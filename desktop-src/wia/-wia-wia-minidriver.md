---
description: Os aplicativos veem os dispositivos de aquisição de imagem do Windows (WIA) como uma árvore hierárquica de objetos IWiaItem ou IWiaItem2 com o item raiz que representa o próprio dispositivo.
ms.assetid: ae4ded93-09be-4caa-ad6e-1a9071fdb4b6
title: Minidriver WIA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f5aadaf55cfe2e8102d4e0e02cf9787b9696e327
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104501775"
---
# <a name="wia-minidriver"></a><span data-ttu-id="c288c-103">Minidriver WIA</span><span class="sxs-lookup"><span data-stu-id="c288c-103">WIA Minidriver</span></span>

<span data-ttu-id="c288c-104">Os aplicativos veem os dispositivos de aquisição de imagem do Windows (WIA) como uma árvore hierárquica de objetos [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) ou [**IWiaItem2**](-wia-iwiaitem2.md) com o item raiz que representa o próprio dispositivo.</span><span class="sxs-lookup"><span data-stu-id="c288c-104">Applications see Windows Image Acquisition (WIA) devices as a hierarchical tree of [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) objects with the root item representing the device itself.</span></span> <span data-ttu-id="c288c-105">Os dispositivos WIA podem ser usados simultaneamente por mais de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="c288c-105">WIA devices may be used concurrently by more than one application.</span></span> <span data-ttu-id="c288c-106">Portanto, é necessário que a exibição de cada aplicativo de um objeto **IWiaItem** ou **IWiaItem2** seja independente das exibições de outro aplicativo.</span><span class="sxs-lookup"><span data-stu-id="c288c-106">It is therefore necessary that each application's view of an **IWiaItem** or **IWiaItem2** object be independent of another application's views.</span></span> <span data-ttu-id="c288c-107">Isso é feito com dois objetos de item diferentes.</span><span class="sxs-lookup"><span data-stu-id="c288c-107">This is accomplished by having two different item objects.</span></span> <span data-ttu-id="c288c-108">O driver cria a árvore de itens de driver de objetos de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) , também chamados de itens de driver, usando os métodos de serviços de driver WIA.</span><span class="sxs-lookup"><span data-stu-id="c288c-108">The driver creates the driver item tree of [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) objects, also called driver items, using the WIA driver services methods.</span></span> <span data-ttu-id="c288c-109">Esses são objetos globais que o driver usa para representar os itens internos de cada driver.</span><span class="sxs-lookup"><span data-stu-id="c288c-109">These are global objects that the driver uses to represent each driver's internal items.</span></span> <span data-ttu-id="c288c-110">Quando um aplicativo cria um objeto **IWiaItem** ou **IWiaItem2** (também chamado de item de aplicativo), esse objeto é vinculado à [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) correspondente do driver na árvore de itens de driver.</span><span class="sxs-lookup"><span data-stu-id="c288c-110">When an application creates an **IWiaItem** or **IWiaItem2** object (also called an application item), this object is linked to the driver's corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) in the driver item tree.</span></span> <span data-ttu-id="c288c-111">Uma contagem de referência é mantida no objeto de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) sujeito às seguintes regras:</span><span class="sxs-lookup"><span data-stu-id="c288c-111">A reference count is maintained on the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object subject to the following rules:</span></span>

-   <span data-ttu-id="c288c-112">Quando um driver adiciona um objeto de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) à árvore de itens de driver, a contagem de referência do objeto de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) é incrementada.</span><span class="sxs-lookup"><span data-stu-id="c288c-112">When a driver adds an [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object to the driver item tree, the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count is incremented.</span></span> <span data-ttu-id="c288c-113">Normalmente, isso ocorre durante o [IWiaMiniDrv::D rvinitializewia](https://msdn.microsoft.com/library/ms794097.aspx) ou quando um \_ comando de sincronização de cmd WIA \_ é processado.</span><span class="sxs-lookup"><span data-stu-id="c288c-113">This typically takes place during [IWiaMiniDrv::drvInitializeWia](https://msdn.microsoft.com/library/ms794097.aspx) or when a WIA\_CMD\_SYNCHRONIZE command is processed.</span></span>
-   <span data-ttu-id="c288c-114">Quando um driver remove um objeto de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) da árvore de itens de driver, a contagem de referência do objeto de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) é decrementada e o objeto de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) é marcado para que ele não possa acessar o dispositivo novamente.</span><span class="sxs-lookup"><span data-stu-id="c288c-114">When a driver removes an [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object from the driver item tree, the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count is decremented and the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is marked so that it can't access the device again.</span></span> <span data-ttu-id="c288c-115">Normalmente, isso ocorre quando um dispositivo é desconectado ou um item é excluído.</span><span class="sxs-lookup"><span data-stu-id="c288c-115">This typically takes place when a device is disconnected or an item is deleted.</span></span> <span data-ttu-id="c288c-116">Os aplicativos ainda podem ler propriedades de um objeto [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) ou [**IWiaItem2**](-wia-iwiaitem2.md) mesmo quando o objeto de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) correspondente foi removido da árvore de itens de driver.</span><span class="sxs-lookup"><span data-stu-id="c288c-116">Applications are still able to read properties from an [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) object even when the corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object has been removed from the driver item tree.</span></span>
-   <span data-ttu-id="c288c-117">Quando um objeto [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) ou [**IWiaItem2**](-wia-iwiaitem2.md) é criado, ele é vinculado a um objeto de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) correspondente.</span><span class="sxs-lookup"><span data-stu-id="c288c-117">When an [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) object is created it is linked to a corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object.</span></span> <span data-ttu-id="c288c-118">A contagem de referência do objeto de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) é incrementada.</span><span class="sxs-lookup"><span data-stu-id="c288c-118">The reference count of the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is incremented.</span></span>
-   <span data-ttu-id="c288c-119">Quando um objeto [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) ou [**IWiaItem2**](-wia-iwiaitem2.md) é liberado, o link para seu objeto de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) correspondente é grave e a contagem de referência do objeto de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) é diminuída.</span><span class="sxs-lookup"><span data-stu-id="c288c-119">When an [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) object is released, the link to its corresponding [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is severed and the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count is decremented.</span></span>
-   <span data-ttu-id="c288c-120">Se a contagem de referência de um objeto de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) chegar a zero, o objeto de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) será excluído.</span><span class="sxs-lookup"><span data-stu-id="c288c-120">If an [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count goes to zero, the [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object is deleted.</span></span> <span data-ttu-id="c288c-121">Isso se aplica a todos os objetos de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) , incluindo o item raiz.</span><span class="sxs-lookup"><span data-stu-id="c288c-121">This applies to all [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) objects including the root item.</span></span> <span data-ttu-id="c288c-122">A contagem de referência de um objeto de [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) só vai para zero quando nenhum item de aplicativo faz referência a ele e não está mais vinculado à árvore de itens de driver.</span><span class="sxs-lookup"><span data-stu-id="c288c-122">An [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) object's reference count only goes to zero when no application items reference it and it is no longer linked to the driver item tree.</span></span>

<span data-ttu-id="c288c-123">Usando esse esquema de contagem de referência, muitos objetos [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) ou [**IWiaItem2**](-wia-iwiaitem2.md) podem ser vinculados a uma [interface IWiaDrvItem](https://msdn.microsoft.com/library/ms793976.aspx) sem interferência.</span><span class="sxs-lookup"><span data-stu-id="c288c-123">Using this reference counting scheme, many [**IWiaItem**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) or [**IWiaItem2**](-wia-iwiaitem2.md) objects may link to one [IWiaDrvItem Interface](https://msdn.microsoft.com/library/ms793976.aspx) without interference.</span></span> <span data-ttu-id="c288c-124">Como cada **IWiaItem** ou **IWiaItem2** contém seu próprio armazenamento de propriedade, um aplicativo pode continuar a ler as propriedades do item mesmo depois que um item tiver sido excluído, mas nenhuma operação que requer acesso ao dispositivo terá sucesso.</span><span class="sxs-lookup"><span data-stu-id="c288c-124">Because each **IWiaItem** or **IWiaItem2** contains its own property storage, an application can continue to read item properties even after an item has been deleted, but no operation that requires access to the device will succeed.</span></span> <span data-ttu-id="c288c-125">Como as propriedades de item são armazenadas no objeto **IWiaItem** ou **IWiaItem2** , o driver deve definir as propriedades do objeto **IWiaItem** ou **IWiaItem2** para o dispositivo antes de uma transferência de dados.</span><span class="sxs-lookup"><span data-stu-id="c288c-125">Because item properties are stored in the **IWiaItem** or **IWiaItem2** object, the driver must set the **IWiaItem** or **IWiaItem2** object's properties to the device before a data transfer.</span></span>

 

 



