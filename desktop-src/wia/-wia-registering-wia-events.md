---
description: 'Os aplicativos podem ser registrados para serem notificados sobre eventos de dispositivo de hardware da aquisição de imagens do Windows (WIA) chamando um dos seguintes métodos de interface IWiaDevMgr ou IWiaDevMgr2: IWiaDevMgr:: RegisterEventCallbackCLSID ou IWiaDevMgr2:: RegisterEventCallbackCLSIDIWiaDevMgr:: RegisterEventCallbackInterface ou IWiaDevMgr2:: RegisterEventCallbackInterfaceIWiaDevMgr:: RegisterEventCallbackProgram ou IWiaDevMgr2:: RegisterEventCallbackProgram'
ms.assetid: 0c142083-835f-4bbd-ab32-eb6130f99c59
title: Registrando eventos WIA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa9fc36540a64211428579bc13b84902490ea103
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103920945"
---
# <a name="registering-wia-events"></a><span data-ttu-id="7b0ab-103">Registrando eventos WIA</span><span class="sxs-lookup"><span data-stu-id="7b0ab-103">Registering WIA Events</span></span>

<span data-ttu-id="7b0ab-104">Os aplicativos podem ser registrados para serem notificados sobre eventos de dispositivo de hardware da aquisição de imagens do Windows (WIA) chamando um dos seguintes métodos de interface [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) ou [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) :</span><span class="sxs-lookup"><span data-stu-id="7b0ab-104">Applications can register to be notified of Windows Image Acquisition (WIA) hardware device events by calling one of the following [**IWiaDevMgr**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiadevmgr) or [**IWiaDevMgr2**](-wia-iwiadevmgr2.md) interface methods:</span></span>

-   <span data-ttu-id="7b0ab-105">[**IWiaDevMgr:: RegisterEventCallbackCLSID**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackclsid) ou [ **IWiaDevMgr2:: RegisterEventCallbackCLSID**](-wia-iwiadevmgr2-registereventcallbackclsid.md)</span><span class="sxs-lookup"><span data-stu-id="7b0ab-105">[**IWiaDevMgr::RegisterEventCallbackCLSID**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackclsid) or [**IWiaDevMgr2::RegisterEventCallbackCLSID**](-wia-iwiadevmgr2-registereventcallbackclsid.md)</span></span>
-   <span data-ttu-id="7b0ab-106">[**IWiaDevMgr:: RegisterEventCallbackInterface**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackinterface) ou [ **IWiaDevMgr2:: RegisterEventCallbackInterface**](-wia-iwiadevmgr2-registereventcallbackinterface.md)</span><span class="sxs-lookup"><span data-stu-id="7b0ab-106">[**IWiaDevMgr::RegisterEventCallbackInterface**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackinterface) or [**IWiaDevMgr2::RegisterEventCallbackInterface**](-wia-iwiadevmgr2-registereventcallbackinterface.md)</span></span>
-   <span data-ttu-id="7b0ab-107">[**IWiaDevMgr:: RegisterEventCallbackProgram**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackprogram) ou [ **IWiaDevMgr2:: RegisterEventCallbackProgram**](-wia-iwiadevmgr2-registereventcallbackprogram.md)</span><span class="sxs-lookup"><span data-stu-id="7b0ab-107">[**IWiaDevMgr::RegisterEventCallbackProgram**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-registereventcallbackprogram) or [**IWiaDevMgr2::RegisterEventCallbackProgram**](-wia-iwiadevmgr2-registereventcallbackprogram.md)</span></span>

<span data-ttu-id="7b0ab-108">Todos esses métodos usam parâmetros que especificam o evento e o dispositivo de hardware para o qual o aplicativo deve ser notificado.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-108">All of these methods take parameters that specify the event and the hardware device for which the application is to be notified.</span></span> <span data-ttu-id="7b0ab-109">Os aplicativos se registram para receber um evento para todos os dispositivos WIA, passando um valor **nulo** para o parâmetro que especifica o dispositivo de hardware.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-109">Applications register to receive an event for all WIA devices by passing a **NULL** value for the parameter that specifies the hardware device.</span></span>

<span data-ttu-id="7b0ab-110">O método **RegisterEventCallbackInterface** registra um aplicativo para receber um evento de dispositivo de hardware WIA se o aplicativo estiver em execução no momento em que o evento ocorrer.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-110">The **RegisterEventCallbackInterface** method registers an application to receive a WIA hardware device event if the application is running at the time the event occurs.</span></span> <span data-ttu-id="7b0ab-111">Quando o evento para o qual o aplicativo é registrado ocorre, o WIA chama o método [**IWiaEventCallback:: ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) do objeto fornecido pelo aplicativo para transmitir as informações do evento.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-111">When the event for which the application is registered occurs, WIA calls the [**IWiaEventCallback::ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) method of the application-provided object to transmit the event information.</span></span>

<span data-ttu-id="7b0ab-112">O método **RegisterEventCallbackCLSID** registra um aplicativo que é um componente COM (Component Object Model registrado) para receber um evento de dispositivo de hardware WIA, mesmo que o aplicativo não esteja em execução.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-112">The **RegisterEventCallbackCLSID** method registers an application that is a registered Component Object Model (COM) component to receive a WIA hardware device event even if the application is not running.</span></span> <span data-ttu-id="7b0ab-113">Além dos parâmetros mencionados anteriormente, esse método usa um parâmetro, *pCLSID*, que especifica a ID de classe do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-113">In addition to the parameters mentioned previously, this method takes a parameter, *pClsID*, that specifies the class ID of the application.</span></span> <span data-ttu-id="7b0ab-114">Quando o evento especificado ocorre, o sistema WIA usa a função [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) e a ID de classe especificada por *pCLSID* para criar uma nova instância do aplicativo e chama o método [**IWiaEventCallback:: ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) desse aplicativo para transmitir as informações do evento.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-114">When the specified event occurs, the WIA system uses the [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function and the class ID specified by *pClsID* to create a new instance of the application, and calls the [**IWiaEventCallback::ImageEventCallback**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaeventcallback-imageeventcallback) method of that application to transmit the event information.</span></span>

<span data-ttu-id="7b0ab-115">O método **RegisterEventCallbackProgram** registra um aplicativo para receber um evento de dispositivo de hardware WIA, mesmo que o aplicativo não esteja em execução quando o evento ocorrer.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-115">The **RegisterEventCallbackProgram** method registers an application to receive a WIA hardware device event even if the application is not running when the event occurs.</span></span> <span data-ttu-id="7b0ab-116">O aplicativo não precisa ser um componente COM registrado.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-116">The application need not be a registered COM component.</span></span> <span data-ttu-id="7b0ab-117">O WIA inicia o aplicativo com uma instrução de linha de comando.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-117">WIA launches the application with a command line statement.</span></span> <span data-ttu-id="7b0ab-118">**RegisterEventCallbackProgram** usa um parâmetro, *bstrCommandline*, que especifica o caminho completo e o nome do arquivo do aplicativo executável.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-118">**RegisterEventCallbackProgram** takes a parameter, *bstrCommandline*, that specifies the full path and filename of the executable application.</span></span> <span data-ttu-id="7b0ab-119">**RegisterEventCallbackProgram** existe para compatibilidade com versões anteriores com aplicativos que não foram escritos para WIA e que devem ser evitados.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-119">**RegisterEventCallbackProgram** exists for backward compatibility with applications that were not written for WIA, and should be avoided.</span></span> <span data-ttu-id="7b0ab-120">Em vez disso, use **RegisterEventCallbackInterface** ou **RegisterEventCallbackCLSID** .</span><span class="sxs-lookup"><span data-stu-id="7b0ab-120">Use **RegisterEventCallbackInterface** or **RegisterEventCallbackCLSID** instead.</span></span>

<span data-ttu-id="7b0ab-121">Para determinar quais manipuladores são registrados para eventos em um dispositivo WIA específico, um aplicativo chama um método [**IWiaItem:: EnumRegisterEventInfo**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaitem-enumregistereventinfo) ou [**IWiaItem2:: EnumRegisterEventInfo**](-wia-iwiaitem2-enumregistereventinfo.md) de um item raiz.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-121">To determine which handlers are registered for events on a specific WIA device, an application calls a [**IWiaItem::EnumRegisterEventInfo**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiaitem-enumregistereventinfo) or [**IWiaItem2::EnumRegisterEventInfo**](-wia-iwiaitem2-enumregistereventinfo.md) method of a root item.</span></span> <span data-ttu-id="7b0ab-122">Esse método cria um objeto de enumeração para as informações de registro.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-122">This method creates an enumeration object for the registration information.</span></span> <span data-ttu-id="7b0ab-123">O aplicativo pode usar a interface [**IEnumWIA \_ dev \_ Caps**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_caps) desse objeto para enumerar informações sobre os manipuladores registrados para receber eventos para esse dispositivo.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-123">The application can then use the [**IEnumWIA\_DEV\_CAPS**](/windows/desktop/api/wia_xp/nn-wia_xp-ienumwia_dev_caps) interface of that object to enumerate information about the handlers registered to receive events for that device.</span></span>

<span data-ttu-id="7b0ab-124">Se ocorrer um evento para o qual um aplicativo em execução é registrado por meio de **RegisterEventCallbackInterface** e **RegisterEventCallbackCLSID** ou **RegisterEventCallbackProgram**, o WIA notifica o aplicativo em execução e não tenta iniciar uma nova instância do aplicativo porque o registro de eventos por meio de **RegisterEventCallbackInterface** tem precedência sobre **RegisterEventCallbackCLSID** e **RegisterEventCallbackProgram**.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-124">If an event occurs for which a running application is registered through **RegisterEventCallbackInterface** and either **RegisterEventCallbackCLSID** or **RegisterEventCallbackProgram**, WIA notifies the running application and does not attempt to launch a new instance of the application because event registration through **RegisterEventCallbackInterface** takes precedence over both **RegisterEventCallbackCLSID** and **RegisterEventCallbackProgram**.</span></span>

> [!Note]  
> <span data-ttu-id="7b0ab-125">Em um aplicativo multi-threaded, não há nenhuma garantia de que o thread em que o retorno de chamada de notificação de eventos retornará é o mesmo thread que registrou o retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="7b0ab-125">In a multi-threaded application, there is no guarantee that the thread that the event notification callback will return on is the same thread that registered the callback.</span></span>

 

 

 
