---
description: O serviço de ordenação de threads controla a execução de um ou mais threads de cliente. Ele garante que cada thread de cliente seja executado uma vez durante o período especificado e em ordem relativa.
ms.assetid: 5c37873a-ced4-447e-a6e1-55cfa8ab24b4
title: Serviço de ordenação de threads
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 72b3cd12b26124b47d506585425388a4542a70df
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105754306"
---
# <a name="thread-ordering-service"></a><span data-ttu-id="a9daf-104">Serviço de ordenação de threads</span><span class="sxs-lookup"><span data-stu-id="a9daf-104">Thread Ordering Service</span></span>

<span data-ttu-id="a9daf-105">O *serviço de ordenação de threads* controla a execução de um ou mais threads de cliente.</span><span class="sxs-lookup"><span data-stu-id="a9daf-105">The *thread ordering service* controls the execution of one or more client threads.</span></span> <span data-ttu-id="a9daf-106">Ele garante que cada thread de cliente seja executado uma vez durante o período especificado e em ordem relativa.</span><span class="sxs-lookup"><span data-stu-id="a9daf-106">It ensures that each client thread runs once during the specified period and in relative order.</span></span>

<span data-ttu-id="a9daf-107">**Windows Server 2003 e Windows XP:** O serviço de ordenação de threads está disponível a partir do Windows Vista e do Windows Server 2008.</span><span class="sxs-lookup"><span data-stu-id="a9daf-107">**Windows Server 2003 and Windows XP:** The thread ordering service is available starting with Windows Vista and Windows Server 2008.</span></span>

<span data-ttu-id="a9daf-108">O serviço de ordenação de threads está desativado por padrão e deve ser iniciado pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="a9daf-108">The thread ordering service is off by default and must be started by the user.</span></span> <span data-ttu-id="a9daf-109">Enquanto o serviço de ordenação de threads está em execução, ele é ativado a cada 5 segundos para verificar se há uma nova solicitação, mesmo que o sistema esteja ocioso.</span><span class="sxs-lookup"><span data-stu-id="a9daf-109">While the thread ordering service is running, it is activated every 5 seconds to check whether there is a new request, even if the system is idle.</span></span> <span data-ttu-id="a9daf-110">Isso impede que o sistema fique em suspensão por mais de 5 segundos, fazendo com que o sistema consuma mais energia.</span><span class="sxs-lookup"><span data-stu-id="a9daf-110">This prevents the system from sleeping for longer than 5 seconds, causing the system to consume more power.</span></span> <span data-ttu-id="a9daf-111">Se a eficiência de energia for crítica para o aplicativo, é melhor não usar o serviço de ordenação de threads e, em vez disso, permitir que o Agendador do sistema gerencie a execução de threads.</span><span class="sxs-lookup"><span data-stu-id="a9daf-111">If energy efficiency is critical to the application, it is better not to use the thread ordering service and instead allow the system scheduler to manage execution of threads.</span></span>

<span data-ttu-id="a9daf-112">Cada thread de cliente pertence a um *grupo de ordenação de thread*.</span><span class="sxs-lookup"><span data-stu-id="a9daf-112">Each client thread belongs to a *thread ordering group*.</span></span> <span data-ttu-id="a9daf-113">O *thread pai* cria um ou mais grupos de ordenação de threads chamando a função [**AvRtCreateThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtcreatethreadorderinggroup) .</span><span class="sxs-lookup"><span data-stu-id="a9daf-113">The *parent thread* creates one or more thread ordering groups by calling the [**AvRtCreateThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtcreatethreadorderinggroup) function.</span></span> <span data-ttu-id="a9daf-114">O thread pai usa essa função para especificar o período para o grupo de ordenação de threads e um intervalo de tempo limite.</span><span class="sxs-lookup"><span data-stu-id="a9daf-114">The parent thread uses this function to specify the period for the thread ordering group and a time-out interval.</span></span>

<span data-ttu-id="a9daf-115">Threads de cliente adicionais chamam a função [**AvRtJoinThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtjointhreadorderinggroup) para ingressar em um grupo de ordenação de thread existente.</span><span class="sxs-lookup"><span data-stu-id="a9daf-115">Additional client threads call the [**AvRtJoinThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtjointhreadorderinggroup) function to join an existing thread ordering group.</span></span> <span data-ttu-id="a9daf-116">Esses threads indicam se são um predecessor ou um sucessor para o thread pai na ordem de execução.</span><span class="sxs-lookup"><span data-stu-id="a9daf-116">These threads indicate whether they are to be a predecessor or successor to the parent thread in the execution order.</span></span> <span data-ttu-id="a9daf-117">Espera-se que cada thread de cliente conclua uma determinada quantidade de processamento a cada período.</span><span class="sxs-lookup"><span data-stu-id="a9daf-117">Each client thread is expected to complete a certain amount of processing each period.</span></span> <span data-ttu-id="a9daf-118">Todos os threads dentro do grupo devem concluir sua execução dentro do período mais o intervalo de tempo limite.</span><span class="sxs-lookup"><span data-stu-id="a9daf-118">All threads within the group should complete their execution within the period plus the time-out interval.</span></span>

<span data-ttu-id="a9daf-119">Os threads de um grupo de ordenação de threads incluem seu código de processamento dentro de um loop que é controlado pela função [**AvRtWaitOnThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtwaitonthreadorderinggroup) .</span><span class="sxs-lookup"><span data-stu-id="a9daf-119">The threads of a thread ordering group enclose their processing code within a loop that is controlled by the [**AvRtWaitOnThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtwaitonthreadorderinggroup) function.</span></span> <span data-ttu-id="a9daf-120">Primeiro, os threads predecessores são executados um de cada vez na ordem em que ingressaram no grupo, enquanto os threads pai e sucessora são bloqueados em suas chamadas para **AvRtWaitOnThreadOrderingGroup**.</span><span class="sxs-lookup"><span data-stu-id="a9daf-120">First, the predecessor threads are executed one at a time in the order that they joined the group, while the parent and successor threads are blocked on their calls to **AvRtWaitOnThreadOrderingGroup**.</span></span> <span data-ttu-id="a9daf-121">Quando cada thread de predecessora é concluído com seu processamento, o controle de execução retorna à parte superior de seu loop de processamento e o thread chama **AvRtWaitOnThreadOrderingGroup** novamente para bloquear até a próxima vez.</span><span class="sxs-lookup"><span data-stu-id="a9daf-121">When each predecessor thread is finished with its processing, control of execution returns to the top of its processing loop and the thread calls **AvRtWaitOnThreadOrderingGroup** again to block until its next turn.</span></span> <span data-ttu-id="a9daf-122">Depois que todos os threads predecessores tiverem chamado essa função, o serviço de ordenação de threads poderá agendar o thread pai.</span><span class="sxs-lookup"><span data-stu-id="a9daf-122">After all predecessor threads have called this function, the thread ordering service can schedule the parent thread.</span></span> <span data-ttu-id="a9daf-123">Finalmente, quando o thread pai conclui seu processamento e chama **AvRtWaitOnThreadOrderingGroup** novamente, o serviço de ordenação de threads pode agendar os threads de sucessor um de cada vez na ordem em que ingressaram no grupo.</span><span class="sxs-lookup"><span data-stu-id="a9daf-123">Finally, when the parent thread finishes its processing and calls **AvRtWaitOnThreadOrderingGroup** again, the thread ordering service can schedule the successor threads one at a time in the order that they joined the group.</span></span> <span data-ttu-id="a9daf-124">Se todos os threads concluírem sua execução antes do término de um período, todos os threads aguardarão até que o restante do período decorra antes que qualquer um seja executado novamente.</span><span class="sxs-lookup"><span data-stu-id="a9daf-124">If all threads complete their execution before a period ends, all threads wait until the remainder of the period elapses before any are executed again.</span></span>

<span data-ttu-id="a9daf-125">Quando o cliente não precisa mais ser executado como parte do grupo de ordenação de threads, ele chama a função [**AvRtLeaveThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtleavethreadorderinggroup) para se remover do grupo.</span><span class="sxs-lookup"><span data-stu-id="a9daf-125">When the client need no longer run as part of the thread ordering group, it calls the [**AvRtLeaveThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtleavethreadorderinggroup) function to remove itself from the group.</span></span> <span data-ttu-id="a9daf-126">Observe que o thread pai não deve se remover de um grupo de ordenação de threads.</span><span class="sxs-lookup"><span data-stu-id="a9daf-126">Note that the parent thread should not remove itself from a thread ordering group.</span></span> <span data-ttu-id="a9daf-127">Se um thread não concluir sua execução antes do período mais o intervalo de tempo limite expirar, ele será excluído do grupo.</span><span class="sxs-lookup"><span data-stu-id="a9daf-127">If a thread does not complete its execution before the period plus the time-out interval elapses, then it is deleted from the group.</span></span>

<span data-ttu-id="a9daf-128">O thread pai chama a função [**AvRtDeleteThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtdeletethreadorderinggroup) para excluir o grupo de ordenação de threads.</span><span class="sxs-lookup"><span data-stu-id="a9daf-128">The parent thread calls the [**AvRtDeleteThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtdeletethreadorderinggroup) function to delete the thread ordering group.</span></span> <span data-ttu-id="a9daf-129">O grupo de ordenação de thread também será destruído se o thread pai não concluir sua execução antes do período mais o intervalo de tempo limite expirar.</span><span class="sxs-lookup"><span data-stu-id="a9daf-129">The thread ordering group is also destroyed if the parent thread does not complete its execution before the period plus the time-out interval elapses.</span></span> <span data-ttu-id="a9daf-130">Quando o grupo de ordenação de threads é destruído, todas as chamadas para [**AvRtWaitOnThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtwaitonthreadorderinggroup) de threads desse grupo falham ou expiram.</span><span class="sxs-lookup"><span data-stu-id="a9daf-130">When the thread ordering group is destroyed, any calls to [**AvRtWaitOnThreadOrderingGroup**](/windows/desktop/api/Avrt/nf-avrt-avrtwaitonthreadorderinggroup) from threads of that group fail or time out.</span></span>

 

 



