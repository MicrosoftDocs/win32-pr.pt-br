---
description: Um objeto de trabalho permite que grupos de processos sejam gerenciados como uma unidade. Os objetos de trabalho são objetos namable, protegíveis e compartilháveis que controlam os atributos dos processos associados a eles.
ms.assetid: 59296384-5e78-44dd-8019-f1df6668928b
title: Objetos de trabalho
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 07e6d9758faf2b66f047ca60dbba91601b202b4c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104296743"
---
# <a name="job-objects"></a><span data-ttu-id="d3935-104">Objetos de trabalho</span><span class="sxs-lookup"><span data-stu-id="d3935-104">Job Objects</span></span>

<span data-ttu-id="d3935-105">Um *objeto de trabalho* permite que grupos de processos sejam gerenciados como uma unidade.</span><span class="sxs-lookup"><span data-stu-id="d3935-105">A *job object* allows groups of processes to be managed as a unit.</span></span> <span data-ttu-id="d3935-106">Os objetos de trabalho são objetos namable, protegíveis e compartilháveis que controlam os atributos dos processos associados a eles.</span><span class="sxs-lookup"><span data-stu-id="d3935-106">Job objects are namable, securable, sharable objects that control attributes of the processes associated with them.</span></span> <span data-ttu-id="d3935-107">As operações realizadas em um objeto de trabalho afetam todos os processos associados ao objeto de trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-107">Operations performed on a job object affect all processes associated with the job object.</span></span> <span data-ttu-id="d3935-108">Os exemplos incluem a imposição de limites, como o tamanho do conjunto de trabalho e a prioridade do processo ou o encerramento de todos os processos associados a um trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-108">Examples include enforcing limits such as working set size and process priority or terminating all processes associated with a job.</span></span>

-   [<span data-ttu-id="d3935-109">Criando trabalhos</span><span class="sxs-lookup"><span data-stu-id="d3935-109">Creating Jobs</span></span>](#creating-jobs)
-   [<span data-ttu-id="d3935-110">Gerenciando processos em trabalhos</span><span class="sxs-lookup"><span data-stu-id="d3935-110">Managing Processes in Jobs</span></span>](#managing-processes-in-jobs)
-   [<span data-ttu-id="d3935-111">Notificações e limites de trabalho</span><span class="sxs-lookup"><span data-stu-id="d3935-111">Job Limits and Notifications</span></span>](#job-limits-and-notifications)
-   [<span data-ttu-id="d3935-112">Contabilidade de recursos para trabalhos</span><span class="sxs-lookup"><span data-stu-id="d3935-112">Resource Accounting for Jobs</span></span>](#resource-accounting-for-jobs)
-   [<span data-ttu-id="d3935-113">Gerenciando objetos de trabalho</span><span class="sxs-lookup"><span data-stu-id="d3935-113">Managing Job Objects</span></span>](#managing-job-objects)
-   [<span data-ttu-id="d3935-114">Gerenciando uma árvore de processos que usa objetos de trabalho</span><span class="sxs-lookup"><span data-stu-id="d3935-114">Managing a Process Tree that Uses Job Objects</span></span>](#managing-a-process-tree-that-uses-job-objects)

## <a name="creating-jobs"></a><span data-ttu-id="d3935-115">Criando trabalhos</span><span class="sxs-lookup"><span data-stu-id="d3935-115">Creating Jobs</span></span>

<span data-ttu-id="d3935-116">Para criar um objeto de trabalho, use a função [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta) .</span><span class="sxs-lookup"><span data-stu-id="d3935-116">To create a job object, use the [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta) function.</span></span> <span data-ttu-id="d3935-117">Quando o trabalho é criado, nenhum processo é associado ao trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-117">When the job is created, no processes are associated with the job.</span></span>

<span data-ttu-id="d3935-118">Para associar um processo a um trabalho, use a função [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) .</span><span class="sxs-lookup"><span data-stu-id="d3935-118">To associate a process with a job, use the [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) function.</span></span> <span data-ttu-id="d3935-119">Depois que um processo é associado a um trabalho, a associação não pode ser quebrada.</span><span class="sxs-lookup"><span data-stu-id="d3935-119">After a process is associated with a job, the association cannot be broken.</span></span> <span data-ttu-id="d3935-120">Um processo pode ser associado a mais de um trabalho em uma hierarquia de trabalhos aninhados.</span><span class="sxs-lookup"><span data-stu-id="d3935-120">A process can be associated with more than one job in a hierarchy of nested jobs.</span></span> <span data-ttu-id="d3935-121">Para obter mais informações, consulte [tarefas aninhadas](nested-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="d3935-121">For more information, see [Nested Jobs](nested-jobs.md).</span></span>

<span data-ttu-id="d3935-122">**Windows 7, Windows server 2008 R2, Windows XP com SP3, Windows server 2008, Windows Vista e Windows Server 2003:** Um processo pode ser associado a apenas um trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-122">**Windows 7, Windows Server 2008 R2, Windows XP with SP3, Windows Server 2008, Windows Vista and Windows Server 2003:** A process can be associated with only one job.</span></span> <span data-ttu-id="d3935-123">Os trabalhos não podem ser aninhados.</span><span class="sxs-lookup"><span data-stu-id="d3935-123">Jobs cannot be nested.</span></span> <span data-ttu-id="d3935-124">A capacidade de aninhar trabalhos foi adicionada no Windows 8 e no Windows Server 2012.</span><span class="sxs-lookup"><span data-stu-id="d3935-124">The ability to nest jobs was added in Windows 8 and Windows Server 2012.</span></span>

<span data-ttu-id="d3935-125">Você pode especificar um descritor de segurança para um objeto de trabalho ao chamar a função [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta) .</span><span class="sxs-lookup"><span data-stu-id="d3935-125">You can specify a security descriptor for a job object when you call the [**CreateJobObject**](/windows/desktop/api/WinBase/nf-winbase-createjobobjecta) function.</span></span> <span data-ttu-id="d3935-126">Para obter mais informações, consulte [segurança do objeto de trabalho e direitos de acesso](job-object-security-and-access-rights.md).</span><span class="sxs-lookup"><span data-stu-id="d3935-126">For more information, see [Job Object Security and Access Rights](job-object-security-and-access-rights.md).</span></span>

## <a name="managing-processes-in-jobs"></a><span data-ttu-id="d3935-127">Gerenciando processos em trabalhos</span><span class="sxs-lookup"><span data-stu-id="d3935-127">Managing Processes in Jobs</span></span>

<span data-ttu-id="d3935-128">Depois que um processo é associado a um trabalho, por padrão, todos os processos filho que ele cria usando [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) também são associados ao trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-128">After a process is associated with a job, by default any child processes it creates using [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) are also associated with the job.</span></span> <span data-ttu-id="d3935-129">(Processos filho criados usando [**o \_ processo Win32. Create**](../cimwin32prov/create-method-in-class-win32-process.md) não estão associados ao trabalho.) Esse comportamento padrão pode ser alterado configurando o limite estendido do objeto de trabalho limite \_ \_ \_ BREAKAWAY \_ OK ou o \_ limite de objeto de trabalho \_ \_ silencioso \_ BREAKAWAY \_ OK para o trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-129">(Child processes created using [**Win32\_Process.Create**](../cimwin32prov/create-method-in-class-win32-process.md) are not associated with the job.) This default behavior can be changed by setting the extended limit JOB\_OBJECT\_LIMIT\_BREAKAWAY\_OK or JOB\_OBJECT\_LIMIT\_SILENT\_BREAKAWAY\_OK for the job.</span></span>

-   <span data-ttu-id="d3935-130">Se o trabalho tiver o limite de objeto de trabalho limite estendido \_ \_ \_ BREAKAWAY \_ OK e o processo pai tiver sido criado com o \_ sinalizador criar BREAKAWAY \_ do \_ trabalho, os processos filho do processo pai não serão associados ao trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-130">If the job has the extended limit JOB\_OBJECT\_LIMIT\_BREAKAWAY\_OK and the parent process was created with the CREATE\_BREAKAWAY\_FROM\_JOB flag, then child processes of the parent process are not associated with the job.</span></span>
-   <span data-ttu-id="d3935-131">Se o trabalho tiver o limite de objeto de trabalho limite estendido \_ \_ \_ \_ BREAKAWAY \_ OK, os processos filho de qualquer processo pai associado ao trabalho não serão associados ao trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-131">If the job has the extended limit JOB\_OBJECT\_LIMIT\_SILENT\_BREAKAWAY\_OK, then child processes of any parent process associated with the job are not associated with the job.</span></span> <span data-ttu-id="d3935-132">Não é necessário que os processos pai sejam criados com o sinalizador criar \_ BREAKAWAY \_ do \_ trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-132">It is not necessary for parent processes to be created with the CREATE\_BREAKAWAY\_FROM\_JOB flag.</span></span>

<span data-ttu-id="d3935-133">Se o trabalho estiver aninhado, as configurações de Breakaway dos trabalhos pai na hierarquia afetarão se os processos filho estão associados a outro trabalho na hierarquia.</span><span class="sxs-lookup"><span data-stu-id="d3935-133">If the job is nested, the breakaway settings of parent jobs in the hierarchy affect whether child processes are associated with another job in the hierarchy.</span></span> <span data-ttu-id="d3935-134">Para obter mais informações, consulte [tarefas aninhadas](nested-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="d3935-134">For more information, see [Nested Jobs](nested-jobs.md).</span></span>

<span data-ttu-id="d3935-135">Para determinar se um processo está sendo executado em um trabalho, use a função [**IsProcessInJob**](/windows/win32/api/jobapi/nf-jobapi-isprocessinjob) .</span><span class="sxs-lookup"><span data-stu-id="d3935-135">To determine if a process is running in a job, use the [**IsProcessInJob**](/windows/win32/api/jobapi/nf-jobapi-isprocessinjob) function.</span></span>

<span data-ttu-id="d3935-136">Para encerrar todos os processos atualmente associados a um objeto de trabalho, use a função [**TerminateJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-terminatejobobject) .</span><span class="sxs-lookup"><span data-stu-id="d3935-136">To terminate all processes currently associated with a job object, use the [**TerminateJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-terminatejobobject) function.</span></span>

## <a name="job-limits-and-notifications"></a><span data-ttu-id="d3935-137">Notificações e limites de trabalho</span><span class="sxs-lookup"><span data-stu-id="d3935-137">Job Limits and Notifications</span></span>

<span data-ttu-id="d3935-138">Um trabalho pode impor limites como o tamanho do conjunto de trabalho, a prioridade do processo e o limite de tempo de término do trabalho em cada processo associado ao trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-138">A job can enforce limits such as working set size, process priority, and end-of-job time limit on each process that is associated with the job.</span></span> <span data-ttu-id="d3935-139">Se um processo associado a um trabalho tentar aumentar seu tamanho de conjunto de trabalho ou prioridade de processo do limite estabelecido pelo trabalho, a função chamará com sucesso, mas será silenciosamente ignorada.</span><span class="sxs-lookup"><span data-stu-id="d3935-139">If a process associated with a job attempts to increase its working set size or process priority from the limit established by the job, the function calls succeed but are silently ignored.</span></span> <span data-ttu-id="d3935-140">Um trabalho também pode definir limites que disparam uma notificação quando são excedidos, mas permitem que o trabalho continue a ser executado.</span><span class="sxs-lookup"><span data-stu-id="d3935-140">A job can also set limits that trigger a notification when they are exceeded but allow the job to continue to run.</span></span>

<span data-ttu-id="d3935-141">Para definir limites para um trabalho, use a função [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) .</span><span class="sxs-lookup"><span data-stu-id="d3935-141">To set limits for a job, use the [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) function.</span></span> <span data-ttu-id="d3935-142">Para obter uma lista dos possíveis limites que podem ser definidos para um trabalho, consulte os seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="d3935-142">For a list of possible limits that can be set for a job, see the following topics:</span></span>

-   [<span data-ttu-id="d3935-143">**\_informações de \_ limite \_ básico do JOBOBJECT**</span><span class="sxs-lookup"><span data-stu-id="d3935-143">**JOBOBJECT\_BASIC\_LIMIT\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_basic_limit_information)
-   [<span data-ttu-id="d3935-144">**\_restrições básicas de \_ interface do usuário do JOBOBJECT \_**</span><span class="sxs-lookup"><span data-stu-id="d3935-144">**JOBOBJECT\_BASIC\_UI\_RESTRICTIONS**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_basic_ui_restrictions)
-   [<span data-ttu-id="d3935-145">**\_informações de \_ controle de taxa de CPU JOBOBJECT \_ \_**</span><span class="sxs-lookup"><span data-stu-id="d3935-145">**JOBOBJECT\_CPU\_RATE\_CONTROL\_INFORMATION**</span></span>](/windows/desktop/api/Winnt/ns-winnt-jobobject_cpu_rate_control_information)
-   [<span data-ttu-id="d3935-146">**\_informações de \_ limite ESTENDIdo JOBOBJECT \_**</span><span class="sxs-lookup"><span data-stu-id="d3935-146">**JOBOBJECT\_EXTENDED\_LIMIT\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_extended_limit_information)
-   [<span data-ttu-id="d3935-147">**\_informações de \_ limite de notificação do JOBOBJECT \_**</span><span class="sxs-lookup"><span data-stu-id="d3935-147">**JOBOBJECT\_NOTIFICATION\_LIMIT\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_notification_limit_information)

<span data-ttu-id="d3935-148">Os limites de segurança devem ser definidos individualmente para cada processo associado a um objeto de trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-148">Security limits must be set individually for each process associated with a job object.</span></span> <span data-ttu-id="d3935-149">Para obter mais informações, consulte [segurança do processo e direitos de acesso](process-security-and-access-rights.md).</span><span class="sxs-lookup"><span data-stu-id="d3935-149">For more information, see [Process Security and Access Rights](process-security-and-access-rights.md).</span></span>

<span data-ttu-id="d3935-150">**Windows XP com SP3 e Windows Server 2003:** A função [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) pode ser usada para definir limitações de segurança para todos os processos associados a um objeto de trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-150">**Windows XP with SP3 and Windows Server 2003:** The [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) function can be used to set security limitations for all processes associated with a job object.</span></span> <span data-ttu-id="d3935-151">A partir do Windows Vista, os limites de segurança devem ser definidos individualmente para cada processo associado a um objeto de trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-151">Starting with Windows Vista, security limits must be set individually for each process associated with a job object.</span></span>

<span data-ttu-id="d3935-152">Se o trabalho estiver aninhado, os trabalhos pai na hierarquia influenciarão o limite que é imposto para o trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-152">If the job is nested, parent jobs in the hierarchy influence the limit that is enforced for the job.</span></span> <span data-ttu-id="d3935-153">Para obter mais informações, consulte [tarefas aninhadas](nested-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="d3935-153">For more information, see [Nested Jobs](nested-jobs.md).</span></span>

<span data-ttu-id="d3935-154">Se o trabalho tiver uma porta de conclusão de e/s associada, ele poderá receber notificações quando determinados limites de trabalho forem excedidos.</span><span class="sxs-lookup"><span data-stu-id="d3935-154">If the job has an associated I/O completion port, it can receive notifications when certain job limits are exceeded.</span></span> <span data-ttu-id="d3935-155">O sistema envia mensagens para a porta de conclusão quando um limite é excedido ou determinados outros eventos ocorrem.</span><span class="sxs-lookup"><span data-stu-id="d3935-155">The system sends messages to the completion port when a limit is exceeded or certain other events occur.</span></span> <span data-ttu-id="d3935-156">Para associar uma porta de conclusão a um trabalho, use a função [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) com a classe de informações do objeto de trabalho **JobObjectAssociateCompletionPortInformation** e um ponteiro para uma estrutura de [**porta de conclusão do JOBOBJECT \_ associado \_ \_**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port) .</span><span class="sxs-lookup"><span data-stu-id="d3935-156">To associate a completion port with a job, use the [**SetInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-setinformationjobobject) function with the job object information class **JobObjectAssociateCompletionPortInformation** and a pointer to a [**JOBOBJECT\_ASSOCIATE\_COMPLETION\_PORT**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port) structure.</span></span> <span data-ttu-id="d3935-157">É melhor fazer isso quando o trabalho está inativo, para reduzir a chance de notificações ausentes para processos cujos Estados são alterados durante a associação da porta de conclusão.</span><span class="sxs-lookup"><span data-stu-id="d3935-157">It is best to do this when the job is inactive, to reduce the chance of missing notifications for processes whose states change during the association of the completion port.</span></span>

<span data-ttu-id="d3935-158">Todas as mensagens são enviadas diretamente do trabalho como se o trabalho tivesse chamado a função [**PostQueuedCompletionStatus**](/windows/win32/api/ioapiset/nf-ioapiset-postqueuedcompletionstatus) .</span><span class="sxs-lookup"><span data-stu-id="d3935-158">All messages are sent directly from the job as if the job had called the [**PostQueuedCompletionStatus**](/windows/win32/api/ioapiset/nf-ioapiset-postqueuedcompletionstatus) function.</span></span> <span data-ttu-id="d3935-159">Um thread deve monitorar a porta de conclusão usando a função [**GetQueuedCompletionStatus**](/windows/win32/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) para pegar as mensagens.</span><span class="sxs-lookup"><span data-stu-id="d3935-159">A thread must monitor the completion port using the [**GetQueuedCompletionStatus**](/windows/win32/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) function to pick up the messages.</span></span> <span data-ttu-id="d3935-160">Observe que, com a exceção de limites definidos com a classe de informações **JobObjectNotificationLimitInformation** , a entrega de mensagens para a porta de conclusão não é garantida; a falha de uma mensagem a chegar não significa necessariamente que o evento não ocorra.</span><span class="sxs-lookup"><span data-stu-id="d3935-160">Note that, with the exception of limits set with the **JobObjectNotificationLimitInformation** information class, delivery of messages to the completion port is not guaranteed; failure of a message to arrive does not necessarily mean that the event did not occur.</span></span> <span data-ttu-id="d3935-161">As notificações para os limites definidos com **JobObjectNotificationLimitInformation** têm garantia de chegar à porta de conclusão.</span><span class="sxs-lookup"><span data-stu-id="d3935-161">Notifications for limits set with **JobObjectNotificationLimitInformation** are guaranteed to arrive at the completion port.</span></span> <span data-ttu-id="d3935-162">Para obter uma lista de possíveis mensagens, consulte [**JOBOBJECT \_ associar a \_ \_ porta de conclusão**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port).</span><span class="sxs-lookup"><span data-stu-id="d3935-162">For a list of possible messages, see [**JOBOBJECT\_ASSOCIATE\_COMPLETION\_PORT**](/windows/desktop/api/WinNT/ns-winnt-jobobject_associate_completion_port).</span></span>

## <a name="resource-accounting-for-jobs"></a><span data-ttu-id="d3935-163">Contabilidade de recursos para trabalhos</span><span class="sxs-lookup"><span data-stu-id="d3935-163">Resource Accounting for Jobs</span></span>

<span data-ttu-id="d3935-164">O objeto de trabalho registra informações de estatísticas básicas para todos os seus processos associados, incluindo os que foram encerrados.</span><span class="sxs-lookup"><span data-stu-id="d3935-164">The job object records basic accounting information for all its associated processes, including those that have terminated.</span></span> <span data-ttu-id="d3935-165">Para recuperar essas informações de contabilidade, use a função [**QueryInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-queryinformationjobobject) .</span><span class="sxs-lookup"><span data-stu-id="d3935-165">To retrieve this accounting information, use the [**QueryInformationJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-queryinformationjobobject) function.</span></span> <span data-ttu-id="d3935-166">Para obter uma lista das informações de estatísticas mantidas para um trabalho, consulte os seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="d3935-166">For a list of the accounting information that is maintained for a job, see the following topics:</span></span>

-   [<span data-ttu-id="d3935-167">**informações de contabilidade do JOBOBJECT \_ Basic \_ \_**</span><span class="sxs-lookup"><span data-stu-id="d3935-167">**JOBOBJECT\_BASIC\_ACCOUNTING\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_basic_accounting_information)
-   [<span data-ttu-id="d3935-168">**\_ \_ informações de contabilidade do JOBOBJECT Basic e \_ Io \_ \_**</span><span class="sxs-lookup"><span data-stu-id="d3935-168">**JOBOBJECT\_BASIC\_AND\_IO\_ACCOUNTING\_INFORMATION**</span></span>](/windows/desktop/api/WinNT/ns-winnt-jobobject_basic_and_io_accounting_information)

<span data-ttu-id="d3935-169">Se o objeto de trabalho estiver aninhado, as informações de contabilização de cada trabalho filho serão agregadas em seu trabalho pai.</span><span class="sxs-lookup"><span data-stu-id="d3935-169">If the job object is nested, accounting information for each child job is aggregated in its parent job.</span></span> <span data-ttu-id="d3935-170">Para obter mais informações, consulte [tarefas aninhadas](nested-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="d3935-170">For more information, see [Nested Jobs](nested-jobs.md).</span></span>

## <a name="managing-job-objects"></a><span data-ttu-id="d3935-171">Gerenciando objetos de trabalho</span><span class="sxs-lookup"><span data-stu-id="d3935-171">Managing Job Objects</span></span>

<span data-ttu-id="d3935-172">O estado de um objeto de trabalho é definido como sinalizado quando todos os seus processos são encerrados porque o limite de tempo final do trabalho especificado foi excedido.</span><span class="sxs-lookup"><span data-stu-id="d3935-172">The state of a job object is set to signaled when all of its processes are terminated because the specified end-of-job time limit has been exceeded.</span></span> <span data-ttu-id="d3935-173">Use [**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject) ou [**WaitForSingleObjectEx**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobjectex) para monitorar o objeto de trabalho para este evento.</span><span class="sxs-lookup"><span data-stu-id="d3935-173">Use [**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject) or [**WaitForSingleObjectEx**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobjectex) to monitor the job object for this event.</span></span>

<span data-ttu-id="d3935-174">Para obter um identificador para um objeto de trabalho existente, use a função [**OpenJobObject**](/windows/desktop/api/WinBase/nf-winbase-openjobobjecta) e especifique o nome fornecido para o objeto quando ele foi criado.</span><span class="sxs-lookup"><span data-stu-id="d3935-174">To obtain a handle for an existing job object, use the [**OpenJobObject**](/windows/desktop/api/WinBase/nf-winbase-openjobobjecta) function and specify the name given to the object when it was created.</span></span> <span data-ttu-id="d3935-175">Somente objetos de trabalho nomeados podem ser abertos.</span><span class="sxs-lookup"><span data-stu-id="d3935-175">Only named job objects can be opened.</span></span>

<span data-ttu-id="d3935-176">Para fechar um identificador de objeto de trabalho, use a função [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) .</span><span class="sxs-lookup"><span data-stu-id="d3935-176">To close a job object handle, use the [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) function.</span></span> <span data-ttu-id="d3935-177">O trabalho é destruído quando seu último identificador foi fechado e todos os processos associados foram encerrados.</span><span class="sxs-lookup"><span data-stu-id="d3935-177">The job is destroyed when its last handle has been closed and all associated processes have been terminated.</span></span> <span data-ttu-id="d3935-178">No entanto, se o trabalho tiver o limite de objetos de trabalho \_ \_ \_ Kill \_ no \_ sinalizador de fechamento de trabalho \_ especificado, fechar o último identificador de objeto de trabalho finalizará todos os processos associados e, em seguida, destruirá o próprio objeto de trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-178">However, if the job has the JOB\_OBJECT\_LIMIT\_KILL\_ON\_JOB\_CLOSE flag specified, closing the last job object handle terminates all associated processes and then destroys the job object itself.</span></span> <span data-ttu-id="d3935-179">Se um trabalho aninhado tiver o \_ limite de objetos de trabalho \_ \_ Kill \_ no \_ sinalizador de fechamento de trabalho \_ especificado, fechar o último identificador de objeto de trabalho finalizará todos os processos associados ao trabalho e seus trabalhos filho na hierarquia.</span><span class="sxs-lookup"><span data-stu-id="d3935-179">If a nested job has the JOB\_OBJECT\_LIMIT\_KILL\_ON\_JOB\_CLOSE flag specified, closing the last job object handle terminates all processes associated with the job and its child jobs in the hierarchy.</span></span>

## <a name="managing-a-process-tree-that-uses-job-objects"></a><span data-ttu-id="d3935-180">Gerenciando uma árvore de processos que usa objetos de trabalho</span><span class="sxs-lookup"><span data-stu-id="d3935-180">Managing a Process Tree that Uses Job Objects</span></span>

<span data-ttu-id="d3935-181">A partir do Windows 8 e do Windows Server 2012, um aplicativo pode usar [trabalhos aninhados](nested-jobs.md) para gerenciar uma árvore de processos que usa mais de um objeto de trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-181">Starting with Windows 8 and Windows Server 2012, an application can use [nested jobs](nested-jobs.md) to manage a process tree that uses more than one job object.</span></span> <span data-ttu-id="d3935-182">No entanto, um aplicativo que deve ser executado no Windows 7, no Windows Server 2008 R2 ou em versões anteriores do Windows que não dão suporte a trabalhos aninhados deve gerenciar a árvore de processo de outras maneiras.</span><span class="sxs-lookup"><span data-stu-id="d3935-182">However, an application that must run on Windows 7, Windows Server 2008 R2, or earlier versions of Windows that do not support nested jobs must manage the process tree in other ways.</span></span>

<span data-ttu-id="d3935-183">Se uma ferramenta precisar gerenciar uma árvore de processos que usa objetos de trabalho e não for possível usar trabalhos aninhados, a ferramenta e os membros da árvore de processos deverão cooperar.</span><span class="sxs-lookup"><span data-stu-id="d3935-183">If a tool must manage a process tree that uses job objects and it is not possible to use nested jobs, both the tool and the members of the process tree must cooperate.</span></span> <span data-ttu-id="d3935-184">Use uma das seguintes opções:</span><span class="sxs-lookup"><span data-stu-id="d3935-184">Use one of the following options:</span></span>

-   <span data-ttu-id="d3935-185">Use o \_ limite de \_ BREAKAWAY silencioso de limite de objeto de trabalho \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="d3935-185">Use the JOB\_OBJECT\_LIMIT\_SILENT\_BREAKAWAY\_OK limit.</span></span> <span data-ttu-id="d3935-186">Se a ferramenta usar esse limite, ele não poderá monitorar uma árvore de processo inteira.</span><span class="sxs-lookup"><span data-stu-id="d3935-186">If the tool uses this limit, it cannot monitor an entire process tree.</span></span> <span data-ttu-id="d3935-187">A ferramenta pode monitorar apenas os processos que ele adiciona ao trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-187">The tool can monitor only the processes it adds to the job.</span></span> <span data-ttu-id="d3935-188">Se esses processos criarem processos filho, eles não serão associados ao trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-188">If these processes create child processes, they are not associated with the job.</span></span> <span data-ttu-id="d3935-189">Nessa opção, os processos filho podem ser associados a outros objetos de trabalho.</span><span class="sxs-lookup"><span data-stu-id="d3935-189">In this option, child processes can be associated with other job objects.</span></span>
-   <span data-ttu-id="d3935-190">Use o limite de BREAKAWAY do objeto de trabalho limite \_ \_ \_ \_ OK.</span><span class="sxs-lookup"><span data-stu-id="d3935-190">Use the JOB\_OBJECT\_LIMIT\_BREAKAWAY\_OK limit.</span></span> <span data-ttu-id="d3935-191">Se a ferramenta usar esse limite, ela poderá monitorar toda a árvore de processo, exceto pelos processos que qualquer membro da árvore separa explicitamente da árvore.</span><span class="sxs-lookup"><span data-stu-id="d3935-191">If the tool uses this limit, it can monitor the entire process tree, except for those processes that any member of the tree explicitly breaks away from the tree.</span></span> <span data-ttu-id="d3935-192">Um membro da árvore pode criar um processo filho em um novo objeto de trabalho chamando a função [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) com o sinalizador criar \_ BREAKAWAY \_ do \_ trabalho e, em seguida, chamando a função [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) .</span><span class="sxs-lookup"><span data-stu-id="d3935-192">A member of the tree can create a child process in a new job object by calling the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) function with the CREATE\_BREAKAWAY\_FROM\_JOB flag, then calling the [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject) function.</span></span> <span data-ttu-id="d3935-193">Caso contrário, o membro deve manipular casos em que **AssignProcessToJobObject** falhará.</span><span class="sxs-lookup"><span data-stu-id="d3935-193">Otherwise, the member must handle cases in which **AssignProcessToJobObject** fails.</span></span>

    <span data-ttu-id="d3935-194">O \_ sinalizador criar BREAKAWAY \_ do \_ trabalho não terá efeito se a árvore não estiver sendo monitorada pela ferramenta.</span><span class="sxs-lookup"><span data-stu-id="d3935-194">The CREATE\_BREAKAWAY\_FROM\_JOB flag has no effect if the tree is not being monitored by the tool.</span></span> <span data-ttu-id="d3935-195">Portanto, essa é a opção preferida, mas requer conhecimento avançado dos processos que estão sendo monitorados.</span><span class="sxs-lookup"><span data-stu-id="d3935-195">Therefore, this is the preferred option, but it requires advance knowledge of the processes being monitored.</span></span>

-   <span data-ttu-id="d3935-196">Evite Breakaways de qualquer tipo Configurando nem o \_ limite do objeto de trabalho \_ \_ BREAKAWAY \_ OK nem o limite do objeto de trabalho \_ BREAKAWAY o \_ \_ \_ limite silencioso \_ OK.</span><span class="sxs-lookup"><span data-stu-id="d3935-196">Prevent breakaways of any kind by setting neither the JOB\_OBJECT\_LIMIT\_BREAKAWAY\_OK nor the JOB\_OBJECT\_LIMIT\_SILENT\_BREAKAWAY\_OK limit.</span></span> <span data-ttu-id="d3935-197">Nessa opção, a ferramenta pode monitorar toda a árvore de processo.</span><span class="sxs-lookup"><span data-stu-id="d3935-197">In this option, the tool can monitor the entire process tree.</span></span> <span data-ttu-id="d3935-198">No entanto, se um processo filho tentar se associar a si mesmo ou a outro processo filho com um trabalho chamando [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject), a chamada falhará.</span><span class="sxs-lookup"><span data-stu-id="d3935-198">However, if a child process attempts to associate itself or another child process with a job by calling [**AssignProcessToJobObject**](/windows/win32/api/jobapi2/nf-jobapi2-assignprocesstojobobject), the call will fail.</span></span> <span data-ttu-id="d3935-199">Se o processo foi projetado para ser associado a um trabalho específico, essa falha poderá impedir que o processo funcione corretamente.</span><span class="sxs-lookup"><span data-stu-id="d3935-199">If the process was designed to be associated with a specific job, this failure may prevent the process from working properly.</span></span>

 

 
