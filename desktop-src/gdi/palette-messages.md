---
description: As alterações na paleta do sistema para o dispositivo de vídeo podem ter efeitos expressivos e, às vezes, indesejáveis sobre as cores usadas no Windows na área de trabalho.
ms.assetid: 9c470b6f-c0d3-462e-9649-1f39b06bd543
title: Mensagens da paleta
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9f19a5458ec89d8d9a0524fd2ec383de740c0179
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104967625"
---
# <a name="palette-messages"></a><span data-ttu-id="fcfde-103">Mensagens da paleta</span><span class="sxs-lookup"><span data-stu-id="fcfde-103">Palette Messages</span></span>

<span data-ttu-id="fcfde-104">As alterações na paleta do sistema para o dispositivo de vídeo podem ter efeitos expressivos e, às vezes, indesejáveis sobre as cores usadas no Windows na área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="fcfde-104">Changes to the system palette for the display device can have dramatic and sometimes undesirable effects on the colors used in windows on the desktop.</span></span> <span data-ttu-id="fcfde-105">Para minimizar o impacto dessas alterações, o sistema fornece um conjunto de mensagens que ajudam os aplicativos a gerenciar suas paletas lógicas, garantindo que as cores na janela ativa fiquem o mais próximas possível das cores pretendidas.</span><span class="sxs-lookup"><span data-stu-id="fcfde-105">To minimize the impact of these changes, the system provides a set of messages that help applications manage their logical palettes while ensuring that colors in the active window are as close as possible to the colors intended.</span></span>

<span data-ttu-id="fcfde-106">O sistema envia uma mensagem do [**WM \_ QUERYNEWPALETTE**](wm-querynewpalette.md) para uma janela de nível superior ou sobreposto logo antes de ativar a janela.</span><span class="sxs-lookup"><span data-stu-id="fcfde-106">The system sends a [**WM\_QUERYNEWPALETTE**](wm-querynewpalette.md) message to a top-level or overlapped window just before activating the window.</span></span> <span data-ttu-id="fcfde-107">Essa mensagem dá a um aplicativo a oportunidade de selecionar e perceber sua paleta lógica para que ela receba o melhor mapeamento possível de cores para sua paleta lógica.</span><span class="sxs-lookup"><span data-stu-id="fcfde-107">This message gives an application the opportunity to select and realize its logical palette so that it receives the best possible mapping of colors for its logical palette.</span></span> <span data-ttu-id="fcfde-108">Quando o aplicativo recebe a mensagem, ele deve usar as funções [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette), [**unpercebidoobject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject)e [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) para selecionar e perceber a paleta lógica.</span><span class="sxs-lookup"><span data-stu-id="fcfde-108">When the application receives the message, it should use the [**SelectPalette**](/windows/desktop/api/Wingdi/nf-wingdi-selectpalette), [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject), and [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) functions to select and realize the logical palette.</span></span> <span data-ttu-id="fcfde-109">Fazer isso direciona o sistema para atualizar as cores na paleta do sistema para que suas cores correspondam ao máximo de cores na paleta lógica.</span><span class="sxs-lookup"><span data-stu-id="fcfde-109">Doing so directs the system to update colors in the system palette so that its colors match as many colors in the logical palette as possible.</span></span>

<span data-ttu-id="fcfde-110">Quando um aplicativo faz alterações na paleta do sistema como resultado da realização de sua paleta lógica, o sistema envia uma mensagem da [**\_ paleta do WM**](wm-palettechanged.md) para todas as janelas de nível superior e sobreposto.</span><span class="sxs-lookup"><span data-stu-id="fcfde-110">When an application causes changes to the system palette as a result of realizing its logical palette, the system sends a [**WM\_PALETTECHANGED**](wm-palettechanged.md) message to all top-level and overlapped windows.</span></span> <span data-ttu-id="fcfde-111">Essa mensagem dá aos aplicativos a oportunidade de atualizar as cores nas áreas do cliente de suas janelas, substituindo as cores que foram alteradas com cores que correspondem mais às cores pretendidas.</span><span class="sxs-lookup"><span data-stu-id="fcfde-111">This message gives applications the opportunity to update the colors in the client areas of their windows, replacing colors that have changed with colors that more closely match the intended colors.</span></span> <span data-ttu-id="fcfde-112">Um aplicativo que recebe a mensagem de **\_ paletachanged do WM** deve usar [**unpercebeuobject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject) e [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) para redefinir as paletas lógicas associadas a todas as janelas inativas e, em seguida, atualizar as cores na área do cliente para cada janela inativa usando a função [**UpdateColors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) .</span><span class="sxs-lookup"><span data-stu-id="fcfde-112">An application that receives the **WM\_PALETTECHANGED** message should use [**UnrealizeObject**](/windows/desktop/api/Wingdi/nf-wingdi-unrealizeobject) and [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) to reset the logical palettes associated with all inactive windows and then update the colors in the client area for each inactive window by using the [**UpdateColors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) function.</span></span> <span data-ttu-id="fcfde-113">Essa técnica não garante o maior número de correspondências exatas de cor; no entanto, ele garante que as cores na paleta lógica sejam mapeadas para cores razoáveis na paleta do sistema.</span><span class="sxs-lookup"><span data-stu-id="fcfde-113">This technique does not guarantee the greatest number of exact color matches; however, it does ensure that colors in the logical palette are mapped to reasonable colors in the system palette.</span></span>

> [!Note]  
> <span data-ttu-id="fcfde-114">Para evitar a criação de um loop infinito, um aplicativo nunca deve perceber a paleta da janela cujo identificador corresponde ao identificador passado no parâmetro *wParam* da mensagem [**da \_ paleta do WM**](wm-palettechanged.md) .</span><span class="sxs-lookup"><span data-stu-id="fcfde-114">To avoid creating an infinite loop, an application should never realize the palette for the window whose handle matches the handle passed in the *wParam* parameter of the [**WM\_PALETTECHANGED**](wm-palettechanged.md) message.</span></span>

 

<span data-ttu-id="fcfde-115">A função [**UpdateColors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) normalmente atualiza uma área do cliente de uma janela inativa mais rapidamente do que redesenhar a área.</span><span class="sxs-lookup"><span data-stu-id="fcfde-115">The [**UpdateColors**](/windows/desktop/api/Wingdi/nf-wingdi-updatecolors) function typically updates a client area of an inactive window faster than redrawing the area.</span></span> <span data-ttu-id="fcfde-116">No entanto, como **UpdateColors** executa a tradução de cores com base na cor de cada pixel antes da alteração da paleta do sistema, cada chamada para essa função resulta na perda de alguma precisão de cor.</span><span class="sxs-lookup"><span data-stu-id="fcfde-116">However, because **UpdateColors** performs color translation based on the color of each pixel before the system palette changed, each call to this function results in the loss of some color accuracy.</span></span> <span data-ttu-id="fcfde-117">Isso significa que **UpdateColors** não pode ser usado para atualizar cores quando a janela se torna ativa.</span><span class="sxs-lookup"><span data-stu-id="fcfde-117">This means **UpdateColors** cannot be used to update colors when the window becomes active.</span></span> <span data-ttu-id="fcfde-118">Nesses casos, o aplicativo deve redesenhar a área do cliente.</span><span class="sxs-lookup"><span data-stu-id="fcfde-118">In such cases, the application should redraw the client area.</span></span>

<span data-ttu-id="fcfde-119">O sistema pode enviar a mensagem do [**WM \_ QUERYNEWPALETTE**](wm-querynewpalette.md) quando forem feitas alterações na paleta lógica.</span><span class="sxs-lookup"><span data-stu-id="fcfde-119">The system may send the [**WM\_QUERYNEWPALETTE**](wm-querynewpalette.md) message when changes to the logical palette are made.</span></span> <span data-ttu-id="fcfde-120">Além disso, o sistema pode enviar a mensagem do [**WM \_ PALETTEISCHANGING**](wm-paletteischanging.md) para todas as janelas de nível superior e Overlapped quando a paleta do sistema está prestes a ser alterada.</span><span class="sxs-lookup"><span data-stu-id="fcfde-120">Also, the system may send the [**WM\_PALETTEISCHANGING**](wm-paletteischanging.md) message to all top-level and overlapped windows when the system palette is about to change.</span></span>

 

 



