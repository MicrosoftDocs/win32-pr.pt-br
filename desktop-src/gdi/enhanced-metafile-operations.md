---
description: 'Você pode usar o identificador para um metarquivo avançado para realizar as seguintes tarefas:'
ms.assetid: 8f887c38-6cfa-4918-aa44-dd5fb837b40b
title: Operações de metarquivo aprimoradas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 18ba9e2ac2f14c4436c039a66cc3211b471c0461
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104091186"
---
# <a name="enhanced-metafile-operations"></a><span data-ttu-id="9d599-103">Operações de metarquivo aprimoradas</span><span class="sxs-lookup"><span data-stu-id="9d599-103">Enhanced Metafile Operations</span></span>

<span data-ttu-id="9d599-104">Você pode usar o identificador para um metarquivo avançado para realizar as seguintes tarefas:</span><span class="sxs-lookup"><span data-stu-id="9d599-104">You can use the handle to an enhanced metafile to accomplish the following tasks:</span></span>

-   <span data-ttu-id="9d599-105">Exiba a imagem armazenada em um metarquivo avançado.</span><span class="sxs-lookup"><span data-stu-id="9d599-105">Display the picture stored in an enhanced metafile.</span></span>
-   <span data-ttu-id="9d599-106">Crie cópias de um metarquivo avançado.</span><span class="sxs-lookup"><span data-stu-id="9d599-106">Create copies of an enhanced metafile.</span></span>
-   <span data-ttu-id="9d599-107">Edite um metarquivo avançado.</span><span class="sxs-lookup"><span data-stu-id="9d599-107">Edit an enhanced metafile.</span></span>
-   <span data-ttu-id="9d599-108">Recupere a descrição opcional armazenada em um metarquivo avançado.</span><span class="sxs-lookup"><span data-stu-id="9d599-108">Retrieve the optional description stored in an enhanced metafile.</span></span>
-   <span data-ttu-id="9d599-109">Recupere uma cópia de um cabeçalho Enhanced-Metafile.</span><span class="sxs-lookup"><span data-stu-id="9d599-109">Retrieve a copy of an enhanced-metafile header.</span></span>
-   <span data-ttu-id="9d599-110">Recuperar uma versão binária de um metarquivo avançado.</span><span class="sxs-lookup"><span data-stu-id="9d599-110">Retrieve a binary version of an enhanced metafile.</span></span>
-   <span data-ttu-id="9d599-111">Enumere as cores na paleta opcional.</span><span class="sxs-lookup"><span data-stu-id="9d599-111">Enumerate the colors in the optional palette.</span></span>

<span data-ttu-id="9d599-112">Essas tarefas são discutidas nas seções no restante deste tópico.</span><span class="sxs-lookup"><span data-stu-id="9d599-112">These tasks are discussed in the sections in the remainder of this topic.</span></span>

## <a name="display-the-picture-stored-in-an-enhanced-metafile"></a><span data-ttu-id="9d599-113">Exibir a imagem armazenada em um metarquivo avançado</span><span class="sxs-lookup"><span data-stu-id="9d599-113">Display the Picture Stored in an Enhanced Metafile</span></span>

<span data-ttu-id="9d599-114">Você pode exibir a imagem armazenada em um metarquivo avançado usando a função [**PlayEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-playenhmetafile) .</span><span class="sxs-lookup"><span data-stu-id="9d599-114">You can display the picture stored in an enhanced metafile using the [**PlayEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-playenhmetafile) function.</span></span> <span data-ttu-id="9d599-115">Passe a função um identificador para o metarquivo avançado, sem se preocupar com o formato dos registros de metarquivo aprimorados.</span><span class="sxs-lookup"><span data-stu-id="9d599-115">Pass the function a handle to the enhanced metafile, without being concerned with the format of the enhanced metafile records.</span></span> <span data-ttu-id="9d599-116">No entanto, às vezes é desejável enumerar os registros no metarquivo avançado para pesquisar uma função GDI específica e modificar os parâmetros da função de alguma maneira.</span><span class="sxs-lookup"><span data-stu-id="9d599-116">However, it is sometimes desirable to enumerate the records in the enhanced metafile to search for a particular GDI function and modify the parameters of the function in some manner.</span></span> <span data-ttu-id="9d599-117">Para fazer isso, você pode usar [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) e fornecer uma função de retorno de chamada, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), para processar os registros de metarquivo avançados.</span><span class="sxs-lookup"><span data-stu-id="9d599-117">To do this, you can use [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) and provide a callback function, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), to process the enhanced metafile records.</span></span> <span data-ttu-id="9d599-118">Para modificar os parâmetros de um registro de metarquivo avançado, você deve saber o formato dos parâmetros no registro.</span><span class="sxs-lookup"><span data-stu-id="9d599-118">To modify the parameters for an enhanced metafile record, you must know the format of the parameters within the record.</span></span>

## <a name="create-copies-of-an-enhanced-metafile"></a><span data-ttu-id="9d599-119">Criar cópias de um metarquivo avançado</span><span class="sxs-lookup"><span data-stu-id="9d599-119">Create Copies of an Enhanced Metafile</span></span>

<span data-ttu-id="9d599-120">Alguns aplicativos criam cópias de backup temporário (ou duplicadas) de um arquivo antes de permitir que o usuário altere o original.</span><span class="sxs-lookup"><span data-stu-id="9d599-120">Some applications create temporary backup (or duplicate) copies of a file before enabling the user to alter the original.</span></span> <span data-ttu-id="9d599-121">Um aplicativo pode criar uma cópia de backup de um metarquivo avançado chamando a função [**CopyEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-copyenhmetafilea) , fornecendo um identificador que identifica o metarquivo avançado e fornecendo um ponteiro para o nome do novo arquivo.</span><span class="sxs-lookup"><span data-stu-id="9d599-121">An application can create a backup copy of an enhanced metafile by calling the [**CopyEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-copyenhmetafilea) function, supplying a handle that identifies the enhanced metafile, and supplying a pointer to the name of the new file.</span></span>

<span data-ttu-id="9d599-122">Para criar um metarquivo de formato avançado baseado em memória, chame a função [**SetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-setenhmetafilebits) .</span><span class="sxs-lookup"><span data-stu-id="9d599-122">To create a memory-based enhanced-format metafile, call the [**SetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-setenhmetafilebits) function.</span></span>

## <a name="edit-an-enhanced-metafile"></a><span data-ttu-id="9d599-123">Editar um metarquivo avançado</span><span class="sxs-lookup"><span data-stu-id="9d599-123">Edit an Enhanced Metafile</span></span>

<span data-ttu-id="9d599-124">A maioria dos aplicativos de desenho, ilustração e desenvolvimento auxiliado por computador (CAD) exigem um meio de editar uma imagem armazenada em um metarquivo avançado.</span><span class="sxs-lookup"><span data-stu-id="9d599-124">Most drawing, illustration, and computer-aided design (CAD) applications require a means of editing a picture stored in an enhanced metafile.</span></span> <span data-ttu-id="9d599-125">Embora a edição de um metarquivo avançado seja uma tarefa complexa, você pode usar a função [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) em combinação com outras funções para fornecer esse recurso em seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9d599-125">Although editing an enhanced metafile is a complex task, you can use the [**EnumEnhMetaFile**](/windows/desktop/api/Wingdi/nf-wingdi-enumenhmetafile) function in combination with other functions to provide this capability in your application.</span></span> <span data-ttu-id="9d599-126">A função **EnumEnhMetaFile** e sua função de retorno de chamada associada, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), permitem que o aplicativo processe registros individuais em um metarquivo avançado.</span><span class="sxs-lookup"><span data-stu-id="9d599-126">The **EnumEnhMetaFile** function and its associated callback function, [**EnhMetaFileProc**](/windows/win32/api/wingdi/nc-wingdi-enhmfenumproc), enable the application to process individual records in an enhanced metafile.</span></span>

## <a name="retrieve-the-optional-description-stored-in-an-enhanced-metafile"></a><span data-ttu-id="9d599-127">Recuperar a descrição opcional armazenada em um metarquivo avançado</span><span class="sxs-lookup"><span data-stu-id="9d599-127">Retrieve the Optional Description Stored in an Enhanced Metafile</span></span>

<span data-ttu-id="9d599-128">Alguns aplicativos exibem a descrição de texto de um metarquivo avançado com o nome de arquivo correspondente na caixa de diálogo **abrir** .</span><span class="sxs-lookup"><span data-stu-id="9d599-128">Some applications display the text description of an enhanced metafile with the corresponding file name in the **Open** dialog box.</span></span> <span data-ttu-id="9d599-129">Você pode determinar se essa cadeia de caracteres existe em um metarquivo avançado recuperando o cabeçalho do metarquivo com a função [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) e examinando um de seus membros.</span><span class="sxs-lookup"><span data-stu-id="9d599-129">You can determine whether this string exists in an enhanced metafile by retrieving the metafile header with the [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) function and examining one of its members.</span></span> <span data-ttu-id="9d599-130">Se a cadeia de caracteres existir, o aplicativo a recuperará chamando a função [**GetEnhMetaFileDescription**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafiledescriptiona) .</span><span class="sxs-lookup"><span data-stu-id="9d599-130">If the string exists, the application retrieves it by calling the [**GetEnhMetaFileDescription**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafiledescriptiona) function.</span></span>

## <a name="retrieve-a-binary-version-of-an-enhanced-metafile"></a><span data-ttu-id="9d599-131">Recuperar uma versão binária de um metarquivo avançado</span><span class="sxs-lookup"><span data-stu-id="9d599-131">Retrieve a Binary Version of an Enhanced Metafile</span></span>

<span data-ttu-id="9d599-132">Você pode recuperar o conteúdo de um metarquivo chamando a função [**GetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilebits) ; no entanto, antes de recuperar o conteúdo, você deve especificar o tamanho do arquivo.</span><span class="sxs-lookup"><span data-stu-id="9d599-132">You can retrieve the contents of a metafile by calling the [**GetEnhMetaFileBits**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilebits) function; however, before retrieving the contents, you must specify the size of the file.</span></span> <span data-ttu-id="9d599-133">Para obter o tamanho, você pode usar a função [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) e examinar o membro apropriado.</span><span class="sxs-lookup"><span data-stu-id="9d599-133">To get the size, you can use the [**GetEnhMetaFileHeader**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafileheader) function and examine the appropriate member.</span></span>

## <a name="enumerate-the-colors-in-the-optional-palette"></a><span data-ttu-id="9d599-134">Enumerar as cores na paleta opcional</span><span class="sxs-lookup"><span data-stu-id="9d599-134">Enumerate the Colors in the Optional Palette</span></span>

<span data-ttu-id="9d599-135">Para obter cores consistentes quando uma imagem é exibida em vários dispositivos de saída, você pode chamar a função [**CreatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-createpalette) e armazenar uma paleta lógica em um metarquivo avançado.</span><span class="sxs-lookup"><span data-stu-id="9d599-135">To achieve consistent colors when a picture is displayed on various output devices, you can call the [**CreatePalette**](/windows/desktop/api/Wingdi/nf-wingdi-createpalette) function and store a logical palette in an enhanced metafile.</span></span> <span data-ttu-id="9d599-136">Um aplicativo que exibe a imagem armazenada no metarquivo avançado recupera essa paleta e chama a função [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) antes de exibir a imagem.</span><span class="sxs-lookup"><span data-stu-id="9d599-136">An application that displays the picture stored in the enhanced metafile retrieves this palette and calls the [**RealizePalette**](/windows/desktop/api/Wingdi/nf-wingdi-realizepalette) function before displaying the picture.</span></span> <span data-ttu-id="9d599-137">Para determinar se uma paleta é armazenada em um metarquivo avançado, recupere o cabeçalho do metarquivo e examine o membro apropriado.</span><span class="sxs-lookup"><span data-stu-id="9d599-137">To determine whether a palette is stored in an enhanced metafile, retrieve the metafile header and examine the appropriate member.</span></span> <span data-ttu-id="9d599-138">Se houver uma paleta, você poderá chamar a função [**GetEnhMetaFilePaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilepaletteentries) para recuperar a paleta lógica.</span><span class="sxs-lookup"><span data-stu-id="9d599-138">If a palette exists, you can call the [**GetEnhMetaFilePaletteEntries**](/windows/desktop/api/Wingdi/nf-wingdi-getenhmetafilepaletteentries) function to retrieve the logical palette.</span></span>

 

 
