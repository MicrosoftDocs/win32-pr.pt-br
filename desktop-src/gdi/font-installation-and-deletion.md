---
description: Um aplicativo pode usar uma fonte para desenhar texto somente se essa fonte estiver residente em um dispositivo especificado ou instalado na tabela de fontes do sistema.
ms.assetid: b422b981-8760-4484-9965-f212287c421e
title: Instalação e exclusão de fontes
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0184054973c769462ed8c1620e5534ff909576ca
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104988818"
---
# <a name="font-installation-and-deletion"></a><span data-ttu-id="a569c-103">Instalação e exclusão de fontes</span><span class="sxs-lookup"><span data-stu-id="a569c-103">Font Installation and Deletion</span></span>

<span data-ttu-id="a569c-104">Um aplicativo pode usar uma fonte para desenhar texto somente se essa fonte estiver residente em um dispositivo especificado ou instalado na tabela de fontes do sistema.</span><span class="sxs-lookup"><span data-stu-id="a569c-104">An application can use a font to draw text only if that font is either resident on a specified device or installed in the system font table.</span></span> <span data-ttu-id="a569c-105">A tabela de fontes é uma matriz interna que identifica todas as fontes que não são do dispositivo que estão disponíveis para um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a569c-105">The font table is an internal array that identifies all nondevice fonts that are available to an application.</span></span> <span data-ttu-id="a569c-106">Um aplicativo pode recuperar os nomes das fontes atualmente instaladas em um dispositivo ou armazenadas na tabela de fontes internas chamando as funções [**EnumFontFamilies**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa) ou [**ChooseFont**](/previous-versions/windows/desktop/legacy/ms646914(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="a569c-106">An application can retrieve the names of fonts currently installed on a device or stored in the internal font table by calling the [**EnumFontFamilies**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa) or [**ChooseFont**](/previous-versions/windows/desktop/legacy/ms646914(v=vs.85)) functions.</span></span>

<span data-ttu-id="a569c-107">Para instalar uma fonte temporariamente, chame [**AddFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourcea) ou [**AddFontResourceEx**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourceexa).</span><span class="sxs-lookup"><span data-stu-id="a569c-107">To temporarily install a font, call [**AddFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourcea) or [**AddFontResourceEx**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourceexa).</span></span> <span data-ttu-id="a569c-108">Essas funções carregam uma fonte que é armazenada em um arquivo de recurso de fonte.</span><span class="sxs-lookup"><span data-stu-id="a569c-108">These functions load a font that is stored in a font-resource file.</span></span> <span data-ttu-id="a569c-109">No entanto, essa é uma instalação temporária porque, após uma reinicialização, a fonte não estará presente.</span><span class="sxs-lookup"><span data-stu-id="a569c-109">However, this is a temporary installation because after a reboot the font will not be present.</span></span>

<span data-ttu-id="a569c-110">Para instalar uma fonte que permanecerá após a reinicialização do sistema, use um dos seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="a569c-110">To install a font that will remain after the system is rebooted, use one of the following methods:</span></span>

-   <span data-ttu-id="a569c-111">Vá para o painel de controle, clique no ícone **fontes** e selecione **instalar novas fontes** no menu **arquivo** .</span><span class="sxs-lookup"><span data-stu-id="a569c-111">Go to the Control Panel, click the **Fonts** icon, and select **Install New Fonts** from the **File** menu.</span></span> <span data-ttu-id="a569c-112">A fonte está disponível para um aplicativo mesmo antes da reinicialização.</span><span class="sxs-lookup"><span data-stu-id="a569c-112">The font is available to an application even before the reboot.</span></span> <span data-ttu-id="a569c-113">No entanto, em uma situação de servidor de terminal, a fonte está disponível para a sessão atual, mas não está disponível para outras sessões até após uma reinicialização.</span><span class="sxs-lookup"><span data-stu-id="a569c-113">However, in a terminal server situation the font is available for the current session but is not available for other sessions until after a reboot.</span></span>
-   <span data-ttu-id="a569c-114">Copie a fonte na pasta% windir% \\ fonts.</span><span class="sxs-lookup"><span data-stu-id="a569c-114">Copy the font into the %windir%\\fonts folder.</span></span> <span data-ttu-id="a569c-115">Em seguida, vá para o painel de controle e clique no ícone **fontes** ou chame [**AddFontResource**](/windows/win32/api/wingdi/nf-wingdi-addfontresourcea) ou [**AddFontResourceEx**](/windows/win32/api/wingdi/nf-wingdi-addfontresourceexa).</span><span class="sxs-lookup"><span data-stu-id="a569c-115">Then, either go to the Control Panel and click the **Fonts** icon, or call [**AddFontResource**](/windows/win32/api/wingdi/nf-wingdi-addfontresourcea) or [**AddFontResourceEx**](/windows/win32/api/wingdi/nf-wingdi-addfontresourceexa).</span></span> <span data-ttu-id="a569c-116">A fonte está disponível para um aplicativo mesmo antes da reinicialização.</span><span class="sxs-lookup"><span data-stu-id="a569c-116">The font is available to an application even before the reboot.</span></span> <span data-ttu-id="a569c-117">No entanto, em uma situação de servidor de terminal, a fonte está disponível para a sessão atual, mas não está disponível para outras sessões até após uma reinicialização.</span><span class="sxs-lookup"><span data-stu-id="a569c-117">However, in a terminal server situation the font is available for the current session but is not available for other sessions until after a reboot.</span></span> <span data-ttu-id="a569c-118">Se você copiar apenas a fonte na pasta% windir% \\ fonts, a fonte estará disponível somente depois que o sistema for reinicializado.</span><span class="sxs-lookup"><span data-stu-id="a569c-118">If you only copy the font into the %windir%\\fonts folder, the font will be available only after the system is rebooted.</span></span>

<span data-ttu-id="a569c-119">Quando um aplicativo termina de usar uma fonte instalada, ele deve remover essa fonte chamando a função [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) .</span><span class="sxs-lookup"><span data-stu-id="a569c-119">When an application finishes using an installed font, it must remove that font by calling the [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) function.</span></span>

<span data-ttu-id="a569c-120">Uma fonte instalada a partir de um local diferente da pasta% windir% \\ fonts não pode ser modificada quando carregada em qualquer sessão ativa, incluindo a sessão 0.</span><span class="sxs-lookup"><span data-stu-id="a569c-120">A font installed from a location other than the %windir%\\fonts folder cannot be modified when loaded in any active session, including session 0.</span></span> <span data-ttu-id="a569c-121">Qualquer tentativa de alterar, substituir ou excluir, portanto, será bloqueada.</span><span class="sxs-lookup"><span data-stu-id="a569c-121">Any attempt to change, replace, or delete will, therefore, be blocked.</span></span> <span data-ttu-id="a569c-122">Se a modificação para uma fonte for necessária:</span><span class="sxs-lookup"><span data-stu-id="a569c-122">If modification to a font is necessary:</span></span>

-   <span data-ttu-id="a569c-123">*Fontes temporárias* são carregadas apenas na sessão atual.</span><span class="sxs-lookup"><span data-stu-id="a569c-123">*Temporary fonts* get loaded only in the current session.</span></span> <span data-ttu-id="a569c-124">Antes de tentar qualquer modificação de fonte, chame [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) para forçar a sessão atual a descarregar a fonte.</span><span class="sxs-lookup"><span data-stu-id="a569c-124">Before attempting any font modifications, call [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) to force the current session to unload the font.</span></span>
-   <span data-ttu-id="a569c-125">As *fontes permanentes* permanecem instaladas após a reinicialização e são carregadas por todas as sessões criadas.</span><span class="sxs-lookup"><span data-stu-id="a569c-125">*Permanent fonts* remain installed after reboot and are loaded by all created sessions.</span></span> <span data-ttu-id="a569c-126">Chame [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) para forçar a sessão atual a descarregar a fonte.</span><span class="sxs-lookup"><span data-stu-id="a569c-126">Call [**RemoveFontResource**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) to force the current session to unload the font.</span></span> <span data-ttu-id="a569c-127">Em seguida, na chave do registro da fonte (**HKEY \_ local \_ Machine \\ software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ fonts**), localize e remova o valor do registro associado à fonte.</span><span class="sxs-lookup"><span data-stu-id="a569c-127">Then, in the font registry key (**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Fonts**) find and remove the registry value associated with the font.</span></span> <span data-ttu-id="a569c-128">Por fim, reinicialize o computador para garantir que a fonte não seja carregada em nenhuma sessão.</span><span class="sxs-lookup"><span data-stu-id="a569c-128">Finally, reboot the machine to ensure the font isn't loaded in any session.</span></span> <span data-ttu-id="a569c-129">Após a reinicialização, continue com sua modificação/exclusão de fonte.</span><span class="sxs-lookup"><span data-stu-id="a569c-129">After reboot, proceed with your font modification/deletion.</span></span>

<span data-ttu-id="a569c-130">Sempre que um aplicativo chama as funções que adicionam e excluem recursos de fonte, ele também deve chamar a função [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) e enviar uma mensagem do [**WM \_ FONTCHANGE**](wm-fontchange.md) para todas as janelas de nível superior no sistema.</span><span class="sxs-lookup"><span data-stu-id="a569c-130">Whenever an application calls the functions that add and delete font resources, it should also call the [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) function and send a [**WM\_FONTCHANGE**](wm-fontchange.md) message to all top-level windows in the system.</span></span> <span data-ttu-id="a569c-131">Essa mensagem notifica outros aplicativos de que a tabela de fontes interna foi alterada por um aplicativo que adicionou ou removeu uma fonte.</span><span class="sxs-lookup"><span data-stu-id="a569c-131">This message notifies other applications that the internal font table has been altered by an application that added or removed a font.</span></span>

 

 
