---
description: Toda a memória que um processo aloca usando as funções de alocação de memória (HeapAlloc, VirtualAlloc, GlobalAlloc ou LocalAlloc) é acessível somente para o processo.
ms.assetid: b47200dc-6824-4fd8-8d9f-2aaa439a74ff
title: Escopo da memória alocada
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8d2db67a04c019683e737d0f9c581ce8d16b800
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104164637"
---
# <a name="scope-of-allocated-memory"></a><span data-ttu-id="d0d23-103">Escopo da memória alocada</span><span class="sxs-lookup"><span data-stu-id="d0d23-103">Scope of Allocated Memory</span></span>

<span data-ttu-id="d0d23-104">Toda a memória que um processo aloca usando as funções de alocação de memória ( [**HeapAlloc**](/windows/desktop/api/HeapApi/nf-heapapi-heapalloc), [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc), [**GlobalAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalalloc)ou [**LocalAlloc**](/windows/desktop/api/WinBase/nf-winbase-localalloc)) é acessível somente para o processo.</span><span class="sxs-lookup"><span data-stu-id="d0d23-104">All memory a process allocates by using the memory allocation functions ( [**HeapAlloc**](/windows/desktop/api/HeapApi/nf-heapapi-heapalloc), [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc), [**GlobalAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalalloc), or [**LocalAlloc**](/windows/desktop/api/WinBase/nf-winbase-localalloc)) is accessible only to the process.</span></span> <span data-ttu-id="d0d23-105">No entanto, a memória alocada por uma DLL é alocada no espaço de endereço do processo que chamou a DLL e não pode ser acessada por outros processos usando a mesma DLL.</span><span class="sxs-lookup"><span data-stu-id="d0d23-105">However, memory allocated by a DLL is allocated in the address space of the process that called the DLL and is not accessible to other processes using the same DLL.</span></span> <span data-ttu-id="d0d23-106">Para criar a memória compartilhada, você deve usar o mapeamento de arquivo.</span><span class="sxs-lookup"><span data-stu-id="d0d23-106">To create shared memory, you must use file mapping.</span></span>

<span data-ttu-id="d0d23-107">O mapeamento de arquivo nomeado fornece uma maneira fácil de criar um bloco de memória compartilhada.</span><span class="sxs-lookup"><span data-stu-id="d0d23-107">Named file mapping provides an easy way to create a block of shared memory.</span></span> <span data-ttu-id="d0d23-108">Um processo pode especificar um nome quando ele usa a função [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) para criar um objeto de mapeamento de arquivo.</span><span class="sxs-lookup"><span data-stu-id="d0d23-108">A process can specify a name when it uses the [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) function to create a file-mapping object.</span></span> <span data-ttu-id="d0d23-109">Outros processos podem especificar o mesmo nome para a função **CreateFileMapping** ou [**OpenFileMapping**](/windows/desktop/api/WinBase/nf-winbase-openfilemappinga) para obter um identificador para o objeto de mapeamento.</span><span class="sxs-lookup"><span data-stu-id="d0d23-109">Other processes can specify the same name to either the **CreateFileMapping** or [**OpenFileMapping**](/windows/desktop/api/WinBase/nf-winbase-openfilemappinga) function to obtain a handle to the mapping object.</span></span>

<span data-ttu-id="d0d23-110">Cada processo especifica seu identificador para o objeto de mapeamento de arquivo na função [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) para mapear uma exibição do arquivo para seu próprio espaço de endereço.</span><span class="sxs-lookup"><span data-stu-id="d0d23-110">Each process specifies its handle to the file-mapping object in the [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) function to map a view of the file into its own address space.</span></span> <span data-ttu-id="d0d23-111">As exibições de todos os processos para um único objeto de mapeamento de arquivo são mapeadas para as mesmas páginas compartilháveis do armazenamento físico.</span><span class="sxs-lookup"><span data-stu-id="d0d23-111">The views of all processes for a single file-mapping object are mapped into the same sharable pages of physical storage.</span></span> <span data-ttu-id="d0d23-112">No entanto, os endereços virtuais das exibições mapeadas podem variar de um processo para outro, a menos que a função [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) seja usada para mapear a exibição em um endereço especificado.</span><span class="sxs-lookup"><span data-stu-id="d0d23-112">However, the virtual addresses of the mapped views can vary from one process to another, unless the [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) function is used to map the view at a specified address.</span></span> <span data-ttu-id="d0d23-113">Embora compartilháveis, as páginas de armazenamento físico usadas para uma exibição de arquivo mapeada não são globais; Eles não podem ser acessados por processos que não mapearam uma exibição do arquivo.</span><span class="sxs-lookup"><span data-stu-id="d0d23-113">Although sharable, the pages of physical storage used for a mapped file view are not global; they are not accessible to processes that have not mapped a view of the file.</span></span>

<span data-ttu-id="d0d23-114">Todas as páginas confirmadas por meio do mapeamento de uma exibição de um arquivo são liberadas quando o último processo com uma exibição do objeto de mapeamento termina ou desmapeia sua exibição chamando a função [**UnmapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-unmapviewoffile) .</span><span class="sxs-lookup"><span data-stu-id="d0d23-114">Any pages committed by mapping a view of a file are released when the last process with a view of the mapping object either terminates or unmaps its view by calling the [**UnmapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-unmapviewoffile) function.</span></span> <span data-ttu-id="d0d23-115">Neste momento, o arquivo especificado (se houver) associado ao objeto de mapeamento é atualizado.</span><span class="sxs-lookup"><span data-stu-id="d0d23-115">At this time, the specified file (if any) associated with the mapping object is updated.</span></span> <span data-ttu-id="d0d23-116">Um arquivo especificado também pode ser forçado a Atualizar chamando a função [**FlushViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-flushviewoffile) .</span><span class="sxs-lookup"><span data-stu-id="d0d23-116">A specified file can also be forced to update by calling the [**FlushViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-flushviewoffile) function.</span></span>

<span data-ttu-id="d0d23-117">Para obter mais informações, consulte [mapeamento de arquivo](file-mapping.md).</span><span class="sxs-lookup"><span data-stu-id="d0d23-117">For more information, see [File Mapping](file-mapping.md).</span></span> <span data-ttu-id="d0d23-118">Para obter um exemplo de memória compartilhada em uma DLL, consulte [usando a memória compartilhada em uma biblioteca de Dynamic-Link](../dlls/using-shared-memory-in-a-dynamic-link-library.md).</span><span class="sxs-lookup"><span data-stu-id="d0d23-118">For an example of shared memory in a DLL, see [Using Shared Memory in a Dynamic-Link Library](../dlls/using-shared-memory-in-a-dynamic-link-library.md).</span></span>

<span data-ttu-id="d0d23-119">Se vários processos tiverem acesso de gravação à memória compartilhada, você deverá sincronizar o acesso à memória.</span><span class="sxs-lookup"><span data-stu-id="d0d23-119">If multiple processes have write access to shared memory, you must synchronize access to the memory.</span></span> <span data-ttu-id="d0d23-120">Para obter mais informações, consulte [sincronização](../sync/synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="d0d23-120">For more information, see [Synchronization](../sync/synchronization.md).</span></span>

 

 
