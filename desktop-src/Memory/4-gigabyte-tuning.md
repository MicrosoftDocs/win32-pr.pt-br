---
description: 'Ajuste de 4 gigabytes: BCDEdit e Boot.ini'
ms.assetid: 991eb86f-9e6f-4084-8b6f-f979e42104b5
title: 'Ajuste de 4 gigabytes: BCDEdit e Boot.ini'
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f997ae09748370d5ec8ec246da80b6440d7aaf45
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104169402"
---
# <a name="4-gigabyte-tuning-bcdedit-and-bootini"></a><span data-ttu-id="207bd-103">Ajuste de 4 gigabytes: BCDEdit e Boot.ini</span><span class="sxs-lookup"><span data-stu-id="207bd-103">4-Gigabyte Tuning: BCDEdit and Boot.ini</span></span>

<span data-ttu-id="207bd-104">Nas edições de 32 bits do Windows, os aplicativos têm 4 gigabytes (GB) de espaço de endereço virtual disponíveis.</span><span class="sxs-lookup"><span data-stu-id="207bd-104">On 32-bit editions of Windows, applications have 4 gigabyte (GB) of virtual address space available.</span></span> <span data-ttu-id="207bd-105">O espaço de endereço virtual é dividido para que 2 GB estejam disponíveis para o aplicativo e os outros 2 GB estejam disponíveis apenas para o sistema.</span><span class="sxs-lookup"><span data-stu-id="207bd-105">The virtual address space is divided so that 2 GB is available to the application and the other 2 GB is available only to the system.</span></span> <span data-ttu-id="207bd-106">O recurso de ajuste de 4 gigabytes (ajuste de RAM 4GT ou 4GT), habilitado com o comando *bcdedit/set IncreaseUserVa* , aumenta o espaço de endereço virtual disponível para o aplicativo de até 3 GB e reduz a quantidade disponível para o sistema entre 1 e 2 GB.</span><span class="sxs-lookup"><span data-stu-id="207bd-106">The 4-gigabyte tuning (4GT or 4GT RAM Tuning) feature, enabled with the *BCDEdit /set increaseuserva* command, increases the virtual address space that is available to the application up to 3 GB, and reduces the amount available to the system to between 1 and 2 GB.</span></span>

<span data-ttu-id="207bd-107">Para aplicativos com uso intensivo de memória, como sistemas de gerenciamento de banco de dados (DBMS), o uso de um espaço de endereço virtual maior pode fornecer benefícios consideráveis de desempenho e escalabilidade.</span><span class="sxs-lookup"><span data-stu-id="207bd-107">For applications that are memory-intensive, such as database management systems (DBMS), the use of a larger virtual address space can provide considerable performance and scalability benefits.</span></span> <span data-ttu-id="207bd-108">No entanto, o cache de arquivos, o pool paginável e o pool não-paginável são menores, o que pode afetar negativamente os aplicativos com redes pesadas ou e/s.</span><span class="sxs-lookup"><span data-stu-id="207bd-108">However, the file cache, paged pool, and nonpaged pool are smaller, which can adversely affect applications with heavy networking or I/O.</span></span> <span data-ttu-id="207bd-109">Portanto, talvez você queira testar seu aplicativo sob carga e examinar os contadores de desempenho para determinar se o aplicativo se beneficia do espaço de endereço maior.</span><span class="sxs-lookup"><span data-stu-id="207bd-109">Therefore, you might want to test your application under load, and examine the performance counters to determine whether your application benefits from the larger address space.</span></span>

<span data-ttu-id="207bd-110">Para habilitar 4GT, use o comando [bcdedit/set](/windows-hardware/drivers/devtest/bcdedit--set) para definir a opção de entrada de inicialização **IncreaseUserVa** com um valor entre 2048 (2 GB) e 3072 (3 GB).</span><span class="sxs-lookup"><span data-stu-id="207bd-110">To enable 4GT, use the [BCDEdit /set](/windows-hardware/drivers/devtest/bcdedit--set) command to set the **increaseuserva** boot entry option to a value between 2048 (2 GB) and 3072 (3 GB).</span></span>

<span data-ttu-id="207bd-111">**Windows Server 2003 e anterior:** Para habilitar 4GT, adicione a opção **/3GB** ao arquivo de Boot.ini.</span><span class="sxs-lookup"><span data-stu-id="207bd-111">**Windows Server 2003 and earlier:** To enable 4GT, add the **/3GB** switch to the Boot.ini file.</span></span> <span data-ttu-id="207bd-112">A opção **/3GB** tem suporte nos seguintes sistemas:</span><span class="sxs-lookup"><span data-stu-id="207bd-112">The **/3GB** switch is supported on the following systems:</span></span>

-   <span data-ttu-id="207bd-113">Windows Server 2003</span><span class="sxs-lookup"><span data-stu-id="207bd-113">Windows Server 2003</span></span>
-   <span data-ttu-id="207bd-114">Windows XP Professional</span><span class="sxs-lookup"><span data-stu-id="207bd-114">Windows XP Professional</span></span>

<span data-ttu-id="207bd-115">A opção **/3GB** torna um total de 3 GB de espaço de endereço virtual disponível para aplicativos e reduz a quantidade disponível para o sistema para 1 GB.</span><span class="sxs-lookup"><span data-stu-id="207bd-115">The **/3GB** switch makes a full 3 GB of virtual address space available to applications and reduces the amount available to the system to 1 GB.</span></span> <span data-ttu-id="207bd-116">No Windows Server 2003, a quantidade de espaço de endereço disponível para os aplicativos pode ser ajustada definindo a opção **/USERVA** no Boot.ini como um valor entre 2048 e 3072, o que aumenta a quantidade de espaço de endereço disponível para o sistema.</span><span class="sxs-lookup"><span data-stu-id="207bd-116">On Windows Server 2003, the amount of address space available to applications can be adjusted by setting the **/USERVA** switch in Boot.ini to a value between 2048 and 3072, which increases the amount of address space available to the system.</span></span> <span data-ttu-id="207bd-117">Isso pode ajudar a manter o desempenho geral do sistema quando o aplicativo requer mais de 2 GB, mas menos de 3 GB de espaço de endereço.</span><span class="sxs-lookup"><span data-stu-id="207bd-117">This can help maintain overall system performance when the application requires more than 2 GB but less than 3 GB of address space.</span></span>

<span data-ttu-id="207bd-118">Para permitir que um aplicativo use o espaço de endereço maior, defina o sinalizador de [**\_ \_ \_ \_ reconhecimento de endereço grande do arquivo de imagem**](/windows/desktop/api/dbghelp/ns-dbghelp-loaded_image) no cabeçalho da imagem.</span><span class="sxs-lookup"><span data-stu-id="207bd-118">To enable an application to use the larger address space, set the [**IMAGE\_FILE\_LARGE\_ADDRESS\_AWARE**](/windows/desktop/api/dbghelp/ns-dbghelp-loaded_image) flag in the image header.</span></span> <span data-ttu-id="207bd-119">O vinculador incluído com Microsoft Visual C++ dá suporte à opção **/LARGEADDRESSAWARE** para definir esse sinalizador.</span><span class="sxs-lookup"><span data-stu-id="207bd-119">The linker included with Microsoft Visual C++ supports the **/LARGEADDRESSAWARE** switch to set this flag.</span></span> <span data-ttu-id="207bd-120">Definir esse sinalizador e, em seguida, executar o aplicativo em um sistema que não tem suporte 4GT não deve afetar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="207bd-120">Setting this flag and then running the application on a system that does not have 4GT support should not affect the application.</span></span>

<span data-ttu-id="207bd-121">Nas edições de 64 bits do Windows, os aplicativos de 32 bits marcados com o sinalizador de [**\_ \_ \_ \_ reconhecimento de endereço grande de arquivo de imagem**](/windows/desktop/api/dbghelp/ns-dbghelp-loaded_image) têm 4 GB de espaço de endereço disponível.</span><span class="sxs-lookup"><span data-stu-id="207bd-121">On 64-bit editions of Windows, 32-bit applications marked with the [**IMAGE\_FILE\_LARGE\_ADDRESS\_AWARE**](/windows/desktop/api/dbghelp/ns-dbghelp-loaded_image) flag have 4 GB of address space available.</span></span>

<span data-ttu-id="207bd-122">**Edições do Windows Server 2003 no Itanium:** Antes do SP1, os processos de 32 bits têm apenas 2 GB de espaço de endereço disponível.</span><span class="sxs-lookup"><span data-stu-id="207bd-122">**Itanium editions of Windows Server 2003:** Prior to SP1, 32-bit processes have only 2 GB of address space available.</span></span>

<span data-ttu-id="207bd-123">Use as diretrizes a seguir para dar suporte a 4GT em aplicativos:</span><span class="sxs-lookup"><span data-stu-id="207bd-123">Use the following guidelines to support 4GT in applications:</span></span>

-   <span data-ttu-id="207bd-124">Os endereços próximos ao limite de 2 GB são normalmente usados por várias DLLs do sistema.</span><span class="sxs-lookup"><span data-stu-id="207bd-124">Addresses near the 2-GB boundary are typically used by various system DLLs.</span></span> <span data-ttu-id="207bd-125">Portanto, um processo de 32 bits não pode alocar mais de 2 GB de memória contígua, mesmo que todo o espaço de endereço de 4 GB esteja disponível.</span><span class="sxs-lookup"><span data-stu-id="207bd-125">Therefore, a 32-bit process cannot allocate more than 2 GB of contiguous memory, even if the entire 4-GB address space is available.</span></span>
-   <span data-ttu-id="207bd-126">Para recuperar a quantidade total de espaço virtual do usuário, use a função [**GlobalMemoryStatusEx**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-globalmemorystatusex) .</span><span class="sxs-lookup"><span data-stu-id="207bd-126">To retrieve the amount of total user virtual space, use the [**GlobalMemoryStatusEx**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-globalmemorystatusex) function.</span></span> <span data-ttu-id="207bd-127">Para recuperar o endereço de usuário mais alto possível, use a função [**GetSystemInfo**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) .</span><span class="sxs-lookup"><span data-stu-id="207bd-127">To retrieve the highest possible user address, use the [**GetSystemInfo**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsysteminfo) function.</span></span> <span data-ttu-id="207bd-128">Sempre detecte o valor real em tempo de execução e evite usar definições de constantes com fio físicas, como: `#define HIGHEST_USER_ADDRESS 0xC0000000` .</span><span class="sxs-lookup"><span data-stu-id="207bd-128">Always detect the real value at runtime, and avoid using hard-wired constant definitions such as: `#define HIGHEST_USER_ADDRESS 0xC0000000`.</span></span>
-   <span data-ttu-id="207bd-129">Evite comparações assinadas com ponteiros, pois elas podem fazer com que os aplicativos falhem em um sistema habilitado para 4GT.</span><span class="sxs-lookup"><span data-stu-id="207bd-129">Avoid signed comparisons with pointers, because they might cause applications to crash on a 4GT-enabled system.</span></span> <span data-ttu-id="207bd-130">Uma condição como a seguinte é falsa para um ponteiro que está acima de 2 GB: `if (pointer > 40000000)` .</span><span class="sxs-lookup"><span data-stu-id="207bd-130">A condition such as the following is false for a pointer that is above 2 GB: `if (pointer > 40000000)`.</span></span>
-   <span data-ttu-id="207bd-131">O código que usa o maior bit de um ponteiro para uma finalidade definida pelo aplicativo falhará quando 4GT estiver habilitado.</span><span class="sxs-lookup"><span data-stu-id="207bd-131">Code that uses the highest bit of a pointer for an application-defined purpose will fail when 4GT is enabled.</span></span> <span data-ttu-id="207bd-132">Por exemplo, uma palavra de 32 bits pode ser considerada um endereço de modo de usuário se estiver abaixo de 0x80000000, e um código de erro, se acima.</span><span class="sxs-lookup"><span data-stu-id="207bd-132">For example, a 32-bit word might be considered a user-mode address if it is below 0x80000000, and an error code if above.</span></span> <span data-ttu-id="207bd-133">Isso não é verdadeiro com 4GT.</span><span class="sxs-lookup"><span data-stu-id="207bd-133">This is not true with 4GT.</span></span>

<span data-ttu-id="207bd-134">O [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) geralmente retorna endereços baixos antes dos endereços altos.</span><span class="sxs-lookup"><span data-stu-id="207bd-134">[**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) usually returns low addresses before high addresses.</span></span> <span data-ttu-id="207bd-135">Portanto, o processo não pode usar endereços muito altos, a menos que ele aloque muita memória ou tenha um espaço de endereço virtual fragmentado.</span><span class="sxs-lookup"><span data-stu-id="207bd-135">Therefore, your process may not use very high addresses unless it allocates a lot of memory or has a fragmented virtual address space.</span></span> <span data-ttu-id="207bd-136">Para forçar alocações a alocar de endereços mais altos antes de endereços inferiores para fins de teste, especifique a **\_ parte superior \_ do mem** ao chamar o **VirtualAlloc** ou defina o seguinte valor de registro como 0x100000:</span><span class="sxs-lookup"><span data-stu-id="207bd-136">To force allocations to allocate from higher addresses before lower addresses for testing purposes, specify **MEM\_TOP\_DOWN** when calling **VirtualAlloc** or set the following registry value to 0x100000:</span></span>

<span data-ttu-id="207bd-137">**HKEY \_ Sistema de \_ máquina local** \\  \\ **CurrentControlSet** \\ **Control** \\ **Session Manager** \\ **Gerenciamento de memória** \\ **AllocationPreference**</span><span class="sxs-lookup"><span data-stu-id="207bd-137">**HKEY\_LOCAL\_MACHINE**\\**System**\\**CurrentControlSet**\\**Control**\\**Session Manager**\\**Memory Management**\\**AllocationPreference**</span></span>

## <a name="related-topics"></a><span data-ttu-id="207bd-138">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="207bd-138">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="207bd-139">Limites de memória para versões do Windows</span><span class="sxs-lookup"><span data-stu-id="207bd-139">Memory Limits for Windows Releases</span></span>](memory-limits-for-windows-releases.md)
</dt> <dt>

[<span data-ttu-id="207bd-140">Extensão de endereço físico</span><span class="sxs-lookup"><span data-stu-id="207bd-140">Physical Address Extension</span></span>](physical-address-extension.md)
</dt> <dt>

<span data-ttu-id="207bd-141">[Referência técnica 4GT](/previous-versions/windows/it-pro/windows-server-2003/cc778496(v=ws.10))</span><span class="sxs-lookup"><span data-stu-id="207bd-141">[4GT Technical Reference](/previous-versions/windows/it-pro/windows-server-2003/cc778496(v=ws.10))</span></span>
</dt> </dl>

 

 
