---
description: O WUA (Windows Update Agent) se atualiza automaticamente quando ele está conectado a um servidor Windows Server Update Services (WSUS) ou a Windows Update.
ms.assetid: 829112ab-b240-4cc4-8053-18b484934886
title: Atualizando o agente de Windows Update
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b00fe439b1bea377e2699f6fe5714b208ac5d951
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105793674"
---
# <a name="updating-windows-update-agent"></a><span data-ttu-id="1ae2f-103">Atualizando o agente de Windows Update</span><span class="sxs-lookup"><span data-stu-id="1ae2f-103">Updating Windows Update Agent</span></span>

<span data-ttu-id="1ae2f-104">O WUA (Windows Update Agent) é atualizado por meio de vários meios, dependendo da versão do Windows em execução no dispositivo.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-104">Windows Update Agent (WUA) updates itself through various means, depending on the version of Windows running on the device.</span></span> <span data-ttu-id="1ae2f-105">Versões antigas do WUA podem não ser capazes de se conectar aos serviços de atualização atuais, podem não ser compatíveis com todas as atualizações e podem não dar suporte a todas as APIs documentadas.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-105">Old versions of WUA may not be able to connect to current update services, may not be compatible with all updates, and may not support all documented APIs.</span></span> <span data-ttu-id="1ae2f-106">Veja como garantir que o WUA seja totalmente atualizado e compatível.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-106">Here is how to insure that WUA is fully updated and compatible.</span></span>

<span data-ttu-id="1ae2f-107">**Nas versões do Windows a partir do Windows 7 e do Windows Server 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="1ae2f-107">**On versions of Windows beginning with Windows 7 and Windows Server 2008 R2**</span></span>

<span data-ttu-id="1ae2f-108">As atualizações do WUA (agente de Windows Update) estão incluídas nas atualizações periódicas regulares para o Windows distribuídas por meio de Windows Update ou Windows Server Update Services (WSUS).</span><span class="sxs-lookup"><span data-stu-id="1ae2f-108">Windows Update Agent (WUA) updates are included in the regular periodic updates to Windows distributed through Windows Update or to Windows Server Update Services (WSUS).</span></span> <span data-ttu-id="1ae2f-109">Você não precisa realizar etapas especiais para atualizar o WUA nessas versões do Windows.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-109">You do not need to take any special steps to update WUA on these Windows versions.</span></span>

<span data-ttu-id="1ae2f-110">**Nas versões do Windows anteriores ao Windows 7 e ao Windows Server 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="1ae2f-110">**On versions of Windows prior to Windows 7 and Windows Server 2008 R2**</span></span>

<span data-ttu-id="1ae2f-111">O WUA é atualizado automaticamente quando Atualizações Automáticas se conecta ao Windows Update ou ao WSUS.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-111">WUA automatically updates itself when Automatic Updates connects to Windows Update or to WSUS.</span></span>

<span data-ttu-id="1ae2f-112">Se Atualizações Automáticas ainda não tiver sido executada com êxito, é possível que um dispositivo que executa essas versões do Windows execute uma versão mais antiga do WUA que não ofereça suporte a todas as APIs documentadas.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-112">If Automatic Updates has not yet successfully run, it is possible that a device running these Windows versions will be running an older version of WUA that does not support all the documented APIs.</span></span> <span data-ttu-id="1ae2f-113">Se você receber um resultado de WU_E_SELFUPDATE_REQUIRED ao usar a API do WUA para executar uma verificação, download ou instalação, esse erro indicará que a versão instalada do WUA é muito antiga para se conectar aos serviços Windows Update atuais.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-113">If you receive a WU_E_SELFUPDATE_REQUIRED result when you use the WUA API to perform a scan, download, or install, this error tells you that the installed version of WUA is too old to connect to current Windows Update services.</span></span> <span data-ttu-id="1ae2f-114">Você não pode usar as APIs do WUA normal para atualizar o WUA nesses sistemas operacionais.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-114">You cannot use the normal WUA APIs to update WUA on these operating systems.</span></span> 

<span data-ttu-id="1ae2f-115">Um usuário pode atualizar o WUA manualmente para uma versão atual abrindo o painel de controle Windows Update, selecionando verificar se há atualizações e, em seguida, aceitando a autoatualização que aparece.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-115">A user can manually update WUA to a current version by opening the Windows Update control panel, selecting Check for Updates, then accepting the self-update that appears.</span></span> <span data-ttu-id="1ae2f-116">Como alternativa, você pode atualizar o WUA programaticamente.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-116">Alternately, you can update WUA programmatically.</span></span>

<span data-ttu-id="1ae2f-117">**Para atualizar o WUA de forma programática em versões do Windows anteriores ao Windows 7 e ao Windows Server 2008 R2**</span><span class="sxs-lookup"><span data-stu-id="1ae2f-117">**To programmatically update WUA on versions of Windows prior to Windows 7 and Windows Server 2008 R2**</span></span>

1.  <span data-ttu-id="1ae2f-118">Use as APIs do [WinHTTP](../winhttp/winhttp-start-page.md) para baixar [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span><span class="sxs-lookup"><span data-stu-id="1ae2f-118">Use the [WinHTTP](../winhttp/winhttp-start-page.md) APIs to download [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span></span>
2.  <span data-ttu-id="1ae2f-119">Use as [funções de criptografia](../seccrypto/cryptography-functions.md) para verificar se a cópia baixada do [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab) tem uma assinatura digital da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-119">Use the [Cryptography Functions](../seccrypto/cryptography-functions.md) to verify that the downloaded copy of [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab) has a digital signature from Microsoft.</span></span> <span data-ttu-id="1ae2f-120">Se você não conseguir verificar a assinatura digital, pare.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-120">If you can't verify the digital signature, stop.</span></span>
3.  <span data-ttu-id="1ae2f-121">Use as APIs da [interface de descompactação de arquivo](../devnotes/cabinet-api-functions.md) para extrair o arquivo XML do [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span><span class="sxs-lookup"><span data-stu-id="1ae2f-121">Use the [File Decompression Interface](../devnotes/cabinet-api-functions.md) APIs to extract the XML file from [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).</span></span>
4.  <span data-ttu-id="1ae2f-122">Use as APIs do Microsoft XML Core Services ([MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85))) para carregar o arquivo XML e localizar o nó WURedist/StandaloneRedist/Architecture para a arquitetura do computador.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-122">Use the Microsoft XML Core Services ([MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85))) APIs to load the XML file and locate the WURedist/StandaloneRedist/architecture node for the computer's architecture.</span></span> <span data-ttu-id="1ae2f-123">Por exemplo, para x86, localize o nó WURedist/StandaloneRedist/Architecture com o atributo **Name** de x86.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-123">For example, for x86, locate the WURedist/StandaloneRedist/architecture node with the **name** attribute of x86.</span></span>
5.  <span data-ttu-id="1ae2f-124">Chame [**IWindowsUpdateAgentInfo:: GetInfo**](/windows/desktop/api/Wuapi/nf-wuapi-iwindowsupdateagentinfo-getinfo) para determinar a versão atual do WUA.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-124">Call [**IWindowsUpdateAgentInfo::GetInfo**](/windows/desktop/api/Wuapi/nf-wuapi-iwindowsupdateagentinfo-getinfo) to determine the current version of WUA.</span></span> <span data-ttu-id="1ae2f-125">Se **IWindowsUpdateAgentInfo:: GetInfo** retornar um número de versão que seja pelo menos tão alto quanto o atributo **clientVersion** no nó de arquitetura que você localizou, pare.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-125">If **IWindowsUpdateAgentInfo::GetInfo** returns a version number that is at least as high as the **clientVersion** attribute in the architecture node you located, stop.</span></span>
6.  <span data-ttu-id="1ae2f-126">Use as APIs do [MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85)) para ler o atributo **DownloadURL** do nó de arquitetura que você localizou.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-126">Use the [MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85)) APIs to read the **downloadUrl** attribute from the architecture node that you located.</span></span> <span data-ttu-id="1ae2f-127">o **DownloadURL** fornece a URL de download para o instalador do WUA apropriado para a arquitetura do computador.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-127">**downloadUrl** gives you the download URL for the appropriate WUA installer for the computer's architecture.</span></span>
7.  <span data-ttu-id="1ae2f-128">Use as APIs do [WinHTTP](../winhttp/winhttp-start-page.md) para baixar o instalador apropriado.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-128">Use the [WinHTTP](../winhttp/winhttp-start-page.md) APIs to download the appropriate installer.</span></span>
8.  <span data-ttu-id="1ae2f-129">Use a função [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) ou uma API semelhante para executar o instalador baixado.</span><span class="sxs-lookup"><span data-stu-id="1ae2f-129">Use the [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) function or a similar API to execute the downloaded installer.</span></span>

 

 
