---
description: Um buffer de profundidade, geralmente chamado de buffer z ou buffer w, é uma propriedade do dispositivo que armazena informações de profundidade a serem usadas pelo Direct3D.
ms.assetid: vs|directx_sdk|~\depth_buffers.htm
title: Buffers de profundidade (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fc1ab41ba98ca5e3b08980ac90a572a19fc8a72a
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104456582"
---
# <a name="depth-buffers-direct3d-9"></a><span data-ttu-id="b9f15-103">Buffers de profundidade (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="b9f15-103">Depth Buffers (Direct3D 9)</span></span>

<span data-ttu-id="b9f15-104">Um buffer de profundidade, geralmente chamado de buffer z ou buffer w, é uma propriedade do dispositivo que armazena informações de profundidade a serem usadas pelo Direct3D.</span><span class="sxs-lookup"><span data-stu-id="b9f15-104">A depth buffer, often called a z-buffer or a w-buffer, is a property of the device that stores depth information to be used by Direct3D.</span></span> <span data-ttu-id="b9f15-105">Quando o Direct3D renderiza uma cena para uma superfície de destino, ele pode usar a memória em uma superfície de buffer de profundidade associado como um espaço de trabalho para determinar como os pixels dos polígonos rasterizados ocultam uns aos outros.</span><span class="sxs-lookup"><span data-stu-id="b9f15-105">When Direct3D renders a scene to a target surface, it can use the memory in an associated depth-buffer surface as a workspace to determine how the pixels of rasterized polygons occlude one another.</span></span> <span data-ttu-id="b9f15-106">O Direct3D usa uma superfície Direct3D fora da tela como o destino no qual os valores de cor finais são gravados.</span><span class="sxs-lookup"><span data-stu-id="b9f15-106">Direct3D uses an off-screen Direct3D surface as the target to which final color values are written.</span></span> <span data-ttu-id="b9f15-107">A superfície de buffer de profundidade que está associada com a superfície de destino de renderização é usada para armazenar informações de profundidade que indicam ao Direct3D qual a profundidade de cada pixel visível na cena.</span><span class="sxs-lookup"><span data-stu-id="b9f15-107">The depth-buffer surface that is associated with the render-target surface is used to store depth information that tells Direct3D how deep each visible pixel is in the scene.</span></span>

<span data-ttu-id="b9f15-108">Quando uma cena é rasterizada com o buffer de profundidade habilitado, cada ponto na superfície de renderização é testado.</span><span class="sxs-lookup"><span data-stu-id="b9f15-108">When a scene is rasterized with depth buffering enabled, each point on the rendering surface is tested.</span></span> <span data-ttu-id="b9f15-109">Os valores no buffer de profundidade podem ser uma coordenada z do ponto ou sua coordenada w homogênea - a partir da localização do ponto (x, y, z, w) no espaço de projeção.</span><span class="sxs-lookup"><span data-stu-id="b9f15-109">The values in the depth buffer can be a point's z-coordinate or its homogeneous w-coordinate - from the point's (x,y,z,w) location in projection space.</span></span> <span data-ttu-id="b9f15-110">Um buffer de profundidade que usa valores z é geralmente chamado de buffer z e um que usa valores w é chamado de buffer w.</span><span class="sxs-lookup"><span data-stu-id="b9f15-110">A depth buffer that uses z values is often called a z-buffer, and one that uses w values is called a w-buffer.</span></span> <span data-ttu-id="b9f15-111">Cada tipo de buffer de profundidade tem vantagens e desvantagens, que são discutidas posteriormente.</span><span class="sxs-lookup"><span data-stu-id="b9f15-111">Each type of depth buffer has advantages and disadvantages, which are discussed later.</span></span>

<span data-ttu-id="b9f15-112">No início do teste, o valor de profundidade no buffer de profundidade é definido como o maior valor possível para a cena.</span><span class="sxs-lookup"><span data-stu-id="b9f15-112">At the beginning of the test, the depth value in the depth buffer is set to the largest possible value for the scene.</span></span> <span data-ttu-id="b9f15-113">O valor de cor na superfície de renderização é definido como o valor de cor de plano de fundo ou o valor da cor da textura em segundo plano nesse ponto.</span><span class="sxs-lookup"><span data-stu-id="b9f15-113">The color value on the rendering surface is set to either the background color value or the color value of the background texture at that point.</span></span> <span data-ttu-id="b9f15-114">Cada polígono na cena é testado para verificar se cruza com a coordenada atual (x, y) na superfície de renderização.</span><span class="sxs-lookup"><span data-stu-id="b9f15-114">Each polygon in the scene is tested to see if it intersects with the current coordinate (x,y) on the rendering surface.</span></span> <span data-ttu-id="b9f15-115">Se tiver, o valor de profundidade, que será a coordenada z em um buffer z, e a coordenada w em um buffer w-no ponto atual será testada para ver se ela é menor do que o valor de profundidade armazenado no buffer de profundidade.</span><span class="sxs-lookup"><span data-stu-id="b9f15-115">If it does, the depth value - which will be the z coordinate in a z-buffer, and the w coordinate in a w-buffer - at the current point is tested to see if it is smaller than the depth value stored in the depth buffer.</span></span> <span data-ttu-id="b9f15-116">Se a profundidade do valor do polígono for menor, ele é armazenado no buffer de profundidade e o valor de cor do polígono é gravado para o ponto atual na superfície de renderização.</span><span class="sxs-lookup"><span data-stu-id="b9f15-116">If the depth of the polygon value is smaller, it is stored in the depth buffer and the color value from the polygon is written to the current point on the rendering surface.</span></span> <span data-ttu-id="b9f15-117">Se o valor de profundidade do polígono nesse ponto for maior, o próximo polígono na lista é testado.</span><span class="sxs-lookup"><span data-stu-id="b9f15-117">If the depth value of the polygon at that point is larger, the next polygon in the list is tested.</span></span> <span data-ttu-id="b9f15-118">Esse processo está ilustrado no diagrama a seguir.</span><span class="sxs-lookup"><span data-stu-id="b9f15-118">This process is shown in the following diagram.</span></span>

![Diagrama de teste de valores de profundidade](images/zbuffer.png)

> [!Note]  
> <span data-ttu-id="b9f15-120">Embora a maioria dos aplicativos não use esse recurso, você pode alterar a comparação que o Direct3D usa para determinar quais valores são colocados no buffer de profundidade e, posteriormente, na superfície de destino de renderização.</span><span class="sxs-lookup"><span data-stu-id="b9f15-120">Although most applications don't use this feature, you can change the comparison that Direct3D uses to determine which values are placed in the depth buffer and subsequently the render-target surface.</span></span> <span data-ttu-id="b9f15-121">Para fazer isso, altere o valor para o \_ estado de RENDERIZAÇÃO D3DRS ZFUNC.</span><span class="sxs-lookup"><span data-stu-id="b9f15-121">To do so, change the value for the D3DRS\_ZFUNC render state.</span></span> <span data-ttu-id="b9f15-122">Em alguns itens de hardware, alterar a função de comparação pode desabilitar o teste z hierárquico.</span><span class="sxs-lookup"><span data-stu-id="b9f15-122">On some hardware, changing the compare function may disable hierarchical z testing.</span></span>

 

<span data-ttu-id="b9f15-123">Praticamente todos os aceleradores do mercado são compatíveis com o buffer z, o que o transforma no tipo mais comum de buffer de profundidade hoje.</span><span class="sxs-lookup"><span data-stu-id="b9f15-123">Nearly all accelerators on the market support z-buffering, making z-buffers the most common type of depth buffer today.</span></span> <span data-ttu-id="b9f15-124">Mesmo onipresentes, os buffers z têm suas desvantagens.</span><span class="sxs-lookup"><span data-stu-id="b9f15-124">However ubiquitous, z-buffers have their drawbacks.</span></span> <span data-ttu-id="b9f15-125">Devido à matemática envolvida, os valores z gerados em um buffer z tendem a não ser distribuídos uniformemente no intervalo do buffer z (normalmente 0,0 a 1,0, inclusive).</span><span class="sxs-lookup"><span data-stu-id="b9f15-125">Due to the mathematics involved, the generated z values in a z-buffer tend not to be distributed evenly across the z-buffer range (typically 0.0 to 1.0, inclusive).</span></span> <span data-ttu-id="b9f15-126">Especificamente, a razão entre os planos de recorte distante e próximo afeta intensamente quanto os valores de z são distribuídos irregularmente.</span><span class="sxs-lookup"><span data-stu-id="b9f15-126">Specifically, the ratio between the far and near clipping planes strongly affects how unevenly z values are distributed.</span></span> <span data-ttu-id="b9f15-127">Usando uma razão de distância do plano distante para o plano próximo de 100, 90% do intervalo do buffer de profundidade são gastos nos primeiros 10% do intervalo de profundidade da cena.</span><span class="sxs-lookup"><span data-stu-id="b9f15-127">Using a far-plane distance to near-plane distance ratio of 100, 90 percent of the depth buffer range is spent on the first 10 percent of the scene depth range.</span></span> <span data-ttu-id="b9f15-128">Os aplicativos típicos para diversão ou simulações visuais com cenas exteriores geralmente exigem razões de plano distante/plano próximo em algum ponto entre 1.000 e 10.000.</span><span class="sxs-lookup"><span data-stu-id="b9f15-128">Typical applications for entertainment or visual simulations with exterior scenes often require far-plane/near-plane ratios of anywhere between 1,000 to 10,000.</span></span> <span data-ttu-id="b9f15-129">Em uma razão de 1.000, 98% do intervalo são gastos nos primeiros 2% do intervalo de profundidade, e a distribuição fica pior com razões maiores.</span><span class="sxs-lookup"><span data-stu-id="b9f15-129">At a ratio of 1,000, 98 percent of the range is spent on the first 2 percent of the depth range, and the distribution becomes worse with higher ratios.</span></span> <span data-ttu-id="b9f15-130">Isso pode causar artefatos de superfície ocultos em objetos distantes, especialmente ao usar buffers de profundidade de 16 bits, a profundidade de bits mais comumente compatível.</span><span class="sxs-lookup"><span data-stu-id="b9f15-130">This can cause hidden surface artifacts in distant objects, especially when using 16-bit depth buffers, the most commonly supported bit-depth.</span></span>

<span data-ttu-id="b9f15-131">Um buffer de profundidade com base w, por outro lado, costuma ser distribuído mais uniformemente entre os planos de recorte próximo e distante do que um buffer z.</span><span class="sxs-lookup"><span data-stu-id="b9f15-131">A w-based depth buffer, on the other hand, is often more evenly distributed between the near and far clip planes than a z-buffer.</span></span> <span data-ttu-id="b9f15-132">O principal benefício é que a razão de distâncias para os planos de recorte distante e próximo não é mais um problema.</span><span class="sxs-lookup"><span data-stu-id="b9f15-132">The key benefit is that the ratio of distances for the far and near clipping planes is no longer an issue.</span></span> <span data-ttu-id="b9f15-133">Isso permite que os aplicativos sejam compatíveis com intervalos máximos grandes, ao mesmo tempo que ainda obtêm buffer de profundidade relativamente preciso perto do ponto ocular.</span><span class="sxs-lookup"><span data-stu-id="b9f15-133">This allows applications to support large maximum ranges, while still getting relatively accurate depth buffering close to the eye point.</span></span> <span data-ttu-id="b9f15-134">Um buffer de profundidade com base w não é perfeito e, às vezes, pode apresentar artefatos de superfície ocultos para objetos próximos.</span><span class="sxs-lookup"><span data-stu-id="b9f15-134">A w-based depth buffer isn't perfect, and can sometimes exhibit hidden surface artifacts for near objects.</span></span> <span data-ttu-id="b9f15-135">Outra desvantagem na abordagem de buffer w está relacionada ao suporte de hardware: o buffer w não é tão amplamente compatível com itens de hardware como o buffer z.</span><span class="sxs-lookup"><span data-stu-id="b9f15-135">Another drawback to the w-buffered approach is related to hardware support: w-buffering isn't supported as widely in hardware as z-buffering.</span></span>

<span data-ttu-id="b9f15-136">O uso de um buffer z requer sobrecarga durante a renderização.</span><span class="sxs-lookup"><span data-stu-id="b9f15-136">Using a z-buffer requires overhead during rendering.</span></span> <span data-ttu-id="b9f15-137">Várias técnicas podem ser usadas para otimizar a renderização ao usar buffers z.</span><span class="sxs-lookup"><span data-stu-id="b9f15-137">Various techniques can be used to optimize rendering when using z-buffers.</span></span> <span data-ttu-id="b9f15-138">Para obter detalhes, consulte [Z-buffer performance](performance-optimizations.md).</span><span class="sxs-lookup"><span data-stu-id="b9f15-138">For details, see [Z-Buffer Performance](performance-optimizations.md).</span></span>

> [!Note]  
> <span data-ttu-id="b9f15-139">A interpretação real de um valor de profundidade é específica para o renderizador.</span><span class="sxs-lookup"><span data-stu-id="b9f15-139">The actual interpretation of a depth value is specific to the renderer.</span></span>

 

<span data-ttu-id="b9f15-140">Esta seção apresenta informações sobre como usar buffers de profundidade para a remoção da linha oculta e da superfície oculta.</span><span class="sxs-lookup"><span data-stu-id="b9f15-140">This section presents information about using depth buffers for hidden line and hidden surface removal.</span></span>

-   [<span data-ttu-id="b9f15-141">Consulta de suporte de buffer de profundidade (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="b9f15-141">Querying for Depth Buffer Support (Direct3D 9)</span></span>](querying-for-depth-buffer-support.md)
-   [<span data-ttu-id="b9f15-142">Criando um buffer de profundidade (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="b9f15-142">Creating a Depth Buffer (Direct3D 9)</span></span>](creating-a-depth-buffer.md)
-   [<span data-ttu-id="b9f15-143">Habilitando o buffer de profundidade (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="b9f15-143">Enabling Depth Buffering (Direct3D 9)</span></span>](enabling-depth-buffering.md)
-   [<span data-ttu-id="b9f15-144">Recuperando um buffer de profundidade (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="b9f15-144">Retrieving a Depth Buffer (Direct3D 9)</span></span>](retrieving-a-depth-buffer.md)
-   [<span data-ttu-id="b9f15-145">Limpando buffers de profundidade (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="b9f15-145">Clearing Depth Buffers (Direct3D 9)</span></span>](clearing-depth-buffers.md)
-   [<span data-ttu-id="b9f15-146">Alteração do acesso de gravação do buffer de profundidade (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="b9f15-146">Changing Depth Buffer Write Access (Direct3D 9)</span></span>](changing-depth-buffer-write-access.md)
-   [<span data-ttu-id="b9f15-147">Alterando funções de comparação de buffer de profundidade (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="b9f15-147">Changing Depth Buffer Comparison Functions (Direct3D 9)</span></span>](changing-depth-buffer-comparison-functions.md)

## <a name="related-topics"></a><span data-ttu-id="b9f15-148">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="b9f15-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b9f15-149">Renderização de Direct3D</span><span class="sxs-lookup"><span data-stu-id="b9f15-149">Direct3D Rendering</span></span>](direct3d-rendering.md)
</dt> </dl>

 

 



