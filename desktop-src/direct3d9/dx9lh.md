---
description: Esta documentação refere-se especificamente às extensões do Windows Vista para elementos gráficos do DirectX.
ms.assetid: 3cc0b08c-e126-4f1b-b5d1-0d6c1ebeb0c5
title: Resumo do recurso (Direct3D 9 para Windows Vista)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3d5cf2447297b7f24edf7d0200e640d5aef90bff
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/06/2021
ms.locfileid: "105790508"
---
# <a name="feature-summary-direct3d-9-for-windows-vista"></a><span data-ttu-id="30883-103">Resumo do recurso (Direct3D 9 para Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="30883-103">Feature Summary (Direct3D 9 for Windows Vista)</span></span>

<span data-ttu-id="30883-104">Esta documentação refere-se especificamente às extensões do Windows Vista para elementos gráficos do DirectX.</span><span class="sxs-lookup"><span data-stu-id="30883-104">This documentation specifically refers to the Windows Vista extensions for DirectX graphics.</span></span> <span data-ttu-id="30883-105">Para desenvolver o poder do DirectX para Windows Vista, você deve instalar o SDK do Windows Vista, bem como o SDK do DirectX.</span><span class="sxs-lookup"><span data-stu-id="30883-105">To develop the power of DirectX for Windows Vista, you must install the Windows Vista SDK as well as the DirectX SDK.</span></span> <span data-ttu-id="30883-106">Os aplicativos que usam o DirectX para Windows Vista devem usar o hardware que usa o driver do WDDM (modelo de driver de dispositivo do Windows) em oposição ao XPDM (modelo de driver XP); os drivers que não implementam o WDDM não podem instanciar as interfaces gráficas do DirectX do Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="30883-106">Applications using DirectX for Windows Vista must be using hardware that uses the WDDM driver (Windows Device Driver Model) as opposed to the XPDM (XP Driver Model); drivers that do not implement the WDDM cannot instantiate Windows Vista DirectX graphics interfaces.</span></span>

<span data-ttu-id="30883-107">Descubra os novos recursos gráficos do DirectX no Windows Vista em uma destas seções:</span><span class="sxs-lookup"><span data-stu-id="30883-107">Discover the new DirectX graphics features in Windows Vista in one of these sections:</span></span>

-   [<span data-ttu-id="30883-108">Alterações de comportamento do dispositivo</span><span class="sxs-lookup"><span data-stu-id="30883-108">Device Behavior Changes</span></span>](#device-behavior-changes)
-   [<span data-ttu-id="30883-109">Desabilitando o processamento de vértice de software multithread</span><span class="sxs-lookup"><span data-stu-id="30883-109">Disabling Multithreaded Software Vertex Processing</span></span>](#disabling-multithreaded-software-vertex-processing)
-   [<span data-ttu-id="30883-110">Superfícies de um bit</span><span class="sxs-lookup"><span data-stu-id="30883-110">One Bit Surfaces</span></span>](#one-bit-surfaces)
-   [<span data-ttu-id="30883-111">Lendo buffers de profundidade/estêncil</span><span class="sxs-lookup"><span data-stu-id="30883-111">Reading Depth/Stencil Buffers</span></span>](#reading-depthstencil-buffers)
-   [<span data-ttu-id="30883-112">Compartilhando recursos</span><span class="sxs-lookup"><span data-stu-id="30883-112">Sharing Resources</span></span>](#sharing-resources)
-   [<span data-ttu-id="30883-113">Conversão sRGB antes da mesclagem</span><span class="sxs-lookup"><span data-stu-id="30883-113">sRGB Conversion Before Blending</span></span>](#srgb-conversion-before-blending)
-   [<span data-ttu-id="30883-114">Aprimoramentos do StretchRect</span><span class="sxs-lookup"><span data-stu-id="30883-114">StretchRect Improvements</span></span>](#stretchrect-improvements)
-   [<span data-ttu-id="30883-115">Criação de textura na memória do sistema</span><span class="sxs-lookup"><span data-stu-id="30883-115">Texture Creation in System Memory</span></span>](#texture-creation-in-system-memory)

## <a name="device-behavior-changes"></a><span data-ttu-id="30883-116">Alterações de comportamento do dispositivo</span><span class="sxs-lookup"><span data-stu-id="30883-116">Device Behavior Changes</span></span>

<span data-ttu-id="30883-117">Os dispositivos agora são perdidos apenas em duas circunstâncias; Quando o hardware é redefinido porque está suspenso e quando o driver do dispositivo é interrompido.</span><span class="sxs-lookup"><span data-stu-id="30883-117">Devices are now only lost under two circumstances; when the hardware is reset because it is hanging, and when the device driver is stopped.</span></span> <span data-ttu-id="30883-118">Quando o hardware trava, o dispositivo pode ser redefinido chamando [**ResetEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-resetex).</span><span class="sxs-lookup"><span data-stu-id="30883-118">When hardware hangs, the device can be reset by calling [**ResetEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-resetex).</span></span> <span data-ttu-id="30883-119">Se o hardware parar, a memória da textura será perdida.</span><span class="sxs-lookup"><span data-stu-id="30883-119">If hardware hangs, texture memory is lost.</span></span>

<span data-ttu-id="30883-120">Depois que um driver é interrompido, o objeto IDirect9Ex deve ser recriado para retomar a renderização.</span><span class="sxs-lookup"><span data-stu-id="30883-120">After a driver is stopped, the IDirect9Ex object must be recreated to resume rendering.</span></span>

<span data-ttu-id="30883-121">Quando a área de apresentação é obscurecida por outra janela no modo de janela ou quando um aplicativo de tela inteira é minimizado, [**PresentEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-presentex) retornará S \_ D3DPRESENTATIONOCCLUDED.</span><span class="sxs-lookup"><span data-stu-id="30883-121">When the presentation area is obscured by another window in windowed mode, or when a fullscreen application is minimized, [**PresentEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-presentex) will return S\_D3DPRESENTATIONOCCLUDED.</span></span> <span data-ttu-id="30883-122">Aplicativos de tela inteira podem retomar a renderização quando recebem uma mensagem de retorno de chamada do [**WM \_ ACTIVATEAPP**](../winmsg/wm-activateapp.md) .</span><span class="sxs-lookup"><span data-stu-id="30883-122">Full screen applications can resume rendering when they receive a [**WM\_ACTIVATEAPP**](../winmsg/wm-activateapp.md) callback message.</span></span>

<span data-ttu-id="30883-123">Nas versões anteriores do DirectX, quando um aplicativo sofreu uma alteração no modo, a única maneira de recuperar era redefinir o dispositivo e recriar todos os recursos de memória de vídeo e trocar cadeias.</span><span class="sxs-lookup"><span data-stu-id="30883-123">In previous versions of DirectX, when an application experienced a mode change, the only way to recover was to reset the device and re-create all video memory resources and swap chains.</span></span> <span data-ttu-id="30883-124">Agora, com o DirectX para Windows Vista, chamar Reset após uma alteração de modo não faz com que as superfícies de memória de textura, texturas e informações de estado sejam perdidas e que esses recursos não precisem ser recriados.</span><span class="sxs-lookup"><span data-stu-id="30883-124">Now with DirectX for Windows Vista, calling Reset after a mode change does not cause texture memory surfaces, textures and state information to be lost and these resources do not need to be recreated.</span></span>

## <a name="disabling-multithreaded-software-vertex-processing"></a><span data-ttu-id="30883-125">Desabilitando o processamento de vértice de software multithread</span><span class="sxs-lookup"><span data-stu-id="30883-125">Disabling Multithreaded Software Vertex Processing</span></span>

<span data-ttu-id="30883-126">Um novo bit de Caps (D3DCREATE \_ Disable \_ PSGP \_ Threading) foi adicionado para desabilitar o multithreading para o swvp (processamento de vértices de software).</span><span class="sxs-lookup"><span data-stu-id="30883-126">A new caps bit (D3DCREATE\_DISABLE\_PSGP\_THREADING) has been added that will disable multithreading for software vertex processing (swvp).</span></span> <span data-ttu-id="30883-127">Use esta macro para gerar um sinalizador de comportamento para IDirect3D9:: CreateDevice.</span><span class="sxs-lookup"><span data-stu-id="30883-127">Use this macro to generate a behavior flag for IDirect3D9::CreateDevice.</span></span>


```
#define D3DCREATE_DISABLE_PSGP_THREADING
```



## <a name="one-bit-surfaces"></a><span data-ttu-id="30883-128">Superfícies de um bit</span><span class="sxs-lookup"><span data-stu-id="30883-128">One Bit Surfaces</span></span>

<span data-ttu-id="30883-129">Há um novo tipo de formato de superfície de bit que pode ser especialmente útil para processar glifos de texto.</span><span class="sxs-lookup"><span data-stu-id="30883-129">There is a new one bit surface format type which can be especially useful for processing text glyphs.</span></span> <span data-ttu-id="30883-130">O novo formato é chamado de D3DFMT \_ a1.</span><span class="sxs-lookup"><span data-stu-id="30883-130">The new format is called D3DFMT\_A1.</span></span> <span data-ttu-id="30883-131">Uma superfície de um bit é projetada para ser usada como uma textura por pixel ou a saída de destino de renderização gerada por ComposeRects ou ColorFill.</span><span class="sxs-lookup"><span data-stu-id="30883-131">A one-bit surface is designed to be either used as a per-pixel texture, or the render target output generated by ComposeRects or ColorFill.</span></span> <span data-ttu-id="30883-132">Não há limites separados para a largura e a altura da superfície; uma implementação deve dar suporte a uma superfície de tamanho único que seja de 2K texels x 8K texels.</span><span class="sxs-lookup"><span data-stu-id="30883-132">There are no separate caps for the surface width and height; an implementation must support a single size surface that is 2K texels x 8K texels.</span></span>

<span data-ttu-id="30883-133">Uma superfície de um bit tem um bit por Texel; Portanto, uma delas significa que todos os componentes (r, g, b, a) de um pixel são 1 e zero significaria que todos os componentes são iguais a 0.</span><span class="sxs-lookup"><span data-stu-id="30883-133">A one-bit surface has one bit per texel; therefore, a one would mean that all components (r,g,b,a) of a pixel are 1, and zero would mean that all components are equal to 0.</span></span> <span data-ttu-id="30883-134">Você pode usar superfícies de um bit com as seguintes APIs: ColorFill, UpdateSurface e UpdateTexture.</span><span class="sxs-lookup"><span data-stu-id="30883-134">You may use one-bit surfaces with the following APIs: ColorFill, UpdateSurface and UpdateTexture.</span></span>

<span data-ttu-id="30883-135">Quando uma superfície de um bit é lida, o tempo de execução pode executar a amostra de ponto ou a filtragem de convolução.</span><span class="sxs-lookup"><span data-stu-id="30883-135">When a one-bit surface is read, the runtime can perform either point sample or convolution filtering.</span></span> <span data-ttu-id="30883-136">O filtro de convolução é ajustável (consulte [**SetConvolutionMonoKernel**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-setconvolutionmonokernel)).</span><span class="sxs-lookup"><span data-stu-id="30883-136">The convolution filter is adjustable (see [**SetConvolutionMonoKernel**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-setconvolutionmonokernel)).</span></span>

<span data-ttu-id="30883-137">Há algumas restrições para superfícies de um bit:</span><span class="sxs-lookup"><span data-stu-id="30883-137">There are some restrictions for one-bit surfaces:</span></span>

-   <span data-ttu-id="30883-138">Não há suporte para o mapeamento MIP</span><span class="sxs-lookup"><span data-stu-id="30883-138">Mip-mapping is not supported</span></span>
-   <span data-ttu-id="30883-139">os dados sRGB não podem ser lidos ou gravados em uma superfície de um bit.</span><span class="sxs-lookup"><span data-stu-id="30883-139">sRGB data cannot be read or written to a one-bit surface.</span></span>
-   <span data-ttu-id="30883-140">Uma superfície de um bit não pode ser usada como uma textura de vértice ou para multiamostragem.</span><span class="sxs-lookup"><span data-stu-id="30883-140">A one-bit surface cannot be used as a vertex texture or for multisampling.</span></span>

## <a name="reading-depthstencil-buffers"></a><span data-ttu-id="30883-141">Lendo buffers de profundidade/estêncil</span><span class="sxs-lookup"><span data-stu-id="30883-141">Reading Depth/Stencil Buffers</span></span>

<span data-ttu-id="30883-142">Use IDirect3DDevice9:: UpdateSurface para ler ou gravar dados de profundidade/estêncil de superfícies obtidas de IDirect3DDevice9:: CreateDepthStencilSurface ou IDirect3DDevice9:: GetDepthStencilSurface.</span><span class="sxs-lookup"><span data-stu-id="30883-142">Use IDirect3DDevice9::UpdateSurface to read or write depth/stencil data from surfaces obtained from IDirect3DDevice9::CreateDepthStencilSurface or IDirect3DDevice9::GetDepthStencilSurface.</span></span>

<span data-ttu-id="30883-143">Primeiro, crie uma superfície de bloqueáveis, somente profundidade ou apenas de estêncil usando IDirect3DDevice9:: CreateOffscreenPlainSurface.</span><span class="sxs-lookup"><span data-stu-id="30883-143">First, create a lockable, depth only or stencil only surface using IDirect3DDevice9::CreateOffscreenPlainSurface.</span></span> <span data-ttu-id="30883-144">Use um destes formatos:</span><span class="sxs-lookup"><span data-stu-id="30883-144">Use one of the following formats:</span></span>

-   <span data-ttu-id="30883-145">D3DFMT \_ D16 \_ bloqueáveis</span><span class="sxs-lookup"><span data-stu-id="30883-145">D3DFMT\_D16\_LOCKABLE</span></span>
-   <span data-ttu-id="30883-146">D3DFMT \_ D32F \_ bloqueáveis</span><span class="sxs-lookup"><span data-stu-id="30883-146">D3DFMT\_D32F\_LOCKABLE</span></span>
-   <span data-ttu-id="30883-147">D3DFMT \_ D32 \_ bloqueáveis</span><span class="sxs-lookup"><span data-stu-id="30883-147">D3DFMT\_D32\_LOCKABLE</span></span>
-   <span data-ttu-id="30883-148">D3DFMT \_ S8 \_ bloqueáveis</span><span class="sxs-lookup"><span data-stu-id="30883-148">D3DFMT\_S8\_LOCKABLE</span></span>

<span data-ttu-id="30883-149">Em segundo lugar, transfira dados entre o buffer de profundidade/estêncil e a profundidade de bloqueáveis ou a superfície de estêncil criada recentemente.</span><span class="sxs-lookup"><span data-stu-id="30883-149">Second, transfer data between the depth/stencil buffer and the newly-created lockable depth or stencil surface.</span></span> <span data-ttu-id="30883-150">A transferência é executada usando IDirect3DDevice9:: UpdateSurface.</span><span class="sxs-lookup"><span data-stu-id="30883-150">The transfer is performed using IDirect3DDevice9::UpdateSurface.</span></span>

<span data-ttu-id="30883-151">UpdateSurface falhará quando as duas superfícies forem um formato BLOQUEÁVEIS ou se ambas não forem bloqueáveis.</span><span class="sxs-lookup"><span data-stu-id="30883-151">UpdateSurface will fail when both surfaces are a LOCKABLE format or both are non-lockable.</span></span>

<span data-ttu-id="30883-152">A transferência de dados inexistentes resultará em um erro (por exemplo, transferindo de uma superfície não bloqueáveis somente profundidade para uma \_ superfície D3DFMT S8 \_ bloqueáveis).</span><span class="sxs-lookup"><span data-stu-id="30883-152">Transferring non-existent data will result in an error (for example, transferring from a non-lockable depth-only surface to a D3DFMT\_S8\_LOCKABLE surface).</span></span>

<span data-ttu-id="30883-153">O restante das restrições para IDirect3DDevice9:: UpdateSurface ainda se aplica.</span><span class="sxs-lookup"><span data-stu-id="30883-153">The rest of the restrictions for IDirect3DDevice9::UpdateSurface still apply.</span></span>

## <a name="sharing-resources"></a><span data-ttu-id="30883-154">Compartilhando recursos</span><span class="sxs-lookup"><span data-stu-id="30883-154">Sharing Resources</span></span>

<span data-ttu-id="30883-155">Os recursos do Direct3D agora podem ser compartilhados entre dispositivos ou processos.</span><span class="sxs-lookup"><span data-stu-id="30883-155">Direct3D resources can now be shared between devices or processes.</span></span> <span data-ttu-id="30883-156">Isso se aplica a qualquer recurso do Direct3D, incluindo texturas, buffers de vértice, buffers de índice ou superfícies (como destinos de renderização, buffers de estêncil de profundidade ou superfícies simples fora da tela).</span><span class="sxs-lookup"><span data-stu-id="30883-156">This applies to any Direct3D resource including textures, vertex buffers, index buffers, or surfaces (such as render targets, depth stencil buffers or off-screen plain surfaces).</span></span> <span data-ttu-id="30883-157">Para ser compartilhado, você precisa designar um recurso para compartilhamento no momento da criação e localizar o recurso no pool padrão ( \_ padrão D3DPOOL).</span><span class="sxs-lookup"><span data-stu-id="30883-157">To be shared, you need to designate a resource for sharing at the time of creation, and locate the resource in the default pool (D3DPOOL\_DEFAULT).</span></span> <span data-ttu-id="30883-158">Depois que um recurso é criado para compartilhamento, ele pode ser compartilhado entre dispositivos dentro de um processo ou compartilhado entre processos.</span><span class="sxs-lookup"><span data-stu-id="30883-158">Once a resource is created for sharing, it can be shared across devices within a process, or shared across processes.</span></span>

<span data-ttu-id="30883-159">Para habilitar recursos compartilhados, as APIs de criação de recursos têm um parâmetro de identificador adicional.</span><span class="sxs-lookup"><span data-stu-id="30883-159">To enable shared resources, the resource creation APIs have an additional handle parameter.</span></span> <span data-ttu-id="30883-160">Trata-se de um identificador que aponta para o recurso compartilhado.</span><span class="sxs-lookup"><span data-stu-id="30883-160">This is a HANDLE that points to the shared resource.</span></span> <span data-ttu-id="30883-161">Nas revisões anteriores do DirectX, esse argumento faz parte da assinatura de API, mas não foi usado e deve ser definido como **NULL**.</span><span class="sxs-lookup"><span data-stu-id="30883-161">In previous revisions of DirectX, this argument has been part of the API signature, but has been unused and must be set to **NULL**.</span></span> <span data-ttu-id="30883-162">A partir do Windows Vista, use o pSharedHandle das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="30883-162">Starting with Windows Vista, use pSharedHandle in the following ways:</span></span>

-   <span data-ttu-id="30883-163">Defina o ponteiro (pSharedHandle) como **nulo** para não compartilhar um recurso.</span><span class="sxs-lookup"><span data-stu-id="30883-163">Set the pointer (pSharedHandle) to **NULL** to not share a resource.</span></span> <span data-ttu-id="30883-164">Isso é exatamente como o comportamento do DirectX antes do Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="30883-164">This is just like the behavior of DirectX prior to Windows Vista.</span></span>
-   <span data-ttu-id="30883-165">Para criar um recurso compartilhado, chame qualquer API de criação de recurso (veja abaixo) com um identificador não inicializado (o próprio ponteiro não é **nulo** (pSharedHandle! = **NULL**), mas o ponteiro aponta para um valor **nulo** ( \* pSharedHandle = = **NULL**)).</span><span class="sxs-lookup"><span data-stu-id="30883-165">To create a shared resource, call any resource creation API (see below) with an uninitialized handle (the pointer itself is not **NULL** (pSharedHandle != **NULL**), but the pointer points to a **NULL** value (\*pSharedHandle == **NULL**)).</span></span> <span data-ttu-id="30883-166">A API irá gerar um recurso compartilhado e retornar um identificador válido.</span><span class="sxs-lookup"><span data-stu-id="30883-166">The API will generate a shared resource and return a valid handle.</span></span>
-   <span data-ttu-id="30883-167">Para abrir e acessar um recurso compartilhado criado anteriormente usando um identificador de recurso compartilhado não nulo, defina pSharedHandle como o endereço desse identificador.</span><span class="sxs-lookup"><span data-stu-id="30883-167">To open and access a previously created shared resource by using a nonNULL shared resource handle, set pSharedHandle to the address of that handle.</span></span> <span data-ttu-id="30883-168">Depois de abrir o recurso compartilhado criado anteriormente dessa maneira, você pode usar a interface retornada na API Direct3D 9 ou Direct3D 9Ex como se a interface fosse um recurso típico desse tipo.</span><span class="sxs-lookup"><span data-stu-id="30883-168">After you open the previously created shared resource in this manner, you can use the returned interface in the Direct3D 9 or Direct3D 9Ex API as if the interface were a typical resource of that type.</span></span>

<span data-ttu-id="30883-169">As APIs de criação de recursos incluem- [**CreateTexture**](/windows/desktop/api), [**CreateVolumeTexture**](/windows/desktop/api), [**CreateCubeTexture**](/windows/desktop/api), [**CreateRenderTarget**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createrendertarget), [**CreateVertexBuffer**](/windows/desktop/api), [**CreateIndexBuffer**](/windows/desktop/api), [**CreateDepthStencilSurface**](/windows/desktop/api), [**CreateOffscreenPlainSurface**](/windows/desktop/api), [**CreateDepthStencilSurfaceEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-createdepthstencilsurfaceex), [**CreateOffscreenPlainSurfaceEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-createoffscreenplainsurfaceex)e [**CreateRenderTargetEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-createrendertargetex).</span><span class="sxs-lookup"><span data-stu-id="30883-169">Resource creation APIs include - [**CreateTexture**](/windows/desktop/api), [**CreateVolumeTexture**](/windows/desktop/api), [**CreateCubeTexture**](/windows/desktop/api), [**CreateRenderTarget**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createrendertarget), [**CreateVertexBuffer**](/windows/desktop/api), [**CreateIndexBuffer**](/windows/desktop/api), [**CreateDepthStencilSurface**](/windows/desktop/api), [**CreateOffscreenPlainSurface**](/windows/desktop/api), [**CreateDepthStencilSurfaceEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-createdepthstencilsurfaceex), [**CreateOffscreenPlainSurfaceEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-createoffscreenplainsurfaceex), and [**CreateRenderTargetEx**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9ex-createrendertargetex).</span></span>

<span data-ttu-id="30883-170">Há algumas restrições para o uso de recursos compartilhados.</span><span class="sxs-lookup"><span data-stu-id="30883-170">There are some restrictions for using shared resources.</span></span> <span data-ttu-id="30883-171">Estão incluídos:</span><span class="sxs-lookup"><span data-stu-id="30883-171">These include:</span></span>

-   <span data-ttu-id="30883-172">A API que você usa para abrir um recurso compartilhado deve corresponder à API que você usou para criar o recurso compartilhado.</span><span class="sxs-lookup"><span data-stu-id="30883-172">The API that you use to open a shared resource must match the API that you used to create the shared resource.</span></span> <span data-ttu-id="30883-173">Por exemplo, se você usou [**CreateTexture**](/windows/desktop/api) para criar um recurso compartilhado, deverá usar **CreateTexture** para abrir esse recurso compartilhado; Se você usou o [**CreateRenderTarget**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createrendertarget) para criar um recurso compartilhado, deverá usar o **CreateRenderTarget** para abrir esse recurso compartilhado e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="30883-173">For example, if you used [**CreateTexture**](/windows/desktop/api) to create a shared resource, you must use **CreateTexture** to open that shared resource; if you used [**CreateRenderTarget**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createrendertarget) to create a shared resource, you must use **CreateRenderTarget** to open that shared resource;and so on.</span></span>
-   <span data-ttu-id="30883-174">Ao abrir um recurso compartilhado, você deve especificar D3DPOOL \_ padrão.</span><span class="sxs-lookup"><span data-stu-id="30883-174">When you open a shared resource, you must specify D3DPOOL\_DEFAULT.</span></span>
-   <span data-ttu-id="30883-175">Os recursos de bloqueáveis (texturas com D3DUSAGE \_ dinâmico, buffers de vértice e buffers de índice, por exemplo) podem experimentar mau desempenho quando compartilhados.</span><span class="sxs-lookup"><span data-stu-id="30883-175">Lockable resources (textures with D3DUSAGE\_DYNAMIC, vertex buffers and index buffers, for instance) can experience poor performance when shared.</span></span> <span data-ttu-id="30883-176">O bloqueáveis rendertargets não será compartilhado em alguns hardwares.</span><span class="sxs-lookup"><span data-stu-id="30883-176">Lockable rendertargets will fail to be shared on some hardware.</span></span>
-   <span data-ttu-id="30883-177">As referências a um recurso compartilhado entre processos devem ter as mesmas dimensões que o recurso original.</span><span class="sxs-lookup"><span data-stu-id="30883-177">References to a cross-process shared resource must have the same dimensions as the original resource.</span></span> <span data-ttu-id="30883-178">Ao passar um identificador pelo processo, inclua as informações de dimensão para que a referência possa ser criada de forma idêntica.</span><span class="sxs-lookup"><span data-stu-id="30883-178">When passing a handle across process, include the dimension information so that the reference can be created identically.</span></span>
-   <span data-ttu-id="30883-179">As superfícies de processo cruzado compartilhado não fornecem nenhum mecanismo de sincronização.</span><span class="sxs-lookup"><span data-stu-id="30883-179">Shared cross-process surfaces provide no synchronization mechanism.</span></span> <span data-ttu-id="30883-180">As alterações de leitura/gravação em uma superfície compartilhada podem não refletir a exibição de um processo de referência da superfície quando esperado.</span><span class="sxs-lookup"><span data-stu-id="30883-180">Read/write changes to a shared surface may not reflect a referencing process's view of the surface when expected.</span></span> <span data-ttu-id="30883-181">Para fornecer sincronização, use consultas de evento ou bloqueie a textura.</span><span class="sxs-lookup"><span data-stu-id="30883-181">To provide synchronization, use event queries or lock the texture.</span></span>
-   <span data-ttu-id="30883-182">Somente o processo que inicialmente cria um recurso compartilhado pode bloqueá-lo (qualquer processo que abra uma referência a esse recurso compartilhado não pode bloqueá-lo).</span><span class="sxs-lookup"><span data-stu-id="30883-182">Only the process that initially creates a shared resource can lock it (any process that opens a reference to that shared resource cannot lock it).</span></span>
-   <span data-ttu-id="30883-183">Se um recurso compartilhado estiver bloqueado, não haverá validação para outros processos saber se o recurso está disponível.</span><span class="sxs-lookup"><span data-stu-id="30883-183">If a shared resource is locked, there is no validation for other processes to know if the resource is available.</span></span>

## <a name="srgb-conversion-before-blending"></a><span data-ttu-id="30883-184">Conversão sRGB antes da mesclagem</span><span class="sxs-lookup"><span data-stu-id="30883-184">sRGB Conversion Before Blending</span></span>

<span data-ttu-id="30883-185">Agora você pode verificar se o dispositivo pode converter dados de pipeline para sRGB antes da mistura de buffer de quadro.</span><span class="sxs-lookup"><span data-stu-id="30883-185">You can now check to see if the device can convert pipeline data to sRGB before frame-buffer blending.</span></span> <span data-ttu-id="30883-186">Isso implica que o dispositivo converte os valores de destino de renderização de sRGB.</span><span class="sxs-lookup"><span data-stu-id="30883-186">This implies that the device converts the render-target values from sRGB.</span></span> <span data-ttu-id="30883-187">Para ver se a conversão é suportada pelo hardware, verifique este limite:</span><span class="sxs-lookup"><span data-stu-id="30883-187">To see if conversion is supported by the hardware, check for this cap:</span></span>


```
D3DPMISCCAPS_POSTBLENDSRGBCONVERT
```



<span data-ttu-id="30883-188">Esse limite identifica o hardware que dá suporte à conversão para sRGB antes da mesclagem.</span><span class="sxs-lookup"><span data-stu-id="30883-188">This cap identifies hardware that supports conversion to sRGB before blending.</span></span> <span data-ttu-id="30883-189">Esse recurso é importante para o processamento de alta qualidade de buffers de quadros FP16 no DWM (Gerenciador de janelas da área de trabalho).</span><span class="sxs-lookup"><span data-stu-id="30883-189">This capability is important for the high quality rendering from fp16 frame buffers in the desktop window manager (DWM).</span></span>

## <a name="stretchrect-improvements"></a><span data-ttu-id="30883-190">Aprimoramentos do StretchRect</span><span class="sxs-lookup"><span data-stu-id="30883-190">StretchRect Improvements</span></span>

<span data-ttu-id="30883-191">Nas versões anteriores do DirectX, o StretchRect tem muitas restrições para acomodar drivers diferentes (consulte IDirect3DDevice9:: StretchRect).</span><span class="sxs-lookup"><span data-stu-id="30883-191">In previous versions of DirectX, StretchRect has many restrictions to accommodate different drivers (see IDirect3DDevice9::StretchRect).</span></span> <span data-ttu-id="30883-192">O Windows Vista baseia-se no Windows Device Driver Model (WDDM).</span><span class="sxs-lookup"><span data-stu-id="30883-192">Windows Vista is built on the Windows Device Driver Model (WDDM).</span></span> <span data-ttu-id="30883-193">Esse novo modelo de driver é muito mais robusto e permite que os drivers manipulem casos especiais no hardware.</span><span class="sxs-lookup"><span data-stu-id="30883-193">This new driver model is much more robust, and allows drivers to handle special cases in the hardware.</span></span>

<span data-ttu-id="30883-194">Em geral, a única restrição restante é que o destino de renderização deve ter sido criado com o uso de destino de renderização (D3DUSAGE \_ RENDERTARGET).</span><span class="sxs-lookup"><span data-stu-id="30883-194">In general, the only remaining restriction is that the render target must have been created with render-target usage (D3DUSAGE\_RENDERTARGET).</span></span> <span data-ttu-id="30883-195">Essa restrição será levantada se você estiver fazendo uma cópia simples (onde a origem e o destino têm o mesmo formato, o mesmo tamanho e não há subretângulos).</span><span class="sxs-lookup"><span data-stu-id="30883-195">This restriction is lifted if you are doing a simple copy (where the source and dest are the same format, same size and there are no sub-rectangles).</span></span>

## <a name="texture-creation-in-system-memory"></a><span data-ttu-id="30883-196">Criação de textura na memória do sistema</span><span class="sxs-lookup"><span data-stu-id="30883-196">Texture Creation in System Memory</span></span>

<span data-ttu-id="30883-197">Os aplicativos que precisam de mais flexibilidade sobre o uso, a alocação e a exclusão da memória do sistema agora podem criar texturas de um ponteiro de memória do sistema.</span><span class="sxs-lookup"><span data-stu-id="30883-197">Applications that need more flexibility over the use, allocation and deletion of the system memory can now create textures from a system memory pointer.</span></span> <span data-ttu-id="30883-198">Por exemplo, um aplicativo poderia criar uma textura de Direct3D a partir de um ponteiro de bitmap de memória do sistema GDI.</span><span class="sxs-lookup"><span data-stu-id="30883-198">For example, an application could create a Direct3D texture from a GDI system-memory bitmap pointer.</span></span>

<span data-ttu-id="30883-199">Você precisa fazer duas coisas para criar essa textura:</span><span class="sxs-lookup"><span data-stu-id="30883-199">You need to do two things to create such a texture:</span></span>

-   <span data-ttu-id="30883-200">Aloque memória do sistema suficiente para manter a superfície de textura.</span><span class="sxs-lookup"><span data-stu-id="30883-200">Allocate enough system memory to hold the texture surface.</span></span> <span data-ttu-id="30883-201">O número mínimo de bytes é largura x altura x bytes por pixel.</span><span class="sxs-lookup"><span data-stu-id="30883-201">The minimum number of bytes is width x height x bytes per pixel.</span></span>
-   <span data-ttu-id="30883-202">Passe o endereço de um ponteiro para a superfície de memória do sistema para o \* parâmetro HANDLE para IDirect3DDevice9:: CreateTexture.</span><span class="sxs-lookup"><span data-stu-id="30883-202">Pass the address of a pointer to your system memory surface for the HANDLE\* parameter to IDirect3DDevice9::CreateTexture.</span></span>

<span data-ttu-id="30883-203">Este é o protótipo de função para IDirect3DDevice9:: CreateTexture:</span><span class="sxs-lookup"><span data-stu-id="30883-203">Here is the function prototype for IDirect3DDevice9::CreateTexture:</span></span>


```
STDMETHOD(CreateTexture)(THIS_ UINT Width, UINT Height, UINT Levels, 
    DWORD Usage, D3DFORMAT Format, D3DPOOL Pool, IDirect3DTexture9** ppTexture, 
    HANDLE* pSharedHandle)
```



<span data-ttu-id="30883-204">Uma textura de memória do sistema tem as seguintes restrições:</span><span class="sxs-lookup"><span data-stu-id="30883-204">A system-memory texture has the following restrictions:</span></span>

-   <span data-ttu-id="30883-205">A densidade da textura deve ser igual à largura da textura número de bytes por pixel.</span><span class="sxs-lookup"><span data-stu-id="30883-205">The texture pitch must equal texture width times the number of bytes per pixel.</span></span>
-   <span data-ttu-id="30883-206">Ao usar formatos compactados (formatos DXT), o aplicativo é responsável por alocar o tamanho correto.</span><span class="sxs-lookup"><span data-stu-id="30883-206">When using compressed formats (DXT formats), the application is responsible for allocating the correct size.</span></span>
-   <span data-ttu-id="30883-207">Só há suporte para texturas com um único nível de mipmap.</span><span class="sxs-lookup"><span data-stu-id="30883-207">Only textures with a single mipmap level are supported.</span></span>
-   <span data-ttu-id="30883-208">O valor passado para CreateTexture para o argumento do pool deve ser D3DPOOL \_ SYSTEMMEM.</span><span class="sxs-lookup"><span data-stu-id="30883-208">The value passed to CreateTexture for the Pool argument must be D3DPOOL\_SYSTEMMEM.</span></span>
-   <span data-ttu-id="30883-209">Essa API encapsula a memória fornecida em uma textura.</span><span class="sxs-lookup"><span data-stu-id="30883-209">This API wraps the supplied memory in a texture.</span></span> <span data-ttu-id="30883-210">Não desaloque esta memória até que você tenha feito isso.</span><span class="sxs-lookup"><span data-stu-id="30883-210">Do not deallocate this memory until you are done with it.</span></span>

 

 
