---
description: O conteúdo de textura geralmente é armazenado no formato sRGB.
ms.assetid: d076140d-3e91-412a-b099-9baa52f8d7d8
title: Gama (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4cea4b3ba224452e1c3be8f96b7136f4e4f649c8
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/06/2021
ms.locfileid: "105791265"
---
# <a name="gamma-direct3d-9"></a><span data-ttu-id="da824-103">Gama (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="da824-103">Gamma (Direct3D 9)</span></span>

<span data-ttu-id="da824-104">O conteúdo de textura geralmente é armazenado no formato sRGB.</span><span class="sxs-lookup"><span data-stu-id="da824-104">Texture content is often stored in sRGB format.</span></span> <span data-ttu-id="da824-105">Tradicionalmente, os pipelines de pixel assumiram as cores como lineares para que as operações de mesclagem fossem executadas em espaço linear.</span><span class="sxs-lookup"><span data-stu-id="da824-105">Traditionally, pixel pipelines assumed the colors to be linear so blending operations were performed in linear space.</span></span> <span data-ttu-id="da824-106">No entanto, como o conteúdo sRGB é corrigido em gama, as operações de mesclagem em espaço linear produzirão resultados incorretos.</span><span class="sxs-lookup"><span data-stu-id="da824-106">However, since sRGB content is gamma corrected, blending operations in linear space will produce incorrect results.</span></span> <span data-ttu-id="da824-107">As placas de vídeo agora podem corrigir esse problema desfazendo a correção gama ao ler qualquer conteúdo sRGB e converter dados de pixel de volta para o formato sRGB ao gravar pixels.</span><span class="sxs-lookup"><span data-stu-id="da824-107">Video cards can now fix this problem by undoing the gamma correction when they read any sRGB content, and convert pixel data back to the sRGB format when writing out pixels.</span></span> <span data-ttu-id="da824-108">Nesse caso, todas as operações dentro do pipeline de pixel são executadas no espaço linear.</span><span class="sxs-lookup"><span data-stu-id="da824-108">In this case, all operations inside the pixel pipeline are performed in the linear space.</span></span>

## <a name="gamma-correction"></a><span data-ttu-id="da824-109">Correção gama</span><span class="sxs-lookup"><span data-stu-id="da824-109">Gamma Correction</span></span>

<span data-ttu-id="da824-110">O Direct3D 9 pode:</span><span class="sxs-lookup"><span data-stu-id="da824-110">Direct3D 9 can:</span></span>

-   <span data-ttu-id="da824-111">Indique se uma textura é gama 2,2 corrigida ou não (sRGB ou não).</span><span class="sxs-lookup"><span data-stu-id="da824-111">Indicate whether a texture is gamma 2.2 corrected or not (sRGB or not).</span></span> <span data-ttu-id="da824-112">O driver converterá em um gama linear para operações de mesclagem em tempo detexture ou a amostra irá convertê-la em dados lineares no momento da pesquisa.</span><span class="sxs-lookup"><span data-stu-id="da824-112">The driver will either convert to a linear gamma for blending operations at SetTexture time, or the sampler will convert it to linear data at lookup time.</span></span>
-   <span data-ttu-id="da824-113">Indique se o pipeline de pixel deve corrigir o gama de volta para o espaço sRGB ao gravar no destino de renderização.</span><span class="sxs-lookup"><span data-stu-id="da824-113">Indicate whether the pixel pipeline should gamma correct back to sRGB space when writing out to the render target.</span></span>

<span data-ttu-id="da824-114">Todas as outras cores (cor clara, cor do material, cor do vértice, etc.) são consideradas em espaço linear.</span><span class="sxs-lookup"><span data-stu-id="da824-114">All other colors (clear color, material color, vertex color, etc.) are assumed to be in linear space.</span></span> <span data-ttu-id="da824-115">Os aplicativos podem usar o gama para corrigir as cores gravadas no buffer de quadro usando instruções de sombreador de pixel.</span><span class="sxs-lookup"><span data-stu-id="da824-115">Applications can gamma-correct the colors written into the frame buffer using pixel shader instructions.</span></span> <span data-ttu-id="da824-116">A linearidade deve ser aplicada somente aos canais RGB e não ao canal alfa.</span><span class="sxs-lookup"><span data-stu-id="da824-116">The linearization should be applied only to the RGB channels and not to the alpha channel.</span></span>

<span data-ttu-id="da824-117">Nem todos os formatos de superfície podem ser lineares.</span><span class="sxs-lookup"><span data-stu-id="da824-117">Not all surface formats can be linearized.</span></span> <span data-ttu-id="da824-118">Somente os formatos que passam [**CheckDeviceFormat**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdeviceformat) com D3DUSAGE de \_ consulta \_ SRGBREAD podem ser lineares.</span><span class="sxs-lookup"><span data-stu-id="da824-118">Only the formats that pass [**CheckDeviceFormat**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdeviceformat) with D3DUSAGE\_QUERY\_SRGBREAD can be linearized.</span></span> <span data-ttu-id="da824-119">O estado de amostra D3DSAMP \_ SRGBTEXTURE é ignorado para o restante.</span><span class="sxs-lookup"><span data-stu-id="da824-119">The sampler state D3DSAMP\_SRGBTEXTURE is ignored for the rest.</span></span> <span data-ttu-id="da824-120">Espera-se que somente os formatos de textura não assinados ofereçam suporte a essa conversão.</span><span class="sxs-lookup"><span data-stu-id="da824-120">Only unsigned texture formats are expected to support this conversion.</span></span> <span data-ttu-id="da824-121">Os formatos de textura não assinados incluem apenas os componentes R, G, B e L.</span><span class="sxs-lookup"><span data-stu-id="da824-121">Unsigned texture formats include only R, G, B, and L components.</span></span> <span data-ttu-id="da824-122">Se o canal alfa estiver presente, ele será ignorado.</span><span class="sxs-lookup"><span data-stu-id="da824-122">If the alpha channel is present, it is ignored.</span></span> <span data-ttu-id="da824-123">Se os formatos mistos oferecerem suporte à linearidade de sRGB, somente os canais não assinados serão afetados.</span><span class="sxs-lookup"><span data-stu-id="da824-123">If mixed formats support sRGB linearization, only the unsigned channels are affected.</span></span> <span data-ttu-id="da824-124">Idealmente, o hardware deve executar a linearidade antes da filtragem, mas no Direct3D 9, o hardware tem permissão para executar a linearidade após a filtragem.</span><span class="sxs-lookup"><span data-stu-id="da824-124">Ideally, hardware should perform the linearization before filtering but in Direct3D 9, hardware is allowed to perform the linearization after filtering.</span></span>

<span data-ttu-id="da824-125">Nem todos os formatos de superfície podem ser gravados no espaço sRGB.</span><span class="sxs-lookup"><span data-stu-id="da824-125">Not all surface formats can be written in sRGB space.</span></span> <span data-ttu-id="da824-126">Somente os formatos que passam o [**CheckDeviceFormat**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdeviceformat) com o sinalizador de uso D3DUSAGE \_ consulta \_ SRGBWRITE podem ser lineares.</span><span class="sxs-lookup"><span data-stu-id="da824-126">Only the formats that pass the [**CheckDeviceFormat**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdeviceformat) with the usage flag D3DUSAGE\_QUERY\_SRGBWRITE can be linearized.</span></span> <span data-ttu-id="da824-127">O estado de renderização D3DRS \_ SRGBWRITEENABLE é ignorado para o restante.</span><span class="sxs-lookup"><span data-stu-id="da824-127">The render state D3DRS\_SRGBWRITEENABLE is ignored for the rest.</span></span> <span data-ttu-id="da824-128">Espera-se que oito bits por canal de formatos RGB não assinados exponham essa capacidade.</span><span class="sxs-lookup"><span data-stu-id="da824-128">Eight bits per channel RGB unsigned formats are expected to expose this ability.</span></span>

<span data-ttu-id="da824-129">O ideal é que o hardware execute as operações de mesclagem do buffer de quadros no espaço linear, mas o hardware tem permissão para executá-lo após o sombreador de pixel, mas antes do misturador de buffer de quadros.</span><span class="sxs-lookup"><span data-stu-id="da824-129">Ideally, hardware should perform the frame buffer blending operations in the linear space, but hardware is allowed to perform it after the pixel shader but before the frame buffer blender.</span></span> <span data-ttu-id="da824-130">Isso significa que as operações de mesclagem do buffer de quadros que ocorrem no espaço sRGB produzirão resultados incorretos.</span><span class="sxs-lookup"><span data-stu-id="da824-130">This means that the frame buffer blending operations that take place in sRGB space will produce incorrect results.</span></span> <span data-ttu-id="da824-131">D3DRS \_ SRGBWRITEENABLE é respeitado ao executar uma limpeza do destino de renderização.</span><span class="sxs-lookup"><span data-stu-id="da824-131">D3DRS\_SRGBWRITEENABLE is honored while performing a clear of the render target.</span></span> <span data-ttu-id="da824-132">Para hardware que dá suporte a [vários destinos de renderização (Direct3D 9)](multiple-render-targets.md) ou [texturas de vários elementos (Direct3D 9)](multiple-element-textures.md), somente o primeiro destino de renderização ou elemento é gravado.</span><span class="sxs-lookup"><span data-stu-id="da824-132">For hardware that supports [Multiple Render Targets (Direct3D 9)](multiple-render-targets.md) or [Multiple-element Textures (Direct3D 9)](multiple-element-textures.md), only the first render target or element is written.</span></span>

### <a name="api-changes"></a><span data-ttu-id="da824-133">Alterações de API</span><span class="sxs-lookup"><span data-stu-id="da824-133">API Changes</span></span>


```
// New sampler state (DWORD)
// If this is nonzero, the texture is linearized on lookup.
D3DSAMP_SRGBTEXTURE       // Default FALSE

// New render state (DWORD)
D3DRS_SRGBWRITEENABLE     // Default FALSE

// New usage flags
D3DUSAGE_QUERY_SRGBWRITE
D3DUSAGE_QUERY_SRGBREAD
```



### <a name="windowed-swap-chains"></a><span data-ttu-id="da824-134">Cadeias de permuta em janelas</span><span class="sxs-lookup"><span data-stu-id="da824-134">Windowed Swap Chains</span></span>

<span data-ttu-id="da824-135">É importante que os aplicativos mantenham os buffers de fundo de suas cadeias de permuta em espaço linear para habilitar as operações de mesclagem corretas.</span><span class="sxs-lookup"><span data-stu-id="da824-135">It is valuable for applications to keep the back buffers of their swap chains in linear space in order to enable correct blending operations.</span></span> <span data-ttu-id="da824-136">Como a área de trabalho normalmente não está em espaço linear, uma correção gama é necessária antes que o conteúdo do buffer de fundo possa ser apresentado.</span><span class="sxs-lookup"><span data-stu-id="da824-136">Since the desktop is typically not in linear space, a gamma correction is required before the contents of the back buffer can be presented.</span></span> <span data-ttu-id="da824-137">O aplicativo pode afetar essa correção alocando um buffer adicional e executando sua própria cópia de correção do buffer linear para o buffer de fundo.</span><span class="sxs-lookup"><span data-stu-id="da824-137">The application can effect this correction itself by allocating an additional buffer and performing its own correcting copy from the linear buffer to the back buffer.</span></span> <span data-ttu-id="da824-138">Isso exige uma cópia extra que poderá ser evitada se o driver executar a correção gama como parte da apresentação blit.</span><span class="sxs-lookup"><span data-stu-id="da824-138">This necessitates an extra copy which can be avoided if the driver performs gamma correction as part of the presentation blit.</span></span>

<span data-ttu-id="da824-139">No Direct3D 9, um novo sinalizador, [D3DPRESENT \_ linear \_ Content](d3dpresent.md), está disponível para o [**presente**](/windows/desktop/api) que permite que a apresentação converta implicitamente o espaço linear em sRGB/gama 2,2.</span><span class="sxs-lookup"><span data-stu-id="da824-139">In Direct3D 9 a new flag, [D3DPRESENT\_LINEAR\_CONTENT](d3dpresent.md), is available for [**Present**](/windows/desktop/api) that allows the presentation to implicitly convert from linear space to sRGB/gamma 2.2.</span></span> <span data-ttu-id="da824-140">Os aplicativos devem especificar esse sinalizador se o formato de BackBuffer for de ponto flutuante de 16 bits para corresponder ao modo de janela presente para o comportamento em tela inteira, desde que \_ \_ a apresentação D3DCAPS3 linear para \_ sRGB \_ seja retornada para os recursos de dispositivo recuperados por meio de [**GetDeviceCaps**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getdevicecaps).</span><span class="sxs-lookup"><span data-stu-id="da824-140">Applications should specify this flag if the backbuffer format is 16-bit floating point in order to match windowed mode present to full screen gamma behavior, provided D3DCAPS3\_LINEAR\_TO\_SRGB\_PRESENTATION is returned for device capabilities retrieved through [**GetDeviceCaps**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getdevicecaps).</span></span>

## <a name="related-topics"></a><span data-ttu-id="da824-141">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="da824-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="da824-142">Buffer de quadros</span><span class="sxs-lookup"><span data-stu-id="da824-142">Frame Buffer</span></span>](frame-buffer.md)
</dt> </dl>

 

 
