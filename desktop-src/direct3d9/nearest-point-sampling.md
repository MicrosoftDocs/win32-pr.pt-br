---
description: Os apps não são obrigados a usar filtragem de textura.
ms.assetid: bba0e485-ac5a-4e43-9eb7-25cd0c90d316
title: Amostragem de Nearest-Point (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b11cf98ee917b124b35f3c30ff263365ec3c46e1
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104370185"
---
# <a name="nearest-point-sampling-direct3d-9"></a><span data-ttu-id="64358-103">Amostragem de Nearest-Point (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="64358-103">Nearest-Point Sampling (Direct3D 9)</span></span>

<span data-ttu-id="64358-104">Os apps não são obrigados a usar filtragem de textura.</span><span class="sxs-lookup"><span data-stu-id="64358-104">Applications are not required to use texture filtering.</span></span> <span data-ttu-id="64358-105">O Direct3D pode ser definido para calcular o endereço de texel, que geralmente não avalia como inteiros e copia a cor de texel com o endereço inteiro mais próximo.</span><span class="sxs-lookup"><span data-stu-id="64358-105">Direct3D can be set so that it computes the texel address, which often does not evaluate to integers, and copies the color of the texel with the closest integer address.</span></span> <span data-ttu-id="64358-106">Esse processo é chamado de amostragem do ponto mais próximo.</span><span class="sxs-lookup"><span data-stu-id="64358-106">This process is called nearest-point sampling.</span></span> <span data-ttu-id="64358-107">Isso pode ser uma maneira rápida e eficiente de processar texturas se o tamanho da textura for semelhante ao tamanho da imagem primitiva na tela.</span><span class="sxs-lookup"><span data-stu-id="64358-107">This can be a fast and efficient way to process textures if the size of the texture is similar to the size of the primitive's image on the screen.</span></span> <span data-ttu-id="64358-108">Caso contrário, a textura deve ser ampliada ou minificada.</span><span class="sxs-lookup"><span data-stu-id="64358-108">If not, the texture must be magnified or minified.</span></span> <span data-ttu-id="64358-109">O resultado pode ser uma imagem em partes, com alias ou borrada.</span><span class="sxs-lookup"><span data-stu-id="64358-109">The result can be a chunky, aliased, or blurred image.</span></span>

<span data-ttu-id="64358-110">Seu aplicativo C++ pode selecionar a amostragem de ponto mais próximo chamando o método [**IDirect3DDevice9:: Setsamplestate**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setsamplerstate) .</span><span class="sxs-lookup"><span data-stu-id="64358-110">Your C++ application can select nearest-point sampling by calling the [**IDirect3DDevice9::SetSamplerState**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setsamplerstate) method.</span></span> <span data-ttu-id="64358-111">Defina o valor do primeiro parâmetro como o número de índice inteiro (0-7) da textura para a qual você está selecionando um método de filtragem de textura.</span><span class="sxs-lookup"><span data-stu-id="64358-111">Set the value of the first parameter to the integer index number (0-7) of the texture for which you are selecting a texture filtering method.</span></span> <span data-ttu-id="64358-112">Pass D3DSAMP \_ MAGFILTER, D3DSAMP \_ MINFILTER ou D3DSAMP \_ MIPFILTER para o segundo parâmetro para definir o filtro de ampliação, minificação ou mipmapping.</span><span class="sxs-lookup"><span data-stu-id="64358-112">Pass D3DSAMP\_MAGFILTER, D3DSAMP\_MINFILTER, or D3DSAMP\_MIPFILTER for the second parameter to set the magnification, minification, or mipmapping filter.</span></span> <span data-ttu-id="64358-113">Passe D3DTEXF \_ Point no terceiro parâmetro.</span><span class="sxs-lookup"><span data-stu-id="64358-113">Pass D3DTEXF\_POINT in the third parameter.</span></span>

<span data-ttu-id="64358-114">Você deve usar a amostragem de ponto mais próximo com cuidado, pois pode, às vezes, causar artefatos gráficos quando a textura é amostrada no limite entre duas texels.</span><span class="sxs-lookup"><span data-stu-id="64358-114">You should use nearest-point sampling carefully, because it can sometimes cause graphic artifacts when the texture is sampled at the boundary between two texels.</span></span> <span data-ttu-id="64358-115">Esse limite é a posição ao longo da textura (u ou v) em que as transições de texel amostradas fazem as transições de um texel para o próximo.</span><span class="sxs-lookup"><span data-stu-id="64358-115">This boundary is the position along the texture (u or v) at which the sampled texel transitions from one texel to the next.</span></span> <span data-ttu-id="64358-116">Quando a amostragem de pontos é usada, o sistema escolhe uma amostra texel ou a outra, e o resultado pode mudar abruptamente de um texel para o outro à medida que o limite é ultrapassado.</span><span class="sxs-lookup"><span data-stu-id="64358-116">When point sampling is used, the system chooses one sample texel or the other, and the result can change abruptly from one texel to the next texel as the boundary is crossed.</span></span> <span data-ttu-id="64358-117">Esse efeito pode aparecer como artefatos gráficos indesejados na textura exibida.</span><span class="sxs-lookup"><span data-stu-id="64358-117">This effect can appear as undesired graphic artifacts in the displayed texture.</span></span> <span data-ttu-id="64358-118">Quando a filtragem linear for usada, o texel resultante é calculado a partir de ambos os texels adjacentes e se combina perfeitamente entre eles à medida que o índice de textura percorre o limite.</span><span class="sxs-lookup"><span data-stu-id="64358-118">When linear filtering is used, the resulting texel is computed from both adjacent texels and smoothly blends between them as the texture index moves through the boundary.</span></span>

<span data-ttu-id="64358-119">Esse efeito pode ser observado ao mapear uma textura muito pequena para um polígono muito grande: uma operação geralmente chamada de ampliação.</span><span class="sxs-lookup"><span data-stu-id="64358-119">This effect can be seen when mapping a very small texture onto a very large polygon: an operation often called magnification.</span></span> <span data-ttu-id="64358-120">Por exemplo, ao usar uma textura que se parece com um quadriculado, o exemplo de ponto mais próximo resulta em um quadriculado maior com bordas distintas.</span><span class="sxs-lookup"><span data-stu-id="64358-120">For example, when using a texture that looks like a checkerboard, nearest-point sampling results in a larger checkerboard that shows distinct edges.</span></span> <span data-ttu-id="64358-121">Por outro lado, a filtragem de textura linear resulta em uma imagem em que o quadriculado varia no polígono.</span><span class="sxs-lookup"><span data-stu-id="64358-121">By contrast, linear texture filtering results in an image where the checkerboard colors vary smoothly across the polygon.</span></span>

<span data-ttu-id="64358-122">Na maioria dos casos, os apps recebem os melhores resultados ao evitar o exemplo de ponto mais próximo sempre que possível.</span><span class="sxs-lookup"><span data-stu-id="64358-122">In most cases, applications receive the best results by avoiding nearest-point sample wherever possible.</span></span> <span data-ttu-id="64358-123">A maioria do hardware atual é otimizado para filtragem linear, portanto, o app não deve ter o desempenho prejudicado.</span><span class="sxs-lookup"><span data-stu-id="64358-123">The majority of hardware today is optimized for linear filtering, so your application should not suffer degraded performance.</span></span> <span data-ttu-id="64358-124">Se o efeito desejado exigir o uso do exemplo de ponto próximo, como ao usar texturas para exibir caracteres de texto legível, então o app deve ter cuidado para evitar a amostragem nos limites de texel, o que pode resultar em efeitos indesejados.</span><span class="sxs-lookup"><span data-stu-id="64358-124">If the effect you desire absolutely requires the use of the nearest-point sampling - such as when using textures to display readable text characters - then your application should be extremely careful to avoid sampling at the texel boundaries, which might result in undesired effects.</span></span> <span data-ttu-id="64358-125">A ilustração a seguir mostra a possível aparência desses artefatos.</span><span class="sxs-lookup"><span data-stu-id="64358-125">The following illustration shows what these artifacts can look like.</span></span>

![ilustração de uma caixa divididas em seções seis com linhas horizontais não contínuas nos dois quadrados superiores à direita](images/ptrtfct.png)

<span data-ttu-id="64358-127">Observe que os dois quadrados no canto superior direito do grupo parecem diferentes de seus vizinhos, com deslocamentos diagonais sendo executados por meio deles.</span><span class="sxs-lookup"><span data-stu-id="64358-127">Notice that the two squares in the upper right of the group appear different than their neighbors, with diagonal offsets running through them.</span></span> <span data-ttu-id="64358-128">Para evitar artefatos gráficos como estes, você deve estar familiarizado com as regras de amostragem de textura do Direct3D para filtragem do ponto mais próximo.</span><span class="sxs-lookup"><span data-stu-id="64358-128">To avoid graphic artifacts like these, you must be familiar with Direct3D texture sampling rules for nearest-point filtering.</span></span> <span data-ttu-id="64358-129">O Direct3D mapeia uma coordenada de textura de ponto flutuante, variando de \[ 0,0, 1,0 \] (0,0 a 1,0, inclusive) para um valor de espaço Texel inteiro que varia de \[ -0,5, n-0,5 \] , em que n é o número de texels em uma determinada dimensão na textura.</span><span class="sxs-lookup"><span data-stu-id="64358-129">Direct3D maps a floating-point texture coordinate ranging from \[0.0, 1.0\] (0.0 to 1.0, inclusive) to an integer texel space value ranging from \[ - 0.5, n - 0.5\], where n is the number of texels in a given dimension on the texture.</span></span> <span data-ttu-id="64358-130">O índice de textura resultante é arredondado para o inteiro mais próximo.</span><span class="sxs-lookup"><span data-stu-id="64358-130">The resulting texture index is rounded to the nearest integer.</span></span> <span data-ttu-id="64358-131">Esse mapeamento pode introduzir imprecisões de amostragem nos limites de texel.</span><span class="sxs-lookup"><span data-stu-id="64358-131">This mapping can introduce sampling inaccuracies at texel boundaries.</span></span>

<span data-ttu-id="64358-132">Para um exemplo simples, imagine um aplicativo que renderiza polígonos com o modo de \_ endereçamento de textura D3DTADDRESS Wrap.</span><span class="sxs-lookup"><span data-stu-id="64358-132">For a simple example, imagine an application that renders polygons with the D3DTADDRESS\_WRAP texture addressing mode.</span></span> <span data-ttu-id="64358-133">Usando o mapeamento empregado por Direct3D, o índice de textura u é mapeado como mostrado no diagrama a seguir para uma textura com 4 texels de largura.</span><span class="sxs-lookup"><span data-stu-id="64358-133">Using the mapping employed by Direct3D, the u texture index maps as show in the following diagram for a texture with a width of 4 texels.</span></span>

![diagrama de coordenadas de textura 0,0 e 1,0 no limite entre texels](images/ptsmpprb.png)

<span data-ttu-id="64358-135">Observe que as coordenadas de textura, 0,0 e 1,0 para esta ilustração, estão exatamente no limite entre texels.</span><span class="sxs-lookup"><span data-stu-id="64358-135">Notice that the texture coordinates, 0.0 and 1.0 for this illustration, are exactly at the boundary between texels.</span></span> <span data-ttu-id="64358-136">Usando o método pelo qual o Direct3D mapeia valores, a textura coordena o intervalo de \[ -0,5, 4-0,5 \] , em que 4 é a largura da textura.</span><span class="sxs-lookup"><span data-stu-id="64358-136">Using the method by which Direct3D maps values, the texture coordinates range from \[ - 0.5, 4 - 0.5\], where 4 is the width of the texture.</span></span> <span data-ttu-id="64358-137">Nesse caso, a amostra de texel é o texel 0 para um índice de textura de 1,0.</span><span class="sxs-lookup"><span data-stu-id="64358-137">For this case, the sampled texel is the 0 texel for a texture index of 1.0.</span></span> <span data-ttu-id="64358-138">No entanto, se a coordenada de textura foi somente um pouco menor do que 1,0, a amostra de texel seria o texel n em vez do texel 0.</span><span class="sxs-lookup"><span data-stu-id="64358-138">However, if the texture coordinate was only slightly less than 1.0, the sampled texel would be the n texel instead of the 0 texel.</span></span>

<span data-ttu-id="64358-139">A implicação disso é que ao ampliar uma pequena textura usando coordenadas de textura de 0,0 e 1,0 com filtragem de ponto mais próximo ponto triângulo alinhado no espaço da tela resulta em pixels para os quais é feita a amostragem do mapa de textura com o limite entre texels do limite.</span><span class="sxs-lookup"><span data-stu-id="64358-139">The implication of this is that magnifying a small texture using texture coordinates of exactly 0.0 and 1.0 with nearest-point filtering on a screen-space aligned triangle results in pixels for which the texture map is sampled at the boundary between texels.</span></span> <span data-ttu-id="64358-140">Qualquer imprecisões no cálculo de coordenadas de textura, porém pequenos, resulta em artefatos ao longo as áreas em que a imagem renderizada que correspondem até as bordas de texel do mapa de textura.</span><span class="sxs-lookup"><span data-stu-id="64358-140">Any inaccuracies in the computation of texture coordinates, however small, results in artifacts along the areas in the rendered image which correspond to the texel edges of the texture map.</span></span>

<span data-ttu-id="64358-141">O mapeamento de coordenadas de textura de ponto flutuante em texels inteiros com precisão é difícil, requer tempo para os cálculos e, em geral, não é necessário.</span><span class="sxs-lookup"><span data-stu-id="64358-141">Performing this mapping of floating point texture coordinates to integer texels with perfect accuracy is difficult, computationally time-consuming, and generally not necessary.</span></span> <span data-ttu-id="64358-142">A maioria das implementações de hardware usa uma abordagem iterativa para calcular as coordenadas de textura em cada local de pixel em um triângulo.</span><span class="sxs-lookup"><span data-stu-id="64358-142">Most hardware implementations use an iterative approach for computing texture coordinates at each pixel location within a triangle.</span></span> <span data-ttu-id="64358-143">As abordagens iterativas tendem a ocultar esses imprecisões porque os erros são acumulados de modo uniforme durante a iteração.</span><span class="sxs-lookup"><span data-stu-id="64358-143">Iterative approaches tend to hide these inaccuracies because the errors are accumulated evenly during iteration.</span></span>

<span data-ttu-id="64358-144">O rasterizador de referência do Direct3D usa uma abordagem de avaliação direta para o cálculos dos índices de textura em cada local de pixel.</span><span class="sxs-lookup"><span data-stu-id="64358-144">The Direct3D reference rasterizer uses a direct-evaluation approach for computing texture indexes at each pixel location.</span></span> <span data-ttu-id="64358-145">A avaliação direta difere da abordagem iterativa em que qualquer imprecisão na operação apresenta uma distribuição de erro mais aleatória.</span><span class="sxs-lookup"><span data-stu-id="64358-145">Direct evaluation differs from the iterative approach in that any inaccuracy in the operation exhibits a more random error distribution.</span></span> <span data-ttu-id="64358-146">O resultado é que os erros de amostragem nos limites podem ser mais perceptíveis, pois o rasterizador de referência não executa essa operação com precisão.</span><span class="sxs-lookup"><span data-stu-id="64358-146">The result of this is that the sampling errors that occur at the boundaries can be more noticeable because the reference rasterizer does not perform this operation with perfect accuracy.</span></span>

<span data-ttu-id="64358-147">A melhor abordagem é usar a filtragem de ponto mais próximo somente quando necessário.</span><span class="sxs-lookup"><span data-stu-id="64358-147">The best approach is to use nearest-point filtering only when necessary.</span></span> <span data-ttu-id="64358-148">Quando for necessário deve usá-la, é recomendável deslocar as coordenadas de textura das posições de limite para evitar artefatos.</span><span class="sxs-lookup"><span data-stu-id="64358-148">When you must use it, it is recommended that you offset texture coordinates slightly from the boundary positions to avoid artifacts.</span></span>

## <a name="related-topics"></a><span data-ttu-id="64358-149">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="64358-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="64358-150">Filtragem de textura</span><span class="sxs-lookup"><span data-stu-id="64358-150">Texture Filtering</span></span>](texture-filtering.md)
</dt> </dl>

 

 
