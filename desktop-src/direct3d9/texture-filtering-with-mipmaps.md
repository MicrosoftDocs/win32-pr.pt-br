---
description: Um mipmap é uma sequência de texturas, cada uma delas é uma representação em resolução mais baixa progressivamente da mesma imagem.
ms.assetid: b64abca9-0efb-4939-849d-e75a8d0dc10b
title: Filtragem de textura com mipmaps (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bdc109ae6de93a26b5d5e5b90e948761e92ee92c
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104569439"
---
# <a name="texture-filtering-with-mipmaps-direct3d-9"></a><span data-ttu-id="caf5f-103">Filtragem de textura com mipmaps (Direct3D 9)</span><span class="sxs-lookup"><span data-stu-id="caf5f-103">Texture Filtering with Mipmaps (Direct3D 9)</span></span>

<span data-ttu-id="caf5f-104">Um mipmap é uma sequência de texturas, cada uma delas é uma representação em resolução mais baixa progressivamente da mesma imagem.</span><span class="sxs-lookup"><span data-stu-id="caf5f-104">A mipmap is a sequence of textures, each of which is a progressively lower resolution representation of the same image.</span></span> <span data-ttu-id="caf5f-105">A altura e a largura de cada imagem, ou nível, no mipmap é uma potência de dois menores do que o nível anterior.</span><span class="sxs-lookup"><span data-stu-id="caf5f-105">The height and width of each image, or level, in the mipmap is a power of two smaller than the previous level.</span></span> <span data-ttu-id="caf5f-106">Mipmaps não precisam ser quadrados.</span><span class="sxs-lookup"><span data-stu-id="caf5f-106">Mipmaps do not have to be square.</span></span>

<span data-ttu-id="caf5f-107">Uma imagem de mipmap de alta resolução é usada para objetos que estão próximos ao usuário.</span><span class="sxs-lookup"><span data-stu-id="caf5f-107">A high-resolution mipmap image is used for objects that are close to the user.</span></span> <span data-ttu-id="caf5f-108">Imagens de resolução mais baixa são usadas para o objeto que parece mais distante.</span><span class="sxs-lookup"><span data-stu-id="caf5f-108">Lower-resolution images are used as the object appears farther away.</span></span> <span data-ttu-id="caf5f-109">O mipmapping melhora a qualidade das texturas renderizadas às custas do uso de mais memória.</span><span class="sxs-lookup"><span data-stu-id="caf5f-109">Mipmapping improves the quality of rendered textures at the expense of using more memory.</span></span>

<span data-ttu-id="caf5f-110">O Direct3D representa os mipmaps como uma cadeia de superfícies anexadas.</span><span class="sxs-lookup"><span data-stu-id="caf5f-110">Direct3D represents mipmaps as a chain of attached surfaces.</span></span> <span data-ttu-id="caf5f-111">A textura de resolução mais alta fica no topo da cadeia e tem o próximo nível do mipmap como um anexo.</span><span class="sxs-lookup"><span data-stu-id="caf5f-111">The highest resolution texture is at the head of the chain and has the next level of the mipmap as an attachment.</span></span> <span data-ttu-id="caf5f-112">Por sua vez, esse nível possui um anexo que é o próximo nível no mipmap e assim por diante, até o nível mais baixo de resolução do mipmap.</span><span class="sxs-lookup"><span data-stu-id="caf5f-112">In turn, that level has an attachment that is the next level in the mipmap, and so on, down to the lowest resolution level of the mipmap.</span></span>

<span data-ttu-id="caf5f-113">As ilustrações a seguir mostram um exemplo desses níveis.</span><span class="sxs-lookup"><span data-stu-id="caf5f-113">The following illustrations shows an example of these levels.</span></span> <span data-ttu-id="caf5f-114">As texturas de bitmap representam uma placa em um contêiner em um jogo 3D em primeira pessoa.</span><span class="sxs-lookup"><span data-stu-id="caf5f-114">The bitmap textures represent a sign on a container in a 3D first-person game.</span></span> <span data-ttu-id="caf5f-115">Quando criada como um mipmap, a textura de resolução mais alta é primeira do conjunto.</span><span class="sxs-lookup"><span data-stu-id="caf5f-115">When created as a mipmap, the highest resolution texture is first in the set.</span></span> <span data-ttu-id="caf5f-116">Cada textura subsequente no conjunto de mipmaps é uma potência de 2 menor em altura e largura.</span><span class="sxs-lookup"><span data-stu-id="caf5f-116">Each succeeding texture in the mipmap set is smaller in height and width by a power of 2.</span></span> <span data-ttu-id="caf5f-117">Nesse caso, o mipmap de resolução máxima é de 256 pixels por 256 pixels.</span><span class="sxs-lookup"><span data-stu-id="caf5f-117">In this case, the maximum-resolution mipmap is 256 pixels by 256 pixels.</span></span> <span data-ttu-id="caf5f-118">A próxima textura é de 128x128.</span><span class="sxs-lookup"><span data-stu-id="caf5f-118">The next, texture is 128x128.</span></span> <span data-ttu-id="caf5f-119">A última textura na cadeia é de 64x64.</span><span class="sxs-lookup"><span data-stu-id="caf5f-119">The last texture in the chain is 64x64.</span></span>

<span data-ttu-id="caf5f-120">Essa placa tem uma distância máxima do qual fica visível.</span><span class="sxs-lookup"><span data-stu-id="caf5f-120">This sign has a maximum distance from which it is visible.</span></span> <span data-ttu-id="caf5f-121">Se o usuário começar distante da placa, o jogo exibirá a textura menor da cadeia de mipmaps, que neste caso é a textura de 64x64.</span><span class="sxs-lookup"><span data-stu-id="caf5f-121">If the user begins far away from the sign, the game displays the smallest texture in the mipmap chain, which in this case the 64x64 texture.</span></span>

![ilustração de uma textura de 64x64 de uma placa de perigo](images/mip1.jpg)

<span data-ttu-id="caf5f-123">Conforme o ponto de vista do usuário se aproxima da placa, as texturas de maior resolução da cadeia de mipmaps são usadas progressivamente.</span><span class="sxs-lookup"><span data-stu-id="caf5f-123">As the user moves the point of view closer to the sign, progressively higher-resolution textures in the mipmap chain are used.</span></span> <span data-ttu-id="caf5f-124">A resolução na ilustração a seguir é de 128x128.</span><span class="sxs-lookup"><span data-stu-id="caf5f-124">The resolution in the following illustration is 128x128.</span></span>

![ilustração de uma textura de 128x128 de uma placa de perigo](images/mip2.jpg)

<span data-ttu-id="caf5f-126">A textura de resolução mais alta é usada quando o ponto de vista do usuário é a distância mínima permitida de placa, conforme mostrado na ilustração a seguir.</span><span class="sxs-lookup"><span data-stu-id="caf5f-126">The highest resolution texture is used when the user's point of view is at the minimum allowable distance from the sign, as shown in the following illustration.</span></span>

![ilustração de uma textura de 256x256 de uma placa de perigo](images/mip3.jpg)

<span data-ttu-id="caf5f-128">Essa é uma maneira mais eficiente de simular perspectiva para texturas.</span><span class="sxs-lookup"><span data-stu-id="caf5f-128">This is a more efficient way of simulating perspective for textures.</span></span> <span data-ttu-id="caf5f-129">Em vez de renderizar uma textura em várias resoluções, é mais rápido usar várias texturas em resoluções variadas.</span><span class="sxs-lookup"><span data-stu-id="caf5f-129">Rather than render a single texture at many resolutions, it is faster to use multiple textures at varying resolutions.</span></span>

<span data-ttu-id="caf5f-130">O Direct3D pode avaliar qual textura de um conjunto de mipmaps tem a resolução mais próxima do resultado desejado e pode mapear pixels para seu espaço de texel.</span><span class="sxs-lookup"><span data-stu-id="caf5f-130">Direct3D can assess which texture in a mipmap set is the closest resolution to the desired output, and it can map pixels into its texel space.</span></span> <span data-ttu-id="caf5f-131">Se a resolução da imagem final é entre as resoluções de texturas no conjunto de mipmaps, o Direct3D pode examinar texels nos dois mipmaps e mesclar seus valores de cor.</span><span class="sxs-lookup"><span data-stu-id="caf5f-131">If the resolution of the final image is between the resolutions of the textures in the mipmap set, Direct3D can examine texels in both mipmaps and blend their color values together.</span></span>

<span data-ttu-id="caf5f-132">Para usar mipmaps, seu aplicativo deve criar um conjunto de mipmaps.</span><span class="sxs-lookup"><span data-stu-id="caf5f-132">To use mipmaps, your application must build a set of mipmaps.</span></span> <span data-ttu-id="caf5f-133">Os aplicativos aplicam mipmaps selecionando o conjunto de mipmaps como a primeira textura no conjunto de texturas atuais.</span><span class="sxs-lookup"><span data-stu-id="caf5f-133">Applications apply mipmaps by selecting the mipmap set as the first texture in the set of current textures.</span></span> <span data-ttu-id="caf5f-134">Para obter mais informações, consulte [mesclagem de textura (Direct3D 9)](texture-blending.md).</span><span class="sxs-lookup"><span data-stu-id="caf5f-134">For more information, see [Texture Blending (Direct3D 9)](texture-blending.md).</span></span>

<span data-ttu-id="caf5f-135">Em seguida, seu aplicativo deve definir o método de filtragem que o Direct3D usa para fazer a amostragem de texels.</span><span class="sxs-lookup"><span data-stu-id="caf5f-135">Next, your application must set the filtering method that Direct3D uses to sample texels.</span></span> <span data-ttu-id="caf5f-136">O método mais rápido de filtragem de mipmaps é fazer com que o Direct3D selecione o texel mais próximo.</span><span class="sxs-lookup"><span data-stu-id="caf5f-136">The fastest method of mipmap filtering is to have Direct3D select the nearest texel.</span></span> <span data-ttu-id="caf5f-137">Use o \_ valor enumerado do ponto de D3DTEXF para selecioná-lo.</span><span class="sxs-lookup"><span data-stu-id="caf5f-137">Use the D3DTEXF\_POINT enumerated value to select this.</span></span> <span data-ttu-id="caf5f-138">O Direct3D pode produzir melhores resultados de filtragem se seu aplicativo usar o \_ valor enumerado D3DTEXF linear.</span><span class="sxs-lookup"><span data-stu-id="caf5f-138">Direct3D can produce better filtering results if your application uses the D3DTEXF\_LINEAR enumerated value.</span></span> <span data-ttu-id="caf5f-139">Isso seleciona o mipmap mais próximo e depois calcula uma média ponderada dos texels ao redor do local na textura para a qual o pixel atual é mapeado.</span><span class="sxs-lookup"><span data-stu-id="caf5f-139">This selects the nearest mipmap, and then computes a weighted average of the texels surrounding the location in the texture to which the current pixel maps.</span></span>

<span data-ttu-id="caf5f-140">As texturas de mipmap são usadas em cenas 3D para reduzir o tempo necessário para renderizar uma cena.</span><span class="sxs-lookup"><span data-stu-id="caf5f-140">Mipmap textures are used in 3D scenes to decrease the time required to render a scene.</span></span> <span data-ttu-id="caf5f-141">Eles também melhoram o realismo da cena.</span><span class="sxs-lookup"><span data-stu-id="caf5f-141">They also improve the scene's realism.</span></span> <span data-ttu-id="caf5f-142">No entanto, eles geralmente exigem grandes quantidades de memória.</span><span class="sxs-lookup"><span data-stu-id="caf5f-142">However, they often require large amounts of memory.</span></span>

## <a name="creating-a-set-of-mipmaps"></a><span data-ttu-id="caf5f-143">Criando um conjunto de mipmaps</span><span class="sxs-lookup"><span data-stu-id="caf5f-143">Creating a Set of Mipmaps</span></span>

<span data-ttu-id="caf5f-144">O exemplo a seguir mostra como seu aplicativo pode chamar o método [**IDirect3DDevice9:: CreateTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createtexture) para criar uma cadeia de cinco níveis de mipmap: 256x256, 128x128, 64 x 64, 32x32 e 16x16.</span><span class="sxs-lookup"><span data-stu-id="caf5f-144">The following example shows how your application can call the [**IDirect3DDevice9::CreateTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createtexture) method to build a chain of five mipmap levels: 256x256, 128x128, 64x64, 32x32, and 16x16.</span></span>


```
// This code example assumes that m_d3dDevice is a
// valid pointer to a IDirect3DDevice9 interface

IDirect3DTexture9 * pMipMap;
m_pD3DDevice->CreateTexture(256, 256, 5, 0, D3DFMT_R8G8B8, 
    D3DPOOL_MANAGED, &pMipMap);
```



<span data-ttu-id="caf5f-145">Os dois primeiros parâmetros que são aceitos por [**IDirect3DDevice9:: CreateTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createtexture) são o tamanho e a largura da textura de nível superior.</span><span class="sxs-lookup"><span data-stu-id="caf5f-145">The first two parameters that are accepted by [**IDirect3DDevice9::CreateTexture**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createtexture) are the size and width of the top-level texture.</span></span> <span data-ttu-id="caf5f-146">O terceiro parâmetro especifica o número de níveis na textura.</span><span class="sxs-lookup"><span data-stu-id="caf5f-146">The third parameter specifies the number of levels in the texture.</span></span> <span data-ttu-id="caf5f-147">Se você definir isso como zero, o Direct3D criará uma cadeia de superfícies, cada uma com uma potência de dois menores do que a anterior, até o menor tamanho possível de 1x1.</span><span class="sxs-lookup"><span data-stu-id="caf5f-147">If you set this to zero, Direct3D creates a chain of surfaces, each a power of two smaller than the previous one, down to the smallest possible size of 1x1.</span></span> <span data-ttu-id="caf5f-148">O quarto parâmetro especifica o uso para esse recurso; Nesse caso, 0 é especificado para indicar nenhum uso específico para o recurso.</span><span class="sxs-lookup"><span data-stu-id="caf5f-148">The fourth parameter specifies the usage for this resource; in this case, 0 is specified to indicate no specific usage for the resource.</span></span> <span data-ttu-id="caf5f-149">O quinto parâmetro especifica o formato da superfície para a textura.</span><span class="sxs-lookup"><span data-stu-id="caf5f-149">The fifth parameter specifies the surface format for the texture.</span></span> <span data-ttu-id="caf5f-150">Use um valor do tipo enumerado [D3DFORMAT](d3dformat.md) para esse parâmetro.</span><span class="sxs-lookup"><span data-stu-id="caf5f-150">Use a value from the [D3DFORMAT](d3dformat.md) enumerated type for this parameter.</span></span> <span data-ttu-id="caf5f-151">O sexto parâmetro especifica um membro do tipo enumerado [**D3DPOOL**](./d3dpool.md) indicando a classe de memória na qual o recurso criado será colocado.</span><span class="sxs-lookup"><span data-stu-id="caf5f-151">The sixth parameter specifies a member of the [**D3DPOOL**](./d3dpool.md) enumerated type indicating the memory class into which to place the created resource.</span></span> <span data-ttu-id="caf5f-152">A menos que você esteja usando texturas dinâmicas, o D3DPOOL \_ gerenciado é recomendado.</span><span class="sxs-lookup"><span data-stu-id="caf5f-152">Unless you are using dynamic textures, D3DPOOL\_MANAGED is recommended.</span></span> <span data-ttu-id="caf5f-153">O parâmetro final pega o endereço de um ponteiro para uma interface [**IDirect3DTexture9**](/windows/win32/api/d3d9helper/nn-d3d9helper-idirect3dtexture9) .</span><span class="sxs-lookup"><span data-stu-id="caf5f-153">The final parameter takes the address of a pointer to an [**IDirect3DTexture9**](/windows/win32/api/d3d9helper/nn-d3d9helper-idirect3dtexture9) interface.</span></span>

> [!Note]  
> <span data-ttu-id="caf5f-154">Cada superfície em uma cadeia de mipmap tem dimensões que são uma metade da superfície anterior na cadeia.</span><span class="sxs-lookup"><span data-stu-id="caf5f-154">Each surface in a mipmap chain has dimensions that are one-half that of the previous surface in the chain.</span></span> <span data-ttu-id="caf5f-155">Se o mipmap de nível superior tiver dimensões de 256x128, as dimensões do mipmap do segundo nível serão de 128 x64, do terceiro nível serão de 64x32 e assim por diante, até 1x1.</span><span class="sxs-lookup"><span data-stu-id="caf5f-155">If the top-level mipmap has dimensions of 256x128, the dimensions of the second-level mipmap are 128x64, the third-level are 64x32, and so on, down to 1x1.</span></span> <span data-ttu-id="caf5f-156">Você não pode solicitar um número de níveis de mipmap em Níveis que possam fazer com que a largura ou altura de qualquer mipmap da cadeia seja menor que 1.</span><span class="sxs-lookup"><span data-stu-id="caf5f-156">You cannot request a number of mipmap levels in Levels that would cause either the width or height of any mipmap in the chain to be smaller than 1.</span></span> <span data-ttu-id="caf5f-157">No caso simples de uma superfície de mipmap de nível superior de 4x2, o valor máximo permitido para Níveis é três.</span><span class="sxs-lookup"><span data-stu-id="caf5f-157">In the simple case of a 4x2 top-level mipmap surface, the maximum value allowed for Levels is three.</span></span> <span data-ttu-id="caf5f-158">As dimensões de nível superior são de 4x2, as dimensões do segundo nível são de 2x1 e as dimensões do terceiro nível são de 1x1.</span><span class="sxs-lookup"><span data-stu-id="caf5f-158">The top-level dimensions are 4x2, the second-level dimensions are 2x1, and the dimensions for the third level are 1x1.</span></span> <span data-ttu-id="caf5f-159">Um valor maior que 3 em Níveis resulta em um valor fracionário na altura do mipmap de segundo nível e, portanto, não permitido.</span><span class="sxs-lookup"><span data-stu-id="caf5f-159">A value larger than 3 in Levels results in a fractional value in the height of the second-level mipmap, and is therefore disallowed.</span></span>

 

## <a name="selecting-and-displaying-a-mipmap"></a><span data-ttu-id="caf5f-160">Selecionando e exibindo um mipmap</span><span class="sxs-lookup"><span data-stu-id="caf5f-160">Selecting and Displaying a Mipmap</span></span>

<span data-ttu-id="caf5f-161">Chame o método [**IDirect3DDevice9:: SetTexture**](/windows/desktop/api) para definir o conjunto de textura mipmap como a primeira textura na lista de texturas atuais.</span><span class="sxs-lookup"><span data-stu-id="caf5f-161">Call the [**IDirect3DDevice9::SetTexture**](/windows/desktop/api) method to set the mipmap texture set as the first texture in the list of current textures.</span></span> <span data-ttu-id="caf5f-162">Para obter mais informações, consulte [mesclagem de textura (Direct3D 9)](texture-blending.md).</span><span class="sxs-lookup"><span data-stu-id="caf5f-162">For more information, see [Texture Blending (Direct3D 9)](texture-blending.md).</span></span>

<span data-ttu-id="caf5f-163">Depois que o aplicativo seleciona o conjunto de textura mipmap, ele deve atribuir valores do tipo enumerado [**D3DTEXTUREFILTERTYPE**](./d3dtexturefiltertype.md) ao \_ estado de amostra D3DSAMP MIPFILTER.</span><span class="sxs-lookup"><span data-stu-id="caf5f-163">After your application selects the mipmap texture set, it must assign values from the [**D3DTEXTUREFILTERTYPE**](./d3dtexturefiltertype.md) enumerated type to the D3DSAMP\_MIPFILTER sampler state.</span></span> <span data-ttu-id="caf5f-164">Em seguida, o Direct3D executa automaticamente a filtragem de textura mipmap.</span><span class="sxs-lookup"><span data-stu-id="caf5f-164">Direct3D then automatically performs mipmap texture filtering.</span></span> <span data-ttu-id="caf5f-165">Habilitar a filtragem de textura mipmap é demonstrado no exemplo de código a seguir.</span><span class="sxs-lookup"><span data-stu-id="caf5f-165">Enabling mipmap texture filtering is demonstrated in the following code example.</span></span>


```
m_pD3DDevice->SetTexture(0, pMipMap);
m_pD3DDevice->SetSamplerState(0, D3DSAMP_MIPFILTER, D3DTEXF_POINT);
```



<span data-ttu-id="caf5f-166">Seu aplicativo também pode percorrer manualmente uma cadeia de superfícies mipmap usando o método [**IDirect3DTexture9:: GetSurfaceLevel**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dtexture9-getsurfacelevel) e especificando o nível de mipmap a ser recuperado.</span><span class="sxs-lookup"><span data-stu-id="caf5f-166">Your application can also manually traverse a chain of mipmap surfaces by using the [**IDirect3DTexture9::GetSurfaceLevel**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dtexture9-getsurfacelevel) method and specifying the mipmap level to retrieve.</span></span> <span data-ttu-id="caf5f-167">O exemplo a seguir percorre uma cadeia de mipmap das resoluções mais altas para a mais baixa.</span><span class="sxs-lookup"><span data-stu-id="caf5f-167">The following example traverses a mipmap chain from highest to lowest resolutions.</span></span>


```
IDirect3DSurface9 * pSurfaceLevel;
for (int iLevel = 0; iLevel < pMipMap->GetLevelCount(); iLevel++)
{
    pMipMap->GetSurfaceLevel(iLevel, &pSurfaceLevel);
    // Process this level
    pSurfaceLevel->Release();
}
```



<span data-ttu-id="caf5f-168">Os aplicativos precisam atravessar manualmente uma cadeia mipmap para carregar dados de bitmap em cada superfície na cadeia.</span><span class="sxs-lookup"><span data-stu-id="caf5f-168">Applications need to manually traverse a mipmap chain to load bitmap data into each surface in the chain.</span></span> <span data-ttu-id="caf5f-169">Normalmente, esse é o único motivo para atravessar a cadeia.</span><span class="sxs-lookup"><span data-stu-id="caf5f-169">This is typically the only reason to traverse the chain.</span></span> <span data-ttu-id="caf5f-170">Um aplicativo pode recuperar o número de níveis em um mipmap chamando [**IDirect3DBaseTexture9:: GetLevelCount**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dbasetexture9-getlevelcount).</span><span class="sxs-lookup"><span data-stu-id="caf5f-170">An application can retrieve the number of levels in a mipmap by calling [**IDirect3DBaseTexture9::GetLevelCount**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dbasetexture9-getlevelcount).</span></span>

## <a name="related-topics"></a><span data-ttu-id="caf5f-171">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="caf5f-171">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="caf5f-172">Filtragem de textura</span><span class="sxs-lookup"><span data-stu-id="caf5f-172">Texture Filtering</span></span>](texture-filtering.md)
</dt> </dl>

 

 
