---
title: Sobre troca dinâmica de dados
description: Este tópico discute a transferência de dados entre aplicativos.
ms.assetid: 0bcd8de4-a6f0-4f2a-8b9d-0b1b638925fb
keywords:
- Troca dinâmica de dados (DDE), sobre
- DDE (troca dinâmica de dados), sobre
- troca de dados, troca dinâmica de dados (DDE)
- Troca dinâmica de dados (DDE), vinculando a dados em tempo real
- DDE (troca dinâmica de dados), vinculando a dados em tempo real
- Troca dinâmica de dados (DDE), criando documentos compostos
- DDE (troca dinâmica de dados), criando documentos compostos
- Troca dinâmica de dados (DDE), consultas de dados
- DDE (troca dinâmica de dados), consultas de dados
- Troca dinâmica de dados (DDE), exemplos
- DDE (troca dinâmica de dados), exemplos
- Troca dinâmica de dados (DDE), representação
- DDE (troca dinâmica de dados), representação
- Troca dinâmica de dados (DDE), mensagens
- DDE (troca dinâmica de dados), mensagens
- Troca dinâmica de dados (DDE), Atoms
- DDE (troca dinâmica de dados), Atoms
- Troca dinâmica de dados (DDE), objetos de memória compartilhada
- DDE (troca dinâmica de dados), objetos de memória compartilhada
- Troca dinâmica de dados (DDE), funções de empacotamento de parâmetro
- DDE (troca dinâmica de dados), funções de empacotamento de parâmetro
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7d38574e9182255e8f6761520aea60575d8affbc
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104366513"
---
# <a name="about-dynamic-data-exchange"></a><span data-ttu-id="123f1-124">Sobre troca dinâmica de dados</span><span class="sxs-lookup"><span data-stu-id="123f1-124">About Dynamic Data Exchange</span></span>

<span data-ttu-id="123f1-125">O Windows fornece vários métodos para transferir dados entre aplicativos.</span><span class="sxs-lookup"><span data-stu-id="123f1-125">Windows provides several methods for transferring data between applications.</span></span> <span data-ttu-id="123f1-126">Um método é usar o protocolo troca dinâmica de dados (DDE).</span><span class="sxs-lookup"><span data-stu-id="123f1-126">One method is to use the Dynamic Data Exchange (DDE) protocol.</span></span> <span data-ttu-id="123f1-127">O protocolo DDE é um conjunto de mensagens e diretrizes.</span><span class="sxs-lookup"><span data-stu-id="123f1-127">The DDE protocol is a set of messages and guidelines.</span></span> <span data-ttu-id="123f1-128">Ele envia mensagens entre aplicativos que compartilham dados e usa a memória compartilhada para trocar dados entre aplicativos.</span><span class="sxs-lookup"><span data-stu-id="123f1-128">It sends messages between applications that share data and uses shared memory to exchange data between applications.</span></span> <span data-ttu-id="123f1-129">Os aplicativos podem usar o protocolo DDE para transferências de dados one-time e para trocas contínuas nas quais os aplicativos enviam atualizações entre si à medida que novos dados ficam disponíveis.</span><span class="sxs-lookup"><span data-stu-id="123f1-129">Applications can use the DDE protocol for one-time data transfers and for continuous exchanges in which applications send updates to one another as new data becomes available.</span></span>

<span data-ttu-id="123f1-130">O Windows também dá suporte à DDEML (biblioteca de gerenciamento de troca dinâmica de dados).</span><span class="sxs-lookup"><span data-stu-id="123f1-130">Windows also supports the Dynamic Data Exchange Management Library (DDEML).</span></span> <span data-ttu-id="123f1-131">O DDEML é uma DLL (biblioteca de vínculo dinâmico) que os aplicativos podem usar para compartilhar dados.</span><span class="sxs-lookup"><span data-stu-id="123f1-131">The DDEML is a dynamic-link library (DLL) that applications can use to share data.</span></span> <span data-ttu-id="123f1-132">O DDEML fornece funções e mensagens que simplificam a tarefa de adicionar capacidade DDE a um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="123f1-132">The DDEML provides functions and messages that simplify the task of adding DDE capability to an application.</span></span> <span data-ttu-id="123f1-133">Em vez de enviar, postar e processar mensagens DDE diretamente, um aplicativo usa as funções de DDEML para gerenciar conversas DDE.</span><span class="sxs-lookup"><span data-stu-id="123f1-133">Instead of sending, posting, and processing DDE messages directly, an application uses the DDEML functions to manage DDE conversations.</span></span> <span data-ttu-id="123f1-134">(Uma conversa DDE é a interação entre aplicativos cliente e servidor.)</span><span class="sxs-lookup"><span data-stu-id="123f1-134">(A DDE conversation is the interaction between client and server applications.)</span></span>

<span data-ttu-id="123f1-135">O DDEML também fornece um recurso para gerenciar as cadeias de caracteres e os dados que os aplicativos DDE compartilham.</span><span class="sxs-lookup"><span data-stu-id="123f1-135">The DDEML also provides a facility for managing the strings and data that DDE applications share.</span></span> <span data-ttu-id="123f1-136">Em vez de usar Atoms e ponteiros para objetos de memória compartilhados, os aplicativos DDE criam e trocam identificadores de cadeias de caracteres, que identificam cadeias e identificadores de dados, que identificam objetos de memória.</span><span class="sxs-lookup"><span data-stu-id="123f1-136">Instead of using atoms and pointers to shared memory objects, DDE applications create and exchange string handles, which identify strings, and data handles, which identify memory objects.</span></span> <span data-ttu-id="123f1-137">O DDEML também possibilita que um aplicativo de servidor registre os nomes de serviço com suporte.</span><span class="sxs-lookup"><span data-stu-id="123f1-137">The DDEML also makes it possible for a server application to register the service names it supports.</span></span> <span data-ttu-id="123f1-138">Os nomes são transmitidos para outros aplicativos no sistema, que podem usar os nomes para se conectar ao servidor.</span><span class="sxs-lookup"><span data-stu-id="123f1-138">The names are broadcast to other applications in the system, which can use the names to connect to the server.</span></span> <span data-ttu-id="123f1-139">Além disso, o DDEML garante a compatibilidade entre aplicativos DDE, forçando-os a implementar o protocolo DDE de maneira consistente.</span><span class="sxs-lookup"><span data-stu-id="123f1-139">Moreover, the DDEML ensures compatibility among DDE applications by forcing them to implement the DDE protocol in a consistent manner.</span></span>

<span data-ttu-id="123f1-140">Os aplicativos existentes que usam o protocolo DDE baseado em mensagem são totalmente compatíveis com aqueles que usam o DDEML.</span><span class="sxs-lookup"><span data-stu-id="123f1-140">Existing applications that use the message-based DDE protocol are fully compatible with those that use the DDEML.</span></span> <span data-ttu-id="123f1-141">Ou seja, um aplicativo que usa o DDE baseado em mensagem pode estabelecer conversas e executar transações com aplicativos que usam o DDEML.</span><span class="sxs-lookup"><span data-stu-id="123f1-141">That is, an application that uses message-based DDE can establish conversations and perform transactions with applications that use the DDEML.</span></span> <span data-ttu-id="123f1-142">Devido às muitas vantagens do DDEML, os novos aplicativos devem usá-lo em vez de mensagens DDE.</span><span class="sxs-lookup"><span data-stu-id="123f1-142">Because of the many advantages of the DDEML, new applications should use it rather than the DDE messages.</span></span> <span data-ttu-id="123f1-143">Para usar os elementos de API do DDEML, você deve incluir o arquivo de cabeçalho DDEML em seus arquivos de origem, vincular com a biblioteca DDEML e garantir que a biblioteca de vínculo dinâmico de DDEML esteja no caminho de pesquisa do sistema.</span><span class="sxs-lookup"><span data-stu-id="123f1-143">To use the API elements of the DDEML, you must include the DDEML header file in your source files, link with the DDEML library, and ensure that the DDEML dynamic-link library is in the system's search path.</span></span>

<span data-ttu-id="123f1-144">Os tópicos a seguir são discutidos nesta seção.</span><span class="sxs-lookup"><span data-stu-id="123f1-144">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="123f1-145">Protocolo troca dinâmica de dados</span><span class="sxs-lookup"><span data-stu-id="123f1-145">Dynamic Data Exchange Protocol</span></span>](#dynamic-data-exchange-protocol)
-   [<span data-ttu-id="123f1-146">Usos do para Windows troca dinâmica de dados</span><span class="sxs-lookup"><span data-stu-id="123f1-146">Uses for Windows Dynamic Data Exchange</span></span>](#uses-for-windows-dynamic-data-exchange)
-   [<span data-ttu-id="123f1-147">troca dinâmica de dados do ponto de vista do usuário</span><span class="sxs-lookup"><span data-stu-id="123f1-147">Dynamic Data Exchange from the User's Point of View</span></span>](#dynamic-data-exchange-from-the-users-point-of-view)
-   [<span data-ttu-id="123f1-148">Conceitos de troca dinâmica de dados</span><span class="sxs-lookup"><span data-stu-id="123f1-148">Dynamic Data Exchange Concepts</span></span>](#dynamic-data-exchange-concepts)
    -   [<span data-ttu-id="123f1-149">Cliente, servidor e conversa</span><span class="sxs-lookup"><span data-stu-id="123f1-149">Client, Server, and Conversation</span></span>](#client-server-and-conversation)
    -   [<span data-ttu-id="123f1-150">Nomes de aplicativo, tópico e item</span><span class="sxs-lookup"><span data-stu-id="123f1-150">Application, Topic, and Item Names</span></span>](#application-topic-and-item-names)
    -   [<span data-ttu-id="123f1-151">O tópico System</span><span class="sxs-lookup"><span data-stu-id="123f1-151">The System Topic</span></span>](#the-system-topic)
    -   [<span data-ttu-id="123f1-152">Links de dados permanentes</span><span class="sxs-lookup"><span data-stu-id="123f1-152">Permanent Data Links</span></span>](#permanent-data-links)
    -   [<span data-ttu-id="123f1-153">Atoms e objetos de memória compartilhada</span><span class="sxs-lookup"><span data-stu-id="123f1-153">Atoms and Shared Memory Objects</span></span>](#atoms-and-shared-memory-objects)
-   [<span data-ttu-id="123f1-154">Visão geral de mensagens de troca dinâmica de dados</span><span class="sxs-lookup"><span data-stu-id="123f1-154">Dynamic Data Exchange Messages Overview</span></span>](#dynamic-data-exchange-messages-overview)
-   [<span data-ttu-id="123f1-155">Fluxo de mensagens troca dinâmica de dados</span><span class="sxs-lookup"><span data-stu-id="123f1-155">Dynamic Data Exchange Message Flow</span></span>](#dynamic-data-exchange-message-flow)
-   [<span data-ttu-id="123f1-156">Funções de empacotamento de parâmetro</span><span class="sxs-lookup"><span data-stu-id="123f1-156">Parameter Packing Functions</span></span>](#parameter-packing-functions)
-   [<span data-ttu-id="123f1-157">troca dinâmica de dados e representação</span><span class="sxs-lookup"><span data-stu-id="123f1-157">Dynamic Data Exchange and Impersonation</span></span>](#dynamic-data-exchange-and-impersonation)

## <a name="dynamic-data-exchange-protocol"></a><span data-ttu-id="123f1-158">Protocolo troca dinâmica de dados</span><span class="sxs-lookup"><span data-stu-id="123f1-158">Dynamic Data Exchange Protocol</span></span>

<span data-ttu-id="123f1-159">Como o Windows tem uma arquitetura baseada em mensagens, a passagem de mensagens é o método mais apropriado para transferir automaticamente as informações entre os aplicativos.</span><span class="sxs-lookup"><span data-stu-id="123f1-159">Because Windows has a message-based architecture, passing messages is the most appropriate method for automatically transferring information between applications.</span></span> <span data-ttu-id="123f1-160">No entanto, as mensagens contêm apenas dois parâmetros (*wParam* e *lParam*) para a passagem de dados.</span><span class="sxs-lookup"><span data-stu-id="123f1-160">However, messages contain only two parameters (*wParam* and *lParam*) for passing data.</span></span> <span data-ttu-id="123f1-161">Como resultado, esses parâmetros devem se referir indiretamente a outras partes de dados quando mais de algumas palavras de informações forem passadas entre os aplicativos.</span><span class="sxs-lookup"><span data-stu-id="123f1-161">As a result, these parameters must refer indirectly to other pieces of data when more than a few words of information pass between applications.</span></span> <span data-ttu-id="123f1-162">O protocolo DDE define exatamente como os aplicativos devem usar os parâmetros *wParam* e *lParam* para passar grandes partes de dados por meio de átomos globais e identificadores de memória compartilhada.</span><span class="sxs-lookup"><span data-stu-id="123f1-162">The DDE protocol defines exactly how applications should use the *wParam* and *lParam* parameters to pass larger pieces of data by means of global atoms and shared memory handles.</span></span> <span data-ttu-id="123f1-163">O protocolo DDE tem regras específicas para alocar e excluir Atoms globais e objetos de memória compartilhados.</span><span class="sxs-lookup"><span data-stu-id="123f1-163">The DDE protocol has specific rules for allocating and deleting global atoms and shared memory objects.</span></span>

<span data-ttu-id="123f1-164">Um Atom global é uma referência a uma cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="123f1-164">A global atom is a reference to a character string.</span></span> <span data-ttu-id="123f1-165">No protocolo DDE, os Atoms identificam os aplicativos que trocam dados, a natureza dos dados que estão sendo trocados e os próprios itens de dados.</span><span class="sxs-lookup"><span data-stu-id="123f1-165">In the DDE protocol, atoms identify the applications exchanging data, the nature of the data being exchanged, and the data items themselves.</span></span> <span data-ttu-id="123f1-166">Para obter mais informações sobre Atoms, consulte [sobre Atoms](about-atom-tables.md).</span><span class="sxs-lookup"><span data-stu-id="123f1-166">For more information about atoms, see [About Atoms](about-atom-tables.md).</span></span>

## <a name="uses-for-windows-dynamic-data-exchange"></a><span data-ttu-id="123f1-167">Usos do para Windows troca dinâmica de dados</span><span class="sxs-lookup"><span data-stu-id="123f1-167">Uses for Windows Dynamic Data Exchange</span></span>

<span data-ttu-id="123f1-168">O DDE é mais apropriado para trocas de dados que não exigem interação contínua do usuário.</span><span class="sxs-lookup"><span data-stu-id="123f1-168">DDE is most appropriate for data exchanges that do not require ongoing user interaction.</span></span> <span data-ttu-id="123f1-169">Normalmente, um aplicativo fornece um método para que o usuário estabeleça o vínculo entre os aplicativos trocando dados.</span><span class="sxs-lookup"><span data-stu-id="123f1-169">Usually, an application provides a method for the user to establish the link between the applications exchanging data.</span></span> <span data-ttu-id="123f1-170">Quando esse link é estabelecido, no entanto, os aplicativos trocam dados sem o envolvimento adicional do usuário.</span><span class="sxs-lookup"><span data-stu-id="123f1-170">Once that link is established, however, the applications exchange data without further user involvement.</span></span>

<span data-ttu-id="123f1-171">O DDE pode ser usado para implementar uma ampla gama de recursos de aplicativos, por exemplo:</span><span class="sxs-lookup"><span data-stu-id="123f1-171">DDE can be used to implement a broad range of application features — for example:</span></span>

-   <span data-ttu-id="123f1-172">Vinculação a dados em tempo real, como atualizações de mercado de ações, instrumentos científicos ou controle de processo.</span><span class="sxs-lookup"><span data-stu-id="123f1-172">Linking to real-time data, such as to stock market updates, scientific instruments, or process control.</span></span>
-   <span data-ttu-id="123f1-173">Criar documentos compostos, como um documento de processamento de texto que inclui um gráfico produzido por um aplicativo gráfico.</span><span class="sxs-lookup"><span data-stu-id="123f1-173">Creating compound documents, such as a word processing document that includes a chart produced by a graphics application.</span></span> <span data-ttu-id="123f1-174">Usando o DDE, o gráfico será alterado quando os dados de origem forem alterados, enquanto o restante do documento permanecerá o mesmo.</span><span class="sxs-lookup"><span data-stu-id="123f1-174">Using DDE, the chart will change when the source data is changed, while the rest of the document remains the same.</span></span>
-   <span data-ttu-id="123f1-175">Executar consultas de dados entre aplicativos, como uma planilha consultando um banco de dado para contas vencidas.</span><span class="sxs-lookup"><span data-stu-id="123f1-175">Performing data queries between applications, such as a spreadsheet querying a database for accounts past due.</span></span>

## <a name="dynamic-data-exchange-from-the-users-point-of-view"></a><span data-ttu-id="123f1-176">troca dinâmica de dados do ponto de vista do usuário</span><span class="sxs-lookup"><span data-stu-id="123f1-176">Dynamic Data Exchange from the User's Point of View</span></span>

<span data-ttu-id="123f1-177">O exemplo a seguir ilustra como dois aplicativos DDE podem cooperar, como visto no ponto de vista do usuário.</span><span class="sxs-lookup"><span data-stu-id="123f1-177">The following example illustrates how two DDE applications can cooperate, as seen from the user's point of view.</span></span>

<span data-ttu-id="123f1-178">Um usuário de planilha deseja usar o Microsoft Excel para controlar o preço de um estoque específico na bolsa de ações de Nova York.</span><span class="sxs-lookup"><span data-stu-id="123f1-178">A spreadsheet user wants to use Microsoft Excel to track the price of a particular stock on the New York Stock Exchange.</span></span> <span data-ttu-id="123f1-179">O usuário tem um aplicativo chamado quote que, por sua vez, tem acesso aos dados do NYSE.</span><span class="sxs-lookup"><span data-stu-id="123f1-179">The user has an application called Quote that in turn has access to NYSE data.</span></span> <span data-ttu-id="123f1-180">A conversa DDE entre o Excel e as cotações ocorre da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="123f1-180">The DDE conversation between Excel and Quote takes place as follows:</span></span>

-   <span data-ttu-id="123f1-181">O usuário inicia a conversa fornecendo o nome do aplicativo (cotação) que fornecerá os dados e o tópico específico de interesse (NYSE).</span><span class="sxs-lookup"><span data-stu-id="123f1-181">The user initiates the conversation by supplying the name of the application (Quote) that will supply the data and the particular topic of interest (NYSE).</span></span> <span data-ttu-id="123f1-182">A conversa DDE resultante é usada para solicitar aspas em ações específicas.</span><span class="sxs-lookup"><span data-stu-id="123f1-182">The resulting DDE conversation is used to request quotes on specific stocks.</span></span>
-   <span data-ttu-id="123f1-183">O Excel transmite os nomes do aplicativo e do tópico para todos os aplicativos DDE atualmente em execução no sistema.</span><span class="sxs-lookup"><span data-stu-id="123f1-183">Excel broadcasts the application and topic names to all DDE applications currently running in the system.</span></span> <span data-ttu-id="123f1-184">A cotação responde, estabelecendo uma conversa com o Excel sobre o tópico da NYSE.</span><span class="sxs-lookup"><span data-stu-id="123f1-184">Quote responds, establishing a conversation with Excel about the NYSE topic.</span></span>
-   <span data-ttu-id="123f1-185">Em seguida, o usuário pode criar uma fórmula de planilha em uma célula que solicita que a planilha seja atualizada automaticamente sempre que uma determinada cotação de ações for alterada.</span><span class="sxs-lookup"><span data-stu-id="123f1-185">The user can then create a spreadsheet formula in a cell that requests that the spreadsheet be automatically updated whenever a particular stock quotation changes.</span></span> <span data-ttu-id="123f1-186">Por exemplo, o usuário pode solicitar uma atualização automática sempre que uma alteração ocorrer no preço de venda de ZAXX Stock especificando a seguinte fórmula do Excel: = ' quote ' \| ' NYSE '! ZAXX</span><span class="sxs-lookup"><span data-stu-id="123f1-186">For example, the user could request an automatic update whenever a change occurs in the selling price of ZAXX stock by specifying the following Excel formula: ='Quote'\|'NYSE'!ZAXX</span></span>
-   <span data-ttu-id="123f1-187">O usuário pode encerrar a atualização automática da cotação de ações do ZAXX a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="123f1-187">The user can terminate the automatic updating of the ZAXX stock quotation at any time.</span></span> <span data-ttu-id="123f1-188">Outros links de dados que foram estabelecidos separadamente (como para Cotações para outras ações) ainda permanecerão ativos na mesma conversa da NYSE.</span><span class="sxs-lookup"><span data-stu-id="123f1-188">Other data links that were established separately (such as for quotations for other stocks) still will remain active under the same NYSE conversation.</span></span>
-   <span data-ttu-id="123f1-189">O usuário também pode encerrar toda a conversa entre o Excel e as aspas no tópico da NYSE, para que não seja possível estabelecer links de dados específicos sobre esse tópico sem iniciar uma nova conversa.</span><span class="sxs-lookup"><span data-stu-id="123f1-189">The user can also terminate the entire conversation between Excel and Quote on the NYSE topic, so that no specific data links on that topic can be established without initiating a new conversation.</span></span>

## <a name="dynamic-data-exchange-concepts"></a><span data-ttu-id="123f1-190">Conceitos de troca dinâmica de dados</span><span class="sxs-lookup"><span data-stu-id="123f1-190">Dynamic Data Exchange Concepts</span></span>

<span data-ttu-id="123f1-191">As seções a seguir explicam os conceitos e a terminologia importantes que são fundamentais para compreender o intercâmbio dinâmico de dados.</span><span class="sxs-lookup"><span data-stu-id="123f1-191">The following sections explain the important concepts and terminology that are key to understanding dynamic data exchange.</span></span>

-   [<span data-ttu-id="123f1-192">Cliente, servidor e conversa</span><span class="sxs-lookup"><span data-stu-id="123f1-192">Client, Server, and Conversation</span></span>](#client-server-and-conversation)
-   [<span data-ttu-id="123f1-193">Nomes de aplicativo, tópico e item</span><span class="sxs-lookup"><span data-stu-id="123f1-193">Application, Topic, and Item Names</span></span>](#application-topic-and-item-names)
-   [<span data-ttu-id="123f1-194">O tópico System</span><span class="sxs-lookup"><span data-stu-id="123f1-194">The System Topic</span></span>](#the-system-topic)
-   [<span data-ttu-id="123f1-195">Links de dados permanentes</span><span class="sxs-lookup"><span data-stu-id="123f1-195">Permanent Data Links</span></span>](#permanent-data-links)
-   [<span data-ttu-id="123f1-196">Atoms e objetos de memória compartilhada</span><span class="sxs-lookup"><span data-stu-id="123f1-196">Atoms and Shared Memory Objects</span></span>](#atoms-and-shared-memory-objects)

### <a name="client-server-and-conversation"></a><span data-ttu-id="123f1-197">Cliente, servidor e conversa</span><span class="sxs-lookup"><span data-stu-id="123f1-197">Client, Server, and Conversation</span></span>

<span data-ttu-id="123f1-198">Dois aplicativos que participam do DDE são considerados envolvidos em uma conversa DDE.</span><span class="sxs-lookup"><span data-stu-id="123f1-198">Two applications participating in DDE are said to be engaged in a DDE conversation.</span></span> <span data-ttu-id="123f1-199">O aplicativo que inicia a conversa é o aplicativo cliente DDE; o aplicativo que responde ao cliente é o aplicativo do servidor DDE.</span><span class="sxs-lookup"><span data-stu-id="123f1-199">The application that initiates the conversation is the DDE client application; the application that responds to the client is the DDE server application.</span></span> <span data-ttu-id="123f1-200">Um aplicativo pode envolver várias conversas ao mesmo tempo, agindo como o cliente em algum e como o servidor em outros.</span><span class="sxs-lookup"><span data-stu-id="123f1-200">An application can engage in several conversations at the same time, acting as the client in some and as the server in others.</span></span>

<span data-ttu-id="123f1-201">Uma conversa DDE ocorre entre duas janelas, uma para cada um dos aplicativos participantes.</span><span class="sxs-lookup"><span data-stu-id="123f1-201">A DDE conversation takes place between two windows, one for each of the participating applications.</span></span> <span data-ttu-id="123f1-202">Uma janela pode ser a janela principal do aplicativo; uma janela associada a um documento específico, como em um aplicativo de interface de vários documentos (MDI); ou uma janela oculta (invisível) cuja única finalidade é processar mensagens DDE.</span><span class="sxs-lookup"><span data-stu-id="123f1-202">A window may be the main window of the application; a window associated with a specific document, as in a multiple-document interface (MDI) application; or a hidden (invisible) window whose only purpose is to process DDE messages.</span></span>

<span data-ttu-id="123f1-203">Como uma conversa DDE é identificada pelo par de identificadores para as janelas envolvidas na conversa, nenhuma janela deve ser envolvida em mais de uma conversa com outra janela.</span><span class="sxs-lookup"><span data-stu-id="123f1-203">Since a DDE conversation is identified by the pair of handles to the windows engaged in the conversation, no window should be engaged in more than one conversation with another window.</span></span> <span data-ttu-id="123f1-204">O aplicativo cliente ou o aplicativo de servidor deve fornecer uma janela diferente para cada uma de suas conversas com um aplicativo cliente ou servidor específico.</span><span class="sxs-lookup"><span data-stu-id="123f1-204">Either the client application or the server application must provide a different window for each of its conversations with a particular server or client application.</span></span>

<span data-ttu-id="123f1-205">Um aplicativo pode garantir que um par de clientes e janelas de servidor nunca esteja envolvido em mais de uma conversa criando uma janela oculta para cada conversa.</span><span class="sxs-lookup"><span data-stu-id="123f1-205">An application can ensure a pair of client and server windows is never involved in more than one conversation by creating a hidden window for each conversation.</span></span> <span data-ttu-id="123f1-206">A única finalidade desta janela é processar mensagens DDE.</span><span class="sxs-lookup"><span data-stu-id="123f1-206">The sole purpose of this window is to process DDE messages.</span></span>

### <a name="application-topic-and-item-names"></a><span data-ttu-id="123f1-207">Nomes de aplicativo, tópico e item</span><span class="sxs-lookup"><span data-stu-id="123f1-207">Application, Topic, and Item Names</span></span>

<span data-ttu-id="123f1-208">O protocolo DDE identifica as unidades de dados passadas entre o cliente e o servidor com uma hierarquia de três níveis de nomes de aplicativo, de tópico e de item.</span><span class="sxs-lookup"><span data-stu-id="123f1-208">The DDE protocol identifies the units of data passed between the client and server with a three-level hierarchy of application, topic, and item names.</span></span>

<span data-ttu-id="123f1-209">Cada conversa DDE é definida exclusivamente pelo nome do aplicativo e pelo tópico.</span><span class="sxs-lookup"><span data-stu-id="123f1-209">Each DDE conversation is uniquely defined by the application name and topic.</span></span> <span data-ttu-id="123f1-210">No início de uma conversa DDE, o cliente e o servidor determinam o nome e o tópico do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="123f1-210">At the beginning of a DDE conversation, the client and server determine the application name and topic.</span></span> <span data-ttu-id="123f1-211">O nome do aplicativo geralmente é o nome do aplicativo do servidor.</span><span class="sxs-lookup"><span data-stu-id="123f1-211">The application name is usually the name of the server application.</span></span> <span data-ttu-id="123f1-212">Por exemplo, quando o Excel atua como o servidor em uma conversa, o nome do aplicativo é Excel.</span><span class="sxs-lookup"><span data-stu-id="123f1-212">For example, when Excel acts as the server in a conversation, the application name is Excel.</span></span>

<span data-ttu-id="123f1-213">O tópico DDE é uma classificação geral dos dados dentro dos quais vários itens de dados podem ser "discutidos" (trocados) durante a conversa.</span><span class="sxs-lookup"><span data-stu-id="123f1-213">The DDE topic is a general classification of data within which multiple data items may be "discussed" (exchanged) during the conversation.</span></span> <span data-ttu-id="123f1-214">Para aplicativos que operam em documentos baseados em arquivo, o tópico geralmente é um nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="123f1-214">For applications that operate on file-based documents, the topic is usually a filename.</span></span> <span data-ttu-id="123f1-215">Para outros aplicativos, o tópico é um nome específico do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="123f1-215">For other applications, the topic is an application-specific name.</span></span>

<span data-ttu-id="123f1-216">Como a janela cliente e servidor lida em conjunto, identifique uma conversa DDE, o nome do aplicativo e o tópico que definem uma conversa não podem ser alterados durante o curso da conversa.</span><span class="sxs-lookup"><span data-stu-id="123f1-216">Because the client and server window handles together identify a DDE conversation, the application name and topic that define a conversation cannot be changed during the course of the conversation.</span></span>

<span data-ttu-id="123f1-217">Um item de dados DDE é uma informação relacionada ao tópico de conversa trocado entre os aplicativos.</span><span class="sxs-lookup"><span data-stu-id="123f1-217">A DDE data item is information related to the conversation topic exchanged between the applications.</span></span> <span data-ttu-id="123f1-218">Os valores para o item de dados podem ser passados do servidor para o cliente ou do cliente para o servidor.</span><span class="sxs-lookup"><span data-stu-id="123f1-218">Values for the data item can be passed from the server to the client, or from the client to the server.</span></span> <span data-ttu-id="123f1-219">Os dados podem ser passados com qualquer um dos formatos de área de transferência padrão ou com um formato de área de transferência registrado.</span><span class="sxs-lookup"><span data-stu-id="123f1-219">Data can be passed with any of the standard clipboard formats or with a registered clipboard format.</span></span> <span data-ttu-id="123f1-220">Um formato de nome registrado e especial chamado link identifica um item em uma conversa DDE.</span><span class="sxs-lookup"><span data-stu-id="123f1-220">A special, registered format named Link identifies an item in a DDE conversation.</span></span> <span data-ttu-id="123f1-221">Para obter mais informações sobre formatos de área de transferência, consulte [área de transferência](clipboard.md).</span><span class="sxs-lookup"><span data-stu-id="123f1-221">For more information about clipboard formats, see [Clipboard](clipboard.md).</span></span>

### <a name="the-system-topic"></a><span data-ttu-id="123f1-222">O tópico System</span><span class="sxs-lookup"><span data-stu-id="123f1-222">The System Topic</span></span>

<span data-ttu-id="123f1-223">Os aplicativos devem dar suporte ao tópico do sistema em todos os momentos.</span><span class="sxs-lookup"><span data-stu-id="123f1-223">Applications should support the system topic at all times.</span></span> <span data-ttu-id="123f1-224">Este tópico fornece um contexto para informações que podem ser de interesse geral para outro aplicativo.</span><span class="sxs-lookup"><span data-stu-id="123f1-224">This topic provides a context for information that may be of general interest to another application.</span></span>

<span data-ttu-id="123f1-225">Os valores de item de dados devem ser renderizados no formato de área de transferência de [**\_ texto do CF**](standard-clipboard-formats.md) .</span><span class="sxs-lookup"><span data-stu-id="123f1-225">Data-item values must be rendered in the [**CF\_TEXT**](standard-clipboard-formats.md) clipboard format.</span></span> <span data-ttu-id="123f1-226">Elementos individuais de valores de item para um tópico do sistema devem ser delimitados por caracteres de tabulação.</span><span class="sxs-lookup"><span data-stu-id="123f1-226">Individual elements of item values for a system topic must be delimited by tab characters.</span></span> <span data-ttu-id="123f1-227">A tabela a seguir sugere alguns itens para o tópico System.</span><span class="sxs-lookup"><span data-stu-id="123f1-227">The following table suggests some items for the system topic.</span></span>



| <span data-ttu-id="123f1-228">Item</span><span class="sxs-lookup"><span data-stu-id="123f1-228">Item</span></span>          | <span data-ttu-id="123f1-229">Descrição</span><span class="sxs-lookup"><span data-stu-id="123f1-229">Description</span></span>                                                                                                                                                                                                                                                                                             |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="123f1-230">Formatos</span><span class="sxs-lookup"><span data-stu-id="123f1-230">Formats</span></span>       | <span data-ttu-id="123f1-231">Lista delimitada por tabulação de formatos de área de transferência que o aplicativo pode renderizar.</span><span class="sxs-lookup"><span data-stu-id="123f1-231">Tab-delimited list of clipboard formats the application can render.</span></span> <span data-ttu-id="123f1-232">Normalmente, os formatos de **CF \_** são listados com a parte "**CF \_**" dos nomes removidos (por exemplo, o **\_ texto de CF** é listado como "**texto**").</span><span class="sxs-lookup"><span data-stu-id="123f1-232">Typically, **CF\_** formats are listed with the "**CF\_**" portion of the names removed (for example, **CF\_TEXT** is listed as "**TEXT**").</span></span>                                                                                        |
| <span data-ttu-id="123f1-233">Ajuda</span><span class="sxs-lookup"><span data-stu-id="123f1-233">Help</span></span>          | <span data-ttu-id="123f1-234">Texto que explica brevemente como usar o servidor DDE.</span><span class="sxs-lookup"><span data-stu-id="123f1-234">Text that briefly explains how to use the DDE server.</span></span>                                                                                                                                                                                                                                                   |
| <span data-ttu-id="123f1-235">ReturnMessage</span><span class="sxs-lookup"><span data-stu-id="123f1-235">ReturnMessage</span></span> | <span data-ttu-id="123f1-236">Detalhes de suporte para a mensagem de [**\_ \_ confirmação de DDE do WM**](wm-dde-ack.md) usada mais recentemente.</span><span class="sxs-lookup"><span data-stu-id="123f1-236">Supporting detail for the most recently used [**WM\_DDE\_ACK**](wm-dde-ack.md) message.</span></span> <span data-ttu-id="123f1-237">Esse item é útil quando mais de oito bits de dados de retorno específicos do aplicativo são necessários.</span><span class="sxs-lookup"><span data-stu-id="123f1-237">This item is useful when more than eight bits of application-specific return data are required.</span></span>                                                                                                                |
| <span data-ttu-id="123f1-238">Status</span><span class="sxs-lookup"><span data-stu-id="123f1-238">Status</span></span>        | <span data-ttu-id="123f1-239">Indicação do status atual do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="123f1-239">Indication of the current status of the application.</span></span> <span data-ttu-id="123f1-240">Quando um servidor recebe uma mensagem de [**\_ \_ solicitação DDE do WM**](wm-dde-request.md) para este item de tópico do sistema, ele deve responder postando uma mensagem de [**\_ \_ dados DDE do WM**](wm-dde-data.md) com uma cadeia de caracteres que contenha ocupado ou pronto, conforme apropriado.</span><span class="sxs-lookup"><span data-stu-id="123f1-240">When a server receives a [**WM\_DDE\_REQUEST**](wm-dde-request.md) message for this system-topic item, it should respond by posting a [**WM\_DDE\_DATA**](wm-dde-data.md) message with a string containing either Busy or Ready, as appropriate.</span></span> |
| <span data-ttu-id="123f1-241">SysItems</span><span class="sxs-lookup"><span data-stu-id="123f1-241">SysItems</span></span>      | <span data-ttu-id="123f1-242">Lista de itens de tópico do sistema para os quais o aplicativo dá suporte.</span><span class="sxs-lookup"><span data-stu-id="123f1-242">List of system-topic items the application supports.</span></span>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="123f1-243">TopicItemList</span><span class="sxs-lookup"><span data-stu-id="123f1-243">TopicItemList</span></span> | <span data-ttu-id="123f1-244">Semelhante ao item SysItems, exceto que TopicItemList deve ter suporte para cada tópico que não seja o tópico System.</span><span class="sxs-lookup"><span data-stu-id="123f1-244">Similar to the SysItems item, except that TopicItemList should be supported for each topic other than the system topic.</span></span> <span data-ttu-id="123f1-245">Isso permite a navegação dos itens com suporte em qualquer tópico.</span><span class="sxs-lookup"><span data-stu-id="123f1-245">This allows browsing of the items supported under any topic.</span></span> <span data-ttu-id="123f1-246">Se os itens não puderem ser enumerados, esse item deverá conter apenas "TopicItemList".</span><span class="sxs-lookup"><span data-stu-id="123f1-246">If the items cannot be enumerated, this item should contain only "TopicItemList".</span></span>                                  |
| <span data-ttu-id="123f1-247">Tópicos</span><span class="sxs-lookup"><span data-stu-id="123f1-247">Topics</span></span>        | <span data-ttu-id="123f1-248">Lista de tópicos aos quais o aplicativo dá suporte no momento atual; Essa lista pode variar desde o momento até o momento.</span><span class="sxs-lookup"><span data-stu-id="123f1-248">List of topics the application supports at the current time; this list can vary from moment to moment.</span></span>                                                                                                                                                                                                  |



 

### <a name="permanent-data-links"></a><span data-ttu-id="123f1-249">Links de dados permanentes</span><span class="sxs-lookup"><span data-stu-id="123f1-249">Permanent Data Links</span></span>

<span data-ttu-id="123f1-250">Depois que uma conversa DDE é iniciada, o cliente pode estabelecer um ou mais links de dados permanentes com o servidor.</span><span class="sxs-lookup"><span data-stu-id="123f1-250">Once a DDE conversation has begun, the client can establish one or more permanent data links with the server.</span></span> <span data-ttu-id="123f1-251">Um link de dados é um mecanismo de comunicações pelo qual o servidor notifica o cliente sempre que o valor de um item de dados especificado é alterado.</span><span class="sxs-lookup"><span data-stu-id="123f1-251">A data link is a communications mechanism by which the server notifies the client whenever the value of a specified data item changes.</span></span> <span data-ttu-id="123f1-252">O link de dados é permanente no sentido de que esse processo de notificação continua até que o link de dados ou a própria conversa DDE seja encerrada.</span><span class="sxs-lookup"><span data-stu-id="123f1-252">The data link is permanent in the sense that this notification process continues until the data link or the DDE conversation itself is terminated.</span></span>

<span data-ttu-id="123f1-253">Há dois tipos de vínculos de dados DDE permanentes: quente e quente.</span><span class="sxs-lookup"><span data-stu-id="123f1-253">There are two kinds of permanent DDE data links: warm and hot.</span></span> <span data-ttu-id="123f1-254">Em um link de dados quentes, o servidor notifica o cliente de que o valor do item de dados foi alterado, mas o servidor não envia o valor de dados para o cliente até que o cliente o solicite.</span><span class="sxs-lookup"><span data-stu-id="123f1-254">In a warm data link, the server notifies the client that the value of the data item has changed, but the server does not send the data value to the client until the client requests it.</span></span> <span data-ttu-id="123f1-255">Em um link de dados dinâmicos, o servidor envia imediatamente o valor de dados alterado para o cliente.</span><span class="sxs-lookup"><span data-stu-id="123f1-255">In a hot data link, the server immediately sends the changed data value to the client.</span></span>

<span data-ttu-id="123f1-256">Os aplicativos que dão suporte a links de dados quentes ou Hot data normalmente fornecem um comando **copiar** ou **colar link** no menu **Editar** para permitir que o usuário estabeleça links entre aplicativos.</span><span class="sxs-lookup"><span data-stu-id="123f1-256">Applications that support warm or hot data links typically provide a **Copy** or **Paste Link** command in their **Edit** menu to enable the user to establish links between applications.</span></span>

### <a name="atoms-and-shared-memory-objects"></a><span data-ttu-id="123f1-257">Atoms e objetos de memória compartilhada</span><span class="sxs-lookup"><span data-stu-id="123f1-257">Atoms and Shared Memory Objects</span></span>

<span data-ttu-id="123f1-258">Determinados argumentos de mensagens DDE são Atoms globais ou objetos de memória compartilhada.</span><span class="sxs-lookup"><span data-stu-id="123f1-258">Certain arguments of DDE messages are global atoms or shared memory objects.</span></span> <span data-ttu-id="123f1-259">Os aplicativos que usam esses argumentos devem seguir regras explícitas sobre quando alocar e excluí-los.</span><span class="sxs-lookup"><span data-stu-id="123f1-259">Applications using these arguments must follow explicit rules about when to allocate and delete them.</span></span> <span data-ttu-id="123f1-260">Em todos os casos, o remetente da mensagem deve excluir qualquer objeto Atom ou de memória compartilhada que o receptor pretendido não receberá por causa de uma condição de erro, como falha da função de [**mensagem**](/windows/desktop/api/winuser/nf-winuser-postmessagea) .</span><span class="sxs-lookup"><span data-stu-id="123f1-260">In all cases, the message sender must delete any atom or shared memory object that the intended receiver will not receive because of an error condition, such as failure of the [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea) function.</span></span>

<span data-ttu-id="123f1-261">O DDE usa objetos de memória compartilhada para três finalidades:</span><span class="sxs-lookup"><span data-stu-id="123f1-261">DDE uses shared memory objects for three purposes:</span></span>

-   <span data-ttu-id="123f1-262">Para transportar um valor de item de dados a ser trocado.</span><span class="sxs-lookup"><span data-stu-id="123f1-262">To carry a data-item value to be exchanged.</span></span> <span data-ttu-id="123f1-263">Este é um item referenciado pelo parâmetro *hData* nos [**dados do \_ WM \_ DDE**](wm-dde-data.md) e no [**WM DDE enmediate \_ \_**](wm-dde-poke.md) messages.</span><span class="sxs-lookup"><span data-stu-id="123f1-263">This is an item referenced by the *hData* parameter in the [**WM\_DDE\_DATA**](wm-dde-data.md) and [**WM\_DDE\_POKE**](wm-dde-poke.md) messages.</span></span>
-   <span data-ttu-id="123f1-264">Para transportar opções em uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="123f1-264">To carry options in a message.</span></span> <span data-ttu-id="123f1-265">Este é um item referenciado pelo parâmetro *hOptions* em uma mensagem de [**\_ \_ aviso de DDE do WM**](wm-dde-advise.md) .</span><span class="sxs-lookup"><span data-stu-id="123f1-265">This is an item referenced by the *hOptions* parameter in a [**WM\_DDE\_ADVISE**](wm-dde-advise.md) message.</span></span>
-   <span data-ttu-id="123f1-266">Para executar uma cadeia de caracteres de execução de comando.</span><span class="sxs-lookup"><span data-stu-id="123f1-266">To carry a command execution string.</span></span> <span data-ttu-id="123f1-267">Este é um item referenciado pelo parâmetro *hCommands* na mensagem [**de \_ \_ execução de DDE do WM**](wm-dde-execute.md) e sua mensagem de [**\_ \_ confirmação de DDE do WM**](wm-dde-ack.md) correspondente.</span><span class="sxs-lookup"><span data-stu-id="123f1-267">This is an item referenced by the *hCommands* parameter in the [**WM\_DDE\_EXECUTE**](wm-dde-execute.md) message and its corresponding [**WM\_DDE\_ACK**](wm-dde-ack.md) message.</span></span>

<span data-ttu-id="123f1-268">Um aplicativo que recebe um objeto de memória compartilhada DDE deve tratá-lo como somente leitura.</span><span class="sxs-lookup"><span data-stu-id="123f1-268">An application that receives a DDE shared memory object must treat it as read only.</span></span> <span data-ttu-id="123f1-269">O aplicativo não deve usar o objeto como uma área de leitura/gravação mútua para a troca de dados gratuita.</span><span class="sxs-lookup"><span data-stu-id="123f1-269">The application must not use the object as a mutual read-write area for the free exchange of data.</span></span>

<span data-ttu-id="123f1-270">Como acontece com um átomo DDE, um aplicativo deve liberar um objeto de memória compartilhada para gerenciar a memória com eficiência.</span><span class="sxs-lookup"><span data-stu-id="123f1-270">As it does with a DDE atom, an application should free a shared memory object to manage memory effectively.</span></span> <span data-ttu-id="123f1-271">O aplicativo também deve bloquear e desbloquear os objetos de memória.</span><span class="sxs-lookup"><span data-stu-id="123f1-271">The application should also lock and unlock memory objects.</span></span>

## <a name="dynamic-data-exchange-messages-overview"></a><span data-ttu-id="123f1-272">Visão geral de mensagens de troca dinâmica de dados</span><span class="sxs-lookup"><span data-stu-id="123f1-272">Dynamic Data Exchange Messages Overview</span></span>

<span data-ttu-id="123f1-273">Como o DDE é um protocolo baseado em mensagem, ele emprega nenhuma função ou biblioteca.</span><span class="sxs-lookup"><span data-stu-id="123f1-273">Because DDE is a message-based protocol, it employs no functions or libraries.</span></span> <span data-ttu-id="123f1-274">Todas as transações DDE são realizadas passando determinadas mensagens DDE definidas entre as janelas do cliente e do servidor.</span><span class="sxs-lookup"><span data-stu-id="123f1-274">All DDE transactions are conducted by passing certain defined DDE messages between the client and server windows.</span></span>

<span data-ttu-id="123f1-275">Há nove mensagens DDE; as constantes simbólicas para essas mensagens são definidas no arquivo de cabeçalho DDE.</span><span class="sxs-lookup"><span data-stu-id="123f1-275">There are nine DDE messages; the symbolic constants for these messages are defined in the DDE header file.</span></span> <span data-ttu-id="123f1-276">Determinadas estruturas para as várias mensagens DDE também são definidas neste arquivo de cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="123f1-276">Certain structures for the various DDE messages are also defined in this header file.</span></span>

<span data-ttu-id="123f1-277">A tabela a seguir resume as mensagens DDE.</span><span class="sxs-lookup"><span data-stu-id="123f1-277">The following table summarizes the DDE messages.</span></span>



| <span data-ttu-id="123f1-278">Mensagem</span><span class="sxs-lookup"><span data-stu-id="123f1-278">Message</span></span>                                        | <span data-ttu-id="123f1-279">Descrição</span><span class="sxs-lookup"><span data-stu-id="123f1-279">Description</span></span>                                                                                                                                      |
|------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="123f1-280">**\_ACK de DDE do WM \_**</span><span class="sxs-lookup"><span data-stu-id="123f1-280">**WM\_DDE\_ACK**</span></span>](wm-dde-ack.md)             | <span data-ttu-id="123f1-281">Confirma o recebimento ou não do recebimento de uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="123f1-281">Acknowledges receiving or not receiving a message.</span></span>                                                                                               |
| [<span data-ttu-id="123f1-282">**\_aviso de DDE do WM \_**</span><span class="sxs-lookup"><span data-stu-id="123f1-282">**WM\_DDE\_ADVISE**</span></span>](wm-dde-advise.md)       | <span data-ttu-id="123f1-283">Solicita que o aplicativo de servidor forneça uma atualização ou notificação para um item de dados sempre que ele for alterado.</span><span class="sxs-lookup"><span data-stu-id="123f1-283">Requests the server application to supply an update or notification for a data item whenever it changes.</span></span> <span data-ttu-id="123f1-284">Isso estabelece um link de dados permanente.</span><span class="sxs-lookup"><span data-stu-id="123f1-284">This establishes a permanent data link.</span></span> |
| [<span data-ttu-id="123f1-285">**\_dados DDE do WM \_**</span><span class="sxs-lookup"><span data-stu-id="123f1-285">**WM\_DDE\_DATA**</span></span>](wm-dde-data.md)           | <span data-ttu-id="123f1-286">Envia um valor de item de dados para o aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="123f1-286">Sends a data-item value to the client application.</span></span>                                                                                               |
| [<span data-ttu-id="123f1-287">**\_execução de DDE do WM \_**</span><span class="sxs-lookup"><span data-stu-id="123f1-287">**WM\_DDE\_EXECUTE**</span></span>](wm-dde-execute.md)     | <span data-ttu-id="123f1-288">Envia uma cadeia de caracteres para o aplicativo de servidor, que deve processar a cadeia de caracteres como uma série de comandos.</span><span class="sxs-lookup"><span data-stu-id="123f1-288">Sends a string to the server application, which is expected to process the string as a series of commands.</span></span>                                       |
| [<span data-ttu-id="123f1-289">**início do WM \_ DDE \_**</span><span class="sxs-lookup"><span data-stu-id="123f1-289">**WM\_DDE\_INITIATE**</span></span>](wm-dde-initiate.md)   | <span data-ttu-id="123f1-290">Inicia uma conversa entre os aplicativos cliente e servidor.</span><span class="sxs-lookup"><span data-stu-id="123f1-290">Initiates a conversation between the client and server applications.</span></span>                                                                             |
| [<span data-ttu-id="123f1-291">**o WM \_ DDE. \_**</span><span class="sxs-lookup"><span data-stu-id="123f1-291">**WM\_DDE\_POKE**</span></span>](wm-dde-poke.md)           | <span data-ttu-id="123f1-292">Envia um valor de item de dados para o aplicativo de servidor.</span><span class="sxs-lookup"><span data-stu-id="123f1-292">Sends a data-item value to the server application.</span></span>                                                                                               |
| [<span data-ttu-id="123f1-293">**\_solicitação de DDE do WM \_**</span><span class="sxs-lookup"><span data-stu-id="123f1-293">**WM\_DDE\_REQUEST**</span></span>](wm-dde-request.md)     | <span data-ttu-id="123f1-294">Solicita que o aplicativo de servidor forneça o valor de um item de dados.</span><span class="sxs-lookup"><span data-stu-id="123f1-294">Requests the server application to provide the value of a data item.</span></span>                                                                             |
| [<span data-ttu-id="123f1-295">**fim do WM \_ DDE \_**</span><span class="sxs-lookup"><span data-stu-id="123f1-295">**WM\_DDE\_TERMINATE**</span></span>](wm-dde-terminate.md) | <span data-ttu-id="123f1-296">Encerra uma conversa.</span><span class="sxs-lookup"><span data-stu-id="123f1-296">Terminates a conversation.</span></span>                                                                                                                       |
| [<span data-ttu-id="123f1-297">**\_aviso de DDE do WM \_**</span><span class="sxs-lookup"><span data-stu-id="123f1-297">**WM\_DDE\_UNADVISE**</span></span>](wm-dde-unadvise.md)   | <span data-ttu-id="123f1-298">Encerra um link de dados permanente.</span><span class="sxs-lookup"><span data-stu-id="123f1-298">Terminates a permanent data link.</span></span>                                                                                                                |



 

<span data-ttu-id="123f1-299">Um aplicativo chama [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) para emitir a mensagem de [**\_ \_ início do WM DDE**](wm-dde-initiate.md) ou uma mensagem de [**\_ \_ ACK DDE do WM**](wm-dde-ack.md) enviada em resposta a **início do WM \_ DDE \_**.</span><span class="sxs-lookup"><span data-stu-id="123f1-299">An application calls [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) to issue the [**WM\_DDE\_INITIATE**](wm-dde-initiate.md) message or a [**WM\_DDE\_ACK**](wm-dde-ack.md) message sent in response to **WM\_DDE\_INITIATE**.</span></span> <span data-ttu-id="123f1-300">Todas as outras mensagens são enviadas por uma [**mensagem**](/windows/desktop/api/winuser/nf-winuser-postmessagea).</span><span class="sxs-lookup"><span data-stu-id="123f1-300">All other messages are sent by [**PostMessage**](/windows/desktop/api/winuser/nf-winuser-postmessagea).</span></span> <span data-ttu-id="123f1-301">O primeiro parâmetro dessas chamadas é um identificador para a janela de recebimento; o segundo parâmetro contém a mensagem a ser enviada; o terceiro parâmetro identifica a janela de envio; e o quarto parâmetro contém os argumentos específicos da mensagem.</span><span class="sxs-lookup"><span data-stu-id="123f1-301">The first parameter of these calls is a handle to the receiving window; the second parameter contains the message to be sent; the third parameter identifies the sending window; and the fourth parameter contains the message-specific arguments.</span></span>

## <a name="dynamic-data-exchange-message-flow"></a><span data-ttu-id="123f1-302">Fluxo de mensagens troca dinâmica de dados</span><span class="sxs-lookup"><span data-stu-id="123f1-302">Dynamic Data Exchange Message Flow</span></span>

<span data-ttu-id="123f1-303">Uma conversa DDE típica consiste nos seguintes eventos:</span><span class="sxs-lookup"><span data-stu-id="123f1-303">A typical DDE conversation consists of the following events:</span></span>

1.  <span data-ttu-id="123f1-304">O aplicativo cliente inicia a conversa e o aplicativo do servidor responde.</span><span class="sxs-lookup"><span data-stu-id="123f1-304">The client application initiates the conversation, and the server application responds.</span></span>
2.  <span data-ttu-id="123f1-305">Os aplicativos trocam dados por um ou todos os seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="123f1-305">The applications exchange data by any or all of the following methods:</span></span>
    -   -   <span data-ttu-id="123f1-306">O aplicativo de servidor envia dados para o cliente na solicitação do cliente.</span><span class="sxs-lookup"><span data-stu-id="123f1-306">The server application sends data to the client at the client's request.</span></span>
        -   <span data-ttu-id="123f1-307">O aplicativo cliente envia dados não solicitados para o aplicativo de servidor.</span><span class="sxs-lookup"><span data-stu-id="123f1-307">The client application sends unsolicited data to the server application.</span></span>
        -   <span data-ttu-id="123f1-308">O aplicativo cliente solicita que o aplicativo de servidor notifique o cliente sempre que um item de dados for alterado (link de dados quentes).</span><span class="sxs-lookup"><span data-stu-id="123f1-308">The client application requests the server application to notify the client whenever a data item changes (warm data link).</span></span>
        -   <span data-ttu-id="123f1-309">O aplicativo cliente solicita que o aplicativo de servidor envie dados sempre que os dados forem alterados (link de dados dinâmicos).</span><span class="sxs-lookup"><span data-stu-id="123f1-309">The client application requests the server application to send data whenever the data changes (hot data link).</span></span>
        -   <span data-ttu-id="123f1-310">O aplicativo de servidor executa um comando na solicitação do cliente.</span><span class="sxs-lookup"><span data-stu-id="123f1-310">The server application carries out a command at the client's request.</span></span>

3.  <span data-ttu-id="123f1-311">O aplicativo cliente ou servidor encerra a conversa.</span><span class="sxs-lookup"><span data-stu-id="123f1-311">Either the client or server application terminates the conversation.</span></span>

<span data-ttu-id="123f1-312">Uma janela de aplicativo que processa solicitações de um cliente ou servidor deve processá-las estritamente na ordem em que são recebidas.</span><span class="sxs-lookup"><span data-stu-id="123f1-312">An application window that processes requests from a client or server must process them strictly in the order they are received.</span></span>

<span data-ttu-id="123f1-313">Um cliente pode estabelecer conversas com mais de um servidor; um servidor pode ter conversas com mais de um cliente.</span><span class="sxs-lookup"><span data-stu-id="123f1-313">A client can establish conversations with more than one server; a server can have conversations with more than one client.</span></span> <span data-ttu-id="123f1-314">Ao lidar com mensagens de mais de uma fonte, um cliente ou servidor deve processar as mensagens de uma conversa de forma síncrona, mas não precisa processar todas as mensagens de forma síncrona.</span><span class="sxs-lookup"><span data-stu-id="123f1-314">When handling messages from more than one source, a client or server must process the messages of a conversation synchronously, but need not process all messages synchronously.</span></span> <span data-ttu-id="123f1-315">Em outras palavras, ele pode mudar de uma conversa para outra, conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="123f1-315">In other words, it can shift from one conversation to another as needed.</span></span>

<span data-ttu-id="123f1-316">Se um aplicativo não puder processar uma solicitação de entrada porque está aguardando uma resposta DDE, ele deverá impedir o deadlock postando uma mensagem de [**\_ \_ ACK DDE do WM**](wm-dde-ack.md) com o membro **fBusy** da estrutura [**DDEACK**](/windows/desktop/api/Dde/ns-dde-ddeack) definida como 1.</span><span class="sxs-lookup"><span data-stu-id="123f1-316">If an application is unable to process an incoming request because it is waiting for a DDE response, it must prevent deadlock by posting a [**WM\_DDE\_ACK**](wm-dde-ack.md) message with the **fBusy** member of the [**DDEACK**](/windows/desktop/api/Dde/ns-dde-ddeack) structure set to 1.</span></span> <span data-ttu-id="123f1-317">Um aplicativo também pode enviar uma mensagem **de \_ \_ ACK DDE** ocupada do WM se, por algum motivo, ele não puder processar uma solicitação de entrada dentro de um período de tempo razoável.</span><span class="sxs-lookup"><span data-stu-id="123f1-317">An application can also send a busy **WM\_DDE\_ACK** message if, for any reason, it cannot process an incoming request within a reasonable amount of time.</span></span>

<span data-ttu-id="123f1-318">Um aplicativo deve ser capaz de lidar com a falha de um cliente ou servidor para responder a uma mensagem dentro de um determinado tempo.</span><span class="sxs-lookup"><span data-stu-id="123f1-318">An application should be able to handle the failure of a client or server to respond to a message within a certain time.</span></span> <span data-ttu-id="123f1-319">Como o intervalo de tempo limite pode variar dependendo da natureza do aplicativo e da configuração do sistema do usuário (incluindo se ele está conectado a uma rede), o aplicativo deve fornecer uma maneira para o usuário especificar o intervalo.</span><span class="sxs-lookup"><span data-stu-id="123f1-319">Since the time-out interval may vary depending on the nature of the application and the configuration of the user's system (including whether it is connected to a network), the application should provide a way for the user to specify the interval.</span></span>

## <a name="parameter-packing-functions"></a><span data-ttu-id="123f1-320">Funções de empacotamento de parâmetro</span><span class="sxs-lookup"><span data-stu-id="123f1-320">Parameter Packing Functions</span></span>

<span data-ttu-id="123f1-321">O parâmetro *lParam* de muitas mensagens DDE contém duas partes de dados.</span><span class="sxs-lookup"><span data-stu-id="123f1-321">The *lParam* parameter of many DDE messages contains two pieces of data.</span></span> <span data-ttu-id="123f1-322">Por exemplo, o *lParam* da mensagem [**de \_ \_ dados DDE do WM**](wm-dde-data.md) contém um identificador de dados e um Atom.</span><span class="sxs-lookup"><span data-stu-id="123f1-322">For example, the *lParam* of the [**WM\_DDE\_DATA**](wm-dde-data.md) message contains a data handle and an atom.</span></span> <span data-ttu-id="123f1-323">Os aplicativos devem usar a função [**PackDDElParam**](/windows/desktop/api/Dde/nf-dde-packddelparam) para empacotar o identificador e o Atom em um parâmetro *lParam* e a função [**UnpackDDElParam**](/windows/desktop/api/Dde/nf-dde-unpackddelparam) para remover os valores.</span><span class="sxs-lookup"><span data-stu-id="123f1-323">Applications must use the [**PackDDElParam**](/windows/desktop/api/Dde/nf-dde-packddelparam) function to pack the handle and atom into an *lParam* parameter, and the [**UnpackDDElParam**](/windows/desktop/api/Dde/nf-dde-unpackddelparam) function to remove the values.</span></span> <span data-ttu-id="123f1-324">Os aplicativos DDE devem usar **PackDDElParam** e **UnpackDDElParam** para todas as mensagens lançadas durante uma conversa DDE.</span><span class="sxs-lookup"><span data-stu-id="123f1-324">DDE applications must use **PackDDElParam** and **UnpackDDElParam** for all messages posted during a DDE conversation.</span></span>

<span data-ttu-id="123f1-325">Os aplicativos também podem usar as funções [**ReuseDDElParam**](/windows/desktop/api/Dde/nf-dde-reuseddelparam) e [**FreeDDElParam**](/windows/desktop/api/Dde/nf-dde-freeddelparam) .</span><span class="sxs-lookup"><span data-stu-id="123f1-325">Applications can also use the [**ReuseDDElParam**](/windows/desktop/api/Dde/nf-dde-reuseddelparam) and [**FreeDDElParam**](/windows/desktop/api/Dde/nf-dde-freeddelparam) functions.</span></span> <span data-ttu-id="123f1-326">O **ReuseDDElParam** permite que um aplicativo DDE reutilize um parâmetro *lParam* embalado, ajudando a reduzir o número de realocações de memória que o aplicativo deve executar durante uma conversa.</span><span class="sxs-lookup"><span data-stu-id="123f1-326">**ReuseDDElParam** allows a DDE application to reuse a packed *lParam* parameter, helping reduce the number of memory reallocations the application must perform during a conversation.</span></span> <span data-ttu-id="123f1-327">Um aplicativo pode usar **FreeDDElParam** para liberar a memória associada a um identificador de dados recebido durante uma conversa DDE.</span><span class="sxs-lookup"><span data-stu-id="123f1-327">An application can use **FreeDDElParam** to free the memory associated with a data handle received during a DDE conversation.</span></span>

## <a name="dynamic-data-exchange-and-impersonation"></a><span data-ttu-id="123f1-328">troca dinâmica de dados e representação</span><span class="sxs-lookup"><span data-stu-id="123f1-328">Dynamic Data Exchange and Impersonation</span></span>

<span data-ttu-id="123f1-329">Para permitir que um servidor represente um cliente, o cliente chama a função [**DdeSetQualityOfService**](/windows/desktop/api/Dde/nf-dde-ddesetqualityofservice) .</span><span class="sxs-lookup"><span data-stu-id="123f1-329">To allow a server to impersonate a client, the client calls the [**DdeSetQualityOfService**](/windows/desktop/api/Dde/nf-dde-ddesetqualityofservice) function.</span></span> <span data-ttu-id="123f1-330">A estrutura do [**\_ \_ nível de representação de segurança**](/windows/win32/api/winnt/ne-winnt-security_impersonation_level) é usada para controlar o nível de representação que o servidor pode executar.</span><span class="sxs-lookup"><span data-stu-id="123f1-330">The [**SECURITY\_IMPERSONATION\_LEVEL**](/windows/win32/api/winnt/ne-winnt-security_impersonation_level) structure is used to control the level of impersonation the server may perform.</span></span>

<span data-ttu-id="123f1-331">Um servidor DDE pode representar um cliente DDE chamando a função [**ImpersonateDdeClientWindow**](/windows/desktop/api/Dde/nf-dde-impersonateddeclientwindow) .</span><span class="sxs-lookup"><span data-stu-id="123f1-331">A DDE server can impersonate a DDE client by calling the [**ImpersonateDdeClientWindow**](/windows/desktop/api/Dde/nf-dde-impersonateddeclientwindow) function.</span></span> <span data-ttu-id="123f1-332">Um servidor DDEML deve usar a função [**DdeImpersonateClient**](/windows/desktop/api/Ddeml/nf-ddeml-ddeimpersonateclient) .</span><span class="sxs-lookup"><span data-stu-id="123f1-332">A DDEML server should use the [**DdeImpersonateClient**](/windows/desktop/api/Ddeml/nf-ddeml-ddeimpersonateclient) function.</span></span>

 

 