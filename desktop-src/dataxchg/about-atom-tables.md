---
title: Sobre tabelas Atom
description: Esta seção discute as tabelas Atom.
ms.assetid: 12114a3e-99a4-480f-9d1a-57c1942b7382
keywords:
- átomos
- tabelas Atom
- nomes Atom
- Troca dinâmica de dados (DDE), Atoms
- DDE (troca dinâmica de dados), Atoms
- tabelas Atom globais
- tabelas Atom locais
- Atoms inteiros
- átomos de cadeia de caracteres
ms.topic: article
ms.date: 08/25/2020
ms.openlocfilehash: 27f7cdb4bb2dc2fd97b4dba6909022b297df1a1d
ms.sourcegitcommit: e985e0532f0f895ae418e8c2658dac819cdae3b1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/26/2020
ms.locfileid: "104366796"
---
# <a name="about-atom-tables"></a><span data-ttu-id="d4263-112">Sobre tabelas Atom</span><span class="sxs-lookup"><span data-stu-id="d4263-112">About Atom Tables</span></span>

<span data-ttu-id="d4263-113">Uma *tabela Atom* é uma tabela definida pelo sistema que armazena cadeias de caracteres e identificadores correspondentes.</span><span class="sxs-lookup"><span data-stu-id="d4263-113">An *atom table* is a system-defined table that stores strings and corresponding identifiers.</span></span> <span data-ttu-id="d4263-114">Um aplicativo coloca uma cadeia de caracteres em uma tabela Atom e recebe um inteiro de 16 bits, chamado *Atom*, que pode ser usado para acessar a cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="d4263-114">An application places a string in an atom table and receives a 16-bit integer, called an *atom*, that can be used to access the string.</span></span> <span data-ttu-id="d4263-115">Uma cadeia de caracteres que foi colocada em uma tabela Atom é chamada de *nome Atom*.</span><span class="sxs-lookup"><span data-stu-id="d4263-115">A string that has been placed in an atom table is called an *atom name*.</span></span>

<span data-ttu-id="d4263-116">O sistema fornece várias tabelas Atom.</span><span class="sxs-lookup"><span data-stu-id="d4263-116">The system provides a number of atom tables.</span></span> <span data-ttu-id="d4263-117">Cada tabela Atom atende a uma finalidade diferente.</span><span class="sxs-lookup"><span data-stu-id="d4263-117">Each atom table serves a different purpose.</span></span> <span data-ttu-id="d4263-118">Por exemplo, os aplicativos troca dinâmica de dados (DDE) usam a [tabela global Atom](#global-atom-table) para compartilhar cadeias de caracteres de nome de item e de tópico-nome com outros aplicativos.</span><span class="sxs-lookup"><span data-stu-id="d4263-118">For example, Dynamic Data Exchange (DDE) applications use the [global atom table](#global-atom-table) to share item-name and topic-name strings with other applications.</span></span> <span data-ttu-id="d4263-119">Em vez de passar cadeias de caracteres reais, um aplicativo DDE passa Atoms globais para seu aplicativo de parceiro.</span><span class="sxs-lookup"><span data-stu-id="d4263-119">Rather than passing actual strings, a DDE application passes global atoms to its partner application.</span></span> <span data-ttu-id="d4263-120">O parceiro usa os átomos para obter as cadeias de caracteres da tabela Atom.</span><span class="sxs-lookup"><span data-stu-id="d4263-120">The partner uses the atoms to obtain the strings from the atom table.</span></span>

<span data-ttu-id="d4263-121">Os aplicativos podem usar tabelas Atom locais para armazenar suas próprias associações de nome de item.</span><span class="sxs-lookup"><span data-stu-id="d4263-121">Applications can use local atom tables to store their own item-name associations.</span></span>

<span data-ttu-id="d4263-122">O sistema usa tabelas Atom que não estão diretamente acessíveis aos aplicativos.</span><span class="sxs-lookup"><span data-stu-id="d4263-122">The system uses atom tables that are not directly accessible to applications.</span></span> <span data-ttu-id="d4263-123">No entanto, o aplicativo usa esses átomos ao chamar uma variedade de funções.</span><span class="sxs-lookup"><span data-stu-id="d4263-123">However, the application uses these atoms when calling a variety of functions.</span></span> <span data-ttu-id="d4263-124">Por exemplo, os formatos de área de transferência registrados são armazenados em uma tabela Atom interna usada pelo sistema.</span><span class="sxs-lookup"><span data-stu-id="d4263-124">For example, registered clipboard formats are stored in an internal atom table used by the system.</span></span> <span data-ttu-id="d4263-125">Um aplicativo adiciona Atoms a essa tabela Atom usando a função [**RegisterClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-registerclipboardformata) .</span><span class="sxs-lookup"><span data-stu-id="d4263-125">An application adds atoms to this atom table using the [**RegisterClipboardFormat**](/windows/desktop/api/Winuser/nf-winuser-registerclipboardformata) function.</span></span> <span data-ttu-id="d4263-126">Além disso, as classes registradas são armazenadas em uma tabela Atom interna usada pelo sistema.</span><span class="sxs-lookup"><span data-stu-id="d4263-126">Also, registered classes are stored in an internal atom table used by the system.</span></span> <span data-ttu-id="d4263-127">Um aplicativo adiciona Atoms a essa tabela Atom usando a função [**registerClass**](/windows/desktop/api/winuser/nf-winuser-registerclassa) ou [**RegisterClassEx**](/windows/desktop/api/winuser/nf-winuser-registerclassexa) .</span><span class="sxs-lookup"><span data-stu-id="d4263-127">An application adds atoms to this atom table using the [**RegisterClass**](/windows/desktop/api/winuser/nf-winuser-registerclassa) or [**RegisterClassEx**](/windows/desktop/api/winuser/nf-winuser-registerclassexa) function.</span></span>

<span data-ttu-id="d4263-128">Os tópicos a seguir são discutidos nesta seção.</span><span class="sxs-lookup"><span data-stu-id="d4263-128">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="d4263-129">Tabela Atom global</span><span class="sxs-lookup"><span data-stu-id="d4263-129">Global Atom Table</span></span>](#global-atom-table)
-   [<span data-ttu-id="d4263-130">Tabela Atom do usuário</span><span class="sxs-lookup"><span data-stu-id="d4263-130">User Atom Table</span></span>](#user-atom-table)
-   [<span data-ttu-id="d4263-131">Tabelas Atom locais</span><span class="sxs-lookup"><span data-stu-id="d4263-131">Local Atom Tables</span></span>](#local-atom-tables)
-   [<span data-ttu-id="d4263-132">Tipos Atom</span><span class="sxs-lookup"><span data-stu-id="d4263-132">Atom Types</span></span>](#atom-types)
    -   [<span data-ttu-id="d4263-133">Átomos de cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="d4263-133">String Atoms</span></span>](#string-atoms)
    -   [<span data-ttu-id="d4263-134">Atoms inteiros</span><span class="sxs-lookup"><span data-stu-id="d4263-134">Integer Atoms</span></span>](#integer-atoms)
-   [<span data-ttu-id="d4263-135">Criação de Atom e contagem de uso</span><span class="sxs-lookup"><span data-stu-id="d4263-135">Atom Creation and Usage Count</span></span>](#atom-creation-and-usage-count)
-   [<span data-ttu-id="d4263-136">Consultas de tabela Atom</span><span class="sxs-lookup"><span data-stu-id="d4263-136">Atom-Table Queries</span></span>](#atom-table-queries)
-   [<span data-ttu-id="d4263-137">Formatos de cadeia de caracteres Atom</span><span class="sxs-lookup"><span data-stu-id="d4263-137">Atom String Formats</span></span>](#atom-string-formats)

## <a name="global-atom-table"></a><span data-ttu-id="d4263-138">Tabela Atom global</span><span class="sxs-lookup"><span data-stu-id="d4263-138">Global Atom Table</span></span>

<span data-ttu-id="d4263-139">A tabela global Atom está disponível para todos os aplicativos.</span><span class="sxs-lookup"><span data-stu-id="d4263-139">The global atom table is available to all applications.</span></span> <span data-ttu-id="d4263-140">Quando um aplicativo coloca uma cadeia de caracteres na tabela de átomo global, o sistema gera um átomo que é exclusivo em todo o sistema.</span><span class="sxs-lookup"><span data-stu-id="d4263-140">When an application places a string in the global atom table, the system generates an atom that is unique throughout the system.</span></span> <span data-ttu-id="d4263-141">Qualquer aplicativo que tenha o Atom pode obter a cadeia de caracteres identificada consultando a tabela Atom global.</span><span class="sxs-lookup"><span data-stu-id="d4263-141">Any application that has the atom can obtain the string it identifies by querying the global atom table.</span></span>

<span data-ttu-id="d4263-142">Um aplicativo que define um formato de dados DDE privado para compartilhar dados com outros aplicativos deve posicionar o nome de formato na tabela Atom global.</span><span class="sxs-lookup"><span data-stu-id="d4263-142">An application that defines a private DDE-data format for sharing data with other applications should place the format name in the global atom table.</span></span> <span data-ttu-id="d4263-143">Essa técnica impede conflitos com os nomes de formatos definidos pelo sistema ou por outros aplicativos e torna os identificadores (Atoms) para as mensagens ou os formatos disponíveis para os outros aplicativos.</span><span class="sxs-lookup"><span data-stu-id="d4263-143">This technique prevents conflicts with the names of formats defined by the system or by other applications, and makes the identifiers (atoms) for the messages or formats available to the other applications.</span></span>

## <a name="user-atom-table"></a><span data-ttu-id="d4263-144">Tabela Atom do usuário</span><span class="sxs-lookup"><span data-stu-id="d4263-144">User Atom Table</span></span>

<span data-ttu-id="d4263-145">Além da tabela de Atom global, a tabela Atom do usuário é outra tabela Atom do sistema que também é compartilhada entre todos os processos.</span><span class="sxs-lookup"><span data-stu-id="d4263-145">In addition to the global atom table, the user atom table is another system atom table that is also shared across all processes.</span></span> <span data-ttu-id="d4263-146">A tabela Atom do usuário é usada para um pequeno número de cenários internos a Win32k; por exemplo, nomes de módulo do Windows, cadeias de caracteres bem conhecidas em Win32k, formatos OLE, etc. Embora os aplicativos não interajam diretamente com a tabela Atom do usuário, eles chamam várias APIs, como [registerClass](/windows/win32/api/winuser/nf-winuser-registerclassexa), [RegisterWindowMessage](/windows/win32/api/winuser/nf-winuser-registerwindowmessagea)e [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata), que adicionam entradas à tabela Atom do usuário.</span><span class="sxs-lookup"><span data-stu-id="d4263-146">The user atom table is used for a small number of scenarios internal to win32k; for example, windows module names, well known strings in win32k, OLE formats, etc. Although applications do not interact with the user atom table directly, they call several APIs—such as [RegisterClass](/windows/win32/api/winuser/nf-winuser-registerclassexa), [RegisterWindowMessage](/windows/win32/api/winuser/nf-winuser-registerwindowmessagea), and [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata)—that add entries to the user atom table.</span></span> <span data-ttu-id="d4263-147">As entradas adicionadas pelo `RegisterClass` podem ser excluídas pelo `UnregisterClass` .</span><span class="sxs-lookup"><span data-stu-id="d4263-147">The entries added by `RegisterClass` can be deleted by `UnregisterClass`.</span></span> <span data-ttu-id="d4263-148">No entanto, as entradas adicionadas por `RegisterWindowMessage` e `RegisterClipboardFormat` não são excluídas até que a sessão termine.</span><span class="sxs-lookup"><span data-stu-id="d4263-148">However, the entries added by `RegisterWindowMessage` and `RegisterClipboardFormat` do not get deleted until the session ends.</span></span> <span data-ttu-id="d4263-149">Se a tabela Atom do usuário não tiver mais espaço e a cadeia de caracteres que está sendo passada ainda não estiver na tabela, a chamada falhará.</span><span class="sxs-lookup"><span data-stu-id="d4263-149">If the user atom table has no more space and the string being passed in is not already in the table, the call will fail.</span></span> 

### <a name="atom-table-size"></a><span data-ttu-id="d4263-150">Tamanho da tabela Atom</span><span class="sxs-lookup"><span data-stu-id="d4263-150">Atom Table Size</span></span>
 
<span data-ttu-id="d4263-151">Muitas APIs críticas, incluindo [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindowa), dependem de átomos de usuário.</span><span class="sxs-lookup"><span data-stu-id="d4263-151">Many critical APIs, including [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindowa), rely on user atoms.</span></span> <span data-ttu-id="d4263-152">Portanto, o esgotamento de espaço na tabela Atom do usuário resultará em problemas sérios; por exemplo, todos os aplicativos podem falhar ao iniciar.</span><span class="sxs-lookup"><span data-stu-id="d4263-152">Therefore, space exhaustion in the user atom table will result in serious issues; for example, all applications may fail to launch.</span></span> <span data-ttu-id="d4263-153">Aqui estão algumas recomendações para garantir que seu aplicativo utilize tabelas Atom com eficiência e preserve a confiabilidade e o desempenho do aplicativo e do sistema:</span><span class="sxs-lookup"><span data-stu-id="d4263-153">Here are some recommendations to ensure your application utilizes atom tables efficiently and preserves the reliability and performance of the application and system:</span></span>  

1. <span data-ttu-id="d4263-154">Você deve limitar o uso do aplicativo da tabela Atom do usuário.</span><span class="sxs-lookup"><span data-stu-id="d4263-154">You should limit your app's usage of the user atom table.</span></span> <span data-ttu-id="d4263-155">Armazenar cadeias de caracteres exclusivas usando APIs como `RegisterClass` , `RegisterWindowMessage` ou `RegisterClipboardFormat` usa espaço na tabela Atom do usuário, que é usada globalmente por outros aplicativos para registrar classes de janela usando cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="d4263-155">Storing unique strings using APIs like `RegisterClass`, `RegisterWindowMessage`, or `RegisterClipboardFormat` takes space in the user atom table, which is used globally by other apps to register window classes using strings.</span></span> <span data-ttu-id="d4263-156">Se possível, você deve usar [addatom](/windows/desktop/api/Winbase/nf-winbase-addatomw) / [DeleteAtom](/windows/desktop/api/Winbase/nf-winbase-deleteatom) para armazenar cadeias de caracteres em uma tabela Atom local ou [GlobalAddAtom](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma) / [GlobalDeleteAtom](/windows/desktop/api/Winbase/nf-winbase-globaldeleteatom) se os átomos forem necessários em processo cruzado.</span><span class="sxs-lookup"><span data-stu-id="d4263-156">If at all possible, you should use [AddAtom](/windows/desktop/api/Winbase/nf-winbase-addatomw)/[DeleteAtom](/windows/desktop/api/Winbase/nf-winbase-deleteatom) to store strings in a local atom table, or  [GlobalAddAtom](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma)/[GlobalDeleteAtom](/windows/desktop/api/Winbase/nf-winbase-globaldeleteatom) if the atoms are needed cross-process.</span></span>

1. <span data-ttu-id="d4263-157">Se houver preocupação com o aplicativo que está causando problemas de tabela Atom do usuário, você poderá investigar a causa raiz conectando o depurador de kernel e dividindo o processo em chamadas para `UserAddAtomEx` ( `bae1 win32kbase!UserAddAtomEx /p <eprocess> "kc10;g"` ).</span><span class="sxs-lookup"><span data-stu-id="d4263-157">If there is concern about the application causing user atom table issues, you can investigate the root cause by connecting the kernel debugger and breaking into the process on calls to `UserAddAtomEx` (`bae1 win32kbase!UserAddAtomEx /p <eprocess> "kc10;g"`).</span></span> <span data-ttu-id="d4263-158">Procure `user32!` na pilha de chamadas para ver qual API está sendo chamada.</span><span class="sxs-lookup"><span data-stu-id="d4263-158">Look for `user32!` on the callstack to see which API is being called.</span></span> <span data-ttu-id="d4263-159">A metodologia é semelhante à detecção de problemas de tabela Atom global explicada na [identificação de vazamentos de tabela de Atom global](/archive/blogs/ntdebugging/identifying-global-atom-table-leaks).</span><span class="sxs-lookup"><span data-stu-id="d4263-159">The methodology is similar to the global atom table issue detection explained in [Identifying Global Atom Table Leaks](/archive/blogs/ntdebugging/identifying-global-atom-table-leaks).</span></span> <span data-ttu-id="d4263-160">Outra maneira de despejar o conteúdo da tabela Atom do usuário é chamando [GetClipboardFormatName](/windows/win32/api/winuser/nf-winuser-getclipboardformatnamea) sobre o intervalo de átomos possíveis de 0XC000 para 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="d4263-160">Another way to dump the contents of the user atom table is by calling [GetClipboardFormatName](/windows/win32/api/winuser/nf-winuser-getclipboardformatnamea) over the range of possible atoms from 0xC000 to 0xFFFF.</span></span> <span data-ttu-id="d4263-161">Se a contagem total de Atoms subir constantemente enquanto o aplicativo estiver em execução ou não retornar à linha de base quando o aplicativo for fechado, haverá um problema.</span><span class="sxs-lookup"><span data-stu-id="d4263-161">If the total atom count steadily goes up while the application is running or does not return to baseline when the app is closed, there is a problem.</span></span>

## <a name="local-atom-tables"></a><span data-ttu-id="d4263-162">Tabelas Atom locais</span><span class="sxs-lookup"><span data-stu-id="d4263-162">Local Atom Tables</span></span>

<span data-ttu-id="d4263-163">Um aplicativo pode usar uma tabela Atom local para gerenciar com eficiência um grande número de cadeias de caracteres usadas somente dentro do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d4263-163">An application can use a local atom table to efficiently manage a large number of strings used only within the application.</span></span> <span data-ttu-id="d4263-164">Essas cadeias de caracteres e os átomos associados estão disponíveis somente para o aplicativo que criou a tabela.</span><span class="sxs-lookup"><span data-stu-id="d4263-164">These strings, and the associated atoms, are available only to the application that created the table.</span></span>

<span data-ttu-id="d4263-165">Um aplicativo que requer a mesma cadeia de caracteres em várias estruturas pode reduzir o uso de memória usando uma tabela Atom local.</span><span class="sxs-lookup"><span data-stu-id="d4263-165">An application requiring the same string in a number of structures can reduce memory usage by using a local atom table.</span></span> <span data-ttu-id="d4263-166">Em vez de copiar a cadeia de caracteres em cada estrutura, o aplicativo pode posicionar a cadeia de caracteres na tabela Atom e incluir o átomo resultante nas estruturas.</span><span class="sxs-lookup"><span data-stu-id="d4263-166">Rather than copying the string into each structure, the application can place the string in the atom table and include the resulting atom in the structures.</span></span> <span data-ttu-id="d4263-167">Dessa forma, uma cadeia de caracteres aparece apenas uma vez na memória, mas pode ser usada muitas vezes no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d4263-167">In this way, a string appears only once in memory but can be used many times in the application.</span></span>

<span data-ttu-id="d4263-168">Os aplicativos também podem usar tabelas Atom locais para economizar tempo ao pesquisar uma cadeia de caracteres específica.</span><span class="sxs-lookup"><span data-stu-id="d4263-168">Applications can also use local atom tables to save time when searching for a particular string.</span></span> <span data-ttu-id="d4263-169">Para executar uma pesquisa, um aplicativo precisa apenas posicionar a cadeia de caracteres de pesquisa na tabela Atom e comparar o átomo resultante com os átomos nas estruturas relevantes.</span><span class="sxs-lookup"><span data-stu-id="d4263-169">To perform a search, an application need only place the search string in the atom table and compare the resulting atom with the atoms in the relevant structures.</span></span> <span data-ttu-id="d4263-170">Comparar Atoms normalmente é mais rápido do que comparar cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="d4263-170">Comparing atoms is typically faster than comparing strings.</span></span>

<span data-ttu-id="d4263-171">As tabelas Atom são implementadas como tabelas de hash.</span><span class="sxs-lookup"><span data-stu-id="d4263-171">Atom tables are implemented as hash tables.</span></span> <span data-ttu-id="d4263-172">Por padrão, uma tabela Atom local usa 37 buckets para sua tabela de hash.</span><span class="sxs-lookup"><span data-stu-id="d4263-172">By default, a local atom table uses 37 buckets for its hash table.</span></span> <span data-ttu-id="d4263-173">No entanto, você pode alterar o número de buckets usados chamando a função [**InitAtomTable**](/windows/desktop/api/Winbase/nf-winbase-initatomtable) .</span><span class="sxs-lookup"><span data-stu-id="d4263-173">However, you can change the number of buckets used by calling the [**InitAtomTable**](/windows/desktop/api/Winbase/nf-winbase-initatomtable) function.</span></span> <span data-ttu-id="d4263-174">No entanto, se o aplicativo chamar **InitAtomTable**, ele deverá fazê-lo antes de chamar qualquer outra função de gerenciamento de Atom.</span><span class="sxs-lookup"><span data-stu-id="d4263-174">If the application calls **InitAtomTable**, however, it must do so before calling any other atom-management functions.</span></span>

## <a name="atom-types"></a><span data-ttu-id="d4263-175">Tipos Atom</span><span class="sxs-lookup"><span data-stu-id="d4263-175">Atom Types</span></span>

<span data-ttu-id="d4263-176">Os aplicativos podem criar dois tipos de átomos: sequências de caracteres e Atoms inteiros.</span><span class="sxs-lookup"><span data-stu-id="d4263-176">Applications can create two types of atoms: string atoms and integer atoms.</span></span> <span data-ttu-id="d4263-177">Os valores de átomos de inteiros e Atoms de cadeia de caracteres não se sobrepõem, portanto, ambos os tipos de átomos podem ser usados no mesmo bloco de código.</span><span class="sxs-lookup"><span data-stu-id="d4263-177">The values of integer atoms and string atoms do not overlap, so both types of atoms can be used in the same block of code.</span></span>

<span data-ttu-id="d4263-178">Várias funções aceitam cadeias de caracteres ou Atoms como parâmetros.</span><span class="sxs-lookup"><span data-stu-id="d4263-178">Several functions accept either strings or atoms as parameters.</span></span> <span data-ttu-id="d4263-179">Ao passar um Atom para essas funções, um aplicativo pode usar a macro [**MAKEINTATOM**](/windows/desktop/api/Winbase/nf-winbase-makeintatom) para converter o Atom em um formulário que pode ser usado pela função.</span><span class="sxs-lookup"><span data-stu-id="d4263-179">When passing an atom to these functions, an application can use the [**MAKEINTATOM**](/windows/desktop/api/Winbase/nf-winbase-makeintatom) macro to convert the atom into a form that can be used by the function.</span></span>

<span data-ttu-id="d4263-180">As seções a seguir descrevem os tipos Atom.</span><span class="sxs-lookup"><span data-stu-id="d4263-180">The following sections describe atom types.</span></span>

-   [<span data-ttu-id="d4263-181">Átomos de cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="d4263-181">String Atoms</span></span>](#string-atoms)
-   [<span data-ttu-id="d4263-182">Atoms inteiros</span><span class="sxs-lookup"><span data-stu-id="d4263-182">Integer Atoms</span></span>](#integer-atoms)

### <a name="string-atoms"></a><span data-ttu-id="d4263-183">Átomos de cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="d4263-183">String Atoms</span></span>

<span data-ttu-id="d4263-184">Quando os aplicativos passam cadeias de caracteres terminadas com nulos para as funções [**GlobalAddAtom**](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma), [**addatom**](/windows/desktop/api/Winbase/nf-winbase-addatomw), [**GlobalFindAtom**](/windows/desktop/api/Winbase/nf-winbase-globalfindatoma)e [**FindAtom**](/windows/desktop/api/Winbase/nf-winbase-findatoma) , eles recebem *Atoms de cadeia* (inteiros de 16 bits) no retorno.</span><span class="sxs-lookup"><span data-stu-id="d4263-184">When applications pass null-terminated strings to the [**GlobalAddAtom**](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma), [**AddAtom**](/windows/desktop/api/Winbase/nf-winbase-addatomw), [**GlobalFindAtom**](/windows/desktop/api/Winbase/nf-winbase-globalfindatoma), and [**FindAtom**](/windows/desktop/api/Winbase/nf-winbase-findatoma) functions, they receive *string atoms* (16-bit integers) in return.</span></span> <span data-ttu-id="d4263-185">Os átomos de cadeia de caracteres têm as seguintes propriedades:</span><span class="sxs-lookup"><span data-stu-id="d4263-185">String atoms have the following properties:</span></span>

-   <span data-ttu-id="d4263-186">Os valores dos átomos de cadeia de caracteres estão no intervalo 0xC000 (MAXINTATOM) por meio de 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="d4263-186">The values of string atoms are in the range 0xC000 (MAXINTATOM) through 0xFFFF.</span></span>
-   <span data-ttu-id="d4263-187">O caso não é significativo em pesquisas de um nome Atom em uma tabela Atom.</span><span class="sxs-lookup"><span data-stu-id="d4263-187">Case is not significant in searches for an atom name in an atom table.</span></span> <span data-ttu-id="d4263-188">Além disso, a cadeia de caracteres inteira deve corresponder em uma operação de pesquisa; nenhuma correspondência de subcadeia de caracteres é executada.</span><span class="sxs-lookup"><span data-stu-id="d4263-188">Also, the entire string must match in a search operation; no substring matching is performed.</span></span>
-   <span data-ttu-id="d4263-189">A cadeia de caracteres associada a um átomo de cadeia de caracteres não pode ter mais de 255 bytes de tamanho.</span><span class="sxs-lookup"><span data-stu-id="d4263-189">The string associated with a string atom can be no more than 255 bytes in size.</span></span> <span data-ttu-id="d4263-190">Essa limitação se aplica a todas as funções Atom.</span><span class="sxs-lookup"><span data-stu-id="d4263-190">This limitation applies to all atom functions.</span></span>
-   <span data-ttu-id="d4263-191">Uma *contagem de referência* é associada a cada nome de Atom.</span><span class="sxs-lookup"><span data-stu-id="d4263-191">A *reference count* is associated with each atom name.</span></span> <span data-ttu-id="d4263-192">A contagem é incrementada sempre que o nome do Atom é adicionado à tabela e decrementado toda vez que o nome do Atom é excluído dela.</span><span class="sxs-lookup"><span data-stu-id="d4263-192">The count is incremented each time the atom name is added to the table and decremented each time the atom name is deleted from it.</span></span> <span data-ttu-id="d4263-193">Isso impede que usuários diferentes da mesma cadeia de caracteres Atom destruam os nomes de Atom uns dos outros.</span><span class="sxs-lookup"><span data-stu-id="d4263-193">This prevents different users of the same string atom from destroying each other's atom names.</span></span> <span data-ttu-id="d4263-194">Quando a contagem de referência para um nome Atom é igual a zero, o sistema remove o Atom e o nome do Atom da tabela.</span><span class="sxs-lookup"><span data-stu-id="d4263-194">When the reference count for an atom name equals zero, the system removes the atom and the atom name from the table.</span></span>

### <a name="integer-atoms"></a><span data-ttu-id="d4263-195">Atoms inteiros</span><span class="sxs-lookup"><span data-stu-id="d4263-195">Integer Atoms</span></span>

<span data-ttu-id="d4263-196">Os Atoms inteiros diferem dos átomos de cadeia de caracteres das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="d4263-196">Integer atoms differ from string atoms in the following ways:</span></span>

-   <span data-ttu-id="d4263-197">Os valores de átomos de inteiros estão no intervalo de 0x0001 a 0xBFFF (**MAXINTATOM**– 1).</span><span class="sxs-lookup"><span data-stu-id="d4263-197">The values of integer atoms are in the range 0x0001 through 0xBFFF (**MAXINTATOM**– 1).</span></span>
-   <span data-ttu-id="d4263-198">A representação de cadeia de caracteres de um inteiro Atom é \# *dddd*, em que os valores representados por *dddd* são dígitos decimais.</span><span class="sxs-lookup"><span data-stu-id="d4263-198">The string representation of an integer atom is \#*dddd*, where the values represented by *dddd* are decimal digits.</span></span> <span data-ttu-id="d4263-199">Os zeros à esquerda são ignorados.</span><span class="sxs-lookup"><span data-stu-id="d4263-199">Leading zeros are ignored.</span></span>
-   <span data-ttu-id="d4263-200">Não há nenhuma contagem de referência ou sobrecarga de armazenamento associada a um Atom inteiro.</span><span class="sxs-lookup"><span data-stu-id="d4263-200">There is no reference count or storage overhead associated with an integer atom.</span></span>

## <a name="atom-creation-and-usage-count"></a><span data-ttu-id="d4263-201">Criação de Atom e contagem de uso</span><span class="sxs-lookup"><span data-stu-id="d4263-201">Atom Creation and Usage Count</span></span>

<span data-ttu-id="d4263-202">Um aplicativo cria um Atom local chamando a função [**addatom**](/windows/desktop/api/Winbase/nf-winbase-addatomw) ; Ele cria um Atom global chamando a função [**GlobalAddAtom**](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma) .</span><span class="sxs-lookup"><span data-stu-id="d4263-202">An application creates a local atom by calling the [**AddAtom**](/windows/desktop/api/Winbase/nf-winbase-addatomw) function; it creates a global atom by calling the [**GlobalAddAtom**](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma) function.</span></span> <span data-ttu-id="d4263-203">Ambas as funções exigem um ponteiro para uma cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="d4263-203">Both functions require a pointer to a string.</span></span> <span data-ttu-id="d4263-204">O sistema pesquisa a tabela de Atom apropriada para a cadeia de caracteres e retorna o átomo correspondente para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d4263-204">The system searches the appropriate atom table for the string and returns the corresponding atom to the application.</span></span> <span data-ttu-id="d4263-205">No caso de um átomo de cadeia de caracteres, se a cadeia de caracteres já residir na tabela Atom, o sistema incrementará a contagem de referência para a cadeia de caracteres durante esse processo.</span><span class="sxs-lookup"><span data-stu-id="d4263-205">In the case of a string atom, if the string already resides in the atom table, the system increments the reference count for the string during this process.</span></span>

<span data-ttu-id="d4263-206">Chamadas repetidas para adicionar o mesmo nome de Atom retornam o mesmo Atom.</span><span class="sxs-lookup"><span data-stu-id="d4263-206">Repeated calls to add the same atom name return the same atom.</span></span> <span data-ttu-id="d4263-207">Se o nome do Atom não existir na tabela quando [**addatom**](/windows/desktop/api/Winbase/nf-winbase-addatomw) for chamado, o nome do Atom será adicionado à tabela e um novo Atom será retornado.</span><span class="sxs-lookup"><span data-stu-id="d4263-207">If the atom name does not exist in the table when [**AddAtom**](/windows/desktop/api/Winbase/nf-winbase-addatomw) is called, the atom name is added to the table and a new atom is returned.</span></span> <span data-ttu-id="d4263-208">Se for uma cadeia de caracteres Atom, sua contagem de referência também será definida como um.</span><span class="sxs-lookup"><span data-stu-id="d4263-208">If it is a string atom, its reference count is also set to one.</span></span>

<span data-ttu-id="d4263-209">Um aplicativo deve chamar a função [**DeleteAtom**](/windows/desktop/api/Winbase/nf-winbase-deleteatom) quando ele não precisar mais usar um Atom local; Ele deve chamar a função [**GlobalDeleteAtom**](/windows/desktop/api/Winbase/nf-winbase-globaldeleteatom) quando ele não precisar mais de um átomo global.</span><span class="sxs-lookup"><span data-stu-id="d4263-209">An application should call the [**DeleteAtom**](/windows/desktop/api/Winbase/nf-winbase-deleteatom) function when it no longer needs to use a local atom; it should call the [**GlobalDeleteAtom**](/windows/desktop/api/Winbase/nf-winbase-globaldeleteatom) function when it no longer needs a global atom.</span></span> <span data-ttu-id="d4263-210">No caso de um átomo de cadeia de caracteres, qualquer uma dessas funções reduz a contagem de referência do átomo correspondente por um.</span><span class="sxs-lookup"><span data-stu-id="d4263-210">In the case of a string atom, either of these functions reduces the reference count of the corresponding atom by one.</span></span> <span data-ttu-id="d4263-211">Quando a contagem de referência chega a zero, o sistema exclui o nome do Atom da tabela.</span><span class="sxs-lookup"><span data-stu-id="d4263-211">When the reference count reaches zero, the system deletes the atom name from the table.</span></span>

<span data-ttu-id="d4263-212">O nome do Atom de uma cadeia de caracteres Atom permanece na tabela global Atom, desde que sua contagem de referência seja maior que zero, mesmo depois que o aplicativo que o colocou na tabela for encerrado.</span><span class="sxs-lookup"><span data-stu-id="d4263-212">The atom name of a string atom remains in the global atom table as long as its reference count is greater than zero, even after the application that placed it in the table terminates.</span></span> <span data-ttu-id="d4263-213">Uma tabela Atom local é destruída quando o aplicativo associado é encerrado, independentemente das contagens de referência dos átomos na tabela.</span><span class="sxs-lookup"><span data-stu-id="d4263-213">A local atom table is destroyed when the associated application terminates, regardless of the reference counts of the atoms in the table.</span></span>

## <a name="atom-table-queries"></a><span data-ttu-id="d4263-214">Consultas de Atom-Table</span><span class="sxs-lookup"><span data-stu-id="d4263-214">Atom-Table Queries</span></span>

<span data-ttu-id="d4263-215">Um aplicativo pode determinar se uma cadeia de caracteres específica já está em uma tabela Atom usando a função [**FindAtom**](/windows/desktop/api/Winbase/nf-winbase-findatoma) ou [**GlobalFindAtom**](/windows/desktop/api/Winbase/nf-winbase-globalfindatoma) .</span><span class="sxs-lookup"><span data-stu-id="d4263-215">An application can determine whether a particular string is already in an atom table by using the [**FindAtom**](/windows/desktop/api/Winbase/nf-winbase-findatoma) or [**GlobalFindAtom**](/windows/desktop/api/Winbase/nf-winbase-globalfindatoma) function.</span></span> <span data-ttu-id="d4263-216">Essas funções pesquisam uma tabela Atom para a cadeia de caracteres especificada e, se a cadeia de caracteres estiver lá, retornará o átomo correspondente.</span><span class="sxs-lookup"><span data-stu-id="d4263-216">These functions search an atom table for the specified string and, if the string is there, return the corresponding atom.</span></span>

<span data-ttu-id="d4263-217">Um aplicativo pode usar a função [**Getatomname**](/windows/desktop/api/Winbase/nf-winbase-getatomnamea) ou [**GlobalGetAtomName**](/windows/desktop/api/Winbase/nf-winbase-globalgetatomnamea) para recuperar uma cadeia de caracteres de nome Atom de uma tabela Atom, desde que o aplicativo tenha o átomo correspondente à cadeia de caracteres que está sendo procurada.</span><span class="sxs-lookup"><span data-stu-id="d4263-217">An application can use the [**GetAtomName**](/windows/desktop/api/Winbase/nf-winbase-getatomnamea) or [**GlobalGetAtomName**](/windows/desktop/api/Winbase/nf-winbase-globalgetatomnamea) function to retrieve an atom-name string from an atom table, provided the application has the atom corresponding to the string being sought.</span></span> <span data-ttu-id="d4263-218">Ambas as funções copiam a cadeia de caracteres Atom-Name do átomo especificado para um buffer e retornam o comprimento da cadeia de caracteres que foi copiada.</span><span class="sxs-lookup"><span data-stu-id="d4263-218">Both functions copy the atom-name string of the specified atom to a buffer and return the length of the string that was copied.</span></span> <span data-ttu-id="d4263-219">**Getatomname** recupera uma cadeia de caracteres Atom-Name de uma tabela Atom local e **GlobalGetAtomName** recupera uma cadeia de caracteres de nome Atom da tabela global Atom.</span><span class="sxs-lookup"><span data-stu-id="d4263-219">**GetAtomName** retrieves an atom-name string from a local atom table, and **GlobalGetAtomName** retrieves an atom-name string from the global atom table.</span></span>

## <a name="atom-string-formats"></a><span data-ttu-id="d4263-220">Formatos de cadeia de caracteres Atom</span><span class="sxs-lookup"><span data-stu-id="d4263-220">Atom String Formats</span></span>

<span data-ttu-id="d4263-221">As funções [**addatom**](/windows/desktop/api/Winbase/nf-winbase-addatomw), [**GlobalAddAtom**](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma), [**FindAtom**](/windows/desktop/api/Winbase/nf-winbase-findatoma)e [**GlobalFindAtom**](/windows/desktop/api/Winbase/nf-winbase-globalfindatoma) usam um ponteiro para uma cadeia de caracteres terminada em nulo.</span><span class="sxs-lookup"><span data-stu-id="d4263-221">The [**AddAtom**](/windows/desktop/api/Winbase/nf-winbase-addatomw), [**GlobalAddAtom**](/windows/desktop/api/Winbase/nf-winbase-globaladdatoma), [**FindAtom**](/windows/desktop/api/Winbase/nf-winbase-findatoma), and [**GlobalFindAtom**](/windows/desktop/api/Winbase/nf-winbase-globalfindatoma) functions take a pointer to a null-terminated string.</span></span> <span data-ttu-id="d4263-222">Um aplicativo pode especificar esse ponteiro de uma das maneiras a seguir.</span><span class="sxs-lookup"><span data-stu-id="d4263-222">An application can specify this pointer in one of the following ways.</span></span>



|                    |                                                                                                    |
|--------------------|----------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d4263-223">\#*dia*</span><span class="sxs-lookup"><span data-stu-id="d4263-223">\#*dddd*</span></span>           | <span data-ttu-id="d4263-224">Um inteiro especificado como uma cadeia de caracteres decimal.</span><span class="sxs-lookup"><span data-stu-id="d4263-224">An integer specified as a decimal string.</span></span> <span data-ttu-id="d4263-225">Usado para criar ou encontrar um Atom inteiro.</span><span class="sxs-lookup"><span data-stu-id="d4263-225">Used to create or find an integer atom.</span></span>                  |
| <span data-ttu-id="d4263-226">*nome Atom da cadeia de caracteres*</span><span class="sxs-lookup"><span data-stu-id="d4263-226">*string atom name*</span></span> | <span data-ttu-id="d4263-227">Um nome Atom de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="d4263-227">A string atom name.</span></span> <span data-ttu-id="d4263-228">Usado para adicionar um nome Atom de cadeia de caracteres a uma tabela Atom e receber um Atom em retorno.</span><span class="sxs-lookup"><span data-stu-id="d4263-228">Used to add a string atom name to an atom table and receive an atom in return.</span></span> |



 

 

 
