---
title: Conceitos básicos
description: Este tópico discute os principais conceitos relacionados à troca de dados dinâmicas.
ms.assetid: 37826d83-4dcd-484f-b1aa-87bf309c5c09
keywords:
- Interface do usuário do Windows, troca dinâmica de dados (DDE)
- Interface do usuário do Windows, biblioteca de gerenciamento de troca dinâmica de dados (DDEML)
- Troca dinâmica de dados (DDE), interação do servidor cliente
- DDE (troca dinâmica de dados), interação do servidor cliente
- troca de dados, troca dinâmica de dados (DDE)
- Data Exchange, biblioteca de gerenciamento de troca dinâmica de dados (DDEML)
- Troca dinâmica de dados (DDE), aplicativos cliente
- DDE (troca dinâmica de dados), aplicativos cliente
- Troca dinâmica de dados (DDE), aplicativos de servidor
- DDE (troca dinâmica de dados), aplicativos de servidor
- Troca dinâmica de dados (DDE), funções de retorno de chamada
- DDE (troca dinâmica de dados), funções de retorno de chamada
- Troca dinâmica de dados (DDE), transações
- DDE (troca dinâmica de dados), transações
- Troca dinâmica de dados (DDE), nomes de serviço
- DDE (troca dinâmica de dados), nomes de serviço
- Troca dinâmica de dados (DDE), nomes de item
- DDE (troca dinâmica de dados), nomes de item
- Troca dinâmica de dados (DDE), nomes de tópico
- DDE (troca dinâmica de dados), nomes de tópico
- Troca dinâmica de dados (DDE), tópico do sistema
- DDE (troca dinâmica de dados), tópico do sistema
- DDEML (biblioteca de gerenciamento de troca dinâmica de dados), inicialização
- DDEML (biblioteca de gerenciamento de troca dinâmica de dados), inicialização
- DDEML (biblioteca de gerenciamento de troca dinâmica de dados), funções de retorno de chamada
- DDEML (troca dinâmica de dados biblioteca de gerenciamento), funções de retorno de chamada
- DDEML (biblioteca de gerenciamento de troca dinâmica de dados), gerenciamento de cadeia de caracteres
- DDEML (biblioteca de gerenciamento de troca dinâmica de dados), gerenciamento de cadeia de caracteres
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0c564bffbcbb06ddc3a0e0fa4e0a9ed398d3ca55
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103641254"
---
# <a name="basic-concepts-dde"></a><span data-ttu-id="4c7c7-131">Conceitos básicos (DDE)</span><span class="sxs-lookup"><span data-stu-id="4c7c7-131">Basic Concepts (DDE)</span></span>

<span data-ttu-id="4c7c7-132">Esses conceitos são fundamentais para entender troca dinâmica de dados (DDE) e a biblioteca de gerenciamento de troca dinâmica de dados (DDEML).</span><span class="sxs-lookup"><span data-stu-id="4c7c7-132">These concepts are key to understanding Dynamic Data Exchange (DDE) and the Dynamic Data Exchange Management Library (DDEML).</span></span>

-   [<span data-ttu-id="4c7c7-133">Interação de cliente e servidor</span><span class="sxs-lookup"><span data-stu-id="4c7c7-133">Client and Server Interaction</span></span>](#client-and-server-interaction)
-   [<span data-ttu-id="4c7c7-134">Transações e a função de retorno de chamada DDE</span><span class="sxs-lookup"><span data-stu-id="4c7c7-134">Transactions and the DDE Callback Function</span></span>](#transactions-and-the-dde-callback-function)
-   [<span data-ttu-id="4c7c7-135">Nomes de serviço, nomes de tópico e nomes de item</span><span class="sxs-lookup"><span data-stu-id="4c7c7-135">Service Names, Topic Names, and Item Names</span></span>](#service-names-topic-names-and-item-names)
-   [<span data-ttu-id="4c7c7-136">Tópico do sistema</span><span class="sxs-lookup"><span data-stu-id="4c7c7-136">System Topic</span></span>](#system-topic)
-   [<span data-ttu-id="4c7c7-137">Initialization</span><span class="sxs-lookup"><span data-stu-id="4c7c7-137">Initialization</span></span>](#initialization)
-   [<span data-ttu-id="4c7c7-138">Função de retorno de chamada</span><span class="sxs-lookup"><span data-stu-id="4c7c7-138">Callback Function</span></span>](#callback-function)
-   [<span data-ttu-id="4c7c7-139">Gerenciamento de cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="4c7c7-139">String Management</span></span>](#string-management)
-   [<span data-ttu-id="4c7c7-140">DDEML e threads</span><span class="sxs-lookup"><span data-stu-id="4c7c7-140">DDEML and Threads</span></span>](#ddeml-and-threads)

## <a name="client-and-server-interaction"></a><span data-ttu-id="4c7c7-141">Interação de cliente e servidor</span><span class="sxs-lookup"><span data-stu-id="4c7c7-141">Client and Server Interaction</span></span>

<span data-ttu-id="4c7c7-142">O DDE sempre ocorre entre um aplicativo cliente e um aplicativo de servidor.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-142">DDE always occurs between a client application and a server application.</span></span> <span data-ttu-id="4c7c7-143">O *aplicativo cliente DDE* inicia o Exchange estabelecendo uma conversa com o servidor para enviar transações ao servidor.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-143">The *DDE client application* initiates the exchange by establishing a conversation with the server to send transactions to the server.</span></span> <span data-ttu-id="4c7c7-144">Uma transação é uma solicitação de dados ou serviços.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-144">A transaction is a request for data or services.</span></span> <span data-ttu-id="4c7c7-145">O *aplicativo do servidor DDE* responde às transações fornecendo dados ou serviços ao cliente.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-145">The *DDE server application* responds to transactions by providing data or services to the client.</span></span> <span data-ttu-id="4c7c7-146">Por exemplo, um aplicativo de gráficos pode conter um gráfico de barras que representa os lucros trimestrais de uma empresa, mas os dados do grafo de barras podem estar contidos em um aplicativo de planilha.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-146">For example, a graphics application might contain a bar graph representing a corporation's quarterly profits, but the data for the bar graph might be contained in a spreadsheet application.</span></span> <span data-ttu-id="4c7c7-147">Para obter os valores de lucro mais recentes, o aplicativo de gráficos (o cliente) pode estabelecer uma conversa com o aplicativo de planilha (o servidor).</span><span class="sxs-lookup"><span data-stu-id="4c7c7-147">To obtain the latest profit figures, the graphics application (the client) could establish a conversation with the spreadsheet application (the server).</span></span> <span data-ttu-id="4c7c7-148">O aplicativo gráfico poderia então enviar uma transação para o aplicativo de planilha, solicitando os valores de lucro mais recentes.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-148">The graphics application could then send a transaction to the spreadsheet application, requesting the latest profit figures.</span></span>

<span data-ttu-id="4c7c7-149">Um servidor pode ter muitos clientes ao mesmo tempo e um cliente pode solicitar dados de vários servidores.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-149">A server can have many clients at the same time, and a client can request data from multiple servers.</span></span> <span data-ttu-id="4c7c7-150">Um aplicativo também pode ser um cliente e um servidor.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-150">An application can also be both a client and a server.</span></span> <span data-ttu-id="4c7c7-151">O cliente ou o servidor pode encerrar a conversa a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-151">Either the client or the server can terminate the conversation at any time.</span></span>

## <a name="transactions-and-the-dde-callback-function"></a><span data-ttu-id="4c7c7-152">Transações e a função de retorno de chamada DDE</span><span class="sxs-lookup"><span data-stu-id="4c7c7-152">Transactions and the DDE Callback Function</span></span>

<span data-ttu-id="4c7c7-153">O DDEML notifica um aplicativo sobre a atividade DDE que afeta o aplicativo enviando transações para a função de retorno de chamada DDE do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-153">The DDEML notifies an application about DDE activity that affects the application by sending transactions to the application's DDE callback function.</span></span> <span data-ttu-id="4c7c7-154">Uma *transação DDE* é semelhante a uma mensagem que é uma constante nomeada acompanhada por outros parâmetros que contêm informações adicionais sobre a transação.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-154">A *DDE transaction* is similar to a message   it is a named constant accompanied by other parameters that contain additional information about the transaction.</span></span>

<span data-ttu-id="4c7c7-155">O DDEML passa uma transação para uma função de retorno de chamada DDE definida pelo aplicativo que executa uma ação apropriada ao tipo de transação.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-155">The DDEML passes a transaction to an application-defined DDE callback function that carries out an action appropriate to the type of transaction.</span></span> <span data-ttu-id="4c7c7-156">Por exemplo, quando um aplicativo cliente tenta estabelecer uma conversa com um aplicativo de servidor, o cliente chama a função [**DdeConnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) .</span><span class="sxs-lookup"><span data-stu-id="4c7c7-156">For example, when a client application attempts to establish a conversation with a server application, the client calls the [**DdeConnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) function.</span></span> <span data-ttu-id="4c7c7-157">Essa função faz com que o DDEML envie uma transação [**XTYP \_ Connect**](xtyp-connect.md) para a função de retorno de chamada DDE do servidor.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-157">This function causes the DDEML to send an [**XTYP\_CONNECT**](xtyp-connect.md) transaction to the server's DDE callback function.</span></span> <span data-ttu-id="4c7c7-158">A função de retorno de chamada pode permitir a conversa retornando **true** para o ddeml, ou pode negar a conversa retornando **false**.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-158">The callback function can allow the conversation by returning **TRUE** to the DDEML, or it can deny the conversation by returning **FALSE**.</span></span> <span data-ttu-id="4c7c7-159">Para obter uma discussão detalhada sobre as transações, consulte [Gerenciamento de transações](transaction-management.md).</span><span class="sxs-lookup"><span data-stu-id="4c7c7-159">For a detailed discussion of transactions, see [Transaction Management](transaction-management.md).</span></span>

## <a name="service-names-topic-names-and-item-names"></a><span data-ttu-id="4c7c7-160">Nomes de serviço, nomes de tópico e nomes de item</span><span class="sxs-lookup"><span data-stu-id="4c7c7-160">Service Names, Topic Names, and Item Names</span></span>

<span data-ttu-id="4c7c7-161">Um servidor DDE usa um nome de serviço de hierarquia de três níveis (chamado de "nome do aplicativo" na documentação DDE anterior), nome do tópico e nome do item para identificar exclusivamente uma unidade de dados que o servidor pode trocar durante uma conversa.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-161">A DDE server uses a three-level hierarchy   service name (called "application name" in previous DDE documentation), topic name, and item name   to uniquely identify a unit of data the server can exchange during a conversation.</span></span>

<span data-ttu-id="4c7c7-162">Um *nome de serviço* é uma cadeia de caracteres que um aplicativo de servidor responde quando um cliente tenta estabelecer uma conversa com o servidor.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-162">A *service name* is a string a server application responds to when a client attempts to establish a conversation with the server.</span></span> <span data-ttu-id="4c7c7-163">Um cliente deve especificar esse nome de serviço para estabelecer uma conversa com o servidor.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-163">A client must specify this service name to establish a conversation with the server.</span></span> <span data-ttu-id="4c7c7-164">Embora um servidor possa responder a muitos nomes de serviço, a maioria dos servidores responde a apenas um nome.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-164">Although a server can respond to many service names, most servers respond to only one name.</span></span>

<span data-ttu-id="4c7c7-165">Um *nome de tópico* é uma cadeia de caracteres que identifica um contexto de dados lógicos.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-165">A *topic name* is a string that identifies a logical data context.</span></span> <span data-ttu-id="4c7c7-166">Para servidores que operam em documentos baseados em arquivo, os nomes de tópico são normalmente nomes de arquivos; para outros servidores, eles são cadeias de caracteres específicas do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-166">For servers that operate on file-based documents, topic names are typically filenames; for other servers, they are other application-specific strings.</span></span> <span data-ttu-id="4c7c7-167">Um cliente deve especificar um nome de tópico junto com o nome do serviço de um servidor ao tentar estabelecer uma conversa com um servidor.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-167">A client must specify a topic name along with a server's service name when it attempts to establish a conversation with a server.</span></span>

<span data-ttu-id="4c7c7-168">Um *nome de item* é uma cadeia de caracteres que identifica uma unidade de dados que um servidor pode passar para um cliente durante uma transação.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-168">An *item name* is a string that identifies a unit of data a server can pass to a client during a transaction.</span></span> <span data-ttu-id="4c7c7-169">Por exemplo, um nome de item pode identificar um inteiro, uma cadeia de caracteres, vários parágrafos de texto ou um bitmap.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-169">For example, an item name might identify an integer, a string, several paragraphs of text, or a bitmap.</span></span>

<span data-ttu-id="4c7c7-170">Os nomes de serviço, tópico e item permitem que o cliente estabeleça uma conversa com um servidor e receba dados do servidor.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-170">The service, topic, and item names enable the client to establish a conversation with a server and to receive data from the server.</span></span>

## <a name="system-topic"></a><span data-ttu-id="4c7c7-171">Tópico do sistema</span><span class="sxs-lookup"><span data-stu-id="4c7c7-171">System Topic</span></span>

<span data-ttu-id="4c7c7-172">O tópico System fornece um contexto para obter informações de interesse geral para qualquer cliente DDE.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-172">The System topic provides a context for information of general interest to any DDE client.</span></span> <span data-ttu-id="4c7c7-173">É recomendável que os aplicativos de servidor ofereçam suporte ao tópico do sistema em todos os momentos.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-173">It is recommended that server applications support the System topic at all times.</span></span> <span data-ttu-id="4c7c7-174">O tópico System é definido em DDEML. Arquivo de cabeçalho H como \_ tópico SZDDESYS.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-174">The System topic is defined in the DDEML.H header file as SZDDESYS\_TOPIC.</span></span>

<span data-ttu-id="4c7c7-175">Para determinar quais servidores estão presentes e os tipos de informações que eles podem fornecer, um aplicativo cliente pode solicitar uma conversa no tópico do sistema ao iniciar, definindo o nome do dispositivo como **nulo**.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-175">To determine which servers are present and the kinds of information they can provide, a client application can request a conversation on the System topic upon starting, setting the device name to **NULL**.</span></span> <span data-ttu-id="4c7c7-176">Essas conversas de curinga são dispendiosas em termos de desempenho do sistema, portanto, devem ser mantidas em um mínimo.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-176">Such wildcard conversations are costly in terms of system performance, so they should be kept to a minimum.</span></span> <span data-ttu-id="4c7c7-177">Para obter mais informações sobre como iniciar conversas DDE, consulte [Gerenciamento de conversa](conversation-management.md).</span><span class="sxs-lookup"><span data-stu-id="4c7c7-177">For more information about initiating DDE conversations, see [Conversation Management](conversation-management.md).</span></span>

<span data-ttu-id="4c7c7-178">Um servidor deve dar suporte aos seguintes nomes de item no tópico do sistema e em qualquer outro nome de item que seja útil para um cliente.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-178">A server must support the following item names within the System topic and any other item names that are useful to a client.</span></span>



| <span data-ttu-id="4c7c7-179">Item</span><span class="sxs-lookup"><span data-stu-id="4c7c7-179">Item</span></span>                     | <span data-ttu-id="4c7c7-180">Descrição</span><span class="sxs-lookup"><span data-stu-id="4c7c7-180">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|--------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="4c7c7-181">\_lista de itens do SZDDE \_</span><span class="sxs-lookup"><span data-stu-id="4c7c7-181">SZDDE\_ITEM\_ITEMLIST</span></span>    | <span data-ttu-id="4c7c7-182">Uma lista de itens com suporte em um tópico que não é do sistema.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-182">A list of the items supported under a non-System topic.</span></span> <span data-ttu-id="4c7c7-183">(Essa lista pode variar de momentos para momento e de tópico para tópico.)</span><span class="sxs-lookup"><span data-stu-id="4c7c7-183">(This list can vary from moment to moment and from topic to topic.)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="4c7c7-184">\_formatos de item SZDDESYS \_</span><span class="sxs-lookup"><span data-stu-id="4c7c7-184">SZDDESYS\_ITEM\_FORMATS</span></span>  | <span data-ttu-id="4c7c7-185">Uma lista delimitada por tabulação de cadeias de caracteres que representa todos os formatos de área de transferência possivelmente compatíveis com o aplicativo de serviço.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-185">A tab-delimited list of strings representing all clipboard formats potentially supported by the service application.</span></span> <span data-ttu-id="4c7c7-186">Cadeias de caracteres que representam formatos de área de transferência predefinidos são equivalentes aos valores de CF \_ com o prefixo "CF \_ " removido.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-186">Strings that represent predefined clipboard formats are equivalent to the CF\_ values with the "CF\_" prefix removed.</span></span> <span data-ttu-id="4c7c7-187">Por exemplo, o formato de texto do CF \_ é representado pela cadeia de caracteres "text".</span><span class="sxs-lookup"><span data-stu-id="4c7c7-187">For example, the CF\_TEXT format is represented by the string "TEXT".</span></span> <span data-ttu-id="4c7c7-188">Essas cadeias de caracteres devem ser maiúsculas para identificá-las ainda mais como formatos predefinidos.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-188">These strings must be uppercase to further identify them as predefined formats.</span></span> <span data-ttu-id="4c7c7-189">A lista de formatos deve aparecer na ordem do conteúdo mais rico para o mais rico em conteúdo.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-189">The list of formats must appear in the order of most rich in content to least rich in content.</span></span> <span data-ttu-id="4c7c7-190">Para obter mais informações sobre formatos de área de transferência e dados de renderização, consulte [área de transferência](clipboard.md).</span><span class="sxs-lookup"><span data-stu-id="4c7c7-190">For more information about clipboard formats and rendering data, see [Clipboard](clipboard.md).</span></span><br/> |
| <span data-ttu-id="4c7c7-191">\_ajuda do item SZDDESYS \_</span><span class="sxs-lookup"><span data-stu-id="4c7c7-191">SZDDESYS\_ITEM\_HELP</span></span>     | <span data-ttu-id="4c7c7-192">Informações legíveis ao usuário de interesse geral.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-192">User-readable information of general interest.</span></span> <span data-ttu-id="4c7c7-193">Esse item deve conter, no mínimo, informações sobre como usar os recursos de DDE do aplicativo de servidor.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-193">This item must contain, at a minimum, information on how to use the server application's DDE features.</span></span> <span data-ttu-id="4c7c7-194">Essas informações podem incluir, mas não se limitando a, como especificar itens dentro de tópicos, o que executa cadeias de caracteres que o servidor pode executar, o que as transações de busca são permitidas e como encontrar ajuda em outros itens de tópico do sistema.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-194">This information can include, but is not limited to, how to specify items within topics, what execute strings the server can perform, what poke transactions are allowed, and how to find help on other System topic items.</span></span>                                                                                                                                                                                                                           |
| <span data-ttu-id="4c7c7-195">SZDDESYS \_ item \_ RTNMSG</span><span class="sxs-lookup"><span data-stu-id="4c7c7-195">SZDDESYS\_ITEM\_RTNMSG</span></span>   | <span data-ttu-id="4c7c7-196">Detalhes de suporte para a mensagem de [**\_ \_ confirmação de DDE do WM**](wm-dde-ack.md) usada mais recentemente.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-196">Supporting detail for the most recently used [**WM\_DDE\_ACK**](wm-dde-ack.md) message.</span></span> <span data-ttu-id="4c7c7-197">Esse item é útil quando são necessários mais de 8 bits de dados de retorno específicos do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-197">This item is useful when more than 8 bits of application-specific return data are required.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="4c7c7-198">\_status do item de SZDDESYS \_</span><span class="sxs-lookup"><span data-stu-id="4c7c7-198">SZDDESYS\_ITEM\_STATUS</span></span>   | <span data-ttu-id="4c7c7-199">Uma indicação do status atual do servidor.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-199">An indication of the current status of the server.</span></span> <span data-ttu-id="4c7c7-200">Normalmente, esse item dá suporte apenas ao \_ formato de texto do CF e contém a cadeia de caracteres pronta ou ocupada.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-200">Typically, this item supports only the CF\_TEXT format and contains the Ready or Busy string.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="4c7c7-201">SZDDESYS \_ item \_ SYSITEMS</span><span class="sxs-lookup"><span data-stu-id="4c7c7-201">SZDDESYS\_ITEM\_SYSITEMS</span></span> | <span data-ttu-id="4c7c7-202">Uma lista dos itens com suporte no tópico System por este servidor.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-202">A list of the items supported under the System topic by this server.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="4c7c7-203">\_Tópicos do item SZDDESYS \_</span><span class="sxs-lookup"><span data-stu-id="4c7c7-203">SZDDESYS\_ITEM\_TOPICS</span></span>   | <span data-ttu-id="4c7c7-204">Uma lista dos tópicos com suporte no servidor na hora atual.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-204">A list of the topics supported by the server at the current time.</span></span> <span data-ttu-id="4c7c7-205">(Essa lista pode variar de um momento até o momento.)</span><span class="sxs-lookup"><span data-stu-id="4c7c7-205">(This list can vary from moment to moment.)</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |



 

<span data-ttu-id="4c7c7-206">Esses nomes de item são valores definidos no DDEML. Arquivo de cabeçalho H.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-206">These item names are values defined in the DDEML.H header file.</span></span> <span data-ttu-id="4c7c7-207">Para obter identificadores de cadeias de caracteres para essas cadeias, um aplicativo deve usar as funções de gerenciamento de cadeia de caracteres de DDEML, assim como faria para qualquer outra cadeia de caracteres em um aplicativo DDEML.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-207">To obtain string handles to these strings, an application must use the DDEML string-management functions, just as it would for any other string in a DDEML application.</span></span> <span data-ttu-id="4c7c7-208">Para obter mais informações sobre o gerenciamento de cadeias de caracteres, consulte [Gerenciamento de cadeia](#string-management).</span><span class="sxs-lookup"><span data-stu-id="4c7c7-208">For more information about managing strings, see [String Management](#string-management).</span></span>

## <a name="initialization"></a><span data-ttu-id="4c7c7-209">Inicialização</span><span class="sxs-lookup"><span data-stu-id="4c7c7-209">Initialization</span></span>

<span data-ttu-id="4c7c7-210">Antes de chamar qualquer outra função de DDEML, um aplicativo deve chamar a função [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) .</span><span class="sxs-lookup"><span data-stu-id="4c7c7-210">Before calling any other DDEML function, an application must call the [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) function.</span></span> <span data-ttu-id="4c7c7-211">O **DdeInitialize** Obtém um identificador de instância para o aplicativo, registra a função de retorno de chamada DDE do aplicativo com o DDE e especifica os sinalizadores de filtro de transação para a função de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-211">**DdeInitialize** obtains an instance identifier for the application, registers the application's DDE callback function with the DDE, and specifies the transaction filter flags for the callback function.</span></span>

<span data-ttu-id="4c7c7-212">Cada instância de um aplicativo ou uma DLL deve passar seu identificador de instância como o parâmetro *idInst* para qualquer outra função de ddeml que o exija.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-212">Each instance of an application or a DLL must pass its instance identifier as the *idInst* parameter to any other DDEML function that requires it.</span></span> <span data-ttu-id="4c7c7-213">A finalidade de várias instâncias de DDEML é dar suporte a DLLs que devem usar o DDEML ao mesmo tempo em que um aplicativo o está usando.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-213">The purpose of multiple DDEML instances is to support DLLs that must use the DDEML at the same time an application is using it.</span></span> <span data-ttu-id="4c7c7-214">Um aplicativo não deve usar mais de uma instância do DDEML.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-214">An application must not use more than one instance of the DDEML.</span></span>

<span data-ttu-id="4c7c7-215">Os *filtros de transação* otimizam o desempenho do sistema impedindo que o ddeml transmita transações indesejadas para a função de retorno de chamada DDE do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-215">*Transaction filters* optimize system performance by preventing the DDEML from passing unwanted transactions to the application's DDE callback function.</span></span> <span data-ttu-id="4c7c7-216">Um aplicativo define os filtros de transação no parâmetro [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) *ufCmd* .</span><span class="sxs-lookup"><span data-stu-id="4c7c7-216">An application sets the transaction filters in the [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) *ufCmd* parameter.</span></span> <span data-ttu-id="4c7c7-217">Um aplicativo deve especificar um sinalizador de filtro de transação para cada tipo de transação que ele não processa em sua função de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-217">An application must specify a transaction filter flag for each type of transaction that it does not process in its callback function.</span></span> <span data-ttu-id="4c7c7-218">Um aplicativo pode alterar seus filtros de transação com uma chamada subsequente para **DdeInitialize**.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-218">An application can change its transaction filters with a subsequent call to **DdeInitialize**.</span></span> <span data-ttu-id="4c7c7-219">Para obter mais informações sobre transações, consulte [Gerenciamento de transações](transaction-management.md).</span><span class="sxs-lookup"><span data-stu-id="4c7c7-219">For more information about transactions, see [Transaction Management](transaction-management.md).</span></span>

<span data-ttu-id="4c7c7-220">O exemplo a seguir mostra como inicializar um aplicativo para usar o DDEML.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-220">The following example shows how to initialize an application to use the DDEML.</span></span>


```
DWORD idInst = 0; 
HINSTANCE hinst; 
 
DdeInitialize(&idInst,         // receives instance identifier 
    (PFNCALLBACK) DdeCallback, // pointer to callback function 
    CBF_FAIL_EXECUTES |        // filter XTYPE_EXECUTE 
    CBF_SKIP_ALLNOTIFICATIONS, // filter notifications 
    0); 
```



<span data-ttu-id="4c7c7-221">Um aplicativo deve chamar a função [**DdeUninitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeuninitialize) quando ele não vai mais usar o ddeml.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-221">An application must call the [**DdeUninitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeuninitialize) function when it is no longer going to use the DDEML.</span></span> <span data-ttu-id="4c7c7-222">Essa função encerra todas as conversas abertas no momento para o aplicativo e libera os recursos de DDEML que o sistema alocou para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-222">This function terminates any conversations currently open for the application and frees the DDEML resources the system allocated for the application.</span></span>

## <a name="callback-function"></a><span data-ttu-id="4c7c7-223">Função de retorno da chamada</span><span class="sxs-lookup"><span data-stu-id="4c7c7-223">Callback Function</span></span>

<span data-ttu-id="4c7c7-224">Um aplicativo que usa o DDEML deve fornecer uma função de retorno de chamada que processa os eventos DDE que afetam o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-224">An application that uses the DDEML must provide a callback function that processes the DDE events affecting the application.</span></span> <span data-ttu-id="4c7c7-225">O DDEML notifica um aplicativo sobre tais eventos enviando transações para a função de retorno de chamada DDE do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-225">The DDEML notifies an application of such events by sending transactions to the application's DDE callback function.</span></span> <span data-ttu-id="4c7c7-226">As transações que uma função de retorno de chamada recebe dependem de qual filtro de retorno de chamada sinaliza o aplicativo especificado em [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) e se o aplicativo é um cliente, um servidor ou ambos.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-226">The transactions a callback function receives depend on which callback filter flags the application specified in [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) and whether the application is a client, a server, or both.</span></span> <span data-ttu-id="4c7c7-227">Para obter mais informações, consulte [**DdeCallback**](/windows/win32/api/ddeml/nc-ddeml-pfncallback).</span><span class="sxs-lookup"><span data-stu-id="4c7c7-227">For more information, please see [**DdeCallback**](/windows/win32/api/ddeml/nc-ddeml-pfncallback).</span></span>

<span data-ttu-id="4c7c7-228">O exemplo a seguir mostra a estrutura geral de uma função de retorno de chamada para um aplicativo cliente típico.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-228">The following example shows the general structure of a callback function for a typical client application.</span></span>


```
HDDEDATA CALLBACK DdeCallback(uType, uFmt, hconv, hsz1, 
    hsz2, hdata, dwData1, dwData2) 
UINT uType;       // transaction type 
UINT uFmt;        // clipboard data format 
HCONV hconv;      // handle to conversation 
HSZ hsz1;         // handle to string 
HSZ hsz2;         // handle to string 
HDDEDATA hdata;   // handle to global memory object 
DWORD dwData1;    // transaction-specific data 
DWORD dwData2;    // transaction-specific data 
{ 
    switch (uType) 
    { 
        case XTYP_REGISTER: 
        case XTYP_UNREGISTER: 
            . 
            . 
            . 
            return (HDDEDATA) NULL; 
 
        case XTYP_ADVDATA: 
            . 
            . 
            . 
            return (HDDEDATA) DDE_FACK; 
 
        case XTYP_XACT_COMPLETE: 
            
            // 
            
            return (HDDEDATA) NULL; 
 
        case XTYP_DISCONNECT: 
            
            // 
            
            return (HDDEDATA) NULL; 
 
        default: 
            return (HDDEDATA) NULL; 
    } 
} 
```



<span data-ttu-id="4c7c7-229">O parâmetro *uType* especifica o tipo de transação enviado à função de retorno de chamada pelo ddeml.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-229">The *uType* parameter specifies the transaction type sent to the callback function by the DDEML.</span></span> <span data-ttu-id="4c7c7-230">Os valores dos parâmetros restantes dependem do tipo de transação.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-230">The values of the remaining parameters depend on the transaction type.</span></span> <span data-ttu-id="4c7c7-231">Os tipos de transação e os eventos que os geram são descritos nos tópicos a seguir.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-231">The transaction types and the events that generate them are described in the following topics.</span></span> <span data-ttu-id="4c7c7-232">Para obter informações detalhadas sobre cada tipo de transação, consulte [Gerenciamento de transações](transaction-management.md).</span><span class="sxs-lookup"><span data-stu-id="4c7c7-232">For detailed information about each transaction type, see [Transaction Management](transaction-management.md).</span></span>

## <a name="string-management"></a><span data-ttu-id="4c7c7-233">Gerenciamento de cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="4c7c7-233">String Management</span></span>

<span data-ttu-id="4c7c7-234">Para executar uma tarefa DDE, muitas funções de DDEML exigem acesso a cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-234">To carry out a DDE task, many DDEML functions require access to strings.</span></span> <span data-ttu-id="4c7c7-235">Por exemplo, um cliente deve especificar um nome de serviço e um nome de tópico ao chamar a função [**DdeConnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) para solicitar uma conversa com um servidor.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-235">For example, a client must specify a service name and a topic name when it calls the [**DdeConnect**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) function to request a conversation with a server.</span></span> <span data-ttu-id="4c7c7-236">Um aplicativo especifica uma cadeia de caracteres passando um identificador de cadeia de caracteres (HSZ) em vez de um ponteiro em uma função DDEML.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-236">An application specifies a string by passing a string handle (HSZ) rather than a pointer in a DDEML function.</span></span> <span data-ttu-id="4c7c7-237">Um *identificador de cadeia de caracteres* é um valor **DWORD** , atribuído pelo sistema, que identifica uma cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-237">A *string handle* is a **DWORD** value, assigned by the system, that identifies a string.</span></span>

<span data-ttu-id="4c7c7-238">Um aplicativo pode obter um identificador de cadeia de caracteres para uma cadeia de caracteres específica chamando a função [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea) .</span><span class="sxs-lookup"><span data-stu-id="4c7c7-238">An application can obtain a string handle to a particular string by calling the [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea) function.</span></span> <span data-ttu-id="4c7c7-239">Essa função registra a cadeia de caracteres com o sistema e retorna um identificador de cadeia de caracteres para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-239">This function registers the string with the system and returns a string handle to the application.</span></span> <span data-ttu-id="4c7c7-240">O aplicativo pode passar o identificador para as funções DDEML que devem acessar a cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-240">The application can pass the handle to DDEML functions that must access the string.</span></span> <span data-ttu-id="4c7c7-241">O exemplo a seguir obtém identificadores de cadeia de caracteres para a cadeia de caracteres do tópico do sistema e a cadeia de nome do serviço.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-241">The following example obtains string handles to the System topic string and the service name string.</span></span>


```
HSZ hszServName; 
HSZ hszSysTopic; 
hszServName = DdeCreateStringHandle( 
    idInst,         // instance identifier 
    "MyServer",     // string to register 
    CP_WINANSI);    // Windows ANSI code page 
 
hszSysTopic = DdeCreateStringHandle( 
    idInst,         // instance identifier 
    SZDDESYS_TOPIC, // System topic 
    CP_WINANSI);    // Windows ANSI code page 
    
```



<span data-ttu-id="4c7c7-242">O parâmetro *idInst* no exemplo anterior especifica o identificador de instância obtido pela função [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) .</span><span class="sxs-lookup"><span data-stu-id="4c7c7-242">The *idInst* parameter in the preceding example specifies the instance identifier obtained by the [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) function.</span></span>

<span data-ttu-id="4c7c7-243">A função de retorno de chamada DDE de um aplicativo recebe um ou mais identificadores de cadeia de caracteres durante a maioria das transações DDE.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-243">An application's DDE callback function receives one or more string handles during most DDE transactions.</span></span> <span data-ttu-id="4c7c7-244">Por exemplo, um servidor recebe dois identificadores de cadeia de caracteres durante a transação de [**\_ solicitação XTYP**](xtyp-request.md) : um identifica uma cadeia de caracteres que especifica um nome de tópico e o outro identifica uma cadeia de caracteres que especifica um nome de item.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-244">For example, a server receives two string handles during the [**XTYP\_REQUEST**](xtyp-request.md) transaction: one identifies a string specifying a topic name, and the other identifies a string specifying an item name.</span></span> <span data-ttu-id="4c7c7-245">Um aplicativo pode obter o comprimento da cadeia de caracteres que corresponde a um identificador de cadeia de caracteres e copiar a cadeia de caracteres para um buffer definido pelo aplicativo chamando a função [**DdeQueryString**](/windows/desktop/api/Ddeml/nf-ddeml-ddequerystringa) , conforme mostrado no exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-245">An application can obtain the length of the string that corresponds to a string handle and copy the string to an application-defined buffer by calling the [**DdeQueryString**](/windows/desktop/api/Ddeml/nf-ddeml-ddequerystringa) function, as shown in the following example.</span></span>


```
DWORD idInst; 
DWORD cb; 
HSZ hszServ; 
PSTR pszServName; 
cb = DdeQueryString(idInst, hszServ, (LPSTR) NULL, 0, 
    CP_WINANSI) + 1; 
pszServName = (PSTR) LocalAlloc(LPTR, (UINT) cb); 
DdeQueryString(idInst, hszServ, pszServName, cb, CP_WINANSI); 
```



<span data-ttu-id="4c7c7-246">Um identificador de cadeia de caracteres específica de instância não pode ser mapeado do identificador de cadeia de caracteres para cadeia de caracteres e voltar para identificador de cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="4c7c7-246">An instance-specific string handle cannot be mapped from string handle to string and back to string handle.</span></span> <span data-ttu-id="4c7c7-247">Por exemplo, embora [**DdeQueryString**](/windows/desktop/api/Ddeml/nf-ddeml-ddequerystringa) crie uma cadeia de caracteres de um identificador de cadeia de caracteres e, em seguida, [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea) cria um identificador de cadeia de caracteres a partir dessa cadeia de caracteres, os dois identificadores não são os mesmos, conforme mostrado no exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-247">For instance, although [**DdeQueryString**](/windows/desktop/api/Ddeml/nf-ddeml-ddequerystringa) creates a string from a string handle and then [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea) creates a string handle from that string, the two handles are not the same, as shown in the following example.</span></span>


```
DWORD idInst; 
DWORD cb; 
HSZ hszInst, hszNew; 
PSZ pszInst; 
DdeQueryString(idInst, hszInst, pszInst, cb, CP_WINANSI); 
hszNew = DdeCreateStringHandle(idInst, pszInst, CP_WINANSI); 
// hszNew != hszInst ! 
```



<span data-ttu-id="4c7c7-248">Para comparar os valores de dois identificadores de cadeia de caracteres, use a função [**DdeCmpStringHandles**](/windows/desktop/api/Ddeml/nf-ddeml-ddecmpstringhandles) .</span><span class="sxs-lookup"><span data-stu-id="4c7c7-248">To compare the values of two string handles, use the [**DdeCmpStringHandles**](/windows/desktop/api/Ddeml/nf-ddeml-ddecmpstringhandles) function.</span></span>

<span data-ttu-id="4c7c7-249">Um identificador de cadeia de caracteres passado para a função de retorno de chamada DDE de um aplicativo se torna inválido quando a função de retorno de chamada retorna.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-249">A string handle passed to an application's DDE callback function becomes invalid when the callback function returns.</span></span> <span data-ttu-id="4c7c7-250">Um aplicativo pode salvar um identificador de cadeia de caracteres para uso após a função de retorno de chamada retornar usando a função [**DdeKeepStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddekeepstringhandle) .</span><span class="sxs-lookup"><span data-stu-id="4c7c7-250">An application can save a string handle for use after the callback function returns by using the [**DdeKeepStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddekeepstringhandle) function.</span></span>

<span data-ttu-id="4c7c7-251">Quando um aplicativo chama [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea), o sistema insere a cadeia de caracteres especificada em uma tabela de cadeia de caracteres e gera um identificador que ele usa para acessar a cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-251">When an application calls [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea), the system enters the specified string into a string table and generates a handle that it uses to access the string.</span></span> <span data-ttu-id="4c7c7-252">O sistema também mantém uma contagem de uso para cada cadeia de caracteres na tabela de cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-252">The system also maintains a usage count for each string in the string table.</span></span>

<span data-ttu-id="4c7c7-253">Quando um aplicativo chama [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea) e especifica uma cadeia de caracteres que já existe na tabela, o sistema incrementa a contagem de uso em vez de adicionar outra ocorrência da cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-253">When an application calls [**DdeCreateStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatestringhandlea) and specifies a string that already exists in the table, the system increments the usage count rather than adding another occurrence of the string.</span></span> <span data-ttu-id="4c7c7-254">(Um aplicativo também pode incrementar a contagem de uso usando [**DdeKeepStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddekeepstringhandle).) Quando um aplicativo chama a função [**DdeFreeStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddefreestringhandle) , o sistema decrementa a contagem de uso.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-254">(An application can also increment the usage count by using [**DdeKeepStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddekeepstringhandle).) When an application calls the [**DdeFreeStringHandle**](/windows/desktop/api/Ddeml/nf-ddeml-ddefreestringhandle) function, the system decrements the usage count.</span></span>

<span data-ttu-id="4c7c7-255">Uma cadeia de caracteres é removida da tabela quando sua contagem de uso é igual a zero.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-255">A string is removed from the table when its usage count equals zero.</span></span> <span data-ttu-id="4c7c7-256">Como mais de um aplicativo pode obter o identificador para uma cadeia de caracteres específica, um aplicativo não deve liberar um identificador de cadeia de caracteres mais vezes do que criou ou manteve o identificador.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-256">Because more than one application can obtain the handle to a particular string, an application must not free a string handle more times than it has created or retained the handle.</span></span> <span data-ttu-id="4c7c7-257">Caso contrário, o aplicativo pode fazer com que a cadeia de caracteres seja removida da tabela, negando a outros aplicativos acesso à cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-257">Otherwise, the application can cause the string to be removed from the table, denying other applications access to the string.</span></span>

<span data-ttu-id="4c7c7-258">As funções de gerenciamento de cadeia de caracteres de DDEML são baseadas no Gerenciador de Atom e estão sujeitas às mesmas restrições de tamanho que são Atoms.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-258">The DDEML string-management functions are based on the atom manager and are subject to the same size restrictions as are atoms.</span></span>

## <a name="ddeml-and-threads"></a><span data-ttu-id="4c7c7-259">DDEML e threads</span><span class="sxs-lookup"><span data-stu-id="4c7c7-259">DDEML and Threads</span></span>

<span data-ttu-id="4c7c7-260">A função [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) registra um aplicativo com o ddeml, criando uma instância de ddeml.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-260">The [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) function registers an application with the DDEML, creating a DDEML instance.</span></span> <span data-ttu-id="4c7c7-261">Uma instância de DDEML é baseada em thread, associada ao thread que chamou **DdeInitialize**.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-261">A DDEML instance is thread-based, associated with the thread that called **DdeInitialize**.</span></span>

<span data-ttu-id="4c7c7-262">Todas as chamadas de função DDEML para objetos que pertencem a uma instância de DDEML devem ser feitas no mesmo thread que chamou [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) para criar a instância.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-262">All DDEML function calls for objects belonging to a DDEML instance must be made from the same thread that called [**DdeInitialize**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) to create the instance.</span></span> <span data-ttu-id="4c7c7-263">Se você chamar uma função DDEML de um thread diferente, a função falhará.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-263">If you call a DDEML function from a different thread, the function will fail.</span></span> <span data-ttu-id="4c7c7-264">Você não pode acessar uma conversa de DDEML de um thread que não seja aquele que alocou a conversa.</span><span class="sxs-lookup"><span data-stu-id="4c7c7-264">You cannot access a DDEML conversation from a thread other than the one that allocated the conversation.</span></span>

 

