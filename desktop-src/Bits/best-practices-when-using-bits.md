---
title: Práticas recomendadas ao usar o BITS
description: Esta seção contém informações que você deve considerar ao criar um aplicativo que usa BITS.
ms.assetid: f4a09a80-2a85-4b59-b0fd-c23c128973f7
ms.topic: article
ms.date: 7/12/2019
ms.openlocfilehash: bbf69e75b99994eea3e8986d1be9920ff1a12bc5
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103916041"
---
# <a name="best-practices-when-using-bits"></a><span data-ttu-id="d0a82-103">Práticas recomendadas ao usar o BITS</span><span class="sxs-lookup"><span data-stu-id="d0a82-103">Best Practices When Using BITS</span></span>

<span data-ttu-id="d0a82-104">Esta seção contém informações que você deve considerar ao criar um aplicativo que usa BITS.</span><span class="sxs-lookup"><span data-stu-id="d0a82-104">This section contains information you should consider when designing an application that uses BITS.</span></span>

## <a name="user-context-or-service-context"></a><span data-ttu-id="d0a82-105">Contexto do usuário ou contexto de serviço</span><span class="sxs-lookup"><span data-stu-id="d0a82-105">User context or service context</span></span>

<span data-ttu-id="d0a82-106">O BITS transfere arquivos somente quando o proprietário do trabalho é conectado ao computador (o usuário deve ter feito logon interativamente).</span><span class="sxs-lookup"><span data-stu-id="d0a82-106">BITS transfers files only when the job's owner is logged on to the computer (the user must have logged on interactively).</span></span> <span data-ttu-id="d0a82-107">O BITS não oferece suporte ao comando **runas** .</span><span class="sxs-lookup"><span data-stu-id="d0a82-107">BITS does not support the **RunAs** command.</span></span> <span data-ttu-id="d0a82-108">Para obter mais detalhes, consulte [usuários e conexões de rede](users-and-network-connections.md).</span><span class="sxs-lookup"><span data-stu-id="d0a82-108">For more details, see [Users and Network Connections](users-and-network-connections.md).</span></span>

<span data-ttu-id="d0a82-109">Se você não precisar do contexto de um usuário para seu aplicativo, considere escrever um serviço em execução como LocalSystem, LocalService ou NetworkService em vez disso.</span><span class="sxs-lookup"><span data-stu-id="d0a82-109">If you do not require a user's context for your application, consider writing a service running as LocalSystem, LocalService, or NetworkService instead.</span></span> <span data-ttu-id="d0a82-110">Essas contas de sistema estão sempre conectadas, portanto, a transferência não está sujeita a um logoff de usuário.</span><span class="sxs-lookup"><span data-stu-id="d0a82-110">These system accounts are always logged on, so the transfer is not subject to a user logging off.</span></span> <span data-ttu-id="d0a82-111">No entanto, se você representar um usuário ao criar o trabalho, as regras de logon interativo se aplicarão.</span><span class="sxs-lookup"><span data-stu-id="d0a82-111">However, if you impersonate a user when you create the job, the interactive logon rules apply.</span></span> <span data-ttu-id="d0a82-112">Para obter mais detalhes, consulte [contas de serviço e bits](service-accounts-and-bits.md).</span><span class="sxs-lookup"><span data-stu-id="d0a82-112">For more details, see [Service Accounts and BITS](service-accounts-and-bits.md).</span></span>

## <a name="jobs-are-persistent"></a><span data-ttu-id="d0a82-113">Os trabalhos são persistentes</span><span class="sxs-lookup"><span data-stu-id="d0a82-113">Jobs are persistent</span></span>

<span data-ttu-id="d0a82-114">Os trabalhos permanecem na fila até que você chame o método [**método ibackgroundcopyjob:: Complete**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-complete) ou [**método ibackgroundcopyjob:: Cancel**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-cancel) .</span><span class="sxs-lookup"><span data-stu-id="d0a82-114">Jobs remain in the queue until you call the [**IBackgroundCopyJob::Complete**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-complete) or [**IBackgroundCopyJob::Cancel**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-cancel) method.</span></span> <span data-ttu-id="d0a82-115">Os arquivos no trabalho não estarão disponíveis para o usuário até que você chame **Complete**.</span><span class="sxs-lookup"><span data-stu-id="d0a82-115">The files in the job are not available to the user until you call **Complete**.</span></span> <span data-ttu-id="d0a82-116">Normalmente, você chama **Complete** quando o estado do trabalho é **BG \_ Job \_ estado \_ transferido**, e você chama **Cancel** quando o trabalho está no estado de erro **BG do \_ estado do trabalho \_ \_ \_** ou BG erro de **\_ \_ estado \_ de trabalho** de demarcador e não pode mais progredir.</span><span class="sxs-lookup"><span data-stu-id="d0a82-116">Typically, you call **Complete** when the state of the job is **BG\_JOB\_STATE\_TRANSFERRED**, and you call **Cancel** when the job is in the **BG\_JOB\_STATE\_TRANSIENT\_ERROR** or **BG\_JOB\_STATE\_ERROR** state and can no longer make progress.</span></span>

<span data-ttu-id="d0a82-117">Se você não chamar o método [**Complete**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-complete) ou o método [**Cancel**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-cancel) dentro de 90 dias ( [JobInactivityTimeout](group-policies.md) padrão política de grupo), o serviço cancelará o trabalho.</span><span class="sxs-lookup"><span data-stu-id="d0a82-117">If you do not call the [**Complete**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-complete) method or the [**Cancel**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-cancel) method within 90 days (default [JobInactivityTimeout](group-policies.md) Group Policy), the service cancels the job.</span></span> <span data-ttu-id="d0a82-118">Você sempre deve chamar o método **Complete** ou **Cancel** e não confiar na política JobInactivityTimeout para limpar seus trabalhos.</span><span class="sxs-lookup"><span data-stu-id="d0a82-118">You should always call the **Complete** or the **Cancel** method and not rely on the JobInactivityTimeout policy to cleanup your jobs.</span></span> <span data-ttu-id="d0a82-119">Os trabalhos restantes na fila podem impedir que os usuários criem outros trabalhos se o limite da política MaxJobsPerUser ou MaxJobsPerMachine for atingido.</span><span class="sxs-lookup"><span data-stu-id="d0a82-119">Jobs left in the queue may prevent users from creating other jobs if the MaxJobsPerUser or MaxJobsPerMachine policy limit is reached.</span></span>

## <a name="when-to-use-foreground-or-background-priority"></a><span data-ttu-id="d0a82-120">Quando usar a prioridade de primeiro plano ou plano de fundo</span><span class="sxs-lookup"><span data-stu-id="d0a82-120">When to use foreground or background priority</span></span>

<span data-ttu-id="d0a82-121">A menos que o trabalho seja de tempo crítico ou que o usuário esteja aguardando ativamente, você sempre deve usar uma prioridade de plano de fundo.</span><span class="sxs-lookup"><span data-stu-id="d0a82-121">Unless the job is time critical or the user is actively waiting, you should always use a background priority.</span></span> <span data-ttu-id="d0a82-122">No entanto, há ocasiões em que você talvez queira alternar da prioridade do plano de fundo para a prioridade de primeiro plano, por exemplo, quando o proxy ou o servidor não dá suporte ao cabeçalho do intervalo de conteúdo ou o software antivírus no cliente remove a solicitação de cabeçalho do intervalo.</span><span class="sxs-lookup"><span data-stu-id="d0a82-122">However, there are times when you may want to switch from background priority to foreground priority, for example, when the proxy or server does not support the Content-Range header, or antivirus software on the client removes the range header request.</span></span> <span data-ttu-id="d0a82-123">Alternar para a prioridade de primeiro plano funciona apenas para os arquivos cujo tamanho de arquivo é menor que 2 GB.</span><span class="sxs-lookup"><span data-stu-id="d0a82-123">Switching to foreground priority works only for those files whose file size is less than 2 GB.</span></span> <span data-ttu-id="d0a82-124">Para obter um exemplo, consulte a implementação para o método [**IBackgroundCopyCallback:: JobError**](/windows/desktop/api/Bits/nn-bits-ibackgroundcopycallback) .</span><span class="sxs-lookup"><span data-stu-id="d0a82-124">For an example, see the implementation for the [**IBackgroundCopyCallback::JobError**](/windows/desktop/api/Bits/nn-bits-ibackgroundcopycallback) method.</span></span> <span data-ttu-id="d0a82-125">Observe também que, se o trabalho em primeiro plano for interrompido devido a uma desconexão de rede ou quando o usuário fizer logoff, o trabalho falhará porque o BITS enviará uma solicitação de intervalo para tentar reiniciar a transferência de onde parou.</span><span class="sxs-lookup"><span data-stu-id="d0a82-125">Also note that if the foreground job is then interrupted due to a network disconnect or the user logging off, the job will fail because BITS will send a range request to try to restart the transfer from where it left off.</span></span>

<span data-ttu-id="d0a82-126">A partir do Windows 8, você deve configurar trabalhos de download com **\_ \_ \_ \_ conteúdo dinâmico de propriedade de trabalho bits** e BG de **\_ \_ prioridade \_ de trabalho** para destinar servidores que não atendem aos [requisitos de http para downloads de bits](http-requirements-for-bits-downloads.md).</span><span class="sxs-lookup"><span data-stu-id="d0a82-126">Starting with Windows 8, you should configure download jobs with **BITS\_JOB\_PROPERTY\_DYNAMIC\_CONTENT** and **BG\_JOB\_PRIORITY\_FOREGROUND** when targeting servers that do not meet the [HTTP Requirements for BITS Downloads](http-requirements-for-bits-downloads.md).</span></span> <span data-ttu-id="d0a82-127">Tenha em mente que isso resultará em BITS que precisem reiniciar o download desde o início, se ele for interrompido (por exemplo, devido a problemas de conectividade ou reinicialização do sistema).</span><span class="sxs-lookup"><span data-stu-id="d0a82-127">Bear in mind that this will result in BITS having to restart the download from the beginning if it ever gets interrupted (for example, due to connectivity issues or system reboot).</span></span>

<span data-ttu-id="d0a82-128">Para obter informações sobre as prioridades disponíveis e como o BITS usa o nível de prioridade para agendar trabalhos, consulte [**BG \_ \_ prioridade de trabalho**](/windows/desktop/api/Bits/ne-bits-bg_job_priority).</span><span class="sxs-lookup"><span data-stu-id="d0a82-128">For information on the available priorities and how BITS uses the priority level to schedule jobs, see [**BG\_JOB\_PRIORITY**](/windows/desktop/api/Bits/ne-bits-bg_job_priority).</span></span>

## <a name="transient-and-fatal-errors"></a><span data-ttu-id="d0a82-129">Erros transitórios e fatais</span><span class="sxs-lookup"><span data-stu-id="d0a82-129">Transient and fatal errors</span></span>

<span data-ttu-id="d0a82-130">Alguns erros são recuperáveis e outros não.</span><span class="sxs-lookup"><span data-stu-id="d0a82-130">Some errors are recoverable and some are not.</span></span> <span data-ttu-id="d0a82-131">Por exemplo, o erro "o servidor está indisponível" é um erro recuperável e o erro "acesso negado" é um erro fatal.</span><span class="sxs-lookup"><span data-stu-id="d0a82-131">For example, the error "Server is Unavailable" is a recoverable error, and the error "Access Denied" is a fatal error.</span></span> <span data-ttu-id="d0a82-132">O BITS coloca erros recuperáveis em um estado de erro transitório e tenta o trabalho novamente após um intervalo especificado.</span><span class="sxs-lookup"><span data-stu-id="d0a82-132">BITS puts recoverable errors in a transient error state and tries the job again after a specified interval.</span></span> <span data-ttu-id="d0a82-133">Se o trabalho não puder fazer o progresso, o BITS moverá o trabalho para um estado de erro fatal.</span><span class="sxs-lookup"><span data-stu-id="d0a82-133">If the job is unable to make progress, BITS moves the job to a fatal error state.</span></span> <span data-ttu-id="d0a82-134">Use os métodos [**método ibackgroundcopyjob:: SetMinimumRetryDelay**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay) e [**método ibackgroundcopyjob:: SetNoProgressTimeout**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout) para controlar como o bits processa erros transitórios.</span><span class="sxs-lookup"><span data-stu-id="d0a82-134">Use the [**IBackgroundCopyJob::SetMinimumRetryDelay**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay) and [**IBackgroundCopyJob::SetNoProgressTimeout**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout) methods to control how BITS processes transient errors.</span></span>

<span data-ttu-id="d0a82-135">Para trabalhos em primeiro plano, você deve limitar a quantidade de tempo que permite que um trabalho permaneça no estado de erro transitório e tentar recuperá-lo.</span><span class="sxs-lookup"><span data-stu-id="d0a82-135">For foreground jobs, you should limit the amount of time you let a job stay in the transient error state and try to recover.</span></span> <span data-ttu-id="d0a82-136">Use o método [**SetNoProgressTimeout**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout) para limitar a quantidade de tempo que um trabalho permanece no estado de erro transitório ou para forçar o trabalho para o estado de erro fatal.</span><span class="sxs-lookup"><span data-stu-id="d0a82-136">Use the [**SetNoProgressTimeout**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout) method to limit the amount of time a job stays in the transient error state or to force the job into the fatal error state.</span></span> <span data-ttu-id="d0a82-137">Se você deixar o trabalho tentar recuperar, deverá usar o método [**SetMinimumRetryDelay**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay) para definir o atraso mínimo de repetição como 60 segundos ou chamar o método [**método ibackgroundcopyjob:: resume**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-resume) para ativar o trabalho novamente.</span><span class="sxs-lookup"><span data-stu-id="d0a82-137">If you let the job try to recover, you should use the [**SetMinimumRetryDelay**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay) method to set the minimum retry delay to 60 seconds or call the [**IBackgroundCopyJob::Resume**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-resume) method to activate the job again.</span></span>

<span data-ttu-id="d0a82-138">Para obter mais informações, [**consulte \_ BG \_ estado do trabalho**](/windows/desktop/api/Bits/ne-bits-bg_job_state), [ciclo de vida de um trabalho do bits](life-cycle-of-a-bits-job.md)e [tratamento de erros](handling-errors.md).</span><span class="sxs-lookup"><span data-stu-id="d0a82-138">For more information, see [**BG\_JOB\_STATE**](/windows/desktop/api/Bits/ne-bits-bg_job_state), [Life Cycle of a BITS Job](life-cycle-of-a-bits-job.md), and [Handling Errors](handling-errors.md).</span></span>

## <a name="measuring-network-bandwidth-usage"></a><span data-ttu-id="d0a82-139">Medição do uso da largura de banda da rede</span><span class="sxs-lookup"><span data-stu-id="d0a82-139">Measuring network bandwidth usage</span></span>

<span data-ttu-id="d0a82-140">O BITS pode usar o adaptador de rede do cliente para estimar a largura de banda de rede disponível.</span><span class="sxs-lookup"><span data-stu-id="d0a82-140">BITS might use the client's network adapter to estimate available network bandwidth.</span></span> <span data-ttu-id="d0a82-141">Como o BITS não é capaz de medir a largura de banda além do cliente, os BITS podem congestionar o link WAN.</span><span class="sxs-lookup"><span data-stu-id="d0a82-141">Because BITS is not able to measure bandwidth beyond the client, BITS may congest the WAN link.</span></span> <span data-ttu-id="d0a82-142">Para reduzir o congestionamento no link WAN, você pode usar a política de grupo **MaxInternetBandwidth** para limitar a quantidade de largura de banda que o cliente usa.</span><span class="sxs-lookup"><span data-stu-id="d0a82-142">To reduce congestion on the WAN link, you can use the **MaxInternetBandwidth** group policy to limit the amount of bandwidth that the client uses.</span></span> <span data-ttu-id="d0a82-143">Para obter mais informações, consulte [largura de banda de rede](network-bandwidth.md) e diretivas de [grupo](group-policies.md).</span><span class="sxs-lookup"><span data-stu-id="d0a82-143">For more information, see [Network Bandwidth](network-bandwidth.md) and [Group Policies](group-policies.md).</span></span>

<span data-ttu-id="d0a82-144">Se você estiver escrevendo um aplicativo que muitos clientes usarão para baixar arquivos de um determinado servidor, considere um esquema que Escalona as solicitações de download para que você não sobrecarregue o servidor com solicitações.</span><span class="sxs-lookup"><span data-stu-id="d0a82-144">If you are writing an application that many clients will use to download files from a given server, you should consider a scheme that staggers the download requests so you do not overload the server with requests.</span></span>

## <a name="setting-credentials-for-proxy-and-server-authentication"></a><span data-ttu-id="d0a82-145">Configurando credenciais para autenticação de proxy e servidor</span><span class="sxs-lookup"><span data-stu-id="d0a82-145">Setting credentials for proxy and server authentication</span></span>

<span data-ttu-id="d0a82-146">Se você espera que o proxy ou o servidor exija credenciais de usuário, você deve fornecer as credenciais para BITS.</span><span class="sxs-lookup"><span data-stu-id="d0a82-146">If you expect the proxy or server to require user credentials, you must provide the credentials to BITS.</span></span> <span data-ttu-id="d0a82-147">Para especificar as credenciais, chame o método [**IBackgroundCopyJob2:: SetCredentials**](/windows/desktop/api/Bits1_5/nf-bits1_5-ibackgroundcopyjob2-setcredentials) .</span><span class="sxs-lookup"><span data-stu-id="d0a82-147">To specify the credentials, call the [**IBackgroundCopyJob2::SetCredentials**](/windows/desktop/api/Bits1_5/nf-bits1_5-ibackgroundcopyjob2-setcredentials) method.</span></span> <span data-ttu-id="d0a82-148">O BITS dá suporte a esquemas de autenticação básica, Digest, Negotiate, NTLM e Passport.</span><span class="sxs-lookup"><span data-stu-id="d0a82-148">BITS supports Basic, Digest, Negotiate, NTLM, and Passport authentication schemes.</span></span>

<span data-ttu-id="d0a82-149">Para obter detalhes sobre a autenticação, consulte [autenticação](authentication.md).</span><span class="sxs-lookup"><span data-stu-id="d0a82-149">For details on authentication, see [Authentication](authentication.md).</span></span>

## <a name="specifying-proxy-settings-for-user-accounts-and-service-accounts"></a><span data-ttu-id="d0a82-150">Especificando configurações de proxy para contas de usuário e contas de serviço</span><span class="sxs-lookup"><span data-stu-id="d0a82-150">Specifying proxy settings for user accounts and service accounts</span></span>

<span data-ttu-id="d0a82-151">Por padrão, o BITS usa as configurações de proxy do Internet Explorer do usuário.</span><span class="sxs-lookup"><span data-stu-id="d0a82-151">By default, BITS uses the user's Internet Explorer proxy settings.</span></span> <span data-ttu-id="d0a82-152">Para substituir as configurações de proxy do Internet Explorer do usuário, chame o método [**método ibackgroundcopyjob:: SetProxySettings**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) .</span><span class="sxs-lookup"><span data-stu-id="d0a82-152">To override the user's Internet Explorer proxy settings, call the [**IBackgroundCopyJob::SetProxySettings**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) method.</span></span>

<span data-ttu-id="d0a82-153">As configurações de proxy do Internet Explorer não se aplicam a contas do sistema, portanto o comportamento de proxy padrão (configuração de **\_ uso de proxy de trabalho \_ \_ \_ BG**) só funcionará corretamente em implantações de WPAD (protocolo de descoberta automática de proxy da Web), a menos que sejam executadas etapas de configuração adicionais.</span><span class="sxs-lookup"><span data-stu-id="d0a82-153">The Internet Explorer proxy settings do not apply to system accounts, so the default proxy behavior (**BG\_JOB\_PROXY\_USAGE\_PRECONFIG**) will only work correctly in Web Proxy Auto-Discovery Protocol (WPAD) deployments, unless additional configuration steps are taken.</span></span> <span data-ttu-id="d0a82-154">Se o seu aplicativo for um serviço em execução como LocalSystem, LocalService ou NetworkService, considere configurar um token auxiliar em seus trabalhos do BITS ou definir explicitamente as configurações de proxy corretas chamando [**método ibackgroundcopyjob:: SetProxySettings**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) com a **substituição de uso de \_ proxy de trabalho \_ \_ \_ BG**.</span><span class="sxs-lookup"><span data-stu-id="d0a82-154">If your application is a service running as LocalSystem, LocalService, or NetworkService, consider configuring a helper token on your BITS jobs, or explicitly setting the correct proxy settings by calling [**IBackgroundCopyJob::SetProxySettings**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) with **BG\_JOB\_PROXY\_USAGE\_OVERRIDE**.</span></span> <span data-ttu-id="d0a82-155">Como alternativa, você pode usar os comutadores **/util/SetIEProxy** da BitsAdmin.exe para definir as configurações de proxy do Internet Explorer para a conta do sistema LocalSystem, LocalService ou NetworkService.</span><span class="sxs-lookup"><span data-stu-id="d0a82-155">As an alternative, you can use the **/Util /SetIEProxy** switches of BitsAdmin.exe to set Internet Explorer proxy settings for the LocalSystem, LocalService, or NetworkService system account.</span></span> <span data-ttu-id="d0a82-156">Para obter detalhes, consulte [ferramenta BitsAdmin](bitsadmin-tool.md).</span><span class="sxs-lookup"><span data-stu-id="d0a82-156">For details, see [BitsAdmin Tool](bitsadmin-tool.md).</span></span>

<span data-ttu-id="d0a82-157">O BITS não reconhece as configurações de proxy que são definidas usando o arquivo Proxycfg.exe.</span><span class="sxs-lookup"><span data-stu-id="d0a82-157">BITS does not recognize the proxy settings that are set using the Proxycfg.exe file.</span></span>

<span data-ttu-id="d0a82-158">A partir da atualização do Windows 10 de outubro de 2018 (10,0; Build 17763), o BITS usa a mesma ordem de proxy que o WinHttp usa com AUTOMATIC_PROXY.</span><span class="sxs-lookup"><span data-stu-id="d0a82-158">Starting with the Windows 10 October 2018 Update (10.0; Build 17763), BITS uses the same proxy order that WinHttp uses with AUTOMATIC_PROXY.</span></span> <span data-ttu-id="d0a82-159">O BITS usa essa ordenação mais compatível quando BG_JOB_PROXY_USAGE_PRECONFIG é especificado.</span><span class="sxs-lookup"><span data-stu-id="d0a82-159">BITS uses this more compatible ordering when BG_JOB_PROXY_USAGE_PRECONFIG is specified.</span></span> <span data-ttu-id="d0a82-160">BG_JOB_PROXY_USAGE_PRECONFIG é o valor padrão para especificar o proxy HTTP.</span><span class="sxs-lookup"><span data-stu-id="d0a82-160">BG_JOB_PROXY_USAGE_PRECONFIG is the default value for specifying the HTTP proxy.</span></span>

## <a name="specifying-user-specific-settings-for-authenticating-proxies"></a><span data-ttu-id="d0a82-161">Especificando configurações específicas do usuário para autenticar proxies</span><span class="sxs-lookup"><span data-stu-id="d0a82-161">Specifying user-specific settings for authenticating proxies</span></span>

<span data-ttu-id="d0a82-162">Se você estiver usando BITS em um ambiente que exija autenticação de proxy durante a execução como uma conta sem credenciais NTLM ou Kerberos utilizáveis no domínio de rede da máquina, será necessário executar etapas adicionais para autenticar corretamente usando as credenciais de outra conta de usuário que tenha credenciais no domínio.</span><span class="sxs-lookup"><span data-stu-id="d0a82-162">If you are using BITS in an environment that requires proxy authentication while running as an account without usable NTLM or Kerberos credentials in the machine's network domain, you must take extra steps to authenticate properly by using the credentials of another user account that does have credentials on the domain.</span></span> <span data-ttu-id="d0a82-163">Esse é um cenário típico quando o código BITS está sendo executado como um serviço de sistema, como LocalService, NetworkService ou LocalSystem, pois essas contas não têm credenciais NTLM ou Kerberos utilizáveis.</span><span class="sxs-lookup"><span data-stu-id="d0a82-163">This is a typical scenario when your BITS code is running as a system service such as LocalService, NetworkService, or LocalSystem, as those accounts do not have usable NTLM or Kerberos credentials.</span></span>

<span data-ttu-id="d0a82-164">Para obter detalhes sobre como funciona a autenticação nesse cenário, consulte [autenticação.](authentication.md)</span><span class="sxs-lookup"><span data-stu-id="d0a82-164">For details on how authentication works in this scenario, see [Authentication.](authentication.md)</span></span>

## <a name="scalability"></a><span data-ttu-id="d0a82-165">Escalabilidade</span><span class="sxs-lookup"><span data-stu-id="d0a82-165">Scalability</span></span>

<span data-ttu-id="d0a82-166">Se mais de 100 trabalhos estiverem na fila, o desempenho pode começar a diminuir dependendo da composição do trabalho.</span><span class="sxs-lookup"><span data-stu-id="d0a82-166">If more than 100 jobs are in the queue, performance may start to decrease depending on the composition of the job.</span></span> <span data-ttu-id="d0a82-167">O BITS usa a configuração de política [MaxJobsPerMachine](group-policies.md) para impor um limite rígido no número de trabalhos na fila.</span><span class="sxs-lookup"><span data-stu-id="d0a82-167">BITS uses the [MaxJobsPerMachine](group-policies.md) policy setting to impose a hard limit on the number of jobs in the queue.</span></span> <span data-ttu-id="d0a82-168">Os aplicativos devem limitar o número de seus trabalhos a cerca de 10, de modo que vários aplicativos terão menos chance de exceder a diretriz de 100 trabalhos.</span><span class="sxs-lookup"><span data-stu-id="d0a82-168">Applications should limit the number of their jobs to about 10, so that multiple applications will have less of a chance of exceeding the 100-job guideline.</span></span> <span data-ttu-id="d0a82-169">Normalmente, um aplicativo com um grande número de trabalhos a serem enviados primeiro enviaria 10 trabalhos e, em seguida, enviaria um de cada vez enquanto cada trabalho for concluído.</span><span class="sxs-lookup"><span data-stu-id="d0a82-169">Typically, an application with a large number of jobs to submit would first submit 10 jobs and then submit one at a time as each job finishes.</span></span>

<span data-ttu-id="d0a82-170">O número de arquivos no trabalho também deve ser limitado a um máximo de 10 arquivos.</span><span class="sxs-lookup"><span data-stu-id="d0a82-170">The number of files in the job should also be limited to a maximum of 10 files.</span></span> <span data-ttu-id="d0a82-171">Se você quiser transferir um grande número de arquivos para um trabalho, considere a criação de um arquivo CAB que contenha todos os arquivos.</span><span class="sxs-lookup"><span data-stu-id="d0a82-171">If you want to transfer a large number of files for a job, consider creating a CAB file that contains all the files instead.</span></span>

## <a name="http-headers-can-be-in-any-case"></a><span data-ttu-id="d0a82-172">Os cabeçalhos HTTP podem estar em qualquer caso</span><span class="sxs-lookup"><span data-stu-id="d0a82-172">HTTP Headers can be in any case</span></span>

<span data-ttu-id="d0a82-173">Os padrões HTTP sempre disseram que os cabeçalhos HTTP devem ser tratados como não diferencia maiúsculas de minúsculas (RFC 7230 seção 3,2).</span><span class="sxs-lookup"><span data-stu-id="d0a82-173">The HTTP standards have always said that HTTP headers must be treated as case-insensitive (RFC 7230 section 3.2).</span></span> <span data-ttu-id="d0a82-174">O padrão HTTP mais recente, RFC 7540, vai além e informa que o tráfego HTTP/2 deve comparar os cabeçalhos como não diferenciar maiúsculas de minúsculas e deve apresentar cabeçalhos em letras minúsculas (RFC 6540, seção 8.1.2).</span><span class="sxs-lookup"><span data-stu-id="d0a82-174">The most recent HTTP standard, RFC 7540, goes further and says that HTTP/2 traffic must compare the headers as case-insensitive and must present headers in lower case (RFC 6540, section 8.1.2).</span></span> <span data-ttu-id="d0a82-175">Mesmo quando o tráfego é enviado com cabeçalhos não minúsculos, os proxies podem optar por forçar os cabeçalhos para letras minúsculas.</span><span class="sxs-lookup"><span data-stu-id="d0a82-175">Even when traffic is sent with non lower-case headers, proxies may well choose to force the headers to lower-case.</span></span>

## <a name="avoiding-personally-identifiable-information-pii"></a><span data-ttu-id="d0a82-176">Evitando informações de identificação pessoal (PII)</span><span class="sxs-lookup"><span data-stu-id="d0a82-176">Avoiding personally identifiable information (PII)</span></span>

<span data-ttu-id="d0a82-177">Os trabalhos do BITS, incluindo o nome de exibição do trabalho e os nomes de arquivo e descrição, são visíveis para todos os usuários com privilégios de administrador.</span><span class="sxs-lookup"><span data-stu-id="d0a82-177">BITS jobs including the job display name and description and file names are visible to all users with admin privileges.</span></span> <span data-ttu-id="d0a82-178">Eles também podem ser adicionados à telemetria do Windows.</span><span class="sxs-lookup"><span data-stu-id="d0a82-178">They may also be added to Windows Telemetry.</span></span> <span data-ttu-id="d0a82-179">Você deve evitar colocar dados confidenciais (como o próprio nome do usuário) nos detalhes do trabalho.</span><span class="sxs-lookup"><span data-stu-id="d0a82-179">You should avoid putting sensitive data (like the user's own name) in the job details.</span></span>
