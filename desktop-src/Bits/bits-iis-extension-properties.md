---
title: Propriedades de extensão do IIS do BITS
description: Serviço de Transferência Inteligente em Segundo Plano (BITS) usa uma ISAPI para estender o IIS para dar suporte a trabalhos de carregamento.
ms.assetid: 08a40cc1-ec6d-4b65-971a-15c7b06df148
keywords:
- BITS de propriedades de extensão do IIS do BITS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c09412f6aa0be1ab76e6e45ea0920e1caf1054d7
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104499105"
---
# <a name="bits-iis-extension-properties"></a><span data-ttu-id="69170-104">Propriedades de extensão do IIS do BITS</span><span class="sxs-lookup"><span data-stu-id="69170-104">BITS IIS Extension Properties</span></span>

<span data-ttu-id="69170-105">Serviço de Transferência Inteligente em Segundo Plano (BITS) usa uma ISAPI para estender o IIS para dar suporte a [**trabalhos de carregamento**](/windows/win32/api/bits/ne-bits-bg_job_type).</span><span class="sxs-lookup"><span data-stu-id="69170-105">Background Intelligent Transfer Service (BITS) uses an ISAPI to extend IIS to support [**upload jobs**](/windows/win32/api/bits/ne-bits-bg_job_type).</span></span> <span data-ttu-id="69170-106">A tabela a seguir lista as propriedades que o BITS adiciona à metabase do IIS para o componente do diretório virtual.</span><span class="sxs-lookup"><span data-stu-id="69170-106">The following table lists the properties that BITS adds to the IIS metabase for the virtual directory component.</span></span> <span data-ttu-id="69170-107">O BITS usa essas propriedades para determinar como carregar os arquivos.</span><span class="sxs-lookup"><span data-stu-id="69170-107">BITS uses these properties to determine how to upload the files.</span></span> <span data-ttu-id="69170-108">As propriedades de extensão do IIS do BITS são herdáveis, exceto para **BITSUploadEnabled**.</span><span class="sxs-lookup"><span data-stu-id="69170-108">The BITS IIS extension properties are inheritable, except for **BITSUploadEnabled**.</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="69170-109">Propriedade</span><span class="sxs-lookup"><span data-stu-id="69170-109">Property</span></span></th>
<th><span data-ttu-id="69170-110">Descrição</span><span class="sxs-lookup"><span data-stu-id="69170-110">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="69170-111"><strong>BITSUploadEnabled</strong> Tipo de dados: <strong>booliano</strong></span><span class="sxs-lookup"><span data-stu-id="69170-111"><strong>BITSUploadEnabled</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="69170-112">Indica se os carregamentos do BITS estão habilitados no diretório virtual.</span><span class="sxs-lookup"><span data-stu-id="69170-112">Indicates whether BITS uploads are enabled on the virtual directory.</span></span> <span data-ttu-id="69170-113">Se a configuração não estiver presente ou for 0, os carregamentos do BITS serão desabilitados.</span><span class="sxs-lookup"><span data-stu-id="69170-113">If the setting is not present or is 0, BITS uploads are disabled.</span></span><br/> <span data-ttu-id="69170-114">Trata-se de uma propriedade somente leitura.</span><span class="sxs-lookup"><span data-stu-id="69170-114">This is a read-only property.</span></span> <span data-ttu-id="69170-115">Para definir essa propriedade, chame o método <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-enablebitsuploads"><strong>EnableBITSUploads</strong></a> ou <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-disablebitsuploads"><strong>DisableBITSUploads</strong></a> da interface <a href="/windows/win32/api/bitscfg/nn-bitscfg-ibitsextensionsetup"><strong>IBITSExtensionSetup</strong></a> .</span><span class="sxs-lookup"><span data-stu-id="69170-115">To set this property, call the <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-enablebitsuploads"><strong>EnableBITSUploads</strong></a> or <a href="/windows/win32/api/bitscfg/nf-bitscfg-ibitsextensionsetup-disablebitsuploads"><strong>DisableBITSUploads</strong></a> method of the <a href="/windows/win32/api/bitscfg/nn-bitscfg-ibitsextensionsetup"><strong>IBITSExtensionSetup</strong></a> interface.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="69170-116"><strong>BITSSessionTimeout</strong> Tipo de dados: <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="69170-116"><strong>BITSSessionTimeout</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="69170-117">Número de segundos em que a conexão será mantida se nenhum progresso for fazer upload do arquivo; o temporizador é redefinido quando o andamento é realizado.</span><span class="sxs-lookup"><span data-stu-id="69170-117">Number of seconds the connection is maintained if no progress is made uploading the file; the timer is reset when progress is made.</span></span> <span data-ttu-id="69170-118">O BITS fechará a conexão se o tempo limite for atingido e limpará os dados associados à sessão.</span><span class="sxs-lookup"><span data-stu-id="69170-118">BITS closes the connection if the time-out is reached and cleans up data associated with the session.</span></span><br/> <span data-ttu-id="69170-119">Definir um tempo limite de sessão curto pode ser um problema para trabalhos de resposta de upload porque a resposta só é baixada quando o usuário está conectado e conectado à rede.</span><span class="sxs-lookup"><span data-stu-id="69170-119">Setting a short session time-out can be an issue for upload-reply jobs because the reply is only downloaded when the user is logged on and connected to the network.</span></span> <span data-ttu-id="69170-120">É possível que a sessão expire até que a resposta seja baixada; nesse caso, a sessão é cancelada e o arquivo de resposta é excluído.</span><span class="sxs-lookup"><span data-stu-id="69170-120">It is possible for the session to time out before the reply is downloaded, in which case the session is canceled and the reply file is deleted.</span></span><br/> <span data-ttu-id="69170-121">Observe que o BITS cancelará o trabalho se o valor de Política de Grupo <a href="/windows/win32/bits/group-policies">JobInactivityTimeout</a> (o padrão é 90 dias) for atingido, independentemente dessa configuração.</span><span class="sxs-lookup"><span data-stu-id="69170-121">Note that BITS cancels the job if the <a href="/windows/win32/bits/group-policies">JobInactivityTimeout</a> Group Policy value (default is 90 days) is reached, regardless of this setting.</span></span><br/> <span data-ttu-id="69170-122">O valor padrão é 1.209.600 (14 dias).</span><span class="sxs-lookup"><span data-stu-id="69170-122">Default value is 1,209,600 (14 days).</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="69170-123"><strong>BITSMaximumUploadSize</strong> Tipo de dados: <strong>cadeia de caracteres</strong></span><span class="sxs-lookup"><span data-stu-id="69170-123"><strong>BITSMaximumUploadSize</strong>Data type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="69170-124">Número máximo de bytes que podem ser carregados por trabalho.</span><span class="sxs-lookup"><span data-stu-id="69170-124">Maximum number of bytes that can be uploaded per job.</span></span> <span data-ttu-id="69170-125">Especifique o número máximo de bytes como uma cadeia de caracteres decimal; o valor da cadeia de caracteres deve ser menor ou igual a &quot; 1844674407370955 &quot; .</span><span class="sxs-lookup"><span data-stu-id="69170-125">Specify the maximum number of bytes as a decimal string; the string value must be less than or equal to &quot;1844674407370955&quot;.</span></span> <span data-ttu-id="69170-126">Uma cadeia de caracteres vazia é a mesma que especificar &quot; 1844674407370955 &quot; .</span><span class="sxs-lookup"><span data-stu-id="69170-126">An empty string is the same as specifying &quot;1844674407370955&quot;.</span></span><br/> <span data-ttu-id="69170-127">O valor padrão é uma cadeia de caracteres vazia.</span><span class="sxs-lookup"><span data-stu-id="69170-127">Default value is an empty string.</span></span><br/>
<blockquote>
[!Note]<br />
<span data-ttu-id="69170-128">No IIS 7, o limite de upload padrão é 30 milhões bytes.</span><span class="sxs-lookup"><span data-stu-id="69170-128">In IIS 7, the default upload limit is 30 million bytes.</span></span> <span data-ttu-id="69170-129">O valor da propriedade <strong>BITSMaximumUploadSize</strong> não pode exceder o limite do IIS.</span><span class="sxs-lookup"><span data-stu-id="69170-129">The value of the <strong>BITSMaximumUploadSize</strong> property cannot exceed the IIS limit.</span></span> <span data-ttu-id="69170-130">Para obter detalhes e informações sobre como alterar o padrão do IIS, consulte <a href="https://support.microsoft.com//kb/942074">KB942074</a>.</span><span class="sxs-lookup"><span data-stu-id="69170-130">For details and information on changing the IIS default, see <a href="https://support.microsoft.com//kb/942074">KB942074</a>.</span></span>
</blockquote>
<br/> <br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="69170-131"><strong>BITSServerNotificationType</strong> Tipo de dados: <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="69170-131"><strong>BITSServerNotificationType</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="69170-132">Especifica como enviar o arquivo de upload para o aplicativo de servidor.</span><span class="sxs-lookup"><span data-stu-id="69170-132">Specifies how to send the upload file to the server application.</span></span> <span data-ttu-id="69170-133">Os valores possíveis são: 0, 1 e 2.</span><span class="sxs-lookup"><span data-stu-id="69170-133">The possible values are: 0, 1, and 2.</span></span><br/> <span data-ttu-id="69170-134">Um valor de 0 significa que o arquivo não é enviado para o aplicativo de servidor.</span><span class="sxs-lookup"><span data-stu-id="69170-134">A value of 0 means the file is not sent to the server application.</span></span> <span data-ttu-id="69170-135">O BITS coloca o arquivo de carregamento no diretório especificado no nome remoto (o nome remoto especificado quando você <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-addfile">adicionou o arquivo</a> ao trabalho) sem notificar o aplicativo de servidor.</span><span class="sxs-lookup"><span data-stu-id="69170-135">BITS puts the upload file in the directory specified in the remote name (the remote name specified when you <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-addfile">added the file</a> to the job) without notifying the server application.</span></span> <span data-ttu-id="69170-136">Se o arquivo existir atualmente no diretório de destino, ele será substituído pelo arquivo de carregamento.</span><span class="sxs-lookup"><span data-stu-id="69170-136">If the file currently exists in the destination directory, it is replaced with the upload file.</span></span><br/> <span data-ttu-id="69170-137">Um valor de 1 significa que o BITS passa o local do arquivo de carregamento para o aplicativo de servidor especificado na propriedade <strong>BITSServerNotificationURL</strong> .</span><span class="sxs-lookup"><span data-stu-id="69170-137">A value of 1 means BITS passes the location of the upload file to the server application specified in the <strong>BITSServerNotificationURL</strong> property.</span></span> <span data-ttu-id="69170-138">O aplicativo de servidor processa o arquivo e gera um arquivo de resposta, se necessário.</span><span class="sxs-lookup"><span data-stu-id="69170-138">The server application processes the file and generates a reply file, if needed.</span></span> <span data-ttu-id="69170-139">Por padrão, o BITS remove os arquivos de upload e de resposta do servidor depois de receber a resposta do aplicativo de servidor.</span><span class="sxs-lookup"><span data-stu-id="69170-139">By default, BITS removes the upload and reply files from the server after it receives the response from the server application.</span></span> <span data-ttu-id="69170-140">Para que o BITS Copie o arquivo de upload para o local especificado pelo nome do arquivo remoto no trabalho, inclua o cabeçalho <a href="/windows/win32/bits/notification-protocol-for-server-applications">bits-Copy-file-to-Destination</a> em sua resposta.</span><span class="sxs-lookup"><span data-stu-id="69170-140">To have BITS copy the upload file to the location specified by the remote file name in the job, include the <a href="/windows/win32/bits/notification-protocol-for-server-applications">BITS-Copy-File-To-Destination</a> header in your response.</span></span> <span data-ttu-id="69170-141">Se você não incluir o cabeçalho e quiser salvar os arquivos de upload e de resposta, deverá copiar os arquivos de upload e de resposta em um novo local antes de responder.</span><span class="sxs-lookup"><span data-stu-id="69170-141">If you do not include the header and you want to save the upload and reply files, you must copy the upload and reply files to a new location before responding.</span></span><br/> <span data-ttu-id="69170-142">Um valor de 2 significa que o BITS passa o arquivo de carregamento no corpo da solicitação para o aplicativo de servidor especificado na propriedade <strong>BITSServerNotificationURL</strong> .</span><span class="sxs-lookup"><span data-stu-id="69170-142">A value of 2 means BITS passes the upload file in the body of the request to the server application specified in the <strong>BITSServerNotificationURL</strong> property.</span></span> <span data-ttu-id="69170-143">O aplicativo de servidor processa o arquivo e retorna a resposta no corpo da resposta, se necessário.</span><span class="sxs-lookup"><span data-stu-id="69170-143">The server application processes the file and passes back the reply in the body of the response, if needed.</span></span><br/> <span data-ttu-id="69170-144">Para obter detalhes sobre os cabeçalhos de solicitação e resposta, consulte <a href="/windows/win32/bits/notification-protocol-for-server-applications">protocolo de notificação para aplicativos de servidor</a>.</span><span class="sxs-lookup"><span data-stu-id="69170-144">For details on the request and response headers, see <a href="/windows/win32/bits/notification-protocol-for-server-applications">Notification Protocol for Server Applications</a>.</span></span><br/> <span data-ttu-id="69170-145">O aplicativo de servidor deve fornecer uma resposta em cinco minutos.</span><span class="sxs-lookup"><span data-stu-id="69170-145">The server application must provide a response within five minutes.</span></span> <span data-ttu-id="69170-146">Se o aplicativo do servidor não responder em cinco minutos, o trabalho entrará no estado de erro transitório.</span><span class="sxs-lookup"><span data-stu-id="69170-146">If the server application does not reply within five minutes, the job enters the transient error state.</span></span> <span data-ttu-id="69170-147">Quando o <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay"><strong>intervalo de repetição</strong></a> expirar, o servidor bits enviará outra notificação para o aplicativo de servidor (o aplicativo de servidor deve ser gravado para lidar com notificações duplicadas). <strong>BITS 1,5:</strong> O tempo limite de notificação é de 30 segundos.</span><span class="sxs-lookup"><span data-stu-id="69170-147">When the <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setminimumretrydelay"><strong>retry delay</strong></a> expires, the BITS server will send another notification to the server application (the server application should be written to handle duplicate notifications).<strong>BITS 1.5:</strong> The notification time-out is 30 seconds.</span></span><br/> <br/> <span data-ttu-id="69170-148">O valor padrão é 0.</span><span class="sxs-lookup"><span data-stu-id="69170-148">Default value is 0.</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="69170-149"><strong>BITSServerNotificationURL</strong> Tipo de dados: <strong>cadeia de caracteres</strong></span><span class="sxs-lookup"><span data-stu-id="69170-149"><strong>BITSServerNotificationURL</strong>Data type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="69170-150">Opcional.</span><span class="sxs-lookup"><span data-stu-id="69170-150">Optional.</span></span> <span data-ttu-id="69170-151">Contém a URL do aplicativo de servidor para o qual o BITS publica o arquivo de carregamento.</span><span class="sxs-lookup"><span data-stu-id="69170-151">Contains the URL of the server application to which BITS posts the upload file.</span></span> <span data-ttu-id="69170-152">Você deve especificar uma URL se o valor da propriedade <strong>BITSServerNotificationType</strong> for 1 ou 2.</span><span class="sxs-lookup"><span data-stu-id="69170-152">You must specify a URL if the value of the <strong>BITSServerNotificationType</strong> property is 1 or 2.</span></span> <span data-ttu-id="69170-153">A URL é limitada a 2.200 caracteres, não incluindo o terminador nulo.</span><span class="sxs-lookup"><span data-stu-id="69170-153">The URL is limited to 2,200 characters, not including the null terminator.</span></span> <span data-ttu-id="69170-154">A URL deve ser uma URL HTTP; O BITS não oferece suporte a URLs de notificação HTTPS.</span><span class="sxs-lookup"><span data-stu-id="69170-154">The URL must be an HTTP URL; BITS does not support HTTPS notification URLs.</span></span><br/> <span data-ttu-id="69170-155">Se a URL não estiver disponível no momento do carregamento, o BITS tentará o upload novamente até que a URL de notificação exista ou até que o período de repetição expire.</span><span class="sxs-lookup"><span data-stu-id="69170-155">If the URL is not available at the time of upload, BITS will retry the upload until the notification URL exists or until the retry period expires.</span></span><br/> <span data-ttu-id="69170-156">Observe que, se o nome remoto especificado no trabalho contiver uma cadeia de caracteres de consulta, a cadeia de caracteres de consulta será anexada à URL que você especificar.</span><span class="sxs-lookup"><span data-stu-id="69170-156">Note that if the remote name specified in the job contains a query string, the query string is appended to the URL that you specify.</span></span> <span data-ttu-id="69170-157">Por exemplo, se o nome remoto contiver https://myserver/myvdir/subdir/file.asp?ACCOUNT=86433 e você especificar a configuração <strong>BITSServerNotificationURL</strong> como https://otherserver/myvdir2/bag.asp , a URL para a qual o bits é Postado https://otherserver/myvdir2/bag.asp?ACCOUNT=86433 .</span><span class="sxs-lookup"><span data-stu-id="69170-157">For example, if the remote name contains https://myserver/myvdir/subdir/file.asp?ACCOUNT=86433 and you specify the <strong>BITSServerNotificationURL</strong> setting as https://otherserver/myvdir2/bag.asp, the URL to which BITS posts is https://otherserver/myvdir2/bag.asp?ACCOUNT=86433.</span></span><br/> <span data-ttu-id="69170-158">Se a URL original for https://myserver/myvdir/file.txt e a URL de notificação for myasp. asp, o bits usará http//meuservidor/MyVDir/myasp. asp como a URL de notificação.</span><span class="sxs-lookup"><span data-stu-id="69170-158">If the original URL is https://myserver/myvdir/file.txt and the notification URL is myasp.asp, BITS uses http//myserver/myvdir/myasp.asp as the notification URL.</span></span><br/> <span data-ttu-id="69170-159">Se a parte do caminho e do nome do arquivo da URL contiver caracteres Unicode que não são comuns à página de código no cliente e no servidor, a conversão da URL falhará no servidor e o trabalho do BITS será colocado no estado de erro.</span><span class="sxs-lookup"><span data-stu-id="69170-159">If the path and file name portion of the URL contains Unicode characters not in common to the code page on both the client and server, the URL translation will fail on the server and the BITS job will be placed in the error state.</span></span> <span data-ttu-id="69170-160">Se a parte do servidor da URL contiver caracteres Unicode, você deverá codificar a parte do servidor usando <a href="/windows/win32/intl/handling-internationalized-domain-names--idns">nomes de domínio internacionalizados</a> (IDN).</span><span class="sxs-lookup"><span data-stu-id="69170-160">If the server portion of the URL contains Unicode characters, you must encode the server portion using <a href="/windows/win32/intl/handling-internationalized-domain-names--idns">Internationalized Domain Names</a> (IDN).</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="69170-161"><strong>BITSHostId</strong> Tipo de dados: <strong>cadeia de caracteres</strong></span><span class="sxs-lookup"><span data-stu-id="69170-161"><strong>BITSHostId</strong>Data Type: <strong>String</strong></span></span><br/></td>
<td><span data-ttu-id="69170-162">Defina essa propriedade se a instalação do servidor for uma web farm que não usa armazenamento compartilhado.</span><span class="sxs-lookup"><span data-stu-id="69170-162">Set this property if the server installation is a web farm that does not use shared storage.</span></span><br/> <span data-ttu-id="69170-163">Especifique o nome do servidor ou o endereço IP do servidor ao qual se conectar novamente depois que o processo de carregamento for interrompido.</span><span class="sxs-lookup"><span data-stu-id="69170-163">Specify the server name or IP address of the server to reconnect to after the upload process is interrupted.</span></span> <span data-ttu-id="69170-164">Normalmente, você especifica o nome do servidor que está configurando.</span><span class="sxs-lookup"><span data-stu-id="69170-164">Typically, you specify the name of the server you are configuring.</span></span> <span data-ttu-id="69170-165">A URL é limitada a 300 caracteres, não incluindo o terminador nulo.</span><span class="sxs-lookup"><span data-stu-id="69170-165">The URL is limited to 300 characters, not including the null terminator.</span></span><br/> <span data-ttu-id="69170-166">Se você não especificar essa propriedade e o processo de carregamento for interrompido, será possível que o BITS retome o trabalho em outro servidor no farm.</span><span class="sxs-lookup"><span data-stu-id="69170-166">If you do not specify this property and the upload process is interrupted, it is possible that BITS will resume the job on another server in the farm.</span></span> <span data-ttu-id="69170-167">No entanto, o servidor anterior ainda contém o arquivo de carregamento parcial antes da interrupção.</span><span class="sxs-lookup"><span data-stu-id="69170-167">However, the previous server still contains the partial upload file from before the interruption.</span></span> <span data-ttu-id="69170-168">O BITS remove o arquivo parcial após o <strong>BITSSessionTimeout</strong> expirar.</span><span class="sxs-lookup"><span data-stu-id="69170-168">BITS removes the partial file after the <strong>BITSSessionTimeout</strong> expires.</span></span><br/>
<blockquote>
[!Note]<br />
<span data-ttu-id="69170-169">Não use a propriedade <strong>BITSHostId</strong> se o SSL for usado em um Web farm que usa o NLB (balanceamento de carga de rede) ou nomes DNS com vários endereços IP, a menos que você inclua o nome do cluster e os nomes de servidor individuais no certificado.</span><span class="sxs-lookup"><span data-stu-id="69170-169">Do not use the <strong>BITSHostId</strong> property if SSL is used in a web farm that uses Network Load Balancing (NLB) or DNS names with multiple IP addresses, unless you include the cluster name and individual server names in the certificate.</span></span> <span data-ttu-id="69170-170">(Se o nome do servidor especificado em <strong>BITSHostId</strong> não corresponder ao nome comum no certificado, o trabalho falhará.) Em vez disso, para o NLB, defina o parâmetro <a href="/previous-versions/tn-archive/bb687542(v=technet.10)">Affinity</a> como <strong>single</strong> para garantir que o cliente se comunique com o mesmo servidor no futuro.</span><span class="sxs-lookup"><span data-stu-id="69170-170">(If the server name specified in <strong>BITSHostId</strong> does not match the common name on the certificate, the job will fail.) Instead, for NLB, set the <a href="/previous-versions/tn-archive/bb687542(v=technet.10)">Affinity</a> parameter to <strong>Single</strong> to ensure that the client communicates with the same server in the future.</span></span>
</blockquote>
<br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="69170-171"><strong>BITSHostIdFallbackTimeout</strong> Tipo de dados: <strong>DWORD</strong></span><span class="sxs-lookup"><span data-stu-id="69170-171"><strong>BITSHostIdFallbackTimeout</strong>Data type: <strong>DWORD</strong></span></span><br/></td>
<td><span data-ttu-id="69170-172">Número de segundos em que o cliente BITS tenta se reconectar ao nome do servidor <strong>BITSHostId</strong> antes de reverter para o nome de host especificado no nome do arquivo remoto do trabalho.</span><span class="sxs-lookup"><span data-stu-id="69170-172">Number of seconds the BITS client tries to reconnect to the <strong>BITSHostId</strong> server name before reverting to the host name specified in the remote file name of the job.</span></span> <span data-ttu-id="69170-173">O temporizador começa quando o BITS não consegue se conectar ao servidor <strong>BITSHostId</strong> .</span><span class="sxs-lookup"><span data-stu-id="69170-173">The timer begins when BITS is unable to connect to the <strong>BITSHostId</strong> server.</span></span> <span data-ttu-id="69170-174">O temporizador é redefinido quando o cliente se conecta com êxito ao servidor.</span><span class="sxs-lookup"><span data-stu-id="69170-174">The timer is reset when the client successfully connects to the server.</span></span><br/> <span data-ttu-id="69170-175">Observe que o valor de tempo limite sem progresso do trabalho (consulte <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout"><strong>método ibackgroundcopyjob:: SetNoProgressTimeout</strong></a>) deve ser maior que esse valor de tempo limite.</span><span class="sxs-lookup"><span data-stu-id="69170-175">Note that the no progress timeout value of the job (see <a href="/windows/win32/api/bits/nf-bits-ibackgroundcopyjob-setnoprogresstimeout"><strong>IBackgroundCopyJob::SetNoProgressTimeout</strong></a>) should be longer than this timeout value.</span></span> <span data-ttu-id="69170-176">Caso contrário, o trabalho falhará antes de o valor de tempo limite de fallback expirar.</span><span class="sxs-lookup"><span data-stu-id="69170-176">If not, the job will fail before fallback timeout value expires.</span></span><br/> <span data-ttu-id="69170-177">Defina essa propriedade somente se você definir a propriedade <strong>BITSHostId</strong> .</span><span class="sxs-lookup"><span data-stu-id="69170-177">Set this property only if you set the <strong>BITSHostId</strong> property.</span></span><br/> <span data-ttu-id="69170-178">O valor padrão é 86.400 (1 dia).</span><span class="sxs-lookup"><span data-stu-id="69170-178">Default value is 86,400 (1 day).</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="69170-179"><strong>BITSAllowOverwrites</strong> Tipo de dados: <strong>inteiro</strong></span><span class="sxs-lookup"><span data-stu-id="69170-179"><strong>BITSAllowOverwrites</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="69170-180">Indica se um arquivo de carregamento pode substituir um arquivo existente com o mesmo nome.</span><span class="sxs-lookup"><span data-stu-id="69170-180">Indicates whether an upload file can overwrite an existing file with the same name.</span></span> <span data-ttu-id="69170-181">O arquivo de carregamento substitui o arquivo existente se <strong>BITSAllowOverwrites</strong> for 1.</span><span class="sxs-lookup"><span data-stu-id="69170-181">The upload file overwrites the existing file if <strong>BITSAllowOverwrites</strong> is 1.</span></span><br/> <span data-ttu-id="69170-182">O valor padrão é 0.</span><span class="sxs-lookup"><span data-stu-id="69170-182">Default value is 0.</span></span><br/> <span data-ttu-id="69170-183"><strong>IIS 6,0:</strong> Você pode definir essa propriedade somente de um script, não pode defini-la usando a página de propriedades de extensão do BITS na interface do usuário do IIS.</span><span class="sxs-lookup"><span data-stu-id="69170-183"><strong>IIS 6.0:</strong> You can set this property only from a script, you cannot set it using the BITS extension properties page in the IIS user interface.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="69170-184"><strong>BITSCleanupUseDefault</strong> Tipo de dados: <strong>booliano</strong></span><span class="sxs-lookup"><span data-stu-id="69170-184"><strong>BITSCleanupUseDefault</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="69170-185">Indica se a tarefa de limpeza usa as agendas padrão.</span><span class="sxs-lookup"><span data-stu-id="69170-185">Indicates whether the cleanup task uses the default schedules.</span></span> <span data-ttu-id="69170-186">Por padrão, a tarefa de limpeza é executada a cada 12 horas.</span><span class="sxs-lookup"><span data-stu-id="69170-186">By default, the cleanup task is run every 12 hours.</span></span><br/> <span data-ttu-id="69170-187">Defina como 1 para usar o agendamento padrão; caso contrário, 0 para especificar uma agenda.</span><span class="sxs-lookup"><span data-stu-id="69170-187">Set to 1 to use the default schedule; otherwise, 0 to specify a schedule.</span></span><br/> <span data-ttu-id="69170-188">Para especificar uma agenda, use as propriedades <strong>BITSCleanupCount</strong> e <strong>BITSCleanupUnits</strong> .</span><span class="sxs-lookup"><span data-stu-id="69170-188">To specify a schedule, use the <strong>BITSCleanupCount</strong> and <strong>BITSCleanupUnits</strong> properties.</span></span><br/> <span data-ttu-id="69170-189">A tarefa de limpeza limpa o diretório virtual excluindo os trabalhos que não foram modificados dentro do período de tempo limite da sessão (consulte <strong>BITSSessionTimeout</strong>).</span><span class="sxs-lookup"><span data-stu-id="69170-189">The cleanup task cleans up the virtual directory by deleting jobs that have not been modified within the session time-out period (see <strong>BITSSessionTimeout</strong>).</span></span><br/> <span data-ttu-id="69170-190">O padrão é 1 usar o agendamento padrão.</span><span class="sxs-lookup"><span data-stu-id="69170-190">The default is 1 use the default schedule.</span></span><br/> <span data-ttu-id="69170-191"><strong>IIS 6,0:</strong> Sem suporte.</span><span class="sxs-lookup"><span data-stu-id="69170-191"><strong>IIS 6.0:</strong> Not supported.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="69170-192"><strong>BITSCleanupCount</strong> Tipo de dados: <strong>inteiro</strong></span><span class="sxs-lookup"><span data-stu-id="69170-192"><strong>BITSCleanupCount</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="69170-193">Especifica o intervalo a aguardar entre a execução da tarefa de limpeza.</span><span class="sxs-lookup"><span data-stu-id="69170-193">Specifies the interval to wait between running the cleanup task.</span></span> <span data-ttu-id="69170-194">O intervalo que você pode especificar depende das unidades.</span><span class="sxs-lookup"><span data-stu-id="69170-194">The interval that you can specify depends on the units.</span></span> <span data-ttu-id="69170-195">Para obter possíveis valores de intervalo, consulte a propriedade <strong>BITSCleanupUnits</strong> .</span><span class="sxs-lookup"><span data-stu-id="69170-195">For possible interval values, see the <strong>BITSCleanupUnits</strong> property.</span></span><br/> <span data-ttu-id="69170-196">Essa propriedade será ignorada se <strong>BITSCleanupUseDefault</strong> for 0.</span><span class="sxs-lookup"><span data-stu-id="69170-196">This property is ignored if <strong>BITSCleanupUseDefault</strong> is 0.</span></span><br/> <span data-ttu-id="69170-197"><strong>IIS 6,0:</strong> Sem suporte.</span><span class="sxs-lookup"><span data-stu-id="69170-197"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="69170-198"><strong>BITSCleanupUnits</strong> Tipo de dados: <strong>inteiro</strong></span><span class="sxs-lookup"><span data-stu-id="69170-198"><strong>BITSCleanupUnits</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="69170-199">Especifica as unidades para o intervalo de limpeza especificado na propriedade <strong>BITSCleanupCount</strong> .</span><span class="sxs-lookup"><span data-stu-id="69170-199">Specifies the units for the cleanup interval specified in the <strong>BITSCleanupCount</strong> property.</span></span> <span data-ttu-id="69170-200">Essa propriedade será ignorada se <strong>BITSCleanupUseDefault</strong> for 0.</span><span class="sxs-lookup"><span data-stu-id="69170-200">This property is ignored if <strong>BITSCleanupUseDefault</strong> is 0.</span></span><br/> <span data-ttu-id="69170-201">Os valores possíveis são:</span><span class="sxs-lookup"><span data-stu-id="69170-201">The possible values are:</span></span><dl> <span data-ttu-id="69170-202">0: as unidades são minutos.</span><span class="sxs-lookup"><span data-stu-id="69170-202">0: The units are minutes.</span></span> <span data-ttu-id="69170-203">Os valores possíveis são 1 a 60.</span><span class="sxs-lookup"><span data-stu-id="69170-203">Possible values are 1 to 60.</span></span><br />
<span data-ttu-id="69170-204">1: as unidades são horas.</span><span class="sxs-lookup"><span data-stu-id="69170-204">1: The units are hours.</span></span> <span data-ttu-id="69170-205">Esse é o padrão.</span><span class="sxs-lookup"><span data-stu-id="69170-205">This is the default.</span></span> <span data-ttu-id="69170-206">Os valores possíveis são 1 a 24.</span><span class="sxs-lookup"><span data-stu-id="69170-206">Possible values are 1 to 24.</span></span><br />
<span data-ttu-id="69170-207">2: as unidades são dias.</span><span class="sxs-lookup"><span data-stu-id="69170-207">2: The units are days.</span></span> <span data-ttu-id="69170-208">Os valores possíveis são 1 a 360.</span><span class="sxs-lookup"><span data-stu-id="69170-208">Possible values are 1 to 360.</span></span><br />
</dl> <br/> <span data-ttu-id="69170-209"><strong>IIS 6,0:</strong> Sem suporte.</span><span class="sxs-lookup"><span data-stu-id="69170-209"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="69170-210"><strong>BITSNumberOfSessionsLimit</strong> Tipo de dados: <strong>inteiro</strong></span><span class="sxs-lookup"><span data-stu-id="69170-210"><strong>BITSNumberOfSessionsLimit</strong>Data type: <strong>Integer</strong></span></span><br/></td>
<td><span data-ttu-id="69170-211">Limita o número de sessões de carregamento que podem existir simultaneamente para um usuário.</span><span class="sxs-lookup"><span data-stu-id="69170-211">Limits the number of upload sessions that can exist concurrently for a user.</span></span> <span data-ttu-id="69170-212">Se o número de sessões de um usuário for maior que esse limite, quando a tarefa de limpeza for executada, as sessões mais recentes serão excluídas até que o número de sessões do usuário esteja abaixo do limite.</span><span class="sxs-lookup"><span data-stu-id="69170-212">If the number of sessions for a user is more than this limit, when the cleanup task runs it will delete the most recent sessions until the number of sessions for the user is below the limit.</span></span><br/> <span data-ttu-id="69170-213">O padrão é 50 sessões.</span><span class="sxs-lookup"><span data-stu-id="69170-213">The default is 50 sessions.</span></span><br/> <span data-ttu-id="69170-214"><strong>IIS 6,0:</strong> Sem suporte.</span><span class="sxs-lookup"><span data-stu-id="69170-214"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="69170-215"><strong>BITSSessionLimitEnable</strong> Tipo de dados: <strong>booliano</strong></span><span class="sxs-lookup"><span data-stu-id="69170-215"><strong>BITSSessionLimitEnable</strong>Data type: <strong>Boolean</strong></span></span><br/></td>
<td><span data-ttu-id="69170-216">Indica se o BITS limita o número de sessões de carregamento por usuário.</span><span class="sxs-lookup"><span data-stu-id="69170-216">Indicates whether BITS limits the number of upload sessions per user.</span></span> <span data-ttu-id="69170-217">Se a configuração não estiver presente ou for 0, o limite será desabilitado.</span><span class="sxs-lookup"><span data-stu-id="69170-217">If the setting is not present or is 0, the limit is disabled.</span></span><br/> <span data-ttu-id="69170-218">Para especificar o limite, defina a propriedade <strong>BITSNumberOfSessionsLimit</strong> .</span><span class="sxs-lookup"><span data-stu-id="69170-218">To specify the limit, set the <strong>BITSNumberOfSessionsLimit</strong> property.</span></span><br/> <span data-ttu-id="69170-219">O padrão é 1.</span><span class="sxs-lookup"><span data-stu-id="69170-219">The default is 1.</span></span><br/> <span data-ttu-id="69170-220"><strong>IIS 6,0:</strong> Sem suporte.</span><span class="sxs-lookup"><span data-stu-id="69170-220"><strong>IIS 6.0:</strong> Not supported.</span></span><br/> <br/></td>
</tr>
</tbody>
</table>



 

<span data-ttu-id="69170-221">O exemplo a seguir mostra como definir as propriedades de extensão do IIS do BITS usando o Windows Script Host.</span><span class="sxs-lookup"><span data-stu-id="69170-221">The following example shows how to set the BITS IIS extension properties using Windows Script Host.</span></span> <span data-ttu-id="69170-222">Se o diretório virtual apontar para um compartilhamento remoto, defina também as propriedades de **UNCPassword** do **UNCUserName** e do IIS.</span><span class="sxs-lookup"><span data-stu-id="69170-222">If the virtual directory points to a remote share, also set the **UNCUserName** and **UNCPassword** IIS properties.</span></span>


```JScript
if (WScript.Arguments.length < 2)
{
    WScript.Echo("Usage: bitsvdir virtual_directory local_directory");
    WScript.Quit(1);
}

VirtualDirectoryName = WScript.Arguments(0);
LocalDirectoryName = WScript.Arguments(1);

ServerObj = GetObject("IIS://LocalHost/W3SVC/1/ROOT");
VirtualDir = ServerObj.Create("IIsWebVirtualDir", VirtualDirectoryName );

VirtualDir.Path = LocalDirectoryName;
VirtualDir.AppIsolated = 0;
VirtualDir.AccessScript = true;
VirtualDir.AccessRead = false;
VirtualDir.AccessWrite = false;
VirtualDir.SetInfo();

// Set BITS specific IIS configuration settings
VirtualDir.EnableBITSUploads();
VirtualDir.BITSMaximumUploadSize = "4294967296";
VirtualDir.SetInfo();

WScript.Echo( "Created virtual directory " + VirtualDirectoryName + 
              " with a local directory of " + LocalDirectoryName );
WScript.Quit( 0 );
```



 

