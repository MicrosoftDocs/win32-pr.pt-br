---
title: Contas de serviço e BITS
description: Você pode usar BITS para transferir arquivos de um serviço. O serviço deve usar a conta do sistema LocalSystem, LocalService ou NetworkService. Essas contas estão sempre conectadas; Portanto, os trabalhos enviados por um serviço usando essas contas sempre são executados.
ms.assetid: 43fb58d6-3a99-488f-ab43-dbb4a794fc2f
keywords:
- BITS de contas de serviço
- transferir BITS de trabalho, propriedade, conta de serviço
- BITS de proxy, contas de serviço
- credenciais para transferir BITS de trabalho
ms.topic: article
ms.date: 10/04/2018
ms.openlocfilehash: 475a623e6b105d3ef2bdc6586db613c010fe8923
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104084627"
---
# <a name="service-accounts-and-bits"></a><span data-ttu-id="9805c-109">Contas de serviço e BITS</span><span class="sxs-lookup"><span data-stu-id="9805c-109">Service Accounts and BITS</span></span>

<span data-ttu-id="9805c-110">Você pode usar BITS para transferir arquivos de um serviço.</span><span class="sxs-lookup"><span data-stu-id="9805c-110">You can use BITS to transfer files from a service.</span></span> <span data-ttu-id="9805c-111">O serviço deve usar a conta do sistema LocalSystem, LocalService ou NetworkService.</span><span class="sxs-lookup"><span data-stu-id="9805c-111">The service must use the LocalSystem, LocalService, or NetworkService system account.</span></span> <span data-ttu-id="9805c-112">Essas contas estão sempre conectadas; Portanto, os trabalhos enviados por um serviço usando essas contas sempre são executados.</span><span class="sxs-lookup"><span data-stu-id="9805c-112">These accounts are always logged on; therefore, jobs submitted by a service using these accounts always run.</span></span>

<span data-ttu-id="9805c-113">Se um serviço em execução em uma conta do sistema representar o usuário antes de chamar BITS, o BITS responderá como faria para qualquer conta de usuário (por exemplo, o usuário precisa estar conectado ao computador para que a transferência ocorra).</span><span class="sxs-lookup"><span data-stu-id="9805c-113">If a service running under a system account impersonates the user before calling BITS, BITS responds as it would for any user account (for example, the user needs to be logged on to the computer for the transfer to occur).</span></span> <span data-ttu-id="9805c-114">O serviço também deve usar o encobrimento dinâmico com os ponteiros de interface do BITS ao representar o usuário.</span><span class="sxs-lookup"><span data-stu-id="9805c-114">The service should also use dynamic cloaking with the BITS interface pointers when impersonating the user.</span></span> <span data-ttu-id="9805c-115">O encobrimento não é herdado, portanto, você deve chamar a função [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) em cada ponteiro de interface que você recebe de bits (por exemplo, o ponteiro do trabalho retornado da chamada do método [**IBackgroundCopyManager:: CreateJob**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopymanager-createjob) ); Não é suficiente definir o encobrimento no ponteiro da interface do Gerenciador.</span><span class="sxs-lookup"><span data-stu-id="9805c-115">Cloaking is not inherited, therefore you must call the [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) function on each interface pointer that you receive from BITS (for example, the job pointer returned from calling the [**IBackgroundCopyManager::CreateJob**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopymanager-createjob) method); it is not enough to set cloaking on the manager interface pointer.</span></span> <span data-ttu-id="9805c-116">Você também pode chamar a função [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) para o processo em vez de chamar a função **CoSetProxyBlanket** em cada ponteiro de interface.</span><span class="sxs-lookup"><span data-stu-id="9805c-116">You can also call the [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) function for the process instead of calling the **CoSetProxyBlanket** function on each interface pointer.</span></span>

<span data-ttu-id="9805c-117">No entanto, se o serviço não representar o usuário, os seguintes comportamentos se aplicarão:</span><span class="sxs-lookup"><span data-stu-id="9805c-117">However, if the service does not impersonate the user, the following behaviors apply:</span></span>

- <span data-ttu-id="9805c-118">Os trabalhos criados pela conta de serviço pertencem a essa conta.</span><span class="sxs-lookup"><span data-stu-id="9805c-118">Jobs created by the service account are owned by that account.</span></span> <span data-ttu-id="9805c-119">Como as contas do sistema estão sempre conectadas, o BITS transfere os arquivos desde que o computador esteja em execução e haja uma conexão de rede.</span><span class="sxs-lookup"><span data-stu-id="9805c-119">Because system accounts are always logged on, BITS transfers the files as long as the computer is running and there is a network connection.</span></span>
- <span data-ttu-id="9805c-120">As contas do sistema não devem usar letras de unidade de rede mapeadas porque as letras da unidade são específicas a uma sessão e o mapeamento pode ser perdido após a reinicialização do computador.</span><span class="sxs-lookup"><span data-stu-id="9805c-120">System accounts should not use mapped network drive letters because the drive letters are specific to a session and the mapping may be lost after a computer restart.</span></span>
- <span data-ttu-id="9805c-121">Na ausência de um [token auxiliar](helper-tokens-for-bits-transfer-jobs.md), a autenticação de rede usa credenciais de computador para contas LocalSystem e NetworkService e credenciais anônimas para a conta LocalService.</span><span class="sxs-lookup"><span data-stu-id="9805c-121">In the absence of a [Helper Token](helper-tokens-for-bits-transfer-jobs.md), network authentication uses computer credentials for LocalSystem and NetworkService accounts and anonymous credentials for the LocalService account.</span></span> <span data-ttu-id="9805c-122">O BITS retornará "acesso negado" se a ACL (lista de controle de acesso) do arquivo de origem limitar o acesso a uma conta de usuário.</span><span class="sxs-lookup"><span data-stu-id="9805c-122">BITS returns "access denied" if the access control list (ACL) for the source file limits access to a user account.</span></span>
- <span data-ttu-id="9805c-123">Para obter detalhes sobre como a autenticação funciona na presença de um [token auxiliar](helper-tokens-for-bits-transfer-jobs.md), consulte [autenticação](authentication.md).</span><span class="sxs-lookup"><span data-stu-id="9805c-123">For details on how authentication works in the presence of a [Helper Token](helper-tokens-for-bits-transfer-jobs.md), see [Authentication](authentication.md).</span></span>
- <span data-ttu-id="9805c-124">As configurações de proxy do Microsoft Internet Explorer são armazenadas por usuário e não são definidas para contas do sistema.</span><span class="sxs-lookup"><span data-stu-id="9805c-124">Microsoft Internet Explorer proxy settings are stored per-user and are not set for system accounts.</span></span> <span data-ttu-id="9805c-125">Considere configurar um token auxiliar em seus trabalhos do BITS ou definir explicitamente as configurações de proxy corretas chamando [**método ibackgroundcopyjob:: SetProxySettings**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) com a substituição de uso de **proxy de \_ trabalho \_ \_ \_ BG**.</span><span class="sxs-lookup"><span data-stu-id="9805c-125">Consider configuring a helper token on your BITS jobs, or explicitly setting the correct proxy settings by calling [**IBackgroundCopyJob::SetProxySettings**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) with **BG\_JOB\_PROXY\_USAGE\_OVERRIDE**.</span></span> <span data-ttu-id="9805c-126">Como alternativa, você pode usar os comutadores **/util/SetIEProxy** da BitsAdmin.exe para definir as configurações de proxy do Internet Explorer para a conta do sistema LocalSystem, LocalService ou NetworkService.</span><span class="sxs-lookup"><span data-stu-id="9805c-126">Alternatively, you can use the **/Util /SetIEProxy** switches of BitsAdmin.exe to set Internet Explorer proxy settings for the LocalSystem, LocalService, or NetworkService system account.</span></span> <span data-ttu-id="9805c-127">Para obter detalhes, consulte [ferramenta BitsAdmin](bitsadmin-tool.md).</span><span class="sxs-lookup"><span data-stu-id="9805c-127">For details, see [BitsAdmin Tool](bitsadmin-tool.md).</span></span>

<span data-ttu-id="9805c-128">Observe que o BITS não reconhece as configurações de proxy que são definidas usando o arquivo Proxycfg.exe.</span><span class="sxs-lookup"><span data-stu-id="9805c-128">Note that BITS does not recognize the proxy settings that are set using the Proxycfg.exe file.</span></span>