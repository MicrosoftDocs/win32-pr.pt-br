---
description: Trabalhando com funções de dispositivo
ms.assetid: 3b2cb1fe-0f11-4509-a6f3-513d2755cd29
title: Trabalhando com funções de dispositivo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c21ea667a6974634c1f9f0657dd02c13a621641c
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103920124"
---
# <a name="working-with-device-roles"></a><span data-ttu-id="05c35-103">Trabalhando com funções de dispositivo</span><span class="sxs-lookup"><span data-stu-id="05c35-103">Working with Device Roles</span></span>

<span data-ttu-id="05c35-104">A [API MMDevice](mmdevice-api.md) dá suporte a funções de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="05c35-104">The [MMDevice API](mmdevice-api.md) supports device roles.</span></span> <span data-ttu-id="05c35-105">A enumeração [**ERole**](/windows/win32/api/mmdeviceapi/ne-mmdeviceapi-erole) define as funções de dispositivo com suporte na API MMDevice.</span><span class="sxs-lookup"><span data-stu-id="05c35-105">The [**ERole**](/windows/win32/api/mmdeviceapi/ne-mmdeviceapi-erole) enumeration defines the device roles that are supported by the MMDevice API.</span></span>

> [!Note]  
> <span data-ttu-id="05c35-106">Embora a [API MMDevice](mmdevice-api.md) dê suporte a funções de dispositivo, a interface do usuário no Windows Vista não implementa o suporte para esse recurso.</span><span class="sxs-lookup"><span data-stu-id="05c35-106">Although the [MMDevice API](mmdevice-api.md) supports device roles, the user interface in Windows Vista does not implement support for this feature.</span></span>

 

<span data-ttu-id="05c35-107">Um aplicativo pode usar a API MMDevice para dar suporte a [funções de dispositivo](device-roles.md) por meio dos métodos [**IMMDeviceEnumerator:: GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint) e [**IMMNotificationClient:: OnDefaultDeviceChanged**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immnotificationclient-ondefaultdevicechanged) .</span><span class="sxs-lookup"><span data-stu-id="05c35-107">An application can use MMDevice API to support [device roles](device-roles.md) through the [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint) and [**IMMNotificationClient::OnDefaultDeviceChanged**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immnotificationclient-ondefaultdevicechanged) methods.</span></span> <span data-ttu-id="05c35-108">No entanto, a interface do usuário no Windows Vista não oferece suporte à atribuição de funções individuais a diferentes dispositivos.</span><span class="sxs-lookup"><span data-stu-id="05c35-108">However, the user interface in Windows Vista does not support assignment of individual roles to different devices.</span></span> <span data-ttu-id="05c35-109">No Windows Vista, a interface do usuário permite que o usuário selecione um dispositivo de áudio padrão para renderização e um dispositivo de áudio padrão para captura.</span><span class="sxs-lookup"><span data-stu-id="05c35-109">In Windows Vista, the user interface enables the user to select a default audio device for rendering and a default audio device for capture.</span></span> <span data-ttu-id="05c35-110">Quando o usuário seleciona um dispositivo de renderização ou de captura padrão, o sistema atribui todas as três funções de dispositivo (eConsole, eMultimedia e eCommunications) a esse dispositivo.</span><span class="sxs-lookup"><span data-stu-id="05c35-110">When the user selects a default rendering or capture device, the system assigns all three device roles (eConsole, eMultimedia, and eCommunications) to that device.</span></span> <span data-ttu-id="05c35-111">Os aplicativos não podem alterar as funções atribuídas aos dispositivos de ponto de extremidade de áudio.</span><span class="sxs-lookup"><span data-stu-id="05c35-111">Applications cannot change the roles that are assigned to audio endpoint devices.</span></span> <span data-ttu-id="05c35-112">O sistema operacional permite que apenas o usuário atribua funções de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="05c35-112">The operating system allows only the user to assign device roles.</span></span>

<span data-ttu-id="05c35-113">Um cliente pode se registrar para receber uma notificação da API MMDevice sempre que uma alteração ocorrer na atribuição de funções para dispositivos de ponto de extremidade de áudio.</span><span class="sxs-lookup"><span data-stu-id="05c35-113">A client can register itself to receive a notification from the MMDevice API each time a change occurs in the assignment of roles to audio endpoint devices.</span></span> <span data-ttu-id="05c35-114">Quando uma função muda de um dispositivo para outro, o cliente pode escolher se deseja continuar a reproduzir (ou gravar) seus fluxos por meio do mesmo dispositivo ou para alternar os fluxos para outro dispositivo.</span><span class="sxs-lookup"><span data-stu-id="05c35-114">When a role shifts from one device to another, the client can choose whether to continue playing (or recording) its streams through the same device or to switch the streams to another device.</span></span> <span data-ttu-id="05c35-115">Por padrão, os fluxos continuam a ser reproduzidos (ou registrados) por meio do dispositivo original.</span><span class="sxs-lookup"><span data-stu-id="05c35-115">By default, the streams continue to play (or be recorded) through the original device.</span></span> <span data-ttu-id="05c35-116">No Windows Vista, para alternar os fluxos para outro dispositivo, o cliente deve excluir os fluxos no dispositivo original e criar fluxos de substituição no novo dispositivo.</span><span class="sxs-lookup"><span data-stu-id="05c35-116">In Windows Vista, to switch the streams to another device, the client must delete the streams on the original device and create replacement streams on the new device.</span></span> <span data-ttu-id="05c35-117">No Windows 7, o cliente pode escutar novas notificações para implementar um comutador contínuo sem interromper a reprodução ou a sessão de captura.</span><span class="sxs-lookup"><span data-stu-id="05c35-117">In Windows 7, the client can listen for new notifications to implement a seamless switch without interrupting the playback or the capture session.</span></span> <span data-ttu-id="05c35-118">Para obter mais informações, consulte [Roteamento de fluxo](stream-routing.md).</span><span class="sxs-lookup"><span data-stu-id="05c35-118">For more information, see [Stream Routing](stream-routing.md).</span></span>

<span data-ttu-id="05c35-119">Se você planeja usar o Windows Vista para testar seu aplicativo, você pode configurar um ambiente de teste para verificar se o aplicativo se comporta conforme o esperado quando o usuário pode atribuir funções de dispositivo individuais a diferentes dispositivos.</span><span class="sxs-lookup"><span data-stu-id="05c35-119">If you plan to use Windows Vista to test your application, you can set up a test environment to verify that the application behaves as expected when the user can assign individual device roles to different devices.</span></span> <span data-ttu-id="05c35-120">Para obter mais informações, envie um email para uaa@microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="05c35-120">For more information, send email to uaa@microsoft.com.</span></span>

## <a name="communication-devices"></a><span data-ttu-id="05c35-121">Dispositivos de comunicação</span><span class="sxs-lookup"><span data-stu-id="05c35-121">Communication Devices</span></span>

<span data-ttu-id="05c35-122">A interface do usuário do Windows 7 tem a capacidade de adicionar *dispositivos de comunicação*.</span><span class="sxs-lookup"><span data-stu-id="05c35-122">The Windows 7 user interface has the capability of adding *communications devices*.</span></span> <span data-ttu-id="05c35-123">O painel de controle de **som** permite que o usuário selecione um dispositivo de comunicação padrão para renderizar e capturar o fluxo de áudio.</span><span class="sxs-lookup"><span data-stu-id="05c35-123">The **Sound** control panel enables the user to select a default communication device each for rendering and capturing audio stream.</span></span> <span data-ttu-id="05c35-124">Por padrão, quando um novo dispositivo está conectado ao computador, o sistema operacional executa a detecção automática de função e determina se o dispositivo é adequado para a função eCommunication.</span><span class="sxs-lookup"><span data-stu-id="05c35-124">By default, when a new device is connected to the computer, the operating system performs automatic role detecting and determines whether the device is suitable for the eCommunication role.</span></span> <span data-ttu-id="05c35-125">Ao direcionar dispositivos de comunicação, você pode desenvolver aplicativos que usam APIs de áudio de núcleo para implementar soluções de comunicação de PC-Phone.</span><span class="sxs-lookup"><span data-stu-id="05c35-125">By targeting communication devices, you can develop applications that use Core Audio APIs to implement PC-phone communication solutions.</span></span> <span data-ttu-id="05c35-126">Por exemplo, um aplicativo VoIP pode atribuir seus fluxos de entrada e saída de voz para os dispositivos de ponto de extremidade de captura e renderização padrão com a função eCommunications.</span><span class="sxs-lookup"><span data-stu-id="05c35-126">For example, a VoIP application might assign its voice input and output streams to the default capture and rendering endpoint devices with the eCommunications role.</span></span> <span data-ttu-id="05c35-127">Como qualquer outro fluxo, um aplicativo de comunicação deve obter uma referência ao ponto de extremidade do dispositivo de comunicação chamando [**IMMDeviceEnumerator:: GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span><span class="sxs-lookup"><span data-stu-id="05c35-127">Like any other stream, a communication application must get a reference to the communication device's endpoint by calling [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span></span> <span data-ttu-id="05c35-128">Nesta chamada, o aplicativo deve especificar **eCommunications** no parâmetro *role* .</span><span class="sxs-lookup"><span data-stu-id="05c35-128">In this call, the application must specify **eCommunications** in the *Role* parameter.</span></span> <span data-ttu-id="05c35-129">As operações de fluxo de WASAPI em um fluxo, abertas em um dispositivo de comunicação, são semelhantes a qualquer outro fluxo de áudio.</span><span class="sxs-lookup"><span data-stu-id="05c35-129">The WASAPI stream operations on a stream, opened on a communication device, are similar to any other audio stream.</span></span> <span data-ttu-id="05c35-130">O aplicativo de comunicação pode melhorar a experiência do usuário implementando comportamentos como o pato manipulando notificações do ponto de extremidade do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="05c35-130">The communication application can enhance user experience by implementing behaviors such as ducking by handling notifications from the device endpoint.</span></span> <span data-ttu-id="05c35-131">Para obter mais informações, consulte [usando um dispositivo de comunicação](using-the-communication-device.md).</span><span class="sxs-lookup"><span data-stu-id="05c35-131">For more information, see [Using a Communication Device](using-the-communication-device.md).</span></span>

## <a name="automatic-device-role-detection"></a><span data-ttu-id="05c35-132">Detecção automática de função de dispositivo</span><span class="sxs-lookup"><span data-stu-id="05c35-132">Automatic Device Role Detection</span></span>

<span data-ttu-id="05c35-133">Considere um cenário no qual um computador tem um dispositivo de processamento padrão, os alto-falantes e um dispositivo de captura padrão, um microfone.</span><span class="sxs-lookup"><span data-stu-id="05c35-133">Consider a scenario in which a computer has a default rendering device, the speakers, and a default capture device, a microphone.</span></span> <span data-ttu-id="05c35-134">O usuário conecta um headset USB ao computador.</span><span class="sxs-lookup"><span data-stu-id="05c35-134">The user connects a USB headset to the computer.</span></span> <span data-ttu-id="05c35-135">Depois que os drivers apropriados são instalados, o sistema operacional tenta detectar uma função a ser atribuída para o novo dispositivo de áudio.</span><span class="sxs-lookup"><span data-stu-id="05c35-135">After the appropriate drivers are installed, the operating system attempts to detect a role to assign for the new audio device.</span></span>

<span data-ttu-id="05c35-136">No Windows 7, o recurso de detecção de função de dispositivo foi melhorado significativamente para determinar as funções apropriadas adequadas para dispositivos de áudio.</span><span class="sxs-lookup"><span data-stu-id="05c35-136">In Windows 7, the device role detection feature has been improved significantly to determine the appropriate roles suited for audio devices.</span></span> <span data-ttu-id="05c35-137">Todos os dispositivos de áudio contêm um conjunto de definições de configuração preenchidas pelo OEM do dispositivo, que ajudam o sistema a decidir como usar o dispositivo.</span><span class="sxs-lookup"><span data-stu-id="05c35-137">All audio devices contain a set of configuration settings populated by the device OEM, which help the system decide how to use the device.</span></span> <span data-ttu-id="05c35-138">Essas configurações incluem informações como o local físico da tomada de áudio do tipo de dispositivo, o subtipo da tomada e os recursos de detecção para que o sistema possa determinar se o dispositivo está conectado.</span><span class="sxs-lookup"><span data-stu-id="05c35-138">These settings include information such as the physical location of the audio jack the device type, the jack subtype, and detection capabilities so that the system can determine whether the device is plugged in.</span></span> <span data-ttu-id="05c35-139">Ao recuperar esses valores do dispositivo, o sistema operacional determina a função a ser atribuída ao dispositivo.</span><span class="sxs-lookup"><span data-stu-id="05c35-139">By retrieving these values from the device, the operating system determines the role to assign to the device.</span></span> <span data-ttu-id="05c35-140">Nesse cenário, o sistema consultou o dispositivo headset USB, executou a detecção automática de função e decidiu que o dispositivo é mais adequado para ser um dispositivo de comunicação.</span><span class="sxs-lookup"><span data-stu-id="05c35-140">In this scenario, the system has queried the USB headset device, performed automatic role detection, and decided that the device is best suited to be a communication device.</span></span>

<span data-ttu-id="05c35-141">Um aplicativo também pode obter informações sobre a tomada usando as APIs de áudio principais.</span><span class="sxs-lookup"><span data-stu-id="05c35-141">An application can also get jack information by using the Core Audio APIs.</span></span> <span data-ttu-id="05c35-142">Para obter mais informações, consulte [**IKsJackDescription**](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription) e [**IKsJackDescription2**](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription2).</span><span class="sxs-lookup"><span data-stu-id="05c35-142">For more information, see [**IKsJackDescription**](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription) and [**IKsJackDescription2**](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription2).</span></span>

## <a name="related-topics"></a><span data-ttu-id="05c35-143">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="05c35-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="05c35-144">Funções de dispositivo</span><span class="sxs-lookup"><span data-stu-id="05c35-144">Device Roles</span></span>](device-roles.md)
</dt> </dl>

 

 



