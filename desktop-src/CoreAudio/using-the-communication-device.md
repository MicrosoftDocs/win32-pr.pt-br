---
description: No Windows 7, o painel de controle multimídia do Windows, Mmsys.cpl, fornece uma nova guia de comunicações.
ms.assetid: bec2127d-fb82-436d-beee-d43e8fef5c35
title: Usando um dispositivo de comunicação
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 93f677245e650cf11c71c879b2c26d3183ff4a0b
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103826475"
---
# <a name="using-a-communication-device"></a><span data-ttu-id="d21dd-103">Usando um dispositivo de comunicação</span><span class="sxs-lookup"><span data-stu-id="d21dd-103">Using a Communication Device</span></span>

<span data-ttu-id="d21dd-104">No Windows 7, o painel de controle multimídia do Windows, Mmsys.cpl, fornece uma nova guia de **comunicações** . Essa guia contém opções que permitem que um usuário defina opções que definem como o sistema gerencia um *dispositivo de comunicação*.</span><span class="sxs-lookup"><span data-stu-id="d21dd-104">In Windows 7, the Windows multimedia control panel, Mmsys.cpl, provides a new **Communications** tab. This tab contains options that enables a user to set options that defines how the system manages a *communication device*.</span></span> <span data-ttu-id="d21dd-105">Um dispositivo de comunicação é usado principalmente para colocar ou receber chamadas telefônicas no computador.</span><span class="sxs-lookup"><span data-stu-id="d21dd-105">A communication device is used primarily for placing or receiving telephone calls on the computer.</span></span> <span data-ttu-id="d21dd-106">Para um computador que tem apenas um dispositivo de renderização (alto-falante) e um dispositivo de captura (microfone), esses dispositivos de áudio também agem como os dispositivos de comunicação padrão.</span><span class="sxs-lookup"><span data-stu-id="d21dd-106">For a computer that has only one rendering device (speaker) and one capture device (microphone), these audio devices also act as the default communication devices.</span></span> <span data-ttu-id="d21dd-107">Quando um usuário conecta um novo dispositivo, como um headset USB, o sistema executa a detecção de função de dispositivo automática consultando as definições de configuração que são preenchidas pelo OEM.</span><span class="sxs-lookup"><span data-stu-id="d21dd-107">When a user connects a new device, such as a USB headset, the system performs automatic device role detection by looking up the configuration settings that are populated by the OEM.</span></span> <span data-ttu-id="d21dd-108">Se o sistema determinar que um dispositivo seja mais adequado para fins de comunicação, o sistema atribuirá a função **eCommunications** ao dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d21dd-108">If the system determines a device to be best suited for communication purposes, the system assigns the **eCommunications** role to the device.</span></span> <span data-ttu-id="d21dd-109">Para esses dispositivos, o Mmsys.cpl do Windows 7 fornece a opção **dispositivo de comunicação padrão** que permite que um usuário selecione um dispositivo de comunicação para a renderização de áudio (guia **reprodução** ) e captura de áudio (guia **gravação** ).</span><span class="sxs-lookup"><span data-stu-id="d21dd-109">For these devices, the Windows 7 Mmsys.cpl provides the option **Default Communication Device** that enables a user to select a communication device each for audio rendering (**Playback** tab) and audio capturing (**Recording** tab).</span></span> <span data-ttu-id="d21dd-110">O sistema executa a detecção automática de função, mas não define um dispositivo específico a ser usado para comunicações.</span><span class="sxs-lookup"><span data-stu-id="d21dd-110">The system performs automatic role detection but does not set a particular device to be used for communications.</span></span> <span data-ttu-id="d21dd-111">Isso deve ser feito pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="d21dd-111">This must be done by the user.</span></span> <span data-ttu-id="d21dd-112">A nova função **eCommunications** permite que um aplicativo diferencie um dispositivo escolhido pelo usuário para lidar com chamadas telefônicas e um dispositivo a ser usado como um dispositivo de multimídia (reprodução de música).</span><span class="sxs-lookup"><span data-stu-id="d21dd-112">The new **eCommunications** role lets an application distinguish between a device that is chosen by the user for handling phone calls and a device to be used as a multimedia device (music playback).</span></span> <span data-ttu-id="d21dd-113">Por exemplo, se o usuário tiver um headset e um palestrante conectado ao computador, o sistema atribuirá a função **eConsole** ao palestrante e à função **eCommunications** para o headset.</span><span class="sxs-lookup"><span data-stu-id="d21dd-113">For example, if the user has a headset and a speaker connected to the computer, the system assigns the **eConsole** role to the speaker and the **eCommunications** role to the headset.</span></span> <span data-ttu-id="d21dd-114">Depois que o usuário selecionar o headset a ser usado como o dispositivo de comunicação, para desenvolver um aplicativo de comunicação, você poderá direcionar o headset especificamente para renderizar um fluxo de áudio.</span><span class="sxs-lookup"><span data-stu-id="d21dd-114">After the user selects the headset to be used as the communication device, to develop a communication application, you can target the headset specifically for rendering an audio stream.</span></span> <span data-ttu-id="d21dd-115">Um aplicativo que o usuário não pode alterar a função de dispositivo atribuída pelo sistema.</span><span class="sxs-lookup"><span data-stu-id="d21dd-115">An application the user cannot change the device role assigned by the system.</span></span> <span data-ttu-id="d21dd-116">Para obter mais informações sobre as funções de dispositivo, consulte [funções de dispositivo](device-roles.md).</span><span class="sxs-lookup"><span data-stu-id="d21dd-116">For more information about device roles, see [Device Roles](device-roles.md).</span></span>

<span data-ttu-id="d21dd-117">Aplicativos de comunicação, como VoIP e aplicativos de comunicação unificada, colocam e recebem chamadas telefônicas por meio de um computador.</span><span class="sxs-lookup"><span data-stu-id="d21dd-117">Communication applications, such as VoIP and Unified Communication applications, place and receive phone calls through a computer.</span></span> <span data-ttu-id="d21dd-118">Por exemplo, um aplicativo VoIP pode atribuir um fluxo que contém a notificação de toque para o ponto de extremidade de um conjunto de dispositivos de comunicação para renderização de fluxos de áudio.</span><span class="sxs-lookup"><span data-stu-id="d21dd-118">For example, a VoIP application might assign a stream that contains the ring-in notification to the endpoint of a communication device set for rendering audio streams.</span></span> <span data-ttu-id="d21dd-119">Além disso, o aplicativo pode abrir os fluxos de entrada e saída de voz nos dispositivos de ponto de extremidade de captura e renderização definidos como dispositivos de comunicação.</span><span class="sxs-lookup"><span data-stu-id="d21dd-119">In addition, the application might open the voice input and output streams on the capture and rendering endpoint devices that are set as communication devices.</span></span>

<span data-ttu-id="d21dd-120">Para integrar os recursos de comunicação em seus aplicativos, você pode usar:</span><span class="sxs-lookup"><span data-stu-id="d21dd-120">To integrate communication capabilities into your applications, you can use:</span></span>

-   <span data-ttu-id="d21dd-121">[API MMDevice](mmdevice-api.md)– para obter uma referência ao ponto de extremidade do dispositivo de comunicação.</span><span class="sxs-lookup"><span data-stu-id="d21dd-121">[MMDevice API](mmdevice-api.md)—to get a reference to the endpoint of the communication device.</span></span>
-   <span data-ttu-id="d21dd-122">[WASAPI](wasapi.md)— para renderizar e capturar fluxos de áudio por meio do dispositivo de comunicação.</span><span class="sxs-lookup"><span data-stu-id="d21dd-122">[WASAPI](wasapi.md)—to render and capture audio streams through the communication device.</span></span> <span data-ttu-id="d21dd-123">O sistema operacional considera o fluxo aberto em um dispositivo de comunicação como um *fluxo de comunicação*.</span><span class="sxs-lookup"><span data-stu-id="d21dd-123">The operating system considers the stream opened on a communication device to be a *communication stream*.</span></span>

<span data-ttu-id="d21dd-124">O aplicativo de comunicação enumera dispositivos e fornece gerenciamento de fluxo para um fluxo de fluxo de comunicação (renderização ou captura) da mesma maneira como ele gerenciaria um fluxo de não comunicação usando as APIs de áudio principais.</span><span class="sxs-lookup"><span data-stu-id="d21dd-124">The communication application enumerates devices and provides stream management for a communication stream (rendering or capture) stream in the same manner as it would manage a non-communication stream by using the Core Audio APIs.</span></span>

<span data-ttu-id="d21dd-125">Um dos recursos que você pode integrar em seu aplicativo de comunicação é o *patoing* ou a *atenuação de fluxo*.</span><span class="sxs-lookup"><span data-stu-id="d21dd-125">One of the features that you can integrate in your communication application is *ducking* or *stream attenuation*.</span></span> <span data-ttu-id="d21dd-126">Esse comportamento define o que deve acontecer com outros sons quando um fluxo de comunicação é aberto, por exemplo, quando uma chamada telefônica é recebida no dispositivo de comunicação.</span><span class="sxs-lookup"><span data-stu-id="d21dd-126">This behavior defines what must happen to other sounds when a communication stream is opened, such as when a phone call is received on the communication device.</span></span> <span data-ttu-id="d21dd-127">O sistema pode desativar ou reduzir o volume de áudio do fluxo de não comunicação, dependendo da escolha do usuário.</span><span class="sxs-lookup"><span data-stu-id="d21dd-127">The system might mute or lower the audio volume of the non-communication stream depending on the user's choice.</span></span> <span data-ttu-id="d21dd-128">O sistema de áudio gera eventos de pato quando um fluxo de comunicação é aberto ou fechado para renderização ou captura de fluxos.</span><span class="sxs-lookup"><span data-stu-id="d21dd-128">The audio system generates ducking events when a communication stream is opened or closed for rendering or capturing streams.</span></span> <span data-ttu-id="d21dd-129">Por padrão, o sistema operacional fornece uma experiência de pato padrão.</span><span class="sxs-lookup"><span data-stu-id="d21dd-129">By default, the operating system provides a default ducking experience.</span></span> <span data-ttu-id="d21dd-130">Um aplicativo de mídia pode substituir o comportamento padrão e lidar com esses eventos para fornecer uma experiência personalizada de pato.</span><span class="sxs-lookup"><span data-stu-id="d21dd-130">A media application can replace the default behavior and handle these events itself to provide a customized ducking experience.</span></span>

<span data-ttu-id="d21dd-131">As seções a seguir descrevem como usar as APIs de áudio de núcleo para fornecer uma experiência personalizada de pato.</span><span class="sxs-lookup"><span data-stu-id="d21dd-131">The following sections describe how to use Core Audio APIs to provide a custom ducking experience.</span></span>

-   [<span data-ttu-id="d21dd-132">Experiência de pato padrão</span><span class="sxs-lookup"><span data-stu-id="d21dd-132">Default Ducking Experience</span></span>](stream-attenuation.md)
-   [<span data-ttu-id="d21dd-133">Desabilitando a experiência de pato padrão</span><span class="sxs-lookup"><span data-stu-id="d21dd-133">Disabling the Default Ducking Experience</span></span>](disabling-the-ducking-experience.md)
-   [<span data-ttu-id="d21dd-134">Fornecendo um comportamento personalizado de pato</span><span class="sxs-lookup"><span data-stu-id="d21dd-134">Providing a Custom Ducking Behavior</span></span>](providing-a-custom-ducking-experience.md)
-   [<span data-ttu-id="d21dd-135">Considerações de implementação para notificações de pato</span><span class="sxs-lookup"><span data-stu-id="d21dd-135">Implementation Considerations for Ducking Notifications</span></span>](handling-audio-ducking-events-from-communication-devices.md)
-   [<span data-ttu-id="d21dd-136">Obtendo eventos de pato</span><span class="sxs-lookup"><span data-stu-id="d21dd-136">Getting Ducking Events</span></span>](getting-ducking-events-from-a-communication-device.md)

### <a name="getting-a-reference-to-the-communication-device-endpoint"></a><span data-ttu-id="d21dd-137">Obtendo uma referência para o ponto de extremidade do dispositivo de comunicação</span><span class="sxs-lookup"><span data-stu-id="d21dd-137">Getting a Reference to the Communication Device Endpoint</span></span>

<span data-ttu-id="d21dd-138">Para usar o dispositivo de comunicação, um cliente WASAPI direto deve enumerar os dispositivos usando o enumerador de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d21dd-138">To use the communication device, a direct WASAPI client must enumerate the devices by using the device enumerator.</span></span> <span data-ttu-id="d21dd-139">Obtenha uma referência para o ponto de extremidade do dispositivo de comunicação padrão chamando [**IMMDeviceEnumerator:: GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span><span class="sxs-lookup"><span data-stu-id="d21dd-139">Get a reference to the endpoint of the default communication device by calling [**IMMDeviceEnumerator::GetDefaultAudioEndpoint**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-getdefaultaudioendpoint).</span></span> <span data-ttu-id="d21dd-140">Nesta chamada, o aplicativo deve especificar **eCommunications** no parâmetro de *função* para restringir a enumeração do dispositivo a dispositivos de comunicação.</span><span class="sxs-lookup"><span data-stu-id="d21dd-140">In this call, the application must specify **eCommunications** in the *Role* parameter to restrict the device enumeration to communication devices.</span></span> <span data-ttu-id="d21dd-141">Depois de obter uma referência ao ponto de extremidade do dispositivo para o dispositivo, você pode ativar os serviços que têm o escopo definido para o ponto de extremidade chamando [**IMMDevice:: Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate).</span><span class="sxs-lookup"><span data-stu-id="d21dd-141">After you get a reference to the device endpoint for the device, you can activate the services that are scoped for the endpoint by calling [**IMMDevice::Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate).</span></span> <span data-ttu-id="d21dd-142">Por exemplo, você pode passar o identificador de serviço **\_ IAudioClient de IID** para ativar um objeto de cliente de áudio e usá-lo para o gerenciamento de fluxo, o identificador **\_ IAudioEndpointVolume de IID** para obter acesso aos controles de volume do ponto de extremidade do dispositivo de comunicação ou o identificador **\_ IAudioSessionManager do IID** para ativar o Gerenciador de sessão que permite que você interaja com o mecanismo de política do ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="d21dd-142">For example, you can pass the **IID\_IAudioClient** service identifier to activate an audio client object and use it for stream management, the **IID\_IAudioEndpointVolume** identifier to get access to the volume controls of the communication device endpoint, or the **IID\_IAudioSessionManager** identifier to activate the session manager that enables you to interact with the policy engine of the endpoint.</span></span> <span data-ttu-id="d21dd-143">Para obter informações sobre operações de fluxo, consulte [Gerenciamento de fluxo](stream-management.md).</span><span class="sxs-lookup"><span data-stu-id="d21dd-143">For information about stream operations, see [Stream Management](stream-management.md).</span></span>

<span data-ttu-id="d21dd-144">Usando a referência [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) , você também pode acessar o repositório de propriedades para o ponto de extremidade do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="d21dd-144">By using the [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) reference, you can also access the property store for the device endpoint.</span></span> <span data-ttu-id="d21dd-145">Esses valores de propriedade, como nome amigável do dispositivo e nome do fabricante, são preenchidos pelo OEM e permitem que um aplicativo determine as características de um dispositivo de comunicação.</span><span class="sxs-lookup"><span data-stu-id="d21dd-145">These property values, such as device friendly name and manufacturer name, are populated by the OEM and enable an application to determine the characteristics of a communication device.</span></span> <span data-ttu-id="d21dd-146">Para obter mais informações, consulte [Propriedades do dispositivo](device-properties.md).</span><span class="sxs-lookup"><span data-stu-id="d21dd-146">For more information, see [Device Properties](device-properties.md).</span></span>

<span data-ttu-id="d21dd-147">O código de exemplo a seguir obtém uma referência ao ponto de extremidade do dispositivo de comunicação padrão para renderizar um fluxo de áudio.</span><span class="sxs-lookup"><span data-stu-id="d21dd-147">The following example code gets a reference to the endpoint of the default communication device for rendering an audio stream.</span></span>


```C++
IMMDevice *defaultDevice = NULL;

hr = CoCreateInstance(__uuidof(MMDeviceEnumerator), NULL,
            CLSCTX_INPROC_SERVER, 
            __uuidof(IMMDeviceEnumerator), 
            (LPVOID *)&deviceEnumerator);

hr = deviceEnumerator->GetDefaultAudioEndpoint(eRender, 
            eCommunications, &defaultDevice);
```



## <a name="related-topics"></a><span data-ttu-id="d21dd-148">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="d21dd-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d21dd-149">Gerenciamento de fluxo</span><span class="sxs-lookup"><span data-stu-id="d21dd-149">Stream Management</span></span>](stream-management.md)
</dt> </dl>

 

 



