---
description: Enumerando dispositivos de áudio
ms.assetid: 20110ffc-5eff-4279-abea-53115803b6ee
title: Enumerando dispositivos de áudio
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 707b9a88181c83344757c711af1c0199c19ebc16
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104010215"
---
# <a name="enumerating-audio-devices"></a><span data-ttu-id="31e38-103">Enumerando dispositivos de áudio</span><span class="sxs-lookup"><span data-stu-id="31e38-103">Enumerating Audio Devices</span></span>

<span data-ttu-id="31e38-104">A primeira tarefa de um aplicativo de áudio de cliente é encontrar um dispositivo de áudio adequado para uso.</span><span class="sxs-lookup"><span data-stu-id="31e38-104">The first task of a client audio application is to find a suitable audio device to use.</span></span> <span data-ttu-id="31e38-105">A [API MMDevice](mmdevice-api.md) permite que os clientes descubram os [dispositivos de ponto de extremidade de áudio](audio-endpoint-devices.md) no sistema e determine quais dispositivos são adequados para o aplicativo usar.</span><span class="sxs-lookup"><span data-stu-id="31e38-105">The [MMDevice API](mmdevice-api.md) lets clients discover the [audio endpoint devices](audio-endpoint-devices.md) in the system and determine which devices are suitable for the application to use.</span></span> <span data-ttu-id="31e38-106">Essa API permite que os clientes recuperem coleções dos dispositivos de ponto de extremidade disponíveis e obtenham os recursos de cada dispositivo.</span><span class="sxs-lookup"><span data-stu-id="31e38-106">This API enables clients to retrieve collections of the available endpoint devices and get the capabilities of each device.</span></span> <span data-ttu-id="31e38-107">O arquivo de cabeçalho Mmdeviceapi. h define as interfaces na API MMDevice.</span><span class="sxs-lookup"><span data-stu-id="31e38-107">Header file Mmdeviceapi.h defines the interfaces in the MMDevice API.</span></span>

<span data-ttu-id="31e38-108">Um adaptador de áudio pode conter vários dispositivos — por exemplo, um dispositivo de processamento de ondas e um dispositivo de captura de onda.</span><span class="sxs-lookup"><span data-stu-id="31e38-108">An audio adapter might contain several devices—for example, a wave-rendering device and a wave-capture device.</span></span> <span data-ttu-id="31e38-109">Esses são dispositivos de adaptador em vez de dispositivos de ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="31e38-109">These are adapter devices rather than endpoint devices.</span></span> <span data-ttu-id="31e38-110">Conforme mencionado anteriormente, os dispositivos de adaptador são registrados pelo Gerenciador de Plug and Play, em comparação com os dispositivos de ponto de extremidade, que são registrados pelo Gerenciador de pontos de extremidade.</span><span class="sxs-lookup"><span data-stu-id="31e38-110">As mentioned previously, adapter devices are registered by the Plug and Play manager, in contrast with endpoint devices, which are registered by the endpoint manager.</span></span> <span data-ttu-id="31e38-111">Normalmente, cada dispositivo de adaptador dá suporte a um ou mais dispositivos de ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="31e38-111">Each adapter device typically supports one or more endpoint devices.</span></span> <span data-ttu-id="31e38-112">Um dispositivo de ponto de extremidade de renderização (por exemplo, fones de ouvido) pode receber um fluxo de dados de áudio de um aplicativo cliente e um dispositivo de ponto de extremidade de captura (por exemplo, um microfone) pode enviar um fluxo de áudio para um aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="31e38-112">A rendering endpoint device (for example, headphones) can receive a stream of audio data from a client application, and a capture endpoint device (for example, a microphone) can send an audio stream to a client application.</span></span>

<span data-ttu-id="31e38-113">Antes de enumerar os dispositivos de ponto de extremidade no sistema, o cliente deve primeiro chamar a função [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) do Windows para criar um enumerador de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="31e38-113">Before enumerating the endpoint devices in the system, the client must first call the Windows [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function to create a device enumerator.</span></span> <span data-ttu-id="31e38-114">Um enumerador de dispositivo é um objeto com uma interface [**IMMDeviceEnumerator**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdeviceenumerator) .</span><span class="sxs-lookup"><span data-stu-id="31e38-114">A device enumerator is an object with an [**IMMDeviceEnumerator**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdeviceenumerator) interface.</span></span> <span data-ttu-id="31e38-115">Para obter informações sobre **CoCreateInstance**, consulte a documentação do SDK do Windows.</span><span class="sxs-lookup"><span data-stu-id="31e38-115">For information about **CoCreateInstance**, see the Windows SDK documentation.</span></span>

<span data-ttu-id="31e38-116">O cliente chama o método [**IMMDeviceEnumerator:: EnumAudioEndpoints**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-enumaudioendpoints) para criar uma coleção de objetos de ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="31e38-116">The client calls the [**IMMDeviceEnumerator::EnumAudioEndpoints**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdeviceenumerator-enumaudioendpoints) method to create a collection of endpoint objects.</span></span> <span data-ttu-id="31e38-117">Cada objeto de ponto de extremidade representa um dispositivo de ponto de extremidade de áudio no sistema.</span><span class="sxs-lookup"><span data-stu-id="31e38-117">Each endpoint object represents an audio endpoint device in the system.</span></span> <span data-ttu-id="31e38-118">Nesta chamada, o cliente especifica se a coleção deve conter todos os dispositivos de renderização no sistema, todos os dispositivos de captura ou ambos.</span><span class="sxs-lookup"><span data-stu-id="31e38-118">In this call, the client specifies whether the collection should contain all of the rendering devices in the system, all of the capture devices, or both.</span></span>

<span data-ttu-id="31e38-119">Uma coleção de dispositivos é um objeto com uma interface [**IMMDeviceCollection**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevicecollection) .</span><span class="sxs-lookup"><span data-stu-id="31e38-119">A device collection is an object with an [**IMMDeviceCollection**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevicecollection) interface.</span></span> <span data-ttu-id="31e38-120">Cada item em uma coleção de dispositivos é um objeto de ponto de extremidade com pelo menos as duas interfaces a seguir:</span><span class="sxs-lookup"><span data-stu-id="31e38-120">Each item in a device collection is an endpoint object with at least the following two interfaces:</span></span>

-   <span data-ttu-id="31e38-121">Uma interface [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) .</span><span class="sxs-lookup"><span data-stu-id="31e38-121">An [**IMMDevice**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immdevice) interface.</span></span> <span data-ttu-id="31e38-122">Um cliente obtém uma referência à interface **IMMDevice** de um objeto de ponto de extremidade em uma coleção de dispositivos chamando o método [**IMMDeviceCollection:: item**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevicecollection-item) .</span><span class="sxs-lookup"><span data-stu-id="31e38-122">A client obtains a reference to the **IMMDevice** interface of an endpoint object in a device collection by calling the [**IMMDeviceCollection::Item**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevicecollection-item) method.</span></span>
-   <span data-ttu-id="31e38-123">Uma interface [**IMMEndpoint**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immendpoint) .</span><span class="sxs-lookup"><span data-stu-id="31e38-123">An [**IMMEndpoint**](/windows/desktop/api/Mmdeviceapi/nn-mmdeviceapi-immendpoint) interface.</span></span> <span data-ttu-id="31e38-124">Um cliente obtém uma referência à interface **IMMEndpoint** de um objeto de ponto de extremidade chamando o método [**IMMDevice:: QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) .</span><span class="sxs-lookup"><span data-stu-id="31e38-124">A client obtains a reference to the **IMMEndpoint** interface of an endpoint object by calling the [**IMMDevice::QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) method.</span></span>

<span data-ttu-id="31e38-125">Depois de recuperar uma coleção de dispositivos de ponto de extremidade, o cliente pode consultar as propriedades dos dispositivos individuais na coleção para determinar sua adequação para uso.</span><span class="sxs-lookup"><span data-stu-id="31e38-125">After retrieving a collection of endpoint devices, the client can query the properties of the individual devices in the collection to determine their suitability for use.</span></span> <span data-ttu-id="31e38-126">Para obter um exemplo de código que mostra como enumerar dispositivos de ponto de extremidade e consultar suas propriedades, consulte [Propriedades do dispositivo](device-properties.md).</span><span class="sxs-lookup"><span data-stu-id="31e38-126">For a code example that shows how to enumerate endpoint devices and query their properties, see [Device Properties](device-properties.md).</span></span>

<span data-ttu-id="31e38-127">Depois de selecionar um dispositivo adequado, o cliente pode chamar o método [**IMMDevice:: Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate) para ativar as interfaces específicas do dispositivo no [WASAPI](wasapi.md), a [API do DeviceTopology](devicetopology-api.md)e a API do [EndpointVolume](endpointvolume-api.md).</span><span class="sxs-lookup"><span data-stu-id="31e38-127">After selecting a suitable device, the client can call the [**IMMDevice::Activate**](/windows/desktop/api/Mmdeviceapi/nf-mmdeviceapi-immdevice-activate) method to activate the device-specific interfaces in [WASAPI](wasapi.md), the [DeviceTopology API](devicetopology-api.md), and the [EndpointVolume API](endpointvolume-api.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="31e38-128">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="31e38-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="31e38-129">Dispositivos de ponto de extremidade de áudio</span><span class="sxs-lookup"><span data-stu-id="31e38-129">Audio Endpoint Devices</span></span>](audio-endpoint-devices.md)
</dt> </dl>

 

 
