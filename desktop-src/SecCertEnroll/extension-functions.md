---
description: O formato de certificado X. 509 versão 3 identifica várias extensões que podem ser adicionadas a um certificado para fornecer informações aprimoradas sobre o uso de chave, políticas de certificado e restrições, formulários de nomes alternativos e muito mais.
ms.assetid: d53107b7-a153-41cf-9876-1d28aaf99816
title: Funções de extensão
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4bc490c8763a00fae9e7fb1e8a702ff87e2c18fd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105761401"
---
# <a name="extension-functions"></a><span data-ttu-id="8d349-103">Funções de extensão</span><span class="sxs-lookup"><span data-stu-id="8d349-103">Extension Functions</span></span>

<span data-ttu-id="8d349-104">O formato de certificado [*X. 509*](/windows/desktop/SecGloss/x-gly) versão 3 identifica várias extensões que podem ser adicionadas a um certificado para fornecer informações aprimoradas sobre o uso de chave, políticas de certificado e restrições, formulários de nomes alternativos e muito mais.</span><span class="sxs-lookup"><span data-stu-id="8d349-104">The [*X.509*](/windows/desktop/SecGloss/x-gly) version 3 certificate format identifies multiple extensions that can be added to a certificate to provide enhanced information about key usage, certificate policies and constraints, alternative name forms, and more.</span></span>

<span data-ttu-id="8d349-105">CertEnroll.dll implementa as seguintes interfaces para gerenciar as extensões de certificado:</span><span class="sxs-lookup"><span data-stu-id="8d349-105">CertEnroll.dll implements the following interfaces to manage certificate extensions:</span></span>

-   [<span data-ttu-id="8d349-106">**IX509Extension**</span><span class="sxs-lookup"><span data-stu-id="8d349-106">**IX509Extension**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension)
-   [<span data-ttu-id="8d349-107">**IX509Extensions**</span><span class="sxs-lookup"><span data-stu-id="8d349-107">**IX509Extensions**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions)
-   [<span data-ttu-id="8d349-108">**IX509ExtensionAlternativeNames**</span><span class="sxs-lookup"><span data-stu-id="8d349-108">**IX509ExtensionAlternativeNames**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionalternativenames)
-   [<span data-ttu-id="8d349-109">**IX509ExtensionAuthorityKeyIdentifier**</span><span class="sxs-lookup"><span data-stu-id="8d349-109">**IX509ExtensionAuthorityKeyIdentifier**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionauthoritykeyidentifier)
-   [<span data-ttu-id="8d349-110">**IX509ExtensionBasicConstraints**</span><span class="sxs-lookup"><span data-stu-id="8d349-110">**IX509ExtensionBasicConstraints**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionbasicconstraints)
-   [<span data-ttu-id="8d349-111">**IX509ExtensionCertificatePolicies**</span><span class="sxs-lookup"><span data-stu-id="8d349-111">**IX509ExtensionCertificatePolicies**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensioncertificatepolicies)
-   [<span data-ttu-id="8d349-112">**IX509ExtensionEnhancedKeyUsage**</span><span class="sxs-lookup"><span data-stu-id="8d349-112">**IX509ExtensionEnhancedKeyUsage**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionenhancedkeyusage)
-   [<span data-ttu-id="8d349-113">**IX509ExtensionKeyUsage**</span><span class="sxs-lookup"><span data-stu-id="8d349-113">**IX509ExtensionKeyUsage**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionkeyusage)
-   [<span data-ttu-id="8d349-114">**IX509ExtensionMSApplicationPolicies**</span><span class="sxs-lookup"><span data-stu-id="8d349-114">**IX509ExtensionMSApplicationPolicies**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionmsapplicationpolicies)
-   [<span data-ttu-id="8d349-115">**IX509ExtensionSmimeCapabilities**</span><span class="sxs-lookup"><span data-stu-id="8d349-115">**IX509ExtensionSmimeCapabilities**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsmimecapabilities)
-   [<span data-ttu-id="8d349-116">**IX509ExtensionSubjectKeyIdentifier**</span><span class="sxs-lookup"><span data-stu-id="8d349-116">**IX509ExtensionSubjectKeyIdentifier**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier)
-   [<span data-ttu-id="8d349-117">**IX509ExtensionTemplate**</span><span class="sxs-lookup"><span data-stu-id="8d349-117">**IX509ExtensionTemplate**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplate)
-   [<span data-ttu-id="8d349-118">**IX509ExtensionTemplateName**</span><span class="sxs-lookup"><span data-stu-id="8d349-118">**IX509ExtensionTemplateName**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename)

<span data-ttu-id="8d349-119">Cada uma das seções a seguir discute uma função exportada por Xenroll.dll para gerenciar as extensões de certificado.</span><span class="sxs-lookup"><span data-stu-id="8d349-119">Each of the following sections discusses a function exported by Xenroll.dll to manage certificate extensions.</span></span> <span data-ttu-id="8d349-120">Cada seção também aborda como usar CertEnroll.dll para substituir a função ou indica que não existe nenhum mapeamento entre as duas bibliotecas:</span><span class="sxs-lookup"><span data-stu-id="8d349-120">Each section also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="8d349-121">AddCertTypeToRequestWStr</span><span class="sxs-lookup"><span data-stu-id="8d349-121">AddCertTypeToRequestWStr</span></span>](#addcerttypetorequestwstr)
-   [<span data-ttu-id="8d349-122">AddCertTypeToRequestWStrEx</span><span class="sxs-lookup"><span data-stu-id="8d349-122">AddCertTypeToRequestWStrEx</span></span>](#addcerttypetorequestwstrex)
-   [<span data-ttu-id="8d349-123">AddExtensionsToRequest</span><span class="sxs-lookup"><span data-stu-id="8d349-123">AddExtensionsToRequest</span></span>](#addextensionstorequest)
-   [<span data-ttu-id="8d349-124">addExtensionToRequestWStr</span><span class="sxs-lookup"><span data-stu-id="8d349-124">addExtensionToRequestWStr</span></span>](#addextensiontorequestwstr)
-   [<span data-ttu-id="8d349-125">EnableSMIMECapabilities</span><span class="sxs-lookup"><span data-stu-id="8d349-125">EnableSMIMECapabilities</span></span>](#enablesmimecapabilities)
-   [<span data-ttu-id="8d349-126">IncludeSubjectKeyID</span><span class="sxs-lookup"><span data-stu-id="8d349-126">IncludeSubjectKeyID</span></span>](#includesubjectkeyid)
-   [<span data-ttu-id="8d349-127">resetExtensions</span><span class="sxs-lookup"><span data-stu-id="8d349-127">resetExtensions</span></span>](#resetextensions)
-   [<span data-ttu-id="8d349-128">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="8d349-128">Related topics</span></span>](#related-topics)

## <a name="addcerttypetorequestwstr"></a><span data-ttu-id="8d349-129">AddCertTypeToRequestWStr</span><span class="sxs-lookup"><span data-stu-id="8d349-129">AddCertTypeToRequestWStr</span></span>

<span data-ttu-id="8d349-130">A função [**AddCertTypeToRequestWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addcerttypetorequestwstr) no Xenroll.dll adiciona um modelo de certificado, por nome, a uma solicitação.</span><span class="sxs-lookup"><span data-stu-id="8d349-130">The [**AddCertTypeToRequestWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addcerttypetorequestwstr) function in Xenroll.dll adds a certificate template, by name, to a request.</span></span>

<span data-ttu-id="8d349-131">Usando CertEnroll.dll, o método preferencial para incorporar um modelo a uma solicitação de certificado é usar o método [**InitializeFromTemplateName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromtemplatename) em um \# objeto de solicitação PKCS 10 ou [\* Pkcs) ou o método [**INITIALIZEFROMINNERREQUESTTEMPLATENAME**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-initializefrominnerrequesttemplatename) em uma solicitação CMC.</span><span class="sxs-lookup"><span data-stu-id="8d349-131">Using CertEnroll.dll, the preferred method to incorporate a template into a certificate request is to use the [**InitializeFromTemplateName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-initializefromtemplatename) method on a PKCS\#10 or [\*PKCS ) request object or the [**InitializeFromInnerRequestTemplateName**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestcmc-initializefrominnerrequesttemplatename) method on a CMC request.</span></span>

<span data-ttu-id="8d349-132">Se um modelo específico não estiver disponível no cliente, mas for esperado que seja compreendido pela [*autoridade de certificação*](/windows/desktop/SecGloss/c-gly) (CA), você poderá usar a interface [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) para adicionar um modelo de versão 1 ou pode usar a interface [**IX509ExtensionTemplate**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplate) para adicionar um modelo de versão 2 a uma solicitação de certificado.</span><span class="sxs-lookup"><span data-stu-id="8d349-132">If a specific template is not available on the client but is expected to be understood by the [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA), you can use the [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) interface to add a version 1 template or you can use the [**IX509ExtensionTemplate**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplate) interface to add a version 2 template to a certificate request.</span></span> <span data-ttu-id="8d349-133">Por exemplo, para adicionar um modelo de versão 1, execute as seguintes ações:</span><span class="sxs-lookup"><span data-stu-id="8d349-133">For example, to add a version 1 template, perform the following actions:</span></span>

1.  <span data-ttu-id="8d349-134">Crie um objeto [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) .</span><span class="sxs-lookup"><span data-stu-id="8d349-134">Create an [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) object.</span></span>
2.  <span data-ttu-id="8d349-135">Crie um objeto [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) e chame o método [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensiontemplatename-initializeencode) , especificando o nome do modelo.</span><span class="sxs-lookup"><span data-stu-id="8d349-135">Create an [**IX509ExtensionTemplateName**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensiontemplatename) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensiontemplatename-initializeencode) method, specifying the template name.</span></span>
3.  <span data-ttu-id="8d349-136">Adicione a extensão criada à coleção [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) chamando o método [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) .</span><span class="sxs-lookup"><span data-stu-id="8d349-136">Add the extension created to the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection by calling the [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) method.</span></span>
4.  <span data-ttu-id="8d349-137">Crie um objeto [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) e chame o método [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) , especificando a coleção [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) na entrada.</span><span class="sxs-lookup"><span data-stu-id="8d349-137">Create an [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) method, specifying the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection on input.</span></span>
5.  <span data-ttu-id="8d349-138">Recupere um objeto de coleção [**ICryptAttributes**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes) chamando a propriedade [**cript**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes) . de um objeto de solicitação [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) ou [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) existente.</span><span class="sxs-lookup"><span data-stu-id="8d349-138">Retrieve an [**ICryptAttributes**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes) collection object by calling the [**CryptAttributes**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes) property on an existing [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) or [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) request object.</span></span>

## <a name="addcerttypetorequestwstrex"></a><span data-ttu-id="8d349-139">AddCertTypeToRequestWStrEx</span><span class="sxs-lookup"><span data-stu-id="8d349-139">AddCertTypeToRequestWStrEx</span></span>

<span data-ttu-id="8d349-140">A função [**AddCertTypeToRequestWStrEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addcerttypetorequestwstrex) no Xenroll.dll adiciona um modelo de certificado a uma solicitação por nome, identificador de objeto e versão.</span><span class="sxs-lookup"><span data-stu-id="8d349-140">The [**AddCertTypeToRequestWStrEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addcerttypetorequestwstrex) function in Xenroll.dll adds a certificate template to a request by name, object identifier, and version.</span></span>

<span data-ttu-id="8d349-141">Para obter informações sobre como usar CertEnroll.dll para incorporar informações de modelo em uma solicitação, consulte AddCertTypeToRequestWStr.</span><span class="sxs-lookup"><span data-stu-id="8d349-141">For information about how to use CertEnroll.dll to incorporate template information in a request, see AddCertTypeToRequestWStr.</span></span>

## <a name="addextensionstorequest"></a><span data-ttu-id="8d349-142">AddExtensionsToRequest</span><span class="sxs-lookup"><span data-stu-id="8d349-142">AddExtensionsToRequest</span></span>

<span data-ttu-id="8d349-143">A função [**AddExtensionsToRequest**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addextensionstorequest) no Xenroll.dll adiciona uma coleção de extensões a uma solicitação.</span><span class="sxs-lookup"><span data-stu-id="8d349-143">The [**AddExtensionsToRequest**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-addextensionstorequest) function in Xenroll.dll adds a collection of extensions to a request.</span></span>

<span data-ttu-id="8d349-144">No CertEnroll.dll, as extensões são adicionadas à coleção Attributes de uma solicitação CMC ou PKCS \# 10.</span><span class="sxs-lookup"><span data-stu-id="8d349-144">In CertEnroll.dll, extensions are added to the attributes collection of a CMC or a PKCS \#10 request.</span></span> <span data-ttu-id="8d349-145">Para adicionar extensões, execute as seguintes ações:</span><span class="sxs-lookup"><span data-stu-id="8d349-145">To add extensions, perform the following actions:</span></span>

1.  <span data-ttu-id="8d349-146">Crie um objeto [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) .</span><span class="sxs-lookup"><span data-stu-id="8d349-146">Create an [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) object.</span></span>
2.  <span data-ttu-id="8d349-147">Crie um objeto [**IX509Extension**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension) e chame o método [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extension-initialize) para criar uma extensão a partir de um identificador de objeto e um valor de extensão ou use qualquer uma das interfaces listadas anteriormente para definir uma das extensões mais comuns.</span><span class="sxs-lookup"><span data-stu-id="8d349-147">Create an [**IX509Extension**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension) object and call the [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extension-initialize) method to create an extension from an object identifier and extension value or use any of the interfaces listed earlier to define one of the more common extensions.</span></span>
3.  <span data-ttu-id="8d349-148">Adicione cada nova extensão criada na etapa anterior à coleção [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) chamando o método [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) .</span><span class="sxs-lookup"><span data-stu-id="8d349-148">Add each new extension created in the preceding step to the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection by calling the [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) method.</span></span>

## <a name="addextensiontorequestwstr"></a><span data-ttu-id="8d349-149">addExtensionToRequestWStr</span><span class="sxs-lookup"><span data-stu-id="8d349-149">addExtensionToRequestWStr</span></span>

<span data-ttu-id="8d349-150">A função [**addExtensionToRequestWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addextensiontorequestwstr) no Xenroll.dll adiciona uma extensão específica à solicitação.</span><span class="sxs-lookup"><span data-stu-id="8d349-150">The [**addExtensionToRequestWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-addextensiontorequestwstr) function in Xenroll.dll adds a specific extension to the request.</span></span>

<span data-ttu-id="8d349-151">No CertEnroll.dll, uma extensão específica deve ser definida e adicionada a uma coleção de extensões antes que a coleção de extensão seja adicionada à coleção de atributos de uma solicitação CMC ou PKCS \# 10.</span><span class="sxs-lookup"><span data-stu-id="8d349-151">In CertEnroll.dll, a specific extension must be defined and added to an extensions collection before the extension collection is added to the attributes collection of a CMC or a PKCS \#10 request.</span></span> <span data-ttu-id="8d349-152">Para obter mais informações, consulte a discussão sobre o AddExtensionsToRequest acima.</span><span class="sxs-lookup"><span data-stu-id="8d349-152">For more information see the AddExtensionsToRequest discussion above.</span></span>

## <a name="enablesmimecapabilities"></a><span data-ttu-id="8d349-153">EnableSMIMECapabilities</span><span class="sxs-lookup"><span data-stu-id="8d349-153">EnableSMIMECapabilities</span></span>

<span data-ttu-id="8d349-154">A função [**EnableSMIMECapabilities**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_enablesmimecapabilities) em Xenroll.dll especifica ou recupera um valor booliano que indica se a extensão **SMIMECapabilities** deve ser adicionada à solicitação.</span><span class="sxs-lookup"><span data-stu-id="8d349-154">The [**EnableSMIMECapabilities**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-get_enablesmimecapabilities) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether to add the **SMIMECapabilities** extension to the request.</span></span>

<span data-ttu-id="8d349-155">Você pode chamar a propriedade [**SmimeCapabilities**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_smimecapabilities) no objeto [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) para adicionar automaticamente um objeto [**IX509ExtensionSmimeCapabilities**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsmimecapabilities) à solicitação antes da codificação.</span><span class="sxs-lookup"><span data-stu-id="8d349-155">You can call the [**SmimeCapabilities**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_smimecapabilities) property on the [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) object to automatically add an [**IX509ExtensionSmimeCapabilities**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsmimecapabilities) object to the request before encoding.</span></span>

## <a name="includesubjectkeyid"></a><span data-ttu-id="8d349-156">IncludeSubjectKeyID</span><span class="sxs-lookup"><span data-stu-id="8d349-156">IncludeSubjectKeyID</span></span>

<span data-ttu-id="8d349-157">A função [**IncludeSubjectKeyID**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-get_includesubjectkeyid) em Xenroll.dll especifica ou recupera um valor booliano que indica se a extensão **SubjectKeyIdentifier** deve ser adicionada à solicitação.</span><span class="sxs-lookup"><span data-stu-id="8d349-157">The [**IncludeSubjectKeyID**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-get_includesubjectkeyid) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether to add the **SubjectKeyIdentifier** extension to the request.</span></span>

<span data-ttu-id="8d349-158">Por padrão, a extensão **SubjectKeyIdentifier** é criada quando o objeto de solicitação [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) é inicializado.</span><span class="sxs-lookup"><span data-stu-id="8d349-158">By default, the **SubjectKeyIdentifier** extension is created when the [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) request object is initialized.</span></span> <span data-ttu-id="8d349-159">Você pode substituir esse comportamento chamando a propriedade [**SuppressOids**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_suppressoids) .</span><span class="sxs-lookup"><span data-stu-id="8d349-159">You can override this behavior by calling the [**SuppressOids**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_suppressoids) property.</span></span>

<span data-ttu-id="8d349-160">Se você tiver um [*par de chaves pública/privada*](/windows/desktop/SecGloss/p-gly), também poderá usar a interface [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) em CertEnroll.dll para adicionar uma extensão **SubjectKeyIdentifier** a uma solicitação de certificado executando as seguintes ações:</span><span class="sxs-lookup"><span data-stu-id="8d349-160">If you have a [*public/private key pair*](/windows/desktop/SecGloss/p-gly), you can also use the [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) interface in CertEnroll.dll to add a **SubjectKeyIdentifier** extension to a certificate request by performing the following actions:</span></span>

1.  <span data-ttu-id="8d349-161">Crie um objeto [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) .</span><span class="sxs-lookup"><span data-stu-id="8d349-161">Create an [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) object.</span></span>
2.  <span data-ttu-id="8d349-162">Crie um objeto [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) e chame o método [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensionsubjectkeyidentifier-initializeencode) , especificando uma cadeia de caracteres que contém o identificador.</span><span class="sxs-lookup"><span data-stu-id="8d349-162">Create an [**IX509ExtensionSubjectKeyIdentifier**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensionsubjectkeyidentifier) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensionsubjectkeyidentifier-initializeencode) method, specifying a string that contains the identifier.</span></span> <span data-ttu-id="8d349-163">Normalmente, esse é um hash SHA-1 de 20 bytes da [*chave pública*](/windows/desktop/SecGloss/p-gly) contida no certificado de autenticação da autoridade de certificação.</span><span class="sxs-lookup"><span data-stu-id="8d349-163">Typically, this is a 20-byte SHA-1 hash of the [*public key*](/windows/desktop/SecGloss/p-gly) contained in the CA signing certificate.</span></span>
3.  <span data-ttu-id="8d349-164">Adicione a extensão criada à coleção [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) chamando o método [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) .</span><span class="sxs-lookup"><span data-stu-id="8d349-164">Add the extension created to the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection by calling the [**Add**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-add) method.</span></span>
4.  <span data-ttu-id="8d349-165">Crie um objeto [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) e chame o método [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) , especificando a coleção [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) na entrada.</span><span class="sxs-lookup"><span data-stu-id="8d349-165">Create an [**IX509AttributeExtensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509attributeextensions) object and call the [**InitializeEncode**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509attributeextensions-initializeencode) method, specifying the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection on input.</span></span>
5.  <span data-ttu-id="8d349-166">Recupere um objeto de coleção [**ICryptAttributes**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes) chamando a propriedade [**cript**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes) . de um objeto de solicitação [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) ou [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) existente.</span><span class="sxs-lookup"><span data-stu-id="8d349-166">Retrieve an [**ICryptAttributes**](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes) collection object by calling the [**CryptAttributes**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509certificaterequestpkcs10-get_cryptattributes) property on an existing [**IX509CertificateRequestPkcs10**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestpkcs10) or [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) request object.</span></span>

## <a name="resetextensions"></a><span data-ttu-id="8d349-167">resetExtensions</span><span class="sxs-lookup"><span data-stu-id="8d349-167">resetExtensions</span></span>

<span data-ttu-id="8d349-168">A função [**resetExtensions**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-resetextensions) no Xenroll.dll remove a coleção de extensão da solicitação.</span><span class="sxs-lookup"><span data-stu-id="8d349-168">The [**resetExtensions**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-resetextensions) function in Xenroll.dll removes the extension collection from the request.</span></span>

<span data-ttu-id="8d349-169">Para remover uma extensão de uma solicitação por número de índice usando CertEnroll.dll, chame o método [**Remove**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-remove) na coleção [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) .</span><span class="sxs-lookup"><span data-stu-id="8d349-169">To remove an extension from a request by index number using CertEnroll.dll, call the [**Remove**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-remove) method on the [**IX509Extensions**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions) collection.</span></span> <span data-ttu-id="8d349-170">Para remover todos os atributos de uma solicitação, chame o método [**Clear**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-clear) .</span><span class="sxs-lookup"><span data-stu-id="8d349-170">To remove all attributes from a request, call the [**Clear**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509extensions-clear) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8d349-171">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="8d349-171">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="8d349-172">Mapeando Xenroll.dll para CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="8d349-172">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> <dt>

[<span data-ttu-id="8d349-173">**ICryptAttributes**</span><span class="sxs-lookup"><span data-stu-id="8d349-173">**ICryptAttributes**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-icryptattributes)
</dt> <dt>

[<span data-ttu-id="8d349-174">**IX509Extension**</span><span class="sxs-lookup"><span data-stu-id="8d349-174">**IX509Extension**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extension)
</dt> <dt>

[<span data-ttu-id="8d349-175">**IX509Extensions**</span><span class="sxs-lookup"><span data-stu-id="8d349-175">**IX509Extensions**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509extensions)
</dt> </dl>

 

 
