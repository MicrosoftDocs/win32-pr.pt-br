---
description: Implementa a interface IX509Enrollment.
ms.assetid: bcf5c2f0-b99f-4de5-83f4-44f17dc31cd4
title: Funções de resposta de certificado
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 15eec71d0493fa4961988b86db0397d0fd516508
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105760397"
---
# <a name="certificate-response-functions"></a><span data-ttu-id="6701c-103">Funções de resposta de certificado</span><span class="sxs-lookup"><span data-stu-id="6701c-103">Certificate Response Functions</span></span>

<span data-ttu-id="6701c-104">CertEnroll.dll implementa a interface [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) para enviar uma solicitação de certificado de cliente e instalar a resposta de uma [*autoridade de certificação*](/windows/desktop/SecGloss/c-gly) (CA).</span><span class="sxs-lookup"><span data-stu-id="6701c-104">CertEnroll.dll implements the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) interface to submit a client certificate request and install the response from a [*certification authority*](/windows/desktop/SecGloss/c-gly) (CA).</span></span>

<span data-ttu-id="6701c-105">O processo de registro pode acomodar os três cenários a seguir:</span><span class="sxs-lookup"><span data-stu-id="6701c-105">The enrollment process can accommodate the following three scenarios:</span></span>

<dl> <span data-ttu-id="6701c-106">Registro fora de banda</span><span class="sxs-lookup"><span data-stu-id="6701c-106">Out-of-band enrollment</span></span>

1.  <span data-ttu-id="6701c-107">Chame qualquer método de inicialização implementado pelo objeto [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="6701c-107">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="6701c-108">Chame o método [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) para recuperar a solicitação.</span><span class="sxs-lookup"><span data-stu-id="6701c-108">Call the [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) method to retrieve the request.</span></span>
3.  <span data-ttu-id="6701c-109">Envie a solicitação fora de banda (manualmente ou usando algum outro processo).</span><span class="sxs-lookup"><span data-stu-id="6701c-109">Submit the request out of band (manually or by using some other process).</span></span>
4.  <span data-ttu-id="6701c-110">Receber a resposta de uma AC.</span><span class="sxs-lookup"><span data-stu-id="6701c-110">Receive the response from a CA.</span></span>
5.  <span data-ttu-id="6701c-111">Chame o método [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) .</span><span class="sxs-lookup"><span data-stu-id="6701c-111">Call the [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

  
<span data-ttu-id="6701c-112">Registro automático</span><span class="sxs-lookup"><span data-stu-id="6701c-112">Automatic enrollment</span></span>

1.  <span data-ttu-id="6701c-113">Chame qualquer método de inicialização implementado pelo objeto [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="6701c-113">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="6701c-114">Chame o método de [**registro**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) .</span><span class="sxs-lookup"><span data-stu-id="6701c-114">Call the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) method.</span></span>

  
<span data-ttu-id="6701c-115">Registro atrasado</span><span class="sxs-lookup"><span data-stu-id="6701c-115">Delayed enrollment</span></span>

1.  <span data-ttu-id="6701c-116">Chame qualquer método de inicialização implementado pelo objeto [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) .</span><span class="sxs-lookup"><span data-stu-id="6701c-116">Call any initialization method implemented by the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object.</span></span>
2.  <span data-ttu-id="6701c-117">Chame o método [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) para recuperar a solicitação.</span><span class="sxs-lookup"><span data-stu-id="6701c-117">Call the [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest) method to retrieve the request.</span></span>
3.  <span data-ttu-id="6701c-118">Armazene a solicitação até que você esteja pronto para enviá-la.</span><span class="sxs-lookup"><span data-stu-id="6701c-118">Store the request until you are ready to submit it.</span></span>
4.  <span data-ttu-id="6701c-119">Quando você estiver pronto para se registrar, chame o método [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-initialize) para reinicializar o objeto de registro.</span><span class="sxs-lookup"><span data-stu-id="6701c-119">When you are ready to enroll, call the [**Initialize**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-initialize) method to reinitialize the enrollment object.</span></span>
5.  <span data-ttu-id="6701c-120">Chame o método [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) quando a autoridade de certificação retornar um certificado.</span><span class="sxs-lookup"><span data-stu-id="6701c-120">Call the [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method when the CA returns a certificate.</span></span>

  
</dl>

<span data-ttu-id="6701c-121">Durante o processo de registro, você pode chamar a propriedade [**status**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_status) no objeto [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) para recuperar um valor de enumeração [**EnrollmentEnrollStatus**](/windows/desktop/api/CertEnroll/ne-certenroll-enrollmentenrollstatus) que identifica se o registro foi bem-sucedido, está pendente, foi ignorado, gerou um erro ou foi negado.</span><span class="sxs-lookup"><span data-stu-id="6701c-121">During the enrollment process, you can call the [**Status**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_status) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve an [**EnrollmentEnrollStatus**](/windows/desktop/api/CertEnroll/ne-certenroll-enrollmentenrollstatus) enumeration value that identifies whether enrollment succeeded, is pending, was skipped, generated an error, or was denied.</span></span>

<span data-ttu-id="6701c-122">Cada uma das seções a seguir identifica uma função exportada pelo Xenroll.dll para instalar uma resposta de certificado de uma autoridade de certificação.</span><span class="sxs-lookup"><span data-stu-id="6701c-122">Each of the following sections identifies a function exported by Xenroll.dll to install a certificate response from a CA.</span></span> <span data-ttu-id="6701c-123">Cada seção também aborda como usar CertEnroll.dll para substituir a função ou indica que não existe nenhum mapeamento entre as duas bibliotecas:</span><span class="sxs-lookup"><span data-stu-id="6701c-123">Each section also discusses how to use CertEnroll.dll to replace the function or indicates that no mapping between the two libraries exists:</span></span>

-   [<span data-ttu-id="6701c-124">acceptFilePKCS7WStr</span><span class="sxs-lookup"><span data-stu-id="6701c-124">acceptFilePKCS7WStr</span></span>](#acceptfilepkcs7wstr)
-   [<span data-ttu-id="6701c-125">acceptFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="6701c-125">acceptFileResponseWStr</span></span>](#acceptfileresponsewstr)
-   [<span data-ttu-id="6701c-126">acceptPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="6701c-126">acceptPKCS7Blob</span></span>](#acceptpkcs7blob)
-   [<span data-ttu-id="6701c-127">acceptResponseBlob</span><span class="sxs-lookup"><span data-stu-id="6701c-127">acceptResponseBlob</span></span>](#acceptresponseblob)
-   [<span data-ttu-id="6701c-128">getCertContextFromFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="6701c-128">getCertContextFromFileResponseWStr</span></span>](#getcertcontextfromfileresponsewstr)
-   [<span data-ttu-id="6701c-129">getCertContextFromPKCS7</span><span class="sxs-lookup"><span data-stu-id="6701c-129">getCertContextFromPKCS7</span></span>](#getcertcontextfrompkcs7)
-   [<span data-ttu-id="6701c-130">getCertContextFromResponseBlob</span><span class="sxs-lookup"><span data-stu-id="6701c-130">getCertContextFromResponseBlob</span></span>](#getcertcontextfromresponseblob)
-   [<span data-ttu-id="6701c-131">InstallPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="6701c-131">InstallPKCS7Blob</span></span>](#installpkcs7blobex)
-   [<span data-ttu-id="6701c-132">InstallPKCS7BlobEx</span><span class="sxs-lookup"><span data-stu-id="6701c-132">InstallPKCS7BlobEx</span></span>](#installpkcs7blobex)
-   [<span data-ttu-id="6701c-133">SPCFileNameWStr</span><span class="sxs-lookup"><span data-stu-id="6701c-133">SPCFileNameWStr</span></span>](#spcfilenamewstr)
-   [<span data-ttu-id="6701c-134">WriteCertToCSP</span><span class="sxs-lookup"><span data-stu-id="6701c-134">WriteCertToCSP</span></span>](#writecerttocsp)
-   [<span data-ttu-id="6701c-135">WriteCertToUserDS</span><span class="sxs-lookup"><span data-stu-id="6701c-135">WriteCertToUserDS</span></span>](#writecerttouserds)
-   [<span data-ttu-id="6701c-136">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="6701c-136">Related topics</span></span>](#related-topics)

## <a name="acceptfilepkcs7wstr"></a><span data-ttu-id="6701c-137">acceptFilePKCS7WStr</span><span class="sxs-lookup"><span data-stu-id="6701c-137">acceptFilePKCS7WStr</span></span>

<span data-ttu-id="6701c-138">A função [**acceptFilePKCS7WStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr) no Xenroll.dll instala uma resposta [*PKCS \# 7*](/windows/desktop/SecGloss/p-gly) de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="6701c-138">The [**acceptFilePKCS7WStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptfilepkcs7wstr) function in Xenroll.dll installs a [*PKCS \#7*](/windows/desktop/SecGloss/p-gly) response from a file.</span></span>

<span data-ttu-id="6701c-139">A biblioteca de CertEnroll.dll não implementa diretamente a funcionalidade para instalar uma \# resposta de certificado PKCS 7 de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="6701c-139">The CertEnroll.dll library does not directly implement functionality to install a PKCS \#7 certificate response from a file.</span></span> <span data-ttu-id="6701c-140">No entanto, você pode criar uma função personalizada para ler os dados do arquivo em uma matriz de bytes e chamar [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) para instalar a resposta.</span><span class="sxs-lookup"><span data-stu-id="6701c-140">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the response.</span></span>

<span data-ttu-id="6701c-141">Se você especificar o valor de **AllowNoOutstandingRequest** da enumeração [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) para o primeiro parâmetro de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), um certificado fictício não precisará existir, permitindo assim que você instale um certificado sem primeiro chamar o [**registro**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="6701c-141">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="6701c-142">No entanto, se você estiver instalando um certificado usando um script da Web, um certificado fictício deverá existir no repositório de solicitações.</span><span class="sxs-lookup"><span data-stu-id="6701c-142">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="6701c-143">Portanto, você deve especificar **AllowNone** para o primeiro parâmetro.</span><span class="sxs-lookup"><span data-stu-id="6701c-143">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptfileresponsewstr"></a><span data-ttu-id="6701c-144">acceptFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="6701c-144">acceptFileResponseWStr</span></span>

<span data-ttu-id="6701c-145">A função [**acceptFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr) no Xenroll.dll instala uma \# resposta de certificado PKCS 7 ou CMC de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="6701c-145">The [**acceptFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptfileresponsewstr) function in Xenroll.dll installs a PKCS \#7 or CMC certificate response from a file.</span></span>

<span data-ttu-id="6701c-146">A biblioteca de CertEnroll.dll não implementa diretamente a funcionalidade para instalar uma resposta de certificado de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="6701c-146">The CertEnroll.dll library does not directly implement functionality to install a certificate response from a file.</span></span> <span data-ttu-id="6701c-147">No entanto, você pode criar uma função personalizada para ler os dados do arquivo em uma matriz de bytes e chamar [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) para instalar a \# resposta PKCS 7 ou CMC.</span><span class="sxs-lookup"><span data-stu-id="6701c-147">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the PKCS \#7 or CMC response.</span></span>

<span data-ttu-id="6701c-148">Se você especificar o valor de **AllowNoOutstandingRequest** da enumeração [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) para o primeiro parâmetro de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), um certificado fictício não precisará existir, permitindo assim que você instale um certificado sem primeiro chamar o [**registro**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="6701c-148">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="6701c-149">No entanto, se você estiver instalando um certificado usando um script da Web, um certificado fictício deverá existir no repositório de solicitações.</span><span class="sxs-lookup"><span data-stu-id="6701c-149">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="6701c-150">Portanto, você deve especificar **AllowNone** para o primeiro parâmetro.</span><span class="sxs-lookup"><span data-stu-id="6701c-150">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptpkcs7blob"></a><span data-ttu-id="6701c-151">acceptPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="6701c-151">acceptPKCS7Blob</span></span>

<span data-ttu-id="6701c-152">A função [**acceptPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptpkcs7blob) no Xenroll.dll instala uma \# resposta PKCS 7 contida em uma matriz de bytes.</span><span class="sxs-lookup"><span data-stu-id="6701c-152">The [**acceptPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-acceptpkcs7blob) function in Xenroll.dll installs a PKCS \#7 response contained in a byte array.</span></span>

<span data-ttu-id="6701c-153">Você pode chamar [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) para instalar uma \# mensagem PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="6701c-153">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 message.</span></span> <span data-ttu-id="6701c-154">Se você especificar o valor **AllowNoOutstandingRequest** da enumeração [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) para o primeiro parâmetro de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), um certificado fictício não precisará existir, permitindo assim que você instale a \# resposta PKCS 7 sem primeiro chamar o [**registro**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="6701c-154">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the PKCS \#7 response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="6701c-155">No entanto, se você estiver instalando um certificado usando um script da Web, um certificado fictício deverá existir no repositório de solicitações.</span><span class="sxs-lookup"><span data-stu-id="6701c-155">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="6701c-156">Portanto, você deve especificar **AllowNone** para o primeiro parâmetro.</span><span class="sxs-lookup"><span data-stu-id="6701c-156">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="acceptresponseblob"></a><span data-ttu-id="6701c-157">acceptResponseBlob</span><span class="sxs-lookup"><span data-stu-id="6701c-157">acceptResponseBlob</span></span>

<span data-ttu-id="6701c-158">A função [**acceptResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptresponseblob) no Xenroll.dll instala uma \# resposta de certificado PKCS 7 ou CMC contida em uma matriz de bytes.</span><span class="sxs-lookup"><span data-stu-id="6701c-158">The [**acceptResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-acceptresponseblob) function in Xenroll.dll installs a PKCS \#7 or CMC certificate response contained in a byte array.</span></span>

<span data-ttu-id="6701c-159">Você pode chamar [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) para instalar uma \# resposta PKCS 7 ou CMC.</span><span class="sxs-lookup"><span data-stu-id="6701c-159">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="6701c-160">Se você especificar o valor de **AllowNoOutstandingRequest** da enumeração [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) para o primeiro parâmetro de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), um certificado fictício não precisará existir, permitindo assim que você instale a resposta sem primeiro chamar o [**registro**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="6701c-160">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="6701c-161">No entanto, se você estiver instalando um certificado usando um script da Web, um certificado fictício deverá existir no repositório de solicitações.</span><span class="sxs-lookup"><span data-stu-id="6701c-161">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="6701c-162">Portanto, você deve especificar **AllowNone** para o primeiro parâmetro.</span><span class="sxs-lookup"><span data-stu-id="6701c-162">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="getcertcontextfromfileresponsewstr"></a><span data-ttu-id="6701c-163">getCertContextFromFileResponseWStr</span><span class="sxs-lookup"><span data-stu-id="6701c-163">getCertContextFromFileResponseWStr</span></span>

<span data-ttu-id="6701c-164">A função [**getCertContextFromFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr) no Xenroll.dll recupera o certificado do cliente de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="6701c-164">The [**getCertContextFromFileResponseWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromfileresponsewstr) function in Xenroll.dll retrieves the client certificate from a file.</span></span>

<span data-ttu-id="6701c-165">A biblioteca de CertEnroll.dll não implementa diretamente a funcionalidade para recuperar um certificado de uma resposta de autoridade de certificação salva em um arquivo.</span><span class="sxs-lookup"><span data-stu-id="6701c-165">The CertEnroll.dll library does not directly implement functionality to retrieve a certificate from a CA response saved in a file.</span></span> <span data-ttu-id="6701c-166">No entanto, você pode criar uma função personalizada para ler os dados do arquivo em uma matriz de bytes e chamar [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) para instalar a \# resposta PKCS 7 ou CMC e chamar a propriedade do [**certificado**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) para recuperar o certificado.</span><span class="sxs-lookup"><span data-stu-id="6701c-166">You can, however, create a custom function to read the file data into a byte array and call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install the PKCS \#7 or CMC response, and call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property to retrieve the certificate.</span></span>

<span data-ttu-id="6701c-167">Se você especificar o valor de **AllowNoOutstandingRequest** da enumeração [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) para o primeiro parâmetro de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), um certificado fictício não precisará existir, permitindo assim que você instale um certificado sem primeiro chamar o [**registro**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="6701c-167">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install a certificate without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="6701c-168">No entanto, se você estiver instalando um certificado usando um script da Web, um certificado fictício deverá existir no repositório de solicitações.</span><span class="sxs-lookup"><span data-stu-id="6701c-168">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="6701c-169">Portanto, você deve especificar **AllowNone** para o primeiro parâmetro.</span><span class="sxs-lookup"><span data-stu-id="6701c-169">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="getcertcontextfrompkcs7"></a><span data-ttu-id="6701c-170">getCertContextFromPKCS7</span><span class="sxs-lookup"><span data-stu-id="6701c-170">getCertContextFromPKCS7</span></span>

<span data-ttu-id="6701c-171">A função [**getCertContextFromPKCS7**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7) no Xenroll.dll recupera o certificado do cliente de uma \# resposta PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="6701c-171">The [**getCertContextFromPKCS7**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-getcertcontextfrompkcs7) function in Xenroll.dll retrieves the client certificate from a PKCS \#7 response.</span></span>

<span data-ttu-id="6701c-172">Você pode chamar a propriedade de [**certificado**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) no objeto [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) para recuperar um certificado depois de chamar o método de [**inscrição**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) .</span><span class="sxs-lookup"><span data-stu-id="6701c-172">You can call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve a certificate after calling the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

## <a name="getcertcontextfromresponseblob"></a><span data-ttu-id="6701c-173">getCertContextFromResponseBlob</span><span class="sxs-lookup"><span data-stu-id="6701c-173">getCertContextFromResponseBlob</span></span>

<span data-ttu-id="6701c-174">A função [**getCertContextFromResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob) no Xenroll.dll recupera um certificado de cliente de uma \# resposta PKCS 7 ou CMC.</span><span class="sxs-lookup"><span data-stu-id="6701c-174">The [**getCertContextFromResponseBlob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-getcertcontextfromresponseblob) function in Xenroll.dll retrieves a client certificate from a PKCS \#7 or CMC response.</span></span>

<span data-ttu-id="6701c-175">Você pode chamar a propriedade de [**certificado**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) no objeto [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) para recuperar um certificado depois de chamar o método de [**inscrição**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) .</span><span class="sxs-lookup"><span data-stu-id="6701c-175">You can call the [**Certificate**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-get_certificate) property on the [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) object to retrieve a certificate after calling the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method.</span></span>

## <a name="installpkcs7blob"></a><span data-ttu-id="6701c-176">InstallPKCS7Blob</span><span class="sxs-lookup"><span data-stu-id="6701c-176">InstallPKCS7Blob</span></span>

<span data-ttu-id="6701c-177">A função [**InstallPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-installpkcs7blob) no Xenroll.dll instala uma \# resposta PKCS 7.</span><span class="sxs-lookup"><span data-stu-id="6701c-177">The [**InstallPKCS7Blob**](/windows/desktop/api/xenroll/nf-xenroll-ienroll2-installpkcs7blob) function in Xenroll.dll installs a PKCS \#7 response.</span></span>

<span data-ttu-id="6701c-178">Você pode chamar [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) para instalar uma \# resposta PKCS 7 ou CMC.</span><span class="sxs-lookup"><span data-stu-id="6701c-178">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="6701c-179">Se você especificar o valor de **AllowNoOutstandingRequest** da enumeração [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) para o primeiro parâmetro de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), um certificado fictício não precisará existir, permitindo assim que você instale a resposta sem primeiro chamar o [**registro**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="6701c-179">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="6701c-180">No entanto, se você estiver instalando um certificado usando um script da Web, um certificado fictício deverá existir no repositório de solicitações.</span><span class="sxs-lookup"><span data-stu-id="6701c-180">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="6701c-181">Portanto, você deve especificar **AllowNone** para o primeiro parâmetro.</span><span class="sxs-lookup"><span data-stu-id="6701c-181">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="installpkcs7blobex"></a><span data-ttu-id="6701c-182">InstallPKCS7BlobEx</span><span class="sxs-lookup"><span data-stu-id="6701c-182">InstallPKCS7BlobEx</span></span>

<span data-ttu-id="6701c-183">A função [**InstallPKCS7BlobEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-installpkcs7blobex) no Xenroll.dll instala uma \# resposta PKCS 7 e retorna o número de certificados instalados.</span><span class="sxs-lookup"><span data-stu-id="6701c-183">The [**InstallPKCS7BlobEx**](/windows/desktop/api/xenroll/nf-xenroll-ienroll4-installpkcs7blobex) function in Xenroll.dll installs a PKCS \#7 response and returns the number of certificates installed.</span></span>

<span data-ttu-id="6701c-184">Você pode chamar [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) para instalar uma \# resposta PKCS 7 ou CMC.</span><span class="sxs-lookup"><span data-stu-id="6701c-184">You can call [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) to install a PKCS \#7 or CMC response.</span></span> <span data-ttu-id="6701c-185">Se você especificar o valor de **AllowNoOutstandingRequest** da enumeração [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) para o primeiro parâmetro de [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), um certificado fictício não precisará existir, permitindo assim que você instale a resposta sem primeiro chamar o [**registro**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) ou [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span><span class="sxs-lookup"><span data-stu-id="6701c-185">If you specify the **AllowNoOutstandingRequest** value of the [**InstallResponseRestrictionFlags**](/windows/desktop/api/CertEnroll/ne-certenroll-installresponserestrictionflags) enumeration for the first parameter of [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse), a dummy certificate need not exist, thereby enabling you to install the response without first calling [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) or [**CreateRequest**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-createrequest).</span></span> <span data-ttu-id="6701c-186">No entanto, se você estiver instalando um certificado usando um script da Web, um certificado fictício deverá existir no repositório de solicitações.</span><span class="sxs-lookup"><span data-stu-id="6701c-186">However, if you are installing a certificate by using a web script, a dummy certificate must exist in the request store.</span></span> <span data-ttu-id="6701c-187">Portanto, você deve especificar **AllowNone** para o primeiro parâmetro.</span><span class="sxs-lookup"><span data-stu-id="6701c-187">You must therefore specify **AllowNone** for the first parameter.</span></span>

## <a name="spcfilenamewstr"></a><span data-ttu-id="6701c-188">SPCFileNameWStr</span><span class="sxs-lookup"><span data-stu-id="6701c-188">SPCFileNameWStr</span></span>

<span data-ttu-id="6701c-189">A função [**SPCFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_spcfilenamewstr) em Xenroll.dll especifica ou recupera o nome do arquivo no qual salvar a resposta do certificado.</span><span class="sxs-lookup"><span data-stu-id="6701c-189">The [**SPCFileNameWStr**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_spcfilenamewstr) function in Xenroll.dll specifies or retrieves the name of the file in which to save the certificate response.</span></span> <span data-ttu-id="6701c-190">A biblioteca de CertEnroll.dll não implementa a funcionalidade que permite copiar um certificado para um arquivo específico.</span><span class="sxs-lookup"><span data-stu-id="6701c-190">The CertEnroll.dll library does not implement functionality that enables you to copy a certificate to a specific file.</span></span> <span data-ttu-id="6701c-191">O processo de registro instala automaticamente a cadeia de certificados em arquivos nos armazenamentos apropriados.</span><span class="sxs-lookup"><span data-stu-id="6701c-191">The enrollment process automatically installs the certificate chain into files in the appropriate stores.</span></span>

## <a name="writecerttocsp"></a><span data-ttu-id="6701c-192">WriteCertToCSP</span><span class="sxs-lookup"><span data-stu-id="6701c-192">WriteCertToCSP</span></span>

<span data-ttu-id="6701c-193">A função [**WriteCertToCSP**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttocsp) em Xenroll.dll especifica ou recupera um valor booliano que indica se um certificado deve ser gravado em um CSP ( [*provedor de serviços de criptografia*](/windows/desktop/SecGloss/c-gly) ).</span><span class="sxs-lookup"><span data-stu-id="6701c-193">The [**WriteCertToCSP**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttocsp) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether a certificate should be written to a [*cryptographic service provider*](/windows/desktop/SecGloss/c-gly) (CSP).</span></span> <span data-ttu-id="6701c-194">Normalmente, se essa função for chamada, o provedor será um [*cartão inteligente*](/windows/desktop/SecGloss/s-gly).</span><span class="sxs-lookup"><span data-stu-id="6701c-194">Typically, if this function is called, the provider is a [*smart card*](/windows/desktop/SecGloss/s-gly).</span></span>

<span data-ttu-id="6701c-195">Em CertEnroll.dll, quando um cliente chama o método de [**registro**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) para enviar uma solicitação para um certificado de cartão inteligente e um certificado é emitido, o [**registro**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) instala automaticamente o certificado no cartão inteligente, supondo que o cartão esteja instalado no leitor.</span><span class="sxs-lookup"><span data-stu-id="6701c-195">In CertEnroll.dll, when a client calls the [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) method to submit a request for a smart card certificate and a certificate is issued, [**Enroll**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-enroll) automatically installs the certificate on the smart card, assuming that the card is installed in the reader.</span></span> <span data-ttu-id="6701c-196">O método [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) também grava automaticamente o certificado no cartão inteligente.</span><span class="sxs-lookup"><span data-stu-id="6701c-196">The [**InstallResponse**](/windows/desktop/api/CertEnroll/nf-certenroll-ix509enrollment-installresponse) method also automatically writes the certificate to the smart card.</span></span>

## <a name="writecerttouserds"></a><span data-ttu-id="6701c-197">WriteCertToUserDS</span><span class="sxs-lookup"><span data-stu-id="6701c-197">WriteCertToUserDS</span></span>

<span data-ttu-id="6701c-198">A função [**WriteCertToUserDS**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttouserds) em Xenroll.dll especifica ou recupera um valor booliano que indica se um certificado deve ser salvo no repositório de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6701c-198">The [**WriteCertToUserDS**](/windows/desktop/api/xenroll/nf-xenroll-ienroll-get_writecerttouserds) function in Xenroll.dll specifies or retrieves a Boolean value that indicates whether a certificate should be saved in the Active Directory store.</span></span> <span data-ttu-id="6701c-199">A biblioteca de CertEnroll.dll não implementa a funcionalidade que permite especificar um repositório para o qual copiar um certificado.</span><span class="sxs-lookup"><span data-stu-id="6701c-199">The CertEnroll.dll library does not implement functionality that enables you to specify a store to copy a certificate to.</span></span>

## <a name="related-topics"></a><span data-ttu-id="6701c-200">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="6701c-200">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6701c-201">Mapeando Xenroll.dll para CertEnroll.dll</span><span class="sxs-lookup"><span data-stu-id="6701c-201">Mapping Xenroll.dll to CertEnroll.dll</span></span>](mapping-xenroll-dll-to-certenroll-dll.md)
</dt> <dt>

[<span data-ttu-id="6701c-202">**IX509Enrollment**</span><span class="sxs-lookup"><span data-stu-id="6701c-202">**IX509Enrollment**</span></span>](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment)
</dt> </dl>

 

 
