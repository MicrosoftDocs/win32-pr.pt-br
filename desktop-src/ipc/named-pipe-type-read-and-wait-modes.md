---
description: O servidor de pipe especifica o modo de tipo de pipe, modo de leitura e modo de espera no parâmetro dwPipeMode da função CreateNamedPipe. Os clientes de pipe podem especificar esses modos de pipe para seus identificadores de pipe usando a função CreateFile.
ms.assetid: 07cf9d06-6265-47f4-a9f1-c19c06cc5f9f
title: Modos de tipo de pipe nomeado, leitura e espera
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b116e5ca9357a65a6d63549b96065843b046d479
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103826790"
---
# <a name="named-pipe-type-read-and-wait-modes"></a><span data-ttu-id="ab2b2-104">Modos de tipo de pipe nomeado, leitura e espera</span><span class="sxs-lookup"><span data-stu-id="ab2b2-104">Named Pipe Type, Read, and Wait Modes</span></span>

<span data-ttu-id="ab2b2-105">O servidor de pipe especifica o modo de tipo de pipe, modo de leitura e modo de espera no parâmetro *dwPipeMode* da função [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) .</span><span class="sxs-lookup"><span data-stu-id="ab2b2-105">The pipe server specifies the pipe type mode, read mode, and wait mode in the *dwPipeMode* parameter of the [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) function.</span></span> <span data-ttu-id="ab2b2-106">Os clientes de pipe podem especificar esses modos de pipe para seus identificadores de pipe usando a função [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) .</span><span class="sxs-lookup"><span data-stu-id="ab2b2-106">Pipe clients can specify these pipe modes for their pipe handles using the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function.</span></span>

## <a name="type-mode"></a><span data-ttu-id="ab2b2-107">Modo de tipo</span><span class="sxs-lookup"><span data-stu-id="ab2b2-107">Type Mode</span></span>

<span data-ttu-id="ab2b2-108">O modo de tipo de um pipe determina como os dados são gravados em um pipe nomeado.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-108">The type mode of a pipe determines how data is written to a named pipe.</span></span> <span data-ttu-id="ab2b2-109">Os dados podem ser transmitidos por meio de um pipe nomeado como um fluxo de bytes ou como um fluxo de mensagens.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-109">Data can be transmitted through a named pipe as either a stream of bytes or as a stream of messages.</span></span> <span data-ttu-id="ab2b2-110">O servidor de pipe especifica o tipo de pipe ao chamar [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) para criar uma instância de um pipe nomeado.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-110">The pipe server specifies the pipe type when calling [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) to create an instance of a named pipe.</span></span> <span data-ttu-id="ab2b2-111">Os modos de tipo devem ser os mesmos para todas as instâncias de um pipe.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-111">The type modes must be the same for all instances of a pipe.</span></span>

<span data-ttu-id="ab2b2-112">Para criar um pipe de tipo de byte, especifique \_ \_ o tipo de pipe byte ou use o valor padrão.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-112">To create a byte-type pipe, specify PIPE\_TYPE\_BYTE or use the default value.</span></span> <span data-ttu-id="ab2b2-113">Os dados são gravados no pipe como um fluxo de bytes, e o sistema não diferencia os bytes gravados em operações de gravação diferentes.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-113">The data is written to the pipe as a stream of bytes, and the system does not differentiate between the bytes written in different write operations.</span></span>

<span data-ttu-id="ab2b2-114">Para criar um pipe de tipo de mensagem, especifique a mensagem de tipo de PIPE \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="ab2b2-114">To create a message-type pipe, specify PIPE\_TYPE\_MESSAGE.</span></span> <span data-ttu-id="ab2b2-115">O sistema trata os bytes gravados em cada operação de gravação no pipe como uma unidade de mensagem.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-115">The system treats the bytes written in each write operation to the pipe as a message unit.</span></span> <span data-ttu-id="ab2b2-116">O sistema sempre executa operações de gravação em pipes do tipo de mensagem como se o modo de write-through estivesse habilitado.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-116">The system always performs write operations on message-type pipes as if write-through mode were enabled.</span></span>

## <a name="read-mode"></a><span data-ttu-id="ab2b2-117">Modo de leitura</span><span class="sxs-lookup"><span data-stu-id="ab2b2-117">Read Mode</span></span>

<span data-ttu-id="ab2b2-118">O modo de leitura de um pipe determina como os dados são lidos de um pipe nomeado.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-118">The read mode of a pipe determines how data is read from a named pipe.</span></span> <span data-ttu-id="ab2b2-119">O servidor de pipe especifica o modo de leitura inicial para um identificador de pipe ao chamar [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea).</span><span class="sxs-lookup"><span data-stu-id="ab2b2-119">The pipe server specifies the initial read mode for a pipe handle when calling [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea).</span></span> <span data-ttu-id="ab2b2-120">Os dados podem ser lidos no modo de leitura de bytes ou no modo de leitura de mensagem.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-120">Data can be read in byte-read mode or message-read mode.</span></span> <span data-ttu-id="ab2b2-121">Um identificador para um pipe de tipo de byte só pode estar no modo de leitura de bytes.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-121">A handle to a byte-type pipe can be in byte-read mode only.</span></span> <span data-ttu-id="ab2b2-122">Um identificador para um pipe de tipo de mensagem pode estar no modo de leitura de byte ou de leitura de mensagem.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-122">A handle to a message-type pipe can be in either byte-read or message-read mode.</span></span> <span data-ttu-id="ab2b2-123">Para um pipe de tipo de mensagem, o modo de leitura pode ser diferente para identificadores de servidor e cliente para a mesma instância de pipe.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-123">For a message-type pipe, the read mode can be different for server and client handles to the same pipe instance.</span></span>

<span data-ttu-id="ab2b2-124">Para criar o identificador de pipe no modo de leitura de byte, especifique \_ o pipe ReadMode \_ byte ou use o valor padrão.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-124">To create the pipe handle in byte-read mode, specify PIPE\_READMODE\_BYTE or use the default value.</span></span> <span data-ttu-id="ab2b2-125">Os dados são lidos do pipe como um fluxo de bytes.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-125">Data is read from the pipe as a stream of bytes.</span></span> <span data-ttu-id="ab2b2-126">Uma operação de leitura foi concluída com êxito quando todos os bytes disponíveis no pipe são lidos ou quando o número especificado de bytes é lido.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-126">A read operation is completed successfully when all available bytes in the pipe are read or when the specified number of bytes is read.</span></span>

<span data-ttu-id="ab2b2-127">Para criar o identificador de pipe no modo de leitura de mensagem, especifique a mensagem de leitura de PIPE \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="ab2b2-127">To create the pipe handle in message-read mode, specify PIPE\_READMODE\_MESSAGE.</span></span> <span data-ttu-id="ab2b2-128">Os dados são lidos do pipe como um fluxo de mensagens.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-128">Data is read from the pipe as a stream of messages.</span></span> <span data-ttu-id="ab2b2-129">Uma operação de leitura foi concluída com êxito somente quando a mensagem inteira é lida.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-129">A read operation is completed successfully only when the entire message is read.</span></span> <span data-ttu-id="ab2b2-130">Se o número especificado de bytes a serem lidos for menor que o tamanho da próxima mensagem, a função lerá o máximo possível da mensagem antes de retornar zero (a função [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) retorna um erro \_ mais \_ dados).</span><span class="sxs-lookup"><span data-stu-id="ab2b2-130">If the specified number of bytes to read is less than the size of the next message, the function reads as much of the message as possible before returning zero (the [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) function returns ERROR\_MORE\_DATA).</span></span> <span data-ttu-id="ab2b2-131">O restante da mensagem pode ser lido usando outra operação de leitura.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-131">The remainder of the message can be read using another read operation.</span></span>

<span data-ttu-id="ab2b2-132">Para um cliente de pipe, um identificador de pipe retornado por [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) sempre está no modo de leitura de bytes inicialmente.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-132">For a pipe client, a pipe handle returned by [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) is always in byte-read mode initially.</span></span> <span data-ttu-id="ab2b2-133">Os clientes de pipe e os servidores de pipe podem usar a função [**SetNamedPipeHandleState**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-setnamedpipehandlestate) para alterar o modo de leitura de um identificador de pipe.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-133">Both pipe clients and pipe servers can use the [**SetNamedPipeHandleState**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-setnamedpipehandlestate) function to change the read mode of a pipe handle.</span></span> <span data-ttu-id="ab2b2-134">O identificador de pipe deve ter o \_ direito de acesso de atributos de gravação de arquivo \_ .</span><span class="sxs-lookup"><span data-stu-id="ab2b2-134">The pipe handle must have the FILE\_WRITE\_ATTRIBUTES access right.</span></span>

## <a name="wait-mode"></a><span data-ttu-id="ab2b2-135">Modo de espera</span><span class="sxs-lookup"><span data-stu-id="ab2b2-135">Wait Mode</span></span>

<span data-ttu-id="ab2b2-136">O modo de espera de um identificador de pipe determina como as funções [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile), [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile)e [**ConnectNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-connectnamedpipe) lidam com operações demoradas.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-136">The wait mode of a pipe handle determines how the [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile), [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile), and [**ConnectNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-connectnamedpipe) functions handle lengthy operations.</span></span> <span data-ttu-id="ab2b2-137">No modo de espera de bloqueio, as funções aguardam indefinidamente um processo na outra extremidade do pipe para concluir uma operação.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-137">In blocking-wait mode, the functions wait indefinitely for a process on the other end of the pipe to complete an operation.</span></span> <span data-ttu-id="ab2b2-138">No modo de espera de não bloqueio, as funções retornam imediatamente em situações que, de outra forma, exigiriam uma espera indefinida.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-138">In nonblocking-wait mode, the functions return immediately in situations that would otherwise require an indefinite wait.</span></span>

<span data-ttu-id="ab2b2-139">Uma operação [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) é afetada pelo modo de espera de um identificador de pipe quando o pipe está vazio.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-139">A [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) operation is affected by the wait mode of a pipe handle when the pipe is empty.</span></span> <span data-ttu-id="ab2b2-140">Com um identificador de espera de bloqueio, a operação não é concluída com êxito até que os dados estejam disponíveis de um thread que esteja gravando na outra extremidade do pipe.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-140">With a blocking-wait handle, the operation is not completed successfully until data is available from a thread writing to the other end of the pipe.</span></span> <span data-ttu-id="ab2b2-141">Usando um identificador de espera de não bloqueio, a função retorna zero imediatamente e a função [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) retorna um erro \_ sem \_ dados.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-141">Using a nonblocking-wait handle, the function returns zero immediately, and the [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) function returns ERROR\_NO\_DATA.</span></span>

<span data-ttu-id="ab2b2-142">Uma operação [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) é afetada pelo modo de espera de um identificador de pipe quando não há espaço suficiente no buffer do pipe.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-142">A [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) operation is affected by the wait mode of a pipe handle when there is insufficient space in the pipe's buffer.</span></span> <span data-ttu-id="ab2b2-143">Com um identificador de espera de bloqueio, a operação de gravação não pode ter sucesso até que espaço suficiente seja criado no buffer por uma leitura de thread a partir da outra extremidade do pipe.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-143">With a blocking-wait handle, the write operation cannot succeed until sufficient space is created in the buffer by a thread reading from the other end of the pipe.</span></span> <span data-ttu-id="ab2b2-144">Com um identificador de espera de não bloqueio, a operação de gravação retorna um valor diferente de zero imediatamente, sem gravar nenhum byte (para um pipe de tipo de mensagem) ou depois de gravar quantos bytes o buffer mantém (para um pipe de tipo de byte).</span><span class="sxs-lookup"><span data-stu-id="ab2b2-144">With a nonblocking-wait handle, the write operation returns a nonzero value immediately, without writing any bytes (for a message-type pipe) or after writing as many bytes as the buffer holds (for a byte-type pipe).</span></span>

<span data-ttu-id="ab2b2-145">Uma operação [**ConnectNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-connectnamedpipe) é afetada pelo modo de espera de um identificador de pipe quando não há nenhum cliente conectado ou esperando para se conectar à instância do pipe.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-145">A [**ConnectNamedPipe**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-connectnamedpipe) operation is affected by the wait mode of a pipe handle when there is no client connected or waiting to connect to the pipe instance.</span></span> <span data-ttu-id="ab2b2-146">Com um identificador de espera de bloqueio, a operação de conexão não tem sucesso até que um cliente de pipe se conecte à instância de pipe chamando a função [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) ou [**CallNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-callnamedpipea) .</span><span class="sxs-lookup"><span data-stu-id="ab2b2-146">With a blocking-wait handle, the connect operation does not succeed until a pipe client connects to the pipe instance by calling either the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) or [**CallNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-callnamedpipea) function.</span></span> <span data-ttu-id="ab2b2-147">Com um identificador de espera de não bloqueio, a operação de conexão retorna zero imediatamente e a função [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) retorna o \_ pipe de erro \_ escutando.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-147">With a nonblocking-wait handle, the connect operation returns zero immediately, and the [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) function returns ERROR\_PIPE\_LISTENING.</span></span>

<span data-ttu-id="ab2b2-148">Por padrão, todos os identificadores de pipe nomeado retornados pela função [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) ou [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) são criados com o modo de espera de bloqueio habilitado.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-148">By default, all named pipe handles returned by the [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) or [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function are created with blocking-wait mode enabled.</span></span> <span data-ttu-id="ab2b2-149">Para criar o pipe no modo de espera de não bloqueio, o servidor de pipe especifica o PIPE \_ nowait ao chamar **CreateNamedPipe**.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-149">To create the pipe in nonblocking-wait mode, the pipe server specifies PIPE\_NOWAIT when calling **CreateNamedPipe**.</span></span>

<span data-ttu-id="ab2b2-150">Os clientes de pipe e os servidores de pipe podem alterar o modo de espera de um identificador de pipe especificando a espera de PIPE \_ ou o pipe \_ nowait em uma chamada para a função [**SetNamedPipeHandleState**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-setnamedpipehandlestate) .</span><span class="sxs-lookup"><span data-stu-id="ab2b2-150">Both pipe clients and pipe servers can change a pipe handle's wait mode by specifying either PIPE\_WAIT or PIPE\_NOWAIT in a call to the [**SetNamedPipeHandleState**](/windows/win32/api/namedpipeapi/nf-namedpipeapi-setnamedpipehandlestate) function.</span></span>

> [!Note]  
> <span data-ttu-id="ab2b2-151">O modo de espera de não bloqueio tem suporte para compatibilidade com o Microsoft LAN Manager versão 2,0.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-151">The nonblocking-wait mode is supported for compatibility with Microsoft LAN Manager version 2.0.</span></span> <span data-ttu-id="ab2b2-152">Esse modo não deve ser usado para obter entrada e saída sobrepostas (e/s) com pipes nomeados.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-152">This mode should not be used to achieve overlapped input and output (I/O) with named pipes.</span></span> <span data-ttu-id="ab2b2-153">A e/s sobreposta deve ser usada, pois permite que operações demoradas sejam executadas em segundo plano depois que a função retorna.</span><span class="sxs-lookup"><span data-stu-id="ab2b2-153">Overlapped I/O should be used instead, because it enables time-consuming operations to run in the background after the function returns.</span></span> <span data-ttu-id="ab2b2-154">Para obter mais informações sobre e/s sobreposta, consulte [entrada e saída síncrona e sobreposta](synchronous-and-overlapped-input-and-output.md).</span><span class="sxs-lookup"><span data-stu-id="ab2b2-154">For more information about overlapped I/O, see [Synchronous and Overlapped Input and Output](synchronous-and-overlapped-input-and-output.md).</span></span>

 

 

 
