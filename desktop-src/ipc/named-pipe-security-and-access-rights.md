---
description: Você pode especificar um descritor de segurança para um pipe nomeado ao chamar a função CreateNamedPipe. O descritor de segurança controla o acesso às extremidades do cliente e do servidor do pipe nomeado.
ms.assetid: f9ea97c9-9a97-4083-82d8-29ffb8be5a77
title: Segurança de pipe nomeado e direitos de acesso
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 11cada606d8197ac2f64943aa742bbfd614fa4ef
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105750516"
---
# <a name="named-pipe-security-and-access-rights"></a><span data-ttu-id="e4fd8-104">Segurança de pipe nomeado e direitos de acesso</span><span class="sxs-lookup"><span data-stu-id="e4fd8-104">Named Pipe Security and Access Rights</span></span>

<span data-ttu-id="e4fd8-105">A segurança do Windows permite que você controle o acesso a pipes nomeados.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-105">Windows security enables you to control access to named pipes.</span></span> <span data-ttu-id="e4fd8-106">Para obter mais informações sobre segurança, consulte [modelo de controle de acesso](/windows/desktop/SecAuthZ/access-control-model).</span><span class="sxs-lookup"><span data-stu-id="e4fd8-106">For more information about security, see [Access-Control Model](/windows/desktop/SecAuthZ/access-control-model).</span></span>

<span data-ttu-id="e4fd8-107">Você pode especificar um [descritor de segurança](/windows/desktop/SecAuthZ/security-descriptors) para um pipe nomeado ao chamar a função [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) .</span><span class="sxs-lookup"><span data-stu-id="e4fd8-107">You can specify a [security descriptor](/windows/desktop/SecAuthZ/security-descriptors) for a named pipe when you call the [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) function.</span></span> <span data-ttu-id="e4fd8-108">O descritor de segurança controla o acesso às extremidades do cliente e do servidor do pipe nomeado.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-108">The security descriptor controls access to both client and server ends of the named pipe.</span></span> <span data-ttu-id="e4fd8-109">Se você especificar **NULL**, o pipe nomeado obterá um descritor de segurança padrão.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-109">If you specify **NULL**, the named pipe gets a default security descriptor.</span></span> <span data-ttu-id="e4fd8-110">As ACLs no descritor de segurança padrão para um pipe nomeado concedem controle total à conta LocalSystem, aos administradores e ao proprietário criador.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-110">The ACLs in the default security descriptor for a named pipe grant full control to the LocalSystem account, administrators, and the creator owner.</span></span> <span data-ttu-id="e4fd8-111">Eles também concedem acesso de leitura aos membros do grupo todos e à conta anônima.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-111">They also grant read access to members of the Everyone group and the anonymous account.</span></span>

<span data-ttu-id="e4fd8-112">Para recuperar o descritor de segurança de um pipe nomeado, chame a função [**GetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getsecurityinfo) .</span><span class="sxs-lookup"><span data-stu-id="e4fd8-112">To retrieve a named pipe's security descriptor, call the [**GetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-getsecurityinfo) function.</span></span> <span data-ttu-id="e4fd8-113">Para alterar o descritor de segurança de um pipe nomeado, chame a função [**SetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-setsecurityinfo) .</span><span class="sxs-lookup"><span data-stu-id="e4fd8-113">To change the security descriptor of a named pipe, call the [**SetSecurityInfo**](/windows/desktop/api/aclapi/nf-aclapi-setsecurityinfo) function.</span></span>

<span data-ttu-id="e4fd8-114">Quando um thread chama [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) para abrir um identificador para a extremidade do servidor de um pipe nomeado existente, o sistema executa uma verificação de acesso antes de retornar o identificador.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-114">When a thread calls [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) to open a handle to the server end of an existing named pipe, the system performs an access check before returning the handle.</span></span> <span data-ttu-id="e4fd8-115">A verificação de acesso compara o token de acesso do thread e os [direitos de acesso](/windows/desktop/SecAuthZ/access-rights-and-access-masks) solicitados com relação à DACL no descritor de segurança do pipe nomeado.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-115">The access check compares the thread's access token and the requested [access rights](/windows/desktop/SecAuthZ/access-rights-and-access-masks) against the DACL in the named pipe's security descriptor.</span></span> <span data-ttu-id="e4fd8-116">Além dos direitos de acesso solicitados, a DACL deve permitir que o arquivo de thread de chamada \_ crie \_ \_ acesso à instância de pipe para o pipe nomeado.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-116">In addition to the requested access rights, the DACL must allow the calling thread FILE\_CREATE\_PIPE\_INSTANCE access to the named pipe.</span></span>

<span data-ttu-id="e4fd8-117">Da mesma forma, quando um cliente chama a função [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) ou [**CallNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-callnamedpipea) para se conectar à extremidade do cliente de um pipe nomeado, o sistema executa uma verificação de acesso antes de conceder acesso ao cliente.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-117">Similarly, when a client calls the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) or [**CallNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-callnamedpipea) function to connect to the client end of a named pipe, the system performs an access check before granting access to the client.</span></span>

<span data-ttu-id="e4fd8-118">O identificador retornado pela função [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) sempre tem o acesso de sincronização.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-118">The handle returned by the [**CreateNamedPipe**](/windows/desktop/api/Winbase/nf-winbase-createnamedpipea) function always has SYNCHRONIZE access.</span></span> <span data-ttu-id="e4fd8-119">Ele também tem \_ leitura genérica, \_ gravação genérica ou ambas, dependendo do modo aberto do pipe.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-119">It also has GENERIC\_READ, GENERIC\_WRITE, or both, depending on the open mode of the pipe.</span></span> <span data-ttu-id="e4fd8-120">A seguir estão os direitos de acesso para cada modo aberto.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-120">The following are the access rights for each open mode.</span></span>



| <span data-ttu-id="e4fd8-121">Modo de abertura</span><span class="sxs-lookup"><span data-stu-id="e4fd8-121">Open mode</span></span>                           | <span data-ttu-id="e4fd8-122">Direitos de acesso</span><span class="sxs-lookup"><span data-stu-id="e4fd8-122">Access rights</span></span>                                              |
|-------------------------------------|------------------------------------------------------------|
| <span data-ttu-id="e4fd8-123">\_ \_ Duplex de acesso de pipe (0x00000003)</span><span class="sxs-lookup"><span data-stu-id="e4fd8-123">PIPE\_ACCESS\_DUPLEX (0x00000003)</span></span>   | <span data-ttu-id="e4fd8-124">ARQUIVO \_ \_ de leitura genérica, \_ gravação genérica de arquivo \_ e sincronização</span><span class="sxs-lookup"><span data-stu-id="e4fd8-124">FILE\_GENERIC\_READ, FILE\_GENERIC\_WRITE, and SYNCHRONIZE</span></span> |
| <span data-ttu-id="e4fd8-125">\_ \_ Entrada de acesso de pipe (0x00000001)</span><span class="sxs-lookup"><span data-stu-id="e4fd8-125">PIPE\_ACCESS\_INBOUND (0x00000001)</span></span>  | <span data-ttu-id="e4fd8-126">\_ \_ Leitura e sincronização genérica de arquivo</span><span class="sxs-lookup"><span data-stu-id="e4fd8-126">FILE\_GENERIC\_READ and SYNCHRONIZE</span></span>                        |
| <span data-ttu-id="e4fd8-127">\_ \_ Saída de acesso de pipe (0x00000002)</span><span class="sxs-lookup"><span data-stu-id="e4fd8-127">PIPE\_ACCESS\_OUTBOUND (0x00000002)</span></span> | <span data-ttu-id="e4fd8-128">\_ \_ Gravação e sincronização genérica de arquivo</span><span class="sxs-lookup"><span data-stu-id="e4fd8-128">FILE\_GENERIC\_WRITE and SYNCHRONIZE</span></span>                       |



 

<span data-ttu-id="e4fd8-129">\_ \_ O acesso de leitura genérico de arquivo para um pipe nomeado combina os direitos de leitura de dados do pipe, leitura de atributos de pipe, leitura de atributos estendidos e leitura da DACL do pipe.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-129">FILE\_GENERIC\_READ access for a named pipe combines the rights to read data from the pipe, read pipe attributes, read extended attributes, and read the pipe's DACL.</span></span>

<span data-ttu-id="e4fd8-130">\_ \_ O acesso de gravação genérico de arquivo para um pipe nomeado combina os direitos de gravar dados no pipe, acrescentar dados a ele, gravar atributos de pipe, gravar atributos estendidos e ler a DACL do pipe.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-130">FILE\_GENERIC\_WRITE access for a named pipe combines the rights to write data to the pipe, append data to it, write pipe attributes, write extended attributes, and read the pipe's DACL.</span></span> <span data-ttu-id="e4fd8-131">Como \_ \_ \_ a instância do pipe de criação de arquivos e dados de anexação \_ \_ de arquivo tem a mesma definição, a \_ gravação genérica de arquivo habilita a \_ permissão para criar o pipe.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-131">Because FILE\_APPEND\_DATA and FILE\_CREATE\_PIPE\_INSTANCE have the same definition, so FILE\_GENERIC\_WRITE enables permission to create the pipe.</span></span> <span data-ttu-id="e4fd8-132">Para evitar esse problema, use os direitos individuais em vez de usar a \_ gravação genérica de arquivo \_ .</span><span class="sxs-lookup"><span data-stu-id="e4fd8-132">To avoid this problem, use the individual rights instead of using FILE\_GENERIC\_WRITE.</span></span>

<span data-ttu-id="e4fd8-133">Você pode solicitar o direito de acesso de segurança do sistema de acesso \_ \_ a um objeto de pipe nomeado se desejar ler ou gravar a SACL do objeto.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-133">You can request the ACCESS\_SYSTEM\_SECURITY access right to a named pipe object if you want to read or write the object's SACL.</span></span> <span data-ttu-id="e4fd8-134">Para obter mais informações, consulte [listas de controle de acesso (ACLs)](/windows/desktop/SecAuthZ/access-control-lists) e [direito de acesso SACL](/windows/desktop/SecAuthZ/sacl-access-right).</span><span class="sxs-lookup"><span data-stu-id="e4fd8-134">For more information, see [Access-Control Lists (ACLs)](/windows/desktop/SecAuthZ/access-control-lists) and [SACL Access Right](/windows/desktop/SecAuthZ/sacl-access-right).</span></span>

<span data-ttu-id="e4fd8-135">Para impedir que usuários ou usuários remotos em uma sessão de serviços de terminal diferente acessem um pipe nomeado, use o SID de logon na DACL do pipe.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-135">To prevent remote users or users on a different terminal services session from accessing a named pipe, use the logon SID on the DACL for the pipe.</span></span> <span data-ttu-id="e4fd8-136">O SID de logon também é usado em logons executar como; é o SID usado para proteger o namespace de objeto por sessão.</span><span class="sxs-lookup"><span data-stu-id="e4fd8-136">The logon SID is used in run-as logons as well; it is the SID used to protect the per-session object namespace.</span></span> <span data-ttu-id="e4fd8-137">Para obter mais informações, consulte [obtendo o Sid de logon em C++](/previous-versions//aa446670(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="e4fd8-137">For more information, see [Getting the Logon SID in C++](/previous-versions//aa446670(v=vs.85)).</span></span>

 

 
