---
title: Visão geral do StoClien
description: O exemplo StoClien demonstra como o cliente usa o armazenamento estruturado e como ele direciona um componente de servidor para usar esse armazenamento.
ms.assetid: 1f540e0f-2189-4f45-aad3-9b4b56732907
keywords:
- Visão geral do StoClien
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee37f6f84cf981bda637abbd96ff8e8f0314d8ee
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "105753081"
---
# <a name="stoclien-overview"></a><span data-ttu-id="8e47d-104">Visão geral do StoClien</span><span class="sxs-lookup"><span data-stu-id="8e47d-104">StoClien Overview</span></span>

## <a name="purpose"></a><span data-ttu-id="8e47d-105">Finalidade</span><span class="sxs-lookup"><span data-stu-id="8e47d-105">Purpose</span></span>

<span data-ttu-id="8e47d-106">O foco principal do exemplo de [StoClien](structured-storage-client-sample--stoclien-.md) é como o cliente usa o armazenamento estruturado e como ele instrui um componente de servidor a usar esse armazenamento.</span><span class="sxs-lookup"><span data-stu-id="8e47d-106">The principal focus of the [StoClien](structured-storage-client-sample--stoclien-.md) sample is how the client uses structured storage and how it instructs a server component to use this storage.</span></span> <span data-ttu-id="8e47d-107">O exemplo StoClien demonstra um modelo de programação de serviços de armazenamento estruturados.</span><span class="sxs-lookup"><span data-stu-id="8e47d-107">The StoClien sample demonstrates a programming model of structured storage services.</span></span>

## <a name="functionality"></a><span data-ttu-id="8e47d-108">Funcionalidade</span><span class="sxs-lookup"><span data-stu-id="8e47d-108">Functionality</span></span>

<span data-ttu-id="8e47d-109">A funcionalidade [StoClien](structured-storage-client-sample--stoclien-.md) é semelhante aos exemplos de "rabisco" em algumas versões do Microsoft Visual C++.</span><span class="sxs-lookup"><span data-stu-id="8e47d-109">The [StoClien](structured-storage-client-sample--stoclien-.md) functionality is similar to the "scribble" samples in some versions of Microsoft Visual C++.</span></span> <span data-ttu-id="8e47d-110">A diferença entre o exemplo de StoClien e o exemplo de [StoServe](structured-storage-server-sample--stoserve-.md) é uma arquitetura interna baseada em tecnologia com.</span><span class="sxs-lookup"><span data-stu-id="8e47d-110">The difference between the StoClien sample and the [StoServe](structured-storage-server-sample--stoserve-.md) sample is an internal architecture based on COM technology.</span></span> <span data-ttu-id="8e47d-111">Uma distinção de arquitetura clara é mantida entre o cliente COM e o servidor COM.</span><span class="sxs-lookup"><span data-stu-id="8e47d-111">A clear architectural distinction is kept between COM client and COM server.</span></span>

<span data-ttu-id="8e47d-112">O [StoClien](structured-storage-client-sample--stoclien-.md) carrega e salva seus desenhos no armazenamento estruturado de arquivos compostos com.</span><span class="sxs-lookup"><span data-stu-id="8e47d-112">[StoClien](structured-storage-client-sample--stoclien-.md) loads and saves its drawings in the structured storage of COM compound files.</span></span>

<span data-ttu-id="8e47d-113">O exemplo [StoClien](structured-storage-client-sample--stoclien-.md) cria e usa o objeto com de copapel com conexão que é fornecido como o \_ componente DllPaper do CLSID no servidor [StoServe](structured-storage-server-sample--stoserve-.md) .</span><span class="sxs-lookup"><span data-stu-id="8e47d-113">The [StoClien](structured-storage-client-sample--stoclien-.md) sample creates and uses the connectable COPaper COM object that is provided as the CLSID\_DllPaper component in the [StoServe](structured-storage-server-sample--stoserve-.md) server.</span></span> <span data-ttu-id="8e47d-114">O cliente StoClien cria um objeto de copapel e controla-o por meio da interface IPaper que o objeto expõe.</span><span class="sxs-lookup"><span data-stu-id="8e47d-114">The StoClien client creates a COPaper object and controls it through the IPaper interface that the object exposes.</span></span> <span data-ttu-id="8e47d-115">O StoClien obtém dados de desenho do usuário e os representa graficamente em uma janela que ele gerencia.</span><span class="sxs-lookup"><span data-stu-id="8e47d-115">StoClien obtains drawing data from the user and graphically represents it in a window that it manages.</span></span> <span data-ttu-id="8e47d-116">O StoClien usa a interface IPaper de copapel para salvar os dados de desenho em copapel e para direcionar as operações de armazenamento de arquivos nesses dados.</span><span class="sxs-lookup"><span data-stu-id="8e47d-116">StoClien uses the COPaper IPaper interface to save the drawing data in COPaper and to direct file storage operations on this data.</span></span>

<span data-ttu-id="8e47d-117">Um objeto COM de copapel encapsula apenas o armazenamento baseado em servidor dos dados do papel de desenho: nenhum comportamento de GUI (interface gráfica do usuário) é fornecido no lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="8e47d-117">A COPaper COM object encapsulates only the server-based storage of the drawing paper data: No graphical user interface (GUI) behavior is provided on the server side.</span></span> <span data-ttu-id="8e47d-118">Todo o comportamento da GUI é isolado no cliente.</span><span class="sxs-lookup"><span data-stu-id="8e47d-118">All GUI behavior is isolated in the client.</span></span> <span data-ttu-id="8e47d-119">Os recursos de gerenciamento de dados e armazenamento de objetos de copapel estão disponíveis apenas por meio de uma interface personalizada COM, IPaper.</span><span class="sxs-lookup"><span data-stu-id="8e47d-119">The data management and storage features of COPaper objects are available only through an COM custom interface, IPaper.</span></span>

<span data-ttu-id="8e47d-120">[StoClien](structured-storage-client-sample--stoclien-.md) coopera com o copaper para carregar e salvar os dados de desenho de copapel.</span><span class="sxs-lookup"><span data-stu-id="8e47d-120">[StoClien](structured-storage-client-sample--stoclien-.md) cooperates with the COPaper to load and save the COPaper drawing data.</span></span> <span data-ttu-id="8e47d-121">StoClien Obtém uma interface [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) para o objeto de armazenamento em um arquivo composto.</span><span class="sxs-lookup"><span data-stu-id="8e47d-121">StoClien obtains an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface for the storage object in a compound file.</span></span> <span data-ttu-id="8e47d-122">Em suas operações de carregar e salvar, o StoClien passa um ponteiro para a interface **IStorage** para o copapel no servidor.</span><span class="sxs-lookup"><span data-stu-id="8e47d-122">In its load and save operations, StoClien passes a pointer to the **IStorage** interface to COPaper in the server.</span></span> <span data-ttu-id="8e47d-123">O copaper usa o **IStorage** fornecido para criar fluxos no armazenamento.</span><span class="sxs-lookup"><span data-stu-id="8e47d-123">COPaper uses the provided **IStorage** to create streams in the storage.</span></span> <span data-ttu-id="8e47d-124">O copaper pode usar a interface [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) padrão para ler e gravar os dados de desenho que ele gerencia.</span><span class="sxs-lookup"><span data-stu-id="8e47d-124">COPaper can then use the standard [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interface for reading and writing the drawing data it manages.</span></span>

<span data-ttu-id="8e47d-125">O copaper gerencia apenas os dados de desenho; Ele não executa ações de GUI.</span><span class="sxs-lookup"><span data-stu-id="8e47d-125">COPaper only manages the drawing data; it performs no GUI actions.</span></span> <span data-ttu-id="8e47d-126">O [StoClien](structured-storage-client-sample--stoclien-.md) fornece a GUI para o aplicativo de desenho.</span><span class="sxs-lookup"><span data-stu-id="8e47d-126">[StoClien](structured-storage-client-sample--stoclien-.md) provides the GUI for the drawing application.</span></span> <span data-ttu-id="8e47d-127">Ele encapsula isso em um objeto CGuiPaper do C++ central.</span><span class="sxs-lookup"><span data-stu-id="8e47d-127">It encapsulates this in a central CGuiPaper C++ object.</span></span>

<span data-ttu-id="8e47d-128">O [StoClien](structured-storage-client-sample--stoclien-.md) também implementa a interface IPaperSink personalizada em um objeto com COPaperSink e conecta essa interface a um ponto de conexão apropriado no objeto de copapel do servidor.</span><span class="sxs-lookup"><span data-stu-id="8e47d-128">[StoClien](structured-storage-client-sample--stoclien-.md) also implements the custom IPaperSink interface in a COPaperSink COM object and connects this interface to an appropriate connection point in the server COPaper object.</span></span> <span data-ttu-id="8e47d-129">O copaper usa a interface IPaperSink conectada para enviar notificações de volta para o StoClien.</span><span class="sxs-lookup"><span data-stu-id="8e47d-129">COPaper uses the connected IPaperSink interface to send notifications back to StoClien.</span></span> <span data-ttu-id="8e47d-130">O redesenho de GUI normal dos dados de desenho de copapel é feito no StoClien usando a tecnologia de objetos conectáveis de copapel.</span><span class="sxs-lookup"><span data-stu-id="8e47d-130">The normal GUI repainting of the COPaper drawing data is done in StoClien using the COPaper connectable object technology.</span></span>

<span data-ttu-id="8e47d-131">[StoClien](structured-storage-client-sample--stoclien-.md) é um aplicativo que você pode executar diretamente da maneira normal ou da janela de prompt de comando.</span><span class="sxs-lookup"><span data-stu-id="8e47d-131">[StoClien](structured-storage-client-sample--stoclien-.md) is an application that you can execute directly in the normal manner or from the command prompt window.</span></span> <span data-ttu-id="8e47d-132">StoClien aceita um parâmetro de nome de arquivo opcional na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="8e47d-132">StoClien accepts an optional file name parameter on the command line.</span></span>

<span data-ttu-id="8e47d-133">No exemplo a seguir, Drawing. PAP é um arquivo composto que contém o armazenamento estruturado compatível com DllPaper de dados de desenho.</span><span class="sxs-lookup"><span data-stu-id="8e47d-133">In the following example, Drawing.pap is a compound file containing DllPaper-compatible structured storage of drawing data.</span></span> <span data-ttu-id="8e47d-134">Se nenhum parâmetro de nome de arquivo de linha de comando for especificado, [StoClien](structured-storage-client-sample--stoclien-.md) usará o nome de arquivo padrão StoClien. PAP e tentará abri-lo no mesmo diretório que o Stoclien.exe em execução.</span><span class="sxs-lookup"><span data-stu-id="8e47d-134">If no command line file name parameter is specified, [StoClien](structured-storage-client-sample--stoclien-.md) uses the default file name Stoclien.pap and attempts to open it in the same directory as the executing Stoclien.exe.</span></span>

<span data-ttu-id="8e47d-135">**StoClien c: \\ desenhos \\ Drawing. PAP**</span><span class="sxs-lookup"><span data-stu-id="8e47d-135">**StoClien c:\\drawings\\drawing.pap**</span></span>

## <a name="support-information"></a><span data-ttu-id="8e47d-136">Informações de suporte</span><span class="sxs-lookup"><span data-stu-id="8e47d-136">Support Information</span></span>

<span data-ttu-id="8e47d-137">Para obter mais informações, descrições funcionais e um tutorial de código para [StoClien](structured-storage-client-sample--stoclien-.md), consulte a seção Tour de código em Stoclien.htm.</span><span class="sxs-lookup"><span data-stu-id="8e47d-137">For more information, functional descriptions and a code tutorial for [StoClien](structured-storage-client-sample--stoclien-.md), see the Code Tour section in Stoclien.htm.</span></span> <span data-ttu-id="8e47d-138">Para obter mais informações sobre a operação de usuário externo do StoClien, consulte as seções uso e operação no Stoclien.htm.</span><span class="sxs-lookup"><span data-stu-id="8e47d-138">For more information about the external user operation of StoClien, see the Usage and Operation sections in Stoclien.htm.</span></span> <span data-ttu-id="8e47d-139">Para ler Stoclient.htm, execute Tutorial.exe no diretório principal do tutorial e clique na lição StoClien na tabela de lições.</span><span class="sxs-lookup"><span data-stu-id="8e47d-139">To read Stoclient.htm, run Tutorial.exe in the main tutorial directory and click the StoClien lesson in the table of lessons.</span></span> <span data-ttu-id="8e47d-140">Como alternativa, clique em Stoclien.htm depois de localizar o diretório principal do tutorial no Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="8e47d-140">Alternatively, click Stoclien.htm after locating the main tutorial directory in Windows Explorer.</span></span> <span data-ttu-id="8e47d-141">Para obter mais informações sobre como o [**StoServe**](structured-storage-server-sample--stoserve-.md) funciona e expõe seus serviços para o StoClien, consulte Stoserve.htm no diretório principal do tutorial.</span><span class="sxs-lookup"><span data-stu-id="8e47d-141">For more information about how [**StoServe**](structured-storage-server-sample--stoserve-.md) works and exposes its services to StoClien, see Stoserve.htm in the main tutorial directory.</span></span> <span data-ttu-id="8e47d-142">Lembre-se de que você deve criar o Stoserve.dll antes de compilar o StoClien.</span><span class="sxs-lookup"><span data-stu-id="8e47d-142">Be aware that you must build the Stoserve.dll before building StoClien.</span></span> <span data-ttu-id="8e47d-143">O makefile para [**StoServe**](structured-storage-server-sample--stoserve-.md) registra esse servidor no registro do sistema, portanto, você deve compilar [**StoServe**](structured-storage-server-sample--stoserve-.md) antes de tentar executar o StoClien.</span><span class="sxs-lookup"><span data-stu-id="8e47d-143">The makefile for [**StoServe**](structured-storage-server-sample--stoserve-.md) registers that server in the system registry, so you must build [**StoServe**](structured-storage-server-sample--stoserve-.md) before attempting to run StoClien.</span></span>

<span data-ttu-id="8e47d-144">Para obter mais informações sobre como configurar um sistema para criar e testar os exemplos de código nesta série de tutoriais COM, consulte [como criar exemplos](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="8e47d-144">For more information about setting up a system to build and test the code samples in this COM Tutorial series, see [How to Build Samples](how-to-build-samples.md).</span></span> <span data-ttu-id="8e47d-145">O makefile fornecido (MAKEFILE) é compatível com Microsoft NMAKE.</span><span class="sxs-lookup"><span data-stu-id="8e47d-145">The supplied makefile (MAKEFILE) is Microsoft NMAKE-compatible.</span></span> <span data-ttu-id="8e47d-146">Para criar uma compilação de depuração, emita o comando NMAKE na janela do prompt de comando.</span><span class="sxs-lookup"><span data-stu-id="8e47d-146">To create a debug build, issue the NMAKE command in the command prompt window.</span></span>

<span data-ttu-id="8e47d-147">Para sua conveniência, um arquivo de projeto é fornecido para cada exemplo para uso em Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8e47d-147">For convenience, a project file is provided for each sample for use in Microsoft Visual Studio.</span></span> <span data-ttu-id="8e47d-148">Para carregar o projeto para o exemplo [StoClien](structured-storage-client-sample--stoclien-.md) , execute o Visual Studio no prompt de comando no diretório de exemplo da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="8e47d-148">To load the project for the [StoClien](structured-storage-client-sample--stoclien-.md) sample, run Visual Studio at the command prompt in the sample directory as follows:</span></span>

<span data-ttu-id="8e47d-149">MSDEV STOCLIEN. DSP</span><span class="sxs-lookup"><span data-stu-id="8e47d-149">MSDEV STOCLIEN.DSP</span></span>

<span data-ttu-id="8e47d-150">Você também pode clicar duas vezes no arquivo Stoclient. Dsp no Windows Explorer para carregar um projeto de exemplo no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8e47d-150">You can also double-click the Stoclient.dsp file in Windows Explorer to load a sample project into Visual Studio.</span></span> <span data-ttu-id="8e47d-151">No Visual Studio, você pode procurar as classes C++ da fonte de exemplo e geralmente executar as outras operações de edição-compilação-depuração.</span><span class="sxs-lookup"><span data-stu-id="8e47d-151">In Visual Studio, you can browse the C++ classes of the sample source and generally perform the other edit-compile-debug operations.</span></span> <span data-ttu-id="8e47d-152">Lembre-se de que, como parte do SDK do servidor, a compilação desses exemplos de dentro do Visual Studio requer a configuração apropriada dos caminhos de diretório no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8e47d-152">Be aware that, as part of the Server SDK, the compilation of these samples from within Visual Studio requires the proper setting of directory paths in Visual Studio.</span></span> <span data-ttu-id="8e47d-153">Para obter mais informações, consulte [como criar exemplos](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="8e47d-153">For more information, see [How to Build Samples](how-to-build-samples.md).</span></span>

## <a name="remarks"></a><span data-ttu-id="8e47d-154">Comentários</span><span class="sxs-lookup"><span data-stu-id="8e47d-154">Remarks</span></span>

<span data-ttu-id="8e47d-155">O exemplo de cliente e outros exemplos relacionados devem ser compilados antes que você possa executar o cliente.</span><span class="sxs-lookup"><span data-stu-id="8e47d-155">The client sample and other related samples must be compiled before you can run the client.</span></span> <span data-ttu-id="8e47d-156">Para obter mais informações sobre como criar exemplos, consulte [como criar exemplos](how-to-build-samples.md).</span><span class="sxs-lookup"><span data-stu-id="8e47d-156">For more information about building the samples, see [How to Build Samples](how-to-build-samples.md).</span></span> <span data-ttu-id="8e47d-157">Se você tiver criado os exemplos apropriados, Stoclien.exe será o executável do cliente a ser executado para este exemplo.</span><span class="sxs-lookup"><span data-stu-id="8e47d-157">If you have built the appropriate samples, Stoclien.exe is the client executable to run for this sample.</span></span>

<span data-ttu-id="8e47d-158">O aplicativo Stoclien.exe fornece a interface do usuário para este tutorial.</span><span class="sxs-lookup"><span data-stu-id="8e47d-158">The Stoclien.exe application provides the user interface for this tutorial.</span></span> <span data-ttu-id="8e47d-159">Ele exercita as Stoserve.dll associadas, mas independentes, para demonstrar o uso do cliente e do servidor do armazenamento estruturado COM em arquivos compostos.</span><span class="sxs-lookup"><span data-stu-id="8e47d-159">It exercises the associated, but independent, Stoserve.dll to demonstrate both client and server use of COM structured storage in compound files.</span></span>

 

 




