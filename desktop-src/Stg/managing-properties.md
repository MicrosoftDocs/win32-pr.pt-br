---
title: Gerenciando Propriedades
description: Cada propriedade consiste em um identificador de propriedade (exclusivo dentro de seu conjunto de propriedades), uma marca de tipo Variant (VT ou VarType) que representa o tipo de um valor e o próprio valor.
ms.assetid: d220ecb4-b014-4ac9-a636-9a493187cc87
keywords:
- Armazenamento estruturado Strctd STG, usando, gerenciando Propriedades
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 10dd78a1f8a8484090728dba6fe149840e940461
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103823831"
---
# <a name="managing-properties"></a><span data-ttu-id="00721-104">Gerenciando Propriedades</span><span class="sxs-lookup"><span data-stu-id="00721-104">Managing Properties</span></span>

<span data-ttu-id="00721-105">Cada propriedade consiste em um *identificador de propriedade* (exclusivo dentro de seu conjunto de propriedades), uma *marca de tipo Variant (VT ou VARTYPE)* que representa o tipo de um valor e o próprio *valor* .</span><span class="sxs-lookup"><span data-stu-id="00721-105">Every property consists of a *property identifier* (unique within its property set), a *variant type (VT or VarType) tag* that represents the type of a value, and the *value* itself.</span></span> <span data-ttu-id="00721-106">A marca tipo Variant descreve a representação dos dados no valor.</span><span class="sxs-lookup"><span data-stu-id="00721-106">The variant type tag describes the representation of the data in the value.</span></span> <span data-ttu-id="00721-107">Além disso, uma propriedade também pode ser atribuída a um *nome de cadeia de caracteres* que pode ser usado para identificar a propriedade, em vez de usar o identificador de propriedade numérica (ID) necessário.</span><span class="sxs-lookup"><span data-stu-id="00721-107">In addition, a property may also be assigned a *string name* that can be used to identify the property, rather than using the required numerical property identifier (ID).</span></span> <span data-ttu-id="00721-108">Para criar e gerenciar Propriedades, COM define a interface [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) .</span><span class="sxs-lookup"><span data-stu-id="00721-108">To create and manage properties, COM defines the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface.</span></span>

<span data-ttu-id="00721-109">A interface [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) inclui métodos para ler e gravar matrizes de propriedades ou nomes de propriedade.</span><span class="sxs-lookup"><span data-stu-id="00721-109">The [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interface includes methods to read and write arrays of either properties or property names.</span></span> <span data-ttu-id="00721-110">A interface inclui os métodos [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) e [**REVERT**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) que são semelhantes aos métodos [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) de mesmo nome.</span><span class="sxs-lookup"><span data-stu-id="00721-110">The interface includes [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) and [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) methods that are similar to [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) methods of the same name.</span></span> <span data-ttu-id="00721-111">Há métodos de utilitário que permitem definir o identificador de classe (CLSID) do conjunto de propriedades, definir os horários associados ao conjunto e obter estatísticas sobre o conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="00721-111">There are utility methods that allow you to set the class identifier (CLSID) of the property set, set the times associated with the set, and get statistics about the property set.</span></span> <span data-ttu-id="00721-112">Por fim, o método [**enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) cria um enumerador e retorna um ponteiro para sua interface [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) .</span><span class="sxs-lookup"><span data-stu-id="00721-112">Finally, the [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) method creates an enumerator and returns a pointer to its [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) interface.</span></span> <span data-ttu-id="00721-113">Você pode chamar os métodos dessa interface para enumerar estruturas [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) em seu objeto, o que fornecerá informações sobre todas as propriedades no conjunto de propriedades atual.</span><span class="sxs-lookup"><span data-stu-id="00721-113">You can call the methods of this interface to enumerate [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) structures on your object, which will provide information about all of the properties in the current property set.</span></span>

<span data-ttu-id="00721-114">Veja a seguir um exemplo de como as propriedades são representadas.</span><span class="sxs-lookup"><span data-stu-id="00721-114">The following is an example of how properties are represented.</span></span> <span data-ttu-id="00721-115">Se uma propriedade específica em um conjunto de propriedades mantiver o nome científico de um animal, esse nome poderá ser armazenado como uma cadeia de caracteres terminada em zero.</span><span class="sxs-lookup"><span data-stu-id="00721-115">If a specific property in a property set holds an animal's scientific name, that name could be stored as a zero-terminated string.</span></span> <span data-ttu-id="00721-116">Armazenado junto com o nome seria um indicador de tipo para indicar que o valor é uma cadeia de caracteres terminada em zero.</span><span class="sxs-lookup"><span data-stu-id="00721-116">Stored along with the name would be a type indicator to indicate that the value is a zero-terminated string.</span></span> <span data-ttu-id="00721-117">Essas propriedades podem ter as seguintes características:</span><span class="sxs-lookup"><span data-stu-id="00721-117">These properties might have the following characteristics:</span></span>



| <span data-ttu-id="00721-118">ID da propriedade</span><span class="sxs-lookup"><span data-stu-id="00721-118">Property ID</span></span> | <span data-ttu-id="00721-119">Identificador de cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="00721-119">String identifier</span></span> | <span data-ttu-id="00721-120">Indicador de tipo</span><span class="sxs-lookup"><span data-stu-id="00721-120">Type indicator</span></span> | <span data-ttu-id="00721-121">Valor representado</span><span class="sxs-lookup"><span data-stu-id="00721-121">Value represented</span></span>              |
|-------------|-------------------|----------------|--------------------------------|
| <span data-ttu-id="00721-122">02</span><span class="sxs-lookup"><span data-stu-id="00721-122">02</span></span>          | <span data-ttu-id="00721-123">DTI \_ animalName</span><span class="sxs-lookup"><span data-stu-id="00721-123">PID\_ANIMALNAME</span></span>   | <span data-ttu-id="00721-124">LPWStr do VT \_</span><span class="sxs-lookup"><span data-stu-id="00721-124">VT\_LPWSTR</span></span>     | <span data-ttu-id="00721-125">Cadeia de caracteres Unicode terminada em zero</span><span class="sxs-lookup"><span data-stu-id="00721-125">Zero-terminated Unicode string</span></span> |
| <span data-ttu-id="00721-126">03</span><span class="sxs-lookup"><span data-stu-id="00721-126">03</span></span>          | <span data-ttu-id="00721-127">DTI \_ LEGCOUNT</span><span class="sxs-lookup"><span data-stu-id="00721-127">PID\_LEGCOUNT</span></span>     | <span data-ttu-id="00721-128">\_I2 VT</span><span class="sxs-lookup"><span data-stu-id="00721-128">VT\_I2</span></span>         | <span data-ttu-id="00721-129">WORD</span><span class="sxs-lookup"><span data-stu-id="00721-129">WORD</span></span>                           |



 

<span data-ttu-id="00721-130">Qualquer aplicativo que reconheça o formato do conjunto de propriedades — identificá-lo por meio de seu identificador de formato (FMTID) — pode examinar a propriedade com um identificador de PID \_ animalName, determinar que ele é uma cadeia de caracteres terminada com zero e ler e gravar o valor.</span><span class="sxs-lookup"><span data-stu-id="00721-130">Any application that recognizes the property set format—identifying it through its format identifier (FMTID)—can look at the property with an identifier of PID\_ANIMALNAME, determine that it is a zero-terminated string, and read and write the value.</span></span> <span data-ttu-id="00721-131">Embora o aplicativo possa chamar [**IPropertyStorage:: ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) para ler qualquer ou todas as propriedades definidas (tendo obtido primeiro um ponteiro), o aplicativo deve saber como interpretar o conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="00721-131">Although the application can call [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) to read any or all of a property set (having first obtained a pointer), the application must know how to interpret the property set.</span></span>

<span data-ttu-id="00721-132">Um valor de propriedade é passado por meio de interfaces de propriedade como uma instância do tipo [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant).</span><span class="sxs-lookup"><span data-stu-id="00721-132">A property value is passed through property interfaces as an instance of the type [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant).</span></span>

<span data-ttu-id="00721-133">É importante distinguir entre essas propriedades armazenadas (persistentes) e as propriedades de tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="00721-133">It is important to distinguish between these stored (persistent) properties, and run-time properties.</span></span> <span data-ttu-id="00721-134">Constantes de valor de tipo Variant têm nomes que começam com VT \_ .</span><span class="sxs-lookup"><span data-stu-id="00721-134">Variant-type value constants have names beginning with VT\_.</span></span> <span data-ttu-id="00721-135">O conjunto de PROPVARIANTs válido, no entanto, não é totalmente equivalente ao conjunto de VARIAntes usado na automação e nos controles ActiveX.</span><span class="sxs-lookup"><span data-stu-id="00721-135">The set of valid PROPVARIANTs is, however, not entirely equivalent to the set of VARIANTs used in Automation and ActiveX controls.</span></span>

<span data-ttu-id="00721-136">A única diferença entre as duas estruturas é o conjunto permitido de marcas VT \_ (Variant Type/VARTYPE) em cada.</span><span class="sxs-lookup"><span data-stu-id="00721-136">The only difference between the two structures is the allowable set of VT\_ (Variant Type / VarType) tags in each.</span></span> <span data-ttu-id="00721-137">Onde um determinado tipo de propriedade pode ser usado em uma variante e em um PROPVARIANT, a marca de tipo (o valor de VT \_ ) sempre tem um valor idêntico.</span><span class="sxs-lookup"><span data-stu-id="00721-137">Where a certain property type can be used in both a VARIANT and a PROPVARIANT, the type tag (the VT\_ value) always has an identical value.</span></span> <span data-ttu-id="00721-138">Além disso, para um determinado \_ valor de VT, a representação na memória usada em variantes e PROPVARIANTs é idêntica.</span><span class="sxs-lookup"><span data-stu-id="00721-138">Further, for a given VT\_ value, the in-memory representation used in VARIANTs and PROPVARIANTs is identical.</span></span> <span data-ttu-id="00721-139">Juntos, essa abordagem permite que o sistema de tipos pegue marcas de tipo não permitido, enquanto, ao mesmo tempo, permite que um cliente experiente implemente uma conversão de ponteiro quando apropriado.</span><span class="sxs-lookup"><span data-stu-id="00721-139">Taken all together, this approach allows the type system to catch disallowed type tags, while at the same time allowing a knowledgeable client to implement a pointer cast when appropriate.</span></span>

<span data-ttu-id="00721-140">Para obter mais informações, consulte a seção a seguir [considerações de armazenamento de propriedade](property-storage-considerations.md).</span><span class="sxs-lookup"><span data-stu-id="00721-140">For more information, see the following section, [Property Storage Considerations](property-storage-considerations.md).</span></span>

 

 