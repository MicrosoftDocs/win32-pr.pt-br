---
title: Interfaces de armazenamento estruturado
description: Os serviços de armazenamento estruturados são organizados em três categorias de interfaces.
ms.assetid: a4281f07-eae4-4bcb-8d16-b6c0bd3c5b21
keywords:
- Interfaces de armazenamento estruturado
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0010a0d4dec4908111c8a5bb939f795f0a2b2eb3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "105756356"
---
# <a name="structured-storage-interfaces"></a><span data-ttu-id="586df-104">Interfaces de armazenamento estruturado</span><span class="sxs-lookup"><span data-stu-id="586df-104">Structured Storage Interfaces</span></span>

<span data-ttu-id="586df-105">Os serviços de armazenamento estruturados são organizados em três categorias de [interfaces](interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="586df-105">Structured Storage services are organized into three categories of [interfaces](interfaces.md).</span></span> <span data-ttu-id="586df-106">Cada conjunto representa um nível sucessivo de indireção ou abstração entre um arquivo composto, os objetos que ele contém e a mídia física na qual esses componentes individuais são armazenados.</span><span class="sxs-lookup"><span data-stu-id="586df-106">Each set represents a successive level of indirection or abstraction between a compound file, the objects it contains, and the physical media in which these individual components are stored.</span></span>

<span data-ttu-id="586df-107">A primeira categoria de interfaces consiste em [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage), [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream)e [**IRootStorage**](/windows/desktop/api/Objidl/nn-objidl-irootstorage).</span><span class="sxs-lookup"><span data-stu-id="586df-107">The first category of interfaces consists of [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage), [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream), and [**IRootStorage**](/windows/desktop/api/Objidl/nn-objidl-irootstorage).</span></span> <span data-ttu-id="586df-108">As duas primeiras interfaces definem como os objetos são armazenados em um arquivo composto.</span><span class="sxs-lookup"><span data-stu-id="586df-108">The first two interfaces define how objects are stored within a compound file.</span></span> <span data-ttu-id="586df-109">Essas interfaces fornecem métodos para abrir elementos de armazenamento, confirmar e reverter alterações, copiar e mover elementos e ler e gravar fluxos.</span><span class="sxs-lookup"><span data-stu-id="586df-109">These interfaces provide methods for opening storage elements, committing and reverting changes, copying and moving elements, and reading and writing streams.</span></span> <span data-ttu-id="586df-110">Essas interfaces não reconhecem os formatos de dados nativos dos objetos individuais e, portanto, não têm nenhum método para salvar esses objetos no armazenamento persistente.</span><span class="sxs-lookup"><span data-stu-id="586df-110">These interfaces do not recognize the native data formats of the individual objects and therefore have no methods for saving those objects to persistent storage.</span></span> <span data-ttu-id="586df-111">A interface **IRootStorage** tem um único método para associar um documento composto a um nome de sistema de arquivos subjacente.</span><span class="sxs-lookup"><span data-stu-id="586df-111">The **IRootStorage** interface has a single method for associating a compound document with an underlying file system name.</span></span> <span data-ttu-id="586df-112">Os clientes devem implementar essas interfaces para seus arquivos compostos.</span><span class="sxs-lookup"><span data-stu-id="586df-112">Clients must implement these interfaces for their compound files.</span></span>

<span data-ttu-id="586df-113">A segunda categoria de interfaces consiste nas interfaces [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist) , que os objetos implementam para gerenciar seus dados persistentes.</span><span class="sxs-lookup"><span data-stu-id="586df-113">The second category of interfaces consists of the [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist) interfaces, which objects implement to manage their persistent data.</span></span> <span data-ttu-id="586df-114">Essas interfaces fornecem métodos para ler os formatos de dados de objetos individuais e, portanto, sabem como armazená-los.</span><span class="sxs-lookup"><span data-stu-id="586df-114">These interfaces provide methods to read the data formats of individual objects and therefore know how to store them.</span></span> <span data-ttu-id="586df-115">Os objetos são responsáveis por implementar essas interfaces porque os clientes não conhecem os formatos de dados nativos de seus objetos aninhados.</span><span class="sxs-lookup"><span data-stu-id="586df-115">Objects are responsible for implementing these interfaces because clients do not know the native data formats of their nested objects.</span></span> <span data-ttu-id="586df-116">No entanto, essas interfaces não têm conhecimento de mídia de armazenamento físico específica.</span><span class="sxs-lookup"><span data-stu-id="586df-116">These interfaces, however, have no knowledge of specific physical storage media.</span></span>

<span data-ttu-id="586df-117">Uma terceira categoria consiste em uma única interface, [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes), que fornece métodos para gravar arquivos em mídia física específica, como um disco rígido ou uma unidade de fita.</span><span class="sxs-lookup"><span data-stu-id="586df-117">A third category consists of a single interface, [**ILockBytes**](/windows/desktop/api/Objidl/nn-objidl-ilockbytes), which provides methods for writing files to specific physical media, such as a hard disk or tape drive.</span></span> <span data-ttu-id="586df-118">No entanto, a maioria dos aplicativos não implementará a interface **ILockBytes** porque o com já fornece implementações para as duas situações mais comuns, que são implementação baseada em arquivo e implementação baseada em memória.</span><span class="sxs-lookup"><span data-stu-id="586df-118">However, most applications will not implement the **ILockBytes** interface because COM already provides implementations for the two most common situations, which are File-based implementation and Memory-based implementation.</span></span> <span data-ttu-id="586df-119">O objeto de armazenamento de arquivo composto chama os métodos **ILockBytes** que você não os chama diretamente na implementação.</span><span class="sxs-lookup"><span data-stu-id="586df-119">The compound file storage object calls the **ILockBytes** methods you do not call them directly in the implementation.</span></span>

## <a name="compound-file-implementation-limits"></a><span data-ttu-id="586df-120">Limites de implementação de arquivo composto</span><span class="sxs-lookup"><span data-stu-id="586df-120">Compound File Implementation Limits</span></span>

<span data-ttu-id="586df-121">A implementação COM da arquitetura de armazenamento estruturado é chamada de *arquivos compostos*.</span><span class="sxs-lookup"><span data-stu-id="586df-121">The COM implementation of Structured Storage architecture is called *compound files*.</span></span> <span data-ttu-id="586df-122">Os objetos de armazenamento, conforme implementados em arquivos compostos, incluem uma implementação das interfaces [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) e [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) .</span><span class="sxs-lookup"><span data-stu-id="586df-122">Storage objects, as implemented in compound files, include an implementation of the [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) and [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interfaces.</span></span>

<span data-ttu-id="586df-123">Ponteiros para a implementação de arquivo composto dessas interfaces são adquiridos chamando a função [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) para criar um novo objeto de arquivo composto ou [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) para abrir um arquivo composto criado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="586df-123">Pointers to the compound file implementation of these interfaces are acquired by calling the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) function to create a new compound file object, or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) to open a previously created compound file.</span></span>

<span data-ttu-id="586df-124">Um método alternativo para adquirir um ponteiro para a implementação do arquivo composto dessas interfaces é chamar a função [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) ou [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) mais antiga e limitada.</span><span class="sxs-lookup"><span data-stu-id="586df-124">An alternative method for acquiring a pointer to the compound file implementation of these interfaces is by calling the older and more limited [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) or [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) function.</span></span> <span data-ttu-id="586df-125">Todas as quatro funções são tratadas como implementações de arquivo composto.</span><span class="sxs-lookup"><span data-stu-id="586df-125">All four functions are treated as compound file implementations.</span></span>

<span data-ttu-id="586df-126">A implementação do arquivo composto pode ser configurada para usar os setores de 512 ou 4096 bytes, conforme definido na estrutura [**STGOPTIONS**](/windows/win32/api/coml2api/ns-coml2api-stgoptions) .</span><span class="sxs-lookup"><span data-stu-id="586df-126">The compound file implementation can be configured to use 512 or 4096 byte sectors, as defined in the [**STGOPTIONS**](/windows/win32/api/coml2api/ns-coml2api-stgoptions) structure.</span></span>

<span data-ttu-id="586df-127">A implementação do arquivo composto de arquivos compostos está sujeita às seguintes restrições de implementação.</span><span class="sxs-lookup"><span data-stu-id="586df-127">The compound file implementation of compound files is subject to the following implementation constraints.</span></span>



| <span data-ttu-id="586df-128">Limite</span><span class="sxs-lookup"><span data-stu-id="586df-128">Limit</span></span>                                           | <span data-ttu-id="586df-129">Arquivo composto</span><span class="sxs-lookup"><span data-stu-id="586df-129">Compound file</span></span>                                                                                                                                                                      |
|-------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="586df-130">Limites de tamanho do arquivo:</span><span class="sxs-lookup"><span data-stu-id="586df-130">File size limits:</span></span>                               | <span data-ttu-id="586df-131">512:2 gigabytes (GB) 4096: até os limites do sistema de arquivos</span><span class="sxs-lookup"><span data-stu-id="586df-131">512: 2 gigabytes (GB) 4096: Up to file system limits</span></span><br/>                                                                                                                    |
| <span data-ttu-id="586df-132">Tamanho máximo de heap necessário para elementos abertos:</span><span class="sxs-lookup"><span data-stu-id="586df-132">Maximum heap size required for open elements:</span></span>   | <span data-ttu-id="586df-133">512:4 megabytes (MB) 4096: até limites de memória virtual</span><span class="sxs-lookup"><span data-stu-id="586df-133">512: 4 megabytes (MB) 4096: Up to virtual memory limits</span></span><br/>                                                                                                                 |
| <span data-ttu-id="586df-134">Aberturas de raiz simultâneas (abre do mesmo arquivo):</span><span class="sxs-lookup"><span data-stu-id="586df-134">Concurrent root opens (opens of the same file):</span></span> | <span data-ttu-id="586df-135">Se STGM \_ Read e STGM \_ share \_ Deny \_ Write forem especificados, os limites serão determinados pelos limites do sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="586df-135">If STGM\_READ and STGM\_SHARE\_DENY\_WRITE are specified, limits are dictated by the file-system limits.</span></span> <span data-ttu-id="586df-136">Caso contrário, há um limite de 20 aberturas de raiz simultâneas do mesmo arquivo.</span><span class="sxs-lookup"><span data-stu-id="586df-136">Otherwise, there is a limit of 20 concurrent root opens of the same file.</span></span> |
| <span data-ttu-id="586df-137">Número de elementos em um arquivo:</span><span class="sxs-lookup"><span data-stu-id="586df-137">Number of elements in a file:</span></span>                   | <span data-ttu-id="586df-138">512: ilimitado, mas o desempenho pode diminuir se o número de elementos nos milhares 4096: ilimitado</span><span class="sxs-lookup"><span data-stu-id="586df-138">512: Unlimited, but performance may degrade if elements number in the thousands 4096: Unlimited</span></span><br/>                                                                         |



 

<span data-ttu-id="586df-139">Devido ao limite de tamanho de heap de 4 MB, o número de elementos abertos no modo transacionado é normalmente limitado a vários milhares de elementos.</span><span class="sxs-lookup"><span data-stu-id="586df-139">Due to the 4-MB heap-size limit, the number of open elements in transacted mode is typically limited to several thousand elements.</span></span>

 

