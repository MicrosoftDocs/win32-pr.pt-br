---
title: Constantes PROPSETFLAG (Propidl.h)
description: Definir características de um conjunto de propriedades.
ms.assetid: 6f865c8f-bbca-4122-b076-14f2bc56f292
topic_type:
- apiref
api_name:
- PROPSETFLAG_DEFAULT
- PROPSETFLAG_NONSIMPLE
- PROPSETFLAG_ANSI
- PROPSETFLAG_UNBUFFERED
- PROPSETFLAG_CASE_SENSITIVE
api_location:
- Propidl.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: ca7c2f3566ca55dd82bc86cfbc7aa141eec629a47258f89662eef3d347ee5408
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/11/2021
ms.locfileid: "117960698"
---
# <a name="propsetflag-constants"></a>Constantes PROPSETFLAG

As constantes PROPSETFLAG definem características de um conjunto de propriedades. Os valores, listados na tabela a seguir, são usados no parâmetro *grfFlags* dos métodos [**IPropertySetStorage,**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) na [**função StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) e na [**função StgOpenPropStg.**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg)



| Constante/valor                                                                                                                                                                                                                                               | Descrição                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="PROPSETFLAG_DEFAULT"></span><span id="propsetflag_default"></span><dl> <dt>**PROPSETFLAG \_ DEFAULT**</dt> <dt>0</dt> </dl>                       | Se não for especificado, por padrão, somente valores de propriedade simples poderão ser gravados no conjunto de propriedades. O uso de valores de propriedade simples impede que conjuntos de propriedades são transacionados no arquivo composto e implementações autônomos de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage). Os valores de propriedade não e devem ser usados para essa finalidade.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span id="PROPSETFLAG_NONSIMPLE"></span><span id="propsetflag_nonsimple"></span><dl> <dt>**PROPSETFLAG \_ NONSIMPLE**</dt> <dt>1</dt> </dl>                 | Se especificado, valores de propriedade não simples podem ser gravados no conjunto de propriedades e o conjunto de propriedades é salvo em um objeto de armazenamento. Os valores de propriedade não simples incluem aqueles com um VARTYPE de ARMAZENAMENTO \_ VT, FLUXO de \_ VT, OBJETO ARMAZENADO VT ou \_ OBJETO \_ STREAMED \_ VT. \_ Se esse sinalizador não for especificado, tipos não simples não poderão ser gravados no conjunto de propriedades. No arquivo composto e implementações autônomos, os conjuntos de propriedades poderão ser transacionados somente se **PROPSETFLAG \_ NONSIMPLE** for especificado.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="PROPSETFLAG_ANSI"></span><span id="propsetflag_ansi"></span><dl> <dt>**PROPSETFLAG \_ ANSI**</dt> <dt>2</dt> </dl>                                | Se especificado, todos os valores de cadeia de caracteres no conjunto de propriedades que não são Unicode explicitamente, ou seja, aqueles que não sejam o VT LPWSTR, serão armazenados com a página de código ANSI do sistema \_ atual. Para obter mais informações, [**consulte GetACP**](/windows/desktop/api/winnls/nf-winnls-getacp). O uso desse valor não é recomendado. Para obter mais informações, consulte Comentários.<br/> Se esse valor estiver ausente, os valores de cadeia de caracteres no novo conjunto de propriedades serão armazenados em Unicode. O grau de controle que esse valor fornece é necessário para que os clientes que usam as interfaces relacionadas à propriedade possam interoperar com conjuntos de propriedades padrão, como as informações de resumo OLE2, que podem existir na página de código ANSI.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span id="PROPSETFLAG_UNBUFFERED"></span><span id="propsetflag_unbuffered"></span><dl> <dt>**PROPSETFLAG \_ UNBUFFERED**</dt> <dt>4</dt> </dl>              | Usado somente com as [**funções StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) [**e StgOpenPropStg;**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) ou seja, nas implementações autônomos de interfaces de conjunto de propriedades. Se especificado nessas funções, as alterações no conjunto de propriedades não serão armazenados em buffer. Em vez disso, as alterações são sempre escritas diretamente no conjunto de propriedades. Chamadas para um conjunto de [**propriedades métodos IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) o alterarão. No entanto, por padrão, as alterações são armazenadas em buffer em um cache de conjunto de propriedades interno e subsequentemente são escritas na propriedade definida quando o método [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) é chamado. <br/> Definir **PROPSETFLAG \_ UNBUFFERED** diminui o desempenho porque o buffer interno do conjunto de propriedades é liberado automaticamente após cada alteração no conjunto de propriedades. No entanto, escrever alterações diretamente impedirá problemas de coordenação. Por exemplo, se o objeto de armazenamento for aberto no modo transacionado e o conjunto de propriedades for armazenado em buffer. Em seguida, se você chamar o método [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) no objeto de armazenamento, as alterações do conjunto de propriedades não serão escolhidas como parte da transação, pois elas estão em um buffer que ainda não foi liberado. Você deve chamar [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) antes de chamar **IStorage::Commit** para liberar o buffer do conjunto de propriedades antes de fazer alterações no armazenamento. Como alternativa para fazer duas chamadas, você pode definir **PROPSETFLAG \_ UNBUFFERED** para que as alterações sejam sempre escritas diretamente no conjunto de propriedades e nunca sejam armazenadas em buffer no cache interno do conjunto de propriedades. Em seguida, as alterações serão escolhidas quando o armazenamento transacionado for confirmado.<br/> |
| <span id="PROPSETFLAG_CASE_SENSITIVE"></span><span id="propsetflag_case_sensitive"></span><dl> <dt>**PROPSETFLAG \_ CASE \_ SENSITIVE**</dt> <dt>8</dt> </dl> | Se especificado, os nomes de propriedade serão sensíveis a minúsculas. Os nomes de propriedade que fazem uso de minúsculas só são possíveis no formato de serialização do conjunto de propriedades da versão 1. Para obter mais informações, consulte [Serialização do conjunto de propriedades](version-0-vs--version-1-property-set-serialization.md).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |



## <a name="remarks"></a>Comentários

Esses valores podem ser definidos e verificados usando operações bit a bit que determinam como os conjuntos de propriedades são criados e abertos. Os conjuntos de propriedades são criados [**usando o método IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) ou a [**função StgCreatePropStg.**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) Eles são abertos usando o [**método IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) ou a [**função StgOpenPropStg.**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg)

É recomendável que os conjuntos de propriedades sejam criados como Unicode não definindo o sinalizador **\_ ANSI PROPSETFLAG** no *parâmetro grfFlags.* Também é recomendável evitar o uso de valores LPSTR de VT \_ e usar valores \_ LPWSTR de VT. Quando a página de código do conjunto de propriedades é Unicode, os valores de cadeia de caracteres LPSTR VT são convertidos em Unicode quando armazenados e convertidos novamente em valores de cadeia de caracteres \_ multibyte quando recuperados. Quando a página de código do conjunto de propriedades não é Unicode, nomes de propriedade, cadeias de caracteres BSTR VT e valores de propriedade não simples são convertidos em cadeias de caracteres multibyte quando armazenados e convertidos novamente em Unicode quando recuperados, tudo usando a página de código ANSI do sistema \_ atual.

## <a name="requirements"></a>Requisitos



| Requisito | Valor |
|-------------------------------------|--------------------------------------------------------------------------------------|
| Cliente mínimo com suporte<br/> | Windows 2000 Professional \[somente aplicativos da área de trabalho\]<br/>                           |
| Servidor mínimo com suporte<br/> | Windows 2000 Server \[somente aplicativos da área de trabalho\]<br/>                                 |
| Cabeçalho<br/>                   | <dl> <dt>Propidl.h</dt> </dl> |



## <a name="see-also"></a>Confira também

<dl> <dt>

[**FmtIdToPropStgName**](/windows/desktop/api/coml2api/nf-coml2api-fmtidtopropstgname)
</dt> <dt>

[**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)
</dt> <dt>

[**IPropertySetStorage::Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)
</dt> <dt>

[**PropStgNameToFmtId**](/windows/desktop/api/coml2api/nf-coml2api-propstgnametofmtid)
</dt> <dt>

[**StgCreatePropSetStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropsetstg)
</dt> <dt>

[**StgCreatePropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg)
</dt> <dt>

[**StgOpenPropStg**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg)
</dt> </dl>

 

