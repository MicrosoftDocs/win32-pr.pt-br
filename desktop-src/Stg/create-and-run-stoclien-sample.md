---
title: Criar e executar exemplo de StoClien
description: O StoClien trabalha em cooperação com um objeto de copapel em um servidor COM para obter armazenamento persistente de desenhos em arquivos compostos COM.
ms.assetid: bf622104-10dd-4649-88f0-e2bfb15289b1
keywords:
- Criar e executar exemplo de StoClien
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6f00274293c05e21e660dc8e9448ca95946cab8a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "105750422"
---
# <a name="create-and-run-stoclien-sample"></a><span data-ttu-id="8011b-104">Criar e executar exemplo de StoClien</span><span class="sxs-lookup"><span data-stu-id="8011b-104">Create and Run StoClien Sample</span></span>

<span data-ttu-id="8011b-105">O **StoClien** trabalha em cooperação com um objeto de copapel em um servidor com para obter armazenamento persistente de desenhos em arquivos compostos com.</span><span class="sxs-lookup"><span data-stu-id="8011b-105">**StoClien** works in cooperation with a COPaper object in a COM server to achieve persistent storage of drawings in COM compound files.</span></span> <span data-ttu-id="8011b-106">Para obter mais informações sobre o uso de fluxos do copaper no arquivo composto fornecido para o copaper por **StoClien**, consulte o exemplo de [**StoServe**](structured-storage-server-sample--stoserve-.md) e STOSERVE.HTM.</span><span class="sxs-lookup"><span data-stu-id="8011b-106">For more information about COPaper's use of streams in the compound file provided to COPaper by **StoClien**, see [**StoServe**](structured-storage-server-sample--stoserve-.md) sample and STOSERVE.HTM.</span></span> <span data-ttu-id="8011b-107">A construção de copapel e sua interface IPaper também são abordadas no exemplo de **StoServe** .</span><span class="sxs-lookup"><span data-stu-id="8011b-107">COPaper's construction and its IPaper interface are also covered in the **StoServe** sample.</span></span>

## <a name="code-tour"></a><span data-ttu-id="8011b-108">Tour pelo código</span><span class="sxs-lookup"><span data-stu-id="8011b-108">Code Tour</span></span>

<span data-ttu-id="8011b-109">Os principais tópicos abordados neste Tour de código são:</span><span class="sxs-lookup"><span data-stu-id="8011b-109">The major topics covered in this code tour are:</span></span>

-   <span data-ttu-id="8011b-110">Como o **CGuiPaper** encapsula o comportamento de GUI do papel de desenho eletrônico do **StoClien**</span><span class="sxs-lookup"><span data-stu-id="8011b-110">How **CGuiPaper** encapsulates the GUI behavior of **StoClien**'s electronic drawing paper</span></span>
-   <span data-ttu-id="8011b-111">Como o **StoClien** captura e exibe a atividade de desenho interativa</span><span class="sxs-lookup"><span data-stu-id="8011b-111">How **StoClien** captures and displays interactive drawing activity</span></span>
-   <span data-ttu-id="8011b-112">Como o objeto **CGuiPaper** usa o copapel para gravar dados de desenho</span><span class="sxs-lookup"><span data-stu-id="8011b-112">How the **CGuiPaper** object uses COPaper to record drawing data</span></span>
-   <span data-ttu-id="8011b-113">Como uma conexão IPaperSink é usada na repintura</span><span class="sxs-lookup"><span data-stu-id="8011b-113">How an IPaperSink connection is used in repainting</span></span>
-   <span data-ttu-id="8011b-114">Como os métodos **Load** e **Save** do CPapFile usam o armazenamento estruturado em arquivos compostos</span><span class="sxs-lookup"><span data-stu-id="8011b-114">How the CPapFile **Load** and **Save** methods use the structured storage in compound files</span></span>

<span data-ttu-id="8011b-115">Como a classe **CGuiBall** usada nos exemplos FRECLIEN e CONCLIEN encapsulava o comportamento de uma bola de saltação, **StoClien** usa uma classe **CGuiPaper** do C++ para encapsular os dados e o comportamento da GUI do papel de desenho eletrônico.</span><span class="sxs-lookup"><span data-stu-id="8011b-115">As the **CGuiBall** class used in the FRECLIEN and CONCLIEN samples encapsulated the behavior of a bouncing ball, **StoClien** uses a **CGuiPaper** C++ class to encapsulate the data and GUI behavior of electronic drawing paper.</span></span>

<span data-ttu-id="8011b-116">A tabela a seguir lista os arquivos pertinentes ao exemplo de **StoClien** .</span><span class="sxs-lookup"><span data-stu-id="8011b-116">The following table lists the files pertinent to the **StoClien** sample.</span></span>



| <span data-ttu-id="8011b-117">Arquivos</span><span class="sxs-lookup"><span data-stu-id="8011b-117">Files</span></span>        | <span data-ttu-id="8011b-118">Descrição</span><span class="sxs-lookup"><span data-stu-id="8011b-118">Description</span></span>                                                                                                                      |
|--------------|----------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="8011b-119">STOCLIEN.TXT</span><span class="sxs-lookup"><span data-stu-id="8011b-119">STOCLIEN.TXT</span></span> | <span data-ttu-id="8011b-120">Breve descrição da amostra.</span><span class="sxs-lookup"><span data-stu-id="8011b-120">Short sample description.</span></span>                                                                                                        |
| <span data-ttu-id="8011b-121">MAKEFILE</span><span class="sxs-lookup"><span data-stu-id="8011b-121">MAKEFILE</span></span>     | <span data-ttu-id="8011b-122">O makefile genérico para criar o exemplo de código.</span><span class="sxs-lookup"><span data-stu-id="8011b-122">The generic makefile for building the code sample.</span></span>                                                                               |
| <span data-ttu-id="8011b-123">STOCLIEN. T</span><span class="sxs-lookup"><span data-stu-id="8011b-123">STOCLIEN.H</span></span>   | <span data-ttu-id="8011b-124">O arquivo de inclusão para o aplicativo **StoClien** .</span><span class="sxs-lookup"><span data-stu-id="8011b-124">The include file for the **StoClien** application.</span></span> <span data-ttu-id="8011b-125">Contém declarações de classe, protótipos de função e identificadores de recurso.</span><span class="sxs-lookup"><span data-stu-id="8011b-125">Contains class declarations, function prototypes, and resource identifiers.</span></span>   |
| <span data-ttu-id="8011b-126">STOCLIEN. CPP</span><span class="sxs-lookup"><span data-stu-id="8011b-126">STOCLIEN.CPP</span></span> | <span data-ttu-id="8011b-127">O arquivo de implementação principal para STOCLIEN.EXE.</span><span class="sxs-lookup"><span data-stu-id="8011b-127">The main implementation file for STOCLIEN.EXE.</span></span> <span data-ttu-id="8011b-128">Tem a implementação WinMain e CMainWindow, bem como a expedição do menu principal.</span><span class="sxs-lookup"><span data-stu-id="8011b-128">Has WinMain and CMainWindow implementation, as well as the main menu dispatching.</span></span> |
| <span data-ttu-id="8011b-129">STOCLIEN. RC</span><span class="sxs-lookup"><span data-stu-id="8011b-129">STOCLIEN.RC</span></span>  | <span data-ttu-id="8011b-130">O arquivo de definição de recurso do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8011b-130">The application resource definition file.</span></span>                                                                                        |
| <span data-ttu-id="8011b-131">STOCLIEN. ICO</span><span class="sxs-lookup"><span data-stu-id="8011b-131">STOCLIEN.ICO</span></span> | <span data-ttu-id="8011b-132">O recurso de ícone do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8011b-132">The application icon resource.</span></span>                                                                                                   |
| <span data-ttu-id="8011b-133">STOCLIEN. PAP</span><span class="sxs-lookup"><span data-stu-id="8011b-133">STOCLIEN.PAP</span></span> | <span data-ttu-id="8011b-134">Um arquivo de desenho de papel padrão para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8011b-134">A default paper drawing file for the application.</span></span>                                                                                |
| <span data-ttu-id="8011b-135">Pincel. CUR</span><span class="sxs-lookup"><span data-stu-id="8011b-135">PENCIL.CUR</span></span>   | <span data-ttu-id="8011b-136">Uma imagem de lápis para o cursor da janela do cliente.</span><span class="sxs-lookup"><span data-stu-id="8011b-136">A pencil image for the client window cursor.</span></span>                                                                                     |
| <span data-ttu-id="8011b-137">Coletar. T</span><span class="sxs-lookup"><span data-stu-id="8011b-137">SINK.H</span></span>       | <span data-ttu-id="8011b-138">A declaração de classe para a classe de objeto COPaperSink COM.</span><span class="sxs-lookup"><span data-stu-id="8011b-138">The class declaration for the COPaperSink COM object class.</span></span>                                                                      |
| <span data-ttu-id="8011b-139">Coletar. CPP</span><span class="sxs-lookup"><span data-stu-id="8011b-139">SINK.CPP</span></span>     | <span data-ttu-id="8011b-140">Arquivo de implementação para a classe de objeto COPaperSink COM.</span><span class="sxs-lookup"><span data-stu-id="8011b-140">Implementation file for the COPaperSink COM object class.</span></span>                                                                        |
| <span data-ttu-id="8011b-141">PAPFILE. T</span><span class="sxs-lookup"><span data-stu-id="8011b-141">PAPFILE.H</span></span>    | <span data-ttu-id="8011b-142">A declaração de classe para a classe **CPapFile** C++.</span><span class="sxs-lookup"><span data-stu-id="8011b-142">The class declaration for the **CPapFile** C++ class.</span></span>                                                                            |
| <span data-ttu-id="8011b-143">PAPFILE. CPP</span><span class="sxs-lookup"><span data-stu-id="8011b-143">PAPFILE.CPP</span></span>  | <span data-ttu-id="8011b-144">Arquivo de implementação para a classe **CPapFile** C++.</span><span class="sxs-lookup"><span data-stu-id="8011b-144">Implementation file for the **CPapFile** C++ class.</span></span>                                                                              |
| <span data-ttu-id="8011b-145">GUIPAPER. T</span><span class="sxs-lookup"><span data-stu-id="8011b-145">GUIPAPER.H</span></span>   | <span data-ttu-id="8011b-146">A declaração de classe para a classe **CGuiPaper** C++.</span><span class="sxs-lookup"><span data-stu-id="8011b-146">The class declaration for the **CGuiPaper** C++ class.</span></span>                                                                           |
| <span data-ttu-id="8011b-147">GUIPAPER. CPP</span><span class="sxs-lookup"><span data-stu-id="8011b-147">GUIPAPER.CPP</span></span> | <span data-ttu-id="8011b-148">Arquivo de implementação para a classe **CGuiPaper** C++.</span><span class="sxs-lookup"><span data-stu-id="8011b-148">Implementation file for the **CGuiPaper** C++ class.</span></span>                                                                             |
| <span data-ttu-id="8011b-149">STOCLIEN. DSP</span><span class="sxs-lookup"><span data-stu-id="8011b-149">STOCLIEN.DSP</span></span> | <span data-ttu-id="8011b-150">Microsoft Visual Studio arquivo de projeto.</span><span class="sxs-lookup"><span data-stu-id="8011b-150">Microsoft Visual Studio Project file.</span></span>                                                                                            |



 

## <a name="compound-files"></a><span data-ttu-id="8011b-151">arquivos compostos</span><span class="sxs-lookup"><span data-stu-id="8011b-151">Compound Files</span></span>

<span data-ttu-id="8011b-152">O **StoClien** se baseia em copapel para gravar dados de desenho.</span><span class="sxs-lookup"><span data-stu-id="8011b-152">**StoClien** relies on COPaper to record drawing data.</span></span> <span data-ttu-id="8011b-153">Ele também se baseia em copapel para armazenar os dados em um arquivo composto.</span><span class="sxs-lookup"><span data-stu-id="8011b-153">It also relies on COPaper to store the data in a compound file.</span></span> <span data-ttu-id="8011b-154">No entanto, em uma divisão típica de trabalho entre o cliente COM e o servidor, o **StoClien** compartilha parte da responsabilidade pelo armazenamento de arquivos.</span><span class="sxs-lookup"><span data-stu-id="8011b-154">However, in a typical division of labor between COM client and server, **StoClien** shares part of the responsibility for file storage.</span></span> <span data-ttu-id="8011b-155">Essa divisão de trabalho é importante em aplicativos COM em que o cliente é um contêiner e o servidor é um objeto incorporado.</span><span class="sxs-lookup"><span data-stu-id="8011b-155">This division of labor is important in COM applications where the client is a container and the server is an embedded object.</span></span> <span data-ttu-id="8011b-156">Nesse arranjo, o cliente é responsável por criar ou abrir um arquivo de armazenamento estruturado, enquanto o objeto de servidor é responsável por usar esse armazenamento para suas próprias finalidades de armazenamento de dados.</span><span class="sxs-lookup"><span data-stu-id="8011b-156">In this arrangement, the client is responsible for creating or opening a structured storage file, while the server object is responsible for using that storage for its own data storage purposes.</span></span> <span data-ttu-id="8011b-157">Isso pode envolver o objeto de servidor que cria subarmazenamentos no armazenamento que é fornecido a ele.</span><span class="sxs-lookup"><span data-stu-id="8011b-157">This may involve the server object creating substorages in the storage that is given to it.</span></span> <span data-ttu-id="8011b-158">Em geral, ele envolve o objeto Server criando objetos Stream no armazenamento.</span><span class="sxs-lookup"><span data-stu-id="8011b-158">It usually involves the server object creating stream objects in the storage.</span></span> <span data-ttu-id="8011b-159">O uso de fluxos de armazenamento do copaper é detalhado no exemplo de **StoClien** .</span><span class="sxs-lookup"><span data-stu-id="8011b-159">COPaper's use of storage streams is detailed in the **StoClien** sample.</span></span>

<span data-ttu-id="8011b-160">A interface [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) é usada pelo objeto de cliente e de servidor para executar operações de arquivo.</span><span class="sxs-lookup"><span data-stu-id="8011b-160">The [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface is used by both client and server object to perform file operations.</span></span> <span data-ttu-id="8011b-161">A implementação dos arquivos compostos da arquitetura de armazenamento estruturado é usada.</span><span class="sxs-lookup"><span data-stu-id="8011b-161">The compound files implementation of the Structured Storage architecture is used.</span></span> <span data-ttu-id="8011b-162">As funções de serviço padrão são usadas para operações em arquivos compostos.</span><span class="sxs-lookup"><span data-stu-id="8011b-162">Standard service functions are used for operations on compound files.</span></span> <span data-ttu-id="8011b-163">Por exemplo, a função [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) inicialmente cria um arquivo composto e retorna um ponteiro **IStorage** que pode ser usado para manipular o arquivo.</span><span class="sxs-lookup"><span data-stu-id="8011b-163">For example, the [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) function initially creates a compound file and passes back an **IStorage** pointer that can be used to manipulate the file.</span></span> <span data-ttu-id="8011b-164">Essa função específica é chamada em **StoClien**.</span><span class="sxs-lookup"><span data-stu-id="8011b-164">This particular function is called in **StoClien**.</span></span> <span data-ttu-id="8011b-165">A interface **IStorage** obtida é passada como um parâmetro para o copapel para seu uso.</span><span class="sxs-lookup"><span data-stu-id="8011b-165">The **IStorage** interface it obtains is passed as a parameter to COPaper for its use.</span></span> <span data-ttu-id="8011b-166">O objeto de copapel não cria ou abre arquivos compostos por conta própria: ele usa as interfaces **IStorage** e [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) para trabalhar em arquivos compostos que são fornecidos a ele.</span><span class="sxs-lookup"><span data-stu-id="8011b-166">The COPaper object does not create or open compound files on its own: It uses the **IStorage** and [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interfaces to work in compound files that are given to it.</span></span>

<span data-ttu-id="8011b-167">Essas interfaces [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) e [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) não são implementadas em **StoClien** ou **StoServe**.</span><span class="sxs-lookup"><span data-stu-id="8011b-167">These [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) and [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) interfaces are not implemented within **StoClien** or **StoServe**.</span></span> <span data-ttu-id="8011b-168">Eles são implementados nas bibliotecas COM.</span><span class="sxs-lookup"><span data-stu-id="8011b-168">They are implemented within the COM libraries.</span></span> <span data-ttu-id="8011b-169">Quando um ponteiro para uma dessas interfaces é obtido, seus métodos são essencialmente usados como um conjunto de serviços para operar em um arquivo composto.</span><span class="sxs-lookup"><span data-stu-id="8011b-169">When a pointer to one of these interfaces is obtained, their methods are essentially used as a set of services to operate on a compound file.</span></span>

 

 




