---
title: Implementação de arquivo de IEnumSTATPROPSETSTG-Compound
description: A implementação do arquivo composto da interface IEnumSTATPROPSETSTG é usada para enumerar uma matriz de estruturas STATPROPSETSTG que contêm dados de propriedade estatística.
ms.assetid: 1ce36e40-518c-411b-be5a-835a2dd0995e
keywords:
- IEnumSTATPROPSETSTG Strctd STG, implementação de arquivo composto
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9566af1a1956b3a951a996b6198f4a3161680042
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104294126"
---
# <a name="ienumstatpropsetstg-compound-file-implementation"></a><span data-ttu-id="786d8-104">Implementação de arquivo de IEnumSTATPROPSETSTG-Compound</span><span class="sxs-lookup"><span data-stu-id="786d8-104">IEnumSTATPROPSETSTG-Compound File Implementation</span></span>

<span data-ttu-id="786d8-105">A implementação do arquivo composto da interface [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) é usada para enumerar uma matriz de estruturas [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) que contêm dados de propriedade estatística.</span><span class="sxs-lookup"><span data-stu-id="786d8-105">The compound file implementation of the [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) interface is used to enumerate an array of [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures that contain statistical property data.</span></span> <span data-ttu-id="786d8-106">A implementação de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) gerencia os dados estatísticos e está associada a um objeto de armazenamento de arquivo composto atual.</span><span class="sxs-lookup"><span data-stu-id="786d8-106">The [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) implementation manages the statistical data and is associated with a current compound file storage object.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="786d8-107">Quando usar</span><span class="sxs-lookup"><span data-stu-id="786d8-107">When to Use</span></span>

<span data-ttu-id="786d8-108">Chame os métodos de [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) para enumerar estruturas [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) , cada uma fornecendo dados sobre um dos conjuntos de propriedades associados ao objeto de armazenamento de arquivo composto.</span><span class="sxs-lookup"><span data-stu-id="786d8-108">Call the methods of [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures, each of which provide data about one of the property sets associated with the compound file storage object.</span></span>

## <a name="remarks"></a><span data-ttu-id="786d8-109">Comentários</span><span class="sxs-lookup"><span data-stu-id="786d8-109">Remarks</span></span>

<dl> <dt>

<span data-ttu-id="786d8-110"><span id="IEnumSTATPROPSETSTG__Next"></span><span id="ienumstatpropsetstg__next"></span><span id="IENUMSTATPROPSETSTG__NEXT"></span>[**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)</span><span class="sxs-lookup"><span data-stu-id="786d8-110"><span id="IEnumSTATPROPSETSTG__Next"></span><span id="ienumstatpropsetstg__next"></span><span id="IENUMSTATPROPSETSTG__NEXT"></span>[**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg)</span></span>
</dt> <dd>

<span data-ttu-id="786d8-111">Obtém a próxima uma ou mais estruturas [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) (o número é especificado pelo parâmetro *celt* ).</span><span class="sxs-lookup"><span data-stu-id="786d8-111">Gets the next one or more [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures (the number is specified by the *celt* parameter).</span></span> <span data-ttu-id="786d8-112">Os elementos **STATPROPSETSTG** fornecidos por meio de uma chamada para a implementação do arquivo composto de [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) seguem estas regras:</span><span class="sxs-lookup"><span data-stu-id="786d8-112">The **STATPROPSETSTG** elements provided through a call to the compound file implementation of [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) follow these rules:</span></span>

-   <span data-ttu-id="786d8-113">Se [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) não puder fornecer STATPROPSETSTG. fmtid, zeros serão gravados nesse membro.</span><span class="sxs-lookup"><span data-stu-id="786d8-113">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide STATPROPSETSTG.fmtid, zeros are written to that member.</span></span> <span data-ttu-id="786d8-114">Isso ocorre quando o conjunto de propriedades não tem um nome predefinido (como \\ 005SummaryInformation) e não é um valor válido.</span><span class="sxs-lookup"><span data-stu-id="786d8-114">This occurs when the property set does not have a predefined name (such as \\005SummaryInformation) and is not a legal value.</span></span>
-   <span data-ttu-id="786d8-115">O conjunto de propriedades DocumentSummaryInformation e UserDefined é especial, pois pode ter duas seções de conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="786d8-115">The DocumentSummaryInformation and UserDefined property set is special, in that it may have two property set sections.</span></span> <span data-ttu-id="786d8-116">Esse conjunto de propriedades é descrito na seção [DocumentSummaryInformation e conjuntos de propriedades definidas pelo UserDefined](the-documentsummaryinformation-and-userdefined-property-sets.md).</span><span class="sxs-lookup"><span data-stu-id="786d8-116">This property set is described in the section [The DocumentSummaryInformation and UserDefined Property Sets](the-documentsummaryinformation-and-userdefined-property-sets.md).</span></span> <span data-ttu-id="786d8-117">A segunda seção é chamada de propriedades de User-Defined.</span><span class="sxs-lookup"><span data-stu-id="786d8-117">The second section is referred to as the User-Defined Properties.</span></span> <span data-ttu-id="786d8-118">Cada seção é identificada com um FMTID (identificador de formato exclusivo).</span><span class="sxs-lookup"><span data-stu-id="786d8-118">Each section is identified with a unique format identifier (FMTID).</span></span> <span data-ttu-id="786d8-119">Quando [**IPropertySetStorage:: enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum) é usado para enumerar conjuntos de propriedades, o conjunto de propriedades User-Defined não será enumerado.</span><span class="sxs-lookup"><span data-stu-id="786d8-119">When [**IPropertySetStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-enum) is used to enumerate property sets, the User-Defined property set will not be enumerated.</span></span>

> [!Note]  
> <span data-ttu-id="786d8-120">Se você sempre criar um conjunto de propriedades usando [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), então, porque um "GUID de caractere" é criado para o nome de armazenamento, [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) retornará um FMTID válido, para o conjunto de propriedades \[ STATPROPSETSTG. FMTID \] .</span><span class="sxs-lookup"><span data-stu-id="786d8-120">If you always create a property set using [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), then, because a "Character GUID" is created for the storage name, [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) will return a nonzero, valid FMTID for the property set \[STATPROPSETSTG.fmtid\].</span></span>

 

-   <span data-ttu-id="786d8-121">O membro STATPROPSETSTG. grfFlags não reflete necessariamente se o conjunto de propriedades é ANSI ou não.</span><span class="sxs-lookup"><span data-stu-id="786d8-121">The STATPROPSETSTG.grfFlags member does not necessarily reflect whether the property set is ANSI or not.</span></span> <span data-ttu-id="786d8-122">Se PROPSETFLAG \_ ANSI for definido, o conjunto de propriedades será definitivamente ANSI.</span><span class="sxs-lookup"><span data-stu-id="786d8-122">If PROPSETFLAG\_ANSI is set, the property set is definitely ANSI.</span></span> <span data-ttu-id="786d8-123">Se PROPSETFLAG \_ ANSI estiver claro, o conjunto de propriedades poderá ser Unicode ou não-Unicode, pois não é possível informar se ele é ANSI sem abri-lo.</span><span class="sxs-lookup"><span data-stu-id="786d8-123">If PROPSETFLAG\_ANSI is clear, the property set could be either Unicode or non-Unicode, because it is not possible to tell whether it is ANSI without opening it.</span></span>
-   <span data-ttu-id="786d8-124">O membro STATPROPSETSTG. grfFlags reflete se o conjunto de propriedades é simples ou não, portanto, a configuração do sinalizador de PROPSETFLAG \_ não simples é sempre válida.</span><span class="sxs-lookup"><span data-stu-id="786d8-124">The STATPROPSETSTG.grfFlags member does reflect whether the property set is simple or not, so the setting of the PROPSETFLAG\_NONSIMPLE flag is always valid.</span></span>
-   <span data-ttu-id="786d8-125">Se [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) não puder fornecer STATPROPSETSTG. CLSID, ele será definido como todos os zeros (CLSID \_ NULL).</span><span class="sxs-lookup"><span data-stu-id="786d8-125">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide STATPROPSETSTG.clsid, it is set to all zeroes (CLSID\_NULL).</span></span> <span data-ttu-id="786d8-126">Na implementação do arquivo composto COM, isso ocorre quando o conjunto de propriedades é simples (o \_ sinalizador não simples PROPSETFLAG não é definido) ou não é simples, mas o CLSID não foi definido explicitamente.</span><span class="sxs-lookup"><span data-stu-id="786d8-126">In the COM compound file implementation, this occurs when the property set is simple (the PROPSETFLAG\_NONSIMPLE flag is not set), or is nonsimple, but the CLSID was not explicitly set.</span></span> <span data-ttu-id="786d8-127">Para conjuntos de propriedades não simples, o CLSID recebido é aquele que é mantido pelo [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage)subjacente.</span><span class="sxs-lookup"><span data-stu-id="786d8-127">For nonsimple property sets, the CLSID that is received is the one that is maintained by the underlying [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage).</span></span>
-   <span data-ttu-id="786d8-128">Se [**IEnumSTATPROPSETSTG:: Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) não puder fornecer os campos de hora \[ **CTime**, **mtime**, **atime** \] , cada tempo sem suporte será definido como zeros.</span><span class="sxs-lookup"><span data-stu-id="786d8-128">If [**IEnumSTATPROPSETSTG::Next**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) cannot provide the time fields \[**ctime**, **mtime**, **atime**\], each non-supported time will be set to zeroes.</span></span> <span data-ttu-id="786d8-129">Na implementação do arquivo composto COM, obter esses valores depende de recuperá-los da implementação de [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) subjacente.</span><span class="sxs-lookup"><span data-stu-id="786d8-129">In the COM compound file implementation, getting these values depends on retrieving them from the underlying [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) implementation.</span></span>

</dd> <dt>

<span data-ttu-id="786d8-130"><span id="IEnumSTATPROPSETSTG__Skip"></span><span id="ienumstatpropsetstg__skip"></span><span id="IENUMSTATPROPSETSTG__SKIP"></span>[**IEnumSTATPROPSETSTG:: Skip**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="786d8-130"><span id="IEnumSTATPROPSETSTG__Skip"></span><span id="ienumstatpropsetstg__skip"></span><span id="IENUMSTATPROPSETSTG__SKIP"></span>[**IEnumSTATPROPSETSTG::Skip**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="786d8-131">Ignora o número de elementos especificados em *celt*.</span><span class="sxs-lookup"><span data-stu-id="786d8-131">Skips the number of elements specified in *celt*.</span></span> <span data-ttu-id="786d8-132">Retorna S \_ OK se o número especificado de elementos for ignorado, retornará s \_ false se menos elementos do que o solicitado forem ignorados.</span><span class="sxs-lookup"><span data-stu-id="786d8-132">Returns S\_OK if the specified number of elements are skipped, returns S\_FALSE if fewer elements than requested are skipped.</span></span> <span data-ttu-id="786d8-133">Em qualquer outro caso, o retorna o erro apropriado.</span><span class="sxs-lookup"><span data-stu-id="786d8-133">In any other case, returns the appropriate error.</span></span>

</dd> <dt>

<span data-ttu-id="786d8-134"><span id="IEnumSTATPROPSETSTG__Reset"></span><span id="ienumstatpropsetstg__reset"></span><span id="IENUMSTATPROPSETSTG__RESET"></span>[**IEnumSTATPROPSETSTG:: Reset**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="786d8-134"><span id="IEnumSTATPROPSETSTG__Reset"></span><span id="ienumstatpropsetstg__reset"></span><span id="IENUMSTATPROPSETSTG__RESET"></span>[**IEnumSTATPROPSETSTG::Reset**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="786d8-135">Define o cursor para o início da enumeração.</span><span class="sxs-lookup"><span data-stu-id="786d8-135">Sets the cursor to the beginning of the enumeration.</span></span> <span data-ttu-id="786d8-136">Se for bem-sucedido, retornará S \_ OK, caso contrário, retornará STG \_ E \_ INVALIDHANDLE.</span><span class="sxs-lookup"><span data-stu-id="786d8-136">If successful, returns S\_OK, otherwise, returns STG\_E\_INVALIDHANDLE.</span></span>

</dd> <dt>

<span data-ttu-id="786d8-137"><span id="IEnumSTATPROPSETSTG__Clone"></span><span id="ienumstatpropsetstg__clone"></span><span id="IENUMSTATPROPSETSTG__CLONE"></span>[**IEnumSTATPROPSETSTG:: clone**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span><span class="sxs-lookup"><span data-stu-id="786d8-137"><span id="IEnumSTATPROPSETSTG__Clone"></span><span id="ienumstatpropsetstg__clone"></span><span id="IENUMSTATPROPSETSTG__CLONE"></span>[**IEnumSTATPROPSETSTG::Clone**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg)</span></span>
</dt> <dd>

<span data-ttu-id="786d8-138">Copia o estado de enumeração atual deste enumerador.</span><span class="sxs-lookup"><span data-stu-id="786d8-138">Copies the current enumeration state of this enumerator.</span></span>

</dd> </dl>

 

 