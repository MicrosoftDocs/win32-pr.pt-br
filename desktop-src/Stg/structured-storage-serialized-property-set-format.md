---
title: Formato do conjunto de propriedades serializadas de armazenamento estruturado
description: Os conjuntos de propriedades persistentes fornecem uma opção para armazenar dados em entidades do sistema de arquivos. É recomendável que, para criá-los e gerenciá-los, você use as interfaces IPropertySetStorage e IPropertyStorage descritas em Propriedades e conjuntos de propriedade.
ms.assetid: f22abe40-535f-4178-9460-59bbe26ff178
keywords:
- Armazenamento estruturado Strctd STG, conceitos básicos, formato de conjunto de propriedades serializadas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1ea03d5ccab337897be801840080e83a6fa86880
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "105756132"
---
# <a name="structured-storage-serialized-property-set-format"></a><span data-ttu-id="1276a-105">Formato do conjunto de propriedades serializadas de armazenamento estruturado</span><span class="sxs-lookup"><span data-stu-id="1276a-105">Structured Storage Serialized Property Set Format</span></span>

<span data-ttu-id="1276a-106">Os conjuntos de propriedades persistentes fornecem uma opção para armazenar dados em entidades do sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="1276a-106">Persistent property sets provide an option to store data within file system entities.</span></span> <span data-ttu-id="1276a-107">É recomendável que, para criá-los e gerenciá-los, você use as interfaces [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) e [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) descritas em [Propriedades e conjuntos de propriedade](properties-and-property-sets.md).</span><span class="sxs-lookup"><span data-stu-id="1276a-107">It is recommended that, to create and manage them, you use the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interfaces described in [Properties and Property Sets](properties-and-property-sets.md).</span></span>

<span data-ttu-id="1276a-108">Os conjuntos de propriedades são compostos de uma seção marcada de valores, com a seção identificada exclusivamente por um identificador de formato (FMTID).</span><span class="sxs-lookup"><span data-stu-id="1276a-108">Property sets are composed of a tagged section of values, with the section uniquely identified by a format identifier (FMTID).</span></span> <span data-ttu-id="1276a-109">Cada propriedade consiste em um identificador de propriedade e um indicador de tipo que representa um valor.</span><span class="sxs-lookup"><span data-stu-id="1276a-109">Every property consists of a property identifier and a type indicator that represents a value.</span></span> <span data-ttu-id="1276a-110">Cada valor armazenado em um conjunto de propriedades tem um identificador de propriedade exclusivo que distingue a propriedade.</span><span class="sxs-lookup"><span data-stu-id="1276a-110">Each value stored in a property set has a unique property identifier that distinguishes the property.</span></span> <span data-ttu-id="1276a-111">O indicador de tipo descreve a representação dos dados no valor.</span><span class="sxs-lookup"><span data-stu-id="1276a-111">The type indicator describes the representation of the data in the value.</span></span>

<span data-ttu-id="1276a-112">Ao usar as interfaces [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) e [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) , você não precisa manipular a estrutura de formato do conjunto de propriedades serializadas com.</span><span class="sxs-lookup"><span data-stu-id="1276a-112">When you use the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) and [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) interfaces, you do not have to handle the COM serialized property set format structure.</span></span> <span data-ttu-id="1276a-113">Para obter mais informações, consulte os tópicos listados:</span><span class="sxs-lookup"><span data-stu-id="1276a-113">For more information, see the listed topics:</span></span>

<span data-ttu-id="1276a-114">Todos os elementos de dados dentro de um conjunto de propriedades são armazenados na representação Intel (ou seja, em ordem de byte little-endian).</span><span class="sxs-lookup"><span data-stu-id="1276a-114">All data elements within a property set are stored in Intel representation (that is, in little-endian byte order).</span></span>

<span data-ttu-id="1276a-115">COM define um formato de dados serializado padrão para conjuntos de propriedades.</span><span class="sxs-lookup"><span data-stu-id="1276a-115">COM defines a standard, serialized data format for property sets.</span></span> <span data-ttu-id="1276a-116">Ao lidar com o formato serializado, e não com as interfaces, os conjuntos de propriedades têm as seguintes características:</span><span class="sxs-lookup"><span data-stu-id="1276a-116">When handling the serialized format, and not with the interfaces, property sets have the following characteristics:</span></span>

-   <span data-ttu-id="1276a-117">Os conjuntos de propriedades permitem que aplicativos diferentes criem seus próprios conjuntos de propriedades independentes para atender ao aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1276a-117">Property sets allow for different applications to create their own independent property sets to serve the application.</span></span>
-   <span data-ttu-id="1276a-118">Os conjuntos de propriedades podem ser armazenados em uma única instância de [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) ou em uma instância de [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) que contenha vários fluxos.</span><span class="sxs-lookup"><span data-stu-id="1276a-118">Property sets can be stored in a single [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) instance or in an [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) instance that contains multiple streams.</span></span> <span data-ttu-id="1276a-119">Os conjuntos de propriedades são simplesmente outro tipo de dados que pode ser armazenado em muitas formas diferentes de armazenamento em disco ou na memória.</span><span class="sxs-lookup"><span data-stu-id="1276a-119">Property sets are simply another data type that can be stored in many different forms of an in-memory or on-disk storage.</span></span> <span data-ttu-id="1276a-120">Para obter mais informações e convenções recomendadas para criar o nome da cadeia de caracteres para o objeto de armazenamento, consulte [convenções de nomenclatura de objeto de armazenamento](storage-object-naming-conventions.md).</span><span class="sxs-lookup"><span data-stu-id="1276a-120">For more information and recommended conventions for creating the string name for the storage object, see [Storage Object Naming Conventions](storage-object-naming-conventions.md).</span></span>
-   <span data-ttu-id="1276a-121">Os conjuntos de propriedades permitem que um dicionário de nomes de exibição seja incluído para descrever o conteúdo.</span><span class="sxs-lookup"><span data-stu-id="1276a-121">Property sets allow for a dictionary of display names to be included that describe the contents.</span></span> <span data-ttu-id="1276a-122">É recomendável um conjunto de convenções para escolher nomes de propriedade.</span><span class="sxs-lookup"><span data-stu-id="1276a-122">A set of conventions for choosing property names is recommended.</span></span> <span data-ttu-id="1276a-123">Para obter mais informações sobre esse dicionário opcional, consulte [identificadores de propriedade reservada](reserved-property-identifiers.md), incluindo a [ID de propriedade 0](/windows/desktop/Stg/reserved-property-identifiers).</span><span class="sxs-lookup"><span data-stu-id="1276a-123">For more information about this optional dictionary, see [Reserved Property Identifiers](reserved-property-identifiers.md), including [Property ID 0](/windows/desktop/Stg/reserved-property-identifiers).</span></span>

<span data-ttu-id="1276a-124">O fluxo do conjunto de propriedades é dividido em três partes principais:</span><span class="sxs-lookup"><span data-stu-id="1276a-124">The property set stream is divided into three major parts:</span></span>

-   <span data-ttu-id="1276a-125">parâmetro</span><span class="sxs-lookup"><span data-stu-id="1276a-125">Header</span></span>
-   <span data-ttu-id="1276a-126">FORMATid/par de deslocamento</span><span class="sxs-lookup"><span data-stu-id="1276a-126">FORMATID/offset pair</span></span>
-   <span data-ttu-id="1276a-127">Seção que contém os valores reais do conjunto de propriedades</span><span class="sxs-lookup"><span data-stu-id="1276a-127">Section containing the actual property set values</span></span>

<span data-ttu-id="1276a-128">O comprimento geral do fluxo do conjunto de propriedades deve ser menor ou igual a 256K.</span><span class="sxs-lookup"><span data-stu-id="1276a-128">The overall length of the property set stream must be less than or equal to 256K.</span></span> <span data-ttu-id="1276a-129">As seções a seguir, o [cabeçalho do conjunto de propriedades](property-set-header.md), o identificador de [formato/par de deslocamento](format-identifier-offset-pair.md)e a [seção](section.md) (incluindo [identificadores de propriedade/pares de deslocamento](property-identifiers-offset-pairs.md)), com tópicos de suporte, descrevem os componentes individuais que compõem o formato de dados do conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="1276a-129">The following sections, [Property Set Header](property-set-header.md), [Format Identifier/Offset Pair](format-identifier-offset-pair.md), and [Section](section.md) (including [Property Identifiers/Offset Pairs](property-identifiers-offset-pairs.md)), with supporting topics, describe the individual components that compose the property-set data format.</span></span>

> [!Note]  
> <span data-ttu-id="1276a-130">As versões anteriores deste documento descreveram as extensões para o fluxo do conjunto de propriedades com mais de uma seção permitida, mas que foram revisadas para fornecer uma seção no fluxo de propriedades.</span><span class="sxs-lookup"><span data-stu-id="1276a-130">Previous versions of this document described extensions to the property set stream with more than one section allowed, but that has been revised to provide for one section in the property stream.</span></span> <span data-ttu-id="1276a-131">A única exceção são [os conjuntos de propriedades DocumentSummaryInformation e UserDefined](the-documentsummaryinformation-and-userdefined-property-sets.md).</span><span class="sxs-lookup"><span data-stu-id="1276a-131">The one exception is [The DocumentSummaryInformation and UserDefined Property Sets](the-documentsummaryinformation-and-userdefined-property-sets.md).</span></span>

 

 

 