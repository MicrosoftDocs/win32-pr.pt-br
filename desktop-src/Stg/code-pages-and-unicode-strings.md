---
title: Páginas de código e cadeias de caracteres Unicode
description: Outra consideração na implementação de IPropertySetStorage é como os nomes de propriedade Unicode são armazenados na ID de propriedade 0 (o dicionário de nome de propriedade), que não usa cadeias de caracteres Unicode.
ms.assetid: 830c90c9-d2a5-4ecf-8cb6-9950ed5320bf
keywords:
- Páginas de código e cadeias de caracteres Unicode
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 508d508ec21e7e763a683e534cf485ebbeec018d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104291869"
---
# <a name="code-pages-and-unicode-strings"></a><span data-ttu-id="0b4f0-104">Páginas de código e cadeias de caracteres Unicode</span><span class="sxs-lookup"><span data-stu-id="0b4f0-104">Code Pages and Unicode Strings</span></span>

<span data-ttu-id="0b4f0-105">Outra consideração na implementação de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) é como os nomes de propriedade Unicode são armazenados na ID de propriedade 0 (o dicionário de nome de propriedade), que não usa cadeias de caracteres Unicode.</span><span class="sxs-lookup"><span data-stu-id="0b4f0-105">Another consideration in implementing [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is how Unicode property names are stored in the property ID 0 (the property name dictionary), which does not use Unicode strings.</span></span>

<span data-ttu-id="0b4f0-106">O Unicode oficialmente tem um valor de página de código de 1200.</span><span class="sxs-lookup"><span data-stu-id="0b4f0-106">Unicode officially has a code page value of 1200.</span></span> <span data-ttu-id="0b4f0-107">Para armazenar valores Unicode no dicionário de nome de propriedade, use um valor de página de código de 1200 para o conjunto de propriedades inteiro (na propriedade ID 1), especificado pela ausência do sinalizador **\_ ANSI PROPSETFLAG** em [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="0b4f0-107">To store Unicode values in the property name dictionary, use a code page value of 1200 for the whole property set (in property ID 1), specified by the absence of the **PROPSETFLAG\_ANSI** flag in [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="0b4f0-108">Lembre-se de que isso tem o efeito colateral de armazenar todos os valores de cadeia de caracteres na propriedade definida em Unicode.</span><span class="sxs-lookup"><span data-stu-id="0b4f0-108">Be aware that this has the side effect of storing all string values in the property set in Unicode.</span></span> <span data-ttu-id="0b4f0-109">Em todas as páginas de código, a contagem encontrada no início de um **VT \_ LPSTR** é uma contagem de bytes, não uma contagem de caracteres.</span><span class="sxs-lookup"><span data-stu-id="0b4f0-109">In all code pages, the count found at the start of a **VT\_LPSTR** is a byte count, not a character count.</span></span> <span data-ttu-id="0b4f0-110">Isso é necessário para fornecer compatibilidade com clientes de versão anterior.</span><span class="sxs-lookup"><span data-stu-id="0b4f0-110">This is necessary to provide for compatibility with earlier-version clients.</span></span>

<span data-ttu-id="0b4f0-111">A implementação do arquivo composto de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) cria todos os novos conjuntos de propriedades totalmente em Unicode (página de código 1200) ou na página de código ANSI do sistema atual.</span><span class="sxs-lookup"><span data-stu-id="0b4f0-111">The compound file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) creates all new property sets completely either in Unicode (code page 1200) or in the current system ANSI code page.</span></span> <span data-ttu-id="0b4f0-112">Isso é controlado pela ausência ou presença do sinalizador **\_ ANSI PROPSETFLAG** no parâmetro *grfFlags* de [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="0b4f0-112">This is controlled by the absence or presence of the **PROPSETFLAG\_ANSI** flag in the *grfFlags* parameter of [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span>

<span data-ttu-id="0b4f0-113">Crie e abra conjuntos de propriedades como Unicode.</span><span class="sxs-lookup"><span data-stu-id="0b4f0-113">Create and open property sets as Unicode.</span></span> <span data-ttu-id="0b4f0-114">Para implementar isso, não defina o sinalizador **\_ ANSI PROPSETFLAG** no parâmetro *grfFlags* de [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="0b4f0-114">To implement this, do not set the **PROPSETFLAG\_ANSI** flag in the *grfFlags* parameter of [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="0b4f0-115">Evite usar valores de ' **VT \_ LPSTR** ' e, em vez disso, usar valores de do **VT \_** .</span><span class="sxs-lookup"><span data-stu-id="0b4f0-115">Avoid using **VT\_LPSTR** values, and instead use **VT\_LPWSTR** values.</span></span> <span data-ttu-id="0b4f0-116">Quando a página de código do conjunto de propriedades é Unicode, os valores da cadeia de caracteres **VT \_ LPSTR** são convertidos em Unicode quando armazenados e de volta para valores de cadeia de caracteres multibyte quando recuperados.</span><span class="sxs-lookup"><span data-stu-id="0b4f0-116">When the code page of the property set is Unicode, **VT\_LPSTR** string values are converted to Unicode when stored, and back to multibyte string values when retrieved.</span></span>

<span data-ttu-id="0b4f0-117">Definir o **sinalizador \_ ANSI PROPSETFLAG** como relatado por meio de uma chamada para [**IPropertyStorage:: stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat) reflete se a página de código subjacente é ou não Unicode.</span><span class="sxs-lookup"><span data-stu-id="0b4f0-117">Setting the **PROPSETFLAG\_ANSI** flag as reported through a call to [**IPropertyStorage::Stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat) reflects whether the underlying code page is or is not Unicode.</span></span> <span data-ttu-id="0b4f0-118">Lembre-se de que a ID de propriedade 1 pode ser lida explicitamente para aprender a página de código.</span><span class="sxs-lookup"><span data-stu-id="0b4f0-118">Be aware that Property ID 1 can be explicitly read to learn the code page.</span></span>

<span data-ttu-id="0b4f0-119">Você pode acessar a ID de propriedade 1 por meio de uma chamada para [**IPropertyStorage:: ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple).</span><span class="sxs-lookup"><span data-stu-id="0b4f0-119">You can access Property ID 1 through a call to [**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple).</span></span> <span data-ttu-id="0b4f0-120">No entanto, ele é somente leitura e não pode ser atualizado com [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple).</span><span class="sxs-lookup"><span data-stu-id="0b4f0-120">However, it is read-only, and may not be updated with [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple).</span></span> <span data-ttu-id="0b4f0-121">Além disso, ele não pode ser excluído com [**DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple).</span><span class="sxs-lookup"><span data-stu-id="0b4f0-121">Furthermore, it may not be deleted with [**DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple).</span></span>

 

 




