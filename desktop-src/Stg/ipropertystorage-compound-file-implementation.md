---
title: Implementação de arquivo de IPropertyStorage-Compound
description: A implementação COM da arquitetura de armazenamento estruturado é chamada de arquivos compostos.
ms.assetid: c4b4f313-de58-44f2-8ce1-a07cc187d8ca
keywords:
- IPropertyStorage Strctd STG, implementações, arquivo composto
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 03d927b0145077f12e5ba508ca65554ca33633a3
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103823832"
---
# <a name="ipropertystorage-compound-file-implementation"></a><span data-ttu-id="6a193-104">Implementação de arquivo de IPropertyStorage-Compound</span><span class="sxs-lookup"><span data-stu-id="6a193-104">IPropertyStorage-Compound File Implementation</span></span>

<span data-ttu-id="6a193-105">A implementação COM da arquitetura de armazenamento estruturado é chamada de [arquivos compostos](istorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="6a193-105">The COM implementation of the Structured Storage architecture is called [compound files](istorage-compound-file-implementation.md).</span></span> <span data-ttu-id="6a193-106">Os objetos de armazenamento conforme implementados em arquivos compostos incluem uma implementação de ambos os [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), a interface que gerencia um único conjunto de propriedades persistentes e [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), a interface que gerencia grupos de conjuntos de propriedades persistentes.</span><span class="sxs-lookup"><span data-stu-id="6a193-106">Storage objects as implemented in compound files include an implementation of both [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), the interface that manages a single persistent property set, and [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage), the interface that manages groups of persistent property sets.</span></span> <span data-ttu-id="6a193-107">Para obter mais informações sobre a interface **IPropertyStorage** , consulte [Considerações sobre](property-storage-considerations.md) **IPropertyStorage** e armazenamento de propriedades.</span><span class="sxs-lookup"><span data-stu-id="6a193-107">For more information about the **IPropertyStorage** interface, see **IPropertyStorage** and [Property Storage Considerations](property-storage-considerations.md).</span></span>

<span data-ttu-id="6a193-108">Para obter um ponteiro para a implementação do arquivo composto de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), chame [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) para criar um novo objeto de arquivo composto ou [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) para abrir um objeto de arquivo composto criado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="6a193-108">To get a pointer to the compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), call [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) to create a new compound file object or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) to open a previously created compound file object.</span></span> <span data-ttu-id="6a193-109">No caso de **StgCreateStorageEx**, o parâmetro *stgfmt* deve ser definido como armazenamento stgfmt \_ .</span><span class="sxs-lookup"><span data-stu-id="6a193-109">In the case of **StgCreateStorageEx**, the *stgfmt* parameter should be set to STGFMT\_STORAGE.</span></span> <span data-ttu-id="6a193-110">No caso de **StgOpenStorageEx**, o parâmetro *stgfmt* deve ser definido como stgfmt \_ Storage ou stgfmt \_ any.</span><span class="sxs-lookup"><span data-stu-id="6a193-110">In the case of **StgOpenStorageEx**, the *stgfmt* parameter should be set to STGFMT\_STORAGE or STGFMT\_ANY.</span></span> <span data-ttu-id="6a193-111">Em ambos os casos, o parâmetro *riid* deve ser definido como IID \_ IPropertySetStorage.</span><span class="sxs-lookup"><span data-stu-id="6a193-111">In both cases, the *riid* parameter should be set to IID\_IPropertySetStorage.</span></span> <span data-ttu-id="6a193-112">Ambas as funções fornecem um ponteiro para a interface Object [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) .</span><span class="sxs-lookup"><span data-stu-id="6a193-112">Both functions supply a pointer to the object [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface.</span></span> <span data-ttu-id="6a193-113">Chamando o método [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) ou [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) dessa interface, você receberá um ponteiro para a interface **IPropertyStorage** , que pode ser usada para chamar qualquer um de seus métodos.</span><span class="sxs-lookup"><span data-stu-id="6a193-113">By calling either the [**Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) or [**Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) method of that interface, you will get a pointer to the **IPropertyStorage** interface, which you can use to call any of its methods.</span></span>

<span data-ttu-id="6a193-114">Uma maneira alternativa de obter um ponteiro para a implementação do arquivo composto de [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) é chamar as funções [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) e [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) mais antigas ou especificar um parâmetro *riid* de IStorage de IID \_ para a função [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) ou [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) .</span><span class="sxs-lookup"><span data-stu-id="6a193-114">An alternative way to get a pointer to the compound file implementation of [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) is to call the older [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) and [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) functions, or to specify an *riid* parameter of IID\_IStorage to the [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function.</span></span> <span data-ttu-id="6a193-115">Em ambos os casos, um ponteiro para a interface [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) do objeto é retornado.</span><span class="sxs-lookup"><span data-stu-id="6a193-115">In either case, a pointer to the object's [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) interface is returned.</span></span> <span data-ttu-id="6a193-116">Com os conjuntos de propriedades persistentes, chame [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) para a interface **IPropertySetStorage** , especificando o nome definido pelo cabeçalho para o IPropertySetStorage de IID do identificador de interface (IID) \_ .</span><span class="sxs-lookup"><span data-stu-id="6a193-116">With persistent property sets, call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for the **IPropertySetStorage** interface, specifying the header-defined name for the interface identifier (IID) IID\_IPropertySetStorage.</span></span>

## <a name="when-to-use"></a><span data-ttu-id="6a193-117">Quando usar</span><span class="sxs-lookup"><span data-stu-id="6a193-117">When to Use</span></span>

<span data-ttu-id="6a193-118">Use [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) para gerenciar Propriedades em um único conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="6a193-118">Use [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) to manage properties within a single property set.</span></span> <span data-ttu-id="6a193-119">Seus métodos dão suporte à leitura, gravação e exclusão de propriedades e aos nomes de cadeia de caracteres opcionais que podem ser associados a identificadores de propriedade.</span><span class="sxs-lookup"><span data-stu-id="6a193-119">Its methods support reading, writing, and deleting both properties and the optional string names that can be associated with property identifiers.</span></span> <span data-ttu-id="6a193-120">Outros métodos dão suporte às operações de confirmação e de reversão de armazenamento padrão.</span><span class="sxs-lookup"><span data-stu-id="6a193-120">Other methods support the standard commit and revert storage operations.</span></span> <span data-ttu-id="6a193-121">Também há um método que permite definir os horários associados ao armazenamento de propriedades e outro que permite a atribuição de um CLSID que pode ser usado para associar outro código, como o código de interface do usuário, com o conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="6a193-121">There is also a method that enables you to set times associated with the property storage, and another that permits the assignment of a CLSID that can be used to associate other code, such as user interface code, with the property set.</span></span> <span data-ttu-id="6a193-122">Chamar o método [**enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) fornece um ponteiro para a implementação do arquivo composto de [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), que permite enumerar as propriedades no conjunto.</span><span class="sxs-lookup"><span data-stu-id="6a193-122">Calling the [**Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) method supplies a pointer to the compound file implementation of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), which allows you to enumerate the properties in the set.</span></span>

> [!Note]  
> <span data-ttu-id="6a193-123">Se você obtiver um ponteiro para [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) chamando [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile), [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex), [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) ou [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) em um armazenamento de conjunto de propriedades de modo simples, os métodos **IPropertyStorage** aderirão às regras de fluxos de modo simples.</span><span class="sxs-lookup"><span data-stu-id="6a193-123">If you obtain a pointer to [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) by calling [**StgCreateDocfile**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile), [**StgCreateStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatestorageex), [**StgOpenStorage**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorage) or [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) on a simple-mode property set storage, the **IPropertyStorage** methods adhere to the rules of simple-mode streams.</span></span> <span data-ttu-id="6a193-124">O armazenamento do conjunto de propriedades é o modo simples se ele foi obtido para um arquivo que foi criado ou aberto com o \_ sinalizador simples STGM.</span><span class="sxs-lookup"><span data-stu-id="6a193-124">The property set storage is simple mode if it was obtained for a file that was created or opened with the STGM\_SIMPLE flag.</span></span> <span data-ttu-id="6a193-125">Nesse caso, nem sempre é possível tornar o fluxo subjacente maior e não é possível substituir as propriedades existentes por Propriedades maiores.</span><span class="sxs-lookup"><span data-stu-id="6a193-125">In this case, it is not always possible to make the underlying stream larger and it is not possible to replace existing properties with larger properties.</span></span> <span data-ttu-id="6a193-126">Para obter mais informações, consulte [implementação de arquivo composto IPropertySetStorage](ipropertysetstorage-compound-file-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="6a193-126">For more information, see [IPropertySetStorage-Compound File Implementation](ipropertysetstorage-compound-file-implementation.md).</span></span>

 

## <a name="ipropertystorage-and-caching"></a><span data-ttu-id="6a193-127">IPropertyStorage e Caching</span><span class="sxs-lookup"><span data-stu-id="6a193-127">IPropertyStorage and Caching</span></span>

<span data-ttu-id="6a193-128">A implementação de arquivo composto de caches [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) abre conjuntos de propriedades na memória para melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="6a193-128">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) caches open property sets in memory in order to improve performance.</span></span> <span data-ttu-id="6a193-129">Como resultado, as alterações em um conjunto de propriedades não são gravadas no arquivo composto até que os métodos [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) ou **Release** (última referência) sejam chamados.</span><span class="sxs-lookup"><span data-stu-id="6a193-129">As a result, changes to a property set are not written to the compound file until the [**Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) or **Release** (last reference) methods are called.</span></span>

## <a name="simple-mode-property-sets"></a><span data-ttu-id="6a193-130">Conjuntos de propriedades de modo simples</span><span class="sxs-lookup"><span data-stu-id="6a193-130">Simple Mode Property Sets</span></span>

<span data-ttu-id="6a193-131">Um objeto de armazenamento de propriedade estará no modo simples se for criado a partir de um objeto de armazenamento de conjunto de propriedades de modo simples.</span><span class="sxs-lookup"><span data-stu-id="6a193-131">A property storage object is in simple mode if it is created from a simple mode property set storage object.</span></span> <span data-ttu-id="6a193-132">Por exemplo, um objeto de armazenamento de conjunto de propriedades estaria no modo simples se ele fosse obtido da função [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) , com o \_ sinalizador simples STGM definido no parâmetro *grfMode* .</span><span class="sxs-lookup"><span data-stu-id="6a193-132">For example, a property set storage object would be in simple mode if it were obtained from the [**StgOpenStorageEx**](/windows/desktop/api/coml2api/nf-coml2api-stgopenstorageex) function, with the STGM\_SIMPLE flag set in the *grfMode* parameter.</span></span> <span data-ttu-id="6a193-133">Observe que "modo simples" não está relacionado a "conjuntos de propriedades simples".</span><span class="sxs-lookup"><span data-stu-id="6a193-133">Note that "simple mode" is unrelated to "simple property sets".</span></span> <span data-ttu-id="6a193-134">Um conjunto de propriedades é simples se for criado chamando [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) com o sinalizador de PROPSETFLAG não \_ simples definido no parâmetro *grfFlags* .</span><span class="sxs-lookup"><span data-stu-id="6a193-134">A property set is simple if it is created by calling [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) with the PROPSETFLAG\_NONSIMPLE flag set in the *grfFlags* parameter.</span></span> <span data-ttu-id="6a193-135">Para obter mais informações sobre conjuntos de propriedades simples e não simples, consulte [armazenamento e objetos de fluxo para um conjunto de propriedades](storage-vs--stream-for-a-property-set.md).</span><span class="sxs-lookup"><span data-stu-id="6a193-135">For more information about simple and nonsimple property sets, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md).</span></span>

<span data-ttu-id="6a193-136">Quando um objeto de armazenamento de propriedade de modo simples é criado, não há restrições quanto ao seu uso.</span><span class="sxs-lookup"><span data-stu-id="6a193-136">When a simple mode property storage object is created, there are no restrictions on its use.</span></span> <span data-ttu-id="6a193-137">Quando um objeto de armazenamento de propriedade de modo simples existente é aberto, o objeto de fluxo subjacente que armazena o conjunto de propriedades não pode ser aumentado.</span><span class="sxs-lookup"><span data-stu-id="6a193-137">When an existing simple-mode property storage object is opened, the underlying stream object that stores the property set cannot be grown.</span></span> <span data-ttu-id="6a193-138">Consequentemente, nem sempre é possível modificar tal objeto de armazenamento de propriedade se a alteração exigir um fluxo maior.</span><span class="sxs-lookup"><span data-stu-id="6a193-138">Consequently, it is not always possible to modify such a property storage object if the change requires a larger stream.</span></span>

## <a name="property-set-formats"></a><span data-ttu-id="6a193-139">Formatos de conjunto de propriedades</span><span class="sxs-lookup"><span data-stu-id="6a193-139">Property Set Formats</span></span>

<span data-ttu-id="6a193-140">A implementação do arquivo composto de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) dá suporte aos formatos de serialização da versão 0 e do conjunto de propriedades da versão 1.</span><span class="sxs-lookup"><span data-stu-id="6a193-140">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports both the version 0 and the version 1 property set serialization formats.</span></span> <span data-ttu-id="6a193-141">Há suporte para o formato versão 1 em computadores que executam o Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="6a193-141">The version 1 format is supported on computers running on Windows 2000.</span></span> <span data-ttu-id="6a193-142">Para obter mais informações, consulte [serialização do conjunto de propriedades](version-0-vs--version-1-property-set-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="6a193-142">For more information, see [Property Set Serialization](version-0-vs--version-1-property-set-serialization.md).</span></span> <span data-ttu-id="6a193-143">Os conjuntos de propriedades são criados no formato da versão 0 e permanecem nesse formato, a menos que novos recursos sejam solicitados.</span><span class="sxs-lookup"><span data-stu-id="6a193-143">Property sets are created in version 0 format and remain in that format unless new features are requested.</span></span> <span data-ttu-id="6a193-144">Quando isso ocorre, o formato é atualizado para a versão 1.</span><span class="sxs-lookup"><span data-stu-id="6a193-144">When that occurs, the format is updated to version 1.</span></span>

<span data-ttu-id="6a193-145">Por exemplo, se um conjunto de Propriedades for criado com o \_ sinalizador padrão PROPSETFLAG, seu formato será a versão 0.</span><span class="sxs-lookup"><span data-stu-id="6a193-145">For example, if a property set is created with the PROPSETFLAG\_DEFAULT flag, its format is version 0.</span></span> <span data-ttu-id="6a193-146">Desde que os tipos de propriedade que estejam em conformidade com o formato da versão 0 sejam gravados e lidos a partir desse conjunto de propriedades, o conjunto de propriedades permanecerá no formato da versão 0.</span><span class="sxs-lookup"><span data-stu-id="6a193-146">As long as property types that conform to the version 0 format are written to and read from that property set, the property set remains in version 0 format.</span></span> <span data-ttu-id="6a193-147">Se um tipo de propriedade da versão 1 for gravado no conjunto de propriedades, o conjunto de propriedades será atualizado automaticamente para a versão 1.</span><span class="sxs-lookup"><span data-stu-id="6a193-147">If a version 1 property type is written to the property set, the property set is automatically updated to version 1.</span></span> <span data-ttu-id="6a193-148">Subsequentemente, esse conjunto de propriedades não pode mais ser lido por implementações que reconhecem apenas a versão 0.</span><span class="sxs-lookup"><span data-stu-id="6a193-148">Subsequently, that property set can no longer be read by implementations that recognize only version 0.</span></span>

## <a name="ipropertystorage-and-variant-types"></a><span data-ttu-id="6a193-149">Tipos de IPropertyStorage e variantes</span><span class="sxs-lookup"><span data-stu-id="6a193-149">IPropertyStorage and Variant Types</span></span>

<span data-ttu-id="6a193-150">A implementação do arquivo composto de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) não dá suporte à expedição de tipos Variant VT \_ Unknown ou VT \_ no membro **VT** da estrutura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="6a193-150">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) does not support the variant types VT\_UNKNOWN or VT\_DISPATCH in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="6a193-151">A tabela a seguir lista os tipos de variante que têm suporte em um SafeArray; ou seja, esses valores podem ser combinados com \_ a matriz VT no membro **VT** da estrutura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="6a193-151">The following table lists variant types that are supported within a SafeArray; that is, these values can be combined with VT\_ARRAY in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>



<span data-ttu-id="6a193-152">Tipos de variante com suporte em SafeArray por implementação de arquivo composto de IPropertyStorage</span><span class="sxs-lookup"><span data-stu-id="6a193-152">Variant types supported within SafeArray by compound file implementation of IPropertyStorage</span></span>

<span data-ttu-id="6a193-153">VT \_ i1</span><span class="sxs-lookup"><span data-stu-id="6a193-153">VT\_I1</span></span>

<span data-ttu-id="6a193-154">\_UI1 VT</span><span class="sxs-lookup"><span data-stu-id="6a193-154">VT\_UI1</span></span>

<span data-ttu-id="6a193-155">\_I2 VT</span><span class="sxs-lookup"><span data-stu-id="6a193-155">VT\_I2</span></span>

<span data-ttu-id="6a193-156">\_UI2 VT</span><span class="sxs-lookup"><span data-stu-id="6a193-156">VT\_UI2</span></span>

<span data-ttu-id="6a193-157">\_I4 VT</span><span class="sxs-lookup"><span data-stu-id="6a193-157">VT\_I4</span></span>

<span data-ttu-id="6a193-158">\_UI4 VT</span><span class="sxs-lookup"><span data-stu-id="6a193-158">VT\_UI4</span></span>

<span data-ttu-id="6a193-159">VT \_ int</span><span class="sxs-lookup"><span data-stu-id="6a193-159">VT\_INT</span></span>

<span data-ttu-id="6a193-160">VT \_ uint</span><span class="sxs-lookup"><span data-stu-id="6a193-160">VT\_UINT</span></span>

<span data-ttu-id="6a193-161">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="6a193-161">VT\_R4</span></span>

<span data-ttu-id="6a193-162">R8 de VT \_</span><span class="sxs-lookup"><span data-stu-id="6a193-162">VT\_R8</span></span>

<span data-ttu-id="6a193-163">VT \_ Cy</span><span class="sxs-lookup"><span data-stu-id="6a193-163">VT\_CY</span></span>

<span data-ttu-id="6a193-164">Data de VT \_</span><span class="sxs-lookup"><span data-stu-id="6a193-164">VT\_DATE</span></span>

<span data-ttu-id="6a193-165">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="6a193-165">VT\_BSTR</span></span>

<span data-ttu-id="6a193-166">BOOL do VT \_</span><span class="sxs-lookup"><span data-stu-id="6a193-166">VT\_BOOL</span></span>

<span data-ttu-id="6a193-167">\_decimal VT</span><span class="sxs-lookup"><span data-stu-id="6a193-167">VT\_DECIMAL</span></span>

<span data-ttu-id="6a193-168">erro de VT \_</span><span class="sxs-lookup"><span data-stu-id="6a193-168">VT\_ERROR</span></span>

<span data-ttu-id="6a193-169">variante do VT \_</span><span class="sxs-lookup"><span data-stu-id="6a193-169">VT\_VARIANT</span></span>

 



 

<span data-ttu-id="6a193-170">Quando \_ a variante VT é combinada com \_ a matriz VT, o SAFEARRAY em si mantém as estruturas [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="6a193-170">When VT\_VARIANT is combined with VT\_ARRAY, the SafeArray itself holds [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structures.</span></span> <span data-ttu-id="6a193-171">No entanto, os tipos desses elementos devem ser extraídos da lista anterior, não pode ser VT \_ Variant e não podem incluir os \_ indicadores de vetor VT, VT \_ array ou VT \_ ByRef.</span><span class="sxs-lookup"><span data-stu-id="6a193-171">However, the types of these elements must be taken from the preceding list, cannot be VT\_VARIANT, and cannot include the VT\_VECTOR, VT\_ARRAY, or VT\_BYREF indicators.</span></span>

## <a name="ipropertystorage-methods"></a><span data-ttu-id="6a193-172">Métodos IPropertyStorage</span><span class="sxs-lookup"><span data-stu-id="6a193-172">IPropertyStorage Methods</span></span>

<span data-ttu-id="6a193-173">A implementação do arquivo composto do [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) dá suporte aos seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="6a193-173">The compound file implementation of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) supports the following methods:</span></span>

<dl> <dt>

<span data-ttu-id="6a193-174"><span id="IPropertyStorage__ReadMultiple"></span><span id="ipropertystorage__readmultiple"></span><span id="IPROPERTYSTORAGE__READMULTIPLE"></span>[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)</span><span class="sxs-lookup"><span data-stu-id="6a193-174"><span id="IPropertyStorage__ReadMultiple"></span><span id="ipropertystorage__readmultiple"></span><span id="IPROPERTYSTORAGE__READMULTIPLE"></span>[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple)</span></span>
</dt> <dd>

<span data-ttu-id="6a193-175">Lê as propriedades especificadas na matriz *rgpspec* e fornece os valores de todas as propriedades válidas na matriz *rgVar* de PROPVARIANTs.</span><span class="sxs-lookup"><span data-stu-id="6a193-175">Reads the properties specified in the *rgpspec* array and supplies the values of all valid properties in the *rgvar* array of PROPVARIANTs.</span></span> <span data-ttu-id="6a193-176">Na implementação de arquivo composto COM, os identificadores de propriedade duplicados que se referem aos tipos de fluxo ou de armazenamento resultam em várias chamadas para [**IStorage:: OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) ou [**IStorage:: OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) e o êxito ou a falha de **ReadMultiple** depende da capacidade da implementação de armazenamento subjacente para compartilhar operações de abertura.</span><span class="sxs-lookup"><span data-stu-id="6a193-176">In the COM compound file implementation, duplicate property identifiers that refer to stream or storage types result in multiple calls to [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) or [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) and the success or failure of **ReadMultiple** depends on the underlying storage implementation's ability to share opening operations.</span></span> <span data-ttu-id="6a193-177">Como em um arquivo composto \_ , STGM compartilhamento \_ exclusivo é forçado, várias tentativas abertas falharão.</span><span class="sxs-lookup"><span data-stu-id="6a193-177">Because in a compound file STGM\_SHARE\_EXCLUSIVE is forced, multiple open attempts will fail.</span></span> <span data-ttu-id="6a193-178">Não há suporte para a abertura do mesmo objeto de armazenamento mais de uma vez no mesmo armazenamento pai.</span><span class="sxs-lookup"><span data-stu-id="6a193-178">Opening the same storage object more than once from the same parent storage is not supported.</span></span> <span data-ttu-id="6a193-179">O \_ sinalizador exclusivo de compartilhamento de STGM \_ deve ser especificado.</span><span class="sxs-lookup"><span data-stu-id="6a193-179">The STGM\_SHARE\_EXCLUSIVE flag must be specified.</span></span>

<span data-ttu-id="6a193-180">Além disso, para garantir a operação thread-safe se a mesma propriedade com valor de armazenamento ou fluxo for solicitada várias vezes por meio do mesmo ponteiro [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) na implementação do arquivo composto com, a operação de abertura terá êxito ou falhará dependendo se a propriedade já estiver aberta e se o sistema de arquivos subjacente lida com várias aberturas de um fluxo ou armazenamento.</span><span class="sxs-lookup"><span data-stu-id="6a193-180">In addition, to ensure thread-safe operation if the same stream- or storage-valued property is requested several times through the same [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) pointer in the COM compound file implementation, the open operation will succeed or fail depending on whether the property is already open and whether the underlying file system handles multiple openings of a stream or storage.</span></span> <span data-ttu-id="6a193-181">Assim, a operação **ReadMultiple** em uma propriedade com valor de fluxo ou de armazenamento sempre resulta em uma chamada para [**IStorage:: OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream)ou [**IStorage:: OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage), que passa o acesso (STGM \_ ReadWrite e assim por diante) e sinalizadores de compartilhamento (STGM \_ compartilhamento \_ exclusivo e assim por diante) especificados quando o conjunto de propriedades original foi aberto ou criado.</span><span class="sxs-lookup"><span data-stu-id="6a193-181">Thus, the **ReadMultiple** operation on a stream- or storage-valued property always results in a call to [**IStorage::OpenStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream), or [**IStorage::OpenStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage), which passes the access (STGM\_READWRITE, and so forth) and share flags (STGM\_SHARE\_EXCLUSIVE, and so on) specified when the original property set was opened or created.</span></span>

<span data-ttu-id="6a193-182">Se o método falhar, os valores gravados em *rgVar* \[ \] serão indefinidos.</span><span class="sxs-lookup"><span data-stu-id="6a193-182">If the method fails, the values written to *rgvar*\[\] are undefined.</span></span> <span data-ttu-id="6a193-183">Se algumas propriedades de fluxo ou de valor de armazenamento forem abertas com êxito, mas ocorrer um erro antes da execução ser concluída, elas deverão ser liberadas antes que o método seja retornado.</span><span class="sxs-lookup"><span data-stu-id="6a193-183">If some stream- or storage-valued properties are opened successfully but an error occurs before execution is complete, these should be released before the method returns.</span></span>

</dd> <dt>

<span data-ttu-id="6a193-184"><span id="IPropertyStorage__WriteMultiple"></span><span id="ipropertystorage__writemultiple"></span><span id="IPROPERTYSTORAGE__WRITEMULTIPLE"></span>[**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)</span><span class="sxs-lookup"><span data-stu-id="6a193-184"><span id="IPropertyStorage__WriteMultiple"></span><span id="ipropertystorage__writemultiple"></span><span id="IPROPERTYSTORAGE__WRITEMULTIPLE"></span>[**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple)</span></span>
</dt> <dd>

<span data-ttu-id="6a193-185">Grava as propriedades especificadas na matriz *rgpspec* \[ \] , atribuindo a elas as marcas e os valores de [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) especificados em *rgVar* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="6a193-185">Writes the properties specified in the *rgpspec*\[\] array, assigning them the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) tags and values specified in *rgvar*\[\].</span></span> <span data-ttu-id="6a193-186">As propriedades que já existem são atribuídas aos valores **PROPVARIANT** especificados.</span><span class="sxs-lookup"><span data-stu-id="6a193-186">Properties that already exist are assigned the specified **PROPVARIANT** values.</span></span> <span data-ttu-id="6a193-187">As propriedades que não existem atualmente são criadas.</span><span class="sxs-lookup"><span data-stu-id="6a193-187">Properties that do not currently exist are created.</span></span>

</dd> <dt>

<span data-ttu-id="6a193-188"><span id="IPropertyStorage__DeleteMultiple"></span><span id="ipropertystorage__deletemultiple"></span><span id="IPROPERTYSTORAGE__DELETEMULTIPLE"></span>[**IPropertyStorage::D eleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)</span><span class="sxs-lookup"><span data-stu-id="6a193-188"><span id="IPropertyStorage__DeleteMultiple"></span><span id="ipropertystorage__deletemultiple"></span><span id="IPROPERTYSTORAGE__DELETEMULTIPLE"></span>[**IPropertyStorage::DeleteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletemultiple)</span></span>
</dt> <dd>

<span data-ttu-id="6a193-189">Exclui as propriedades especificadas em *rgpspec* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="6a193-189">Deletes the properties specified in the *rgpspec*\[\].</span></span>

</dd> <dt>

<span data-ttu-id="6a193-190"><span id="IPropertyStorage__ReadPropertyNames"></span><span id="ipropertystorage__readpropertynames"></span><span id="IPROPERTYSTORAGE__READPROPERTYNAMES"></span>[**IPropertyStorage::ReadPropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readpropertynames)</span><span class="sxs-lookup"><span data-stu-id="6a193-190"><span id="IPropertyStorage__ReadPropertyNames"></span><span id="ipropertystorage__readpropertynames"></span><span id="IPROPERTYSTORAGE__READPROPERTYNAMES"></span>[**IPropertyStorage::ReadPropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readpropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="6a193-191">Lê os nomes de cadeia de caracteres existentes associados às IDs de propriedade especificadas na matriz *rgPropID* \[ \] .</span><span class="sxs-lookup"><span data-stu-id="6a193-191">Reads existing string names associated with the property IDs specified in the *rgpropid*\[\] array.</span></span>

</dd> <dt>

<span data-ttu-id="6a193-192"><span id="IPropertyStorage__WritePropertyNames"></span><span id="ipropertystorage__writepropertynames"></span><span id="IPROPERTYSTORAGE__WRITEPROPERTYNAMES"></span>[**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)</span><span class="sxs-lookup"><span data-stu-id="6a193-192"><span id="IPropertyStorage__WritePropertyNames"></span><span id="ipropertystorage__writepropertynames"></span><span id="IPROPERTYSTORAGE__WRITEPROPERTYNAMES"></span>[**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="6a193-193">Atribui nomes de cadeia de caracteres especificados na matriz *rglpwstrName* às IDs de propriedade especificadas na matriz *rgPropID* .</span><span class="sxs-lookup"><span data-stu-id="6a193-193">Assigns string names specified in the *rglpwstrName* array to property IDs specified in the *rgpropid* array.</span></span>

</dd> <dt>

<span data-ttu-id="6a193-194"><span id="IPropertyStorage__DeletePropertyNames"></span><span id="ipropertystorage__deletepropertynames"></span><span id="IPROPERTYSTORAGE__DELETEPROPERTYNAMES"></span>[**IPropertyStorage::D eletePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletepropertynames)</span><span class="sxs-lookup"><span data-stu-id="6a193-194"><span id="IPropertyStorage__DeletePropertyNames"></span><span id="ipropertystorage__deletepropertynames"></span><span id="IPROPERTYSTORAGE__DELETEPROPERTYNAMES"></span>[**IPropertyStorage::DeletePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-deletepropertynames)</span></span>
</dt> <dd>

<span data-ttu-id="6a193-195">Exclui os nomes de propriedade das propriedades especificadas na  \[ \] matriz rgPropID.</span><span class="sxs-lookup"><span data-stu-id="6a193-195">Deletes property names for the properties specified in the *rgpropid*\[\] array.</span></span>

</dd> <dt>

<span data-ttu-id="6a193-196"><span id="IPropertyStorage__SetClass"></span><span id="ipropertystorage__setclass"></span><span id="IPROPERTYSTORAGE__SETCLASS"></span>[**IPropertyStorage:: SetClass**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-setclass)</span><span class="sxs-lookup"><span data-stu-id="6a193-196"><span id="IPropertyStorage__SetClass"></span><span id="ipropertystorage__setclass"></span><span id="IPROPERTYSTORAGE__SETCLASS"></span>[**IPropertyStorage::SetClass**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-setclass)</span></span>
</dt> <dd>

<span data-ttu-id="6a193-197">Define o **CLSID** do fluxo do conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="6a193-197">Sets the **CLSID** of the property set stream.</span></span> <span data-ttu-id="6a193-198">Na implementação do arquivo composto, definir o CLSID em um conjunto de propriedades não simples (que pode conter, legalmente, as propriedades com valor de armazenamento ou de fluxo, conforme descrito em [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)) também define o CLSID no subarmazenamento subjacente para que ele possa ser obtido por meio de uma chamada para [**IStorage:: stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat).</span><span class="sxs-lookup"><span data-stu-id="6a193-198">In the compound file implementation, setting the CLSID on a nonsimple property set (one that can legally contain storage- or stream-valued properties, as described in [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)) also sets the CLSID on the underlying substorage so that it can be obtained through a call to [**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat).</span></span>

</dd> <dt>

<span data-ttu-id="6a193-199"><span id="IPropertyStorage__Commit"></span><span id="ipropertystorage__commit"></span><span id="IPROPERTYSTORAGE__COMMIT"></span>[**IPropertyStorage:: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)</span><span class="sxs-lookup"><span data-stu-id="6a193-199"><span id="IPropertyStorage__Commit"></span><span id="ipropertystorage__commit"></span><span id="IPROPERTYSTORAGE__COMMIT"></span>[**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit)</span></span>
</dt> <dd>

<span data-ttu-id="6a193-200">Para os conjuntos de propriedades simples e não simples, o libera a imagem do conjunto de propriedades para o armazenamento subjacente.</span><span class="sxs-lookup"><span data-stu-id="6a193-200">For both simple and nonsimple property sets, flushes the property set memory image to the underlying storage.</span></span> <span data-ttu-id="6a193-201">Além disso, para conjuntos de propriedades de modo transacionado não simples, esse método executa uma confirmação (como em [**IStorage:: Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)) no armazenamento que contém o conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="6a193-201">In addition, for nonsimple transacted-mode property sets, this method performs a commit (as in [**IStorage::Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit)) on the storage which contains the property set.</span></span>

</dd> <dt>

<span data-ttu-id="6a193-202"><span id="IPropertyStorage__Revert"></span><span id="ipropertystorage__revert"></span><span id="IPROPERTYSTORAGE__REVERT"></span>[**IPropertyStorage:: Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)</span><span class="sxs-lookup"><span data-stu-id="6a193-202"><span id="IPropertyStorage__Revert"></span><span id="ipropertystorage__revert"></span><span id="IPROPERTYSTORAGE__REVERT"></span>[**IPropertyStorage::Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert)</span></span>
</dt> <dd>

<span data-ttu-id="6a193-203">Somente para conjuntos de propriedades não simples, o chama o método [**REVERT**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) do armazenamento subjacente e reabre o fluxo ' Contents '.</span><span class="sxs-lookup"><span data-stu-id="6a193-203">For nonsimple property sets only, calls the [**Revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) method of the underlying storage and reopens the 'contents' stream.</span></span> <span data-ttu-id="6a193-204">Para conjuntos de propriedades simples, essa interface sempre retorna S \_ OK.</span><span class="sxs-lookup"><span data-stu-id="6a193-204">For simple property sets, this interface always returns S\_OK.</span></span> <span data-ttu-id="6a193-205">Os conjuntos de propriedades não simples são aqueles que foram criados usando o sinalizador PROPSETFLAG não \_ simples no método [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) .</span><span class="sxs-lookup"><span data-stu-id="6a193-205">Nonsimple property sets are those which were created using the PROPSETFLAG\_NONSIMPLE flag in the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method.</span></span> <span data-ttu-id="6a193-206">Para obter mais informações, consulte [armazenamento e objetos de fluxo para um conjunto de propriedades](storage-vs--stream-for-a-property-set.md) .</span><span class="sxs-lookup"><span data-stu-id="6a193-206">For more information, see [Storage and Stream Objects for a Property Set](storage-vs--stream-for-a-property-set.md) .</span></span>

</dd> <dt>

<span data-ttu-id="6a193-207"><span id="IPropertyStorage__Enum"></span><span id="ipropertystorage__enum"></span><span id="IPROPERTYSTORAGE__ENUM"></span>[**IPropertyStorage:: enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum)</span><span class="sxs-lookup"><span data-stu-id="6a193-207"><span id="IPropertyStorage__Enum"></span><span id="ipropertystorage__enum"></span><span id="IPROPERTYSTORAGE__ENUM"></span>[**IPropertyStorage::Enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum)</span></span>
</dt> <dd>

<span data-ttu-id="6a193-208">Constrói uma instância de [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), os métodos que podem ser chamados para enumerar as estruturas [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) que fornecem informações sobre cada uma das propriedades no conjunto.</span><span class="sxs-lookup"><span data-stu-id="6a193-208">Constructs an instance of [**IEnumSTATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg), the methods of which can be called to enumerate the [**STATPROPSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) structures that provide information about each of the properties in the set.</span></span> <span data-ttu-id="6a193-209">Essa implementação cria uma matriz na qual o conjunto de propriedades inteiro é lido e que pode ser compartilhado quando **IEnumSTATPROPSTG:: clone** é chamado.</span><span class="sxs-lookup"><span data-stu-id="6a193-209">This implementation creates an array into which the entire property set is read and which can be shared when **IEnumSTATPROPSTG::Clone** is called.</span></span> <span data-ttu-id="6a193-210">As alterações no conjunto de propriedades não são refletidas em uma instância **IEnumSTATPROPSTG** aberta.</span><span class="sxs-lookup"><span data-stu-id="6a193-210">Changes to the property set are not reflected in an open **IEnumSTATPROPSTG** instance.</span></span> <span data-ttu-id="6a193-211">Para ver essas alterações, uma nova instância desse enumerador deve ser construída.</span><span class="sxs-lookup"><span data-stu-id="6a193-211">To see such changes, a new instance of this enumerator must be constructed.</span></span>

</dd> <dt>

<span data-ttu-id="6a193-212"><span id="IPropertyStorage__Stat"></span><span id="ipropertystorage__stat"></span><span id="IPROPERTYSTORAGE__STAT"></span>[**IPropertyStorage:: stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat)</span><span class="sxs-lookup"><span data-stu-id="6a193-212"><span id="IPropertyStorage__Stat"></span><span id="ipropertystorage__stat"></span><span id="IPROPERTYSTORAGE__STAT"></span>[**IPropertyStorage::Stat**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-stat)</span></span>
</dt> <dd>

<span data-ttu-id="6a193-213">Preenche os membros de uma estrutura [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) , que contém dados sobre o conjunto de propriedades como um todo.</span><span class="sxs-lookup"><span data-stu-id="6a193-213">Fills in the members of a [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structure, which contains data about the property set as a whole.</span></span> <span data-ttu-id="6a193-214">No retorno, fornece um ponteiro para a estrutura.</span><span class="sxs-lookup"><span data-stu-id="6a193-214">On return, supplies a pointer to the structure.</span></span> <span data-ttu-id="6a193-215">Para conjuntos de armazenamento não simples, essa implementação chama [**IStorage:: stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat) (ou [**IStream:: stat**](/windows/desktop/api/Objidl/nf-objidl-istream-stat)) para obter os tempos do armazenamento ou fluxo subjacente.</span><span class="sxs-lookup"><span data-stu-id="6a193-215">For nonsimple storage sets, this implementation calls [**IStorage::Stat**](/windows/desktop/api/Objidl/nf-objidl-istorage-stat) (or [**IStream::Stat**](/windows/desktop/api/Objidl/nf-objidl-istream-stat)) to get the times from the underlying storage or stream.</span></span> <span data-ttu-id="6a193-216">Para conjuntos de armazenamento simples, nenhuma vez é mantida.</span><span class="sxs-lookup"><span data-stu-id="6a193-216">For simple storage sets, no times are maintained.</span></span>

</dd> <dt>

<span data-ttu-id="6a193-217"><span id="IPropertyStorage__SetTimes"></span><span id="ipropertystorage__settimes"></span><span id="IPROPERTYSTORAGE__SETTIMES"></span>[**IPropertyStorage:: settimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes)</span><span class="sxs-lookup"><span data-stu-id="6a193-217"><span id="IPropertyStorage__SetTimes"></span><span id="ipropertystorage__settimes"></span><span id="IPROPERTYSTORAGE__SETTIMES"></span>[**IPropertyStorage::SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes)</span></span>
</dt> <dd>

<span data-ttu-id="6a193-218">Somente para conjuntos de propriedades não simples, o define os tempos suportados pelo armazenamento subjacente.</span><span class="sxs-lookup"><span data-stu-id="6a193-218">For nonsimple property sets only, sets the times supported by the underlying storage.</span></span> <span data-ttu-id="6a193-219">A implementação do armazenamento de arquivos compostos dá suporte a todos os três: modificação, acesso e criação.</span><span class="sxs-lookup"><span data-stu-id="6a193-219">The compound file storage implementation supports all three: modification, access, and creation.</span></span> <span data-ttu-id="6a193-220">Essa implementação de [**Settimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes) chama o método [**IStorage:: SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes) do armazenamento subjacente para recuperar esses horários.</span><span class="sxs-lookup"><span data-stu-id="6a193-220">This implementation of [**SetTimes**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-settimes) calls the [**IStorage::SetElementTimes**](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes) method of the underlying storage to retrieve these times.</span></span>

</dd> </dl>

## <a name="related-topics"></a><span data-ttu-id="6a193-221">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="6a193-221">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6a193-222">**IPropertyStorage**</span><span class="sxs-lookup"><span data-stu-id="6a193-222">**IPropertyStorage**</span></span>](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)
</dt> <dt>

[<span data-ttu-id="6a193-223">**IStorage:: SetElementTimes**</span><span class="sxs-lookup"><span data-stu-id="6a193-223">**IStorage::SetElementTimes**</span></span>](/windows/desktop/api/Objidl/nf-objidl-istorage-setelementtimes)
</dt> </dl>

 

 