---
title: Como criar amostras
description: Para criar um exemplo de COM, o ambiente de computador deve ser configurado para criar aplicativos do Microsoft Win32 C++.
ms.assetid: c62b8b4d-a9d2-4587-8bb6-7b2c30d1c00d
keywords:
- Como criar amostras
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 593d3465d3ebcc32a6768dd8b2dffe1f0a653d07
ms.sourcegitcommit: c2a1c4314550ea9bd202d28adfcc7bfe6180932f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2020
ms.locfileid: "105754929"
---
# <a name="how-to-build-samples"></a><span data-ttu-id="722a8-104">Como criar amostras</span><span class="sxs-lookup"><span data-stu-id="722a8-104">How to Build Samples</span></span>

<span data-ttu-id="722a8-105">Para criar um exemplo de COM, o ambiente de computador deve ser configurado para criar aplicativos do Microsoft Win32 C++.</span><span class="sxs-lookup"><span data-stu-id="722a8-105">To build a COM sample, the computer environment must be set up to build Microsoft Win32 C++ applications.</span></span>

## <a name="preparing-a-computer-to-create-com-samples"></a><span data-ttu-id="722a8-106">Preparando um computador para criar amostras COM</span><span class="sxs-lookup"><span data-stu-id="722a8-106">Preparing a Computer to Create COM Samples</span></span>

<span data-ttu-id="722a8-107">O ambiente de computador deve ser configurado com um compilador C++ de 32 bits, vinculador e recurso instalado corretamente que seja compatível com o Microsoft Visual C++ 4. x ou posterior e um SDK do Windows instalado corretamente.</span><span class="sxs-lookup"><span data-stu-id="722a8-107">The computer environment must be set up with a properly installed 32-bit C++ compiler, linker, and resource compiler that are compatible with Microsoft Visual C++ 4.x or later, and a properly installed Windows SDK.</span></span> <span data-ttu-id="722a8-108">É melhor instalar o SDK do Windows por último.</span><span class="sxs-lookup"><span data-stu-id="722a8-108">It is best to install the Windows SDK last.</span></span> <span data-ttu-id="722a8-109">O SDK do Windows fornece os arquivos de biblioteca. h include e. lib necessários para a funcionalidade COM codificada nos exemplos.</span><span class="sxs-lookup"><span data-stu-id="722a8-109">The Windows SDK provides .h include and .lib library files required for the COM functionality coded in the samples.</span></span>

<span data-ttu-id="722a8-110">Para executar com êxito os exemplos de Remclien, Freserve e Freclien exigem os recursos do sistema que estão disponíveis nos sistemas operacionais Windows: Windows Server 2003, Windows XP, Windows 2000 ou Windows NT 4,0.</span><span class="sxs-lookup"><span data-stu-id="722a8-110">To successfully run the Remclien, Freserve, and Freclien samples requires system facilities that are available in the Windows operating systems: Windows Server 2003, Windows XP, Windows 2000, or Windows NT 4.0.</span></span> <span data-ttu-id="722a8-111">Os exemplos de Remclien, Freserve e Freclien serão criados, mas não serão executados nos sistemas operacionais Windows me, Windows 98 ou Windows 95, a menos que Distributed COM (DCOM) e COM threaded COM sejam parte do sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="722a8-111">The Remclien, Freserve, and Freclien samples will build but will not run on the Windows Me, Windows 98, or Windows 95 operating systems unless Distributed COM (DCOM) and free threaded COM are part of the operating system.</span></span> <span data-ttu-id="722a8-112">Esse suporte está disponível para os sistemas operacionais Windows me, Windows 98 e Windows 95 no complemento do DCOM95.</span><span class="sxs-lookup"><span data-stu-id="722a8-112">This support is available for the Windows Me, Windows 98, and Windows 95 operating systems in the DCOM95 add on.</span></span> <span data-ttu-id="722a8-113">Atualmente, o DCOM95 pode ser obtido pelo [download da Microsoft](https://www.microsoft.com/download/details.aspx?id=31661).</span><span class="sxs-lookup"><span data-stu-id="722a8-113">DCOM95 can currently be obtained by [download from Microsoft](https://www.microsoft.com/download/details.aspx?id=31661).</span></span>

<span data-ttu-id="722a8-114">Cada diretório de exemplo tem os arquivos de origem necessários para compilar e executar o exemplo.</span><span class="sxs-lookup"><span data-stu-id="722a8-114">Each sample directory has the necessary source files to build and run the sample.</span></span> <span data-ttu-id="722a8-115">O diretório de exemplo pai tem um arquivo Makeall.bat, que pode ser executado no prompt de comando para disponibilizar todos os exemplos de código na ramificação.</span><span class="sxs-lookup"><span data-stu-id="722a8-115">The parent sample directory has a Makeall.bat file, which you can run from the command prompt to make all the code samples in the branch below.</span></span> <span data-ttu-id="722a8-116">Para obter mais informações, consulte o arquivo Makeall.bat.</span><span class="sxs-lookup"><span data-stu-id="722a8-116">For more information, see the Makeall.bat file.</span></span> <span data-ttu-id="722a8-117">Se o seu ambiente estiver configurado para criar aplicativos Win32 C++, você poderá simplesmente executar Makeall.bat do diretório em que ele reside para criar todos os exemplos de código na ramificação abaixo.</span><span class="sxs-lookup"><span data-stu-id="722a8-117">If your environment is set up to build Win32 C++ applications, you can simply run Makeall.bat from the directory where it resides to build all the code samples in the branch below.</span></span> <span data-ttu-id="722a8-118">O Makeall garante a ordem correta para a compilação para que todas as dependências de exemplo de código sejam satisfeitas.</span><span class="sxs-lookup"><span data-stu-id="722a8-118">Makeall ensures the correct order to the build so that all the code sample dependencies are satisfied.</span></span>

<span data-ttu-id="722a8-119">O diretório principal também tem um makefile que cria todos os exemplos de código do tutorial usando opções semelhantes àquelas com suporte pelo Makeall.bat.</span><span class="sxs-lookup"><span data-stu-id="722a8-119">The main directory also has a makefile that builds all the tutorial code samples using options similar to those supported by Makeall.bat.</span></span> <span data-ttu-id="722a8-120">Para obter mais informações, consulte este makefile.</span><span class="sxs-lookup"><span data-stu-id="722a8-120">For more information, see this makefile.</span></span> <span data-ttu-id="722a8-121">Esse makefile pressupõe que toda a ramificação de exemplos de código seja instalada como parte do SDK do Windows.</span><span class="sxs-lookup"><span data-stu-id="722a8-121">This makefile assumes that the entire code samples branch is installed as part of the Windows SDK.</span></span> <span data-ttu-id="722a8-122">Atualmente, esse local tem um caminho semelhante a *d: \\ MSSDK \\ Samples \\ com \\ TUTSAMP*, em que D: representa a unidade de instalação.</span><span class="sxs-lookup"><span data-stu-id="722a8-122">Currently this location has a path similar to *D:\\MSSDK\\SAMPLES\\COM\\TUTSAMP*, where D: represents the installation drive.</span></span> <span data-ttu-id="722a8-123">Se você tiver extraído a ramificação de exemplo de código do tutorial (por exemplo, o COM do diretório COM e seus subdiretórios) para outro local fora do SDK do Windows (ou se você tiver obtido o conjunto de exemplo como um download separado do site da Microsoft), use Makeall.bat para compilar todos os exemplos na ramificação.</span><span class="sxs-lookup"><span data-stu-id="722a8-123">If you have extracted the tutorial code sample branch (for example, the COM directory COM and its subdirectories) to another location outside the Windows SDK (or if you obtained the sample set as a separate download from the Microsoft website), then use Makeall.bat to compile all the samples in the branch.</span></span> <span data-ttu-id="722a8-124">Em geral, é recomendável Makeall.bat.</span><span class="sxs-lookup"><span data-stu-id="722a8-124">In general, Makeall.bat is recommended.</span></span> <span data-ttu-id="722a8-125">Um arquivo de Logmall.bat também é fornecido.</span><span class="sxs-lookup"><span data-stu-id="722a8-125">A Logmall.bat file is also provided.</span></span> <span data-ttu-id="722a8-126">Ele faz o mesmo que o arquivo em lote Makeall, exceto que ele registra em log toda a saída de compilação no arquivo Errorlog.txt no diretório principal do tutorial.</span><span class="sxs-lookup"><span data-stu-id="722a8-126">It does the same as Makeall batch file except that it logs all compilation output to file Errorlog.txt in the main tutorial directory.</span></span>

<span data-ttu-id="722a8-127">Dois arquivos em lotes, Regall.bat e Unregall.bat, também são fornecidos no diretório principal para registrar e cancelar o registro de todos os servidores COM na série de exemplos de código do tutorial.</span><span class="sxs-lookup"><span data-stu-id="722a8-127">Two batch files, Regall.bat and Unregall.bat, are also provided in the main directory to register and unregister all COM servers in the tutorial code sample series.</span></span> <span data-ttu-id="722a8-128">Para registrar todos os servidores, execute Regall.bat arquivo do diretório principal.</span><span class="sxs-lookup"><span data-stu-id="722a8-128">To register all servers, run Regall.bat file from the main directory.</span></span> <span data-ttu-id="722a8-129">Para cancelar o registro de todos os servidores, execute Unregall.bat da mesma maneira.</span><span class="sxs-lookup"><span data-stu-id="722a8-129">To unregister all servers, run Unregall.bat in the same manner.</span></span> <span data-ttu-id="722a8-130">Esses arquivos em lotes exigem uma compilação anterior dos exemplos de código REGISTER, MARSHAL, DLLSERVE, LICSERVE, LOCSERVE, APTSERVE, FRESERVE e preserve.</span><span class="sxs-lookup"><span data-stu-id="722a8-130">These batch files require a prior build of the REGISTER, MARSHAL, DLLSERVE, LICSERVE, LOCSERVE, APTSERVE, FRESERVE, and CONSERVE code samples.</span></span> <span data-ttu-id="722a8-131">Se você executar uma compilação normal dos exemplos de código, os makefiles do servidor registrarão automaticamente os servidores.</span><span class="sxs-lookup"><span data-stu-id="722a8-131">If you perform a normal build of the code samples, the server makefiles will automatically register the servers.</span></span> <span data-ttu-id="722a8-132">Nesse caso, não é necessário executar o arquivo em lotes Regall.</span><span class="sxs-lookup"><span data-stu-id="722a8-132">In this case, it is not necessary to run the Regall batch file.</span></span>

<span data-ttu-id="722a8-133">Execute o arquivo em lote Cleanall.bat para executar uma Cleanall exaustiva de todos os exemplos de tutorial COM.</span><span class="sxs-lookup"><span data-stu-id="722a8-133">Run the Cleanall.bat batch file to perform an exhaustive Cleanall of all the COM Tutorial Samples.</span></span>

> [!WARNING]
> <span data-ttu-id="722a8-134">Esse arquivo em lotes exclui todos os arquivos de projeto do Visual Studio e outros arquivos de trabalho temporários criados por Visual C++ nos exemplos.</span><span class="sxs-lookup"><span data-stu-id="722a8-134">This batch file deletes all Visual Studio project files and other temporary work files created by Visual C++ in the samples.</span></span> <span data-ttu-id="722a8-135">Todos os servidores COM criados nos exemplos de código do tutorial são desregistrados do registro.</span><span class="sxs-lookup"><span data-stu-id="722a8-135">All of the COM servers built in the tutorial code samples are unregistered from the registry.</span></span> <span data-ttu-id="722a8-136">Todos os arquivos exe e. dll executáveis são excluídos.</span><span class="sxs-lookup"><span data-stu-id="722a8-136">All executable exe and .dll files are deleted.</span></span> <span data-ttu-id="722a8-137">Todos os arquivos de símbolo de depuração são excluídos.</span><span class="sxs-lookup"><span data-stu-id="722a8-137">All debug symbol files are deleted.</span></span> <span data-ttu-id="722a8-138">Os arquivos gerados em uma variedade de ambientes de compilação também são excluídos.</span><span class="sxs-lookup"><span data-stu-id="722a8-138">Files generated in a variety of build environments are also deleted.</span></span>

 

<span data-ttu-id="722a8-139">Execute ' Makeall Clean ' para executar uma limpeza mais rápida, mas mais modesto, de todos os exemplos de código.</span><span class="sxs-lookup"><span data-stu-id="722a8-139">Run 'Makeall Clean' to perform a faster, but more modest, cleanup of all the code samples.</span></span> <span data-ttu-id="722a8-140">Essa operação de limpeza não tenta ser tão abrangente quanto a realizada pelo Cleanall.bat.</span><span class="sxs-lookup"><span data-stu-id="722a8-140">This cleaning operation does not attempt to be as comprehensive as that performed by Cleanall.bat.</span></span> <span data-ttu-id="722a8-141">Os arquivos. obj são excluídos, mas os binários de saída são retidos.</span><span class="sxs-lookup"><span data-stu-id="722a8-141">The .obj files are deleted, but the output binaries are retained.</span></span> <span data-ttu-id="722a8-142">Os servidores COM não estão registrados no registro.</span><span class="sxs-lookup"><span data-stu-id="722a8-142">The COM servers are not unregistered from the registry.</span></span>

<span data-ttu-id="722a8-143">Essa série de exemplo foi originada como parte integrante do SDK do Windows, portanto, a narração do tutorial pressupõe um ambiente com o SDK do Windows instalado corretamente.</span><span class="sxs-lookup"><span data-stu-id="722a8-143">This sample series originated as an integral part of the Windows SDK, therefore the tutorial narrative assumes an environment with the Windows SDK properly installed.</span></span>

<span data-ttu-id="722a8-144">No entanto, as versões do Microsoft Visual C++ versão 4,0 e posterior também podem fornecer os arquivos de biblioteca. h include e. lib necessários para a compilação.</span><span class="sxs-lookup"><span data-stu-id="722a8-144">However, releases of Microsoft Visual C++ version 4.0 and later may also provide the .h include and .lib library files required for compilation.</span></span> <span data-ttu-id="722a8-145">Nesses casos, a instalação do SDK do Windows pode não ser necessária para compilar os exemplos.</span><span class="sxs-lookup"><span data-stu-id="722a8-145">In such cases, installation of the Windows SDK may not be required to compile the samples.</span></span>

<span data-ttu-id="722a8-146">Para obter mais informações e detalhes de compilação de exemplo completos, consulte:</span><span class="sxs-lookup"><span data-stu-id="722a8-146">For more information and complete sample build details, see:</span></span>

[<span data-ttu-id="722a8-147">Configuração do ambiente</span><span class="sxs-lookup"><span data-stu-id="722a8-147">Environment Setup</span></span>](environment-setup.md)

[<span data-ttu-id="722a8-148">Makefiles</span><span class="sxs-lookup"><span data-stu-id="722a8-148">Makefiles</span></span>](makefiles.md)

[<span data-ttu-id="722a8-149">Usando o Visual Studio</span><span class="sxs-lookup"><span data-stu-id="722a8-149">Using Visual Studio</span></span>](using-visual-studio.md)

[<span data-ttu-id="722a8-150">Extraindo os exemplos de código</span><span class="sxs-lookup"><span data-stu-id="722a8-150">Extracting the Code Samples</span></span>](extracting-the-code-samples.md)

[<span data-ttu-id="722a8-151">Convenções de estilo de codificação</span><span class="sxs-lookup"><span data-stu-id="722a8-151">Coding Style Conventions</span></span>](coding-style-conventions.md)

 

 




