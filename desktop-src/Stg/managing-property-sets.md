---
title: Gerenciando conjuntos de propriedades
description: Um conjunto de propriedades persistentes contém dados relacionados como propriedades.
ms.assetid: 19ff2751-87f3-43d8-9307-ce2dd399f694
keywords:
- Gerenciando conjuntos de propriedades
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: af3f9862d3074a5221bf1d5d975754486a562f87
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "105762883"
---
# <a name="managing-property-sets"></a><span data-ttu-id="62e9d-104">Gerenciando conjuntos de propriedades</span><span class="sxs-lookup"><span data-stu-id="62e9d-104">Managing Property Sets</span></span>

<span data-ttu-id="62e9d-105">Um conjunto de propriedades persistentes contém dados relacionados como propriedades.</span><span class="sxs-lookup"><span data-stu-id="62e9d-105">A persistent property set contains related data as properties.</span></span> <span data-ttu-id="62e9d-106">Cada conjunto de propriedades é identificado com um FMTID e um identificador global exclusivo (GUID) que habilita aplicativos, acessando o conjunto de propriedades, para identificar o conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="62e9d-106">Each property set is identified with an FMTID, and a globally unique identifier (GUID) that enables applications, accessing the property set, to identify the property set.</span></span> <span data-ttu-id="62e9d-107">Com essa identificação, o aplicativo interpreta as propriedades que o conjunto contém.</span><span class="sxs-lookup"><span data-stu-id="62e9d-107">Through this identification, the application interprets the properties that the set contains.</span></span>

<span data-ttu-id="62e9d-108">Por exemplo, as propriedades de formatação de caracteres em um processador de texto ou os atributos de renderização de um elemento em um programa de desenho são conjuntos de propriedades.</span><span class="sxs-lookup"><span data-stu-id="62e9d-108">For example, the character-formatting properties in a word processor or the rendering attributes of an element in a drawing program are property sets.</span></span>

<span data-ttu-id="62e9d-109">COM define a interface [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) para facilitar o gerenciamento de conjuntos de propriedades.</span><span class="sxs-lookup"><span data-stu-id="62e9d-109">COM defines the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface to facilitate management of property sets.</span></span> <span data-ttu-id="62e9d-110">Por meio dos métodos dessa interface, você pode criar um novo conjunto de propriedades ou abrir ou excluir um conjunto de propriedades existente.</span><span class="sxs-lookup"><span data-stu-id="62e9d-110">Through the methods of this interface, you can create a new property set, or open or delete an existing property set.</span></span> <span data-ttu-id="62e9d-111">Além disso, ele fornece um método que cria um enumerador e fornece um ponteiro para sua interface [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) .</span><span class="sxs-lookup"><span data-stu-id="62e9d-111">In addition, it provides a method that creates an enumerator and supplies a pointer to its [**IEnumSTATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) interface.</span></span> <span data-ttu-id="62e9d-112">Você pode chamar os métodos dessa interface para enumerar estruturas [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) em seu objeto, o que fornecerá informações sobre todos os conjuntos de propriedades no objeto.</span><span class="sxs-lookup"><span data-stu-id="62e9d-112">You can call the methods of this interface to enumerate [**STATPROPSETSTG**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) structures on your object, which will provide information about all of the property sets on the object.</span></span>

<span data-ttu-id="62e9d-113">Quando você cria ou abre uma instância de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), é semelhante a abrir um objeto que dá suporte a [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) ou [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream), pois você precisa especificar o modo de armazenamento no qual você está abrindo a interface.</span><span class="sxs-lookup"><span data-stu-id="62e9d-113">When you create or open an instance of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage), it is similar to opening an object that supports [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) or [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream), because you need to specify the storage mode in which you are opening the interface.</span></span> <span data-ttu-id="62e9d-114">Para **IStorage**, isso inclui o modo de transação, o modo de leitura/gravação e o modo de compartilhamento.</span><span class="sxs-lookup"><span data-stu-id="62e9d-114">For **IStorage**, these include the transaction mode, the read/write mode, and the sharing mode.</span></span>

<span data-ttu-id="62e9d-115">Quando você cria um conjunto de propriedades com uma chamada para [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), especifica se o conjunto de propriedades é simples ou não simples.</span><span class="sxs-lookup"><span data-stu-id="62e9d-115">When you create a property set with a call to [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create), specify whether the property set is to be simple or nonsimple.</span></span> <span data-ttu-id="62e9d-116">Um conjunto de propriedades simples contém tipos que podem ser gravados totalmente dentro do fluxo do conjunto de propriedades, que deve ser limitado em tamanho e não pode exceder 256 KB no Windows NT 4,0 e versões anteriores, ou 1 MB no Windows 2000, Windows XP e Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="62e9d-116">A simple property set contains types that can be written fully within the property set stream, which is intended to be limited in size, and can be no larger than 256 KB in Windows NT 4.0 and earlier, or 1 MB in Windows 2000, Windows XP, and Windows Server 2003.</span></span> <span data-ttu-id="62e9d-117">No entanto, quando você precisar armazenar uma quantidade maior de informações no conjunto de propriedades, poderá especificar que o conjunto de propriedades não é simples.</span><span class="sxs-lookup"><span data-stu-id="62e9d-117">However, when you need to store a larger amount of information in the property set, you can specify that the property set be nonsimple.</span></span> <span data-ttu-id="62e9d-118">Isso permite que você use um ou mais dos tipos que especificam apenas um ponteiro para um objeto de armazenamento ou de fluxo.</span><span class="sxs-lookup"><span data-stu-id="62e9d-118">This allows you to use one or more of the types that specify only a pointer to a storage or stream object.</span></span> <span data-ttu-id="62e9d-119">Esses tipos são o \_ fluxo VT, o \_ objeto transmitido VT, o \_ armazenamento VT e o \_ objeto armazenado VT \_ .</span><span class="sxs-lookup"><span data-stu-id="62e9d-119">These types are VT\_STREAM, VT\_STREAMED OBJECT, VT\_STORAGE and VT\_STORED\_OBJECT.</span></span>

<span data-ttu-id="62e9d-120">Os dados armazenados nessas propriedades não são contados em relação ao limite de tamanho do conjunto de propriedades de 256 KB no Windows NT 4,0 ou anterior, ou o limite de 1 MB no Windows 2000, no Windows XP e no Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="62e9d-120">Data stored in these properties is not counted against the 256 KB property-set size limit in Windows NT 4.0 or earlier, or the 1 MB limit in Windows 2000, Windows XP, and Windows Server 2003.</span></span> <span data-ttu-id="62e9d-121">No entanto, os dados sobre a propriedade, como seu nome, se aplicam.</span><span class="sxs-lookup"><span data-stu-id="62e9d-121">However, data about the property, such as its name, does apply.</span></span> <span data-ttu-id="62e9d-122">Além disso, se você precisar de uma atualização transacionada, o conjunto de propriedades deverá ser não simples.</span><span class="sxs-lookup"><span data-stu-id="62e9d-122">Also, if you need a transacted update, the property set must be nonsimple.</span></span> <span data-ttu-id="62e9d-123">É claro que há uma certa penalidade de desempenho para a abertura desses tipos, pois ele requer a abertura do fluxo ou objeto de armazenamento ao qual você tem o ponteiro.</span><span class="sxs-lookup"><span data-stu-id="62e9d-123">There is, of course, a certain performance penalty for opening these types, because it requires opening the stream or storage object to which you have the pointer.</span></span>

<span data-ttu-id="62e9d-124">Se seu aplicativo usar arquivos compostos, você poderá usar a implementação fornecida pelo COM dessas interfaces, que são implementadas no objeto de armazenamento de arquivo composto COM.</span><span class="sxs-lookup"><span data-stu-id="62e9d-124">If your application uses compound files, you can use the COM-provided implementation of these interfaces, which are implemented on the COM compound file storage object.</span></span>

<span data-ttu-id="62e9d-125">Cada conjunto de propriedades consiste principalmente em um grupo de propriedades logicamente conectado, conforme descrito em [Gerenciando Propriedades](managing-properties.md).</span><span class="sxs-lookup"><span data-stu-id="62e9d-125">Each property set consists primarily of a logically connected group of properties, as described in [Managing Properties](managing-properties.md).</span></span>

<span data-ttu-id="62e9d-126">Para obter mais informações sobre conjuntos de propriedades em COM, consulte:</span><span class="sxs-lookup"><span data-stu-id="62e9d-126">For more information about property sets in COM, see:</span></span>

-   [<span data-ttu-id="62e9d-127">Implementações de conjunto de propriedades em COM</span><span class="sxs-lookup"><span data-stu-id="62e9d-127">Property Set Implementations in COM</span></span>](property-set-implementations-in-com.md)
-   [<span data-ttu-id="62e9d-128">Considerações sobre o conjunto de propriedades</span><span class="sxs-lookup"><span data-stu-id="62e9d-128">Property Set Considerations</span></span>](property-set-considerations.md)
-   [<span data-ttu-id="62e9d-129">Considerações sobre implementação do IPropertySetStorage</span><span class="sxs-lookup"><span data-stu-id="62e9d-129">IPropertySetStorage Implementation Considerations</span></span>](ipropertysetstorage-implementation-considerations.md)
-   [<span data-ttu-id="62e9d-130">Armazenando conjuntos de propriedades</span><span class="sxs-lookup"><span data-stu-id="62e9d-130">Storing Property Sets</span></span>](storing-property-sets.md)
-   [<span data-ttu-id="62e9d-131">Características de desempenho</span><span class="sxs-lookup"><span data-stu-id="62e9d-131">Performance Characteristics</span></span>](performance-characteristics.md)
-   [<span data-ttu-id="62e9d-132">Implementando o conjunto de propriedades de informações de resumo</span><span class="sxs-lookup"><span data-stu-id="62e9d-132">Implementing the Summary Information Property Set</span></span>](implementing-the-summary-information-property-set.md)

 

 