---
title: Características de desempenho
description: Uma chamada para a implementação do arquivo composto COM da Interface IPropertySetStorage para criar um conjunto de propriedades faz com que um fluxo ou um armazenamento seja criado por meio de uma chamada para o IStorage CreateStream ou IStorage CreateStorage.
ms.assetid: 7773e649-19a4-4df2-84ed-027d73283140
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8597862602a367ed93a3d6e5e0bcac76035c337a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103917454"
---
# <a name="performance-characteristics"></a><span data-ttu-id="7ce1a-103">Características de desempenho</span><span class="sxs-lookup"><span data-stu-id="7ce1a-103">Performance Characteristics</span></span>

<span data-ttu-id="7ce1a-104">Uma chamada para a implementação do arquivo composto COM da interface [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) para criar um conjunto de propriedades faz com que um fluxo ou um armazenamento seja criado por meio de uma chamada para [**IStorage:: CreateStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) ou [**IStorage:: CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage).</span><span class="sxs-lookup"><span data-stu-id="7ce1a-104">A call to the COM compound file implementation of the [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) interface to create a property set causes either a stream or storage to be created through a call to [**IStorage::CreateStream**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstream) or [**IStorage::CreateStorage**](/windows/desktop/api/Objidl/nf-objidl-istorage-createstorage).</span></span> <span data-ttu-id="7ce1a-105">Um conjunto de propriedades padrão é criado na memória, mas não é liberado para o disco.</span><span class="sxs-lookup"><span data-stu-id="7ce1a-105">A default property set is created in memory, but not flushed to disk.</span></span> <span data-ttu-id="7ce1a-106">Quando há uma chamada para [**IPropertyStorage:: WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple), ela funciona dentro do buffer.</span><span class="sxs-lookup"><span data-stu-id="7ce1a-106">When there is a call to [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple), it operates within the buffer.</span></span>

<span data-ttu-id="7ce1a-107">Quando um conjunto de propriedades é aberto, [IStorage:: OpenStream](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) ou [IStorage:: OpenStorage](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) é usado.</span><span class="sxs-lookup"><span data-stu-id="7ce1a-107">When a property set is opened, [IStorage::OpenStream](/windows/desktop/api/Objidl/nf-objidl-istorage-openstream) or [IStorage::OpenStorage](/windows/desktop/api/Objidl/nf-objidl-istorage-openstorage) is used.</span></span> <span data-ttu-id="7ce1a-108">O fluxo do conjunto de propriedades inteiro é lido na memória contígua.</span><span class="sxs-lookup"><span data-stu-id="7ce1a-108">The entire property set stream is read into contiguous memory.</span></span> <span data-ttu-id="7ce1a-109">As operações [**IPropertyStorage:: ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) funcionam lendo o buffer de memória.</span><span class="sxs-lookup"><span data-stu-id="7ce1a-109">[**IPropertyStorage::ReadMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) operations then operate by reading the memory buffer.</span></span> <span data-ttu-id="7ce1a-110">Portanto, o primeiro acesso é caro em termos de tempo (devido a leituras de disco), mas os acessos subsequentes são muito eficientes.</span><span class="sxs-lookup"><span data-stu-id="7ce1a-110">Therefore, the first access is expensive in terms of time (because of disk reads) but subsequent accesses are very efficient.</span></span> <span data-ttu-id="7ce1a-111">As gravações podem ser um pouco mais caras porque as operações SetSize no fluxo subjacente podem ser necessárias para garantir que o espaço em disco esteja disponível se os dados forem adicionados.</span><span class="sxs-lookup"><span data-stu-id="7ce1a-111">Writes may be slightly more expensive because SetSize operations on the underlying stream may be required to guarantee that disk space is available if data is added.</span></span>

<span data-ttu-id="7ce1a-112">Nenhuma garantia é feita se [**IPropertyStorage:: WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) liberar as atualizações.</span><span class="sxs-lookup"><span data-stu-id="7ce1a-112">No guarantees are made as to whether [**IPropertyStorage::WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) will flush updates.</span></span> <span data-ttu-id="7ce1a-113">Em geral, o cliente deve assumir que **IPropertyStorage:: WriteMultiple** atualiza apenas o buffer de memória.</span><span class="sxs-lookup"><span data-stu-id="7ce1a-113">In general, the client should assume that **IPropertyStorage::WriteMultiple** only updates the in memory buffer.</span></span> <span data-ttu-id="7ce1a-114">Para liberar dados, [**IPropertyStorage:: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) ou [**IUnknown:: Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) (última versão) deve ser chamado.</span><span class="sxs-lookup"><span data-stu-id="7ce1a-114">To flush data, [**IPropertyStorage::Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) or [**IUnknown::Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) (last release) should be called.</span></span>

<span data-ttu-id="7ce1a-115">Esse design significa que o [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) pode ter sucesso, mas os dados não são realmente gravados de forma persistente.</span><span class="sxs-lookup"><span data-stu-id="7ce1a-115">This design means that [**WriteMultiple**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writemultiple) may succeed but the data is not actually persistently written.</span></span>

> [!Note]  
> <span data-ttu-id="7ce1a-116">Esse tamanho do fluxo do conjunto de propriedades não pode exceder 256 bytes.</span><span class="sxs-lookup"><span data-stu-id="7ce1a-116">This size of the property set stream cannot exceed 256K bytes.</span></span>

 

 

 