---
title: Serialização do conjunto de propriedades
description: Há duas versões do formato de serialização do conjunto de propriedades.
ms.assetid: 10544118-5e80-47e2-b75b-c1a43be15b2e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49c635728e169cdddb20437323a49a18496b3459
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104162330"
---
# <a name="property-set-serialization"></a><span data-ttu-id="14c26-103">Serialização do conjunto de propriedades</span><span class="sxs-lookup"><span data-stu-id="14c26-103">Property Set Serialization</span></span>

<span data-ttu-id="14c26-104">Há duas versões do formato de serialização do conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="14c26-104">There are two versions of the property set serialization format.</span></span> <span data-ttu-id="14c26-105">A especificação original descreve a versão 0 do formato.</span><span class="sxs-lookup"><span data-stu-id="14c26-105">The original specification describes version 0 of the format.</span></span> <span data-ttu-id="14c26-106">Consulte [Formatar versão](format-version.md) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="14c26-106">See [Format Version](format-version.md) for more information.</span></span> <span data-ttu-id="14c26-107">A versão 1 estende a versão original.</span><span class="sxs-lookup"><span data-stu-id="14c26-107">Version 1 extends the original version.</span></span> <span data-ttu-id="14c26-108">Todos os conjuntos de propriedades da versão 0 são válidos como conjuntos de propriedades da versão 1.</span><span class="sxs-lookup"><span data-stu-id="14c26-108">All version 0 property sets are valid as version 1 property sets.</span></span> <span data-ttu-id="14c26-109">O campo **versão de formato** no cabeçalho de um conjunto de propriedades serializadas indica a versão.</span><span class="sxs-lookup"><span data-stu-id="14c26-109">The **Format Version** field in the header of a serialized property set indicates the version.</span></span>

<span data-ttu-id="14c26-110">Os itens a seguir identificam as diferenças entre a versão 0 e os formatos de serialização do conjunto de propriedades da versão 1.</span><span class="sxs-lookup"><span data-stu-id="14c26-110">The following items identify the differences between version 0 and version 1 property set serialization formats.</span></span>

-   <span data-ttu-id="14c26-111">Suporte para novos valores **VarType** .</span><span class="sxs-lookup"><span data-stu-id="14c26-111">Support for new **VARTYPE** values.</span></span> <span data-ttu-id="14c26-112">Para obter mais informações sobre valores **VarType** e como usá-los, consulte o tópico [tipos de dados e estruturas do IDispatch]( /previous-versions/ms221600(v=vs.100)) e a estrutura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="14c26-112">For more information about **VARTYPE** values and how to use them, see the topic [IDispatch Data Types and Structures]( /previous-versions/ms221600(v=vs.100)) and the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

    <span data-ttu-id="14c26-113">Os seguintes valores **VarType** não têm suporte nos conjuntos de propriedades da versão 0, mas têm suporte na versão 1:</span><span class="sxs-lookup"><span data-stu-id="14c26-113">The following **VARTYPE** values are not supported in version 0 property sets, but are supported in version 1:</span></span>

    <span data-ttu-id="14c26-114">VT \_ i1</span><span class="sxs-lookup"><span data-stu-id="14c26-114">VT\_I1</span></span>

    <span data-ttu-id="14c26-115">\_Vetor VT \| UT \_ i1</span><span class="sxs-lookup"><span data-stu-id="14c26-115">VT\_VECTOR \| VT\_I1</span></span>

    <span data-ttu-id="14c26-116">VT \_ int</span><span class="sxs-lookup"><span data-stu-id="14c26-116">VT\_INT</span></span>

    <span data-ttu-id="14c26-117">VT \_ uint</span><span class="sxs-lookup"><span data-stu-id="14c26-117">VT\_UINT</span></span>

    <span data-ttu-id="14c26-118">\_decimal VT</span><span class="sxs-lookup"><span data-stu-id="14c26-118">VT\_DECIMAL</span></span>

    <span data-ttu-id="14c26-119">Além disso, SafeArrays podem ser serializados em um conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="14c26-119">Additionally, SafeArrays can be serialized in a property set.</span></span> <span data-ttu-id="14c26-120">A presença de um SafeArray é indicada pelo bit da \_ matriz VT combinado, usando uma operação **ou** , com os elementos da matriz no membro **VT** da estrutura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="14c26-120">The presence of a SafeArray is indicated by the VT\_ARRAY bit combined, using an **OR** operation, with the array elements in the **vt** member of the [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span> <span data-ttu-id="14c26-121">Por exemplo, um SafeArray de inteiros com sinal de 4 bytes tem um tipo de i4 da matriz VT VT \_ \| \_ .</span><span class="sxs-lookup"><span data-stu-id="14c26-121">For example, a SafeArray of 4-byte signed integers has a type of VT\_ARRAY \| VT\_I4.</span></span>

    <span data-ttu-id="14c26-122">Os seguintes tipos de elemento são válidos para um SafeArray em um conjunto de propriedades serializadas:</span><span class="sxs-lookup"><span data-stu-id="14c26-122">The following element types are valid for a SafeArray in a serialized property set:</span></span>



|             |          |             |           |
|-------------|----------|-------------|-----------|
| <span data-ttu-id="14c26-123">VT \_ i1</span><span class="sxs-lookup"><span data-stu-id="14c26-123">VT\_I1</span></span>      | <span data-ttu-id="14c26-124">\_UI1 VT</span><span class="sxs-lookup"><span data-stu-id="14c26-124">VT\_UI1</span></span>  | <span data-ttu-id="14c26-125">\_I2 VT</span><span class="sxs-lookup"><span data-stu-id="14c26-125">VT\_I2</span></span>      | <span data-ttu-id="14c26-126">\_UI2 VT</span><span class="sxs-lookup"><span data-stu-id="14c26-126">VT\_UI2</span></span>   |
| <span data-ttu-id="14c26-127">\_I4 VT</span><span class="sxs-lookup"><span data-stu-id="14c26-127">VT\_I4</span></span>      | <span data-ttu-id="14c26-128">\_UI4 VT</span><span class="sxs-lookup"><span data-stu-id="14c26-128">VT\_UI4</span></span>  | <span data-ttu-id="14c26-129">VT \_ int</span><span class="sxs-lookup"><span data-stu-id="14c26-129">VT\_INT</span></span>     | <span data-ttu-id="14c26-130">VT \_ uint</span><span class="sxs-lookup"><span data-stu-id="14c26-130">VT\_UINT</span></span>  |
| <span data-ttu-id="14c26-131">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="14c26-131">VT\_R4</span></span>      | <span data-ttu-id="14c26-132">R8 de VT \_</span><span class="sxs-lookup"><span data-stu-id="14c26-132">VT\_R8</span></span>   | <span data-ttu-id="14c26-133">VT \_ Cy</span><span class="sxs-lookup"><span data-stu-id="14c26-133">VT\_CY</span></span>      | <span data-ttu-id="14c26-134">Data de VT \_</span><span class="sxs-lookup"><span data-stu-id="14c26-134">VT\_DATE</span></span>  |
| <span data-ttu-id="14c26-135">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="14c26-135">VT\_BSTR</span></span>    | <span data-ttu-id="14c26-136">BOOL do VT \_</span><span class="sxs-lookup"><span data-stu-id="14c26-136">VT\_BOOL</span></span> | <span data-ttu-id="14c26-137">\_decimal VT</span><span class="sxs-lookup"><span data-stu-id="14c26-137">VT\_DECIMAL</span></span> | <span data-ttu-id="14c26-138">erro de VT \_</span><span class="sxs-lookup"><span data-stu-id="14c26-138">VT\_ERROR</span></span> |
| <span data-ttu-id="14c26-139">variante do VT \_</span><span class="sxs-lookup"><span data-stu-id="14c26-139">VT\_VARIANT</span></span> |          |             |           |



 

<span data-ttu-id="14c26-140">Quando o \_ tipo de dados de variante VT é especificado, ele indica que o SAFEARRAY em si contém estruturas [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="14c26-140">When the VT\_VARIANT data type is specified, it indicates that the SafeArray itself holds [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structures.</span></span> <span data-ttu-id="14c26-141">Os tipos desses elementos devem ser da lista anterior, exceto que não podem conter tipos de variante VT aninhados \_ .</span><span class="sxs-lookup"><span data-stu-id="14c26-141">The types for these elements must be from the preceding list, except they cannot contain nested VT\_VARIANT types.</span></span>

<span data-ttu-id="14c26-142">Observe que as implementações de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) devem ser capazes de recuperar normalmente retornando um erro quando um novo tipo é encontrado; por exemplo, VARENUM Types.</span><span class="sxs-lookup"><span data-stu-id="14c26-142">Note that implementations of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) must be able to recover gracefully by returning an error when a new type is encountered; for example, VARENUM types.</span></span>

-   <span data-ttu-id="14c26-143">Nomes de propriedade diferenciar maiúsculas e minúsculas.</span><span class="sxs-lookup"><span data-stu-id="14c26-143">Case sensitive property names.</span></span> <span data-ttu-id="14c26-144">Os nomes de propriedade, por exemplo, aqueles especificados no método [**IPropertyStorage:: WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames) , não diferenciam maiúsculas de minúsculas nos conjuntos de propriedades da versão 0.</span><span class="sxs-lookup"><span data-stu-id="14c26-144">Property names, for example those specified in the [**IPropertyStorage::WritePropertyNames**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-writepropertynames) method, are not case sensitive in version 0 property sets.</span></span> <span data-ttu-id="14c26-145">Nos conjuntos de propriedades da versão 1, os nomes de propriedade podem diferenciar maiúsculas de minúsculas, dependendo do valor da nova propriedade de comportamento.</span><span class="sxs-lookup"><span data-stu-id="14c26-145">In version 1 property sets, property names can be case-sensitive depending on the value of the new Behavior property.</span></span>

    <span data-ttu-id="14c26-146">A propriedade Behavior é a [ID de propriedade 0x80000003](/windows/desktop/Stg/reserved-property-identifiers) com um tipo de VT \_ UI4.</span><span class="sxs-lookup"><span data-stu-id="14c26-146">The Behavior property is [Property ID 0x80000003](/windows/desktop/Stg/reserved-property-identifiers) with a type of VT\_UI4.</span></span> <span data-ttu-id="14c26-147">Se o menor bit desse valor for definido, os nomes do conjunto de propriedades diferenciarão maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="14c26-147">If the lowest bit of this value is set, the property set names are case sensitive.</span></span> <span data-ttu-id="14c26-148">Defina o \_ sinalizador de diferenciação de maiúsculas e minúsculas PROPSETFLAG \_ no parâmetro *GrfFlags* do método [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) para especificar um conjunto de propriedades que diferencia maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="14c26-148">Set the PROPSETFLAG\_CASE\_SENSITIVE flag in the *grfFlags* parameter of the [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) method to specify a case-sensitive property set.</span></span>

-   <span data-ttu-id="14c26-149">Nomes de propriedade longos.</span><span class="sxs-lookup"><span data-stu-id="14c26-149">Long property names.</span></span> <span data-ttu-id="14c26-150">Os nomes de propriedade dos conjuntos de propriedades da versão 0 devem ser menores ou iguais a 256 caracteres, incluindo o terminador de cadeia de caracteres, para conjuntos de propriedades na página de código Unicode.</span><span class="sxs-lookup"><span data-stu-id="14c26-150">Property names for version 0 property sets must be less than or equal to 256 characters, including the string terminator, for property sets in the Unicode code page.</span></span> <span data-ttu-id="14c26-151">Se não estiver na página de código Unicode, eles deverão ter menos de 256 bytes.</span><span class="sxs-lookup"><span data-stu-id="14c26-151">If not in the Unicode code page, they must be less than 256 bytes.</span></span> <span data-ttu-id="14c26-152">Por outro lado, os conjuntos de propriedades da versão 1 podem ter nomes de propriedade de comprimento ilimitado, embora eles ainda sejam limitados pelo limite de tamanho do conjunto de propriedades geral de 256 kilobytes (KB).</span><span class="sxs-lookup"><span data-stu-id="14c26-152">Version 1 property sets, on the other hand, can have property names of unlimited length, although they are still limited by the overall property set size limit of 256 kilobytes (KB).</span></span>

<span data-ttu-id="14c26-153">É recomendável que as implementações de [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) criem e mantenham os conjuntos de propriedades da versão 0 por padrão.</span><span class="sxs-lookup"><span data-stu-id="14c26-153">It is recommended that implementations of [**IPropertyStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) create and maintain version 0 property sets by default.</span></span> <span data-ttu-id="14c26-154">Em seguida, se um chamador solicitar um recurso específico para o formato da versão 1, somente a versão do conjunto de propriedades deverá ser atualizada.</span><span class="sxs-lookup"><span data-stu-id="14c26-154">If a caller subsequently requests a feature specific to the version 1 format, only then should the version of the property set be updated.</span></span> <span data-ttu-id="14c26-155">Por exemplo, se uma propriedade da matriz de tipo VT \_ for gravada ou se um nome de propriedade longo for gravado, a implementação deverá atualizar o formato do conjunto de propriedades para a versão 1.</span><span class="sxs-lookup"><span data-stu-id="14c26-155">For example, if a property of type VT\_ARRAY is written or if a long property name is written, then the implementation should update the property set format to version 1.</span></span> <span data-ttu-id="14c26-156">Uma exceção a essa diretriz ocorre se o \_ valor de enumeração diferenciar maiúsculas e minúsculas PROPSETFLAG \_ for especificado na chamada para [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span><span class="sxs-lookup"><span data-stu-id="14c26-156">One exception to this guideline occurs if the PROPSETFLAG\_CASE\_SENSITIVE enumeration value is specified in the call to [**IPropertySetStorage::Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create).</span></span> <span data-ttu-id="14c26-157">Nesse caso, o conjunto de propriedades deve ser criado como um conjunto de propriedades da versão 1.</span><span class="sxs-lookup"><span data-stu-id="14c26-157">In this case, the property set must be created as a version 1 property set.</span></span>

 

 