---
title: Métodos IPaperSink
description: O copaper expõe a interface IConnectionPointContainer para que os clientes possam se conectar ao copaper a fim de receber notificações de eventos especificados que ocorrem em copapel.
ms.assetid: 2466c721-b275-4dbc-a604-2d5e6a29d6a1
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: ac8dee615b278c5214ad1efa3c10d22759620103
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104162364"
---
# <a name="ipapersink-methods"></a><span data-ttu-id="00b9d-103">Métodos IPaperSink</span><span class="sxs-lookup"><span data-stu-id="00b9d-103">IPaperSink Methods</span></span>

<span data-ttu-id="00b9d-104">O copaper expõe a interface [**IConnectionPointContainer**](/windows/win32/api/ocidl/nn-ocidl-iconnectionpointcontainer) para que os clientes possam se conectar ao copaper a fim de receber notificações de eventos especificados que ocorrem em copapel.</span><span class="sxs-lookup"><span data-stu-id="00b9d-104">COPaper exposes the [**IConnectionPointContainer**](/windows/win32/api/ocidl/nn-ocidl-iconnectionpointcontainer) interface so clients can connect to COPaper in order to receive notifications of specified events that occur in COPaper.</span></span> <span data-ttu-id="00b9d-105">Ao expor essa interface, o copaper se torna um objeto conectável.</span><span class="sxs-lookup"><span data-stu-id="00b9d-105">By exposing this interface, COPaper becomes a connectable object.</span></span> <span data-ttu-id="00b9d-106">Um cliente pode chamar [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) para essa interface e usá-la para obter os pontos de conexão do objeto.</span><span class="sxs-lookup"><span data-stu-id="00b9d-106">A client can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for this interface and use it to obtain the object's connection points.</span></span> <span data-ttu-id="00b9d-107">A participação do cliente neste esquema é abordada no exemplo de **StoClien** associado.</span><span class="sxs-lookup"><span data-stu-id="00b9d-107">The client participation in this scheme is covered in the associated **StoClien** sample.</span></span>

<span data-ttu-id="00b9d-108">Basicamente, o cliente implementa o que é chamado de coletor na forma de um objeto de coletor com uma interface de coletor.</span><span class="sxs-lookup"><span data-stu-id="00b9d-108">Basically, the client implements what is called a sink in the form of a sink object with a sink interface.</span></span> <span data-ttu-id="00b9d-109">A interface do coletor recebe chamadas de notificação de eventos de saída do copaper após o coletor ser corretamente conectado pelo cliente a uma instância de copapel.</span><span class="sxs-lookup"><span data-stu-id="00b9d-109">The sink interface receives outgoing event notification calls from COPaper after the sink is properly connected by the client to a COPaper instance.</span></span> <span data-ttu-id="00b9d-110">O cliente faz a conexão usando um objeto de ponto de conexão que é gerenciado por copaper.</span><span class="sxs-lookup"><span data-stu-id="00b9d-110">The client makes the connection by using a connection point object that is managed by COPaper.</span></span> <span data-ttu-id="00b9d-111">Pode haver inúmeros pontos de conexão em um único objeto COM conectável.</span><span class="sxs-lookup"><span data-stu-id="00b9d-111">There can be numerous connection points on a single connectable COM object.</span></span> <span data-ttu-id="00b9d-112">No exemplo de **StoServe** , o copaper tem apenas um ponto de conexão, que manipula os eventos de papel de desenho.</span><span class="sxs-lookup"><span data-stu-id="00b9d-112">In the **StoServe** sample, COPaper has only one connection point, which handles drawing paper events.</span></span>

<span data-ttu-id="00b9d-113">Qualquer número de clientes pode se conectar a um único ponto de conexão.</span><span class="sxs-lookup"><span data-stu-id="00b9d-113">Any number of clients can connect to a single connection point.</span></span> <span data-ttu-id="00b9d-114">O ponto de conexão do CONNPOINT \_ PAPERSINK no copaper mantém um grupo de conexões que podem crescer dinamicamente no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="00b9d-114">The CONNPOINT\_PAPERSINK connection point in COPaper maintains a group of connections that can grow dynamically at run time.</span></span> <span data-ttu-id="00b9d-115">Os detalhes completos sobre o suporte a objetos conectáveis do copaper são codificados em arquivos CONNECT. H e conectar. CPP e não serão abordados aqui.</span><span class="sxs-lookup"><span data-stu-id="00b9d-115">The full details on COPaper's connectable object support is coded in files CONNECT.H and CONNECT.CPP and will not be covered here.</span></span> <span data-ttu-id="00b9d-116">A construção é muito semelhante ao que foi estudado no exemplo de código para conservar.</span><span class="sxs-lookup"><span data-stu-id="00b9d-116">The construction is very similar to what was studied in the CONSERVE code sample.</span></span>

<span data-ttu-id="00b9d-117">O cliente **StoClien** implementa os objetos de coletor apropriados para os pontos de conexão que espera encontrar no copaper.</span><span class="sxs-lookup"><span data-stu-id="00b9d-117">The **StoClien** client implements appropriate sink objects for the connection points it expects to find in COPaper.</span></span> <span data-ttu-id="00b9d-118">No contexto de copaper, o objeto de coletor importante que o **StoClien** implementa expõe a interface **IPaperSink** .</span><span class="sxs-lookup"><span data-stu-id="00b9d-118">From the context of COPaper, the important sink object that **StoClien** implements exposes the **IPaperSink** interface.</span></span> <span data-ttu-id="00b9d-119">Essa é a interface de saída usada pelo copaper para notificar **StoClien** de vários eventos em copapel.</span><span class="sxs-lookup"><span data-stu-id="00b9d-119">This is the outgoing interface used by COPaper to notify **StoClien** of various events in COPaper.</span></span>

<span data-ttu-id="00b9d-120">Aqui está um resumo dos métodos no **IPaperSink** do IPAPER. H no \\ diretório irmão Inc.</span><span class="sxs-lookup"><span data-stu-id="00b9d-120">Here is a summary of the methods in **IPaperSink** from IPAPER.H in the \\INC sibling directory.</span></span>



| <span data-ttu-id="00b9d-121">Método</span><span class="sxs-lookup"><span data-stu-id="00b9d-121">Method</span></span>   | <span data-ttu-id="00b9d-122">Descrição</span><span class="sxs-lookup"><span data-stu-id="00b9d-122">Description</span></span>                                                   |
|----------|---------------------------------------------------------------|
| <span data-ttu-id="00b9d-123">Bloqueado</span><span class="sxs-lookup"><span data-stu-id="00b9d-123">Locked</span></span>   | <span data-ttu-id="00b9d-124">Um cliente assumiu o controle e bloqueou o documento.</span><span class="sxs-lookup"><span data-stu-id="00b9d-124">A client has taken control of and locked the paper.</span></span>           |
| <span data-ttu-id="00b9d-125">Desbloqueado</span><span class="sxs-lookup"><span data-stu-id="00b9d-125">Unlocked</span></span> | <span data-ttu-id="00b9d-126">Um cliente abandonou o controle do papel.</span><span class="sxs-lookup"><span data-stu-id="00b9d-126">A client has relinquished control of the paper.</span></span>               |
| <span data-ttu-id="00b9d-127">Carregado</span><span class="sxs-lookup"><span data-stu-id="00b9d-127">Loaded</span></span>   | <span data-ttu-id="00b9d-128">Um cliente carregou o conteúdo de papel de seu próprio arquivo composto.</span><span class="sxs-lookup"><span data-stu-id="00b9d-128">A client has loaded paper content from its own compound file.</span></span> |
| <span data-ttu-id="00b9d-129">Salvo</span><span class="sxs-lookup"><span data-stu-id="00b9d-129">Saved</span></span>    | <span data-ttu-id="00b9d-130">Um cliente salvou o conteúdo de papel em seu próprio arquivo composto.</span><span class="sxs-lookup"><span data-stu-id="00b9d-130">A client has saved paper content to its own compound file.</span></span>    |
| <span data-ttu-id="00b9d-131">InkStart</span><span class="sxs-lookup"><span data-stu-id="00b9d-131">InkStart</span></span> | <span data-ttu-id="00b9d-132">Um cliente iniciou uma sequência de desenho de tinta colorida para o documento.</span><span class="sxs-lookup"><span data-stu-id="00b9d-132">A client started a color ink drawing sequence to the paper.</span></span>   |
| <span data-ttu-id="00b9d-133">InkDraw</span><span class="sxs-lookup"><span data-stu-id="00b9d-133">InkDraw</span></span>  | <span data-ttu-id="00b9d-134">Um cliente está colocando pontos de dados de tinta na superfície do papel.</span><span class="sxs-lookup"><span data-stu-id="00b9d-134">A client is putting ink data points on the paper surface.</span></span>     |
| <span data-ttu-id="00b9d-135">InkStop</span><span class="sxs-lookup"><span data-stu-id="00b9d-135">InkStop</span></span>  | <span data-ttu-id="00b9d-136">Um cliente interrompeu sua sequência de desenho de tinta para o documento.</span><span class="sxs-lookup"><span data-stu-id="00b9d-136">A client has stopped its ink drawing sequence to the paper.</span></span>   |
| <span data-ttu-id="00b9d-137">Apagados</span><span class="sxs-lookup"><span data-stu-id="00b9d-137">Erased</span></span>   | <span data-ttu-id="00b9d-138">Um cliente apagou todos os dados de tinta do documento.</span><span class="sxs-lookup"><span data-stu-id="00b9d-138">A client has erased all ink data from the paper.</span></span>              |
| <span data-ttu-id="00b9d-139">Redimensionado</span><span class="sxs-lookup"><span data-stu-id="00b9d-139">Resized</span></span>  | <span data-ttu-id="00b9d-140">Um cliente redimensionou o documento.</span><span class="sxs-lookup"><span data-stu-id="00b9d-140">A client has resized the paper.</span></span>                               |



 

<span data-ttu-id="00b9d-141">Esses métodos são amplamente auto-explicativos.</span><span class="sxs-lookup"><span data-stu-id="00b9d-141">These methods are largely self-explanatory.</span></span> <span data-ttu-id="00b9d-142">Embora o coletor deva implementar todos esses métodos de alguma maneira, muitos são implementados como stubs e não são usados nos exemplos de StoClien de **StoServe** /  .</span><span class="sxs-lookup"><span data-stu-id="00b9d-142">Although the sink must implement all these methods in some fashion, many are implemented as stubs and are not used in the **StoServe**/**StoClien** samples.</span></span>

<span data-ttu-id="00b9d-143">Um método importante usado nesses exemplos é o método carregado.</span><span class="sxs-lookup"><span data-stu-id="00b9d-143">An important method used in these samples is the Loaded method.</span></span> <span data-ttu-id="00b9d-144">Quando o copapel é informado pelo cliente para carregar um novo desenho do arquivo, ele precisa de uma maneira de notificar o cliente quando os novos dados são carregados.</span><span class="sxs-lookup"><span data-stu-id="00b9d-144">When COPaper is told by the client to load a new drawing from file, it needs a way to notify the client when the new data is loaded.</span></span> <span data-ttu-id="00b9d-145">Para fazer isso, o copaper chama **IPaperSink:: Loaded** no coletor do cliente.</span><span class="sxs-lookup"><span data-stu-id="00b9d-145">To do this, COPaper Calls **IPaperSink::Loaded** on the client sink.</span></span> <span data-ttu-id="00b9d-146">O cliente pode então chamar [**IPaper:: redesenhar**](ipaper--redraw.md) para solicitar que o copapel reproduza os novos dados para o cliente.</span><span class="sxs-lookup"><span data-stu-id="00b9d-146">The client can then call [**IPaper::Redraw**](ipaper--redraw.md) to request that COPaper play back the new data to the client.</span></span> <span data-ttu-id="00b9d-147">Redesenhar faz com que o desenho carregado na exibição do cliente seja redesenhado.</span><span class="sxs-lookup"><span data-stu-id="00b9d-147">Redraw causes the loaded drawing in the client's display to be repainted.</span></span> <span data-ttu-id="00b9d-148">Quando a carga é concluída, o desenho carregado recentemente é exibido automaticamente na janela fornecida pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="00b9d-148">When the load is completed, the newly loaded drawing is displayed automatically in the window provided by the client.</span></span>

<span data-ttu-id="00b9d-149">Consulte [**IPaper:: redesenhar**](ipaper--redraw.md) para obter informações completas sobre a conectividade desse método IPaper com o **IPaperSink**.</span><span class="sxs-lookup"><span data-stu-id="00b9d-149">See [**IPaper::Redraw**](ipaper--redraw.md) for complete information of this IPaper method's connectivity to **IPaperSink**.</span></span>

<span data-ttu-id="00b9d-150">Os  métodos IPaperSink **InkStart**, **InkDraw** e **InkStop** são usados para enviar pacotes de dados de tinta individuais de volta para o cliente.</span><span class="sxs-lookup"><span data-stu-id="00b9d-150">The **IPaperSink** methods **InkStart**, **InkDraw**, and **InkStop** are used to send individual ink data packets back to the client.</span></span> <span data-ttu-id="00b9d-151">Na recepção, o cliente os pinta em sua exibição da mesma maneira como quando as enviou originalmente para o copapel.</span><span class="sxs-lookup"><span data-stu-id="00b9d-151">On reception, the client paints them in its display in the same manner as when it originally sent them to COPaper.</span></span> <span data-ttu-id="00b9d-152">A lógica acima é geral o suficiente para permitir que vários clientes que estão escutando no mesmo ponto de conexão do CONNPOINT \_ PAPERSINK.</span><span class="sxs-lookup"><span data-stu-id="00b9d-152">The above logic is general enough to allow for multiple clients that are all listening on the same CONNPOINT\_PAPERSINK connection point.</span></span> <span data-ttu-id="00b9d-153">Se uma instância de copapel comum foi compartilhada por esses clientes, todas elas podem exibir o mesmo desenho conectando-se a esse ponto de conexão.</span><span class="sxs-lookup"><span data-stu-id="00b9d-153">If a common COPaper instance was shared by these clients, they could all display the same drawing by connecting to this connection point.</span></span>

 

 