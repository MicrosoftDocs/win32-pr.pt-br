---
title: Usando o WER
description: A partir do Windows Vista, o Windows fornece um relatório de falhas, sem resposta e falha de kernel, por padrão, sem a necessidade de alterações no aplicativo.
ms.assetid: c096cd89-e3a7-4959-a35f-40e6168f277e
keywords:
- Relatório de Erros do Windows de relatório de erros do Windows, usando
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 655bed6d11757d7d4e08cd00ac47479e1246f96b
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "104365831"
---
# <a name="using-wer"></a><span data-ttu-id="1a5f5-104">Usando o WER</span><span class="sxs-lookup"><span data-stu-id="1a5f5-104">Using WER</span></span>

<span data-ttu-id="1a5f5-105">A partir do Windows Vista, o Windows fornece um relatório de falhas, sem resposta e falha de kernel, por padrão, sem a necessidade de alterações no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-105">Beginning with Windows Vista, Windows provides crash, non-response, and kernel fault error reporting by default without requiring changes to your application.</span></span> <span data-ttu-id="1a5f5-106">O relatório incluirá informações de minidespejo e despejo de heap, se necessário.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-106">The report will include minidump and heap dump information if required.</span></span> <span data-ttu-id="1a5f5-107">Em vez disso, os aplicativos usam a API WER para enviar relatórios de problemas específicos do aplicativo à Microsoft.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-107">Applications instead use the WER API to send application-specific problem reports to Microsoft.</span></span>

<span data-ttu-id="1a5f5-108">Como o Windows relata automaticamente as exceções sem tratamento, o aplicativo não deve lidar com exceções fatais.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-108">Because Windows automatically reports unhandled exceptions, application should not handle fatal exceptions.</span></span> <span data-ttu-id="1a5f5-109">Se o processo de falha ou não resposta for interativo, o WER exibirá uma interface do usuário informando o usuário do problema.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-109">If the faulting or not-responding process is interactive, WER displays a user interface informing the user of the problem.</span></span> <span data-ttu-id="1a5f5-110">Um aplicativo será considerado sem resposta se não responder a mensagens do Windows por cinco segundos enquanto o usuário estiver tentando interagir com o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-110">An application is considered unresponsive if it does not respond to Windows messages for five seconds while the user is trying to interact with the application.</span></span>

## <a name="windows-error-reporting-flow-for-crashes-non-response-and-kernel-faults"></a><span data-ttu-id="1a5f5-111">Fluxo de Relatório de Erros do Windows para falhas, não resposta e falhas de kernel</span><span class="sxs-lookup"><span data-stu-id="1a5f5-111">Windows Error Reporting flow for crashes, non-response, and kernel faults</span></span>

<span data-ttu-id="1a5f5-112">O seguinte mostra as etapas que ocorrem para uma falha de aplicativo, não resposta ou falha do kernel.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-112">The following shows the steps that occur for an application crash, non-response, or kernel fault.</span></span>

1.  <span data-ttu-id="1a5f5-113">O evento de problema ocorre.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-113">The problem event occurs.</span></span>
2.  <span data-ttu-id="1a5f5-114">O sistema operacional invoca o WER.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-114">The operating system invokes WER.</span></span>
3.  <span data-ttu-id="1a5f5-115">O WER coleta os dados, cria um relatório e solicita o consentimento do usuário (se necessário).</span><span class="sxs-lookup"><span data-stu-id="1a5f5-115">WER collects the data, builds a report, and prompts the user for consent (if needed).</span></span>
4.  <span data-ttu-id="1a5f5-116">O WER enviará o relatório para a Microsoft (servidor Watson) se o usuário tiver consentido.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-116">WER sends the report to Microsoft (Watson Server) if the user consented.</span></span>
5.  <span data-ttu-id="1a5f5-117">Se o servidor Watson solicitar dados adicionais, o WER coletará os dados e solicitará o consentimento do usuário (se necessário).</span><span class="sxs-lookup"><span data-stu-id="1a5f5-117">If the Watson server requests additional data, WER collects the data and prompts the user for consent (if needed).</span></span>
6.  <span data-ttu-id="1a5f5-118">Se o aplicativo tiver se registrado para recuperação e reinicialização, o WER executará as funções de retorno de chamada registradas enquanto os dados são compactados e enviados à Microsoft (se o usuário tiver consentido).</span><span class="sxs-lookup"><span data-stu-id="1a5f5-118">If the application has registered for recovery and restart, WER executes the registered callback functions while the data is compressed and sent to Microsoft (if the user consented).</span></span>
7.  <span data-ttu-id="1a5f5-119">Se uma resposta para o problema estiver disponível na Microsoft, o usuário será notificado.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-119">If a response to the problem is available from Microsoft, the user is notified.</span></span>

<span data-ttu-id="1a5f5-120">Os aplicativos podem usar as seguintes funções para personalizar o conteúdo do relatório que é enviado à Microsoft.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-120">Applications can use the following functions to customize the contents of the report that is sent to Microsoft.</span></span> <span data-ttu-id="1a5f5-121">As funções de registro informam ao WER para incluir os arquivos específicos e os blocos de memória no relatório de erros que ele cria.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-121">The registration functions tell WER to include the specific files and memory blocks in the error report that it creates.</span></span>

-   [<span data-ttu-id="1a5f5-122">**WerRegisterFile**</span><span class="sxs-lookup"><span data-stu-id="1a5f5-122">**WerRegisterFile**</span></span>](/windows/desktop/api/Werapi/nf-werapi-werregisterfile)
-   [<span data-ttu-id="1a5f5-123">**WerRegisterMemoryBlock**</span><span class="sxs-lookup"><span data-stu-id="1a5f5-123">**WerRegisterMemoryBlock**</span></span>](/windows/desktop/api/Werapi/nf-werapi-werregistermemoryblock)
-   [<span data-ttu-id="1a5f5-124">**WerSetFlags**</span><span class="sxs-lookup"><span data-stu-id="1a5f5-124">**WerSetFlags**</span></span>](/windows/desktop/api/Werapi/nf-werapi-wersetflags)
-   [<span data-ttu-id="1a5f5-125">**WerUnregisterFile**</span><span class="sxs-lookup"><span data-stu-id="1a5f5-125">**WerUnregisterFile**</span></span>](/windows/desktop/api/Werapi/nf-werapi-werunregisterfile)
-   [<span data-ttu-id="1a5f5-126">**WerUnregisterMemoryBlock**</span><span class="sxs-lookup"><span data-stu-id="1a5f5-126">**WerUnregisterMemoryBlock**</span></span>](/windows/desktop/api/Werapi/nf-werapi-werunregistermemoryblock)
-   [<span data-ttu-id="1a5f5-127">**WerGetFlags**</span><span class="sxs-lookup"><span data-stu-id="1a5f5-127">**WerGetFlags**</span></span>](/windows/desktop/api/Werapi/nf-werapi-wergetflags)

## <a name="windows-error-reporting-flow-for-generic-event-reporting"></a><span data-ttu-id="1a5f5-128">Fluxo de Relatório de Erros do Windows para relatórios de eventos genéricos</span><span class="sxs-lookup"><span data-stu-id="1a5f5-128">Windows Error Reporting flow for generic event reporting</span></span>

<span data-ttu-id="1a5f5-129">As etapas a seguir mostram como os aplicativos podem obter um relatório de erros para uma condição de erro não fatal.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-129">The following steps show how applications can get an error report for a non-fatal error condition.</span></span>

1.  <span data-ttu-id="1a5f5-130">O evento de problema não fatal ocorre.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-130">The non-fatal problem event occurs.</span></span>
2.  <span data-ttu-id="1a5f5-131">O aplicativo reconhece o evento e usa a sequência de chamadas de função a seguir para gerar o relatório.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-131">The application recognizes the event and uses the following sequence of function calls to generate the report.</span></span>
    1.  <span data-ttu-id="1a5f5-132">Chame a função [**WerReportCreate**](/windows/desktop/api/Werapi/nf-werapi-werreportcreate) para criar o relatório.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-132">Call the [**WerReportCreate**](/windows/desktop/api/Werapi/nf-werapi-werreportcreate) function to create the report.</span></span>
    2.  <span data-ttu-id="1a5f5-133">Chame a função [**WerReportSetParameter**](/windows/desktop/api/Werapi/nf-werapi-werreportsetparameter) para definir os parâmetros do relatório.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-133">Call the [**WerReportSetParameter**](/windows/desktop/api/Werapi/nf-werapi-werreportsetparameter) function to set the report parameters.</span></span>
    3.  <span data-ttu-id="1a5f5-134">Chame a função [**WerReportAddFile**](/windows/desktop/api/Werapi/nf-werapi-werreportaddfile) para adicionar arquivos ao relatório.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-134">Call the [**WerReportAddFile**](/windows/desktop/api/Werapi/nf-werapi-werreportaddfile) function to add files to the report.</span></span>
    4.  <span data-ttu-id="1a5f5-135">Chame a função [**WerReportAddDump**](/windows/desktop/api/Werapi/nf-werapi-werreportadddump) para adicionar um minidespejo ao relatório (se necessário).</span><span class="sxs-lookup"><span data-stu-id="1a5f5-135">Call the [**WerReportAddDump**](/windows/desktop/api/Werapi/nf-werapi-werreportadddump) function to add a minidump to the report (if needed).</span></span>
    5.  <span data-ttu-id="1a5f5-136">Chame a função [**WerReportSubmit**](/windows/desktop/api/Werapi/nf-werapi-werreportsubmit) para enviar o relatório.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-136">Call the [**WerReportSubmit**](/windows/desktop/api/Werapi/nf-werapi-werreportsubmit) function to send the report.</span></span>
    6.  <span data-ttu-id="1a5f5-137">Chame o [**WerReportCloseHandle**](/windows/desktop/api/Werapi/nf-werapi-werreportclosehandle) para liberar recursos.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-137">Call the [**WerReportCloseHandle**](/windows/desktop/api/Werapi/nf-werapi-werreportclosehandle) to free resources.</span></span>
3.  <span data-ttu-id="1a5f5-138">Dependendo das opções específicas usadas ao chamar as funções na etapa 2, o WER concluirá o relatório de erros.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-138">Depending on the specific options used when calling the functions in step 2, WER will finish the error reporting.</span></span> <span data-ttu-id="1a5f5-139">O WER garantirá que o relatório seja feito de acordo com as políticas definidas pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-139">WER will ensure that the reporting is done in accordance with the policies set by the user.</span></span> <span data-ttu-id="1a5f5-140">Por exemplo, o WER enviará o relatório para a Microsoft, colocará o relatório em fila e mostrará as interfaces de usuário apropriadas ao usuário.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-140">For example, WER will send the report to Microsoft, queue the report, and show the appropriate user interfaces to the user.</span></span>

## <a name="excluding-an-application-from-windows-error-reporting"></a><span data-ttu-id="1a5f5-141">Excluindo um aplicativo do Relatório de Erros do Windows</span><span class="sxs-lookup"><span data-stu-id="1a5f5-141">Excluding an application from Windows Error Reporting</span></span>

<span data-ttu-id="1a5f5-142">Para excluir seu aplicativo do relatório de erros do Windows, use a função [**WerAddExcludedApplication**](/windows/desktop/api/Werapi/nf-werapi-weraddexcludedapplication) .</span><span class="sxs-lookup"><span data-stu-id="1a5f5-142">To exclude your application from Windows error reporting, use the [**WerAddExcludedApplication**](/windows/desktop/api/Werapi/nf-werapi-weraddexcludedapplication) function.</span></span> <span data-ttu-id="1a5f5-143">Para restaurar o relatório de erros para seu aplicativo, use a função [**WerRemoveExcludedApplication**](/windows/desktop/api/Werapi/nf-werapi-werremoveexcludedapplication) .</span><span class="sxs-lookup"><span data-stu-id="1a5f5-143">To restore error reporting for your application, use the [**WerRemoveExcludedApplication**](/windows/desktop/api/Werapi/nf-werapi-werremoveexcludedapplication) function.</span></span>

## <a name="automatically-recovering-data-and-restarting-a-faulted-application"></a><span data-ttu-id="1a5f5-144">Recuperando dados automaticamente e reiniciando um aplicativo com falha</span><span class="sxs-lookup"><span data-stu-id="1a5f5-144">Automatically recovering data and restarting a faulted application</span></span>

<span data-ttu-id="1a5f5-145">Um aplicativo pode usar a recuperação e reinicialização do aplicativo para salvar dados e informações de estado antes que o aplicativo seja encerrado devido a uma exceção sem tratamento ou quando o aplicativo para de responder.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-145">An application can use Application Recovery and Restart to save data and state information before the application exits due to an unhandled exception or when the application stops responding.</span></span> <span data-ttu-id="1a5f5-146">O aplicativo também será reiniciado, se solicitado.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-146">The application is also restarted, if requested.</span></span> <span data-ttu-id="1a5f5-147">Para obter detalhes, consulte [recuperação e reinicialização do aplicativo](/windows/desktop/Recovery/application-recovery-and-restart-portal).</span><span class="sxs-lookup"><span data-stu-id="1a5f5-147">For details, see [Application Recovery and Restart](/windows/desktop/Recovery/application-recovery-and-restart-portal).</span></span>

## <a name="legacy-api"></a><span data-ttu-id="1a5f5-148">API herdada</span><span class="sxs-lookup"><span data-stu-id="1a5f5-148">Legacy API</span></span>

<span data-ttu-id="1a5f5-149">Um aplicativo pode relatar uma falha chamando a função [**ReportFault**](/windows/desktop/api/ErrorRep/nf-errorrep-reportfault) .</span><span class="sxs-lookup"><span data-stu-id="1a5f5-149">An application can report a fault by calling the [**ReportFault**](/windows/desktop/api/ErrorRep/nf-errorrep-reportfault) function.</span></span> <span data-ttu-id="1a5f5-150">No entanto, você não deve usar a função **ReportFault** , a menos que tenha um requisito muito específico de que o comportamento do relatório de erros padrão do sistema operacional não possa atender.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-150">However, you should not use the **ReportFault** function unless you have a very specific requirement that the operating system's default error reporting behavior cannot fulfill.</span></span>

<span data-ttu-id="1a5f5-151">Se o relatório de erros estiver habilitado, o sistema exibirá uma caixa de diálogo para o usuário indicando que o aplicativo encontrou um problema e será fechado.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-151">If error reporting is enabled, the system displays a dialog box to the user indicating that the application has encountered a problem and will close.</span></span> <span data-ttu-id="1a5f5-152">Se houver um depurador configurado na chave **HKEY \_ local \_ Machine \\ software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ AeDebug** , o usuário receberá a opção de iniciar o depurador.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-152">If there is a debugger configured in the **HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AeDebug** key, the user is given the option to launch the debugger.</span></span> <span data-ttu-id="1a5f5-153">O usuário também recebe a opção de enviar um relatório à Microsoft.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-153">The user is also given the option to send a report to Microsoft.</span></span> <span data-ttu-id="1a5f5-154">Se o usuário enviar o relatório, o sistema exibirá outra caixa de diálogo, agradecendo ao usuário pelo relatório e fornecendo um link para mais informações.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-154">If the user sends the report, the system displays another dialog box thanking the user for the report and providing a link to more information.</span></span>

<span data-ttu-id="1a5f5-155">O sistema de relatório de erros do dá suporte aos seguintes modos de operação.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-155">The error reporting system supports the following operation modes.</span></span>



| <span data-ttu-id="1a5f5-156">Modo de operação</span><span class="sxs-lookup"><span data-stu-id="1a5f5-156">Operation mode</span></span>          | <span data-ttu-id="1a5f5-157">Descrição</span><span class="sxs-lookup"><span data-stu-id="1a5f5-157">Description</span></span>                                                                                                                                                                                                                                                                                                                                  |
|-------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1a5f5-158">Relatórios de memória compartilhada</span><span class="sxs-lookup"><span data-stu-id="1a5f5-158">Shared memory reporting</span></span> | <span data-ttu-id="1a5f5-159">Se o contexto de segurança do aplicativo for o mesmo que o contexto de segurança do usuário conectado, o sistema de relatórios de erros usará um bloco de memória compartilhada para comunicação.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-159">If the application's security context is the same as the security context of the logged-on user, the error reporting system uses a block of shared memory for communication.</span></span> <span data-ttu-id="1a5f5-160">Este modo não pode ser usado com o modo de relatório do manifesto.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-160">This mode cannot be used with manifest reporting mode.</span></span><br/>                                                                                               |
| <span data-ttu-id="1a5f5-161">Relatório de manifesto</span><span class="sxs-lookup"><span data-stu-id="1a5f5-161">Manifest reporting</span></span>      | <span data-ttu-id="1a5f5-162">Se o contexto de segurança do aplicativo não for o mesmo que o contexto de segurança do usuário conectado, o sistema de relatórios de erros usará um arquivo para comunicação.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-162">If the application's security context is not the same as the security context of the logged-on user, the error reporting system uses a file for communication.</span></span> <span data-ttu-id="1a5f5-163">Esse modo também é usado para relatar aplicativos sem resposta e falhas de kernel.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-163">This mode is also used for reporting unresponsive applications and kernel faults.</span></span> <span data-ttu-id="1a5f5-164">Este modo não pode ser usado com o modo de relatório de memória compartilhada.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-164">This mode cannot be used with shared memory reporting mode.</span></span><br/>                      |
| <span data-ttu-id="1a5f5-165">Relatórios da Internet</span><span class="sxs-lookup"><span data-stu-id="1a5f5-165">Internet reporting</span></span>      | <span data-ttu-id="1a5f5-166">O sistema de relatórios de erros envia todos os dados para a Microsoft pela Internet.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-166">The error reporting system sends all data to Microsoft through the Internet.</span></span> <span data-ttu-id="1a5f5-167">Este é o modo de operação padrão.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-167">This is the default mode of operation.</span></span> <span data-ttu-id="1a5f5-168">Ele não pode ser usado com o modo de relatório corporativo.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-168">It cannot be used with corporate reporting mode.</span></span> <span data-ttu-id="1a5f5-169">Esse modo é usado quando não há nenhum caminho de carregamento corporativo especificado pelo administrador.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-169">This mode is used when there is no corporate upload path specified by the administrator.</span></span><br/>                                                                     |
| <span data-ttu-id="1a5f5-170">Relatórios corporativos</span><span class="sxs-lookup"><span data-stu-id="1a5f5-170">Corporate reporting</span></span>     | <span data-ttu-id="1a5f5-171">O sistema de relatórios de erros envia todos os dados para um compartilhamento de arquivos em vez de carregá-los diretamente para a Microsoft.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-171">The error reporting system sends all data to a file share instead of uploading it directly to Microsoft.</span></span> <span data-ttu-id="1a5f5-172">Isso permite que os gerentes de ti corporativos examinem os dados antes de serem enviados à Microsoft.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-172">This allows corporate IT managers to review data before it is sent to Microsoft.</span></span> <span data-ttu-id="1a5f5-173">Esse modo é usado quando há um caminho de carregamento corporativo especificado pelo administrador.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-173">This mode is used when there is a corporate upload path specified by the administrator.</span></span> <span data-ttu-id="1a5f5-174">Ele não pode ser usado com o modo de relatório da Internet.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-174">It cannot be used with Internet reporting mode.</span></span><br/> |
| <span data-ttu-id="1a5f5-175">Relatórios sem periféricos</span><span class="sxs-lookup"><span data-stu-id="1a5f5-175">Headless reporting</span></span>      | <span data-ttu-id="1a5f5-176">O sistema de relatório de erros não exibirá nenhuma caixa de diálogo para o usuário.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-176">The error reporting system will not display any dialog boxes to the user.</span></span> <span data-ttu-id="1a5f5-177">Isso permite que os gerentes de ti corporativos coletem relatórios de erros de seus funcionários em todos os momentos.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-177">This allows corporate IT managers to collect error reports from their employees at all times.</span></span> <span data-ttu-id="1a5f5-178">Esse modo é usado quando o relatório é habilitado pelo administrador, mas a notificação é desabilitada.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-178">This mode is used when reporting is enabled by the administrator, but notification is disabled.</span></span> <span data-ttu-id="1a5f5-179">Ele pode ser usado somente com o modo de relatório corporativo.</span><span class="sxs-lookup"><span data-stu-id="1a5f5-179">It can be used only with corporate reporting mode.</span></span><br/>        |



 

<span data-ttu-id="1a5f5-180">Para excluir seu aplicativo do relatório de erros, use a função [**AddERExcludedApplication**](/windows/desktop/api/ErrorRep/nf-errorrep-adderexcludedapplicationa) .</span><span class="sxs-lookup"><span data-stu-id="1a5f5-180">To exclude your application from error reporting, use the [**AddERExcludedApplication**](/windows/desktop/api/ErrorRep/nf-errorrep-adderexcludedapplicationa) function.</span></span>

 

