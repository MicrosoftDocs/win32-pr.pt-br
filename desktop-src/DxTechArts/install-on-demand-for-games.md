---
title: Instale-sob demanda para jogos
description: Este artigo técnico aborda duas técnicas, instalação sob demanda e instalação em segundo plano, usando Windows Installer.
ms.assetid: abaaa7bf-8ed8-0425-6845-3671a56fe7fc
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 064dc58c563c372d1320a21040920e492e4e65e4
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "105781008"
---
# <a name="install-on-demand-for-games"></a>Instale-sob demanda para jogos

Este artigo técnico aborda duas técnicas, instalação sob demanda e instalação em segundo plano, usando [Windows Installer](/windows/desktop/Msi/windows-installer-portal). Os jogos podem utilizar essas técnicas de instalação para fornecer uma experiência de jogos melhor e mais agradável para os jogadores, reduzindo o tempo de instalação.

-   [Visão geral](#overview)
-   [Suporte a patches](#patching-support)
-   [O exemplo do SDK do InstallOnDemand](#the-installondemand-sdk-sample)
-   [Os recursos e componentes do exemplo](#the-samples-features-and-components)
-   [Instalação](#installation)
-   [Limitação](#limitation)

## <a name="overview"></a>Visão geral

A instalação tem sido um elemento de aplicativos baseados em computador por muito tempo. A maioria dos aplicativos hoje exige que eles sejam instalados no disco rígido local do usuário antes que possam ser usados. Jogos de computador não são exceção; Quando um consumidor adquire um jogo do Microsoft Windows e tenta executá-lo, ele deve primeiro passar por um processo de instalação que copia os arquivos necessários do disco do jogo para o disco rígido. Esse processo de instalação é geralmente longo e pode levar até uma hora para ser concluído. O tempo de instalação é um fator que torna os jogos de console mais desejáveis do que jogos baseados em computador para alguns jogadores, pois eles podem executar imediatamente um jogo de console depois de inserir o disco do jogo. A tecnologia discutida neste artigo tentará corrigir isso reduzindo drasticamente o tempo de instalação.

Tradicionalmente, os jogos exigem que todos ou a maioria dos arquivos sejam instalados antes de iniciar. Para obter a instalação sob demanda, os recursos do jogo precisam ser modulares; ou seja, o desenvolvedor deve dividir os recursos do aplicativo (gráficos, áudio e assim por diante) em componentes. Cada componente é um conjunto de recursos que podem ser instalados ou removidos como uma unidade. Quando isso for feito, o desenvolvedor do jogo definirá um ou mais recursos, normalmente um ou mais por nível ou zona. Cada recurso de um aplicativo especifica um conjunto de componentes necessários para executar esse recurso específico. Quando um aplicativo é instalado, seus recursos podem ser marcados como "instalar" (componentes copiados para o disco rígido local no momento da instalação) ou "anunciados" (componentes copiados para o disco rígido local após a instalação inicial quando o aplicativo usa esse recurso). Um desenvolvedor de jogos pode reduzir o tempo de instalação projetando o jogo para ser iniciado e executado com um conjunto mínimo de recursos instalados. O restante de seus recursos pode ser marcado como anunciado e instalado sob demanda quando o aplicativo realmente precisa usar funcionalidades que esses recursos fornecem.

Os jogos podem chamar [Windows Installer](/windows/desktop/Msi/windows-installer-portal) para instalar um recurso específico que pode não ter sido instalado. Para fazer a instalação aparecer em segundo plano, um thread de trabalho pode ser usado para fazer as chamadas para o instalador enquanto o thread principal continua a lidar com a lógica do jogo e para renderizar a tela. Isso minimiza a interrupção do jogo causado pela instalação. O jogo pode iniciar a instalação a qualquer momento. No entanto, como a instalação consome ciclos do processador, geralmente não é uma boa ideia executar a instalação quando o thread principal está em necessidade crítica de poder de processamento, como quando o usuário está no meio da ação. Por exemplo, um bom momento para executar a instalação pode ser durante o tempo que o usuário está no menu do jogo, quando o jogo é pausado ou minimizado, ou quando o usuário está assistindo ao filme de introdução ou cutscenes.

## <a name="patching-support"></a>Suporte a patches

Atualmente, a maioria dos jogos precisa ser atualizada mesmo depois que eles são enviados conforme os bugs são corrigidos e novos recursos são adicionados. A atualização geralmente requer aplicação de patch, que é tradicionalmente um procedimento direto para jogos. Como todos os arquivos necessários são instalados no disco rígido do usuário, a aplicação de patches em um jogo envolve copiar arquivos revisados no disco rígido, substituindo os arquivos existentes. Quando a instalação sob demanda é empregada, nem todos os arquivos são instalados e copiados no momento da aplicação de patch. Portanto, o patcher não pode simplesmente gravar arquivos atualizados na pasta do jogo.

[Windows Installer](/windows/desktop/Msi/windows-installer-portal) tem recursos para aplicação de patch de aplicativos que usam a instalação sob demanda. Ao aplicar um patch, o instalador armazena em cache o patch no sistema. Esse recurso funciona bem para patches com deltas pequenos. Os arquivos liberados originalmente não precisam mais estar no disco no momento da aplicação de patch, portanto, esses arquivos podem ser anunciados. Posteriormente, quando o aplicativo for executado e precisar acessar os arquivos, o instalador instalará a versão mais recente desses arquivos copiando a versão originalmente liberada da mídia (por exemplo, CDs) e aplicando o patch depois de ler os dados de patch salvos.

## <a name="the-installondemand-sdk-sample"></a>O exemplo do SDK do InstallOnDemand

O exemplo de instalação sob demanda para jogos demonstra as técnicas de instalação sob demanda abordadas neste artigo. Ao contrário de outros exemplos, a instalação sob demanda para jogos não pode ser executada diretamente do navegador de exemplo. Como o exemplo usa o [Windows Installer](/windows/desktop/Msi/windows-installer-portal) para gerenciar sua instalação, ele precisa ser incluído no banco de dados do instalador de aplicativos instalados.

**Para iniciar o exemplo**

1.  Use o link instalar projeto no navegador de exemplo para copiar os arquivos de exemplo para uma pasta.
2.  Clique duas vezes em InstallOnDemand.msi para instalar o exemplo.
3.  Selecione instalação típica.
4.  Inicie o exemplo iniciando o InstallOnDemand.exe na pasta instalada (normalmente arquivos de programas \\ InstallOnDemand) ou iniciando nos programas do menu iniciar \\ .

InstallOnDemand.msi é um banco de dados reconhecido pelo instalador. Ele define todo o processo de instalação: a estrutura de diretório, o que será e não será copiado, quais recursos serão copiados juntos, quais valores de registro gravar, quais atalhos criar e assim por diante.

Quando iniciado, o exemplo reproduz uma sequência de introdução. O jogador pode encerrar e inserir o menu principal pressionando a tecla ESC. Após a introdução, o jogador pode iniciar um novo jogo inserindo um nome de caractere e rolando as estatísticas. Antes que o exemplo comece a reproduzir a sequência de introdução, o exemplo chama uma função de instalador para verificar se o recurso do nível 1 está instalado. Se o recurso nível 1 não tiver sido instalado, o exemplo usará um thread em segundo plano para solicitar que o instalador instale o jogo, enquanto o thread principal está fazendo algo mais (como reproduzir a sequência de introdução, renderizar o menu ou interagir com o Player na criação de caracteres). A experiência é diferente da instalação tradicional do jogo, pois o usuário está ocupado no jogo (observando a introdução ou criando um novo caractere) enquanto a instalação está em andamento. Depois que o jogador terminar de criar um caractere, o exemplo carregará os recursos para o nível 1.

No lado direito da tela de exemplo estão cinco botões marcados como "reproduzir nível 1" por meio de "reproduzir nível 5". Esses botões simulam a conclusão do Player do nível atual e o avanço para o próximo. Quando um desses botões é clicado, uma tela de estatísticas é exibida mostrando informações sobre o nível que acabou de terminar. O exemplo também leva esse tempo para solicitar que o instalador Verifique e instale o próximo nível, se ele ainda não estiver instalado. A instalação ocorre enquanto o player está lendo a tela estatísticas, de modo que, quando o usuário clicar em OK para inserir o próximo nível, os recursos do nível serão todos instalados e prontos para serem carregados.

## <a name="the-samples-features-and-components"></a>Os recursos e componentes do exemplo

Tradicionalmente, os jogos exigem que todos ou a maioria dos arquivos sejam instalados antes de iniciar. Para obter a instalação sob demanda, os recursos do jogo precisam ser modulares; ou seja, o desenvolvedor deve dividir os recursos do aplicativo (gráficos, áudio e assim por diante) em componentes. Cada componente é um conjunto de recursos que podem ser instalados ou removidos como uma unidade. Quando isso for feito, o desenvolvedor do jogo definirá um ou mais recursos, normalmente um ou mais por nível ou zona. Cada recurso de um aplicativo especifica um conjunto de componentes necessários para executar esse recurso específico. Quando um aplicativo é instalado, seus recursos podem ser marcados como "instalar" (componentes copiados para o disco rígido local no momento da instalação) ou "anunciados" (componentes copiados para o disco rígido local quando o aplicativo usa posteriormente esse recurso). Um desenvolvedor de jogos pode reduzir o tempo de instalação projetando o jogo para iniciar e começar a execução com um conjunto mínimo de recursos instalados. O restante de seus recursos pode ser marcado como anunciado e instalado sob demanda quando o aplicativo realmente precisa usar funcionalidades que esses recursos fornecem.

A tabela a seguir lista os seis recursos de nível superior que o exemplo define.



| Nome do recurso | Funcionalidade                                                                                                                                                                                                             | Componentes  | Arquivos                                                                     |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|---------------------------------------------------------------------------|
| Core         | Inclui recursos sempre necessários, independentemente do nível. Esses recursos são: executável de exemplo, mídia exigida pela sequência de introdução e pela tela de carregamento e arquivo. FX que manipula toda a renderização no exemplo. | Core        | InstallOnDemand.exe, InstallOnDemand. FX, Loading.bmp, Level. x             |
| Core         | (o mesmo que acima)                                                                                                                                                                                                           | CoreUI      | \\Interface do usuário \\ de mídia dxutcontrols. DDS, Media \\ UI \\ DXUTShared. FX, Media \\ UI \\ Arrow. x |
| Core         | (o mesmo que acima)                                                                                                                                                                                                           | CoreMisc    | Media \\ misc \\ . x multisoloseafloor.bmp de \\ \\ mídia                        |
| Core         | (o mesmo que acima)                                                                                                                                                                                                           | CoreSpeeder | \\Demonstração de PRT \\ de mídia LandShark. x, \\ acelerador de demonstração de prt de mídia \\ \_diff.jpg          |
| Core         | (o mesmo que acima)                                                                                                                                                                                                           | CoreReg     | N/A (valor do registro)                                                      |
| Level1       | Fornece recursos usados pelo nível 1.                                                                                                                                                                                       | Level1      | Level1.jpg                                                                |
| Level1       | (o mesmo que o anterior)                                                                                                                                                                                                        | L1Skybox    | Investigação de luz de mídia \\ \\ Galileo \_ Cross. DDS                                   |
| Level2       | Fornece recursos usados pelo nível 2.                                                                                                                                                                                       | Level2      | Level2.jpg                                                                |
| Level2       | (o mesmo que o anterior)                                                                                                                                                                                                        | L2Skybox    | Cortesia de investigações de luz de mídia \\ \\ \_ cruzada. DDS                                     |
| Level3       | Fornece recursos usados pelo nível 3.                                                                                                                                                                                       | Level3      | Level3.jpg                                                                |
| Level3       | (o mesmo que o anterior)                                                                                                                                                                                                        | L3Skybox    | Investigação de luz de mídia \\ \\ RNL \_ Cross. DDS                                       |
| Nível4       | Fornece recursos usados pelo nível 4.                                                                                                                                                                                       | Nível4      | Level4.jpg                                                                |
| Nível4       | (o mesmo que o anterior)                                                                                                                                                                                                        | L4Skybox    | Investigações de luz de mídia \\ \\ entre os superpeters \_ . DDS                                  |
| Level5       | Fornece recursos usados pelo nível 5.                                                                                                                                                                                       | Level5      | Level5.jpg                                                                |
| Level5       | (o mesmo que o anterior)                                                                                                                                                                                                        | L5Skybox    | Investigação de luz de mídia \\ \\ Uffizi \_ Cross. DDS                                    |



 

Os recursos do Level1 por meio do Level5 têm sub-recursos adicionais que contêm arquivos que não são usados diretamente pelo exemplo. Esses arquivos de sub-recursos foram adicionados para fazer com que a instalação demore mais. Isso é feito para ilustrar a operação de instalação em andamento que está sendo executada em segundo plano enquanto o exemplo está em execução.

A tabela a seguir lista os sub-recursos.



| Recurso | Sub-recursos                      | Arquivos                                                                                                                                                                          |
|---------|-----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Level1  | L1PH1, L1PH2, L1PH3, L1PH4, L1PH5 | Level1 PlaceHolder data \\ L1PH1. dat Level1 dados de espaço reservado \\ L1PH2. dat Level1 espaço reservado L1PH3 \\ . dat Level1 espaço reservado dados \\ L1PH4. dat Level1 espaço reservado dados \\ L1PH5. dat |
| Level2  | L2PH1, L2PH2, L2PH3, L2PH4, L2PH5 | Level2 PlaceHolder data \\ L2PH1. dat Level2 dados de espaço reservado \\ L2PH2. dat Level2 espaço reservado L2PH3 \\ . dat Level2 espaço reservado dados \\ L2PH4. dat Level2 espaço reservado dados \\ L2PH5. dat |
| Level3  | L3PH1, L3PH2, L3PH3, L3PH4, L3PH5 | Level3 PlaceHolder data \\ L3PH1. dat Level3 dados de espaço reservado \\ L3PH2. dat Level3 espaço reservado L3PH3 \\ . dat Level3 espaço reservado dados \\ L3PH4. dat Level3 espaço reservado dados \\ L3PH5. dat |
| Nível4  | L4PH1, L4PH2, L4PH3, L4PH4, L4PH5 | Level4 PlaceHolder data \\ L4PH1. dat Level4 dados de espaço reservado \\ L4PH2. dat Level4 espaço reservado L4PH3 \\ . dat Level4 espaço reservado dados \\ L4PH4. dat Level4 espaço reservado dados \\ L4PH5. dat |
| Level5  | L5PH1, L5PH2, L5PH3, L5PH4, L5PH5 | Level5 PlaceHolder data \\ L5PH1. dat Level5 dados de espaço reservado \\ L5PH2. dat Level5 espaço reservado L5PH3 \\ . dat Level5 espaço reservado dados \\ L5PH4. dat Level5 espaço reservado dados \\ L5PH5. dat |



 

Durante a instalação, o recurso principal deve ser marcado como "instalar" e todos os outros recursos devem ser marcados como "anunciados". Ao instalar apenas um recurso em vez de seis, o tempo que o Player deve aguardar até que o jogo seja reiniciado é significativamente reduzido.

## <a name="installation"></a>Instalação

O [Windows Installer](/windows/desktop/Msi/windows-installer-portal) fornece um mecanismo para um aplicativo solicitar que um recurso anunciado seja instalado. No entanto, o mecanismo é uma chamada de API (interface de programação de aplicativo) síncrona, o que significa que o aplicativo precisa aguardar dentro da chamada até que a instalação seja concluída. Para obter a instalação em segundo plano, um thread de trabalho é necessário para que o thread do aplicativo principal seja gratuito para executar outras tarefas importantes, como a renderização na tela para continuar fornecendo os comentários visuais do jogador.

No exemplo, há três Estados de instalação que ocorrem durante a execução de exemplo: instalação ativa, instalação passiva e sem instalação.

-   A instalação ativa é uma solicitação iniciada pelo exemplo quando precisa acessar ou carregar recursos fornecidos por um ou mais recursos. O exemplo faz isso quando não pode continuar até que o recurso seja instalado.
-   A instalação passiva é iniciada quando o exemplo não está executando uma tarefa crítica, como quando o jogador está em um menu ou assistindo a uma cena de recorte. Quando esse for o caso, o thread de trabalho verificará se algum recurso do exemplo ainda está anunciado. Se ele puder encontrar um, ele chamará o instalador para instalar esse recurso. Esse processo se repete até que todos os recursos do exemplo sejam instalados. Essencialmente, a instalação passiva utiliza ciclos de processador extras para executar a instalação em segundo plano quando é menos invasiva para o exemplo principal.
-   Nenhuma instalação acontece quando o jogador está ativamente envolvido no jogo; Isso impede que um descarte de taxa de quadros interrompa a experiência do usuário.

No exemplo, uma classe CMsiUtil é definida para lidar com todas as tarefas relacionadas à instalação. Essencialmente, o CMsiUtil usa um thread de trabalho que invoca o instalador para instalar os recursos do exemplo em um loop. A classe tem duas filas que armazenam solicitações de instalação: uma fila de alta prioridade para instalação ativa e uma fila de baixa prioridade para instalação passiva. Durante a inicialização, a classe enumera todos os recursos do produto e os adiciona à fila de instalação passiva. Como o produto inteiro é colocado na fila dessa forma, todo o produto será instalado eventualmente se o exemplo tiver ciclos de processador livres suficientes.

Quando o exemplo precisa solicitar uma instalação ativa, o exemplo pode chamar CMsiUtil:: UseFeatureSet () e passar o nome do recurso de nível superior. UseFeatureSet () colocará em fila o recurso solicitado e todos os seus sub-recursos na fila de instalação ativa para que o thread de trabalho possa instalá-los.

Durante a execução de uma solicitação de instalação, o thread de trabalho verificará a fila de instalação ativa, bem como a fila de instalação passiva, para ver se a fila tem alguma solicitação adicional. Cada vez que o thread encontra uma solicitação, ele chamará a API do instalador para executar a instalação real. Depois que ambas as filas estiverem vazias, o thread de trabalho entrará em suspensão com uma chamada para [**WaitForSingleObject**](/windows/desktop/api/synchapi/nf-synchapi-waitforsingleobject). Como o produto inteiro é colocado na fila de instalação passiva durante a inicialização, uma fila vazia implica que todo o produto foi instalado.

O exemplo chama CMsiUtil:: EnablePassiveInstall () para habilitar ou desabilitar a instalação passiva. EnablePassiveInstall (true) incrementa a contagem de habilitação para instalação passiva e EnablePassiveInstall (false) diminui. Se a contagem de habilitação for maior que 0, a classe processará a fila de instalação passiva. O exemplo permite a instalação passiva quando qualquer uma das seguintes opções for verdadeira:

-   O usuário está exibindo a sequência de introdução inicial.
-   O usuário está navegando no menu de exemplo.
-   O usuário está exibindo as estatísticas no final de um nível.
-   O aplicativo de exemplo perde seu foco e vai para o plano de fundo.

Os métodos de CMsiUtil estão listados abaixo:



| Método                | Descrição                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| AbortAllRequests      | Faz com que a instalação atual anule e esvazia a fila de solicitações de instalação ativa.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| AbortCurrentRequest   | Faz com que a instalação em andamento seja anulada. O thread de trabalho processa a próxima solicitação na fila, se existir uma.                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| EnablePassiveInstall  | Incrementa ou decrementa a contagem de habilitação da instalação passiva. O exemplo usa essa chamada para controlar quando a instalação passiva pode e não pode acontecer.                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| GetCurrentFeatureName | Retorna o nome do recurso que está sendo instalado ativamente.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| GetFeatureProgress    | Retorna a posição da escala atual para o recurso que está sendo instalado.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| GetFeatureProgressMax | Retorna o número máximo de tiques de progresso para o recurso que está sendo instalado.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Obter Último Erro          | Use este método para recuperar o código de retorno da solicitação de instalação anterior.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| GetPassiveProgress    | Retorna a posição de tique da barra de progresso para instalação passiva.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| GetPassiveProgressMax | Retorna a posição de tique atual e o número máximo de tiques para instalação passiva. Juntos, o exemplo pode usá-los para mostrar o progresso geral da instalação passiva.                                                                                                                                                                                                                                                                                                                                                                                               |
| GetProgress           | Retorna a posição de tique da barra de progresso para a instalação do conjunto de recursos ativo. Isso é usado quando o exemplo renderiza a barra de progresso da instalação. Como o Windows Installer só fornece informações de progresso para o recurso que está sendo instalado, o método divide a barra de progresso entre os recursos solicitados para que o usuário ainda Veja toda a instalação como uma tarefa.                                                                                                                                                                                           |
| GetProgressMax        | Retorna a contagem máxima de tiques da barra de progresso para a instalação ativa do conjunto de recursos. Isso é usado quando o exemplo renderiza a barra de progresso da instalação.                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Inicializar            | Inicializa a classe com o GUID (identificador global exclusivo) do produto. Esse método também enumera todos os recursos do aplicativo que foi anunciado, mas ainda não instalado, e os coloca na fila de instalação passiva para configurar a instalação passiva.                                                                                                                                                                                                                                                                                                           |
| IsInstallInProgress   | Use este método para descobrir se uma instalação ativa está sendo processada.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| UseFeature            | Método particular chamado por UseFeatureSet. Verifica se um recurso está instalado. Se o recurso solicitado for instalado, o método retornará. Se o recurso ainda não estiver instalado (anunciado), o método enfileirará uma nova solicitação de instalação ativa para o thread de trabalho e, em seguida, retornará. O identificador de evento opcional que será sinalizado quando a instalação solicitada for concluída.                                                                                                                                                                                                        |
| UseFeatureSet         | Chamado pelo exemplo quando ele precisa acessar as funcionalidades fornecidas por um determinado recurso ou qualquer um de seus sub-recursos. O método enumera todos os recursos do exemplo e chama UseFeature () para os sub-recursos do recurso raiz especificado. O exemplo pode passar um identificador de evento que será sinalizado quando todo o conjunto de recursos for instalado. Como os recursos são todos instalados como um conjunto, o identificador é especificado para o último recurso enfileirado por UseFeature () em vez de todos os recursos, para que o exemplo seja notificado uma vez após a instalação de todos os recursos solicitados. |
| UseProduct            | Enfileira uma solicitação de instalação ativa para o thread de trabalho chamar o instalador para executar uma instalação completa do produto. O identificador de evento opcional que será sinalizado quando a instalação solicitada for concluída.                                                                                                                                                                                                                                                                                                                                                                |



 

## <a name="limitation"></a>Limitação

A versão atual do instalador não foi projetada para acesso simultâneo por vários threads. Portanto, quando o thread de trabalho está chamando o instalador, o thread principal não deve chamar o instalador. Um exemplo dessa limitação ocorre no exemplo quando o thread principal solicita um recurso e, em seguida, solicita o mesmo recurso novamente antes que o thread de trabalho conclua a instalação. A segunda solicitação chama MsiQueryFeatureState () para descobrir se o recurso solicitado já está instalado, pois o instalador pode, às vezes, indicar que o recurso foi completamente instalado quando o thread de trabalho ainda está copiando os arquivos.

Felizmente, há uma solução fácil para isso. CMsiUtil verificará se um recurso está sendo instalado pelo thread de trabalho antes de chamar funções como MsiQueryFeatureState () ou MsiUseFeature () para solicitar o estado de instalação do recurso em questão. Lembre-se de que essa limitação também pode se tornar um problema em outro lugar.

A aplicação de patches pode afetar o funcionamento da instalação sob demanda no computador de um usuário final. Aplicar um patch que contém apenas dados que foram alterados da versão anterior pode exigir que a versão anterior do arquivo atualizado seja instalada para aplicar o Delta. Nessa situação, o patch deve solicitar que o instalador instale os recursos anunciados afetados antes de aplicar o patch ao jogo.

O exemplo é instalado inicializando InstallOnDemand.msi porque supõe que o [Windows Installer](/windows/desktop/Msi/windows-installer-portal) está presente no computador. Se o instalador estiver ausente, os arquivos. msi não serão reconhecidos e as inicializações não funcionarão. Para superar esse problema, um aplicativo deve usar um programa de instalação para executar a tarefa. Esse programa deve primeiro verificar se o instalador está presente e, em caso afirmativo, sua versão. Se a versão não atender ao requisito do aplicativo, o programa de instalação deverá instalar o Windows Installer e, em seguida, iniciar o arquivo. msi. Esse processo é conhecido como inicialização. Os aplicativos normalmente nomeam seu programa de instalação de inicialização Setup.exe. O exemplo não trata de inicialização. No entanto, detalhes completos sobre a inicialização podem ser encontrados no Windows Installer.

Os desenvolvedores também devem prestar atenção ao tamanho de cada recurso em seus jogos. Ao cancelar uma instalação em andamento, o instalador restaura o computador para o estado anterior à instalação. Isso significa que a instalação do recurso é completamente desfeita e não há nenhuma instalação de recurso parcial. Um recurso grande requer mais tempo para instalar, o que aumenta a probabilidade de que a instalação seja interrompida e cancelada ou a instalação irá interferir no aplicativo principal. Um exemplo seria habilitar a instalação passiva quando o usuário abrir o menu do jogo no meio do jogo jogar. Se um recurso estiver sendo instalado e o usuário voltar para a execução, o jogo poderá executar uma das duas ações: ele poderá permitir que a instalação passiva seja concluída ou pode cancelar a instalação passiva. Um recurso grande se ajustaria de forma ruim com qualquer um dos modelos. Se o jogo permitir que a instalação grande seja concluída, a instalação poderá atrapalhar o desempenho de renderização do jogo por um longo tempo. Por outro lado, se o jogo cancelar a instalação, o usuário deverá permanecer no menu por um longo tempo antes de retornar ao jogo. Os desenvolvedores devem encontrar um tamanho de recurso equilibrado que funcione melhor para seus jogos individuais.

 

 