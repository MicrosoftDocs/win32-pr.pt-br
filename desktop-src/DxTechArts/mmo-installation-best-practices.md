---
title: Práticas recomendadas de instalação para jogos online com vários participantes
description: Este artigo descreve a criação de uma cadeia de design de confiança para instalação de cliente de jogos online de vários participantes (MMOG) e sistemas de atualização de jogos personalizados que funcionam bem com o Windows e o modelo de segurança do Windows Vista e do Windows 7.
ms.assetid: b719cff7-97e8-5e0a-9c91-3bd8178da7c8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e81003a434b830f046c29d606355104fe618d1f5
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104007782"
---
# <a name="installation-best-practices-for-massively-multiplayer-online-games"></a><span data-ttu-id="def83-103">Práticas recomendadas de instalação para jogos online com vários participantes</span><span class="sxs-lookup"><span data-stu-id="def83-103">Installation Best Practices for Massively Multiplayer Online Games</span></span>

<span data-ttu-id="def83-104">Este artigo descreve a criação de uma cadeia de design de confiança para instalação de cliente de jogos online de vários participantes (MMOG) e sistemas de atualização de jogos personalizados que funcionam bem com o Windows e o modelo de segurança do Windows Vista e do Windows 7.</span><span class="sxs-lookup"><span data-stu-id="def83-104">This article describes creating a chain of trust design for Massively Multiplayer Online Games (MMOG) client installation and custom game update systems that work well with Windows and the security model of Windows Vista and Windows 7.</span></span> <span data-ttu-id="def83-105">A abordagem foi projetada para habilitar a aplicação de patches em títulos de MMOG enquanto dá suporte a contas de usuário padrão, que têm acesso restrito ao registro do sistema e do disco rígido.</span><span class="sxs-lookup"><span data-stu-id="def83-105">The approach is designed to enable patching of MMOG titles while supporting standard user accounts, which have restricted access to the hard drive and system registry.</span></span>

-   [<span data-ttu-id="def83-106">Por que os clientes do MMOG têm requisitos diferentes para jogos tradicionais de varejo adquiridos</span><span class="sxs-lookup"><span data-stu-id="def83-106">Why MMOG Clients Have Different Requirements to Traditional Retail Purchased Games</span></span>](#why-mmog-clients-have-different-requirements-to-traditional-retail-purchased-games)
-   [<span data-ttu-id="def83-107">Visão geral de uma abordagem de cadeia de confiança</span><span class="sxs-lookup"><span data-stu-id="def83-107">Overview of a Chain of Trust Approach</span></span>](#overview-of-a-chain-of-trust-approach)
-   [<span data-ttu-id="def83-108">Tudo é validado no servidor, por que devo me preocupar se meu cliente é invadido?</span><span class="sxs-lookup"><span data-stu-id="def83-108">Everything is validated on the server, why should I worry if my client gets hacked?</span></span>](#everything-is-validated-on-the-server-why-should-i-worry-if-my-client-gets-hacked)
-   [<span data-ttu-id="def83-109">Construção do aplicativo de carregador de Trust-Worthy</span><span class="sxs-lookup"><span data-stu-id="def83-109">Construction of the Trust-Worthy Loader Application</span></span>](#construction-of-the-trust-worthy-loader-application)
    -   [<span data-ttu-id="def83-110">Leitura em segundo plano</span><span class="sxs-lookup"><span data-stu-id="def83-110">Background Reading</span></span>](#background-reading)
    -   [<span data-ttu-id="def83-111">Instalação do carregador confiável e Patcher</span><span class="sxs-lookup"><span data-stu-id="def83-111">Installation of the Trusted Loader and Patcher</span></span>](#installation-of-the-trusted-loader-and-patcher)
    -   [<span data-ttu-id="def83-112">Instalação dos executáveis, DLLs e dados do jogo</span><span class="sxs-lookup"><span data-stu-id="def83-112">Installation of the Game Executables, DLLs, and Data</span></span>](#installation-of-the-game-executables-dlls-and-data)
    -   [<span data-ttu-id="def83-113">Código de modificação da lista de controle de acesso</span><span class="sxs-lookup"><span data-stu-id="def83-113">Access Control List Modification Code</span></span>](#access-control-list-modification-code)
    -   [<span data-ttu-id="def83-114">Instalações para usuários avançados</span><span class="sxs-lookup"><span data-stu-id="def83-114">Installations for Advanced Users</span></span>](#installations-for-advanced-users)
    -   [<span data-ttu-id="def83-115">A verificação de confiança do carregador</span><span class="sxs-lookup"><span data-stu-id="def83-115">The Loader's Verification of Trust</span></span>](#the-loaders-verification-of-trust)
    -   [<span data-ttu-id="def83-116">Validação de dados</span><span class="sxs-lookup"><span data-stu-id="def83-116">Data Validation</span></span>](#data-validation)

## <a name="why-mmog-clients-have-different-requirements-to-traditional-retail-purchased-games"></a><span data-ttu-id="def83-117">Por que os clientes do MMOG têm requisitos diferentes para jogos tradicionais de varejo adquiridos</span><span class="sxs-lookup"><span data-stu-id="def83-117">Why MMOG Clients Have Different Requirements to Traditional Retail Purchased Games</span></span>

<span data-ttu-id="def83-118">A natureza constantemente conectada e em constante evolução do MMOGs torna um requisito fundamental para fornecer atualizações regulares do código do cliente e do conteúdo para corrigir vulnerabilidades de segurança e estender a experiência de jogos.</span><span class="sxs-lookup"><span data-stu-id="def83-118">The constantly connected and evolving nature of MMOGs makes it a fundamental requirement to provide regular updates of client code and content to fix security vulnerabilities and extend the gameplay experience.</span></span> <span data-ttu-id="def83-119">Com o potencial para atualizações quase diárias, o cenário de MMOG requer um gerenciamento cuidadoso para garantir uma experiência amigável do usuário.</span><span class="sxs-lookup"><span data-stu-id="def83-119">With the potential for almost daily updates, the MMOG scenario requires careful management to ensure a user friendly experience.</span></span> <span data-ttu-id="def83-120">Isso difere do modelo de compra de varejo tradicional, em que um pequeno número de patches pode ser fornecido próximo à data de envio de varejo do produto.</span><span class="sxs-lookup"><span data-stu-id="def83-120">This differs from the traditional retail purchase model where a small number of patches may be provided close to the retail ship date of the product.</span></span> <span data-ttu-id="def83-121">A Windows Installer tecnologia limitada de aplicação de patches do usuário fornecida com o sistema operacional foi projetada para lidar com pequenas quantidades de patches de aplicativos, e não a grande quantidade e alta frequência necessária para MMOGs.</span><span class="sxs-lookup"><span data-stu-id="def83-121">The Windows Installer limited user patching technology provided with the operating system is designed to handle small numbers of application patches, and not the large quantity and high frequency needed by MMOGs.</span></span> <span data-ttu-id="def83-122">Portanto, geralmente é necessário que os sistemas de aplicação de patches personalizados sejam desenvolvidos para atender às necessidades do MMOGs, incluindo quaisquer requisitos especiais específicos para o MMOG específico que está sendo desenvolvido.</span><span class="sxs-lookup"><span data-stu-id="def83-122">It is therefore often necessary for custom patching systems to be developed to address the needs of MMOGs, including any special requirements specific to the particular MMOG being developed.</span></span>

<span data-ttu-id="def83-123">Como muitos computadores estão conectados à Internet, o Windows Vista e o Windows 7 têm restrições de segurança e proteções mais difíceis para os usuários, que limitam o acesso que os aplicativos têm a várias áreas do disco rígido.</span><span class="sxs-lookup"><span data-stu-id="def83-123">Because so many computers are connected to the Internet, Windows Vista and Windows 7 have tougher security restrictions and safeguards for users, which limit the access that applications have to various areas of the hard drive.</span></span> <span data-ttu-id="def83-124">Ao contrário do Windows XP, essas restrições são habilitadas para o modo padrão para contas de usuário.</span><span class="sxs-lookup"><span data-stu-id="def83-124">Unlike Windows XP, these restrictions are enabled for the default mode for user accounts.</span></span> <span data-ttu-id="def83-125">Essas restrições devem ser levadas em conta ao criar o layout de um jogo, de um executável e de dados e de seu sistema de aplicação de patches associado.</span><span class="sxs-lookup"><span data-stu-id="def83-125">These restrictions must be taken into account when designing the layout of a game, executable and data, and its associated patching system.</span></span> <span data-ttu-id="def83-126">Para obter mais detalhes sobre as medidas de segurança fornecidas pelo sistema operacional, consulte [controle de conta de usuário para desenvolvedores de jogos](/windows/desktop/DxTechArts/user-account-control-for-game-developers).</span><span class="sxs-lookup"><span data-stu-id="def83-126">For more details about the security measures provided by the operating system, see [User Account Control for Game Developers](/windows/desktop/DxTechArts/user-account-control-for-game-developers).</span></span>

## <a name="overview-of-a-chain-of-trust-approach"></a><span data-ttu-id="def83-127">Visão geral de uma abordagem de cadeia de confiança</span><span class="sxs-lookup"><span data-stu-id="def83-127">Overview of a Chain of Trust Approach</span></span>

<span data-ttu-id="def83-128">A abordagem de atualização personalizada apresentada neste white paper baseia-se em ter um aplicativo de carregador confiável instalado na pasta arquivos de programas protegidos, mantendo os arquivos executáveis e os dados de jogos em uma área compartilhada de todos os usuários.</span><span class="sxs-lookup"><span data-stu-id="def83-128">The custom update approach presented in this whitepaper is based upon having a trustworthy loader application installed to the protected Program Files folder while keeping the games executable files and data in a shared all-user-accessible area.</span></span> <span data-ttu-id="def83-129">Uma cadeia de confiança começa com o carregador que executa verificações de validade nos dados e binários do jogo antes do lançamento.</span><span class="sxs-lookup"><span data-stu-id="def83-129">A chain of trust starts with the loader which performs validity checks on the game binaries and data before launch.</span></span>

![a cadeia de confiança começa com um carregador confiável](images/mmo-installation-best-practices-01.gif)

<span data-ttu-id="def83-131">O carregador confiável precisa ter lógica suficiente para poder verificar se o executável do jogo e outros binários não foram adulterados antes de iniciar o jogo.</span><span class="sxs-lookup"><span data-stu-id="def83-131">The trustworthy loader needs to have enough logic to be able to verify that the game's executable and other binaries have not been tampered with before launching the game.</span></span> <span data-ttu-id="def83-132">O carregador também pode verificar os dados do jogo sempre que necessário. no entanto, o tamanho dos dados do jogo geralmente é muito grande para permitir que ele seja verificado todas as vezes em uma única passagem.</span><span class="sxs-lookup"><span data-stu-id="def83-132">The loader may also verify game data as often as needed, however, the size of game data is usually too large to allow it be checked every time in a single pass.</span></span> <span data-ttu-id="def83-133">Uma abordagem alternativa é usar um padrão de amostragem que garanta que a verificação de todo o conjunto de dados ocorra durante um longo período de tempo.</span><span class="sxs-lookup"><span data-stu-id="def83-133">An alternative approach is to use a sampling pattern which ensures that verification of the entire data set occurs over an extended period of time.</span></span> <span data-ttu-id="def83-134">O aplicativo de carregador pode conter um mecanismo de aplicação de patches de jogos, que fornece um método digno de confiança pelo para integrar atualizações com o jogo instalado.</span><span class="sxs-lookup"><span data-stu-id="def83-134">The loader application may contain a game patching engine, which provides a trust worthy method by to integrate updates with the installed game.</span></span>

## <a name="everything-is-validated-on-the-server-why-should-i-worry-if-my-client-gets-hacked"></a><span data-ttu-id="def83-135">Tudo é validado no servidor, por que devo me preocupar se meu cliente é invadido?</span><span class="sxs-lookup"><span data-stu-id="def83-135">Everything is validated on the server, why should I worry if my client gets hacked?</span></span>

<span data-ttu-id="def83-136">É impossível confiar que o cliente não foi comprometido; Portanto, é comum que servidores MMOG validem todos os dados recebidos do cliente.</span><span class="sxs-lookup"><span data-stu-id="def83-136">It is impossible to trust that the client has not been compromised; therefore it is common for MMOG servers to validate all data received from the client.</span></span> <span data-ttu-id="def83-137">Embora esse processamento possa identificar clientes de jogos comprometidos ou trapaceandodos no universo do jogo, o servidor não pode identificar facilmente todos os problemas aos quais o cliente do jogo pode ser exposto.</span><span class="sxs-lookup"><span data-stu-id="def83-137">While this processing can identify compromised or cheating game clients within the game universe, the server cannot easily identify all issues the game client can be exposed to.</span></span> <span data-ttu-id="def83-138">É importante reforçar a proteção contra hackers que desejam usar seu cliente como uma plataforma para ataques em seu serviço, outros usuários ou até mesmo como um vetor para atacar os próprios computadores cliente.</span><span class="sxs-lookup"><span data-stu-id="def83-138">It's important to strengthen protection from hackers who wish to use your client as a platform for attacks on your service, other users, or even simply as a vector for attacking the client machines themselves.</span></span> <span data-ttu-id="def83-139">A aplicação de assinaturas de código e técnicas de verificação de dados pode ajudar a detectar clientes comprometidos antes que eles sejam executados.</span><span class="sxs-lookup"><span data-stu-id="def83-139">The application of code signing and data verification techniques can help detect compromised clients before they get executed.</span></span> <span data-ttu-id="def83-140">Como o mecanismo de aplicação de patches requer a exposição de binários executáveis e DLL que não são protegidos pelas permissões somente leitura padrão em arquivos de programas, a validação desses arquivos antes de iniciá-los é importante para a segurança geral do sistema.</span><span class="sxs-lookup"><span data-stu-id="def83-140">Since the patching mechanism requires exposing executable and DLL binaries that are not protected by the standard read-only permissions on Program Files, validating these files before launching them is important for overall system security.</span></span>

<span data-ttu-id="def83-141">Esse modelo não tenta lidar com o cenário do usuário administrador mal-intencionado em que o próprio carregador pode se tornar comprometido, mas se concentra em proteger usuários padrão contra acidentalmente execução de código adulterado.</span><span class="sxs-lookup"><span data-stu-id="def83-141">This model does not attempt to deal with the malicious admin user scenario where the loader itself could become compromised but focuses on protecting standard users from accidentally running tampered code.</span></span> <span data-ttu-id="def83-142">As técnicas tradicionais de validação de servidor-cliente são, na verdade, a única mitigação possível para administradores de sistema cliente mal-intencionados.</span><span class="sxs-lookup"><span data-stu-id="def83-142">Traditional server-client validation techniques are really the only possible mitigation for malicious client system administrators.</span></span>

## <a name="construction-of-the-trust-worthy-loader-application"></a><span data-ttu-id="def83-143">Construção do aplicativo de carregador de Trust-Worthy</span><span class="sxs-lookup"><span data-stu-id="def83-143">Construction of the Trust-Worthy Loader Application</span></span>

### <a name="background-reading"></a><span data-ttu-id="def83-144">Leitura em segundo plano</span><span class="sxs-lookup"><span data-stu-id="def83-144">Background Reading</span></span>

<span data-ttu-id="def83-145">Os leitores devem se familiarizar com a documentação a seguir, que fornece detalhes da tecnologia base para garantir a prática recomendada para a confiança baseada em software.</span><span class="sxs-lookup"><span data-stu-id="def83-145">Readers should familiarize themselves with the following documentation, which provides details of the foundation technology for ensuring best practice for software based trust.</span></span>

<dl> <dt>

<span data-ttu-id="def83-146"><span id="Code_Signing"></span><span id="code_signing"></span><span id="CODE_SIGNING"></span>Assinatura de código</span><span class="sxs-lookup"><span data-stu-id="def83-146"><span id="Code_Signing"></span><span id="code_signing"></span><span id="CODE_SIGNING"></span>Code Signing</span></span>
</dt> <dd>

[<span data-ttu-id="def83-147">Assinatura Authenticode para desenvolvedores de jogos</span><span class="sxs-lookup"><span data-stu-id="def83-147">Authenticode Signing for Game Developers</span></span>](/windows/desktop/DxTechArts/authenticode-signing-for-game-developers)

</dd> <dt>

<span data-ttu-id="def83-148"><span id="SignTool"></span><span id="signtool"></span><span id="SIGNTOOL"></span>SignTool</span><span class="sxs-lookup"><span data-stu-id="def83-148"><span id="SignTool"></span><span id="signtool"></span><span id="SIGNTOOL"></span>SignTool</span></span>
</dt> <dd>

<span data-ttu-id="def83-149">[SignTool](/windows/desktop/SecCrypto/signtool) no MSDN</span><span class="sxs-lookup"><span data-stu-id="def83-149">[SignTool](/windows/desktop/SecCrypto/signtool) on MSDN</span></span>

</dd> </dl>

<span data-ttu-id="def83-150">A seção a seguir detalha as APIs que devem ser usadas para construir o aplicativo de carregador, que dá suporte ao layout de disco para instalação e verificação de verificação de confiança.</span><span class="sxs-lookup"><span data-stu-id="def83-150">The following section details the APIs that should be used to construct the loader application, which support disc layout for install and verification of trust checking.</span></span>

### <a name="installation-of-the-trusted-loader-and-patcher"></a><span data-ttu-id="def83-151">Instalação do carregador confiável e Patcher</span><span class="sxs-lookup"><span data-stu-id="def83-151">Installation of the Trusted Loader and Patcher</span></span>

<span data-ttu-id="def83-152">O carregador confiável e a versão base do utilitário Patcher devem ser instalados na pasta arquivos de programas protegidos no HDD, assim como nas instalações tradicionais.</span><span class="sxs-lookup"><span data-stu-id="def83-152">The trusted loader and base version of the patcher utility should be installed under the protected Program Files folder on the HDD just as in traditional installs.</span></span> <span data-ttu-id="def83-153">A instalação e a aplicação de patches do aplicativo carregador exigem direitos de administrador, portanto, é importante minimizar a frequência de atualização para o carregador para garantir que os usuários finais não precisem aumentar com frequência, embora Windows Installer aplicação limitada de patches de usuário possa ser usada para evitar a elevação de patches do carregador.</span><span class="sxs-lookup"><span data-stu-id="def83-153">Installation and patching of the loader application requires Admin rights so it is important to minimize the frequency of update for the loader to ensure end users do not need to elevate often, although Windows Installer limited user patching could be used to avoid elevation for loader patches.</span></span>

<span data-ttu-id="def83-154">Consulte o artigo corrigindo o software de jogos no Windows XP, no Windows Vista e no Windows 7.</span><span class="sxs-lookup"><span data-stu-id="def83-154">See the article Patching Game Software in Windows XP, Windows Vista, and Windows 7.</span></span>

### <a name="installation-of-the-game-executables-dlls-and-data"></a><span data-ttu-id="def83-155">Instalação dos executáveis, DLLs e dados do jogo</span><span class="sxs-lookup"><span data-stu-id="def83-155">Installation of the Game Executables, DLLs, and Data</span></span>

<span data-ttu-id="def83-156">Para facilitar as atualizações de usuário padrão do jogo sem privilégios administrativos, o executável dos jogos, as DLLs e os dados devem ser instalados em uma área do disco rígido que está acessível para gravação para todos os usuários.</span><span class="sxs-lookup"><span data-stu-id="def83-156">In order to facilitate Standard User updates of the game without administrative privilege, the games executable, DLLs, and data must be installed to an area of the hard disk that is write accessible for all users.</span></span> <span data-ttu-id="def83-157">O sistema operacional fornece uma área de "todos os usuários de aplicativos" que pode ser usada como o local padrão para instalação.</span><span class="sxs-lookup"><span data-stu-id="def83-157">The operating system provides an "All Users Application Data" area which can be used as the default location for installation.</span></span> <span data-ttu-id="def83-158">[**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) deve ser usado com a chave de \_ AppData comuns de CSIDL \_ para determinar o caminho do arquivo para essa área.</span><span class="sxs-lookup"><span data-stu-id="def83-158">[**SHGetFolderPath**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderpatha) should be used with the CSIDL\_COMMON\_APPDATA key to determine the file path for this area.</span></span> <span data-ttu-id="def83-159">É importante que não sejam feitas suposições sobre o caminho para o qual essa chave retorna, como pode ser configurável pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="def83-159">It is important that no assumptions be made about the path to which this key returns as it may be user configurable.</span></span>

<span data-ttu-id="def83-160">A instalação precisa alterar ou gerenciar as permissões de pasta para obter o acesso de todos os usuários-compartilhado-gravação necessário para atualizar o título.</span><span class="sxs-lookup"><span data-stu-id="def83-160">The installation needs to alter or manage the folder permissions in order to achieve the all-user-shared-write access needed for updating the title.</span></span> <span data-ttu-id="def83-161">Com as permissões corretas, a funcionalidade de atualizador do jogo do programa carregador pode facilmente corrigir o jogo sem a necessidade de um privilégio especial de qualquer conta de usuário, incluindo vezes quando iniciado por usuários padrão.</span><span class="sxs-lookup"><span data-stu-id="def83-161">With the correct permissions, the game updater functionality of the loader program can easily patch the game without the need for special privilege from any users account including times when launched by standard users.</span></span>

### <a name="access-control-list-modification-code"></a><span data-ttu-id="def83-162">Código de modificação da lista de controle de acesso</span><span class="sxs-lookup"><span data-stu-id="def83-162">Access Control List Modification Code</span></span>

<span data-ttu-id="def83-163">Para o Windows XP, você precisará executar o código para alterar a lista de controle de acesso (ACL) manualmente, aqui está uma função de exemplo que demonstra como fazer isso:</span><span class="sxs-lookup"><span data-stu-id="def83-163">For Windows XP, you will need to execute code to change the access control list (ACL) manually, here is an example function that demonstrates how to do this:</span></span>

``` syntax
HRESULT ChangeACLtoAllowUserRW( WCHAR* strDir )
{
    EXPLICIT_ACCESS explicitaccess;
    PACL NewAcl = NULL;
    DWORD dwError;

    BuildExplicitAccessWithName( &explicitaccess, L"BUILTIN\\Users",
                                 GENERIC_ALL, GRANT_ACCESS,
                                 SUB_CONTAINERS_AND_OBJECTS_INHERIT );
                                 
    dwError = SetEntriesInAcl( 1, &explicitaccess, NULL, &NewAcl );
    if( dwError == ERROR_SUCCESS) 
    {
        dwError = SetNamedSecurityInfo( strDir, SE_FILE_OBJECT,
                                        DACL_SECURITY_INFORMATION,
                                        NULL, NULL, NewAcl, NULL );
        if( dwError == ERROR_SUCCESS)
        {
            if( NewAcl != NULL ) AccFree( NewAcl );
            return S_OK;
        }
    }

    if( NewAcl != NULL ) AccFree( NewAcl );
    return E_FAIL;
}
```

<span data-ttu-id="def83-164">Este exemplo de código também funcionará para o Windows Vista e o Windows 7; no entanto, eles também fornecem o utilitário de linha de comando icacls para editar ACLS de arquivo que você pode optar por usar em vez disso.</span><span class="sxs-lookup"><span data-stu-id="def83-164">This code example will also work for Windows Vista and Windows 7; however, they also provide the command line utility icacls to edit file ACLS which you may choose to use instead.</span></span>

<span data-ttu-id="def83-165">A ferramenta fornece uma ajuda detalhada quando executada no entanto, um exemplo de uso para a ferramenta é:</span><span class="sxs-lookup"><span data-stu-id="def83-165">The tool provides a detailed help when executed however, one example usage for the tool is:</span></span>

``` syntax
icacls "C:\Users\All Users\Game" /grant Rex:(D,WDAC)
```

<span data-ttu-id="def83-166">Esse uso concederá ao usuário a permissão Excluir e gravar permissões DAC para a pasta de jogos armazenada nas áreas todos os usuários do disco rígido.</span><span class="sxs-lookup"><span data-stu-id="def83-166">This usage will grant the user Rex Delete and Write DAC permissions to game folder stored in the All Users areas of the hard drive.</span></span>

### <a name="installations-for-advanced-users"></a><span data-ttu-id="def83-167">Instalações para usuários avançados</span><span class="sxs-lookup"><span data-stu-id="def83-167">Installations for Advanced Users</span></span>

<span data-ttu-id="def83-168">Para cenários avançados de instalação de usuário, um usuário pode querer especificar o caminho de instalação de jogos manualmente.</span><span class="sxs-lookup"><span data-stu-id="def83-168">For advanced user installation scenarios, a user may want to specify the games installation path manually.</span></span> <span data-ttu-id="def83-169">A seleção de diretório deve ser restrita a uma fora dos arquivos de programa para garantir que a pasta esteja em uma área verdadeiramente compartilhável do disco rígido.</span><span class="sxs-lookup"><span data-stu-id="def83-169">The directory selection should be restricted to one outside of program files to ensure the folder is in a truly sharable area of the hard drive.</span></span> <span data-ttu-id="def83-170">O caminho selecionado pelo usuário deve ser usado apenas para os EXEs e os dados dos jogos como o carregador de jogos e os EXEs do Patcher sempre devem ser instalados na pasta arquivos de programas seguros para obter mais segurança.</span><span class="sxs-lookup"><span data-stu-id="def83-170">The user selected path should only be used for the games exes and data as the game Loader and Patcher exes should always be installed under the secure Program Files folder for better security.</span></span>

### <a name="the-loaders-verification-of-trust"></a><span data-ttu-id="def83-171">A verificação de confiança do carregador</span><span class="sxs-lookup"><span data-stu-id="def83-171">The Loader's Verification of Trust</span></span>

<span data-ttu-id="def83-172">O Windows fornece a função [**WinVerifyTrust**](/windows/desktop/api/wintrust/nf-wintrust-winverifytrust) para verificar a validade do código assinado e é baseado nos serviços de criptografia no sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="def83-172">Windows provides the [**WinVerifyTrust**](/windows/desktop/api/wintrust/nf-wintrust-winverifytrust) function for checking the validity of signed code and is based on the cryptographic services in the operating system.</span></span> <span data-ttu-id="def83-173">A função está totalmente documentada na função MSDN: **WinVerifyTrust** .</span><span class="sxs-lookup"><span data-stu-id="def83-173">The function is fully documented on MSDN: **WinVerifyTrust** Function.</span></span>

<span data-ttu-id="def83-174">O programa de exemplo a seguir no MSDN detalha o uso da função para determinar se um executável de programa está assinado com um certificado válido: [programa C de exemplo: verificando a assinatura de um arquivo PE](/windows/desktop/SecCrypto/example-c-program--verifying-the-signature-of-a-pe-file).</span><span class="sxs-lookup"><span data-stu-id="def83-174">The following example program on MSDN details the use of the function to determine whether a program executable is signed with a valid certificate: [Example C Program: Verifying the Signature of a PE File](/windows/desktop/SecCrypto/example-c-program--verifying-the-signature-of-a-pe-file).</span></span>

<span data-ttu-id="def83-175">Para fins de verificação de que o executável do jogo assinado é confiável para ser executado de dentro do carregador, a ação de verificação genérica será suficiente:</span><span class="sxs-lookup"><span data-stu-id="def83-175">For the purposes of verifying that the signed game executable is trustworthy to be executed from within the loader, the Generic Verify action will suffice:</span></span>

<dl> <dt>

<span data-ttu-id="def83-176"><span id="Value"></span><span id="value"></span><span id="VALUE"></span>Valor</span><span class="sxs-lookup"><span data-stu-id="def83-176"><span id="Value"></span><span id="value"></span><span id="VALUE"></span>Value</span></span>
</dt> <dd>

<span data-ttu-id="def83-177">\_Verificação genérica de ação WINTRUST \_ \_ \_ v2</span><span class="sxs-lookup"><span data-stu-id="def83-177">WINTRUST\_ACTION\_GENERIC\_VERIFY\_V2</span></span>

</dd> <dt>

<span data-ttu-id="def83-178"><span id="Meaning"></span><span id="meaning"></span><span id="MEANING"></span>Significado</span><span class="sxs-lookup"><span data-stu-id="def83-178"><span id="Meaning"></span><span id="meaning"></span><span id="MEANING"></span>Meaning</span></span>
</dt> <dd>

<span data-ttu-id="def83-179">Verifique um arquivo ou objeto usando o provedor de diretiva Authenticode.</span><span class="sxs-lookup"><span data-stu-id="def83-179">Verify a file or object using the Authenticode policy provider.</span></span>

</dd> </dl>

<span data-ttu-id="def83-180">A função usa um argumento de estrutura de entrada que contém informações que o provedor de confiança precisa para processar a ação especificada.</span><span class="sxs-lookup"><span data-stu-id="def83-180">The function takes an input structure argument which contains information that the trust provider needs to process the specified action.</span></span> <span data-ttu-id="def83-181">Normalmente, como no caso de exemplo anterior, a estrutura inclui informações que identificam o objeto que o provedor de confiança deve avaliar.</span><span class="sxs-lookup"><span data-stu-id="def83-181">Typically, as in the preceding example case, the structure includes information that identifies the object that the trust provider must evaluate.</span></span>

<span data-ttu-id="def83-182">O formato da estrutura é específico para o identificador de ação.</span><span class="sxs-lookup"><span data-stu-id="def83-182">The format of the structure is specific to the action identifier.</span></span> <span data-ttu-id="def83-183">O tópico a seguir sobre o MSDN detalha a estrutura de exemplo para a estrutura de [**\_ dados**](/windows/desktop/api/wintrust/ns-wintrust-wintrust_data) do provedor de wintrust: wintrust.</span><span class="sxs-lookup"><span data-stu-id="def83-183">The following topic on MSDN details the example structure for the WinTrust provider: [**WINTRUST\_DATA**](/windows/desktop/api/wintrust/ns-wintrust-wintrust_data) Structure.</span></span>

<span data-ttu-id="def83-184">Se o provedor de confiança verificar que o assunto é confiável para a ação especificada, o valor de retorno será zero.</span><span class="sxs-lookup"><span data-stu-id="def83-184">If the trust provider verifies that the subject is trusted for the specified action, the return value is zero.</span></span> <span data-ttu-id="def83-185">Nenhum outro valor além de zero deve ser considerado um retorno bem-sucedido.</span><span class="sxs-lookup"><span data-stu-id="def83-185">No other value besides zero should be considered a successful return.</span></span>

### <a name="data-validation"></a><span data-ttu-id="def83-186">Validação de dados</span><span class="sxs-lookup"><span data-stu-id="def83-186">Data Validation</span></span>

<span data-ttu-id="def83-187">O mecanismo de codesignação só dá suporte à assinatura de alguns tipos específicos de arquivos, incluindo executáveis, DLLs, pacotes de Windows Installer (arquivos. msi) e arquivos de gabinete (. cab).</span><span class="sxs-lookup"><span data-stu-id="def83-187">The codesigning mechanism only supports signing a few specific types of files, including executables, DLLs, Windows Installer packages (.msi files), and cabinet (.cab) files.</span></span> <span data-ttu-id="def83-188">A API [**WinVerifyTrust**](/windows/desktop/api/wintrust/nf-wintrust-winverifytrust) não deve ser usada para verificar se arquivos de dados grandes (arquivos. cab, por exemplo) não foram adulterados, pois há alguns problemas de desempenho e estabilidade ao validar arquivos muito grandes.</span><span class="sxs-lookup"><span data-stu-id="def83-188">The [**WinVerifyTrust**](/windows/desktop/api/wintrust/nf-wintrust-winverifytrust) API should not be used to verify that large data files (.cab files for example) have not been tampered with, as there are some issues with performance and stability when validating very large files.</span></span> <span data-ttu-id="def83-189">Os executáveis do programa tendem a ser pequenos o suficiente para que uma verificação de confiança total ocorra usando o provedor WinTrust, mas os arquivos de dados para jogos são geralmente do realm de muitos gigabytes.</span><span class="sxs-lookup"><span data-stu-id="def83-189">Program executables tend be small enough for a full trust check to occur using the WinTrust provider but data files for games are often of the realm of many gigabytes in size.</span></span> <span data-ttu-id="def83-190">A abordagem adotada pelo carregador para a verificação dos dados do jogo deve ser aquela em que uma pequena amostra do conjunto é testada no tempo de execução do jogo.</span><span class="sxs-lookup"><span data-stu-id="def83-190">The approach taken by the loader for verification of game data should be one where a small sample of the dataset is tested over the run time of the game.</span></span> <span data-ttu-id="def83-191">Essa abordagem espalha o custo dos testes de verificação durante a vida útil da experiência do jogo e pode fornecer uma experiência de usuário tranqüila sem tempos de espera longos.</span><span class="sxs-lookup"><span data-stu-id="def83-191">This approach spreads the cost of verification tests over the life of the game play experience and can provide a seamless user experience without long wait times.</span></span> <span data-ttu-id="def83-192">Para conseguir isso, a organização cuidadosa dos dados pode ser necessária.</span><span class="sxs-lookup"><span data-stu-id="def83-192">To achieve this, careful organization of the data may be required.</span></span> <span data-ttu-id="def83-193">Alguns MMOGs empregam uma abordagem de banco de dados para ajudar a gerenciar, manter e verificar a exatidão dos ativos do jogo ao longo do tempo.</span><span class="sxs-lookup"><span data-stu-id="def83-193">Some MMOGs employ a database approach to help manage, maintain and verify correctness of game assets over time.</span></span>

<span data-ttu-id="def83-194">Do ponto de vista da segurança, o código do cliente deve ser criado para não confiar em arquivos de dados, mesmo se você estiver usando algum tipo de validação de dados básica com o carregador confiável.</span><span class="sxs-lookup"><span data-stu-id="def83-194">From a security standpoint, the client code should be designed to not trust data files even if using some kind of basic data validation with the trusted loader.</span></span> <span data-ttu-id="def83-195">Verificações de cabeçalho, hashes e outra verificação de integridade tradicional devem ser empregadas.</span><span class="sxs-lookup"><span data-stu-id="def83-195">Header checks, hashes, and other traditional integrity checking should be employed.</span></span> <span data-ttu-id="def83-196">O trabalho para proteger o código de e/s do cliente também deve ser feito usando técnicas como teste de fuzzing, bem como tirando proveito de ferramentas de análise de código estático automáticas, como a opção **/Analyze** no visual Studio 2005 e no visual Studio 2008 (disponível no Visual Studio Team System e o compilador gratuito fornecido com o SDK do Windows).</span><span class="sxs-lookup"><span data-stu-id="def83-196">Work to hardened the client's I/O code should also be done using techniques such as fuzz testing as well as taking advantage of automatic static code analysis tools such as the **/analyze** switch in Visual Studio 2005 and Visual Studio 2008 (available in Visual Studio Team System and the free compiler that ships with the Windows SDK).</span></span>

<span data-ttu-id="def83-197">Para obter mais informações sobre segurança de software, consulte [práticas recomendadas de segurança no desenvolvimento de jogos](/windows/desktop/DxTechArts/best-security-practices-in-game-development).</span><span class="sxs-lookup"><span data-stu-id="def83-197">For more information about software security, see [Best Security Practices in Game Development](/windows/desktop/DxTechArts/best-security-practices-in-game-development).</span></span>

 

 