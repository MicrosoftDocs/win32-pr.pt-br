---
description: Este tópico não é atual. Para obter as informações mais atuais, consulte a especificação do esquema de impressão.
ms.assetid: 1f991b6b-8443-4234-ad46-dc4220e34c5c
title: Criando um PrintTicket genérico
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c34281eda82a48ea0ac4077248547522ddc305ea
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/05/2021
ms.locfileid: "105771555"
---
# <a name="creating-a-generic-printticket"></a><span data-ttu-id="0eda0-104">Criando um PrintTicket genérico</span><span class="sxs-lookup"><span data-stu-id="0eda0-104">Creating a Generic PrintTicket</span></span>

<span data-ttu-id="0eda0-105">Este tópico não é atual.</span><span class="sxs-lookup"><span data-stu-id="0eda0-105">This topic is not current.</span></span> <span data-ttu-id="0eda0-106">Para obter as informações mais atuais, consulte a [especificação do esquema de impressão](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span><span class="sxs-lookup"><span data-stu-id="0eda0-106">For the most current information, see the [Print Schema Specification](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span></span>

<span data-ttu-id="0eda0-107">Se o documento PrintCapabilities do dispositivo estiver indisponível ou se o dispositivo de destino for desconhecido, você deverá construir um PrintTicket genérico.</span><span class="sxs-lookup"><span data-stu-id="0eda0-107">If the PrintCapabilities document for the device is unavailable, or if the target device is unknown, you should construct a generic PrintTicket.</span></span> <span data-ttu-id="0eda0-108">Como não há nenhum documento de PrintCapabilities que forneça um conjunto de elementos de recursos e opções, ou parâmetros, as instâncias com suporte desses tipos de elementos devem ser obtidas diretamente das palavras-chave do esquema de impressão.</span><span class="sxs-lookup"><span data-stu-id="0eda0-108">Because there is no PrintCapabilities document that provides a set of Feature and Option elements, or parameters, the supported instances of these element types must be obtained directly from the Print Schema Keywords.</span></span>

<span data-ttu-id="0eda0-109">As etapas mostradas na lista a seguir devem ser usadas quando você cria um PrintTicket genérico.</span><span class="sxs-lookup"><span data-stu-id="0eda0-109">The steps shown in the following list should be used when you create a generic PrintTicket.</span></span>

1.  <span data-ttu-id="0eda0-110">Crie um documento XML vazio que contenha a raiz do PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0eda0-110">Create an empty XML document that contains the PrintTicket root.</span></span> <span data-ttu-id="0eda0-111">Atribua um prefixo de namespace ao namespace de esquema de impressão.</span><span class="sxs-lookup"><span data-stu-id="0eda0-111">Assign a namespace prefix to the Print Schema namespace.</span></span> <span data-ttu-id="0eda0-112">Especifique a versão do esquema.</span><span class="sxs-lookup"><span data-stu-id="0eda0-112">Specify the Schema version.</span></span>

2.  <span data-ttu-id="0eda0-113">Examine as instâncias de recurso nas palavras-chave do esquema de impressão e determine quais delas você deseja definir em seu PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0eda0-113">Examine the Feature instances in the Print Schema Keywords and determine which of these you want defined in your PrintTicket.</span></span> <span data-ttu-id="0eda0-114">Adicione essas instâncias de recursos ao seu PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0eda0-114">Add these Feature instances to your PrintTicket.</span></span> <span data-ttu-id="0eda0-115">Ao transferir um subrecurso, você deve transferir o recurso pai e preservar a relação pai-filho entre o recurso e o subrecurso no PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0eda0-115">When you transfer a subfeature, you must transfer the parent Feature, and preserve the parent-child relationship between the Feature and subfeature in the PrintTicket.</span></span>

    <span data-ttu-id="0eda0-116">Para cada instância de recurso que você transferir, determine quais instâncias de opção são aplicáveis ao seu PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0eda0-116">For each Feature instance that you transfer, determine which Option instances are applicable to your PrintTicket.</span></span> <span data-ttu-id="0eda0-117">A partir desse conjunto de instâncias de opção, transfira cada instância de opção inteira como ela aparece no esquema de impressão e, em seguida, remova todas as instâncias de propriedade que estão presentes, com a possível exceção daqueles que têm significado em seu PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0eda0-117">From this set of Option instances, transfer each entire Option instance as it appears in the Print Schema, and then remove any Property instances that are present, with the possible exception of those that have significance to your PrintTicket.</span></span> <span data-ttu-id="0eda0-118">Mantenha todas as instâncias de ScoredProperty, garantindo que você preserve sua localização; Eles são parte intrínseca da definição de opção.</span><span class="sxs-lookup"><span data-stu-id="0eda0-118">Keep all of the ScoredProperty instances, making sure that you preserve their location; they are an intrinsic part of the Option definition.</span></span>

3.  <span data-ttu-id="0eda0-119">Você também pode adicionar instâncias de propriedade a qualquer ScoredProperty.</span><span class="sxs-lookup"><span data-stu-id="0eda0-119">You may also add Property instances to any ScoredProperty.</span></span> <span data-ttu-id="0eda0-120">Os elementos de propriedade são aplicáveis somente se o provedor PrintTicket suportar explicitamente seu uso.</span><span class="sxs-lookup"><span data-stu-id="0eda0-120">Property elements are applicable only if the PrintTicket provider explicitly supports their use.</span></span> <span data-ttu-id="0eda0-121">Cada provedor deve documentar a finalidade e o uso de todas as instâncias de propriedade com suporte.</span><span class="sxs-lookup"><span data-stu-id="0eda0-121">Each provider should document the purpose and use of all supported Property instances.</span></span> <span data-ttu-id="0eda0-122">Como você não tem idéia de qual provedor processará o PrintTicket, talvez queira acrescentar apenas as instâncias de propriedade com suporte explícito pelo provedor PrintTicket do sistema.</span><span class="sxs-lookup"><span data-stu-id="0eda0-122">Because you have no idea which provider will process the PrintTicket, you might wish to append only the Property instances that are explicitly supported by the system PrintTicket provider.</span></span>

4.  <span data-ttu-id="0eda0-123">Se as palavras-chave do esquema de impressão definirem a Propriedade SelectionType como PickMany para um recurso específico, você poderá selecionar mais de uma opção para esse recurso, desde que a opção designada como IdentityOption não seja aquela selecionada.</span><span class="sxs-lookup"><span data-stu-id="0eda0-123">If the Print Schema Keywords set the SelectionType Property to PickMany for a particular Feature, you may select more than one Option for that Feature, provided that the Option designated as IdentityOption is not one of those selected.</span></span> <span data-ttu-id="0eda0-124">IdentityOption no esquema de impressão tem o mesmo efeito que a opção None em arquivos PPD PostScript e arquivos GPD do unidrv; Ele serve como um estado não operacional.</span><span class="sxs-lookup"><span data-stu-id="0eda0-124">IdentityOption in the Print Schema has the same effect as the None option in Postscript PPD files and Unidrv GPD files; it serves as a no-op.</span></span>

5.  <span data-ttu-id="0eda0-125">Examine as palavras-chave do esquema de impressão para instâncias ParameterDef que devem ser inicializadas em seu PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0eda0-125">Examine the Print Schema Keywords for ParameterDef instances that should be initialized in your PrintTicket.</span></span> <span data-ttu-id="0eda0-126">Para cada instância de ParameterDef, selecione o valor a ser usado na instância de ParameterInit no PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0eda0-126">For each such ParameterDef instance, select the Value to be used in the ParameterInit instance in the PrintTicket.</span></span> <span data-ttu-id="0eda0-127">Esse valor deve ser do tipo de dados correto, deve estar dentro do intervalo definido na instância ParameterDef e deve atender a todos os outros requisitos especificados na instância ParameterDef.</span><span class="sxs-lookup"><span data-stu-id="0eda0-127">This Value must be of the correct data type, must fall within the range defined in the ParameterDef instance, and must meet all of the other requirements specified in the ParameterDef instance.</span></span> <span data-ttu-id="0eda0-128">Use uma instância de ParameterInit para inicializar o parâmetro para o valor que você selecionou.</span><span class="sxs-lookup"><span data-stu-id="0eda0-128">Use a ParameterInit instance to initialize the parameter to the Value you have selected.</span></span>

    <span data-ttu-id="0eda0-129">Se você estiver desenvolvendo um componente de interface do usuário (IU), crie seus métodos de geração de PrintTicket para que os usuários possam inserir o valor para o elemento ParameterInit.</span><span class="sxs-lookup"><span data-stu-id="0eda0-129">If you are developing a user interface (UI) component, design your PrintTicket generation methods so that users can enter the Value for the ParameterInit element.</span></span> <span data-ttu-id="0eda0-130">Além disso, o método de entrada da interface do usuário deve observar e obedecer a quaisquer restrições de entrada especificadas pelo elemento ParameterDef associado.</span><span class="sxs-lookup"><span data-stu-id="0eda0-130">In addition, the UI entry method should observe and comply with any input restrictions specified by the associated ParameterDef element.</span></span>

6.  <span data-ttu-id="0eda0-131">Examine o conteúdo de cada instância de opção que aparece no PrintTicket para ocorrências de ParameterRef.</span><span class="sxs-lookup"><span data-stu-id="0eda0-131">Examine the contents of each Option instance that appears in the PrintTicket for occurrences of ParameterRef.</span></span> <span data-ttu-id="0eda0-132">Se uma instância ParameterInit correspondente ainda não aparecer no PrintTicket, siga a etapa anterior para criar uma instância ParameterInit no PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0eda0-132">If a corresponding ParameterInit instance does not already appear in the PrintTicket, follow the previous step to create a ParameterInit instance in the PrintTicket.</span></span> <span data-ttu-id="0eda0-133">A finalidade dessa instância de ParameterInit é inicializar o parâmetro referenciado pela instância ParameterRef.</span><span class="sxs-lookup"><span data-stu-id="0eda0-133">The purpose of this ParameterInit instance is to initialize the parameter referenced by the ParameterRef instance.</span></span>

7.  <span data-ttu-id="0eda0-134">Tenha em mente que o dispositivo que processa o trabalho pode não dar suporte a todos os recursos especificados no PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0eda0-134">Keep in mind that the device that processes the job might not support every Feature specified in the PrintTicket.</span></span> <span data-ttu-id="0eda0-135">Tenha em mente também que um recurso nomeado pode ter suporte, mas uma opção especificada desse recurso pode não ser.</span><span class="sxs-lookup"><span data-stu-id="0eda0-135">Keep in mind also, that a named Feature might be supported, but a specified Option of that Feature might not be.</span></span> <span data-ttu-id="0eda0-136">As mesmas restrições se aplicam aos parâmetros.</span><span class="sxs-lookup"><span data-stu-id="0eda0-136">The same caveats apply to parameters.</span></span> <span data-ttu-id="0eda0-137">Mesmo que um dispositivo dê suporte a um parâmetro nomeado, o valor especificado na instância ParameterInit pode não estar dentro do intervalo válido para o dispositivo.</span><span class="sxs-lookup"><span data-stu-id="0eda0-137">Even if a device supports a named parameter, the Value specified in the ParameterInit instance might not be within the valid range for the device.</span></span>

8.  <span data-ttu-id="0eda0-138">Examine as palavras-chave do esquema de impressão para as instâncias de propriedade que devem estar presentes em seu PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0eda0-138">Examine the Print Schema Keywords for Property instances that must be present in your PrintTicket.</span></span> <span data-ttu-id="0eda0-139">Adicione uma instância de propriedade para cada uma delas ao seu PrintTicket e forneça um valor adequado para ela usando o tipo de elemento de valor.</span><span class="sxs-lookup"><span data-stu-id="0eda0-139">Add a Property instance for each of these to your PrintTicket, and provide a suitable value for it using the Value element type.</span></span> <span data-ttu-id="0eda0-140">Verifique se as instâncias de propriedade estão localizadas corretamente dentro do PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0eda0-140">Make sure that Property instances are located properly within the PrintTicket.</span></span> <span data-ttu-id="0eda0-141">Certifique-se de consultar o esquema PrintTicket em vez do esquema PrintCapabilities.</span><span class="sxs-lookup"><span data-stu-id="0eda0-141">Make sure that you consult the PrintTicket Schema rather than the PrintCapabilities Schema.</span></span>

9.  <span data-ttu-id="0eda0-142">Examine as instâncias de propriedade opcionais definidas no esquema PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0eda0-142">Examine the optional Property instances defined in the PrintTicket Schema.</span></span> <span data-ttu-id="0eda0-143">Se houver essas instâncias de propriedade que devem estar em seu PrintTicket, crie-as em seu PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0eda0-143">If there are any such Property instances that should be in your PrintTicket, create them in your PrintTicket.</span></span>

10. <span data-ttu-id="0eda0-144">Os filhos do mesmo tipo de elemento não podem aninhar uma profundidade de mais de 10 elementos.</span><span class="sxs-lookup"><span data-stu-id="0eda0-144">Children of the same element type may not nest to a depth of more than 10 elements.</span></span> <span data-ttu-id="0eda0-145">Essa regra se aplica de forma independente a cada tipo de elemento que pode ser definido.</span><span class="sxs-lookup"><span data-stu-id="0eda0-145">This rule applies independently to each type of element that can be defined.</span></span>

> [!Note]  
> <span data-ttu-id="0eda0-146">O conteúdo XML do PrintTicket deve ser codificado usando UTF-8 ou UTF-16.</span><span class="sxs-lookup"><span data-stu-id="0eda0-146">PrintTicket XML content MUST be encoded using either UTF-8 or UTF-16.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="0eda0-147">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="0eda0-147">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0eda0-148">Especificação de esquema de impressão</span><span class="sxs-lookup"><span data-stu-id="0eda0-148">Print Schema Specification</span></span>](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip)
</dt> </dl>

 

 



