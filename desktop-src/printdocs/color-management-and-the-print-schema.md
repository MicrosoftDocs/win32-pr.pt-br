---
description: Saiba mais sobre palavras-chave configuráveis pelo usuário no esquema de impressão para gerenciamento de cores, como PageColorManagement e PageBlackGenerationProcessing.
ms.assetid: 296255b8-fe5c-46dd-b717-487aaae0db80
title: Gerenciamento de cores e o esquema de impressão
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9258d9dcc59ab24f9cfca8e170bf3f3f62841b21
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/19/2021
ms.locfileid: "112409669"
---
# <a name="color-management-and-the-print-schema"></a><span data-ttu-id="0d012-103">Gerenciamento de cores e o esquema de impressão</span><span class="sxs-lookup"><span data-stu-id="0d012-103">Color Management and the Print Schema</span></span>

<span data-ttu-id="0d012-104">Este tópico não é atual.</span><span class="sxs-lookup"><span data-stu-id="0d012-104">This topic is not current.</span></span> <span data-ttu-id="0d012-105">Para obter as informações mais atuais, consulte a [especificação do esquema de impressão](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span><span class="sxs-lookup"><span data-stu-id="0d012-105">For the most current information, see the [Print Schema Specification](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span></span>

<span data-ttu-id="0d012-106">As palavras-chave do elemento configurável pelo usuário podem ser específicas de XPS ou específicas não-XPS.</span><span class="sxs-lookup"><span data-stu-id="0d012-106">User Configurable Element keywords may either be XPS specific or non-XPS specific.</span></span> <span data-ttu-id="0d012-107">No caso em que eles não são específicos do XPS, a palavra-chave pode ser usada para impressão baseada em GDI herdada.</span><span class="sxs-lookup"><span data-stu-id="0d012-107">In the case where they are not XPS specific, the keyword may be used for Legacy GDI-based printing.</span></span> <span data-ttu-id="0d012-108">Se um aplicativo decidir definir essas palavras-chave em um PrintTicket, cabe ao driver determinar a ação e o comportamento adequados a serem tomadas com base nas definições apresentadas no esquema de impressão.</span><span class="sxs-lookup"><span data-stu-id="0d012-108">If an application decides to set these keywords in a PrintTicket, it is up to the driver to determine the proper action and behavior to take based on the definitions presented in the Print Schema.</span></span> <span data-ttu-id="0d012-109">Qualquer uma dessas palavras-chave pode ser usada no contexto de ICM.</span><span class="sxs-lookup"><span data-stu-id="0d012-109">Any of these keywords may be used in the context of ICM.</span></span> <span data-ttu-id="0d012-110">Para obter mais informações, consulte o SDK do Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="0d012-110">For more information, please see the Windows Vista SDK.</span></span>



| <span data-ttu-id="0d012-111">Palavra-chave configurável do usuário do esquema de impressão</span><span class="sxs-lookup"><span data-stu-id="0d012-111">Print Schema User Configurable Keyword</span></span>       | <span data-ttu-id="0d012-112">DEVMODE equivalente</span><span class="sxs-lookup"><span data-stu-id="0d012-112">DEVMODE Equivalent</span></span>     | <span data-ttu-id="0d012-113">Específico do XPS</span><span class="sxs-lookup"><span data-stu-id="0d012-113">XPS Specific</span></span>   |
|----------------------------------------------|------------------------|----------------|
| <span data-ttu-id="0d012-114">PageColorManagement</span><span class="sxs-lookup"><span data-stu-id="0d012-114">PageColorManagement</span></span><br/>               | <span data-ttu-id="0d012-115">dmICMMethod</span><span class="sxs-lookup"><span data-stu-id="0d012-115">dmICMMethod</span></span><br/> | <span data-ttu-id="0d012-116">Não</span><span class="sxs-lookup"><span data-stu-id="0d012-116">No</span></span><br/>  |
| <span data-ttu-id="0d012-117">PageBlackGenerationProcessing</span><span class="sxs-lookup"><span data-stu-id="0d012-117">PageBlackGenerationProcessing</span></span><br/>     | <span data-ttu-id="0d012-118">Nenhum</span><span class="sxs-lookup"><span data-stu-id="0d012-118">None</span></span><br/>        | <span data-ttu-id="0d012-119">Sim</span><span class="sxs-lookup"><span data-stu-id="0d012-119">Yes</span></span><br/> |
| <span data-ttu-id="0d012-120">PageBlendColorSpace</span><span class="sxs-lookup"><span data-stu-id="0d012-120">PageBlendColorSpace</span></span><br/>               | <span data-ttu-id="0d012-121">Nenhum</span><span class="sxs-lookup"><span data-stu-id="0d012-121">None</span></span><br/>        | <span data-ttu-id="0d012-122">Sim</span><span class="sxs-lookup"><span data-stu-id="0d012-122">Yes</span></span><br/> |
| <span data-ttu-id="0d012-123">PageSourceColorProfile</span><span class="sxs-lookup"><span data-stu-id="0d012-123">PageSourceColorProfile</span></span><br/>            | <span data-ttu-id="0d012-124">Nenhum</span><span class="sxs-lookup"><span data-stu-id="0d012-124">None</span></span><br/>        | <span data-ttu-id="0d012-125">Não</span><span class="sxs-lookup"><span data-stu-id="0d012-125">No</span></span><br/>  |
| <span data-ttu-id="0d012-126">PageDestinationColorProfile</span><span class="sxs-lookup"><span data-stu-id="0d012-126">PageDestinationColorProfile</span></span><br/>       | <span data-ttu-id="0d012-127">Nenhum</span><span class="sxs-lookup"><span data-stu-id="0d012-127">None</span></span><br/>        | <span data-ttu-id="0d012-128">Não</span><span class="sxs-lookup"><span data-stu-id="0d012-128">No</span></span><br/>  |
| <span data-ttu-id="0d012-129">PageICMRenderingIntent</span><span class="sxs-lookup"><span data-stu-id="0d012-129">PageICMRenderingIntent</span></span><br/>            | <span data-ttu-id="0d012-130">dmICMIntent</span><span class="sxs-lookup"><span data-stu-id="0d012-130">dmICMIntent</span></span><br/> | <span data-ttu-id="0d012-131">Não</span><span class="sxs-lookup"><span data-stu-id="0d012-131">No</span></span><br/>  |
| <span data-ttu-id="0d012-132">JobOptimalDestinationColorProfile</span><span class="sxs-lookup"><span data-stu-id="0d012-132">JobOptimalDestinationColorProfile</span></span><br/> | <span data-ttu-id="0d012-133">Nenhum</span><span class="sxs-lookup"><span data-stu-id="0d012-133">None</span></span><br/>        | <span data-ttu-id="0d012-134">Não</span><span class="sxs-lookup"><span data-stu-id="0d012-134">No</span></span><br/>  |
| <span data-ttu-id="0d012-135">PageDeviceColorSpaceUsage</span><span class="sxs-lookup"><span data-stu-id="0d012-135">PageDeviceColorSpaceUsage</span></span><br/>         | <span data-ttu-id="0d012-136">Nenhum</span><span class="sxs-lookup"><span data-stu-id="0d012-136">None</span></span><br/>        | <span data-ttu-id="0d012-137">Sim</span><span class="sxs-lookup"><span data-stu-id="0d012-137">Yes</span></span><br/> |



 

## <a name="pagecolormanagement-system-handling"></a><span data-ttu-id="0d012-138">Manipulação do sistema PageColorManagement</span><span class="sxs-lookup"><span data-stu-id="0d012-138">PageColorManagement System Handling</span></span>

<span data-ttu-id="0d012-139">Para PageColorManagement, o sistema fornece manipulação automática de PrintTicket para DEVMODE ou DEVMODE para conversão de PrintTicket, se necessário.</span><span class="sxs-lookup"><span data-stu-id="0d012-139">For PageColorManagement, the system provides automatic handling of PrintTicket to DEVMODE or DEVMODE to PrintTicket conversion if necessary.</span></span> <span data-ttu-id="0d012-140">Isso depende do caminho de impressão específico entre o aplicativo (Win32 ou WPF) e o driver (baseado em GDI ou XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="0d012-140">This depends on the specific print path between the application (Win32 or WPF)and the driver (GDI-based or XPSDrv).</span></span> <span data-ttu-id="0d012-141">No caso de impressão de um aplicativo Windows Presentation Foundation para um driver de impressão XPSDrv da Microsoft, uma opção pública PageColorManagement do sistema não deve ser anunciada no documento PrintTicket ou PrintCapabilities; Nesse caso, o gerenciamento de cores não pode ser manipulado automaticamente pelo sistema.</span><span class="sxs-lookup"><span data-stu-id="0d012-141">In the case of printing from a Windows Presentation Foundation application to a Microsoft XPSDrv print driver, a PageColorManagement public option of System SHOULD NOT be advertised in either the PrintTicket or PrintCapabilities document; in this case, color management cannot be handled automatically by the system.</span></span> <span data-ttu-id="0d012-142">A impressão de um aplicativo Win32 para um driver de impressão XPSDrv da Microsoft pode resultar em gerenciamento de cores entre o aplicativo e o GDI, no entanto, após a conversão para o formato XPS, não haverá manipulação automática do sistema de gerenciamento de cores entre o documento XPS e o driver e/ou o dispositivo, pois o formato XPS marca cada elemento com informações de cores completas e cabe ao driver ou dispositivo processar essas informações.</span><span class="sxs-lookup"><span data-stu-id="0d012-142">Printing from a Win32 application to a Microsoft XPSDrv print driver may result in color management between the application and GDI, however after conversion to XPS-format, there will be no automatic system handling of color management between the XPS document and the driver and/or device, because the XPS-format tags each element with complete color information, and it is up to the driver or the device to process this information.</span></span>



| <span data-ttu-id="0d012-143">Opções públicas do PageColorManagement</span><span class="sxs-lookup"><span data-stu-id="0d012-143">PageColorManagement Public Options</span></span> | <span data-ttu-id="0d012-144">Valor de DEVMODE</span><span class="sxs-lookup"><span data-stu-id="0d012-144">DEVMODE Value</span></span>                  |
|------------------------------------|--------------------------------|
| <span data-ttu-id="0d012-145">Nenhum</span><span class="sxs-lookup"><span data-stu-id="0d012-145">None</span></span><br/>                    | <span data-ttu-id="0d012-146">DMICMMETHOD \_ nenhum</span><span class="sxs-lookup"><span data-stu-id="0d012-146">DMICMMETHOD\_NONE</span></span><br/>   |
| <span data-ttu-id="0d012-147">Dispositivo</span><span class="sxs-lookup"><span data-stu-id="0d012-147">Device</span></span><br/>                  | <span data-ttu-id="0d012-148">\_dispositivo DMICMMETHOD</span><span class="sxs-lookup"><span data-stu-id="0d012-148">DMICMMETHOD\_DEVICE</span></span><br/> |
| <span data-ttu-id="0d012-149">Driver</span><span class="sxs-lookup"><span data-stu-id="0d012-149">Driver</span></span><br/>                  | <span data-ttu-id="0d012-150">\_Driver DMICMMETHOD</span><span class="sxs-lookup"><span data-stu-id="0d012-150">DMICMMETHOD\_DRIVER</span></span><br/> |
| <span data-ttu-id="0d012-151">Sistema</span><span class="sxs-lookup"><span data-stu-id="0d012-151">System</span></span><br/>                  | <span data-ttu-id="0d012-152">\_sistema DMICMMETHOD</span><span class="sxs-lookup"><span data-stu-id="0d012-152">DMICMMETHOD\_SYSTEM</span></span><br/> |



 

## <a name="pageicmrenderingintent-system-handling"></a><span data-ttu-id="0d012-153">Manipulação do sistema PageICMRenderingIntent</span><span class="sxs-lookup"><span data-stu-id="0d012-153">PageICMRenderingIntent System Handling</span></span>

<span data-ttu-id="0d012-154">Para PageICMRenderingIntent, o sistema fornece manipulação automática de PrintTicket para DEVMODE ou DEVMODE para conversão de PrintTicket, se necessário.</span><span class="sxs-lookup"><span data-stu-id="0d012-154">For PageICMRenderingIntent, the system provides automatic handling of PrintTicket to DEVMODE or DEVMODE to PrintTicket conversion if necessary.</span></span> <span data-ttu-id="0d012-155">Isso depende do caminho de impressão específico entre o aplicativo (Win32 ou Windows Presentation Foundation) e o driver (baseado em GDI ou XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="0d012-155">This depends on the specific print path between the application (Win32 or Windows Presentation Foundation) and the driver (GDI-based or XPSDrv).</span></span>



| <span data-ttu-id="0d012-156">Opções públicas do PageICMRenderingIntent</span><span class="sxs-lookup"><span data-stu-id="0d012-156">PageICMRenderingIntent Public Options</span></span> | <span data-ttu-id="0d012-157">Valor de DEVMODE</span><span class="sxs-lookup"><span data-stu-id="0d012-157">DEVMODE Value</span></span>                       |
|---------------------------------------|-------------------------------------|
| <span data-ttu-id="0d012-158">AbsoluteColorimetric</span><span class="sxs-lookup"><span data-stu-id="0d012-158">AbsoluteColorimetric</span></span><br/>       | <span data-ttu-id="0d012-159">colorimétrico DMICM do \_ ABS \_</span><span class="sxs-lookup"><span data-stu-id="0d012-159">DMICM\_ABS\_COLORIMETRIC</span></span><br/> |
| <span data-ttu-id="0d012-160">RelativeColorimetric</span><span class="sxs-lookup"><span data-stu-id="0d012-160">RelativeColorimetric</span></span><br/>       | <span data-ttu-id="0d012-161">\_COLORIMÉTRICO DMICM</span><span class="sxs-lookup"><span data-stu-id="0d012-161">DMICM\_COLORIMETRIC</span></span><br/>      |
| <span data-ttu-id="0d012-162">Fotografias</span><span class="sxs-lookup"><span data-stu-id="0d012-162">Photographs</span></span><br/>                | <span data-ttu-id="0d012-163">contraste de DMICM \_</span><span class="sxs-lookup"><span data-stu-id="0d012-163">DMICM\_CONTRAST</span></span><br/>          |
| <span data-ttu-id="0d012-164">BusinessGraphics</span><span class="sxs-lookup"><span data-stu-id="0d012-164">BusinessGraphics</span></span><br/>           | <span data-ttu-id="0d012-165">\_saturação DMICM</span><span class="sxs-lookup"><span data-stu-id="0d012-165">DMICM\_SATURATE</span></span><br/>          |



 

<span data-ttu-id="0d012-166">Todas as outras palavras-chave relacionadas ao gerenciamento de cores (além de PageColorManagement ou PageICMRenderingIntent) não têm tal manipulação automática.</span><span class="sxs-lookup"><span data-stu-id="0d012-166">All other Color Management related keywords (besides PageColorManagement or PageICMRenderingIntent) do not have such automatic handling.</span></span>

## <a name="joboptimaldestinationcolorprofile-and-pagedestinationcolorprofile-usage"></a><span data-ttu-id="0d012-167">Uso de JobOptimalDestinationColorProfile e PageDestinationColorProfile</span><span class="sxs-lookup"><span data-stu-id="0d012-167">JobOptimalDestinationColorProfile and PageDestinationColorProfile Usage</span></span>

<span data-ttu-id="0d012-168">Um aplicativo pode decidir consultar o documento de PrintCapabilities para JobOptimalDestinationColorProfile.</span><span class="sxs-lookup"><span data-stu-id="0d012-168">An application MAY decide to query PrintCapabilities document for JobOptimalDestinationColorProfile.</span></span> <span data-ttu-id="0d012-169">Isso pode dar a um aplicativo o perfil de cor ideal, considerando a configuração atual do dispositivo, conforme definido no documento PrintCapabilities.</span><span class="sxs-lookup"><span data-stu-id="0d012-169">This could give an application the optimal color profile given the current device configuration as defined in the PrintCapabilities document.</span></span> <span data-ttu-id="0d012-170">Se o aplicativo decidir que o driver executa o gerenciamento de cores para o perfil de cor de destino especificado por JobOptimalDestinationColorProfile, PageColorManagement e PageDestinationColorProfile seriam definidos como driver e DriverConfiguration no PrintTicket, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="0d012-170">If the application decides it would like the driver to perform color management to the destination color profile specified by JobOptimalDestinationColorProfile, then PageColorManagement and PageDestinationColorProfile would be set to Driver and DriverConfiguration in the PrintTicket respectively.</span></span> <span data-ttu-id="0d012-171">Se o aplicativo não quiser usar o JobOptionalDestinationColorProfile e optar por usar seu próprio, ele deverá definir PageColorManagement como None e também definir o PageDestinationColorProfile como aplicativo no PrintTicket para transmitir que o aplicativo já realizou o gerenciamento de cores para seu perfil de cor de destino especificado.</span><span class="sxs-lookup"><span data-stu-id="0d012-171">If the application does not want to use the JobOptionalDestinationColorProfile and chooses to use its own, it SHOULD set PageColorManagement to None and also set the PageDestinationColorProfile to Application in the PrintTicket to convey that the application has already performed color management to its specified destination color profile.</span></span> <span data-ttu-id="0d012-172">Outro cenário pode ocorrer quando o aplicativo opta por usar o perfil de cor de destino ideal retornado pelos drivers de PrintCapabilities, mas decide fazer o gerenciamento de cores por conta própria.</span><span class="sxs-lookup"><span data-stu-id="0d012-172">Another scenario may occur when the application chooses to use the optimal destination color profile returned by the drivers PrintCapabilities but decides to do color management on its own.</span></span> <span data-ttu-id="0d012-173">Nesse caso, PageColorManagement seria definido como None e PageDestinationColorProfile seria definido como Application.</span><span class="sxs-lookup"><span data-stu-id="0d012-173">In this case, PageColorManagement would be set to None and PageDestinationColorProfile would be set to Application.</span></span>

## <a name="pagesourcecolorprofile-usage"></a><span data-ttu-id="0d012-174">Uso de PageSourceColorProfile</span><span class="sxs-lookup"><span data-stu-id="0d012-174">PageSourceColorProfile Usage</span></span>

<span data-ttu-id="0d012-175">Para PageSourceColorProfile, um aplicativo pode especificar um perfil de cor de origem para cada página no PrintTicket, independentemente da opção selecionada para PageColorManagement.</span><span class="sxs-lookup"><span data-stu-id="0d012-175">For PageSourceColorProfile, an application MAY specify a source color profile for each page in the PrintTicket, regardless of the option selected for PageColorManagement.</span></span> <span data-ttu-id="0d012-176">Independentemente de estar presente ou não, cabe ao driver decidir o comportamento de cada caso com base nas definições apresentadas no esquema de impressão.</span><span class="sxs-lookup"><span data-stu-id="0d012-176">Whether it is present or not, it is up to the driver to decide the behavior for each case based on the definitions presented in the Print Schema.</span></span> <span data-ttu-id="0d012-177">Por exemplo, um aplicativo pode definir PageColorManagement como nenhum e, em seguida, não definir PageSourceColorProfile no PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="0d012-177">For example, an application may set PageColorManagement to None, and then not set PageSourceColorProfile in the PrintTicket.</span></span> <span data-ttu-id="0d012-178">Também é possível que um aplicativo defina PageColorManagement para driver e, em seguida, defina PageSourceColorProfile no PrintTicket; o driver, nesse caso, é responsável por determinar o comportamento dentro das diretrizes do coesquema.</span><span class="sxs-lookup"><span data-stu-id="0d012-178">It is also possible for an application to set PageColorManagement to Driver, and then set PageSourceColorProfile in the PrintTicket; the driver in this case is responsible for determining the behavior within the guidelines of the PrintSchema.</span></span>

## <a name="pagedevicecolorspaceusage"></a><span data-ttu-id="0d012-179">PageDeviceColorSpaceUsage</span><span class="sxs-lookup"><span data-stu-id="0d012-179">PageDeviceColorSpaceUsage</span></span>

<span data-ttu-id="0d012-180">PageDeviceColorSpaceUsage é um elemento que pode ser configurado pelo usuário específico do XPS que é definido pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0d012-180">PageDeviceColorSpaceUsage is an XPS specific user configurable element that is set by the application.</span></span> <span data-ttu-id="0d012-181">Ele fornece instruções para o dispositivo definindo a opção apropriada no PrintTicket, para o tratamento de perfil de espaço de cores associado em um documento XPS.</span><span class="sxs-lookup"><span data-stu-id="0d012-181">It provides instructions for the device by setting the appropriate option in the PrintTicket, for color space profile handling associated within an XPS document.</span></span> <span data-ttu-id="0d012-182">O aplicativo e/ou PrintTicket existente podem especificar essa palavra-chave em um PrintTicket enviado ao dispositivo.</span><span class="sxs-lookup"><span data-stu-id="0d012-182">The application and/or existing PrintTicket MAY specify this keyword in a PrintTicket sent to the device.</span></span> <span data-ttu-id="0d012-183">Independentemente de estar presente ou não, cabe ao driver decidir o comportamento de cada caso, com base nas definições apresentadas no esquema de impressão.</span><span class="sxs-lookup"><span data-stu-id="0d012-183">Whether it is present or not, it is up to the driver to decide the behavior for each case, based on the definitions presented in the Print Schema.</span></span>

## <a name="print-schema-color-management-example-flow"></a><span data-ttu-id="0d012-184">Fluxo de exemplo de gerenciamento de cores do esquema de impressão</span><span class="sxs-lookup"><span data-stu-id="0d012-184">Print Schema Color Management Example Flow</span></span>

<span data-ttu-id="0d012-185">O diagrama a seguir ilustra o Flow para os cenários mais prováveis para usar o gerenciamento de cores e o esquema de impressão.</span><span class="sxs-lookup"><span data-stu-id="0d012-185">The following diagram illustrates flow for the most likely scenarios for using Color Management and the Print Schema.</span></span> <span data-ttu-id="0d012-186">Para simplificar e facilitar a legibilidade, somente as seguintes palavras-chave de esquema de impressão configuráveis pelo usuário foram usadas para demonstrar seu uso: PageColorManagement, JobOptimalDestinaionColorProfile, PageSourceColorProfile e PageDestinationColorProfile.</span><span class="sxs-lookup"><span data-stu-id="0d012-186">For simplicity and readability, only the following user configurable Print Schema keywords were used to demonstrate their usage: PageColorManagement, JobOptimalDestinaionColorProfile, PageSourceColorProfile, and PageDestinationColorProfile.</span></span> <span data-ttu-id="0d012-187">Uma linha sólida representa uma ação que deve ocorrer e uma linha tracejada representa uma ação que pode ocorrer.</span><span class="sxs-lookup"><span data-stu-id="0d012-187">A solid line represents an action that SHOULD occur and a dashed line represents an action that MAY occur.</span></span> <span data-ttu-id="0d012-188">O cenário a seguir não é a interação garantida que resultará entre o aplicativo, o driver e o sistema, no entanto, representa o caso de uso mais comum que ocorrerá.</span><span class="sxs-lookup"><span data-stu-id="0d012-188">The following scenario is not the guaranteed interaction that will result between the application, driver, and system, however, it represents the most common usage case that will occur.</span></span>

![um diagrama que mostra como as configurações de gerenciamento de cores são processadas](images/local-1992284846-colormanagementtest3.png)

## <a name="related-topics"></a><span data-ttu-id="0d012-190">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="0d012-190">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0d012-191">Especificação de esquema de impressão</span><span class="sxs-lookup"><span data-stu-id="0d012-191">Print Schema Specification</span></span>](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip)
</dt> </dl>

 

 




