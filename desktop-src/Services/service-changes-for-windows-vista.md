---
description: Houve alterações significativas no modelo de serviços para melhorar o desempenho, a confiabilidade, a segurança, o gerenciamento e a administração de serviços.
ms.assetid: b1c09468-51e1-4ffd-bf07-6faa9f9336dd
title: Alterações de serviço do Windows Vista
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e6ba96cc0c69e2bda4e19e7d093098c578e31c4b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103827023"
---
# <a name="service-changes-for-windows-vista"></a><span data-ttu-id="07cd1-103">Alterações de serviço do Windows Vista</span><span class="sxs-lookup"><span data-stu-id="07cd1-103">Service Changes for Windows Vista</span></span>

<span data-ttu-id="07cd1-104">Houve alterações significativas no modelo de serviços para melhorar o desempenho, a confiabilidade, a segurança, o gerenciamento e a administração de serviços.</span><span class="sxs-lookup"><span data-stu-id="07cd1-104">There have been significant changes to the services model to improve performance, reliability, security, management, and administration of services.</span></span>

<span data-ttu-id="07cd1-105">A tabela a seguir resume os aprimoramentos feitos nos serviços do Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="07cd1-105">The following table summarizes the enhancements to services for Windows Vista.</span></span>



| <span data-ttu-id="07cd1-106">Aprimoramento</span><span class="sxs-lookup"><span data-stu-id="07cd1-106">Enhancement</span></span>                                                                                                                                                                                                  | <span data-ttu-id="07cd1-107">Descrição</span><span class="sxs-lookup"><span data-stu-id="07cd1-107">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="07cd1-108"><span id="Delayed_Auto-Start"></span><span id="delayed_auto-start"></span><span id="DELAYED_AUTO-START"></span>Início automático atrasado</span><span class="sxs-lookup"><span data-stu-id="07cd1-108"><span id="Delayed_Auto-Start"></span><span id="delayed_auto-start"></span><span id="DELAYED_AUTO-START"></span>Delayed Auto-Start</span></span><br/>                                                                 | <span data-ttu-id="07cd1-109">Os serviços de início automático atrasados são iniciados logo após o sistema ser iniciado.</span><span class="sxs-lookup"><span data-stu-id="07cd1-109">Delayed auto-start services are started shortly after the system has started.</span></span> <span data-ttu-id="07cd1-110">Isso melhora o desempenho de inicialização do sistema enquanto ainda fornece inicialização automática para esses serviços.</span><span class="sxs-lookup"><span data-stu-id="07cd1-110">This improves system startup performance while still providing automatic startup for these services.</span></span> <span data-ttu-id="07cd1-111">Para definir o sinalizador de início automático atrasado, chame a função [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) com **\_ \_ \_ \_ \_ informações de início automático atrasadas de configuração de serviço**.</span><span class="sxs-lookup"><span data-stu-id="07cd1-111">To set the delayed auto-start flag, call the [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) function with **SERVICE\_CONFIG\_DELAYED\_AUTO\_START\_INFO**.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="07cd1-112"><span id="Failure_Detection_and_Recovery"></span><span id="failure_detection_and_recovery"></span><span id="FAILURE_DETECTION_AND_RECOVERY"></span>Detecção e recuperação de falha</span><span class="sxs-lookup"><span data-stu-id="07cd1-112"><span id="Failure_Detection_and_Recovery"></span><span id="failure_detection_and_recovery"></span><span id="FAILURE_DETECTION_AND_RECOVERY"></span>Failure Detection and Recovery</span></span><br/>                 | <span data-ttu-id="07cd1-113">Se um serviço falhar, o SCM (Gerenciador de controle de serviço) poderá executar uma ação de falha, como reiniciar o serviço em uma tentativa de recuperação dessa falha.</span><span class="sxs-lookup"><span data-stu-id="07cd1-113">If a service fails, the service control manager (SCM) can perform a failure action, such as restarting the service in an attempt to recover from that failure.</span></span> <span data-ttu-id="07cd1-114">Para configurar uma ação de falha, chame [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) com ações de falha de configuração de **serviço \_ \_ \_**.</span><span class="sxs-lookup"><span data-stu-id="07cd1-114">To configure a failure action, call [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) with **SERVICE\_CONFIG\_FAILURE\_ACTIONS**.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="07cd1-115"><span id="Preshutdown_Notifications"></span><span id="preshutdown_notifications"></span><span id="PRESHUTDOWN_NOTIFICATIONS"></span>Notificações de pré-desligamento</span><span class="sxs-lookup"><span data-stu-id="07cd1-115"><span id="Preshutdown_Notifications"></span><span id="preshutdown_notifications"></span><span id="PRESHUTDOWN_NOTIFICATIONS"></span>Preshutdown Notifications</span></span><br/>                                     | <span data-ttu-id="07cd1-116">Um serviço pode se registrar para receber uma notificação de pré-desligamento de **\_ controle \_ de serviço** em sua função [*HandlerEx*](/windows/desktop/api/WinSvc/nc-winsvc-lphandler_function_ex) antes de receber a notificação de desligamento real.</span><span class="sxs-lookup"><span data-stu-id="07cd1-116">A service can register to receive a **SERVICE\_CONTROL\_PRESHUTDOWN** notification in its [*HandlerEx*](/windows/desktop/api/WinSvc/nc-winsvc-lphandler_function_ex) function before it receives the actual shutdown notification.</span></span> <span data-ttu-id="07cd1-117">Isso fornece aos serviços um procedimento de desligamento demorado mais tempo para desligar normalmente.</span><span class="sxs-lookup"><span data-stu-id="07cd1-117">This provides services with a lengthy shutdown procedure more time to shut down gracefully.</span></span> <span data-ttu-id="07cd1-118">Para definir o valor de tempo limite, chame [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) com **\_ \_ \_ informações de pré-desligamento de configuração de serviço**.</span><span class="sxs-lookup"><span data-stu-id="07cd1-118">To set the time-out value, call [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) with **SERVICE\_CONFIG\_PRESHUTDOWN\_INFO**.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="07cd1-119"><span id="Restricted_Network_Access"></span><span id="restricted_network_access"></span><span id="RESTRICTED_NETWORK_ACCESS"></span>Acesso restrito à rede</span><span class="sxs-lookup"><span data-stu-id="07cd1-119"><span id="Restricted_Network_Access"></span><span id="restricted_network_access"></span><span id="RESTRICTED_NETWORK_ACCESS"></span>Restricted Network Access</span></span><br/>                                     | <span data-ttu-id="07cd1-120">Você pode usar os SIDs de serviço para restringir o acesso a portas, protocolos ou a direção do tráfego de rede.</span><span class="sxs-lookup"><span data-stu-id="07cd1-120">You can use service SIDs to restrict access to ports, protocols, or the direction of network traffic.</span></span> <span data-ttu-id="07cd1-121">Para restringir o acesso de um serviço à rede, use a interface [**INetFwServiceRestriction**](/windows/desktop/api/netfw/nn-netfw-inetfwservicerestriction) .</span><span class="sxs-lookup"><span data-stu-id="07cd1-121">To restrict a service's access to the network, use the [**INetFwServiceRestriction**](/windows/desktop/api/netfw/nn-netfw-inetfwservicerestriction) interface.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="07cd1-122"><span id="Running_with_Least_Privilege"></span><span id="running_with_least_privilege"></span><span id="RUNNING_WITH_LEAST_PRIVILEGE"></span>Executando com privilégios mínimos</span><span class="sxs-lookup"><span data-stu-id="07cd1-122"><span id="Running_with_Least_Privilege"></span><span id="running_with_least_privilege"></span><span id="RUNNING_WITH_LEAST_PRIVILEGE"></span>Running with Least Privilege</span></span><br/>                         | <span data-ttu-id="07cd1-123">Os serviços podem ser executados em qualquer conta que contenha os privilégios necessários (LocalService, NetworkService, LocalSystem, uma conta de domínio ou uma conta local) e indique os privilégios necessários chamando [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) com as **\_ \_ \_ \_ informações de privilégios necessários de configuração de serviço**.</span><span class="sxs-lookup"><span data-stu-id="07cd1-123">Services can run under any account that contains the required privileges (LocalService, NetworkService, LocalSystem, a domain account, or a local account) and indicate the required privileges by calling [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) with **SERVICE\_CONFIG\_REQUIRED\_PRIVILEGES\_INFO**.</span></span> <span data-ttu-id="07cd1-124">O SCM remove todos os privilégios que não são necessários.</span><span class="sxs-lookup"><span data-stu-id="07cd1-124">The SCM removes any privileges that are not required.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="07cd1-125"><span id="Service_Isolation"></span><span id="service_isolation"></span><span id="SERVICE_ISOLATION"></span>Isolamento de serviço</span><span class="sxs-lookup"><span data-stu-id="07cd1-125"><span id="Service_Isolation"></span><span id="service_isolation"></span><span id="SERVICE_ISOLATION"></span>Service Isolation</span></span><br/>                                                                     | <span data-ttu-id="07cd1-126">Um serviço pode isolar objetos, como arquivos ou chaves do registro, para seu uso exclusivo, protegendo-os com uma entrada de controle de acesso que contenha um SID de serviço.</span><span class="sxs-lookup"><span data-stu-id="07cd1-126">A service can isolate objects, such as files or registry keys, for its exclusive use by securing them with an access control entry that contains a service SID.</span></span> <span data-ttu-id="07cd1-127">Depois que esse SID tiver sido atribuído a um serviço, o proprietário do serviço poderá modificar as listas de controle de acesso dos objetos para conceder acesso ao SID.</span><span class="sxs-lookup"><span data-stu-id="07cd1-127">After this SID has been assigned to a service, the service owner can modify the objects' access control lists to grant access to the SID.</span></span> <span data-ttu-id="07cd1-128">Isso permite que um serviço acesse objetos específicos sem executar uma conta de alto privilégio ou reduzir a segurança nos objetos.</span><span class="sxs-lookup"><span data-stu-id="07cd1-128">This enables a service to access specific objects without running under a high-privilege account or lowering the security on the objects.</span></span> <span data-ttu-id="07cd1-129">Para definir o SID do serviço, chame [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) com as informações de SID do serviço de configuração de **serviço \_ \_ \_ \_**.</span><span class="sxs-lookup"><span data-stu-id="07cd1-129">To set the service SID, call [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) with **SERVICE\_CONFIG\_SERVICE\_SID\_INFO**.</span></span><br/>                                                                                                                                                                                                                                     |
| <span data-ttu-id="07cd1-130"><span id="Service_State_Change_Notifications"></span><span id="service_state_change_notifications"></span><span id="SERVICE_STATE_CHANGE_NOTIFICATIONS"></span>Notificações de alteração de estado do serviço</span><span class="sxs-lookup"><span data-stu-id="07cd1-130"><span id="Service_State_Change_Notifications"></span><span id="service_state_change_notifications"></span><span id="SERVICE_STATE_CHANGE_NOTIFICATIONS"></span>Service State Change Notifications</span></span><br/> | <span data-ttu-id="07cd1-131">Os serviços podem se registrar para serem notificados quando um serviço é criado, excluído ou tem uma alteração no status usando a função [**NotifyServiceStatusChange**](/windows/desktop/api/Winsvc/nf-winsvc-notifyservicestatuschangea) .</span><span class="sxs-lookup"><span data-stu-id="07cd1-131">Services can register to be notified when a service is created, deleted, or has a change in status by using the [**NotifyServiceStatusChange**](/windows/desktop/api/Winsvc/nf-winsvc-notifyservicestatuschangea) function.</span></span> <span data-ttu-id="07cd1-132">Isso é mais eficiente do que chamar a função [**QueryServiceStatusEx**](/windows/desktop/api/Winsvc/nf-winsvc-queryservicestatusex) em um loop para sondar o status.</span><span class="sxs-lookup"><span data-stu-id="07cd1-132">This is more efficient than calling the [**QueryServiceStatusEx**](/windows/desktop/api/Winsvc/nf-winsvc-queryservicestatusex) function in a loop to poll for status.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <span data-ttu-id="07cd1-133"><span id="Session_0_Isolation"></span><span id="session_0_isolation"></span><span id="SESSION_0_ISOLATION"></span>Isolamento da sessão 0</span><span class="sxs-lookup"><span data-stu-id="07cd1-133"><span id="Session_0_Isolation"></span><span id="session_0_isolation"></span><span id="SESSION_0_ISOLATION"></span>Session 0 Isolation</span></span><br/>                                                             | <span data-ttu-id="07cd1-134">Os serviços sempre foram executados na sessão 0.</span><span class="sxs-lookup"><span data-stu-id="07cd1-134">Services have always run in session 0.</span></span> <span data-ttu-id="07cd1-135">Antes do Windows Vista, o primeiro usuário a fazer logon também foi atribuído à sessão 0.</span><span class="sxs-lookup"><span data-stu-id="07cd1-135">Before Windows Vista, the first user to log on was also assigned to session 0.</span></span> <span data-ttu-id="07cd1-136">Agora, a sessão 0 é reservada exclusivamente para serviços e outros aplicativos não associados a uma sessão de usuário interativa.</span><span class="sxs-lookup"><span data-stu-id="07cd1-136">Now, session 0 is reserved exclusively for services and other applications not associated with an interactive user session.</span></span> <span data-ttu-id="07cd1-137">(O primeiro usuário a fazer logon está conectado à sessão 1, o segundo usuário a fazer logon está conectado à sessão 2 e assim por diante.) A sessão 0 não oferece suporte a processos que interagem com o usuário.</span><span class="sxs-lookup"><span data-stu-id="07cd1-137">(The first user to log on is connected to session 1, the second user to log on is connected to session 2, and so on.) Session 0 does not support processes that interact with the user.</span></span><br/> <span data-ttu-id="07cd1-138">Essa alteração significa que um serviço não pode postar ou enviar uma mensagem para um aplicativo e um aplicativo não pode enviar ou postar uma mensagem para um serviço.</span><span class="sxs-lookup"><span data-stu-id="07cd1-138">This change means that a service cannot post or send a message to an application and an application cannot send or post a message to a service.</span></span> <span data-ttu-id="07cd1-139">Além disso, os serviços não podem exibir um item de interface do usuário, como uma caixa de diálogo diretamente.</span><span class="sxs-lookup"><span data-stu-id="07cd1-139">In addition, services cannot display a user interface item such as a dialog box directly.</span></span> <span data-ttu-id="07cd1-140">Um serviço pode usar a função [**WTSSendMessage**](/windows/desktop/api/wtsapi32/nf-wtsapi32-wtssendmessagea) para exibir uma caixa de diálogo em outra sessão.</span><span class="sxs-lookup"><span data-stu-id="07cd1-140">A service can use the [**WTSSendMessage**](/windows/desktop/api/wtsapi32/nf-wtsapi32-wtssendmessagea) function to display a dialog box in another session.</span></span><br/> |



 

## <a name="related-topics"></a><span data-ttu-id="07cd1-141">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="07cd1-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="07cd1-142">Serviços</span><span class="sxs-lookup"><span data-stu-id="07cd1-142">Services</span></span>](services.md)
</dt> </dl>

 

