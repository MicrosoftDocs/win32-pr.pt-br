---
description: Saiba mais sobre como proteger os serviços de modo de usuário do anti-malware (AM) e como você pode optar por incluir esse recurso em seu serviço de anti-malware.
ms.assetid: 88875a0d-9027-43f2-8411-34f9ff428fe5
title: Protegendo serviços Antimalware
ms.topic: article
ms.date: 08/02/2018
ms.openlocfilehash: 5e7783eb307381d368900332b5e761ad62785913
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104011711"
---
# <a name="protecting-anti-malware-services"></a>Protegendo serviços Antimalware

Windows 8.1 introduziu um novo conceito de serviços protegidos para proteger os serviços Antimalware, que são um alvo frequente de ataque por malware.

Saiba mais sobre como proteger os serviços de modo de usuário do anti-malware (AM) e como você pode optar por incluir esse recurso em seu serviço de anti-malware.

Essas informações se aplicam aos seguintes sistemas operacionais e aos seus sucessores:

-   Windows 8.1
-   Windows Server 2012 R2

As referências e os recursos discutidos aqui são listados no final deste tópico.

## <a name="introduction"></a>Introdução

A maioria das soluções Antimalware inclui um serviço de modo de usuário que executa operações especializadas para detectar e remover malware do sistema. Esse serviço de modo de usuário também é freqüentemente responsável por baixar as definições de vírus e assinaturas mais recentes. Esse serviço de modo de usuário se torna um destino frequente de malware porque é o ponto único de falha ao desabilitar a proteção em um sistema. Para se defender contra ataques no serviço de modo de usuário, os fornecedores de anti-malware precisam adicionar muita funcionalidade e heurística ao software. No entanto, essas técnicas não são totalmente infalívels e tendem a ser propensas a erros, pois precisam identificar a funcionalidade que o Windows realiza em seu serviço e habilitar seletivamente essa funcionalidade.

No Windows 8.1, um novo conceito de serviço protegido foi introduzido para permitir que os serviços de modo de usuário Antimalware sejam iniciados como um serviço protegido. Depois que o serviço é iniciado como protegido, o Windows usa a integridade do código para permitir que apenas o código confiável seja carregado no serviço protegido. O Windows também protege esses processos contra injeção de código e outros ataques de processos administrativos.

Este documento descreve como um fornecedor anti-malware com um driver ELAM (AntiMalware de início antecipado) pode aceitar esse recurso e iniciar seu serviço Antimalware como um serviço protegido.

## <a name="system-protected-process"></a>Processo protegido pelo sistema

A partir do Windows 8.1, um novo modelo de segurança foi implementado no kernel para se defender melhor contra ataques mal-intencionados em componentes críticos do sistema. Esse novo modelo de segurança estende as versões anteriores da infraestrutura de processo protegida do Windows usadas para cenários específicos, como a execução de conteúdo DRM, em um modelo de finalidade geral que pode ser usado por fornecedores antimalware de terceiros. A infraestrutura de processo protegida só permite que código confiável e assinado carregue e tenha defesa interna contra ataques de injeção de código.

Consulte [processos protegidos no Windows Vista](https://download.microsoft.com/download/a/f/7/af7777e5-7dcd-4800-8a0a-b18336565f5b/process_vista.doc) para obter mais informações sobre processos protegidos.

O novo modelo de segurança usa uma variante ligeiramente diferente da infraestrutura do processo de proteção chamada processo protegido pelo sistema, que é mais adequada para esse recurso, pois isso mantém o conteúdo do DRM separado. Cada processo protegido pelo sistema tem um nível ou atributo associado, que indica a diretiva de assinatura do código assinado com permissão para carregar dentro do processo. Depois que os serviços Antimalware tiverem optado no modo de serviço protegido, somente código assinado do Windows ou código assinado com os certificados do fornecedor Antimalware poderão ser carregados nesse processo. Da mesma forma, outros níveis de processo protegidos têm políticas de código diferentes impostas pelo Windows.

## <a name="requirements"></a>Requisitos

Para que um serviço de modo de usuário Antimalware seja executado como um serviço protegido, o fornecedor de anti-malware deve ter um driver ELAM instalado no computador com Windows. Além dos requisitos de certificação do driver ELAM existentes, o driver deve ter uma seção de recurso inserido que contém as informações dos certificados usados para assinar os binários do serviço de modo de usuário.

> [!IMPORTANT]
> Em Windows 8.1, a cadeia de certificação deve ser uma raiz conhecida, conforme determinado pela verificação do driver, ou o certificado raiz deve ser incluído.

 

Durante o processo de inicialização, esta seção de recurso será extraída do driver ELAM para validar as informações do certificado e registrar o serviço antimalware. O serviço Antimalware também pode ser registrado durante o processo de instalação do software antimalware chamando uma API especial, conforme descrito posteriormente neste documento.

Depois que a seção de recursos for extraída com êxito do driver ELAM e o serviço de modo de usuário estiver registrado, o serviço poderá ser iniciado como um serviço protegido. Depois que o serviço for iniciado como protegido, outros processos não protegidos no sistema não poderão injetar threads e eles não poderão gravar na memória virtual do processo protegido.

Além disso, todas as DLLs não Windows que são carregadas no processo protegido devem ser assinadas com um certificado apropriado.

Consulte [antimalware de início antecipado](/windows/desktop/w8cookbook/secured-boot) para obter mais informações sobre drivers Elam.

### <a name="anti-malware-service-signing-requirements"></a>Requisitos de assinatura de serviço anti-malware

O serviço de modo de usuário que precisa ser iniciado como protegido deve ser assinado com certificados válidos. O serviço EXE deve ser assinado por hash de página e todas as DLLs não Windows que são carregadas no serviço também devem ser assinadas com os mesmos certificados. O hash desses certificados deve ser adicionado ao arquivo de recurso, que será vinculado ao driver ELAM.

> [!Note]  
> Os hashes de arquivo/página SHA256 devem ser usados, embora os certificados possam continuar a ser SHA1.

 

### <a name="primary-signature-recommended"></a>Assinatura principal (recomendada)

Recomendamos que os fornecedores Antimalware usem seu certificado Authenticode existente para assinar seus binários de serviço anti-malware e que o hash desse certificado Authenticode seja incluído na seção de recursos para indicar o certificado usado para assinar os binários de serviço. Se você atualizar esse certificado, uma versão mais recente do driver ELAM deverá ser lançada com os hashes de certificado atualizados.

### <a name="secondary-signature-optional"></a>Assinatura secundária (opcional)

Os fornecedores Antimalware têm a opção de configurar uma AC privada e usar certificados dessa autoridade de certificação para assinar códigos binários de serviço anti-malware como uma assinatura secundária. A principal vantagem de usar a autoridade de certificação privada é que ela permite que os fornecedores criem certificados com uma propriedade EKU especializada, que pode ser usada para diferenciar entre vários produtos do mesmo fornecedor. Ele também reduz a necessidade de atualizar o driver ELAM devido à expiração do certificado, pois os certificados da autoridade de certificação privada normalmente têm datas de expiração mais longas.

Observe que, se os binários de serviço forem assinados com os certificados de autoridade de certificação privada, os binários também deverão ser assinados duplos com o certificado Authenticode existente. Se os binários não forem assinados por uma autoridade de certificação confiável conhecida (por exemplo, VeriSign), o usuário do computador não terá confiança nos binários porque eles não podem confiar na autoridade de certificação privada. A assinatura dupla dos binários com o certificado Authenticode existente também permite que os binários sejam executados em sistemas operacionais de nível inferior.

Para obter mais informações sobre como configurar e instalar a autoridade de certificação, consulte [Configurando uma autoridade](/previous-versions/windows/desktop/ms755466(v=vs.85)) de certificação e [instalar a autoridade](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj125375(v=ws.11)).

> [!Note]  
> Para compatibilidade com o Windows Vista ou o Windows XP (ou o Windows 7 sem o patch SHA2), você pode usar a opção "/as" ao assinar seus binários com [SignTool.exe](/windows/desktop/SecCrypto/signtool) com os hashes de arquivo/página SHA256. Isso adicionará a assinatura como uma assinatura secundária ao arquivo. O SHA1 assinar o arquivo primeiro, pois o Windows XP, o Windows Vista e o Windows 7 verão apenas a primeira assinatura.

 

### <a name="dll-signing-requirements"></a>Requisitos de assinatura de DLL

Como mencionado anteriormente, todas as DLLs não Windows que são carregadas no serviço protegido devem ser assinadas com o mesmo certificado usado para assinar o serviço antimalware.

### <a name="catalog-signing"></a>Assinatura de catálogo

Os fornecedores de anti-malware podem incluir pacotes desenvolvidos por outras empresas sem Atualizar as assinaturas binárias. Isso pode ser obtido com a inclusão de binários em um catálogo que é assinado com seu certificado Authenticode, realizado seguindo estas etapas:

1. Gerar um catálogo usando [MakeCat](/windows/desktop/SecCrypto/makecat)
2. Adicionar todos os binários sem uma assinatura apropriada ao catálogo
3. Assinar o catálogo com o certificado Authenticode, como você faria com qualquer outro binário
4. Use a função [Adicionar Catálogo](/windows/desktop/api/Mscat/nf-mscat-cryptcatadminaddcatalog) para incluir o catálogo com o aplicativo.

Quando a integridade de código entra nos pacotes sem uma assinatura apropriada, ela pesquisará um catálogo com uma assinatura aprovada. Ele encontrará esse catálogo, contanto que essas etapas sejam seguidas e instaladas com o aplicativo.


## <a name="resource-file-info"></a>Informações do arquivo de recurso

Um arquivo de recurso deve ser criado e vinculado ao driver ELAM. O hash do certificado, juntamente com outras informações de certificado, deve ser adicionado no arquivo de recurso.

A seção de recursos deve estar no layout a seguir para o sistema para extrair com êxito os recursos da imagem binária e validar as informações do certificado inserido.

``` syntax
MicrosoftElamCertificateInfo  MSElamCertInfoID
{
      3, // count of entries
      L”CertHash1\0”,
      Algorithm,
      L”EKU1\0”,
      L”CertHash2\0”,
      Algorithm,
      L”\0”, //No EKU for cert hash 2
      L”CertHash3\0”,
      Algorithm,
      L”EKU3a;EKU3b;EKU3c\0”,  //multiple EKU entries supported (max: 3)
}
```

Para obter mais informações sobre o arquivo de recursos definido pelo usuário, consulte [recurso definido pelo usuário](/windows/desktop/menurc/user-defined-resource).

### <a name="certhash"></a>CertHash

O hash do certificado que é usado para assinar o serviço anti-malware. A ferramenta de CertMgr.exe, que é fornecida na SDK do Windows, pode ser usada para obter o hash.

``` syntax
certmgr.exe –v <path to the signed file>
```

Por exemplo:

![hash de certificado de serviço protegido por anti-malware (certhash)](images/cert-hash-example.png)

### <a name="algorithm"></a>Algoritmo

O valor do algoritmo representa o algoritmo do certificado. Esses valores de algoritmo têm suporte:

<dl> 0x8004 – SHA1  
0x800C – SHA256  
0X800d – SHA384  
0x800e – SHA512  
</dl>

Lembre-se de incluir o valor do algoritmo (como mostrado acima) e não o nome real do algoritmo. Por exemplo, se o certificado for baseado no algoritmo SHA256, inclua 0x800C na seção de recursos.

### <a name="eku"></a>EKU

O objeto EKU representa uma única propriedade EKU (uso estendido de chave) de um certificado. Isso é opcional e " \\ 0" deve ser especificado se nenhum EKUs estiver associado ao certificado. Em um caso em que há vários produtos e serviços de um único fornecedor de antimalware em execução no mesmo sistema, o fornecedor de anti-malware pode usar a propriedade EKU do certificado de autoridade de certificação privada para diferenciar um serviço de outro. Por exemplo, se houver dois serviços em execução no sistema do mesmo fornecedor antimalware e assinados pela mesma AC, o serviço que precisa ser iniciado como protegido pode ser assinado com um certificado emitido pela AC que contém um EKU especial. Esse EKU deve ser adicionado à seção de recursos. O EKU é então registrado pelo sistema e emparelhado com o hash de certificado para validar e iniciar o serviço como protegido.

Observe que a cadeia de certificados deve incluir o 1.3.6.1.5.5.7.3.3 (EKU de assinatura de código), mas esse EKU não deve ser incluído na seção de recursos do driver ELAM.

> [!Note]  
> Se as informações EKU estiverem incluídas nas informações de certificado para o driver ELAM, o mesmo EKU deverá ser usado ao assinar seus binários.

 

### <a name="count"></a>Contagem

Se o binário do serviço anti-malware for assinado com o certificado Authenticode, bem como o certificado de autoridade de certificação privada, somente as informações de certificado da autoridade de certificação privada deverão ser adicionadas na seção recurso.

## <a name="launching-anti-malware-services-as-protected"></a>Iniciando serviços Antimalware como protegidos

### <a name="registering-the-service"></a>Registrando o serviço

O serviço anti-malware deve ser registrado no sistema antes que possa ser iniciado como protegido. Durante a instalação do software antimalware, o instalador pode instalar o driver ELAM e reinicializar o sistema para registrar o serviço automaticamente. O sistema registrará o serviço no momento da inicialização, extraindo as informações do certificado do arquivo de recursos mencionado anteriormente que está vinculado ao driver ELAM.

Durante a fase de instalação, é altamente recomendável que o sistema seja reiniciado para que o driver ELAM seja carregado e valide o estado do sistema. No entanto, para casos em que uma reinicialização deve ser evitada, o Windows também expõe um mecanismo para o instalador anti-malware registrar o serviço como protegido usando uma API.

### <a name="registering-the-service-without-rebooting-the-system"></a>Registrando o serviço sem reinicializar o sistema

Durante a instalação, um instalador de software antimalware pode chamar a API [**InstallELAMCertificateInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-installelamcertificateinfo) e fornecer um identificador para o arquivo de driver Elam. O sistema abre o driver ELAM, chama rotinas internas para verificar se o driver ELAM está assinado corretamente e extrai as informações do certificado da seção de recursos associada ao driver ELAM. Para obter a sintaxe de função, consulte [**InstallELAMCertificateInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-installelamcertificateinfo).

Exemplo de código:


```C++
HANDLE FileHandle = NULL;

FileHandle = CreateFile(<Insert Elam driver file name>,
                        FILE_READ_DATA,
                        FILE_SHARE_READ,
                        NULL,
                        OPEN_EXISTING,
                        FILE_ATTRIBUTE_NORMAL,
                        NULL
                        );

if (InstallElamCertificateInfo(FileHandle) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}
```



### <a name="starting-the-service-as-protected"></a>Iniciando o serviço como protegido

O instalador pode seguir estas etapas para criar, configurar e iniciar o serviço como protegido:

1.  Chame a API [**CreateService**](/windows/desktop/api/Winsvc/nf-winsvc-createservicea) para criar um objeto de serviço e adicioná-lo ao banco de dados SCM (Gerenciador de controle de serviço).
2.  Chame a API [**SetServiceObjectSecurity**](/windows/desktop/api/winsvc/nf-winsvc-setserviceobjectsecurity) para definir o descritor de segurança do objeto de serviço criado na etapa 1.
3.  Chame a API [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) para marcar o serviço como protegido, especificando o novo valor de enumeração protegida de inicialização de configuração de **serviço \_ \_ \_** , que foi adicionado em Winsvc. h (a partir de Windows 8.1).

    Exemplo de código:

    ```C++
    SERVICE_LAUNCH_PROTECTED_INFO Info;
    SC_HANDLE hService;

    Info.dwLaunchProtected = SERVICE_LAUNCH_PROTECTED_ANTIMALWARE_LIGHT;

    hService = CreateService (/* ... */);

    if (ChangeServiceConfig2(hService,
                             SERVICE_CONFIG_LAUNCH_PROTECTED,
                             &Info) == FALSE)
    {
        Result = GetLastError();
    }
    ```

    

4.  Chame a API [**StartService**](/windows/desktop/api/Winsvc/nf-winsvc-startservicea) para iniciar o serviço. Ao iniciar o serviço como protegido, o SCM verifica o subsistema de integridade de código (CI) para validar as informações do certificado. Depois que as informações do certificado forem validadas pelo CI, o SCM iniciará o serviço como protegido.
    1.  Observe que essa etapa falhará se você não tiver registrado o serviço chamando a API [**InstallELAMCertificateInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-installelamcertificateinfo) .
    2.  Se o serviço tiver sido configurado para iniciar automaticamente durante a fase de inicialização do sistema, você poderá evitar essa etapa e simplesmente reinicializar o sistema. Durante uma reinicialização, o sistema registrará automaticamente o serviço (se o driver ELAM for iniciado com êxito) e iniciará o serviço no modo protegido.

### <a name="launching-a-child-process-as-protected"></a>Iniciando um processo filho como protegido

O novo modelo de segurança também permite que os serviços protegidos por anti-malware iniciem processos filhos como protegidos. Esses processos filho serão executados no mesmo nível de proteção que o serviço pai e seus binários devem ser assinados com o mesmo certificado registrado por meio da seção de recursos ELAM.

Para permitir que o serviço protegido por anti-malware inicie o processo filho como protegido, uma nova chave de atributo estendida **, \_ \_ nível de \_ proteção \_ de atributo de thread proc**, foi exposta e deve ser usada com a API [**UpdateProcThreadAttribute**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute) . Um ponteiro para o valor de atributo **do \_ nível \_ de proteção igual** deve ser passado para a API **UpdateProcThreadAttribute** .

Observações:

-   Para usar esse novo atributo, o serviço também deve especificar **criar \_ \_ processo protegido** no parâmetro de sinalizadores de criação de processo da chamada [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) .
-   Você precisa ter seus binários de serviço assinados usando a opção/AC para incluir o certificado cruzado para enchainá-lo para uma autoridade de certificação conhecida. O certificado autoassinado sem o encadeamento adequado para uma autoridade de certificação raiz conhecida não funcionará.

Exemplo de código:


```C++
DWORD ProtectionLevel = PROTECTION_LEVEL_SAME;
SIZE_T AttributeListSize;

STARTUPINFOEXW StartupInfoEx = { 0 };

StartupInfoEx.StartupInfo.cb = sizeof(StartupInfoEx);

if (InitializeProcThreadAttributeList(NULL,
                                      1,
                                      0,
                                      &AttributeListSize) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}

StartupInfoEx.lpAttributeList = (LPPROC_THREAD_ATTRIBUTE_LIST) HeapAlloc(
    GetProcessHeap(),
    0,
    AttributeListSize
    );

if (InitializeProcThreadAttributeList(StartupInfoEx.lpAttributeList,
                                      1,
                                      0,
                                      &AttributeListSize) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}

if (UpdateProcThreadAttribute(StartupInfoEx.lpAttributeList,
                              0,
                              PROC_THREAD_ATTRIBUTE_PROTECTION_LEVEL,
                              &ProtectionLevel,
                              sizeof(ProtectionLevel),
                              NULL,
                              NULL) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}

PROCESS_INFORMATION ProcessInformation = { 0 };

if (CreateProcessW(ApplicationName,
                   CommandLine,
                   ProcessAttributes,
                   ThreadAttributes,
                   InheritHandles,
                   EXTENDED_STARTUPINFO_PRESENT | CREATE_PROTECTED_PROCESS,
                   Environment,
                   CurrentDirectory,
                   (LPSTARTUPINFOW)&StartupInfoEx,
                   &ProcessInformation) == FALSE)
{
    Result = GetLastError();
    goto exitFunc;
}
```



## <a name="updates-and-servicing"></a>Atualizações e serviços

Depois que o serviço Antimalware for iniciado como protegido, outros processos não protegidos (e até mesmo administradores) não poderão interromper o serviço. No caso de atualizações para os binários de serviço, o serviço Antimalware precisa receber um retorno de chamada do instalador para parar a si mesmo para que possa ser atendido. Depois que o serviço for interrompido, o instalador Antimalware poderá executar atualizações e, em seguida, seguir as etapas descritas acima no [registro do](https://www.bing.com/search?q=Registering+the+service) serviço e no [início do serviço como seções protegidas](#starting-the-service-as-protected) para registrar o certificado e iniciar o serviço como protegido.

Observe que o serviço deve garantir que somente chamadores confiáveis possam parar o serviço. Permitir que chamadores não confiáveis façam isso anula a finalidade de proteger o serviço.

### <a name="unregistering-the-service"></a>Cancelando o registro do serviço

Quando você desinstala um serviço protegido, o serviço deve se marcar como desprotegido chamando a API [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) . Observe que, como o sistema não permite que nenhum processo não protegido altere a configuração de um serviço protegido, a chamada para [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) deve ser feita pelo próprio serviço protegido. Depois que o serviço foi reconfigurado para ser executado como desprotegido, o desinstalador pode simplesmente tomar as medidas apropriadas para remover o software antimalware do sistema.

## <a name="debugging-an-anti-malware-protected-service"></a>Depurando um serviço protegido por anti-malware

Como parte do modelo de segurança do processo protegido, outros processos não protegidos não são capazes de injetar threads ou gravar na memória virtual do processo protegido. No entanto, um KD (depurador de kernel) é permitido para depuração de qualquer processo protegido por anti-malware. O KD também pode ser usado para verificar se o serviço Antimalware está sendo executado como protegido ou não:

``` syntax
dt –r1 nt!_EPROCESS <Process Address>
+0x67a Protection       : _PS_PROTECTION
      +0x000 Level            : 0x31 '1'
      +0x000 Type             : 0y0001
      +0x000 Signer           : 0y0011
```

Se o valor do membro do *tipo* for 0y0001, o serviço será executado como protegido.

Além disso, somente os comandos SC a seguir são permitidos no serviço protegido por anti-malware:

-   `sc config start=Auto`
-   `sc qc`
-   `sc start`
-   `sc interrogate`
-   `sc sdshow`

Se o depurador estiver anexado, use o seguinte sinalizador no registro para interromper o depurador quando os binários não assinados (ou assinados de forma inadequada) forem carregados no serviço protegido antimalware.

``` syntax
Key:   HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\CI
Value: DebugFlags      REG_DWORD
```

Defina o valor como **00000400** para interromper no depurador quando a validação da assinatura falhar.

> [!Note]  
> Limitações de processos protegidos:
>
> 1.  Processos que têm interface do usuário ou uma GUI não podem ser protegidos devido à maneira como o kernel bloqueia um processo na memória e não permite gravações nele.
> 2.  Antes do Windows 10, versão 1703 (a atualização para criadores), processos protegidos não podem usar os protocolos de comunicação TLS ou SSL devido a limitações de compartilhamento de certificado entre a LSA (autoridade de segurança local) e um processo protegido.

 

## <a name="resources"></a>Recursos

Para saber mais, veja:

-   [Antimalware de início antecipado](/windows/desktop/w8cookbook/secured-boot)
-   [Processos protegidos no Windows Vista](/previous-versions/windows/hardware/download/dn550976(v=vs.85))
-   [Configurando uma autoridade de certificação](/previous-versions/windows/desktop/ms755466(v=vs.85))
-   [Instalar a autoridade de certificação](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj125375(v=ws.11))
-   [Recurso definido pelo usuário](/windows/desktop/menurc/user-defined-resource)

Essas funções da API do Windows são referenciadas neste artigo:

-   [**ChangeServiceConfig2**](/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a)
-   [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa)
-   [**CreateService**](/windows/desktop/api/Winsvc/nf-winsvc-createservicea)
-   [**InitializeProcThreadAttributeList**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-initializeprocthreadattributelist)
-   [**InstallELAMCertificateInfo**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-installelamcertificateinfo)
-   [**SetServiceObjectSecurity**](/windows/desktop/api/winsvc/nf-winsvc-setserviceobjectsecurity)
-   [**StartService**](/windows/desktop/api/Winsvc/nf-winsvc-startservicea)
-   [**UpdateProcThreadAttribute**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-updateprocthreadattribute)

 

 
