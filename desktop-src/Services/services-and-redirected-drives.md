---
description: Um serviço (ou qualquer processo em execução em um contexto de segurança diferente) que deve acessar um recurso remoto deve usar o nome UNC (Convenção de nomenclatura universal) para acessar o recurso.
ms.assetid: 2582259d-077c-4089-9a87-1a377994f0bd
title: Serviços e unidades redirecionadas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a3b1435e69ded3bf13a0869a0b9ad2b90bb4682c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103922609"
---
# <a name="services-and-redirected-drives"></a><span data-ttu-id="52e0e-103">Serviços e unidades redirecionadas</span><span class="sxs-lookup"><span data-stu-id="52e0e-103">Services and Redirected Drives</span></span>

<span data-ttu-id="52e0e-104">Um serviço (ou qualquer processo em execução em um contexto de segurança diferente) que deve acessar um recurso remoto deve usar o nome UNC (Convenção de nomenclatura universal) para acessar o recurso.</span><span class="sxs-lookup"><span data-stu-id="52e0e-104">A service (or any process running in a different security context) that must access a remote resource should use the Universal Naming Convention (UNC) name to access the resource.</span></span> <span data-ttu-id="52e0e-105">O serviço deve ter os privilégios apropriados para acessar o recurso.</span><span class="sxs-lookup"><span data-stu-id="52e0e-105">The service must have appropriate privileges to access the resource.</span></span> <span data-ttu-id="52e0e-106">Se um serviço do lado do servidor usar uma conexão RPC, a delegação deverá ser habilitada no servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="52e0e-106">If a server-side service uses an RPC connection, delegation must be enabled on the remote server.</span></span>

<span data-ttu-id="52e0e-107">As letras das unidades não são globais para o sistema.</span><span class="sxs-lookup"><span data-stu-id="52e0e-107">Drive letters are not global to the system.</span></span> <span data-ttu-id="52e0e-108">Cada sessão de logon recebe seu próprio conjunto de letras de unidade de A a Z. Portanto, as unidades redirecionadas não podem ser compartilhadas entre processos em execução em contas de usuário diferentes.</span><span class="sxs-lookup"><span data-stu-id="52e0e-108">Each logon session receives its own set of drive letters from A to Z. Therefore, redirected drives cannot be shared between processes running under different user accounts.</span></span> <span data-ttu-id="52e0e-109">Além disso, um serviço (ou qualquer processo em execução em sua própria sessão de logon) não pode acessar as letras da unidade que foram estabelecidas em uma sessão de logon diferente.</span><span class="sxs-lookup"><span data-stu-id="52e0e-109">Moreover, a service (or any process running within its own logon session) cannot access the drive letters that were established within a different logon session.</span></span>

<span data-ttu-id="52e0e-110">Um serviço não deve acessar diretamente os recursos locais ou de rede por meio de letras de unidade mapeadas, nem chamar o comando **net use** para mapear letras de unidade em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="52e0e-110">A service should not directly access local or network resources through mapped drive letters, nor should it call the **net use** command to map drive letters at run time.</span></span> <span data-ttu-id="52e0e-111">O comando **net use** não é recomendado por vários motivos:</span><span class="sxs-lookup"><span data-stu-id="52e0e-111">The **net use** command is not recommended for several reasons:</span></span>

-   <span data-ttu-id="52e0e-112">Os mapeamentos de unidade existem em contextos de logon. portanto, se um aplicativo estiver sendo executado no contexto da [conta LocalService](localservice-account.md), qualquer outro serviço em execução nesse contexto poderá ter acesso à unidade mapeada.</span><span class="sxs-lookup"><span data-stu-id="52e0e-112">Drive mappings exist across logon contexts, so if an application is running in the context of the [LocalService account](localservice-account.md), then any other service running in that context may have access to the mapped drive.</span></span>
-   <span data-ttu-id="52e0e-113">Se o serviço fornecer credenciais explícitas para um comando **net use** , essas credenciais poderão ser compartilhadas inadvertidamente fora dos limites de serviço.</span><span class="sxs-lookup"><span data-stu-id="52e0e-113">If the service provides explicit credentials to a **net use** command, those credentials might be inadvertently shared outside of the service boundaries.</span></span> <span data-ttu-id="52e0e-114">Em vez disso, o serviço deve usar a [representação do cliente](/windows/desktop/SecAuthZ/client-impersonation) para representar o usuário.</span><span class="sxs-lookup"><span data-stu-id="52e0e-114">Instead, the service should use [client impersonation](/windows/desktop/SecAuthZ/client-impersonation) to impersonate the user.</span></span>
-   <span data-ttu-id="52e0e-115">Vários serviços em execução no mesmo contexto podem interferir entre si.</span><span class="sxs-lookup"><span data-stu-id="52e0e-115">Multiple services running in the same context may interfere with each other.</span></span> <span data-ttu-id="52e0e-116">Se ambos os serviços executarem um **uso líquido** explícito e fornecerem as mesmas credenciais ao mesmo tempo, um serviço falhará com um erro "já conectado".</span><span class="sxs-lookup"><span data-stu-id="52e0e-116">If both services perform an explicit **net use** and provide the same credentials at the same time, one service will fail with an "already connected" error.</span></span>

<span data-ttu-id="52e0e-117">Além disso, um serviço não deve usar as [funções de rede do Windows](/windows/desktop/WNet/windows-networking-functions) para gerenciar as letras de unidade mapeadas.</span><span class="sxs-lookup"><span data-stu-id="52e0e-117">Additionally, a service should not use the [Windows Networking Functions](/windows/desktop/WNet/windows-networking-functions) to manage mapped drive letters.</span></span> <span data-ttu-id="52e0e-118">Embora as funções WNet possam retornar com êxito, o comportamento resultante não é o esperado.</span><span class="sxs-lookup"><span data-stu-id="52e0e-118">Although the WNet functions may return successfully, the resulting behavior is not as intended.</span></span> <span data-ttu-id="52e0e-119">Quando o sistema estabelece uma unidade redirecionada, ele é armazenado em uma base por usuário.</span><span class="sxs-lookup"><span data-stu-id="52e0e-119">When the system establishes a redirected drive, it is stored on a per-user basis.</span></span> <span data-ttu-id="52e0e-120">Somente o usuário é capaz de gerenciar a unidade redirecionada.</span><span class="sxs-lookup"><span data-stu-id="52e0e-120">Only the user is able to manage the redirected drive.</span></span> <span data-ttu-id="52e0e-121">O sistema mantém o controle de unidades redirecionadas com base no SID (identificador de segurança) de logon do usuário.</span><span class="sxs-lookup"><span data-stu-id="52e0e-121">The system keeps track of redirected drives based on the user's logon security identifier (SID).</span></span> <span data-ttu-id="52e0e-122">O SID de logon é um identificador exclusivo para a sessão de logon do usuário.</span><span class="sxs-lookup"><span data-stu-id="52e0e-122">The logon SID is a unique identifier for the user's logon session.</span></span> <span data-ttu-id="52e0e-123">Um único usuário pode ter várias sessões de logon simultâneas no sistema.</span><span class="sxs-lookup"><span data-stu-id="52e0e-123">A single user can have multiple, simultaneous logon sessions on the system.</span></span>

<span data-ttu-id="52e0e-124">Se um serviço estiver configurado para ser executado em uma conta de usuário, o sistema sempre criará uma nova sessão de logon para o usuário e iniciará o serviço nessa nova sessão de logon.</span><span class="sxs-lookup"><span data-stu-id="52e0e-124">If a service is configured to run under a user account, the system always creates a new logon session for the user and starts the service in that new logon session.</span></span> <span data-ttu-id="52e0e-125">Portanto, um serviço não pode gerenciar os mapeamentos de unidade estabelecidos nas outras sessões do usuário.</span><span class="sxs-lookup"><span data-stu-id="52e0e-125">Therefore, a service cannot manage the drive mappings established within the user's other sessions.</span></span>

<span data-ttu-id="52e0e-126">**Windows Server 2003:** Em um computador que tem várias interfaces de rede (ou seja, um computador de hospedagem múltipla), os atrasos de até 60 segundos podem ocorrer ao usar caminhos UNC para acessar arquivos armazenados em um servidor remoto de protocolo SMB.</span><span class="sxs-lookup"><span data-stu-id="52e0e-126">**Windows Server 2003:** On a computer that has multiple network interfaces (that is, a multihomed computer), delays up to 60 seconds may occur when using UNC paths to access files that are stored on a remote server message block (SMB) server.</span></span> <span data-ttu-id="52e0e-127">Para obter mais informações, consulte o [artigo 890553](https://support.microsoft.com/kb/890553) na base de dados de conhecimento de ajuda e suporte.</span><span class="sxs-lookup"><span data-stu-id="52e0e-127">For more information, see [article 890553](https://support.microsoft.com/kb/890553) in the Help and Support Knowledge Base.</span></span>

 

 
