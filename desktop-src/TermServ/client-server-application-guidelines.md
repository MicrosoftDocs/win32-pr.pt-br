---
title: Diretrizes de aplicativo cliente/servidor
description: Aplicativos cliente/servidor não devem assumir que uma única conexão de computador é equivalente a uma única sessão de usuário.
ms.assetid: 69822ef1-eca8-4302-b014-8e5894d52109
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cd0c1a71256f3ab469bfeb1c08b2d096b56ac1b5
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "105761943"
---
# <a name="clientserver-application-guidelines"></a><span data-ttu-id="f8b87-103">Diretrizes de aplicativo cliente/servidor</span><span class="sxs-lookup"><span data-stu-id="f8b87-103">Client/Server application guidelines</span></span>

<span data-ttu-id="f8b87-104">Aplicativos cliente/servidor não devem assumir que uma única conexão de computador é equivalente a uma única sessão de usuário.</span><span class="sxs-lookup"><span data-stu-id="f8b87-104">Client/server applications must not assume that a single computer connection is equivalent to a single user session.</span></span> <span data-ttu-id="f8b87-105">Esse é um caso especial do problema discutido em [endereços IP e nomes de computador](ip-addresses-and-computer-names.md).</span><span class="sxs-lookup"><span data-stu-id="f8b87-105">This is a special case of the issue discussed in [IP Addresses and Computer Names](ip-addresses-and-computer-names.md).</span></span>

<span data-ttu-id="f8b87-106">Para identificar exclusivamente uma conexão de cliente/servidor, cada módulo de cliente deve usar um nome ou identificador exclusivo.</span><span class="sxs-lookup"><span data-stu-id="f8b87-106">To uniquely identify a client/server connection, each client module must use a unique name or identifier.</span></span> <span data-ttu-id="f8b87-107">Os aplicativos podem usar objetos nomeados ou pipes, soquetes ou outros métodos de IPC.</span><span class="sxs-lookup"><span data-stu-id="f8b87-107">Applications can use named objects or pipes, sockets, or other IPC methods.</span></span> <span data-ttu-id="f8b87-108">Para obter mais informações, consulte [namespaces de objeto kernel](kernel-object-namespaces.md).</span><span class="sxs-lookup"><span data-stu-id="f8b87-108">For more information, see [Kernel Object Namespaces](kernel-object-namespaces.md).</span></span>

<span data-ttu-id="f8b87-109">Para ser compatível Serviços de Área de Trabalho Remota, o módulo de servidor em um aplicativo cliente/servidor deve ser capaz de lidar com vários clientes que se conectam a partir do mesmo computador.</span><span class="sxs-lookup"><span data-stu-id="f8b87-109">To be Remote Desktop Services compatible, the server module in a client/server application must be able to handle multiple clients connecting from the same computer.</span></span> <span data-ttu-id="f8b87-110">Para fazer isso, o módulo de servidor deve aceitar conexões de cliente por meio de uma interface global bem definida, como RPC ou pipes nomeados.</span><span class="sxs-lookup"><span data-stu-id="f8b87-110">To accomplish this, the server module must accept client connections through a well-defined global interface, such as RPC or named pipes.</span></span> <span data-ttu-id="f8b87-111">O servidor e o cliente devem negociar um canal de comunicação diferente para cada sessão de usuário.</span><span class="sxs-lookup"><span data-stu-id="f8b87-111">The server and client must negotiate a different communication channel for each user session.</span></span> <span data-ttu-id="f8b87-112">O cliente deve estabelecer uma conexão com o servidor usando protocolos que dão suporte facilmente a esse tipo de operação, como TCP/IP, em que uma conexão de soquete diferente pode ser usada para cada aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="f8b87-112">The client must establish a connection to the server by using protocols that easily support this type of operation, such as TCP/IP, where a different socket connection can be used for each client application.</span></span>

<span data-ttu-id="f8b87-113">O módulo de cliente pode chamar a função [**ProcessIdToSessionId**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-processidtosessionid) para recuperar o identificador de sua sessão de serviços de área de trabalho remota.</span><span class="sxs-lookup"><span data-stu-id="f8b87-113">The client module can call the [**ProcessIdToSessionId**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-processidtosessionid) function to retrieve the identifier of its Remote Desktop Services session.</span></span> <span data-ttu-id="f8b87-114">Em seguida, o cliente usa alguma forma de comunicação entre processos para passar seu identificador de sessão para o módulo de servidor.</span><span class="sxs-lookup"><span data-stu-id="f8b87-114">The client then uses some form of interprocess communication to pass its session identifier to the server module.</span></span> <span data-ttu-id="f8b87-115">Os módulos cliente e servidor podem usar o identificador de sessão para configurar um canal de comunicação privada.</span><span class="sxs-lookup"><span data-stu-id="f8b87-115">The client and server modules can then use the session identifier to set up a private communication channel.</span></span> <span data-ttu-id="f8b87-116">Por exemplo, o módulo de servidor pode usar um identificador de sessão para acessar objetos no namespace da sessão para objetos kernel.</span><span class="sxs-lookup"><span data-stu-id="f8b87-116">For example, the server module can use a session identifier to access objects in the session's namespace for kernel objects.</span></span>

<span data-ttu-id="f8b87-117">Além disso, o módulo de servidor pode usar o identificador de sessão em uma chamada [**WTSQuerySessionInformation**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsquerysessioninformationa) para recuperar informações adicionais sobre o cliente.</span><span class="sxs-lookup"><span data-stu-id="f8b87-117">Furthermore, the server module can use the session identifier in a [**WTSQuerySessionInformation**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtsquerysessioninformationa) call to retrieve additional information about the client.</span></span> <span data-ttu-id="f8b87-118">O módulo de servidor também pode usar o identificador de sessão em uma chamada [**WTSSendMessage**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtssendmessagea) para exibir uma mensagem no terminal do cliente.</span><span class="sxs-lookup"><span data-stu-id="f8b87-118">The server module can also use the session identifier in a [**WTSSendMessage**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtssendmessagea) call to display a message on the client terminal.</span></span> <span data-ttu-id="f8b87-119">O módulo de servidor também pode criar dois eventos para monitorar a conexão do cliente e a desconexão de uma sessão.</span><span class="sxs-lookup"><span data-stu-id="f8b87-119">The server module can also create two events to monitor client connection to and disconnection from a session.</span></span> <span data-ttu-id="f8b87-120">No entanto, ele deve ser registrado no servidor de Host da Sessão da Área de Trabalho Remota (Host da Sessão RD) para fazer isso.</span><span class="sxs-lookup"><span data-stu-id="f8b87-120">However, it must be registered on the Remote Desktop Session Host (RD Session Host) server to do this.</span></span> <span data-ttu-id="f8b87-121">Para obter mais informações, consulte [monitorando conexões de sessão e desconexões](monitoring-session-connections-and-disconnections.md).</span><span class="sxs-lookup"><span data-stu-id="f8b87-121">For more information, see [Monitoring Session Connections and Disconnections](monitoring-session-connections-and-disconnections.md).</span></span>

<span data-ttu-id="f8b87-122">Prompts para entrada do usuário são uma fonte potencial de problemas para aplicativos cliente/servidor.</span><span class="sxs-lookup"><span data-stu-id="f8b87-122">Prompts for user input are a potential source of problems for client/server applications.</span></span> <span data-ttu-id="f8b87-123">Por exemplo, se um serviço chamar a função [**MessageBox**](/windows/desktop/api/winuser/nf-winuser-messagebox) , a caixa de mensagem será exibida na área de trabalho do servidor de host da Sessão RD, não na área de trabalho cliente.</span><span class="sxs-lookup"><span data-stu-id="f8b87-123">For example, if a service calls the [**MessageBox**](/windows/desktop/api/winuser/nf-winuser-messagebox) function, the message box is displayed on the desktop of the RD Session Host server, not on the client desktop.</span></span> <span data-ttu-id="f8b87-124">Para exibir uma mensagem em uma área de trabalho cliente, o serviço pode chamar a função [**WtsSendMessage**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtssendmessagea) .</span><span class="sxs-lookup"><span data-stu-id="f8b87-124">To display a message on a client desktop, the service can call the [**WtsSendMessage**](/windows/desktop/api/Wtsapi32/nf-wtsapi32-wtssendmessagea) function.</span></span> <span data-ttu-id="f8b87-125">Como alternativa, o serviço pode solicitar entrada do módulo do cliente e o módulo do cliente pode exibir a interface do usuário e enviar a entrada resultante de volta para o serviço.</span><span class="sxs-lookup"><span data-stu-id="f8b87-125">Alternatively, the service can request input from the client module, and the client module can display the user interface and send the resulting input back to the service.</span></span>

<span data-ttu-id="f8b87-126">Os processos gerados de várias sessões podem enviar dados e receber dados uns dos outros por meio do uso de blocos de memória compartilhada.</span><span class="sxs-lookup"><span data-stu-id="f8b87-126">Processes spawned from multiple sessions can send data to and receive data from each other through the use of shared memory blocks.</span></span> <span data-ttu-id="f8b87-127">Para obter mais informações, consulte [criando memória compartilhada nomeada](/windows/desktop/Memory/creating-named-shared-memory).</span><span class="sxs-lookup"><span data-stu-id="f8b87-127">For more information, see [Creating Named Shared Memory](/windows/desktop/Memory/creating-named-shared-memory).</span></span> <span data-ttu-id="f8b87-128">A memória compartilhada não pode ser usada sob as seguintes condições:</span><span class="sxs-lookup"><span data-stu-id="f8b87-128">Shared memory cannot be used under the following conditions:</span></span>

-   <span data-ttu-id="f8b87-129">Os processos que usam o bloco de memória compartilhada foram gerados por várias sessões.</span><span class="sxs-lookup"><span data-stu-id="f8b87-129">The processes using the shared memory block were spawned by multiple sessions.</span></span>
-   <span data-ttu-id="f8b87-130">As sessões compartilham a mesma credencial de autenticação de usuário.</span><span class="sxs-lookup"><span data-stu-id="f8b87-130">The sessions share the same user authentication credential.</span></span>

 

 