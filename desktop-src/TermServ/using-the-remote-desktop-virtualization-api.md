---
title: Usando a API de virtualização Área de Trabalho Remota
description: Os desenvolvedores podem usar essa API para personalizar a lógica que o agente de conexão de área de trabalho remota usa para determinar o melhor destino para uma conexão de cliente de entrada.
ms.assetid: b25eb87e-dac4-49ce-890e-b39c7e9e3408
ms.tgt_platform: multiple
keywords:
- Serviços de Área de Trabalho Remota Serviços de Área de Trabalho Remota, usando a API de virtualização
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cda9ebfc014a2c8ec20d299bbb8be9183b25ce89
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104366132"
---
# <a name="using-the-remote-desktop-virtualization-api"></a><span data-ttu-id="904a0-104">Usando a API de virtualização Área de Trabalho Remota</span><span class="sxs-lookup"><span data-stu-id="904a0-104">Using the Remote Desktop Virtualization API</span></span>

<span data-ttu-id="904a0-105">O serviço de função do diretório de sessão dos serviços de terminal (diretório de Sessão TS) permite que os servidores de terminal armazenem informações de usuário e de sessão em um banco de dados chamado de diretório de sessões.</span><span class="sxs-lookup"><span data-stu-id="904a0-105">The Terminal Services Session Directory (TS  Session Directory) role service allows terminal servers to store user and session information in a database called a session directory.</span></span> <span data-ttu-id="904a0-106">Quando um usuário se conecta a um servidor de terminal em um farm, o diretório de Sessão TS determina se o usuário já tem uma sessão em execução em um servidor de terminal e, nesse caso, redireciona o usuário para esse servidor de terminal.</span><span class="sxs-lookup"><span data-stu-id="904a0-106">When a user connects to a terminal server in a farm, TS Session Directory determines whether the user already has a session running on a terminal server and if so, it redirects the user to that terminal server.</span></span>

<span data-ttu-id="904a0-107">No Windows Server 2008, o serviço de função do diretório de sessões TS foi expandido e renomeado como agente de sessão de serviços de terminal (provedor de Sessão TS).</span><span class="sxs-lookup"><span data-stu-id="904a0-107">In Windows Server 2008, the TS Session Directory role service was expanded and renamed Terminal Services Session Broker (TS Session Broker).</span></span> <span data-ttu-id="904a0-108">Além de manter um diretório de sessões existentes, o agente de Sessão TS também pode fazer o agente de conexões de entrada.</span><span class="sxs-lookup"><span data-stu-id="904a0-108">In addition to maintaining a directory of existing sessions, TS Session Broker can also broker incoming connections.</span></span> <span data-ttu-id="904a0-109">Quando o agente de Sessão TS recebe uma conexão de entrada de um usuário, ele verifica seu banco de dados para determinar se o usuário tem uma sessão existente em um servidor de terminal.</span><span class="sxs-lookup"><span data-stu-id="904a0-109">When TS Session Broker receives an incoming connection from a user, it checks its database to determine whether the user has an existing session on a terminal server.</span></span> <span data-ttu-id="904a0-110">Nesse caso, o agente de Sessão TS redireciona a conexão para o mesmo servidor de terminal.</span><span class="sxs-lookup"><span data-stu-id="904a0-110">If so, TS Session Broker redirects the connection to that same terminal server.</span></span> <span data-ttu-id="904a0-111">Caso contrário, o agente de Sessão TS determina qual servidor de terminal tem as menores conexões e redireciona a conexão para esse servidor.</span><span class="sxs-lookup"><span data-stu-id="904a0-111">If not, TS Session Broker determines which terminal server has the fewest connections and redirects the connection to that server.</span></span>

<span data-ttu-id="904a0-112">A partir do Windows Server 2008, a Microsoft também lançou uma API (interface de programação de aplicativo) pública para monitorar e interagir com sessões em servidores de terminal.</span><span class="sxs-lookup"><span data-stu-id="904a0-112">Beginning with Windows Server 2008, Microsoft also released a public application programming interface (API) for monitoring and interacting with sessions on terminal servers.</span></span> <span data-ttu-id="904a0-113">Essa API é descrita em [referência de plug-in do conexão de área de trabalho remota Broker](/windows/desktop/TermServ/terminal-services-virtualization-api-reference).</span><span class="sxs-lookup"><span data-stu-id="904a0-113">This API is described in [Remote Desktop Connection Broker Plug-in Reference](/windows/desktop/TermServ/terminal-services-virtualization-api-reference).</span></span> <span data-ttu-id="904a0-114">Usando essa API, os desenvolvedores podem criar plug-ins de política personalizados que substituem a lógica de redirecionamento padrão do agente de Sessão TS.</span><span class="sxs-lookup"><span data-stu-id="904a0-114">Using this API, developers can create custom policy plug-ins that override the standard redirection logic of TS Session Broker.</span></span> <span data-ttu-id="904a0-115">Os plug-ins personalizados podem redirecionar sessões para servidores de terminal, bem como máquinas virtuais, áreas de trabalho virtuais, servidores de folha e áreas de trabalho físicas.</span><span class="sxs-lookup"><span data-stu-id="904a0-115">The custom plug-ins can redirect sessions to terminal servers, as well as virtual machines, virtual desktops, blade servers, and physical desktops.</span></span>

<span data-ttu-id="904a0-116">No Windows Server 2008 R2, a arquitetura do agente do Conexão de Área de Trabalho Remota (agente de conexão RD) (anteriormente conhecido como agente de Sessão TS) foi expandida para dar suporte a conexões com máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="904a0-116">In Windows Server 2008 R2, the architecture of Remote Desktop Connection Broker (RD Connection Broker) (formerly known as TS Session Broker) was expanded to support connections to virtual machines.</span></span> <span data-ttu-id="904a0-117">A nova arquitetura dá suporte ao gerenciamento de sessões para máquinas virtuais por meio da API de virtualização Área de Trabalho Remota.</span><span class="sxs-lookup"><span data-stu-id="904a0-117">The new architecture supports session management for virtual machines through the Remote Desktop Virtualization API.</span></span> <span data-ttu-id="904a0-118">Os desenvolvedores podem usar essa API para personalizar a lógica que o agente de conexão de área de trabalho remota usa para determinar o melhor destino para uma conexão de cliente de entrada.</span><span class="sxs-lookup"><span data-stu-id="904a0-118">Developers can use this API to customize the logic that RD Connection Broker uses to determine the best destination for an incoming client connection.</span></span>

<span data-ttu-id="904a0-119">A API de virtualização Área de Trabalho Remota oferece vários benefícios para os desenvolvedores:</span><span class="sxs-lookup"><span data-stu-id="904a0-119">Remote Desktop Virtualization API offers several benefits to developers:</span></span>

-   <span data-ttu-id="904a0-120">As interfaces para trabalhar com servidores de terminal físicos são semelhantes às do trabalho com máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="904a0-120">The interfaces for working with physical terminal servers are similar to those for working with virtual machines.</span></span>
-   <span data-ttu-id="904a0-121">Os desenvolvedores podem substituir toda ou parte da lógica de redirecionamento padrão.</span><span class="sxs-lookup"><span data-stu-id="904a0-121">Developers can replace all or part of the standard redirection logic.</span></span> <span data-ttu-id="904a0-122">Os desenvolvedores podem criar o código que acompanha o produto e não precisam escrever tudo do zero.</span><span class="sxs-lookup"><span data-stu-id="904a0-122">Developers can build on the code that ships with the product and do not have to write everything from scratch.</span></span>
-   <span data-ttu-id="904a0-123">Nenhum agente de gerenciamento adicional é necessário no servidor de gerenciamento ou na sessão.</span><span class="sxs-lookup"><span data-stu-id="904a0-123">No additional management agent is required on the managing server or within the session.</span></span>
-   <span data-ttu-id="904a0-124">Plug-ins do agente de Sessão TS desenvolvidos para uso com o Windows Server 2008 ainda têm suporte.</span><span class="sxs-lookup"><span data-stu-id="904a0-124">TS Session Broker plug-ins developed for use with Windows Server 2008 are still supported.</span></span>
-   <span data-ttu-id="904a0-125">A API também permite que os desenvolvedores criem interfaces do usuário para administração de servidores Host da Sessão da Área de Trabalho Remota (Host da Sessão RD) (anteriormente conhecidos como "servidores de terminal") e máquinas virtuais.</span><span class="sxs-lookup"><span data-stu-id="904a0-125">The API also allows developers to create user interfaces for administration of both Remote Desktop Session Host (RD Session Host) servers (formerly known as "terminal servers") and virtual machines.</span></span>

## <a name="related-topics"></a><span data-ttu-id="904a0-126">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="904a0-126">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="904a0-127">Referência de API de virtualização Área de Trabalho Remota</span><span class="sxs-lookup"><span data-stu-id="904a0-127">Remote Desktop Virtualization API Reference</span></span>](terminal-services-virtualization-api-reference.md)
</dt> <dt>

[<span data-ttu-id="904a0-128">Referência de plug-in do Conexão de Área de Trabalho Remota Broker</span><span class="sxs-lookup"><span data-stu-id="904a0-128">Remote Desktop Connection Broker Plug-in Reference</span></span>](/windows/desktop/TermServ/terminal-services-virtualization-api-reference)
</dt> </dl>

 

 