---
title: Habilitando a funcionalidade da Internet
description: Antes de usar as funções WinINet, o aplicativo deve tentar fazer uma conexão com a Internet usando a função InternetAttemptConnect.
ms.assetid: 80747c0d-5a09-4ffa-a0ca-b051b82acbf8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: adb44fadaf0726b81618dde19105da7517673a00
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104008031"
---
# <a name="enabling-internet-functionality"></a><span data-ttu-id="17f30-103">Habilitando a funcionalidade da Internet</span><span class="sxs-lookup"><span data-stu-id="17f30-103">Enabling Internet Functionality</span></span>

<span data-ttu-id="17f30-104">Antes de usar as funções WinINet, o aplicativo deve tentar fazer uma conexão com a Internet usando a função [**InternetAttemptConnect**](/windows/desktop/api/Wininet/nf-wininet-internetattemptconnect) .</span><span class="sxs-lookup"><span data-stu-id="17f30-104">Before using the WinINet functions, the application should attempt to make a connection to the Internet by using the [**InternetAttemptConnect**](/windows/desktop/api/Wininet/nf-wininet-internetattemptconnect) function.</span></span> <span data-ttu-id="17f30-105">Essa função chama a caixa de diálogo de conexão discada para iniciar uma conexão com a Internet ou verificar se já existe uma conexão.</span><span class="sxs-lookup"><span data-stu-id="17f30-105">This function calls the dial-up dialog box to initiate a connection to the Internet or check if a connection already exists.</span></span> <span data-ttu-id="17f30-106">Se essa função falhar, o aplicativo poderá entrar no modo offline, o que permite que ele acesse informações armazenadas em cache durante as conexões anteriores à Internet.</span><span class="sxs-lookup"><span data-stu-id="17f30-106">If this function fails, the application can enter offline mode, which allows it to access information that was cached during previous connections to the Internet.</span></span>

<span data-ttu-id="17f30-107">Use a função [**InternetCheckConnection**](/windows/desktop/api/Wininet/nf-wininet-internetcheckconnectiona) para verificar a conexão com a Internet.</span><span class="sxs-lookup"><span data-stu-id="17f30-107">Use the [**InternetCheckConnection**](/windows/desktop/api/Wininet/nf-wininet-internetcheckconnectiona) function to check the connection to the Internet.</span></span> <span data-ttu-id="17f30-108">Ele tenta executar ping no servidor designado pela URL que é passada para a função.</span><span class="sxs-lookup"><span data-stu-id="17f30-108">It attempts to ping the server designated by the URL that is passed to the function.</span></span> <span data-ttu-id="17f30-109">Se o sinalizador SINALIZAr \_ \_ conexão de força ICC \_ estiver definido e a URL for **nula**, a função verificará se há uma entrada no banco de dados do servidor para o servidor mais próximo.</span><span class="sxs-lookup"><span data-stu-id="17f30-109">If the FLAG\_ICC\_FORCE\_CONNECTION flag is set and the URL is **NULL**, the function checks to see if there is an entry in the server database for the nearest server.</span></span> <span data-ttu-id="17f30-110">Se houver, a função executará ping nesse servidor.</span><span class="sxs-lookup"><span data-stu-id="17f30-110">If one exists, the function pings that server.</span></span>

<span data-ttu-id="17f30-111">Em seguida, use a função [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) para estabelecer as características da conexão com a Internet que o aplicativo cliente está usando.</span><span class="sxs-lookup"><span data-stu-id="17f30-111">Next, use the [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) function to establish the characteristics of the Internet connection the client application is using.</span></span> <span data-ttu-id="17f30-112">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) cria o identificador [**HINTERNET**](appendix-a-hinternet-handles.md) raiz que é usado para estabelecer sessões [http](http-sessions.md)[FTP](ftp-sessions.md) .</span><span class="sxs-lookup"><span data-stu-id="17f30-112">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) creates the root [**HINTERNET**](appendix-a-hinternet-handles.md) handle that is used to establish [http](http-sessions.md)[ftp](ftp-sessions.md) sessions.</span></span> <span data-ttu-id="17f30-113">O [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) não testa a conexão com a Internet para verificar se as características passadas para a função estão corretas.</span><span class="sxs-lookup"><span data-stu-id="17f30-113">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) does not test the connection to the Internet to verify that the characteristics passed to the function are correct.</span></span>

<span data-ttu-id="17f30-114">Use a função [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) para criar uma sessão específica.</span><span class="sxs-lookup"><span data-stu-id="17f30-114">Use the [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) function to create a specific session.</span></span> <span data-ttu-id="17f30-115">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) Inicializa uma sessão para o site especificado usando os argumentos passados a ele e cria um identificador [**HINTERNET**](appendix-a-hinternet-handles.md) que é uma ramificação do identificador raiz.</span><span class="sxs-lookup"><span data-stu-id="17f30-115">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) initializes a session for the specified site using the arguments passed to it and creates an [**HINTERNET**](appendix-a-hinternet-handles.md) handle that is a branch off the root handle.</span></span> <span data-ttu-id="17f30-116">O [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) não tenta acessar ou estabelecer uma conexão com o site especificado, exceto no caso de uma sessão de FTP.</span><span class="sxs-lookup"><span data-stu-id="17f30-116">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) does not attempt to access or establish a connection to the specified site, except in the case of an FTP session.</span></span> <span data-ttu-id="17f30-117">As funções [**FtpFindFirstFile**](/windows/desktop/api/Wininet/nf-wininet-ftpfindfirstfilea), [**FtpOpenFile**](/windows/desktop/api/Wininet/nf-wininet-ftpopenfilea)e [**HttpOpenRequest**](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta) usam o identificador criado por [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) para estabelecer uma conexão com o site especificado.</span><span class="sxs-lookup"><span data-stu-id="17f30-117">[**FtpFindFirstFile**](/windows/desktop/api/Wininet/nf-wininet-ftpfindfirstfilea), [**FtpOpenFile**](/windows/desktop/api/Wininet/nf-wininet-ftpopenfilea), and [**HttpOpenRequest**](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta) functions use the handle created by [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) to establish a connection to the specified site.</span></span>

## <a name="using-internetopen"></a><span data-ttu-id="17f30-118">Usando InternetOpen</span><span class="sxs-lookup"><span data-stu-id="17f30-118">Using InternetOpen</span></span>

<span data-ttu-id="17f30-119">Para habilitar uma conexão com a Internet, um identificador de [**HINTERNET**](appendix-a-hinternet-handles.md) raiz deve ser criado usando [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="17f30-119">To enable a connection to the Internet, a root [**HINTERNET**](appendix-a-hinternet-handles.md) handle must be created by using [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span> <span data-ttu-id="17f30-120">Informações sobre o agente do usuário (o aplicativo que chama as funções da Internet), o tipo de acesso à Internet, os nomes de proxy, os hosts e endereços que ignoram o proxy e o comportamento é passado para [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="17f30-120">Information about the user agent (the application calling the Internet functions), the type of access to the Internet, the proxy names, the hosts and addresses that bypass the proxy, and the behavior are passed to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span>

### <a name="setting-the-user-agent"></a><span data-ttu-id="17f30-121">Configurando o agente do usuário</span><span class="sxs-lookup"><span data-stu-id="17f30-121">Setting the User Agent</span></span>

<span data-ttu-id="17f30-122">O aplicativo de chamada deve fornecer uma cadeia de caracteres que contém o nome do aplicativo ou da entidade acessando a Internet para o parâmetro *lpszAgent* de [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="17f30-122">The calling application should give a string that contains the name of the application or entity accessing the Internet to the *lpszAgent* parameter of [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span> <span data-ttu-id="17f30-123">Essa cadeia de caracteres é usada como o agente do usuário no protocolo HTTP.</span><span class="sxs-lookup"><span data-stu-id="17f30-123">This string is used as the user agent in the HTTP protocol.</span></span> <span data-ttu-id="17f30-124">Por exemplo, o Microsoft Internet Explorer usa o "Microsoft Internet Explorer".</span><span class="sxs-lookup"><span data-stu-id="17f30-124">For example, Microsoft Internet Explorer uses "Microsoft Internet Explorer".</span></span>

### <a name="setting-access-types"></a><span data-ttu-id="17f30-125">Definindo tipos de acesso</span><span class="sxs-lookup"><span data-stu-id="17f30-125">Setting Access Types</span></span>

<span data-ttu-id="17f30-126">O [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) dá suporte a três tipos de acesso:</span><span class="sxs-lookup"><span data-stu-id="17f30-126">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) supports three access types:</span></span>

-   <span data-ttu-id="17f30-127">Use INTERNET \_ Open \_ Type \_ Direct se o sistema no qual o aplicativo está sendo executado usar uma conexão direta com a Internet.</span><span class="sxs-lookup"><span data-stu-id="17f30-127">Use INTERNET\_OPEN\_TYPE\_DIRECT if the system on which the application is running uses a direct connection to the Internet.</span></span> <span data-ttu-id="17f30-128">Os parâmetros *lpszProxyName* e *lpszProxyBypass* de [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) não são usados e devem ser definidos como **NULL**.</span><span class="sxs-lookup"><span data-stu-id="17f30-128">The *lpszProxyName* and *lpszProxyBypass* parameters of [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) are not used and should be set to **NULL**.</span></span>
-   <span data-ttu-id="17f30-129">Use \_ \_ \_ o proxy de tipo aberto da Internet se o sistema no qual o aplicativo está sendo executado usar um ou mais servidores proxy para acessar a Internet.</span><span class="sxs-lookup"><span data-stu-id="17f30-129">Use INTERNET\_OPEN\_TYPE\_PROXY if the system on which the application is running uses one or more proxy servers to access the Internet.</span></span> <span data-ttu-id="17f30-130">O [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) usa os servidores proxy indicados por *lpszProxyName* e ignora o proxy para quaisquer nomes de host ou endereços IP especificados por *lpszProxyBypass*.</span><span class="sxs-lookup"><span data-stu-id="17f30-130">[**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) uses the proxy servers indicated by *lpszProxyName* and bypasses the proxy for any host names or IP addresses specified by *lpszProxyBypass*.</span></span>
-   <span data-ttu-id="17f30-131">Use INTERNET \_ Open \_ tipo \_ preconfig para instruir seu aplicativo a recuperar a configuração do registro.</span><span class="sxs-lookup"><span data-stu-id="17f30-131">Use INTERNET\_OPEN\_TYPE\_PRECONFIG to instruct your application to retrieve the configuration from the registry.</span></span> <span data-ttu-id="17f30-132">Normalmente, essa é a melhor opção, pois a maioria dos aplicativos, incluindo navegadores da Web, usa essa opção.</span><span class="sxs-lookup"><span data-stu-id="17f30-132">This is typically the best choice, as most applications including web browsers use this option.</span></span>

<span data-ttu-id="17f30-133">INTERNET \_ Open \_ Type a \_ preconfig examina os valores de registro **ProxyEnable**, **ProxyServer** e **ProxyOverride**.</span><span class="sxs-lookup"><span data-stu-id="17f30-133">INTERNET\_OPEN\_TYPE\_PRECONFIG looks at the registry values **ProxyEnable**, **ProxyServer**, and **ProxyOverride**.</span></span> <span data-ttu-id="17f30-134">Esses valores estão localizados em "HKEY \_ Current \_ user \\ software \\ Microsoft \\ Windows \\ CurrentVersion \\ Internet Settings".</span><span class="sxs-lookup"><span data-stu-id="17f30-134">These values are located under "HKEY\_CURRENT\_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings".</span></span>

<span data-ttu-id="17f30-135">Se **ProxyEnable** for zero, o aplicativo usará o \_ tipo de abertura direto da Internet \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="17f30-135">If **ProxyEnable** is zero, the application uses INTERNET\_OPEN\_TYPE\_DIRECT.</span></span> <span data-ttu-id="17f30-136">Caso contrário, o aplicativo usará \_ \_ \_ o proxy de tipo aberto da Internet e usará as informações de **ProxyServer** e **ProxyOverride** .</span><span class="sxs-lookup"><span data-stu-id="17f30-136">Otherwise, the application uses INTERNET\_OPEN\_TYPE\_PROXY and uses the **ProxyServer** and **ProxyOverride** information.</span></span>

<span data-ttu-id="17f30-137">As funções do WinINet fornecerão suporte para proxies de tipo Socks somente se o Internet Explorer estiver instalado.</span><span class="sxs-lookup"><span data-stu-id="17f30-137">The WinINet functions provide support for SOCKS type proxies only if Internet Explorer is installed.</span></span> <span data-ttu-id="17f30-138">A instalação do Internet Explorer inclui o arquivo Wsock32n.dll, que é necessário para dar suporte a proxies SOCKS.</span><span class="sxs-lookup"><span data-stu-id="17f30-138">The installation of Internet Explorer includes the Wsock32n.dll file, which is needed to support SOCKS proxies.</span></span> <span data-ttu-id="17f30-139">Wsock32n.dll não é redistribuível.</span><span class="sxs-lookup"><span data-stu-id="17f30-139">Wsock32n.dll is not redistributable.</span></span>

### <a name="listing-proxy-servers"></a><span data-ttu-id="17f30-140">Listando servidores proxy</span><span class="sxs-lookup"><span data-stu-id="17f30-140">Listing Proxy Servers</span></span>

<span data-ttu-id="17f30-141">O WinINet reconhece dois tipos de proxy: proxies de tipo CERN (somente HTTP) e proxies FTP TIS (somente FTP).</span><span class="sxs-lookup"><span data-stu-id="17f30-141">WinINet recognizes two types of proxies: CERN type proxies (HTTP only) and TIS FTP proxies (FTP only).</span></span> <span data-ttu-id="17f30-142">Se o Internet Explorer estiver instalado, o WinINet também oferecerá suporte a proxies de tipo Socks.</span><span class="sxs-lookup"><span data-stu-id="17f30-142">If Internet Explorer is installed, WinINet also support SOCKS type proxies.</span></span> <span data-ttu-id="17f30-143">O [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) assume, por padrão, que o proxy especificado é um proxy de CERN.</span><span class="sxs-lookup"><span data-stu-id="17f30-143">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) assumes, by default, that the specified proxy is a CERN proxy.</span></span> <span data-ttu-id="17f30-144">Se o tipo de acesso estiver definido como \_ Internet Open \_ Type \_ Direct ou Internet \_ Open \_ Type \_ preconfig, o parâmetro *LpszProxyName* de [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) deverá ser definido como **null**.</span><span class="sxs-lookup"><span data-stu-id="17f30-144">If the access type is set to INTERNET\_OPEN\_TYPE\_DIRECT or INTERNET\_OPEN\_TYPE\_PRECONFIG, the *lpszProxyName* parameter of [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) should be set to **NULL**.</span></span> <span data-ttu-id="17f30-145">Caso contrário, o valor passado para *lpszProxyName* deve conter os proxies em uma cadeia de caracteres delimitada por espaço.</span><span class="sxs-lookup"><span data-stu-id="17f30-145">Otherwise, the value passed to *lpszProxyName* must contain the proxies in a space-delimited string.</span></span> <span data-ttu-id="17f30-146">As listagens de proxy podem conter o número da porta usado para acessar o proxy.</span><span class="sxs-lookup"><span data-stu-id="17f30-146">The proxy listings can contain the port number that is used to access the proxy.</span></span>

<span data-ttu-id="17f30-147">Para listar um proxy para um protocolo específico, a cadeia de caracteres deve seguir o formato "" <protocol> <protocol> ://<nome do proxy \_> "".</span><span class="sxs-lookup"><span data-stu-id="17f30-147">To list a proxy for a specific protocol, the string must follow the format ""<protocol><protocol>://<proxy\_name>"".</span></span> <span data-ttu-id="17f30-148">Os protocolos válidos são HTTP, HTTPS e FTP.</span><span class="sxs-lookup"><span data-stu-id="17f30-148">The valid protocols are HTTP, HTTPS and FTP.</span></span> <span data-ttu-id="17f30-149">Por exemplo, para listar um proxy de FTP, uma cadeia de caracteres válida seria "" FTP = FTP://FTP \_ proxy \_ Name: 21 "", onde \_ \_ o nome do proxy FTP é o nome do proxy FTP e 21 é o número da porta que deve ser usado para acessar o proxy.</span><span class="sxs-lookup"><span data-stu-id="17f30-149">For example, to list an FTP proxy, a valid string would be ""ftp=ftp://ftp\_proxy\_name:21"", where ftp\_proxy\_name is the name of the FTP proxy and 21 is the port number that must be used to access the proxy.</span></span> <span data-ttu-id="17f30-150">Se o proxy usar o número da porta padrão para esse protocolo, o número da porta poderá ser omitido.</span><span class="sxs-lookup"><span data-stu-id="17f30-150">If the proxy uses the default port number for that protocol, the port number can be omitted.</span></span> <span data-ttu-id="17f30-151">Se um nome de proxy estiver listado por si só, ele será usado como o proxy padrão para qualquer protocolo que não tenha um proxy específico especificado.</span><span class="sxs-lookup"><span data-stu-id="17f30-151">If a proxy name is listed by itself, it is used as the default proxy for any protocols that do not have a specific proxy specified.</span></span> <span data-ttu-id="17f30-152">Por exemplo, "" http = https://http\_proxy other "" usaria o \_ proxy http para qualquer operação http, enquanto todos os outros protocolos usariam outros.</span><span class="sxs-lookup"><span data-stu-id="17f30-152">For example, ""http=https://http\_proxy other"" would use http\_proxy for any HTTP operations, while all other protocols would use other.</span></span>

<span data-ttu-id="17f30-153">Por padrão, a função pressupõe que o proxy especificado por *lpszProxyName* seja um proxy de CERN.</span><span class="sxs-lookup"><span data-stu-id="17f30-153">By default, the function assumes that the proxy specified by *lpszProxyName* is a CERN proxy.</span></span> <span data-ttu-id="17f30-154">Um aplicativo pode especificar mais de um proxy, incluindo proxies diferentes para os diferentes protocolos.</span><span class="sxs-lookup"><span data-stu-id="17f30-154">An application can specify more than one proxy, including different proxies for the different protocols.</span></span> <span data-ttu-id="17f30-155">Por exemplo, se você especificar "" FTP = FTP://FTP-GW HTTP = https://jericho:99 proxy "", as solicitações de FTP serão feitas por meio do proxy de FTP-GW, que escuta na porta 21, e as solicitações HTTP são feitas por meio de um proxy CERN chamado Jericho, que escuta na porta 99.</span><span class="sxs-lookup"><span data-stu-id="17f30-155">For example, if you specify ""ftp=ftp://ftp-gw HTTP=https://jericho:99 proxy"", FTP requests are made through the ftp-gw proxy, which listens at port 21, and HTTP requests are made through a CERN proxy called jericho, which listens at port 99.</span></span> <span data-ttu-id="17f30-156">Caso contrário, as solicitações HTTP seriam feitas por meio do proxy CERN chamado proxy, que escuta na porta 80.</span><span class="sxs-lookup"><span data-stu-id="17f30-156">Otherwise, HTTP requests would be made through the CERN proxy called proxy, which listens at port 80.</span></span> <span data-ttu-id="17f30-157">Observe que, se o aplicativo estiver usando apenas o FTP, por exemplo, ele não precisará especificar "" FTP = FTP://FTP-GW: 21 "".</span><span class="sxs-lookup"><span data-stu-id="17f30-157">Note that if the application is only using FTP, for example, it would not need to specify ""ftp=ftp://ftp-gw:21"".</span></span> <span data-ttu-id="17f30-158">Ele poderia especificar apenas "" FTP-GW "".</span><span class="sxs-lookup"><span data-stu-id="17f30-158">It could specify just ""ftp-gw"".</span></span> <span data-ttu-id="17f30-159">Um aplicativo só será necessário para especificar os nomes de protocolo se ele estiver usando mais de um protocolo por identificador retornado por [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span><span class="sxs-lookup"><span data-stu-id="17f30-159">An application is only required to specify the protocol names if it is using more than one protocol per handle returned by [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena).</span></span>

### <a name="listing-the-proxy-bypass"></a><span data-ttu-id="17f30-160">Listando o bypass do proxy</span><span class="sxs-lookup"><span data-stu-id="17f30-160">Listing the Proxy Bypass</span></span>

<span data-ttu-id="17f30-161">Os nomes de host ou endereços IP que não devem ser enviados ao proxy podem ser listados na lista de bypass de proxy.</span><span class="sxs-lookup"><span data-stu-id="17f30-161">Host names or IP addresses that should not be sent to the proxy can be listed in the proxy bypass list.</span></span> <span data-ttu-id="17f30-162">Essa lista pode conter curingas, " \* ", que fazem com que o aplicativo ignore o servidor proxy para endereços que se ajustam ao padrão especificado.</span><span class="sxs-lookup"><span data-stu-id="17f30-162">This list can contain wildcards, "\*", which cause the application to bypass the proxy server for addresses that fit the specified pattern.</span></span> <span data-ttu-id="17f30-163">Para listar vários endereços e nomes de host, separe-os com ponto e vírgula na cadeia de caracteres de bypass de proxy.</span><span class="sxs-lookup"><span data-stu-id="17f30-163">To list multiple addresses and host names, separate them with semicolons in the proxy bypass string.</span></span> <span data-ttu-id="17f30-164">Se a <local> macro "" for especificada, a função ignorará o proxy para qualquer nome de host que não contenha um ponto.</span><span class="sxs-lookup"><span data-stu-id="17f30-164">If the "<local>" macro is specified, the function bypasses the proxy for any host name that does not contain a period.</span></span>

<span data-ttu-id="17f30-165">Por padrão, o WinINet irá ignorar o proxy para solicitações que usam os nomes de host "localhost", "Loopback", "127.0.0.1" ou " \[ :: 1 \] ".</span><span class="sxs-lookup"><span data-stu-id="17f30-165">By default, WinINet will bypass the proxy for requests that use the host names "localhost", "loopback", "127.0.0.1", or "\[::1\]".</span></span> <span data-ttu-id="17f30-166">Esse comportamento existe porque um servidor proxy remoto normalmente não resolverá esses endereços corretamente.</span><span class="sxs-lookup"><span data-stu-id="17f30-166">This behavior exists because a remote proxy server typically will not resolve these addresses properly.</span></span>

<span data-ttu-id="17f30-167">**Internet Explorer 9:** Você pode remover o computador local da lista de bypass de proxy usando a macro "<-loopback>".</span><span class="sxs-lookup"><span data-stu-id="17f30-167">**Internet Explorer 9:** You can remove the local computer from the proxy bypass list using the "<-loopback>" macro.</span></span>

<span data-ttu-id="17f30-168">O exemplo a seguir mostra chamadas de exemplo para [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) usando diferentes cadeias de caracteres de bypass de proxy.</span><span class="sxs-lookup"><span data-stu-id="17f30-168">The following example shows sample calls to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) using different proxy bypass strings.</span></span> <span data-ttu-id="17f30-169">Os comentários acima de cada chamada descrevem o efeito que a cadeia de caracteres de bypass tem nos nomes de host que são acessados do identificador [**HINTERNET**](appendix-a-hinternet-handles.md) que ele cria.</span><span class="sxs-lookup"><span data-stu-id="17f30-169">The comments above each call describe what effect the bypass string has on the host names that are accessed from the [**HINTERNET**](appendix-a-hinternet-handles.md) handle it creates.</span></span>


```C++
HINTERNET hInternetRoot;

/* bypass the proxy for any host name that does not 
    contain a period */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("<local>"), 0);

/* bypass the proxy for any host name that starts with the 
    letters "ms" */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("ms*"), 0);

/* bypass the proxy for any host name that contains "int", 
    such as "internet" and "painter" */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("*int*"), 0);

/* bypass the proxy for the host name "example" and any 
    host name that contains "test" */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("proxy"),TEXT("example *test*"), 0);

/* Disable the loopback proxy bypass for localhost */
hInternetRoot = InternetOpen(TEXT("WinInet Example"), 
    INTERNET_OPEN_TYPE_PROXY,TEXT("127.0.0.1:8888"),TEXT("<-loopback>"), 0);
```



## <a name="using-internetconnect"></a><span data-ttu-id="17f30-170">Usando InternetConnect</span><span class="sxs-lookup"><span data-stu-id="17f30-170">Using InternetConnect</span></span>

<span data-ttu-id="17f30-171">Para iniciar uma sessão, a função [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) deve criar um identificador fora do identificador raiz retornado pela função [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) .</span><span class="sxs-lookup"><span data-stu-id="17f30-171">To begin a session, the [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) function must create a handle off the root handle returned by the [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) function.</span></span> <span data-ttu-id="17f30-172">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) define o endereço do servidor, o número da porta, o nome de usuário, a senha e o tipo de serviço.</span><span class="sxs-lookup"><span data-stu-id="17f30-172">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) sets the server address, port number, user name, password, and type of service.</span></span>

<span data-ttu-id="17f30-173">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) usa o identificador [**HINTERNET**](appendix-a-hinternet-handles.md) raiz criado pelo [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) para estabelecer um identificador de sessão.</span><span class="sxs-lookup"><span data-stu-id="17f30-173">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) uses the root [**HINTERNET**](appendix-a-hinternet-handles.md) handle created by [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena) to establish a session handle.</span></span> <span data-ttu-id="17f30-174">Se o [sinalizador \_ \_ assíncrono de sinalizador da Internet](api-flags.md) tiver sido definido na chamada para [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), a chamada para [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) deverá incluir um valor de contexto diferente de zero.</span><span class="sxs-lookup"><span data-stu-id="17f30-174">If the [INTERNET\_FLAG\_ASYNC](api-flags.md) flag was set in the call to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), the call to [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) should include a nonzero context value.</span></span>

<span data-ttu-id="17f30-175">O nome do servidor pode conter o nome do host (por exemplo, "www.servername.com") ou o número de IP do site no formato ASCII pontilhado-decimal (por exemplo, "10.0.1.45").</span><span class="sxs-lookup"><span data-stu-id="17f30-175">The server name can contain either the host name (for example, "www.servername.com") or IP number of the site in ASCII dotted-decimal format (for example, "10.0.1.45").</span></span>

<span data-ttu-id="17f30-176">A porta do servidor é o número da porta TCP/IP (protocolo de controle de transmissão/protocolo Internet) ao qual se conectar no servidor.</span><span class="sxs-lookup"><span data-stu-id="17f30-176">The server port is the Transmission Control Protocol/Internet Protocol (TCP/IP) port number to connect to on the server.</span></span> <span data-ttu-id="17f30-177">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) usará a porta padrão para o tipo de serviço selecionado se o \_ valor de número de porta inválido da Internet \_ \_ for usado.</span><span class="sxs-lookup"><span data-stu-id="17f30-177">[**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) uses the default port for the selected service type if the INTERNET\_INVALID\_PORT\_NUMBER value is used.</span></span> <span data-ttu-id="17f30-178">As tabelas a seguir contêm os padrões de porta do servidor para o WinINet.</span><span class="sxs-lookup"><span data-stu-id="17f30-178">The following tables contain the server port defaults for WinINet.</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="17f30-179">Valor</span><span class="sxs-lookup"><span data-stu-id="17f30-179">Value</span></span></th>
<th><span data-ttu-id="17f30-180">Significado</span><span class="sxs-lookup"><span data-stu-id="17f30-180">Meaning</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="17f30-181">INTERNET_DEFAULT_FTP_PORT</span><span class="sxs-lookup"><span data-stu-id="17f30-181">INTERNET_DEFAULT_FTP_PORT</span></span></td>
<td><span data-ttu-id="17f30-182">Use a porta padrão para servidores FTP (porta 21).</span><span class="sxs-lookup"><span data-stu-id="17f30-182">Use the default port for ftp servers (port 21).</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="17f30-183">INTERNET_DEFAULT_GOPHER_PORT</span><span class="sxs-lookup"><span data-stu-id="17f30-183">INTERNET_DEFAULT_GOPHER_PORT</span></span></td>
<td><span data-ttu-id="17f30-184">Use a porta padrão para servidores Gopher (porta 70).</span><span class="sxs-lookup"><span data-stu-id="17f30-184">Use the default port for gopher servers (port 70).</span></span>
<blockquote>
[!Note]<br />
<span data-ttu-id="17f30-185">Somente Windows XP e Windows Server 2003 R2 e versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="17f30-185">Windows XP and Windows Server 2003 R2 and earlier only.</span></span>
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="17f30-186">INTERNET_DEFAULT_HTTP_PORT</span><span class="sxs-lookup"><span data-stu-id="17f30-186">INTERNET_DEFAULT_HTTP_PORT</span></span></td>
<td><span data-ttu-id="17f30-187">Use a porta padrão para servidores http (porta 80).</span><span class="sxs-lookup"><span data-stu-id="17f30-187">Use the default port for http servers (port 80).</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="17f30-188">INTERNET_DEFAULT_HTTPS_PORT</span><span class="sxs-lookup"><span data-stu-id="17f30-188">INTERNET_DEFAULT_HTTPS_PORT</span></span></td>
<td><span data-ttu-id="17f30-189">Use a porta padrão para servidores HTTPS (porta 443).</span><span class="sxs-lookup"><span data-stu-id="17f30-189">Use the default port for https servers (port 443).</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="17f30-190">INTERNET_DEFAULT_SOCKS_PORT</span><span class="sxs-lookup"><span data-stu-id="17f30-190">INTERNET_DEFAULT_SOCKS_PORT</span></span></td>
<td><span data-ttu-id="17f30-191">Use a porta padrão para servidores de firewall Socks (porta 1080).</span><span class="sxs-lookup"><span data-stu-id="17f30-191">Use the default port for SOCKS firewall servers (port 1080).</span></span></td>
</tr>
</tbody>
</table>



 

### <a name="defining-the-user-name-and-password"></a><span data-ttu-id="17f30-192">Definindo o nome de usuário e a senha</span><span class="sxs-lookup"><span data-stu-id="17f30-192">Defining the User Name and Password</span></span>

<span data-ttu-id="17f30-193">O valor de *lpszUsername* é o endereço de uma cadeia de caracteres terminada em **nulo** que contém o nome do usuário que está fazendo logon.</span><span class="sxs-lookup"><span data-stu-id="17f30-193">The value of *lpszUsername* is the address of a **null**-terminated string that contains the name of the user who is logging on.</span></span> <span data-ttu-id="17f30-194">Se esse parâmetro for **nulo**, a função usará um padrão apropriado, exceto para http.</span><span class="sxs-lookup"><span data-stu-id="17f30-194">If this parameter is **NULL**, the function uses an appropriate default, except for HTTP.</span></span> <span data-ttu-id="17f30-195">Um parâmetro **nulo** em http faz com que o servidor retorne um erro.</span><span class="sxs-lookup"><span data-stu-id="17f30-195">A **NULL** parameter in HTTP causes the server to return an error.</span></span> <span data-ttu-id="17f30-196">Para o protocolo FTP, o padrão é anônimo.</span><span class="sxs-lookup"><span data-stu-id="17f30-196">For the FTP protocol, the default is anonymous.</span></span>

<span data-ttu-id="17f30-197">O valor de *lpszPassword* é o endereço de uma cadeia de caracteres terminada em **nulo** que contém a senha de logon.</span><span class="sxs-lookup"><span data-stu-id="17f30-197">The value of *lpszPassword* is the address of a **null**-terminated string that contains the log-on password.</span></span> <span data-ttu-id="17f30-198">Se *lpszUsername* e *lpszPassword* forem **nulos**, a função usará a senha anônima padrão.</span><span class="sxs-lookup"><span data-stu-id="17f30-198">If both *lpszUsername* and *lpszPassword* are **NULL**, the function uses the default anonymous password.</span></span> <span data-ttu-id="17f30-199">No caso do FTP, a senha anônima padrão é o nome de email do usuário.</span><span class="sxs-lookup"><span data-stu-id="17f30-199">In the case of FTP, the default anonymous password is the user's email name.</span></span> <span data-ttu-id="17f30-200">Se *lpszUsername* não for **nulo** e *lpszPassword* for **nulo**, a função usará uma senha em branco.</span><span class="sxs-lookup"><span data-stu-id="17f30-200">If *lpszUsername* is not **NULL** and *lpszPassword* is **NULL**, the function uses a blank password.</span></span> <span data-ttu-id="17f30-201">Há quatro configurações possíveis de *lpszUsername* e *lpszPassword*, que produzem os comportamentos mostrados na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="17f30-201">There are four possible settings of *lpszUsername* and *lpszPassword*, which produce the behaviors shown in the following table.</span></span>



| <span data-ttu-id="17f30-202">*lpszUsername*</span><span class="sxs-lookup"><span data-stu-id="17f30-202">*lpszUsername*</span></span>      | <span data-ttu-id="17f30-203">*lpszPassword*</span><span class="sxs-lookup"><span data-stu-id="17f30-203">*lpszPassword*</span></span>      | <span data-ttu-id="17f30-204">Nome de usuário enviado ao servidor FTP</span><span class="sxs-lookup"><span data-stu-id="17f30-204">User name sent to FTP server</span></span> | <span data-ttu-id="17f30-205">Senha enviada ao servidor FTP</span><span class="sxs-lookup"><span data-stu-id="17f30-205">Password sent to FTP server</span></span> |
|---------------------|---------------------|------------------------------|-----------------------------|
| <span data-ttu-id="17f30-206">**NULL**</span><span class="sxs-lookup"><span data-stu-id="17f30-206">**NULL**</span></span>            | <span data-ttu-id="17f30-207">**NULL**</span><span class="sxs-lookup"><span data-stu-id="17f30-207">**NULL**</span></span>            | <span data-ttu-id="17f30-208">modo</span><span class="sxs-lookup"><span data-stu-id="17f30-208">"anonymous"</span></span>                  | <span data-ttu-id="17f30-209">Nome de email do usuário</span><span class="sxs-lookup"><span data-stu-id="17f30-209">User's email name</span></span>           |
| <span data-ttu-id="17f30-210">Cadeia de caracteres não **nula**</span><span class="sxs-lookup"><span data-stu-id="17f30-210">Non-**NULL** string</span></span> | <span data-ttu-id="17f30-211">**NULL**</span><span class="sxs-lookup"><span data-stu-id="17f30-211">**NULL**</span></span>            | <span data-ttu-id="17f30-212">*lpszUsername*</span><span class="sxs-lookup"><span data-stu-id="17f30-212">*lpszUsername*</span></span>               | <span data-ttu-id="17f30-213">""</span><span class="sxs-lookup"><span data-stu-id="17f30-213">""</span></span>                          |
| <span data-ttu-id="17f30-214">**NULL**</span><span class="sxs-lookup"><span data-stu-id="17f30-214">**NULL**</span></span>            | <span data-ttu-id="17f30-215">Cadeia de caracteres não **nula**</span><span class="sxs-lookup"><span data-stu-id="17f30-215">Non-**NULL** string</span></span> | <span data-ttu-id="17f30-216">ERROR</span><span class="sxs-lookup"><span data-stu-id="17f30-216">ERROR</span></span>                        | <span data-ttu-id="17f30-217">ERROR</span><span class="sxs-lookup"><span data-stu-id="17f30-217">ERROR</span></span>                       |
| <span data-ttu-id="17f30-218">Cadeia de caracteres não **nula**</span><span class="sxs-lookup"><span data-stu-id="17f30-218">Non-**NULL** string</span></span> | <span data-ttu-id="17f30-219">Cadeia de caracteres não **nula**</span><span class="sxs-lookup"><span data-stu-id="17f30-219">Non-**NULL** string</span></span> | <span data-ttu-id="17f30-220">*lpszUsername*</span><span class="sxs-lookup"><span data-stu-id="17f30-220">*lpszUsername*</span></span>               | <span data-ttu-id="17f30-221">*lpszPassword*</span><span class="sxs-lookup"><span data-stu-id="17f30-221">*lpszPassword*</span></span>              |



 

<span data-ttu-id="17f30-222">Essas informações podem ser alteradas usando as funções [**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) e [**InternetErrorDlg**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) .</span><span class="sxs-lookup"><span data-stu-id="17f30-222">This information can be changed by using the [**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) and [**InternetErrorDlg**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) functions.</span></span> <span data-ttu-id="17f30-223">[**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) altera os valores de nome de usuário e senha, enquanto [**InternetErrorDlg**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) exibe uma caixa de diálogo que solicita o nome de usuário e a senha apropriados.</span><span class="sxs-lookup"><span data-stu-id="17f30-223">[**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) changes the user name and password values, while [**InternetErrorDlg**](/windows/desktop/api/Wininet/nf-wininet-interneterrordlg) displays a dialog box that requests the proper user name and password.</span></span>

### <a name="defining-the-session"></a><span data-ttu-id="17f30-224">Definindo a sessão</span><span class="sxs-lookup"><span data-stu-id="17f30-224">Defining the Session</span></span>

<span data-ttu-id="17f30-225">Para definir a sessão que está sendo estabelecida, defina o tipo de serviço, os sinalizadores e o valor de contexto para [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta).</span><span class="sxs-lookup"><span data-stu-id="17f30-225">To define the session that is being established, set the service type, flags, and context value for [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta).</span></span>

<span data-ttu-id="17f30-226">Há dois tipos de serviço disponíveis para [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta): serviço de Internet \_ \_ FTP e Internet \_ Service \_ http.</span><span class="sxs-lookup"><span data-stu-id="17f30-226">There are two service types available to [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta): INTERNET\_SERVICE\_FTP and INTERNET\_SERVICE\_HTTP.</span></span> <span data-ttu-id="17f30-227">\_ \_ O http do serviço de Internet é usado para sessões http e HTTPS.</span><span class="sxs-lookup"><span data-stu-id="17f30-227">INTERNET\_SERVICE\_HTTP is used for both HTTP and HTTPS sessions.</span></span>

<span data-ttu-id="17f30-228">[Internet \_ O sinalizador \_ passivo](api-flags.md) é o único sinalizador específico de serviço usado pelas funções Wininet.</span><span class="sxs-lookup"><span data-stu-id="17f30-228">[INTERNET\_FLAG\_PASSIVE](api-flags.md) is the only service-specific flag used by the WinINet functions.</span></span> <span data-ttu-id="17f30-229">Esse sinalizador pode ser definido quando o tipo de serviço for INTERNET \_ Service \_ FTP para usar a semântica de FTP passiva.</span><span class="sxs-lookup"><span data-stu-id="17f30-229">This flag can be set when the service type is INTERNET\_SERVICE\_FTP in order to use passive FTP semantics.</span></span>

<span data-ttu-id="17f30-230">Para todas as operações síncronas, o valor de *dwContext* deve ser definido como zero.</span><span class="sxs-lookup"><span data-stu-id="17f30-230">For all synchronous operations, the value of *dwContext* should be set to zero.</span></span> <span data-ttu-id="17f30-231">Se as operações assíncronas tiverem sido estabelecidas com a definição do sinalizador [ \_ \_ assíncrono de sinalizador da Internet](api-flags.md) na chamada para [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), um valor diferente de zero deverá ser fornecido para *dwContext*.</span><span class="sxs-lookup"><span data-stu-id="17f30-231">If asynchronous operations were established by setting the [INTERNET\_FLAG\_ASYNC](api-flags.md) flag in the call to [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), a nonzero value should be supplied for *dwContext*.</span></span> <span data-ttu-id="17f30-232">Para obter mais informações sobre operações assíncronas, consulte [Configurando operações assíncronas](common-functions.md).</span><span class="sxs-lookup"><span data-stu-id="17f30-232">For more information on asynchronous operations, see [Setting Up Asynchronous Operations](common-functions.md).</span></span>

<span data-ttu-id="17f30-233">Para sessões de FTP, o [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) tenta estabelecer uma conexão com o servidor na Internet.</span><span class="sxs-lookup"><span data-stu-id="17f30-233">For FTP sessions, [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) tries to establish a connection to the server on the Internet.</span></span> <span data-ttu-id="17f30-234">Para sessões HTTP, o [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) não estabelece uma conexão até que outra função tente obter informações do servidor.</span><span class="sxs-lookup"><span data-stu-id="17f30-234">For HTTP sessions, [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta) does not establish a connection until another function attempts to get information from the server.</span></span>

> [!Note]  
> <span data-ttu-id="17f30-235">O WinINet não oferece suporte a implementações de servidor.</span><span class="sxs-lookup"><span data-stu-id="17f30-235">WinINet does not support server implementations.</span></span> <span data-ttu-id="17f30-236">Além disso, ele não deve ser usado de um serviço.</span><span class="sxs-lookup"><span data-stu-id="17f30-236">In addition, it should not be used from a service.</span></span> <span data-ttu-id="17f30-237">Para implementações de servidor ou serviços, use [o Microsoft Windows http Services (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span><span class="sxs-lookup"><span data-stu-id="17f30-237">For server implementations or services use [Microsoft Windows HTTP Services (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span></span>

 

 

