---
title: Codificação de Conteúdo
description: A partir do Windows Server 2008 e do Windows Vista, o aplicativo pode direcionar o WinINet a executar a decodificação de conteúdo para os esquemas de codificação de conteúdo gzip e deflate.
ms.assetid: 136f22a6-e5ca-41c5-8651-6e132655d268
keywords:
- Codificação de Conteúdo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 09b089ae2aa4cbacdfc9b6ebefe5cbdfc1bfc10e
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104008032"
---
# <a name="content-encoding"></a><span data-ttu-id="0cc5e-104">Codificação de Conteúdo</span><span class="sxs-lookup"><span data-stu-id="0cc5e-104">Content Encoding</span></span>

<span data-ttu-id="0cc5e-105">Conforme especificado nos aplicativos do protocolo HTTP (RFC 2616), é possível solicitar que o servidor retorne respostas HTTP no formato codificado.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-105">As specified in the HTTP protocol (RFC 2616) applications can request that the server return HTTP responses in encoded format.</span></span> <span data-ttu-id="0cc5e-106">Antes do Windows Server 2008 e do Windows Vista, as solicitações com codificação de conteúdo foram enviadas para o aplicativo para processamento em seu nível.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-106">Prior to Windows Server 2008 and Windows Vista, requests with content encoding were sent to the application for processing at their level.</span></span> <span data-ttu-id="0cc5e-107">A partir do Windows Server 2008 e do Windows Vista, o aplicativo pode direcionar o WinINet a executar a decodificação de conteúdo para os esquemas de codificação de conteúdo gzip e deflate.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-107">Starting in Windows Server 2008 and Windows Vista, the application can direct WinINet to perform content decoding for the gzip and deflate content encoding schemes.</span></span>

<span data-ttu-id="0cc5e-108">Para habilitar a decodificação de conteúdo, o aplicativo define a opção de decodificação solicitando que o WinINet execute a decodificação em seu nome.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-108">To enable content decoding, the application sets the decoding option requesting that WinINet perform decoding on their behalf.</span></span> <span data-ttu-id="0cc5e-109">No entanto, habilitar a decodificação não garante que o WinINet executará a decodificação de conteúdo e que o aplicativo deve estar preparado para lidar com a decodificação.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-109">However, enabling decoding does not guarantee that WinINet will perform content decoding, and the application should be prepared to handle decoding.</span></span> <span data-ttu-id="0cc5e-110">O WinINet retira o cabeçalho de codificação de conteúdo da resposta quando a decodificação de conteúdo é executada com êxito.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-110">WinINet strips the content-encoding header from the response when content decoding is successfully performed.</span></span> <span data-ttu-id="0cc5e-111">Espera-se que os aplicativos manipulem a decodificação de conteúdo independentemente de a opção de decodificação estar habilitada ou desabilitada quando o cabeçalho de codificação de conteúdo estiver presente na resposta.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-111">Applications are expected to handle content decoding regardless of whether the decoding option is enabled or disabled when the content-encoding header is present in the response.</span></span>

<span data-ttu-id="0cc5e-112">Quando a decodificação está habilitada, o aplicativo deve especificar a lista de codificações com suporte no cabeçalho Accept-Encoding da solicitação.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-112">When decoding is enabled, the application must specify the list of supported encodings in the Accept-Encoding header of the request.</span></span> <span data-ttu-id="0cc5e-113">No entanto, o cabeçalho Accept-Encoding não obriga o servidor a enviar uma resposta codificada.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-113">The Accept-Encoding header, however, does not obligate the server to send an encoded response.</span></span> <span data-ttu-id="0cc5e-114">O WinINet enviará respostas que não correspondam à lista de codificações aceitáveis de volta para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-114">WinINet will send responses that do not match the list of acceptable encodings back to the application.</span></span>

<span data-ttu-id="0cc5e-115">A lista a seguir descreve as condições sob as quais o WinINet executará a decodificação de conteúdo quando a opção estiver habilitada:</span><span class="sxs-lookup"><span data-stu-id="0cc5e-115">The following list describes the conditions under which WinINet will perform content decoding when the option is enabled:</span></span>

-   <span data-ttu-id="0cc5e-116">O cabeçalho de Accept-Encoding deve estar presente na solicitação e deve especificar os esquemas de codificação gzip, deflate ou gzip e deflate.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-116">The Accept-Encoding header must be present in the request, and it must specify the gzip, deflate, or both gzip and deflate encoding schemes.</span></span>
-   <span data-ttu-id="0cc5e-117">O esquema de codificação especificado no cabeçalho de codificação de conteúdo deve corresponder a um dos esquemas de codificação especificados no cabeçalho de Accept-Encoding.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-117">The encoding scheme specified in the Content-Encoding header must match one of the encoding schemes specified in the Accept-Encoding header.</span></span>
-   <span data-ttu-id="0cc5e-118">O cabeçalho Content-Encoding na resposta especifica apenas um esquema de codificação.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-118">The Content-Encoding header in the response specifies only one encoding scheme.</span></span>
-   <span data-ttu-id="0cc5e-119">A resposta deve conter apenas um cabeçalho de codificação de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-119">The response must contain only one Content- Encoding header.</span></span> <span data-ttu-id="0cc5e-120">O WinINet decodifica o conteúdo codificado com apenas um esquema de codificação.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-120">WinINet decodes content that is encoded with only one encoding scheme.</span></span>
-   <span data-ttu-id="0cc5e-121">O cabeçalho de Cache-Control não deve conter a diretiva no-Transform.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-121">The Cache-Control header must not contain the no-transform directive.</span></span>
-   <span data-ttu-id="0cc5e-122">O cabeçalho de intervalo de conteúdo não deve estar presente na resposta.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-122">The Content-Range header must not be present in the response.</span></span>

## <a name="setting-the-decompression-option"></a><span data-ttu-id="0cc5e-123">Configurando a opção de descompactação</span><span class="sxs-lookup"><span data-stu-id="0cc5e-123">Setting the Decompression Option</span></span>

<span data-ttu-id="0cc5e-124">A opção de decodificação pode ser definida no identificador de sessão, no identificador de solicitação ou no identificador de conexão.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-124">The decoding option can be set on the session handle, the request handle or the connection handle.</span></span> <span data-ttu-id="0cc5e-125">O identificador no qual a opção de decodificação é definida define o escopo da opção de decodificação.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-125">The handle on which the decoding option is set, defines the scope of the decoding option.</span></span> <span data-ttu-id="0cc5e-126">Por exemplo, definir a decodificação na sessão permitirá a decodificação de todas as conexões e solicitações criadas sob esse identificador.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-126">For example, setting decoding on the session will enable decoding an all connections and requests created under that handle.</span></span>

<span data-ttu-id="0cc5e-127">Para definir a opção de decodificação, o aplicativo chama o [**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) com o identificador retornado de [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta)ou [**HttpOpenRequest**](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta).</span><span class="sxs-lookup"><span data-stu-id="0cc5e-127">To set the decoding option, the application calls [**InternetSetOption**](/windows/desktop/api/Wininet/nf-wininet-internetsetoptiona) with the handle returned from [**InternetOpen**](/windows/desktop/api/Wininet/nf-wininet-internetopena), [**InternetConnect**](/windows/desktop/api/Wininet/nf-wininet-internetconnecta), or [**HttpOpenRequest**](/windows/desktop/api/Wininet/nf-wininet-httpopenrequesta).</span></span> <span data-ttu-id="0cc5e-128">A opção **Internet \_ Option \_ http \_ decodificação** é especificada no parâmetro *dwOption* e o parâmetro *lpBuffer* aponta para uma variável booleana definida como true.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-128">The **INTERNET\_OPTION\_HTTP\_DECODING** option is specified in the *dwOption* parameter, and the *lpBuffer* parameter points to a boolean variable set to true.</span></span> <span data-ttu-id="0cc5e-129">Para desabilitar a decodificação, o aplicativo chama o **InternetSetOption** com a opção **Internet \_ Option \_ http \_ decodificação** e a variável booliana definida como false.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-129">To disable decoding, the application calls **InternetSetOption** with the **INTERNET\_OPTION\_HTTP\_DECODING** option and the boolean variable set to false.</span></span>

<span data-ttu-id="0cc5e-130">Quando a opção de decodificação é definida, o WinINet executa a decodificação na solicitação quando o aplicativo chama [**InternetReadFile**](/windows/desktop/api/Wininet/nf-wininet-internetreadfile).</span><span class="sxs-lookup"><span data-stu-id="0cc5e-130">When the decoding option is set, WinINet performs decoding on the request when the application calls [**InternetReadFile**](/windows/desktop/api/Wininet/nf-wininet-internetreadfile).</span></span> <span data-ttu-id="0cc5e-131">Se o WinINet encontrar um erro ao executar a decodificação de conteúdo, a chamada para **InternetReadFile** falhará com um **erro de \_ decodificação de Internet com \_ \_ falha**.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-131">If WinINet encounters an error while performing content decoding, the call to **InternetReadFile** fails with an **ERROR\_INTERNET\_DECODING\_FAILED**.</span></span> <span data-ttu-id="0cc5e-132">Quando a decodificação falha, o aplicativo tem duas opções: ele pode remover o cabeçalho Accept-Encoding e reenviar a solicitação, ou pode definir a opção **Internet \_ Option \_ http \_ decodificação** na solicitação como false e, em seguida, reenviar a solicitação.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-132">When decoding fails, the application has two options: it can remove the Accept-Encoding header and resend the request, or it can set the **INTERNET\_OPTION\_HTTP\_DECODING** option on the request to false and then resend the request.</span></span> <span data-ttu-id="0cc5e-133">Se a opção de decodificação for definida como false, o aplicativo deverá verificar o cabeçalho de codificação de conteúdo e executar qualquer decodificação no nível do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-133">If the decoding option is set to false, the application must check the Content-Encoding header and perform any decoding at the application level.</span></span>

> [!Note]  
> <span data-ttu-id="0cc5e-134">O WinINet não oferece suporte a implementações de servidor.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-134">WinINet does not support server implementations.</span></span> <span data-ttu-id="0cc5e-135">Além disso, ele não deve ser usado de um serviço.</span><span class="sxs-lookup"><span data-stu-id="0cc5e-135">In addition, it should not be used from a service.</span></span> <span data-ttu-id="0cc5e-136">Para implementações de servidor ou serviços, use [o Microsoft Windows http Services (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span><span class="sxs-lookup"><span data-stu-id="0cc5e-136">For server implementations or services use [Microsoft Windows HTTP Services (WinHTTP)](/windows/desktop/WinHttp/winhttp-start-page).</span></span>

 

 

 