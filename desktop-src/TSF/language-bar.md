---
title: Barra de idiomas (serviços de texto)
description: Barra de idiomas
ms.assetid: 82b92567-fdc1-488c-b395-4cb95257955c
keywords:
- TSF (estrutura de serviços de texto), barra de idiomas
- TSF (estrutura de serviços de texto), barra de idiomas
- serviços de texto, barra de idiomas
- barra de idiomas
- TSF (estrutura de serviços de texto), botões
- TSF (estrutura de serviços de texto), botões
- serviços de texto, botões
- TSF (estrutura de serviços de texto), menus
- TSF (estrutura de serviços de texto), menus
- serviços de texto, menus
- estilos de botão
- botões de menu
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c41d64a488406f6eefcff5fef6c11093af00bc5b
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/10/2020
ms.locfileid: "104369163"
---
# <a name="language-bar-text-services"></a><span data-ttu-id="f9cea-115">Barra de idiomas (serviços de texto)</span><span class="sxs-lookup"><span data-stu-id="f9cea-115">Language Bar (Text Services)</span></span>

## <a name="implementing-the-language-bar-object"></a><span data-ttu-id="f9cea-116">Implementando o objeto de barra de idiomas</span><span class="sxs-lookup"><span data-stu-id="f9cea-116">Implementing the Language Bar Object</span></span>

<span data-ttu-id="f9cea-117">Para dar suporte à adição de um item à barra de idiomas, um serviço de texto deve implementar um objeto que dê suporte à interface [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) e um dos elementos de controle [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) .</span><span class="sxs-lookup"><span data-stu-id="f9cea-117">To support adding an item to the language bar, a text service must implement an object that supports the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface and one of the [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) control elements.</span></span> <span data-ttu-id="f9cea-118">Quando o item é instalado, a barra de idiomas instala um coletor [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) chamando o [ITfSource:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) do item com a IID \_ ITfLangBarItemSink.</span><span class="sxs-lookup"><span data-stu-id="f9cea-118">When the item is installed, the language bar installs an [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) sink by calling the item's [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfLangBarItemSink.</span></span> <span data-ttu-id="f9cea-119">O item usa a interface **ITfLangBarItemSink** para notificar a barra de idiomas das alterações, por exemplo, quando o item está oculto, mostrado, habilitado ou desabilitado.</span><span class="sxs-lookup"><span data-stu-id="f9cea-119">The item uses the **ITfLangBarItemSink** interface to notify the language bar of changes, for example when the item is hidden, shown, enabled, or disabled.</span></span>

<span data-ttu-id="f9cea-120">Quatro tipos de itens de barra de idiomas podem ser instalados e cada uma das interfaces necessárias é criada a partir de **ITfLangBarItem**.</span><span class="sxs-lookup"><span data-stu-id="f9cea-120">Four types of language bar items can be installed and each of the required interfaces is created from **ITfLangBarItem**.</span></span> <span data-ttu-id="f9cea-121">Os elementos de controle **ITfLangBarItem** a seguir são possíveis.</span><span class="sxs-lookup"><span data-stu-id="f9cea-121">The following are possible **ITfLangBarItem** control elements.</span></span>



|               |                                                                                                                                                                                   |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f9cea-122">Botão</span><span class="sxs-lookup"><span data-stu-id="f9cea-122">Button</span></span>        | <span data-ttu-id="f9cea-123">Um botão de barra de idiomas funciona como um botão de comando, um controle de alternância ou um menu na barra de idiomas.</span><span class="sxs-lookup"><span data-stu-id="f9cea-123">A language bar button functions as a command button, toggle control, or a menu on the language bar.</span></span> <span data-ttu-id="f9cea-124">O objeto deve dar suporte à interface ITfLangBarItemButton.</span><span class="sxs-lookup"><span data-stu-id="f9cea-124">The object must support the ITfLangBarItemButton interface.</span></span>                   |
| <span data-ttu-id="f9cea-125">Balão</span><span class="sxs-lookup"><span data-stu-id="f9cea-125">Balloon</span></span>       | <span data-ttu-id="f9cea-126">Um balão de barra de idiomas funciona como uma notificação pop-up na barra de idiomas.</span><span class="sxs-lookup"><span data-stu-id="f9cea-126">A language bar balloon functions as a pop-up notification on the language bar.</span></span> <span data-ttu-id="f9cea-127">O objeto deve dar suporte à interface ITfLangBarItemBalloon.</span><span class="sxs-lookup"><span data-stu-id="f9cea-127">The object must support the ITfLangBarItemBalloon interface.</span></span>                                       |
| <span data-ttu-id="f9cea-128">Bitmap</span><span class="sxs-lookup"><span data-stu-id="f9cea-128">Bitmap</span></span>        | <span data-ttu-id="f9cea-129">Um bitmap de barra de idiomas funciona como um elemento estático na barra de idiomas que exibe um bitmap.</span><span class="sxs-lookup"><span data-stu-id="f9cea-129">A language bar bitmap functions as a static element on the language bar that displays a bitmap.</span></span> <span data-ttu-id="f9cea-130">O objeto deve dar suporte à interface ITfLangBarItemBitmap.</span><span class="sxs-lookup"><span data-stu-id="f9cea-130">The object must support the ITfLangBarItemBitmap interface.</span></span>                       |
| <span data-ttu-id="f9cea-131">Botão bitmap</span><span class="sxs-lookup"><span data-stu-id="f9cea-131">Bitmap Button</span></span> | <span data-ttu-id="f9cea-132">Um botão de bitmap de barra de idiomas funciona como um elemento de botão na barra de idiomas que exibe o texto e um bitmap.</span><span class="sxs-lookup"><span data-stu-id="f9cea-132">A language bar bitmap button functions as a button element on the language bar that displays text and a bitmap.</span></span> <span data-ttu-id="f9cea-133">O objeto deve dar suporte à interface ITfLangBarItemBitmapButton.</span><span class="sxs-lookup"><span data-stu-id="f9cea-133">The object must support the ITfLangBarItemBitmapButton interface.</span></span> |



 

## <a name="button-styles"></a><span data-ttu-id="f9cea-134">Estilos de botão</span><span class="sxs-lookup"><span data-stu-id="f9cea-134">Button Styles</span></span>

<span data-ttu-id="f9cea-135">Um elemento Button pode funcionar como qualquer um dos seguintes.</span><span class="sxs-lookup"><span data-stu-id="f9cea-135">A button element can function as any of the following.</span></span> <span data-ttu-id="f9cea-136">A função do item de botão é determinada pelos sinalizadores definidos no membro **dwStyle** da estrutura [TF \_ LANGBARITEMINFO](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) no método [ITfLangBarItem:: GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) .</span><span class="sxs-lookup"><span data-stu-id="f9cea-136">The function of the button item is determined by the flags set in the **dwStyle** member of the [TF\_LANGBARITEMINFO](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) structure in the [ITfLangBarItem::GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) method.</span></span>



|               |                                                                                                                                                                                                                                                                                                                                                                                      |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f9cea-137">Botão</span><span class="sxs-lookup"><span data-stu-id="f9cea-137">Button</span></span>        | <span data-ttu-id="f9cea-138">O botão funciona como um botão de comando padrão.</span><span class="sxs-lookup"><span data-stu-id="f9cea-138">The button functions as a standard command button.</span></span> <span data-ttu-id="f9cea-139">Esse estilo de botão é identificado pelo \_ estilo de botão TF bin \_ Style \_ BTN \_ .</span><span class="sxs-lookup"><span data-stu-id="f9cea-139">This button style is identified by the TF\_LBI\_STYLE\_BTN\_BUTTON style.</span></span> <span data-ttu-id="f9cea-140">ITfLangBarItemButton:: OnClick é chamado quando o item é clicado.</span><span class="sxs-lookup"><span data-stu-id="f9cea-140">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="f9cea-141">ITfLangBarItemButton:: InitMenu e ITfLangBarItemButton:: OnMenuSelect não são usados.</span><span class="sxs-lookup"><span data-stu-id="f9cea-141">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                                                                   |
| <span data-ttu-id="f9cea-142">Botão de alternância</span><span class="sxs-lookup"><span data-stu-id="f9cea-142">Toggle Button</span></span> | <span data-ttu-id="f9cea-143">O botão funciona como um controle de alternância que pode manter um estado clicado, semelhante a uma caixa de seleção.</span><span class="sxs-lookup"><span data-stu-id="f9cea-143">The button functions as a toggle control that can maintain a clicked state, similar to a check box.</span></span> <span data-ttu-id="f9cea-144">Esse estilo de botão é identificado pelo \_ estilo de alternância TF bin \_ Style \_ BTN \_ .</span><span class="sxs-lookup"><span data-stu-id="f9cea-144">This button style is identified by the TF\_LBI\_STYLE\_BTN\_TOGGLE style.</span></span> <span data-ttu-id="f9cea-145">ITfLangBarItemButton:: OnClick é chamado quando o item é clicado.</span><span class="sxs-lookup"><span data-stu-id="f9cea-145">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="f9cea-146">ITfLangBarItemButton:: InitMenu e ITfLangBarItemButton:: OnMenuSelect não são usados.</span><span class="sxs-lookup"><span data-stu-id="f9cea-146">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                  |
| <span data-ttu-id="f9cea-147">Menu</span><span class="sxs-lookup"><span data-stu-id="f9cea-147">Menu</span></span>          | <span data-ttu-id="f9cea-148">O botão funciona como um menu suspenso.</span><span class="sxs-lookup"><span data-stu-id="f9cea-148">The button functions as a drop-down menu.</span></span> <span data-ttu-id="f9cea-149">Esse estilo de botão é identificado pelo \_ estilo de menu TF bin \_ Style \_ BTN \_ .</span><span class="sxs-lookup"><span data-stu-id="f9cea-149">This button style is identified by the TF\_LBI\_STYLE\_BTN\_MENU style.</span></span> <span data-ttu-id="f9cea-150">ITfLangBarItemButton:: InitMenu é chamado quando o botão é clicado.</span><span class="sxs-lookup"><span data-stu-id="f9cea-150">ITfLangBarItemButton::InitMenu is called when the button is clicked.</span></span> <span data-ttu-id="f9cea-151">Quando o usuário seleciona um item no menu, a barra de idiomas chama ITfLangBarItemButton:: OnMenuSelect com o identificador do item de menu selecionado.</span><span class="sxs-lookup"><span data-stu-id="f9cea-151">When the user selects an item in the menu, the language bar calls ITfLangBarItemButton::OnMenuSelect with the identifier of the selected menu item.</span></span> <span data-ttu-id="f9cea-152">ITfLangBarItemButton:: OnClick não é usado.</span><span class="sxs-lookup"><span data-stu-id="f9cea-152">ITfLangBarItemButton::OnClickis not used.</span></span> |



 

## <a name="implementing-a-menu-button"></a><span data-ttu-id="f9cea-153">Implementando um botão de menu</span><span class="sxs-lookup"><span data-stu-id="f9cea-153">Implementing a Menu Button</span></span>

<span data-ttu-id="f9cea-154">Quando o usuário clica em um botão de menu, a barra de idiomas chama [ITfLangBarItemButton:: InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span><span class="sxs-lookup"><span data-stu-id="f9cea-154">When the user clicks a menu button, the language bar calls [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span></span> <span data-ttu-id="f9cea-155">O item adiciona itens ao menu usando a interface [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) passada para InitMenu.</span><span class="sxs-lookup"><span data-stu-id="f9cea-155">The item adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to InitMenu.</span></span>

<span data-ttu-id="f9cea-156">Para adicionar um submenu ao menu, chame [ITfMenu:: addMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) com o \_ \_ submenu TF LBMENUF.</span><span class="sxs-lookup"><span data-stu-id="f9cea-156">To add a submenu to the menu, call [ITfMenu::AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) with TF\_LBMENUF\_SUBMENU.</span></span> <span data-ttu-id="f9cea-157">Quando isso é feito, um novo objeto **ITfMenu** que representa o submenu é retornado no parâmetro *PpMenu* de addMenuItem.</span><span class="sxs-lookup"><span data-stu-id="f9cea-157">When this is done, a new **ITfMenu** object that represents the submenu is returned in the *ppMenu* parameter of AddMenuItem.</span></span> <span data-ttu-id="f9cea-158">Esse novo objeto de menu é usado para adicionar itens ao submenu.</span><span class="sxs-lookup"><span data-stu-id="f9cea-158">This new menu object is used to add items to the submenu.</span></span>

<span data-ttu-id="f9cea-159">Quando o usuário seleciona um item no menu, a barra de idiomas chama [ITfLangBarItemButton:: OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) com o identificador do item de menu selecionado.</span><span class="sxs-lookup"><span data-stu-id="f9cea-159">When the user selects an item in the menu, the language bar calls [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) with the identifier of the selected menu item.</span></span>

## <a name="adding-items-to-the-language-bar"></a><span data-ttu-id="f9cea-160">Adicionando itens à barra de idiomas</span><span class="sxs-lookup"><span data-stu-id="f9cea-160">Adding Items to the Language Bar</span></span>

<span data-ttu-id="f9cea-161">Um serviço de texto deve adicionar seus itens à barra de idiomas quando o método [ITfTextInputProcessor:: Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) for chamado e removê-los quando seu [ITfTextInputProcessor::D eactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) for chamado.</span><span class="sxs-lookup"><span data-stu-id="f9cea-161">A text service should add its items to the language bar when its [ITfTextInputProcessor::Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) method is called and remove them when its [ITfTextInputProcessor::Deactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) is called.</span></span>

<span data-ttu-id="f9cea-162">Para adicionar um item à barra de idiomas, o serviço de texto Obtém uma interface [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) chamando ITfThreadMgr:: QUERYINTERFACE com IID \_ ITfLangBarItemMgr.</span><span class="sxs-lookup"><span data-stu-id="f9cea-162">To add an item to the language bar, the text service obtains an [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) interface by calling ITfThreadMgr::QueryInterface with IID\_ITfLangBarItemMgr.</span></span> <span data-ttu-id="f9cea-163">Em seguida, o serviço de texto chama [ITfLangBarItemMgr:: AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) com o ponteiro para o objeto de item de barra de idiomas.</span><span class="sxs-lookup"><span data-stu-id="f9cea-163">The text service then calls [ITfLangBarItemMgr::AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) with the pointer to the language bar item object.</span></span>

<span data-ttu-id="f9cea-164">O serviço de texto deve remover o item quando desativado.</span><span class="sxs-lookup"><span data-stu-id="f9cea-164">The text service must remove the item when deactivated.</span></span> <span data-ttu-id="f9cea-165">O serviço de texto usa a mesma interface **ITfLangBarItemMgr** usada para adicionar os itens ou obter outra instância da interface.</span><span class="sxs-lookup"><span data-stu-id="f9cea-165">The text service either uses the same **ITfLangBarItemMgr** interface used to add the items or obtains another instance of the interface.</span></span> <span data-ttu-id="f9cea-166">Em seguida, o serviço de texto chama [ITfLangBarItemMgr:: RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) com o ponteiro de interface do item a ser removido.</span><span class="sxs-lookup"><span data-stu-id="f9cea-166">The text service then calls [ITfLangBarItemMgr::RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) with the interface pointer of the item to remove.</span></span>

## <a name="extending-system-language-bar-items"></a><span data-ttu-id="f9cea-167">Estendendo itens da barra de idiomas do sistema</span><span class="sxs-lookup"><span data-stu-id="f9cea-167">Extending System Language Bar Items</span></span>

<span data-ttu-id="f9cea-168">O TSF fornece a capacidade de adicionar itens de menu a menus de barra de idiomas existentes.</span><span class="sxs-lookup"><span data-stu-id="f9cea-168">TSF provides the ability to add menu items to existing language bar menus.</span></span> <span data-ttu-id="f9cea-169">Isso permite que um serviço de texto adicione itens ao menu de outro serviço de texto sem precisar adicionar um botão separado à barra de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="f9cea-169">This enables a text service to add items to the menu of another text service without having to add a separate button to the toolbar.</span></span> <span data-ttu-id="f9cea-170">Isso também permite que os itens de menu sejam organizados em grupos lógicos.</span><span class="sxs-lookup"><span data-stu-id="f9cea-170">This also enables the menu items to be organized into logical groups.</span></span> <span data-ttu-id="f9cea-171">Por exemplo, um serviço de texto que fornece recursos adicionais para o serviço de texto de fala padrão pode adicionar itens ao menu de serviço de texto de fala em vez de adicionar seu próprio botão de menu de nível superior.</span><span class="sxs-lookup"><span data-stu-id="f9cea-171">For example, a text service that provides additional features to the standard speech text service can add items to the speech text service menu rather than adding its own top-level menu button.</span></span>

<span data-ttu-id="f9cea-172">Um serviço de texto fornece uma extensão de menu de barra de idiomas implementando um objeto que dá suporte à interface [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) .</span><span class="sxs-lookup"><span data-stu-id="f9cea-172">A text service provides a language bar menu extension by implementing an object that supports the [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) interface.</span></span> <span data-ttu-id="f9cea-173">Essa interface funciona exatamente como a interface [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) para um botão de menu.</span><span class="sxs-lookup"><span data-stu-id="f9cea-173">This interface works exactly like the [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) interface for a menu button.</span></span> <span data-ttu-id="f9cea-174">Quando o menu é exibido, o serviço de texto que está sendo estendido chama [ITfSystemLangBarItemSink:: InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span><span class="sxs-lookup"><span data-stu-id="f9cea-174">When the menu is displayed, the text service being extended calls [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span></span> <span data-ttu-id="f9cea-175">A extensão adiciona itens ao menu usando a interface [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) passada para **InitMenu**.</span><span class="sxs-lookup"><span data-stu-id="f9cea-175">The extension adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to **InitMenu**.</span></span> <span data-ttu-id="f9cea-176">Quando o usuário seleciona um item adicionado pela extensão, o serviço de texto que está sendo estendido chama [ITfSystemLangBarItemSink:: OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) com o identificador do item de menu selecionado.</span><span class="sxs-lookup"><span data-stu-id="f9cea-176">When the user selects an item added by the extension, the text service being extended calls [ITfSystemLangBarItemSink::OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) with the identifier of the selected menu item.</span></span>

<span data-ttu-id="f9cea-177">Para instalar uma extensão de menu da barra de idiomas, o serviço de texto conclui as etapas a seguir.</span><span class="sxs-lookup"><span data-stu-id="f9cea-177">To install a language bar menu extension, the text service completes the following steps.</span></span>

1.  <span data-ttu-id="f9cea-178">Obtenha a interface **ITfLangBarItem** para o item a ser estendido chamando [ITfLangBarItemMgr:: GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) com o **GUID** para o item a ser estendido.</span><span class="sxs-lookup"><span data-stu-id="f9cea-178">Obtain the **ITfLangBarItem** interface for the item to extend by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) with the **GUID** for the item to be extended.</span></span>
2.  <span data-ttu-id="f9cea-179">Obtenha a interface **ITfSource** para o item a ser estendido chamando ITfLangBarItem:: QUERYINTERFACE com IID \_ ITfSource.</span><span class="sxs-lookup"><span data-stu-id="f9cea-179">Obtain the **ITfSource** interface for the item to extend by calling ITfLangBarItem::QueryInterface with IID\_ITfSource.</span></span>
3.  <span data-ttu-id="f9cea-180">Chame [ITfSource:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) com IID \_ ITfSystemLangBarItemSink e o ponteiro para o objeto **ITfSystemLangBarItemSink** .</span><span class="sxs-lookup"><span data-stu-id="f9cea-180">Call [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink and the pointer to the **ITfSystemLangBarItemSink** object.</span></span> <span data-ttu-id="f9cea-181">Se ITfSource:: AdviseSink falhar, o serviço de texto não oferece suporte a extensões de menu.</span><span class="sxs-lookup"><span data-stu-id="f9cea-181">If ITfSource::AdviseSink fails, the text service does not support menu extensions.</span></span>

<span data-ttu-id="f9cea-182">[ITfSource:: UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource:: AdviseSink**</span><span class="sxs-lookup"><span data-stu-id="f9cea-182">[ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource::AdviseSink**</span></span>

## <a name="supporting-language-bar-menu-extensions"></a><span data-ttu-id="f9cea-183">Suporte a extensões de menu da barra de idiomas</span><span class="sxs-lookup"><span data-stu-id="f9cea-183">Supporting Language Bar Menu Extensions</span></span>

<span data-ttu-id="f9cea-184">Um serviço de texto pode permitir que outros serviços de texto adicionem itens aos seus menus da barra de idiomas, conforme mostrado acima.</span><span class="sxs-lookup"><span data-stu-id="f9cea-184">A text service can enable other text services to add items to its language bar menus as shown above.</span></span> <span data-ttu-id="f9cea-185">O serviço de texto que deve publicar seu GUID para que o item possa ser obtido chamando [ITfLangBarItemMgr:: GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span><span class="sxs-lookup"><span data-stu-id="f9cea-185">The text service that must publish its GUID so that the item can be obtained by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span></span>

<span data-ttu-id="f9cea-186">Para dar suporte a extensões de menu, o serviço de texto deve dar suporte à interface [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) .</span><span class="sxs-lookup"><span data-stu-id="f9cea-186">To support menu extensions, the text service must support the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface.</span></span> <span data-ttu-id="f9cea-187">As etapas a seguir habilitam o suporte para uma ou mais extensões de menu.</span><span class="sxs-lookup"><span data-stu-id="f9cea-187">The following steps enable support for one or more menu extensions.</span></span>

1.  <span data-ttu-id="f9cea-188">Quando [ITfSource:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) com IID \_ ITfSystemLangBarItemSink é chamado, o serviço de texto deve armazenar a interface **ITfSystemLangBarItemSink** e retornar um valor de cookie que identificará a extensão.</span><span class="sxs-lookup"><span data-stu-id="f9cea-188">When [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink is called, the text service must store the **ITfSystemLangBarItemSink** interface and return a cookie value that will identify the extension.</span></span>
2.  <span data-ttu-id="f9cea-189">Quando [ITfLangBarItemButton:: InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) é chamado, o serviço de texto chama o método [ITfSystemLangBarItemSink:: InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) da extensão.</span><span class="sxs-lookup"><span data-stu-id="f9cea-189">When [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) is called, the text service calls the extension's [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) method.</span></span> <span data-ttu-id="f9cea-190">O serviço de texto deve implementar uma maneira de identificar os itens de menu adicionados pela extensão, em oposição aos itens adicionados pelo próprio serviço de texto.</span><span class="sxs-lookup"><span data-stu-id="f9cea-190">The text service must implement a way to identify the menu items added by the extension as opposed to the items added by the text service itself.</span></span>
3.  <span data-ttu-id="f9cea-191">Quando [ITfLangBarItemButton:: OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) é chamado com um identificador de item de menu que pertence a uma extensão, o serviço de texto chama o método **ITfSystemLangBarItemSink:: OnMenuSelect** de extensões.</span><span class="sxs-lookup"><span data-stu-id="f9cea-191">When [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) is called with a menu item identifier that belongs to an extension, the text service calls the extensions's **ITfSystemLangBarItemSink::OnMenuSelect** method.</span></span>
4.  <span data-ttu-id="f9cea-192">Quando [ITfSource:: UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) é chamado com o cookie apropriado, o serviço de texto remove a extensão do menu.</span><span class="sxs-lookup"><span data-stu-id="f9cea-192">When [ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) is called with the appropriate cookie, the text service removes the menu extension.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f9cea-193">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="f9cea-193">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f9cea-194">Como configurar a estrutura de serviços de texto</span><span class="sxs-lookup"><span data-stu-id="f9cea-194">How To Set Up Text Services Framework</span></span>](how-to-set-up-tsf.md)
</dt> <dt>

[<span data-ttu-id="f9cea-195">Barra de idiomas (aplicativos)</span><span class="sxs-lookup"><span data-stu-id="f9cea-195">Language Bar (Applications)</span></span>](language-bar-app.md)
</dt> </dl>

 

 
