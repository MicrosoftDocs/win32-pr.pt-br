---
title: Barra de idiomas (serviços de texto)
description: Barra de idiomas
ms.assetid: 82b92567-fdc1-488c-b395-4cb95257955c
keywords:
- TSF (estrutura de serviços de texto), barra de idiomas
- TSF (estrutura de serviços de texto), barra de idiomas
- serviços de texto, barra de idiomas
- barra de idiomas
- TSF (estrutura de serviços de texto), botões
- TSF (estrutura de serviços de texto), botões
- serviços de texto, botões
- TSF (estrutura de serviços de texto), menus
- TSF (estrutura de serviços de texto), menus
- serviços de texto, menus
- estilos de botão
- botões de menu
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e3c4359c6753f5d96613435f9501036f1d5f317
ms.sourcegitcommit: 8ebcf6cd36f67f8bcf78e76ae8923d65b8995c8a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/05/2021
ms.locfileid: "111524440"
---
# <a name="language-bar-text-services"></a><span data-ttu-id="89c95-115">Barra de idiomas (serviços de texto)</span><span class="sxs-lookup"><span data-stu-id="89c95-115">Language Bar (Text Services)</span></span>

## <a name="implementing-the-language-bar-object"></a><span data-ttu-id="89c95-116">Implementando o objeto de barra de idiomas</span><span class="sxs-lookup"><span data-stu-id="89c95-116">Implementing the Language Bar Object</span></span>

<span data-ttu-id="89c95-117">Para dar suporte à adição de um item à barra de idiomas, um serviço de texto deve implementar um objeto que dê suporte à interface [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) e um dos elementos de controle [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) .</span><span class="sxs-lookup"><span data-stu-id="89c95-117">To support adding an item to the language bar, a text service must implement an object that supports the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface and one of the [ITfLangBarItem](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritem) control elements.</span></span> <span data-ttu-id="89c95-118">Quando o item é instalado, a barra de idiomas instala um coletor [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) chamando o [ITfSource:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) do item com a IID \_ ITfLangBarItemSink.</span><span class="sxs-lookup"><span data-stu-id="89c95-118">When the item is installed, the language bar installs an [ITfLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemsink) sink by calling the item's [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfLangBarItemSink.</span></span> <span data-ttu-id="89c95-119">O item usa a interface **ITfLangBarItemSink** para notificar a barra de idiomas das alterações, por exemplo, quando o item está oculto, mostrado, habilitado ou desabilitado.</span><span class="sxs-lookup"><span data-stu-id="89c95-119">The item uses the **ITfLangBarItemSink** interface to notify the language bar of changes, for example when the item is hidden, shown, enabled, or disabled.</span></span>

<span data-ttu-id="89c95-120">Quatro tipos de itens de barra de idiomas podem ser instalados e cada uma das interfaces necessárias é criada a partir de **ITfLangBarItem**.</span><span class="sxs-lookup"><span data-stu-id="89c95-120">Four types of language bar items can be installed and each of the required interfaces is created from **ITfLangBarItem**.</span></span> <span data-ttu-id="89c95-121">Os elementos de controle **ITfLangBarItem** a seguir são possíveis.</span><span class="sxs-lookup"><span data-stu-id="89c95-121">The following are possible **ITfLangBarItem** control elements.</span></span>



|   <span data-ttu-id="89c95-122">Elemento</span><span class="sxs-lookup"><span data-stu-id="89c95-122">Element</span></span>            |    <span data-ttu-id="89c95-123">Descrição</span><span class="sxs-lookup"><span data-stu-id="89c95-123">Description</span></span>                                                                                                                                                                               |
|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="89c95-124">Botão</span><span class="sxs-lookup"><span data-stu-id="89c95-124">Button</span></span>        | <span data-ttu-id="89c95-125">Um botão de barra de idiomas funciona como um botão de comando, um controle de alternância ou um menu na barra de idiomas.</span><span class="sxs-lookup"><span data-stu-id="89c95-125">A language bar button functions as a command button, toggle control, or a menu on the language bar.</span></span> <span data-ttu-id="89c95-126">O objeto deve dar suporte à interface ITfLangBarItemButton.</span><span class="sxs-lookup"><span data-stu-id="89c95-126">The object must support the ITfLangBarItemButton interface.</span></span>                   |
| <span data-ttu-id="89c95-127">Balão</span><span class="sxs-lookup"><span data-stu-id="89c95-127">Balloon</span></span>       | <span data-ttu-id="89c95-128">Um balão de barra de idiomas funciona como uma notificação pop-up na barra de idiomas.</span><span class="sxs-lookup"><span data-stu-id="89c95-128">A language bar balloon functions as a pop-up notification on the language bar.</span></span> <span data-ttu-id="89c95-129">O objeto deve dar suporte à interface ITfLangBarItemBalloon.</span><span class="sxs-lookup"><span data-stu-id="89c95-129">The object must support the ITfLangBarItemBalloon interface.</span></span>                                       |
| <span data-ttu-id="89c95-130">Bitmap</span><span class="sxs-lookup"><span data-stu-id="89c95-130">Bitmap</span></span>        | <span data-ttu-id="89c95-131">Um bitmap de barra de idiomas funciona como um elemento estático na barra de idiomas que exibe um bitmap.</span><span class="sxs-lookup"><span data-stu-id="89c95-131">A language bar bitmap functions as a static element on the language bar that displays a bitmap.</span></span> <span data-ttu-id="89c95-132">O objeto deve dar suporte à interface ITfLangBarItemBitmap.</span><span class="sxs-lookup"><span data-stu-id="89c95-132">The object must support the ITfLangBarItemBitmap interface.</span></span>                       |
| <span data-ttu-id="89c95-133">Botão bitmap</span><span class="sxs-lookup"><span data-stu-id="89c95-133">Bitmap Button</span></span> | <span data-ttu-id="89c95-134">Um botão de bitmap de barra de idiomas funciona como um elemento de botão na barra de idiomas que exibe o texto e um bitmap.</span><span class="sxs-lookup"><span data-stu-id="89c95-134">A language bar bitmap button functions as a button element on the language bar that displays text and a bitmap.</span></span> <span data-ttu-id="89c95-135">O objeto deve dar suporte à interface ITfLangBarItemBitmapButton.</span><span class="sxs-lookup"><span data-stu-id="89c95-135">The object must support the ITfLangBarItemBitmapButton interface.</span></span> |



 

## <a name="button-styles"></a><span data-ttu-id="89c95-136">Estilos de botão</span><span class="sxs-lookup"><span data-stu-id="89c95-136">Button Styles</span></span>

<span data-ttu-id="89c95-137">Um elemento Button pode funcionar como qualquer um dos seguintes.</span><span class="sxs-lookup"><span data-stu-id="89c95-137">A button element can function as any of the following.</span></span> <span data-ttu-id="89c95-138">A função do item de botão é determinada pelos sinalizadores definidos no membro **dwStyle** da estrutura [TF \_ LANGBARITEMINFO](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) no método [ITfLangBarItem:: GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) .</span><span class="sxs-lookup"><span data-stu-id="89c95-138">The function of the button item is determined by the flags set in the **dwStyle** member of the [TF\_LANGBARITEMINFO](/windows/desktop/api/ctfutb/ns-ctfutb-tf_langbariteminfo) structure in the [ITfLangBarItem::GetInfo](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritem-getinfo) method.</span></span>



|    <span data-ttu-id="89c95-139">Elemento</span><span class="sxs-lookup"><span data-stu-id="89c95-139">Element</span></span>           |    <span data-ttu-id="89c95-140">Descrição</span><span class="sxs-lookup"><span data-stu-id="89c95-140">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                  |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="89c95-141">Botão</span><span class="sxs-lookup"><span data-stu-id="89c95-141">Button</span></span>        | <span data-ttu-id="89c95-142">O botão funciona como um botão de comando padrão.</span><span class="sxs-lookup"><span data-stu-id="89c95-142">The button functions as a standard command button.</span></span> <span data-ttu-id="89c95-143">Esse estilo de botão é identificado pelo \_ estilo de botão TF bin \_ Style \_ BTN \_ .</span><span class="sxs-lookup"><span data-stu-id="89c95-143">This button style is identified by the TF\_LBI\_STYLE\_BTN\_BUTTON style.</span></span> <span data-ttu-id="89c95-144">ITfLangBarItemButton:: OnClick é chamado quando o item é clicado.</span><span class="sxs-lookup"><span data-stu-id="89c95-144">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="89c95-145">ITfLangBarItemButton:: InitMenu e ITfLangBarItemButton:: OnMenuSelect não são usados.</span><span class="sxs-lookup"><span data-stu-id="89c95-145">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                                                                   |
| <span data-ttu-id="89c95-146">Botão de alternância</span><span class="sxs-lookup"><span data-stu-id="89c95-146">Toggle Button</span></span> | <span data-ttu-id="89c95-147">O botão funciona como um controle de alternância que pode manter um estado clicado, semelhante a uma caixa de seleção.</span><span class="sxs-lookup"><span data-stu-id="89c95-147">The button functions as a toggle control that can maintain a clicked state, similar to a check box.</span></span> <span data-ttu-id="89c95-148">Esse estilo de botão é identificado pelo \_ estilo de alternância TF bin \_ Style \_ BTN \_ .</span><span class="sxs-lookup"><span data-stu-id="89c95-148">This button style is identified by the TF\_LBI\_STYLE\_BTN\_TOGGLE style.</span></span> <span data-ttu-id="89c95-149">ITfLangBarItemButton:: OnClick é chamado quando o item é clicado.</span><span class="sxs-lookup"><span data-stu-id="89c95-149">ITfLangBarItemButton::OnClick is called when the item is clicked.</span></span> <span data-ttu-id="89c95-150">ITfLangBarItemButton:: InitMenu e ITfLangBarItemButton:: OnMenuSelect não são usados.</span><span class="sxs-lookup"><span data-stu-id="89c95-150">ITfLangBarItemButton::InitMenu and ITfLangBarItemButton::OnMenuSelect are not used.</span></span>                                                  |
| <span data-ttu-id="89c95-151">Menu</span><span class="sxs-lookup"><span data-stu-id="89c95-151">Menu</span></span>          | <span data-ttu-id="89c95-152">O botão funciona como um menu suspenso.</span><span class="sxs-lookup"><span data-stu-id="89c95-152">The button functions as a drop-down menu.</span></span> <span data-ttu-id="89c95-153">Esse estilo de botão é identificado pelo \_ estilo de menu TF bin \_ Style \_ BTN \_ .</span><span class="sxs-lookup"><span data-stu-id="89c95-153">This button style is identified by the TF\_LBI\_STYLE\_BTN\_MENU style.</span></span> <span data-ttu-id="89c95-154">ITfLangBarItemButton:: InitMenu é chamado quando o botão é clicado.</span><span class="sxs-lookup"><span data-stu-id="89c95-154">ITfLangBarItemButton::InitMenu is called when the button is clicked.</span></span> <span data-ttu-id="89c95-155">Quando o usuário seleciona um item no menu, a barra de idiomas chama ITfLangBarItemButton:: OnMenuSelect com o identificador do item de menu selecionado.</span><span class="sxs-lookup"><span data-stu-id="89c95-155">When the user selects an item in the menu, the language bar calls ITfLangBarItemButton::OnMenuSelect with the identifier of the selected menu item.</span></span> <span data-ttu-id="89c95-156">ITfLangBarItemButton:: OnClick não é usado.</span><span class="sxs-lookup"><span data-stu-id="89c95-156">ITfLangBarItemButton::OnClickis not used.</span></span> |



 

## <a name="implementing-a-menu-button"></a><span data-ttu-id="89c95-157">Implementando um botão de menu</span><span class="sxs-lookup"><span data-stu-id="89c95-157">Implementing a Menu Button</span></span>

<span data-ttu-id="89c95-158">Quando o usuário clica em um botão de menu, a barra de idiomas chama [ITfLangBarItemButton:: InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span><span class="sxs-lookup"><span data-stu-id="89c95-158">When the user clicks a menu button, the language bar calls [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu).</span></span> <span data-ttu-id="89c95-159">O item adiciona itens ao menu usando a interface [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) passada para InitMenu.</span><span class="sxs-lookup"><span data-stu-id="89c95-159">The item adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to InitMenu.</span></span>

<span data-ttu-id="89c95-160">Para adicionar um submenu ao menu, chame [ITfMenu:: addMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) com o \_ \_ submenu TF LBMENUF.</span><span class="sxs-lookup"><span data-stu-id="89c95-160">To add a submenu to the menu, call [ITfMenu::AddMenuItem](/windows/desktop/api/Ctfutb/nf-ctfutb-itfmenu-addmenuitem) with TF\_LBMENUF\_SUBMENU.</span></span> <span data-ttu-id="89c95-161">Quando isso é feito, um novo objeto **ITfMenu** que representa o submenu é retornado no parâmetro *PpMenu* de addMenuItem.</span><span class="sxs-lookup"><span data-stu-id="89c95-161">When this is done, a new **ITfMenu** object that represents the submenu is returned in the *ppMenu* parameter of AddMenuItem.</span></span> <span data-ttu-id="89c95-162">Esse novo objeto de menu é usado para adicionar itens ao submenu.</span><span class="sxs-lookup"><span data-stu-id="89c95-162">This new menu object is used to add items to the submenu.</span></span>

<span data-ttu-id="89c95-163">Quando o usuário seleciona um item no menu, a barra de idiomas chama [ITfLangBarItemButton:: OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) com o identificador do item de menu selecionado.</span><span class="sxs-lookup"><span data-stu-id="89c95-163">When the user selects an item in the menu, the language bar calls [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) with the identifier of the selected menu item.</span></span>

## <a name="adding-items-to-the-language-bar"></a><span data-ttu-id="89c95-164">Adicionando itens à barra de idiomas</span><span class="sxs-lookup"><span data-stu-id="89c95-164">Adding Items to the Language Bar</span></span>

<span data-ttu-id="89c95-165">Um serviço de texto deve adicionar seus itens à barra de idiomas quando o método [ITfTextInputProcessor:: Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) for chamado e removê-los quando seu [ITfTextInputProcessor::D eactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) for chamado.</span><span class="sxs-lookup"><span data-stu-id="89c95-165">A text service should add its items to the language bar when its [ITfTextInputProcessor::Activate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-activate) method is called and remove them when its [ITfTextInputProcessor::Deactivate](/windows/desktop/api/msctf/nf-msctf-itftextinputprocessor-deactivate) is called.</span></span>

<span data-ttu-id="89c95-166">Para adicionar um item à barra de idiomas, o serviço de texto Obtém uma interface [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) chamando ITfThreadMgr:: QUERYINTERFACE com IID \_ ITfLangBarItemMgr.</span><span class="sxs-lookup"><span data-stu-id="89c95-166">To add an item to the language bar, the text service obtains an [ITfLangBarItemMgr](/windows/desktop/api/ctfutb/nn-ctfutb-itflangbaritemmgr) interface by calling ITfThreadMgr::QueryInterface with IID\_ITfLangBarItemMgr.</span></span> <span data-ttu-id="89c95-167">Em seguida, o serviço de texto chama [ITfLangBarItemMgr:: AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) com o ponteiro para o objeto de item de barra de idiomas.</span><span class="sxs-lookup"><span data-stu-id="89c95-167">The text service then calls [ITfLangBarItemMgr::AddItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-additem) with the pointer to the language bar item object.</span></span>

<span data-ttu-id="89c95-168">O serviço de texto deve remover o item quando desativado.</span><span class="sxs-lookup"><span data-stu-id="89c95-168">The text service must remove the item when deactivated.</span></span> <span data-ttu-id="89c95-169">O serviço de texto usa a mesma interface **ITfLangBarItemMgr** usada para adicionar os itens ou obter outra instância da interface.</span><span class="sxs-lookup"><span data-stu-id="89c95-169">The text service either uses the same **ITfLangBarItemMgr** interface used to add the items or obtains another instance of the interface.</span></span> <span data-ttu-id="89c95-170">Em seguida, o serviço de texto chama [ITfLangBarItemMgr:: RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) com o ponteiro de interface do item a ser removido.</span><span class="sxs-lookup"><span data-stu-id="89c95-170">The text service then calls [ITfLangBarItemMgr::RemoveItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-removeitem) with the interface pointer of the item to remove.</span></span>

## <a name="extending-system-language-bar-items"></a><span data-ttu-id="89c95-171">Estendendo itens da barra de idiomas do sistema</span><span class="sxs-lookup"><span data-stu-id="89c95-171">Extending System Language Bar Items</span></span>

<span data-ttu-id="89c95-172">O TSF fornece a capacidade de adicionar itens de menu a menus de barra de idiomas existentes.</span><span class="sxs-lookup"><span data-stu-id="89c95-172">TSF provides the ability to add menu items to existing language bar menus.</span></span> <span data-ttu-id="89c95-173">Isso permite que um serviço de texto adicione itens ao menu de outro serviço de texto sem precisar adicionar um botão separado à barra de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="89c95-173">This enables a text service to add items to the menu of another text service without having to add a separate button to the toolbar.</span></span> <span data-ttu-id="89c95-174">Isso também permite que os itens de menu sejam organizados em grupos lógicos.</span><span class="sxs-lookup"><span data-stu-id="89c95-174">This also enables the menu items to be organized into logical groups.</span></span> <span data-ttu-id="89c95-175">Por exemplo, um serviço de texto que fornece recursos adicionais para o serviço de texto de fala padrão pode adicionar itens ao menu de serviço de texto de fala em vez de adicionar seu próprio botão de menu de nível superior.</span><span class="sxs-lookup"><span data-stu-id="89c95-175">For example, a text service that provides additional features to the standard speech text service can add items to the speech text service menu rather than adding its own top-level menu button.</span></span>

<span data-ttu-id="89c95-176">Um serviço de texto fornece uma extensão de menu de barra de idiomas implementando um objeto que dá suporte à interface [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) .</span><span class="sxs-lookup"><span data-stu-id="89c95-176">A text service provides a language bar menu extension by implementing an object that supports the [ITfSystemLangBarItemSink](/windows/desktop/api/ctfutb/nn-ctfutb-itfsystemlangbaritemsink) interface.</span></span> <span data-ttu-id="89c95-177">Essa interface funciona exatamente como a interface [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) para um botão de menu.</span><span class="sxs-lookup"><span data-stu-id="89c95-177">This interface works exactly like the [ITfLangBarItemButton](/windows/desktop/api/Ctfutb/nn-ctfutb-itflangbaritembutton) interface for a menu button.</span></span> <span data-ttu-id="89c95-178">Quando o menu é exibido, o serviço de texto que está sendo estendido chama [ITfSystemLangBarItemSink:: InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span><span class="sxs-lookup"><span data-stu-id="89c95-178">When the menu is displayed, the text service being extended calls [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu).</span></span> <span data-ttu-id="89c95-179">A extensão adiciona itens ao menu usando a interface [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) passada para **InitMenu**.</span><span class="sxs-lookup"><span data-stu-id="89c95-179">The extension adds items to the menu using the [ITfMenu](/windows/desktop/api/ctfutb/nn-ctfutb-itfmenu) interface passed to **InitMenu**.</span></span> <span data-ttu-id="89c95-180">Quando o usuário seleciona um item adicionado pela extensão, o serviço de texto que está sendo estendido chama [ITfSystemLangBarItemSink:: OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) com o identificador do item de menu selecionado.</span><span class="sxs-lookup"><span data-stu-id="89c95-180">When the user selects an item added by the extension, the text service being extended calls [ITfSystemLangBarItemSink::OnMenuSelect](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-onmenuselect) with the identifier of the selected menu item.</span></span>

<span data-ttu-id="89c95-181">Para instalar uma extensão de menu da barra de idiomas, o serviço de texto conclui as etapas a seguir.</span><span class="sxs-lookup"><span data-stu-id="89c95-181">To install a language bar menu extension, the text service completes the following steps.</span></span>

1.  <span data-ttu-id="89c95-182">Obtenha a interface **ITfLangBarItem** para o item a ser estendido chamando [ITfLangBarItemMgr:: GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) com o **GUID** para o item a ser estendido.</span><span class="sxs-lookup"><span data-stu-id="89c95-182">Obtain the **ITfLangBarItem** interface for the item to extend by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem) with the **GUID** for the item to be extended.</span></span>
2.  <span data-ttu-id="89c95-183">Obtenha a interface **ITfSource** para o item a ser estendido chamando ITfLangBarItem:: QUERYINTERFACE com IID \_ ITfSource.</span><span class="sxs-lookup"><span data-stu-id="89c95-183">Obtain the **ITfSource** interface for the item to extend by calling ITfLangBarItem::QueryInterface with IID\_ITfSource.</span></span>
3.  <span data-ttu-id="89c95-184">Chame [ITfSource:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) com IID \_ ITfSystemLangBarItemSink e o ponteiro para o objeto **ITfSystemLangBarItemSink** .</span><span class="sxs-lookup"><span data-stu-id="89c95-184">Call [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink and the pointer to the **ITfSystemLangBarItemSink** object.</span></span> <span data-ttu-id="89c95-185">Se ITfSource:: AdviseSink falhar, o serviço de texto não oferece suporte a extensões de menu.</span><span class="sxs-lookup"><span data-stu-id="89c95-185">If ITfSource::AdviseSink fails, the text service does not support menu extensions.</span></span>

<span data-ttu-id="89c95-186">[ITfSource:: UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource:: AdviseSink**</span><span class="sxs-lookup"><span data-stu-id="89c95-186">[ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink)**ITfSource::AdviseSink**</span></span>

## <a name="supporting-language-bar-menu-extensions"></a><span data-ttu-id="89c95-187">Suporte a extensões de menu da barra de idiomas</span><span class="sxs-lookup"><span data-stu-id="89c95-187">Supporting Language Bar Menu Extensions</span></span>

<span data-ttu-id="89c95-188">Um serviço de texto pode permitir que outros serviços de texto adicionem itens aos seus menus da barra de idiomas, conforme mostrado acima.</span><span class="sxs-lookup"><span data-stu-id="89c95-188">A text service can enable other text services to add items to its language bar menus as shown above.</span></span> <span data-ttu-id="89c95-189">O serviço de texto que deve publicar seu GUID para que o item possa ser obtido chamando [ITfLangBarItemMgr:: GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span><span class="sxs-lookup"><span data-stu-id="89c95-189">The text service that must publish its GUID so that the item can be obtained by calling [ITfLangBarItemMgr::GetItem](/windows/desktop/api/ctfutb/nf-ctfutb-itflangbaritemmgr-getitem).</span></span>

<span data-ttu-id="89c95-190">Para dar suporte a extensões de menu, o serviço de texto deve dar suporte à interface [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) .</span><span class="sxs-lookup"><span data-stu-id="89c95-190">To support menu extensions, the text service must support the [ITfSource](/windows/desktop/api/msctf/nn-msctf-itfsource) interface.</span></span> <span data-ttu-id="89c95-191">As etapas a seguir habilitam o suporte para uma ou mais extensões de menu.</span><span class="sxs-lookup"><span data-stu-id="89c95-191">The following steps enable support for one or more menu extensions.</span></span>

1.  <span data-ttu-id="89c95-192">Quando [ITfSource:: AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) com IID \_ ITfSystemLangBarItemSink é chamado, o serviço de texto deve armazenar a interface **ITfSystemLangBarItemSink** e retornar um valor de cookie que identificará a extensão.</span><span class="sxs-lookup"><span data-stu-id="89c95-192">When [ITfSource::AdviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-advisesink) with IID\_ITfSystemLangBarItemSink is called, the text service must store the **ITfSystemLangBarItemSink** interface and return a cookie value that will identify the extension.</span></span>
2.  <span data-ttu-id="89c95-193">Quando [ITfLangBarItemButton:: InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) é chamado, o serviço de texto chama o método [ITfSystemLangBarItemSink:: InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) da extensão.</span><span class="sxs-lookup"><span data-stu-id="89c95-193">When [ITfLangBarItemButton::InitMenu](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-initmenu) is called, the text service calls the extension's [ITfSystemLangBarItemSink::InitMenu](/windows/desktop/api/ctfutb/nf-ctfutb-itfsystemlangbaritemsink-initmenu) method.</span></span> <span data-ttu-id="89c95-194">O serviço de texto deve implementar uma maneira de identificar os itens de menu adicionados pela extensão, em oposição aos itens adicionados pelo próprio serviço de texto.</span><span class="sxs-lookup"><span data-stu-id="89c95-194">The text service must implement a way to identify the menu items added by the extension as opposed to the items added by the text service itself.</span></span>
3.  <span data-ttu-id="89c95-195">Quando [ITfLangBarItemButton:: OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) é chamado com um identificador de item de menu que pertence a uma extensão, o serviço de texto chama o método **ITfSystemLangBarItemSink:: OnMenuSelect** de extensões.</span><span class="sxs-lookup"><span data-stu-id="89c95-195">When [ITfLangBarItemButton::OnMenuSelect](/windows/desktop/api/Ctfutb/nf-ctfutb-itflangbaritembutton-onmenuselect) is called with a menu item identifier that belongs to an extension, the text service calls the extensions's **ITfSystemLangBarItemSink::OnMenuSelect** method.</span></span>
4.  <span data-ttu-id="89c95-196">Quando [ITfSource:: UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) é chamado com o cookie apropriado, o serviço de texto remove a extensão do menu.</span><span class="sxs-lookup"><span data-stu-id="89c95-196">When [ITfSource::UnadviseSink](/windows/desktop/api/msctf/nf-msctf-itfsource-unadvisesink) is called with the appropriate cookie, the text service removes the menu extension.</span></span>

## <a name="related-topics"></a><span data-ttu-id="89c95-197">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="89c95-197">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="89c95-198">Como configurar a estrutura de serviços de texto</span><span class="sxs-lookup"><span data-stu-id="89c95-198">How To Set Up Text Services Framework</span></span>](how-to-set-up-tsf.md)
</dt> <dt>

[<span data-ttu-id="89c95-199">Barra de idiomas (aplicativos)</span><span class="sxs-lookup"><span data-stu-id="89c95-199">Language Bar (Applications)</span></span>](language-bar-app.md)
</dt> </dl>

 

 
