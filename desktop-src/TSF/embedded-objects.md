---
title: Objetos inseridos (estrutura de serviços de texto)
description: A estrutura de serviços de texto permite que um serviço de texto incorpore objetos em um fluxo de texto de aplicativo.
ms.assetid: 44cb22b5-707b-4f21-b986-5258ed273543
keywords:
- TSF (estrutura de serviços de texto), objetos inseridos
- TSF (estrutura de serviços de texto), objetos inseridos
- Aplicativos habilitados para TSF, objetos inseridos
- objetos inseridos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 39e4f819e6f42cc4e8d2ed81e47c79efe5ff7407
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/10/2020
ms.locfileid: "104560132"
---
# <a name="embedded-objects-text-services-framework"></a><span data-ttu-id="35819-107">Objetos inseridos (estrutura de serviços de texto)</span><span class="sxs-lookup"><span data-stu-id="35819-107">Embedded Objects (Text Services Framework)</span></span>

<span data-ttu-id="35819-108">A estrutura de serviços de texto permite que um serviço de texto incorpore objetos em um fluxo de texto de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="35819-108">Text Services Framework enables a text service to embed objects in an application text stream.</span></span> <span data-ttu-id="35819-109">Os objetos inseridos são inseridos no fluxo de texto usando o valor [TS \_ Char \_ inserido](ts-char--constants.md).</span><span class="sxs-lookup"><span data-stu-id="35819-109">Embedded objects are inserted into the text stream using the value [TS\_CHAR\_EMBEDDED](ts-char--constants.md).</span></span> <span data-ttu-id="35819-110">Esse valor é resolvido para o caractere de substituição de objeto Unicode U + fffc, usando a notação hexadecimal.</span><span class="sxs-lookup"><span data-stu-id="35819-110">This value resolves to the Unicode object replacement character U+fffc, using hexadecimal notation.</span></span> <span data-ttu-id="35819-111">Por exemplo, a ilustração a seguir mostra a renderização de um objeto inserido que representa *a ideograma* de CJK, em combinação com a sequência de caracteres Unicode que representa a tradução em inglês de "sol".</span><span class="sxs-lookup"><span data-stu-id="35819-111">For example, the following illustration shows the rendering of an embedded object that represents the Japanese ideograph *hi*, in combination with the sequence of Unicode characters that represent the English translation of "Sun."</span></span>

![codificação de caracteres de um objeto inserido](images/emb-obj.gif)

<span data-ttu-id="35819-113">A linha superior da figura contém o texto traduzido, que consiste na palavra "sol" seguida pelo caractere japonês para sol, *Olá*.</span><span class="sxs-lookup"><span data-stu-id="35819-113">The top row of the figure contains the translated text, consisting of the word "Sun" followed by the Japanese character for sun, *hi*.</span></span> <span data-ttu-id="35819-114">A linha central da figura mostra o caractere Unicode.</span><span class="sxs-lookup"><span data-stu-id="35819-114">The center row of the figure shows the Unicode character.</span></span> <span data-ttu-id="35819-115">No caso de U + fffc, esse é o caractere de substituição do objeto.</span><span class="sxs-lookup"><span data-stu-id="35819-115">In the case of U+fffc, this is the object replacement character.</span></span> <span data-ttu-id="35819-116">A linha inferior da figura mostra o valor hexadecimal de cada caractere.</span><span class="sxs-lookup"><span data-stu-id="35819-116">The bottom row of the figure shows the hexadecimal value of each character.</span></span>

## <a name="supporting-embedded-objects-in-an-application"></a><span data-ttu-id="35819-117">Suporte a objetos incorporados em um aplicativo</span><span class="sxs-lookup"><span data-stu-id="35819-117">Supporting Embedded Objects in an Application</span></span>

<span data-ttu-id="35819-118">O Gerenciador do TSF insere um objeto inserido no fluxo de texto chamando [ITextStoreACP:: InsertEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-insertembedded) para um aplicativo baseado em ACP ou [ITextStoreAnchor:: InsertEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-insertembedded) para um aplicativo baseado em âncora.</span><span class="sxs-lookup"><span data-stu-id="35819-118">The TSF manager inserts an embedded object into the text stream by calling [ITextStoreACP::InsertEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-insertembedded) for an ACP-based application, or [ITextStoreAnchor::InsertEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-insertembedded) for an anchor-based application.</span></span> <span data-ttu-id="35819-119">Quando um objeto inserido é inserido, o aplicativo deve colocar o valor de **TS \_ Char \_ inserido** na posição do caractere (ou no local da âncora) em que o objeto é inserido e armazenar o IDataObject associado ao objeto incorporado.</span><span class="sxs-lookup"><span data-stu-id="35819-119">When an embedded object is inserted, the application should place the **TS\_CHAR\_EMBEDDED** value at the character position (or anchor location) where the object is embedded and store the IDataObject associated with the embedded object.</span></span> <span data-ttu-id="35819-120">Quando [ITextStoreACP:: gettext](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-gettext) ou [ITextStoreAnchor:: gettext](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-gettext) é chamado e um objeto incorporado está contido no texto obtido, o valor **\_ \_ inserido de TS Char** indica a presença e o local do objeto inserido.</span><span class="sxs-lookup"><span data-stu-id="35819-120">When [ITextStoreACP::GetText](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-gettext) or [ITextStoreAnchor::GetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-gettext) is called and an embedded object is contained within the text obtained, the **TS\_CHAR\_EMBEDDED** value indicates the presence and location of the embedded object.</span></span> <span data-ttu-id="35819-121">Para obter o objeto incorporado, chame [ITextStoreACP:: getembedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-getembedded) com a posição de caractere do objeto inserido ou [ITextStoreAnchor:: getembedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-getembedded) com o local de âncora do objeto inserido.</span><span class="sxs-lookup"><span data-stu-id="35819-121">To obtain the embedded object, call [ITextStoreACP::GetEmbedded](/windows/desktop/api/textstor/nf-textstor-itextstoreacp-getembedded) with the character position of the embedded object, or [ITextStoreAnchor::GetEmbedded](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-getembedded) with the anchor location of the embedded object.</span></span>

<span data-ttu-id="35819-122">O aplicativo normalmente não reconhece o conteúdo do objeto inserido.</span><span class="sxs-lookup"><span data-stu-id="35819-122">The application does not normally recognize the embedded object contents.</span></span> <span data-ttu-id="35819-123">O aplicativo pode tentar obter informações de exibição do próprio objeto.</span><span class="sxs-lookup"><span data-stu-id="35819-123">The application can attempt to obtain display information from the object itself.</span></span> <span data-ttu-id="35819-124">Se o objeto incorporado puder fornecer dados em um formato reconhecido pelo aplicativo, como CF \_ UNICODETEXT ou \_ o bitmap CF, o aplicativo poderá exibir informações gráficas fornecidas pelo objeto.</span><span class="sxs-lookup"><span data-stu-id="35819-124">If the embedded object can supply data in a format that the application recognizes, such as CF\_UNICODETEXT or CF\_BITMAP, the application can display graphic information supplied by the object.</span></span>

## <a name="inserting-embedded-objects"></a><span data-ttu-id="35819-125">Inserindo objetos inseridos</span><span class="sxs-lookup"><span data-stu-id="35819-125">Inserting Embedded Objects</span></span>

<span data-ttu-id="35819-126">Um serviço de texto insere um objeto inserido em um contexto chamando [ITfRange:: InsertEmbedded](/windows/desktop/api/msctf/nf-msctf-itfrange-insertembedded) ou [ITfInsertAtSelection:: InsertEmbeddedAtSelection](/windows/desktop/api/msctf/nf-msctf-itfinsertatselection-insertembeddedatselection).</span><span class="sxs-lookup"><span data-stu-id="35819-126">A text service inserts an embedded object into a context by calling [ITfRange::InsertEmbedded](/windows/desktop/api/msctf/nf-msctf-itfrange-insertembedded) or [ITfInsertAtSelection::InsertEmbeddedAtSelection](/windows/desktop/api/msctf/nf-msctf-itfinsertatselection-insertembeddedatselection).</span></span> <span data-ttu-id="35819-127">O serviço de texto deve fornecer o IDataObject inserido.</span><span class="sxs-lookup"><span data-stu-id="35819-127">The text service must supply the embedded IDataObject.</span></span>

 

 
