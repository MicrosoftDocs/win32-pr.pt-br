---
title: Visão geral do modo de UILess
description: Visão geral do modo de UILess
ms.assetid: cc0e4936-eab1-452d-9ba1-188401918e99
keywords:
- TSF (estrutura de serviços de texto), UILessMode
- TSF (estrutura de serviços de texto), UILessMode
- Aplicativos habilitados para TSF, UILessMode
- UILessMode
- TSF (estrutura de serviços de texto), lista de candidatos UIElement
- TSF (estrutura de serviços de texto), UIElement de lista de candidatos
- Aplicativos habilitados para TSF, lista de candidatos UIElement
- UIElement da lista de candidatos
- TSF (estrutura de serviços de texto), dica UIElement
- TSF (estrutura de serviços de texto), dica UIElement
- Aplicativos habilitados para TSF, dica UIElement
- Dica UIElement
- TSF (estrutura de serviços de texto), elementos de interface do usuário predefinidos
- TSF (estrutura de serviços de texto), elementos de interface do usuário predefinidos
- Aplicativos habilitados para TSF, elementos de interface do usuário predefinidos
- elementos predefinidos da interface do usuário
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b7354a88fb28fd0d6bf5f4180ac23359a2117fe7
ms.sourcegitcommit: ee06501cc29132927ade9813e0888aaa4decc487
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/28/2021
ms.locfileid: "104554035"
---
# <a name="uiless-mode-overview"></a><span data-ttu-id="9b893-119">Visão geral do modo de UILess</span><span class="sxs-lookup"><span data-stu-id="9b893-119">UILess Mode Overview</span></span>

## <a name="how-to-create-uilessmode"></a><span data-ttu-id="9b893-120">Como criar UILessMode</span><span class="sxs-lookup"><span data-stu-id="9b893-120">How to create UILessMode</span></span>

<span data-ttu-id="9b893-121">**Criando thread sem interface do usuário:** O aplicativo pode tornar uma interface do usuário com menos thread por [**ITfThreadMgrEx:: ActivateEx**](/windows/desktop/api/Msctf/nf-msctf-itfthreadmgrex-activateex) com ITF \_ AE \_ UIELEMENTENABLEDONLY.</span><span class="sxs-lookup"><span data-stu-id="9b893-121">**Making UI-less Thread:** The application can make a UI Less Thread by [**ITfThreadMgrEx::ActivateEx**](/windows/desktop/api/Msctf/nf-msctf-itfthreadmgrex-activateex) with ITF\_AE\_UIELEMENTENABLEDONLY.</span></span> <span data-ttu-id="9b893-122">Quando ThreadMgr é ativado com esse sinalizador, somente as dicas que podem controlar seu elemento de interface do usuário são ativadas no thread.</span><span class="sxs-lookup"><span data-stu-id="9b893-122">When ThreadMgr is activated with this flag, only TIPs that can control its UI element are activated on the thread.</span></span> <span data-ttu-id="9b893-123">O aplicativo precisa implementar a interface [**ITfUIElementSink**](/windows/desktop/api/Msctf/nn-msctf-itfuielementsink) e aconselhar a interface no Gerenciador de threads.</span><span class="sxs-lookup"><span data-stu-id="9b893-123">The application needs to implement [**ITfUIElementSink**](/windows/desktop/api/Msctf/nn-msctf-itfuielementsink) interface and advise the interface into thread manager.</span></span> <span data-ttu-id="9b893-124">[**ITfUIElementSink:: BeginUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementsink-beginuielement) é chamado quando Tip mostra sua interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="9b893-124">[**ITfUIElementSink::BeginUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementsink-beginuielement) is called when TIP shows its UI.</span></span> <span data-ttu-id="9b893-125">O aplicativo pode retornar **true** no parâmetro pbShow para permitir que a dica mostre a interface do usuário original da dica quando o aplicativo não deseja desenhar.</span><span class="sxs-lookup"><span data-stu-id="9b893-125">The application can return **TRUE** in pbShow param to allow TIP to show TIP's original UI when the application does not want to draw.</span></span> <span data-ttu-id="9b893-126">Se o aplicativo não permitir a interface do usuário de TIP, ele poderá retornar **false** em pbShow (consulte os diagramas abaixo).</span><span class="sxs-lookup"><span data-stu-id="9b893-126">If the application does not allow TIP's UI, it can return **FALSE** in pbShow (see diagrams below).</span></span> <span data-ttu-id="9b893-127">O aplicativo pode desenhar a interface do usuário por si só obtendo algumas informações do parâmetro *pElement* .</span><span class="sxs-lookup"><span data-stu-id="9b893-127">The application can draw the UI by itself by getting some information from the *pElement* param.</span></span> <span data-ttu-id="9b893-128">Pode ser a lista de candidatos, o item de barra de idiomas ou a interface do usuário personalizada de TIP.</span><span class="sxs-lookup"><span data-stu-id="9b893-128">It could be the candidate list, the language bar item, or the custom UI of TIP.</span></span> <span data-ttu-id="9b893-129">O aplicativo pode saber o tipo de interface do usuário pela interface QIing [**ITfUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfuielement) .</span><span class="sxs-lookup"><span data-stu-id="9b893-129">The application can know the kind of UI by QIing [**ITfUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfuielement) interface.</span></span> <span data-ttu-id="9b893-130">Quando a interface do usuário é alterada, [**ITfUIElementSink:: UpdateUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementsink-updateuielement) é chamado.</span><span class="sxs-lookup"><span data-stu-id="9b893-130">When the UI is changed, [**ITfUIElementSink::UpdateUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementsink-updateuielement) is called.</span></span> <span data-ttu-id="9b893-131">O aplicativo pode comparar o GUID de pElement->GetGuid () para saber se o elemento está desenhado no momento pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9b893-131">The application can compare the GUID from pElement->GetGUID() to know if the element is currently drawn by the application.</span></span>

<span data-ttu-id="9b893-132">**Criando dica com menos reconhecimento à interface do usuário:** A TIP deve dar suporte ao modo menos de interface do usuário se quiser executar sob o aplicativo que não deseja permitir a interface do usuário da TIP, como aplicativos de jogo ou de tela inteira.</span><span class="sxs-lookup"><span data-stu-id="9b893-132">**Making UI-less Aware TIP:** TIP should support UI less mode if it wants to run under the application that does not want to allow TIP's UI such as game application or full screen applications.</span></span> <span data-ttu-id="9b893-133">Para ser menos ciente da interface do usuário, a TIP precisa implementar a interface [**ITfTextInputProcessorEx**](/windows/desktop/api/Msctf/nn-msctf-itftextinputprocessorex) .</span><span class="sxs-lookup"><span data-stu-id="9b893-133">To be UI less aware, TIP needs to implement [**ITfTextInputProcessorEx**](/windows/desktop/api/Msctf/nn-msctf-itftextinputprocessorex) interface.</span></span> <span data-ttu-id="9b893-134">Se essa interface não for implementada, a TIP não será ativada sob o thread de modo inferior da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="9b893-134">If this interface is not implemented, TIP will not be activated under the UI less mode thread.</span></span> <span data-ttu-id="9b893-135">Além disso, a TIP deve chamar [**ITFUIElementMgr:: BeginUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementmgr-beginuielement) antes de mostrar uma interface do usuário visível na tela.</span><span class="sxs-lookup"><span data-stu-id="9b893-135">In addition, TIP must call [**ITFUIElementMgr::BeginUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementmgr-beginuielement) before it shows a visible UI to the screen.</span></span> <span data-ttu-id="9b893-136">Esse método faz uma chamada para [**ITfUIElementSink**](/windows/desktop/api/Msctf/nn-msctf-itfuielementsink) para notificar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9b893-136">This method makes a call to [**ITfUIElementSink**](/windows/desktop/api/Msctf/nn-msctf-itfuielementsink) to notify the application.</span></span> <span data-ttu-id="9b893-137">E o aplicativo decidirá se ele pode ser mostrado ou não.</span><span class="sxs-lookup"><span data-stu-id="9b893-137">And the application will decide if it can be shown or not.</span></span> <span data-ttu-id="9b893-138">Quando TIP chama BeginUIElement (), a TIP precisa ter a interface [**ITfUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfuielement) para a interface do usuário correspondente.</span><span class="sxs-lookup"><span data-stu-id="9b893-138">When TIP calls BeginUIElement(), TIP needs to have the [**ITfUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfuielement) interface for the corresponding UI.</span></span> <span data-ttu-id="9b893-139">O aplicativo irá QI da interface para obter outra interface específica da interface do usuário para recuperar mais informações para desenhar a interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="9b893-139">The application will QI the interface to get another UI specific interface to retrieve more information to draw the UI.</span></span> <span data-ttu-id="9b893-140">O sistema predefine [**ITfCandidateListUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfcandidatelistuielement) e [**ITfReadingInformationUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfreadinginformationuielement) para Tip.</span><span class="sxs-lookup"><span data-stu-id="9b893-140">System predefines [**ITfCandidateListUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfcandidatelistuielement) and [**ITfReadingInformationUIElement**](/windows/desktop/api/Msctf/nn-msctf-itfreadinginformationuielement) for TIP.</span></span> <span data-ttu-id="9b893-141">Quando a dica deseja mostrar a lista de candidatos em thread de modo inferior da interface do usuário, a TIP deve criar uma instância da interface **ITfCandidateListUIElement** e chamar **ITFUIElementMgr:: BeginUIElement**.</span><span class="sxs-lookup"><span data-stu-id="9b893-141">When TIP wants to show the candidate list under UI less mode thread, TIP must create an instance of the **ITfCandidateListUIElement** interface and call **ITFUIElementMgr::BeginUIElement**.</span></span> <span data-ttu-id="9b893-142">Quando [**ITfTextInputProcessorEx:: ActivateEx**](/windows/desktop/api/Msctf/nf-msctf-itftextinputprocessorex-activateex) é chamado, a dica já sabe que o thread é a interface do usuário menos para que possa eliminar a interface do usuário personalizada extra.</span><span class="sxs-lookup"><span data-stu-id="9b893-142">When [**ITfTextInputProcessorEx::ActivateEx**](/windows/desktop/api/Msctf/nf-msctf-itftextinputprocessorex-activateex) is called, TIP already know the thread is UI less more so it can eliminate the extra custom UI.</span></span> <span data-ttu-id="9b893-143">No entanto, é claro que ele pode implementar sua própria interface que pode ser QIed e tentar fazer uma notificação.</span><span class="sxs-lookup"><span data-stu-id="9b893-143">However, of course, it can implement its own interface that can be QIed from and try to make a notification.</span></span> <span data-ttu-id="9b893-144">Portanto, a TIP e a **ITfUIElement** de aplicação podem ter uma negociação para a interface do usuário personalizada da TIP.</span><span class="sxs-lookup"><span data-stu-id="9b893-144">Thus TIP and the appli **ITfUIElement** cation can have a negotiation for the TIP custom UI.</span></span>

## <a name="uielement-supporting-tip"></a><span data-ttu-id="9b893-145">Dica de suporte a UIElement</span><span class="sxs-lookup"><span data-stu-id="9b893-145">UIElement Supporting TIP</span></span>

<span data-ttu-id="9b893-146">A dica que dá suporte ao UIElement deve ser categorizada por GUID \_ TFCAT \_ TIPCAP \_ UIELEMENTENABLED.</span><span class="sxs-lookup"><span data-stu-id="9b893-146">The TIP that supports the UIElement must be categorized by GUID\_TFCAT\_TIPCAP\_UIELEMENTENABLED.</span></span> <span data-ttu-id="9b893-147">A TIP no GUID \_ TFCAT \_ TIPCAP \_ UIELEMENTENABLED deve usar [**ITfUIElementMgr**](/windows/desktop/api/Msctf/nn-msctf-itfuielementmgr) para mostrar qualquer interface do usuário para que o aplicativo possa controlar a visibilidade da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="9b893-147">The TIP in GUID\_TFCAT\_TIPCAP\_UIELEMENTENABLED must use [**ITfUIElementMgr**](/windows/desktop/api/Msctf/nn-msctf-itfuielementmgr) to show any UI so the application can control the visibility of the UI.</span></span>

<span data-ttu-id="9b893-148">**Mostrar/ocultar status do UIElement:** Mostrar/ocultar status indicado pelo método [**ITfUIElement:: show**](/windows/desktop/api/Msctf/nf-msctf-itfuielement-show) ou [**ITfUIElement:: ismostren**](/windows/desktop/api/Msctf/nf-msctf-itfuielement-isshown) é o status real visível.</span><span class="sxs-lookup"><span data-stu-id="9b893-148">**Show/Hide status of UIElement:** Show/Hide status that is indicated by [**ITfUIElement::Show**](/windows/desktop/api/Msctf/nf-msctf-itfuielement-show) or [**ITfUIElement::IsShown**](/windows/desktop/api/Msctf/nf-msctf-itfuielement-isshown) method is the actual visible status.</span></span> <span data-ttu-id="9b893-149">Ele não está relacionado à disponibilidade do UIElement.</span><span class="sxs-lookup"><span data-stu-id="9b893-149">It is not related to the availability of UIElement.</span></span> <span data-ttu-id="9b893-150">O UIElement deve estar sempre disponível quando o status de exibição existir.</span><span class="sxs-lookup"><span data-stu-id="9b893-150">UIElement should be always available when the show status exists.</span></span> <span data-ttu-id="9b893-151">O status de exibição é controlável do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9b893-151">The show status is controllable from the application.</span></span> <span data-ttu-id="9b893-152">O aplicativo pode repentinamente mudar para o modo UILess e começar a desenhar alguma interface do usuário por si só, chamando **ITfUIElement:: show** com **false** para ocultar toda a interface do usuário de Tip.</span><span class="sxs-lookup"><span data-stu-id="9b893-152">The application may suddenly move into UILess mode and start drawing some UI by itself, by calling **ITfUIElement::Show** with **FALSE** to hide all the UI of TIP.</span></span> <span data-ttu-id="9b893-153">Em seguida, a TIP pode executar uma de algumas opções.</span><span class="sxs-lookup"><span data-stu-id="9b893-153">Then TIP can take one of some options.</span></span> <span data-ttu-id="9b893-154">1) a TIP pode mover o UIElement para o status de ocultar e começar a gerar UpdateUIElement.</span><span class="sxs-lookup"><span data-stu-id="9b893-154">1) TIP can move the UIElement to the Hide status and start generating UpdateUIElement.</span></span> <span data-ttu-id="9b893-155">2) a TIP pode concluir o UIElement, pois o elemento de interface do usuário não dá suporte a ocultar status e Tip chama enduielement () para concluí-lo.</span><span class="sxs-lookup"><span data-stu-id="9b893-155">2) TIP can finish UIElement since the UI element does not support Hide status and Tip calls EndUIElement() to finish it.</span></span>

## <a name="predefined-ui-elements"></a><span data-ttu-id="9b893-156">Elementos predefinidos da interface do usuário</span><span class="sxs-lookup"><span data-stu-id="9b893-156">Predefined UI Elements</span></span>

<span data-ttu-id="9b893-157">**A lista de candidatos:** A lista de candidatos é um dos principais elementos da interface do usuário para a entrada EA.</span><span class="sxs-lookup"><span data-stu-id="9b893-157">**The candidate list:** The candidate list is one of the major UI elements for EA input.</span></span> <span data-ttu-id="9b893-158">Este elemento de interface do usuário fornece a lista de candidatos e o número correspondente de cadeias de caracteres candidatas para desenho.</span><span class="sxs-lookup"><span data-stu-id="9b893-158">This UI Element provides the candidate list and corresponding number of the candidate strings for drawing.</span></span>

<span data-ttu-id="9b893-159">**A janela de informações de leitura** A janela de informações de leitura é comum para entrada de teclado chinês.</span><span class="sxs-lookup"><span data-stu-id="9b893-159">**The reading information window** The reading information window is common for Chinese Keyboard Input.</span></span> <span data-ttu-id="9b893-160">Ele tem o estágio que não pode ser inserido no documento como a cadeia de caracteres de composição.</span><span class="sxs-lookup"><span data-stu-id="9b893-160">It has the stage that cannot be inserted into the document as the composition string.</span></span> <span data-ttu-id="9b893-161">Um processador de entrada em chinês abre uma pequena janela de informações de leitura que mostra as informações de leitura, fonética ou digitação.</span><span class="sxs-lookup"><span data-stu-id="9b893-161">Some Chinese Input Processor opens a small reading information window that shows the reading, phonetic or typing information.</span></span>

## <a name="the-flow-chart-of-uilessmode"></a><span data-ttu-id="9b893-162">O gráfico de fluxo de UILessMode</span><span class="sxs-lookup"><span data-stu-id="9b893-162">The flow chart of UILessMode</span></span>

![Diagrama que mostra o gráfico de fluxo U I Lessmode.](images/tsf-uilessmode-ovw1.gif)

<span data-ttu-id="9b893-164">Depois que a dica recebe **true** em \* pbShown by [**ITfUIElementMgr:: BeginUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementmgr-beginuielement), a Tip não precisa chamar UpdateUIElement para o UIElement.</span><span class="sxs-lookup"><span data-stu-id="9b893-164">After the TIP receives **TRUE** in \*pbShown by [**ITfUIElementMgr::BeginUIElement**](/windows/desktop/api/Msctf/nf-msctf-itfuielementmgr-beginuielement), the TIP does not have to call UpdateUIElement for the UIElement.</span></span> <span data-ttu-id="9b893-165">Mas a TIP precisa chamar enduielement () para que o [**ITfUIElementMgr**](/windows/desktop/api/Msctf/nn-msctf-itfuielementmgr) e o aplicativo possam acompanhar o status de UIElement.</span><span class="sxs-lookup"><span data-stu-id="9b893-165">But TIP needs to call EndUIElement() so the [**ITfUIElementMgr**](/windows/desktop/api/Msctf/nn-msctf-itfuielementmgr) and the application can track the status of UIElement.</span></span> <span data-ttu-id="9b893-166">A TIP deve chamar UpdateUIElement () depois de BeginUIElement () retornar **false** em \* pbShow.</span><span class="sxs-lookup"><span data-stu-id="9b893-166">TIP must calls UpdateUIElement() after BeginUIElement() returns **FALSE** in \*pbShow.</span></span> <span data-ttu-id="9b893-167">O aplicativo que deseja desenhar a interface do usuário não verifica o conteúdo em BeginUIElement (), ele apenas retorna o status show em BeginUIElement () e inicia a verificação do conteúdo em UpdateUIElement ().</span><span class="sxs-lookup"><span data-stu-id="9b893-167">The application that wants to draw the UI does not check the contents in BeginUIElement(), it just returns the show status at BeginUIElement() and starts checking the contents at UpdateUIElement().</span></span> <span data-ttu-id="9b893-168">Por exemplo, o sinalizador de atualização da lista de candidatos UIElement tem todos os bits no primeiro UpdateUIElement ().</span><span class="sxs-lookup"><span data-stu-id="9b893-168">For example, the update flag of the candidate list UIElement has all bits at the first UpdateUIElement().</span></span> <span data-ttu-id="9b893-169">Isso significa que o conteúdo de UIElement não precisa estar pronto em BeginUIElement ().</span><span class="sxs-lookup"><span data-stu-id="9b893-169">This means that the contents of UIElement does not have to be ready at BeginUIElement().</span></span>

![Diagrama que mostra quando o T I P chama ' ITUIElementMgr:: BeginUIElement () ' e ' BeginUIElement de UIElementSink do aplicativo ' é chamado.](images/tsf-uilessmode-ovw2.gif)![O diagrama que mostra o aplicativo retorna falso em \* pbShow.](images/tsf-uilessmode-ovw3.gif)![gráfico de fluxo uilessmode](images/tsf-uilessmode-ovw4.gif)

## <a name="the-candidate-list-uielement"></a><span data-ttu-id="9b893-173">O UIElement da lista de candidatos</span><span class="sxs-lookup"><span data-stu-id="9b893-173">The candidate list UIElement</span></span>

<span data-ttu-id="9b893-174">**Sobre pageIndex:** O aplicativo que desenha a lista de candidatos calculará o número de cadeias de caracteres por página quando o conteúdo da lista for alterado (TF \_ CLUIE \_ cadeia de caracteres está definida).</span><span class="sxs-lookup"><span data-stu-id="9b893-174">**About PageIndex:** The application that draws the candidate list will calculate the number of strings per page when the contents of the list is changed (TF\_CLUIE\_STRING is set).</span></span> <span data-ttu-id="9b893-175">Não é bom alterar o índice da página enquanto a lista de candidatos está disponível para o modo UILess.</span><span class="sxs-lookup"><span data-stu-id="9b893-175">It is not good to change the page index while the candidate list is available for UILess mode.</span></span> <span data-ttu-id="9b893-176">Isso significa que a lista de candidatos da TIP deve se comportar com a paginação em vez de rolar quando a seleção for movida para a próxima página.</span><span class="sxs-lookup"><span data-stu-id="9b893-176">This means that TIP's candidate list should behave the paging rather than scrolling when the selection is moved to the next page.</span></span> <span data-ttu-id="9b893-177">Se a rolagem ocorrer na seleção for movida, o índice da página será alterado e o aplicativo precisará recalcular o índice da página.</span><span class="sxs-lookup"><span data-stu-id="9b893-177">If the scroll happens at the selection moves, the page index is changed and the application needs to recalculate the page index.</span></span> <span data-ttu-id="9b893-178">O resultado pode não ser esperado por TIP.</span><span class="sxs-lookup"><span data-stu-id="9b893-178">The result may not be expected by TIP.</span></span>

<span data-ttu-id="9b893-179">**Nenhuma seleção:** [**ITfCandidateListUIElement:: GetSelection**](/windows/desktop/api/Msctf/nf-msctf-itfcandidatelistuielement-getselection) retornará S \_ false, se a lista de candidatos não tiver uma seleção.</span><span class="sxs-lookup"><span data-stu-id="9b893-179">**No Selection:** [**ITfCandidateListUIElement::GetSelection**](/windows/desktop/api/Msctf/nf-msctf-itfcandidatelistuielement-getselection) returns S\_FALSE, if the candidate list does not have a selection.</span></span> <span data-ttu-id="9b893-180">O valor de retorno do primeiro parâmetro é inválido.</span><span class="sxs-lookup"><span data-stu-id="9b893-180">The return value of the first param is invalid.</span></span>

 

 




