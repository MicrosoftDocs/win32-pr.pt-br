---
title: Composições
description: Uma composição é um estado de entrada temporário que permite que um serviço de texto especifique tanto para o aplicativo quanto para o usuário que o texto de entrada ainda está em um estado de alteração.
ms.assetid: 3d9da4f2-ceb9-4abc-8979-d3756d948a57
keywords:
- TSF (estrutura de serviços de texto), composições
- TSF (estrutura de serviços de texto), composições
- serviços de texto, composições
- Aplicativos habilitados para TSF, composições
- compositions
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0b03f3e991f76ee7c6dca3830267796576c7b842
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104366488"
---
# <a name="compositions"></a><span data-ttu-id="5603b-108">Composições</span><span class="sxs-lookup"><span data-stu-id="5603b-108">Compositions</span></span>

<span data-ttu-id="5603b-109">Uma composição é um estado de entrada temporário que permite que um serviço de texto especifique tanto para o aplicativo quanto para o usuário que o texto de entrada ainda está em um estado de alteração.</span><span class="sxs-lookup"><span data-stu-id="5603b-109">A composition is a temporary input state that enables a text service to specify both to the application and the user that the input text is still in a state of change.</span></span> <span data-ttu-id="5603b-110">Um aplicativo pode e deve obter informações de atributo de exibição sobre a composição e usar essas informações para exibir o estado de composição para o usuário.</span><span class="sxs-lookup"><span data-stu-id="5603b-110">An application can and should obtain display attribute information about the composition and use this information to display the composition state to the user.</span></span>

<span data-ttu-id="5603b-111">Um exemplo do uso de uma composição é durante a entrada de fala.</span><span class="sxs-lookup"><span data-stu-id="5603b-111">One example of the use of a composition is during speech input.</span></span> <span data-ttu-id="5603b-112">Enquanto o usuário está falando, o serviço de texto de fala cria uma composição.</span><span class="sxs-lookup"><span data-stu-id="5603b-112">While the user is speaking, the speech text service creates a composition.</span></span> <span data-ttu-id="5603b-113">Essa composição permanecerá intacta até que toda a entrada de fala seja concluída.</span><span class="sxs-lookup"><span data-stu-id="5603b-113">This composition will remain intact until the entire speech input is complete.</span></span> <span data-ttu-id="5603b-114">Quando a sessão termina, o serviço de texto de fala termina a composição.</span><span class="sxs-lookup"><span data-stu-id="5603b-114">When the session ends, the speech text service terminates the composition.</span></span>

<span data-ttu-id="5603b-115">Um aplicativo usa a presença e a ausência de uma composição para determinar como exibir texto e o que, se houver, o processamento deve ser executado no texto.</span><span class="sxs-lookup"><span data-stu-id="5603b-115">An application uses the presence and absence of a composition to determine how to display text and what, if any, processing should be performed on the text.</span></span> <span data-ttu-id="5603b-116">Por exemplo, se o usuário estiver usando o mecanismo de fala para inserir texto, o aplicativo não deverá executar nenhuma verificação ortográfica ou gramatical em nenhum texto de composição.</span><span class="sxs-lookup"><span data-stu-id="5603b-116">For example, if the user is using the speech engine to input text, the application should not perform any spelling or grammar checking on any composition text.</span></span> <span data-ttu-id="5603b-117">O texto é considerado incompleto até que a composição seja encerrada.</span><span class="sxs-lookup"><span data-stu-id="5603b-117">The text is considered incomplete until the composition is terminated.</span></span>

## <a name="text-services"></a><span data-ttu-id="5603b-118">Serviços de texto</span><span class="sxs-lookup"><span data-stu-id="5603b-118">Text Services</span></span>

<span data-ttu-id="5603b-119">Um serviço de texto cria uma composição chamando [ITfContextComposition:: StartComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextcomposition-startcomposition).</span><span class="sxs-lookup"><span data-stu-id="5603b-119">A text service creates a composition by calling [ITfContextComposition::StartComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextcomposition-startcomposition).</span></span> <span data-ttu-id="5603b-120">Opcionalmente, o serviço de texto pode implementar um objeto [ITfCompositionSink](/windows/desktop/api/msctf/nn-msctf-itfcompositionsink) que recebe notificações de eventos de composição.</span><span class="sxs-lookup"><span data-stu-id="5603b-120">The text service can optionally implement an [ITfCompositionSink](/windows/desktop/api/msctf/nn-msctf-itfcompositionsink) object that receives composition event notifications.</span></span> <span data-ttu-id="5603b-121">StartComposition retorna um objeto [ITfComposition](/windows/desktop/api/msctf/nn-msctf-itfcomposition) ao qual o serviço de texto mantém uma referência e usa para modificar e encerrar a composição.</span><span class="sxs-lookup"><span data-stu-id="5603b-121">StartComposition returns an [ITfComposition](/windows/desktop/api/msctf/nn-msctf-itfcomposition) object that the text service keeps a reference to and uses to modify and terminate the composition.</span></span> <span data-ttu-id="5603b-122">O serviço de texto encerra a composição chamando [ITfComposition:: endcomposição](/windows/desktop/api/msctf/nf-msctf-itfcomposition-endcomposition).</span><span class="sxs-lookup"><span data-stu-id="5603b-122">The text service terminates the composition by calling [ITfComposition::EndComposition](/windows/desktop/api/msctf/nf-msctf-itfcomposition-endcomposition).</span></span>

<span data-ttu-id="5603b-123">Se um serviço de texto for criar composições, ele também deverá dar suporte a atributos de exibição para permitir que um aplicativo exiba o texto que faz parte de uma composição diferente do texto padrão.</span><span class="sxs-lookup"><span data-stu-id="5603b-123">If a text service is going to create compositions, it should also support display attributes to enable an application to display text that is part of a composition differently than standard text.</span></span> <span data-ttu-id="5603b-124">Para obter mais informações, consulte [fornecendo atributos de exibição](providing-display-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="5603b-124">For more information, see [Providing Display Attributes](providing-display-attributes.md).</span></span>

## <a name="applications"></a><span data-ttu-id="5603b-125">Aplicativos</span><span class="sxs-lookup"><span data-stu-id="5603b-125">Applications</span></span>

<span data-ttu-id="5603b-126">Um aplicativo pode monitorar a criação, a alteração e o encerramento de composições instalando um coletor [ITfContextOwnerCompositionSink](/windows/desktop/api/msctf/nn-msctf-itfcontextownercompositionsink) .</span><span class="sxs-lookup"><span data-stu-id="5603b-126">An application can monitor the creation, change and termination of compositions by installing an [ITfContextOwnerCompositionSink](/windows/desktop/api/msctf/nn-msctf-itfcontextownercompositionsink) sink.</span></span> <span data-ttu-id="5603b-127">Quando uma composição é iniciada, [ITfContextOwnerCompositionSink:: OnStartComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onstartcomposition) é chamado.</span><span class="sxs-lookup"><span data-stu-id="5603b-127">When a composition is started, [ITfContextOwnerCompositionSink::OnStartComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onstartcomposition) is called.</span></span> <span data-ttu-id="5603b-128">Da mesma forma, quando uma composição é alterada ou terminada, [ITfContextOwnerCompositionSink:: OnUpdateComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onupdatecomposition) e [ITfContextOwnerCompositionSink:: OnEndComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onendcomposition) será chamado, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="5603b-128">Likewise, when a composition is changed or terminated, [ITfContextOwnerCompositionSink::OnUpdateComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onupdatecomposition) and [ITfContextOwnerCompositionSink::OnEndComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionsink-onendcomposition) will be called, respectively.</span></span>

<span data-ttu-id="5603b-129">Veja a seguir um procedimento típico para atualizar um documento usando uma composição.</span><span class="sxs-lookup"><span data-stu-id="5603b-129">The following is a typical procedure to update a document using a composition.</span></span>

1.  <span data-ttu-id="5603b-130">[ITextStoreACP:: InsertTextAtSelection](/windows/desktop/api/Textstor/nf-textstor-itextstoreacp-inserttextatselection) ou [ITextStoreAnchor:: InsertTextAtSelection](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-inserttextatselection) normalmente são usados para inserir o texto inicial na composição.</span><span class="sxs-lookup"><span data-stu-id="5603b-130">[ITextStoreACP::InsertTextAtSelection](/windows/desktop/api/Textstor/nf-textstor-itextstoreacp-inserttextatselection) or [ITextStoreAnchor::InsertTextAtSelection](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-inserttextatselection) are typically used to insert the initial text into the composition.</span></span>
2.  <span data-ttu-id="5603b-131">A composição é iniciada com uma chamada para [ITfContextComposition:: StartComposition](/windows/desktop/api/Msctf/nf-msctf-itfcontextcomposition-startcomposition), usando o intervalo de texto retornado por **InsertTextAtSelection**.</span><span class="sxs-lookup"><span data-stu-id="5603b-131">The composition is started with a call to [ITfContextComposition::StartComposition](/windows/desktop/api/Msctf/nf-msctf-itfcontextcomposition-startcomposition), using the range of text returned by **InsertTextAtSelection**.</span></span>
3.  <span data-ttu-id="5603b-132">Quando recebe uma nova entrada, como entrada de teclado ou fala, o aplicativo atualiza a composição com [ITextStoreACP:: SetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreacp-settext) ou [ITextStoreAnchor:: SetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-settext).</span><span class="sxs-lookup"><span data-stu-id="5603b-132">When it receives new input such as speech or keyboard entry, the application updates the composition with [ITextStoreACP::SetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreacp-settext) or [ITextStoreAnchor::SetText](/windows/desktop/api/Textstor/nf-textstor-itextstoreanchor-settext).</span></span>
4.  <span data-ttu-id="5603b-133">Quando o aplicativo determina que é hora de encerrar a composição, ele chama [ITfComposition:: endcomposição](/windows/desktop/api/Msctf/nf-msctf-itfcomposition-endcomposition).</span><span class="sxs-lookup"><span data-stu-id="5603b-133">When the application determines that it is time to end the composition, it calls [ITfComposition::EndComposition](/windows/desktop/api/Msctf/nf-msctf-itfcomposition-endcomposition).</span></span>

<span data-ttu-id="5603b-134">O aplicativo deve usar os atributos de exibição fornecidos pelo serviço de texto para modificar a exibição do texto em todos os momentos e não apenas quando uma composição estiver ativa.</span><span class="sxs-lookup"><span data-stu-id="5603b-134">The application should use the display attributes provided by the text service to modify the display of text at all times and not just when a composition is active.</span></span> <span data-ttu-id="5603b-135">Para obter mais informações, consulte [usando atributos de exibição](using-display-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="5603b-135">For more information, see [Using Display Attributes](using-display-attributes.md).</span></span>

<span data-ttu-id="5603b-136">Se necessário, um aplicativo pode encerrar uma composição chamando [ITfContextOwnerCompositionServices:: TerminateComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionservices-terminatecomposition).</span><span class="sxs-lookup"><span data-stu-id="5603b-136">If necessary, an application can terminate a composition by calling [ITfContextOwnerCompositionServices::TerminateComposition](/windows/desktop/api/msctf/nf-msctf-itfcontextownercompositionservices-terminatecomposition).</span></span>

 

 