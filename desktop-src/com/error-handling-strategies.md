---
title: Estratégias de tratamento de erros
description: Estratégias de tratamento de erros
ms.assetid: 8d03ede8-0661-43dc-adaf-3c1f5fc1687e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 36c594a8b1e5baf0eab3d928b8f1b861b7f0160d
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/29/2020
ms.locfileid: "104453838"
---
# <a name="error-handling-strategies"></a><span data-ttu-id="ceb84-103">Estratégias de tratamento de erros</span><span class="sxs-lookup"><span data-stu-id="ceb84-103">Error Handling Strategies</span></span>

<span data-ttu-id="ceb84-104">Como os métodos de interface são virtuais, não é possível que um chamador conheça o conjunto completo de valores que podem ser retornados de qualquer chamada.</span><span class="sxs-lookup"><span data-stu-id="ceb84-104">Because interface methods are virtual, it is not possible for a caller to know the full set of values that may be returned from any one call.</span></span> <span data-ttu-id="ceb84-105">Uma implementação de um método pode retornar cinco valores; outra pode retornar oito.</span><span class="sxs-lookup"><span data-stu-id="ceb84-105">One implementation of a method may return five values; another may return eight.</span></span>

<span data-ttu-id="ceb84-106">A documentação lista os valores comuns que podem ser retornados para cada método; Esses são os valores que você deve verificar e manipular em seu código, pois eles têm significados especiais.</span><span class="sxs-lookup"><span data-stu-id="ceb84-106">The documentation lists common values that may be returned for each method; these are the values that you must check for and handle in your code because they have special meanings.</span></span> <span data-ttu-id="ceb84-107">Outros valores podem ser retornados, mas como não são significativos, você não precisa escrever código especial para tratá-los.</span><span class="sxs-lookup"><span data-stu-id="ceb84-107">Other values may be returned, but because they are not meaningful, you do not need to write special code to handle them.</span></span> <span data-ttu-id="ceb84-108">Uma verificação simples de zero ou diferente de 0 é adequada.</span><span class="sxs-lookup"><span data-stu-id="ceb84-108">A simple check for zero or nonzero is adequate.</span></span>

## <a name="hresult-values"></a><span data-ttu-id="ceb84-109">Valores HRESULT</span><span class="sxs-lookup"><span data-stu-id="ceb84-109">HRESULT Values</span></span>

<span data-ttu-id="ceb84-110">O valor de retorno de funções e métodos COM é um **HRESULT**.</span><span class="sxs-lookup"><span data-stu-id="ceb84-110">The return value of COM functions and methods is an **HRESULT**.</span></span> <span data-ttu-id="ceb84-111">Os valores de alguns HRESULTs foram alterados em COM para eliminar toda a duplicação e sobreposição com os códigos de erro do sistema.</span><span class="sxs-lookup"><span data-stu-id="ceb84-111">The values of some HRESULTs have been changed in COM to eliminate all duplication and overlapping with the system error codes.</span></span> <span data-ttu-id="ceb84-112">Aqueles que duplicam códigos de erro do sistema foram alterados para o \_ Win32 do recurso e aqueles que se sobrepõem permanecem em instalações \_ nulas.</span><span class="sxs-lookup"><span data-stu-id="ceb84-112">Those that duplicate system error codes have been changed to FACILITY\_WIN32, and those that overlap remain in FACILITY\_NULL.</span></span> <span data-ttu-id="ceb84-113">Os valores **HRESULT** comuns e seus valores são listados na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="ceb84-113">Common **HRESULT** values and their values are listed in the following table.</span></span>



| <span data-ttu-id="ceb84-114">HRESULT</span><span class="sxs-lookup"><span data-stu-id="ceb84-114">HRESULT</span></span>                    | <span data-ttu-id="ceb84-115">Valor</span><span class="sxs-lookup"><span data-stu-id="ceb84-115">Value</span></span>                 | <span data-ttu-id="ceb84-116">Descrição</span><span class="sxs-lookup"><span data-stu-id="ceb84-116">Description</span></span>                                                                                                                                        |
|----------------------------|-----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="ceb84-117">E \_ anular</span><span class="sxs-lookup"><span data-stu-id="ceb84-117">E\_ABORT</span></span><br/>        | <span data-ttu-id="ceb84-118">0x80004004</span><span class="sxs-lookup"><span data-stu-id="ceb84-118">0x80004004</span></span><br/> | <span data-ttu-id="ceb84-119">A operação foi anulada devido a um erro não especificado.</span><span class="sxs-lookup"><span data-stu-id="ceb84-119">The operation was aborted because of an unspecified error.</span></span><br/>                                                                              |
| <span data-ttu-id="ceb84-120">E \_ ACCESSDENIED</span><span class="sxs-lookup"><span data-stu-id="ceb84-120">E\_ACCESSDENIED</span></span><br/> | <span data-ttu-id="ceb84-121">0x80070005</span><span class="sxs-lookup"><span data-stu-id="ceb84-121">0x80070005</span></span><br/> | <span data-ttu-id="ceb84-122">Um erro geral de acesso negado.</span><span class="sxs-lookup"><span data-stu-id="ceb84-122">A general access-denied error.</span></span><br/>                                                                                                          |
| <span data-ttu-id="ceb84-123">E \_ falha</span><span class="sxs-lookup"><span data-stu-id="ceb84-123">E\_FAIL</span></span><br/>         | <span data-ttu-id="ceb84-124">0x80004005</span><span class="sxs-lookup"><span data-stu-id="ceb84-124">0x80004005</span></span><br/> | <span data-ttu-id="ceb84-125">Ocorreu uma falha não especificada.</span><span class="sxs-lookup"><span data-stu-id="ceb84-125">An unspecified failure has occurred.</span></span><br/>                                                                                                    |
| <span data-ttu-id="ceb84-126">\_identificador E</span><span class="sxs-lookup"><span data-stu-id="ceb84-126">E\_HANDLE</span></span><br/>       | <span data-ttu-id="ceb84-127">0x80070006</span><span class="sxs-lookup"><span data-stu-id="ceb84-127">0x80070006</span></span><br/> | <span data-ttu-id="ceb84-128">Um identificador inválido foi usado.</span><span class="sxs-lookup"><span data-stu-id="ceb84-128">An invalid handle was used.</span></span><br/>                                                                                                             |
| <span data-ttu-id="ceb84-129">E \_ INVALIDARG</span><span class="sxs-lookup"><span data-stu-id="ceb84-129">E\_INVALIDARG</span></span><br/>   | <span data-ttu-id="ceb84-130">0x80070057</span><span class="sxs-lookup"><span data-stu-id="ceb84-130">0x80070057</span></span><br/> | <span data-ttu-id="ceb84-131">Um ou mais argumentos são inválidos.</span><span class="sxs-lookup"><span data-stu-id="ceb84-131">One or more arguments are invalid.</span></span><br/>                                                                                                      |
| <span data-ttu-id="ceb84-132">E \_ NOinterface</span><span class="sxs-lookup"><span data-stu-id="ceb84-132">E\_NOINTERFACE</span></span><br/>  | <span data-ttu-id="ceb84-133">0x80004002</span><span class="sxs-lookup"><span data-stu-id="ceb84-133">0x80004002</span></span><br/> | <span data-ttu-id="ceb84-134">O método [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) não reconheceu a interface solicitada.</span><span class="sxs-lookup"><span data-stu-id="ceb84-134">The [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) method did not recognize the requested interface.</span></span> <span data-ttu-id="ceb84-135">Não há suporte para a interface.</span><span class="sxs-lookup"><span data-stu-id="ceb84-135">The interface is not supported.</span></span><br/> |
| <span data-ttu-id="ceb84-136">E \_ NOTIMPL</span><span class="sxs-lookup"><span data-stu-id="ceb84-136">E\_NOTIMPL</span></span><br/>      | <span data-ttu-id="ceb84-137">0x80004001</span><span class="sxs-lookup"><span data-stu-id="ceb84-137">0x80004001</span></span><br/> | <span data-ttu-id="ceb84-138">O método não está implementado.</span><span class="sxs-lookup"><span data-stu-id="ceb84-138">The method is not implemented.</span></span><br/>                                                                                                          |
| <span data-ttu-id="ceb84-139">E \_ OUTOFMEMORY</span><span class="sxs-lookup"><span data-stu-id="ceb84-139">E\_OUTOFMEMORY</span></span><br/>  | <span data-ttu-id="ceb84-140">0x8007000E</span><span class="sxs-lookup"><span data-stu-id="ceb84-140">0x8007000E</span></span><br/> | <span data-ttu-id="ceb84-141">O método não alocou a memória necessária.</span><span class="sxs-lookup"><span data-stu-id="ceb84-141">The method failed to allocate necessary memory.</span></span><br/>                                                                                         |
| <span data-ttu-id="ceb84-142">E \_ pendente</span><span class="sxs-lookup"><span data-stu-id="ceb84-142">E\_PENDING</span></span><br/>      | <span data-ttu-id="ceb84-143">0x8000000A</span><span class="sxs-lookup"><span data-stu-id="ceb84-143">0x8000000A</span></span><br/> | <span data-ttu-id="ceb84-144">Os dados necessários para concluir a operação ainda não estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="ceb84-144">The data necessary to complete the operation is not yet available.</span></span><br/>                                                                      |
| <span data-ttu-id="ceb84-145">\_ponteiro E</span><span class="sxs-lookup"><span data-stu-id="ceb84-145">E\_POINTER</span></span><br/>      | <span data-ttu-id="ceb84-146">0x80004003</span><span class="sxs-lookup"><span data-stu-id="ceb84-146">0x80004003</span></span><br/> | <span data-ttu-id="ceb84-147">Foi usado um ponteiro inválido.</span><span class="sxs-lookup"><span data-stu-id="ceb84-147">An invalid pointer was used.</span></span><br/>                                                                                                            |
| <span data-ttu-id="ceb84-148">E \_ inesperado</span><span class="sxs-lookup"><span data-stu-id="ceb84-148">E\_UNEXPECTED</span></span><br/>   | <span data-ttu-id="ceb84-149">0x8000FFFF</span><span class="sxs-lookup"><span data-stu-id="ceb84-149">0x8000FFFF</span></span><br/> | <span data-ttu-id="ceb84-150">Ocorreu uma falha catastrófica.</span><span class="sxs-lookup"><span data-stu-id="ceb84-150">A catastrophic failure has occurred.</span></span><br/>                                                                                                    |
| <span data-ttu-id="ceb84-151">\_falso</span><span class="sxs-lookup"><span data-stu-id="ceb84-151">S\_FALSE</span></span><br/>        | <span data-ttu-id="ceb84-152">0x00000001</span><span class="sxs-lookup"><span data-stu-id="ceb84-152">0x00000001</span></span><br/> | <span data-ttu-id="ceb84-153">O método foi bem-sucedido e retornou o valor booliano **false**.</span><span class="sxs-lookup"><span data-stu-id="ceb84-153">The method succeeded and returned the boolean value **FALSE**.</span></span><br/>                                                                          |
| <span data-ttu-id="ceb84-154">S \_ OK</span><span class="sxs-lookup"><span data-stu-id="ceb84-154">S\_OK</span></span><br/>           | <span data-ttu-id="ceb84-155">0x00000000</span><span class="sxs-lookup"><span data-stu-id="ceb84-155">0x00000000</span></span><br/> | <span data-ttu-id="ceb84-156">O método foi bem-sucedido.</span><span class="sxs-lookup"><span data-stu-id="ceb84-156">The method succeeded.</span></span> <span data-ttu-id="ceb84-157">Se um valor de retorno booliano for esperado, o valor retornado será **true**.</span><span class="sxs-lookup"><span data-stu-id="ceb84-157">If a boolean return value is expected, the returned value is **TRUE**.</span></span><br/>                                            |



 

## <a name="network-errors"></a><span data-ttu-id="ceb84-158">Erros de rede</span><span class="sxs-lookup"><span data-stu-id="ceb84-158">Network Errors</span></span>

<span data-ttu-id="ceb84-159">Se os quatro primeiros dígitos do código de erro forem 8007, isso indicará um erro de sistema ou de rede.</span><span class="sxs-lookup"><span data-stu-id="ceb84-159">If the first four digits of the error code are 8007, this indicates a system or network error.</span></span> <span data-ttu-id="ceb84-160">Você pode usar o comando **net** para decodificar esses tipos de erros.</span><span class="sxs-lookup"><span data-stu-id="ceb84-160">You can use the **net** command to decode these types of errors.</span></span> <span data-ttu-id="ceb84-161">Para decodificar o erro, primeiro converta os últimos quatro dígitos do código de erro hexadecimal em decimal.</span><span class="sxs-lookup"><span data-stu-id="ceb84-161">To decode the error, first convert the last four digits of the hexadecimal error code to decimal.</span></span> <span data-ttu-id="ceb84-162">Em seguida, no prompt de comando, digite o seguinte, em que o código decimal é substituído pelo valor de retorno que você deseja decodificar:</span><span class="sxs-lookup"><span data-stu-id="ceb84-162">Then, at the command prompt, type the following, where decimal code is replaced with the return value you want to decode:</span></span>

<span data-ttu-id="ceb84-163">**NET HELPMSG <***\_ código decimal***>**</span><span class="sxs-lookup"><span data-stu-id="ceb84-163">**net helpmsg <***decimal\_code***>**</span></span>

<span data-ttu-id="ceb84-164">O comando net retorna uma descrição do erro.</span><span class="sxs-lookup"><span data-stu-id="ceb84-164">The net command returns a description of the error.</span></span> <span data-ttu-id="ceb84-165">Por exemplo, se COM retornar o erro 8007054B, converta o 054B para decimal (1355).</span><span class="sxs-lookup"><span data-stu-id="ceb84-165">For example, if COM returns the error 8007054B, convert the 054B to decimal (1355).</span></span> <span data-ttu-id="ceb84-166">Depois, digite o seguinte:</span><span class="sxs-lookup"><span data-stu-id="ceb84-166">Then type the following:</span></span>

<span data-ttu-id="ceb84-167">**NET HELPMSG 1355**</span><span class="sxs-lookup"><span data-stu-id="ceb84-167">**net helpmsg 1355**</span></span>

<span data-ttu-id="ceb84-168">O comando net retorna a descrição do erro: "o domínio especificado não existia".</span><span class="sxs-lookup"><span data-stu-id="ceb84-168">The net command returns the error description: "The specified domain did not exist".</span></span>

## <a name="related-topics"></a><span data-ttu-id="ceb84-169">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="ceb84-169">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="ceb84-170">Tratamento de erro em COM</span><span class="sxs-lookup"><span data-stu-id="ceb84-170">Error Handling in COM</span></span>](error-handling-in-com.md)
</dt> </dl>

 

 





