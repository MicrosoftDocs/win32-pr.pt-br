---
title: Fazendo e processando chamadas assíncronas
description: Objetos COM podem dar suporte à chamada assíncrona.
ms.assetid: bf7f9f8e-66ce-41a4-854c-62dbe840a89e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 059f55cc64a70f130e7fb654426803edbe8b7209
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "105770576"
---
# <a name="making-and-processing-asynchronous-calls"></a><span data-ttu-id="95bd8-103">Fazendo e processando chamadas assíncronas</span><span class="sxs-lookup"><span data-stu-id="95bd8-103">Making and Processing Asynchronous Calls</span></span>

<span data-ttu-id="95bd8-104">Objetos COM podem dar suporte à chamada assíncrona.</span><span class="sxs-lookup"><span data-stu-id="95bd8-104">COM objects can support asynchronous calling.</span></span> <span data-ttu-id="95bd8-105">Quando um cliente faz uma chamada assíncrona, o controle retorna ao cliente imediatamente.</span><span class="sxs-lookup"><span data-stu-id="95bd8-105">When a client makes an asynchronous call, control returns to the client immediately.</span></span> <span data-ttu-id="95bd8-106">Enquanto o servidor processa a chamada, o cliente está livre para realizar outros trabalhos.</span><span class="sxs-lookup"><span data-stu-id="95bd8-106">While the server processes the call, the client is free to do other work.</span></span> <span data-ttu-id="95bd8-107">Quando o cliente não puder mais continuar sem os resultados da chamada, ele poderá obter os resultados da chamada nesse momento.</span><span class="sxs-lookup"><span data-stu-id="95bd8-107">When the client can no longer proceed without the results of the call, it can get the results of the call at that time.</span></span>

<span data-ttu-id="95bd8-108">Por exemplo, uma solicitação para um conjunto de registros grande ou complexo pode ser demorada.</span><span class="sxs-lookup"><span data-stu-id="95bd8-108">For example, a request for a large or complex recordset can be time-consuming.</span></span> <span data-ttu-id="95bd8-109">Um cliente pode solicitar o conjunto de registros por uma chamada assíncrona e, em seguida, fazer outro trabalho.</span><span class="sxs-lookup"><span data-stu-id="95bd8-109">A client can request the recordset by an asynchronous call and then do other work.</span></span> <span data-ttu-id="95bd8-110">Quando o conjunto de registros está disponível, o cliente pode obtê-lo rapidamente sem bloqueio.</span><span class="sxs-lookup"><span data-stu-id="95bd8-110">When the recordset is available, the client can obtain it quickly without blocking.</span></span>

<span data-ttu-id="95bd8-111">Os clientes não fazem chamadas assíncronas diretamente no objeto de servidor.</span><span class="sxs-lookup"><span data-stu-id="95bd8-111">Clients do not make asynchronous calls directly on the server object.</span></span> <span data-ttu-id="95bd8-112">Em vez disso, eles obtêm um objeto de chamada que implementa uma versão assíncrona de uma interface síncrona no objeto Server.</span><span class="sxs-lookup"><span data-stu-id="95bd8-112">Instead, they obtain a call object that implements an asynchronous version of a synchronous interface on the server object.</span></span> <span data-ttu-id="95bd8-113">A interface assíncrona no objeto de chamada tem um nome do formato Async *InterfaceName*.</span><span class="sxs-lookup"><span data-stu-id="95bd8-113">The asynchronous interface on the call object has a name of the form Async *InterfaceName*.</span></span> <span data-ttu-id="95bd8-114">Por exemplo, se um objeto de servidor implementar uma interface síncrona chamada IMinhaInterface, haverá um objeto de chamada que implementa uma interface assíncrona denominada AsyncIMyInterface.</span><span class="sxs-lookup"><span data-stu-id="95bd8-114">For example, if a server object implements a synchronous interface named IMyInterface, there will be a call object that implements an asynchronous interface named AsyncIMyInterface.</span></span>

> [!Note]  
> <span data-ttu-id="95bd8-115">O suporte assíncrono não está disponível para **IDispatch** ou para interfaces que herdam **IDispatch**.</span><span class="sxs-lookup"><span data-stu-id="95bd8-115">Asynchronous support is not available for **IDispatch** or for interfaces that inherit **IDispatch**.</span></span>

 

<span data-ttu-id="95bd8-116">Objetos de servidor que dão suporte a chamadas assíncronas implementam a interface [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) .</span><span class="sxs-lookup"><span data-stu-id="95bd8-116">Server objects that support asynchronous calls implement the [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) interface.</span></span> <span data-ttu-id="95bd8-117">Essa interface expõe um único método, [**createchama**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall), que cria uma instância de um objeto de chamada especificado.</span><span class="sxs-lookup"><span data-stu-id="95bd8-117">This interface exposes a single method, [**CreateCall**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall), which creates an instance of a specified call object.</span></span> <span data-ttu-id="95bd8-118">Os clientes podem consultar **ICallFactory** para determinar se um objeto dá suporte à chamada assíncrona.</span><span class="sxs-lookup"><span data-stu-id="95bd8-118">Clients can query for **ICallFactory** to determine whether an object supports asynchronous calling.</span></span>

<span data-ttu-id="95bd8-119">Para cada método em uma interface síncrona, a interface assíncrona correspondente implementa dois métodos.</span><span class="sxs-lookup"><span data-stu-id="95bd8-119">For each method on a synchronous interface, the corresponding asynchronous interface implements two methods.</span></span> <span data-ttu-id="95bd8-120">Esses métodos anexam os prefixos Begin \_ e Finish \_ ao nome do método síncrono.</span><span class="sxs-lookup"><span data-stu-id="95bd8-120">These methods attach the prefixes Begin\_ and Finish\_ to the name of the synchronous method.</span></span> <span data-ttu-id="95bd8-121">Por exemplo, se uma interface chamada ISimpleStream tiver um método Read, a interface AsyncISimpleStream terá um método Begin \_ Read e Finish \_ Read.</span><span class="sxs-lookup"><span data-stu-id="95bd8-121">For example, if an interface named ISimpleStream has a Read method, the AsyncISimpleStream interface will have a Begin\_Read and a Finish\_Read method.</span></span> <span data-ttu-id="95bd8-122">Para iniciar uma chamada assíncrona, o cliente chama o \_ método Begin.</span><span class="sxs-lookup"><span data-stu-id="95bd8-122">To begin an asynchronous call, the client calls the Begin\_ method.</span></span>

<span data-ttu-id="95bd8-123">Ao implementar um objeto de servidor, você não precisa fornecer um objeto de chamada para cada interface que o objeto implementa.</span><span class="sxs-lookup"><span data-stu-id="95bd8-123">When you implement a server object, you do not have to provide a call object for every interface the object implements.</span></span> <span data-ttu-id="95bd8-124">Se o objeto de servidor implementar a interface [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) e usar o marshaling padrão, um cliente com marshaling pode sempre obter um objeto de chamada de proxy, mesmo que não haja nenhum objeto de chamada no lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="95bd8-124">If the server object implements the [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) interface and uses standard marshaling, a marshaled client can always obtain a proxy call object, even if there is no call object on the server side.</span></span> <span data-ttu-id="95bd8-125">Esse proxy realizará marshaling do \_ método Begin como uma chamada síncrona, o servidor processará a chamada de forma síncrona e o cliente poderá obter os parâmetros de saída chamando o \_ método Finish.</span><span class="sxs-lookup"><span data-stu-id="95bd8-125">This proxy will marshal the Begin\_ method as a synchronous call, the server will process the call synchronously, and the client can obtain the out parameters by calling the Finish\_ method.</span></span>

<span data-ttu-id="95bd8-126">Por outro lado, se um cliente fizer uma chamada síncrona com marshaling em uma interface para a qual há um objeto de chamada no lado do servidor, o servidor sempre processará a chamada de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="95bd8-126">Conversely, if a client makes a marshaled synchronous call on an interface for which there is a call object on the server side, the server will always process the call asynchronously.</span></span> <span data-ttu-id="95bd8-127">Esse comportamento não será aparente para o cliente, pois o cliente receberá os mesmos parâmetros de saída e o mesmo valor de retorno que ele teria recebido do método síncrono.</span><span class="sxs-lookup"><span data-stu-id="95bd8-127">This behavior will not be apparent to the client, because the client will receive the same out parameters and the same return value it would have received from the synchronous method.</span></span>

<span data-ttu-id="95bd8-128">Em ambos os casos, a interação entre o cliente e o servidor é empacotada como se a chamada fosse síncrona: a saída de proxies síncronos e assíncronos é indistinguíveis, assim como a saída dos stubs correspondentes.</span><span class="sxs-lookup"><span data-stu-id="95bd8-128">In either case, the interaction between client and server is marshaled as if the call were synchronous: The output of synchronous and asynchronous proxies is indistinguishable, as is the output of the corresponding stubs.</span></span> <span data-ttu-id="95bd8-129">Esse comportamento simplifica muito o modelo de programação tanto de clientes quanto de servidores.</span><span class="sxs-lookup"><span data-stu-id="95bd8-129">This behavior greatly simplifies the programming model both of clients and of servers.</span></span> <span data-ttu-id="95bd8-130">Se um objeto de servidor implementar [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory), um cliente com marshaling não precisa tentar criar um objeto de chamada que pode não estar disponível – para o cliente, um objeto de chamada estará sempre disponível.</span><span class="sxs-lookup"><span data-stu-id="95bd8-130">If a server object implements [**ICallFactory**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory), a marshaled client does not have to attempt to create a call object that may not be available — to the client, a call object is always available.</span></span>

<span data-ttu-id="95bd8-131">Quando o cliente e o servidor estiverem no mesmo apartamento, o objeto de servidor processará qualquer chamada que o cliente fizer.</span><span class="sxs-lookup"><span data-stu-id="95bd8-131">When client and server are in the same apartment, the server object will process whichever call the client makes.</span></span> <span data-ttu-id="95bd8-132">Se um objeto de chamada não estiver disponível, o cliente deverá obter explicitamente a interface síncrona e fazer uma chamada síncrona.</span><span class="sxs-lookup"><span data-stu-id="95bd8-132">If a call object is not available, the client must explicitly obtain the synchronous interface and make a synchronous call.</span></span>

<span data-ttu-id="95bd8-133">Para mais informações, consulte os seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="95bd8-133">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="95bd8-134">Fazendo uma chamada assíncrona</span><span class="sxs-lookup"><span data-stu-id="95bd8-134">Making an Asynchronous Call</span></span>](making-an-asynchronous-call.md)
-   [<span data-ttu-id="95bd8-135">Cancelando uma chamada assíncrona</span><span class="sxs-lookup"><span data-stu-id="95bd8-135">Canceling an Asynchronous Call</span></span>](canceling-an-asynchronous-call.md)
-   [<span data-ttu-id="95bd8-136">Cancelando chamadas de método</span><span class="sxs-lookup"><span data-stu-id="95bd8-136">Canceling Method Calls</span></span>](canceling-method-calls.md)
-   [<span data-ttu-id="95bd8-137">Sincronização de chamadas</span><span class="sxs-lookup"><span data-stu-id="95bd8-137">Call Synchronization</span></span>](call-synchronization.md)

 

 