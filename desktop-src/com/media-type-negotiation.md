---
title: Negociação de Media-Type
description: Muitos protocolos de Internet de camada de aplicativo são baseados na troca de mensagens em um formato simples e flexível chamado MIME (Multipurpose Internet Mail Extensions).
ms.assetid: 7a2c9d8f-639a-4865-a62b-63330175f5f0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb145fa3a76da6574172ddd24888f3b5da7ad85e
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104366771"
---
# <a name="media-type-negotiation"></a><span data-ttu-id="245ae-103">Negociação de Media-Type</span><span class="sxs-lookup"><span data-stu-id="245ae-103">Media-Type Negotiation</span></span>

<span data-ttu-id="245ae-104">Muitos protocolos de Internet de camada de aplicativo são baseados na troca de mensagens em um formato simples e flexível chamado MIME (Multipurpose Internet Mail Extensions).</span><span class="sxs-lookup"><span data-stu-id="245ae-104">Many application-layer Internet protocols are based on the exchange of messages in a simple, flexible format called Multipurpose Internet Mail Extensions (MIME).</span></span> <span data-ttu-id="245ae-105">Embora o MIME tenha sido originado como um padrão para a troca de mensagens de email eletrônica, ele é usado hoje por uma ampla variedade de aplicativos para especificar formatos de dados mutuamente compreendidos como MIME, ou tipos de mídia.</span><span class="sxs-lookup"><span data-stu-id="245ae-105">Although MIME originated as a standard for exchanging electronic mail messages, it is used today by a wide variety of applications to specify mutually understood data formats as MIME, or media, types.</span></span> <span data-ttu-id="245ae-106">O processo é chamado de *negociação de tipo de mídia*.</span><span class="sxs-lookup"><span data-stu-id="245ae-106">The process is called *media-type negotiation*.</span></span>

<span data-ttu-id="245ae-107">Os tipos de mídia são cadeias de caracteres simples que denotam um tipo e subtipo (como "texto/simples" ou "texto/HTML").</span><span class="sxs-lookup"><span data-stu-id="245ae-107">Media types are simple strings that denote a type and subtype (such as "text/plain" or "text/HTML").</span></span> <span data-ttu-id="245ae-108">Eles são usados para rotular dados ou qualificar uma solicitação.</span><span class="sxs-lookup"><span data-stu-id="245ae-108">They are used to label data or qualify a request.</span></span> <span data-ttu-id="245ae-109">Um navegador da Web, por exemplo, como parte de um HTTP Request-for-data ou Request-for-info, especifica que ele está solicitando os tipos de mídia "image/gif" ou "image/jpeg", ao qual um servidor Web responde retornando o tipo de mídia apropriado e, se a chamada foi uma solicitação-para-dados, os dados em si no formato solicitado</span><span class="sxs-lookup"><span data-stu-id="245ae-109">A Web browser, for example, as part of an HTTP request-for-data or request-for-info, specifies that it is requesting "image/gif" or "image/jpeg" Media Types, to which a web server responds by returning the appropriate media type and, if the call was a request-for-data, the data itself in the requested format.</span></span>

<span data-ttu-id="245ae-110">A negociação de tipo de mídia geralmente é semelhante a como os aplicativos de área de trabalho existentes negociam com a área de transferência do sistema para determinar qual formato de dados colar quando um usuário escolhe Editar/colar ou consultas para formatos ao receber um ponteiro do [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) durante uma operação de arrastar e soltar.</span><span class="sxs-lookup"><span data-stu-id="245ae-110">Media-type negotiation is often similar to how existing desktop applications negotiate with the system clipboard to determine which data format to paste when a user chooses Edit/Paste or queries for formats when receiving an [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) pointer during a drag-and-drop operation.</span></span> <span data-ttu-id="245ae-111">A diferença sutil na negociação do tipo de mídia HTTP é que o cliente não sabe antecipadamente quais formatos o servidor está disponível.</span><span class="sxs-lookup"><span data-stu-id="245ae-111">The subtle difference in HTTP media-type negotiation is that the client does not know ahead of time which formats the server has available.</span></span> <span data-ttu-id="245ae-112">Portanto, o cliente especifica os tipos de mídia aos quais ele dá suporte, em ordem de maior fidelidade, e o servidor responde com o melhor formato disponível.</span><span class="sxs-lookup"><span data-stu-id="245ae-112">Therefore, the client specifies up-front the media types it supports, in order of greatest fidelity, and the server responds with the best available format.</span></span>

<span data-ttu-id="245ae-113">Os monikers de URL dão suporte à negociação de tipo de mídia como uma maneira para os clientes e servidores da Internet concordarem em formatos a serem usados ao baixar dados em operações [**BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage) .</span><span class="sxs-lookup"><span data-stu-id="245ae-113">URL monikers support media-type negotiation as a way for Internet clients and servers to agree upon formats to be used when downloading data in [**BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage) operations.</span></span> <span data-ttu-id="245ae-114">Para dar suporte à negociação de tipo de mídia, um cliente implementa a interface [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) e chama a função [**RegisterFormatEnumerator**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775116(v=vs.85)) para registrá-la com o contexto de associação.</span><span class="sxs-lookup"><span data-stu-id="245ae-114">To support media-type negotiation, a client implements the [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) interface and calls the [**RegisterFormatEnumerator**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775116(v=vs.85)) function to register it with the bind context.</span></span> <span data-ttu-id="245ae-115">O enumerador de formato lista os formatos que o cliente pode aceitar.</span><span class="sxs-lookup"><span data-stu-id="245ae-115">The format enumerator lists the formats the client can accept.</span></span> <span data-ttu-id="245ae-116">Um moniker de URL converte esses formatos em tipos de mídia ao ligar a URLs HTTP.</span><span class="sxs-lookup"><span data-stu-id="245ae-116">A URL moniker translates these formats into media types when binding to HTTP URLs.</span></span>

<span data-ttu-id="245ae-117">Os tipos de mídia possíveis solicitados pelo cliente são representados para os monikers de URL por meio de estruturas [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) disponíveis no enumerador [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) registrado pelo chamador no contexto de associação: cada **FORMATETC** especifica um formato de área de transferência que identifica o tipo de mídia.</span><span class="sxs-lookup"><span data-stu-id="245ae-117">The possible media types requested by the client are represented to URL monikers through [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structures available from the [**IEnumFORMATETC**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) enumerator registered by the caller on the bind context: Each **FORMATETC** specifies a clipboard format identifying the media type.</span></span> <span data-ttu-id="245ae-118">Por exemplo, o fragmento de código a seguir especifica que o tipo de mídia é PostScript.</span><span class="sxs-lookup"><span data-stu-id="245ae-118">For example, the following code fragment specifies that the media type is PostScript.</span></span>

``` syntax
FORMATETC fmtetc;
fmtetc.cfFormat = RegisterClipboardFormat(CF_MIME_POSTSCRIPT);
. . .
```

<span data-ttu-id="245ae-119">Um cliente pode definir o formato da área de transferência para o tipo de mídia especial CF \_ NULL para indicar que o tipo de mídia padrão do recurso apontado pela URL deve ser recuperado.</span><span class="sxs-lookup"><span data-stu-id="245ae-119">A client can set the clipboard format to the special media type CF\_NULL to indicate that the default media type of the resource pointed to by the URL should be retrieved.</span></span> <span data-ttu-id="245ae-120">Esse formato é geralmente o último em que o cliente está interessado.</span><span class="sxs-lookup"><span data-stu-id="245ae-120">This format is usually the last one in which the client is interested.</span></span> <span data-ttu-id="245ae-121">Quando nenhum enumerador é registrado com o contexto de ligação, um moniker de URL funciona como se um enumerador contendo um único [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) com **cfFormat**= CF \_ NULL estiver disponível, baixando automaticamente o tipo de mídia padrão.</span><span class="sxs-lookup"><span data-stu-id="245ae-121">When no enumerator is registered with the bind context, a URL moniker works as if an enumerator containing a single [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) with **cfFormat**=CF\_NULL is available, automatically downloading the default media-type.</span></span>

<span data-ttu-id="245ae-122">Seja qual for o tipo de mídia a ser usado, o cliente é notificado sobre a escolha por meio do argumento *pFormatetc* em seu método [**IBindStatusCallback:: OnDataAvailable**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775061(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="245ae-122">Whatever media type is to be used, the client is notified of the choice by means of the *pformatetc* argument on its [**IBindStatusCallback::OnDataAvailable**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775061(v=vs.85)) method.</span></span> <span data-ttu-id="245ae-123">O retorno de chamada ocorre no contexto da chamada do cliente para [**BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage).</span><span class="sxs-lookup"><span data-stu-id="245ae-123">The callback occurs within the context of the client's call to [**BindToStorage**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtostorage).</span></span>

> [!Note]  
> <span data-ttu-id="245ae-124">Se o conteúdo recebido for de um tipo de mídia não reconhecido, o cliente chamará automaticamente [**RegisterMediaTypes**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775118(v=vs.85)) para registrar o novo tipo.</span><span class="sxs-lookup"><span data-stu-id="245ae-124">If received content is of an unrecognized media-type, the client automatically calls [**RegisterMediaTypes**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775118(v=vs.85)) to register the new type.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="245ae-125">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="245ae-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="245ae-126">Identificadores de URL</span><span class="sxs-lookup"><span data-stu-id="245ae-126">URL Monikers</span></span>](url-monikers.md)
</dt> </dl>

 

 