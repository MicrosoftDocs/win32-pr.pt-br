---
title: O manipulador de Client-Side leve
description: Os manipuladores leves do lado do cliente permitem criar manipuladores gerais do lado do cliente de qualquer tamanho, para ajudá-lo a fazer qualquer tipo de tarefa padrão.
ms.assetid: b712237c-55d7-4f52-9cf6-19c6e5fb3182
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f1e8df5be24e8773a660a4d0208b27a2f585e32
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "103641909"
---
# <a name="the-lightweight-client-side-handler"></a><span data-ttu-id="abee6-103">O manipulador de Client-Side leve</span><span class="sxs-lookup"><span data-stu-id="abee6-103">The Lightweight Client-Side Handler</span></span>

<span data-ttu-id="abee6-104">Os manipuladores leves do lado do cliente permitem criar manipuladores gerais do lado do cliente de qualquer tamanho, para ajudá-lo a fazer qualquer tipo de tarefa padrão.</span><span class="sxs-lookup"><span data-stu-id="abee6-104">Lightweight client-side handlers allow you to create general client-side handlers of any size, to help you do any kind of standard task.</span></span> <span data-ttu-id="abee6-105">Como manipuladores, eles podem ser usados por mais de um cliente.</span><span class="sxs-lookup"><span data-stu-id="abee6-105">As handlers, these are usable by more than one client.</span></span> <span data-ttu-id="abee6-106">Elas diferem dos manipuladores OLE, pois não podem ser criadas antes de o servidor ser iniciado, e seu tempo de vida está vinculado ao Gerenciador de proxy, impedindo uma possível condição de corrida na qual o manipulador poderia, de outra forma, ser lançado prematuramente.</span><span class="sxs-lookup"><span data-stu-id="abee6-106">They differ from OLE handlers in that they cannot be created before the server is launched, and their lifetime is tied to that of the proxy manager, preventing a possible race condition in which the handler could otherwise be prematurely released.</span></span>

<span data-ttu-id="abee6-107">O Gerenciador de proxy é o objeto criado pelo sistema que implementa a interface [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) .</span><span class="sxs-lookup"><span data-stu-id="abee6-107">The proxy manager is the system-created object that implements the [**IMarshal**](/windows/win32/api/objidlbase/nn-objidlbase-imarshal) interface.</span></span> <span data-ttu-id="abee6-108">Se você usar o marshaling padrão, o sistema o criará para você quando chamar [**CoGetStandardMarshal**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstandardmarshal) (ou [**CoGetStdMarshalEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstdmarshalex), para criar um marshaler agregado para manipuladores leves) e também implementará as interfaces [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) e [**IMultiQI**](/windows/win32/api/objidlbase/nn-objidlbase-imultiqi) no objeto.</span><span class="sxs-lookup"><span data-stu-id="abee6-108">If you use standard marshaling, the system creates it for you when you call [**CoGetStandardMarshal**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstandardmarshal) (or [**CoGetStdMarshalEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetstdmarshalex), for creating an aggregated marshaler for lightweight handlers) and also implements the [**IClientSecurity**](/windows/desktop/api/ObjIdl/nn-objidl-iclientsecurity) and [**IMultiQI**](/windows/win32/api/objidlbase/nn-objidlbase-imultiqi) interfaces on the object.</span></span> <span data-ttu-id="abee6-109">No lado do servidor, há um objeto do sistema correspondente que também implementa **IMarshal**.</span><span class="sxs-lookup"><span data-stu-id="abee6-109">On the server side, there is a corresponding system object that also implements **IMarshal**.</span></span> <span data-ttu-id="abee6-110">Esses objetos manipulam o marshaling para você de forma transparente.</span><span class="sxs-lookup"><span data-stu-id="abee6-110">These objects handle marshaling for you transparently.</span></span>

<span data-ttu-id="abee6-111">Há dois tipos gerais desses manipuladores que você talvez queira implementar:</span><span class="sxs-lookup"><span data-stu-id="abee6-111">There are two general types of these handlers that you may want to implement:</span></span>

-   <span data-ttu-id="abee6-112">Um manipulador que executa um serviço que não requer dados adicionais do servidor</span><span class="sxs-lookup"><span data-stu-id="abee6-112">A handler that performs a service that requires no extra data from the server</span></span>
-   <span data-ttu-id="abee6-113">Um manipulador que usa dados adicionais do servidor</span><span class="sxs-lookup"><span data-stu-id="abee6-113">A handler that uses extra data from the server</span></span>

<span data-ttu-id="abee6-114">Alguns usos potenciais dos dados adicionais no fluxo fornecido pelo servidor são os seguintes:</span><span class="sxs-lookup"><span data-stu-id="abee6-114">Some potential uses of the extra data in the stream supplied by the server are as follows:</span></span>

-   <span data-ttu-id="abee6-115">Dados estáticos do servidor.</span><span class="sxs-lookup"><span data-stu-id="abee6-115">Static data from server.</span></span> <span data-ttu-id="abee6-116">Independentemente da interface específica que está sendo empacotada, o servidor grava os mesmos dados no fluxo.</span><span class="sxs-lookup"><span data-stu-id="abee6-116">Regardless of the particular interface being marshaled, the server writes the same data into the stream.</span></span>
-   <span data-ttu-id="abee6-117">Dados por interface do servidor.</span><span class="sxs-lookup"><span data-stu-id="abee6-117">Per-interface data from server.</span></span> <span data-ttu-id="abee6-118">Dependendo de qual interface específica está sendo empacotada, o servidor pode gravar dados diferentes no fluxo.</span><span class="sxs-lookup"><span data-stu-id="abee6-118">Depending on which particular interface is being marshaled, the server may write different data into the stream.</span></span>
-   <span data-ttu-id="abee6-119">Auxiliares por interface.</span><span class="sxs-lookup"><span data-stu-id="abee6-119">Per-interface helpers.</span></span> <span data-ttu-id="abee6-120">Componentes COM por interface agregados ao manipulador de cliente e à delegação ao proxy padrão.</span><span class="sxs-lookup"><span data-stu-id="abee6-120">Per-interface COM components aggregated into the client handler and delegating to the standard proxy.</span></span> <span data-ttu-id="abee6-121">Por exemplo, para melhorar o desempenho da rede, um componente COM para [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) poderia fazer cache de dados do lado do cliente, leitura antecipada, gravação por trás, bloqueio de op e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="abee6-121">For example, to improve network performance, a COM component for [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) could do client-side caching of data, read-ahead, write-behind, op-locking, and so forth.</span></span>
-   <span data-ttu-id="abee6-122">Versão de rede de uma interface.</span><span class="sxs-lookup"><span data-stu-id="abee6-122">Network version of an interface.</span></span> <span data-ttu-id="abee6-123">A versão de rede da interface é diferente da interface exposta pelo código do aplicativo cliente e servidor.</span><span class="sxs-lookup"><span data-stu-id="abee6-123">The network version of the interface is different from the interface exposed by the client and server application code.</span></span> <span data-ttu-id="abee6-124">É possível, por exemplo, multiplexar interfaces expostas IA e IB sobre o mesmo adaptador de rede INetAB, a maneira que o manipulador de servidor de incorporação faz.</span><span class="sxs-lookup"><span data-stu-id="abee6-124">It is possible, for example, to multiplex exposed interfaces IA and IB over the same network interface INetAB, the way the embedding server handler does.</span></span> <span data-ttu-id="abee6-125">Por exemplo, é possível converter uma interface de transferência de dados em uma interface de rede que usa pipes para transferência de dados eficiente.</span><span class="sxs-lookup"><span data-stu-id="abee6-125">For example, one could convert a data transfer interface into a network interface that uses pipes for efficient data transfer.</span></span>

<span data-ttu-id="abee6-126">Os clientes de nível inferior podem não ter a capacidade de desempacotamento de interfaces que têm manipuladores personalizados, por dois motivos: primeiro, eles podem não entender o CLSID usado no pacote empacotado personalizado quando o manipulador de servidor é agregado e o objeto deseja um manipulador.</span><span class="sxs-lookup"><span data-stu-id="abee6-126">Down-level clients may not have the capability of unmarshaling interfaces that have custom handlers, for two reasons: First, they may not understand the CLSID used in the custom marshaled packet when the server handler is aggregated and the object wants a handler.</span></span> <span data-ttu-id="abee6-127">Em segundo lugar, o código do manipulador pode nem mesmo ser executado no lado do cliente se ele exigir uma nova funcionalidade de COM para criar o marshaler padrão agregado e fazer chamadas de [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) remotas.</span><span class="sxs-lookup"><span data-stu-id="abee6-127">Second, the handler code may not even run on the client side if it requires new functionality from COM to create the aggregated standard marshaler and to do remote [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) calls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="abee6-128">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="abee6-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="abee6-129">O manipulador OLE</span><span class="sxs-lookup"><span data-stu-id="abee6-129">The OLE Handler</span></span>](the-ole-handler.md)
</dt> </dl>

 

 