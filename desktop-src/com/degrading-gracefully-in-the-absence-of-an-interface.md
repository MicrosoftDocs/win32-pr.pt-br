---
title: Degradando normalmente na ausência de uma interface
description: Como um controle pode não dar suporte a nenhuma interface diferente de IUnknown, um contêiner precisa ser degradado normalmente quando encontra a ausência de qualquer interface específica.
ms.assetid: 1b833900-2357-4b39-b88d-5ee6321f488e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fef1b329faa2d4da333cf2e201fc887764af96bc5ea2573060f41774b57c0d56
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/11/2021
ms.locfileid: "119501266"
---
# <a name="degrading-gracefully-in-the-absence-of-an-interface"></a>Degradando normalmente na ausência de uma interface

Como um controle pode não dar suporte a nenhuma interface diferente de [**IUnknown,**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown)um contêiner precisa ser degradado normalmente quando encontra a ausência de qualquer interface específica.

Pode-se questioná-lo sobre a utilidade de um controle com nada além [**de IUnknown.**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) Mas considere as vantagens que um controle recebe do ambiente de programação visual de um contêiner (como VB) quando o contêiner reconhece o objeto como um controle:

-   Um botão para o objeto aparece em uma caixa de ferramentas.
-   É possível criar um objeto arrastando-o da caixa de ferramentas para um formulário.
-   É possível dar ao objeto um nome que seja reconhecido no ambiente de programação visual.
-   O mesmo nome em (3) acima pode ser usado imediatamente na escrita de qualquer outro código para controles no mesmo formato (ou até mesmo em um formato diferente).
-   O contêiner pode fornecer automaticamente pontos de entrada de código para todos os eventos disponíveis desse objeto.
-   O contêiner fornece sua própria interface do usuário de navegação de propriedade para todas as propriedades disponíveis.

Quando um objeto não é reconhecido como um controle, ele potencialmente perde todos esses recursos de integração muito poderosos e benéficos. Por exemplo, no Visual Basic 4.0, é muito difícil integrar algum objeto aleatório que não é um controle no sentido completo, mas ainda pode ter propriedades e eventos. Como Visual Basic ideia 4 de um controle é muito restritiva, o objeto não ganha nenhum dos recursos de integração acima. Mas até mesmo um controle com [**IUnknown,**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown)em que o tempo de vida do controle determina a existência de algum recurso, deve ser capaz de obter os recursos de integração descritos acima.

Como as ferramentas atuais exigem um grande conjunto de interfaces de controle para obter qualquer vantagem, os controles geralmente são levados à super-implementação, de modo que contêm mais código do que realmente precisam. Controles que podem ter 7K podem acabar sendo 25 mil, o que é um grande problema de desempenho em áreas como a Internet. Isso também levou à percepção de que só é possível implementar um controle com uma ferramenta como a CDK devido à complexidade da implementação de todas as interfaces e isso tem implicações quando uma DLL grande como OC30.DLL é necessária para esse controle, aumentando o conjunto de trabalho. Se nem todas as interfaces são necessárias, isso abre muitos desenvolvedores para escrever controles muito pequenos e leves com o OLE simples ou com outras ferramentas também, minimizando a sobrecarga para cada controle.

É por isso que esse apêndice reconhece um controle como qualquer objeto com uma CLSID e uma interface [**IUnknown.**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) Mesmo com nada além de IUnknown, um contêiner com um ambiente de programação deve ser capaz de fornecer pelo menos recursos 3 e ) entrada do registro, ele obtém \# \# 1 e \# 2. Se o objeto fornece [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) (e [**IProvideClassInfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo) em geral) para algum conjunto de eventos, ele obtém 5 e, se ele dá suporte a \# **IDispatch** para propriedades e métodos, ele obtém 6, bem como melhor integração de código no \# contêiner.

Em resumo, um objeto deve ser capaz de implementar tão pouco quanto **IDispatch** e um conjunto de eventos exposto por meio de [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) para obter todos esses recursos visuais acima.

Com isso em mente, a tabela a seguir descreve o que um contêiner pode fazer na ausência de qualquer interface possível. Observe que apenas essas interfaces são listadas que o contêiner obterá diretamente por [**meio de QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)). Outras interfaces, como [**IOleInPlaceActiveObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceactiveobject), são obtidas por outros meios.



| Interface                                                                                                             | Significado da ausência da interface                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|-----------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)<br/>                                                                       | O controle não tem visuais que ele desenhará por conta própria, portanto, não tem nenhuma extensão definida a ser fornecidas. Em tempo de executar, o contêiner simplesmente não tenta desenhar nada quando essa interface está ausente. Em tempo de design, o contêiner deve, pelo menos, desenhar algum tipo de retângulo padrão com um nome para esse controle, para que um usuário em um ambiente de programação visual possa selecionar o objeto e conferir suas propriedades, métodos e eventos existentes. Lidar com a ausência de [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) é essencial para um bom suporte à programação visual.<br/> |
| [**Ioleobject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject)<br/>                                                                           | O controle não precisa do site, nem faz parte de nenhuma negociação de layout de objeto inserido. Todas as informações (como as extensão de controle) que um contêiner possa esperar dessa interface devem ser preenchidas com os padrões fornecidos pelo contêiner.<br/>                                                                                                                                                                                                                                                                                                       |
| [**Ioleinplaceobject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceobject)<br/>                                                             | O controle não in-locar ativo (como um rótulo) e, portanto, nunca tenta ativar dessa maneira. Sua única ativação pode ser suas páginas de propriedades.<br/>                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**Iolecontrol**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrol)<br/>                                                                         | O controle não tem mnemônicos e não usa propriedades de ambiente e não se importa se o contêiner ignora eventos. Na ausência dessa interface, o contêiner simplesmente não chama seus métodos.<br/>                                                                                                                                                                                                                                                                                                                                                                         |
| [**Idataobject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                         | O controle não fornece nenhum conjunto de propriedades nem nenhuma renderização visual que possa ser armazenada em cache, portanto, o contêiner optaria por armazenar em cache alguma apresentação padrão na ausência dessa interface (suporte para CF METAFILEPICT, especificamente) e desabilitar qualquer funcionalidade relacionada ao conjunto de \_ propriedades.<br/>                                                                                                                                                                                                                                                                            |
| **IDispatch**<br/>                                                                                              | O controle não tem propriedades ou métodos personalizados. O contêiner não precisa tentar mostrar nenhuma propriedade de controle nesse caso e deve não permitir nenhuma chamada de método personalizada que o contêiner não reconheça como pertencente a seus próprios controles estendidos (que podem dar suporte a métodos e propriedades). Como os controles estendidos geralmente delegam determinadas chamadas **IDispatch** para o controle, um controle estendido não deve esperar que o controle tenha **IDispatch.**<br/>                                                                                          |
| [**Iconnectionpointcontainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer)<br/>                                             | O controle não tem eventos, portanto, o contêiner não precisa pensar em lidar com nenhum.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**Iprovideclassinfo**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo)<br/> [**Iprovideclassinfo2**](/windows/desktop/api/OCIdl/nn-ocidl-iprovideclassinfo2)<br/> | O controle não tem informações de tipo ou eventos ou o contêiner precisa entrar nas informações de tipo do controle por meio das entradas do Registro do controle. A existência dessa interface é uma otimização.<br/>                                                                                                                                                                                                                                                                                                                                            |
| [**Ispecifypropertypages**](/windows/desktop/api/OCIdl/nn-ocidl-ispecifypropertypages)<br/>                                                     | O controle não tem páginas de propriedades, portanto, se o contêiner tiver qualquer interface do usuário que as invocaria, o contêiner deverá desabilitar essa interface do usuário.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [**IPerPropertyBrowsing**](/windows/desktop/api/OCIdl/nn-ocidl-iperpropertybrowsing)<br/>                                                       | O controle não tem nenhum nome de exibição em si, nenhuma cadeia de caracteres e valores predeterminados e nenhuma propriedade para mapeamento de página. Essa interface é quase sempre usada para gerar a interface do usuário do contêiner, portanto, esses elementos de interface do usuário seriam desabilitados na ausência dessa interface.<br/>                                                                                                                                                                                                                                                                                                 |
| Ipersist\*<br/>                                                                                                 | O controle não tem estado persistente para falar, portanto, o contêiner não precisa se preocupar em salvar dados específicos do controle. O contêiner, é claro, salvará suas próprias informações sobre o controle em sua própria forma ou documento, mas o próprio controle não tem nada para contribuir com essas informações.<br/>                                                                                                                                                                                                                                                        |
| [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache)<br/> [**IOleCache2**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache2)<br/>                                 | O objeto não dá suporte ao cache. Um contêiner ainda pode dar suporte ao cache apenas criando um cache de dados usando [**CreateDataCache**](/windows/desktop/api/ObjBase/nf-objbase-createdatacache).<br/>                                                                                                                                                                                                                                                                                                                                                                                                    |



 

## <a name="related-topics"></a>Tópicos relacionados

<dl> <dt>

[Contêineres](containers.md)
</dt> </dl>

 

 





