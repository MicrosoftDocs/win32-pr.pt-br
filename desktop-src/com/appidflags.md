---
title: AppIDFlags
description: Um conjunto de sinalizadores que controlam o comportamento de ativação de um servidor COM.
ms.assetid: ab98e7d3-85c6-4328-84c4-1d4583df69ce
keywords:
- COM valor do registro AppIDFlags COM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cdad2b80625d6a60460d43f242d7897e0ae7eb40
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "105791374"
---
# <a name="appidflags"></a><span data-ttu-id="1e9c4-104">AppIDFlags</span><span class="sxs-lookup"><span data-stu-id="1e9c4-104">AppIDFlags</span></span>

<span data-ttu-id="1e9c4-105">Um conjunto de sinalizadores que controlam o comportamento de ativação de um servidor COM.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-105">A set of flags that control the activation behavior of a COM server.</span></span>

## <a name="registry-entry"></a><span data-ttu-id="1e9c4-106">Entrada do Registro</span><span class="sxs-lookup"><span data-stu-id="1e9c4-106">Registry Entry</span></span>

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID
   {AppID_GUID}
      AppIDFlags = flags
```

## <a name="remarks"></a><span data-ttu-id="1e9c4-107">Comentários</span><span class="sxs-lookup"><span data-stu-id="1e9c4-107">Remarks</span></span>

<span data-ttu-id="1e9c4-108">Esse é um valor de **reg \_ DWORD** .</span><span class="sxs-lookup"><span data-stu-id="1e9c4-108">This is a **REG\_DWORD** value.</span></span>



| <span data-ttu-id="1e9c4-109">Valor de sinalizador</span><span class="sxs-lookup"><span data-stu-id="1e9c4-109">Flag Value</span></span> | <span data-ttu-id="1e9c4-110">Constante</span><span class="sxs-lookup"><span data-stu-id="1e9c4-110">Constant</span></span>                                              |
|------------|-------------------------------------------------------|
| <span data-ttu-id="1e9c4-111">0x1</span><span class="sxs-lookup"><span data-stu-id="1e9c4-111">0x1</span></span>        | <span data-ttu-id="1e9c4-112">APPIDREGFLAGS \_ ativar o \_ IUSERVER \_ indesktop</span><span class="sxs-lookup"><span data-stu-id="1e9c4-112">APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP</span></span>          |
| <span data-ttu-id="1e9c4-113">0x2</span><span class="sxs-lookup"><span data-stu-id="1e9c4-113">0x2</span></span>        | <span data-ttu-id="1e9c4-114">\_ \_ processo de servidor seguro APPIDREGFLAGS \_ \_ \_ de SD e \_ ligação</span><span class="sxs-lookup"><span data-stu-id="1e9c4-114">APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND</span></span> |
| <span data-ttu-id="1e9c4-115">0x4</span><span class="sxs-lookup"><span data-stu-id="1e9c4-115">0x4</span></span>        | <span data-ttu-id="1e9c4-116">\_ \_ RPC de ativação do problema APPIDREGFLAGS \_ \_ em \_ identificar</span><span class="sxs-lookup"><span data-stu-id="1e9c4-116">APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY</span></span>   |



 

### <a name="appidregflags_activate_iuserver_indesktop-description"></a><span data-ttu-id="1e9c4-117">APPIDREGFLAGS \_ Ativar \_ \_ Descrição de INárea de trabalho do IUSERVER</span><span class="sxs-lookup"><span data-stu-id="1e9c4-117">APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP Description</span></span>

<span data-ttu-id="1e9c4-118">Se o sinalizador **APPIDREGFLAGS \_ ativar o \_ \_ indesktop IUSERVER** for limpo em **AppIDFlags** ou se **AppIDFlags** não estiver presente, o cliente em uma sessão do Terminal Server fazendo uma solicitação de ativação para um servidor com de [usuário interativo](interactive-user.md) se associará ou iniciará e associará ao servidor com na área de trabalho "padrão" da estação de [janela](/windows/desktop/winstation/window-stations) "winsta0" da sessão na solicitação de ativação.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-118">If the **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag is cleared in **AppIDFlags** or if **AppIDFlags** is not present, the client in a terminal server session making an activation request for an [Interactive User](interactive-user.md) COM server, will either bind to, or launch and bind to, the COM server in the "default" desktop of the "winsta0" [window station](/windows/desktop/winstation/window-stations) of the session in the activation request.</span></span> <span data-ttu-id="1e9c4-119">Por exemplo, se o cliente estiver executando "winsta0 \\ desktop1" da sessão 3, a solicitação de ativação para a sessão 3 será associada ou iniciada e associada ao servidor com em "winsta0 \\ padrão" da sessão 3, mesmo que uma instância do servidor com já esteja em execução em "winsta0 \\ desktop1" da sessão 3.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-119">For example, if the client is running "winsta0\\desktop1" of session 3, the activation request for session 3 will either bind to, or launch and bind to, the COM server in "winsta0\\default" of session 3, even if an instance of the COM server is already running in "winsta0\\desktop1" of session 3.</span></span>

<span data-ttu-id="1e9c4-120">Se o sinalizador **APPIDREGFLAGS \_ ativar o \_ \_ indesktop IUSERVER** for definido no valor **AppIDFlags** , o com será associado ou iniciado e associado ao processo do servidor em execução na área de trabalho do cliente e na sessão na solicitação de ativação.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-120">If the **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag is set in the **AppIDFlags** value, COM will either bind to, or launch and bind to, the server process running in the client's desktop and the session in the activation request.</span></span> <span data-ttu-id="1e9c4-121">Por exemplo, se o cliente estiver executando "winsta0 \\ desktop1" na sessão 3, a solicitação de ativação para a sessão 3 será associada ou iniciada e associada ao servidor com em "winsta0 \\ desktop1" na sessão 3, mesmo que uma instância do servidor com já esteja em execução em "winsta0 \\ padrão" na sessão 3.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-121">For example, if the client is running "winsta0\\desktop1" in session 3, the activation request for session 3 will either bind to, or launch and bind to, the COM server in "winsta0\\desktop1" in session 3, even if an instance of the COM server is already running in "winsta0\\default" in session 3.</span></span>

<span data-ttu-id="1e9c4-122">O cliente pode usar o [moniker de sessão](/windows/desktop/TermServ/session-monikers) para especificar uma sessão diferente da sessão do cliente quando ele faz a solicitação de ativação.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-122">The client can use the [session moniker](/windows/desktop/TermServ/session-monikers) to specify a session different than the client's session when it makes the activation request.</span></span>

<span data-ttu-id="1e9c4-123">O sinalizador **APPIDREGFLAGS \_ ativar o \_ \_ indesktop IUSERVER** aplica-se somente a servidores com que são configurados para "[usuário interativo](interactive-user.md)" runas.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-123">The **APPIDREGFLAGS\_ACTIVATE\_IUSERVER\_INDESKTOP** flag applies only to COM servers that are configured to RunAs "[Interactive User](interactive-user.md)".</span></span>

### <a name="appidregflags_secure_server_process_sd_and_bind-description"></a><span data-ttu-id="1e9c4-124">APPIDREGFLAGS \_ o \_ \_ processo de servidor seguro \_ SD e a \_ \_ Descrição de ligação</span><span class="sxs-lookup"><span data-stu-id="1e9c4-124">APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND Description</span></span>

<span data-ttu-id="1e9c4-125">Se o **sinalizador \_ \_ \_ \_ SD \_ e \_ BIND do APPIDREGFLAGS Secure Server** for definido em **AppIDFlags**, os servidores com configurados para executar como runas "Activator" serão iniciados com um descritor de segurança do processo que permite [processar \_ todo o \_ acesso](/windows/desktop/ProcThread/process-security-and-access-rights) ao SID de LogonId do token de processo.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-125">If the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set in **AppIDFlags**, COM servers that are configured to RunAs "Activator" will be launched with a process security descriptor that allows [PROCESS\_ALL\_ACCESS](/windows/desktop/ProcThread/process-security-and-access-rights) to the LogonID SID of the process token.</span></span> <span data-ttu-id="1e9c4-126">Além disso, o proprietário do descritor de segurança será definido como o SID de LogonId do token de processo.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-126">In addition, the owner of the security descriptor will be set to the LogonID SID of the process token.</span></span>

<span data-ttu-id="1e9c4-127">Se o **sinalizador \_ \_ \_ \_ SD \_ e \_ BIND do APPIDREGFLAGS Secure Server** for definido em **AppIDFlags**, os servidores com configurados para executar como "este usuário" serão iniciados com um descritor de segurança do processo que permite [processar \_ todo o \_ acesso](/windows/desktop/ProcThread/process-security-and-access-rights) no SID de LogonId do token de processo.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-127">If the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set in **AppIDFlags**, COM servers that are configured to RunAs "This User" will be launched with a process security descriptor that allows [PROCESS\_ALL\_ACCESS](/windows/desktop/ProcThread/process-security-and-access-rights) in the LogonID SID of the process token.</span></span> <span data-ttu-id="1e9c4-128">Além disso, o proprietário do descritor de segurança será definido como o SID de LogonId do token de processo.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-128">In addition, the owner of the security descriptor will be set to the LogonID SID of the process token.</span></span> <span data-ttu-id="1e9c4-129">Além disso, o SCM (Gerenciador de controle de serviço) do COM modifica o token do processo do servidor COM da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="1e9c4-129">Further, the COM Service Control Manager (SCM) modifies the token of the COM server process as follows:</span></span>

-   <span data-ttu-id="1e9c4-130">Ele adiciona um SID do APPID ao token.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-130">It adds an APPID SID to the token.</span></span> <span data-ttu-id="1e9c4-131">Ele concede ao APPID SID Full Access na DACL (lista de controle de acesso discricionário) padrão do token.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-131">It grants the APPID SID full access in the token default discretionary access control list (DACL).</span></span> <span data-ttu-id="1e9c4-132">No Windows Vista e versões posteriores do Windows, ele concede a permissão de controle de leitura de SID OwnerRights \_ na DACL padrão do token.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-132">In Windows Vista and later versions of Windows, it grants the OwnerRights SID READ\_CONTROL permission in the token default DACL.</span></span> <span data-ttu-id="1e9c4-133">Nas versões anteriores ao Windows Vista do Windows, ele define o proprietário do token para o SID do APPID.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-133">In pre-Windows Vista versions of Windows, it sets the token owner to the APPID SID.</span></span>

<span data-ttu-id="1e9c4-134">As considerações de segurança a seguir devem ser levadas em conta ao usar o **\_ processo de servidor seguro APPIDREGFLAGS do SD e o sinalizador \_ \_ \_ \_ de \_ ligação** :</span><span class="sxs-lookup"><span data-stu-id="1e9c4-134">The following security considerations must be taken into account when using the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag:</span></span>

-   <span data-ttu-id="1e9c4-135">O **sinalizador \_ \_ \_ \_ SD \_ e \_ BIND do APPIDREGFLAGS Secure Server** deve ser definido por servidores com que são iniciados em um dos contextos de segurança do serviço interno; tanto as contas NetworkService quanto LocalService.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-135">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is meant to be set by COM servers that are launched under one of the built-in service security contexts; either the NetworkService or the LocalService accounts.</span></span> <span data-ttu-id="1e9c4-136">Se os servidores representarem clientes privilegiados e se o sinalizador **\_ \_ \_ \_ SD \_ e \_ BIND do APPIDREGFLAGS Secure Server** não estiver definido, o código mal-intencionado em execução em outros processos com o mesmo contexto de segurança poderá elevar o privilégio ao seqüestrar os tokens de representação dos clientes com privilégios do processo do servidor com.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-136">If the servers impersonate privileged clients and if the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is not set, malicious code running in other processes with the same security context can elevate privilege by hijacking the impersonation tokens of the privileged clients from the COM server process.</span></span>
-   <span data-ttu-id="1e9c4-137">Quando o **sinalizador \_ \_ \_ \_ SD \_ and \_ BIND do processo de servidor seguro do APPIDREGFLAGS** é definido, o com protege o descritor de segurança do objeto de processo no caso de servidores com "ativados" do runas.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-137">When the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set, COM hardens the security descriptor of the process object in the case of RunAs "Activator" COM servers.</span></span> <span data-ttu-id="1e9c4-138">Para esses servidores, espera-se que o cliente COM proteja o token que ele usa para a ativação COM.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-138">For such servers, the COM client is expected to harden the token that it uses for the COM activation.</span></span>
-   <span data-ttu-id="1e9c4-139">Quando o **sinalizador \_ \_ \_ \_ SD \_ and \_ BIND do processo do servidor seguro do APPIDREGFLAGS** é definido, o com protege o descritor de segurança do objeto de processo no caso dos servidores com "este usuário" do runas.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-139">When the **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is set, COM hardens the security descriptor of the process object in the case of RunAs "This User" COM servers.</span></span> <span data-ttu-id="1e9c4-140">Ele também protege o token do processo do servidor COM, já que o SCM COM é a entidade que cria o token.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-140">It also hardens the process token of the COM server since the COM SCM is the entity that creates the token.</span></span>

<span data-ttu-id="1e9c4-141">O **sinalizador \_ \_ \_ \_ SD \_ e \_ BIND do processo APPIDREGFLAGS Secure Server** tem suporte no Windows XP, no Windows Server 2003, no Windows Vista e no Windows Server 2008 somente quando o patch MSRC8322 ([Boletim de segurança MS09-012](https://support.microsoft.com/kb/959454)) é aplicado.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-141">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag is supported in Windows XP, Windows Server 2003, Windows Vista, and Windows Server 2008 only when the MSRC8322 patch ([security bulletin MS09-012](https://support.microsoft.com/kb/959454)) is applied.</span></span> <span data-ttu-id="1e9c4-142">Há suporte nativo no Windows 7 e em versões posteriores do Windows.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-142">It is natively supported in Windows 7 and later versions of Windows.</span></span>

<span data-ttu-id="1e9c4-143">O **sinalizador \_ \_ \_ \_ SD \_ e \_ BIND do APPIDREGFLAGS Secure Server** aplica-se somente a servidores com que são configurados para executar como runas "Activator" ou "este usuário".</span><span class="sxs-lookup"><span data-stu-id="1e9c4-143">The **APPIDREGFLAGS\_SECURE\_SERVER\_PROCESS\_SD\_AND\_BIND** flag applies only to COM servers that are configured to RunAs "Activator" or "This User".</span></span> <span data-ttu-id="1e9c4-144">Ele não se aplica a servidores COM que são serviços NT.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-144">It does not apply to COM servers that are NT services.</span></span>

### <a name="appidregflags_issue_activation_rpc_at_identify-description"></a><span data-ttu-id="1e9c4-145">\_ \_ RPC de ativação do problema APPIDREGFLAGS \_ \_ na \_ Descrição da identificação</span><span class="sxs-lookup"><span data-stu-id="1e9c4-145">APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY Description</span></span>

<span data-ttu-id="1e9c4-146">Se o **RPC de ativação do problema de APPIDREGFLAGS no sinalizador de \_ \_ \_ \_ \_ identificação** estiver definido em **AppIDFlags**, o SCM com emitirá solicitações de ativação do objeto para o processo do servidor com usando um nível de representação de [identificação do nível de imp do RPC \_ C \_ \_ \_](impersonation-levels.md).</span><span class="sxs-lookup"><span data-stu-id="1e9c4-146">If the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is set in **AppIDFlags**, the COM SCM will issue object activation requests to the COM server process using an impersonation level of [RPC\_C\_IMP\_LEVEL\_IDENTIFY](impersonation-levels.md).</span></span>

<span data-ttu-id="1e9c4-147">Se o sinalizador de **ativação do problema de APPIDREGFLAGS não estiver definido, o SCM com emitirá \_ \_ \_ \_ \_** solicitações de ativação de objeto para os processos de servidor com usando um nível de representação de [Impersonate de nível de imp do RPC \_ C \_ \_ \_](impersonation-levels.md).</span><span class="sxs-lookup"><span data-stu-id="1e9c4-147">If the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is not set, the COM SCM will issue object activation requests to the COM server processes using an impersonation level of [RPC\_C\_IMP\_LEVEL\_IMPERSONATE](impersonation-levels.md).</span></span>

<span data-ttu-id="1e9c4-148">As considerações de segurança a seguir devem ser levadas em conta ao usar o **\_ RPC de ativação do problema APPIDREGFLAGS no sinalizador \_ \_ \_ de \_ identificação** :</span><span class="sxs-lookup"><span data-stu-id="1e9c4-148">The following security considerations must be taken into account when using the **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag:</span></span>

-   <span data-ttu-id="1e9c4-149">O **\_ RPC de ativação do problema APPIDREGFLAGS \_ \_ \_ no \_** sinalizador de identificação deve ser usado por servidores com que não executam o trabalho em nome de clientes em solicitações de ativação de objeto.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-149">The **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is meant to be used by COM servers that do not perform work on behalf of clients in object activation requests.</span></span> <span data-ttu-id="1e9c4-150">Para esses servidores, ter as solicitações de ativação do objeto de emissão de SCM no [RPC \_ C \_ IMP \_ Level \_ identifica](impersonation-levels.md) minimiza as chances de tokens com privilégios com nível de [**\_ \_ nome de representação se**](/windows/desktop/SecAuthZ/privilege-constants) aparecer no processo.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-150">For such servers, having the COM SCM issue object activation requests at [RPC\_C\_IMP\_LEVEL\_IDENTIFY](impersonation-levels.md) minimizes the chances of privileged tokens with [**SE\_IMPERSONATE\_NAME**](/windows/desktop/SecAuthZ/privilege-constants) level appearing in the process.</span></span>

<span data-ttu-id="1e9c4-151">O **APPIDREGFLAGS de \_ ativação do problema de \_ \_ RPC \_ no \_** sinalizador de identificação tem suporte no Windows 7 e versões posteriores do Windows.</span><span class="sxs-lookup"><span data-stu-id="1e9c4-151">The **APPIDREGFLAGS\_ISSUE\_ACTIVATION\_RPC\_AT\_IDENTIFY** flag is supported in Windows 7 and later versions of Windows.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1e9c4-152">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="1e9c4-152">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1e9c4-153">Desktops</span><span class="sxs-lookup"><span data-stu-id="1e9c4-153">Desktops</span></span>](/windows/desktop/winstation/desktops)
</dt> <dt>

[<span data-ttu-id="1e9c4-154">Níveis de representação</span><span class="sxs-lookup"><span data-stu-id="1e9c4-154">Impersonation Levels</span></span>](impersonation-levels.md)
</dt> <dt>

[<span data-ttu-id="1e9c4-155">Usuário interativo</span><span class="sxs-lookup"><span data-stu-id="1e9c4-155">Interactive User</span></span>](interactive-user.md)
</dt> <dt>

[<span data-ttu-id="1e9c4-156">Monikers de sessão</span><span class="sxs-lookup"><span data-stu-id="1e9c4-156">Session Monikers</span></span>](/windows/desktop/TermServ/session-monikers)
</dt> <dt>

[<span data-ttu-id="1e9c4-157">Estações de janela</span><span class="sxs-lookup"><span data-stu-id="1e9c4-157">Window Stations</span></span>](/windows/desktop/winstation/window-stations)
</dt> </dl>

 

 