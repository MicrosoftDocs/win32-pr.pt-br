---
title: O manipulador OLE
description: Um manipulador OLE é uma DLL que contém vários componentes de interação usados para vinculação e inserção.
ms.assetid: 5a01b4be-38cf-4019-ba20-ee67b836a3e0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fb9579f18b44a36a794ff807d9d616dd3a06dd1b
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104005589"
---
# <a name="the-ole-handler"></a><span data-ttu-id="da3fa-103">O manipulador OLE</span><span class="sxs-lookup"><span data-stu-id="da3fa-103">The OLE Handler</span></span>

<span data-ttu-id="da3fa-104">Um *manipulador OLE* é uma DLL que contém vários componentes de interação usados para vinculação e inserção.</span><span class="sxs-lookup"><span data-stu-id="da3fa-104">An *OLE handler* is a DLL containing several interacting components used for linking and embedding.</span></span> <span data-ttu-id="da3fa-105">Para evitar a despesa de comunicação entre processos constantes entre um contêiner e seu servidor, o manipulador é carregado no espaço de processo do contêiner para atuar em nome de um servidor como um tipo de processo substituto.</span><span class="sxs-lookup"><span data-stu-id="da3fa-105">To avoid the expense of constant interprocess communication between a container and its server, the handler is loaded into the container's process space to act on behalf of a server as a sort of surrogate process.</span></span> <span data-ttu-id="da3fa-106">O manipulador OLE gerencia solicitações de contêiner que não exigem a atenção do aplicativo de servidor, como solicitações de desenho.</span><span class="sxs-lookup"><span data-stu-id="da3fa-106">The OLE handler manages container requests that do not require the attention of the server application, such as requests for drawing.</span></span> <span data-ttu-id="da3fa-107">Quando um contêiner solicita algo que o manipulador de objetos não pode fornecer, o manipulador se comunica com o aplicativo de servidor usando o mecanismo de comunicação fora do processo COM.</span><span class="sxs-lookup"><span data-stu-id="da3fa-107">When a container requests something that the object handler cannot provide, the handler communicates with the server application using the COM out-of-process communication mechanism.</span></span>

<span data-ttu-id="da3fa-108">Os componentes do manipulador OLE incluem partes de comunicação remota para gerenciar a comunicação entre o manipulador e seu servidor, um cache para armazenar os dados de um objeto (juntamente com informações sobre como esses dados devem ser formatados e exibidos) e um objeto de controle que coordena as atividades dos outros componentes da DLL.</span><span class="sxs-lookup"><span data-stu-id="da3fa-108">The OLE handler components include remoting pieces to manage communication between the handler and its server, a cache for storing an object's data (along with information on how that data should be formatted and displayed), and a controlling object that coordinates the activities of the DLL's other components.</span></span> <span data-ttu-id="da3fa-109">Além disso, se um objeto for um link, a DLL também incluirá um componente de vinculação ou *objeto vinculado*, que controla o nome e o local da origem do link.</span><span class="sxs-lookup"><span data-stu-id="da3fa-109">In addition, if an object is a link, the DLL also includes a linking component, or *linked object*, which keeps track of the name and location of the link source.</span></span>

<span data-ttu-id="da3fa-110">O OLE fornece um manipulador padrão que a maioria dos aplicativos usa para vinculação e inserção.</span><span class="sxs-lookup"><span data-stu-id="da3fa-110">OLE provides a default handler that most applications use for linking and embedding.</span></span> <span data-ttu-id="da3fa-111">Se o padrão não corresponder aos requisitos do seu servidor, você poderá substituir completamente o manipulador padrão ou usar partes da funcionalidade que ele fornece quando apropriado.</span><span class="sxs-lookup"><span data-stu-id="da3fa-111">If the default does not match the requirements of your server, you can either completely replace the default handler or use parts of the functionality it provides where appropriate.</span></span> <span data-ttu-id="da3fa-112">No último caso, o manipulador de aplicativos é implementado como um objeto de agregação composto por um novo objeto de controle e o manipulador padrão.</span><span class="sxs-lookup"><span data-stu-id="da3fa-112">In the latter case, the application handler is implemented as an aggregate object composed of a new control object and the default handler.</span></span> <span data-ttu-id="da3fa-113">Os manipuladores de aplicativo/padrão de combinação também são conhecidos como *manipuladores em processo*.</span><span class="sxs-lookup"><span data-stu-id="da3fa-113">Combination application/default handlers are also known as *in-process handlers*.</span></span> <span data-ttu-id="da3fa-114">O *manipulador de comunicação remota* é usado para objetos que não são atribuídos a um CLSID no registro do sistema ou que não têm nenhum manipulador especificado.</span><span class="sxs-lookup"><span data-stu-id="da3fa-114">The *remoting handler* is used for objects that are not assigned a CLSID in the system registry or that have no specified handler.</span></span> <span data-ttu-id="da3fa-115">Tudo o que é necessário a partir de um manipulador para esses tipos de objetos é que eles passam informações entre o limite do processo.</span><span class="sxs-lookup"><span data-stu-id="da3fa-115">All that is required from a handler for these types of objects is that they pass information across the process boundary.</span></span> <span data-ttu-id="da3fa-116">Para criar uma nova instância do manipulador padrão, chame [**OleCreateDefaultHandler**](/windows/desktop/api/Ole2/nf-ole2-olecreatedefaulthandler).</span><span class="sxs-lookup"><span data-stu-id="da3fa-116">To create a new instance of the default handler, call [**OleCreateDefaultHandler**](/windows/desktop/api/Ole2/nf-ole2-olecreatedefaulthandler).</span></span> <span data-ttu-id="da3fa-117">Para algumas circunstâncias especiais, chame [**OleCreateEmbeddingHelper**](/windows/desktop/api/Ole2/nf-ole2-olecreateembeddinghelper).</span><span class="sxs-lookup"><span data-stu-id="da3fa-117">For some special circumstances, call [**OleCreateEmbeddingHelper**](/windows/desktop/api/Ole2/nf-ole2-olecreateembeddinghelper).</span></span>

<span data-ttu-id="da3fa-118">Quando você cria uma instância de um manipulador para uma classe, não pode usá-la para outra.</span><span class="sxs-lookup"><span data-stu-id="da3fa-118">When you create an instance of a handler for one class, you cannot use it for another.</span></span> <span data-ttu-id="da3fa-119">Quando usado para um documento composto, o manipulador OLE implementa as estruturas de dados do lado do contêiner quando os objetos de uma determinada classe são acessados remotamente.</span><span class="sxs-lookup"><span data-stu-id="da3fa-119">When used for a compound document, the OLE handler implements the container-side data structures when objects of a particular class are accessed remotely.</span></span>

<span data-ttu-id="da3fa-120">O OLE definiu o manipulador padrão para clientes de servidores locais de documento composto.</span><span class="sxs-lookup"><span data-stu-id="da3fa-120">OLE defined the default handler for clients of compound document local servers.</span></span> <span data-ttu-id="da3fa-121">O manipulador padrão implementou várias interfaces que o servidor típico não fez.</span><span class="sxs-lookup"><span data-stu-id="da3fa-121">The default handler implemented a number of interfaces that the typical server did not.</span></span> <span data-ttu-id="da3fa-122">Quando o OLE permitia subseqüentemente servidores em processo para documentos compostos, eles tinham que criar um auxiliar de incorporação que implementou essas interfaces extras para que os clientes pudessem trabalhar diretamente com elas.</span><span class="sxs-lookup"><span data-stu-id="da3fa-122">When OLE subsequently allowed in-process servers for compound documents, they had to create an embedding helper that implemented these extra interfaces so that clients could seamlessly work with them.</span></span>

<span data-ttu-id="da3fa-123">Os designers de estrutura que definem e implementam um manipulador do lado do cliente devem considerar esse problema em seu design e devem fornecer um auxiliar em processo equivalente pelos mesmos motivos.</span><span class="sxs-lookup"><span data-stu-id="da3fa-123">Framework designers that define and implement a client-side handler should consider this issue in their design and should provide an equivalent in-process helper for the same reasons.</span></span> <span data-ttu-id="da3fa-124">Mesmo que os designers não implementem interfaces no manipulador que os servidores não expõem, talvez eles queiram definir um auxiliar agora para que possam adicioná-los no futuro.</span><span class="sxs-lookup"><span data-stu-id="da3fa-124">Even if the designers currently don't implement interfaces on the handler that the servers don't expose, they may want to define a helper now so that they can add them in the future.</span></span> <span data-ttu-id="da3fa-125">Como alternativa, é possível implementar as interfaces extras no próprio objeto de servidor.</span><span class="sxs-lookup"><span data-stu-id="da3fa-125">Alternatively, one could implement the extra interfaces on the server object itself.</span></span>

## <a name="related-topics"></a><span data-ttu-id="da3fa-126">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="da3fa-126">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="da3fa-127">O manipulador de Client-Side leve</span><span class="sxs-lookup"><span data-stu-id="da3fa-127">The Lightweight Client-Side Handler</span></span>](the-lightweight-client-side-handler.md)
</dt> </dl>

 

 




