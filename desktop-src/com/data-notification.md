---
title: Notificação de dados
description: Os objetos que consomem dados de uma fonte externa às vezes precisam ser informados quando os dados nessa fonte são alterados.
ms.assetid: 286a1ecf-5255-4443-a17d-5ffa55ed0be1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49df9e6bb7d9b15192473b18114fe7fcd69ecedf
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "105811577"
---
# <a name="data-notification"></a><span data-ttu-id="a33ea-103">Notificação de dados</span><span class="sxs-lookup"><span data-stu-id="a33ea-103">Data Notification</span></span>

<span data-ttu-id="a33ea-104">Os objetos que consomem dados de uma fonte externa às vezes precisam ser informados quando os dados nessa fonte são alterados.</span><span class="sxs-lookup"><span data-stu-id="a33ea-104">Objects that consume data from an external source sometimes need to be informed when data in that source changes.</span></span> <span data-ttu-id="a33ea-105">Por exemplo, um visualizador de fita com cotação de ações que depende de dados em algumas planilhas precisa ser notificado quando esses dados são alterados para que ele possa atualizar sua exibição.</span><span class="sxs-lookup"><span data-stu-id="a33ea-105">For example, a stock ticker tape viewer that relies on data in some spreadsheet needs to be notified when that data changes so it can update its display.</span></span> <span data-ttu-id="a33ea-106">Da mesma forma, um documento composto precisa de informações sobre as alterações de dados em seus objetos incorporados para que ele possa atualizar seus caches de dados.</span><span class="sxs-lookup"><span data-stu-id="a33ea-106">Similarly, a compound document needs information about data changes in its embedded objects so that it can update its data caches.</span></span> <span data-ttu-id="a33ea-107">Em casos como esse, em que a atualização dinâmica de dados é desejável, as fontes de dados exigem algum mecanismo de notificação de consumidores de dados de alterações à medida que ocorrem sem OBLIGATING os consumidores a descartar tudo para atualizar seus dados.</span><span class="sxs-lookup"><span data-stu-id="a33ea-107">In cases such as this, where dynamic updating of data is desirable, sources of data require some mechanism of notifying data consumers of changes as they occur without obligating the consumers to drop everything in order to update their data.</span></span> <span data-ttu-id="a33ea-108">De preferência, ter sido notificado de que ocorreu uma alteração na fonte de dados, um objeto de consumo pode solicitar uma cópia atualizada em seu lazer.</span><span class="sxs-lookup"><span data-stu-id="a33ea-108">Ideally, having been notified that a change has occurred in the data source, a consuming object can ask for an updated copy at its leisure.</span></span>

<span data-ttu-id="a33ea-109">O mecanismo de COM para lidar COM notificações assíncronas desse tipo é um objeto chamado de coletor de aviso, que é simplesmente qualquer objeto COM que implementa uma interface chamada [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink).</span><span class="sxs-lookup"><span data-stu-id="a33ea-109">COM's mechanism for handling asynchronous notifications of this type is an object called an advise sink, which is simply any COM object that implements an interface called [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink).</span></span> <span data-ttu-id="a33ea-110">Os consumidores de dados implementam o **IAdviseSink**.</span><span class="sxs-lookup"><span data-stu-id="a33ea-110">Consumers of data implement the **IAdviseSink**.</span></span> <span data-ttu-id="a33ea-111">Eles se registram para receber notificações ao entregar um ponteiro para o objeto de dados de interesse.</span><span class="sxs-lookup"><span data-stu-id="a33ea-111">They register to receive notifications by handing a pointer to the data object of interest.</span></span>

<span data-ttu-id="a33ea-112">As interfaces [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) expõe os seguintes métodos para receber notificações assíncronas:</span><span class="sxs-lookup"><span data-stu-id="a33ea-112">The [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) interfaces exposes the following methods for receiving asynchronous notifications:</span></span>



| <span data-ttu-id="a33ea-113">Método</span><span class="sxs-lookup"><span data-stu-id="a33ea-113">Method</span></span>                                                      | <span data-ttu-id="a33ea-114">Notifica o coletor de aviso que</span><span class="sxs-lookup"><span data-stu-id="a33ea-114">Notifies the advise sink that</span></span>                                            |
|-------------------------------------------------------------|--------------------------------------------------------------------------|
| [<span data-ttu-id="a33ea-115">**OnDataChange**</span><span class="sxs-lookup"><span data-stu-id="a33ea-115">**OnDataChange**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange)<br/> | <span data-ttu-id="a33ea-116">Os dados do objeto de chamada foram alterados.</span><span class="sxs-lookup"><span data-stu-id="a33ea-116">The calling object's data has changed.</span></span><br/>                        |
| [<span data-ttu-id="a33ea-117">**OnViewChange**</span><span class="sxs-lookup"><span data-stu-id="a33ea-117">**OnViewChange**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange)<br/> | <span data-ttu-id="a33ea-118">As instruções para desenhar o objeto de chamada foram alteradas.</span><span class="sxs-lookup"><span data-stu-id="a33ea-118">The instructions for drawing the calling object have changed.</span></span><br/> |
| [<span data-ttu-id="a33ea-119">**Renomear**</span><span class="sxs-lookup"><span data-stu-id="a33ea-119">**OnRename**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onrename)<br/>         | <span data-ttu-id="a33ea-120">O moniker do objeto de chamada foi alterado.</span><span class="sxs-lookup"><span data-stu-id="a33ea-120">The calling object's moniker has changed.</span></span><br/>                     |
| [<span data-ttu-id="a33ea-121">**OnSave**</span><span class="sxs-lookup"><span data-stu-id="a33ea-121">**OnSave**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onsave)<br/>             | <span data-ttu-id="a33ea-122">O objeto de chamada foi salvo no armazenamento persistente.</span><span class="sxs-lookup"><span data-stu-id="a33ea-122">The calling object has been saved to persistent storage.</span></span><br/>      |
| [<span data-ttu-id="a33ea-123">**Fechamento**</span><span class="sxs-lookup"><span data-stu-id="a33ea-123">**OnClose**</span></span>](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onclose)<br/>           | <span data-ttu-id="a33ea-124">O objeto de chamada foi fechado.</span><span class="sxs-lookup"><span data-stu-id="a33ea-124">The calling object has been closed.</span></span><br/>                           |



 

<span data-ttu-id="a33ea-125">Como a tabela indica, a interface [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) expõe métodos para notificar o coletor de avisos de eventos diferentes das alterações nos dados do objeto de chamada.</span><span class="sxs-lookup"><span data-stu-id="a33ea-125">As the table indicates, the [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) interface exposes methods for notifying the advise sink of events other than changes in the calling object's data.</span></span> <span data-ttu-id="a33ea-126">O objeto de chamada também pode notificar o coletor quando o modo no qual ele se desenha altera, ou é renomeado, salvo ou fechado.</span><span class="sxs-lookup"><span data-stu-id="a33ea-126">The calling object can also notify the sink when the way in which it draws itself changes, or it is renamed, saved, or closed.</span></span> <span data-ttu-id="a33ea-127">Essas outras notificações são usadas principalmente ou inteiramente no contexto de documentos compostos, embora o mecanismo de notificação seja idêntico.</span><span class="sxs-lookup"><span data-stu-id="a33ea-127">These other notifications are used mainly or entirely in the context of compound documents, although the notification mechanism is identical.</span></span> <span data-ttu-id="a33ea-128">Para obter mais informações sobre notificações de documentos compostos, consulte "documentos compostos".</span><span class="sxs-lookup"><span data-stu-id="a33ea-128">For more information on compound-document notifications, see "Compound Documents."</span></span>

<span data-ttu-id="a33ea-129">Para aproveitar o coletor de avisos, uma fonte de dados deve implementar [**IDataObject::D Advise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**IDataObject::D Unadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise)e [**IDataObject:: EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise).</span><span class="sxs-lookup"><span data-stu-id="a33ea-129">In order to take advantage of the advise sink, a data source must implement [**IDataObject::DAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dadvise), [**IDataObject::DUnadvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-dunadvise), and [**IDataObject::EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise).</span></span> <span data-ttu-id="a33ea-130">Um consumidor de dados chama o **DAdvise** mothod para notificar um objeto de dados de que ele deseja ser notificado quando os dados do objeto forem alterados.</span><span class="sxs-lookup"><span data-stu-id="a33ea-130">A data consumer calls the **DAdvise** mothod to notify a data object that it wishes to be notified when the object's data changes.</span></span> <span data-ttu-id="a33ea-131">O objeto de consumo chama o método **DUnadvise** para desmontar essa conexão.</span><span class="sxs-lookup"><span data-stu-id="a33ea-131">The consuming object calls the **DUnadvise** method to tear down this connection.</span></span> <span data-ttu-id="a33ea-132">Qualquer parte interessada pode chamar o método **EnumDAdvise** para saber o número de objetos que têm uma conexão de consultoria com um objeto de dados.</span><span class="sxs-lookup"><span data-stu-id="a33ea-132">Any interested party can call the **EnumDAdvise** method to learn the number of objects having an advisory connection with a data object.</span></span>

<span data-ttu-id="a33ea-133">Quando os dados são alterados na origem, o objeto de dados chama [**IAdviseSink:: OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) em todos os consumidores de dados que se registraram para receber notificações.</span><span class="sxs-lookup"><span data-stu-id="a33ea-133">When data changes at the source, the data object calls [**IAdviseSink::OnDataChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-ondatachange) on all data consumers that have registered to receive notifications.</span></span> <span data-ttu-id="a33ea-134">Para controlar as conexões de consultoria e gerenciar a expedição de notificações, as fontes de dados dependem de um objeto chamado de um *detentor de aviso de dados*.</span><span class="sxs-lookup"><span data-stu-id="a33ea-134">To keep track of advisory connections and manage the dispatch of notifications, data sources rely on an object called a *data advise holder*.</span></span> <span data-ttu-id="a33ea-135">Você pode criar seu próprio detentor de aviso de dados implementando a interface [**IDataAdviseHolder**](/windows/desktop/api/ObjIdl/nn-objidl-idataadviseholder) .</span><span class="sxs-lookup"><span data-stu-id="a33ea-135">You can create your own data advise holder by implementing the [**IDataAdviseHolder**](/windows/desktop/api/ObjIdl/nn-objidl-idataadviseholder) interface.</span></span> <span data-ttu-id="a33ea-136">Ou, você pode deixar COM que o COM faça isso chamando a função auxiliar [**CreateDataAdviseHolder**](/windows/win32/api/ole2/nf-ole2-createdataadviseholder).</span><span class="sxs-lookup"><span data-stu-id="a33ea-136">Or, you can let COM do it for you by calling the helper function [**CreateDataAdviseHolder**](/windows/win32/api/ole2/nf-ole2-createdataadviseholder).</span></span>

## <a name="related-topics"></a><span data-ttu-id="a33ea-137">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="a33ea-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a33ea-138">Transferência de Dados</span><span class="sxs-lookup"><span data-stu-id="a33ea-138">Data Transfer</span></span>](data-transfer.md)
</dt> </dl>

 

