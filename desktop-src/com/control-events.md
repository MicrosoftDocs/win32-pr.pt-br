---
title: Eventos de controle (COM)
description: Além de fornecer propriedades e métodos, um controle também fornece interfaces de saída para notificar seu cliente de eventos.
ms.assetid: e7085bc0-c087-4cc8-9c69-ba05b0923b74
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1833e1396847e09366d1e06193196cfcf981d330
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/10/2020
ms.locfileid: "104008719"
---
# <a name="control-events-com"></a><span data-ttu-id="c81da-103">Eventos de controle (COM)</span><span class="sxs-lookup"><span data-stu-id="c81da-103">Control Events (COM)</span></span>

<span data-ttu-id="c81da-104">Além de fornecer propriedades e métodos, um controle também fornece interfaces de saída para notificar seu cliente de eventos.</span><span class="sxs-lookup"><span data-stu-id="c81da-104">In addition to providing properties and methods, a control also provides outgoing interfaces to notify its client of events.</span></span> <span data-ttu-id="c81da-105">O cliente deve dar suporte ao tratamento desses eventos.</span><span class="sxs-lookup"><span data-stu-id="c81da-105">The client must support handling of these events.</span></span> <span data-ttu-id="c81da-106">Consulte [eventos em objetos com e conectáveis](events-in-com-and-connectable-objects.md) para obter mais informações sobre como os objetos conectáveis funcionam.</span><span class="sxs-lookup"><span data-stu-id="c81da-106">See [Events in COM and Connectable Objects](events-in-com-and-connectable-objects.md) for more information on how connectable objects work.</span></span>

<span data-ttu-id="c81da-107">Um controle pode dar suporte a diferentes interfaces de saída para finalidades diferentes.</span><span class="sxs-lookup"><span data-stu-id="c81da-107">A control can support different outgoing interfaces for different purposes.</span></span> <span data-ttu-id="c81da-108">Todas as interfaces de saída são marcadas como interfaces de origem nas informações de tipo do controle, mas apenas uma é marcada como padrão para indicar que é a interface de saída primária.</span><span class="sxs-lookup"><span data-stu-id="c81da-108">All outgoing interfaces are marked as source interfaces in the control's type information, but only one is marked default to indicate that it is the primary outgoing interface.</span></span>

<span data-ttu-id="c81da-109">Um contêiner pode dar suporte a uma ou mais das interfaces de saída definidas por um controle.</span><span class="sxs-lookup"><span data-stu-id="c81da-109">A container can support one or more of the outgoing interfaces defined by a control.</span></span> <span data-ttu-id="c81da-110">O controle deve ser preparado para lidar com contêineres que dão suporte apenas a algumas de suas interfaces de saída.</span><span class="sxs-lookup"><span data-stu-id="c81da-110">The control should be prepared to deal with containers that only provide support for some of their outgoing interfaces.</span></span>

<span data-ttu-id="c81da-111">Os controles dão suporte a quatro tipos de eventos:</span><span class="sxs-lookup"><span data-stu-id="c81da-111">Controls support four kinds of events:</span></span>

-   <span data-ttu-id="c81da-112">Eventos de solicitação.</span><span class="sxs-lookup"><span data-stu-id="c81da-112">Request events.</span></span> <span data-ttu-id="c81da-113">Um controle solicita permissão de seu cliente para fazer algo chamando um método na interface de saída, disparando assim um evento de solicitação.</span><span class="sxs-lookup"><span data-stu-id="c81da-113">A control requests permission from its client to do something by calling a method in the outgoing interface, thus triggering a request event.</span></span> <span data-ttu-id="c81da-114">O cliente sinaliza o controle por meio de um booliano, out-Parameter no método chamado pelo controle.</span><span class="sxs-lookup"><span data-stu-id="c81da-114">The client signals the control through a boolean, out-parameter in the method that the control called.</span></span> <span data-ttu-id="c81da-115">O cliente pode, portanto, impedir que o controle execute a ação.</span><span class="sxs-lookup"><span data-stu-id="c81da-115">The client can thus prevent the control from performing the action.</span></span>
-   <span data-ttu-id="c81da-116">Eventos Before.</span><span class="sxs-lookup"><span data-stu-id="c81da-116">Before events.</span></span> <span data-ttu-id="c81da-117">Um controle notifica seu Client Hat que fará algo chamando um método na interface de saída, disparando assim um evento Before.</span><span class="sxs-lookup"><span data-stu-id="c81da-117">A control notifies its client hat it is going to do something by calling a method in the outgoing interface, thus triggering a before event.</span></span> <span data-ttu-id="c81da-118">O cliente não tem a oportunidade de evitar a ação, mas pode executar todas as etapas necessárias, dada a ação que está prestes a ocorrer.</span><span class="sxs-lookup"><span data-stu-id="c81da-118">The client does not have the opportunity to prevent the action, but it can take any necessary steps given the action that is about to occur.</span></span>
-   <span data-ttu-id="c81da-119">Após eventos.</span><span class="sxs-lookup"><span data-stu-id="c81da-119">After events.</span></span> <span data-ttu-id="c81da-120">Um controle notifica seu cliente de que acabou de fazer algo chamando um método na interface de saída, disparando assim um evento After.</span><span class="sxs-lookup"><span data-stu-id="c81da-120">A control notifies its client that it has just done something by calling a method in the outgoing interface, thus triggering an after event.</span></span> <span data-ttu-id="c81da-121">Novamente, o cliente não pode cancelar essa ação, mas pode tomar as medidas necessárias devido à ação que ocorreu.</span><span class="sxs-lookup"><span data-stu-id="c81da-121">Again, the client cannot cancel this action, but it can take necessary steps given the action that has occurred.</span></span>
-   <span data-ttu-id="c81da-122">Fazer eventos.</span><span class="sxs-lookup"><span data-stu-id="c81da-122">Do events.</span></span> <span data-ttu-id="c81da-123">Um controle dispara um evento do para permitir que seu cliente substitua a ação do controle e forneça algumas ações alternativas ou complementares.</span><span class="sxs-lookup"><span data-stu-id="c81da-123">A control triggers a do event to allow its client to override the control's action and provide some alternative or supplementary actions.</span></span> <span data-ttu-id="c81da-124">Normalmente, o método que um controle chama para um evento do tem um número de parâmetros para negociar com o cliente sobre as ações que ocorrerão.</span><span class="sxs-lookup"><span data-stu-id="c81da-124">Usually, the method that a control calls for a do event has a number of parameters for negotiating with the client about the actions that will occur.</span></span>

<span data-ttu-id="c81da-125">Os seguintes DISPIDs são definidos para eventos padrão aos quais os controles podem dar suporte: clique, DblClick, KeyDown, KeyPress, KeyUp, MouseMove, MouseUp e erro.</span><span class="sxs-lookup"><span data-stu-id="c81da-125">The following dispids are defined for standard events that controls can support: Click, DblClick, KeyDown, KeyPress, KeyUp, MouseMove, MouseUp, and Error.</span></span> <span data-ttu-id="c81da-126">Todos esses eventos padrão têm valores DISPID negativos, indicando seu status padrão.</span><span class="sxs-lookup"><span data-stu-id="c81da-126">All of these standard events have negative DISPID values, indicating their standard status.</span></span>

<span data-ttu-id="c81da-127">O método [**IOleControl:: FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents) , quando chamado com **true**, informa a um controle se o contêiner irá se preocupar em manipular eventos do controle até que **FreezeEvents** seja chamado novamente com **false**.</span><span class="sxs-lookup"><span data-stu-id="c81da-127">The [**IOleControl::FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents) method, when called with **TRUE**, tells a control whether the container will bother handling events from the control until **FreezeEvents** is again called with **FALSE**.</span></span> <span data-ttu-id="c81da-128">Durante esse tempo, o controle não pode depender do contêiner que realmente manipula todos os eventos.</span><span class="sxs-lookup"><span data-stu-id="c81da-128">During this time control cannot depend on the container actually handling any events.</span></span> <span data-ttu-id="c81da-129">Se for necessário manipular um evento, o controle deverá enfileirar o evento para que ele seja acionado quando **FreezeEvents** for chamado com **false**.</span><span class="sxs-lookup"><span data-stu-id="c81da-129">If an event must be handled, the control should queue the event in order to fire it when **FreezeEvents** is called with **FALSE**.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c81da-130">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="c81da-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c81da-131">Controles ActiveX</span><span class="sxs-lookup"><span data-stu-id="c81da-131">ActiveX Controls</span></span>](activex-controls.md)
</dt> </dl>

 

 




