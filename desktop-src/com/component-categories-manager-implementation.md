---
title: Implementação do Gerenciador de categorias de componentes
description: À medida que aumenta o número de componentes disponíveis, torna-se cada vez mais difícil gerenciar esses componentes. Em termos das interfaces que expõem, bem como as tarefas que eles executam, muitos componentes oferecem funcionalidade semelhante.
ms.assetid: c2c67129-bf19-465b-8354-193922aeafaa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2414567beba159c05ea08b3561f0a97ddda1cb70
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103916624"
---
# <a name="component-categories-manager-implementation"></a><span data-ttu-id="61df1-104">Implementação do Gerenciador de categorias de componentes</span><span class="sxs-lookup"><span data-stu-id="61df1-104">Component Categories Manager Implementation</span></span>

<span data-ttu-id="61df1-105">À medida que aumenta o número de componentes disponíveis, torna-se cada vez mais difícil gerenciar esses componentes.</span><span class="sxs-lookup"><span data-stu-id="61df1-105">As the number of available components grows, it becomes increasingly difficult to manage these components.</span></span> <span data-ttu-id="61df1-106">Em termos das interfaces que expõem, bem como as tarefas que eles executam, muitos componentes oferecem funcionalidade semelhante.</span><span class="sxs-lookup"><span data-stu-id="61df1-106">In terms of the interfaces they expose as well as the tasks they perform, many components offer similar functionality.</span></span>

<span data-ttu-id="61df1-107">Geralmente, é necessário enumerar os componentes que podem ser usados em um determinado contexto.</span><span class="sxs-lookup"><span data-stu-id="61df1-107">It is often necessary to enumerate the components that can be used in a certain context.</span></span> <span data-ttu-id="61df1-108">Exemplos disso são a caixa de diálogo **Inserir objeto** usada em documentos OLE compostos e a caixa de diálogo **controle de inserção** usada em controles OLE.</span><span class="sxs-lookup"><span data-stu-id="61df1-108">Examples of this are the **Insert Object** dialog box used in OLE compound documents and the **Insert Control** dialog box used in OLE controls.</span></span> <span data-ttu-id="61df1-109">Essas caixas de diálogo listam todos os componentes que atendem (ou alegam atender) os contratos de interface para documentos ou controles compostos.</span><span class="sxs-lookup"><span data-stu-id="61df1-109">These dialog boxes list all components that fulfill (or claim to fulfill) the interface contracts for compound documents or controls.</span></span> <span data-ttu-id="61df1-110">Essas categorias existentes (documento OLE, controle OLE) não implicam uma assinatura de interface exata.</span><span class="sxs-lookup"><span data-stu-id="61df1-110">These existing categories (OLE document, OLE control) do not imply an exact interface signature.</span></span> <span data-ttu-id="61df1-111">Documentos OLE precisam expor um determinado conjunto de interfaces principais (por exemplo, [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) ou [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)), mas também podem expor interfaces adicionais, como [**IOleLink**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink).</span><span class="sxs-lookup"><span data-stu-id="61df1-111">OLE documents have to expose a certain set of core interfaces (for example, [**IOleObject**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) or [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)) but can also expose additional interfaces such as [**IOleLink**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink).</span></span>

<span data-ttu-id="61df1-112">No passado, os componentes foram marcados com a adição de um nome legível ("Insertável", "Control" e assim por diante) como uma subchave ao **\_ CLSID raiz da classe HKEY \_ \\ \\ {...}**</span><span class="sxs-lookup"><span data-stu-id="61df1-112">In the past, components have been tagged by adding a human-readable name ("Insertable", "Control", and so on) as a subkey to the **HKEY\_CLASSES\_ROOT\\CLSID\\{...}**</span></span> <span data-ttu-id="61df1-113">chave do registro correspondente ao componente.</span><span class="sxs-lookup"><span data-stu-id="61df1-113">registry key corresponding to the component.</span></span> <span data-ttu-id="61df1-114">Isso funciona bem para uma definição central de categorias, mas o nome dos riscos é colisões quando muitas partes independentes definem novas categorias.</span><span class="sxs-lookup"><span data-stu-id="61df1-114">This works well for a central definition of categories but risks name collisions when many independent parties define new categories.</span></span> <span data-ttu-id="61df1-115">Como em outras áreas do COM, a solução para fornecer um namespace extensível está no uso de GUIDs (identificadores globais exclusivos).</span><span class="sxs-lookup"><span data-stu-id="61df1-115">As in other areas of COM, the solution to providing an extensible namespace lies in the use of globally unique identifiers (GUIDs).</span></span> <span data-ttu-id="61df1-116">Em vez de usar um nome legível, um número exclusivo (CATID) é atribuído a cada categoria.</span><span class="sxs-lookup"><span data-stu-id="61df1-116">Instead of using a human-readable name, a unique number (CATID) is assigned to each category.</span></span>

<span data-ttu-id="61df1-117">Outra limitação da categorização existente é que ela é limitada a expressar os recursos do próprio componente.</span><span class="sxs-lookup"><span data-stu-id="61df1-117">Another limitation with the existing categorization is that it is limited to expressing the capabilities of the component itself.</span></span> <span data-ttu-id="61df1-118">Muitos componentes exigem certos recursos dos contêineres.</span><span class="sxs-lookup"><span data-stu-id="61df1-118">Many components require certain capabilities from the containers.</span></span> <span data-ttu-id="61df1-119">Quando esse componente é inserido em um contêiner, a inserção pode falhar ou se comportar inesperadamente, mesmo que o componente atenda aos contratos implícitos por uma de suas categorias.</span><span class="sxs-lookup"><span data-stu-id="61df1-119">When such a component is inserted into a container, the insertion can fail or behave unexpectedly, even though the component fulfills the contracts implied by one of its categories.</span></span> <span data-ttu-id="61df1-120">Para enumerar os componentes que podem ser usados com êxito em determinadas situações, os recursos do componente e do contêiner devem ser considerados.</span><span class="sxs-lookup"><span data-stu-id="61df1-120">To enumerate the components that can be used successfully in certain situations, the capabilities of both the component and the container must be considered.</span></span>

<span data-ttu-id="61df1-121">Devido a essas considerações, as seguintes alterações foram feitas na categorização existente:</span><span class="sxs-lookup"><span data-stu-id="61df1-121">Because of these considerations, the following changes were made to the existing categorization:</span></span>

-   <span data-ttu-id="61df1-122">As categorias são indicadas usando CATIDs que são identificadores globalmente exclusivos.</span><span class="sxs-lookup"><span data-stu-id="61df1-122">Categories are indicated by using CATIDs that are globally unique identifiers.</span></span>
-   <span data-ttu-id="61df1-123">Na subchave **componentes** da chave do registro do **\_ \_ \\ CLSID da classe HKEY** , duas subchaves separadas, "categorias implementadas" e "categorias necessárias", foram desenvolvidas.</span><span class="sxs-lookup"><span data-stu-id="61df1-123">Under the **Components** subkey of the **HKEY\_CLASSES\_ROOT\\CLSID** registry key, two separate subkeys, "Implemented Categories" and "Required Categories", were developed.</span></span> <span data-ttu-id="61df1-124">Essas subchaves contêm as listas de CATIDs fornecidas pelo componente ou que o contêiner do componente deve fornecer.</span><span class="sxs-lookup"><span data-stu-id="61df1-124">These subkeys contain the lists of CATIDs that are provided by the component or that the container of the component must provide.</span></span>

<span data-ttu-id="61df1-125">Para facilitar o gerenciamento das categorias de componentes, as categorias são listadas em um local central no registro: **\_ categorias de \_ \\ componentes raiz de classes hKey**.</span><span class="sxs-lookup"><span data-stu-id="61df1-125">To ease managing the component categories, categories are listed in a central place in the registry: **HKEY\_CLASSES\_ROOT\\Component Categories**.</span></span> <span data-ttu-id="61df1-126">Essa chave lista as categorias instaladas com seu CATID e com nomes localizados e legíveis.</span><span class="sxs-lookup"><span data-stu-id="61df1-126">This key lists the installed categories both with their CATID and with localized, human-readable names.</span></span>

<span data-ttu-id="61df1-127">Para mais informações, consulte os seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="61df1-127">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="61df1-128">Categorizando por recursos de componente</span><span class="sxs-lookup"><span data-stu-id="61df1-128">Categorizing by Component Capabilities</span></span>](categorizing-by-component-capabilities.md)
-   [<span data-ttu-id="61df1-129">Categorizando por recursos de contêiner</span><span class="sxs-lookup"><span data-stu-id="61df1-129">Categorizing by Container Capabilities</span></span>](categorizing-by-container-capabilities.md)
-   [<span data-ttu-id="61df1-130">O Gerenciador de categorias de componentes</span><span class="sxs-lookup"><span data-stu-id="61df1-130">The Component Categories Manager</span></span>](the-component-categories-manager.md)
-   [<span data-ttu-id="61df1-131">Classes e associações padrão</span><span class="sxs-lookup"><span data-stu-id="61df1-131">Default Classes and Associations</span></span>](default-classes-and-associations.md)
-   [<span data-ttu-id="61df1-132">Definindo categorias de componentes</span><span class="sxs-lookup"><span data-stu-id="61df1-132">Defining Component Categories</span></span>](defining-component-categories.md)
-   [<span data-ttu-id="61df1-133">Associando ícones a uma categoria</span><span class="sxs-lookup"><span data-stu-id="61df1-133">Associating Icons with a Category</span></span>](associating-icons-with-a-category.md)

 

 




