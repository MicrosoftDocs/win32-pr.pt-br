---
title: Vinculação de dados por meio de IPropertyNotifySink
description: Vinculação de dados por meio de IPropertyNotifySink
ms.assetid: 275a84b3-65d8-43de-bfba-72e3e5ee59fe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5d39c7277d27f0df6c185fc35a926aa98b77b91a
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103637156"
---
# <a name="data-binding-through-ipropertynotifysink"></a><span data-ttu-id="28e33-103">Vinculação de dados por meio de IPropertyNotifySink</span><span class="sxs-lookup"><span data-stu-id="28e33-103">Data Binding through IPropertyNotifySink</span></span>

<span data-ttu-id="28e33-104">Os objetos que dão suporte a propriedades, por exemplo, por meio da automação OLE e da interface **IDispatch** , podem querer permitir que os clientes sejam notificados quando determinadas propriedades alteram o valor.</span><span class="sxs-lookup"><span data-stu-id="28e33-104">Objects that support properties, for example, through OLE Automation and the **IDispatch** interface, may want to allow clients to be notified when certain properties change value.</span></span> <span data-ttu-id="28e33-105">Essa propriedade é chamada de propriedade vinculável porque as notificações permitem que um cliente sincronize sua própria exibição dos valores de propriedade atuais do objeto.</span><span class="sxs-lookup"><span data-stu-id="28e33-105">Such a property is called a bindable property because the notifications allow a client to synchronize its own display of the object's current property values.</span></span> <span data-ttu-id="28e33-106">Além disso, os mesmos objetos talvez queiram permitir que um cliente controle quando determinadas propriedades têm permissão para serem alteradas.</span><span class="sxs-lookup"><span data-stu-id="28e33-106">In addition, the same objects may wish to allow a client to control when certain properties are allowed to change.</span></span> <span data-ttu-id="28e33-107">Essas propriedades são chamadas de propriedades de edição de solicitação.</span><span class="sxs-lookup"><span data-stu-id="28e33-107">Such properties are called request edit properties.</span></span>

<span data-ttu-id="28e33-108">O [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) é uma interface de notificação padrão que dá suporte às propriedades bindable e Request-Edit.</span><span class="sxs-lookup"><span data-stu-id="28e33-108">The [**IPropertyNotifySink**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) is a standard notification interface that supports bindable and request-edit properties.</span></span> <span data-ttu-id="28e33-109">**IPropertyNotifySink** tem suporte de um objeto com propriedades como uma interface de saída.</span><span class="sxs-lookup"><span data-stu-id="28e33-109">**IPropertyNotifySink** is supported from an object with properties as an outgoing interface.</span></span> <span data-ttu-id="28e33-110">Ou seja, a própria interface é implementada pelo objeto de coletor de um cliente e o cliente conecta o coletor ao objeto de suporte por meio do mecanismo de ponto de conexão descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="28e33-110">That is, the interface itself is implemented by a client's sink object, and the client connects the sink to the supporting object through the connection point mechanism described earlier.</span></span> <span data-ttu-id="28e33-111">O **IPropertyNotifySink** é definido da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="28e33-111">The **IPropertyNotifySink** is defined as follows:</span></span>

``` syntax
interface IPropertyNotifySink : IUnknown 
  { 
    HRESULT OnChanged([in] DISPID dispID); 
    HRESULT OnRequestEdit([in] DISPID dispID); 
  } 
 
```

<span data-ttu-id="28e33-112">Quando um objeto deseja notificar seus coletores conectados de que uma propriedade vinculável identificada com um determinado DISPID foi alterado, ele chama [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span><span class="sxs-lookup"><span data-stu-id="28e33-112">When an object wishes to notify its connected sinks that a bindable property identified with a given DISPID has changed, it calls [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span></span> <span data-ttu-id="28e33-113">Se um objeto alterar várias propriedades de uma só vez, ele poderá passar DISPID \_ Unknown para **OnChanged** , caso em que um cliente atualiza seu cache de todos os valores de propriedade de interesse.</span><span class="sxs-lookup"><span data-stu-id="28e33-113">If an object changes multiple properties at once, it can pass DISPID\_UNKNOWN to **OnChanged** in which case a client refreshes its cache of all property values of interest.</span></span>

<span data-ttu-id="28e33-114">Quando uma propriedade de edição de solicitação está prestes a ser alterada, um objeto pode perguntar ao cliente se ele permitirá que essa alteração ocorra.</span><span class="sxs-lookup"><span data-stu-id="28e33-114">When a request edit property is about to change, an object can ask the client whether it will allow that change to occur.</span></span> <span data-ttu-id="28e33-115">O objeto chama [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) passando o DispID da propriedade em questão (ou DISPID \_ desconhecido para identificar todas as propriedades).</span><span class="sxs-lookup"><span data-stu-id="28e33-115">The object calls [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) passing the DISPID of the property in question (or DISPID\_UNKNOWN to identify all properties).</span></span> <span data-ttu-id="28e33-116">O coletor do cliente retorna S \_ OK para indicar que a alteração é permitida ou s \_ false (ou um erro) para indicar que a alteração não é permitida.</span><span class="sxs-lookup"><span data-stu-id="28e33-116">The client's sink returns S\_OK to indicate that the change is allowed, or S\_FALSE (or an error) to indicate that change is not allowed.</span></span> <span data-ttu-id="28e33-117">Quando um objeto chama **OnRequestEdit**, é necessário obedecer aos desejos do cliente seguindo a semântica exata dos \_ valores de retorno S OK e s \_ falsos.</span><span class="sxs-lookup"><span data-stu-id="28e33-117">When an object calls **OnRequestEdit**, it is required to obey the client's wishes by following the exact semantics of S\_OK and S\_FALSE return values.</span></span>

<span data-ttu-id="28e33-118">Observe que [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) não pode ser usado para validação de dados porque, no momento da chamada, o novo valor da propriedade ainda não está disponível.</span><span class="sxs-lookup"><span data-stu-id="28e33-118">Note that [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) cannot be used for data validation because at the time of the call, the new value of the property is not yet available.</span></span> <span data-ttu-id="28e33-119">A notificação só pode ser usada para controlar um estado somente leitura para uma propriedade.</span><span class="sxs-lookup"><span data-stu-id="28e33-119">The notification can only be used to control a read-only state for a property.</span></span>

<span data-ttu-id="28e33-120">Objetos controlam quais propriedades são vinculáveis e solicitam editar e marcar essas propriedades nas informações de tipo do objeto.</span><span class="sxs-lookup"><span data-stu-id="28e33-120">Objects control which properties are bindable and request edit and mark such properties in the object's type information.</span></span> <span data-ttu-id="28e33-121">Nas informações de tipo, o atributo ligável marca uma propriedade como suporte [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span><span class="sxs-lookup"><span data-stu-id="28e33-121">In the type information, the attribute bindable marks a property as supporting [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged).</span></span> <span data-ttu-id="28e33-122">O atributo requestedit marca uma propriedade como [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit)de suporte.</span><span class="sxs-lookup"><span data-stu-id="28e33-122">The attribute requestedit marks a property as supporting [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit).</span></span>

<span data-ttu-id="28e33-123">Uma propriedade pode dar suporte a ambos os comportamentos, caso em que [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) é chamado primeiro, e somente se a alteração for permitida for [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) chamada.</span><span class="sxs-lookup"><span data-stu-id="28e33-123">One property can support both behaviors in which case [**OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) is called first, and only if change is allowed is [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) called.</span></span>

<span data-ttu-id="28e33-124">A única exceção ao comportamento dessas propriedades é que nenhuma notificação é enviada como resultado dos procedimentos de inicialização ou carregamento de um objeto.</span><span class="sxs-lookup"><span data-stu-id="28e33-124">The one exception to the behavior of such properties is that no notifications are sent as a result of an object's initialization or loading procedures.</span></span> <span data-ttu-id="28e33-125">Nesses momentos, supõe-se que todas as propriedades sejam alteradas e que todas devem ter permissão para serem alteradas.</span><span class="sxs-lookup"><span data-stu-id="28e33-125">At such times, it is assumed that all properties change and that all must be allowed to change.</span></span> <span data-ttu-id="28e33-126">As notificações para essa interface são, portanto, apenas significativas no contexto de um objeto totalmente inicializado/carregado.</span><span class="sxs-lookup"><span data-stu-id="28e33-126">Notifications to this interface are therefore only meaningful in the context of a fully initialized/loaded object.</span></span>

<span data-ttu-id="28e33-127">Dois outros atributos podem ser aplicados às propriedades nas informações de tipo de um objeto.</span><span class="sxs-lookup"><span data-stu-id="28e33-127">Two other attributes can be applied to properties in an object's type information.</span></span> <span data-ttu-id="28e33-128">O atributo defaultbind marca uma propriedade vinculável como sendo a que melhor representa o estado do objeto como um todo.</span><span class="sxs-lookup"><span data-stu-id="28e33-128">The defaultbind attribute marks a bindable property as being the one that best represents the state of the object as a whole.</span></span> <span data-ttu-id="28e33-129">O atributo displaybind marca uma propriedade vinculável como adequada para exibição na interface do usuário de um cliente.</span><span class="sxs-lookup"><span data-stu-id="28e33-129">The displaybind attribute marks a bindable property as suitable for display in a client's own user interface.</span></span>

## <a name="related-topics"></a><span data-ttu-id="28e33-130">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="28e33-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="28e33-131">Páginas de propriedades e folhas de propriedades</span><span class="sxs-lookup"><span data-stu-id="28e33-131">Property Pages and Property Sheets</span></span>](property-pages-and-property-sheets.md)
</dt> </dl>

 

 




