---
title: Estrutura de códigos de erro COM
description: Estrutura de códigos de erro COM
ms.assetid: 97e68708-eb62-4481-af03-cf8b80304103
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb27143f50028592f6fe0aeb5cab9795dcd10d4a
ms.sourcegitcommit: d39e82e232f6510f843fdb8d55d25b4e9e02e880
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/03/2021
ms.locfileid: "104570653"
---
# <a name="structure-of-com-error-codes"></a><span data-ttu-id="9ef67-103">Estrutura de códigos de erro COM</span><span class="sxs-lookup"><span data-stu-id="9ef67-103">Structure of COM Error Codes</span></span>

<span data-ttu-id="9ef67-104">A ilustração a seguir mostra o formato de um [**HRESULT**](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a) (ou SCODE); os números indicam as posições de bits:</span><span class="sxs-lookup"><span data-stu-id="9ef67-104">The following illustration shows the format of an [**HRESULT**](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a) (or SCODE); the numbers indicate bit positions:</span></span>

![Mostra o formato de um "resultado" ou "código" com números que indicam posições de bits.](images/a5a947d1-7b5a-4474-afed-2a1c58fe2421.png)

<span data-ttu-id="9ef67-106">O bit de ordem superior no **HRESULT** ou SCODE indica se o valor de retorno representa êxito ou falha.</span><span class="sxs-lookup"><span data-stu-id="9ef67-106">The high-order bit in the **HRESULT** or SCODE indicates whether the return value represents success or failure.</span></span> <span data-ttu-id="9ef67-107">Se definido como 0, \_ êxito na severidade, o valor indica êxito.</span><span class="sxs-lookup"><span data-stu-id="9ef67-107">If set to 0, SEVERITY\_SUCCESS, the value indicates success.</span></span> <span data-ttu-id="9ef67-108">Se definido como 1, erro de severidade \_ , indica falha.</span><span class="sxs-lookup"><span data-stu-id="9ef67-108">If set to 1, SEVERITY\_ERROR, it indicates failure.</span></span>

<span data-ttu-id="9ef67-109">Os bits R, C, N e R são reservados.</span><span class="sxs-lookup"><span data-stu-id="9ef67-109">The R, C, N, and r bits are reserved.</span></span>

<span data-ttu-id="9ef67-110">O campo recurso indica o serviço do sistema responsável pelo erro.</span><span class="sxs-lookup"><span data-stu-id="9ef67-110">The facility field indicates the system service responsible for the error.</span></span> <span data-ttu-id="9ef67-111">A Microsoft aloca novos códigos de recursos à medida que eles se tornam necessários.</span><span class="sxs-lookup"><span data-stu-id="9ef67-111">Microsoft allocates new facility codes as they become necessary.</span></span> <span data-ttu-id="9ef67-112">A maioria dos valores SCODEs e **HRESULT** definem o campo recurso como recurso \_ ITF, indicando um erro de método de interface.</span><span class="sxs-lookup"><span data-stu-id="9ef67-112">Most SCODEs and **HRESULT** values set the facility field to FACILITY\_ITF, indicating an interface method error.</span></span>

<span data-ttu-id="9ef67-113">Os campos de recursos comuns são descritos na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="9ef67-113">Common facility fields are described in the following table.</span></span>



| <span data-ttu-id="9ef67-114">Campo de recurso</span><span class="sxs-lookup"><span data-stu-id="9ef67-114">Facility Field</span></span>                | <span data-ttu-id="9ef67-115">Valor</span><span class="sxs-lookup"><span data-stu-id="9ef67-115">Value</span></span>        | <span data-ttu-id="9ef67-116">Descrição</span><span class="sxs-lookup"><span data-stu-id="9ef67-116">Description</span></span>                                                                                                                                                                                                                                                                                                              |
|-------------------------------|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="9ef67-117">expedição de recursos \_</span><span class="sxs-lookup"><span data-stu-id="9ef67-117">FACILITY\_DISPATCH</span></span><br/> | <span data-ttu-id="9ef67-118">2</span><span class="sxs-lookup"><span data-stu-id="9ef67-118">2</span></span><br/> | <span data-ttu-id="9ef67-119">Para erros da interface **IDispatch** de ligação tardia.</span><span class="sxs-lookup"><span data-stu-id="9ef67-119">For late-binding **IDispatch** interface errors.</span></span> <br/>                                                                                                                                                                                                                                                             |
| <span data-ttu-id="9ef67-120">ITF de instalação \_</span><span class="sxs-lookup"><span data-stu-id="9ef67-120">FACILITY\_ITF</span></span><br/>      | <span data-ttu-id="9ef67-121">4</span><span class="sxs-lookup"><span data-stu-id="9ef67-121">4</span></span><br/> | <span data-ttu-id="9ef67-122">Para a maioria dos códigos de status retornados dos métodos de interface.</span><span class="sxs-lookup"><span data-stu-id="9ef67-122">For most status codes returned from interface methods.</span></span> <span data-ttu-id="9ef67-123">O significado real do erro é definido pela interface.</span><span class="sxs-lookup"><span data-stu-id="9ef67-123">The actual meaning of the error is defined by the interface.</span></span> <span data-ttu-id="9ef67-124">Ou seja, dois **HRESULT** s com exatamente o mesmo valor de 32 bits retornado de duas interfaces diferentes podem ter significados diferentes.</span><span class="sxs-lookup"><span data-stu-id="9ef67-124">That is, two **HRESULT** s with exactly the same 32-bit value returned from two different interfaces might have different meanings.</span></span> <br/>                                                       |
| <span data-ttu-id="9ef67-125">RECURSO \_ nulo</span><span class="sxs-lookup"><span data-stu-id="9ef67-125">FACILITY\_NULL</span></span><br/>     | <span data-ttu-id="9ef67-126">0</span><span class="sxs-lookup"><span data-stu-id="9ef67-126">0</span></span><br/> | <span data-ttu-id="9ef67-127">Para códigos de status comuns amplamente aplicáveis, como S \_ OK.</span><span class="sxs-lookup"><span data-stu-id="9ef67-127">For broadly applicable common status codes such as S\_OK.</span></span> <br/>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="9ef67-128">RECURSO \_ RPC</span><span class="sxs-lookup"><span data-stu-id="9ef67-128">FACILITY\_RPC</span></span><br/>      | <span data-ttu-id="9ef67-129">1</span><span class="sxs-lookup"><span data-stu-id="9ef67-129">1</span></span><br/> | <span data-ttu-id="9ef67-130">Para códigos de status retornados de chamadas de procedimento remoto.</span><span class="sxs-lookup"><span data-stu-id="9ef67-130">For status codes returned from remote procedure calls.</span></span> <br/>                                                                                                                                                                                                                                                       |
| <span data-ttu-id="9ef67-131">armazenamento de instalações \_</span><span class="sxs-lookup"><span data-stu-id="9ef67-131">FACILITY\_STORAGE</span></span><br/>  | <span data-ttu-id="9ef67-132">3</span><span class="sxs-lookup"><span data-stu-id="9ef67-132">3</span></span><br/> | <span data-ttu-id="9ef67-133">Para códigos de status retornados das chamadas de método [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) ou [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) relacionadas ao armazenamento estruturado.</span><span class="sxs-lookup"><span data-stu-id="9ef67-133">For status codes returned from [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) or [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) method calls relating to structured storage.</span></span> <span data-ttu-id="9ef67-134">Os códigos de status cujo valor de código (mais de 16 bits) está no intervalo de códigos de erro do MS-DOS (ou seja, menos de 256) têm o mesmo significado que o erro do MS-DOS correspondente.</span><span class="sxs-lookup"><span data-stu-id="9ef67-134">Status codes whose code (lower 16 bits) value is in the range of MS-DOS error codes (that is, less than 256) have the same meaning as the corresponding MS-DOS error.</span></span> <br/> |
| <span data-ttu-id="9ef67-135">RECURSO \_ Win32</span><span class="sxs-lookup"><span data-stu-id="9ef67-135">FACILITY\_WIN32</span></span><br/>    | <span data-ttu-id="9ef67-136">7</span><span class="sxs-lookup"><span data-stu-id="9ef67-136">7</span></span><br/> | <span data-ttu-id="9ef67-137">Usado para fornecer um meio de manipular códigos de erro de funções na API do Windows como um **HRESULT**.</span><span class="sxs-lookup"><span data-stu-id="9ef67-137">Used to provide a means of handling error codes from functions in the Windows API as an **HRESULT**.</span></span> <span data-ttu-id="9ef67-138">Os códigos de erro em OLE de 16 bits que códigos de erro duplicados do sistema também foram alterados para recursos do \_ Win32.</span><span class="sxs-lookup"><span data-stu-id="9ef67-138">Error codes in 16-bit OLE that duplicated system error codes have also been changed to FACILITY\_WIN32.</span></span> <br/>                                                                                                 |
| <span data-ttu-id="9ef67-139">janelas de instalações \_</span><span class="sxs-lookup"><span data-stu-id="9ef67-139">FACILITY\_WINDOWS</span></span><br/>  | <span data-ttu-id="9ef67-140">8</span><span class="sxs-lookup"><span data-stu-id="9ef67-140">8</span></span><br/> | <span data-ttu-id="9ef67-141">Usado para códigos de erro adicionais das interfaces definidas pela Microsoft.</span><span class="sxs-lookup"><span data-stu-id="9ef67-141">Used for additional error codes from Microsoft-defined interfaces.</span></span><br/>                                                                                                                                                                                                                                            |



 

<span data-ttu-id="9ef67-142">O campo de código é um número exclusivo que é atribuído para representar o erro ou aviso.</span><span class="sxs-lookup"><span data-stu-id="9ef67-142">The code field is a unique number that is assigned to represent the error or warning.</span></span>

<span data-ttu-id="9ef67-143">Por convenção, os valores **HRESULT** geralmente têm nomes no seguinte formato:  \_ motivo de *gravidade* da instalação \_ .</span><span class="sxs-lookup"><span data-stu-id="9ef67-143">By convention, **HRESULT** values generally have names in the following format: *Facility*\_*Severity*\_*Reason*.</span></span>

<span data-ttu-id="9ef67-144">O *recurso* é o nome do recurso ou algum outro identificador diferencial; *Severidade* é uma única letra, S ou e, que indica se a chamada de função foi bem-sucedida ou produziu um erro (E); e o *motivo* é um identificador que descreve o significado do código.</span><span class="sxs-lookup"><span data-stu-id="9ef67-144">*Facility* is either the facility name or some other distinguishing identifier; *Severity* is a single letter, S or E, that indicates whether the function call succeeded (S) or produced an error (E); and *Reason* is an identifier that describes the meaning of the code.</span></span> <span data-ttu-id="9ef67-145">Por exemplo, o código de status STG \_ E \_ FILENOTFOUND indica que ocorreu um erro relacionado ao armazenamento; especificamente, um arquivo solicitado não existe.</span><span class="sxs-lookup"><span data-stu-id="9ef67-145">For example, the status code STG\_E\_FILENOTFOUND indicates a storage-related error has occurred; specifically, a requested file does not exist.</span></span> <span data-ttu-id="9ef67-146">Os códigos de status do recurso \_ NULL omitem o prefixo de *recurso* \_ .</span><span class="sxs-lookup"><span data-stu-id="9ef67-146">Status codes from FACILITY\_NULL omit the *Facility*\_ prefix.</span></span>

<span data-ttu-id="9ef67-147">Os códigos de erro são definidos dentro do contexto de uma implementação de interface.</span><span class="sxs-lookup"><span data-stu-id="9ef67-147">Error codes are defined within the context of an interface implementation.</span></span> <span data-ttu-id="9ef67-148">Uma vez definidas, os códigos de êxito não podem ser alterados ou novos códigos de êxito foram adicionados.</span><span class="sxs-lookup"><span data-stu-id="9ef67-148">Once defined, success codes cannot be changed or new success codes added.</span></span> <span data-ttu-id="9ef67-149">No entanto, novos códigos de falha podem ser gravados.</span><span class="sxs-lookup"><span data-stu-id="9ef67-149">However, new failure codes can be written.</span></span> <span data-ttu-id="9ef67-150">A Microsoft se reserva o direito de definir novos códigos de falha (mas não códigos de êxito) para as interfaces descritas em FACILITy \_ ITF ou em novas instalações.</span><span class="sxs-lookup"><span data-stu-id="9ef67-150">Microsoft reserves the right to define new failure codes (but not success codes) for the interfaces described in FACILITY\_ITF or in new facilities.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9ef67-151">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="9ef67-151">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9ef67-152">Tratamento de erro em COM</span><span class="sxs-lookup"><span data-stu-id="9ef67-152">Error Handling in COM</span></span>](error-handling-in-com.md)
</dt> <dt>

[<span data-ttu-id="9ef67-153">Protocolos do Windows: HRESULT</span><span class="sxs-lookup"><span data-stu-id="9ef67-153">Windows Protocols: HRESULT</span></span>](/openspecs/windows_protocols/ms-erref/0642cb2f-2075-4469-918c-4441e69c548a)
</dt> </dl>

 

