---
title: Exibir cache
description: Exibir cache
ms.assetid: d19c111c-1367-43a2-97a9-35dc0ff5dcc8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 592c5bc2555e907cdc4e600465b807387c3a5548
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104366745"
---
# <a name="view-caching"></a><span data-ttu-id="3721a-103">Exibir cache</span><span class="sxs-lookup"><span data-stu-id="3721a-103">View Caching</span></span>

<span data-ttu-id="3721a-104">Um aplicativo de contêiner deve ser capaz de obter uma apresentação de um objeto com a finalidade de exibi-lo ou imprimi-lo para os usuários quando o documento está aberto, mas o aplicativo de servidor do objeto não está em execução ou não está instalado no computador do usuário.</span><span class="sxs-lookup"><span data-stu-id="3721a-104">A container application must be able to obtain a presentation of an object for the purpose of displaying or printing it for users when the document is open but the object's server application is not running or is not installed on the user's machine.</span></span> <span data-ttu-id="3721a-105">No entanto, para supor que os servidores de todos os objetos que podem ser considerados em um documento sejam instalados no computador de cada usuário e sempre possam ser executados sob demanda.</span><span class="sxs-lookup"><span data-stu-id="3721a-105">To assume, however, that the servers for all the objects that might conceivably be found in a document are installed on every user's machine and can always run on demand is unrealistic.</span></span> <span data-ttu-id="3721a-106">O manipulador de objetos padrão, que está disponível em todos os momentos, resolve esse dilema armazenando em cache as apresentações de objetos no armazenamento do documento e manipulando essas apresentações em qualquer plataforma, independentemente da disponibilidade do servidor de objetos em qualquer instalação específica do contêiner.</span><span class="sxs-lookup"><span data-stu-id="3721a-106">The default object handler, which is available at all times, solves this dilemma by caching object presentations in the document's storage and manipulating these presentations on any platform regardless of the availablility of the object server on any particular installation of the container.</span></span>

<span data-ttu-id="3721a-107">Os contêineres podem manter apresentações de desenho para um ou mais dispositivos de destino específicos, além do necessário para manter o objeto na tela.</span><span class="sxs-lookup"><span data-stu-id="3721a-107">Containers can maintain drawing presentations for one or more specific target devices in addition to the one required to maintain the object on screen.</span></span> <span data-ttu-id="3721a-108">Além disso, se você portar o objeto de uma plataforma para outra, o OLE converterá automaticamente os formatos de dados do objeto para aqueles com suporte na nova plataforma.</span><span class="sxs-lookup"><span data-stu-id="3721a-108">Moreover, if you port the object from one platform to another, OLE automatically converts the object's data formats to ones supported on the new platform.</span></span> <span data-ttu-id="3721a-109">Por exemplo, se você mover um objeto do Windows para o Macintosh, o OLE converterá suas apresentações de metarquivo em formatos PICT.</span><span class="sxs-lookup"><span data-stu-id="3721a-109">For example, if you move an object from Windows to the Macintosh, OLE will convert its metafile presentations to PICT formats.</span></span>

<span data-ttu-id="3721a-110">Para apresentar uma representação precisa de um objeto incorporado ao usuário, o aplicativo de contêiner do objeto inicia uma caixa de diálogo com o manipulador de objetos, solicitando dados e instruções de desenho.</span><span class="sxs-lookup"><span data-stu-id="3721a-110">In order to present an accurate representation of an embedded object to the user, the object's container application initiates a dialog with the object handler, requesting data and drawing instructions.</span></span> <span data-ttu-id="3721a-111">Para poder atender às solicitações do contêiner, o manipulador deve implementar as interfaces [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)e [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) .</span><span class="sxs-lookup"><span data-stu-id="3721a-111">To be able to fulfill the container's requests, the handler must implement the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2), and [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) interfaces.</span></span>

<span data-ttu-id="3721a-112">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) permite que um aplicativo de contêiner OLE obtenha dados e envie dados para seus objetos incorporados ou vinculados.</span><span class="sxs-lookup"><span data-stu-id="3721a-112">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) enables an OLE container application to get data from and send data to its embedded or linked objects.</span></span> <span data-ttu-id="3721a-113">Quando os dados são alterados em um objeto, essa interface fornece uma maneira para que o objeto torne seus novos dados disponíveis para seu contêiner e fornece ao contêiner uma maneira de atualizar os dados em sua cópia do objeto.</span><span class="sxs-lookup"><span data-stu-id="3721a-113">When data changes in an object, this interface provides a way for the object to make its new data available to its container and provides the container with a way to update the data in its copy of the object.</span></span> <span data-ttu-id="3721a-114">(Para uma discussão sobre transferência de dados em geral, consulte o capítulo 4, Transferência de Dados.)</span><span class="sxs-lookup"><span data-stu-id="3721a-114">(For a discussion of data transfer in general, see Chapter 4, Data Transfer.)</span></span>

<span data-ttu-id="3721a-115">A interface [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) é muito parecida com a interface [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) , exceto que ela solicita que um objeto se desenhe em um contexto de dispositivo, como uma tela, impressora ou metarquivo, em vez de mover ou copiar seus dados para a memória ou outra mídia de transferência.</span><span class="sxs-lookup"><span data-stu-id="3721a-115">The [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) interface is very much like the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface except that it asks an object to draw itself on a device context, such as a screen, printer, or metafile, rather than move or copy its data to memory or some other transfer medium.</span></span> <span data-ttu-id="3721a-116">A finalidade da interface é habilitar um contêiner OLE para obter representações de ilustração alternativas de seus objetos incorporados, cujos dados ele já tem, evitando, assim, a sobrecarga de ter que transferir totalmente novas instâncias dos mesmos objetos de dados simplesmente para obter novas instruções de desenho.</span><span class="sxs-lookup"><span data-stu-id="3721a-116">The purpose of the interface is to enable an OLE container to obtain alternative pictorial representations of its embedded objects, whose data it already has, thereby avoiding the overhead of having to transfer entirely new instances of the same data objects simply to obtain new drawing instructions.</span></span> <span data-ttu-id="3721a-117">Em vez disso, a interface **IViewObject2** permite que o contêiner peça a um objeto para fornecer uma representação de sua própria forma de desenho em um contexto de dispositivo especificado pelo contêiner.</span><span class="sxs-lookup"><span data-stu-id="3721a-117">Instead, the **IViewObject2** interface enables the container to ask an object to provide a pictorial representation of itself by drawing on a device context specified by the container.</span></span>

<span data-ttu-id="3721a-118">Ao chamar a interface [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) , um aplicativo de contêiner também pode especificar que o objeto seja desenhado em um dispositivo de destino diferente daquele em que ele realmente será renderizado.</span><span class="sxs-lookup"><span data-stu-id="3721a-118">When calling the [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) interface, a container application can also specify that the object draw itself on a target device different than the one on which it will actually be rendered.</span></span> <span data-ttu-id="3721a-119">Isso habilita o contêiner, conforme necessário, para gerar renderizações diferentes de um único objeto.</span><span class="sxs-lookup"><span data-stu-id="3721a-119">This enables the container, as needed, to generate different renderings from a single object.</span></span> <span data-ttu-id="3721a-120">Por exemplo, o chamador poderia pedir ao objeto para compor a si mesmo para uma impressora, mesmo que o desenho resultante seja renderizado na tela.</span><span class="sxs-lookup"><span data-stu-id="3721a-120">For example, the caller could ask the object to compose itself for a printer even though the resulting drawing will be rendered on screen.</span></span> <span data-ttu-id="3721a-121">O resultado, é claro, seria uma visualização de impressão do objeto.</span><span class="sxs-lookup"><span data-stu-id="3721a-121">The result, of course, would be a print-preview of the object.</span></span>

<span data-ttu-id="3721a-122">A interface [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)também fornece métodos que permitem que os contêineres se registrem para notificações de alteração de exibição.</span><span class="sxs-lookup"><span data-stu-id="3721a-122">The [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)interface also provides methods that enable containers to register for view-change notifications.</span></span> <span data-ttu-id="3721a-123">Assim como acontece com os conselhos de dados e OLE, uma conexão de exibição de consultoria permite que um contêiner atualize seus processamentos de um objeto por sua própria conveniência, em vez de responder a uma chamada do objeto.</span><span class="sxs-lookup"><span data-stu-id="3721a-123">As with data and OLE advisories, a view advisory connection enables a container to update its renderings of an object at its own convenience rather than in response to a call from the object.</span></span> <span data-ttu-id="3721a-124">Por exemplo, se uma nova versão do aplicativo de servidor de um objeto fosse oferecer exibições adicionais dos mesmos dados, o manipulador padrão do objeto chamaria a implementação de cada contêiner de [**IAdviseSink:: OnViewChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange) para informá-los de que as novas apresentações estavam disponíveis.</span><span class="sxs-lookup"><span data-stu-id="3721a-124">For example, if a new version of an object's server application were to offer additional views of the same data, the object's default handler would call each container's implementation of [**IAdviseSink::OnViewChange**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange) to let them know that the new presentations were available.</span></span> <span data-ttu-id="3721a-125">O contêiner recuperaria essas informações do coletor de aviso somente quando necessário.</span><span class="sxs-lookup"><span data-stu-id="3721a-125">The container would retrieve this information from the advise sink only when needed.</span></span>

<span data-ttu-id="3721a-126">Como os contextos de dispositivo do Windows têm significado apenas em um único processo, você não pode passar ponteiros [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) entre limites de processo.</span><span class="sxs-lookup"><span data-stu-id="3721a-126">Because Windows device contexts have meaning only within a single process, you cannot pass [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) pointers across process boundaries.</span></span> <span data-ttu-id="3721a-127">Como resultado, os servidores OLE local e remoto não precisam de nada para implementar a interface, o que não funcionaria corretamente, mesmo que tenha feito isso.</span><span class="sxs-lookup"><span data-stu-id="3721a-127">As a result, OLE local and remote servers have no need whatsoever to implement the interface, which wouldn't work properly even if they did.</span></span> <span data-ttu-id="3721a-128">Somente manipuladores de objeto e servidores em processo implementam a interface **IViewObject2**.</span><span class="sxs-lookup"><span data-stu-id="3721a-128">Only object handlers and in-process servers implement the **IViewObject2** interface.</span></span> <span data-ttu-id="3721a-129">O OLE fornece uma implementação padrão, que você pode usar em seus próprios servidores OLE em processo e manipuladores de objetos simplesmente agregando o manipulador padrão OLE.</span><span class="sxs-lookup"><span data-stu-id="3721a-129">OLE provides a default implementation, which you can use in your own OLE in-process servers and object handlers simply by aggregating the OLE default handler.</span></span> <span data-ttu-id="3721a-130">Ou você pode escrever sua própria implementação de **IViewObject2**.</span><span class="sxs-lookup"><span data-stu-id="3721a-130">Or you can write your own implementation of **IViewObject2**.</span></span>

<span data-ttu-id="3721a-131">Um objeto implementa a interface [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) para permitir que o manipulador saiba quais recursos ele deve armazenar em cache.</span><span class="sxs-lookup"><span data-stu-id="3721a-131">An object implements the [**IOleCache**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) interface in order to let the handler know what capabilities it should cache.</span></span> <span data-ttu-id="3721a-132">O manipulador de objetos também possui o cache e garante que ele seja mantido atualizado.</span><span class="sxs-lookup"><span data-stu-id="3721a-132">The object handler also owns the cache and ensures it is kept up to date.</span></span> <span data-ttu-id="3721a-133">Como o objeto incorporado entra no estado de execução, o manipulador configura as conexões de consultoria apropriadas no objeto de servidor, com ele atuando como o coletor.</span><span class="sxs-lookup"><span data-stu-id="3721a-133">As the embedded object enters the running state, the handler sets up appropriate advisory connections on the server object, with itself acting as the sink.</span></span> <span data-ttu-id="3721a-134">As implementações da interface [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) e [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)operam fora dos dados armazenados em cache no lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="3721a-134">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)interface implementations operate out of data cached on the client side.</span></span> <span data-ttu-id="3721a-135">A implementação do manipulador de **IViewObject2** é responsável por determinar quais formatos de dados armazenar em cache para atender às solicitações de desenho do cliente.</span><span class="sxs-lookup"><span data-stu-id="3721a-135">The handler's implementation of **IViewObject2** is responsible for determining what data formats to cache in order to satisfy client draw requests.</span></span> <span data-ttu-id="3721a-136">A implementação do manipulador de **IDataObject** é responsável por obter dados em vários formatos, etc., entre a memória e a instância de [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) subjacente do objeto inserido.</span><span class="sxs-lookup"><span data-stu-id="3721a-136">The handler's implementation of **IDataObject** is responsible for getting data in various formats, etc., between memory and the underlying [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) instance of the embedded object.</span></span> <span data-ttu-id="3721a-137">Os manipuladores personalizados podem usar essas implementações agregando no manipulador padrão.</span><span class="sxs-lookup"><span data-stu-id="3721a-137">Custom handlers can use these implementations by aggregating on the default handler.</span></span>

> [!Note]  
> <span data-ttu-id="3721a-138">A interface [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) é uma extensão funcional simples de [**IViewObject**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject) e deve ser implementada em vez da última interface, que agora é obsoleta.</span><span class="sxs-lookup"><span data-stu-id="3721a-138">The [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) interface is a simple functional extension of [**IViewObject**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject) and should be implemented instead of the latter interface, which is now obsolete.</span></span> <span data-ttu-id="3721a-139">Além de fornecer os métodos **IViewObject** , a interface **IViewObject2** fornece um único membro [**adicional, getestende, que**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent)permite que um aplicativo de contêiner obtenha o tamanho da apresentação de um objeto do cache sem precisar primeiro mover o objeto para o estado em execução com uma chamada para [**IOleObject:: getextensão**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent).</span><span class="sxs-lookup"><span data-stu-id="3721a-139">In addition to providing the **IViewObject** methods, the **IViewObject2** interface provides a single additional member, [**GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent), which enables a container application to get the size of an object's presentation from the cache without first having to move the object into the running state with a call to [**IOleObject::GetExtent**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent).</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="3721a-140">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="3721a-140">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3721a-141">Documentos compostos</span><span class="sxs-lookup"><span data-stu-id="3721a-141">Compound Documents</span></span>](compound-documents.md)
</dt> </dl>

 

 