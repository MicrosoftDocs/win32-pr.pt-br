---
title: Arquitetura de objetos conectáveis
description: Arquitetura de objetos conectáveis
ms.assetid: 69949a3b-3ab8-4054-84d8-9256fbf39c7b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e9d8d2909942d1c04aed972e7891a6f4ae3f730
ms.sourcegitcommit: d39e82e232f6510f843fdb8d55d25b4e9e02e880
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/03/2021
ms.locfileid: "105788695"
---
# <a name="architecture-of-connectable-objects"></a><span data-ttu-id="012e4-103">Arquitetura de objetos conectáveis</span><span class="sxs-lookup"><span data-stu-id="012e4-103">Architecture of Connectable Objects</span></span>

<span data-ttu-id="012e4-104">O objeto conectável é apenas uma parte da arquitetura geral de objetos conectáveis.</span><span class="sxs-lookup"><span data-stu-id="012e4-104">The connectable object is only one piece of the overall architecture of connectable objects.</span></span> <span data-ttu-id="012e4-105">Essa tecnologia inclui os seguintes elementos:</span><span class="sxs-lookup"><span data-stu-id="012e4-105">This technology includes the following elements:</span></span>

-   <span data-ttu-id="012e4-106">**Objeto conectável.**</span><span class="sxs-lookup"><span data-stu-id="012e4-106">**Connectable object.**</span></span> <span data-ttu-id="012e4-107">Implementa a interface [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) ; cria pelo menos um objeto de ponto de conexão; define uma interface de saída para o cliente.</span><span class="sxs-lookup"><span data-stu-id="012e4-107">Implements the [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) interface; creates at least one connection point object; defines an outgoing interface for the client.</span></span>
-   <span data-ttu-id="012e4-108">**Cliente.**</span><span class="sxs-lookup"><span data-stu-id="012e4-108">**Client.**</span></span> <span data-ttu-id="012e4-109">Consulta o objeto para [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) para determinar se o objeto é conectável; Cria um objeto de coletor para implementar a interface de saída definida pelo objeto que pôde ser conectado.</span><span class="sxs-lookup"><span data-stu-id="012e4-109">Queries the object for [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) to determine whether the object is connectable; creates a sink object to implement the outgoing interface defined by the connectable object.</span></span>
-   <span data-ttu-id="012e4-110">**Objeto Sink.**</span><span class="sxs-lookup"><span data-stu-id="012e4-110">**Sink object.**</span></span> <span data-ttu-id="012e4-111">Implementa a interface de saída; usado para estabelecer uma conexão com o objeto conectável.</span><span class="sxs-lookup"><span data-stu-id="012e4-111">Implements the outgoing interface; used to establish a connection to the connectable object.</span></span>
-   <span data-ttu-id="012e4-112">**Objeto de ponto de conexão.**</span><span class="sxs-lookup"><span data-stu-id="012e4-112">**Connection point object.**</span></span> <span data-ttu-id="012e4-113">Implementa a interface [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) e gerencia a conexão com o coletor do cliente.</span><span class="sxs-lookup"><span data-stu-id="012e4-113">Implements the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface and manages connection with the client's sink.</span></span>

<span data-ttu-id="012e4-114">As relações entre o cliente, o objeto connectável, um ponto de conexão e um coletor são ilustradas no diagrama a seguir:</span><span class="sxs-lookup"><span data-stu-id="012e4-114">The relationships between client, connectable object, a connection point, and a sink are illustrated in the following diagram:</span></span>

![Diagrama que mostra os pontos de conexão entre o cliente e o objeto conectável.](images/1cd44fec-5d2c-4427-846b-ccab7ec0b08a.png)

<span data-ttu-id="012e4-116">Antes que o objeto de ponto de conexão Chame métodos na interface do coletor na etapa 3 no diagrama anterior, ele deve ser [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) para a interface específica necessária, mesmo que o ponteiro já tenha passado na chamada Step 2 para o método [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) .</span><span class="sxs-lookup"><span data-stu-id="012e4-116">Before the connection point object calls methods in the sink interface in step 3 in the preceding diagram, it must [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) for the specific interface required, even if the pointer was already passed in the step 2 call to the [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) method.</span></span>

<span data-ttu-id="012e4-117">Dois objetos enumeradores também estão envolvidos nessa arquitetura, embora não sejam mostrados na ilustração.</span><span class="sxs-lookup"><span data-stu-id="012e4-117">Two enumerator objects are also involved in this architecture though not shown in the illustration.</span></span> <span data-ttu-id="012e4-118">Um é criado por um método em [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) para enumerar os pontos de conexão dentro do objeto conectável.</span><span class="sxs-lookup"><span data-stu-id="012e4-118">One is created by a method in [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) to enumerate the connection points within the connectable object.</span></span> <span data-ttu-id="012e4-119">O outro é criado por um método em [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) para enumerar as conexões estabelecidas atualmente com esse ponto de conexão.</span><span class="sxs-lookup"><span data-stu-id="012e4-119">The other is created by a method in [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) to enumerate the connections currently established to that connection point.</span></span> <span data-ttu-id="012e4-120">Um ponto de conexão pode dar suporte a várias interfaces de coletor conectadas e deve iterar na lista de conexões toda vez que faz uma chamada de método nessa interface.</span><span class="sxs-lookup"><span data-stu-id="012e4-120">One connection point can support multiple connected sink interfaces, and it should iterate through the list of connections each time it makes a method call on that interface.</span></span> <span data-ttu-id="012e4-121">Esse processo é conhecido como multicast.</span><span class="sxs-lookup"><span data-stu-id="012e4-121">This process is known as multicasting.</span></span>

<span data-ttu-id="012e4-122">Ao trabalhar com objetos conectáveis, é importante entender que o objeto conectável, cada ponto de conexão, cada coletor e todos os enumeradores são objetos separados com implementações [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) separadas, contagens de referência separadas e tempos de vida separados.</span><span class="sxs-lookup"><span data-stu-id="012e4-122">When working with connectable objects, it is important to understand that the connectable object, each connection point, each sink, and all enumerators are separate objects with separate [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) implementations, separate reference counts, and separate lifetimes.</span></span> <span data-ttu-id="012e4-123">Um cliente que usa esses objetos é sempre responsável por liberar todas as contagens de referência que ele possui.</span><span class="sxs-lookup"><span data-stu-id="012e4-123">A client using these objects is always responsible for releasing all reference counts it owns.</span></span>

> [!Note]  
> <span data-ttu-id="012e4-124">Um objeto conectável pode dar suporte a mais de um cliente e pode dar suporte a vários coletores dentro de um cliente.</span><span class="sxs-lookup"><span data-stu-id="012e4-124">A connectable object can support more than one client and can support multiple sinks within a client.</span></span> <span data-ttu-id="012e4-125">Da mesma forma, um coletor pode ser conectado a mais de um objeto conectável.</span><span class="sxs-lookup"><span data-stu-id="012e4-125">Likewise, a sink can be connected to more than one connectable object.</span></span>

 

<span data-ttu-id="012e4-126">As etapas para estabelecer uma conexão entre um cliente e um objeto conectável são as seguintes:</span><span class="sxs-lookup"><span data-stu-id="012e4-126">The steps for establishing a connection between a client and a connectable object are as follows:</span></span>

1.  <span data-ttu-id="012e4-127">O cliente consulta o [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) no objeto para determinar se o objeto é conectável.</span><span class="sxs-lookup"><span data-stu-id="012e4-127">The client queries for [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) on the object to determine whether the object is connectable.</span></span> <span data-ttu-id="012e4-128">Se essa chamada for bem-sucedida, o cliente mantém um ponteiro para a interface **IConnectionPointContainer** no objeto que pôde ser conectado e o contador de referência de objeto conectável foi incrementado.</span><span class="sxs-lookup"><span data-stu-id="012e4-128">If this call is successful, the client holds a pointer to the **IConnectionPointContainer** interface on the connectable object and the connectable object reference counter has been incremented.</span></span> <span data-ttu-id="012e4-129">Caso contrário, o objeto não será conectável e não dará suporte a interfaces de saída.</span><span class="sxs-lookup"><span data-stu-id="012e4-129">Otherwise, the object is not connectable and does not support outgoing interfaces.</span></span>
2.  <span data-ttu-id="012e4-130">Se o objeto for conectável, o cliente tentará, em seguida, obter um ponteiro para a interface [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) em um ponto de conexão dentro do objeto conectável.</span><span class="sxs-lookup"><span data-stu-id="012e4-130">If the object is connectable, the client next tries to obtain a pointer to the [**IConnectionPoint**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpoint) interface on a connection point within the connectable object.</span></span> <span data-ttu-id="012e4-131">Há dois métodos para obter esse ponteiro, em [**IConnectionPointContainer:: FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint) e em [**IConnectionPointContainer:: EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span><span class="sxs-lookup"><span data-stu-id="012e4-131">There are two methods for obtaining this pointer, both in [**IConnectionPointContainer::FindConnectionPoint**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-findconnectionpoint) and in [**IConnectionPointContainer::EnumConnectionPoints**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpointcontainer-enumconnectionpoints).</span></span> <span data-ttu-id="012e4-132">Há algumas etapas adicionais necessárias se **EnumConnectionPoints** for usado.</span><span class="sxs-lookup"><span data-stu-id="012e4-132">There are a few additional steps needed if **EnumConnectionPoints** is used.</span></span> <span data-ttu-id="012e4-133">(Consulte [usando IConnectionPointContainer](using-iconnectionpointcontainer.md) para obter mais informações.) Se for bem-sucedido, o objeto conectável e o cliente terão suporte para a mesma interface de saída.</span><span class="sxs-lookup"><span data-stu-id="012e4-133">(See [Using IConnectionPointContainer](using-iconnectionpointcontainer.md) for more information.) If successful, the connectable object and the client both support the same outgoing interface.</span></span> <span data-ttu-id="012e4-134">O objeto conectável o define e o chama, e o cliente o implementa.</span><span class="sxs-lookup"><span data-stu-id="012e4-134">The connectable object defines it and calls it, and the client implements it.</span></span> <span data-ttu-id="012e4-135">Em seguida, o cliente pode se comunicar por meio do ponto de conexão dentro do objeto que pode ser conectado.</span><span class="sxs-lookup"><span data-stu-id="012e4-135">The client can then communicate through the connection point within the connectable object.</span></span>
3.  <span data-ttu-id="012e4-136">Em seguida, o cliente chama [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) no ponto de conexão para estabelecer uma conexão entre sua interface de coletor e o ponto de conexão do objeto.</span><span class="sxs-lookup"><span data-stu-id="012e4-136">The client then calls [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) on the connection point to establish a connection between its sink interface and the object's connection point.</span></span> <span data-ttu-id="012e4-137">Após essa chamada, o ponto de conexão do objeto mantém um ponteiro para a interface de saída no coletor.</span><span class="sxs-lookup"><span data-stu-id="012e4-137">After this call, the object's connection point holds a pointer to the outgoing interface on the sink.</span></span>
4.  <span data-ttu-id="012e4-138">O código dentro de [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) chama [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) no ponteiro de interface que é passado, solicitando o identificador de interface específico ao qual ele se conecta.</span><span class="sxs-lookup"><span data-stu-id="012e4-138">The code inside [**Advise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-advise) calls [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) on the interface pointer that is passed in, asking for the specific interface identifier to which it connects.</span></span>
5.  <span data-ttu-id="012e4-139">O objeto chama métodos na interface do coletor, conforme necessário, usando o ponteiro mantido por seu ponto de conexão.</span><span class="sxs-lookup"><span data-stu-id="012e4-139">The object calls methods on the sink's interface as needed, using the pointer held by its connection point.</span></span>
6.  <span data-ttu-id="012e4-140">O cliente chama [**Unadvise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-unadvise) para encerrar a conexão.</span><span class="sxs-lookup"><span data-stu-id="012e4-140">The client calls [**Unadvise**](/windows/desktop/api/OCIdl/nf-ocidl-iconnectionpoint-unadvise) to terminate the connection.</span></span> <span data-ttu-id="012e4-141">Em seguida, o cliente chama **IConnectionPoint:: Release** para liberar sua espera no ponto de conexão e, portanto, o principal objeto conectável também.</span><span class="sxs-lookup"><span data-stu-id="012e4-141">Then the client calls **IConnectionPoint::Release** to free its hold on the connection point and, therefore, the main connectable object also.</span></span> <span data-ttu-id="012e4-142">O cliente também deve chamar **IConnectionPointContainer:: Release** para liberar sua espera no objeto principal que pode ser conectado.</span><span class="sxs-lookup"><span data-stu-id="012e4-142">The client must also call **IConnectionPointContainer::Release** to free its hold on the main connectable object.</span></span>

## <a name="related-topics"></a><span data-ttu-id="012e4-143">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="012e4-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="012e4-144">Interfaces de objeto conectáveis</span><span class="sxs-lookup"><span data-stu-id="012e4-144">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)
</dt> </dl>

 

 




