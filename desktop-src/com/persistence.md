---
title: Persistência
description: Persistência
ms.assetid: 4916ea52-a21c-4938-81cb-392b5ca1f6c1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7ba5fc0c8e389c7babdf80b76719b39fc02d5604
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104008462"
---
# <a name="persistence"></a><span data-ttu-id="2ca4e-103">Persistência</span><span class="sxs-lookup"><span data-stu-id="2ca4e-103">Persistence</span></span>

<span data-ttu-id="2ca4e-104">Um controle implementa uma ou mais de várias interfaces de persistência para dar suporte à persistência de seu estado.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-104">A control implements one or more of several persistence interfaces to support persistence of its state.</span></span> <span data-ttu-id="2ca4e-105">Por exemplo, a interface [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) dá suporte à persistência baseada em fluxo do estado do controle.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-105">For example, the [**IPersistStreamInit**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) interface supports stream-based persistence of the control's state.</span></span> <span data-ttu-id="2ca4e-106">**IPersistStreamInit** é uma substituição para [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) e adiciona um método de inicialização, [**InitNew**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-initnew).</span><span class="sxs-lookup"><span data-stu-id="2ca4e-106">**IPersistStreamInit** is a replacement for [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) and adds an initialization method, [**InitNew**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-initnew).</span></span> <span data-ttu-id="2ca4e-107">Os outros métodos são os mesmos em ambas as interfaces.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-107">The other methods are the same in both interfaces.</span></span> <span data-ttu-id="2ca4e-108">**IPersistStreamInit** não é derivado de **IPersistStream**; um objeto dá suporte a apenas uma das duas interfaces com base em se requer a capacidade de inicializar novas instâncias de si mesma.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-108">**IPersistStreamInit** is not derived from **IPersistStream**; an object supports only one of the two interfaces based on whether it requires the ability to initialize new instances of itself.</span></span>

<span data-ttu-id="2ca4e-109">Outras interfaces de persistência que um controle pode oferecer incluem: [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage), [**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85)), [**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85)), [**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="2ca4e-109">Other persistence interfaces that a control can offer include: [**IPersistStorage**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage), [**IPersistMemory**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85)), [**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85)), [**IPersistMoniker**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)).</span></span> <span data-ttu-id="2ca4e-110">O implementador de controle deve decidir quais tipos de persistência são mais importantes e implementar as interfaces de persistência apropriadas.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-110">The control implementer must decide what kinds of persistence are most important and implement the appropriate persistence interfaces.</span></span> <span data-ttu-id="2ca4e-111">O implementador de controle também decide o que salvar.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-111">The control implementer also decides what to save.</span></span> <span data-ttu-id="2ca4e-112">Por exemplo, um controle pode salvar os valores atuais de suas propriedades ou sua localização e tamanho dentro de seu contêiner.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-112">For example, a control can save the current values of its properties or its location and size within its container.</span></span> <span data-ttu-id="2ca4e-113">O cliente decide qual interface prefere usar.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-113">The client decides which interface it prefers to use.</span></span>

<span data-ttu-id="2ca4e-114">Antes de carregar um controle de seu estado persistente, um cliente pode verificar o \_ sinalizador OLEMISC SETCLIENTSITEFIRST para determinar se o controle dá suporte à obtenção de suas propriedades de site e de ambiente do cliente antes de carregar seu estado persistente.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-114">Before loading a control from its persistent state, a client can check the OLEMISC\_SETCLIENTSITEFIRST flag to determine if the control supports getting its client site and ambient properties before loading its persistent state.</span></span> <span data-ttu-id="2ca4e-115">Essa otimização pode poupar tempo ao instanciar um controle, uma vez que o controle é liberado para ignorar seus valores persistentes em vez de carregá-los apenas para que sejam substituídos pelas propriedades de ambiente fornecidas pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-115">This optimization can save time when instantiating a control since the control is then free to ignore its persistent values rather than loading them only to have them overridden by ambient properties supplied by the client.</span></span>

<span data-ttu-id="2ca4e-116">Um controle também pode dar suporte a salvar e restaurar seu estado em um conjunto de propriedades OLE, um conjunto de identificadores e valores em um formato especificado.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-116">A control can also support saving and restoring its state in an OLE property set, a set of identifiers and values in a specified format.</span></span> <span data-ttu-id="2ca4e-117">Esse recurso pode ser útil com contêineres como Visual Basic, que salva seus programas em um formato de texto.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-117">This feature can be useful with containers such as Visual Basic, which saves its programs in a textual form.</span></span> <span data-ttu-id="2ca4e-118">Um controle que deseja dar suporte a esse recurso implementa [**IDataObject:: GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) e [**IDataObject:: SetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-setdata) para passar seus valores de propriedade para e do contêiner, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-118">A control that wants to support this feature implements [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) and [**IDataObject::SetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-setdata) to pass its property values to and from the container, respectively.</span></span> <span data-ttu-id="2ca4e-119">É o trabalho do contêiner para converter essas informações em texto e salvá-las.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-119">It is the container's job to convert this information to text and save it.</span></span> <span data-ttu-id="2ca4e-120">Os identificadores usados pelo controle correspondem aos nomes de Propriedade do controle e aos valores.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-120">The identifiers used by the control correspond to the control's property names and the values.</span></span> <span data-ttu-id="2ca4e-121">Consulte o CDK OLE para a definição deste conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="2ca4e-121">See the OLE CDK for the definition of this property set.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2ca4e-122">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="2ca4e-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2ca4e-123">Controles ActiveX</span><span class="sxs-lookup"><span data-stu-id="2ca4e-123">ActiveX Controls</span></span>](activex-controls.md)
</dt> </dl>

 

 