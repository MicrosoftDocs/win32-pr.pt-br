---
title: Interfaces Transferência de Dados
description: Interfaces Transferência de Dados
ms.assetid: c42e65a4-7b77-4f39-8323-04fa60c5b140
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 448e1a580880c7202ec67d12965f6db7e0be99d0
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "105765342"
---
# <a name="data-transfer-interfaces"></a><span data-ttu-id="c3ba5-103">Interfaces Transferência de Dados</span><span class="sxs-lookup"><span data-stu-id="c3ba5-103">Data Transfer Interfaces</span></span>

<span data-ttu-id="c3ba5-104">A interface [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) fornece aos consumidores de dados os métodos para obter e definir os dados de um objeto, determinando os formatos aos quais o objeto dá suporte e registrando e recebendo notificações quando os dados no objeto são alterados.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-104">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface provides consumers of data with methods for getting and setting an object's data, determining which formats the object supports, and registering for and receiving notifications when data in the object changes.</span></span> <span data-ttu-id="c3ba5-105">Ao obter dados, um chamador pode especificar o formato no qual deseja renderizar os dados.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-105">When obtaining data, a caller can specify the format in which it wants to render the data.</span></span> <span data-ttu-id="c3ba5-106">A origem dos dados, no entanto, determina o meio de armazenamento, que ele retorna em um parâmetro out fornecido pelo chamador.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-106">The source of the data, however, determines the storage medium, which it returns in an out parameter provided by the caller.</span></span>

<span data-ttu-id="c3ba5-107">Por si só, o [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) fornece todas as ferramentas necessárias para implementar transferências de área de transferência do Windows ou transferências de documentos compostos em seus aplicativos.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-107">By itself, [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) supplies all the tools you need to implement Windows clipboard transfers or compound document transfers in your applications.</span></span> <span data-ttu-id="c3ba5-108">Se você também quiser dar suporte a transferências de arrastar e soltar, precisará implementar as interfaces [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) e [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) juntamente com **IDataObject**.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-108">If you also want to support drag and drop transfers, you need to implement the [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) and [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) interfaces along with **IDataObject**.</span></span>

<span data-ttu-id="c3ba5-109">A interface [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) combinada com as APIs de área de transferência OLE fornece todos os recursos das APIs de área de transferência do Windows.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-109">The [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface combined with OLE clipboard APIs provide all the capabilities of the Windows clipboard APIs.</span></span> <span data-ttu-id="c3ba5-110">Geralmente, não é necessário usar ambas as APIs da área de transferência.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-110">It is not generally necessary to use both clipboard APIs.</span></span> <span data-ttu-id="c3ba5-111">Os fornecedores de dados que dão suporte a transferências de arrastar e soltar ou documentos compostos OLE devem implementar a interface **IDataObject** .</span><span class="sxs-lookup"><span data-stu-id="c3ba5-111">Data suppliers that support either drag and drop transfers or OLE compound documents must implement the **IDataObject** interface.</span></span> <span data-ttu-id="c3ba5-112">Se seu aplicativo der suporte apenas a transferências de área de transferência agora, mas você pretende adicionar documentos de arrastar e soltar ou compostos em versões posteriores, talvez você queira implementar o **IDataObject** e as APIs da área de transferência OLE agora para minimizar a quantidade de tempo gasto para recodificar e depurar mais tarde.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-112">If your application supports only clipboard transfers now, but you intend to add drag and drop or compound documents in later releases, you may want to implement **IDataObject** and the OLE clipboard APIs now in order to minimize the amount of time spent recoding and debugging later.</span></span> <span data-ttu-id="c3ba5-113">Talvez você também queira implementar o **IDataObject** para utilizar a mídia de transferência que não seja a memória global.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-113">You may also want to implement **IDataObject** in order to utilize transfer media other than global memory.</span></span>

<span data-ttu-id="c3ba5-114">A tabela a seguir resume quais deles usar, dependendo de quais tipos de transferência de dados você deseja oferecer suporte:</span><span class="sxs-lookup"><span data-stu-id="c3ba5-114">The following table summarizes which ones to use, depending on what types of data transfer you want to support:</span></span>



| <span data-ttu-id="c3ba5-115">Para dar suporte a</span><span class="sxs-lookup"><span data-stu-id="c3ba5-115">To support</span></span>                                                                       | <span data-ttu-id="c3ba5-116">Uso</span><span class="sxs-lookup"><span data-stu-id="c3ba5-116">Use</span></span>                                                                                                                                                                         |
|----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c3ba5-117">Documentos compostos</span><span class="sxs-lookup"><span data-stu-id="c3ba5-117">Compound documents</span></span><br/>                                                    | [<span data-ttu-id="c3ba5-118">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="c3ba5-118">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| <span data-ttu-id="c3ba5-119">Arrastar e soltar transferências</span><span class="sxs-lookup"><span data-stu-id="c3ba5-119">Drag and drop transfers</span></span><br/>                                               | <span data-ttu-id="c3ba5-120">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource), [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget), [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (ou equivalente)</span><span class="sxs-lookup"><span data-stu-id="c3ba5-120">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IDropSource**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource), [**IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget), [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (or the equivalent)</span></span><br/> |
| <span data-ttu-id="c3ba5-121">Transferências de área de transferência usando memória global exclusivamente</span><span class="sxs-lookup"><span data-stu-id="c3ba5-121">Clipboard transfers using global memory exclusively</span></span><br/>                   | [<span data-ttu-id="c3ba5-122">API da área de transferência</span><span class="sxs-lookup"><span data-stu-id="c3ba5-122">Clipboard API</span></span>](../dataxchg/clipboard.md)<br/>                                                                                                                            |
| <span data-ttu-id="c3ba5-123">Transferências de área de transferência usando mídias do Exchange diferentes da memória global.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-123">Clipboard transfers using exchange mediums other than global memory.</span></span><br/>  | [<span data-ttu-id="c3ba5-124">**IDataObject**</span><span class="sxs-lookup"><span data-stu-id="c3ba5-124">**IDataObject**</span></span>](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| <span data-ttu-id="c3ba5-125">Transferências da área de transferência agora, mas arrastar e soltar ou documentos compostos mais tarde</span><span class="sxs-lookup"><span data-stu-id="c3ba5-125">Clipboard transfers now but drag and drop or compound documents later</span></span><br/> | <span data-ttu-id="c3ba5-126">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) e as interfaces e funções listadas acima para "arrastar e soltar transferências"</span><span class="sxs-lookup"><span data-stu-id="c3ba5-126">[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and the interfaces and function listed above for "Drag and drop transfers"</span></span><br/>                                                    |



 

<span data-ttu-id="c3ba5-127">Quando um usuário inicia uma operação de transferência de dados, o aplicativo de origem cria uma instância do [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) e, por meio dela, torna os dados disponíveis em um ou mais formatos.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-127">When a user initiates a data transfer operation, the source application creates an instance of [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) and through it makes the data available in one or more formats.</span></span> <span data-ttu-id="c3ba5-128">Em uma transferência de área de transferência, o aplicativo chama a função [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) para passar um ponteiro de objeto de dados para OLE.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-128">In a clipboard transfer, the application calls the [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) function to pass a data-object pointer to OLE.</span></span> <span data-ttu-id="c3ba5-129">(O **OleSetClipboard** também oferece formatos de dados padrão da área de transferência para aplicativos OLE versão 1 e não OLE.) Em uma transferência de arrastar e soltar, o aplicativo chama a função [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) em vez disso.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-129">(**OleSetClipboard** also offers standard clipboard data formats for both OLE version 1 and non-OLE applications.) In a drag and drop transfer, the application calls the [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) function instead.</span></span>

<span data-ttu-id="c3ba5-130">No lado de recebimento da transferência, o destino recebe o ponteiro [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) como um argumento para uma invocação de [**IDropTarget::D ROP**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) ou chamando a função [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) , dependendo se a transferência é por meio de arrastar e soltar ou da área de transferência.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-130">On the receiving side of the transfer, the destination receives the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) pointer either as an argument to an invocation of [**IDropTarget::Drop**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) or by calling the [**OleSetClipboard**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) function, depending on whether the transfer is by means of drag and drop or the clipboard.</span></span> <span data-ttu-id="c3ba5-131">Tendo obtido esse ponteiro, o destino chama [**IDataObject:: EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) para saber quais formatos estão disponíveis para recuperação e em quais tipos de mídia eles podem ser obtidos.</span><span class="sxs-lookup"><span data-stu-id="c3ba5-131">Having obtained this pointer, the destination calls [**IDataObject::EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) to learn what formats are available for retrieval and on what types of media they can be obtained.</span></span> <span data-ttu-id="c3ba5-132">Munido dessas informações, o aplicativo de recebimento solicita os dados com uma chamada para [**IDataObject:: GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata).</span><span class="sxs-lookup"><span data-stu-id="c3ba5-132">Armed with this information, the receiving application requests the data with a call to [**IDataObject::GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata).</span></span>

## <a name="related-topics"></a><span data-ttu-id="c3ba5-133">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="c3ba5-133">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c3ba5-134">Transferência de Dados</span><span class="sxs-lookup"><span data-stu-id="c3ba5-134">Data Transfer</span></span>](data-transfer.md)
</dt> </dl>

 

