---
title: Implementando a ativação do In-Place
description: Implementando a ativação do In-Place
ms.assetid: 5fd67d1c-1dc5-4d83-a41e-b64d84cbf212
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c075f143c772fe34de0c494664227e892b998387
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "105770058"
---
# <a name="implementing-in-place-activation"></a><span data-ttu-id="9f1ce-103">Implementando a ativação do In-Place</span><span class="sxs-lookup"><span data-stu-id="9f1ce-103">Implementing In-Place Activation</span></span>

<span data-ttu-id="9f1ce-104">A ativação in-loco permite que um usuário interaja com um objeto inserido sem sair do documento de contêiner.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-104">In-place activation enables a user to interact with an embedded object without leaving the container document.</span></span> <span data-ttu-id="9f1ce-105">Quando um usuário ativa o objeto, uma *barra de menus compostas* que inclui elementos das barras de menus do aplicativo de contêiner e do aplicativo do servidor substitui a barra de menus principal do contêiner.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-105">When a user activates the object, a *composite menu bar* comprising elements from both the container application's and server application's menu bars replaces the container's main menu bar.</span></span> <span data-ttu-id="9f1ce-106">Os comandos e recursos de ambos os aplicativos estão, portanto, disponíveis para o usuário, incluindo a ajuda contextual para o objeto ativo.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-106">Commands and features from both applications are thus available to the user, including context sensitive help for the active object.</span></span> <span data-ttu-id="9f1ce-107">Quando um usuário começa a trabalhar com alguma parte não objeto do documento, o objeto é desativado, fazendo com que o menu original do documento de contêiner substitua o menu composto.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-107">When a user begins working with some non-object portion of the document, the object is deactivated, causing the container document's original menu to replace the composite menu.</span></span>

<span data-ttu-id="9f1ce-108">Esse recurso foi originalmente criado pelo nome da *edição in-loco*.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-108">This capability originally went by the name of *in-place editing*.</span></span> <span data-ttu-id="9f1ce-109">O nome foi alterado porque a edição é apenas uma maneira de um usuário interagir com um objeto em execução.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-109">The name was changed because editing is only one way for a user to interact with a running object.</span></span> <span data-ttu-id="9f1ce-110">Os clipes de som, por exemplo, podem ser ouvidos em vez de editar.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-110">Sound clips, for example, can be listened to instead of editing.</span></span> <span data-ttu-id="9f1ce-111">Os clipes de vídeo podem ser exibidos em vez de editar.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-111">Video clips can be viewed instead of editing.</span></span> <span data-ttu-id="9f1ce-112">A ativação in-loco é particularmente apta no caso de clipes de vídeo porque permite que eles sejam executados no local, sem chamar uma janela separada.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-112">In-place activation is particularly apt in the case of video clips because it allows them to run in place, without calling up a separate window.</span></span> <span data-ttu-id="9f1ce-113">Isso pode ser crítico se o vídeo fosse exibido, digamos, em conjunto com os dados de texto adjacentes no documento de contêiner.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-113">This could be critical if the video were to be viewed, say, in conjunction with adjacent text data in the container document.</span></span>

<span data-ttu-id="9f1ce-114">A implementação da ativação in-loco é estritamente opcional para os aplicativos de contêiner e de servidor.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-114">Implementing in-place activation is strictly optional for both container and server applications.</span></span> <span data-ttu-id="9f1ce-115">O OLE ainda dá suporte ao modelo no qual a ativação de um objeto faz com que o aplicativo de servidor abra uma janela separada.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-115">OLE still supports the model in which activating an object causes the server application to open a separate window.</span></span> <span data-ttu-id="9f1ce-116">Os objetos vinculados sempre são abertos em uma janela separada para enfatizar que eles residem em um documento separado.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-116">Linked objects always open in a separate window to emphasize that they reside in a separate document.</span></span>

<span data-ttu-id="9f1ce-117">A ativação in-loco começa com o objeto em resposta a uma chamada [**IOleObject::D overb**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-doverb) de seu contêiner.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-117">In-place activation begins with the object in response to an [**IOleObject::DoVerb**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-doverb) call from its container.</span></span> <span data-ttu-id="9f1ce-118">Essa chamada geralmente acontece em resposta a um usuário clicando duas vezes no objeto ou selecionando um comando (verbo) no menu Editar do aplicativo contêiner.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-118">This call usually happens in response to a user double-clicking the object or selecting a command (verb) from the container application's Edit menu.</span></span>

<span data-ttu-id="9f1ce-119">A janela in-loco recebe a entrada do teclado e do mouse enquanto o objeto incorporado está ativo.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-119">The in-place window receives keyboard and mouse input while the embedded object is active.</span></span> <span data-ttu-id="9f1ce-120">Quando um usuário seleciona comandos na barra de menus de composição, o comando e as mensagens de menu associadas são enviadas para o aplicativo de contêiner ou objeto, dependendo de quem possui o menu suspenso específico selecionado.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-120">When a user selects commands from the composite menu bar, the command and associated menu messages are sent to the container or object application, depending on which owns the particular drop-down menu selected.</span></span> <span data-ttu-id="9f1ce-121">A entrada por meio de réguas, barras de ferramentas ou adornos de quadros de um objeto vai diretamente para o objeto inserido, que possui essas janelas.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-121">Input by means of an object's rulers, toolbars, or frame adornments go directly to the embedded object, which owns these windows.</span></span>

<span data-ttu-id="9f1ce-122">Um objeto incorporado ativado no local permanece ativo até que o contêiner o desative em resposta à entrada do usuário ou o objeto seja voluntariamente formado pelo estado ativo, como um clipe de vídeo pode, por exemplo.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-122">An in-place-activated embedded object remains active until either the container deactivates it in response to user input or the object voluntarily gives up the active state, as a video clip might do, for example.</span></span> <span data-ttu-id="9f1ce-123">Um usuário pode desativar um objeto clicando dentro do documento do contêiner, mas fora da janela de ativação in-loco do objeto, ou simplesmente clicando em outro objeto.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-123">A user can deactivate an object by clicking inside the container document but outside the object's in-place-activation window, or simply by clicking another object.</span></span> <span data-ttu-id="9f1ce-124">Um objeto ativado no local permanece ativo, no entanto, se o usuário clicar na barra de título do contêiner, na barra de rolagem ou, em particular, na barra de menus.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-124">An in-place-activated object remains active, however, if the user clicks the container's title bar, scroll bar or, in particular, menu bar.</span></span>

<span data-ttu-id="9f1ce-125">Você pode implementar um servidor in-loco-Activation-Object como um servidor em processo (DLL) ou um servidor local (EXE).</span><span class="sxs-lookup"><span data-stu-id="9f1ce-125">You can implement an in-place-activation-object server either as an in-process server (DLL) or a local server (EXE).</span></span> <span data-ttu-id="9f1ce-126">Em ambos os casos, a barra de menu composto contém itens (normalmente menus suspensos) dos processos de servidor e contêiner.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-126">In both cases, the composite menu bar contains items (typically drop-down menus) from both the server and container processes.</span></span> <span data-ttu-id="9f1ce-127">No caso de um servidor em processo, a janela de ativação in-loco é simplesmente outra janela filho na hierarquia de janela do contêiner, recebendo sua entrada por meio da bomba de mensagem do aplicativo de contêiner.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-127">In the case of a in-process server, the in-place activation window is simply another child window in the container's window hierarchy, receiving its input through the container application's message pump.</span></span>

<span data-ttu-id="9f1ce-128">No caso de um servidor local, a janela de ativação in-loco pertence ao processo do aplicativo de servidor do objeto incorporado, mas sua janela pai pertence ao contêiner.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-128">In the case of a local server, the in-place activation window belongs to the embedded object's server application process, but its parent window belongs to the container.</span></span> <span data-ttu-id="9f1ce-129">A entrada para a janela de ativação in-loco é exibida na fila de mensagens do servidor e é expedida pelo loop de mensagem do servidor.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-129">Input for the in-place-activation window appears in the server's message queue and is dispatched by the server's message loop.</span></span> <span data-ttu-id="9f1ce-130">As bibliotecas OLE são responsáveis por ver que os comandos de menu e as mensagens são expedidas corretamente.</span><span class="sxs-lookup"><span data-stu-id="9f1ce-130">The OLE libraries are responsible for seeing to it that menu commands and messages are dispatched correctly.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9f1ce-131">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="9f1ce-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9f1ce-132">Documentos compostos</span><span class="sxs-lookup"><span data-stu-id="9f1ce-132">Compound Documents</span></span>](compound-documents.md)
</dt> </dl>

 

 




