---
title: Objetos de classe COM e CLSIDs
description: Um servidor COM é implementado como uma classe COM.
ms.assetid: 0073acdf-38a8-4f1a-aa26-379456a95fca
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1bbfde2f379c4c7589db4cde283c8c67d720b21d
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "105765065"
---
# <a name="com-class-objects-and-clsids"></a><span data-ttu-id="d6603-103">Objetos de classe COM e CLSIDs</span><span class="sxs-lookup"><span data-stu-id="d6603-103">COM Class Objects and CLSIDs</span></span>

<span data-ttu-id="d6603-104">Um servidor COM é implementado como uma classe COM.</span><span class="sxs-lookup"><span data-stu-id="d6603-104">A COM server is implemented as a COM class.</span></span> <span data-ttu-id="d6603-105">Uma *classe com* é uma implementação de um grupo de interfaces no código executado sempre que você interage com um determinado objeto.</span><span class="sxs-lookup"><span data-stu-id="d6603-105">A *COM class* is an implementation of a group of interfaces in code executed whenever you interact with a given object.</span></span> <span data-ttu-id="d6603-106">Há uma distinção importante entre uma classe C++ e uma classe COM: em C++, uma classe é um tipo, enquanto uma classe COM é simplesmente uma definição do objeto e não transporta nenhum tipo, embora um programador de C++ possa implementá-la usando uma classe C++.</span><span class="sxs-lookup"><span data-stu-id="d6603-106">There is an important distinction between a C++ class and a COM class: In C++, a class is a type, while a COM class is simply a definition of the object and carries no type, although a C++ programmer might implement it by using a C++ class.</span></span> <span data-ttu-id="d6603-107">O COM foi projetado para permitir que uma classe seja usada por diferentes aplicativos, incluindo aplicativos escritos sem conhecimento da existência dessa classe específica.</span><span class="sxs-lookup"><span data-stu-id="d6603-107">COM is designed to allow a class to be used by different applications, including applications written without knowledge of that particular class's existence.</span></span> <span data-ttu-id="d6603-108">Portanto, o código de classe de um determinado tipo de objeto existe em uma DLL (biblioteca vinculada dinâmica) ou em outro aplicativo executável (EXE).</span><span class="sxs-lookup"><span data-stu-id="d6603-108">Therefore, class code for a given type of object exists either in a dynamic linked library (DLL) or in another executable application (EXE).</span></span>

<span data-ttu-id="d6603-109">Cada classe COM é identificada por um *CLSID*, um GUID de 128 bits exclusivo, que o servidor deve registrar.</span><span class="sxs-lookup"><span data-stu-id="d6603-109">Each COM class is identified by a *CLSID*, a unique 128-bit GUID, which the server must register.</span></span> <span data-ttu-id="d6603-110">O COM usa esse CLSID, na solicitação de um cliente, para associar dados específicos com a DLL ou EXE que contém o código que implementa a classe, criando assim uma instância do objeto.</span><span class="sxs-lookup"><span data-stu-id="d6603-110">COM uses this CLSID, at the request of a client, to associate specific data with the DLL or EXE containing the code that implements the class, thus creating an instance of the object.</span></span>

<span data-ttu-id="d6603-111">Para clientes e servidores no mesmo computador, o CLSID do servidor é todo o cliente precisar.</span><span class="sxs-lookup"><span data-stu-id="d6603-111">For clients and servers on the same computer, the CLSID of the server is all the client ever needs.</span></span> <span data-ttu-id="d6603-112">Em cada computador, o COM mantém um banco de dados (ele usa o registro do sistema em plataformas Microsoft Windows e Macintosh) de todos os CLSIDs para os servidores instalados no sistema.</span><span class="sxs-lookup"><span data-stu-id="d6603-112">On each computer, COM maintains a database (it makes use of the system registry on Microsoft Windows and Macintosh platforms) of all the CLSIDs for the servers installed on the system.</span></span> <span data-ttu-id="d6603-113">Esse é um mapeamento entre cada CLSID e o local do DLL ou EXE que abriga o código para esse CLSID.</span><span class="sxs-lookup"><span data-stu-id="d6603-113">This is a mapping between each CLSID and the location of the DLL or EXE that houses the code for that CLSID.</span></span> <span data-ttu-id="d6603-114">COM consulta esse banco de dados sempre que um cliente quiser criar uma instância de uma classe COM e usar seus serviços, o cliente nunca precisará saber o local absoluto do código no computador.</span><span class="sxs-lookup"><span data-stu-id="d6603-114">COM consults this database whenever a client wants to create an instance of a COM class and use its services, so the client never needs to know the absolute location of the code on the computer.</span></span>

<span data-ttu-id="d6603-115">Para sistemas distribuídos, o COM fornece entradas de registro que permitem que um servidor remoto se registre para uso por um cliente.</span><span class="sxs-lookup"><span data-stu-id="d6603-115">For distributed systems, COM provides registry entries that allow a remote server to register itself for use by a client.</span></span> <span data-ttu-id="d6603-116">Embora os aplicativos precisem conhecer apenas o CLSID de um servidor, porque eles podem confiar no registro para localizar o servidor, o COM permite que os clientes substituam as entradas do registro e especifiquem os locais do servidor, para aproveitar ao máximo a rede.</span><span class="sxs-lookup"><span data-stu-id="d6603-116">While applications need know only a server's CLSID, because they can rely on the registry to locate the server, COM allows clients to override registry entries and to specify server locations, to take full advantage of the network.</span></span> <span data-ttu-id="d6603-117">(Consulte [localizando um objeto remoto](locating-a-remote-object.md).)</span><span class="sxs-lookup"><span data-stu-id="d6603-117">(See [Locating a Remote Object](locating-a-remote-object.md).)</span></span>

<span data-ttu-id="d6603-118">A maneira básica de criar uma instância de uma classe é por meio de um *objeto de classe* com.</span><span class="sxs-lookup"><span data-stu-id="d6603-118">The basic way to create an instance of a class is through a COM *class object*.</span></span> <span data-ttu-id="d6603-119">Trata-se simplesmente de um objeto intermediário que dá suporte a funções comuns à criação de novas instâncias de uma determinada classe.</span><span class="sxs-lookup"><span data-stu-id="d6603-119">This is simply an intermediate object that supports functions common to creating new instances of a given class.</span></span> <span data-ttu-id="d6603-120">A maioria dos objetos de classe usados para criar objetos de um CLSID dá suporte à interface [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) , uma interface que inclui o método [**CreateInstance**](/windows/desktop/api/Unknwn/nf-unknwn-iclassfactory-createinstance) importante.</span><span class="sxs-lookup"><span data-stu-id="d6603-120">Most class objects used to create objects from a CLSID support the [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface, an interface that includes the important [**CreateInstance**](/windows/desktop/api/Unknwn/nf-unknwn-iclassfactory-createinstance) method.</span></span> <span data-ttu-id="d6603-121">Implemente uma interface **IClassFactory** para cada classe de objeto que você oferece a ser instanciada.</span><span class="sxs-lookup"><span data-stu-id="d6603-121">You implement an **IClassFactory** interface for each class of object that you offer to be instantiated.</span></span> <span data-ttu-id="d6603-122">(Para obter mais informações sobre como implementar **IClassFactory**, consulte [implementando IClassFactory](implementing-iclassfactory.md).)</span><span class="sxs-lookup"><span data-stu-id="d6603-122">(For more information about implementing **IClassFactory**, see [Implementing IClassFactory](implementing-iclassfactory.md).)</span></span>

> [!Note]  
> <span data-ttu-id="d6603-123">Os servidores que dão suporte a alguma outra interface de fábrica de classe personalizada não são necessários para dar suporte a [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) especificamente.</span><span class="sxs-lookup"><span data-stu-id="d6603-123">Servers that support some other custom class factory interface are not required to support [**IClassFactory**](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) specifically.</span></span> <span data-ttu-id="d6603-124">No entanto, as chamadas para funções de ativação que não sejam [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) (como [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)) exigem que o servidor dê suporte a **IClassFactory**.</span><span class="sxs-lookup"><span data-stu-id="d6603-124">However, calls to activation functions other than [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject) (such as [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)) require that the server support **IClassFactory**.</span></span>

 

<span data-ttu-id="d6603-125">Quando um cliente deseja criar uma instância do objeto do servidor, ele usa o CLSID do objeto desejado em uma chamada para [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject).</span><span class="sxs-lookup"><span data-stu-id="d6603-125">When a client wants to create an instance of the server's object, it uses the desired object's CLSID in a call to [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject).</span></span> <span data-ttu-id="d6603-126">(Essa chamada pode ser direta ou implícita, por meio de uma das funções auxiliares de criação de objeto.) Essa função localiza o código associado ao CLSID e cria um objeto de classe e fornece um ponteiro para a interface solicitada.</span><span class="sxs-lookup"><span data-stu-id="d6603-126">(This call can be either direct or implicit, through one of the object creation helper functions.) This function locates the code associated with the CLSID, and creates a class object, and supplies a pointer to the interface requested.</span></span> <span data-ttu-id="d6603-127">(**CoGetClassObject** usa um parâmetro *riid* que especifica o ponteiro de interface desejado do cliente.)</span><span class="sxs-lookup"><span data-stu-id="d6603-127">(**CoGetClassObject** takes a *riid* param that specifies the client's desired interface pointer.)</span></span>

> [!Note]  
> <span data-ttu-id="d6603-128">O COM tem apenas algumas funções nas quais muitos dos outros são criados.</span><span class="sxs-lookup"><span data-stu-id="d6603-128">COM has just a few functions upon which many of the others are built.</span></span> <span data-ttu-id="d6603-129">O mais importante deles é provavelmente [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), que se baseia em todas as funções de criação de instância.</span><span class="sxs-lookup"><span data-stu-id="d6603-129">The most important of these is probably [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), which underlies all of the instance creation functions.</span></span>

 

<span data-ttu-id="d6603-130">Com esse ponteiro, o chamador pode criar uma instância do objeto e recuperar um ponteiro para uma interface solicitada no objeto.</span><span class="sxs-lookup"><span data-stu-id="d6603-130">With this pointer, the caller can create an instance of the object and retrieve a pointer to a requested interface on the object.</span></span> <span data-ttu-id="d6603-131">Normalmente, isso é uma interface de inicialização, usada para ativar o objeto (colocá-lo no estado de execução) para que o cliente possa fazer qualquer trabalho com o objeto que desejar.</span><span class="sxs-lookup"><span data-stu-id="d6603-131">This is usually an initialization interface, used to activate the object (put it in the running state) so that the client can do whatever work with the object that it wants to.</span></span> <span data-ttu-id="d6603-132">Usando as funções básicas do COM, o cliente também deve cuidar de liberar todos os ponteiros de objeto.</span><span class="sxs-lookup"><span data-stu-id="d6603-132">Using COM's basic functions, the client must also take care to release all object pointers.</span></span>

<span data-ttu-id="d6603-133">Outro mecanismo de ativação de instâncias de objeto é por meio do moniker de classe.</span><span class="sxs-lookup"><span data-stu-id="d6603-133">Another mechanism for activating object instances is through the class moniker.</span></span> <span data-ttu-id="d6603-134">Os monikers de classe são associados ao objeto de classe da classe para a qual eles são criados.</span><span class="sxs-lookup"><span data-stu-id="d6603-134">Class monikers bind to the class object of the class for which they are created.</span></span> <span data-ttu-id="d6603-135">Para obter mais informações, consulte [moniker de classe](class-monikers.md).</span><span class="sxs-lookup"><span data-stu-id="d6603-135">For more information, see [Class Monikers](class-monikers.md).</span></span>

<span data-ttu-id="d6603-136">O COM fornece várias funções auxiliares que reduzem o trabalho de criação de instâncias de objeto.</span><span class="sxs-lookup"><span data-stu-id="d6603-136">COM provides several helper functions that reduce the work of creating object instances.</span></span> <span data-ttu-id="d6603-137">Elas são descritas em [funções auxiliares de criação de instância](instance-creation-helper-functions.md).</span><span class="sxs-lookup"><span data-stu-id="d6603-137">These are described in [Instance Creation Helper Functions](instance-creation-helper-functions.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="d6603-138">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="d6603-138">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d6603-139">Criando um objeto por meio de um objeto de classe</span><span class="sxs-lookup"><span data-stu-id="d6603-139">Creating an Object Through a Class Object</span></span>](creating-an-object-through-a-class-object.md)
</dt> </dl>

 

 