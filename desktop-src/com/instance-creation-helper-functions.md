---
title: Funções auxiliares de criação de instância
description: Funções auxiliares de criação de instância
ms.assetid: 0b9b7bcf-f0f0-42c4-945e-63a532640d4b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 84956f6040aaba13b46dea92bea611a49d5d8de3
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104008411"
---
# <a name="instance-creation-helper-functions"></a><span data-ttu-id="55dfe-103">Funções auxiliares de criação de instância</span><span class="sxs-lookup"><span data-stu-id="55dfe-103">Instance Creation Helper Functions</span></span>

<span data-ttu-id="55dfe-104">Nas versões anteriores do COM, o mecanismo primário usado para criar uma instância de objeto era a função [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) .</span><span class="sxs-lookup"><span data-stu-id="55dfe-104">In previous releases of COM, the primary mechanism used to create an object instance was the [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function.</span></span> <span data-ttu-id="55dfe-105">Essa função encapsula o processo de criação de um objeto de classe, usando-o para criar uma nova instância e liberar o objeto de classe.</span><span class="sxs-lookup"><span data-stu-id="55dfe-105">This function encapsulates the process of creating a class object, using that to create a new instance and releasing the class object.</span></span> <span data-ttu-id="55dfe-106">Outra função desse tipo é o [**OleCreate**](/windows/desktop/api/ole/nf-ole-olecreate)mais específico, o auxiliar de documento OLE composto que cria um objeto de classe e recupera um ponteiro para um objeto solicitado.</span><span class="sxs-lookup"><span data-stu-id="55dfe-106">Another function of this kind is the more specific [**OleCreate**](/windows/desktop/api/ole/nf-ole-olecreate), the OLE compound document helper that creates a class object and retrieves a pointer to a requested object.</span></span>

<span data-ttu-id="55dfe-107">Para suavizar o processo de criação de instâncias em sistemas distribuídos, o COM introduziu quatro novos mecanismos importantes de criação de instância:</span><span class="sxs-lookup"><span data-stu-id="55dfe-107">To smooth the process of instance creation on distributed systems, COM has introduced four important new instance creation mechanisms:</span></span>

-   <span data-ttu-id="55dfe-108">Monikers de classe e [ **IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator)</span><span class="sxs-lookup"><span data-stu-id="55dfe-108">Class monikers and [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator)</span></span>
-   [<span data-ttu-id="55dfe-109">**CoCreateInstanceEx**</span><span class="sxs-lookup"><span data-stu-id="55dfe-109">**CoCreateInstanceEx**</span></span>](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex)
-   [<span data-ttu-id="55dfe-110">**CoGetInstanceFromFile**</span><span class="sxs-lookup"><span data-stu-id="55dfe-110">**CoGetInstanceFromFile**</span></span>](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile)
-   [<span data-ttu-id="55dfe-111">**CoGetInstanceFromIStorage**</span><span class="sxs-lookup"><span data-stu-id="55dfe-111">**CoGetInstanceFromIStorage**</span></span>](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage)

<span data-ttu-id="55dfe-112">Um moniker de classe permite que você identifique a classe de um objeto e normalmente é usado com outro moniker, como um moniker de arquivo, para indicar o local do objeto.</span><span class="sxs-lookup"><span data-stu-id="55dfe-112">A class moniker permits you to identify the class of an object and is typically used with another moniker, like a file moniker, to indicate the location of the object.</span></span> <span data-ttu-id="55dfe-113">Isso permite que você se vincule a um objeto e especifique o servidor que deve ser iniciado para esse objeto.</span><span class="sxs-lookup"><span data-stu-id="55dfe-113">This permits you to bind to an object and specify the server that is to be launched for that object.</span></span> <span data-ttu-id="55dfe-114">Os monikers de classe também podem ser compostos à direita dos monikers que dão suporte à associação à interface [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator) .</span><span class="sxs-lookup"><span data-stu-id="55dfe-114">Class monikers may also be composed to the right of monikers supporting binding to the [**IClassActivator**](/windows/desktop/api/ObjIdl/nn-objidl-iclassactivator) interface.</span></span> <span data-ttu-id="55dfe-115">Para obter mais informações, consulte [moniker de classe](class-monikers.md).</span><span class="sxs-lookup"><span data-stu-id="55dfe-115">For more information, see [Class Monikers](class-monikers.md).</span></span>

<span data-ttu-id="55dfe-116">[**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) estende [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) para tornar possível criar um único objeto não inicializado associado ao CLSID fornecido em um computador remoto especificado.</span><span class="sxs-lookup"><span data-stu-id="55dfe-116">[**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) extends [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) to make it possible to create a single uninitialized object associated with the given CLSID on a specified remote machine.</span></span> <span data-ttu-id="55dfe-117">Além disso, em vez de solicitar uma única interface e obter um único ponteiro para essa interface, o **CoCreateInstanceEx** torna possível consultar várias interfaces e (se disponível) receber ponteiros para elas em uma única viagem de ida e volta, permitindo, portanto, menos viagens de ida e volta entre as máquinas.</span><span class="sxs-lookup"><span data-stu-id="55dfe-117">In addition, rather than requesting a single interface and obtaining a single pointer to that interface, **CoCreateInstanceEx** makes it possible to query for multiple interfaces and (if available) receive pointers to them in a single round-trip, thus permitting fewer round-trips between machines.</span></span> <span data-ttu-id="55dfe-118">Isso pode tornar a interação do objeto remoto muito mais eficiente.</span><span class="sxs-lookup"><span data-stu-id="55dfe-118">This can make remote object interaction much more efficient.</span></span> <span data-ttu-id="55dfe-119">Para fazer isso, a função usa uma matriz de [**várias estruturas \_ QI**](/windows/win32/api/objidlbase/ns-objidlbase-multi_qi) .</span><span class="sxs-lookup"><span data-stu-id="55dfe-119">To do this, the function uses an array of [**MULTI\_QI**](/windows/win32/api/objidlbase/ns-objidlbase-multi_qi) structures.</span></span>

<span data-ttu-id="55dfe-120">A criação de um objeto por meio de [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) ainda requer que o objeto seja inicializado por meio de uma chamada para uma das interfaces de inicialização (como [**IPersistStorage:: Load**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststorage-load)).</span><span class="sxs-lookup"><span data-stu-id="55dfe-120">Creating an object through [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) still requires that the object be initialized through a call to one of the initialization interfaces (such as [**IPersistStorage::Load**](/windows/desktop/api/ObjIdl/nf-objidl-ipersiststorage-load)).</span></span> <span data-ttu-id="55dfe-121">As funções auxiliares [**CoGetInstanceFromFile**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile) e [**CoGetInstanceFromIStorage**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage) encapsulam a potência de criação de instância do **CoCreateInstanceEx** e a inicialização, a antiga de um arquivo e a última de um armazenamento.</span><span class="sxs-lookup"><span data-stu-id="55dfe-121">The helper functions [**CoGetInstanceFromFile**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromfile) and [**CoGetInstanceFromIStorage**](/windows/desktop/api/Objbase/nf-objbase-cogetinstancefromistorage) encapsulate both the instance creation power of **CoCreateInstanceEx** and the initialization, the former from a file and the latter from a storage.</span></span>

## <a name="related-topics"></a><span data-ttu-id="55dfe-122">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="55dfe-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="55dfe-123">Criando um objeto por meio de um objeto de classe</span><span class="sxs-lookup"><span data-stu-id="55dfe-123">Creating an Object Through a Class Object</span></span>](creating-an-object-through-a-class-object.md)
</dt> </dl>

 

 