---
title: Visão geral das diretrizes de contêiner de controle e controle
description: Visão geral das diretrizes de contêiner de controle e controle
ms.assetid: c4cf2409-0085-43e6-afa2-f9c03cc50565
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fd72851775898f4fd140c7d101d72993c34e3eb
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/29/2020
ms.locfileid: "103639087"
---
# <a name="overview-of-control-and-control-container-guidelines"></a><span data-ttu-id="d85b8-103">Visão geral das diretrizes de contêiner de controle e controle</span><span class="sxs-lookup"><span data-stu-id="d85b8-103">Overview of Control and Control Container Guidelines</span></span>

<span data-ttu-id="d85b8-104">Um controle ActiveX é essencialmente um objeto OLE simples que dá suporte à interface [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="d85b8-104">An ActiveX control is essentially a simple OLE object that supports the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="d85b8-105">Em geral, ele dará suporte a mais interfaces para oferecer funcionalidade, mas todas as interfaces adicionais podem ser exibidas como opcionais e, como tal, um contêiner de controle não deve depender de nenhuma interface adicional com suporte.</span><span class="sxs-lookup"><span data-stu-id="d85b8-105">It will usually support more interfaces in order to offer functionality, but all additional interfaces may be viewed as optional and as such, a control container should not rely on any additional interfaces being supported.</span></span> <span data-ttu-id="d85b8-106">Ao não especificar interfaces adicionais às quais um controle deve dar suporte, um controle pode direcionar com eficiência uma área específica de funcionalidade sem precisar dar suporte a interfaces específicas para se qualificar como um controle.</span><span class="sxs-lookup"><span data-stu-id="d85b8-106">By not specifying additional interfaces that a control must support, a control may efficiently target a particular area of functionality without having to support particular interfaces to qualify as a control.</span></span> <span data-ttu-id="d85b8-107">Como sempre com OLE, seja em um controle ou em um contêiner de controle, nunca deve ser considerado que uma interface está disponível e as convenções de verificação de retorno padrão sempre devem ser seguidas.</span><span class="sxs-lookup"><span data-stu-id="d85b8-107">As always with OLE, whether in a control or a control container, it should never be assumed that an interface is available and standard return-checking conventions should always be followed.</span></span> <span data-ttu-id="d85b8-108">É importante que um contêiner controle ou controle seja degradado normalmente e ofereça funcionalidade alternativa se uma interface necessária não estiver disponível.</span><span class="sxs-lookup"><span data-stu-id="d85b8-108">It is important for a control or control container to degrade gracefully and offer alternative functionality if an interface required is not available.</span></span>

<span data-ttu-id="d85b8-109">Um contêiner de controle ActiveX deve ser capaz de hospedar um controle ActiveX mínimo; Ele também dará suporte a várias interfaces adicionais, conforme especificado em [contêineres](containers.md).</span><span class="sxs-lookup"><span data-stu-id="d85b8-109">An ActiveX control container must be able to host a minimal ActiveX control; it will also support a number of additional interfaces as specified in [Containers](containers.md).</span></span> <span data-ttu-id="d85b8-110">Há uma série de interfaces e métodos aos quais um contêiner pode, opcionalmente, dar suporte, que são agrupados em áreas funcionais conhecidas como *categorias de componentes*.</span><span class="sxs-lookup"><span data-stu-id="d85b8-110">There are a number of interfaces and methods that a container may optionally support, which are grouped into functional areas known as *component categories*.</span></span> <span data-ttu-id="d85b8-111">Um contêiner pode dar suporte a qualquer combinação de categorias de componente, por exemplo, uma categoria de componente existe para a ligação de dados e um contêiner pode ou não oferecer suporte à funcionalidade de associação de dados, dependendo das necessidades de mercado do contêiner.</span><span class="sxs-lookup"><span data-stu-id="d85b8-111">A container may support any combination of component categories, for example, a component category exists for databinding and a container may or may not support the databinding functionality, depending on the market needs of the container.</span></span> <span data-ttu-id="d85b8-112">Se um controle precisar de suporte a DataBinding de um contêiner para funcionar, ele inserirá esse requisito no registro.</span><span class="sxs-lookup"><span data-stu-id="d85b8-112">If a control needs databinding support from a container to function, then it will enter this requirement in the registry.</span></span> <span data-ttu-id="d85b8-113">Isso permite que um contêiner de controle ofereça apenas para inserir os controles que ele sabe que ele pode hospedar com êxito.</span><span class="sxs-lookup"><span data-stu-id="d85b8-113">This allows a control container to only offer for insertion those controls that it knows it can successfully host.</span></span> <span data-ttu-id="d85b8-114">É importante observar que as categorias de componente são especificadas como parte do OLE e não são específicas para controles ActiveX, a arquitetura de controles usa categorias de componentes para identificar áreas de funcionalidades às quais um componente OLE pode dar suporte.</span><span class="sxs-lookup"><span data-stu-id="d85b8-114">It is important to note that component categories are specified as part of OLE and are not specific to ActiveX controls, the controls architecture uses component categories to identify areas of functionality that an OLE component may support.</span></span> <span data-ttu-id="d85b8-115">As categorias de componente não são cumulativas ou exclusivas, portanto, um contêiner de controle pode dar suporte a uma categoria sem necessariamente dar suporte a outra.</span><span class="sxs-lookup"><span data-stu-id="d85b8-115">Component categories are not cumulative or exclusive, so a control container can support one category without necessarily supporting another.</span></span>

<span data-ttu-id="d85b8-116">É importante que os controles que exigem recursos opcionais ou recursos específicos para um determinado contêiner sejam claramente empacotados e comercializados com esses requisitos.</span><span class="sxs-lookup"><span data-stu-id="d85b8-116">It is important for controls that require optional features, or features specific to a certain container to be clearly packaged and marketed with those requirements.</span></span> <span data-ttu-id="d85b8-117">Os contêineres da mesma forma que oferecem determinados recursos ou categorias de componentes devem ser comercializados e empacotados como oferecendo esses níveis de suporte ao hospedar controles ActiveX.</span><span class="sxs-lookup"><span data-stu-id="d85b8-117">Similarly containers that offer certain features or component categories must be marketed and packaged as offering those levels of support when hosting ActiveX controls.</span></span> <span data-ttu-id="d85b8-118">É recomendável que o controle o destino e o teste com o máximo de contêineres possível e degradar normalmente para oferecer funcionalidade menor ou alternativa se as interfaces ou os métodos não estiverem disponíveis.</span><span class="sxs-lookup"><span data-stu-id="d85b8-118">It is recommended that controls target and test with as many containers as possible and degrade gracefully to offer less or alternative functionality if interfaces or methods are not available.</span></span> <span data-ttu-id="d85b8-119">Em uma situação em que um controle não pode executar sua função de trabalho designada sem o suporte de uma categoria de componente, essa categoria deve ser inserida como um requisito no registro para impedir que o controle seja inserido em um contêiner inadequado.</span><span class="sxs-lookup"><span data-stu-id="d85b8-119">In a situation where a control cannot perform its designated job function without the support of a component category, that category should be entered as a requirement in the registry in order to prevent the control being inserted in an inappropriate container.</span></span>

<span data-ttu-id="d85b8-120">Essas diretrizes definem as interfaces e os métodos que um controle pode esperar que um contêiner de controle dê suporte, embora como sempre um controle deva verificar os valores de retorno ao usar [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) ou outros métodos para obter ponteiros para essas interfaces.</span><span class="sxs-lookup"><span data-stu-id="d85b8-120">These guidelines define those interfaces and methods that a control may expect a control container to support, although as always a control should check the return values when using [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) or other methods to obtain pointers to these interfaces.</span></span> <span data-ttu-id="d85b8-121">Um contêiner não deve esperar que um controle dê suporte a nada mais do que a interface [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) , e essas diretrizes identificam quais interfaces um controle pode dar suporte e qual significa a presença de uma interface específica.</span><span class="sxs-lookup"><span data-stu-id="d85b8-121">A container should not expect a control to support anything more than the [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface, and these guidelines identify what interfaces a control may support and what the presence of a particular interface means.</span></span>

## <a name="why-the-activex-control-and-control-container-guidelines-are-important"></a><span data-ttu-id="d85b8-122">Por que o controle ActiveX e as diretrizes de contêiner de controle são importantes</span><span class="sxs-lookup"><span data-stu-id="d85b8-122">Why the ActiveX Control and Control Container Guidelines Are Important</span></span>

<span data-ttu-id="d85b8-123">Os controles ActiveX se tornaram a principal arquitetura para o desenvolvimento de componentes de software programáveis para uso em vários contêineres diferentes, desde ferramentas de desenvolvimento de software até ferramentas de produtividade do usuário final.</span><span class="sxs-lookup"><span data-stu-id="d85b8-123">ActiveX Controls have become the primary architecture for developing programmable software components for use in a variety of different containers ranging from software development tools to end-user productivity tools.</span></span> <span data-ttu-id="d85b8-124">Para que um controle opere bem em uma variedade de contêineres, o controle deve ser capaz de assumir algum nível mínimo de funcionalidade sobre o qual ele pode depender em todos os contêineres.</span><span class="sxs-lookup"><span data-stu-id="d85b8-124">In order for a control to operate well in a variety of containers, the control must be able to assume some minimum level of functionality that it can rely on in all containers.</span></span>

<span data-ttu-id="d85b8-125">Ao seguir essas diretrizes, os desenvolvedores de controle e de contêineres tornam seus controles e contêineres mais confiáveis e interoperáveis e, por fim, melhores e mais utilizáveis componentes para a criação de soluções baseadas em componentes.</span><span class="sxs-lookup"><span data-stu-id="d85b8-125">By following these guidelines, control and container developers make their controls and containers more reliable and interoperable, and ultimately, better and more usable components for building component-based solutions.</span></span>

## <a name="what-to-do-when-an-interface-you-need-is-not-available"></a><span data-ttu-id="d85b8-126">O que fazer quando uma interface que você precisa não está disponível</span><span class="sxs-lookup"><span data-stu-id="d85b8-126">What to Do When an Interface You Need Is Not Available</span></span>

<span data-ttu-id="d85b8-127">Os programas OLE devem usar [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) para adquirir ponteiros de interface e devem verificar o valor de retorno.</span><span class="sxs-lookup"><span data-stu-id="d85b8-127">OLE programs should use [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) to acquire interface pointers, and must check the return value.</span></span> <span data-ttu-id="d85b8-128">Os aplicativos OLE não podem pressupor com segurança que **QueryInterface** terá sucesso.</span><span class="sxs-lookup"><span data-stu-id="d85b8-128">OLE applications cannot safely assume that **QueryInterface** will succeed.</span></span>

<span data-ttu-id="d85b8-129">Esse requisito se aplica a todos os aplicativos OLE.</span><span class="sxs-lookup"><span data-stu-id="d85b8-129">This requirement applies to all OLE applications.</span></span> <span data-ttu-id="d85b8-130">Se a interface solicitada não estiver disponível (ou seja, [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) retorna E \_ nointerface), o controle ou o contêiner deverá degradar normalmente, mesmo que isso signifique que ele não pode executar sua função de trabalho designada.</span><span class="sxs-lookup"><span data-stu-id="d85b8-130">If the requested interface is not available (that is, [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) returns E\_NOINTERFACE), the control or container must degrade gracefully, even if that means that it cannot perform its designated job function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d85b8-131">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="d85b8-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d85b8-132">Diretrizes de contêiner de controle e controle ActiveX</span><span class="sxs-lookup"><span data-stu-id="d85b8-132">ActiveX Control and Control Container Guidelines</span></span>](activex-control-and-control-container-guidelines.md)
</dt> </dl>

 

 




