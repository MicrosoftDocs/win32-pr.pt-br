---
title: Eventos em objetos COM e conectáveis
description: Quando um programa detecta algo que aconteceu, ele pode notificar seus clientes.
ms.assetid: f6ffbd1d-4bc1-4dc2-b3ed-ee12359e3d75
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa5115cfd08d57658eec879d44b4361e88965b3c
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/29/2020
ms.locfileid: "104007032"
---
# <a name="events-in-com-and-connectable-objects"></a><span data-ttu-id="df5ab-103">Eventos em objetos COM e conectáveis</span><span class="sxs-lookup"><span data-stu-id="df5ab-103">Events in COM and Connectable Objects</span></span>

<span data-ttu-id="df5ab-104">Quando um programa detecta algo que aconteceu, ele pode notificar seus clientes.</span><span class="sxs-lookup"><span data-stu-id="df5ab-104">When a program detects something that has happened, it can notify its clients.</span></span> <span data-ttu-id="df5ab-105">Por exemplo, se um programa de cotação de ações detectar uma alteração no preço de uma ação, ele poderá notificar todos os clientes da alteração.</span><span class="sxs-lookup"><span data-stu-id="df5ab-105">For example, if a stock ticker program detects a change in the price of a stock, it can notify all clients of the change.</span></span> <span data-ttu-id="df5ab-106">Esse processo de notificação é conhecido como *acionando um evento*.</span><span class="sxs-lookup"><span data-stu-id="df5ab-106">This notification process is referred to as *firing an event*.</span></span>

<span data-ttu-id="df5ab-107">Com o COM, os objetos de servidor podem usar eventos COM para acionar eventos sem nenhuma informação sobre quais objetos serão notificados.</span><span class="sxs-lookup"><span data-stu-id="df5ab-107">With COM, server objects can use COM events to fire events without any information about what objects will be notified.</span></span> <span data-ttu-id="df5ab-108">Os objetos também podem usar *objetos conectáveis* para manter informações detalhadas sobre os clientes que solicitaram notificações.</span><span class="sxs-lookup"><span data-stu-id="df5ab-108">Objects can also use *connectable objects* to maintain detailed information about clients who have requested notifications.</span></span>

<span data-ttu-id="df5ab-109">Os objetos de conexão COM fornecem interfaces de saída para seus clientes, além de suas interfaces de entrada.</span><span class="sxs-lookup"><span data-stu-id="df5ab-109">COM connectable objects provide outgoing interfaces to their clients in addition to their incoming interfaces.</span></span> <span data-ttu-id="df5ab-110">Como resultado, os objetos e seus clientes podem se envolver na comunicação bidirecional.</span><span class="sxs-lookup"><span data-stu-id="df5ab-110">As a result, objects and their clients can engage in bidirectional communication.</span></span> <span data-ttu-id="df5ab-111">As interfaces de entrada são implementadas em um objeto e recebem chamadas de clientes externos de um objeto, enquanto as interfaces de saída são implementadas no coletor do cliente e recebem chamadas do objeto.</span><span class="sxs-lookup"><span data-stu-id="df5ab-111">Incoming interfaces are implemented on an object and receive calls from external clients of an object, while outgoing interfaces are implemented on the client's sink and receive calls from the object.</span></span> <span data-ttu-id="df5ab-112">O objeto define uma interface que gostaria de usar e o cliente a implementa.</span><span class="sxs-lookup"><span data-stu-id="df5ab-112">The object defines an interface it would like to use, and the client implements it.</span></span>

<span data-ttu-id="df5ab-113">Um objeto define suas interfaces de entrada e fornece implementações dessas interfaces.</span><span class="sxs-lookup"><span data-stu-id="df5ab-113">An object defines its incoming interfaces and provides implementations of these interfaces.</span></span> <span data-ttu-id="df5ab-114">As interfaces de entrada estão disponíveis para clientes por meio do método [**IUnknown:: QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) do objeto.</span><span class="sxs-lookup"><span data-stu-id="df5ab-114">Incoming interfaces are available to clients through the object's [**IUnknown::QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) method.</span></span> <span data-ttu-id="df5ab-115">Os clientes chamam os métodos de uma interface de entrada no objeto e o objeto executa as ações desejadas em nome do cliente.</span><span class="sxs-lookup"><span data-stu-id="df5ab-115">Clients call the methods of an incoming interface on the object, and the object performs desired actions on behalf of the client.</span></span>

<span data-ttu-id="df5ab-116">As interfaces de saída também são definidas por um objeto, mas o cliente fornece as implementações das interfaces de saída em um objeto de coletor que o cliente cria.</span><span class="sxs-lookup"><span data-stu-id="df5ab-116">Outgoing interfaces are also defined by an object, but the client provides the implementations of the outgoing interfaces on a sink object that the client creates.</span></span> <span data-ttu-id="df5ab-117">Em seguida, o objeto chama métodos da interface de saída no objeto do coletor para notificar o cliente sobre as alterações no objeto, disparar eventos no cliente, solicitar algo do cliente, ou, na verdade, para qualquer finalidade com a qual o criador de objeto é fornecido.</span><span class="sxs-lookup"><span data-stu-id="df5ab-117">The object then calls methods of the outgoing interface on the sink object to notify the client of changes in the object, to trigger events in the client, to request something from the client, or, in fact, for any purpose the object creator comes up with.</span></span>

<span data-ttu-id="df5ab-118">Um exemplo de uma interface de saída é uma interface IButtonSink definida por um controle de botão de ação para notificar seus clientes sobre seus eventos.</span><span class="sxs-lookup"><span data-stu-id="df5ab-118">An example of an outgoing interface is an IButtonSink interface defined by a push button control to notify its clients of its events.</span></span> <span data-ttu-id="df5ab-119">Por exemplo, o objeto Button chama IButtonSink:: OnClick no objeto Sink do cliente quando o usuário clica no botão na tela.</span><span class="sxs-lookup"><span data-stu-id="df5ab-119">For example, the button object calls IButtonSink::OnClick on the client's sink object when the user clicks the button on the screen.</span></span> <span data-ttu-id="df5ab-120">O controle de botão define a interface de saída.</span><span class="sxs-lookup"><span data-stu-id="df5ab-120">The button control defines the outgoing interface.</span></span> <span data-ttu-id="df5ab-121">Para um cliente do botão manipular o evento, o cliente deve implementar essa interface de saída em um objeto de coletor e, em seguida, conectar esse coletor ao controle de botão.</span><span class="sxs-lookup"><span data-stu-id="df5ab-121">For a client of the button to handle the event, the client must implement that outgoing interface on a sink object and then connect that sink to the button control.</span></span> <span data-ttu-id="df5ab-122">Em seguida, quando os eventos ocorrerem no botão, o botão chamará o coletor, no momento em que o cliente pode executar qualquer ação que desejar atribuir a esse botão.</span><span class="sxs-lookup"><span data-stu-id="df5ab-122">Then, when events occur in the button, the button will call the sink, at which time the client can execute whatever action it wishes to assign to that button click.</span></span>

<span data-ttu-id="df5ab-123">Os objetos conectáveis fornecem um mecanismo geral para comunicação entre objetos e clientes.</span><span class="sxs-lookup"><span data-stu-id="df5ab-123">Connectable objects provide a general mechanism for object-to-client communication.</span></span> <span data-ttu-id="df5ab-124">Qualquer objeto que queira expor eventos ou notificações de qualquer tipo pode usar essa tecnologia.</span><span class="sxs-lookup"><span data-stu-id="df5ab-124">Any object that wishes to expose events or notifications of any kind can use this technology.</span></span> <span data-ttu-id="df5ab-125">Além da tecnologia de objeto de conexão geral, o COM fornece muitas interfaces de site e coletor de propósito especial usadas por objetos para notificar os clientes sobre eventos específicos de interesse do cliente.</span><span class="sxs-lookup"><span data-stu-id="df5ab-125">In addition to the general connectable object technology, COM provides many special purpose sink and site interfaces used by objects to notify clients of specific events of interest to the client.</span></span> <span data-ttu-id="df5ab-126">Por exemplo, [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) pode ser usado por objetos para notificar clientes de dados e exibir alterações no objeto.</span><span class="sxs-lookup"><span data-stu-id="df5ab-126">For example, [**IAdviseSink**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) may be used by objects to notify clients of data and view changes in the object.</span></span>

<span data-ttu-id="df5ab-127">Para mais informações, consulte os seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="df5ab-127">For more information, see the following topics:</span></span>

-   [<span data-ttu-id="df5ab-128">Arquitetura de objetos conectáveis</span><span class="sxs-lookup"><span data-stu-id="df5ab-128">Architecture of Connectable Objects</span></span>](architecture-of-connectable-objects.md)
-   [<span data-ttu-id="df5ab-129">Interfaces de objeto conectáveis</span><span class="sxs-lookup"><span data-stu-id="df5ab-129">Connectable Object Interfaces</span></span>](connectable-object-interfaces.md)

 

 




