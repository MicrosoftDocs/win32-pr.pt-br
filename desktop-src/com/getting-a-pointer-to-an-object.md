---
title: Obtendo um ponteiro para um objeto
description: Obtendo um ponteiro para um objeto
ms.assetid: 4af9d356-402b-4e69-9f6e-8589057d3ac4
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0476d36390e7077e7fdd75eef8d95e8173683891
ms.sourcegitcommit: 307b14e9847ced354a52a1ac12d7f659722d99bb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/06/2020
ms.locfileid: "105787655"
---
# <a name="getting-a-pointer-to-an-object"></a><span data-ttu-id="24ef0-103">Obtendo um ponteiro para um objeto</span><span class="sxs-lookup"><span data-stu-id="24ef0-103">Getting a Pointer to an Object</span></span>

<span data-ttu-id="24ef0-104">Como o COM não tem um modelo de classe estrito, há quatro maneiras pelas quais um cliente pode instanciar ou obter um ponteiro para uma interface em um objeto:</span><span class="sxs-lookup"><span data-stu-id="24ef0-104">Because COM does not have a strict class model, there are four ways that a client can instantiate or get a pointer to an interface on an object:</span></span>

-   <span data-ttu-id="24ef0-105">Chamar uma função de biblioteca COM que cria um objeto de um tipo predeterminado; ou seja, a função retornará um ponteiro para apenas uma interface específica para uma classe de objeto específica.</span><span class="sxs-lookup"><span data-stu-id="24ef0-105">Call a COM library function that creates an object of a predetermined type; that is, the function will return a pointer to only one specific interface for a specific object class.</span></span>
-   <span data-ttu-id="24ef0-106">Chame uma função de biblioteca COM que possa criar um objeto com base em um identificador de classe (CLSID) e que retorne qualquer tipo de ponteiro de interface solicitado.</span><span class="sxs-lookup"><span data-stu-id="24ef0-106">Call a COM library function that can create an object based on a class identifier (CLSID) and that returns any type of interface pointer requested.</span></span>
-   <span data-ttu-id="24ef0-107">Chame um método de alguma interface que crie outro objeto (ou se conecte a um existente) e retorne um ponteiro de interface nesse objeto separado.</span><span class="sxs-lookup"><span data-stu-id="24ef0-107">Call a method of some interface that creates another object (or connects to an existing one) and returns an interface pointer on that separate object.</span></span>
-   <span data-ttu-id="24ef0-108">Implemente um objeto com uma interface por meio da qual outros objetos passam o ponteiro de interface diretamente para o cliente.</span><span class="sxs-lookup"><span data-stu-id="24ef0-108">Implement an object with an interface through which other objects pass their interface pointer to the client directly.</span></span>

<span data-ttu-id="24ef0-109">Para obter informações sobre como obter ponteiros para outras interfaces em um objeto depois que você tiver o primeiro, consulte [QueryInterface: navegando em um objeto](queryinterface--navigating-in-an-object.md).</span><span class="sxs-lookup"><span data-stu-id="24ef0-109">For information on getting pointers to other interfaces on an object after you have the first one, see [QueryInterface: Navigating in an Object](queryinterface--navigating-in-an-object.md).</span></span>

## <a name="creating-an-object-of-a-predetermined-type"></a><span data-ttu-id="24ef0-110">Criando um objeto de um tipo predeterminado</span><span class="sxs-lookup"><span data-stu-id="24ef0-110">Creating an Object of a Predetermined Type</span></span>

<span data-ttu-id="24ef0-111">Há várias funções COM, como [**CoGetMalloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetmalloc), que retornam ponteiros para implementações de interface específicas.</span><span class="sxs-lookup"><span data-stu-id="24ef0-111">There are numerous COM functions, such as [**CoGetMalloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetmalloc), that return pointers to specific interface implementations.</span></span> <span data-ttu-id="24ef0-112">(**CoGetMalloc** recupera um ponteiro para o alocador de memória com padrão.) A maioria delas são funções auxiliares e a maioria dessas funções são descritas nas seções de referência desta documentação, sob a área específica à qual estão relacionadas, como armazenamento ou transferência de dados.</span><span class="sxs-lookup"><span data-stu-id="24ef0-112">(**CoGetMalloc** retrieves a pointer to the standard COM memory allocator.) Most of these are helper functions, and most of these functions are described in the reference sections of this documentation, under the specific area they are related to, such as storage or data transfer.</span></span>

## <a name="creating-an-object-based-on-a-clsid"></a><span data-ttu-id="24ef0-113">Criando um objeto com base em um CLSID</span><span class="sxs-lookup"><span data-stu-id="24ef0-113">Creating an Object Based on a CLSID</span></span>

<span data-ttu-id="24ef0-114">Há várias funções que, considerando um CLSID, um cliente pode chamar para criar uma instância de objeto e obter um ponteiro para ela.</span><span class="sxs-lookup"><span data-stu-id="24ef0-114">There are several functions that, given a CLSID, a client can call to create an object instance and get a pointer to it.</span></span> <span data-ttu-id="24ef0-115">Todas essas funções são baseadas na função [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), que cria um objeto de classe e fornece um ponteiro para uma interface que permite que você crie instâncias dessa classe.</span><span class="sxs-lookup"><span data-stu-id="24ef0-115">All of these functions are based on the function [**CoGetClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-cogetclassobject), which creates a class object and supplies a pointer to an interface that allows you to create instances of that class.</span></span> <span data-ttu-id="24ef0-116">Embora haja informações que indiquem em qual sistema o servidor reside, não há necessidade de que essas informações estejam contidas no cliente.</span><span class="sxs-lookup"><span data-stu-id="24ef0-116">While there must be information that says which system the server resides on, there is no need for that information to be contained in the client.</span></span> <span data-ttu-id="24ef0-117">O cliente precisa saber apenas o CLSID e nunca o caminho absoluto do código do servidor.</span><span class="sxs-lookup"><span data-stu-id="24ef0-117">The client needs to know only the CLSID and never the absolute path of the server code.</span></span> <span data-ttu-id="24ef0-118">Para obter mais informações, consulte [criando um objeto por meio de um objeto de classe](creating-an-object-through-a-class-object.md).</span><span class="sxs-lookup"><span data-stu-id="24ef0-118">For more information, see [Creating an Object Through a Class Object](creating-an-object-through-a-class-object.md).</span></span>

## <a name="returning-a-pointer-to-a-separate-object"></a><span data-ttu-id="24ef0-119">Retornando um ponteiro para um objeto separado</span><span class="sxs-lookup"><span data-stu-id="24ef0-119">Returning a Pointer to a Separate Object</span></span>

<span data-ttu-id="24ef0-120">Entre os muitos métodos de interface que retornam um ponteiro para um objeto separado, há vários que criam e retornam um ponteiro para um *objeto enumerador*, que permite determinar quantos itens de um determinado tipo um objeto mantém.</span><span class="sxs-lookup"><span data-stu-id="24ef0-120">Among the many interface methods that return a pointer to a separate object are several that create and return a pointer to an *enumerator object*, which allows you to determine how many items of a given type an object maintains.</span></span> <span data-ttu-id="24ef0-121">O COM define interfaces para enumerar uma grande variedade de itens, como cadeias de caracteres, estruturas importantes, monikers e ponteiros de interface [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="24ef0-121">COM defines interfaces for enumerating a wide variety of items, such as strings, important structures, monikers, and [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) interface pointers.</span></span> <span data-ttu-id="24ef0-122">A maneira típica de criar uma instância de enumerador e obter um ponteiro para sua interface é chamar um método de outra interface.</span><span class="sxs-lookup"><span data-stu-id="24ef0-122">The typical way to create an enumerator instance and get a pointer to its interface is to call a method from another interface.</span></span> <span data-ttu-id="24ef0-123">Por exemplo, a interface [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) define dois métodos, [**EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) e [**EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), que retornam ponteiros para interfaces em dois objetos de enumeração diferentes.</span><span class="sxs-lookup"><span data-stu-id="24ef0-123">For example, the [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) interface defines two methods, [**EnumDAdvise**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumdadvise) and [**EnumFormatEtc**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), that return pointers to interfaces on two different enumeration objects.</span></span> <span data-ttu-id="24ef0-124">Há muitos outros exemplos em COM dos métodos que retornam ponteiros para objetos, como a interface de documento OLE composto [**IOleObject:: GetClientSite**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getclientsite), que, quando chamado no objeto incorporado ou vinculado, retorna um ponteiro para a implementação do objeto de contêiner de [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite).</span><span class="sxs-lookup"><span data-stu-id="24ef0-124">There are many other examples in COM of methods that return pointers to objects, such as the OLE compound document interface [**IOleObject::GetClientSite**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getclientsite), which, when called on the embedded or linked object, returns a pointer to the container object's implementation of [**IOleClientSite**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite).</span></span>

## <a name="implementing-an-object-through-which-to-pass-an-interface-pointer-directly-to-the-client"></a><span data-ttu-id="24ef0-125">Implementando um objeto por meio do qual passar um ponteiro de interface diretamente para o cliente</span><span class="sxs-lookup"><span data-stu-id="24ef0-125">Implementing an Object Through Which to Pass an Interface Pointer Directly to the Client</span></span>

<span data-ttu-id="24ef0-126">Quando dois objetos, como um contêiner de documento OLE composto e um servidor, precisam de comunicação bidirecional, cada um implementa um objeto que contém um método de interface por meio do qual ele pode passar um ponteiro de interface para o outro objeto.</span><span class="sxs-lookup"><span data-stu-id="24ef0-126">When two objects, such as an OLE compound document container and server, need bidirectional communication, each implements an object containing an interface method through which it can pass an interface pointer to the other object.</span></span> <span data-ttu-id="24ef0-127">O objeto de implementação, que também é o cliente do objeto criado, pode chamar o método e obter o ponteiro que foi passado.</span><span class="sxs-lookup"><span data-stu-id="24ef0-127">The implementing object, which is also the client of the created object, can then call the method and get the pointer that was passed.</span></span>

## <a name="related-topics"></a><span data-ttu-id="24ef0-128">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="24ef0-128">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="24ef0-129">Clientes e servidores COM</span><span class="sxs-lookup"><span data-stu-id="24ef0-129">COM Clients and Servers</span></span>](com-clients-and-servers.md)
</dt> <dt>

[<span data-ttu-id="24ef0-130">Responsabilidades do servidor COM</span><span class="sxs-lookup"><span data-stu-id="24ef0-130">COM Server Responsibilities</span></span>](com-server-responsibilities.md)
</dt> </dl>

 

 




