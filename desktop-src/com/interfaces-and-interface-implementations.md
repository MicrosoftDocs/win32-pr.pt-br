---
title: Interfaces e implementações de interface
description: COM faz uma distinção fundamental entre as definições de interface e suas implementações.
ms.assetid: f50b3e8f-bf87-4525-b47b-96e75b3a05b9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: db8df92ac8b851925d82a4b03505fa4c5ab3dc39
ms.sourcegitcommit: 80d74c0bf4fc402865a1ad223480abe1ce4d1115
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/12/2020
ms.locfileid: "104007217"
---
# <a name="interfaces-and-interface-implementations"></a><span data-ttu-id="3d0f2-103">Interfaces e implementações de interface</span><span class="sxs-lookup"><span data-stu-id="3d0f2-103">Interfaces and Interface Implementations</span></span>

<span data-ttu-id="3d0f2-104">COM faz uma distinção fundamental entre as definições de interface e suas implementações.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-104">COM makes a fundamental distinction between interface definitions and their implementations.</span></span>

<span data-ttu-id="3d0f2-105">Uma *interface* é, na verdade, um contrato que consiste em um grupo de protótipos de função relacionados cujo uso é definido, mas cuja implementação não é.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-105">An *interface* is actually a contract that consists of a group of related function prototypes whose usage is defined but whose implementation is not.</span></span> <span data-ttu-id="3d0f2-106">Esses protótipos de função são equivalentes a classes de base virtual puras na programação C++.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-106">These function prototypes are equivalent to pure virtual base classes in C++ programming.</span></span> <span data-ttu-id="3d0f2-107">Uma definição de interface especifica as funções de membro da interface, chamadas *métodos*, seus tipos de retorno, o número e os tipos de seus parâmetros e o que eles devem fazer.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-107">An interface definition specifies the interface's member functions, called *methods*, their return types, the number and types of their parameters, and what they must do.</span></span> <span data-ttu-id="3d0f2-108">Não há nenhuma implementação associada a uma interface.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-108">There is no implementation associated with an interface.</span></span>

<span data-ttu-id="3d0f2-109">Uma *implementação de interface* é o código que um programador fornece para realizar as ações especificadas em uma definição de interface.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-109">An *interface implementation* is the code a programmer supplies to carry out the actions specified in an interface definition.</span></span> <span data-ttu-id="3d0f2-110">Implementações de muitas das interfaces que um programador pode usar em um aplicativo baseado em objeto são incluídas nas bibliotecas COM.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-110">Implementations of many of the interfaces a programmer can use in an object-based application are included in the COM libraries.</span></span> <span data-ttu-id="3d0f2-111">No entanto, os programadores estão livres para ignorar essas implementações e escrever suas próprias.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-111">However, programmers are free to ignore these implementations and write their own.</span></span> <span data-ttu-id="3d0f2-112">Uma implementação de interface deve ser associada a um objeto quando uma instância desse objeto é criada e a implementação fornece os serviços que o objeto oferece.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-112">An interface implementation is to be associated with an object when an instance of that object is created, and the implementation provides the services that the object offers.</span></span>

<span data-ttu-id="3d0f2-113">Por exemplo, uma interface hipotética chamada istachar pode definir dois métodos, chamados push e pop, especificando que as chamadas sucessivas para o método pop retornam, na ordem inversa, os valores passados anteriormente para o método Push.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-113">For example, a hypothetical interface named IStack might define two methods, named Push and Pop, specifying that successive calls to the Pop method return, in reverse order, values previously passed to the Push method.</span></span> <span data-ttu-id="3d0f2-114">Essa definição de interface não especificaria como as funções devem ser implementadas no código.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-114">This interface definition would not specify how the functions are to be implemented in code.</span></span> <span data-ttu-id="3d0f2-115">Na implementação da interface, um programador pode implementar a pilha como uma matriz e implementar os métodos push e pop de forma a acessar essa matriz, enquanto outro programador pode usar uma lista vinculada e implementar os métodos adequadamente.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-115">In implementing the interface, one programmer might implement the stack as an array and implement the Push and Pop methods in such a way as to access that array, while another programmer might use a linked list and would implement the methods accordingly.</span></span> <span data-ttu-id="3d0f2-116">Independentemente de uma implementação específica dos métodos push e pop, a representação na memória de um ponteiro para uma interface istachar e, portanto, seu uso por um cliente, é completamente determinada pela definição da interface.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-116">Regardless of a particular implementation of the Push and Pop methods, the in-memory representation of a pointer to an IStack interface, and therefore its use by a client, is completely determined by the interface definition.</span></span>

<span data-ttu-id="3d0f2-117">Os objetos simples dão suporte apenas a uma única interface.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-117">Simple objects support only a single interface.</span></span> <span data-ttu-id="3d0f2-118">Objetos mais complicados, como objetos incorporáveis, normalmente dão suporte a várias interfaces.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-118">More complicated objects, such as embeddable objects, typically support several interfaces.</span></span> <span data-ttu-id="3d0f2-119">Os clientes têm acesso a um objeto COM somente por meio de um ponteiro para uma de suas interfaces, o que, por sua vez, permite que o cliente chame qualquer um dos métodos que compõem essa interface.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-119">Clients have access to a COM object only through a pointer to one of its interfaces, which, in turn, allows the client to call any of the methods that make up that interface.</span></span> <span data-ttu-id="3d0f2-120">Esses métodos determinam como um cliente pode usar os dados do objeto.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-120">These methods determine how a client can use the object's data.</span></span>

<span data-ttu-id="3d0f2-121">As interfaces definem um contrato entre um objeto e seus clientes.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-121">Interfaces define a contract between an object and its clients.</span></span> <span data-ttu-id="3d0f2-122">O contrato especifica os métodos que devem ser associados a cada interface e qual o comportamento de cada um dos métodos deve estar em termos de entrada e saída.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-122">The contract specifies the methods that must be associated with each interface and what the behavior of each of the methods must be in terms of input and output.</span></span> <span data-ttu-id="3d0f2-123">O contrato geralmente não define como implementar os métodos em uma interface.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-123">The contract generally does not define how to implement the methods in an interface.</span></span> <span data-ttu-id="3d0f2-124">Outro aspecto importante do contrato é que, se um objeto oferecer suporte a uma interface, ele deverá dar suporte a todos os métodos dessa interface de alguma maneira.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-124">Another important aspect of the contract is that if an object supports an interface, it must support all of that interface's methods in some way.</span></span> <span data-ttu-id="3d0f2-125">Nem todos os métodos em uma implementação precisam fazer algo.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-125">Not all of the methods in an implementation need to do something.</span></span> <span data-ttu-id="3d0f2-126">Se um objeto não oferecer suporte à função implícita por um método, sua implementação poderá ser um retorno simples ou talvez o retorno de uma mensagem de erro significativa — mas os métodos devem existir.</span><span class="sxs-lookup"><span data-stu-id="3d0f2-126">If an object does not support the function implied by a method, its implementation may be a simple return or perhaps the return of a meaningful error message—but the methods must exist.</span></span>

## <a name="related-topics"></a><span data-ttu-id="3d0f2-127">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="3d0f2-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3d0f2-128">Objetos e interfaces COM</span><span class="sxs-lookup"><span data-stu-id="3d0f2-128">COM Objects and Interfaces</span></span>](com-objects-and-interfaces.md)
</dt> </dl>

 

 




