---
title: O Component Object Model OLE
description: O Component Object Model OLE
ms.assetid: f3200d81-c2fa-4cc7-bf85-54f6c753a529
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 211c41de8c16eb1cabb1e62f475adbbf603e2c92
ms.sourcegitcommit: 52d79b29f3b9933c8bef43207ff80c668a81cb73
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/20/2020
ms.locfileid: "103917775"
---
# <a name="the-ole-component-object-model"></a><span data-ttu-id="7385f-103">O Component Object Model OLE</span><span class="sxs-lookup"><span data-stu-id="7385f-103">The OLE Component Object Model</span></span>

<span data-ttu-id="7385f-104">Os objetos usados pela biblioteca AVIFile fazem parte do Component Object Model OLE.</span><span class="sxs-lookup"><span data-stu-id="7385f-104">The objects used by the AVIFile library are all part of the OLE Component Object Model.</span></span> <span data-ttu-id="7385f-105">Basicamente, isso significa que eles compartilham determinados métodos que os tornam mais fáceis de trabalhar e os valores que eles retornam são comuns à maioria dos métodos de interface OLE.</span><span class="sxs-lookup"><span data-stu-id="7385f-105">Primarily, this means they share certain methods that make them easier to work with, and the values they return are common to most OLE interface methods.</span></span>

<span data-ttu-id="7385f-106">O Component Object Model OLE dos manipuladores de arquivo e fluxo usa a interface de **IClassFactory** do OLE para criar instâncias de sua classe de objeto.</span><span class="sxs-lookup"><span data-stu-id="7385f-106">The OLE Component Object Model of the file and stream handlers uses the OLE **IClassFactory** interface to create instances of their object class.</span></span> <span data-ttu-id="7385f-107">Como objetos de componente, eles implementam a interface [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) , que consiste nos métodos [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(refiid_void)), [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)e [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) .</span><span class="sxs-lookup"><span data-stu-id="7385f-107">As component objects, they implement the [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface, which consists of the [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(refiid_void)), [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release), and [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) methods.</span></span> <span data-ttu-id="7385f-108">A interface **IUnknown** permite que um aplicativo obtenha ponteiros para outras interfaces com suporte no mesmo objeto.</span><span class="sxs-lookup"><span data-stu-id="7385f-108">The **IUnknown** interface lets an application obtain pointers to other interfaces supported by the same object.</span></span>

<span data-ttu-id="7385f-109">Você pode determinar se um objeto dá suporte a uma interface específica usando o método **QueryInterface** .</span><span class="sxs-lookup"><span data-stu-id="7385f-109">You can determine if an object supports a specific interface by using the **QueryInterface** method.</span></span> <span data-ttu-id="7385f-110">Se um objeto der suporte a uma interface especificada, **QueryInterface** retornará um ponteiro para essa interface.</span><span class="sxs-lookup"><span data-stu-id="7385f-110">If an object supports a specified interface, **QueryInterface** returns a pointer to that interface.</span></span>

<span data-ttu-id="7385f-111">Você pode incrementar e decrementar a contagem de referência associada a um objeto usando os métodos [**AddRef**](/previous-versions//dd757100(v=vs.85)) e [**Release**](/previous-versions//dd757102(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="7385f-111">You can increment and decrement the reference count associated with an object by using the [**AddRef**](/previous-versions//dd757100(v=vs.85)) and [**Release**](/previous-versions//dd757102(v=vs.85)) methods.</span></span> <span data-ttu-id="7385f-112">A contagem de referência permite que vários clientes acessem um objeto.</span><span class="sxs-lookup"><span data-stu-id="7385f-112">The reference count lets multiple clients access an object.</span></span> <span data-ttu-id="7385f-113">Quando um objeto é usado pelo primeiro aplicativo, sua contagem de referência é definida como 1.</span><span class="sxs-lookup"><span data-stu-id="7385f-113">When an object is used by the first application, its reference count is set to 1.</span></span> <span data-ttu-id="7385f-114">Os aplicativos posteriormente usam o método **AddRef** para incrementar a contagem para permitir que o objeto acompanhe o número de vezes que ele é acessado.</span><span class="sxs-lookup"><span data-stu-id="7385f-114">Applications subsequently use the **AddRef** method to increment the count to let the object keep track of the number of times it is accessed.</span></span>

<span data-ttu-id="7385f-115">Quando um aplicativo é feito usando um objeto, ele chama o método **Release** para diminuir a contagem de referência.</span><span class="sxs-lookup"><span data-stu-id="7385f-115">When an application is done using an object, it calls the **Release** method to decrement the reference count.</span></span> <span data-ttu-id="7385f-116">Quando a contagem de referência é zero, o objeto não é mais necessário e a **versão** libera todos os recursos que ele usa e destrói o objeto.</span><span class="sxs-lookup"><span data-stu-id="7385f-116">When the reference count is zero, the object is no longer needed and **Release** frees any resources it uses and destroys the object.</span></span> <span data-ttu-id="7385f-117">Como um objeto usa recursos internos transparentes para o aplicativo, o objeto é responsável por liberá-los.</span><span class="sxs-lookup"><span data-stu-id="7385f-117">Because an object uses internal resources transparent to the application, the object is responsible for freeing them.</span></span> <span data-ttu-id="7385f-118">Por exemplo, um manipulador de arquivos pode precisar fechar arquivos de disco abertos e liberar memória de buffer quando lançado.</span><span class="sxs-lookup"><span data-stu-id="7385f-118">For example, a file handler might need to close open disk files and free buffer memory when released.</span></span>

<span data-ttu-id="7385f-119">A maioria dos métodos de interface OLE retorna identificadores de resultados que são definidos usando o tipo de dados **HRESULT** .</span><span class="sxs-lookup"><span data-stu-id="7385f-119">Most OLE interface methods return result handles that are defined by using the **HRESULT** data type.</span></span> <span data-ttu-id="7385f-120">Esse tipo de dados é feito de um código de severidade, informações contextuais, um código de recurso e um código de status.</span><span class="sxs-lookup"><span data-stu-id="7385f-120">This data type is made of a severity code, contextual information, a facility code, and a status code.</span></span> <span data-ttu-id="7385f-121">Um identificador de resultado de retorno que indica êxito tem o valor zero.</span><span class="sxs-lookup"><span data-stu-id="7385f-121">A return result handle that indicates success has the value zero.</span></span> <span data-ttu-id="7385f-122">Um valor diferente de zero indica falha e o membro de código de status do identificador de resultado de retorno fornece uma base para interpretação adicional.</span><span class="sxs-lookup"><span data-stu-id="7385f-122">A nonzero value indicates failure and the status code member of the return result handle provides a basis for additional interpretation.</span></span> <span data-ttu-id="7385f-123">Para obter informações adicionais sobre identificadores de resultado de retorno de OLE, consulte a *referência do programador de OLE*.</span><span class="sxs-lookup"><span data-stu-id="7385f-123">For additional information about OLE return result handles, see the *OLE Programmer's Reference*.</span></span>

 

 