---
title: Descompactação de Image-Data
description: Descompactação de Image-Data
ms.assetid: 4bff02be-dac8-41f4-a3af-2da6a2693ffe
keywords:
- VCM (Gerenciador de compactação de vídeo), descompactação de dados de imagem
- VCM (Gerenciador de compactação de vídeo), descompactação de dados de imagem
- Funções ICDecompressEx
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 25614f157436056f7f24c340f6cc6f4dbc62d9ae
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104293971"
---
# <a name="image-data-decompression"></a><span data-ttu-id="1c76e-106">Descompactação de Image-Data</span><span class="sxs-lookup"><span data-stu-id="1c76e-106">Image-Data Decompression</span></span>

<span data-ttu-id="1c76e-107">Seu aplicativo usa uma série de funções [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) para controlar o descompactador.</span><span class="sxs-lookup"><span data-stu-id="1c76e-107">Your application uses a series of [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) functions to control the decompressor.</span></span> <span data-ttu-id="1c76e-108">As funções podem ajudá-lo a executar as seguintes tarefas:</span><span class="sxs-lookup"><span data-stu-id="1c76e-108">The functions can help you perform the following tasks:</span></span>

-   <span data-ttu-id="1c76e-109">Selecione um descompactador.</span><span class="sxs-lookup"><span data-stu-id="1c76e-109">Select a decompressor.</span></span>
-   <span data-ttu-id="1c76e-110">Prepare o descompactador.</span><span class="sxs-lookup"><span data-stu-id="1c76e-110">Prepare the decompressor.</span></span>
-   <span data-ttu-id="1c76e-111">Descompacte os dados.</span><span class="sxs-lookup"><span data-stu-id="1c76e-111">Decompress the data.</span></span>
-   <span data-ttu-id="1c76e-112">Encerrar descompactação.</span><span class="sxs-lookup"><span data-stu-id="1c76e-112">End decompression.</span></span>

<span data-ttu-id="1c76e-113">Seu aplicativo lida com a descompactação da mesma forma que manipula a compactação, exceto que o formato de entrada é um formato compactado e o formato de saída é um formato que é exibível.</span><span class="sxs-lookup"><span data-stu-id="1c76e-113">Your application handles decompression similarly to the way it handles compression, except that the input format is a compressed format and the output format is a displayable format.</span></span> <span data-ttu-id="1c76e-114">O formato de entrada para descompactação geralmente é obtido do cabeçalho do fluxo.</span><span class="sxs-lookup"><span data-stu-id="1c76e-114">The input format for decompression is usually obtained from the stream header.</span></span> <span data-ttu-id="1c76e-115">Depois de determinar o formato de entrada, seu aplicativo pode usar as funções [**ICLocate**](/windows/desktop/api/Vfw/nf-vfw-iclocate) ou [**ICOpen**](/windows/desktop/api/Vfw/nf-vfw-icopen) para encontrar um descompactador que possa tratá-lo.</span><span class="sxs-lookup"><span data-stu-id="1c76e-115">After determining the input format, your application can use the [**ICLocate**](/windows/desktop/api/Vfw/nf-vfw-iclocate) or [**ICOpen**](/windows/desktop/api/Vfw/nf-vfw-icopen) functions to find a decompressor that can handle it.</span></span>

<span data-ttu-id="1c76e-116">As funções e macros do [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) são um superconjunto do grupo de funções do [**ICDecompress**](/windows/desktop/api/Vfw/nf-vfw-icdecompress) e fornecem mais recursos.</span><span class="sxs-lookup"><span data-stu-id="1c76e-116">The [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) functions and macros are a superset of the [**ICDecompress**](/windows/desktop/api/Vfw/nf-vfw-icdecompress) function group and provide more capabilities.</span></span> <span data-ttu-id="1c76e-117">A funcionalidade de **ICDecompressEx**, [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin), [**ICDecompressExEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexend)e [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) substitui a das funções **ICDecompress**, [**ICDecompressBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressbegin), [**ICDecompressEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressend)e [**ICDecompressQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressquery) .</span><span class="sxs-lookup"><span data-stu-id="1c76e-117">The functionality of **ICDecompressEx**, [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin), [**ICDecompressExEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexend), and [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) replaces that of the **ICDecompress**, [**ICDecompressBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressbegin), [**ICDecompressEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressend), and [**ICDecompressQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressquery) functions.</span></span> <span data-ttu-id="1c76e-118">Use as funções e macros do **ICDecompressEx** no lugar dos equivalentes do **ICDecompress** .</span><span class="sxs-lookup"><span data-stu-id="1c76e-118">Use the **ICDecompressEx** functions and macros in place of the **ICDecompress** equivalents.</span></span>

## <a name="decompressor-and-decompression-format-selection"></a><span data-ttu-id="1c76e-119">Seleção de formato de descompactação e descompressão</span><span class="sxs-lookup"><span data-stu-id="1c76e-119">Decompressor and Decompression Format Selection</span></span>

<span data-ttu-id="1c76e-120">Se desejar descompactar dados e seu aplicativo exigir um formato de saída específico, você poderá usar a função [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) para consultar o descompactador para determinar se ele dá suporte aos formatos de entrada e saída.</span><span class="sxs-lookup"><span data-stu-id="1c76e-120">If you want to decompress data and your application requires a specific output format, you can use the [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) function to query the decompressor to determine if it supports the input and output formats.</span></span>

<span data-ttu-id="1c76e-121">Se o formato de saída não for importante em seu aplicativo, você precisará localizar apenas um descompactador que possa manipular o formato de entrada.</span><span class="sxs-lookup"><span data-stu-id="1c76e-121">If the output format is not important in your application, you need only find a decompressor that can handle the input format.</span></span> <span data-ttu-id="1c76e-122">Para determinar se um descompactador pode manipular o formato de entrada, use [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) e especifique **NULL** para o parâmetro *lpbiDst* .</span><span class="sxs-lookup"><span data-stu-id="1c76e-122">To determine if a decompressor can handle the input format, use [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery) and specify **NULL** for the *lpbiDst* parameter.</span></span> <span data-ttu-id="1c76e-123">Seu aplicativo pode determinar o tamanho do buffer necessário para os dados que especificam o formato de descompactação enviando a mensagem [**ICM \_ descompactar \_ Get \_ Format**](icm-decompress-get-format.md) (ou usar a macro [**ICDecompressGetFormatSize**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetformatsize) ).</span><span class="sxs-lookup"><span data-stu-id="1c76e-123">Your application can determine the buffer size needed for the data specifying the decompression format by sending the [**ICM\_DECOMPRESS\_GET\_FORMAT**](icm-decompress-get-format.md) message (or use the [**ICDecompressGetFormatSize**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetformatsize) macro).</span></span> <span data-ttu-id="1c76e-124">Você também pode enviar **o \_ formato de \_ Get \_ do ICM** (ou a macro [**ICDecompressGetFormat**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetformat) ) para recuperar os dados de formato.</span><span class="sxs-lookup"><span data-stu-id="1c76e-124">You can also send **ICM\_DECOMPRESS\_GET\_FORMAT** (or the [**ICDecompressGetFormat**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetformat) macro) to retrieve the format data.</span></span> <span data-ttu-id="1c76e-125">O descompactador retorna seu formato sugerido em uma estrutura [**BITMAPINFO**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) .</span><span class="sxs-lookup"><span data-stu-id="1c76e-125">The decompressor returns its suggested format in a [**BITMAPINFO**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) structure.</span></span> <span data-ttu-id="1c76e-126">Esse formato normalmente preserva a maioria das informações durante a descompactação.</span><span class="sxs-lookup"><span data-stu-id="1c76e-126">This format typically preserves the most information during decompression.</span></span> <span data-ttu-id="1c76e-127">Seu aplicativo deve garantir que o descompactador retorne com êxito antes de descompactar as informações.</span><span class="sxs-lookup"><span data-stu-id="1c76e-127">Your application should ensure that the decompressor returns successfully before it decompresses the information.</span></span>

<span data-ttu-id="1c76e-128">Como seu aplicativo aloca a memória necessária para descompactação, ele precisa determinar a memória máxima que o descompactador pode exigir para o formato de saída.</span><span class="sxs-lookup"><span data-stu-id="1c76e-128">Because your application allocates the memory required for decompression, it needs to determine the maximum memory the decompressor can require for the output format.</span></span> <span data-ttu-id="1c76e-129">A mensagem de **\_ \_ obter \_ formato do ICM descompactar** Obtém o número de bytes que o descompactador usa para o formato padrão.</span><span class="sxs-lookup"><span data-stu-id="1c76e-129">The **ICM\_DECOMPRESS\_GET\_FORMAT** message obtains the number of bytes the decompressor uses for the default format.</span></span>

<span data-ttu-id="1c76e-130">Se seu aplicativo define seu próprio formato usando [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery), ele também deve obter uma paleta para o bitmap; **ICDecompressExQuery** não fornece definições de paleta.</span><span class="sxs-lookup"><span data-stu-id="1c76e-130">If your application defines its own format by using [**ICDecompressExQuery**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexquery), it must also obtain a palette for the bitmap; **ICDecompressExQuery** does not provide palette definitions.</span></span> <span data-ttu-id="1c76e-131">(A maioria dos aplicativos usa formatos padrão e não precisa obter uma paleta.) Seu aplicativo pode obter a paleta enviando a mensagem [**ICM \_ descompactar a \_ \_ paleta**](icm-decompress-get-palette.md) (ou usar a macro [**ICDecompressGetPalette**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetpalette) ).</span><span class="sxs-lookup"><span data-stu-id="1c76e-131">(Most applications use standard formats and do not need to obtain a palette.) Your application can obtain the palette by sending the [**ICM\_DECOMPRESS\_GET\_PALETTE**](icm-decompress-get-palette.md) message (or use the [**ICDecompressGetPalette**](/windows/desktop/api/Vfw/nf-vfw-icdecompressgetpalette) macro).</span></span>

## <a name="decompressor-initialization"></a><span data-ttu-id="1c76e-132">Inicialização do descompactador</span><span class="sxs-lookup"><span data-stu-id="1c76e-132">Decompressor Initialization</span></span>

<span data-ttu-id="1c76e-133">Depois que o aplicativo selecionar um descompactador que possa manipular os formatos de entrada e saída de que precisa, você poderá inicializar o descompactador usando a função [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin) .</span><span class="sxs-lookup"><span data-stu-id="1c76e-133">After your application selects a decompressor that can handle the input and output formats it needs, you can initialize the decompressor by using the [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin) function.</span></span> <span data-ttu-id="1c76e-134">Essa função requer o identificador do descompactador e os formatos de entrada e saída.</span><span class="sxs-lookup"><span data-stu-id="1c76e-134">This function requires the decompressor handle and the input and output formats.</span></span>

## <a name="data-decompression"></a><span data-ttu-id="1c76e-135">Descompactação de dados</span><span class="sxs-lookup"><span data-stu-id="1c76e-135">Data Decompression</span></span>

<span data-ttu-id="1c76e-136">Você pode usar a função [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) para descompactar um quadro.</span><span class="sxs-lookup"><span data-stu-id="1c76e-136">You can use the [**ICDecompressEx**](/windows/desktop/api/Vfw/nf-vfw-icdecompressex) function to decompress a frame.</span></span> <span data-ttu-id="1c76e-137">Seu aplicativo deve usar essa função repetidamente até que todos os quadros em uma sequência sejam descompactados.</span><span class="sxs-lookup"><span data-stu-id="1c76e-137">Your application must use this function repeatedly until all the frames in a sequence are decompressed.</span></span>

<span data-ttu-id="1c76e-138">Se o fluxo de vídeo estiver atrasado atrás de outros componentes (como áudio) durante a reprodução, o aplicativo poderá especificar o sinalizador **ICDECOMPRESS \_ HURRYUP** para acelerar a descompactação.</span><span class="sxs-lookup"><span data-stu-id="1c76e-138">If your video stream lags behind other components (such as audio) during playback, your application can specify the **ICDECOMPRESS\_HURRYUP** flag to speed decompression.</span></span> <span data-ttu-id="1c76e-139">Para fazer isso, um descompactador pode extrair apenas as informações necessárias para descompactar o próximo quadro e não descompactar completamente o quadro atual.</span><span class="sxs-lookup"><span data-stu-id="1c76e-139">To do this, a decompressor might extract only the information it needs to decompress the next frame and not fully decompress the current frame.</span></span> <span data-ttu-id="1c76e-140">Portanto, seu aplicativo não deve tentar desenhar os dados descompactados quando ele usar esse sinalizador.</span><span class="sxs-lookup"><span data-stu-id="1c76e-140">Therefore, your application should not try to draw the decompressed data when it uses this flag.</span></span>

<span data-ttu-id="1c76e-141">Depois que o aplicativo tiver descompactado os dados, ele poderá enviar a mensagem de [**\_ \_ final DECOMPRESSEX do ICM**](icm-decompressex-end.md) (ou usar a macro [**ICDecompressExEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexend) ) para notificar o descompactador de que ele foi concluído.</span><span class="sxs-lookup"><span data-stu-id="1c76e-141">After your application has decompressed the data, it can send the [**ICM\_DECOMPRESSEX\_END**](icm-decompressex-end.md) message (or use the [**ICDecompressExEnd**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexend) macro) to notify the decompressor that it has finished.</span></span> <span data-ttu-id="1c76e-142">Se você quiser reiniciar a descompactação depois de usar essa função, seu aplicativo deverá reinicializar o descompactador usando [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin).</span><span class="sxs-lookup"><span data-stu-id="1c76e-142">If you want to restart decompression after using this function, your application must reinitialize the decompressor by using [**ICDecompressExBegin**](/windows/desktop/api/Vfw/nf-vfw-icdecompressexbegin).</span></span>

## <a name="related-topics"></a><span data-ttu-id="1c76e-143">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="1c76e-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1c76e-144">Serviços VCMs</span><span class="sxs-lookup"><span data-stu-id="1c76e-144">VCM Services</span></span>](vcm-services.md)
</dt> </dl>

 

 