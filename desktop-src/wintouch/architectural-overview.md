---
title: Visão geral da arquitetura
description: Essa visão geral da arquitetura fornece contexto para a API de toque do Windows para tecnologias de Tablet e Touch e explica como ela se encaixa na arquitetura maior do Windows 7.
ms.assetid: b284e96f-0998-408c-ae84-92a3acdc3014
keywords:
- Windows Touch, visão geral da arquitetura
- Windows Touch, manipulações
- Windows Touch, mensagens
- Windows Touch, inércia
- Toque do Windows, gestos
- gestos, sobre
- manipulações, sobre
- inércia, sobre
- processador de manipulação, visão geral da arquitetura
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b807113211d77f0aad0ed01fc24570d033063474
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103917320"
---
# <a name="architectural-overview"></a><span data-ttu-id="d8579-112">Visão geral da arquitetura</span><span class="sxs-lookup"><span data-stu-id="d8579-112">Architectural Overview</span></span>

<span data-ttu-id="d8579-113">Essa visão geral da arquitetura fornece contexto para a API de toque do Windows para tecnologias de Tablet e Touch e explica como ela se encaixa na arquitetura maior do Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d8579-113">This architectural overview provides context for the Windows Touch API for Tablet and Touch Technologies and explains how it fits into the larger Windows 7 architecture.</span></span>

## <a name="messages-for-windows-touch-input-and-gestures"></a><span data-ttu-id="d8579-114">Mensagens para entrada e gestos do Windows Touch</span><span class="sxs-lookup"><span data-stu-id="d8579-114">Messages for Windows Touch Input and Gestures</span></span>

<span data-ttu-id="d8579-115">Os recursos do sistema de mensagens para Windows Touch são habilitados ouvindo e interpretando mensagens durante a execução.</span><span class="sxs-lookup"><span data-stu-id="d8579-115">Messaging features for Windows Touch are enabled by listening and interpreting messages during execution.</span></span> <span data-ttu-id="d8579-116">A ilustração a seguir mostra como as mensagens são geradas do hardware e enviadas aos aplicativos pelo Windows 7.</span><span class="sxs-lookup"><span data-stu-id="d8579-116">The following illustration shows how messages are generated from hardware and sent to applications by Windows 7.</span></span>

![ilustração mostrando como o Windows 7 envia mensagens do hardware multitoque para um aplicativo](images/wm-multitouch-messaging.png)

<span data-ttu-id="d8579-118">Na coluna mais à esquerda da ilustração, o hardware sensível ao toque recebe a entrada de um usuário.</span><span class="sxs-lookup"><span data-stu-id="d8579-118">In the leftmost column of the illustration, touch-sensitive hardware receives input from a user.</span></span> <span data-ttu-id="d8579-119">Em seguida, um driver se comunica entre o hardware e o sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="d8579-119">A driver then communicates between the hardware and the OS.</span></span> <span data-ttu-id="d8579-120">Em seguida, o sistema operacional gera uma mensagem [**de \_ gesto**](wm-gesture.md) do [**WM \_ Touch**](wm-touchdown.md) ou do WM que é enviada para o HWND de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d8579-120">Next, the OS generates a [**WM\_TOUCH**](wm-touchdown.md) or [**WM\_GESTURE**](wm-gesture.md) message that is then sent to an application's HWND.</span></span> <span data-ttu-id="d8579-121">Em seguida, o aplicativo atualiza a interface do usuário de acordo com as informações encapsuladas na mensagem.</span><span class="sxs-lookup"><span data-stu-id="d8579-121">The application then updates the UI given the information encapsulated in the message.</span></span>

<span data-ttu-id="d8579-122">Por padrão, os aplicativos recebem gestos.</span><span class="sxs-lookup"><span data-stu-id="d8579-122">Applications receive gestures by default.</span></span> <span data-ttu-id="d8579-123">A menos que um aplicativo seja registrado para mensagens de entrada de toque do Windows com a função [**RegisterTouchWindow**](/windows/desktop/api/winuser/nf-winuser-registertouchwindow) , as notificações para gestos (mensagens de [**\_ gesto do WM**](wm-gesture.md) ) são criadas pelo Windows e enviadas para essa janela de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d8579-123">Unless an application registers for Windows Touch input messages with the [**RegisterTouchWindow**](/windows/desktop/api/winuser/nf-winuser-registertouchwindow) function, notifications for gestures ([**WM\_GESTURE**](wm-gesture.md) messages) are created by Windows and sent to that application window.</span></span> <span data-ttu-id="d8579-124">Se uma janela de aplicativo for registrada para receber mensagens de toque, as notificações para entrada do Windows Touch (mensagens de [**\_ toque do WM**](wm-touchdown.md) ) serão enviadas para essa janela de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d8579-124">If an application Window registers to receive touch messages, notifications for Windows Touch input ([**WM\_TOUCH**](wm-touchdown.md) messages) are sent to that application window.</span></span> <span data-ttu-id="d8579-125">As mensagens de toque e gesto do Windows são ávidos no sentido de que, depois que um toque é feito ou um gesto começa em uma janela de aplicativo, todas as mensagens são enviadas para esse aplicativo até que o gesto seja concluído ou o toque primário seja concluído.</span><span class="sxs-lookup"><span data-stu-id="d8579-125">Windows Touch and gesture messages are greedy in the sense that after a touch is made or a gesture begins on an application Window, all messages are sent to that application until the gesture completes or the primary touch is completed.</span></span>

<span data-ttu-id="d8579-126">Para suporte herdado, o Windows interpreta mensagens de [**\_ gesto do WM**](wm-gesture.md) se elas forem consumidas e ENVIARá ou lançará as mensagens apropriadas que são mapeadas para o gesto.</span><span class="sxs-lookup"><span data-stu-id="d8579-126">For legacy support, Windows interprets [**WM\_GESTURE**](wm-gesture.md) messages if they are bubbled up and then will SEND or POST appropriate messages that map to the gesture.</span></span> <span data-ttu-id="d8579-127">Para evitar a interrupção do suporte herdado, certifique-se de encaminhar mensagens de gesto do WM \_ usando [DefWindowProc](/windows/win32/api/winuser/nf-winuser-defwindowproca).</span><span class="sxs-lookup"><span data-stu-id="d8579-127">To avoid breaking legacy support, make sure that you forward WM\_GESTURE messages using [DefWindowProc](/windows/win32/api/winuser/nf-winuser-defwindowproca).</span></span> <span data-ttu-id="d8579-128">Mais informações sobre o suporte herdado podem ser encontradas na seção [visão geral dos gestos do Windows Touch](windows-touch-gestures-overview.md).</span><span class="sxs-lookup"><span data-stu-id="d8579-128">More information on legacy support can be found in the section [Windows Touch Gestures Overview](windows-touch-gestures-overview.md).</span></span>

## <a name="manipulations-and-inertia"></a><span data-ttu-id="d8579-129">Manipulações e inércia</span><span class="sxs-lookup"><span data-stu-id="d8579-129">Manipulations and Inertia</span></span>

<span data-ttu-id="d8579-130">Os programadores do Windows Touch devem ser capazes de interpretar gestos de várias fontes de uma maneira que seja significativa para o gesto em andamento.</span><span class="sxs-lookup"><span data-stu-id="d8579-130">Windows Touch programmers must be able to interpret gestures from multiple sources in a manner that is meaningful for the gesture taking place.</span></span> <span data-ttu-id="d8579-131">A Microsoft fornece a API de manipulação para executar esses cálculos.</span><span class="sxs-lookup"><span data-stu-id="d8579-131">Microsoft provides the manipulation API to perform these calculations.</span></span> <span data-ttu-id="d8579-132">As manipulações são essencialmente gestos com valores associados a elas que descrevem todo o gesto.</span><span class="sxs-lookup"><span data-stu-id="d8579-132">Manipulations are essentially gestures with values associated with them that describe the entire gesture.</span></span> <span data-ttu-id="d8579-133">Depois de conectar os dados de entrada ao processador de manipulação, você pode recuperar informações pertinentes à ação que o usuário faz no objeto.</span><span class="sxs-lookup"><span data-stu-id="d8579-133">After you connect the input data to the manipulation processor, you can retrieve information pertinent to action that the user makes on the object.</span></span> <span data-ttu-id="d8579-134">A figura a seguir mostra uma maneira que você pode usar manipulações.</span><span class="sxs-lookup"><span data-stu-id="d8579-134">The following figure shows one way you can use manipulations.</span></span>

![ilustração mostrando mensagens de toque do Windows passadas para o processador de manipulação de um objeto, que manipula eventos com a \- interface imanipulationevents](images/manipulation-arch.png)

<span data-ttu-id="d8579-136">Na parte superior esquerda da ilustração, o usuário tocou na tela, que cria mensagens de toque.</span><span class="sxs-lookup"><span data-stu-id="d8579-136">In the top left of the illustration, the user has touched the screen, which creates touch messages.</span></span> <span data-ttu-id="d8579-137">Essas mensagens contêm uma coordenada x e uma coordenada y que são usadas para determinar o objeto que está em foco.</span><span class="sxs-lookup"><span data-stu-id="d8579-137">These messages contain an x-coordinate and a y-coordinate that are used to determine the object that is in focus.</span></span> <span data-ttu-id="d8579-138">O objeto em foco contém um processador de manipulação.</span><span class="sxs-lookup"><span data-stu-id="d8579-138">The object in focus contains a manipulation processor.</span></span> <span data-ttu-id="d8579-139">Em seguida, na mensagem do [**WM \_ Touch**](wm-touchdown.md) com o sinalizador **TOUCHEVENTF \_ up** , o objeto no foco do usuário é selecionado, o processador de manipulação é referenciado e a mensagem é enviada para o processador de manipulação.</span><span class="sxs-lookup"><span data-stu-id="d8579-139">Next, on the [**WM\_TOUCH**](wm-touchdown.md) message with the **TOUCHEVENTF\_UP** flag, the object in the user's focus is selected, the manipulation processor is referenced, and the message is sent to the manipulation processor.</span></span> <span data-ttu-id="d8579-140">As próximas mensagens do **WM \_ Touch** associadas a este contato são enviadas para o processador de manipulação até que a mensagem do **WM \_ Touch** com o sinalizador **TOUCHEVENTF \_ up** seja recebida e o objeto selecionado seja desreferenciado.</span><span class="sxs-lookup"><span data-stu-id="d8579-140">Subsequent **WM\_TOUCH** messages associated with this contact are sent to the manipulation processor until the **WM\_TOUCH** message with the **TOUCHEVENTF\_UP** flag is received and the selected object is dereferenced.</span></span> <span data-ttu-id="d8579-141">Na seção inferior direita da ilustração, um coletor de eventos de manipulação que implementa a interface [**\_ IManipulationEvents**](/windows/win32/api/manipulations/nn-manipulations-_imanipulationevents) é usado para manipular os eventos de manipulação, que são gerados enquanto as mensagens de toque estão sendo criadas.</span><span class="sxs-lookup"><span data-stu-id="d8579-141">In the bottom right section of the illustration, a manipulation event sink that implements the [**\_IManipulationEvents**](/windows/win32/api/manipulations/nn-manipulations-_imanipulationevents) interface is used to handle the manipulation events, which are raised while the touch messages are being created.</span></span> <span data-ttu-id="d8579-142">O coletor de eventos pode executar atualizações na interface com base nos eventos de manipulação enquanto eles ocorrem.</span><span class="sxs-lookup"><span data-stu-id="d8579-142">The event sink can perform updates to the interface based on the manipulation events while they occur.</span></span>

<span data-ttu-id="d8579-143">Em aplicativos Windows Touch, é comum incorporar uma física simples para que os objetos cheguem a uma parada tranqüila, em vez de serem interrompidos abruptamente quando não estiverem mais sendo tocados.</span><span class="sxs-lookup"><span data-stu-id="d8579-143">In Windows Touch applications, it's common to incorporate simple physics so that objects smoothly come to a stop, rather than abruptly stop when they are no longer being touched.</span></span> <span data-ttu-id="d8579-144">A Microsoft fornece a API inércia para executar os cálculos para essas física simples, de forma que seu aplicativo possa se comportar de maneira semelhante a outros aplicativos.</span><span class="sxs-lookup"><span data-stu-id="d8579-144">Microsoft provides the Inertia API to perform the calculations for these simple physics so that your application can behave in a manner similar to other applications.</span></span> <span data-ttu-id="d8579-145">Isso também poupa o esforço necessário para criar uma funcionalidade de física robusta.</span><span class="sxs-lookup"><span data-stu-id="d8579-145">This also saves you the effort required to create robust physics functionality.</span></span> <span data-ttu-id="d8579-146">A figura a seguir mostra como você pode usar o inércia.</span><span class="sxs-lookup"><span data-stu-id="d8579-146">The following figure shows how you can use inertia.</span></span>

![ilustração mostrando mensagens de toque do Windows passadas para a interface IInertiaProcessor de um objeto, que gera eventos com a \- interface imanipulationevents](images/inertia-arch.png)

<span data-ttu-id="d8579-148">Observe as semelhanças entre inércia e manipulação.</span><span class="sxs-lookup"><span data-stu-id="d8579-148">Note the similarities between inertia and manipulation.</span></span> <span data-ttu-id="d8579-149">A única diferença entre os dois é que, no caso do inércia, as mensagens interpretadas são enviadas para um processador inércia em vez de um processador de manipulação e o processador inércia gera os eventos.</span><span class="sxs-lookup"><span data-stu-id="d8579-149">The only difference between the two is that in the case of inertia, interpreted messages are handed to an inertia processor rather than a manipulation processor and the inertia processor raises the events.</span></span> <span data-ttu-id="d8579-150">Na parte superior esquerda da ilustração, na mensagem do [**WM \_ Touch**](wm-touchdown.md) com o sinalizador **TOUCHEVENTF \_ up** , as mensagens de toque são usadas para identificar um objeto em foco que contém um processador inércia e um processador de manipulação.</span><span class="sxs-lookup"><span data-stu-id="d8579-150">In the top left of the illustration, on the [**WM\_TOUCH**](wm-touchdown.md) message with the **TOUCHEVENTF\_UP** flag, touch messages are used to identify an object in focus that contains an inertia processor and a manipulation processor.</span></span> <span data-ttu-id="d8579-151">As próximas mensagens do **WM \_ Touch** são enviadas para o processador de manipulação e o processador de manipulação executa atualizações na interface do usuário do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d8579-151">Subsequent **WM\_TOUCH** messages are sent to the manipulation processor and the manipulation processor performs updates to the application UI.</span></span> <span data-ttu-id="d8579-152">Depois que a manipulação for concluída, os valores de velocidade da manipulação serão usados para configurar um processador inércia.</span><span class="sxs-lookup"><span data-stu-id="d8579-152">After the manipulation completes, velocity values from the manipulation are used to set up an inertia processor.</span></span> <span data-ttu-id="d8579-153">Conforme ilustrado na coluna do meio, o método [**processo**](/windows/desktop/api/manipulations/nf-manipulations-iinertiaprocessor-process) ou [**processtime**](/windows/desktop/api/manipulations/nf-manipulations-iinertiaprocessor-processtime) é chamado na interface [**IInertiaProcessor**](/windows/desktop/api/manipulations/nn-manipulations-iinertiaprocessor) usando um temporizador ou outro loop em um thread separado até que as chamadas indiquem que o processamento do processador terminou.</span><span class="sxs-lookup"><span data-stu-id="d8579-153">As illustrated in the middle column, the [**Process**](/windows/desktop/api/manipulations/nf-manipulations-iinertiaprocessor-process) or [**ProcessTime**](/windows/desktop/api/manipulations/nf-manipulations-iinertiaprocessor-processtime) method is called on the [**IInertiaProcessor**](/windows/desktop/api/manipulations/nn-manipulations-iinertiaprocessor) interface using a timer or other loop in a separate thread until the calls indicate the processor is finished processing.</span></span> <span data-ttu-id="d8579-154">Embora essas chamadas sejam feitas, os eventos de manipulação são gerados, que são tratados por um coletor de eventos de manipulação com base na interface [**\_ IManipulationEvents**](/windows/win32/api/manipulations/nn-manipulations-_imanipulationevents) .</span><span class="sxs-lookup"><span data-stu-id="d8579-154">While these calls are made, manipulation events are raised, which are handled by a manipulation event sink based on the [**\_IManipulationEvents**](/windows/win32/api/manipulations/nn-manipulations-_imanipulationevents) interface.</span></span> <span data-ttu-id="d8579-155">Na seção inferior direita da ilustração, esse coletor de eventos executa atualizações na interface do usuário do aplicativo com base em eventos de manipulação quando eles ocorrem por meio de manipuladores de eventos no coletor de eventos.</span><span class="sxs-lookup"><span data-stu-id="d8579-155">At the bottom right section of the illustration, this event sink then performs updates to the application UI based on manipulation events when they occur through event handlers in the event sink.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d8579-156">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="d8579-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d8579-157">Guia de programação</span><span class="sxs-lookup"><span data-stu-id="d8579-157">Programming Guide</span></span>](programming-guide.md)
</dt> </dl>

 

 