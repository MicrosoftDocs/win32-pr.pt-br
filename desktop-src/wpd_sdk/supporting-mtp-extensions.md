---
description: Suporte a extensões de MTP
ms.assetid: 9e5f3da6-346a-4eca-bc85-2755c569986d
title: Suporte a extensões de MTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f26a6a5a585167984ec944528bb74a6746e42ac4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103829592"
---
# <a name="supporting-mtp-extensions"></a><span data-ttu-id="b6d63-103">Suporte a extensões de MTP</span><span class="sxs-lookup"><span data-stu-id="b6d63-103">Supporting MTP Extensions</span></span>

## <a name="media-transfer-protocol"></a><span data-ttu-id="b6d63-104">Protocolo de transferência de mídia</span><span class="sxs-lookup"><span data-stu-id="b6d63-104">Media Transfer Protocol</span></span>

<span data-ttu-id="b6d63-105">O MTP (protocolo de transferência de mídia) é uma extensão do PTP (protocolo de transferência de imagem).</span><span class="sxs-lookup"><span data-stu-id="b6d63-105">Media Transfer Protocol (MTP) is an extension to the Picture Transfer Protocol (PTP).</span></span> <span data-ttu-id="b6d63-106">Como resultado, todas as semânticas do protocolo PTP são válidas em MTP.</span><span class="sxs-lookup"><span data-stu-id="b6d63-106">As a result, all PTP protocol semantics are valid in MTP.</span></span>

<span data-ttu-id="b6d63-107">O MTP se comunica usando comandos e respostas entre duas partes, o iniciador e o respondente.</span><span class="sxs-lookup"><span data-stu-id="b6d63-107">MTP communicates by using commands and responses between two parties, the initiator and the responder.</span></span> <span data-ttu-id="b6d63-108">As funções dos dispositivos envolvidos são claramente definidas.</span><span class="sxs-lookup"><span data-stu-id="b6d63-108">The roles of the involved devices are very clearly defined.</span></span> <span data-ttu-id="b6d63-109">O PC normalmente é o iniciador, e o dispositivo é sempre o respondente.</span><span class="sxs-lookup"><span data-stu-id="b6d63-109">The PC typically is the initiator, and the device is always the responder.</span></span> <span data-ttu-id="b6d63-110">Um dispositivo que não seja de PC também poderia ser um iniciador (por exemplo, um baralho de carro ou uma caixa de X da Microsoft).</span><span class="sxs-lookup"><span data-stu-id="b6d63-110">A non-PC device could also be an initiator (for example, a car deck or a Microsoft X-box).</span></span> <span data-ttu-id="b6d63-111">Um dispositivo nunca pode assumir ambas as funções ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="b6d63-111">A device can never assume both roles at the same time.</span></span>

<span data-ttu-id="b6d63-112">O iniciador inicia a comunicação enviando um comando para o respondente.</span><span class="sxs-lookup"><span data-stu-id="b6d63-112">The initiator starts communication by sending a command to the responder.</span></span> <span data-ttu-id="b6d63-113">O respondente processa o comando e envia de volta uma resposta apropriada.</span><span class="sxs-lookup"><span data-stu-id="b6d63-113">The responder processes the command and sends back an appropriate response.</span></span> <span data-ttu-id="b6d63-114">Pode haver uma fase de dados associada ao comando.</span><span class="sxs-lookup"><span data-stu-id="b6d63-114">There might be a data phase associated with the command.</span></span> <span data-ttu-id="b6d63-115">Se esse for o caso, a direção do fluxo de dados deve ser conhecida com antecedência e aceita pelo iniciador e pelo respondente.</span><span class="sxs-lookup"><span data-stu-id="b6d63-115">If this is the case, the direction of data flow must be known beforehand and accepted by both the initiator and the responder.</span></span> <span data-ttu-id="b6d63-116">Lembre-se de que não há um cabeçalho descritivo que indica fluxos de dados para novos comandos.</span><span class="sxs-lookup"><span data-stu-id="b6d63-116">Be aware that there is not a descriptive header that indicates data flows for new commands.</span></span>

<span data-ttu-id="b6d63-117">O respondente pode iniciar a comunicação independente do iniciador.</span><span class="sxs-lookup"><span data-stu-id="b6d63-117">The responder can start communication independent of the initiator.</span></span> <span data-ttu-id="b6d63-118">Por exemplo, o respondente pode enviar eventos para o iniciador.</span><span class="sxs-lookup"><span data-stu-id="b6d63-118">For example, the responder can send events to the initiator.</span></span> <span data-ttu-id="b6d63-119">No entanto, nenhum dado pode ser enviado junto com o evento.</span><span class="sxs-lookup"><span data-stu-id="b6d63-119">However, no data can be sent together with the event.</span></span> <span data-ttu-id="b6d63-120">Se houver dados que precisam ser lidos como parte do evento, o iniciador deverá enviar um comando MTP e o dispositivo poderá enviar dados em resposta ao comando.</span><span class="sxs-lookup"><span data-stu-id="b6d63-120">If there is any data that needs to be read as part of the event, the initiator must send an MTP command, and the device can then send data in response to the command.</span></span>

<span data-ttu-id="b6d63-121">Para obter uma descrição completa do MTP, consulte a [especificação do MTP](https://www.usb.org/sites/default/files/MTPv1_1.zip).</span><span class="sxs-lookup"><span data-stu-id="b6d63-121">For a complete description of MTP, refer to the [MTP specification](https://www.usb.org/sites/default/files/MTPv1_1.zip).</span></span>

## <a name="sending-mtp-commands"></a><span data-ttu-id="b6d63-122">Enviando comandos MTP</span><span class="sxs-lookup"><span data-stu-id="b6d63-122">Sending MTP Commands</span></span>

<span data-ttu-id="b6d63-123">Os aplicativos podem enviar comandos MTP para um dispositivo invocando o método [**IPortableDevice:: SendCommand**](/windows/desktop/api/PortableDeviceApi/nf-portabledeviceapi-iportabledevice-sendcommand) .</span><span class="sxs-lookup"><span data-stu-id="b6d63-123">Applications can send MTP commands to a device by invoking the [**IPortableDevice::SendCommand**](/windows/desktop/api/PortableDeviceApi/nf-portabledeviceapi-iportabledevice-sendcommand) method.</span></span> <span data-ttu-id="b6d63-124">O comando que é enviado depende de se há uma fase de dados e se algum dado que o acompanha é lido ou gravado no dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b6d63-124">The command that is sent depends on whether there is a data phase, and, on whether any accompanying data is read from or written to the device.</span></span> <span data-ttu-id="b6d63-125">A tabela a seguir descreve os três comandos de extensão MTP possíveis.</span><span class="sxs-lookup"><span data-stu-id="b6d63-125">The following table describes the three possible MTP extension commands.</span></span>

<span data-ttu-id="b6d63-126">Lembre-se de que esses comandos são específicos para MTP; e, portanto, são implementadas apenas pelo driver de classe MTP WPD.</span><span class="sxs-lookup"><span data-stu-id="b6d63-126">Be aware that these commands are specific to MTP; and are therefore, only implemented by the WPD MTP class driver.</span></span>



|                                                                                                                                      |                                                                                                   |
|--------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b6d63-127">Comando</span><span class="sxs-lookup"><span data-stu-id="b6d63-127">Command</span></span>                                                                                                                              | <span data-ttu-id="b6d63-128">Descrição</span><span class="sxs-lookup"><span data-stu-id="b6d63-128">Description</span></span>                                                                                       |
| [<span data-ttu-id="b6d63-129">**\_transferência de \_ \_ dados de \_ extremidade \_ de \_ MTP de comando WPD**</span><span class="sxs-lookup"><span data-stu-id="b6d63-129">**WPD\_COMMAND\_MTP\_EXT\_END\_DATA\_TRANSFER**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-end-data-transfer)                                      | <span data-ttu-id="b6d63-130">Emite um comando MTP que sinaliza a conclusão de uma operação de leitura ou gravação de dados.</span><span class="sxs-lookup"><span data-stu-id="b6d63-130">Issues an MTP command that signals the conclusion of a data read or write operation.</span></span>              |
| [<span data-ttu-id="b6d63-131">**comando WPD de \_ \_ MTP \_ ext comando \_ \_ \_ sem \_ fase de dados \_**</span><span class="sxs-lookup"><span data-stu-id="b6d63-131">**WPD\_COMMAND\_MTP\_EXT\_EXECUTE\_COMMAND\_WITHOUT\_DATA\_PHASE**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-execute-command-without-data-phase)  | <span data-ttu-id="b6d63-132">Emite um comando MTP sem uma fase de dados correspondente.</span><span class="sxs-lookup"><span data-stu-id="b6d63-132">Issues an MTP command without a corresponding data phase.</span></span>                                         |
| [<span data-ttu-id="b6d63-133">**\_comando WPD \_ MTP \_ ext \_ \_ comando \_ com \_ dados \_ a serem \_ gravados**</span><span class="sxs-lookup"><span data-stu-id="b6d63-133">**WPD\_COMMAND\_MTP\_EXT\_EXECUTE\_COMMAND\_WITH\_DATA\_TO\_WRITE**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-execute-command-with-data-to-write) | <span data-ttu-id="b6d63-134">Emite um comando MTP seguido pelo acompanhamento de dados, que serão gravados no dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b6d63-134">Issues an MTP command that is followed by accompanying data, which will be written to the device.</span></span> |
| [<span data-ttu-id="b6d63-135">**\_comando WPD \_ MTP \_ ext \_ \_ comando \_ com \_ dados \_ a serem \_ lidos**</span><span class="sxs-lookup"><span data-stu-id="b6d63-135">**WPD\_COMMAND\_MTP\_EXT\_EXECUTE\_COMMAND\_WITH\_DATA\_TO\_READ**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-execute-command-with-data-to-read)   | <span data-ttu-id="b6d63-136">Emite um comando MTP seguido pelo acompanhamento de dados, que é lido do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="b6d63-136">Issues an MTP command that is followed by accompanying data, which is read from the device.</span></span>       |
| [<span data-ttu-id="b6d63-137">**comando WPD de \_ \_ leitura de \_ \_ dados de extensão MTP \_**</span><span class="sxs-lookup"><span data-stu-id="b6d63-137">**WPD\_COMMAND\_MTP\_EXT\_READ\_DATA**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-read-data)                                                       | <span data-ttu-id="b6d63-138">Emite um comando MTP que envia dados do dispositivo para o PC.</span><span class="sxs-lookup"><span data-stu-id="b6d63-138">Issues an MTP command that sends data from the device to the PC.</span></span>                                  |
| [<span data-ttu-id="b6d63-139">**comando WPD de \_ \_ gravação de \_ \_ \_ dados do MTP**</span><span class="sxs-lookup"><span data-stu-id="b6d63-139">**WPD\_COMMAND\_MTP\_EXT\_WRITE\_DATA**</span></span>](/windows/desktop/wpd_sdk/wpd-command-mtp-ext-write-data)                                                     | <span data-ttu-id="b6d63-140">Emite um comando MTP que envia dados para o dispositivo do PC.</span><span class="sxs-lookup"><span data-stu-id="b6d63-140">Issues an MTP command that sends data to the device from the PC.</span></span>                                  |



 

<span data-ttu-id="b6d63-141">Seja qual for a fase, a **Propriedade WPD do MTP e o \_ \_ \_ \_ \_ código** da operação de especificação do **\_ \_ MTP \_ ext \_ \_ Property** devem ser especificados.</span><span class="sxs-lookup"><span data-stu-id="b6d63-141">Regardless of the phase, **WPD\_PROPERTY\_MTP\_EXT\_OPERATION\_CODE** and **WPD\_PROPERTY\_MTP\_EXT\_OPERATION\_PARAMS** must be specified.</span></span>

<span data-ttu-id="b6d63-142">Se o driver MTP puder enviar o comando para o dispositivo, os valores de retorno sempre conterão o **\_ código de \_ \_ \_ resposta \_ MTP ext da propriedade WPD**.</span><span class="sxs-lookup"><span data-stu-id="b6d63-142">If the MTP driver was able to send the command to the device, the return values will always contain **WPD\_PROPERTY\_MTP\_EXT\_RESPONSE\_CODE**.</span></span> <span data-ttu-id="b6d63-143">Se o código de resposta indicar êxito e se a semântica do comando permitir parâmetros de resposta, o **\_ parâmetro de \_ \_ resposta de \_ \_ extensão MTP da propriedade WPD** também estará disponível.</span><span class="sxs-lookup"><span data-stu-id="b6d63-143">If the response code indicates success and if the semantics of the command allow for response parameters, **WPD\_PROPERTY\_MTP\_EXT\_RESPONSE\_PARAMS** will also be available.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b6d63-144">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="b6d63-144">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b6d63-145">**Guia de programação**</span><span class="sxs-lookup"><span data-stu-id="b6d63-145">**Programming Guide**</span></span>](programming-guide.md)
</dt> </dl>

 

 
