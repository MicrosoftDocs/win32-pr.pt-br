---
description: Os contextos de ativação são visíveis durante todo o processo.
ms.assetid: 6eda00d5-9dac-4267-bf61-b481814201f8
title: Threads, procedimentos assíncronos e mensagens de janela
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e615eb9795ba32bcf4bd227a4933e890e9b89055
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103826994"
---
# <a name="using-threads-asynchronous-procedures-and-window-messages"></a><span data-ttu-id="60e45-103">Usando threads, procedimentos assíncronos e mensagens de janela</span><span class="sxs-lookup"><span data-stu-id="60e45-103">Using Threads, Asynchronous Procedures, and Window Messages</span></span>

<span data-ttu-id="60e45-104">Os contextos de ativação são visíveis durante todo o processo.</span><span class="sxs-lookup"><span data-stu-id="60e45-104">Activation contexts are visible throughout the entire process.</span></span> <span data-ttu-id="60e45-105">As pilhas de contexto de ativação são, no entanto, por thread, e dois threads no mesmo processo podem ter diferentes pilhas de ativação.</span><span class="sxs-lookup"><span data-stu-id="60e45-105">The activation context stacks are however per-thread, and two threads in the same process can have different activation stacks.</span></span> <span data-ttu-id="60e45-106">[**CreateThread**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createthread) coloca automaticamente o contexto de ativação atual na parte superior da pilha de ativação do novo thread.</span><span class="sxs-lookup"><span data-stu-id="60e45-106">[**CreateThread**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createthread) automatically puts the current activation context at the top of the new thread's activation stack.</span></span> <span data-ttu-id="60e45-107">Isso pode facilitar a atualização do código existente para usar componentes lado a lado, pois o novo thread pode ser executado imediatamente no contexto de ativação atual.</span><span class="sxs-lookup"><span data-stu-id="60e45-107">This can facilitate upgrading existing code to use side-by-side components because the new thread can run immediately in the current activation context.</span></span>

<span data-ttu-id="60e45-108">Chamadas de procedimento assíncronos, retornos de chamada de porta de conclusão e quaisquer outros retornos de chamada em outros threads obtêm automaticamente o contexto de ativação da origem.</span><span class="sxs-lookup"><span data-stu-id="60e45-108">Asynchronous procedure calls, completion port callbacks, and any other callbacks on other threads automatically get the activation context of the source.</span></span> <span data-ttu-id="60e45-109">Quando o retorno de chamada é chamado, a pilha de ativação é limpa.</span><span class="sxs-lookup"><span data-stu-id="60e45-109">When the callback is called, the activation stack is cleaned up.</span></span> <span data-ttu-id="60e45-110">Isso significa que seu aplicativo pode usar chamadas de procedimento assíncronos e retornos de chamada sem ativar explicitamente quaisquer contextos porque o gerenciamento de contexto será feito pela infraestrutura lado a lado subjacente.</span><span class="sxs-lookup"><span data-stu-id="60e45-110">This means that your application can use asynchronous procedure calls and callbacks without explicitly activating any contexts because context management will be done by the underlying side-by-side infrastructure.</span></span> <span data-ttu-id="60e45-111">Para fazer com que outros contextos sejam ativados durante um retorno de chamada ou novo thread, seu aplicativo pode fazer seu próprio gerenciamento de contexto.</span><span class="sxs-lookup"><span data-stu-id="60e45-111">To make other contexts active during a callback or new thread, your application can do its own context management.</span></span> <span data-ttu-id="60e45-112">Nesse caso, o programa deve usar a sequência adequada de contexto de ativação ativar funções e desativar funções.</span><span class="sxs-lookup"><span data-stu-id="60e45-112">In this case your program must use the proper sequence of activation context activate functions and deactivate functions.</span></span>

<span data-ttu-id="60e45-113">Os contextos de ativação são de thread neutro.</span><span class="sxs-lookup"><span data-stu-id="60e45-113">Activation contexts are thread-neutral.</span></span> <span data-ttu-id="60e45-114">Ativar um contexto apenas altera a pilha do thread atual e você não pode ativar um contexto entre threads.</span><span class="sxs-lookup"><span data-stu-id="60e45-114">Activating a context only changes the current thread's stack, and you cannot activate a context across threads.</span></span> <span data-ttu-id="60e45-115">O thread A não pode forçar um contexto para o thread B. As funções da API de contexto de ativação também têm reconhecimento de Threading.</span><span class="sxs-lookup"><span data-stu-id="60e45-115">Thread A cannot force a context onto thread B. The functions of the activation context API are also threading-aware.</span></span>

<span data-ttu-id="60e45-116">Quando você usa [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) ou a [**mensagem de ismessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) para enviar uma mensagem de janela para outro procedimento de janela em seu processo, o contexto de ativação atual é ativado antes que a mensagem seja passada para o procedimento de destino.</span><span class="sxs-lookup"><span data-stu-id="60e45-116">When you use [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) or [**PostMessage**](/windows/win32/api/winuser/nf-winuser-postmessagea) to send a window message to another window procedure in your process, the current activation context is activated before the message is passed on to the target procedure.</span></span> <span data-ttu-id="60e45-117">O contexto de ativação atual acompanha a mensagem.</span><span class="sxs-lookup"><span data-stu-id="60e45-117">The current activation context goes along with the message.</span></span> <span data-ttu-id="60e45-118">Isso garante que as mensagens que se referem a objetos COM, nomes de DLL ou outros recursos lado a lado retenham suas informações de contexto corretas.</span><span class="sxs-lookup"><span data-stu-id="60e45-118">This ensures that messages that refer to COM objects, DLL names, or other side-by-side resources retain their correct context information.</span></span>

 

 
