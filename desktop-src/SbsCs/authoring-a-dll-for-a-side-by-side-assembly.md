---
description: Ao criar seus próprios assemblies lado a lado, siga as diretrizes para criar assemblies lado a lado.
ms.assetid: e5fc3bae-0646-4418-a8f7-369856f03cd5
title: Criando DLLs para assemblies lado a lado
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa15f3876c60ce55be00d60d8f417eb0c2cbf6ec
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104170035"
---
# <a name="authoring-dlls-for-side-by-side-assemblies"></a><span data-ttu-id="f92ca-103">Criando DLLs para assemblies lado a lado</span><span class="sxs-lookup"><span data-stu-id="f92ca-103">Authoring DLLs for Side-by-side Assemblies</span></span>

<span data-ttu-id="f92ca-104">Ao criar seus próprios assemblies lado a lado, siga as [diretrizes para criar assemblies lado a lado](guidelines-for-creating-side-by-side-assemblies.md) e criar qualquer DLL usada no assembly de acordo com as seguintes diretrizes:</span><span class="sxs-lookup"><span data-stu-id="f92ca-104">When creating your own side-by-side assemblies, follow the [Guidelines for Creating Side-by-side Assemblies](guidelines-for-creating-side-by-side-assemblies.md) and author any DLLs used in the assembly according to the following guidelines:</span></span>

-   <span data-ttu-id="f92ca-105">Suas DLLs devem ser projetadas para que várias versões possam ser executadas ao mesmo tempo e no mesmo processo sem interferir umas com as outras.</span><span class="sxs-lookup"><span data-stu-id="f92ca-105">Your DLLs should be designed so that multiple versions can run at the same time and in the same process without interfering with each other.</span></span> <span data-ttu-id="f92ca-106">Por exemplo, muitos aplicativos hospedam vários plug-ins que exigem uma versão diferente de um componente.</span><span class="sxs-lookup"><span data-stu-id="f92ca-106">For example, many applications host multiple plug-ins that each require a different version of one component.</span></span> <span data-ttu-id="f92ca-107">O desenvolvedor que o assembly lado a lado precisa projetar e testar para garantir que várias versões do componente funcionem corretamente quando executadas ao mesmo tempo no mesmo processo.</span><span class="sxs-lookup"><span data-stu-id="f92ca-107">The developer the side-by-side assembly needs to design and test to ensure that multiple versions of the component work correctly when run at the same time in the same process.</span></span>

-   <span data-ttu-id="f92ca-108">Se você planeja fornecer seu componente como um componente compartilhado em sistemas anteriores ao Windows XP, você precisará continuar a instalar o componente nesses sistemas como um componente compartilhado de instância única.</span><span class="sxs-lookup"><span data-stu-id="f92ca-108">If you plan to provide your component as a shared component on systems earlier than Windows XP, you need to continue to install the component on these systems as a single-instance shared component.</span></span> <span data-ttu-id="f92ca-109">Nesse caso, você precisa garantir que seu componente seja compatível com versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="f92ca-109">In this case, you need to ensure your component is backward compatible.</span></span>

-   <span data-ttu-id="f92ca-110">Avalie o uso de objetos quando mais de uma versão do assembly for executada no sistema.</span><span class="sxs-lookup"><span data-stu-id="f92ca-110">Evaluate the use of objects when more than one version of your assembly is run on the system.</span></span> <span data-ttu-id="f92ca-111">Determine se versões diferentes do assembly exigem estruturas de dados separadas, como arquivos mapeados de memória, pipes nomeados, mensagens e classes registradas do Windows, memória compartilhada, semáforos, mutexes e drivers de hardware.</span><span class="sxs-lookup"><span data-stu-id="f92ca-111">Determine whether different versions of the assembly require separate data structures, such as memory-mapped files, named pipes, registered Windows messages and classes, shared memory, semaphores, mutexes, and hardware drivers.</span></span> <span data-ttu-id="f92ca-112">Todas as estruturas de dados usadas nas versões de assembly devem ser compatíveis com versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="f92ca-112">Any data structures used across assembly versions must be backward-compatible.</span></span> <span data-ttu-id="f92ca-113">Decida quais estruturas de dados podem ser usadas nas versões e quais estruturas de dados devem ser privadas para uma versão.</span><span class="sxs-lookup"><span data-stu-id="f92ca-113">Decide which data structures can be used across versions, and which data structures must be private to a version.</span></span> <span data-ttu-id="f92ca-114">Determine se as estruturas de dados compartilhados exigem objetos de sincronização separados, como semáforos e mutexes.</span><span class="sxs-lookup"><span data-stu-id="f92ca-114">Determine whether shared data structures require separate synchronization objects, such as semaphores and mutexes.</span></span>

-   <span data-ttu-id="f92ca-115">Alguns objetos, como classes de janela e Atoms, são nomeados exclusivamente para cada processo.</span><span class="sxs-lookup"><span data-stu-id="f92ca-115">Some objects, such as window classes and Atoms, are uniquely named for each process.</span></span> <span data-ttu-id="f92ca-116">Objetos como classes de janela devem ter controle de versão para cada assembly usando o manifesto.</span><span class="sxs-lookup"><span data-stu-id="f92ca-116">Objects such as window classes should be versioned for each assembly using the manifest.</span></span> <span data-ttu-id="f92ca-117">Para objetos como Atoms, use identificadores específicos de versão, a menos que você planeje compartilhar entre versões.</span><span class="sxs-lookup"><span data-stu-id="f92ca-117">For objects such as Atoms, use version-specific identifiers unless you plan to share across versions.</span></span> <span data-ttu-id="f92ca-118">Se você usar identificadores específicos de versão, use o número de versão de quatro partes.</span><span class="sxs-lookup"><span data-stu-id="f92ca-118">If you use version-specific identifiers, use the four-part versioning number.</span></span>

-   <span data-ttu-id="f92ca-119">Não inclua nenhum código de registro automático em qualquer DLL.</span><span class="sxs-lookup"><span data-stu-id="f92ca-119">Include no self-registering code in any DLL.</span></span> <span data-ttu-id="f92ca-120">Uma DLL em um assembly lado a lado não pode ser autoregistrada.</span><span class="sxs-lookup"><span data-stu-id="f92ca-120">A DLL in a side-by-side assembly cannot be self-registering.</span></span>

-   <span data-ttu-id="f92ca-121">Defina todos os nomes específicos de versão em sua DLL com \# instruções de definição.</span><span class="sxs-lookup"><span data-stu-id="f92ca-121">Define all version-specific names in your DLL with \#define statements.</span></span> <span data-ttu-id="f92ca-122">Isso permite que todas as chaves do registro sejam alteradas de um local.</span><span class="sxs-lookup"><span data-stu-id="f92ca-122">This enables all registry keys to be changed from one location.</span></span> <span data-ttu-id="f92ca-123">Ao liberar uma nova versão do assembly, você só precisa alterar essa \# instrução de definição.</span><span class="sxs-lookup"><span data-stu-id="f92ca-123">When you release a new version of your assembly, you only need to change this \#define statement.</span></span> <span data-ttu-id="f92ca-124">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="f92ca-124">For example:</span></span>

    `#define MyRegistryKey "MyAssembly1.0.0.0"`

-   <span data-ttu-id="f92ca-125">Armazene quaisquer dados não persistentes no diretório temporário.</span><span class="sxs-lookup"><span data-stu-id="f92ca-125">Store any nonpersistent data in the Temp directory.</span></span>

-   <span data-ttu-id="f92ca-126">Não coloque os dados do usuário em locais globais.</span><span class="sxs-lookup"><span data-stu-id="f92ca-126">Do not put user data into global locations.</span></span> <span data-ttu-id="f92ca-127">Manter os dados do aplicativo separados dos dados do usuário.</span><span class="sxs-lookup"><span data-stu-id="f92ca-127">Keep application data separate from user data.</span></span>

-   <span data-ttu-id="f92ca-128">Atribua a todos os arquivos compartilhados uma versão de arquivo que dependa do nome do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f92ca-128">Assign all shared files a file version that depends upon the application's name.</span></span>

-   <span data-ttu-id="f92ca-129">Atribua todas as mensagens e estruturas de dados usadas em processos uma versão para impedir o compartilhamento entre processos não intencional.</span><span class="sxs-lookup"><span data-stu-id="f92ca-129">Assign all messages and data structures used across processes a version to prevent unintentional cross-process sharing.</span></span>

-   <span data-ttu-id="f92ca-130">Sua DLL não deve depender do compartilhamento entre as versões que podem não existir, como seções de memória compartilhada que não são compartilhadas entre diferentes versões do seu assembly.</span><span class="sxs-lookup"><span data-stu-id="f92ca-130">Your DLL should not depend upon sharing across versions that may not exist, such as shared memory sections that are not shared across different versions of your assembly.</span></span>

-   <span data-ttu-id="f92ca-131">Se você adicionar uma nova funcionalidade que não segue o contrato de compatibilidade de interface binária da DLL original, deverá atribuir um novo CLSID, ProgId e nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="f92ca-131">If you add new functionality that does not follow the binary interface compatibility contract of the original DLL, you must assign a new CLSID, ProgId, and file name.</span></span> <span data-ttu-id="f92ca-132">Versões futuras do assembly lado a lado são necessárias para usar esse CLSID, ProgId e nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="f92ca-132">Future versions of your side-by-side assembly is then required to use this CLSID, ProgId, and file name.</span></span> <span data-ttu-id="f92ca-133">Isso evita um conflito quando uma versão da DLL que não está lado a lado é registrada em uma versão lado a lado.</span><span class="sxs-lookup"><span data-stu-id="f92ca-133">This prevents a conflict when a version of the DLL that is not side-by-side is registered over a side-by-side version.</span></span>

-   <span data-ttu-id="f92ca-134">Se você reutilizar o mesmo CLSID ou ProgId, teste para garantir que o assembly seja compatível com versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="f92ca-134">If you reuse the same CLSID or ProgId, test to ensure that the assembly is backward compatible.</span></span>

-   <span data-ttu-id="f92ca-135">Inicialize e defina as configurações padrão para o assembly no código do assembly.</span><span class="sxs-lookup"><span data-stu-id="f92ca-135">Initialize and set the default settings for the assembly in the assembly code.</span></span> <span data-ttu-id="f92ca-136">Não salve as configurações de padrões no registro.</span><span class="sxs-lookup"><span data-stu-id="f92ca-136">Do not save the defaults settings in the registry.</span></span>

-   <span data-ttu-id="f92ca-137">Atribua versões a todas as estruturas de dados.</span><span class="sxs-lookup"><span data-stu-id="f92ca-137">Assign versions to all data structures.</span></span>

-   <span data-ttu-id="f92ca-138">Sua DLL deve armazenar o estado do assembly lado a lado, conforme descrito em [armazenamento de estado de criação para assemblies lado a lado](authoring-state-storage-for-side-by-side-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="f92ca-138">Your DLL should store the state of the side-by-side assembly as described in [Authoring State Storage for Side-by-Side Assemblies](authoring-state-storage-for-side-by-side-assemblies.md).</span></span>

 

 



