---
description: Contextos de ativação são estruturas de dados na memória que contêm informações que o sistema pode usar para redirecionar um aplicativo para carregar uma versão de DLL específica, instância de objeto COM ou versão de janela personalizada.
ms.assetid: 5416f8c0-d99b-4a5d-a689-a47bd0cf1a88
title: Contextos de ativação
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2f1f20d747f63ba71eee73fc17c0d5543003e5f7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104296715"
---
# <a name="activation-contexts"></a><span data-ttu-id="fdd34-103">Contextos de ativação</span><span class="sxs-lookup"><span data-stu-id="fdd34-103">Activation Contexts</span></span>

<span data-ttu-id="fdd34-104">[*Contextos de ativação*](a-sbscs-gly.md) são estruturas de dados na memória que contêm informações que o sistema pode usar para redirecionar um aplicativo para carregar uma versão de DLL específica, instância de objeto com ou versão de janela personalizada.</span><span class="sxs-lookup"><span data-stu-id="fdd34-104">[*Activation contexts*](a-sbscs-gly.md) are data structures in memory containing information that the system can use to redirect an application to load a particular DLL version, COM object instance, or custom window version.</span></span> <span data-ttu-id="fdd34-105">Uma seção do contexto de ativação pode conter informações de redirecionamento de DLL que são usadas pelo carregador de DLL; outra seção pode conter informações do servidor COM.</span><span class="sxs-lookup"><span data-stu-id="fdd34-105">One section of the activation context may contain DLL redirection information which is used by the DLL loader; another section may contain COM server information.</span></span> <span data-ttu-id="fdd34-106">As funções de contexto de ativação usam, criam, ativam e desativam contextos de ativação.</span><span class="sxs-lookup"><span data-stu-id="fdd34-106">The activation context functions use, create, activate, and deactivate activation contexts.</span></span> <span data-ttu-id="fdd34-107">As funções de ativação podem redirecionar a associação de um aplicativo para objetos nomeados por versão que especificam versões de DLL específicas, classes de janela, servidores COM, bibliotecas de tipos e interfaces.</span><span class="sxs-lookup"><span data-stu-id="fdd34-107">The activation functions can redirect the binding of an application to version-named objects that specify particular DLL versions, window classes, COM servers, type libraries, and interfaces.</span></span> <span data-ttu-id="fdd34-108">Para obter mais informações sobre as funções e estruturas de contexto de ativação, consulte a [referência de contexto de ativação](activation-context-reference.md).</span><span class="sxs-lookup"><span data-stu-id="fdd34-108">For more information about the activation context functions and structures, see the [Activation Context Reference](activation-context-reference.md).</span></span>

<span data-ttu-id="fdd34-109">A partir do Windows XP, as funções de contexto de ativação permitem que o Windows Use informações em [manifestos](manifests.md) para criar objetos nomeados por versão.</span><span class="sxs-lookup"><span data-stu-id="fdd34-109">Beginning with Windows XP, activation context functions enable Windows to use information in [manifests](manifests.md) to create version-named objects.</span></span> <span data-ttu-id="fdd34-110">Se um aplicativo criar um processo chamando [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), o Windows verificará a existência de um [manifesto do aplicativo](application-manifests.md).</span><span class="sxs-lookup"><span data-stu-id="fdd34-110">If an application creates a process by calling [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), Windows checks for the existence of an [application manifest](application-manifests.md).</span></span> <span data-ttu-id="fdd34-111">Se existir um manifesto, o Windows usará as informações no manifesto para preencher o contexto de ativação.</span><span class="sxs-lookup"><span data-stu-id="fdd34-111">If a manifest exists, Windows uses the information in the manifest to populate the activation context.</span></span> <span data-ttu-id="fdd34-112">Como os manifestos descrevem a dependência de um aplicativo nas versões do [assembly lado a lado](about-side-by-side-assemblies-.md) , os objetos especificados sem versões no manifesto são mapeados para objetos com nome de versão.</span><span class="sxs-lookup"><span data-stu-id="fdd34-112">Because manifests describe an application's dependence on [side-by-side assembly](about-side-by-side-assemblies-.md) versions, objects specified without versions in the manifest are mapped to version-named objects.</span></span> <span data-ttu-id="fdd34-113">Por exemplo, o manifesto pode descrever DLLs, arquivos, classes de janela, servidores COM, bibliotecas de tipos e interfaces.</span><span class="sxs-lookup"><span data-stu-id="fdd34-113">For example, the manifest may describe DLLs, files, window classes, COM servers, type libraries, and interfaces.</span></span>

<span data-ttu-id="fdd34-114">Quando um objeto global é criado dentro do contexto de ativação, o sistema automaticamente fornece ao objeto um nome específico da versão consultando o manifesto.</span><span class="sxs-lookup"><span data-stu-id="fdd34-114">When a global object is created within the activation context, the system automatically gives the object a version-specific name by consulting the manifest.</span></span> <span data-ttu-id="fdd34-115">Quando o aplicativo é executado e solicita um objeto nomeado, ele obtém o objeto com nome de versão.</span><span class="sxs-lookup"><span data-stu-id="fdd34-115">When the application executes and requests a named object, it gets the version-named object.</span></span> <span data-ttu-id="fdd34-116">Isso permite que várias versões de um módulo de código sejam executadas no sistema ao mesmo tempo sem interferir umas com as outras.</span><span class="sxs-lookup"><span data-stu-id="fdd34-116">This enables multiple versions of a code module to run on the system at the same time without interfering with each other.</span></span> <span data-ttu-id="fdd34-117">Por exemplo, o [shell do Windows](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)) usa um manifesto para descrever uma dependência da versão 6,0 do Comctl32 e criar versões de classes de janela.</span><span class="sxs-lookup"><span data-stu-id="fdd34-117">For example, [Windows Shell](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)) uses a manifest to describe a dependence on version 6.0 of COMCTL32 and to create versions of window classes.</span></span>

<span data-ttu-id="fdd34-118">Se um aplicativo criar um recurso chamando [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), o processo especificará um nome de classe para essa função.</span><span class="sxs-lookup"><span data-stu-id="fdd34-118">If an application creates a resource by calling [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), the process specifies a class name to that function.</span></span> <span data-ttu-id="fdd34-119">A chamada para [**GetCurrentActCtx**](/windows/desktop/api/Winbase/nf-winbase-getcurrentactctx) Obtém o contexto de ativação atual e verifica se existe um mapeamento para o nome de classe fornecido.</span><span class="sxs-lookup"><span data-stu-id="fdd34-119">The call to [**GetCurrentActCtx**](/windows/desktop/api/Winbase/nf-winbase-getcurrentactctx) gets the current activation context and checks to see if a mapping exists for the given class name.</span></span> <span data-ttu-id="fdd34-120">Se houver um mapeamento, ele usará essa versão do processo de chamada para resolver o mapeamento e fornecer o nome da classe específica da versão.</span><span class="sxs-lookup"><span data-stu-id="fdd34-120">If a mapping exists, it will use that version of the calling process to resolve the mapping and provide the version-specific class name.</span></span> <span data-ttu-id="fdd34-121">O Windows cria uma janela com o procedimento de janela, os estilos e outros atributos associados a esse nome de classe e versão.</span><span class="sxs-lookup"><span data-stu-id="fdd34-121">Windows creates a window with the window procedure, styles, and other attributes associated with that class name and version.</span></span>

<span data-ttu-id="fdd34-122">O contexto de ativação é gerenciado pelo sistema na maioria dos casos.</span><span class="sxs-lookup"><span data-stu-id="fdd34-122">The activation context is managed by the system in most cases.</span></span> <span data-ttu-id="fdd34-123">Os desenvolvedores de aplicativos e os provedores de assembly normalmente não precisam fazer chamadas para a pilha.</span><span class="sxs-lookup"><span data-stu-id="fdd34-123">Application developers and assembly providers do not commonly need to make calls to the stack.</span></span> <span data-ttu-id="fdd34-124">Os aplicativos podem gerenciar um contexto de ativação chamando diretamente o contexto de ativação.</span><span class="sxs-lookup"><span data-stu-id="fdd34-124">Applications can manage an activation context by directly calling the activation context.</span></span> <span data-ttu-id="fdd34-125">Para obter mais informações, consulte [usando a API de contexto de ativação](using-the-activation-context-api.md).</span><span class="sxs-lookup"><span data-stu-id="fdd34-125">For more information, see [Using the Activation Context API](using-the-activation-context-api.md).</span></span>

 

 
