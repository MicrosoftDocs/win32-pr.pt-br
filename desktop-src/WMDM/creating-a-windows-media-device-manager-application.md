---
title: Criando um aplicativo de Gerenciador de Dispositivos de mídia do Windows
description: Criando um aplicativo de Gerenciador de Dispositivos de mídia do Windows
ms.assetid: 6a200bd9-19dd-4130-acb4-e038b469c334
keywords:
- Windows Media Gerenciador de Dispositivos, criando aplicativos
- Gerenciador de Dispositivos, criando aplicativos
- Windows Media Gerenciador de Dispositivos, guia de programação
- Gerenciador de Dispositivos, guia de programação
- Guia de programação, aplicativos de área de trabalho
- Guia de programação, Windows Media Gerenciador de Dispositivos
- Guia de programação, plug-ins
- Guia de programação, criando aplicativos
- Windows Media Gerenciador de Dispositivos, aplicativos de área de trabalho
- Gerenciador de Dispositivos, aplicativos de área de trabalho
- Gerenciador de Dispositivos de mídia do Windows, plug-ins
- Gerenciador de Dispositivos, plug-Insp
- plug-ins, criando
- plug-ins, guia de programação
- aplicativos de desktop, criando
- Criando aplicativos de Gerenciador de Dispositivos de mídia do Windows, sobre
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1b50a2dfce057b993f84c0aca4c8f45796f67ba8
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "105781475"
---
# <a name="creating-a-windows-media-device-manager-application"></a><span data-ttu-id="20a73-119">Criando um aplicativo de Gerenciador de Dispositivos de mídia do Windows</span><span class="sxs-lookup"><span data-stu-id="20a73-119">Creating a Windows Media Device Manager Application</span></span>

<span data-ttu-id="20a73-120">Esta seção descreve como usar o Windows Media Gerenciador de Dispositivos em seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="20a73-120">This section describes how to use Windows Media Device Manager in your application.</span></span> <span data-ttu-id="20a73-121">O termo "aplicativo" aqui significa um executável, como um player de mídia ou um plug-in COM, como um plug-in de medição.</span><span class="sxs-lookup"><span data-stu-id="20a73-121">The term "application" here means either an executable, such as a media player, or a COM plug-in, such as a metering plug-in.</span></span>

<span data-ttu-id="20a73-122">A Microsoft inclui vários provedores de serviços com o Windows XP e o Windows Media Player 10, incluindo um provedor de serviços do MTP, um provedor de serviços de Windows CE (para dispositivos que executam Windows CE e usando o protocolo RAPI, como o Pocket PC) e um provedor de serviços para dispositivos de categoria de armazenamento em massa (MSC).</span><span class="sxs-lookup"><span data-stu-id="20a73-122">Microsoft includes several service providers with Windows XP and Windows Media Player 10, including an MTP service provider, a Windows CE service provider (for devices running Windows CE and using the RAPI protocol, such as the Pocket PC), and a service provider for mass-storage category (MSC) devices.</span></span> <span data-ttu-id="20a73-123">Você também pode criar seu próprio provedor de serviços para garantir a comunicação com seu próprio dispositivo; para obter mais informações, consulte [criando um provedor de serviços](creating-a-service-provider.md).</span><span class="sxs-lookup"><span data-stu-id="20a73-123">You can also create your own service provider to ensure communication with your own device; for more information, see [Creating a Service Provider](creating-a-service-provider.md).</span></span>

<span data-ttu-id="20a73-124">Há vários provedores de serviços herdados de terceiros que abordam um dispositivo específico do fabricante, não RAPI ou não-MSC.</span><span class="sxs-lookup"><span data-stu-id="20a73-124">There are a number of third-party legacy service providers that address a particular manufacturer's non-MTP, non-RAPI, or non-MSC device.</span></span> <span data-ttu-id="20a73-125">Esses provedores de serviços estão incluídos no disco do driver fornecido com esses dispositivos.</span><span class="sxs-lookup"><span data-stu-id="20a73-125">These service providers are included on the driver disk shipped with these devices.</span></span>

<span data-ttu-id="20a73-126">Um aplicativo que usa o Windows Media Gerenciador de Dispositivos deve executar as etapas a seguir.</span><span class="sxs-lookup"><span data-stu-id="20a73-126">An application that uses Windows Media Device Manager must perform the following steps.</span></span>

1.  <span data-ttu-id="20a73-127">**Fique atento aos problemas de privacidade envolvidos no desenvolvimento de um aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="20a73-127">**Become aware of privacy issues involved with developing an application.**</span></span> <span data-ttu-id="20a73-128">Consulte a [política de privacidade](privacy-statement.md) para saber mais sobre problemas de privacidade envolvendo o desenvolvimento de um aplicativo de Gerenciador de dispositivos de mídia do Windows.</span><span class="sxs-lookup"><span data-stu-id="20a73-128">See [Privacy Statement](privacy-statement.md) to learn about some privacy issues involving developing a Windows Media Device Manager application.</span></span>
2.  <span data-ttu-id="20a73-129">**Inclua a biblioteca e os arquivos de cabeçalho necessários para seu aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="20a73-129">**Include the required library and header files for your application.**</span></span> <span data-ttu-id="20a73-130">Consulte [os arquivos de biblioteca e de cabeçalho necessários para um aplicativo](required-library-and-header-files-for-an-application.md) para saber quais arquivos você precisará incluir em seu projeto.</span><span class="sxs-lookup"><span data-stu-id="20a73-130">See [Required Library and Header Files for an Application](required-library-and-header-files-for-an-application.md) to learn what files you will need to include in your project.</span></span>
3.  <span data-ttu-id="20a73-131">**Autentique o aplicativo e adquira a interface IWMDMDevice raiz.**</span><span class="sxs-lookup"><span data-stu-id="20a73-131">**Authenticate the application and acquire the root IWMDMDevice interface.**</span></span> <span data-ttu-id="20a73-132">A primeira tarefa que um aplicativo deve fazer para usar o Windows Media Gerenciador de Dispositivos é autenticar a si mesmo.</span><span class="sxs-lookup"><span data-stu-id="20a73-132">The first task an application must do to use Windows Media Device Manager is to authenticate itself.</span></span> <span data-ttu-id="20a73-133">Esse processo verifica a identidade do aplicativo para o Windows Media Gerenciador de Dispositivos usando um certificado fictício para a funcionalidade limitada do Windows Media Gerenciador de Dispositivos ou usando um certificado oficial para a funcionalidade completa.</span><span class="sxs-lookup"><span data-stu-id="20a73-133">This process verifies the identity of the application to Windows Media Device Manager using a dummy certificate for limited Windows Media Device Manager functionality, or using an official certificate for full functionality.</span></span> <span data-ttu-id="20a73-134">Para obter mais informações, consulte [Autenticando o aplicativo](authenticating-the-application.md).</span><span class="sxs-lookup"><span data-stu-id="20a73-134">For more information, see [Authenticating the Application](authenticating-the-application.md).</span></span>
4.  <span data-ttu-id="20a73-135">**Enumere os dispositivos conectados.**</span><span class="sxs-lookup"><span data-stu-id="20a73-135">**Enumerate the connected devices.**</span></span> <span data-ttu-id="20a73-136">A primeira etapa na comunicação com dispositivos é descobrir quais dispositivos estão conectados e acessíveis ao Windows Media Gerenciador de Dispositivos.</span><span class="sxs-lookup"><span data-stu-id="20a73-136">The first step in communicating with devices is to find out what devices are connected and accessible to Windows Media Device Manager.</span></span> <span data-ttu-id="20a73-137">Para obter mais informações, consulte [enumerando dispositivos](enumerating-devices.md).</span><span class="sxs-lookup"><span data-stu-id="20a73-137">For more information, see [Enumerating Devices](enumerating-devices.md).</span></span>
5.  <span data-ttu-id="20a73-138">**Verifique o status dos componentes DRM do dispositivo.**</span><span class="sxs-lookup"><span data-stu-id="20a73-138">**Check the status of the device's DRM components.**</span></span> <span data-ttu-id="20a73-139">Para usar arquivos protegidos por DRM, um dispositivo deve ser criado em alguma versão do Windows Media DRM para dispositivos portáteis e os componentes DRM devem estar atualizados.</span><span class="sxs-lookup"><span data-stu-id="20a73-139">To use DRM-protected files, a device must be built on some version of Windows Media DRM for Portable Devices, and the DRM components must be up to date.</span></span> <span data-ttu-id="20a73-140">Antes de começar a lidar com arquivos no dispositivo, é melhor ver se o dispositivo dá suporte a arquivos protegidos por DRM e se o dispositivo precisa ser atualizado.</span><span class="sxs-lookup"><span data-stu-id="20a73-140">Before you begin handling files on the device, it is best to see if the device supports DRM-protected files, and whether the device needs to be updated.</span></span> <span data-ttu-id="20a73-141">Para obter mais informações, consulte [lidando com conteúdo protegido no aplicativo](handling-protected-content-in-the-application.md).</span><span class="sxs-lookup"><span data-stu-id="20a73-141">For more information, see [Handling Protected Content in the Application](handling-protected-content-in-the-application.md).</span></span>
6.  <span data-ttu-id="20a73-142">**Explorar um dispositivo.**</span><span class="sxs-lookup"><span data-stu-id="20a73-142">**Explore a device.**</span></span> <span data-ttu-id="20a73-143">Depois de encontrar o dispositivo desejado, você pode explorar o conteúdo desse dispositivo.</span><span class="sxs-lookup"><span data-stu-id="20a73-143">After you have found the device you want, you can explore the contents of that device.</span></span> <span data-ttu-id="20a73-144">Para obter mais informações, consulte [explorando um dispositivo](exploring-a-device.md).</span><span class="sxs-lookup"><span data-stu-id="20a73-144">For more information, see [Exploring a Device](exploring-a-device.md).</span></span>
7.  <span data-ttu-id="20a73-145">**Ler arquivos do dispositivo e gravar arquivos no dispositivo.**</span><span class="sxs-lookup"><span data-stu-id="20a73-145">**Read files from the device, and write files to the device.**</span></span> <span data-ttu-id="20a73-146">Depois de saber sobre o layout do dispositivo, você pode começar a transferir arquivos de e para o dispositivo.</span><span class="sxs-lookup"><span data-stu-id="20a73-146">After you know about the layout of the device, you can begin transferring files to and from the device.</span></span> <span data-ttu-id="20a73-147">Para obter mais informações, consulte [lendo arquivos do dispositivo](reading-files-from-the-device.md) e [gravando arquivos no dispositivo](writing-files-to-the-device.md).</span><span class="sxs-lookup"><span data-stu-id="20a73-147">For more information, see [Reading Files from the Device](reading-files-from-the-device.md) and [Writing Files to the Device](writing-files-to-the-device.md).</span></span>
8.  <span data-ttu-id="20a73-148">**Crie listas de reprodução no dispositivo.**</span><span class="sxs-lookup"><span data-stu-id="20a73-148">**Create playlists on the device.**</span></span> <span data-ttu-id="20a73-149">Um tipo de arquivo que você pode gravar no dispositivo é um arquivo abstrato, que é uma coleção de referências a outros arquivos.</span><span class="sxs-lookup"><span data-stu-id="20a73-149">One kind of file you can write to the device is an abstract file, which is a collection of references to other files.</span></span> <span data-ttu-id="20a73-150">Embora a capacidade de gravar arquivos abstratos em um dispositivo dependa do provedor de serviços e do dispositivo, geralmente somente os dispositivos MTP têm esse recurso.</span><span class="sxs-lookup"><span data-stu-id="20a73-150">Although the ability to write abstract files to a device depends on the service provider and the device, generally only MTP devices have this capability.</span></span> <span data-ttu-id="20a73-151">Para obter mais informações, consulte [criando uma lista de reprodução no dispositivo](creating-a-playlist-on-the-device.md).</span><span class="sxs-lookup"><span data-stu-id="20a73-151">For more information, see [Creating a Playlist on the Device](creating-a-playlist-on-the-device.md).</span></span>

<span data-ttu-id="20a73-152">Além dessas etapas, há vários outros recursos que você pode habilitar em seu aplicativo:</span><span class="sxs-lookup"><span data-stu-id="20a73-152">In addition to these steps, there are several more features that you can enable in your application:</span></span>

-   <span data-ttu-id="20a73-153">**Notificações.**</span><span class="sxs-lookup"><span data-stu-id="20a73-153">**Notifications.**</span></span> <span data-ttu-id="20a73-154">Você pode habilitar seu aplicativo para receber notificações quando os dispositivos se conectarem ou desconectarem do computador.</span><span class="sxs-lookup"><span data-stu-id="20a73-154">You can enable your application to receive notifications when devices connect or disconnect from the computer.</span></span> <span data-ttu-id="20a73-155">Para obter mais informações, consulte [habilitando notificações](enabling-notifications.md).</span><span class="sxs-lookup"><span data-stu-id="20a73-155">For more information, see [Enabling Notifications](enabling-notifications.md).</span></span>
-   <span data-ttu-id="20a73-156">**Logout.**</span><span class="sxs-lookup"><span data-stu-id="20a73-156">**Logging.**</span></span> <span data-ttu-id="20a73-157">O Windows Media Gerenciador de Dispositivos usa um objeto de log que salva um registro de suas ações em um arquivo de texto local.</span><span class="sxs-lookup"><span data-stu-id="20a73-157">Windows Media Device Manager uses a logging object that saves a record of its actions to a local text file.</span></span> <span data-ttu-id="20a73-158">Você pode adicionar mensagens a esse log para ajudá-lo a analisar erros ou desempenho em seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="20a73-158">You can add messages to this log to help you analyze errors or performance in your application.</span></span> <span data-ttu-id="20a73-159">Para obter mais informações, consulte [habilitando o log](enabling-logging.md).</span><span class="sxs-lookup"><span data-stu-id="20a73-159">For more information, see [Enabling Logging](enabling-logging.md).</span></span>
-   <span data-ttu-id="20a73-160">**Medição do uso de conteúdo.**</span><span class="sxs-lookup"><span data-stu-id="20a73-160">**Metering content usage.**</span></span> <span data-ttu-id="20a73-161">Você pode recuperar estatísticas de uso de conteúdo para licenças que concedem esse direito.</span><span class="sxs-lookup"><span data-stu-id="20a73-161">You can retrieve content usage statistics for licenses that grant this right.</span></span> <span data-ttu-id="20a73-162">Essas estatísticas podem então ser enviadas para um servidor Web para calcular pagamentos de royalties para proprietários de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="20a73-162">These statistics can then be sent up to a Web server to calculate royalty payments to content owners.</span></span> <span data-ttu-id="20a73-163">Para obter mais informações, consulte [medição do uso de conteúdo](metering-content-usage.md).</span><span class="sxs-lookup"><span data-stu-id="20a73-163">For more information, see [Metering Content Usage](metering-content-usage.md).</span></span>

<span data-ttu-id="20a73-164">**Uma observação de cuidado**</span><span class="sxs-lookup"><span data-stu-id="20a73-164">**A note of caution**</span></span>

<span data-ttu-id="20a73-165">Seu aplicativo pode precisar trabalhar com uma variedade de dispositivos, incluindo alguns que você não desenvolveu e nunca testou seu código.</span><span class="sxs-lookup"><span data-stu-id="20a73-165">Your application may need to work with a variety of devices, including some that you have not developed and have never tested your code against.</span></span> <span data-ttu-id="20a73-166">Esses dispositivos podem ou não responder com precisão a consultas e comandos, ou implementar MTP ou outras especificações.</span><span class="sxs-lookup"><span data-stu-id="20a73-166">These devices might or might not accurately respond to queries and commands, or implement MTP or other specifications.</span></span> <span data-ttu-id="20a73-167">Certifique-se de incluir a verificação de erros robusta e a funcionalidade de fallback para lidar com o inesperado.</span><span class="sxs-lookup"><span data-stu-id="20a73-167">Be sure to include robust error checking and fallback functionality to deal with the unexpected.</span></span> <span data-ttu-id="20a73-168">Programa de defesa.</span><span class="sxs-lookup"><span data-stu-id="20a73-168">Program defensively.</span></span>

## <a name="related-topics"></a><span data-ttu-id="20a73-169">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="20a73-169">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="20a73-170">**Guia de programação**</span><span class="sxs-lookup"><span data-stu-id="20a73-170">**Programming Guide**</span></span>](programming-guide.md)
</dt> </dl>

 

 




