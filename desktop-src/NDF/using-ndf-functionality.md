---
title: Usando a funcionalidade NDF
description: A Microsoft fornece acesso à funcionalidade NDF por meio de uma API pública. Quando ocorre um problema, o aplicativo pode usar essa API para aproveitar essa funcionalidade dentro do contexto de um aplicativo específico.
ms.assetid: db06b9a9-a64a-43ff-9b77-95230208cfd6
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5ca74a8a80f7babca75182625ec71dc1ec47cbc7
ms.sourcegitcommit: c9c66a09eeb9e46311879a5181342e89964c1dd8
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/10/2020
ms.locfileid: "104365817"
---
# <a name="using-ndf-functionality"></a><span data-ttu-id="59b33-104">Usando a funcionalidade NDF</span><span class="sxs-lookup"><span data-stu-id="59b33-104">Using NDF Functionality</span></span>

<span data-ttu-id="59b33-105">A Microsoft fornece acesso à funcionalidade NDF por meio de uma API pública.</span><span class="sxs-lookup"><span data-stu-id="59b33-105">Microsoft provides access to NDF functionality through a public API.</span></span> <span data-ttu-id="59b33-106">Quando ocorre um problema, o aplicativo pode usar essa API para aproveitar essa funcionalidade dentro do contexto de um aplicativo específico.</span><span class="sxs-lookup"><span data-stu-id="59b33-106">When a problem occurs, the application can use this API to leverage this functionality within the context of a specific application.</span></span>

<span data-ttu-id="59b33-107">Há três estágios de executar o diagnóstico com o NDF: Criando um incidente, executando o diagnóstico e os reparos e fechando o incidente.</span><span class="sxs-lookup"><span data-stu-id="59b33-107">There are three stages of performing diagnosis with NDF: creating an incident, running diagnosis and repairs, and closing the incident.</span></span> <span data-ttu-id="59b33-108">Esta visão geral indica quais funções NDF podem ser relevantes para um cenário específico.</span><span class="sxs-lookup"><span data-stu-id="59b33-108">This overview indicates which NDF functions may be relevant for a specific scenario.</span></span> <span data-ttu-id="59b33-109">Informações detalhadas sobre cada função podem ser encontradas na seção de [referência do NDF](ndf-reference.md) .</span><span class="sxs-lookup"><span data-stu-id="59b33-109">Detailed information on each function can be found in the [NDF Reference](ndf-reference.md) section.</span></span>

## <a name="creating-an-incident"></a><span data-ttu-id="59b33-110">Criando um incidente</span><span class="sxs-lookup"><span data-stu-id="59b33-110">Creating an Incident</span></span>

<span data-ttu-id="59b33-111">Uma sessão de diagnóstico NDF requer um incidente específico para diagnosticar.</span><span class="sxs-lookup"><span data-stu-id="59b33-111">An NDF diagnostics session requires a specific incident to diagnose.</span></span> <span data-ttu-id="59b33-112">Há várias funções que podem ser usadas para criar um incidente.</span><span class="sxs-lookup"><span data-stu-id="59b33-112">There are several functions which can be used to create an incident.</span></span> <span data-ttu-id="59b33-113">Escolha a função que mais se aproximará do que o aplicativo estava tentando fazer quando a falha ocorreu.</span><span class="sxs-lookup"><span data-stu-id="59b33-113">Choose the function which most closely matches what the application was trying to do when the failure occurred.</span></span>

-   <span data-ttu-id="59b33-114">[**NdfCreateConnectivityIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateconnectivityincident): problemas gerais de conectividade com a Internet que não precisam de informações adicionais.</span><span class="sxs-lookup"><span data-stu-id="59b33-114">[**NdfCreateConnectivityIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateconnectivityincident): General Internet connectivity problems which do not need additional information.</span></span>
-   <span data-ttu-id="59b33-115">[**NdfCreateWebIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincident) / [**NdfCreateWebIncidentEx**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincidentex): conectando-se a uma URL http ou HTTPS.</span><span class="sxs-lookup"><span data-stu-id="59b33-115">[**NdfCreateWebIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincident)/[**NdfCreateWebIncidentEx**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewebincidentex): Connecting to an HTTP or HTTPS URL.</span></span>
-   <span data-ttu-id="59b33-116">[**NdfCreateSharingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatesharingincident): acessando um caminho UNC ou compartilhamento de arquivos.</span><span class="sxs-lookup"><span data-stu-id="59b33-116">[**NdfCreateSharingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatesharingincident): Accessing a UNC path or file share.</span></span>
-   <span data-ttu-id="59b33-117">[**NdfCreateDNSIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatednsincident): resolvendo um nome de host DNS.</span><span class="sxs-lookup"><span data-stu-id="59b33-117">[**NdfCreateDNSIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatednsincident): Resolving a DNS host name.</span></span>
-   <span data-ttu-id="59b33-118">[**NdfCreatePnrpIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatepnrpincident): resolvendo um nome de par PNRP.</span><span class="sxs-lookup"><span data-stu-id="59b33-118">[**NdfCreatePnrpIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatepnrpincident): Resolving a PNRP peer name.</span></span>
-   <span data-ttu-id="59b33-119">[**NdfCreateGroupingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreategroupingincident): Ingressando em um grupo ponto a ponto.</span><span class="sxs-lookup"><span data-stu-id="59b33-119">[**NdfCreateGroupingIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreategroupingincident): Joining a peer-to-peer group.</span></span>
-   <span data-ttu-id="59b33-120">[**NdfCreateWinSockIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewinsockincident): conectando-se a um destino usando um soquete (quando nenhuma das outras funções se aplicam especificamente).</span><span class="sxs-lookup"><span data-stu-id="59b33-120">[**NdfCreateWinSockIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreatewinsockincident): Connecting to a destination by using a socket (when none of the other functions specifically apply).</span></span>
-   <span data-ttu-id="59b33-121">[**NdfCreateIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateincident): usado quando nenhum outro cenário é apropriado e a classe auxiliar NDF específica a ser invocada é conhecida (juntamente com os argumentos necessários).</span><span class="sxs-lookup"><span data-stu-id="59b33-121">[**NdfCreateIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcreateincident): Used when no other scenario is appropriate and the specific NDF helper class to be invoked is known (along with the arguments it requires).</span></span> <span data-ttu-id="59b33-122">Usado principalmente para fins de teste por desenvolvedores de aplicativos que escreveram sua própria classe auxiliar.</span><span class="sxs-lookup"><span data-stu-id="59b33-122">Primarily used for testing purposes by application developers who have written their own helper class.</span></span>

## <a name="running-diagnosis-and-repairs"></a><span data-ttu-id="59b33-123">Executando diagnóstico e reparos</span><span class="sxs-lookup"><span data-stu-id="59b33-123">Running Diagnosis and Repairs</span></span>

<span data-ttu-id="59b33-124">Há duas maneiras de iniciar a funcionalidade de diagnóstico e reparo.</span><span class="sxs-lookup"><span data-stu-id="59b33-124">There are two ways to launch the diagnosis and repair functionality.</span></span>

-   <span data-ttu-id="59b33-125">Usando a interface do usuário do Windows (recomendado)</span><span class="sxs-lookup"><span data-stu-id="59b33-125">Using the Windows User Interface (Recommended)</span></span>

    <span data-ttu-id="59b33-126">Ao executar na interface do usuário padrão do Windows, você pode simplesmente chamar a função [**NdfExecuteDiagnosis**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfexecutediagnosis) .</span><span class="sxs-lookup"><span data-stu-id="59b33-126">When running in the standard Windows user interface, you can simply call the [**NdfExecuteDiagnosis**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfexecutediagnosis) function.</span></span> <span data-ttu-id="59b33-127">O assistente do NDF será iniciado e ajudará o usuário a identificar (e se possível, e resolver) o problema.</span><span class="sxs-lookup"><span data-stu-id="59b33-127">The NDF Wizard will launch and assist the user in identifying (and if possible, and resolving) the problem.</span></span> <span data-ttu-id="59b33-128">A função retornará após a conclusão desse processo.</span><span class="sxs-lookup"><span data-stu-id="59b33-128">The function will return after this process has finished.</span></span> <span data-ttu-id="59b33-129">A interface do usuário é opcionalmente modal para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="59b33-129">The user interface is optionally modal to your application.</span></span>

-   <span data-ttu-id="59b33-130">Usando uma interface do usuário personalizada (somente Windows 7 e posterior)</span><span class="sxs-lookup"><span data-stu-id="59b33-130">Using a Custom User Interface (Windows 7 and later only)</span></span>

    <span data-ttu-id="59b33-131">Funções diferentes estão disponíveis para uso em cenários em que nenhuma interface do usuário está sendo mostrada, ou onde a experiência padrão do Windows não está sendo usada (como o Media Center, aplicativos inseridos e o prompt de comando).</span><span class="sxs-lookup"><span data-stu-id="59b33-131">Different functions are available to use in scenarios where no user interface is being shown, or where the standard Windows experience is not being used (such as Media Center, embedded applications, and the command prompt).</span></span> <span data-ttu-id="59b33-132">Essa opção ignora a funcionalidade de experiência do usuário fornecida no assistente do NDF, que inclui a limitação dos resultados a causas raiz totalmente suportadas, bem como a heurística para apresentar os reparos para o usuário na ordem recomendada.</span><span class="sxs-lookup"><span data-stu-id="59b33-132">This option bypasses the user experience functionality provided in the NDF Wizard, which includes limiting the results to fully-supported root causes, as well as heuristics to present repairs to the user in recommended order.</span></span> <span data-ttu-id="59b33-133">Ao usar essas funções, você mesmo deve fornecer qualquer funcionalidade desse tipo.</span><span class="sxs-lookup"><span data-stu-id="59b33-133">When using these functions, you must provide any such functionality yourself.</span></span> <span data-ttu-id="59b33-134">Você também deve se certificar de liberar a memória usada pelos resultados do diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="59b33-134">You must also make sure to free memory used by the diagnosis results.</span></span>

    <span data-ttu-id="59b33-135">Para iniciar o diagnóstico, chame a função [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) .</span><span class="sxs-lookup"><span data-stu-id="59b33-135">To begin diagnosis, call the [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) function.</span></span> <span data-ttu-id="59b33-136">Todos os problemas encontrados serão retornados ao aplicativo como uma coleção de estruturas [**RootCauseInfo**](/windows/win32/api/ndattrib/ns-ndattrib-rootcauseinfo) descrevendo as causas raiz identificadas e os possíveis reparos.</span><span class="sxs-lookup"><span data-stu-id="59b33-136">Any problems found will be returned to the application as a collection of [**RootCauseInfo**](/windows/win32/api/ndattrib/ns-ndattrib-rootcauseinfo) structures describing identified root causes and possible repairs.</span></span>

    <span data-ttu-id="59b33-137">Depois de selecionar um reparo (ou pedir que o usuário selecione um reparo), [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) deve ser chamado para tentar o reparo e determinar se o problema foi resolvido.</span><span class="sxs-lookup"><span data-stu-id="59b33-137">After selecting a repair (or asking the user to select a repair), [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) should be called to attempt the repair and determine whether the problem was resolved.</span></span>

    <span data-ttu-id="59b33-138">Em alguns casos, um reparo pode ser executado com êxito, mas não resolverá o problema.</span><span class="sxs-lookup"><span data-stu-id="59b33-138">In some cases, a repair may be successfully performed but will not resolve the problem.</span></span> <span data-ttu-id="59b33-139">Nesses casos, é recomendável fechar o incidente existente e abrir um novo.</span><span class="sxs-lookup"><span data-stu-id="59b33-139">In such cases, closing the existing incident and then opening a new one is recommended.</span></span> <span data-ttu-id="59b33-140">Isso garantirá que todos os novos problemas desmascarados pelo reparo inicial sejam identificados.</span><span class="sxs-lookup"><span data-stu-id="59b33-140">This will ensure that any new problems unmasked by the initial repair are identified.</span></span> <span data-ttu-id="59b33-141">Por exemplo, suponha que nenhuma rede sem fio tenha sido visível.</span><span class="sxs-lookup"><span data-stu-id="59b33-141">For example, suppose that no wireless networks had been visible.</span></span> <span data-ttu-id="59b33-142">Depois de redefinir o adaptador, as redes sem fio ficam visíveis, mas nenhuma delas está na lista preferencial.</span><span class="sxs-lookup"><span data-stu-id="59b33-142">After resetting the adapter, wireless networks are visible, but none of them are on the preferred list.</span></span> <span data-ttu-id="59b33-143">Esse é um novo problema que exigiria que um novo diagnóstico fosse identificado.</span><span class="sxs-lookup"><span data-stu-id="59b33-143">This is a new problem that would require a new diagnosis to identify.</span></span> <span data-ttu-id="59b33-144">Se uma segunda tentativa de diagnóstico não identificar problemas adicionais, um reparo diferente poderá ser tentado para resolver o problema original ou o usuário poderá ser informado de que o problema não pôde ser resolvido.</span><span class="sxs-lookup"><span data-stu-id="59b33-144">If such a second diagnosis attempt does not identify additional problems, a different repair can be attempted to resolve the original issue, or the user can be informed that the problem could not be resolved.</span></span>

    <span data-ttu-id="59b33-145">[**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) e [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) são APIs síncronas.</span><span class="sxs-lookup"><span data-stu-id="59b33-145">[**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident) and [**NdfRepairIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfrepairincident) are synchronous APIs.</span></span> <span data-ttu-id="59b33-146">Se você quiser cancelar a atividade iniciada por essas funções, chame [**NdfCancelIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcancelincident) de outro thread.</span><span class="sxs-lookup"><span data-stu-id="59b33-146">If you wish to cancel activity initiated by these functions, call [**NdfCancelIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcancelincident) from another thread.</span></span> <span data-ttu-id="59b33-147">A função retornará no próximo ponto de interrupção disponível no processo de diagnóstico ou reparo.</span><span class="sxs-lookup"><span data-stu-id="59b33-147">The function will return at the next available stopping point in the diagnosis or repair process.</span></span>

    <span data-ttu-id="59b33-148">A qualquer momento, você pode, opcionalmente, chamar [**NdfGetTraceFile**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfgettracefile) para recuperar uma cópia do log NDF para a sessão de diagnóstico atual e incluí-la com os logs do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="59b33-148">At any point, you may optionally call [**NdfGetTraceFile**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfgettracefile) to retrieve a copy of the NDF log for the current diagnosis session and include it with your application logs.</span></span> <span data-ttu-id="59b33-149">O log é liberado após a recuperação, e as chamadas subsequentes só recuperarão os eventos que ocorreram após a última chamada para essa função.</span><span class="sxs-lookup"><span data-stu-id="59b33-149">The log is flushed once retrieved, and subsequent calls will only retrieve events which occurred after the last call to this function.</span></span>

## <a name="closing-an-incident"></a><span data-ttu-id="59b33-150">Fechando um incidente</span><span class="sxs-lookup"><span data-stu-id="59b33-150">Closing an Incident</span></span>

<span data-ttu-id="59b33-151">Quando você terminar de diagnosticar um incidente, chame [**NdfCloseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcloseincident) para liberar recursos do sistema associados à execução de diagnósticos nesse incidente.</span><span class="sxs-lookup"><span data-stu-id="59b33-151">When you are finished diagnosing an incident, call [**NdfCloseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfcloseincident) to free system resources associated with performing diagnostics on that incident.</span></span> <span data-ttu-id="59b33-152">(Observe que isso não libera objetos criados pelo [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident).</span><span class="sxs-lookup"><span data-stu-id="59b33-152">(Note that this does not free objects created by [**NdfDiagnoseIncident**](/windows/desktop/api/Ndfapi/nf-ndfapi-ndfdiagnoseincident).</span></span>
