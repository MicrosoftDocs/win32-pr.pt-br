---
title: Usando o Netsh para gerenciar rastreamentos
description: No Windows 7, netsh.exe pode ser usado em um prompt de comando para habilitar e configurar rastreamentos de rede. Esta seção descreve alguns dos comandos netsh.exe que podem ajudar na solução de problemas de rastreamento, incluindo a nova funcionalidade de rastreamento netsh.
ms.assetid: f0f0fc7b-7cfa-43c7-89a3-3b80050875f8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0c1cf869f60b69e227e78e19e8e05d3765ddb67d
ms.sourcegitcommit: b32433cc0394159c7263809ae67615ab5792d40d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/30/2021
ms.locfileid: "113119021"
---
# <a name="using-netsh-to-manage-traces"></a><span data-ttu-id="6e86d-104">Usando o Netsh para gerenciar rastreamentos</span><span class="sxs-lookup"><span data-stu-id="6e86d-104">Using Netsh to Manage Traces</span></span>

<span data-ttu-id="6e86d-105">No Windows 7, netsh.exe pode ser usado em um prompt de comando para habilitar e configurar rastreamentos de rede.</span><span class="sxs-lookup"><span data-stu-id="6e86d-105">In Windows 7, netsh.exe can be used from a command prompt to enable and configure network traces.</span></span> <span data-ttu-id="6e86d-106">Esta seção descreve alguns dos comandos netsh.exe que podem ajudar na solução de problemas de rastreamento, incluindo a nova **funcionalidade de rastreamento netsh.**</span><span class="sxs-lookup"><span data-stu-id="6e86d-106">This section describes some of the netsh.exe commands which can help in troubleshooting tracing issues, including the new **netsh trace** functionality.</span></span> <span data-ttu-id="6e86d-107">Observe que os comandos netsh devem ser executados em um prompt de comando com elevação.</span><span class="sxs-lookup"><span data-stu-id="6e86d-107">Note that the netsh commands must be run from an elevated command prompt.</span></span>

## <a name="collecting-traces"></a><span data-ttu-id="6e86d-108">Coletando rastreamentos</span><span class="sxs-lookup"><span data-stu-id="6e86d-108">Collecting traces</span></span>

<span data-ttu-id="6e86d-109">Os cenários são conjuntos predefinidos de provedores de rastreamento que podem ser habilitados para solução de problemas.</span><span class="sxs-lookup"><span data-stu-id="6e86d-109">Scenarios are predefined sets of trace providers which can be enabled for troubleshooting.</span></span> <span data-ttu-id="6e86d-110">Para exibir a lista de cenários disponíveis relacionados à rede, digite **cenários netsh trace show** **(provedores netsh trace show** lista cada um dos provedores disponíveis, incluindo aqueles que não são relevantes para a rede).</span><span class="sxs-lookup"><span data-stu-id="6e86d-110">To display the list of available network-related scenarios, type **netsh trace show scenarios** (**netsh trace show providers** lists every one of the available providers, including ones that are not relevant to networking).</span></span>

<span data-ttu-id="6e86d-111">Quando você identificar um cenário que parece relevante para seus problemas, poderá ver uma lista de todos os provedores incluídos nesse cenário.</span><span class="sxs-lookup"><span data-stu-id="6e86d-111">When you have identified a scenario that looks relevant to your issues, you can see a list of all of the providers included in that scenario.</span></span> <span data-ttu-id="6e86d-112">Por exemplo, para ver todos os provedores habilitados no cenário InternetClient, digite **netsh trace show scenario internetclient**.</span><span class="sxs-lookup"><span data-stu-id="6e86d-112">For example, to see all of the providers enabled under the InternetClient scenario, type **netsh trace show scenario internetclient**.</span></span>

<span data-ttu-id="6e86d-113">Você pode iniciar um rastreamento para todos os provedores em um determinado cenário ou conjunto de cenários.</span><span class="sxs-lookup"><span data-stu-id="6e86d-113">You can start a trace for all of the providers in a given scenario or set of scenarios.</span></span> <span data-ttu-id="6e86d-114">Por exemplo, para iniciar um rastreamento para todos os provedores habilitados no cenário InternetClient, digite **netsh trace start scenario=internetclient**.</span><span class="sxs-lookup"><span data-stu-id="6e86d-114">For example, to start a trace for all of the providers enabled under the InternetClient scenario, type **netsh trace start scenario=internetclient**.</span></span> <span data-ttu-id="6e86d-115">Para capturar provedores para mais de um cenário, você pode especificar todos os cenários apropriados, como **netsh trace start scenario=FileSharing scenario=DirectAccess**.</span><span class="sxs-lookup"><span data-stu-id="6e86d-115">To capture providers for more than one scenario, you can specify all of the appropriate scenarios, such as **netsh trace start scenario=FileSharing scenario=DirectAccess**.</span></span> <span data-ttu-id="6e86d-116">Observe que apenas uma sessão de rastreamento pode ser habilitada por vez; Não é possível capturar simultaneamente informações de rastreamento de diferentes conjuntos de provedores em arquivos separados.</span><span class="sxs-lookup"><span data-stu-id="6e86d-116">Note that only one tracing session may be enabled at a time; it is not possible to simultaneously capture trace information from different sets of providers in separate files.</span></span>

<span data-ttu-id="6e86d-117">Você também pode iniciar um rastreamento para provedores adicionais não incluídos nesse cenário específico.</span><span class="sxs-lookup"><span data-stu-id="6e86d-117">You can also start a trace for additional providers not included in that particular scenario.</span></span> <span data-ttu-id="6e86d-118">Por exemplo, talvez você queira iniciar rastreamentos para todos os provedores habilitados no cenário WLAN e também o provedor DHCP.</span><span class="sxs-lookup"><span data-stu-id="6e86d-118">For example, you might want to start traces for all of the providers enabled under the WLAN scenario and also the DHCP provider.</span></span> <span data-ttu-id="6e86d-119">Para fazer isso, digite **netsh trace start scenario=wlan provider=Microsoft-Windows-Dhcp-Client**.</span><span class="sxs-lookup"><span data-stu-id="6e86d-119">To do this, type **netsh trace start scenario=wlan provider=Microsoft-Windows-Dhcp-Client**.</span></span>

<span data-ttu-id="6e86d-120">Você também pode ver mais detalhes sobre um provedor específico digitando **netsh trace show provider** seguido pelo nome do provedor.</span><span class="sxs-lookup"><span data-stu-id="6e86d-120">You can also see more details about a specific provider by typing **netsh trace show provider** followed by the provider name.</span></span>

<span data-ttu-id="6e86d-121">Para ver todas as opções e filtros disponíveis, digite **netsh trace start /?**.</span><span class="sxs-lookup"><span data-stu-id="6e86d-121">To see all of the options and filters available you can type **netsh trace start /?**.</span></span>

<span data-ttu-id="6e86d-122">Para interromper o rastreamento, digite **netsh trace stop**.</span><span class="sxs-lookup"><span data-stu-id="6e86d-122">To stop tracing, type **netsh trace stop**.</span></span>

## <a name="using-the-output-files"></a><span data-ttu-id="6e86d-123">Usando os arquivos de saída</span><span class="sxs-lookup"><span data-stu-id="6e86d-123">Using the output files</span></span>

<span data-ttu-id="6e86d-124">Quando o rastreamento é interrompido, dois arquivos são gerados por padrão: um arquivo ETL (Log de Rastreamento de Eventos) e um .cab arquivo.</span><span class="sxs-lookup"><span data-stu-id="6e86d-124">When tracing is stopped, two files are generated by default: an Event Trace Log (ETL) file and a .cab file.</span></span>

<span data-ttu-id="6e86d-125">Os eventos de rastreamento são coletados no arquivo ETL, que pode ser exibido usando ferramentas como Monitor de Rede.</span><span class="sxs-lookup"><span data-stu-id="6e86d-125">Trace events are collected in the ETL file, which can be viewed using tools such as Network Monitor.</span></span> <span data-ttu-id="6e86d-126">O arquivo ETL será nomeado nettrace.etl por padrão ou você poderá especificar um nome diferente incluindo **tracefile=filename.etl** ao iniciar o rastreamento.</span><span class="sxs-lookup"><span data-stu-id="6e86d-126">The ETL file will be named nettrace.etl by default, or you can specify a different name by including **tracefile=filename.etl** when starting the trace.</span></span>

<span data-ttu-id="6e86d-127">O .cab arquivo contém informações sofisticadas sobre o software e o hardware no sistema, como as informações de adaptador, build, sistema operacional e configurações sem fio.</span><span class="sxs-lookup"><span data-stu-id="6e86d-127">The .cab file contains rich information about the software and hardware on the system such as the adapter information, build, operating system, and wireless settings.</span></span> <span data-ttu-id="6e86d-128">O .cab será nomeado como nettrace.cab por padrão, a menos que outro nome tenha sido especificado, conforme indicado acima.</span><span class="sxs-lookup"><span data-stu-id="6e86d-128">The .cab file will be named nettrace.cab by default, unless another name was specified as indicated above.</span></span>

<span data-ttu-id="6e86d-129">Esse .cab arquivo conterá dois arquivos, que sempre terão o mesmo nome.</span><span class="sxs-lookup"><span data-stu-id="6e86d-129">This .cab file will contain two files, which will always have the same name.</span></span> <span data-ttu-id="6e86d-130">Report.etl é outra cópia das mesmas informações incluídas em nettrace.etl.</span><span class="sxs-lookup"><span data-stu-id="6e86d-130">Report.etl is another copy of the same information included in nettrace.etl.</span></span> <span data-ttu-id="6e86d-131">O report.html inclui informações adicionais sobre os eventos de rastreamento e as outras informações coletadas.</span><span class="sxs-lookup"><span data-stu-id="6e86d-131">The report.html file includes additional information about the trace events and the other information collected.</span></span> <span data-ttu-id="6e86d-132">Para receber os detalhes mais disponíveis, inclua o relatório de **comando = sim** ao iniciar um rastreamento.</span><span class="sxs-lookup"><span data-stu-id="6e86d-132">To receive the most details available, include the command **report = yes** when starting a trace.</span></span>

## <a name="using-filters-to-reduce-the-amount-of-data-in-the-etl-trace-file"></a><span data-ttu-id="6e86d-133">Usando filtros para reduzir a quantidade de dados no arquivo de rastreamento ETL</span><span class="sxs-lookup"><span data-stu-id="6e86d-133">Using filters to reduce the amount of data in the ETL trace file</span></span>

<span data-ttu-id="6e86d-134">Quando as capturas ocorrem por um longo período de tempo, o arquivo de rastreamento de ETL pode se tornar muito grande.</span><span class="sxs-lookup"><span data-stu-id="6e86d-134">When captures happen over a long period of time, the ETL trace file can become very large.</span></span> <span data-ttu-id="6e86d-135">Em cenários em que vários provedores estão habilitados, resultando em alto tráfego, as restrições de buffer ETW podem fazer com que alguns rastreamentos sejam descartados.</span><span class="sxs-lookup"><span data-stu-id="6e86d-135">In scenarios where multiple providers are enabled, resulting in high traffic, ETW buffer constraints may cause some traces to be dropped.</span></span> <span data-ttu-id="6e86d-136">Além dessa consideração, reduzir a quantidade de dados no arquivo de rastreamento de ETL pode ajudar a facilitar a solução de problemas, reduzindo a quantidade de dados a ser revisada.</span><span class="sxs-lookup"><span data-stu-id="6e86d-136">Aside from this consideration, reducing the amount of data in the ETL trace file can help make troubleshooting easier by reducing the amount of data to review.</span></span>

<span data-ttu-id="6e86d-137">Os filtros de rastreamento netsh podem ser usados para reduzir o tamanho do arquivo de rastreamento de ETL.</span><span class="sxs-lookup"><span data-stu-id="6e86d-137">Netsh trace filters can be used to reduce the ETL trace file size.</span></span> <span data-ttu-id="6e86d-138">Esses filtros de rastreamento são níveis ETW e palavras-chave que podem ser aplicados a provedores individuais.</span><span class="sxs-lookup"><span data-stu-id="6e86d-138">These trace filters are ETW levels and keywords that can be applied to individual providers.</span></span>

<span data-ttu-id="6e86d-139">Para ver uma lista de filtros que podem ser aplicados, digite **netsh trace start /?**</span><span class="sxs-lookup"><span data-stu-id="6e86d-139">To see a list of filters which can be applied, type **netsh trace start /?**</span></span>

<span data-ttu-id="6e86d-140">Um exemplo de um filtro é **netsh trace start InternetClient provider=Microsoft-Windows-TCPIP level=5 keywords=ut:ReceivePath,ut:SendPath**.</span><span class="sxs-lookup"><span data-stu-id="6e86d-140">An example of a filter is **netsh trace start InternetClient provider=Microsoft-Windows-TCPIP level=5 keywords=ut:ReceivePath,ut:SendPath**.</span></span>

<span data-ttu-id="6e86d-141">Neste exemplo, o nível é definido como 5, o que significa que o número máximo de eventos será mostrado.</span><span class="sxs-lookup"><span data-stu-id="6e86d-141">In this example, the level is set to 5, which means that the maximum number of events will be shown.</span></span> <span data-ttu-id="6e86d-142">A tabela a seguir mostra as configurações disponíveis:</span><span class="sxs-lookup"><span data-stu-id="6e86d-142">The following table shows the settings available:</span></span>



| <span data-ttu-id="6e86d-143">Level</span><span class="sxs-lookup"><span data-stu-id="6e86d-143">Level</span></span>      | <span data-ttu-id="6e86d-144">Configuração</span><span class="sxs-lookup"><span data-stu-id="6e86d-144">Setting</span></span>              | <span data-ttu-id="6e86d-145">Descrição</span><span class="sxs-lookup"><span data-stu-id="6e86d-145">Description</span></span>                                                                           |
|-------|---------------|----------------------------------------------------------------------------|
| <span data-ttu-id="6e86d-146">1</span><span class="sxs-lookup"><span data-stu-id="6e86d-146">1</span></span>     | <span data-ttu-id="6e86d-147">Crítico</span><span class="sxs-lookup"><span data-stu-id="6e86d-147">Critical</span></span>      | <span data-ttu-id="6e86d-148">Somente eventos críticos serão mostrados.</span><span class="sxs-lookup"><span data-stu-id="6e86d-148">Only critical events will be shown.</span></span>                                        |
| <span data-ttu-id="6e86d-149">2</span><span class="sxs-lookup"><span data-stu-id="6e86d-149">2</span></span>     | <span data-ttu-id="6e86d-150">Errors</span><span class="sxs-lookup"><span data-stu-id="6e86d-150">Errors</span></span>        | <span data-ttu-id="6e86d-151">Eventos críticos e erros serão mostrados.</span><span class="sxs-lookup"><span data-stu-id="6e86d-151">Critical events and errors will be shown.</span></span>                                  |
| <span data-ttu-id="6e86d-152">3</span><span class="sxs-lookup"><span data-stu-id="6e86d-152">3</span></span>     | <span data-ttu-id="6e86d-153">Warnings</span><span class="sxs-lookup"><span data-stu-id="6e86d-153">Warnings</span></span>      | <span data-ttu-id="6e86d-154">Eventos críticos, erros e avisos serão mostrados.</span><span class="sxs-lookup"><span data-stu-id="6e86d-154">Critical events, errors, and warnings will be shown.</span></span>                       |
| <span data-ttu-id="6e86d-155">4</span><span class="sxs-lookup"><span data-stu-id="6e86d-155">4</span></span>     | <span data-ttu-id="6e86d-156">Informativo</span><span class="sxs-lookup"><span data-stu-id="6e86d-156">Informational</span></span> | <span data-ttu-id="6e86d-157">Eventos críticos, erros, avisos e eventos informacionais serão mostrados.</span><span class="sxs-lookup"><span data-stu-id="6e86d-157">Critical events, errors, warnings, and informational events will be shown.</span></span> |
| <span data-ttu-id="6e86d-158">5</span><span class="sxs-lookup"><span data-stu-id="6e86d-158">5</span></span>     | <span data-ttu-id="6e86d-159">Detalhado</span><span class="sxs-lookup"><span data-stu-id="6e86d-159">Verbose</span></span>       | <span data-ttu-id="6e86d-160">Todos os eventos serão mostrados.</span><span class="sxs-lookup"><span data-stu-id="6e86d-160">All events will be shown.</span></span>                                                  |



 

<span data-ttu-id="6e86d-161">As **palavras-chave ut:ReceivePath** e **ut:SentPath** filtram os eventos para mostrar somente os eventos rastreados no caminho de recebimento ou envio.</span><span class="sxs-lookup"><span data-stu-id="6e86d-161">The keywords **ut:ReceivePath** and **ut:SentPath** filters the events to show only those events traced on the receive or send path.</span></span> <span data-ttu-id="6e86d-162">Uma lista completa de palavras-chave para um provedor específico pode ser encontrada digitando **netsh trace show provider** seguido pelo nome do provedor.</span><span class="sxs-lookup"><span data-stu-id="6e86d-162">A complete list of keywords for a specific provider can be found by typing **netsh trace show provider** followed by the provider name.</span></span> <span data-ttu-id="6e86d-163">Por exemplo, digitar **netsh trace show provider Microsoft-Windows-TCPIP** exibirá informações sobre o provedor Microsoft-Windows-TCPIP, incluindo uma lista de palavras-chave.</span><span class="sxs-lookup"><span data-stu-id="6e86d-163">For example, typing **netsh trace show provider Microsoft-Windows-TCPIP** will display information about the Microsoft-Windows-TCPIP provider, including a list of keywords.</span></span>

<span data-ttu-id="6e86d-164">O Netsh também dá suporte à funcionalidade de filtragem de pacotes (semelhante ao Monitor de Rede) quando a captura de pacotes está 100000001(captura **de configuração = sim).**</span><span class="sxs-lookup"><span data-stu-id="6e86d-164">Netsh also supports packet filtering capability (similar to Network Monitor) when packet capturing is turned on (by setting **capture = yes**).</span></span> <span data-ttu-id="6e86d-165">A filtragem de pacotes pode ser usada para capturar um número limitado de pacotes em um arquivo de rastreamento.</span><span class="sxs-lookup"><span data-stu-id="6e86d-165">Packet filtering can be used to capture a limited number of packets in a trace file.</span></span> <span data-ttu-id="6e86d-166">Por exemplo, **netsh trace start capture = yes ipv4.address == x.x.x.x.x** , em que x.x.x.x é o endereço IP, apenas capturará pacotes com tráfego ipv4 com esse endereço de origem ou destino específico.</span><span class="sxs-lookup"><span data-stu-id="6e86d-166">For example, **netsh trace start capture = yes ipv4.address == x.x.x.x** , where x.x.x.x is the IP address, will only capture packets with ipv4 traffic with that specific source or destination address.</span></span>

<span data-ttu-id="6e86d-167">Para obter informações adicionais sobre como usar a filtragem de pacotes, digite **netsh trace show capturefilterHelp**.</span><span class="sxs-lookup"><span data-stu-id="6e86d-167">For additional information about how to use packet filtering, you can type **netsh trace show capturefilterHelp**.</span></span>

 

 




