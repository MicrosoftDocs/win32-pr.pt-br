---
description: Use o NTFS transacional para manter a integridade dos dados.
ms.assetid: 886d6075-57e8-47db-aec5-77660d0a53f9
title: Quando usar o NTFS Transacional
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 28c0a134a8cb5824337022fedf14fe3db3c6f76c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105783308"
---
# <a name="when-to-use-transactional-ntfs"></a><span data-ttu-id="ddb03-103">Quando usar o NTFS Transacional</span><span class="sxs-lookup"><span data-stu-id="ddb03-103">When to Use Transactional NTFS</span></span>

<span data-ttu-id="ddb03-104">Um aplicativo pode usar o NTFS Transacional (TxF) para preservar a integridade dos dados em disco durante condições de erro inesperadas.</span><span class="sxs-lookup"><span data-stu-id="ddb03-104">An application can use Transactional NTFS (TxF) to preserve the integrity of data on disk during unexpected error conditions.</span></span> <span data-ttu-id="ddb03-105">Em geral, um aplicativo deve considerar o uso do TxF se o aplicativo estiver liberando arquivos e usando outras técnicas para manter a integridade dos dados.</span><span class="sxs-lookup"><span data-stu-id="ddb03-105">In general, an application should consider using TxF if the application is flushing files and using other techniques to maintain data integrity.</span></span> <span data-ttu-id="ddb03-106">O TxF pode executar melhor e simplificar o código de tratamento de erros do aplicativo, aumentando a recuperação e a confiabilidade do erro.</span><span class="sxs-lookup"><span data-stu-id="ddb03-106">TxF can perform better and simplify the application's error handling code while improving error recovery and reliability.</span></span> <span data-ttu-id="ddb03-107">As seções a seguir neste tópico fornecem exemplos de cenários para usar o TxF.</span><span class="sxs-lookup"><span data-stu-id="ddb03-107">The following sections in this topic provide examples of scenarios for you to use TxF.</span></span>

## <a name="updating-a-file"></a><span data-ttu-id="ddb03-108">Atualizando um arquivo</span><span class="sxs-lookup"><span data-stu-id="ddb03-108">Updating a File</span></span>

<span data-ttu-id="ddb03-109">A atualização de um arquivo é uma operação comum e normalmente simples.</span><span class="sxs-lookup"><span data-stu-id="ddb03-109">The updating of a file is a common and typically simple operation.</span></span> <span data-ttu-id="ddb03-110">No entanto, se o sistema ou aplicativo falhar enquanto um aplicativo estiver atualizando informações em um disco, o resultado poderá ser catastrófico, pois os dados do usuário podem ser corrompidos por uma operação de atualização de arquivo parcialmente concluída.</span><span class="sxs-lookup"><span data-stu-id="ddb03-110">However, if the system or application fails while an application is updating information on a disk, the result can be catastrophic, because the user data can be corrupted by a file update operation that is partially completed.</span></span> <span data-ttu-id="ddb03-111">Aplicativos robustos geralmente executam sequências complexas de cópias de arquivos e renomeações de arquivo para garantir que os dados não sejam corrompidos se um sistema falhar.</span><span class="sxs-lookup"><span data-stu-id="ddb03-111">Robust applications often perform complex sequences of file copies and file renames to ensure that data is not corrupted if a system fails.</span></span>

<span data-ttu-id="ddb03-112">O TxF torna simples para um aplicativo proteger as operações de atualização de arquivos contra falhas do sistema ou do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ddb03-112">TxF makes it simple for an application to protect file update operations from system or application failure.</span></span> <span data-ttu-id="ddb03-113">Para atualizar um arquivo com segurança, o aplicativo abre o arquivo no modo transacionado, faz as atualizações necessárias e, em seguida, confirma a transação.</span><span class="sxs-lookup"><span data-stu-id="ddb03-113">To update a file safely, the application opens the file in transacted mode, makes the necessary updates, and then commits the transaction.</span></span> <span data-ttu-id="ddb03-114">Se o sistema ou aplicativo falhar durante a atualização do arquivo, o TxF restaura automaticamente o arquivo para o estado que ele tinha antes do início da atualização do arquivo, o que evita a corrupção do arquivo.</span><span class="sxs-lookup"><span data-stu-id="ddb03-114">If the system or application fails during the file update, then TxF automatically restores the file to the state that it had before the file update began, which avoids file corruption.</span></span>

## <a name="multi-file-updates"></a><span data-ttu-id="ddb03-115">Atualizações de vários arquivos</span><span class="sxs-lookup"><span data-stu-id="ddb03-115">Multi-File Updates</span></span>

<span data-ttu-id="ddb03-116">O TxF é ainda mais importante quando uma única operação lógica afeta vários arquivos.</span><span class="sxs-lookup"><span data-stu-id="ddb03-116">TxF is even more important when a single logical operation affects multiple files.</span></span> <span data-ttu-id="ddb03-117">Por exemplo, se você quiser usar uma ferramenta para renomear uma das páginas HTML ou ASP em um site, uma ferramenta bem projetada também corrigirá todos os links para usar o novo nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="ddb03-117">For example, if you want to use a tool to rename one of the HTML or ASP pages on a website, a well-designed tool would also fix all links to use the new file name.</span></span> <span data-ttu-id="ddb03-118">No entanto, uma falha durante essa operação deixa o site em um estado inconsistente, com alguns dos links que ainda se referem ao nome do arquivo antigo.</span><span class="sxs-lookup"><span data-stu-id="ddb03-118">However, a failure during this operation leaves the website in an inconsistent state, with some of the links still referring to the old file name.</span></span> <span data-ttu-id="ddb03-119">Ao fazer a operação de renomeação de arquivo e o link que está corrigindo a operação de uma única transação, o TxF garante que a correção do arquivo e o link sejam bem-sucedidos ou falhem como uma única operação.</span><span class="sxs-lookup"><span data-stu-id="ddb03-119">By making the file rename operation and the link fixing operation a single transaction, TxF ensures that the file rename and link fix succeed or fail as a single operation.</span></span>

## <a name="consistent-concurrent-updates"></a><span data-ttu-id="ddb03-120">Atualizações simultâneas consistentes</span><span class="sxs-lookup"><span data-stu-id="ddb03-120">Consistent Concurrent Updates</span></span>

<span data-ttu-id="ddb03-121">O TxF isola as transações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="ddb03-121">TxF isolates concurrent transactions.</span></span> <span data-ttu-id="ddb03-122">Se um aplicativo abrir um arquivo para uma leitura transacional enquanto outro aplicativo tiver o mesmo arquivo aberto para uma atualização transacional, o TxF isolará os efeitos das duas transações entre si.</span><span class="sxs-lookup"><span data-stu-id="ddb03-122">If an application opens a file for a transactional read while another application has the same file open for a transactional update, TxF isolates the effects of the two transactions from one another.</span></span> <span data-ttu-id="ddb03-123">Em outras palavras, o leitor transacional sempre exibe uma única versão consistente do arquivo, mesmo que esse arquivo esteja em processo de ser atualizado por outra transação.</span><span class="sxs-lookup"><span data-stu-id="ddb03-123">In other words, the transactional reader always views a single, consistent version of the file, even while that file is in the process of being updated by another transaction.</span></span>

<span data-ttu-id="ddb03-124">Um aplicativo pode usar essa funcionalidade para permitir que os clientes exibam arquivos enquanto outros clientes fazem atualizações.</span><span class="sxs-lookup"><span data-stu-id="ddb03-124">An application can use this functionality to allow customers to view files while other customers make updates.</span></span> <span data-ttu-id="ddb03-125">Por exemplo, um servidor Web transacional pode fornecer uma exibição única e consistente de arquivos enquanto outra ferramenta atualiza esses arquivos simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="ddb03-125">For example, a transactional web server can provide a single, consistent view of files while another tool concurrently updates those files.</span></span>

> [!Note]  
> <span data-ttu-id="ddb03-126">O TxF não oferece suporte a atualizações simultâneas por vários gravadores em transações diferentes.</span><span class="sxs-lookup"><span data-stu-id="ddb03-126">TxF does not support concurrent updates by multiple writers in different transactions.</span></span> <span data-ttu-id="ddb03-127">O TxF dá suporte a apenas um único gravador com vários leitores simultâneos e consistentes.</span><span class="sxs-lookup"><span data-stu-id="ddb03-127">TxF supports only a single writer with multiple concurrent and consistent readers.</span></span>

 

## <a name="coordinating-with-other-transacted-resource-managers"></a><span data-ttu-id="ddb03-128">Coordenando com outros gerenciadores de recursos transacionados</span><span class="sxs-lookup"><span data-stu-id="ddb03-128">Coordinating With Other Transacted Resource Managers</span></span>

<span data-ttu-id="ddb03-129">As transações usadas com sistemas de arquivos transacionados também podem ser usadas com o registro transacionado.</span><span class="sxs-lookup"><span data-stu-id="ddb03-129">Transactions used with transacted file systems may also be used with the transacted registry.</span></span> <span data-ttu-id="ddb03-130">As atualizações no arquivo e no registro são coordenadas com uma única transação.</span><span class="sxs-lookup"><span data-stu-id="ddb03-130">Updates to the file and the registry are coordinated with a single transaction.</span></span>

<span data-ttu-id="ddb03-131">Ao usar transações de [Coordenador de transações distribuídas](/previous-versions/windows/desktop/mscs/distributed-transaction-coordinator) (DTC) ou System. Transactions, as atualizações feitas no SQL, no MSMQ e em outros recursos transacionais podem ser coordenadas com atualizações de arquivo realizadas.</span><span class="sxs-lookup"><span data-stu-id="ddb03-131">By using [Distributed Transaction Coordinator](/previous-versions/windows/desktop/mscs/distributed-transaction-coordinator) (DTC) transactions or System.Transactions, updates made to SQL, MSMQ, and other transactional resources can be coordinated with transacted file updates.</span></span> <span data-ttu-id="ddb03-132">Para obter mais informações, consulte [IKernelTransaction](/previous-versions/windows/desktop/aa344210(v=vs.85))do DTC.</span><span class="sxs-lookup"><span data-stu-id="ddb03-132">For more information, see DTC's [IKernelTransaction](/previous-versions/windows/desktop/aa344210(v=vs.85)).</span></span>

## <a name="unsupported-scenarios"></a><span data-ttu-id="ddb03-133">Cenários sem suporte</span><span class="sxs-lookup"><span data-stu-id="ddb03-133">Unsupported Scenarios</span></span>

<span data-ttu-id="ddb03-134">O TxF não dá suporte aos seguintes cenários de transação:</span><span class="sxs-lookup"><span data-stu-id="ddb03-134">TxF does not support the following transaction scenarios:</span></span>

-   <span data-ttu-id="ddb03-135">Transações em volumes de rede, por exemplo, em compartilhamentos de arquivos.</span><span class="sxs-lookup"><span data-stu-id="ddb03-135">Transactions on network volumes, for example on file shares.</span></span> <span data-ttu-id="ddb03-136">Não há suporte para TxF nos protocolos CIFS/SMB.</span><span class="sxs-lookup"><span data-stu-id="ddb03-136">TxF is not supported by the CIFS/SMB protocols.</span></span>
-   <span data-ttu-id="ddb03-137">Transações em qualquer sistema de arquivos que não sejam NTFS.</span><span class="sxs-lookup"><span data-stu-id="ddb03-137">Transactions on any file system other than NTFS.</span></span>
-   <span data-ttu-id="ddb03-138">Operações transacionadas em arquivos armazenados em cache pelo armazenamento em cache do lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="ddb03-138">Transacted operations against files cached by client-side caching.</span></span>
-   <span data-ttu-id="ddb03-139">Acesso ao arquivo usando IDs de objeto.</span><span class="sxs-lookup"><span data-stu-id="ddb03-139">File access using object IDs.</span></span>
-   <span data-ttu-id="ddb03-140">Qualquer cenário de gravador compartilhado.</span><span class="sxs-lookup"><span data-stu-id="ddb03-140">Any shared writer scenario.</span></span>
-   <span data-ttu-id="ddb03-141">Qualquer situação em que um arquivo é aberto por um período de tempo estendido (dias ou semanas).</span><span class="sxs-lookup"><span data-stu-id="ddb03-141">Any situation where a file is opened for an extended period of time (days or weeks).</span></span>

 

 
