---
description: As funções de criptografia brutas permitem o backup de arquivos criptografados.
ms.assetid: 00f9b00e-305d-4554-8b43-7061228c92c3
title: Backup e restauração de arquivos criptografados
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fbc5d1babbbbb92cef9e78f9a0dade702fd63d2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104010655"
---
# <a name="backup-and-restore-of-encrypted-files"></a><span data-ttu-id="740d9-103">Backup e restauração de arquivos criptografados</span><span class="sxs-lookup"><span data-stu-id="740d9-103">Backup and Restore of Encrypted Files</span></span>

<span data-ttu-id="740d9-104">O sistema de arquivos com criptografia (EFS) filtra a abertura de um arquivo criptografado de forma que o aplicativo que abriu o arquivo obtenha acesso às informações não criptografadas, desde que ele tenha as credenciais apropriadas para acessar o arquivo e obter a chave necessária para descriptografar o arquivo.</span><span class="sxs-lookup"><span data-stu-id="740d9-104">The Encrypting File System (EFS) filters the opening of an encrypted file in such a way that the application that opened the file gets access to the unencrypted information, provided of course it has the proper credentials to access the file and get the key necessary to decrypt the file.</span></span> <span data-ttu-id="740d9-105">As operações de leitura subsequentes neste arquivo resultarão em texto não criptografado.</span><span class="sxs-lookup"><span data-stu-id="740d9-105">Subsequent read operations on this file will yield unencrypted text.</span></span> <span data-ttu-id="740d9-106">Isso é muito desejável para acesso típico a arquivos criptografados e mantém a criptografia e a descriptografia dos arquivos transparentes.</span><span class="sxs-lookup"><span data-stu-id="740d9-106">This is very desirable for typical access to encrypted files, and keeps the encryption and decryption of the files transparent.</span></span> <span data-ttu-id="740d9-107">No entanto, ele impede o backup de arquivos criptografados, porque se o backup for tentado com as chamadas de e/s de arquivo padrão como [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea), [**ReadFile**](/windows/desktop/api/FileAPI/nf-fileapi-readfile)e [**WriteFile**](/windows/desktop/api/FileAPI/nf-fileapi-writefile), o backup dos arquivos será a versão de texto sem formatação.</span><span class="sxs-lookup"><span data-stu-id="740d9-107">However, it hinders backup of encrypted files, because if backup is attempted with the standard file I/O calls like [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea), [**ReadFile**](/windows/desktop/api/FileAPI/nf-fileapi-readfile), and [**WriteFile**](/windows/desktop/api/FileAPI/nf-fileapi-writefile), the files backed up will be the plain text version.</span></span>

<span data-ttu-id="740d9-108">As funções de criptografia bruta são fornecidas para resolver esse problema.</span><span class="sxs-lookup"><span data-stu-id="740d9-108">The raw encryption functions are provided to solve this problem.</span></span> <span data-ttu-id="740d9-109">Os aplicativos de backup são um usuário principal pretendido para essas funções.</span><span class="sxs-lookup"><span data-stu-id="740d9-109">Backup applications are a primary intended user for these functions.</span></span> <span data-ttu-id="740d9-110">As funções de criptografia brutas diferem de outras funções do sistema de arquivos nas funções abrir, ler e gravar permitem o acesso aos fluxos de dados criptografados brutos e também permitem a leitura/gravação do fluxo de $EFS.</span><span class="sxs-lookup"><span data-stu-id="740d9-110">Raw encryption functions differ from other file system functions in that open, read, and write functions allow access to the raw encrypted data streams and also allow reading/writing of the $EFS stream.</span></span> <span data-ttu-id="740d9-111">Portanto, o chamador das funções de criptografia bruta não precisa acessar as chaves de criptografia que descriptografam o arquivo.</span><span class="sxs-lookup"><span data-stu-id="740d9-111">Therefore, the caller of the raw encryption functions does not need access to the cryptographic keys that decrypt the file.</span></span> <span data-ttu-id="740d9-112">As seguintes APIs de criptografia bruta estão disponíveis para uso com aplicativos de backup e restauração:</span><span class="sxs-lookup"><span data-stu-id="740d9-112">The following raw encryption APIs are available for use with backup and restore applications:</span></span> 

| <span data-ttu-id="740d9-113">API de criptografia bruta</span><span class="sxs-lookup"><span data-stu-id="740d9-113">Raw Encryption API</span></span>                                     | <span data-ttu-id="740d9-114">Descrição</span><span class="sxs-lookup"><span data-stu-id="740d9-114">Description</span></span>                                                                                                                                                                                                                                                                   |
|--------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="740d9-115">**OpenEncryptedFileRaw**</span><span class="sxs-lookup"><span data-stu-id="740d9-115">**OpenEncryptedFileRaw**</span></span>](/windows/desktop/api/WinBase/nf-winbase-openencryptedfilerawa)   | <span data-ttu-id="740d9-116">Abra um arquivo criptografado com acesso aos dados em formato criptografado.</span><span class="sxs-lookup"><span data-stu-id="740d9-116">Open an encrypted file with access to data in encrypted format.</span></span> <span data-ttu-id="740d9-117">Se o chamador não tiver acesso à chave do arquivo, o chamador precisará de [SeBackupPrivilege](/windows/desktop/SecAuthZ/authorization-constants) para exportar arquivos criptografados ou SeRestorePrivilege para importar arquivos criptografados.</span><span class="sxs-lookup"><span data-stu-id="740d9-117">If the caller does not have access to the key for the file, the caller needs [SeBackupPrivilege](/windows/desktop/SecAuthZ/authorization-constants) to export encrypted files or SeRestorePrivilege to import encrypted files.</span></span> |
| [<span data-ttu-id="740d9-118">**CloseEncryptedFileRaw**</span><span class="sxs-lookup"><span data-stu-id="740d9-118">**CloseEncryptedFileRaw**</span></span>](/windows/desktop/api/WinBase/nf-winbase-closeencryptedfileraw) | <span data-ttu-id="740d9-119">Fechar um arquivo criptografado aberto com [ **OpenEncryptedFileRaw**](/windows/desktop/api/WinBase/nf-winbase-openencryptedfilerawa)</span><span class="sxs-lookup"><span data-stu-id="740d9-119">Close an encrypted file opened with [**OpenEncryptedFileRaw**](/windows/desktop/api/WinBase/nf-winbase-openencryptedfilerawa)</span></span>                                                                                                                                                                                      |
| [<span data-ttu-id="740d9-120">**ReadEncryptedFileRaw**</span><span class="sxs-lookup"><span data-stu-id="740d9-120">**ReadEncryptedFileRaw**</span></span>](/windows/desktop/api/WinBase/nf-winbase-readencryptedfileraw)   | <span data-ttu-id="740d9-121">Ler um arquivo criptografado deixando seus dados no formato criptografado</span><span class="sxs-lookup"><span data-stu-id="740d9-121">Read an encrypted file leaving its data in encrypted format</span></span>                                                                                                                                                                                                                   |
| [<span data-ttu-id="740d9-122">**WriteEncryptedFileRaw**</span><span class="sxs-lookup"><span data-stu-id="740d9-122">**WriteEncryptedFileRaw**</span></span>](/windows/desktop/api/WinBase/nf-winbase-writeencryptedfileraw) | <span data-ttu-id="740d9-123">Gravar um arquivo criptografado deixando seus dados no formato criptografado</span><span class="sxs-lookup"><span data-stu-id="740d9-123">Write an encrypted file leaving its data in encrypted format</span></span>                                                                                                                                                                                                                  |
| [<span data-ttu-id="740d9-124">**ImportCallback**</span><span class="sxs-lookup"><span data-stu-id="740d9-124">**ImportCallback**</span></span>](/windows/desktop/api/WinBase/nc-winbase-pfe_import_func)               | <span data-ttu-id="740d9-125">Retorno de chamada definido pelo aplicativo para uso com [ **WriteEncryptedFileRaw**](/windows/desktop/api/WinBase/nf-winbase-writeencryptedfileraw)</span><span class="sxs-lookup"><span data-stu-id="740d9-125">Application-defined callback for use with [**WriteEncryptedFileRaw**](/windows/desktop/api/WinBase/nf-winbase-writeencryptedfileraw)</span></span>                                                                                                                                                                              |
| [<span data-ttu-id="740d9-126">**ExportCallback**</span><span class="sxs-lookup"><span data-stu-id="740d9-126">**ExportCallback**</span></span>](/windows/desktop/api/WinBase/nc-winbase-pfe_export_func)               | <span data-ttu-id="740d9-127">Retorno de chamada definido pelo aplicativo para uso com [ **ReadEncryptedFileRaw**](/windows/desktop/api/WinBase/nf-winbase-readencryptedfileraw)</span><span class="sxs-lookup"><span data-stu-id="740d9-127">Application-defined callback for use with [**ReadEncryptedFileRaw**](/windows/desktop/api/WinBase/nf-winbase-readencryptedfileraw)</span></span>                                                                                                                                                                                |



 

 

 
