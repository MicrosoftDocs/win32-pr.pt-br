---
description: Aplicativos cliente que chamam interfaces WMI podem controlar os níveis de segurança de seus processos.
ms.assetid: 790b4e40-9b92-464a-a774-dec0b75cedee
ms.tgt_platform: multiple
title: Definindo a segurança do processo do aplicativo cliente
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8bfa0a42390ffa433cff01300b0976d40553665c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104170377"
---
# <a name="setting-client-application-process-security"></a><span data-ttu-id="f6bff-103">Definindo a segurança do processo do aplicativo cliente</span><span class="sxs-lookup"><span data-stu-id="f6bff-103">Setting Client Application Process Security</span></span>

<span data-ttu-id="f6bff-104">Aplicativos cliente que chamam interfaces WMI podem controlar os níveis de segurança de seus processos.</span><span class="sxs-lookup"><span data-stu-id="f6bff-104">Client applications that call WMI interfaces can control the security levels of their processes.</span></span> <span data-ttu-id="f6bff-105">Todos os aplicativos WMI acessam o WMI por meio do COM e você pode chamar a função de COM [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) para definir a segurança para seus processos.</span><span class="sxs-lookup"><span data-stu-id="f6bff-105">All WMI applications access WMI through COM, and you can call the COM function [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) to set security for your processes.</span></span> <span data-ttu-id="f6bff-106">Os aplicativos que fazem chamadas assíncronas para o WMI e os aplicativos que se registram como consumidores de eventos definem níveis de segurança na chamada no WMI.</span><span class="sxs-lookup"><span data-stu-id="f6bff-106">Applications that make asynchronous calls to WMI and applications that register as event consumers set security levels on the call into WMI.</span></span>

<span data-ttu-id="f6bff-107">Se você não fizer uma chamada explícita para [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity), o com as chamará implicitamente com valores do registro.</span><span class="sxs-lookup"><span data-stu-id="f6bff-107">If you do not make an explicit call to [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity), COM calls it implicitly with values from the registry.</span></span> <span data-ttu-id="f6bff-108">No entanto, os valores do registro podem ter configurações mais baixas para representação e autenticação que não fornecem a segurança necessária para o WMI.</span><span class="sxs-lookup"><span data-stu-id="f6bff-108">However, the registry values may have lower settings for impersonation and authentication that do not provide the security required for WMI.</span></span> <span data-ttu-id="f6bff-109">Para obter mais informações, consulte [definindo o nível de segurança do processo padrão usando C++](setting-the-default-process-security-level-using-c-.md).</span><span class="sxs-lookup"><span data-stu-id="f6bff-109">For more information, see [Setting the Default Process Security Level Using C++](setting-the-default-process-security-level-using-c-.md).</span></span>

<span data-ttu-id="f6bff-110">O acesso assíncrono ao WMI não é recomendado.</span><span class="sxs-lookup"><span data-stu-id="f6bff-110">Asynchronous access to WMI is not recommended.</span></span> <span data-ttu-id="f6bff-111">Um retorno de chamada assíncrono permite que um usuário não autenticado forneça dados para o coletor.</span><span class="sxs-lookup"><span data-stu-id="f6bff-111">An asynchronous callback allows a non-authenticated user to provide data to the sink.</span></span> <span data-ttu-id="f6bff-112">Isso representa riscos de segurança para seus scripts e aplicativos.</span><span class="sxs-lookup"><span data-stu-id="f6bff-112">This poses security risks to your scripts and applications.</span></span> <span data-ttu-id="f6bff-113">Para eliminar os riscos, use semisynchronous ou comunicação síncrona ou execute as verificações de acesso apropriadas no aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="f6bff-113">To eliminate the risks, use semisynchronous or synchronous communication, or perform proper access checks in your client application.</span></span> <span data-ttu-id="f6bff-114">Para obter mais informações, consulte [chamando um método](calling-a-method.md).</span><span class="sxs-lookup"><span data-stu-id="f6bff-114">For more information, see [Calling a Method](calling-a-method.md).</span></span>

<span data-ttu-id="f6bff-115">Chamadas para qualquer um dos proxies WMI ([**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices), [**IEnumWbemClassObject**](/windows/desktop/api/Wbemcli/nn-wbemcli-ienumwbemclassobject),[**IWbemCallResult**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemcallresult)ou [**IWbemRefresher**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemrefresher)) usam um ponteiro fora do processo.</span><span class="sxs-lookup"><span data-stu-id="f6bff-115">Calls to any of the WMI proxies ([**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices), [**IEnumWbemClassObject**](/windows/desktop/api/Wbemcli/nn-wbemcli-ienumwbemclassobject),[**IWbemCallResult**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemcallresult), or [**IWbemRefresher**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemrefresher)) use an out-of-process pointer.</span></span> <span data-ttu-id="f6bff-116">Para obter mais informações sobre os padrões e as recomendações, consulte [definindo a segurança em IWbemServices e outros proxies](setting-the-security-on-iwbemservices-and-other-proxies.md).</span><span class="sxs-lookup"><span data-stu-id="f6bff-116">For more information about the defaults and recommendations, see [Setting the Security on IWbemServices and Other Proxies](setting-the-security-on-iwbemservices-and-other-proxies.md).</span></span>

<span data-ttu-id="f6bff-117">O procedimento a seguir descreve as etapas que você deve executar para definir a segurança para o WMI em seu processo de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f6bff-117">The following procedure describes the steps you must perform to set the security for WMI on your application process.</span></span>

<span data-ttu-id="f6bff-118">**Para definir a segurança para o WMI em seu processo de aplicativo**</span><span class="sxs-lookup"><span data-stu-id="f6bff-118">**To set security for WMI on your application process**</span></span>

1.  <span data-ttu-id="f6bff-119">Determine os níveis de segurança necessários para os sistemas operacionais Windows nos quais seu aplicativo cliente é executado.</span><span class="sxs-lookup"><span data-stu-id="f6bff-119">Determine the security levels required for the Windows operating systems on which your client application runs.</span></span>
2.  <span data-ttu-id="f6bff-120">Chame a função COM [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) para definir a segurança padrão para o processo no qual o aplicativo cliente é executado.</span><span class="sxs-lookup"><span data-stu-id="f6bff-120">Call the COM [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) function to set the default security for the process in which the client application runs.</span></span> <span data-ttu-id="f6bff-121">Isso declara a quantidade de segurança que outros aplicativos exigem para acessar o processo no qual seu aplicativo é executado.</span><span class="sxs-lookup"><span data-stu-id="f6bff-121">This declares how much security other applications require to access the process in which your application runs.</span></span>
3.  <span data-ttu-id="f6bff-122">Se você precisar alterar a segurança em um proxy individual, por exemplo, em outra chamada para [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices), chame [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket).</span><span class="sxs-lookup"><span data-stu-id="f6bff-122">If you need to change the security on an individual proxy, for example on another call to [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices), call [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket).</span></span>
4.  <span data-ttu-id="f6bff-123">Se você precisar controlar o hardware remoto ou um objeto do sistema que requer mais privilégios, use a função [**AdjustTokenPrivileges**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges) para habilitar os privilégios necessários.</span><span class="sxs-lookup"><span data-stu-id="f6bff-123">If you need to control remote hardware or a system object that requires more privilege, use the [**AdjustTokenPrivileges**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges) function to enable the necessary privileges.</span></span> <span data-ttu-id="f6bff-124">Observe que você não pode habilitar um privilégio que o processo ainda não tenha sido atribuído a ele.</span><span class="sxs-lookup"><span data-stu-id="f6bff-124">Note that you cannot enable a privilege that the process does not already have assigned to it.</span></span> <span data-ttu-id="f6bff-125">Para obter mais informações, consulte [verificando o acesso a objetos privados](/windows/desktop/SecAuthZ/checking-access-to-private-objects).</span><span class="sxs-lookup"><span data-stu-id="f6bff-125">For more information, see [Checking Access to Private Objects](/windows/desktop/SecAuthZ/checking-access-to-private-objects).</span></span>

<span data-ttu-id="f6bff-126">Para obter mais informações sobre como definir o nível de segurança do processo padrão, consulte [definindo o nível de segurança do processo padrão usando C++](setting-the-default-process-security-level-using-c-.md) e [definindo o nível de segurança do processo padrão usando o VBScript](setting-the-default-process-security-level-using-vbscript.md).</span><span class="sxs-lookup"><span data-stu-id="f6bff-126">For further information about setting the default process security level, see [Setting the Default Process Security Level Using C++](setting-the-default-process-security-level-using-c-.md) and [Setting the Default Process Security Level Using VBScript](setting-the-default-process-security-level-using-vbscript.md).</span></span>

 

 
