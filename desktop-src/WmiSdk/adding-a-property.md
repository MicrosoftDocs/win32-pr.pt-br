---
description: As propriedades nas classes WMI descrevem dados sobre um objeto gerenciado.
ms.assetid: 4046bfc7-9528-4737-ad61-bbb8419d0b51
ms.tgt_platform: multiple
title: Adicionando uma propriedade WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bba8944da155ca250edfed0c6e9160f555ba9551
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105812262"
---
# <a name="adding-a-wmi-property"></a><span data-ttu-id="7e6d9-103">Adicionando uma propriedade WMI</span><span class="sxs-lookup"><span data-stu-id="7e6d9-103">Adding a WMI Property</span></span>

<span data-ttu-id="7e6d9-104">As propriedades nas classes WMI descrevem dados sobre um objeto gerenciado.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-104">Properties in WMI classes describe data about a managed object.</span></span> <span data-ttu-id="7e6d9-105">Por exemplo, **HANDLE**, **ProcessId** e **PageFaults** são definidos como propriedades da classe de [**\_ processo do Win32**](/windows/desktop/CIMWin32Prov/win32-process) e descrevem aspectos de um processo do sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-105">For example, **Handle**, **ProcessId**, and **PageFaults** are defined as properties of the [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) class and describe aspects of an operating system process.</span></span> <span data-ttu-id="7e6d9-106">Para obter mais informações, consulte [escrevendo um provedor de propriedades](writing-a-property-provider.md).</span><span class="sxs-lookup"><span data-stu-id="7e6d9-106">For more information, see [Writing a Property Provider](writing-a-property-provider.md).</span></span>

## <a name="defining-a-property-in-mof"></a><span data-ttu-id="7e6d9-107">Definindo uma propriedade no MOF</span><span class="sxs-lookup"><span data-stu-id="7e6d9-107">Defining a Property in MOF</span></span>

<span data-ttu-id="7e6d9-108">Uma propriedade WMI representa um aspecto ou estado no objeto.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-108">A WMI property represents an aspect or state in the object.</span></span> <span data-ttu-id="7e6d9-109">Em vez de criar métodos que simplesmente obtêm e definem um valor, você pode criar uma propriedade.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-109">Rather than create methods that simply get and set a value, you can create a property.</span></span> <span data-ttu-id="7e6d9-110">Por exemplo, a propriedade **netenabled** de [**\_ adaptador do Win32**](/windows/desktop/CIMWin32Prov/win32-networkadapter) exibe se o estado do adaptador está habilitado ou desabilitado.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-110">For example, the **NetEnabled** property of [**Win32\_NetworkAdapter**](/windows/desktop/CIMWin32Prov/win32-networkadapter) displays whether the state of the adapter is enabled or disabled.</span></span> <span data-ttu-id="7e6d9-111">No entanto, os métodos [**Enable**](/windows/desktop/CIMWin32Prov/enable-method-in-class-win32-networkadapter) e [**Disable**](/windows/desktop/CIMWin32Prov/disable-method-in-class-win32-networkadapter) realmente executam a ação de alterar o estado do adaptador.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-111">However, the [**Enable**](/windows/desktop/CIMWin32Prov/enable-method-in-class-win32-networkadapter) and [**Disable**](/windows/desktop/CIMWin32Prov/disable-method-in-class-win32-networkadapter) methods actually perform the action of changing the adapter state.</span></span>

<span data-ttu-id="7e6d9-112">Uma propriedade deve ter um tipo de dados.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-112">A property must have a data type.</span></span> <span data-ttu-id="7e6d9-113">O tipo de dados do **identificador** de Propriedade do [**\_ processo do Win32**](/windows/desktop/CIMWin32Prov/win32-process) é **String** e o tipo de dados de **PageFaults** é **UInt32**.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-113">The data type of the [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) property **Handle** is **string** and the data type of **PageFaults** is **uint32**.</span></span> <span data-ttu-id="7e6d9-114">Se uma propriedade puder ter apenas dois Estados, o tipo de dados da propriedade será normalmente definido como **booliano**.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-114">If a property can have only two states, the data type of the property is normally set to **boolean**.</span></span>

<span data-ttu-id="7e6d9-115">A propriedade também pode ser uma matriz.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-115">The property may also be an array.</span></span> <span data-ttu-id="7e6d9-116">Por exemplo, a propriedade **Sid**(identificador de segurança) [**do \_ confiança do Win32**](/previous-versions/windows/desktop/secrcw32prov/win32-trustee) é uma matriz de bytes (**uint8**) que contém o Sid.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-116">For example, the security identifier (**SID**) property of [**Win32\_Trustee**](/previous-versions/windows/desktop/secrcw32prov/win32-trustee) is a byte array (**uint8**) that contains the SID.</span></span> <span data-ttu-id="7e6d9-117">As propriedades podem conter objetos incorporados que são referências a uma ou mais instâncias de outra classe WMI.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-117">Properties can contain embedded objects which are references to one or more instances of another WMI class.</span></span> <span data-ttu-id="7e6d9-118">A **DACL (** lista de controle de acesso discricionário) e as propriedades da **SACL (** lista de controle de acesso do sistema) do [**Win32 \_ SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor), por exemplo, são matrizes de objetos do [**Win32 \_ Ace**](/previous-versions/windows/desktop/secrcw32prov/win32-ace) que descrevem os grupos e contas que têm acesso.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-118">The discretionary access control list **(DACL)** and system access control list **(SACL)** properties of [**Win32\_SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor), for example, are arrays of [**Win32\_ACE**](/previous-versions/windows/desktop/secrcw32prov/win32-ace) objects that describe the groups and accounts that have access.</span></span> <span data-ttu-id="7e6d9-119">A propriedade **Group** no **Win32 \_ SecurityDescriptor** contém uma referência a uma única instância do **Win32 \_ Trustee**.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-119">The **Group** property in **Win32\_SecurityDescriptor** contains a reference to a single instance of **Win32\_Trustee**.</span></span> <span data-ttu-id="7e6d9-120">Para obter mais informações, consulte [inserindo objetos em uma classe](embedded-objects.md).</span><span class="sxs-lookup"><span data-stu-id="7e6d9-120">For more information, see [Embedding Objects in a Class](embedded-objects.md).</span></span>

<span data-ttu-id="7e6d9-121">Uma propriedade pode ter vários [*qualificadores*](gloss-q.md).</span><span class="sxs-lookup"><span data-stu-id="7e6d9-121">A property may have several [*qualifiers*](gloss-q.md).</span></span> <span data-ttu-id="7e6d9-122">Esses [qualificadores](wmi-qualifiers.md) podem ser [*modelo CIM (CIM)*](gloss-c.md) ou qualificadores WMI ou podem ser específicos para determinados tipos de classes, por exemplo, os qualificadores de classe do [contador de desempenho](qualifiers-specific-to-wmi-performance-classes.md) .</span><span class="sxs-lookup"><span data-stu-id="7e6d9-122">These [qualifiers](wmi-qualifiers.md) may be [*Common Information Model (CIM)*](gloss-c.md) or WMI qualifiers or may be specific to certain types of classes, for example, the [performance Counter](qualifiers-specific-to-wmi-performance-classes.md) class qualifiers.</span></span> <span data-ttu-id="7e6d9-123">Os qualificadores especificam algum aspecto da propriedade, como se for somente leitura ou se não puder ser alterado sem um privilégio específico.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-123">Qualifiers specify some aspect of the property, such as if it is read-only or if it cannot be changed without a specific privilege.</span></span> <span data-ttu-id="7e6d9-124">Um aplicativo que tenta gravar na propriedade **DACL** do [**Win32 \_ SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor), por exemplo, requer os privilégios **SeSecurityPrivilege** e **SeRestorePrivilege**.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-124">An application which attempts to write to the [**Win32\_SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor)**DACL** property, for example, requires the privileges **SeSecurityPrivilege** and **SeRestorePrivilege**.</span></span> <span data-ttu-id="7e6d9-125">Para obter mais informações, consulte [adicionando um qualificador](adding-a-qualifier.md).</span><span class="sxs-lookup"><span data-stu-id="7e6d9-125">For more information, see [Adding a Qualifier](adding-a-qualifier.md).</span></span>

<span data-ttu-id="7e6d9-126">Por fim, uma propriedade deve ter um nome.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-126">Finally, a property must have a name.</span></span> <span data-ttu-id="7e6d9-127">Você pode nomear uma propriedade de qualquer coisa dentro dos limites da prática de programação padrão.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-127">You may name a property anything within the bounds of standard programming practice.</span></span> <span data-ttu-id="7e6d9-128">No entanto, há duas exceções principais.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-128">However, there are two main exceptions.</span></span> <span data-ttu-id="7e6d9-129">Primeiro, você não pode usar nenhuma palavra-chave MOF, como "Class", como um nome de propriedade.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-129">First, you may not use any MOF keyword, such as "class", as a property name.</span></span> <span data-ttu-id="7e6d9-130">Em segundo lugar, você não pode usar nenhuma palavra-chave WQL, como "grupo", como um nome de propriedade.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-130">Second, you may not use any WQL keywords, such as "group", as a property name either.</span></span> <span data-ttu-id="7e6d9-131">Para obter mais informações sobre as palavras-chave MOF e WQL, consulte [tipos de dados MOF](mof-data-types.md) e [WQL (SQL para WMI)](wql-sql-for-wmi.md).</span><span class="sxs-lookup"><span data-stu-id="7e6d9-131">For more information on MOF and WQL keywords, see [MOF Data Types](mof-data-types.md) and [WQL (SQL for WMI)](wql-sql-for-wmi.md).</span></span>

<span data-ttu-id="7e6d9-132">Para o código do C++ e do formato MOF (MOF), você declara as propriedades de uma classe ao mesmo tempo em que declara a classe.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-132">For both C++ and Managed Object Format (MOF) code, you declare the properties of a class at the same time that you declare the class.</span></span>

<span data-ttu-id="7e6d9-133">**Para definir uma propriedade**</span><span class="sxs-lookup"><span data-stu-id="7e6d9-133">**To define a property**</span></span>

-   <span data-ttu-id="7e6d9-134">Inclua o tipo de dados de propriedade, o nome e um valor padrão opcional e qualificador entre as chaves da descrição da classe.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-134">Include the property data type, name, and an optional default value and qualifier between the curly braces of the class description.</span></span>

    ``` syntax
    class MyClass 
    {
        [key] string   strProp;
        sint32         dwProp1 = 21;
        uint32         dwProp2;
    };
    ```

    <span data-ttu-id="7e6d9-135">A classe MyClass no exemplo anterior tem três propriedades: uma cadeia de caracteres, um inteiro com sinal de 32 bits e um inteiro sem sinal de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-135">The MyClass class in the preceding example has three properties: a character string, a 32-bit signed integer, and a 32-bit unsigned integer.</span></span> <span data-ttu-id="7e6d9-136">Cada propriedade é atribuída a um nome que não diferencia maiúsculas de minúsculas e um tipo de dados MOF.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-136">Each property is assigned a case-insensitive name and a MOF data type.</span></span>

    <span data-ttu-id="7e6d9-137">O qualificador de [**chave**](key-qualifier.md) define a propriedade de cadeia de caracteres como a propriedade de chave que identifica exclusivamente uma instância da classe.</span><span class="sxs-lookup"><span data-stu-id="7e6d9-137">The [**Key**](key-qualifier.md) qualifier defines the string property as the key property that uniquely identifies an instance of the class.</span></span> <span data-ttu-id="7e6d9-138">Para obter mais informações sobre qualificadores, consulte [adicionando um qualificador](adding-a-qualifier.md).</span><span class="sxs-lookup"><span data-stu-id="7e6d9-138">For more information about qualifiers, see [Adding a Qualifier](adding-a-qualifier.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="7e6d9-139">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="7e6d9-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7e6d9-140">Criando uma classe</span><span class="sxs-lookup"><span data-stu-id="7e6d9-140">Creating a Class</span></span>](creating-a-class.md)
</dt> </dl>

 

 
