---
description: Para criar um provedor de classes WMI, você deve registrar a \_ \_ instância Win32Provider que representa seu provedor usando uma instância de \_ \_ ClassProviderRegistration.
ms.assetid: ed834969-47e9-47df-9db8-c805b2eb71da
ms.tgt_platform: multiple
title: Registrando um provedor de classe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7bc15893e654f96f8c4e476219389a1f8f2c464a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103921312"
---
# <a name="registering-a-class-provider"></a><span data-ttu-id="4a80d-103">Registrando um provedor de classe</span><span class="sxs-lookup"><span data-stu-id="4a80d-103">Registering a Class Provider</span></span>

<span data-ttu-id="4a80d-104">Para criar um provedor de classes WMI, você deve registrar a instância [**\_ \_ Win32Provider**](--win32provider.md) que representa seu provedor usando uma instância de [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md).</span><span class="sxs-lookup"><span data-stu-id="4a80d-104">To create a WMI class provider you must register the [**\_\_Win32Provider**](--win32provider.md) instance that represents your provider using an instance of [**\_\_ClassProviderRegistration**](--classproviderregistration.md).</span></span> <span data-ttu-id="4a80d-105">Como um objeto COM, seu provedor deve se registrar no sistema operacional e no WMI.</span><span class="sxs-lookup"><span data-stu-id="4a80d-105">As a COM object, your provider must register with the operating system and WMI.</span></span> <span data-ttu-id="4a80d-106">O procedimento a seguir pressupõe que você já implementou o processo de registro conforme descrito em [registrando um provedor](registering-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="4a80d-106">The following procedure assumes that you have already implemented the registration process as described in [Registering a Provider](registering-a-provider.md).</span></span> <span data-ttu-id="4a80d-107">Se o provedor armazenar a maioria dos dados no repositório WMI e se os dados forem atualizados somente na inicialização do WMI, registre sua classe como um provedor de classe Push.</span><span class="sxs-lookup"><span data-stu-id="4a80d-107">If your provider stores most data in the WMI repository and that data is updated only on WMI initialization, then register your class as a push class provider.</span></span> <span data-ttu-id="4a80d-108">Se os dados que você está fornecendo mudam com frequência e são recuperados dinamicamente pelo seu código em cada solicitação do WMI, Registre seu provedor como um provedor de classe pull.</span><span class="sxs-lookup"><span data-stu-id="4a80d-108">If the data you are providing changes frequently and is retrieved dynamically by your code on every request from WMI, then register your provider as a pull class provider.</span></span>

<span data-ttu-id="4a80d-109">O procedimento a seguir descreve como registrar um provedor de classe Push.</span><span class="sxs-lookup"><span data-stu-id="4a80d-109">The following procedure describes how to register a push class provider.</span></span>

<span data-ttu-id="4a80d-110">**Para registrar um provedor de classe push**</span><span class="sxs-lookup"><span data-stu-id="4a80d-110">**To register a push class provider**</span></span>

-   <span data-ttu-id="4a80d-111">Defina a propriedade **interactiontype** da instância [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) como 1.</span><span class="sxs-lookup"><span data-stu-id="4a80d-111">Set the **InteractionType** property of the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) instance to 1.</span></span>

    <span data-ttu-id="4a80d-112">A criação de uma instância do [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) faz parte do processo de registro.</span><span class="sxs-lookup"><span data-stu-id="4a80d-112">Creating an instance of [**\_\_ClassProviderRegistration**](--classproviderregistration.md) is part of the registration process.</span></span>

<span data-ttu-id="4a80d-113">O procedimento a seguir descreve como registrar um provedor de classe pull.</span><span class="sxs-lookup"><span data-stu-id="4a80d-113">The following procedure describes how to register a pull class provider.</span></span>

<span data-ttu-id="4a80d-114">**Para registrar um provedor de classe pull**</span><span class="sxs-lookup"><span data-stu-id="4a80d-114">**To register a pull class provider**</span></span>

1.  <span data-ttu-id="4a80d-115">Crie uma instância da classe [**\_ \_ Win32Provider**](--win32provider.md) que descreve o provedor.</span><span class="sxs-lookup"><span data-stu-id="4a80d-115">Create an instance of the [**\_\_Win32Provider**](--win32provider.md) class that describes the provider.</span></span>
2.  <span data-ttu-id="4a80d-116">Crie uma instância da classe [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) que descreve o conjunto de recursos do provedor.</span><span class="sxs-lookup"><span data-stu-id="4a80d-116">Create an instance of the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) class that describes the feature set of the provider.</span></span>

    <span data-ttu-id="4a80d-117">Na instância de [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) :</span><span class="sxs-lookup"><span data-stu-id="4a80d-117">Within the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) instance:</span></span>

    1.  <span data-ttu-id="4a80d-118">Defina a propriedade **interactiontype** para indicar se o provedor é um provedor de Push ou pull.</span><span class="sxs-lookup"><span data-stu-id="4a80d-118">Set the **InteractionType** property to indicate whether the provider is a push or pull provider.</span></span>
    2.  <span data-ttu-id="4a80d-119">Marque a classe com os qualificadores [**dinâmicos**](standard-wmi-qualifiers.md) e de [**provedor**](/windows/desktop/api/Provider/nl-provider-provider) .</span><span class="sxs-lookup"><span data-stu-id="4a80d-119">Tag the class with both the [**Dynamic**](standard-wmi-qualifiers.md) and [**Provider**](/windows/desktop/api/Provider/nl-provider-provider) qualifiers.</span></span>

        <span data-ttu-id="4a80d-120">O qualificador [**dinâmico**](standard-wmi-qualifiers.md) sinaliza que o WMI deve usar um provedor para recuperar as instâncias de classe.</span><span class="sxs-lookup"><span data-stu-id="4a80d-120">The [**Dynamic**](standard-wmi-qualifiers.md) qualifier signals that WMI should use a provider to retrieve the class instances.</span></span> <span data-ttu-id="4a80d-121">O qualificador do [**provedor**](/windows/desktop/api/Provider/nl-provider-provider) especifica o nome do provedor que o WMI deve usar.</span><span class="sxs-lookup"><span data-stu-id="4a80d-121">The [**Provider**](/windows/desktop/api/Provider/nl-provider-provider) qualifier specifies the name of the provider that WMI should use.</span></span>

    3.  <span data-ttu-id="4a80d-122">Defina as propriedades **ResultSetQueries**, **ReferencedSetQueries** e **UnsupportedQueries** .</span><span class="sxs-lookup"><span data-stu-id="4a80d-122">Define the **ResultSetQueries**, **ReferencedSetQueries**, and **UnsupportedQueries** properties.</span></span>

        <span data-ttu-id="4a80d-123">Essas propriedades de consulta descrevem informações detalhadas sobre a classe com suporte.</span><span class="sxs-lookup"><span data-stu-id="4a80d-123">These query properties describe detailed information about the supported class.</span></span>

<span data-ttu-id="4a80d-124">Além de descrever os vários métodos com suporte de uma classe, a classe [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md) também tem três propriedades que descrevem uma série de consultas.</span><span class="sxs-lookup"><span data-stu-id="4a80d-124">In addition to describing the various supported methods of a class, the [**\_\_ClassProviderRegistration**](--classproviderregistration.md) class also has three properties that describe a series of queries.</span></span> <span data-ttu-id="4a80d-125">Quando usadas juntas, essas três propriedades descrevem todo o intervalo de classes fornecidas pelo provedor de classe.</span><span class="sxs-lookup"><span data-stu-id="4a80d-125">When used together, these three properties describe the entire range of classes supplied by the class provider.</span></span> <span data-ttu-id="4a80d-126">Cada propriedade de consulta contém uma instrução de seleção WQL, chamada de "consulta de esquema", para especificar os tipos de classes com suporte.</span><span class="sxs-lookup"><span data-stu-id="4a80d-126">Each query property contains a WQL SELECT statement, called a "schema query," to specify the types of supported classes.</span></span> <span data-ttu-id="4a80d-127">Consultas de esquema especificam um nome de classe especial chamado meta \_ Class.</span><span class="sxs-lookup"><span data-stu-id="4a80d-127">Schema queries specify a special class name called meta\_class.</span></span> <span data-ttu-id="4a80d-128">A tabela a seguir lista as propriedades de consulta.</span><span class="sxs-lookup"><span data-stu-id="4a80d-128">The following table lists the query properties.</span></span>



| <span data-ttu-id="4a80d-129">Propriedade</span><span class="sxs-lookup"><span data-stu-id="4a80d-129">Property</span></span>                 | <span data-ttu-id="4a80d-130">Descrição</span><span class="sxs-lookup"><span data-stu-id="4a80d-130">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|--------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="4a80d-131">**ResultSetQueries**</span><span class="sxs-lookup"><span data-stu-id="4a80d-131">**ResultSetQueries**</span></span>     | <span data-ttu-id="4a80d-132">Contém informações sobre o conjunto de resultados que o provedor fornece.</span><span class="sxs-lookup"><span data-stu-id="4a80d-132">Contains information about the result set the provider supplies.</span></span> <span data-ttu-id="4a80d-133">O WMI usa as informações para determinar se deve invocar o provedor para atender a uma consulta de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4a80d-133">WMI uses the information to determine whether to invoke the provider to satisfy a query from an application.</span></span> <span data-ttu-id="4a80d-134">Esta propriedade descreve o conjunto de todas as classes que o provedor pode fornecer ou um superconjunto das classes disponíveis, mas nunca um subconjunto.</span><span class="sxs-lookup"><span data-stu-id="4a80d-134">This property describes either the set of all classes that the provider can supply or a superset of the available classes, but never a subset.</span></span> <span data-ttu-id="4a80d-135">O WMI requer um provedor para especificar pelo menos uma consulta nesta propriedade.</span><span class="sxs-lookup"><span data-stu-id="4a80d-135">WMI requires a provider to specify at least one query in this property.</span></span><br/> <span data-ttu-id="4a80d-136">O exemplo a seguir mostra como definir **ResultSetQueries** quando um provedor fornece uma classe de associação que faz referência à classe do disco [**\_ lógico do Win32**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) .</span><span class="sxs-lookup"><span data-stu-id="4a80d-136">The following example shows how to set **ResultSetQueries** when a provider supplies an association class that references the [**Win32\_LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) class.</span></span><br/> `SELECT * FROM meta_class WHERE __Class = "Win32_LogicalDisk"`<br/> <span data-ttu-id="4a80d-137">O exemplo a seguir mostra como especificar uma consulta geral quando um provedor fornece classes que fazem referência a outras classes desconhecidas.</span><span class="sxs-lookup"><span data-stu-id="4a80d-137">The following example shows how to specify a general query when a provider supplies classes that reference other unknown classes.</span></span><br/> `SELECT * FROM meta_class`<br/> <span data-ttu-id="4a80d-138">O exemplo a seguir mostra como definir **ResultSetQueries** quando um provedor fornece apenas subclasses, mas não a classe pai de uma determinada classe.</span><span class="sxs-lookup"><span data-stu-id="4a80d-138">The following example shows how to set **ResultSetQueries** when a provider supplies only subclasses, but not the parent class of a given class.</span></span><br/> `SELECT * FROM meta_class WHERE __Dynasty = "MyClass"`<br/> <span data-ttu-id="4a80d-139">O exemplo a seguir mostra como usar a \_ \_ propriedade especial this e Set **ResultSetQueries** quando um provedor fornece todas as classes e subclasses.</span><span class="sxs-lookup"><span data-stu-id="4a80d-139">The following example shows how to use the special \_\_this property and set **ResultSetQueries** when a provider supplies all class and subclasses.</span></span><br/> `SELECT * FROM meta_class WHERE __this ISA "MyClass"`<br/> |
| <span data-ttu-id="4a80d-140">**ReferencedSetQueries**</span><span class="sxs-lookup"><span data-stu-id="4a80d-140">**ReferencedSetQueries**</span></span> | <span data-ttu-id="4a80d-141">Determina se o provedor deve ser ignorado em consultas de esquema em que as associações e referências estão sendo solicitadas.</span><span class="sxs-lookup"><span data-stu-id="4a80d-141">Determines whether to bypass the provider in schema queries where associations and references are being requested.</span></span> <span data-ttu-id="4a80d-142">Provedores que podem fornecer classes de associação devem incluir pelo menos uma consulta em sua propriedade **ReferencedSetQueries** .</span><span class="sxs-lookup"><span data-stu-id="4a80d-142">Providers that can supply association classes must include at least one query in their **ReferencedSetQueries** property.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="4a80d-143">**UnsupportedQueries**</span><span class="sxs-lookup"><span data-stu-id="4a80d-143">**UnsupportedQueries**</span></span>   | <span data-ttu-id="4a80d-144">Contém informações sobre o conjunto de resultados que um provedor de classe não fornece.</span><span class="sxs-lookup"><span data-stu-id="4a80d-144">Contains information about the result set that a class provider does not supply.</span></span> <span data-ttu-id="4a80d-145">O WMI usa essa propriedade para subtrair do conjunto de classes implícitas por **ResultSetQueries**.</span><span class="sxs-lookup"><span data-stu-id="4a80d-145">WMI uses this property to subtract from the set of classes implied by **ResultSetQueries**.</span></span> <span data-ttu-id="4a80d-146">Por exemplo, um provedor de classe pode especificar no suporte **ResultSetQueries** para todas as classes derivadas de MyClass e especificar em **UnsupportedQueries** a falta de suporte para uma classe derivada específica.</span><span class="sxs-lookup"><span data-stu-id="4a80d-146">For example, a class provider can specify in **ResultSetQueries** support for all classes derived from MyClass and specify in **UnsupportedQueries** a lack of support for one particular derived class.</span></span><br/> <span data-ttu-id="4a80d-147">Quanto mais informações o provedor puder registrar sobre seus recursos de processamento de consulta, mais rápido será executado.</span><span class="sxs-lookup"><span data-stu-id="4a80d-147">The more information that a provider can register about its query processing capabilities, the faster it runs.</span></span> <span data-ttu-id="4a80d-148">A inserção de uma ou mais consultas na propriedade **UnsupportedQueries** é uma maneira de ser específica e é particularmente importante quando um provedor se baseia em uma classe que não fornece.</span><span class="sxs-lookup"><span data-stu-id="4a80d-148">Entering one or more queries in the **UnsupportedQueries** property is one way to be specific and is particularly important when a provider relies on a class that it does not supply.</span></span> <span data-ttu-id="4a80d-149">Quando uma solicitação é feita para uma classe que está listada em uma consulta na propriedade **UnsupportedQueries** , o WMI pode fornecer a própria classe ou invocar um provedor alternativo para fornecê-la.</span><span class="sxs-lookup"><span data-stu-id="4a80d-149">When a request is made for a class that is listed in a query in the **UnsupportedQueries** property, WMI can supply the class itself or invoke an alternate provider to supply it.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

<span data-ttu-id="4a80d-150">Como o WMI não oferece suporte à cláusula OR, você deve criar uma consulta separada para cada classe.</span><span class="sxs-lookup"><span data-stu-id="4a80d-150">Because WMI does not support the OR clause, you must create a separate query for each class.</span></span>

<span data-ttu-id="4a80d-151">As consultas a seguir são especificadas em **ResultSetQueries** quando um provedor de classe fornece MyClass1, MyClass2 e MyClass3.</span><span class="sxs-lookup"><span data-stu-id="4a80d-151">The following queries are specified in **ResultSetQueries** when a class provider supplies MyClass1, MyClass2, and MyClass3.</span></span>


```sql
SELECT * FROM meta_class WHERE __Class = "MyClass1"
SELECT * FROM meta_class WHERE __Class = "MyClass2"
SELECT * FROM meta_class WHERE __Class = "MyClass3"
```



<span data-ttu-id="4a80d-152">Somente os administradores podem registrar ou excluir um provedor criando uma instância do [**\_ \_ Win32Provider**](--win32provider.md) e do [**\_ \_ ClassProviderRegistration**](--classproviderregistration.md).</span><span class="sxs-lookup"><span data-stu-id="4a80d-152">Only administrators can register or delete a provider by creating an instance of [**\_\_Win32Provider**](--win32provider.md) and [**\_\_ClassProviderRegistration**](--classproviderregistration.md).</span></span>

 

