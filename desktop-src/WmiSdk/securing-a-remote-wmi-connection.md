---
description: Para se conectar a um computador remoto usando o WMI, verifique se as configurações de DCOM corretas e as configurações de segurança do namespace WMI estão habilitadas para a conexão.
ms.assetid: 96ebaa9b-a062-4300-a637-8eb71cb80d1c
ms.tgt_platform: multiple
title: Protegendo uma conexão WMI remota
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df2a044e49fed5eaa27fbc246dca3306a6c29650
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104505675"
---
# <a name="securing-a-remote-wmi-connection"></a><span data-ttu-id="3c6fc-103">Protegendo uma conexão WMI remota</span><span class="sxs-lookup"><span data-stu-id="3c6fc-103">Securing a Remote WMI Connection</span></span>

<span data-ttu-id="3c6fc-104">Para se conectar a um computador remoto usando o WMI, verifique se as configurações de DCOM corretas e as configurações de segurança do namespace WMI estão habilitadas para a conexão.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-104">To connect to a remote computer using WMI, ensure that the correct DCOM settings and WMI namespace security settings are enabled for the connection.</span></span>

<span data-ttu-id="3c6fc-105">O WMI tem configurações padrão de representação, autenticação e serviço de autenticação (NTLM ou Kerberos) que o computador de destino em uma conexão remota exige.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-105">WMI has default impersonation, authentication, and authentication service (NTLM or Kerberos) settings that the target computer in a remote connection requires.</span></span> <span data-ttu-id="3c6fc-106">Seu computador local pode usar padrões diferentes que o sistema de destino não aceita.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-106">Your local machine may use different defaults that the target system does not accept.</span></span> <span data-ttu-id="3c6fc-107">Você pode alterar essas configurações na chamada de conexão.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-107">You can change these settings in the connection call.</span></span>

<span data-ttu-id="3c6fc-108">As seções a seguir são discutidas neste tópico:</span><span class="sxs-lookup"><span data-stu-id="3c6fc-108">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="3c6fc-109">Configurações de representação e autenticação DCOM para WMI</span><span class="sxs-lookup"><span data-stu-id="3c6fc-109">DCOM Impersonation and Authentication Settings for WMI</span></span>](#dcom-impersonation-and-authentication-settings-for-wmi)
-   [<span data-ttu-id="3c6fc-110">Definindo a segurança DCOM para permitir que um usuário acesse um computador remotamente</span><span class="sxs-lookup"><span data-stu-id="3c6fc-110">Setting DCOM Security to Allow a User to Access a Computer Remotely</span></span>](#setting-dcom-security-to-allow-a-user-to-access-a-computer-remotely)
-   [<span data-ttu-id="3c6fc-111">Permitindo que os usuários acessem um namespace WMI específico</span><span class="sxs-lookup"><span data-stu-id="3c6fc-111">Allowing Users Access to a Specific WMI Namespace</span></span>](#allowing-users-access-to-a-specific-wmi-namespace)
-   [<span data-ttu-id="3c6fc-112">Definindo a segurança do namespace para exigir a criptografia de dados para conexões remotas</span><span class="sxs-lookup"><span data-stu-id="3c6fc-112">Setting Namespace Security to Require Data Encryption for Remote Connections</span></span>](#setting-namespace-security-to-require-data-encryption-for-remote-connections)
-   [<span data-ttu-id="3c6fc-113">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="3c6fc-113">Related topics</span></span>](#related-topics)

## <a name="dcom-impersonation-and-authentication-settings-for-wmi"></a><span data-ttu-id="3c6fc-114">Configurações de representação e autenticação DCOM para WMI</span><span class="sxs-lookup"><span data-stu-id="3c6fc-114">DCOM Impersonation and Authentication Settings for WMI</span></span>

<span data-ttu-id="3c6fc-115">O WMI tem configurações de representação, autenticação e serviço de autenticação (NTLM ou Kerberos) padrão do DCOM que o sistema remoto exige.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-115">WMI has default DCOM impersonation, authentication, and authentication service (NTLM or Kerberos) settings that the a remote system requires.</span></span> <span data-ttu-id="3c6fc-116">Seu sistema local pode usar padrões diferentes que o sistema remoto de destino não aceita.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-116">Your local system may use different defaults that the target remote system does not accept.</span></span> <span data-ttu-id="3c6fc-117">Você pode alterar essas configurações na chamada de conexão.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-117">You can change these settings in the connection call.</span></span> <span data-ttu-id="3c6fc-118">Para obter mais informações, consulte [definindo a segurança do processo do aplicativo cliente](setting-client-application-process-security.md).</span><span class="sxs-lookup"><span data-stu-id="3c6fc-118">For more information, see [Setting Client Application Process Security](setting-client-application-process-security.md).</span></span> <span data-ttu-id="3c6fc-119">No entanto, para o serviço de autenticação, é recomendável que você especifique o **\_ \_ \_ padrão de autenticação RPC C** e permitir que o DCOM escolha o serviço apropriado para o computador de destino.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-119">However, for the authentication service, it is recommended that you specify **RPC\_C\_AUTHN\_DEFAULT** and allow DCOM to choose the appropriate service for the target computer.</span></span>

<span data-ttu-id="3c6fc-120">Você pode fornecer configurações em parâmetros para as chamadas para [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) ou [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) em C++.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-120">You can supply settings in parameters for the calls to [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) or [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) in C++.</span></span> <span data-ttu-id="3c6fc-121">Em scripts, você pode estabelecer configurações de segurança em chamadas para [**SWbemLocator. ConnectServer**](swbemlocator-connectserver.md), em um objeto [**SWbemSecurity**](swbemsecurity.md) ou na cadeia de caracteres do [moniker do identificador](constructing-a-moniker-string.md) de script.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-121">In scripts, you can establish security settings in calls to [**SWbemLocator.ConnectServer**](swbemlocator-connectserver.md), in an [**SWbemSecurity**](swbemsecurity.md) object, or in the scripting [moniker](constructing-a-moniker-string.md) string.</span></span>

<span data-ttu-id="3c6fc-122">Para obter uma lista de todas as constantes de representação de C++, consulte [definindo o nível de segurança do processo padrão usando C++](setting-the-default-process-security-level-using-c-.md).</span><span class="sxs-lookup"><span data-stu-id="3c6fc-122">For a list of all the C++ impersonation constants, see [Setting the Default Process Security Level Using C++](setting-the-default-process-security-level-using-c-.md).</span></span> <span data-ttu-id="3c6fc-123">Para obter as constantes de Visual Basic e as cadeias de caracteres de script para usar a conexão do moniker, consulte [definindo o nível de segurança do processo padrão usando o VBScript](setting-the-default-process-security-level-using-vbscript.md).</span><span class="sxs-lookup"><span data-stu-id="3c6fc-123">For the Visual Basic constants and scripting strings for using the moniker connection, see [Setting the Default Process Security Level Using VBScript](setting-the-default-process-security-level-using-vbscript.md).</span></span>

<span data-ttu-id="3c6fc-124">A tabela a seguir lista as configurações padrão de representação, autenticação e serviço de autenticação do DCOM exigidas pelo computador de destino (computador B) em uma conexão remota.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-124">The following table lists the default DCOM impersonation, authentication, and authentication service settings required by the target computer (Computer B) in a remote connection.</span></span> <span data-ttu-id="3c6fc-125">Para obter mais informações, consulte protegendo uma conexão WMI remota.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-125">For more information, see Securing a Remote WMI Connection.</span></span>



| <span data-ttu-id="3c6fc-126">Sistema operacional do computador B</span><span class="sxs-lookup"><span data-stu-id="3c6fc-126">Computer B operating system</span></span> | <span data-ttu-id="3c6fc-127">Cadeia de caracteres de script de nível de representação</span><span class="sxs-lookup"><span data-stu-id="3c6fc-127">Impersonation level scripting string</span></span> | <span data-ttu-id="3c6fc-128">Cadeia de caracteres de script do nível de autenticação</span><span class="sxs-lookup"><span data-stu-id="3c6fc-128">Authentication level scripting string</span></span> | <span data-ttu-id="3c6fc-129">Serviço de autenticação</span><span class="sxs-lookup"><span data-stu-id="3c6fc-129">Authentication service</span></span> |
|-----------------------------|--------------------------------------|---------------------------------------|------------------------|
| <span data-ttu-id="3c6fc-130">Windows Vista ou posterior</span><span class="sxs-lookup"><span data-stu-id="3c6fc-130">Windows Vista or later</span></span>      | <span data-ttu-id="3c6fc-131">Impersonate</span><span class="sxs-lookup"><span data-stu-id="3c6fc-131">Impersonate</span></span>                          | <span data-ttu-id="3c6fc-132">PCT</span><span class="sxs-lookup"><span data-stu-id="3c6fc-132">Pkt</span></span>                                   | <span data-ttu-id="3c6fc-133">Kerberos</span><span class="sxs-lookup"><span data-stu-id="3c6fc-133">Kerberos</span></span>               |



 

<span data-ttu-id="3c6fc-134">As conexões remotas do WMI são afetadas pelo [controle de conta de usuário (UAC)](/previous-versions/aa905108(v=msdn.10)) e pelo [Firewall do Windows](https://www.microsoft.com/technet/itsolutions/network/wf/default.mspx).</span><span class="sxs-lookup"><span data-stu-id="3c6fc-134">WMI remote connections are affected by [User Account Control (UAC)](/previous-versions/aa905108(v=msdn.10)) and [Windows Firewall](https://www.microsoft.com/technet/itsolutions/network/wf/default.mspx).</span></span> <span data-ttu-id="3c6fc-135">Para obter mais informações, consulte [conectando-se ao WMI remotamente a partir do vista](connecting-to-wmi-remotely-starting-with-vista.md) e [conectando por meio do firewall do Windows](/windows/desktop/WmiSdk/connecting-to-wmi-remotely-starting-with-vista).</span><span class="sxs-lookup"><span data-stu-id="3c6fc-135">For more information, see [Connecting to WMI Remotely Starting with Vista](connecting-to-wmi-remotely-starting-with-vista.md) and [Connecting Through Windows Firewall](/windows/desktop/WmiSdk/connecting-to-wmi-remotely-starting-with-vista).</span></span>

<span data-ttu-id="3c6fc-136">Lembre-se de que conectar-se ao WMI no computador local tem um nível de autenticação padrão de **PktPrivacy**.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-136">Be aware that connecting to WMI on the local computer has a default authentication level of **PktPrivacy**.</span></span>

## <a name="setting-dcom-security-to-allow-a-user-to-access-a-computer-remotely"></a><span data-ttu-id="3c6fc-137">Definindo a segurança DCOM para permitir que um usuário acesse um computador remotamente</span><span class="sxs-lookup"><span data-stu-id="3c6fc-137">Setting DCOM Security to Allow a User to Access a Computer Remotely</span></span>

<span data-ttu-id="3c6fc-138">A segurança no WMI está relacionada à conexão com um namespace WMI.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-138">Security in WMI is related to connecting to a WMI namespace.</span></span> <span data-ttu-id="3c6fc-139">O WMI usa DCOM para lidar com chamadas remotas.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-139">WMI uses DCOM to handle remote calls.</span></span> <span data-ttu-id="3c6fc-140">Um motivo para a falha de conexão a um computador remoto é devido a uma falha DCOM (erro "DCOM Access Denied" decimal-2147024891 ou hex 0x80070005).</span><span class="sxs-lookup"><span data-stu-id="3c6fc-140">One reason for failure to connect to a remote computer is due to a DCOM failure (error "DCOM Access Denied" decimal -2147024891 or hex 0x80070005).</span></span> <span data-ttu-id="3c6fc-141">Para obter mais informações sobre segurança DCOM no WMI para aplicativos C++, consulte [definindo a segurança do processo do aplicativo cliente](setting-client-application-process-security.md).</span><span class="sxs-lookup"><span data-stu-id="3c6fc-141">For more information about DCOM security in WMI for C++ applications, see [Setting Client Application Process Security](setting-client-application-process-security.md).</span></span>

<span data-ttu-id="3c6fc-142">Você pode definir as configurações do DCOM para o WMI usando o utilitário de configuração do DCOM (**DCOMCnfg.exe**) encontrado em **Ferramentas administrativas** no **painel de controle**.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-142">You can configure DCOM settings for WMI using the DCOM Config utility (**DCOMCnfg.exe**) found in **Administrative Tools** in **Control Panel**.</span></span> <span data-ttu-id="3c6fc-143">Esse utilitário expõe as configurações que permitem que determinados usuários se conectem ao computador remotamente por meio do DCOM.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-143">This utility exposes the settings that enable certain users to connect to the computer remotely through DCOM.</span></span> <span data-ttu-id="3c6fc-144">Os membros do grupo Administradores têm permissão para se conectar remotamente ao computador por padrão.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-144">Members of the Administrators group are allowed to remotely connect to the computer by default.</span></span> <span data-ttu-id="3c6fc-145">Com esse utilitário, você pode definir a segurança para iniciar, acessar e configurar o serviço WMI.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-145">With this utility you can set the security to start, access, and configure the WMI service.</span></span>

<span data-ttu-id="3c6fc-146">O procedimento a seguir descreve como conceder permissões de inicialização remota DCOM e ativação para determinados usuários e grupos.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-146">The following procedure describes how to grant DCOM remote startup and activation permissions for certain users and groups.</span></span> <span data-ttu-id="3c6fc-147">Se o computador A estiver se conectando remotamente ao computador B, você poderá definir essas permissões no computador B para permitir que um usuário ou grupo que não faça parte do grupo Administradores no computador B execute chamadas de inicialização e ativação do DCOM no computador B.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-147">If Computer A is connecting remotely to Computer B, you can set these permissions on Computer B to allow a user or group that is not part of the Administrators group on Computer B to execute DCOM startup and activation calls on Computer B.</span></span>

<span data-ttu-id="3c6fc-148">**Para conceder permissões de inicialização remota de DCOM e ativação para um usuário ou grupo**</span><span class="sxs-lookup"><span data-stu-id="3c6fc-148">**To grant DCOM remote launch and activation permissions for a user or group**</span></span>

1.  <span data-ttu-id="3c6fc-149">Clique em **Iniciar**, **executar**, digite **DCOMCNFG** e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-149">Click **Start**, click **Run**, type **DCOMCNFG**, and then click **OK**.</span></span>
2.  <span data-ttu-id="3c6fc-150">Na caixa de diálogo **serviços de componentes** , expanda **serviços de componentes**, expanda **computadores** e clique com o botão direito do mouse em **meu computador** e clique em **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-150">In the **Component Services** dialog box, expand **Component Services**, expand **Computers**, and then right-click **My Computer** and click **Properties**.</span></span>
3.  <span data-ttu-id="3c6fc-151">Na caixa de diálogo **Propriedades do meu computador** , clique na guia **segurança com** .</span><span class="sxs-lookup"><span data-stu-id="3c6fc-151">In the **My Computer Properties** dialog box, click the **COM Security** tab.</span></span>
4.  <span data-ttu-id="3c6fc-152">Em **permissões de inicialização e ativação**, clique em **Editar limites**.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-152">Under **Launch and Activation Permissions**, click **Edit Limits**.</span></span>
5.  <span data-ttu-id="3c6fc-153">Na caixa de diálogo **permissão de inicialização** , siga estas etapas se o seu nome ou grupo não aparecer na **lista grupos ou nomes de usuário**:</span><span class="sxs-lookup"><span data-stu-id="3c6fc-153">In the **Launch Permission** dialog box, follow these steps if your name or your group does not appear in the **Groups or user names list**:</span></span>

    1.  <span data-ttu-id="3c6fc-154">Na caixa de diálogo **permissão de inicialização** , clique em **Adicionar**.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-154">In the **Launch Permission** dialog box, click **Add**.</span></span>
    2.  <span data-ttu-id="3c6fc-155">Na caixa de diálogo **Selecionar usuários, computadores ou grupos** , adicione seu nome e o grupo na caixa **digite os nomes de objeto a serem selecionados** e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-155">In the **Select Users, Computers, or Groups** dialog box, add your name and the group in the **Enter the object names to select** box, and then click **OK**.</span></span>

6.  <span data-ttu-id="3c6fc-156">Na caixa de diálogo **permissão de inicialização** , selecione o usuário e o grupo na caixa **nomes de grupo ou de usuário** .</span><span class="sxs-lookup"><span data-stu-id="3c6fc-156">In the **Launch Permission** dialog box, select your user and group in the **Group or user names** box.</span></span> <span data-ttu-id="3c6fc-157">Na coluna **permitir** em **permissões para usuário**, selecione **inicialização remota** e selecione **ativação remota** e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-157">In the **Allow** column under **Permissions for User**, select **Remote Launch** and select **Remote Activation**, and then click **OK**.</span></span>

<span data-ttu-id="3c6fc-158">O procedimento a seguir descreve como conceder permissões de acesso remoto DCOM para determinados usuários e grupos.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-158">The following procedure describes how to grant DCOM remote access permissions for certain users and groups.</span></span> <span data-ttu-id="3c6fc-159">Se o computador A estiver se conectando remotamente ao computador B, você poderá definir essas permissões no computador B para permitir que um usuário ou grupo que não faça parte do grupo de administradores no computador B se conecte ao computador B.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-159">If Computer A is connecting remotely to Computer B, you can set these permissions on Computer B to allow a user or group that is not part of the Administrators group on Computer B to connect to Computer B.</span></span>

<span data-ttu-id="3c6fc-160">**Para conceder permissões de acesso remoto DCOM**</span><span class="sxs-lookup"><span data-stu-id="3c6fc-160">**To grant DCOM remote access permissions**</span></span>

1.  <span data-ttu-id="3c6fc-161">Clique em **Iniciar**, **executar**, digite **DCOMCNFG** e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-161">Click **Start**, click **Run**, type **DCOMCNFG**, and then click **OK**.</span></span>
2.  <span data-ttu-id="3c6fc-162">Na caixa de diálogo **serviços de componentes** , expanda **serviços de componentes**, expanda **computadores** e clique com o botão direito do mouse em **meu computador** e clique em **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-162">In the **Component Services** dialog box, expand **Component Services**, expand **Computers**, and then right-click **My Computer** and click **Properties**.</span></span>
3.  <span data-ttu-id="3c6fc-163">Na caixa de diálogo **Propriedades do meu computador** , clique na guia **segurança com** .</span><span class="sxs-lookup"><span data-stu-id="3c6fc-163">In the **My Computer Properties** dialog box, click the **COM Security** tab.</span></span>
4.  <span data-ttu-id="3c6fc-164">Em **permissões de acesso**, clique em **Editar limites**.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-164">Under **Access Permissions**, click **Edit Limits**.</span></span>
5.  <span data-ttu-id="3c6fc-165">Na caixa de diálogo **permissão de acesso** , selecione nome de **logon anônimo** na caixa **nomes de grupo ou de usuário** .</span><span class="sxs-lookup"><span data-stu-id="3c6fc-165">In the **Access Permission** dialog box, select **ANONYMOUS LOGON** name in the **Group or user names** box.</span></span> <span data-ttu-id="3c6fc-166">Na coluna **permitir** , em **permissões para usuário**, selecione **acesso remoto** e clique em **OK**.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-166">In the **Allow** column under **Permissions for User**, select **Remote Access**, and then click **OK**.</span></span>

## <a name="allowing-users-access-to-a-specific-wmi-namespace"></a><span data-ttu-id="3c6fc-167">Permitindo que os usuários acessem um namespace WMI específico</span><span class="sxs-lookup"><span data-stu-id="3c6fc-167">Allowing Users Access to a Specific WMI Namespace</span></span>

<span data-ttu-id="3c6fc-168">Você pode permitir ou impedir que os usuários acessem um namespace WMI específico definindo a permissão "Habilitar remotamente" no controle WMI para um namespace.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-168">You can allow or disallow users access to a specific WMI namespace by setting the "Remote Enable" permission in the WMI Control for a namespace.</span></span> <span data-ttu-id="3c6fc-169">Se um usuário tentar se conectar a um namespace ao qual ele não tem permissão de acesso, ele receberá o erro 0x80041003.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-169">If a user tries to connect to a namespace they are not allowed access to, they will receive error 0x80041003.</span></span> <span data-ttu-id="3c6fc-170">Por padrão, essa permissão é habilitada somente para administradores.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-170">By default, this permission is enabled only for administrators.</span></span> <span data-ttu-id="3c6fc-171">Um administrador pode habilitar o acesso remoto a namespaces WMI específicos para um usuário não administrador.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-171">An administrator can enable remote access to specific WMI namespaces for a nonadministrator user.</span></span>

<span data-ttu-id="3c6fc-172">O procedimento a seguir define permissões de habilitação remota para um usuário não administrador.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-172">The following procedure sets remote enable permissions for a non-administrator user.</span></span>

<span data-ttu-id="3c6fc-173">**Para definir permissões de habilitação remota**</span><span class="sxs-lookup"><span data-stu-id="3c6fc-173">**To set remote enable permissions**</span></span>

1.  <span data-ttu-id="3c6fc-174">Conecte-se ao computador remoto usando o controle WMI.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-174">Connect to the remote computer using the WMI Control.</span></span>

    <span data-ttu-id="3c6fc-175">Para obter mais informações sobre o controle WMI, consulte [definindo a segurança do namespace com o controle WMI](setting-namespace-security-with-the-wmi-control.md).</span><span class="sxs-lookup"><span data-stu-id="3c6fc-175">For more information about the WMI Control, see [Setting Namespace Security with the WMI Control](setting-namespace-security-with-the-wmi-control.md).</span></span>

2.  <span data-ttu-id="3c6fc-176">Na guia **segurança** , selecione o namespace e clique em **segurança**.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-176">In the **Security** tab, select the namespace and click **Security**.</span></span>
3.  <span data-ttu-id="3c6fc-177">Localize a conta apropriada e marque **habilitar remotamente** na lista de **permissões** .</span><span class="sxs-lookup"><span data-stu-id="3c6fc-177">Locate the appropriate account and check **Remote Enable** in the **Permissions** list.</span></span>

## <a name="setting-namespace-security-to-require-data-encryption-for-remote-connections"></a><span data-ttu-id="3c6fc-178">Definindo a segurança do namespace para exigir a criptografia de dados para conexões remotas</span><span class="sxs-lookup"><span data-stu-id="3c6fc-178">Setting Namespace Security to Require Data Encryption for Remote Connections</span></span>

<span data-ttu-id="3c6fc-179">Um administrador ou um arquivo MOF pode configurar um namespace do WMI para que nenhum dado seja retornado, a menos que você use a privacidade do pacote (a **privacidade do PCT do \_ nível de \_ autenticação RPC \_ \_ \_ C** ou **PktPrivacy** como um moniker em um script) em uma conexão com esse namespace.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-179">An administrator or a MOF file can configure a WMI namespace so that no data is returned unless you use packet privacy (**RPC\_C\_AUTHN\_LEVEL\_PKT\_PRIVACY** or **PktPrivacy** as a moniker in a script) in a connection to that namespace.</span></span> <span data-ttu-id="3c6fc-180">Isso garante que os dados sejam criptografados enquanto atravessam a rede.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-180">This ensures that data is encrypted as it crosses the network.</span></span> <span data-ttu-id="3c6fc-181">Se você tentar definir um nível de autenticação inferior, receberá uma mensagem de acesso negado.</span><span class="sxs-lookup"><span data-stu-id="3c6fc-181">If you try to set a lower authentication level, you will get an access denied message.</span></span> <span data-ttu-id="3c6fc-182">Para obter mais informações, consulte [exigindo uma conexão criptografada para um namespace](requiring-an-encrypted-connection-to-a-namespace.md).</span><span class="sxs-lookup"><span data-stu-id="3c6fc-182">For more information, see [Requiring an Encrypted Connection to a Namespace](requiring-an-encrypted-connection-to-a-namespace.md).</span></span>

<span data-ttu-id="3c6fc-183">O exemplo de código VBScript a seguir mostra como se conectar a um namespace criptografado usando "pktPrivacy".</span><span class="sxs-lookup"><span data-stu-id="3c6fc-183">The following VBScript code example shows how to connect to an encrypted namespace using "pktPrivacy".</span></span>


```VB
strComputer = "RemoteComputer"
Set objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate,authenticationLevel=pktPrivacy}!\\" _
                              & strComputer & "\root\EncryptedNamespace")
```



## <a name="related-topics"></a><span data-ttu-id="3c6fc-184">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="3c6fc-184">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3c6fc-185">Delegando com WMI</span><span class="sxs-lookup"><span data-stu-id="3c6fc-185">Delegating with WMI</span></span>](connecting-to-a-3rd-computer-delegation.md)
</dt> <dt>

[<span data-ttu-id="3c6fc-186">Criando processos remotamente com o WMI</span><span class="sxs-lookup"><span data-stu-id="3c6fc-186">Creating Processes Remotely with WMI</span></span>](creating-processes-remotely.md)
</dt> <dt>

[<span data-ttu-id="3c6fc-187">Protegendo clientes e provedores do C++</span><span class="sxs-lookup"><span data-stu-id="3c6fc-187">Securing C++ Clients and Providers</span></span>](securing-c---clients-and-providers.md)
</dt> <dt>

[<span data-ttu-id="3c6fc-188">Protegendo clientes de script</span><span class="sxs-lookup"><span data-stu-id="3c6fc-188">Securing Scripting Clients</span></span>](securing-scripting-clients.md)
</dt> </dl>

 

 
