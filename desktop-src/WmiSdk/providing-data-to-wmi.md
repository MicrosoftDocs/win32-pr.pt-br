---
description: O WMI torna os dados sobre os objetos gerenciáveis do Windows disponíveis por meio de provedores WMI.
ms.assetid: 74558c6e-28b6-479f-9de6-2fbad793ae26
ms.tgt_platform: multiple
title: Fornecendo dados ao WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 60df0384bd6f512b931870775067d9d9e6d4077d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103647695"
---
# <a name="providing-data-to-wmi"></a><span data-ttu-id="43b9b-103">Fornecendo dados ao WMI</span><span class="sxs-lookup"><span data-stu-id="43b9b-103">Providing Data to WMI</span></span>

<span data-ttu-id="43b9b-104">O WMI torna os dados sobre os objetos gerenciáveis do Windows disponíveis por meio de [*provedores*](gloss-p.md)WMI.</span><span class="sxs-lookup"><span data-stu-id="43b9b-104">WMI makes data about Windows manageable objects available through WMI [*providers*](gloss-p.md).</span></span> <span data-ttu-id="43b9b-105">Um provedor recupera dados de um componente do sistema, como um processo, ou um aplicativo instrumentado, como SNMP ou IIS, e passa esses dados por meio do WMI para um aplicativo de gerenciamento.</span><span class="sxs-lookup"><span data-stu-id="43b9b-105">A provider retrieves data from a system component, such as a process, or an instrumented application, such as SNMP or IIS, and passes that data through WMI to a management application.</span></span> <span data-ttu-id="43b9b-106">Por exemplo, quando um aplicativo ou script solicita informações de processo usando a classe de [**\_ processo WMI Win32**](/windows/desktop/CIMWin32Prov/win32-process) , os dados são obtidos dinamicamente por meio de um provedor pré-instalado.</span><span class="sxs-lookup"><span data-stu-id="43b9b-106">For example, when an application or script requests process information using the WMI [**Win32\_Process**](/windows/desktop/CIMWin32Prov/win32-process) class, the data is obtained dynamically through a preinstalled provider.</span></span>

<span data-ttu-id="43b9b-107">As seções a seguir são discutidas neste tópico:</span><span class="sxs-lookup"><span data-stu-id="43b9b-107">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="43b9b-108">Criando um modelo para um objeto gerenciável</span><span class="sxs-lookup"><span data-stu-id="43b9b-108">Creating a Model for a Manageable Object</span></span>](#creating-a-model-for-a-manageable-object)
-   [<span data-ttu-id="43b9b-109">Implementando um modelo para um objeto gerenciável</span><span class="sxs-lookup"><span data-stu-id="43b9b-109">Implementing a Model for a Manageable Object</span></span>](#implementing-a-model-for-a-manageable-object)
-   [<span data-ttu-id="43b9b-110">Determinando um tipo de provedor a ser implementado</span><span class="sxs-lookup"><span data-stu-id="43b9b-110">Determining a Provider Type to Implement</span></span>](#determining-a-provider-type-to-implement)
-   [<span data-ttu-id="43b9b-111">Determinando um modelo de hospedagem (implementação) para um provedor</span><span class="sxs-lookup"><span data-stu-id="43b9b-111">Determining a Hosting (Implementation) Model for a Provider</span></span>](#determining-a-hosting-implementation-model-for-a-provider)
-   [<span data-ttu-id="43b9b-112">Implementando um provedor</span><span class="sxs-lookup"><span data-stu-id="43b9b-112">Implementing a Provider</span></span>](#implementing-a-provider)
-   [<span data-ttu-id="43b9b-113">Registrando um provedor com o WMI e o sistema</span><span class="sxs-lookup"><span data-stu-id="43b9b-113">Registering a Provider with WMI and the System</span></span>](#registering-a-provider-with-wmi-and-the-system)
-   [<span data-ttu-id="43b9b-114">Testando um provedor</span><span class="sxs-lookup"><span data-stu-id="43b9b-114">Testing a Provider</span></span>](#testing-a-provider)
-   [<span data-ttu-id="43b9b-115">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="43b9b-115">Related topics</span></span>](#related-topics)

## <a name="creating-a-model-for-a-manageable-object"></a><span data-ttu-id="43b9b-116">Criando um modelo para um objeto gerenciável</span><span class="sxs-lookup"><span data-stu-id="43b9b-116">Creating a Model for a Manageable Object</span></span>

<span data-ttu-id="43b9b-117">Antes de desenvolver um provedor, crie um modelo de dados para representar o objeto gerenciável a ser exposto por meio do WMI.</span><span class="sxs-lookup"><span data-stu-id="43b9b-117">Before developing a provider, create a data model to represent the manageable object to be exposed through WMI.</span></span> <span data-ttu-id="43b9b-118">Você planeja quais objetos de dados seu provedor vai expor.</span><span class="sxs-lookup"><span data-stu-id="43b9b-118">You plan which data objects your provider will expose.</span></span> <span data-ttu-id="43b9b-119">Por exemplo, se você planeja gerenciar a resolução de tela do plano de fundo da área de trabalho, você deve decidir como modelar a área de trabalho em um arquivo [*formato MOF (MOF)*](gloss-m.md) .</span><span class="sxs-lookup"><span data-stu-id="43b9b-119">For example, if you plan to manage the screen resolution of the desktop background, you must decide how to model the Desktop in a [*Managed Object Format (MOF)*](gloss-m.md) file.</span></span>

<span data-ttu-id="43b9b-120">Para criar um modelo útil:</span><span class="sxs-lookup"><span data-stu-id="43b9b-120">To create a useful model:</span></span>

-   <span data-ttu-id="43b9b-121">Determine cenários do mundo real e modele as informações que um cliente talvez queira ler e atualizar (por exemplo, alterar a imagem de plano de fundo) para cada objeto gerenciável.</span><span class="sxs-lookup"><span data-stu-id="43b9b-121">Determine real world scenarios and model the information a customer may want to read and update (for example, changing the background image) for each manageable object.</span></span> <span data-ttu-id="43b9b-122">Essas são suas propriedades de classe.</span><span class="sxs-lookup"><span data-stu-id="43b9b-122">These are your class properties.</span></span>
-   <span data-ttu-id="43b9b-123">Determine o tipo de ações que um cliente pode querer executar com cada objeto gerenciável.</span><span class="sxs-lookup"><span data-stu-id="43b9b-123">Determine which kind of actions a customer may want to perform with each manageable object.</span></span> <span data-ttu-id="43b9b-124">Esses são seus métodos.</span><span class="sxs-lookup"><span data-stu-id="43b9b-124">These are your methods.</span></span>

## <a name="implementing-a-model-for-a-manageable-object"></a><span data-ttu-id="43b9b-125">Implementando um modelo para um objeto gerenciável</span><span class="sxs-lookup"><span data-stu-id="43b9b-125">Implementing a Model for a Manageable Object</span></span>

<span data-ttu-id="43b9b-126">Para implementar um modelo para objetos gerenciáveis, crie um arquivo MOF contendo uma classe WMI que represente cada objeto.</span><span class="sxs-lookup"><span data-stu-id="43b9b-126">To implement a model for manageable objects, create a MOF file containing a WMI class that represents each object.</span></span> <span data-ttu-id="43b9b-127">Para obter mais informações sobre como criar um arquivo MOF para definir classes WMI, consulte [Designing formato MOF (MOF) classes](designing-managed-object-format--mof--classes.md).</span><span class="sxs-lookup"><span data-stu-id="43b9b-127">For more information about creating a MOF file to define WMI classes, see [Designing Managed Object Format (MOF) Classes](designing-managed-object-format--mof--classes.md).</span></span> <span data-ttu-id="43b9b-128">O registro do provedor e suas classes geralmente são incluídos no arquivo MOF, embora seja possível usar a [API com](com-api-for-wmi.md) para criar classes e métodos.</span><span class="sxs-lookup"><span data-stu-id="43b9b-128">The registration of the provider and its classes are usually included in the MOF file, although it is possible to use the [COM API](com-api-for-wmi.md) to create classes and methods.</span></span> <span data-ttu-id="43b9b-129">Para obter mais informações, consulte [desenvolvendo um provedor WMI](developing-a-wmi-provider.md).</span><span class="sxs-lookup"><span data-stu-id="43b9b-129">For more information, see [Developing a WMI Provider](developing-a-wmi-provider.md).</span></span>

> [!Note]  
> <span data-ttu-id="43b9b-130">Para garantir que todas as definições de classe WMI para objetos gerenciados sejam restauradas no [*repositório WMI*](gloss-w.md) se o WMI tiver uma falha e reiniciar, use a instrução de pré-processador de [**\# AutoRecuperação pragma**](pragma-autorecover.md) em seu arquivo [*formato MOF (MOF)*](gloss-m.md) .</span><span class="sxs-lookup"><span data-stu-id="43b9b-130">To ensure that all your WMI class definitions for managed objects are restored to the [*WMI repository*](gloss-w.md) if WMI has a failure and restarts, use the [**\#pragma autorecover**](pragma-autorecover.md) preprocessor instruction in your [*Managed Object Format (MOF)*](gloss-m.md) file.</span></span>

 

<span data-ttu-id="43b9b-131">Depois de criar o arquivo MOF, compile-o usando a ferramenta [**Mofcomp.exe**](mofcomp.md) .</span><span class="sxs-lookup"><span data-stu-id="43b9b-131">After you create the MOF file, compile it using the [**Mofcomp.exe**](mofcomp.md) tool.</span></span> <span data-ttu-id="43b9b-132">Isso notifica você sobre erros no arquivo MOF e adiciona a classe WMI definida no arquivo MOF ao [*repositório WMI*](gloss-w.md) para que a classe possa ser usada por um provedor.</span><span class="sxs-lookup"><span data-stu-id="43b9b-132">This notifies you of errors in your MOF file, and adds the WMI class defined in the MOF file to the [*WMI repository*](gloss-w.md) so that the class can be used by a provider.</span></span>

## <a name="determining-a-provider-type-to-implement"></a><span data-ttu-id="43b9b-133">Determinando um tipo de provedor a ser implementado</span><span class="sxs-lookup"><span data-stu-id="43b9b-133">Determining a Provider Type to Implement</span></span>

<span data-ttu-id="43b9b-134">O WMI dá suporte a um determinado número de tipos de provedor, que determina a natureza das informações entregues e as operações com suporte dos provedores.</span><span class="sxs-lookup"><span data-stu-id="43b9b-134">WMI supports a certain number of provider types, which determines the nature of the information delivered and operations supported by the providers.</span></span>

<span data-ttu-id="43b9b-135">Os tipos de provedor são:</span><span class="sxs-lookup"><span data-stu-id="43b9b-135">The provider types are:</span></span>

-   [<span data-ttu-id="43b9b-136">*Provedor de instância*</span><span class="sxs-lookup"><span data-stu-id="43b9b-136">*Instance provider*</span></span>](gloss-i.md)
-   [<span data-ttu-id="43b9b-137">*Provedor de método*</span><span class="sxs-lookup"><span data-stu-id="43b9b-137">*Method provider*</span></span>](gloss-m.md)
-   [<span data-ttu-id="43b9b-138">*Provedor de propriedades*</span><span class="sxs-lookup"><span data-stu-id="43b9b-138">*Property provider*</span></span>](gloss-p.md)
-   <span data-ttu-id="43b9b-139">Provedor de classe</span><span class="sxs-lookup"><span data-stu-id="43b9b-139">Class provider</span></span>
-   [<span data-ttu-id="43b9b-140">*Provedor de eventos*</span><span class="sxs-lookup"><span data-stu-id="43b9b-140">*Event provider*</span></span>](gloss-e.md)
-   [<span data-ttu-id="43b9b-141">*Provedor de consumidor de eventos*</span><span class="sxs-lookup"><span data-stu-id="43b9b-141">*Event consumer provider*</span></span>](gloss-e.md)
-   [<span data-ttu-id="43b9b-142">*Provedor de associação*</span><span class="sxs-lookup"><span data-stu-id="43b9b-142">*Association provider*</span></span>](gloss-a.md)

<span data-ttu-id="43b9b-143">A grande maioria dos provedores são provedores de instâncias e provedores de métodos.</span><span class="sxs-lookup"><span data-stu-id="43b9b-143">The vast majority of providers are instance providers and method providers.</span></span> <span data-ttu-id="43b9b-144">Um provedor de instância é o provedor mais comum e fornece as instâncias de uma determinada classe.</span><span class="sxs-lookup"><span data-stu-id="43b9b-144">An instance provider is the most common provider, and it supplies the instances of a given class.</span></span> <span data-ttu-id="43b9b-145">Um provedor de método implementa os métodos de uma ou mais classes.</span><span class="sxs-lookup"><span data-stu-id="43b9b-145">A method provider implements the methods of one or more classes.</span></span> <span data-ttu-id="43b9b-146">Para obter mais informações sobre os tipos de provedores, consulte [desenvolvendo um provedor WMI](developing-a-wmi-provider.md).</span><span class="sxs-lookup"><span data-stu-id="43b9b-146">For more information about the types of providers, see [Developing a WMI Provider](developing-a-wmi-provider.md).</span></span>

## <a name="determining-a-hosting-implementation-model-for-a-provider"></a><span data-ttu-id="43b9b-147">Determinando um modelo de hospedagem (implementação) para um provedor</span><span class="sxs-lookup"><span data-stu-id="43b9b-147">Determining a Hosting (Implementation) Model for a Provider</span></span>

<span data-ttu-id="43b9b-148">Provedores WMI são binários implementados como objetos COM.</span><span class="sxs-lookup"><span data-stu-id="43b9b-148">WMI providers are binaries implemented as COM objects.</span></span> <span data-ttu-id="43b9b-149">Isso significa que cada provedor tem um arquivo DLL que pode ser executado dentro de um processo e contexto de segurança específicos.</span><span class="sxs-lookup"><span data-stu-id="43b9b-149">This means that each provider has a DLL file which can be executed within a specific process and security context.</span></span> <span data-ttu-id="43b9b-150">Isso é o que o WMI se refere como o [*modelo de hospedagem*](gloss-h.md).</span><span class="sxs-lookup"><span data-stu-id="43b9b-150">This is what WMI refers to as the [*hosting model*](gloss-h.md).</span></span> <span data-ttu-id="43b9b-151">O WMI oferece várias maneiras de hospedar provedores, mas a abordagem mais comum é usar o modelo de provedor acoplado (em execução no processo WMI) no contexto de segurança NetworkServiceHost.</span><span class="sxs-lookup"><span data-stu-id="43b9b-151">WMI offers various ways to host providers, but the most common approach is to use the coupled provider model (running under the WMI process) in the NetworkServiceHost security context.</span></span> <span data-ttu-id="43b9b-152">Um provedor WMI pode ser classificado como acoplado [*ou*](gloss-d.md)dissociado.</span><span class="sxs-lookup"><span data-stu-id="43b9b-152">A WMI provider can be classified as either coupled or [*decoupled*](gloss-d.md).</span></span>

<span data-ttu-id="43b9b-153">O termo de provedor acoplado ou dissociado determina sob qual processo de host o provedor está sendo executado em relação ao processo de WMIPRVSE.EXE fornecido pelo WMI.</span><span class="sxs-lookup"><span data-stu-id="43b9b-153">The term coupled or decoupled provider determines under which host process the provider is running with respect to the WMI provided WMIPRVSE.EXE process.</span></span> <span data-ttu-id="43b9b-154">Uma prática recomendada é determinar se os dados de gerenciamento que o provedor expõe e a API ou o aplicativo do qual ele depende estão sempre disponíveis no sistema ou não.</span><span class="sxs-lookup"><span data-stu-id="43b9b-154">A best practice is to determine if the management data that the provider exposes and the API or application it relies on are always available in the system or not.</span></span> <span data-ttu-id="43b9b-155">Se a API ou o aplicativo do qual o provedor depende estiver sempre disponível (em execução no sistema), o provedor deverá ser um provedor acoplado, caso contrário, deve ser um provedor desacoplado.</span><span class="sxs-lookup"><span data-stu-id="43b9b-155">If the API or application the provider relies on is always available (running on the system), then the provider should be a coupled provider, if not, it must be a decoupled provider.</span></span> <span data-ttu-id="43b9b-156">Para obter mais informações sobre modelos de hospedagem, consulte [provedor de hospedagem e segurança](provider-hosting-and-security.md).</span><span class="sxs-lookup"><span data-stu-id="43b9b-156">For more information about hosting models, see [Provider Hosting and Security](provider-hosting-and-security.md).</span></span>

<span data-ttu-id="43b9b-157">Para obter mais informações sobre como criar um provedor acoplado, consulte [fornecendo dados ao WMI escrevendo um provedor](supplying-data-to-wmi-by-writing-a-provider.md)e para obter informações sobre como incorporar um provedor dissociado em um aplicativo, consulte [incorporando um provedor em um aplicativo](incorporating-a-provider-in-an-application.md).</span><span class="sxs-lookup"><span data-stu-id="43b9b-157">For more information about creating a coupled provider, see [Supplying Data to WMI by Writing a Provider](supplying-data-to-wmi-by-writing-a-provider.md), and for information about incorporating a decoupled provider in an application, see [Incorporating a Provider in an Application](incorporating-a-provider-in-an-application.md).</span></span>

<span data-ttu-id="43b9b-158">Provedores acoplados podem ser descritos como em processo (em processamento) ou fora de processo (fora do procedimento).</span><span class="sxs-lookup"><span data-stu-id="43b9b-158">Coupled providers can be described as in-process (in-proc) or out-of-process (out-of-proc).</span></span> <span data-ttu-id="43b9b-159">Quando um provedor acoplado é um provedor em processo, ele é executado em um processo de hospedagem do WMI WMIPRVSE.EXE compartilhado e é implementado como um servidor no proc (. dll) COM.</span><span class="sxs-lookup"><span data-stu-id="43b9b-159">When a coupled provider is an in-proc provider, it runs under a shared WMIPRVSE.EXE WMI hosting process and is implemented as a COM in-proc server (.dll).</span></span> <span data-ttu-id="43b9b-160">Quando um provedor é um provedor fora do processo, ele é iniciado pela WMI na solicitação de um cliente ou evento, mas é executado como um processo separado e é implementado como um executável (. exe).</span><span class="sxs-lookup"><span data-stu-id="43b9b-160">When a provider is an out-of-proc provider, it is started by WMI on request of a client or event, but it runs as a separated process and is implemented as an executable (.exe).</span></span>

## <a name="implementing-a-provider"></a><span data-ttu-id="43b9b-161">Implementando um provedor</span><span class="sxs-lookup"><span data-stu-id="43b9b-161">Implementing a Provider</span></span>

<span data-ttu-id="43b9b-162">Um provedor pode ser implementado das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="43b9b-162">A provider can be implemented in the following ways:</span></span>

-   <span data-ttu-id="43b9b-163">Usando o assistente de ATL no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="43b9b-163">Using the ATL Wizard in Visual Studio.</span></span>

    <span data-ttu-id="43b9b-164">O assistente do ATL gera o código do provedor que implementa um provedor acoplado.</span><span class="sxs-lookup"><span data-stu-id="43b9b-164">The ATL Wizard generates provider code that implements a coupled provider.</span></span> <span data-ttu-id="43b9b-165">Ao usar o assistente ATL, você pode especificar que deseja criar um modelo de tempo de execução (. dll) ou fora do processo (. exe) no procedimento.</span><span class="sxs-lookup"><span data-stu-id="43b9b-165">While using the ATL Wizard, you can specify that you want to create an in-proc (.dll) or out-of-proc (.exe) provider run-time model.</span></span>

-   <span data-ttu-id="43b9b-166">Definindo um objeto COM para conter seu provedor.</span><span class="sxs-lookup"><span data-stu-id="43b9b-166">Defining a COM object to contain your provider.</span></span>

    <span data-ttu-id="43b9b-167">O código do provedor é escrito em C++.</span><span class="sxs-lookup"><span data-stu-id="43b9b-167">The provider code is written in C++.</span></span> <span data-ttu-id="43b9b-168">Para obter mais informações, consulte [fornecendo dados ao WMI escrevendo um provedor](supplying-data-to-wmi-by-writing-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="43b9b-168">For more information, see [Supplying Data to WMI by Writing a Provider](supplying-data-to-wmi-by-writing-a-provider.md).</span></span>

-   <span data-ttu-id="43b9b-169">Usando as classes no namespace [**Microsoft. Management. Infrastructure**](/previous-versions//hh872326(v=vs.85)) no .NET Framework para criar um provedor usando código gerenciado.</span><span class="sxs-lookup"><span data-stu-id="43b9b-169">Using the classes in the [**Microsoft.Management.Infrastructure**](/previous-versions//hh872326(v=vs.85)) namespace in the .NET Framework to create a provider using managed code.</span></span> <span data-ttu-id="43b9b-170">(Não há mais suporte para o namespace **System. Management. Instrumentation** .)</span><span class="sxs-lookup"><span data-stu-id="43b9b-170">(The **System.Management.Instrumentation** namespace is no longer supported.)</span></span>

    <span data-ttu-id="43b9b-171">Esse processo cria um provedor dissociado.</span><span class="sxs-lookup"><span data-stu-id="43b9b-171">This process creates a decoupled provider.</span></span>

## <a name="registering-a-provider-with-wmi-and-the-system"></a><span data-ttu-id="43b9b-172">Registrando um provedor com o WMI e o sistema</span><span class="sxs-lookup"><span data-stu-id="43b9b-172">Registering a Provider with WMI and the System</span></span>

<span data-ttu-id="43b9b-173">Antes de usar o provedor de um consumidor, é importante registrá-lo no sistema WMI e no subsistema COM do Windows.</span><span class="sxs-lookup"><span data-stu-id="43b9b-173">Before using the provider from a consumer, it is important to register it with the WMI system and the Windows COM subsystem.</span></span>

<span data-ttu-id="43b9b-174">Um arquivo MOF pode conter vários tipos de provedores para as mesmas classes.</span><span class="sxs-lookup"><span data-stu-id="43b9b-174">A MOF file can contain multiple types of providers for the same classes.</span></span> <span data-ttu-id="43b9b-175">O mesmo nome de provedor é registrado como, por exemplo, uma instância ou um provedor de métodos.</span><span class="sxs-lookup"><span data-stu-id="43b9b-175">The same provider name is registered as, for example, an instance or a method provider.</span></span> <span data-ttu-id="43b9b-176">Para obter mais informações, consulte [registrando um provedor](registering-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="43b9b-176">For more information, see [Registering a Provider](registering-a-provider.md).</span></span>

## <a name="testing-a-provider"></a><span data-ttu-id="43b9b-177">Testando um provedor</span><span class="sxs-lookup"><span data-stu-id="43b9b-177">Testing a Provider</span></span>

<span data-ttu-id="43b9b-178">Quando o código do provedor é registrado, é importante testar corretamente o provedor usando o provedor de consumidores diferentes (por exemplo, scripts, código gerenciado do .NET e consumidores do C++).</span><span class="sxs-lookup"><span data-stu-id="43b9b-178">When the provider code is registered, it is important to properly test the provider by using the provider from different consumers (for example, scripts, .NET managed code, and C++ consumers).</span></span>

<span data-ttu-id="43b9b-179">Execute as seguintes tarefas para testar seu provedor:</span><span class="sxs-lookup"><span data-stu-id="43b9b-179">Perform the following tasks to test your provider:</span></span>

-   <span data-ttu-id="43b9b-180">Verifique se o provedor está carregando corretamente rastreando as notificações de evento do [**MSFT \_ WmiProvider \_ OperationEvent**](/previous-versions/windows/desktop/wmisystemprov/msft-wmiprovider-operationevent) .</span><span class="sxs-lookup"><span data-stu-id="43b9b-180">Ensure that your provider is loading properly by tracking the [**MSFT\_WmiProvider\_OperationEvent**](/previous-versions/windows/desktop/wmisystemprov/msft-wmiprovider-operationevent) event notifications.</span></span> <span data-ttu-id="43b9b-181">Esses eventos informarão sobre quaisquer falhas de carregamento do provedor.</span><span class="sxs-lookup"><span data-stu-id="43b9b-181">These events will inform you about any provider load failures.</span></span> <span data-ttu-id="43b9b-182">Outras classes de solução de problemas que podem ser úteis são [**Win32 \_ ProcessStartTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstarttrace) e [**Win32 \_ ProcessStopTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstoptrace).</span><span class="sxs-lookup"><span data-stu-id="43b9b-182">Other troubleshooting classes that may be helpful are [**Win32\_ProcessStartTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstarttrace) and [**Win32\_ProcessStopTrace**](/previous-versions/windows/desktop/krnlprov/win32-processstoptrace).</span></span> <span data-ttu-id="43b9b-183">Para obter mais informações sobre como solucionar problemas de provedores, consulte [Depurando provedores](debugging-providers.md) e [configuração de provedor e classes de solução de problemas](provider-configuration-and-troubleshooting-classes.md).</span><span class="sxs-lookup"><span data-stu-id="43b9b-183">For more information about troubleshooting providers, see [Debugging Providers](debugging-providers.md) and [Provider Configuration and Troubleshooting Classes](provider-configuration-and-troubleshooting-classes.md).</span></span>
-   <span data-ttu-id="43b9b-184">Se o provedor for uma instância ou um provedor de métodos, certifique-se de testar cada recurso de provedor, um por um, para evitar confusão na seguinte lógica de código.</span><span class="sxs-lookup"><span data-stu-id="43b9b-184">If the provider is an instance or method provider, ensure you test each provider capability one-by-one to avoid confusion in following your code logic.</span></span>
-   <span data-ttu-id="43b9b-185">Para um provedor de instância, crie um aplicativo cliente ou script que invoca todas as interfaces do provedor (Enumeração, Get, PUT e Delete).</span><span class="sxs-lookup"><span data-stu-id="43b9b-185">For an instance provider, create a client application or script that invokes every interface of the provider (enumeration, get, put, and delete).</span></span> <span data-ttu-id="43b9b-186">Mesmo que o provedor não deva implementar nada, ele deve retornar uma mensagem "sem suporte".</span><span class="sxs-lookup"><span data-stu-id="43b9b-186">Even if the provider is not supposed to implement anything, it should return a "not supported" message.</span></span> <span data-ttu-id="43b9b-187">Você pode encontrar os valores de retorno já definidos nos [códigos de retorno do WMI](wmi-return-codes.md).</span><span class="sxs-lookup"><span data-stu-id="43b9b-187">You can find the return values already defined in [WMI Return Codes](wmi-return-codes.md).</span></span>
-   <span data-ttu-id="43b9b-188">Para garantir que o contexto de segurança desejado esteja funcionando como planejado, invoque as operações com suporte do provedor de um contexto de segurança não administrador.</span><span class="sxs-lookup"><span data-stu-id="43b9b-188">To ensure that the desired security context is working as planned, invoke the provider supported operations from a nonadministrator security context.</span></span> <span data-ttu-id="43b9b-189">O provedor deve dar suporte à representação.</span><span class="sxs-lookup"><span data-stu-id="43b9b-189">The provider must support impersonation.</span></span> <span data-ttu-id="43b9b-190">Se um usuário sem as credenciais de segurança corretas tentar atualizar dados ou executar uma operação que execute um método, seu provedor deverá negar o acesso com a mensagem de erro apropriada.</span><span class="sxs-lookup"><span data-stu-id="43b9b-190">If a user lacking the correct security credentials tries to update data or perform an operation that executes a method, your provider should deny access with the appropriate error message.</span></span>
-   <span data-ttu-id="43b9b-191">Para obter mais informações sobre a segurança do provedor, consulte [protegendo seu provedor](securing-your-provider.md).</span><span class="sxs-lookup"><span data-stu-id="43b9b-191">For more information about provider security, see [Securing Your Provider](securing-your-provider.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="43b9b-192">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="43b9b-192">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="43b9b-193">Desenvolvendo um provedor WMI</span><span class="sxs-lookup"><span data-stu-id="43b9b-193">Developing a WMI Provider</span></span>](developing-a-wmi-provider.md)
</dt> <dt>

[<span data-ttu-id="43b9b-194">Hospedagem e segurança de provedor</span><span class="sxs-lookup"><span data-stu-id="43b9b-194">Provider Hosting and Security</span></span>](provider-hosting-and-security.md)
</dt> <dt>

[<span data-ttu-id="43b9b-195">Fornecendo dados ao WMI escrevendo um provedor</span><span class="sxs-lookup"><span data-stu-id="43b9b-195">Supplying Data to WMI by Writing a Provider</span></span>](supplying-data-to-wmi-by-writing-a-provider.md)
</dt> <dt>

[<span data-ttu-id="43b9b-196">Incorporando um provedor em um aplicativo</span><span class="sxs-lookup"><span data-stu-id="43b9b-196">Incorporating a Provider in an Application</span></span>](incorporating-a-provider-in-an-application.md)
</dt> <dt>

[<span data-ttu-id="43b9b-197">Registrando um provedor</span><span class="sxs-lookup"><span data-stu-id="43b9b-197">Registering a Provider</span></span>](registering-a-provider.md)
</dt> <dt>

[<span data-ttu-id="43b9b-198">Solucionando problemas de aplicativos cliente WMI</span><span class="sxs-lookup"><span data-stu-id="43b9b-198">Troubleshooting WMI Client Applications</span></span>](troubleshooting-wmi-client-applications.md)
</dt> <dt>

[<span data-ttu-id="43b9b-199">Protegendo seu provedor</span><span class="sxs-lookup"><span data-stu-id="43b9b-199">Securing Your Provider</span></span>](securing-your-provider.md)
</dt> <dt>

[<span data-ttu-id="43b9b-200">Obtenção e fornecimento de dados em uma plataforma de 64 bits</span><span class="sxs-lookup"><span data-stu-id="43b9b-200">Getting and Providing Data on a 64-bit Platform</span></span>](getting-and-providing-data-on-a-64-bit-computer.md)
</dt> </dl>

 

 
