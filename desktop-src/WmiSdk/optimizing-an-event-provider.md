---
description: Um provedor de eventos pode dedicar bastante tempo para a criação de eventos.
ms.assetid: 5cf414f0-b3a8-4623-9aaa-08e2a28b40c0
ms.tgt_platform: multiple
title: Otimizando um provedor de eventos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 70eaabfbbd462b831059b10590d7959bdef05cbc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105765253"
---
# <a name="optimizing-an-event-provider"></a><span data-ttu-id="ab351-103">Otimizando um provedor de eventos</span><span class="sxs-lookup"><span data-stu-id="ab351-103">Optimizing an Event Provider</span></span>

<span data-ttu-id="ab351-104">Um provedor de eventos pode dedicar bastante tempo para a criação de eventos.</span><span class="sxs-lookup"><span data-stu-id="ab351-104">An event provider may devote a great deal of time to creating events.</span></span> <span data-ttu-id="ab351-105">Se nenhum aplicativo cliente usar os eventos criados, o provedor estará desperdiçando recursos do sistema.</span><span class="sxs-lookup"><span data-stu-id="ab351-105">If no client applications use the created events, then the provider is wasting system resources.</span></span> <span data-ttu-id="ab351-106">Além disso, o WMI gasta uma quantidade considerável de recursos analisando e enviando consultas complexas para o provedor apropriado.</span><span class="sxs-lookup"><span data-stu-id="ab351-106">Further, WMI spends a considerable amount of resources parsing and sending complex queries to the appropriate provider.</span></span> <span data-ttu-id="ab351-107">Para evitar o desperdício de recursos do sistema e melhorar o desempenho do seu provedor de eventos, você pode implementar a interface [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) .</span><span class="sxs-lookup"><span data-stu-id="ab351-107">To avoid the waste of system resources and to improve the performance of your event provider, you can implement the [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink) interface.</span></span> <span data-ttu-id="ab351-108">O **IWbemEventProviderQuerySink** monitora as consultas que os aplicativos cliente registram com o WMI usando os métodos [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) e [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) .</span><span class="sxs-lookup"><span data-stu-id="ab351-108">**IWbemEventProviderQuerySink** monitors the queries that client applications register with WMI by using the [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) and [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) methods.</span></span> <span data-ttu-id="ab351-109">Ao monitorar as consultas de cliente registradas, seu provedor pode determinar e se qualquer mensagem deve ser enviada ao WMI.</span><span class="sxs-lookup"><span data-stu-id="ab351-109">By monitoring the registered client queries, your provider can determine what if any messages must be sent to WMI.</span></span>

<span data-ttu-id="ab351-110">O WMI chama [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) em um provedor de eventos quando um consumidor cliente registra uma consulta de filtro de eventos que contém referências a eventos com suporte pelo provedor de eventos.</span><span class="sxs-lookup"><span data-stu-id="ab351-110">WMI calls [**NewQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-newquery) on an event provider when a client consumer registers an event filter query that contains references to events supported by that event provider.</span></span> <span data-ttu-id="ab351-111">Portanto, o provedor de eventos responsável por eventos de modificação de instância para a classe **EmailClass** pode ser configurado para gerar notificações somente para o **remetente**.</span><span class="sxs-lookup"><span data-stu-id="ab351-111">So the event provider responsible for instance modification events for the **EmailClass** class can be set up to generate notifications only for **sender**.</span></span> <span data-ttu-id="ab351-112">Quando o provedor recebe uma consulta solicitando a notificação de alterações para a propriedade **Subject** , o provedor pode começar a gerar essas notificações.</span><span class="sxs-lookup"><span data-stu-id="ab351-112">When the provider receives a query requesting notification of changes to the **subject** property, the provider can start generating those notifications.</span></span> <span data-ttu-id="ab351-113">Nesse cenário, o WMI não é necessário para descartar as notificações que relatam apenas as alterações de **destinatário** .</span><span class="sxs-lookup"><span data-stu-id="ab351-113">In this scenario, WMI is not required to discard the notifications that report **recipient** changes only.</span></span>

<span data-ttu-id="ab351-114">Da mesma forma, o WMI chama [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) em um provedor de eventos quando um consumidor de cliente cancela o registro de uma consulta de filtro de eventos que contém referências a eventos com suporte no provedor de eventos.</span><span class="sxs-lookup"><span data-stu-id="ab351-114">Similarly, WMI calls [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery) on an event provider when a client consumer deregisters an event filter query that contains references to events supported by the event provider.</span></span> <span data-ttu-id="ab351-115">A finalidade de **CancelQuery** é que o provedor de eventos atualize a lista de quais eventos devem ser enviados.</span><span class="sxs-lookup"><span data-stu-id="ab351-115">The purpose of **CancelQuery** is for the event provider to update the list of what events should be sent out.</span></span>

> [!Note]  
> <span data-ttu-id="ab351-116">Se seu provedor oferecer suporte a [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) e [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink), verifique se a implementação do método **IUnknown:: QueryInterface** retorna ponteiros para ambas as interfaces.</span><span class="sxs-lookup"><span data-stu-id="ab351-116">If your provider supports both [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) and [**IWbemEventProviderQuerySink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink), ensure that your implementation of the **IUnknown::QueryInterface** method returns pointers to both interfaces.</span></span>

 

 

 



