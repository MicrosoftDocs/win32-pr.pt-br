---
description: Um provedor é um objeto de Component Object Model (COM) que atua como um intermediário entre o WMI e um objeto gerenciado.
ms.assetid: a4f537ba-9081-43b4-acff-4d206de3d9d7
ms.tgt_platform: multiple
title: Desenvolvendo um provedor WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9249c251f75f08f9e5142e70a507b0dced8f91df
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105812078"
---
# <a name="developing-a-wmi-provider"></a><span data-ttu-id="a19c8-103">Desenvolvendo um provedor WMI</span><span class="sxs-lookup"><span data-stu-id="a19c8-103">Developing a WMI Provider</span></span>

<span data-ttu-id="a19c8-104">Um provedor é um objeto de Component Object Model (COM) que atua como um intermediário entre o WMI e um objeto gerenciado.</span><span class="sxs-lookup"><span data-stu-id="a19c8-104">A provider is a Component Object Model (COM) object that acts as an intermediary between WMI and a managed object.</span></span> <span data-ttu-id="a19c8-105">Por exemplo, quando um aplicativo ou script solicita dados de disco usando a classe do [**\_ LOGICALDISK**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) do WMI Win32, os dados são obtidos dinamicamente por meio do [Provedor Win32](/windows/desktop/CIMWin32Prov/win32-provider)pré-instalado.</span><span class="sxs-lookup"><span data-stu-id="a19c8-105">For example, when an application or script requests disk data using the WMI [**Win32\_LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) class, the data is obtained dynamically through the preinstalled [Win32 provider](/windows/desktop/CIMWin32Prov/win32-provider).</span></span>

<span data-ttu-id="a19c8-106">Se você quiser fornecer dados por meio do WMI para outros aplicativos, poderá criar um provedor de código não gerenciado escrevendo um servidor COM ou por meio de **assistentes WMI ATL** no Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a19c8-106">If you want to supply data through WMI to other applications, you can create an unmanaged code provider by writing a COM server or through the **WMI ATL wizards** in Visual Studio.</span></span> <span data-ttu-id="a19c8-107">Você pode escrever um provedor de código gerenciado usando o WMI na .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="a19c8-107">You can write a managed code provider by using WMI in the .NET Framework.</span></span> <span data-ttu-id="a19c8-108">Os tópicos nesta seção descrevem o processo de gravação de um provedor COM não gerenciado.</span><span class="sxs-lookup"><span data-stu-id="a19c8-108">The topics in this section describe the process of writing an unmanaged COM provider.</span></span>

> [!Note]  
> <span data-ttu-id="a19c8-109">Para garantir que todas as suas definições de classe WMI para objetos gerenciados sejam restauradas no [*repositório WMI*](gloss-w.md) se o WMI tiver uma falha e for reiniciado, use a instrução de pré-processador de [**\# AutoRecuperação pragma**](pragma-autorecover.md) no seu arquivo formato MOF (MOF).</span><span class="sxs-lookup"><span data-stu-id="a19c8-109">To ensure that all of your WMI class definitions for managed objects are restored to the [*WMI repository*](gloss-w.md) if WMI has a failure and restarts, use the [**\#pragma autorecover**](pragma-autorecover.md) preprocessor instruction in your Managed Object Format (MOF) file.</span></span>

 

<span data-ttu-id="a19c8-110">Um provedor consiste em classes definidas no esquema [*formato MOF (MOF)*](gloss-m.md) e em um arquivo dll que executa as funções do provedor.</span><span class="sxs-lookup"><span data-stu-id="a19c8-110">A provider consists of classes defined in the [*Managed Object Format (MOF)*](gloss-m.md) schema and a DLL file which carries out the functions of the provider.</span></span> <span data-ttu-id="a19c8-111">Por exemplo, o MOF que define as classes do provedor Win32 é CIMWin32. mof e a DLL é CIMWin32.dll, ambos são encontrados em% windir% \\ System32 \\ WBEM.</span><span class="sxs-lookup"><span data-stu-id="a19c8-111">For example, the MOF that defines the classes of the Win32 provider is CIMWin32.mof and the DLL is CIMWin32.dll, both are found in %windir%\\System32\\Wbem.</span></span>

<span data-ttu-id="a19c8-112">O esquema MOF para o provedor pode conter vários tipos de provedor.</span><span class="sxs-lookup"><span data-stu-id="a19c8-112">The MOF schema for the provider may contain several provider types.</span></span> <span data-ttu-id="a19c8-113">Por exemplo, o [provedor de log de eventos](/previous-versions/windows/desktop/eventlogprov/event-log-provider) tem instância, método e tipos de provedor de eventos em um arquivo MOF chamado Ntevt. mof.</span><span class="sxs-lookup"><span data-stu-id="a19c8-113">For example, the [Event Log Provider](/previous-versions/windows/desktop/eventlogprov/event-log-provider) has instance, method, and event provider types in one MOF file named Ntevt.mof.</span></span> <span data-ttu-id="a19c8-114">É recomendável que todas as classes e o esquema de registro para provedores relacionados sejam montados em um arquivo, em vez de criar um arquivo por classe.</span><span class="sxs-lookup"><span data-stu-id="a19c8-114">It is recommended that all of the classes and registration schema for related providers be assembled in one file, rather than creating one file per class.</span></span>

<span data-ttu-id="a19c8-115">Além de usar provedores pré-instalados, você pode criar seu próprio provedor para fornecer informações sobre um dispositivo de hardware ou as operações do software.</span><span class="sxs-lookup"><span data-stu-id="a19c8-115">In addition to using preinstalled providers, you can create your own provider to supply information about a hardware device or the operations of software.</span></span>

<span data-ttu-id="a19c8-116">A tabela a seguir lista as tarefas básicas que criam um provedor.</span><span class="sxs-lookup"><span data-stu-id="a19c8-116">The following table lists the basic tasks that create a provider.</span></span>



| <span data-ttu-id="a19c8-117">Tarefa</span><span class="sxs-lookup"><span data-stu-id="a19c8-117">Task</span></span>                                                                                                                                                            | <span data-ttu-id="a19c8-118">Descrição</span><span class="sxs-lookup"><span data-stu-id="a19c8-118">Description</span></span>                                                                                                                                      |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a19c8-119">Criando classes formato MOF (MOF)</span><span class="sxs-lookup"><span data-stu-id="a19c8-119">Designing Managed Object Format (MOF) Classes</span></span>](designing-managed-object-format--mof--classes.md)                                                              | <span data-ttu-id="a19c8-120">Desenvolva um modelo para as entidades que você deseja gerenciar por meio do WMI e crie um arquivo formato MOF (MOF) para descrever o esquema.</span><span class="sxs-lookup"><span data-stu-id="a19c8-120">Develop a model for the entities you want to manage through WMI and create a Managed Object Format (MOF) file to describe the schema.</span></span><br/> |
| [<span data-ttu-id="a19c8-121">Fornecendo dados ao WMI escrevendo um provedor</span><span class="sxs-lookup"><span data-stu-id="a19c8-121">Supplying Data to WMI by Writing a Provider</span></span>](supplying-data-to-wmi-by-writing-a-provider.md)                                                                  | <span data-ttu-id="a19c8-122">Crie o provedor mais básico que está acoplado ao WMI.</span><span class="sxs-lookup"><span data-stu-id="a19c8-122">Create the most basic provider that is coupled to WMI.</span></span><br/>                                                                                |
| [<span data-ttu-id="a19c8-123">Incorporando um provedor em um aplicativo</span><span class="sxs-lookup"><span data-stu-id="a19c8-123">Incorporating a Provider in an Application</span></span>](incorporating-a-provider-in-an-application.md)                                                                    | <span data-ttu-id="a19c8-124">Inclua o provedor como um componente em um aplicativo se ele não for executado o tempo todo.</span><span class="sxs-lookup"><span data-stu-id="a19c8-124">Include the provider as a component within an application if it does not run all of the time.</span></span><br/>                                         |
| [<span data-ttu-id="a19c8-125">Registrando um provedor</span><span class="sxs-lookup"><span data-stu-id="a19c8-125">Registering a Provider</span></span>](registering-a-provider.md)                                                                                                            | <span data-ttu-id="a19c8-126">Registre o provedor com com e WMI.</span><span class="sxs-lookup"><span data-stu-id="a19c8-126">Register the provider with COM and WMI.</span></span><br/>                                                                                               |
| [<span data-ttu-id="a19c8-127">Inicializando um provedor</span><span class="sxs-lookup"><span data-stu-id="a19c8-127">Initializing a Provider</span></span>](initializing-a-provider.md)                                                                                                          | <span data-ttu-id="a19c8-128">Implemente as interfaces [**IWbemProviderInit**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) e [**IWbemProviderInitSink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinitsink) .</span><span class="sxs-lookup"><span data-stu-id="a19c8-128">Implement the [**IWbemProviderInit**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) and [**IWbemProviderInitSink**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinitsink) interfaces.</span></span><br/>   |
| [<span data-ttu-id="a19c8-129">Fazendo chamadas para o WMI</span><span class="sxs-lookup"><span data-stu-id="a19c8-129">Making Calls to WMI</span></span>](making-calls-to-wmi.md)                                                                                                                  | <span data-ttu-id="a19c8-130">Chamar interfaces WMI de um provedor.</span><span class="sxs-lookup"><span data-stu-id="a19c8-130">Call WMI interfaces from a provider.</span></span><br/>                                                                                                  |
| [<span data-ttu-id="a19c8-131">Representando um cliente</span><span class="sxs-lookup"><span data-stu-id="a19c8-131">Impersonating a Client</span></span>](impersonating-a-client.md)                                                                                                            | <span data-ttu-id="a19c8-132">Defina a segurança para acessar um aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="a19c8-132">Set security to access a client application.</span></span><br/>                                                                                          |
| [<span data-ttu-id="a19c8-133">Atualizando um provedor</span><span class="sxs-lookup"><span data-stu-id="a19c8-133">Updating a Provider</span></span>](updating-a-provider.md)                                                                                                                  | <span data-ttu-id="a19c8-134">Melhore o provedor conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="a19c8-134">Improve the provider as needed.</span></span><br/>                                                                                                       |
| [<span data-ttu-id="a19c8-135">Descarregando um provedor</span><span class="sxs-lookup"><span data-stu-id="a19c8-135">Unloading a Provider</span></span>](unloading-a-provider.md)                                                                                                                | <span data-ttu-id="a19c8-136">Remova o provedor da memória durante o desligamento ou quando o provedor estiver ocioso.</span><span class="sxs-lookup"><span data-stu-id="a19c8-136">Remove the provider from memory during shutdown or when the provider is idle.</span></span><br/>                                                         |
| <span data-ttu-id="a19c8-137">[Depurando provedores](debugging-providers.md) e [configuração de provedor e classes de solução de problemas](provider-configuration-and-troubleshooting-classes.md)</span><span class="sxs-lookup"><span data-stu-id="a19c8-137">[Debugging Providers](debugging-providers.md) and [Provider Configuration and Troubleshooting Classes](provider-configuration-and-troubleshooting-classes.md)</span></span> | <span data-ttu-id="a19c8-138">Depure seu provedor usando os recursos fornecidos pelo WMI.</span><span class="sxs-lookup"><span data-stu-id="a19c8-138">Debug your provider using facilities supplied by WMI.</span></span><br/>                                                                                 |
| [<span data-ttu-id="a19c8-139">Obter e fornecer dados em um computador de 64 bits</span><span class="sxs-lookup"><span data-stu-id="a19c8-139">Getting and Providing Data on a 64-bit Computer</span></span>](getting-and-providing-data-on-a-64-bit-computer.md)                                                          | <span data-ttu-id="a19c8-140">Avalie se você precisa de um provedor de compatibilidade de aplicativos de 32 bits ou se o provedor de 64 bits pode fornecer dados para ambos os clientes.</span><span class="sxs-lookup"><span data-stu-id="a19c8-140">Evaluate whether you need a 32-bit application compatibility provider or if the 64-bit provider can supply data to both clients.</span></span><br/>      |



 

<span data-ttu-id="a19c8-141">Os tópicos a seguir discutem as etapas necessárias para escrever diferentes tipos de provedores:</span><span class="sxs-lookup"><span data-stu-id="a19c8-141">The following topics discuss the steps needed to write different types of providers:</span></span>

-   [<span data-ttu-id="a19c8-142">Gravando um provedor de instância</span><span class="sxs-lookup"><span data-stu-id="a19c8-142">Writing an Instance Provider</span></span>](writing-an-instance-provider.md)
-   [<span data-ttu-id="a19c8-143">Escrevendo um provedor de métodos</span><span class="sxs-lookup"><span data-stu-id="a19c8-143">Writing a Method Provider</span></span>](writing-a-method-provider.md)
-   [<span data-ttu-id="a19c8-144">Escrevendo um provedor de eventos</span><span class="sxs-lookup"><span data-stu-id="a19c8-144">Writing an Event Provider</span></span>](writing-an-event-provider.md)
-   [<span data-ttu-id="a19c8-145">Escrevendo um provedor de consumidor de eventos</span><span class="sxs-lookup"><span data-stu-id="a19c8-145">Writing an Event Consumer Provider</span></span>](writing-an-event-consumer-provider.md)
-   [<span data-ttu-id="a19c8-146">Escrevendo um provedor de classe</span><span class="sxs-lookup"><span data-stu-id="a19c8-146">Writing a Class Provider</span></span>](writing-a-class-provider.md)
-   [<span data-ttu-id="a19c8-147">Gravando um provedor de propriedades</span><span class="sxs-lookup"><span data-stu-id="a19c8-147">Writing a Property Provider</span></span>](writing-a-property-provider.md)
-   [<span data-ttu-id="a19c8-148">Criando um provedor de instância em um provedor de High-Performance</span><span class="sxs-lookup"><span data-stu-id="a19c8-148">Making an Instance Provider into a High-Performance Provider</span></span>](making-an-instance-provider-into-a-high-performance-provider.md)

 

