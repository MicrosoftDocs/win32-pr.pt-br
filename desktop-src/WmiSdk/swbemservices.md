---
description: Você pode usar os métodos de um objeto SWbemServices para executar operações em um namespace em um host local ou em um host remoto. Este objeto não pode ser criado pela chamada VBScript CreateObject.
ms.assetid: 7fcfa404-2fe6-42e5-85ac-64536f6d2a44
ms.tgt_platform: multiple
title: Objeto SWbemServices (Wbemdisp. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- SWbemServices
- ISWbemServices
api_type:
- COM
api_location:
- Wbemdisp.dll
ms.openlocfilehash: 4303b3226acc6d773ed35e77176e05e3a58c567d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105811716"
---
# <a name="swbemservices-object"></a><span data-ttu-id="6d1c2-104">Objeto SWbemServices</span><span class="sxs-lookup"><span data-stu-id="6d1c2-104">SWbemServices object</span></span>

<span data-ttu-id="6d1c2-105">Você pode usar os métodos de um objeto **SWbemServices** para executar operações em um namespace em um host local ou em um host remoto.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-105">You can use the methods of an **SWbemServices** object to perform operations against a namespace on either a local host or a remote host.</span></span> <span data-ttu-id="6d1c2-106">Este objeto não pode ser criado pela chamada VBScript **CreateObject** .</span><span class="sxs-lookup"><span data-stu-id="6d1c2-106">This object cannot be created by the VBScript **CreateObject** call.</span></span>

## <a name="members"></a><span data-ttu-id="6d1c2-107">Membros</span><span class="sxs-lookup"><span data-stu-id="6d1c2-107">Members</span></span>

<span data-ttu-id="6d1c2-108">O objeto **SWbemServices** tem estes tipos de membros:</span><span class="sxs-lookup"><span data-stu-id="6d1c2-108">The **SWbemServices** object has these types of members:</span></span>

-   [<span data-ttu-id="6d1c2-109">Métodos</span><span class="sxs-lookup"><span data-stu-id="6d1c2-109">Methods</span></span>](#methods)
-   [<span data-ttu-id="6d1c2-110">Propriedades</span><span class="sxs-lookup"><span data-stu-id="6d1c2-110">Properties</span></span>](#properties)

### <a name="methods"></a><span data-ttu-id="6d1c2-111">Métodos</span><span class="sxs-lookup"><span data-stu-id="6d1c2-111">Methods</span></span>

<span data-ttu-id="6d1c2-112">O objeto **SWbemServices** tem esses métodos.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-112">The **SWbemServices** object has these methods.</span></span>



| <span data-ttu-id="6d1c2-113">Método</span><span class="sxs-lookup"><span data-stu-id="6d1c2-113">Method</span></span>                                                                         | <span data-ttu-id="6d1c2-114">Descrição</span><span class="sxs-lookup"><span data-stu-id="6d1c2-114">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|:-------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6d1c2-115">**AssociatorsOf**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-115">**AssociatorsOf**</span></span>](swbemservices-associatorsof.md)                           | <span data-ttu-id="6d1c2-116">Recupera as instâncias de recursos gerenciados que estão associados a um recurso especificado por meio de uma ou mais classes de associação.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-116">Retrieves the instances of managed resources that are associated with a specified resource through one or more association classes.</span></span> <span data-ttu-id="6d1c2-117">Você fornece o caminho do objeto para o ponto de extremidade de origem e [**AssociatorsOf**](swbemservices-associatorsof.md) retorna os recursos gerenciados no ponto de extremidade oposto.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-117">You provide the object path for the originating endpoint, and [**AssociatorsOf**](swbemservices-associatorsof.md) returns the managed resources at the opposite endpoint.</span></span> <span data-ttu-id="6d1c2-118">O método **AssociatorsOf** executa a mesma função que a consulta WQL "ASSOCIATORS of" executa.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-118">The **AssociatorsOf** method performs the same function that the "ASSOCIATORS OF" WQL query performs.</span></span><br/>                                                                           |
| [<span data-ttu-id="6d1c2-119">**AssociatorsOfAsync**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-119">**AssociatorsOfAsync**</span></span>](swbemservices-associatorsofasync.md)                 | <span data-ttu-id="6d1c2-120">De forma assíncrona retorna uma coleção de objetos (classes ou instâncias) que estão associados a um objeto especificado.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-120">Asynchronously returns a collection of objects (classes or instances) that are associated with a specified object.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="6d1c2-121">**Apagar**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-121">**Delete**</span></span>](swbemservices-delete.md)                                         | <span data-ttu-id="6d1c2-122">Exclui uma instância de um recurso gerenciado (ou uma definição de classe do repositório CIM).</span><span class="sxs-lookup"><span data-stu-id="6d1c2-122">Deletes an instance of a managed resource (or a class definition from the CIM repository).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="6d1c2-123">**DeleteAsync**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-123">**DeleteAsync**</span></span>](swbemservices-deleteasync.md)                               | <span data-ttu-id="6d1c2-124">Exclui de forma assíncrona a classe ou instância especificada no caminho do objeto.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-124">Asynchronously deletes the class or instance that is specified in the object path.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="6d1c2-125">**ExecMethod**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-125">**ExecMethod**</span></span>](swbemservices-execmethod.md)                                 | <span data-ttu-id="6d1c2-126">Fornece uma maneira alternativa para executar um método definido por uma definição de classe de recurso gerenciado.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-126">Provides an alternative way to execute a method defined by a managed resource class definition.</span></span> <span data-ttu-id="6d1c2-127">Usado principalmente em situações em que a linguagem de script não dá suporte a parâmetros de saída.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-127">Primarily used in situations in which the scripting language does not support out parameters.</span></span> <span data-ttu-id="6d1c2-128">Por exemplo, o JScript não dá suporte a parâmetros de saída.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-128">For example, JScript does not support out parameters.</span></span><br/>                                                                                                                                                                                                                                            |
| [<span data-ttu-id="6d1c2-129">**ExecMethodAsync**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-129">**ExecMethodAsync**</span></span>](swbemservices-execmethodasync.md)                       | <span data-ttu-id="6d1c2-130">Executa de forma assíncrona um método que é exportado por um provedor de método.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-130">Asynchronously executes a method that is exported by a method provider.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="6d1c2-131">**ExecNotificationQuery**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-131">**ExecNotificationQuery**</span></span>](swbemservices-execnotificationquery.md)           | <span data-ttu-id="6d1c2-132">Executa uma consulta de assinatura de evento para receber eventos.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-132">Executes an event subscription query to receive events.</span></span> <span data-ttu-id="6d1c2-133">Uma consulta de assinatura de evento é uma consulta que define uma alteração no ambiente gerenciado que você deseja monitorar.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-133">An event subscription query is a query that defines a change to the managed environment that you want to monitor.</span></span> <span data-ttu-id="6d1c2-134">Quando a alteração ocorre, a infraestrutura do WMI fornece um evento que descreve a alteração no script de chamada.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-134">When the change occurs, the WMI infrastructure delivers an event describing the change to the calling script.</span></span><br/>                                                                                                                                                                                                        |
| [<span data-ttu-id="6d1c2-135">**ExecNotificationQueryAsync**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-135">**ExecNotificationQueryAsync**</span></span>](swbemservices-execnotificationqueryasync.md) | <span data-ttu-id="6d1c2-136">Executa de forma assíncrona uma consulta para receber eventos.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-136">Asynchronously executes a query to receive events.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| [<span data-ttu-id="6d1c2-137">**ExecQuery**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-137">**ExecQuery**</span></span>](swbemservices-execquery.md)                                   | <span data-ttu-id="6d1c2-138">Executa uma consulta para recuperar uma coleção de instâncias de recursos gerenciados por WMI (ou definições de classe).</span><span class="sxs-lookup"><span data-stu-id="6d1c2-138">Executes a query to retrieve a collection of instances of WMI-managed resources (or class definitions).</span></span> <span data-ttu-id="6d1c2-139">[**ExecQuery**](swbemservices-execquery.md) pode ser usado para recuperar uma coleção filtrada de instâncias que correspondem aos critérios que você define na consulta passada para **ExecQuery**.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-139">[**ExecQuery**](swbemservices-execquery.md) can be used to retrieve a filtered collection of instances that match criteria you define in the query passed to **ExecQuery**.</span></span><br/>                                                                                                                                                                                                           |
| [<span data-ttu-id="6d1c2-140">**ExecQueryAsync**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-140">**ExecQueryAsync**</span></span>](swbemservices-execqueryasync.md)                         | <span data-ttu-id="6d1c2-141">Executa de forma assíncrona uma consulta para recuperar objetos.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-141">Asynchronously executes a query to retrieve objects.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [<span data-ttu-id="6d1c2-142">**Obter**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-142">**Get**</span></span>](swbemservices-get.md)                                               | <span data-ttu-id="6d1c2-143">Recupera uma única instância de um recurso gerenciado (ou definição de classe) com base em um caminho de objeto.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-143">Retrieves a single instance of a managed resource (or class definition) based on an object path.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="6d1c2-144">**Getasync**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-144">**GetAsync**</span></span>](swbemservices-getasync.md)                                     | <span data-ttu-id="6d1c2-145">Recupera de forma assíncrona um objeto, que é uma definição de classe ou uma instância, com base no caminho do objeto.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-145">Asynchronously retrieves an object, that is either a class definition or an instance, based on the object path.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="6d1c2-146">**InstancesOf**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-146">**InstancesOf**</span></span>](swbemservices-instancesof.md)                               | <span data-ttu-id="6d1c2-147">Recupera todas as instâncias de um recurso gerenciado com base em um nome de classe.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-147">Retrieves all the instances of a managed resource based on a class name.</span></span> <span data-ttu-id="6d1c2-148">Por padrão, o [**InstancesOf**](swbemservices-instancesof.md) executa uma recuperação profunda.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-148">By default, [**InstancesOf**](swbemservices-instancesof.md) performs a deep retrieval.</span></span> <span data-ttu-id="6d1c2-149">Ou seja, **InstancesOf** recupera as instâncias do recurso identificado pelo nome de classe passado para o método e também recupera todas as instâncias de todos os recursos que são subclasses (definidos abaixo) da classe de destino.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-149">That is, **InstancesOf** retrieves the instances of the resource identified by the class name passed to the method and also retrieves all the instances of all the resources that are subclasses (defined beneath) of the target class.</span></span><br/>                                                                                       |
| [<span data-ttu-id="6d1c2-150">**InstancesOfAsync**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-150">**InstancesOfAsync**</span></span>](swbemservices-instancesofasync.md)                     | <span data-ttu-id="6d1c2-151">Retorna de forma assíncrona as instâncias de uma classe especificada de acordo com os critérios de seleção especificados pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-151">Asynchronously returns the instances of a specified class according to the user-specified selection criteria.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                  |
| [<span data-ttu-id="6d1c2-152">**Referências a**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-152">**ReferencesTo**</span></span>](swbemservices-referencesto.md)                             | <span data-ttu-id="6d1c2-153">Retorna todas as associações que fazem referência a um recurso especificado.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-153">Returns all of the associations that reference a specified resource.</span></span> <span data-ttu-id="6d1c2-154">A melhor maneira de entender [**referênciasto**](swbemservices-referencesto.md) é compará-la com o método [**AssociatorsOf**](swbemservices-associatorsof.md) .</span><span class="sxs-lookup"><span data-stu-id="6d1c2-154">The best way to understand [**ReferencesTo**](swbemservices-referencesto.md) is to compare it with the [**AssociatorsOf**](swbemservices-associatorsof.md) method.</span></span> <span data-ttu-id="6d1c2-155">**AssociatorsOf** retorna os recursos dinâmicos que estão na extremidade oposta de uma associação.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-155">**AssociatorsOf** returns the dynamic resources that are at the opposite end of an association.</span></span> <span data-ttu-id="6d1c2-156">**References** para retorna a associação em si.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-156">**ReferencesTo** returns the association itself.</span></span> <span data-ttu-id="6d1c2-157">O método **References** executa a mesma função que as "referências de" consulta WQL executa.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-157">The **ReferencesTo** method performs the same function that the "REFERENCES OF" WQL query performs.</span></span><br/> |
| [<span data-ttu-id="6d1c2-158">**ReferencesToAsync**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-158">**ReferencesToAsync**</span></span>](swbemservices-referencesto.md)                        | <span data-ttu-id="6d1c2-159">Retorna de forma assíncrona uma coleção de todas as classes ou instâncias de associação que se referem a uma classe ou instância específica.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-159">Asynchronously returns a collection of all association classes or instances that refer to a specific class or instance.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                        |
| [<span data-ttu-id="6d1c2-160">**SubclassesOf**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-160">**SubclassesOf**</span></span>](swbemservices-subclassesof.md)                             | <span data-ttu-id="6d1c2-161">Recupera todas as subclasses de uma classe especificada do repositório CIM.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-161">Retrieves all the subclasses of a specified class from the CIM repository.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="6d1c2-162">**SubclassesOfAsync**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-162">**SubclassesOfAsync**</span></span>](swbemservices-subclassesofasync.md)                   | <span data-ttu-id="6d1c2-163">De forma assíncrona retorna uma coleção de subclasses para uma classe especificada.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-163">Asynchronously returns a collection of subclasses for a specified class.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                       |



 

### <a name="properties"></a><span data-ttu-id="6d1c2-164">Propriedades</span><span class="sxs-lookup"><span data-stu-id="6d1c2-164">Properties</span></span>

<span data-ttu-id="6d1c2-165">O objeto **SWbemServices** tem essas propriedades.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-165">The **SWbemServices** object has these properties.</span></span>



| <span data-ttu-id="6d1c2-166">Propriedade</span><span class="sxs-lookup"><span data-stu-id="6d1c2-166">Property</span></span>                                                 | <span data-ttu-id="6d1c2-167">Tipo de acesso</span><span class="sxs-lookup"><span data-stu-id="6d1c2-167">Access type</span></span>          | <span data-ttu-id="6d1c2-168">Descrição</span><span class="sxs-lookup"><span data-stu-id="6d1c2-168">Description</span></span>                                                                          |
|:---------------------------------------------------------|:---------------------|:-------------------------------------------------------------------------------------|
| [<span data-ttu-id="6d1c2-169">**Segurança\_**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-169">**Security\_**</span></span>](swbemservices-security-.md)<br/> | <span data-ttu-id="6d1c2-170">Somente leitura</span><span class="sxs-lookup"><span data-stu-id="6d1c2-170">Read-only</span></span><br/> | <span data-ttu-id="6d1c2-171">Usado para obter ou definir as configurações de segurança para um objeto **SWbemServices** .</span><span class="sxs-lookup"><span data-stu-id="6d1c2-171">Used to get or set the security settings for an **SWbemServices** object.</span></span><br/> |



 

## <a name="remarks"></a><span data-ttu-id="6d1c2-172">Comentários</span><span class="sxs-lookup"><span data-stu-id="6d1c2-172">Remarks</span></span>

<span data-ttu-id="6d1c2-173">Os métodos podem ser chamados no modo síncrono, no modo assíncrono ou no modo semisynchronous.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-173">The methods can be called in either the synchronous mode, the asynchronous mode, or the semisynchronous mode.</span></span> <span data-ttu-id="6d1c2-174">Para obter mais informações, consulte [chamando um método](calling-a-method.md).</span><span class="sxs-lookup"><span data-stu-id="6d1c2-174">For more information see [Calling a Method](calling-a-method.md).</span></span>

<span data-ttu-id="6d1c2-175">**Visão geral**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-175">**Overview**</span></span>

<span data-ttu-id="6d1c2-176">**SWbemServices** atende a duas funções principais.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-176">**SWbemServices** serves two primary roles.</span></span> <span data-ttu-id="6d1c2-177">Primeiro, o objeto **SWbemServices** representa uma conexão autenticada a um namespace WMI em um computador de destino.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-177">First, the **SWbemServices** object represents an authenticated connection to a WMI namespace on a target computer.</span></span> <span data-ttu-id="6d1c2-178">Em segundo lugar, **SWbemServices** é o objeto de automação que você usa para recuperar recursos gerenciados por WMI.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-178">Second, **SWbemServices** is the Automation object you use to retrieve WMI-managed resources.</span></span> <span data-ttu-id="6d1c2-179">Você pode obter uma referência a um objeto **SWbemServices** de uma das duas maneiras:</span><span class="sxs-lookup"><span data-stu-id="6d1c2-179">You can obtain a reference to an **SWbemServices** object in either of two ways:</span></span>

-   <span data-ttu-id="6d1c2-180">Conforme demonstrado na maioria dos scripts WMI apresentados até agora, você pode usar a função VBScript [**GetObject**](https://msdn.microsoft.com/library/e9waz863(v=VS.71).aspx) em combinação com o moniker WMI "winmgmts:".</span><span class="sxs-lookup"><span data-stu-id="6d1c2-180">As demonstrated in most of the WMI scripts presented thus far, you can use the VBScript [**GetObject**](https://msdn.microsoft.com/library/e9waz863(v=VS.71).aspx) function in combination with the WMI moniker "winmgmts:".</span></span> <span data-ttu-id="6d1c2-181">O exemplo a seguir é a forma mais simples de uma conexão WMI.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-181">The following example is the simplest form of a WMI connection.</span></span> <span data-ttu-id="6d1c2-182">O exemplo se conecta ao namespace padrão (normalmente "raiz \\ CIMv2") no computador local:</span><span class="sxs-lookup"><span data-stu-id="6d1c2-182">The example connects to the default namespace (typically "Root\\CIMv2") on the local computer:</span></span>

    `Set objSWbemServices = GetObject("winmgmts:")`

-   <span data-ttu-id="6d1c2-183">Você também pode usar o método [**ConnectServer**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemlocator-connectserver) do objeto [**SWbemLocator**](swbemlocator.md) para obter uma referência a um objeto **SWbemServices** .</span><span class="sxs-lookup"><span data-stu-id="6d1c2-183">You can also use the [**SWbemLocator**](swbemlocator.md) object [**ConnectServer**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemlocator-connectserver) method to obtain a reference to an **SWbemServices** object.</span></span>

<span data-ttu-id="6d1c2-184">Depois de obter uma referência a um objeto **SWbemServices** , use a referência de objeto para chamar 1 de 18 métodos disponíveis usando **SWbemServices**.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-184">After you obtain a reference to an **SWbemServices** object, you use the object reference to call 1 of 18 methods available using **SWbemServices**.</span></span> <span data-ttu-id="6d1c2-185">**SWbemServices** pode retornar um dos três objetos de biblioteca de script WMI diferentes ([**SWbemObjectSet**](swbemobjectset.md), [**SWbemObject**](swbemobject.md)ou [**SWbemEventSource**](swbemeventsource.md)), dependendo do método que você chama.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-185">**SWbemServices** can return one of three different WMI scripting library objects ([**SWbemObjectSet**](swbemobjectset.md), [**SWbemObject**](swbemobject.md), or [**SWbemEventSource**](swbemeventsource.md)), depending on the method you call.</span></span> <span data-ttu-id="6d1c2-186">Saber o tipo de objeto que cada método retorna ajudará a determinar a próxima etapa que seu script deve tomar.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-186">Knowing the type of object each method returns will help you determine the next step your script must take.</span></span> <span data-ttu-id="6d1c2-187">Por exemplo, se você retornar um **SWbemObjectSet**, deverá enumerar a coleção para acessar cada **SWbemObject** na coleção.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-187">For example, if you get back an **SWbemObjectSet**, you must enumerate the collection to access each **SWbemObject** in the collection.</span></span> <span data-ttu-id="6d1c2-188">Se você retornar um **SWbemObject**, poderá acessar imediatamente os métodos e as propriedades do objeto sem enumerar a coleção primeiro.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-188">If you get back an **SWbemObject**, you can immediately access the object methods and properties without enumerating the collection first.</span></span>

<span data-ttu-id="6d1c2-189">**Modos de operação**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-189">**Modes of Operation**</span></span>

<span data-ttu-id="6d1c2-190">O **SWbemServices** dá suporte a três modos de operação: síncrono, assíncrono e semisynchronous.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-190">**SWbemServices** supports three modes of operation: synchronous, asynchronous, and semisynchronous.</span></span>

-   <span data-ttu-id="6d1c2-191">**Síncrono**.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-191">**Synchronous**.</span></span> <span data-ttu-id="6d1c2-192">No modo síncrono, seu script bloqueia (pausa) até que o método **SWbemServices** seja concluído.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-192">In synchronous mode, your script blocks (pauses) until the **SWbemServices** method completes.</span></span> <span data-ttu-id="6d1c2-193">Não apenas a espera do seu script, mas em casos em que o WMI recupera instâncias de recursos gerenciados, o WMI cria o [**SWbemObjectSet**](swbemobjectset.md) inteiro na memória antes que o primeiro byte de dados seja retornado para o script de chamada.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-193">Not only does your script wait, but in cases in which WMI retrieves instances of managed resources, WMI builds the entire [**SWbemObjectSet**](swbemobjectset.md) in memory before the first byte of data is returned to the calling script.</span></span> <span data-ttu-id="6d1c2-194">Isso pode ter um efeito adverso no desempenho do script e no computador que executa o script.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-194">This can have an adverse effect on the script performance and on the computer running the script.</span></span> <span data-ttu-id="6d1c2-195">Por exemplo, a recuperação síncrona de milhares de eventos dos logs de eventos do Windows pode levar muito tempo e usar muita memória.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-195">For example, synchronously retrieving thousands of events from the Windows Event Logs can take a long time and use a lot of memory.</span></span> <span data-ttu-id="6d1c2-196">Por esses motivos, as operações síncronas não são recomendadas, exceto para os três métodos ([**delete**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md)e [**Get**](swbemservices-get.md)) que são síncronos por padrão.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-196">For these reasons, synchronous operations are not recommended except for the three methods ([**Delete**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md), and [**Get**](swbemservices-get.md)) that are synchronous by default.</span></span> <span data-ttu-id="6d1c2-197">Esses métodos não retornam grandes conjuntos de dados, portanto, a operação semisynchronous não é necessária.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-197">These methods do not return large data sets, so semisynchronous operation is not required.</span></span>
-   <span data-ttu-id="6d1c2-198">**Assíncrono**.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-198">**Asynchronous**.</span></span> <span data-ttu-id="6d1c2-199">No modo assíncrono, seu script chama um dos nove métodos assíncronos e retorna imediatamente.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-199">In asynchronous mode, your script calls one of the nine asynchronous methods and returns immediately.</span></span> <span data-ttu-id="6d1c2-200">Ou seja, assim que o método assíncrono for chamado, o script retomará a execução da próxima linha de código.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-200">That is, as soon as the asynchronous method is called, your script resumes running the next line of code.</span></span> <span data-ttu-id="6d1c2-201">Para usar um método assíncrono, o script deve primeiro criar um objeto [**SWbemSink**](swbemsink.md) e uma sub-rotina especial chamada manipulador de eventos.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-201">To use an asynchronous method, your script must first create an [**SWbemSink**](swbemsink.md) object and a special subroutine called an event handler.</span></span> <span data-ttu-id="6d1c2-202">O WMI executa a operação assíncrona e notifica o script chamando a sub-rotina do manipulador de eventos quando a operação é concluída.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-202">WMI performs the asynchronous operation and notifies the script by calling the event handler subroutine when the operation is complete.</span></span>
-   <span data-ttu-id="6d1c2-203">**Semisynchronous**.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-203">**Semisynchronous**.</span></span> <span data-ttu-id="6d1c2-204">O modo Semisynchronous é um comprometimento entre síncrono e assíncrono.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-204">Semisynchronous mode is a compromise between synchronous and asynchronous.</span></span> <span data-ttu-id="6d1c2-205">As operações Semisynchronous oferecem melhor desempenho do que as operações síncronas, ainda que não exijam o conhecimento extra e as etapas de script necessárias para lidar com operações assíncronas.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-205">Semisynchronous operations offer better performance than synchronous operations, yet they do not require the extra knowledge and scripting steps necessary to handle asynchronous operations.</span></span> <span data-ttu-id="6d1c2-206">Esse é o tipo de operação padrão para a maioria das consultas WMI.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-206">This is the default operation type for most WMI queries.</span></span>

    <span data-ttu-id="6d1c2-207">No modo semisynchronous, seu script chama um dos seis métodos de recuperação de dados e retorna imediatamente.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-207">In semisynchronous mode, your script calls one of the six data retrieval methods and returns immediately.</span></span> <span data-ttu-id="6d1c2-208">O WMI recupera os recursos gerenciados em segundo plano à medida que o script continua a ser executado.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-208">WMI retrieves the managed resources in the background as your script continues to run.</span></span> <span data-ttu-id="6d1c2-209">À medida que os recursos são recuperados, eles são retornados imediatamente para o script por meio de um SWbemObjectSet.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-209">As the resources are retrieved, they are immediately returned to your script by way of an SWbemObjectSet.</span></span> <span data-ttu-id="6d1c2-210">Você pode começar a acessar os recursos gerenciados sem esperar que toda a coleção seja montada.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-210">You can begin to access the managed resources without waiting for the entire collection to be assembled.</span></span>

    <span data-ttu-id="6d1c2-211">Há uma limitação para semisynchronous operações quando você está trabalhando com recursos gerenciados que têm muitas instâncias (muitos significando mais de 1.000), como [**CIM \_ DataFile**](/windows/desktop/CIMWin32Prov/cim-datafile) e [**Win32 \_ NTLogEvent**](/previous-versions/windows/desktop/eventlogprov/win32-ntlogevent).</span><span class="sxs-lookup"><span data-stu-id="6d1c2-211">There is a caveat to semisynchronous operations when you are working with managed resources that have many instances (many meaning greater than 1,000), such as [**CIM\_DataFile**](/windows/desktop/CIMWin32Prov/cim-datafile) and [**Win32\_NTLogEvent**](/previous-versions/windows/desktop/eventlogprov/win32-ntlogevent).</span></span> <span data-ttu-id="6d1c2-212">A limitação é um resultado de como o WMI lida com instâncias de recursos gerenciados.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-212">The caveat is a result of how WMI handles instances of managed resources.</span></span> <span data-ttu-id="6d1c2-213">Para cada instância de um recurso gerenciado, o WMI cria e armazena em cache um objeto [**SWbemObject**](swbemobject.md) .</span><span class="sxs-lookup"><span data-stu-id="6d1c2-213">For each instance of a managed resource, WMI creates and caches an [**SWbemObject**](swbemobject.md) object.</span></span> <span data-ttu-id="6d1c2-214">Quando há um grande número de instâncias para um recurso gerenciado, a recuperação da instância pode monopolizar os recursos disponíveis, reduzindo o desempenho do script e do computador.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-214">When a large number of instances exist for a managed resource, instance retrieval can monopolize available resources, reducing the performance of both the script and the computer.</span></span>

    <span data-ttu-id="6d1c2-215">Para contornar o problema, você pode otimizar as chamadas de método semisynchronous usando o sinalizador **wbemFlagForwardOnly** .</span><span class="sxs-lookup"><span data-stu-id="6d1c2-215">To work around the problem, you can optimize semisynchronous method calls using the **wbemFlagForwardOnly** flag.</span></span> <span data-ttu-id="6d1c2-216">O sinalizador **wbemFlagForwardOnly** , combinado com o sinalizador **wbemFlagReturnImmediately** (o sinalizador semisynchronous padrão), informa ao WMI para retornar um [**SWbemObjectSet**](swbemobjectset.md)somente de encaminhamento, o que elimina o grande problema de desempenho do conjunto de dados.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-216">The **wbemFlagForwardOnly** flag, combined with the **wbemFlagReturnImmediately** flag (the default semisynchronous flag), tells WMI to return a forward-only [**SWbemObjectSet**](swbemobjectset.md), which eliminates the large data set performance problem.</span></span> <span data-ttu-id="6d1c2-217">No entanto, o uso do sinalizador **wbemFlagForwardOnly** vem com um custo.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-217">However, using the **wbemFlagForwardOnly** flag comes with a cost.</span></span> <span data-ttu-id="6d1c2-218">Um **SWbemObjectSet** somente de encaminhamento pode ser enumerado apenas uma vez.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-218">A forward-only **SWbemObjectSet** can be enumerated only once.</span></span> <span data-ttu-id="6d1c2-219">Depois que cada [**SWbemObject**](swbemobject.md) em um **SWbemObjectSet** somente de encaminhamento for acessado, a memória alocada para a instância será liberada.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-219">After each [**SWbemObject**](swbemobject.md) in a forward-only **SWbemObjectSet** is accessed, the memory allocated to the instance is released.</span></span>

<span data-ttu-id="6d1c2-220">Com exceção dos métodos assíncronos [**delete**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md), [**Get**](swbemservices-get.md)e nove, semisynchronous é o modo de operação padrão e recomendado.</span><span class="sxs-lookup"><span data-stu-id="6d1c2-220">With the exception of the [**Delete**](swbemservices-delete.md), [**ExecMethod**](swbemservices-execmethod.md), [**Get**](swbemservices-get.md), and nine asynchronous methods, semisynchronous is the default and recommended mode of operation.</span></span>

<span data-ttu-id="6d1c2-221">**Métodos comumente usados**</span><span class="sxs-lookup"><span data-stu-id="6d1c2-221">**Commonly-used Methods**</span></span>

<span data-ttu-id="6d1c2-222">Os métodos usados com mais frequência nos scripts de administração do sistema são [**InstancesOf**](swbemservices-instancesof.md), [**ExecQuery**](swbemservices-execquery.md), [**Get**](swbemservices-get.md)e [**ExecNotificationQuery**](swbemservices-execnotificationquery.md).</span><span class="sxs-lookup"><span data-stu-id="6d1c2-222">The methods most often used in system administration scripts are [**InstancesOf**](swbemservices-instancesof.md), [**ExecQuery**](swbemservices-execquery.md), [**Get**](swbemservices-get.md), and [**ExecNotificationQuery**](swbemservices-execnotificationquery.md).</span></span> <span data-ttu-id="6d1c2-223">Embora seja usado com frequência, o **InstancesOf** não é necessariamente a maneira recomendada de recuperar informações (embora seja, de forma imprecisa, a maneira mais fácil).</span><span class="sxs-lookup"><span data-stu-id="6d1c2-223">Although often used, **InstancesOf** is not necessarily the recommended way to retrieve information (although it is arguably the easiest way).</span></span>

## <a name="requirements"></a><span data-ttu-id="6d1c2-224">Requisitos</span><span class="sxs-lookup"><span data-stu-id="6d1c2-224">Requirements</span></span>



| <span data-ttu-id="6d1c2-225">Requisito</span><span class="sxs-lookup"><span data-stu-id="6d1c2-225">Requirement</span></span> | <span data-ttu-id="6d1c2-226">Valor</span><span class="sxs-lookup"><span data-stu-id="6d1c2-226">Value</span></span> |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| <span data-ttu-id="6d1c2-227">Cliente mínimo com suporte</span><span class="sxs-lookup"><span data-stu-id="6d1c2-227">Minimum supported client</span></span><br/> | <span data-ttu-id="6d1c2-228">Windows Vista</span><span class="sxs-lookup"><span data-stu-id="6d1c2-228">Windows Vista</span></span><br/>                                                                |
| <span data-ttu-id="6d1c2-229">Servidor mínimo com suporte</span><span class="sxs-lookup"><span data-stu-id="6d1c2-229">Minimum supported server</span></span><br/> | <span data-ttu-id="6d1c2-230">Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="6d1c2-230">Windows Server 2008</span></span><br/>                                                          |
| <span data-ttu-id="6d1c2-231">parâmetro</span><span class="sxs-lookup"><span data-stu-id="6d1c2-231">Header</span></span><br/>                   | <dl> <span data-ttu-id="6d1c2-232"><dt>Wbemdisp. h</dt></span><span class="sxs-lookup"><span data-stu-id="6d1c2-232"><dt>Wbemdisp.h</dt></span></span> </dl>   |
| <span data-ttu-id="6d1c2-233">Biblioteca de tipos</span><span class="sxs-lookup"><span data-stu-id="6d1c2-233">Type library</span></span><br/>             | <dl> <span data-ttu-id="6d1c2-234"><dt>Wbemdisp. tlb</dt></span><span class="sxs-lookup"><span data-stu-id="6d1c2-234"><dt>Wbemdisp.tlb</dt></span></span> </dl> |
| <span data-ttu-id="6d1c2-235">DLL</span><span class="sxs-lookup"><span data-stu-id="6d1c2-235">DLL</span></span><br/>                      | <dl> <span data-ttu-id="6d1c2-236"><dt>Wbemdisp.dll</dt></span><span class="sxs-lookup"><span data-stu-id="6d1c2-236"><dt>Wbemdisp.dll</dt></span></span> </dl> |
| <span data-ttu-id="6d1c2-237">CLSID</span><span class="sxs-lookup"><span data-stu-id="6d1c2-237">CLSID</span></span><br/>                    | <span data-ttu-id="6d1c2-238">\_SWBEMSERVICES CLSID</span><span class="sxs-lookup"><span data-stu-id="6d1c2-238">CLSID\_SWbemServices</span></span><br/>                                                         |
| <span data-ttu-id="6d1c2-239">IID</span><span class="sxs-lookup"><span data-stu-id="6d1c2-239">IID</span></span><br/>                      | <span data-ttu-id="6d1c2-240">ISWbemServices de IID \_</span><span class="sxs-lookup"><span data-stu-id="6d1c2-240">IID\_ISWbemServices</span></span><br/>                                                          |



## <a name="see-also"></a><span data-ttu-id="6d1c2-241">Confira também</span><span class="sxs-lookup"><span data-stu-id="6d1c2-241">See also</span></span>

<dl> <dt>

[<span data-ttu-id="6d1c2-242">Objetos de API de script</span><span class="sxs-lookup"><span data-stu-id="6d1c2-242">Scripting API Objects</span></span>](scripting-api-objects.md)
</dt> <dt>

[<span data-ttu-id="6d1c2-243">Chamando um método</span><span class="sxs-lookup"><span data-stu-id="6d1c2-243">Calling a Method</span></span>](calling-a-method.md)
</dt> </dl>

 

