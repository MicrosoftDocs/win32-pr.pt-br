---
description: Um provedor de eventos deve implementar a interface IWbemEventProvider para gerar notificações de eventos.
ms.assetid: ae33c9f5-61f7-4488-a281-01d7f9c62c46
ms.tgt_platform: multiple
title: Implementando a interface primária para um provedor de eventos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5621a2c6d0901a7925828149dd5c1480c2b11456
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103922200"
---
# <a name="implementing-the-primary-interface-for-an-event-provider"></a><span data-ttu-id="f94f9-103">Implementando a interface primária para um provedor de eventos</span><span class="sxs-lookup"><span data-stu-id="f94f9-103">Implementing the Primary Interface for an Event Provider</span></span>

<span data-ttu-id="f94f9-104">Um provedor de eventos deve implementar a interface [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) para gerar notificações de eventos.</span><span class="sxs-lookup"><span data-stu-id="f94f9-104">An event provider must implement the [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) interface to generate event notifications.</span></span> <span data-ttu-id="f94f9-105">O WMI chama o método [**IWbemEventProvider::P rovideevents**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventprovider-provideevents) do provedor e passa um ponteiro para o objeto Sink, que é uma implementação da interface [**IWbemObjectSink**](iwbemobjectsink.md) .</span><span class="sxs-lookup"><span data-stu-id="f94f9-105">WMI calls the [**IWbemEventProvider::ProvideEvents**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventprovider-provideevents) method of the provider and passes in a pointer to the sink object, which is an implementation of the [**IWbemObjectSink**](iwbemobjectsink.md) interface.</span></span> <span data-ttu-id="f94f9-106">Quando o provedor de eventos estiver pronto para gerar uma notificação, o provedor chamará o método [**IWbemObjectSink:: indicativo**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-indicate) .</span><span class="sxs-lookup"><span data-stu-id="f94f9-106">When the event provider is ready to generate a notification, the provider calls the [**IWbemObjectSink::Indicate**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-indicate) method.</span></span>

<span data-ttu-id="f94f9-107">Um provedor de eventos deve posicionar as notificações geradas por meio de [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) em objetos de evento.</span><span class="sxs-lookup"><span data-stu-id="f94f9-107">An event provider should place the notifications generated through [**IWbemEventProvider**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) in event objects.</span></span> <span data-ttu-id="f94f9-108">Você deve implementar objetos de evento como entradas em uma matriz de interfaces [**IWbemClassObject**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemclassobject) representadas pelo parâmetro *ppObjArray* do método [**indique**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-indicate) .</span><span class="sxs-lookup"><span data-stu-id="f94f9-108">You should implement event objects as entries in an array of [**IWbemClassObject**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemclassobject) interfaces represented by the *ppObjArray* parameter of the [**Indicate**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-indicate) method.</span></span> <span data-ttu-id="f94f9-109">Como **IWbemClassObjects** são objetos com, o provedor deve incrementar a contagem de referência para o coletor chamando o método [**IWbemObjectSink:: AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) .</span><span class="sxs-lookup"><span data-stu-id="f94f9-109">Because **IWbemClassObjects** are COM objects, the provider must increment the reference count for the sink by calling the [**IWbemObjectSink::AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) method.</span></span> <span data-ttu-id="f94f9-110">Provedores de eventos que devem fornecer muitas notificações (por exemplo, eventos 400) devem criar um objeto de evento exclusivo para cada notificação, gerando uma nova instância ou clonando uma existente.</span><span class="sxs-lookup"><span data-stu-id="f94f9-110">Event providers that must supply many notifications (for example, 400 events) should create a unique event object for each notification by either spawning a new instance or cloning an existing one.</span></span> <span data-ttu-id="f94f9-111">O WMI nunca se mantém em um objeto de evento após a conclusão da chamada de **indicação** e não tem requisitos especiais para **AddRef** acima e além do padrão com.</span><span class="sxs-lookup"><span data-stu-id="f94f9-111">WMI never holds onto an event object past the completion of the **Indicate** call, and has no special requirements for **AddRef** above and beyond the COM standard.</span></span>

<span data-ttu-id="f94f9-112">Considere as seguintes diretrizes ao implementar um provedor de eventos:</span><span class="sxs-lookup"><span data-stu-id="f94f9-112">Consider the following guidelines when implementing an event provider:</span></span>

-   <span data-ttu-id="f94f9-113">Não faça nenhuma alteração de classe durante a manutenção de uma chamada de cliente.</span><span class="sxs-lookup"><span data-stu-id="f94f9-113">Do not make any class changes while servicing a client call.</span></span>
-   <span data-ttu-id="f94f9-114">Não emita chamadas relacionadas a eventos, como uma chamada que modifica um filtro de eventos.</span><span class="sxs-lookup"><span data-stu-id="f94f9-114">Do not issue any event-related calls, such as a call that modifies an event filter.</span></span>
-   <span data-ttu-id="f94f9-115">Processe todas as solicitações que o serviço de gerenciamento do Windows emite, como [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery), antes de redisparar um evento.</span><span class="sxs-lookup"><span data-stu-id="f94f9-115">Process any requests that the Windows Management service issues, such as [**CancelQuery**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery), before refiring an event.</span></span>

    <span data-ttu-id="f94f9-116">Se você não processar a solicitação, a reacionamento do evento poderá impedir que o evento seja aceito.</span><span class="sxs-lookup"><span data-stu-id="f94f9-116">If you do not process the request, then refiring the event might block the event from ever being accepted.</span></span>

-   <span data-ttu-id="f94f9-117">Nunca chame [**IWbemObjectSink:: SetStatus**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-setstatus) de dentro de um provedor.</span><span class="sxs-lookup"><span data-stu-id="f94f9-117">Never call [**IWbemObjectSink::SetStatus**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-setstatus) from within a provider.</span></span>

 

 
