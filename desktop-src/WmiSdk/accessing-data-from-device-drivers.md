---
description: O provedor de Windows Driver Model (WDM) concede acesso às classes, instâncias, métodos e eventos de drivers de hardware que estão em conformidade com o modelo WDM.
ms.assetid: 8686a613-0e53-4e6e-b193-7839abfb70de
ms.tgt_platform: multiple
title: Acessando dados de drivers de dispositivo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 72a59b59116ca0f71178fb2faed290d6bc76c9d6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105765760"
---
# <a name="accessing-data-from-device-drivers"></a><span data-ttu-id="43d44-103">Acessando dados de drivers de dispositivo</span><span class="sxs-lookup"><span data-stu-id="43d44-103">Accessing Data from Device Drivers</span></span>

<span data-ttu-id="43d44-104">O provedor de Windows Driver Model (WDM) concede acesso às classes, instâncias, métodos e eventos de drivers de hardware que estão em conformidade com o modelo WDM.</span><span class="sxs-lookup"><span data-stu-id="43d44-104">The Windows Driver Model (WDM) provider grants access to the classes, instances, methods, and events of hardware drivers that conform to the WDM model.</span></span> <span data-ttu-id="43d44-105">As classes para drivers de hardware residem no \\ \\ \\ namespace raiz WMI.</span><span class="sxs-lookup"><span data-stu-id="43d44-105">The classes for hardware drivers reside in the \\\\root\\wmi namespace.</span></span>

<span data-ttu-id="43d44-106">O provedor WDM é de interesse daqueles que escrevem drivers de dispositivo e administradores que estão interessados em dados de driver de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="43d44-106">The WDM provider is of interest to those who write device drivers and to administrators who are interested in device driver data.</span></span>

<span data-ttu-id="43d44-107">As seções a seguir são discutidas neste tópico:</span><span class="sxs-lookup"><span data-stu-id="43d44-107">The following sections are discussed in this topic:</span></span>

-   [<span data-ttu-id="43d44-108">Informações para gravadores de driver de dispositivo</span><span class="sxs-lookup"><span data-stu-id="43d44-108">Information for Device Driver Writers</span></span>](#information-for-device-driver-writers)
-   [<span data-ttu-id="43d44-109">Informações para administradores e usuários de dados de driver</span><span class="sxs-lookup"><span data-stu-id="43d44-109">Information for Administrators and Users of Driver Data</span></span>](#information-for-administrators-and-users-of-driver-data)
-   [<span data-ttu-id="43d44-110">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="43d44-110">Related topics</span></span>](#related-topics)

## <a name="information-for-device-driver-writers"></a><span data-ttu-id="43d44-111">Informações para gravadores de driver de dispositivo</span><span class="sxs-lookup"><span data-stu-id="43d44-111">Information for Device Driver Writers</span></span>

<span data-ttu-id="43d44-112">As classes WMI relacionadas a um driver de dispositivo específico são criadas quando o provedor WDM extrai o MOF binário do arquivo executável do driver de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="43d44-112">WMI classes related to a specific device driver are created when the WDM provider extracts the binary MOF from the device driver executable file.</span></span> <span data-ttu-id="43d44-113">Isso ocorre sempre que o WMI é iniciado, um novo driver de dispositivo é instalado ou a instância do [WMIBinaryMofResource](/windows/desktop/WmiCoreProv/wmibinarymofresource) para um determinado driver é excluída.</span><span class="sxs-lookup"><span data-stu-id="43d44-113">This takes place whenever WMI is started, a new device driver is installed, or the instance of [WMIBinaryMofResource](/windows/desktop/WmiCoreProv/wmibinarymofresource) for a particular driver is deleted.</span></span> <span data-ttu-id="43d44-114">Ao verificar wmiprov. log, você pode determinar se um erro resultante de falha ocorreu durante a extração do arquivo MOF binário.</span><span class="sxs-lookup"><span data-stu-id="43d44-114">By checking Wmiprov.log, you can determine if an error resulting in failure occurred while extracting the binary MOF file.</span></span> <span data-ttu-id="43d44-115">Detalhes de erros de [Mofcomp](mofcomp.md) são relatados em Mofcomp. log.</span><span class="sxs-lookup"><span data-stu-id="43d44-115">Details of [mofcomp](mofcomp.md) errors are reported in Mofcomp.log.</span></span> <span data-ttu-id="43d44-116">Para obter mais informações, consulte [arquivos de log do WMI](wmi-log-files.md).</span><span class="sxs-lookup"><span data-stu-id="43d44-116">For more information, see [WMI Log Files](wmi-log-files.md).</span></span> <span data-ttu-id="43d44-117">Por motivos de desempenho, o provedor WDM não gera eventos durante a criação ou exclusão de classes devido a um provedor WDM iniciando ou parando.</span><span class="sxs-lookup"><span data-stu-id="43d44-117">For performance reasons, the WDM provider does not generate events while creating or deleting classes due to a WDM provider starting or stopping.</span></span>

<span data-ttu-id="43d44-118">O provedor WDM transforma todos os dados de WNODE em informações de classe.</span><span class="sxs-lookup"><span data-stu-id="43d44-118">The WDM provider transforms all WNODE data into class information.</span></span> <span data-ttu-id="43d44-119">Se for encontrado um erro ao transformar os dados de WNODE em dados de classe, eles serão relatados em wmiprov. log com o cabeçalho formatado e os bytes processados na mesma forma que um despejo de memória.</span><span class="sxs-lookup"><span data-stu-id="43d44-119">If an error is encountered when transforming the data from WNODE to class data, it is reported in Wmiprov.log with the header formatted and bytes rendered in the same form as a memory dump.</span></span>

<span data-ttu-id="43d44-120">As alterações feitas nas configurações de segurança do driver não entram em vigor até que o provedor WDM seja descarregado e recarregado.</span><span class="sxs-lookup"><span data-stu-id="43d44-120">Changes made to driver security settings do not take effect until the WDM provider is unloaded and reloaded.</span></span> <span data-ttu-id="43d44-121">Para obter mais informações, consulte [descarregando um provedor](unloading-a-provider.md).</span><span class="sxs-lookup"><span data-stu-id="43d44-121">For more information, see [Unloading a Provider](unloading-a-provider.md).</span></span>

<span data-ttu-id="43d44-122">O WMI também pode disponibilizar contadores de alto desempenho para drivers de hardware disponíveis.</span><span class="sxs-lookup"><span data-stu-id="43d44-122">WMI can also make high-performance counters for hardware drivers available.</span></span> <span data-ttu-id="43d44-123">Para obter mais informações sobre como criar classes de alto desempenho e exibir dados no monitor do sistema Perfmon, consulte [melhorando a eficiência de um provedor de instância](improving-the-efficiency-of-an-instance-provider.md).</span><span class="sxs-lookup"><span data-stu-id="43d44-123">For more information about creating high-performance classes and displaying data in Perfmon System Monitor, see [Improving the Efficiency of an Instance Provider](improving-the-efficiency-of-an-instance-provider.md).</span></span> <span data-ttu-id="43d44-124">Para obter mais informações sobre como escrever drivers de dispositivo habilitados para WMI, consulte [https://www.microsoft.com/ddk](https://msdn.microsoft.com/library/aa972908.aspx) .</span><span class="sxs-lookup"><span data-stu-id="43d44-124">For more information about writing WMI-enabled device drivers, see [https://www.microsoft.com/ddk](https://msdn.microsoft.com/library/aa972908.aspx).</span></span> <span data-ttu-id="43d44-125">Para obter mais informações sobre qualificadores específicos de WDM no arquivo MOF, consulte [**qualificadores específicos para o provedor WDM**](qualifiers-specific-to-the-wdm-provider.md).</span><span class="sxs-lookup"><span data-stu-id="43d44-125">For more information about WDM specific qualifiers in the MOF file, see [**Qualifiers Specific to the WDM Provider**](qualifiers-specific-to-the-wdm-provider.md).</span></span>

## <a name="information-for-administrators-and-users-of-driver-data"></a><span data-ttu-id="43d44-126">Informações para administradores e usuários de dados de driver</span><span class="sxs-lookup"><span data-stu-id="43d44-126">Information for Administrators and Users of Driver Data</span></span>

<span data-ttu-id="43d44-127">Listar as instâncias da classe [WMIBinaryMofResource](/windows/desktop/WmiCoreProv/wmibinarymofresource) fornece uma lista dos drivers no sistema e informações sobre se o provedor WDM teve êxito na compilação do MOFs para cada driver.</span><span class="sxs-lookup"><span data-stu-id="43d44-127">Listing the instances of the [WMIBinaryMofResource](/windows/desktop/WmiCoreProv/wmibinarymofresource) class provides a list of the drivers in the system and information about whether the WDM provider succeeded in compiling the MOFs for each driver.</span></span> <span data-ttu-id="43d44-128">Você pode forçar o provedor a recompilar e regenerar as classes de um driver excluindo a instância de WMIBinaryMofResource que representa esse driver.</span><span class="sxs-lookup"><span data-stu-id="43d44-128">You can force the provider to recompile and regenerate the classes for a driver by deleting the instance of WMIBinaryMofResource that represents that driver.</span></span> <span data-ttu-id="43d44-129">Os detalhes dos erros de [Mofcomp](mofcomp.md) são relatados no Mofcomp. log.</span><span class="sxs-lookup"><span data-stu-id="43d44-129">Details of [mofcomp](mofcomp.md) errors are reported in the Mofcomp.log.</span></span>

<span data-ttu-id="43d44-130">Se o namespace WMI estiver corrompido, ele poderá ser excluído e reaberto para forçar o WDM a recriar as classes de driver.</span><span class="sxs-lookup"><span data-stu-id="43d44-130">If the WMI namespace is corrupted, it can be deleted and reopened to force WDM to rebuild the driver classes.</span></span> <span data-ttu-id="43d44-131">Para obter mais informações sobre como abrir um namespace, consulte [Criando hierarquias dentro do WMI](creating-hierarchies-within-wmi.md).</span><span class="sxs-lookup"><span data-stu-id="43d44-131">For more information about opening a namespace, see [Creating Hierarchies Within WMI](creating-hierarchies-within-wmi.md).</span></span>

<span data-ttu-id="43d44-132">As classes de driver podem ocasionalmente ser "retidos" se o carregamento do driver for interrompido ou se outras operações anormais ocorrerem.</span><span class="sxs-lookup"><span data-stu-id="43d44-132">Driver classes can occasionally get "stranded" if driver loading is interrupted or other abnormal operations occur.</span></span> <span data-ttu-id="43d44-133">O provedor WDM pesquisará e limpará as classes "com falha" quando um novo driver for instalado ou quando o valor da chave do registro do **software \\ Microsoft \\ WBEM \\ WDMProvider** **ProcessStrandedClasses** for definido como **true**.</span><span class="sxs-lookup"><span data-stu-id="43d44-133">The WDM provider will only search for and clean up "stranded" classes when a new driver is installed or when the **Software\\Microsoft\\WBEM\\WDMProvider** registry key value **ProcessStrandedClasses** is set to **TRUE**.</span></span> <span data-ttu-id="43d44-134">Definir esse valor como **true** retarda o desempenho de inicialização do WMI devido à operação de limpeza.</span><span class="sxs-lookup"><span data-stu-id="43d44-134">Setting this value to **TRUE** slows WMI startup performance because of the cleanup operation.</span></span> <span data-ttu-id="43d44-135">O valor padrão é **false**.</span><span class="sxs-lookup"><span data-stu-id="43d44-135">The default value is **FALSE**.</span></span> <span data-ttu-id="43d44-136">O provedor WDM verifica apenas esse valor de registro quando o namespace "root \\ WMI" é aberto pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="43d44-136">The WDM provider only checks this registry value when the "Root\\Wmi" namespace is opened for the first time.</span></span>

<span data-ttu-id="43d44-137">Se forem feitas alterações de segurança em um driver de dispositivo WDM, as alterações não entrarão em vigor até que o provedor WDM seja descarregado e recarregado.</span><span class="sxs-lookup"><span data-stu-id="43d44-137">If security changes are made to a WDM device driver, the changes will not go into effect until the WDM provider is unloaded and reloaded.</span></span> <span data-ttu-id="43d44-138">O serviço de gerenciamento do Windows deve ser interrompido e reiniciado para fazer isso.</span><span class="sxs-lookup"><span data-stu-id="43d44-138">The Windows Management service must be stopped and restarted to accomplish this.</span></span>

## <a name="related-topics"></a><span data-ttu-id="43d44-139">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="43d44-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="43d44-140">Usando o WMI</span><span class="sxs-lookup"><span data-stu-id="43d44-140">Using WMI</span></span>](using-wmi.md)
</dt> </dl>

 

 
