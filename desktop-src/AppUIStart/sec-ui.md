---
title: considerações de segurança Windows Interface do usuário
description: este tópico fornece informações sobre considerações de segurança na Interface do usuário do Windows.
ms.assetid: D560E59A-D6C8-40a9-AABB-DE5A47C94E6E
keywords:
- Windows Interface do usuário, segurança
- segurança para Interface do usuário Windows
- segurança de cadeia de caracteres
- entrada do usuário, validação
- Validando entradas do usuário
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f8d8281684dde5a78d458816c3d90c8c75fd96bb8ae7160004667ea302794c37
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/11/2021
ms.locfileid: "119589196"
---
# <a name="security-considerations-windows-user-interface"></a>considerações sobre segurança: Windows Interface do usuário

este tópico fornece informações sobre considerações de segurança na Interface do usuário do Windows. Este tópico não fornece tudo o que você precisa saber sobre problemas de segurança. Em vez disso, use-o como ponto de partida e referência para essa área de tecnologia.

Com o aumento na interconectividade entre computadores, os desenvolvedores agora devem se preocupar com a segurança do aplicativo. No entanto, a segurança também aprimora a segurança geral do aplicativo e a robustez; Portanto, é outra maneira que o desenvolvedor pode fornecer uma boa experiência do usuário. os tópicos a seguir discutem algumas possíveis preocupações de segurança ao usar a Interface do usuário do Windows.

-   [Considerações sobre cadeia de caracteres](#string-considerations)
-   [Entrada do usuário](#user-input)
-   [Alertas de Segurança](#security-alerts)
-   [Tópicos relacionados](#related-topics)

## <a name="string-considerations"></a>Considerações sobre cadeia de caracteres

Muitas funções, mensagens e macros usam cadeias de caracteres em seus parâmetros. No entanto, geralmente as cadeias de caracteres não são verificadas quanto ao término nulo ou para comprimento. Uma preocupação relacionada é calcular o comprimento de uma cadeia de caracteres ou buffer. Em ambos os casos, isso pode levar ao estouro de buffer ou truncamento de dados, o que pode afetar o aplicativo de forma adversa. Para obter mais informações sobre estouros de buffer e outras questões de segurança, consulte *escrevendo código seguro* por Michael Howard e David LeBlanc, Microsoft Press, 2002.

Para manipular cadeias de caracteres de forma segura, você deve fazer o seguinte:

-   Verifique as cadeias de caracteres para terminação nula ou para o comprimento correto, conforme apropriado.
-   Tome cuidado especial para determinar o comprimento de uma cadeia de caracteres ou buffer, especialmente quando ele contiver valores **TCHAR** .
-   Se você criar uma cadeia de caracteres ou usar uma cadeia de caracteres que foi usada anteriormente, inicialize-a para zero ou insira um terminador nulo, conforme apropriado.

Além disso, considere o uso das funções [StrSafe](/windows/desktop/menurc/strsafe-ovw) ao lidar com cadeias de caracteres. Essas funções foram projetadas para manipular cadeias de caracteres com segurança.

## <a name="user-input"></a>Entrada do usuário

a interface do usuário Windows se preocupa em obter e responder às informações dos usuários. No entanto, os usuários que inserem dados incorretos podem interromper seu aplicativo, seja ou não pretendem fazer isso. Portanto, a regra cardeal é que toda a entrada deve ser validada.

De preocupação principal são dados de cadeia de caracteres, que são discutidos em [Considerações sobre cadeias de caracteres](#string-considerations). No entanto, todos os tipos de entrada devem ser validados antes de serem usados pelo seu aplicativo. Outra preocupação é quando os dados são validados em um ponto, mas são alterados antes de serem usados, por exemplo, ao receber mensagens que fornecem o comprimento do texto. Portanto, se houver uma chance de que os dados possam ser alterados, você deverá verificar os dados antes de usá-los

## <a name="security-alerts"></a>Alertas de segurança

A tabela a seguir lista os recursos que, se usados incorretamente, podem comprometer a segurança de seus aplicativos.



| Recurso                                                                                                                                                   | Atenuação                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**Getatomname**](/windows/desktop/api/winbase/nf-winbase-getatomnamea)                                                                                                               | Tenha cuidado ao especificar o tamanho do buffer.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**GlobalGetAtomName**](/windows/desktop/api/winbase/nf-winbase-globalgetatomnamea)                                                                                                   | Os átomos de cadeia de caracteres global podem ser acessados por qualquer aplicativo. No entanto, se outro aplicativo estiver descuidado, ele poderá lidar com suas contagens de referência e excluí-los. Em vez disso, você deve considerar o uso de átomos de inteiro global.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [**ImpersonateDdeClientWindow**](/windows/desktop/api/dde/nf-dde-impersonateddeclientwindow)                                                                                 | Se a função falhar, as solicitações de cliente subsequentes serão feitas no contexto de segurança do processo de chamada. Isso pode ser um problema se o processo de chamada estiver sendo executado como uma conta altamente privilegiada. Portanto, se a chamada falhar ou gerar um erro, não continue a execução da solicitação do cliente.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**DdeImpersonateClient**](/windows/desktop/api/ddeml/nf-ddeml-ddeimpersonateclient)                                                                                             | Se a função falhar, as solicitações de cliente subsequentes serão feitas no contexto de segurança do processo de chamada. Isso pode ser um problema se o processo de chamada estiver sendo executado como uma conta altamente privilegiada. Portanto, se a chamada falhar ou gerar um erro, não continue a execução da solicitação do cliente.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**GetClipboardFormatName**](/windows/desktop/api/winuser/nf-winuser-getclipboardformatnamea)                                                                                         | Calcular incorretamente o tamanho adequado do buffer *lpszFormatName* , especialmente quando o aplicativo é usado nas versões ANSI e Unicode, pode causar um estouro de buffer. Além disso, observe que a cadeia de caracteres será truncada se for maior do que o parâmetro *cchMaxCount* , o que pode levar à perda de informações.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**Getmenustring**](/windows/desktop/api/winuser/nf-winuser-getmenustringa)                                                                                                           | O parâmetro *LPSTR* é um buffer **TCHAR** e *nMaxCount* é o comprimento da cadeia de caracteres do menu no **TCHAR** s. O dimensionamento incorreto desses parâmetros pode ser o comprimento da cadeia de caracteres do menu em caracteres. O dimensionamento incorreto desses parâmetros pode causar truncamento da cadeia de caracteres, levando à possível perda de dados.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**GetStringTypeA**](/windows/desktop/api/winnls/nf-winnls-getstringtypea), [**GetStringTypeEx**](/windows/win32/api/stringapiset/nf-stringapiset-getstringtypeexw), [**GetStringTypeW**](/windows/desktop/api/stringapiset/nf-stringapiset-getstringtypew) | Para evitar um estouro de buffer, defina o tamanho do buffer *lpCharType* corretamente.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya)                                                                                                                       | O uso incorreto de **LoadLibrary** pode comprometer a segurança do seu aplicativo carregando a dll errada.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [**Cadeia de caracteres LoadString**](/windows/desktop/api/winuser/nf-winuser-loadstringa)                                                                                                                 | Uso incorreto inclui especificar o tamanho incorreto no parâmetro *nBufferMax* . Por exemplo, sizeof (*lpBuffer*) fornece o tamanho do buffer em bytes, o que pode levar a um estouro de buffer para a versão Unicode da função. As situações de estouro de buffer são a causa de muitos problemas de segurança em aplicativos. Nesse caso, o uso `sizeof(lpBuffer)/sizeof(TCHAR)` fornece o tamanho adequado do buffer.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**lstrcat**](/windows/desktop/api/winbase/nf-winbase-lstrcata)                                                                                                                       | Essa função usa SEH (manipulação de exceção estruturada) para capturar violações de acesso e outros erros. Quando essa função captura erros SEH, ela retorna **NULL** sem o encerramento nulo da cadeia de caracteres e sem NULL sem o encerramento nulo da cadeia de caracteres e sem notificar o chamador do erro. O chamador não é seguro para supor que o espaço insuficiente é a condição de erro. O primeiro argumento, *lpString1*, deve ser grande o suficiente para manter *lpString2* e o fechamento ' \\ 0 '; caso contrário, poderá ocorrer uma saturação do buffer. As saturações de buffer podem levar a um ataque de negação de serviço contra o aplicativo se ocorrer uma violação de acesso. Na pior das hipóteses, uma saturação de buffer pode permitir que um invasor insira código executável em seu processo, especialmente se *lpString1* for um buffer baseado em pilha. Considere o uso de uma das alternativas a seguir. [**StringCbCat**](/windows/desktop/api/strsafe/nf-strsafe-stringcbcata) ou [**StringCchCat**](/windows/desktop/api/strsafe/nf-strsafe-stringcchcata).                                                                                                                                                                                       |
| [**lstrcpy**](/windows/desktop/api/winbase/nf-winbase-lstrcpya)                                                                                                                       | Essa função usa SEH (manipulação de exceção estruturada) para capturar violações de acesso e outros erros. Quando essa função captura erros SEH, ela retorna **NULL** sem o encerramento nulo da cadeia de caracteres e sem NULL sem o encerramento nulo da cadeia de caracteres e sem notificar o chamador do erro. O chamador não é seguro para supor que o espaço insuficiente é a condição de erro. O primeiro argumento, *lpString1*, deve ser grande o suficiente para manter *lpString2* e o fechamento ' \\ 0 '; caso contrário, poderá ocorrer uma saturação do buffer. As saturações de buffer podem levar a um ataque de negação de serviço contra o aplicativo se ocorrer uma violação de acesso. Na pior das hipóteses, uma saturação de buffer pode permitir que um invasor insira código executável em seu processo, especialmente se *lpString1* for um buffer baseado em pilha. Considere usar [**StringCchCopy**](/windows/desktop/api/strsafe/nf-strsafe-stringcchcopya) em vez disso.                                                                                                                                                                                                                                                               |
| [**lstrcpyn**](/windows/desktop/api/winbase/nf-winbase-lstrcpyna)                                                                                                                     | Essa função usa SEH (manipulação de exceção estruturada) para capturar violações de acesso e outros erros. Quando essa função captura erros SEH, ela retorna **NULL** sem o encerramento nulo da cadeia de caracteres e sem NULL sem o encerramento nulo da cadeia de caracteres e sem notificar o chamador do erro. O chamador não é seguro para supor que o espaço insuficiente é a condição de erro. Se *lpString1* não for grande o suficiente para conter a cadeia de caracteres copiada, poderá ocorrer uma saturação de buffer. Além disso, ao copiar uma cadeia de caracteres inteira, observe que [sizeof](https://msdn.microsoft.com/library/0w557fh7(VS.71).aspx) retorna o número de bytes em vez de **WCHAR**, que **sizeof** retorna o número de bytes em vez de caracteres, o que é incorreto para a versão Unicode dessa função. As saturações de buffer podem causar um ataque de negação de serviço contra o aplicativo se ocorrer uma violação de acesso. Na pior das hipóteses, uma saturação de buffer pode permitir que um invasor insira código executável em seu processo, especialmente se *lpString1* for um buffer baseado em pilha. Considere usar [**StringCchCopy**](/windows/desktop/api/strsafe/nf-strsafe-stringcchcopya) em vez disso. |
| [**lstrlen**](/windows/desktop/api/winbase/nf-winbase-lstrlena)                                                                                                                       | [**lstrlen**](/windows/desktop/api/winbase/nf-winbase-lstrlena) pressupõe que a *LPSTR* é uma cadeia de caracteres terminada em nulo. Se não for, isso pode levar a uma saturação de buffer ou a um ataque de negação de serviço contra seu aplicativo. Considere o uso de uma das alternativas a seguir. [**StringCbLength**](/windows/desktop/api/strsafe/nf-strsafe-stringcblengtha) ou [**StringCchLength**](/windows/desktop/api/strsafe/nf-strsafe-stringcchlengtha).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**wsprintf**](/windows/desktop/api/winuser/nf-winuser-wsprintfa)                                                                                                                     | Não há garantia de que a cadeia de caracteres retornada em *lpOut* seja terminada em nulo. Além disso, evite o formato% s, o que pode levar a uma saturação de buffer. Se ocorrer uma violação de acesso, isso causará uma negação de serviço em relação ao seu aplicativo. Na pior das letras, um invasor pode injetar código executável. Considere o uso de uma das alternativas a seguir. [**StringCbPrintf**](/windows/desktop/api/strsafe/nf-strsafe-stringcbprintfa), [**StringCbPrintfEx**](/windows/desktop/api/strsafe/nf-strsafe-stringcbprintfexa), [**StringCbVPrintf**](/windows/desktop/api/strsafe/nf-strsafe-stringcbvprintfa), [**StringCbVPrintfEx**](/windows/desktop/api/strsafe/nf-strsafe-stringcbvprintfexa), [**StringCchPrintf**](/windows/desktop/api/strsafe/nf-strsafe-stringcchprintfa), [**StringCchPrintfEx**](/windows/desktop/api/strsafe/nf-strsafe-stringcchprintfexa), [**StringCchVPrintf**](/windows/desktop/api/strsafe/nf-strsafe-stringcchvprintfa)ou [**StringCchVPrintfEx**](/windows/desktop/api/strsafe/nf-strsafe-stringcchvprintfexa).                                                                                                                                                                                                                                                                                                                                         |
| [**wvsprintf**](/windows/desktop/api/winuser/nf-winuser-wvsprintfa)                                                                                                                   | Não há garantia de que a cadeia de caracteres retornada em *lpOutput* seja terminada em nulo. Além disso, evite o uso do formato% s, o que pode levar a uma saturação de buffer. Isso pode levar a uma negação de serviço se resultar em uma violação de acesso ou um invasor pode injetar código executável. Considere o uso de uma das alternativas a seguir. [**StringCbPrintf**](/windows/desktop/api/strsafe/nf-strsafe-stringcbprintfa), [**StringCbPrintfEx**](/windows/desktop/api/strsafe/nf-strsafe-stringcbprintfexa), [**StringCbVPrintf**](/windows/desktop/api/strsafe/nf-strsafe-stringcbvprintfa), [**StringCbVPrintfEx**](/windows/desktop/api/strsafe/nf-strsafe-stringcbvprintfexa), [**StringCchPrintf**](/windows/desktop/api/strsafe/nf-strsafe-stringcchprintfa), [**StringCchPrintfEx**](/windows/desktop/api/strsafe/nf-strsafe-stringcchprintfexa), [**StringCchVPrintf**](/windows/desktop/api/strsafe/nf-strsafe-stringcchvprintfa)ou [**StringCchVPrintfEx**](/windows/desktop/api/strsafe/nf-strsafe-stringcchvprintfexa).                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="related-topics"></a>Tópicos relacionados

<dl> <dt>

[Segurança da Microsoft](https://www.microsoft.com/security/)
</dt> <dt>

[Segurança e identidade](/windows/desktop/security)
</dt> <dt>

[Índice de tos de como de segurança](/previous-versions/msp-n-p/ff650055(v=pandp.10))
</dt> <dt>

[Recursos de segurança do TechNet](https://www.microsoft.com/technet/security/default.mspx)
</dt> <dt>

[Práticas recomendadas para as APIs de segurança](/windows/desktop/SecBP/best-practices-for-the-security-apis)
</dt> </dl>

 

 