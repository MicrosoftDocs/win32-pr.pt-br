---
title: Registrando um dispositivo hospedado no host do dispositivo
description: Registrar um dispositivo hospedado significa fornecer o host do dispositivo com a descrição do dispositivo e seu objeto de controle de dispositivo.
ms.assetid: 1d85b412-9b1b-415d-8664-8d96a6644793
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c4a607af4f6ada359a9ee32e98e416d8271fd502
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104159735"
---
# <a name="registering-a-hosted-device-with-the-device-host"></a><span data-ttu-id="8de1d-103">Registrando um dispositivo hospedado no host do dispositivo</span><span class="sxs-lookup"><span data-stu-id="8de1d-103">Registering a Hosted Device With the Device Host</span></span>

<span data-ttu-id="8de1d-104">Registrar um dispositivo hospedado significa fornecer o host do dispositivo com a descrição do dispositivo e seu objeto de controle de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8de1d-104">Registering a hosted device means providing the device host with the device description and its device control object.</span></span> <span data-ttu-id="8de1d-105">Em seguida, o host do dispositivo constrói uma descrição completa do dispositivo UPnP, publica-o e anuncia o dispositivo na rede usando o protocolo de descoberta UPnP.</span><span class="sxs-lookup"><span data-stu-id="8de1d-105">The device host then constructs a complete UPnP device description, publishes it, and announces the device on the network using the UPnP discovery protocol.</span></span> <span data-ttu-id="8de1d-106">Depois que um dispositivo for publicado, ele estará disponível para pontos de controle.</span><span class="sxs-lookup"><span data-stu-id="8de1d-106">Once a device is published, it is available to control points.</span></span>

<span data-ttu-id="8de1d-107">Os dispositivos são registrados de duas maneiras:</span><span class="sxs-lookup"><span data-stu-id="8de1d-107">Devices are registered in two ways:</span></span>

-   <span data-ttu-id="8de1d-108">Um aplicativo cria uma instância do objeto de controle de dispositivo e passa um ponteiro para ele para o host do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8de1d-108">An application creates an instance of the device control object and passes a pointer to it to the device host.</span></span>
-   <span data-ttu-id="8de1d-109">O aplicativo passa o ProgID de um objeto de controle de dispositivo registrado para o host do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8de1d-109">The application passes the ProgID for a registered device control object to the device host.</span></span> <span data-ttu-id="8de1d-110">O host do dispositivo instancia-o quando o host do dispositivo recebe a primeira solicitação para o dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8de1d-110">The device host instantiates it when the device host receives the first request for the device.</span></span>

<span data-ttu-id="8de1d-111">Independentemente de qual método é usado, o host do dispositivo publica e anuncia o dispositivo assim que ele é registrado.</span><span class="sxs-lookup"><span data-stu-id="8de1d-111">Regardless of which method is used, the device host publishes and announces the device as soon as it is registered.</span></span> <span data-ttu-id="8de1d-112">A diferença entre as duas abordagens tem a ver com quando o código do dispositivo é carregado.</span><span class="sxs-lookup"><span data-stu-id="8de1d-112">The difference between the two approaches has to do with when the device code is loaded.</span></span> <span data-ttu-id="8de1d-113">Quando o aplicativo passa um ponteiro para o objeto de controle de dispositivo, o código do dispositivo é carregado e em execução no momento do registro.</span><span class="sxs-lookup"><span data-stu-id="8de1d-113">When the application passes in a pointer to the device control object, the device code is loaded and running at the time of registration.</span></span> <span data-ttu-id="8de1d-114">Quando o aplicativo passa um ProgID, o código do dispositivo só é carregado quando uma ação é chamada, uma propriedade é consultada ou uma solicitação de assinatura de evento chega.</span><span class="sxs-lookup"><span data-stu-id="8de1d-114">When the application passes a ProgID, the device code is only loaded when an action is invoked, a property is queried, or an event subscription request arrives.</span></span> <span data-ttu-id="8de1d-115">A segunda abordagem é um pouco mais eficiente.</span><span class="sxs-lookup"><span data-stu-id="8de1d-115">The second approach is slightly more efficient.</span></span> <span data-ttu-id="8de1d-116">No entanto, ele não é adequado para dispositivos que devem estar em execução antes que todas as solicitações de assinatura de evento ou controle cheguem, porque usar essa abordagem, os objetos de controle de dispositivo são criados apenas quando são necessários.</span><span class="sxs-lookup"><span data-stu-id="8de1d-116">However, it is not suitable for devices that must be running before any control or event subscription requests arrive, because using this approach, device control objects are only created when they are needed.</span></span> <span data-ttu-id="8de1d-117">Esse segundo método também pode criar problemas de desempenho ao receber a primeira solicitação para um tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8de1d-117">This second method can also create performance issues when it receives the first request for a device type.</span></span>

<span data-ttu-id="8de1d-118">Se você quiser garantir que um dispositivo seja anunciado automaticamente pelo host do dispositivo na rede quando o computador for iniciado, invoque [**IUPnPRegistrar:: RegisterDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerdevice).</span><span class="sxs-lookup"><span data-stu-id="8de1d-118">If you want to ensure that a device is announced by the device host on the network automatically when the computer is started, invoke [**IUPnPRegistrar::RegisterDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerdevice).</span></span> <span data-ttu-id="8de1d-119">O **RegisterDevice** garante que o código do dispositivo seja carregado apenas quando uma solicitação de assinatura de evento ou controle for recebida.</span><span class="sxs-lookup"><span data-stu-id="8de1d-119">**RegisterDevice** ensures that your device code is only loaded when a control or event subscription request is received.</span></span>

<span data-ttu-id="8de1d-120">Se seus dispositivos forem transitórios ou ligados, invoque [**IUPnPRegistrar:: RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice)e o dispositivo não será automaticamente anunciado quando o computador for reiniciado.</span><span class="sxs-lookup"><span data-stu-id="8de1d-120">If your devices are transient or bridged, invoke [**IUPnPRegistrar::RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice), and the device is not automatically re-advertised when the computer is restarted.</span></span>

## <a name="discovery-announcement-lifetime"></a><span data-ttu-id="8de1d-121">Tempo de vida do anúncio de descoberta</span><span class="sxs-lookup"><span data-stu-id="8de1d-121">Discovery Announcement Lifetime</span></span>

<span data-ttu-id="8de1d-122">Cada dispositivo registrado com o host do dispositivo é associado a um tempo de vida, que é especificado pelo dispositivo após o registro.</span><span class="sxs-lookup"><span data-stu-id="8de1d-122">Each device registered with the device host is associated with a lifetime, which is specified by the device upon registration.</span></span> <span data-ttu-id="8de1d-123">O tempo de vida do dispositivo é o período durante o qual os comunicados de descoberta do dispositivo são válidos.</span><span class="sxs-lookup"><span data-stu-id="8de1d-123">The lifetime of the device is the period of time for which the device's discovery announcements are valid.</span></span> <span data-ttu-id="8de1d-124">O tempo de vida é passado para o ponto de controle como um cabeçalho no anúncio de descoberta inicial.</span><span class="sxs-lookup"><span data-stu-id="8de1d-124">The lifetime is passed to the control point as a header in the initial discovery announcement.</span></span> <span data-ttu-id="8de1d-125">O host do dispositivo atualiza automaticamente o comunicado antes do tempo de expiração.</span><span class="sxs-lookup"><span data-stu-id="8de1d-125">The device host automatically refreshes the announcement prior to the expiration time.</span></span> <span data-ttu-id="8de1d-126">Os valores do tempo de vida do anúncio de descoberta devem ser 15 minutos ou mais (o padrão é 30 minutos).</span><span class="sxs-lookup"><span data-stu-id="8de1d-126">The values of the discovery announcement lifetime should be 15 minutes or more (the default is 30 minutes).</span></span>

## <a name="device-identifiers-created-at-registration"></a><span data-ttu-id="8de1d-127">Identificadores de dispositivo criados no registro</span><span class="sxs-lookup"><span data-stu-id="8de1d-127">Device Identifiers Created at Registration</span></span>

<span data-ttu-id="8de1d-128">Ao criar um modelo de descrição do dispositivo, o desenvolvedor do dispositivo deve fornecer o caminho do recurso para a descrição do serviço e os ícones associados.</span><span class="sxs-lookup"><span data-stu-id="8de1d-128">When creating a device description template, the device developer must provide the resource path to the service description and associated icons.</span></span> <span data-ttu-id="8de1d-129">O caminho do recurso é determinado pelo aplicativo do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8de1d-129">The resource path is determined by the device application.</span></span>

<span data-ttu-id="8de1d-130">Como o mesmo dispositivo pode ser registrado várias vezes no mesmo computador, o UDN especificado no modelo de descrição do dispositivo não é suficiente para identificar exclusivamente um dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8de1d-130">Since the same device can be registered multiple times on the same computer, the UDN specified in the device description template is not sufficient to uniquely identify a device.</span></span> <span data-ttu-id="8de1d-131">Portanto, quando um dispositivo é registrado, o host do dispositivo cria um identificador de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8de1d-131">Therefore, when a device is registered, the device host creates a device identifier.</span></span> <span data-ttu-id="8de1d-132">Esse identificador de dispositivo, em associação com o UDN no modelo de descrição do dispositivo, pode ser usado para identificar exclusivamente um dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8de1d-132">This device identifier, in association with the UDN in the device description template, can be used to uniquely identify a device.</span></span>

<span data-ttu-id="8de1d-133">Esse identificador também é usado quando o registro do dispositivo é cancelado temporariamente e, em seguida, registrado novamente.</span><span class="sxs-lookup"><span data-stu-id="8de1d-133">This identifier is also used when the device is temporarily unregistered and then re-registered.</span></span> <span data-ttu-id="8de1d-134">Quando um dispositivo é desregistrado temporariamente, o host do dispositivo não exclui o UDN.</span><span class="sxs-lookup"><span data-stu-id="8de1d-134">When a device is unregistered temporarily, the device host does not delete the UDN.</span></span> <span data-ttu-id="8de1d-135">Os motivos para não excluir o UDN incluem:</span><span class="sxs-lookup"><span data-stu-id="8de1d-135">Reasons for not deleting the UDN include:</span></span>

-   <span data-ttu-id="8de1d-136">O dispositivo está sendo atualizado.</span><span class="sxs-lookup"><span data-stu-id="8de1d-136">The device is being upgraded.</span></span>
-   <span data-ttu-id="8de1d-137">Você está alterando as propriedades do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8de1d-137">You are changing the properties of the device.</span></span>
-   <span data-ttu-id="8de1d-138">Um serviço está temporariamente indisponível.</span><span class="sxs-lookup"><span data-stu-id="8de1d-138">A service is temporarily unavailable.</span></span>
-   <span data-ttu-id="8de1d-139">Você está adicionando um novo serviço a um dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8de1d-139">You are adding a new service to a device.</span></span>
-   <span data-ttu-id="8de1d-140">Você está atualizando a DLL.</span><span class="sxs-lookup"><span data-stu-id="8de1d-140">You are updating the DLL.</span></span>
-   <span data-ttu-id="8de1d-141">O dispositivo está em modo de espera.</span><span class="sxs-lookup"><span data-stu-id="8de1d-141">The device is in stand-by mode.</span></span>

<span data-ttu-id="8de1d-142">Consulte as seções a seguir para obter mais informações sobre o registro:</span><span class="sxs-lookup"><span data-stu-id="8de1d-142">Refer to the following sections for further information on registration:</span></span>

-   [<span data-ttu-id="8de1d-143">Como registrar um dispositivo no host do dispositivo</span><span class="sxs-lookup"><span data-stu-id="8de1d-143">How to Register a Device with the Device Host</span></span>](how-to-register-a-device-with-the-device-host.md)
-   [<span data-ttu-id="8de1d-144">Cancelando o registro de um dispositivo</span><span class="sxs-lookup"><span data-stu-id="8de1d-144">Unregistering a Device</span></span>](unregistering-a-device.md)
-   [<span data-ttu-id="8de1d-145">**IUPnPRegistrar::UnregisterDevice**</span><span class="sxs-lookup"><span data-stu-id="8de1d-145">**IUPnPRegistrar::UnregisterDevice**</span></span>](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-unregisterdevice)
-   [<span data-ttu-id="8de1d-146">**IUPnPReregistrar**</span><span class="sxs-lookup"><span data-stu-id="8de1d-146">**IUPnPReregistrar**</span></span>](/windows/desktop/api/Upnphost/nn-upnphost-iupnpreregistrar)

 

 




