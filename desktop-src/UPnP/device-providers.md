---
title: Provedores de dispositivo
description: Os provedores de dispositivo são objetos registrados que o computador inicia em todas as inicializações do sistema.
ms.assetid: 80c08993-0a8b-4ee9-93cd-bcc3c00e843b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 67fac270342830045fc3bac9f0573f283d87dc6a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104084599"
---
# <a name="device-providers"></a><span data-ttu-id="1e544-103">Provedores de dispositivo</span><span class="sxs-lookup"><span data-stu-id="1e544-103">Device Providers</span></span>

<span data-ttu-id="1e544-104">Os provedores de dispositivo são objetos registrados que o computador inicia em todas as inicializações do sistema.</span><span class="sxs-lookup"><span data-stu-id="1e544-104">Device providers are registered objects that the computer starts on every system startup.</span></span> <span data-ttu-id="1e544-105">Os provedores de dispositivo registram e cancelam o registro de dispositivos em execução com o host do dispositivo em resposta a algum evento.</span><span class="sxs-lookup"><span data-stu-id="1e544-105">Device providers register and unregister running devices with the device host in response to some event.</span></span> <span data-ttu-id="1e544-106">Esses dispositivos são dispositivos que foram iniciados automaticamente no momento da inicialização do sistema.</span><span class="sxs-lookup"><span data-stu-id="1e544-106">These devices are devices that have been automatically started at system startup time.</span></span> <span data-ttu-id="1e544-107">Por motivos de segurança, um provedor de dispositivo deve geralmente ser executado como [LocalService](/windows/desktop/Services/localservice-account), em vez de [LocalSystem](/windows/desktop/Services/localsystem-account).</span><span class="sxs-lookup"><span data-stu-id="1e544-107">For security reasons, a device provider should generally run as [LocalService](/windows/desktop/Services/localservice-account), rather than [LocalSystem](/windows/desktop/Services/localsystem-account).</span></span>

<span data-ttu-id="1e544-108">Os provedores de dispositivo podem ser usados para dispositivos transitórios.</span><span class="sxs-lookup"><span data-stu-id="1e544-108">Device providers can be used for transient devices.</span></span> <span data-ttu-id="1e544-109">Os provedores de dispositivos também podem ser usados para ligar dispositivos à mídia sondada.</span><span class="sxs-lookup"><span data-stu-id="1e544-109">Device providers can also be used to bridge devices to polled media.</span></span> <span data-ttu-id="1e544-110">Por exemplo, um dispositivo periférico, como um player digital de música, é conectado a um computador por meio de uma porta serial.</span><span class="sxs-lookup"><span data-stu-id="1e544-110">For example, a peripheral device such as a digital music player is connected to a computer via a serial port.</span></span> <span data-ttu-id="1e544-111">Para expor o player de música como um dispositivo baseado em UPnP, é necessário um objeto de controle de dispositivo e um conjunto de objetos de serviço.</span><span class="sxs-lookup"><span data-stu-id="1e544-111">To expose the music player as a UPnP-based device, a device control object and a set of service objects are required.</span></span> <span data-ttu-id="1e544-112">Esses objetos implementam as ações do player de música baseado em UPnP como comandos seriais.</span><span class="sxs-lookup"><span data-stu-id="1e544-112">These objects implement the UPnP-based music player actions as serial commands.</span></span> <span data-ttu-id="1e544-113">No entanto, o player de música deve estar conectado à porta serial e disponível para controle antes que esses objetos sejam registrados.</span><span class="sxs-lookup"><span data-stu-id="1e544-113">However, the music player must be plugged into the serial port and available for control before these objects are registered.</span></span>

<span data-ttu-id="1e544-114">Como a porta serial não oferece um mecanismo de notificação explícito quando os dispositivos estão conectados, o código de sondagem é necessário.</span><span class="sxs-lookup"><span data-stu-id="1e544-114">Because the serial port does not offer an explicit notification mechanism when devices are connected, polling code is required.</span></span> <span data-ttu-id="1e544-115">Esse código pode ser implementado em um objeto de provedor de dispositivo, em um serviço ou em um aplicativo autônomo.</span><span class="sxs-lookup"><span data-stu-id="1e544-115">This code can be implemented in a device provider object, a service, or in a standalone application.</span></span> <span data-ttu-id="1e544-116">Quando o computador é iniciado, o host do dispositivo instancia o objeto do provedor do dispositivo e, em seguida, invoca o método [**inicial**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) .</span><span class="sxs-lookup"><span data-stu-id="1e544-116">When the computer is started, the device host instantiates the device provider object, and then invokes its [**Start**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) method.</span></span> <span data-ttu-id="1e544-117">Quando o provedor de dispositivo detecta a presença de um dispositivo player de música, ele instancia o objeto de controle de dispositivo apropriado e o registra chamando [**IUPnPRegistrar:: RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice).</span><span class="sxs-lookup"><span data-stu-id="1e544-117">When the device provider detects the presence of a music player device, it instantiates the appropriate device control object and registers it by calling [**IUPnPRegistrar::RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice).</span></span> <span data-ttu-id="1e544-118">Esse método publica o dispositivo e o anuncia para a rede baseada em UPnP.</span><span class="sxs-lookup"><span data-stu-id="1e544-118">This method publishes the device and announces it to the UPnP-based network.</span></span>

<span data-ttu-id="1e544-119">A mesma funcionalidade também pode ser obtida com a implementação de um serviço que sonda a porta serial.</span><span class="sxs-lookup"><span data-stu-id="1e544-119">The same functionality can also be achieved by implementing a service that polls the serial port.</span></span> <span data-ttu-id="1e544-120">No entanto, os provedores de dispositivos simplificam as coisas exigindo apenas a funcionalidade básica — a sondagem — a ser implementada, pois os provedores de dispositivos dependem do host do dispositivo para iniciá-los e pará-los.</span><span class="sxs-lookup"><span data-stu-id="1e544-120">However, device providers simplify things by requiring only the core functionality—the polling—to be implemented because device providers rely on the device host to start and stop them.</span></span> <span data-ttu-id="1e544-121">O uso de provedores de dispositivos é mais simples do que a implementação de um serviço.</span><span class="sxs-lookup"><span data-stu-id="1e544-121">Using device providers is simpler than implementing a service.</span></span>

<span data-ttu-id="1e544-122">No momento do registro, e em cada inicialização subsequente do sistema, o computador instancia o objeto de provedor do dispositivo e, em seguida, invoca o método [**IUPnPDeviceProvider:: Start**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) , passando-o para a cadeia de inicialização especificada durante o registro.</span><span class="sxs-lookup"><span data-stu-id="1e544-122">At registration time, and on every subsequent system startup, the computer instantiates the device provider object, and then invokes its [**IUPnPDeviceProvider::Start**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) method, passing it the initialization string specified during registration.</span></span>

<span data-ttu-id="1e544-123">Depois que o método [**Start**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) é chamado, o provedor do dispositivo executa qualquer processamento necessário e, quando necessário, o provedor do dispositivo registra os dispositivos chamando [**IUPnPRegistrar:: RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice), conforme descrito na seção [registrando um dispositivo hospedado com o host do dispositivo](registering-a-hosted-device-with-the-device-host.md).</span><span class="sxs-lookup"><span data-stu-id="1e544-123">Once the [**Start**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-start) method is called, the device provider performs any necessary processing, and when necessary, the device provider registers devices by calling [**IUPnPRegistrar::RegisterRunningDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice), as described in the section [Registering a Hosted Device with the Device Host](registering-a-hosted-device-with-the-device-host.md).</span></span>

<span data-ttu-id="1e544-124">Quando o computador é desligado, o host do dispositivo invoca o método [**IUPnPDeviceProvider:: Stop**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-stop) para indicar que o provedor do dispositivo encerra suas operações.</span><span class="sxs-lookup"><span data-stu-id="1e544-124">When the computer is shut down, the device host invokes the [**IUPnPDeviceProvider::Stop**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpdeviceprovider-stop) method to indicate that the device provider terminate its operations.</span></span>

 

 