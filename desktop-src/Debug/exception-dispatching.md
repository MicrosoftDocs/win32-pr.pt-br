---
description: Quando ocorre uma exceção de hardware ou software, o processador para a execução no ponto em que a exceção ocorreu e transfere o controle para o sistema.
ms.assetid: 35a1b9bd-8da9-47e6-beda-e0b159bd840d
title: Expedição de exceção
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e02b40aa132541fe88d692cbbf1881a8b620a209
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104088842"
---
# <a name="exception-dispatching"></a><span data-ttu-id="26ea3-103">Expedição de exceção</span><span class="sxs-lookup"><span data-stu-id="26ea3-103">Exception Dispatching</span></span>

<span data-ttu-id="26ea3-104">Quando ocorre uma exceção de hardware ou software, o processador para a execução no ponto em que a exceção ocorreu e transfere o controle para o sistema.</span><span class="sxs-lookup"><span data-stu-id="26ea3-104">When a hardware or software exception occurs, the processor stops execution at the point at which the exception occurred and transfers control to the system.</span></span> <span data-ttu-id="26ea3-105">Primeiro, o sistema salva o estado da máquina do thread atual e as informações que descrevem a exceção.</span><span class="sxs-lookup"><span data-stu-id="26ea3-105">First, the system saves both the machine state of the current thread and information that describes the exception.</span></span> <span data-ttu-id="26ea3-106">Em seguida, o sistema tenta encontrar um manipulador de exceção para manipular a exceção.</span><span class="sxs-lookup"><span data-stu-id="26ea3-106">The system then attempts to find an exception handler to handle the exception.</span></span>

<span data-ttu-id="26ea3-107">O estado da máquina do thread no qual a exceção ocorreu é salvo em uma estrutura de [**contexto**](/windows/desktop/api/WinNT/ns-winnt-arm64_nt_context) .</span><span class="sxs-lookup"><span data-stu-id="26ea3-107">The machine state of the thread in which the exception occurred is saved in a [**CONTEXT**](/windows/desktop/api/WinNT/ns-winnt-arm64_nt_context) structure.</span></span> <span data-ttu-id="26ea3-108">Essas informações (chamadas de *registro de contexto*) permitem que o sistema continue a execução no ponto da exceção se a exceção for manipulada com êxito.</span><span class="sxs-lookup"><span data-stu-id="26ea3-108">This information (called the *context record*) enables the system to continue execution at the point of the exception if the exception is successfully handled.</span></span> <span data-ttu-id="26ea3-109">A descrição da exceção (chamada de **registro de exceção**) é salva em uma estrutura de [**\_ registro de exceção**](/windows/desktop/api/WinNT/ns-winnt-exception_record) .</span><span class="sxs-lookup"><span data-stu-id="26ea3-109">The description of the exception (called the **exception record**) is saved in an [**EXCEPTION\_RECORD**](/windows/desktop/api/WinNT/ns-winnt-exception_record) structure.</span></span> <span data-ttu-id="26ea3-110">Como ele armazena as informações dependentes do computador do registro de contexto separadamente das informações independentes da máquina do registro de exceção, o mecanismo de tratamento de exceções é portátil para diferentes plataformas.</span><span class="sxs-lookup"><span data-stu-id="26ea3-110">Because it stores the machine-dependent information of the context record separately from the machine-independent information of the exception record, the exception-handling mechanism is portable to different platforms.</span></span>

<span data-ttu-id="26ea3-111">As informações no contexto e nos registros de exceção estão disponíveis por meio da função [**GetExceptionInformation**](getexceptioninformation.md) e podem ser disponibilizadas para quaisquer manipuladores de exceção que são executados como resultado da exceção.</span><span class="sxs-lookup"><span data-stu-id="26ea3-111">The information in both the context and exception records is available by means of the [**GetExceptionInformation**](getexceptioninformation.md) function, and can be made available to any exception handlers that are executed as a result of the exception.</span></span> <span data-ttu-id="26ea3-112">O registro de exceção inclui as informações a seguir.</span><span class="sxs-lookup"><span data-stu-id="26ea3-112">The exception record includes the following information.</span></span>

-   <span data-ttu-id="26ea3-113">Um código de exceção que identifica o tipo de exceção.</span><span class="sxs-lookup"><span data-stu-id="26ea3-113">An exception code that identifies the type of exception.</span></span>
-   <span data-ttu-id="26ea3-114">Sinalizadores que indicam se a exceção é continuável.</span><span class="sxs-lookup"><span data-stu-id="26ea3-114">Flags indicating whether the exception is continuable.</span></span> <span data-ttu-id="26ea3-115">Qualquer tentativa de continuar a execução após uma exceção não continuável gera outra exceção.</span><span class="sxs-lookup"><span data-stu-id="26ea3-115">Any attempt to continue execution after a noncontinuable exception generates another exception.</span></span>
-   <span data-ttu-id="26ea3-116">Um ponteiro para outro registro de exceção.</span><span class="sxs-lookup"><span data-stu-id="26ea3-116">A pointer to another exception record.</span></span> <span data-ttu-id="26ea3-117">Isso facilita a criação de uma lista vinculada de exceções se ocorrerem exceções aninhadas.</span><span class="sxs-lookup"><span data-stu-id="26ea3-117">This facilitates creation of a linked list of exceptions if nested exceptions occur.</span></span>
-   <span data-ttu-id="26ea3-118">O endereço no qual a exceção ocorreu.</span><span class="sxs-lookup"><span data-stu-id="26ea3-118">The address at which the exception occurred.</span></span>
-   <span data-ttu-id="26ea3-119">Uma matriz de argumentos que fornece informações adicionais sobre a exceção.</span><span class="sxs-lookup"><span data-stu-id="26ea3-119">An array of arguments that provide additional information about the exception.</span></span>

<span data-ttu-id="26ea3-120">Quando ocorre uma exceção no código de modo de usuário, o sistema usa a seguinte ordem de pesquisa para encontrar um manipulador de exceção:</span><span class="sxs-lookup"><span data-stu-id="26ea3-120">When an exception occurs in user-mode code, the system uses the following search order to find an exception handler:</span></span>

1.  <span data-ttu-id="26ea3-121">Se o processo estiver sendo depurado, o sistema notificará o depurador.</span><span class="sxs-lookup"><span data-stu-id="26ea3-121">If the process is being debugged, the system notifies the debugger.</span></span> <span data-ttu-id="26ea3-122">Para obter mais informações, consulte [manipulação de exceção do depurador](debugger-exception-handling.md).</span><span class="sxs-lookup"><span data-stu-id="26ea3-122">For more information, see [Debugger Exception Handling](debugger-exception-handling.md).</span></span>
2.  <span data-ttu-id="26ea3-123">Se o processo não estiver sendo depurado, ou se o depurador associado não tratar a exceção, o sistema tentará localizar um manipulador de exceção baseado em quadros pesquisando os quadros de pilha do thread no qual a exceção ocorreu.</span><span class="sxs-lookup"><span data-stu-id="26ea3-123">If the process is not being debugged, or if the associated debugger does not handle the exception, the system attempts to locate a frame-based exception handler by searching the stack frames of the thread in which the exception occurred.</span></span> <span data-ttu-id="26ea3-124">O sistema pesquisa primeiro o quadro de pilha atual e, em seguida, pesquisa os quadros de pilha anteriores na ordem inversa.</span><span class="sxs-lookup"><span data-stu-id="26ea3-124">The system searches the current stack frame first, then searches through preceding stack frames in reverse order.</span></span>
3.  <span data-ttu-id="26ea3-125">Se nenhum manipulador baseado em quadros puder ser encontrado ou nenhum manipulador baseado em quadros tratar a exceção, mas o processo estiver sendo depurado, o sistema notificará o depurador uma segunda vez.</span><span class="sxs-lookup"><span data-stu-id="26ea3-125">If no frame-based handler can be found, or no frame-based handler handles the exception, but the process is being debugged, the system notifies the debugger a second time.</span></span>
4.  <span data-ttu-id="26ea3-126">Se o processo não estiver sendo depurado, ou se o depurador associado não tratar a exceção, o sistema fornecerá manipulação padrão com base no tipo de exceção.</span><span class="sxs-lookup"><span data-stu-id="26ea3-126">If the process is not being debugged, or if the associated debugger does not handle the exception, the system provides default handling based on the exception type.</span></span> <span data-ttu-id="26ea3-127">Para a maioria das exceções, a ação padrão é chamar a função [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) .</span><span class="sxs-lookup"><span data-stu-id="26ea3-127">For most exceptions, the default action is to call the [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) function.</span></span>

<span data-ttu-id="26ea3-128">Quando ocorre uma exceção no código do modo kernel, o sistema pesquisa os quadros de pilha da pilha do kernel em uma tentativa de localizar um manipulador de exceção.</span><span class="sxs-lookup"><span data-stu-id="26ea3-128">When an exception occurs in kernel-mode code, the system searches the stack frames of the kernel stack in an attempt to locate an exception handler.</span></span> <span data-ttu-id="26ea3-129">Se um manipulador não puder ser localizado ou nenhum manipulador tratar a exceção, o sistema será desligado como se a função [**ExitWindows**](/windows/win32/api/winuser/nf-winuser-exitwindows) tivesse sido chamada.</span><span class="sxs-lookup"><span data-stu-id="26ea3-129">If a handler cannot be located or no handler handles the exception, the system is shut down as if the [**ExitWindows**](/windows/win32/api/winuser/nf-winuser-exitwindows) function had been called.</span></span>

 

 
