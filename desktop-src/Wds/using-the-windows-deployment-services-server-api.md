---
title: Uso da API de servidor de Serviços de Implantação do Windows
description: Em ambientes em que a solução padrão WDS (serviços de implantação do Windows) não pode ser usada, o servidor WDS expõe uma API que permite aos desenvolvedores escrever plug-ins, conhecidos como provedores, para lidar com solicitações de PXE (Preboot Execution Environment).
ms.assetid: 5e25654a-33c6-4c0f-acc3-e938d1f4a4e7
keywords:
- Serviços de implantação do Windows serviços de implantação do Windows, usando a API do servidor
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d3634dffa73eddc9b5db92be6bc807cccbc5248f
ms.sourcegitcommit: c2a1c4314550ea9bd202d28adfcc7bfe6180932f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/11/2020
ms.locfileid: "103640338"
---
# <a name="using-the-windows-deployment-services-server-api"></a><span data-ttu-id="0f670-104">Uso da API de servidor de Serviços de Implantação do Windows</span><span class="sxs-lookup"><span data-stu-id="0f670-104">Using the Windows Deployment Services Server API</span></span>

<span data-ttu-id="0f670-105">Em ambientes em que a solução padrão WDS (serviços de implantação do Windows) não pode ser usada, o servidor WDS expõe uma API que permite aos desenvolvedores escrever plug-ins, conhecidos como provedores, para lidar com solicitações de PXE (Preboot Execution Environment).</span><span class="sxs-lookup"><span data-stu-id="0f670-105">In environments where the standard Windows Deployment Services (WDS) solution cannot be used, the WDS server exposes an API that enables developers to write plug-ins, referred to as providers, to handle preboot execution environment (PXE) requests.</span></span> <span data-ttu-id="0f670-106">Os desenvolvedores devem aderir às seguintes diretrizes ao escrever provedores PXE para o WDS.</span><span class="sxs-lookup"><span data-stu-id="0f670-106">Developers should adhere to the following guidelines when writing PXE providers for WDS.</span></span>

## <a name="install-the-wds-role-on-the-server"></a><span data-ttu-id="0f670-107">Instalar a função do WDS no servidor</span><span class="sxs-lookup"><span data-stu-id="0f670-107">Install the WDS Role on the Server</span></span>

-   <span data-ttu-id="0f670-108">O WDS (serviços de implantação do Windows) é a versão revisada do RIS (serviços de instalação remota), você precisará da função de servidor do WDS para implementar o servidor PXE do WDS e os provedores.</span><span class="sxs-lookup"><span data-stu-id="0f670-108">Windows Deployment Services (WDS) is the revised version of Remote Installation Services (RIS), you will need the WDS server role to implement the WDS PXE server and providers.</span></span>
-   <span data-ttu-id="0f670-109">O WDS substitui o RIS como o componente padrão a partir do Windows Server 2008 e do Windows Server 2003 com Service Pack 2 (SP2).</span><span class="sxs-lookup"><span data-stu-id="0f670-109">WDS replaces RIS as the standard component starting with Windows Server 2008 and Windows Server 2003 with Service Pack 2 (SP2).</span></span>
-   <span data-ttu-id="0f670-110">Você deve atualizar o servidor RIS para o WDS no Windows Server 2003 com Service Pack 1 (SP1).</span><span class="sxs-lookup"><span data-stu-id="0f670-110">You must update the RIS server to WDS on Windows Server 2003 with Service Pack 1 (SP1).</span></span> <span data-ttu-id="0f670-111">Você pode instalar a função de servidor do WDS com o [WAIK (Kit de instalação automatizada do Windows)](https://www.microsoft.com/download/details.aspx?id=10333).</span><span class="sxs-lookup"><span data-stu-id="0f670-111">You can install the WDS server role with the [Windows Automated Installation Kit (WAIK)](https://www.microsoft.com/download/details.aspx?id=10333).</span></span>

## <a name="register-providers"></a><span data-ttu-id="0f670-112">Registrar provedores</span><span class="sxs-lookup"><span data-stu-id="0f670-112">Register Providers</span></span>

-   <span data-ttu-id="0f670-113">Registre a DLL (biblioteca de vínculo dinâmico) do provedor durante a instalação e insira o provedor na lista ordenada de provedores registrados.</span><span class="sxs-lookup"><span data-stu-id="0f670-113">Register the provider dynamic-link library (DLL) during its installation and insert the provider into the ordered list of registered providers.</span></span>
    > [!Note]  
    > <span data-ttu-id="0f670-114">Ao instalar um provedor novo ou modificado, será necessário reiniciar o serviço WDS PXE para que as alterações entrem em vigor.</span><span class="sxs-lookup"><span data-stu-id="0f670-114">When you install a new or modified provider, you will need to restart WDS PXE service for the changes to take effect.</span></span>

     

-   <span data-ttu-id="0f670-115">Use a função [**PxeProviderRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister) para registrar o provedor e adicioná-lo à lista.</span><span class="sxs-lookup"><span data-stu-id="0f670-115">Use the [**PxeProviderRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister) function to register the provider and add it to the list.</span></span> <span data-ttu-id="0f670-116">Use a função [**PxeProviderUnRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderunregister) para cancelar o registro de um provedor registrado e removê-lo da lista.</span><span class="sxs-lookup"><span data-stu-id="0f670-116">Use the [**PxeProviderUnRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderunregister) function to unregister a registered provider and remove it from the list.</span></span>
-   <span data-ttu-id="0f670-117">Especifique a sequência do provedor na lista ordenada.</span><span class="sxs-lookup"><span data-stu-id="0f670-117">Specify the sequence of the provider in the ordered list.</span></span> <span data-ttu-id="0f670-118">O índice de um provedor na lista não pode ser garantido porque outro provedor pode ser registrado posteriormente antes dele.</span><span class="sxs-lookup"><span data-stu-id="0f670-118">The index of a provider in the list cannot be guaranteed because another provider may later be registered before it.</span></span> <span data-ttu-id="0f670-119">Para inserir o provedor na lista antes ou depois de outro provedor registrado, primeiro use a função [**PxeProviderQueryIndex**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderqueryindex) para obter o índice do provedor registrado e, em seguida, registre o novo provedor ao especificar um valor de índice maior ou menor.</span><span class="sxs-lookup"><span data-stu-id="0f670-119">To insert the provider in the list before or after another registered provider, first use the [**PxeProviderQueryIndex**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderqueryindex) function to get the index of the registered provider and then register the new provider while specifying a larger or smaller index value.</span></span>
-   <span data-ttu-id="0f670-120">A instalação pode armazenar informações de configuração do provedor na chave do registro retornada quando o provedor é registrado.</span><span class="sxs-lookup"><span data-stu-id="0f670-120">The installation can store provider configuration information under the registry key returned when the provider is registered.</span></span> <span data-ttu-id="0f670-121">O endereço da chave do registro é recebido pelo *phProviderKey* de [**PxeProviderRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister).</span><span class="sxs-lookup"><span data-stu-id="0f670-121">The address of the registry key is received by the *phProviderKey* of [**PxeProviderRegister**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderregister).</span></span> <span data-ttu-id="0f670-122">O provedor recebe um identificador para essa mesma chave como o parâmetro *hProviderKey* para seu retorno de chamada [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="0f670-122">The provider receives a handle to this same key as the *hProviderKey* parameter to its [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span> <span data-ttu-id="0f670-123">O provedor deve armazenar o endereço dessa chave.</span><span class="sxs-lookup"><span data-stu-id="0f670-123">The provider should store the address of this key.</span></span>
-   <span data-ttu-id="0f670-124">Sempre instale a DLL (biblioteca de vínculo dinâmico) do provedor na pasta arquivos de programas do servidor.</span><span class="sxs-lookup"><span data-stu-id="0f670-124">Always install the provider dynamic-link library (DLL) in the server's Program Files folder.</span></span>

## <a name="initialize"></a><span data-ttu-id="0f670-125">Inicializar</span><span class="sxs-lookup"><span data-stu-id="0f670-125">Initialize</span></span>

-   <span data-ttu-id="0f670-126">Inclua uma DLL que exporta a função de retorno de chamada [*PxeProviderInitialize*](pxeproviderinitialize.md) no provedor.</span><span class="sxs-lookup"><span data-stu-id="0f670-126">Include a DLL that exports the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback function in the provider.</span></span> <span data-ttu-id="0f670-127">Cada provedor requer um retorno de chamada *PxeProviderInitialize* .</span><span class="sxs-lookup"><span data-stu-id="0f670-127">Every provider requires a *PxeProviderInitialize* callback.</span></span> <span data-ttu-id="0f670-128">Quando o WDS carrega um provedor, ele chama a função *PxeProviderInitialize* do provedor e passa um identificador para a mesma chave que é usada para armazenar informações de configuração durante o registro do provedor.</span><span class="sxs-lookup"><span data-stu-id="0f670-128">When WDS loads a provider, it calls the provider's *PxeProviderInitialize* function and passes a handle to the same key that is used to store configuration information during provider registration.</span></span>
-   <span data-ttu-id="0f670-129">Quando o retorno de chamada [*PxeProviderInitialize*](pxeproviderinitialize.md) retorna e é bem-sucedido, o provedor deve ser totalmente inicializado e pronto para processar solicitações.</span><span class="sxs-lookup"><span data-stu-id="0f670-129">When the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback returns and is successful, the provider should be fully initialized and ready to process requests.</span></span>
-   <span data-ttu-id="0f670-130">Registre cada retorno de chamada no provedor durante o processamento da função [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="0f670-130">Register every callback in the provider during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) function.</span></span> <span data-ttu-id="0f670-131">Os retornos de chamada devem ser registrados com a função [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) .</span><span class="sxs-lookup"><span data-stu-id="0f670-131">Callbacks should be registered with the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function.</span></span>
-   <span data-ttu-id="0f670-132">Inicialize todos os recursos internos do provedor dentro do processamento de sua função [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="0f670-132">Initialize all the provider's internal resources within the processing of its [*PxeProviderInitialize*](pxeproviderinitialize.md) function.</span></span>

## <a name="shutdown"></a><span data-ttu-id="0f670-133">Desligar</span><span class="sxs-lookup"><span data-stu-id="0f670-133">Shutdown</span></span>

-   <span data-ttu-id="0f670-134">Implemente o retorno de chamada [*PxeProviderShutdown*](pxeprovidershutdown.md) .</span><span class="sxs-lookup"><span data-stu-id="0f670-134">Implement the [*PxeProviderShutdown*](pxeprovidershutdown.md) callback.</span></span> <span data-ttu-id="0f670-135">Todo provedor precisa ter um retorno de chamada *PxeProviderShutdown*.</span><span class="sxs-lookup"><span data-stu-id="0f670-135">Every provider is required to have a *PxeProviderShutdown* callback.</span></span>
-   <span data-ttu-id="0f670-136">A função de retorno de chamada [*PxeProviderShutdown*](pxeprovidershutdown.md) deve desligar completamente o provedor e liberar todos os seus recursos.</span><span class="sxs-lookup"><span data-stu-id="0f670-136">The [*PxeProviderShutdown*](pxeprovidershutdown.md) callback function should fully shut down the provider and release all its resources.</span></span>
-   <span data-ttu-id="0f670-137">Depois que o retorno de chamada [*PxeProviderShutdown*](pxeprovidershutdown.md) retorna, o identificador *hProvider* passado para a função [*PxeProviderInitialize*](pxeproviderinitialize.md) não é mais válido e não deve ser usado para chamar o WDS.</span><span class="sxs-lookup"><span data-stu-id="0f670-137">After the [*PxeProviderShutdown*](pxeprovidershutdown.md) callback returns, the *hProvider* handle passed to the [*PxeProviderInitialize*](pxeproviderinitialize.md) function is no longer valid and should not be used to call WDS.</span></span>
-   <span data-ttu-id="0f670-138">Registre o retorno de chamada [*PxeProviderShutdown*](pxeprovidershutdown.md) chamando a função [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) com o **\_ \_ desligamento de retorno de chamada PXE** durante o processamento do retorno de chamada [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="0f670-138">Register the [*PxeProviderShutdown*](pxeprovidershutdown.md) callback by calling the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function with **PXE\_CALLBACK\_SHUTDOWN** during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span> <span data-ttu-id="0f670-139">Não chame o retorno de chamada *PxeProviderShutdown* se a função *PxeProviderInitialize* falhar.</span><span class="sxs-lookup"><span data-stu-id="0f670-139">Do not call the *PxeProviderShutdown* callback if the *PxeProviderInitialize* function fails.</span></span>

## <a name="handle-request-packet"></a><span data-ttu-id="0f670-140">Processar pacote de solicitação</span><span class="sxs-lookup"><span data-stu-id="0f670-140">Handle Request Packet</span></span>

<span data-ttu-id="0f670-141">Implemente o retorno de chamada [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) para o provedor.</span><span class="sxs-lookup"><span data-stu-id="0f670-141">Implement the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback for the provider.</span></span> <span data-ttu-id="0f670-142">Todo provedor precisa ter um retorno de chamada *PxeProviderRecvRequest* .</span><span class="sxs-lookup"><span data-stu-id="0f670-142">Every provider is required to have a *PxeProviderRecvRequest* callback.</span></span> <span data-ttu-id="0f670-143">Quando o WDS recebe uma solicitação, ele chama o retorno de chamada *PxeProviderRecvRequest* para o primeiro provedor na lista de provedores registrados.</span><span class="sxs-lookup"><span data-stu-id="0f670-143">When WDS receives a request, it calls the *PxeProviderRecvRequest* callback for the first provider in the registered provider list.</span></span>

-   <span data-ttu-id="0f670-144">Se o provedor processar essa solicitação de forma síncrona, a função [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) deverá retornar um valor **de \_ êxito de erro**.</span><span class="sxs-lookup"><span data-stu-id="0f670-144">If the provider will process this request synchronously, the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) function should return a value of **ERROR\_SUCCESS**.</span></span> <span data-ttu-id="0f670-145">Se e somente se o provedor processar essa solicitação de forma assíncrona, o retorno de chamada *PxeProviderRecvRequest* deverá retornar o **erro e \_ /s \_ pendente** e chamará a função [**PxeAsyncRecvDone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) quando a solicitação tiver sido processada.</span><span class="sxs-lookup"><span data-stu-id="0f670-145">If and only if the provider will process this request asynchronously, the *PxeProviderRecvRequest* callback should return **ERROR\_IO\_PENDING** and call the [**PxeAsyncRecvDone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) function when the request has been processed.</span></span>
-   <span data-ttu-id="0f670-146">O retorno de chamada [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) e a função [**PxeAsyncRecvDone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) retorna o endereço de uma enumeração de **\_ \_ ação de inicialização PXE** que descreve a ação realizada pelo provedor para manipular a solicitação.</span><span class="sxs-lookup"><span data-stu-id="0f670-146">The [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback and the [**PxeAsyncRecvDone**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeasyncrecvdone) function returns the address of a **PXE\_BOOT\_ACTION** enum that describes the action taken by the provider to handle the request.</span></span>

    <span data-ttu-id="0f670-147">Há quatro maneiras de um provedor lidar com uma solicitação:</span><span class="sxs-lookup"><span data-stu-id="0f670-147">There are four ways for a provider to handle a request:</span></span>

    -   <span data-ttu-id="0f670-148">O provedor responde ao cliente com um pacote de resposta DHCP padrão que contém um caminho para o programa de inicialização de rede.</span><span class="sxs-lookup"><span data-stu-id="0f670-148">The provider replies to the client with a standard DHCP response packet that contains a path to the Network Boot Program.</span></span> <span data-ttu-id="0f670-149">Retornar o valor de **\_ \_ NBP da BA PXE** para a enumeração significa que o provedor processou com êxito o pacote de solicitação e concluiu a solicitação enviando um pacote de resposta chamando as funções [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) e [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) .</span><span class="sxs-lookup"><span data-stu-id="0f670-149">Returning the **PXE\_BA\_NBP** value for the enum means that the provider has successfully processed the request packet and completed the request by sending a response packet by calling the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) and [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) functions.</span></span>
    -   <span data-ttu-id="0f670-150">O provedor responde ao cliente com um pacote de resposta personalizado que não está em conformidade com o DHCP.</span><span class="sxs-lookup"><span data-stu-id="0f670-150">The provider replies to the client with a custom response packet that does not conform to DHCP.</span></span> <span data-ttu-id="0f670-151">Retornar o **valor \_ \_ personalizado de Ba do PXE** para enum significa que o provedor processou com êxito o pacote de solicitação e concluiu a solicitação enviando um pacote de resposta personalizado chamando as funções [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) e [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) .</span><span class="sxs-lookup"><span data-stu-id="0f670-151">Returning the **PXE\_BA\_CUSTOM** value for the enum means that the provider has successfully processed the request packet and completed the request by sending a custom response packet by calling the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) and [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) functions.</span></span>
    -   <span data-ttu-id="0f670-152">O provedor determina que a solicitação deve ser ignorada.</span><span class="sxs-lookup"><span data-stu-id="0f670-152">The provider determines the request should be ignored.</span></span> <span data-ttu-id="0f670-153">Retornar o valor de **\_ \_ ignorar BA do PXE** para a enumeração significa que o provedor liberou todos os recursos associados à solicitação e a solicitação não é passada para o próximo provedor na lista de provedores registrados.</span><span class="sxs-lookup"><span data-stu-id="0f670-153">Returning the **PXE\_BA\_IGNORE** value for the enum means the provider has released all resources associated with the request and the request is not passed to the next provider in the list of registered providers.</span></span> <span data-ttu-id="0f670-154">Os provedores podem usar essa opção se detectarem que um pacote de solicitação é inválido.</span><span class="sxs-lookup"><span data-stu-id="0f670-154">Providers may use this option if they detect that a request packet is invalid.</span></span>
    -   <span data-ttu-id="0f670-155">O provedor recusa a atender à solicitação.</span><span class="sxs-lookup"><span data-stu-id="0f670-155">The provider declines to service the request.</span></span> <span data-ttu-id="0f670-156">Retornar o valor de **\_ \_ rejeição de Ba do PXE** para a enumeração instrui o sistema a passar a solicitação para o próximo provedor na lista de provedores registrados.</span><span class="sxs-lookup"><span data-stu-id="0f670-156">Returning the **PXE\_BA\_REJECT** value for the enum instructs the system to pass the request to the next provider in the list of registered providers.</span></span> <span data-ttu-id="0f670-157">Se esse for o último provedor na lista, isso liberará todos os recursos associados à solicitação e a solicitação será ignorada.</span><span class="sxs-lookup"><span data-stu-id="0f670-157">If this were the last provider in the list, this releases all resources associated with the request and the request is ignored.</span></span>
    -   <span data-ttu-id="0f670-158">Registre o retorno de chamada [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) chamando a função [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) com a solicitação de **recebimento de retorno de \_ chamada \_ \_ PXE** durante o processamento do retorno de chamada [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="0f670-158">Register the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback by calling the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function with **PXE\_CALLBACK\_RECV\_REQUEST** during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span>

## <a name="generate-response-packet"></a><span data-ttu-id="0f670-159">Gerar pacote de resposta</span><span class="sxs-lookup"><span data-stu-id="0f670-159">Generate Response Packet</span></span>

-   <span data-ttu-id="0f670-160">Use a API para gravar provedores para lidar com solicitações DHCP e gerar pacotes de resposta.</span><span class="sxs-lookup"><span data-stu-id="0f670-160">Use the API to write providers to handle DHCP request and generate response packets.</span></span>
-   <span data-ttu-id="0f670-161">A função [**PxeProviderSetAttribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) especifica os atributos usados pelo provedor para filtrar os pacotes.</span><span class="sxs-lookup"><span data-stu-id="0f670-161">The [**PxeProviderSetAttribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) function specifies the attributes used by the provider to filter packets.</span></span> <span data-ttu-id="0f670-162">Os atributos do provedor podem ser especificados para que o provedor Veja todos os pacotes, o provedor vê apenas os pacotes DHCP ou o provedor vê somente os pacotes DHCP que especificam a opção de identificador de classe de fornecedor DHCP (60) como "PXEClient".</span><span class="sxs-lookup"><span data-stu-id="0f670-162">The attributes of the provider can be specified so that the provider see all packets, the provider sees only DHCP packets, or the provider sees only DHCP packets that specify the DHCP Vendor Class Identifier option (60) as "PXEClient".</span></span>
-   <span data-ttu-id="0f670-163">A função [**PxeDhcpIsValid**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpisvalid) verifica se um pacote é um pacote DHCP válido.</span><span class="sxs-lookup"><span data-stu-id="0f670-163">The [**PxeDhcpIsValid**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpisvalid) function checks that a packet is a valid DHCP packet.</span></span> <span data-ttu-id="0f670-164">Os provedores podem usar a função **PxeDhcpIsValid** para verificar se um pacote do cliente é um pacote DHCP quando o conjunto de filtros com a função [**PxeProviderSetAttribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) é definido para receber todos os pacotes para determinar se um pacote especificado é um pacote DHCP válido.</span><span class="sxs-lookup"><span data-stu-id="0f670-164">Providers can use the **PxeDhcpIsValid** function to check whether a packet from the client is a DHCP packet when the filter set with the [**PxeProviderSetAttribute**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeprovidersetattribute) function is set to receive all packets to determine if a specified packet is a valid DHCP packet.</span></span>
-   <span data-ttu-id="0f670-165">A função [**PxeDhcpInitialize**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpinitialize) Inicializa um pacote de resposta como um pacote de resposta DHCP baseado nas informações de um pacote recebido do cliente.</span><span class="sxs-lookup"><span data-stu-id="0f670-165">The [**PxeDhcpInitialize**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpinitialize) function initializes a response packet as a DHCP reply packet that is based on the information in a packet received from the client.</span></span> <span data-ttu-id="0f670-166">A função [*PxeProviderInitialize*](pxeproviderinitialize.md) pega o endereço de um pacote DHCP válido recebido do cliente no retorno de chamada [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) .</span><span class="sxs-lookup"><span data-stu-id="0f670-166">The [*PxeProviderInitialize*](pxeproviderinitialize.md) function takes the address of a valid DHCP packet received from the client in the [*PxeProviderRecvRequest*](pxeproviderrecvrequest.md) callback.</span></span> <span data-ttu-id="0f670-167">A função **PxeDhcpInitialize** usa um ponteiro para um pacote de resposta alocado com a função [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) .</span><span class="sxs-lookup"><span data-stu-id="0f670-167">The **PxeDhcpInitialize** function takes a pointer to a reply packet allocated with the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) function.</span></span>
-   <span data-ttu-id="0f670-168">A função [**PxeDhcpGetOptionValue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetoptionvalue) recupera um valor de opção de um pacote DHCP.</span><span class="sxs-lookup"><span data-stu-id="0f670-168">The [**PxeDhcpGetOptionValue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetoptionvalue) function retrieves an option value from a DHCP packet.</span></span> <span data-ttu-id="0f670-169">A função [**PxeDhcpGetVendorOptionValue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetvendoroptionvalue) recupera um valor de opção do campo informações específicas do fornecedor (43) de um pacote DHCP.</span><span class="sxs-lookup"><span data-stu-id="0f670-169">The [**PxeDhcpGetVendorOptionValue**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpgetvendoroptionvalue) function retrieves an option value from the Vendor Specific Information field (43) of a DHCP packet.</span></span>
-   <span data-ttu-id="0f670-170">O provedor pode então popular o pacote de resposta com informações e usar a função [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) para enviar o pacote de resposta ao cliente.</span><span class="sxs-lookup"><span data-stu-id="0f670-170">The provider can then populate the reply packet with information and use the [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) function to send the reply packet to the client.</span></span> <span data-ttu-id="0f670-171">A função [**PxeDhcpAppendOption**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpappendoption) acrescenta uma opção DHCP ao pacote de resposta.</span><span class="sxs-lookup"><span data-stu-id="0f670-171">The [**PxeDhcpAppendOption**](/windows/win32/api/WdsPxe/nf-wdspxe-pxedhcpappendoption) function appends a DHCP option to the reply packet.</span></span>
-   <span data-ttu-id="0f670-172">Um provedor que responde às solicitações do cliente enviando um pacote deve alocar o pacote de resposta usando a função [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) .</span><span class="sxs-lookup"><span data-stu-id="0f670-172">A provider that replies to client requests by sending a packet must allocate the response packet using the [**PxePacketAllocate**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketallocate) function.</span></span> <span data-ttu-id="0f670-173">O provedor pode então popular o pacote de resposta com informações e usar a função [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) para enviar o pacote de resposta ao cliente.</span><span class="sxs-lookup"><span data-stu-id="0f670-173">The provider can then populate the reply packet with information and use the [**PxeSendReply**](/windows/win32/api/WdsPxe/nf-wdspxe-pxesendreply) function to send the reply packet to the client.</span></span>
-   <span data-ttu-id="0f670-174">Quando a memória alocada não for mais necessária, o provedor deverá liberá-la usando a função [**PxePacketFree**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketfree) .</span><span class="sxs-lookup"><span data-stu-id="0f670-174">When the allocated memory is no longer needed, the provider should release it using the [**PxePacketFree**](/windows/win32/api/WdsPxe/nf-wdspxe-pxepacketfree) function.</span></span>

## <a name="enumerate-registered-providers"></a><span data-ttu-id="0f670-175">Enumerar provedores registrados</span><span class="sxs-lookup"><span data-stu-id="0f670-175">Enumerate Registered Providers</span></span>

-   <span data-ttu-id="0f670-176">Use a API para gravar provedores que enumerem e verifiquem outros provedores registrados na lista.</span><span class="sxs-lookup"><span data-stu-id="0f670-176">Use the API to write providers that enumerate and check other registered providers in the list.</span></span>
-   <span data-ttu-id="0f670-177">A função [**PxeGetServerInfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxegetserverinfo) retorna informações sobre o servidor PXE.</span><span class="sxs-lookup"><span data-stu-id="0f670-177">The [**PxeGetServerInfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxegetserverinfo) function returns information about the PXE server.</span></span> <span data-ttu-id="0f670-178">A função **PxeGetServerInfo** retorna um **bool** que indica se o rastreamento está habilitado para o servidor.</span><span class="sxs-lookup"><span data-stu-id="0f670-178">The **PxeGetServerInfo** function returns a **BOOL** that indicates whether tracing is enabled for the server.</span></span> <span data-ttu-id="0f670-179">**Verdadeiro** indica que o rastreamento está habilitado.</span><span class="sxs-lookup"><span data-stu-id="0f670-179">**TRUE** indicates that tracing is enabled.</span></span>
-   <span data-ttu-id="0f670-180">A função [**PxeProviderEnumFirst**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumfirst) inicia um provedor de enumerationof na lista de provedores registrados.</span><span class="sxs-lookup"><span data-stu-id="0f670-180">The [**PxeProviderEnumFirst**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumfirst) function starts an enumerationof providers in the registered provider list.</span></span> <span data-ttu-id="0f670-181">A função **PxeProviderEnumFirst** inicia a enumeração e retorna o endereço do identificador que deve ser usado ao chamar a função [**PxeProviderEnumNext**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumnext) .</span><span class="sxs-lookup"><span data-stu-id="0f670-181">The **PxeProviderEnumFirst** function starts the enumeration and returns the address of the handle that should be used when calling the [**PxeProviderEnumNext**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumnext) function.</span></span> <span data-ttu-id="0f670-182">A função **PxeProviderEnumNext** retorna uma estrutura de [**\_ provedor PXE**](/windows/win32/api/wdspxe/ns-wdspxe-pxe_provider) que contém as informações sobre o provedor.</span><span class="sxs-lookup"><span data-stu-id="0f670-182">The **PxeProviderEnumNext** function returns a [**PXE\_PROVIDER**](/windows/win32/api/wdspxe/ns-wdspxe-pxe_provider) structure containing the information about the provider.</span></span> <span data-ttu-id="0f670-183">A função [**PxeProviderFreeInfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderfreeinfo) libera a memória que foi alocada para a estrutura **do \_ provedor PXE** pela função **PxeProviderEnumNext** .</span><span class="sxs-lookup"><span data-stu-id="0f670-183">The [**PxeProviderFreeInfo**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderfreeinfo) function frees the memory that has been allocated for the **PXE\_PROVIDER** structure by the **PxeProviderEnumNext** function.</span></span> <span data-ttu-id="0f670-184">A função [**PxeProviderEnumClose**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumclose) fecha a enumeração de provedores na lista de provedores registrados.</span><span class="sxs-lookup"><span data-stu-id="0f670-184">The [**PxeProviderEnumClose**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeproviderenumclose) function closes the enumeration of providers in the registered providers list.</span></span>

## <a name="handle-service-control-codes"></a><span data-ttu-id="0f670-185">Manipular códigos de controle de serviço</span><span class="sxs-lookup"><span data-stu-id="0f670-185">Handle Service Control Codes</span></span>

-   <span data-ttu-id="0f670-186">Quando uma mensagem de controle de serviço é recebida, o WDS chama o retorno de chamada [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) .</span><span class="sxs-lookup"><span data-stu-id="0f670-186">When a service control message is received, WDS calls the [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) callback.</span></span>
-   <span data-ttu-id="0f670-187">O provedor pode definir uma função de retorno de chamada [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) para manipular mensagens de controle de serviço.</span><span class="sxs-lookup"><span data-stu-id="0f670-187">The provider can define a [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) callback function to handle service control messages.</span></span>
-   <span data-ttu-id="0f670-188">Registre o retorno de chamada [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) chamando a função [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) com o controle de **serviço de retorno de \_ chamada \_ \_ PXE** durante o processamento do retorno de chamada [*PxeProviderInitialize*](pxeproviderinitialize.md) .</span><span class="sxs-lookup"><span data-stu-id="0f670-188">Register the [*PxeProviderServiceControl*](pxeproviderservicecontrol.md) callback by calling the [**PxeRegisterCallback**](/windows/win32/api/WdsPxe/nf-wdspxe-pxeregistercallback) function with **PXE\_CALLBACK\_SERVICE\_CONTROL** during the processing of the [*PxeProviderInitialize*](pxeproviderinitialize.md) callback.</span></span>

## <a name="add-trace-entries-to-pxe-log"></a><span data-ttu-id="0f670-189">Adicionar entradas de rastreamento ao log PXE</span><span class="sxs-lookup"><span data-stu-id="0f670-189">Add Trace Entries to PXE Log</span></span>

-   <span data-ttu-id="0f670-190">A função [**PxeTrace**](/windows/win32/api/WdsPxe/nf-wdspxe-pxetrace) adiciona uma entrada de rastreamento ao log PXE.</span><span class="sxs-lookup"><span data-stu-id="0f670-190">The [**PxeTrace**](/windows/win32/api/WdsPxe/nf-wdspxe-pxetrace) function adds a trace entry to the PXE log.</span></span> <span data-ttu-id="0f670-191">O WDSPXE fornece rastreamento para ajudar os administradores na solução de problemas.</span><span class="sxs-lookup"><span data-stu-id="0f670-191">WDSPXE provides tracing to help administrators in troubleshooting.</span></span> <span data-ttu-id="0f670-192">Os provedores podem registrar entradas de rastreamento de diferentes níveis de severidade.</span><span class="sxs-lookup"><span data-stu-id="0f670-192">Providers can log trace entries of different severity levels.</span></span> <span data-ttu-id="0f670-193">Os administradores podem configurar o WDSPXE para registrar somente as entradas para determinados níveis de gravidade.</span><span class="sxs-lookup"><span data-stu-id="0f670-193">The administrators can configure WDSPXE to only log entries for certain severity levels.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0f670-194">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="0f670-194">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0f670-195">Sobre a API dos serviços de implantação do Windows</span><span class="sxs-lookup"><span data-stu-id="0f670-195">About the Windows Deployment Services API</span></span>](about-the-windows-deployment-services-api.md)
</dt> <dt>

[<span data-ttu-id="0f670-196">Uso da API de cliente de Serviços de Implantação do Windows</span><span class="sxs-lookup"><span data-stu-id="0f670-196">Using the Windows Deployment Services Client API</span></span>](using-the-windows-deployment-services-client-api.md)
</dt> </dl>

 

 




