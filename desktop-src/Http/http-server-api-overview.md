---
title: Visão geral da API do servidor HTTP
description: Este tópico identifica uma sequência típica de operações que usam a API do servidor HTTP.
ms.assetid: 1245fd98-8370-4f1b-8c86-de9be5e678bd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5c99af3e4914c5496c2adea10b3ac658f75f3018
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/19/2020
ms.locfileid: "105761726"
---
# <a name="http-server-api-overview"></a><span data-ttu-id="7b7a4-103">Visão geral da API do servidor HTTP</span><span class="sxs-lookup"><span data-stu-id="7b7a4-103">HTTP Server API Overview</span></span>

<span data-ttu-id="7b7a4-104">A lista a seguir identifica uma sequência típica de operações que usam a API do servidor HTTP:</span><span class="sxs-lookup"><span data-stu-id="7b7a4-104">The following list identifies a typical sequence of operations that use the HTTP Server API:</span></span>

-   <span data-ttu-id="7b7a4-105">Inicialize a API do servidor HTTP usando a função [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) .</span><span class="sxs-lookup"><span data-stu-id="7b7a4-105">Initialize the HTTP Server API by using the [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) function.</span></span>
-   <span data-ttu-id="7b7a4-106">Crie uma fila de solicitações usando a função [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle) .</span><span class="sxs-lookup"><span data-stu-id="7b7a4-106">Create a request queue by using the [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle) function.</span></span>
-   <span data-ttu-id="7b7a4-107">Registre uma ou mais URLs usando a função [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) .</span><span class="sxs-lookup"><span data-stu-id="7b7a4-107">Register one or more URLs by using the [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function.</span></span>
-   <span data-ttu-id="7b7a4-108">Receba solicitações de entrada direcionadas a URLs registradas usando a função [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) e envie respostas HTTP para essas solicitações usando a função [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) .</span><span class="sxs-lookup"><span data-stu-id="7b7a4-108">Receive incoming requests directed to registered URLs by using the [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) function, and send HTTP responses for these requests by using the [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) function.</span></span>
-   <span data-ttu-id="7b7a4-109">Adicional Ao enviar uma resposta, envie um corpo de entidade adicional usando a função [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) .</span><span class="sxs-lookup"><span data-stu-id="7b7a4-109">(Optional) When sending a response, send an additional entity body by using the [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) function.</span></span>
-   <span data-ttu-id="7b7a4-110">Execute operações de limpeza usando as funções [**HttpRemoveUrl**](/windows/desktop/api/Http/nf-http-httpremoveurl), [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) e [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) .</span><span class="sxs-lookup"><span data-stu-id="7b7a4-110">Perform clean-up operations by using the [**HttpRemoveUrl**](/windows/desktop/api/Http/nf-http-httpremoveurl), [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) and [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) functions.</span></span>

<span data-ttu-id="7b7a4-111">Em operações que usam URLs, observe que é a URL processada contida no membro **CookedUrl** da estrutura [**http \_ Request \_ v1**](/windows/desktop/api/Http/ns-http-http_request_v1) que deve ser usada.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-111">In operations that use URLs, note that it is the processed URL contained in the **CookedUrl** member of the [**HTTP\_REQUEST\_V1**](/windows/desktop/api/Http/ns-http-http_request_v1) structure that should be used.</span></span> <span data-ttu-id="7b7a4-112">Não a URL não processada no membro **pRawUrl** , que é exclusivamente para fins de acompanhamento e estatística.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-112">Do not the unprocessed URL in the **pRawUrl** member, which is solely for tracking and statistical purposes.</span></span>

<span data-ttu-id="7b7a4-113">Cada aplicativo cria sua própria fila de solicitações.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-113">Each application creates its own request queue.</span></span> <span data-ttu-id="7b7a4-114">Um aplicativo obtém o identificador da fila de solicitações de [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle).</span><span class="sxs-lookup"><span data-stu-id="7b7a4-114">An application obtains its request queue handle from [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle).</span></span> <span data-ttu-id="7b7a4-115">Ele passa esse identificador para a função [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) para adicionar uma URL à fila de solicitações.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-115">It passes this handle to the [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function to add a URL to the request queue.</span></span> <span data-ttu-id="7b7a4-116">O aplicativo recebe a notificação de uma solicitação de entrada e a recupera da fila de solicitações chamando a função [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) com o identificador da fila de solicitações.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-116">The application receives notification of an incoming request, and retrieves it from the request queue by calling the [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) function with the request queue handle.</span></span> <span data-ttu-id="7b7a4-117">Você pode usar essa função para receber os cabeçalhos de solicitação ou os cabeçalhos e o corpo da entidade.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-117">You can use this function to receive either the request headers or both the headers and entity body.</span></span> <span data-ttu-id="7b7a4-118">[**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) também retorna um identificador de solicitação (RequestId) para a solicitação recebida que é exclusiva para o identificador de solicitação.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-118">[**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) also returns a request identifier (RequestId) for the received request that is unique to the request handle.</span></span>

> [!Note]  
> <span data-ttu-id="7b7a4-119">É responsabilidade do aplicativo examinar todos os cabeçalhos de solicitação relevantes, incluindo cabeçalhos de negociação de conteúdo, se estiverem sendo usados, e falhar solicitações conforme apropriado com base no conteúdo do cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-119">It is the application's responsibility to examine all relevant request headers, including content-negotiation headers if they are being used, and fail requests as appropriate based on header content.</span></span> <span data-ttu-id="7b7a4-120">A API do servidor HTTP garante apenas que cada linha de cabeçalho seja corretamente encerrada e não contenha caracteres ilegais.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-120">The HTTP Server API ensures only that each header line is properly terminated, and does not contain illegal characters.</span></span>

 

<span data-ttu-id="7b7a4-121">Use a função [**HttpReceiveRequestEntityBody**](/windows/desktop/api/Http/nf-http-httpreceiverequestentitybody) com o identificador da fila de solicitações para recuperar partes subsequentes do corpo da entidade de uma solicitação, se houver.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-121">Use the [**HttpReceiveRequestEntityBody**](/windows/desktop/api/Http/nf-http-httpreceiverequestentitybody) function with the request queue handle to retrieve subsequent portions of a request's entity body, if any.</span></span>

> [!Note]  
> <span data-ttu-id="7b7a4-122">A API do servidor HTTP decodifica mensagens em partes no lado do recebimento, mas não executa a codificação em partes no lado de envio.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-122">The HTTP Server API decodes chunked messages on the receive side, but does not perform chunked encoding on the send side.</span></span> <span data-ttu-id="7b7a4-123">Se o agrupamento for necessário no lado de envio, o aplicativo deverá implementá-lo.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-123">If chunking is required on the send side, the application must implement it.</span></span> <span data-ttu-id="7b7a4-124">Para obter mais informações sobre a codificação em partes, consulte [RFC 2616](https://www.ietf.org/rfc/rfc2616.txt).</span><span class="sxs-lookup"><span data-stu-id="7b7a4-124">For more information about chunked encoding, see [RFC 2616](https://www.ietf.org/rfc/rfc2616.txt).</span></span>

 

<span data-ttu-id="7b7a4-125">Use a função [**HttpReceiveClientCertificate**](/windows/desktop/api/Http/nf-http-httpreceiveclientcertificate) com aplicativos que atendem URLs usando um esquema seguro ("**https**") para, opcionalmente, recuperar as informações de certificado do cliente.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-125">Use the [**HttpReceiveClientCertificate**](/windows/desktop/api/Http/nf-http-httpreceiveclientcertificate) function with applications that serve URLs by using a secure scheme ("**https**") to optionally retrieve the client's certificate information.</span></span>

<span data-ttu-id="7b7a4-126">As respostas são enviadas com a função [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) .</span><span class="sxs-lookup"><span data-stu-id="7b7a4-126">Responses are sent with the [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) function.</span></span> <span data-ttu-id="7b7a4-127">Essa função usa RequestId da solicitação correspondente para enviar a resposta.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-127">This function uses the RequestId from the corresponding request to send the response.</span></span> <span data-ttu-id="7b7a4-128">Uma resposta pode ser enviada em várias chamadas de API ao longo do tempo chamando a função [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) com a RequestId da solicitação recebida originalmente.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-128">A response can be sent in several API calls over time by calling the [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) function with the RequestId from the originally received request.</span></span>

> [!Note]  
> <span data-ttu-id="7b7a4-129">Por padrão, [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) usa "Microsoft-HTTPAPI/1.0" como o cabeçalho "Server:".</span><span class="sxs-lookup"><span data-stu-id="7b7a4-129">By default, [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) uses "Microsoft-HTTPAPI/1.0" as the "Server:" header.</span></span> <span data-ttu-id="7b7a4-130">Se um aplicativo especificar um cabeçalho de servidor em uma resposta, esse valor será colocado como a primeira parte do cabeçalho do servidor, seguido de um espaço e, em seguida, "Microsoft-HTTPAPI/1.0".</span><span class="sxs-lookup"><span data-stu-id="7b7a4-130">If an application specifies a server header in a response, that value is placed as the first part of the server header, followed by a space and then "Microsoft-HTTPAPI/1.0".</span></span>

 

<span data-ttu-id="7b7a4-131">Em geral, a API do servidor HTTP oculta os detalhes do gerenciamento de conexão e seus estabelecimentos e subdivisão dos aplicativos.</span><span class="sxs-lookup"><span data-stu-id="7b7a4-131">In general, the HTTP Server API hides details of connection management and their establishment and teardown from applications.</span></span> <span data-ttu-id="7b7a4-132">No entanto, um aplicativo pode opcionalmente detectar a terminação de uma conexão chamando [**HttpWaitForDisconnect**](/windows/desktop/api/Http/nf-http-httpwaitfordisconnect).</span><span class="sxs-lookup"><span data-stu-id="7b7a4-132">However, an application can optionally detect termination of a connection by calling [**HttpWaitForDisconnect**](/windows/desktop/api/Http/nf-http-httpwaitfordisconnect).</span></span>

<span data-ttu-id="7b7a4-133">Os aplicativos devem ser limpos usando as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="7b7a4-133">Applications must clean-up by using the following steps:</span></span>

-   <span data-ttu-id="7b7a4-134">Quando o aplicativo não está escutando ou respondendo a uma URL, a URL é removida usando a função [**HttpRemoveURL**](/windows/desktop/api/Http/nf-http-httpremoveurl) .</span><span class="sxs-lookup"><span data-stu-id="7b7a4-134">When the application is not listening or responding to a URL, the URL is removed by using the [**HttpRemoveURL**](/windows/desktop/api/Http/nf-http-httpremoveurl) function.</span></span>
-   <span data-ttu-id="7b7a4-135">Quando o aplicativo for concluído usando a fila de solicitações, feche o identificador da fila de solicitações usando a função [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) .</span><span class="sxs-lookup"><span data-stu-id="7b7a4-135">When the application is finished using the request queue, close the request queue handle by using the [**CloseHandle**](/windows/desktop/api/handleapi/nf-handleapi-closehandle) function.</span></span>
-   <span data-ttu-id="7b7a4-136">Quando o aplicativo for concluído usando a API do servidor HTTP, chame a função [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) .</span><span class="sxs-lookup"><span data-stu-id="7b7a4-136">When the application is finished using the HTTP Server API, call the [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) function.</span></span>

 

 