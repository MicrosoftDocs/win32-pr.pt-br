---
title: Cache de fragmento
description: A API do servidor HTTP fornece a funcionalidade para que os usuários armazenem fragmentos de dados em um cache para uso na forma de respostas HTTP rapidamente.
ms.assetid: 0f9a768e-723c-4c7b-a746-6b817441409c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a3979fb03c4f8898644329fd27eafb7007adbcc9
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103916060"
---
# <a name="fragment-cache"></a><span data-ttu-id="5a702-103">Cache de fragmento</span><span class="sxs-lookup"><span data-stu-id="5a702-103">Fragment Cache</span></span>

<span data-ttu-id="5a702-104">A API do servidor HTTP fornece a funcionalidade para que os usuários armazenem fragmentos de dados em um cache para uso na forma de respostas HTTP rapidamente.</span><span class="sxs-lookup"><span data-stu-id="5a702-104">The HTTP Server API provides functionality for users to store data fragments in a cache for use in rapidly forming HTTP responses.</span></span>

<span data-ttu-id="5a702-105">Os fragmentos podem ser adicionados ao cache chamando a função [**HttpAddFragmentToCache**](/windows/desktop/api/Http/nf-http-httpaddfragmenttocache) .</span><span class="sxs-lookup"><span data-stu-id="5a702-105">Fragments can be added to the cache by calling the [**HttpAddFragmentToCache**](/windows/desktop/api/Http/nf-http-httpaddfragmenttocache) function.</span></span> <span data-ttu-id="5a702-106">Um fragmento é identificado por uma URL contida no parâmetro *pUrlPrefix* .</span><span class="sxs-lookup"><span data-stu-id="5a702-106">A Fragment is identified by a URL contained in the *pUrlPrefix* parameter.</span></span> <span data-ttu-id="5a702-107">Uma chamada para essa função com a URL de um fragmento existente substitui o fragmento existente.</span><span class="sxs-lookup"><span data-stu-id="5a702-107">A call to this function with the URL of an existing fragment overwrites the existing fragment.</span></span>

<span data-ttu-id="5a702-108">Um fragmento pode ser excluído ou substituído pelo proprietário da fila de solicitações que inicialmente adicionou o fragmento.</span><span class="sxs-lookup"><span data-stu-id="5a702-108">A fragment can be deleted or overwritten by the owner of the request queue that initially added the fragment.</span></span> <span data-ttu-id="5a702-109">A função [**HttpFlushResponseCache**](/windows/desktop/api/Http/nf-http-httpflushresponsecache) chamada com um URLPrefix exclui todos os fragmentos dentro desse prefixo, bem como os descendentes hierárquicos desse URLPrefix.</span><span class="sxs-lookup"><span data-stu-id="5a702-109">The [**HttpFlushResponseCache**](/windows/desktop/api/Http/nf-http-httpflushresponsecache) function called with a UrlPrefix deletes all fragments within that prefix as well as the hierarchical descendants of that UrlPrefix.</span></span> <span data-ttu-id="5a702-110">A função [**HttpReadFragmentFromCache**](/windows/desktop/api/Http/nf-http-httpreadfragmentfromcache) lê em todo o fragmento ou em um intervalo de bytes especificado dentro do fragmento.</span><span class="sxs-lookup"><span data-stu-id="5a702-110">The [**HttpReadFragmentFromCache**](/windows/desktop/api/Http/nf-http-httpreadfragmentfromcache) function reads in the entire fragment or a specified byte range within the fragment.</span></span>

> [!Note]  
> <span data-ttu-id="5a702-111">A adição de um fragmento ao cache não garante que ele esteja disponível para chamadas futuras para enviar uma resposta.</span><span class="sxs-lookup"><span data-stu-id="5a702-111">Adding a fragment to the cache does not guarantee that it is available for future calls to send a response.</span></span> <span data-ttu-id="5a702-112">As entradas de cache de fragmento podem ficar indisponíveis a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="5a702-112">Fragment cache entries can become unavailable at any time.</span></span> <span data-ttu-id="5a702-113">Uma chamada que usa um fragmento que não está disponível falha.</span><span class="sxs-lookup"><span data-stu-id="5a702-113">A call that uses a fragment that is not available fails.</span></span> <span data-ttu-id="5a702-114">Os aplicativos que usam o cache de fragmento devem estar preparados para lidar com essa falha.</span><span class="sxs-lookup"><span data-stu-id="5a702-114">Applications that use the fragment cache must be prepared to handle this failure.</span></span>

 

## <a name="sending-a-response-with-a-fragment"></a><span data-ttu-id="5a702-115">Enviando uma resposta com um fragmento</span><span class="sxs-lookup"><span data-stu-id="5a702-115">Sending a Response With a Fragment</span></span>

<span data-ttu-id="5a702-116">Os fragmentos podem ser usados para formar todas ou partes de um corpo de entidade de respostas HTTP.</span><span class="sxs-lookup"><span data-stu-id="5a702-116">Fragments can be used to form all or portions of an HTTP responses entity body.</span></span> <span data-ttu-id="5a702-117">Você pode enviar uma resposta e corpo de entidade em uma chamada para a função [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) especificando uma matriz de estruturas de [**\_ \_ partes de dados http**](/windows/desktop/api/Http/ns-http-http_data_chunk) na estrutura de [**\_ resposta http**](http-response.md) .</span><span class="sxs-lookup"><span data-stu-id="5a702-117">You can send a response and entity body in one call to the [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) function by specifying an array of [**HTTP\_DATA\_CHUNK**](/windows/desktop/api/Http/ns-http-http_data_chunk) structures in the [**HTTP\_RESPONSE**](http-response.md) structure.</span></span>

<span data-ttu-id="5a702-118">Uma [**\_ \_ parte de dados http**](/windows/desktop/api/Http/ns-http-http_data_chunk) pode especificar um bloco de memória, um identificador para um arquivo já aberto ou uma entrada de cache de fragmento.</span><span class="sxs-lookup"><span data-stu-id="5a702-118">An [**HTTP\_DATA\_CHUNK**](/windows/desktop/api/Http/ns-http-http_data_chunk) can specify a block of memory, a handle to an already opened file or a fragment cache entry.</span></span> <span data-ttu-id="5a702-119">Elas correspondem aos tipos **de \_ \_ partes de dados http** : **HttpDataChunkFromMemory**, **HttpDataChunkFromFileHandle** e **HttpDataChunkFromFragmentCache**, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="5a702-119">These correspond to the **HTTP\_DATA\_CHUNK** types: **HttpDataChunkFromMemory**, **HttpDataChunkFromFileHandle**, and **HttpDataChunkFromFragmentCache**, respectively.</span></span> <span data-ttu-id="5a702-120">As respostas completas no cache HTTP também podem ser usadas como fragmentos na estrutura [**de \_ resposta http**](http-response.md) , embora essa prática não seja recomendada.</span><span class="sxs-lookup"><span data-stu-id="5a702-120">Full responses in the HTTP cache can also be used as fragments in the [**HTTP\_RESPONSE**](http-response.md) structure, although this practice is not recommended.</span></span>

<span data-ttu-id="5a702-121">A estrutura de [**\_ resposta http**](http-response.md) contém um ponteiro para uma matriz de estruturas de [**\_ \_ partes de dados http**](/windows/desktop/api/Http/ns-http-http_data_chunk) que compõem o corpo da entidade da resposta.</span><span class="sxs-lookup"><span data-stu-id="5a702-121">The [**HTTP\_RESPONSE**](http-response.md) structure contains a pointer to an array of [**HTTP\_DATA\_CHUNK**](/windows/desktop/api/Http/ns-http-http_data_chunk) structures that comprise the entity body of the response.</span></span> <span data-ttu-id="5a702-122">A estrutura de **\_ resposta http** também contém uma contagem correspondente que especifica a dimensão da matriz de estruturas de **\_ \_ partes de dados http** .</span><span class="sxs-lookup"><span data-stu-id="5a702-122">The **HTTP\_RESPONSE** structure also contains a matching count which specifies the dimension of the array of **HTTP\_DATA\_CHUNK** structures.</span></span> <span data-ttu-id="5a702-123">O valor de HttpDataChunkFromFragmentCache na estrutura de **\_ \_ partes de dados http** especifica o tipo de cache de fragmento da parte de dados.</span><span class="sxs-lookup"><span data-stu-id="5a702-123">The HttpDataChunkFromFragmentCache value in the **HTTP\_DATA\_CHUNK** structure specifies the fragment cache type of the data chunk.</span></span> <span data-ttu-id="5a702-124">A estrutura da **\_ \_ parte de dados http** também especifica o nome do fragmento.</span><span class="sxs-lookup"><span data-stu-id="5a702-124">The **HTTP\_DATA\_CHUNK** structure also specifies the fragment name.</span></span>

<span data-ttu-id="5a702-125">Uma resposta que contém um fragmento armazenado em cache falha com um \_ caminho \_ de erro não \_ encontrado se qualquer uma das entradas de cache de fragmento não estiver disponível.</span><span class="sxs-lookup"><span data-stu-id="5a702-125">A response that contains a cached fragment fails with an ERROR\_PATH\_NOT\_FOUND if any of the fragment cache entries are not available.</span></span> <span data-ttu-id="5a702-126">Como não há garantia de que as entradas do cache do fragmento estejam disponíveis, os aplicativos devem estar preparados para lidar com esse caso.</span><span class="sxs-lookup"><span data-stu-id="5a702-126">Since the fragment cache entries are not guaranteed to be available, applications must be prepared to handle this case.</span></span> <span data-ttu-id="5a702-127">Uma maneira de lidar com esse caso é tentar adicionar novamente a entrada do cache de fragmento e reenviar a resposta.</span><span class="sxs-lookup"><span data-stu-id="5a702-127">One way to handle this case is to attempt to re-add the fragment cache entry and resend the response.</span></span> <span data-ttu-id="5a702-128">Se ocorrerem falhas repetidas, o aplicativo poderá usar partes de dados armazenadas em buffers de memória em vez de entradas de cache de fragmento.</span><span class="sxs-lookup"><span data-stu-id="5a702-128">If repeated failures occur, the application can use data chunks stored in memory buffers instead of fragment cache entries.</span></span>

<span data-ttu-id="5a702-129">As entradas de cache de fragmento também podem ser especificadas na função [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) .</span><span class="sxs-lookup"><span data-stu-id="5a702-129">Fragment cache entries can also be specified in the [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) function.</span></span> <span data-ttu-id="5a702-130">O fragmento é adicionado ao corpo da entidade na estrutura [**da \_ \_ parte de dados http**](/windows/desktop/api/Http/ns-http-http_data_chunk) , conforme descrito acima.</span><span class="sxs-lookup"><span data-stu-id="5a702-130">The fragment is added to the entity body in the [**HTTP\_DATA\_CHUNK**](/windows/desktop/api/Http/ns-http-http_data_chunk) structure as described above.</span></span> <span data-ttu-id="5a702-131">Novamente, o envio poderá falhar se qualquer uma das entradas de cache de fragmento especificadas não estiver disponível.</span><span class="sxs-lookup"><span data-stu-id="5a702-131">Again, the send can fail if any of the specified fragment cache entries are not available.</span></span>

 

 




