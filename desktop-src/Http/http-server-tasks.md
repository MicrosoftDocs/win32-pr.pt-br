---
title: Tarefas do servidor HTTP
description: Normalmente, as tarefas do servidor HTTP são executadas em uma ordem específica; ou seja, uma tarefa deve ser concluída e a saída obtida antes do início da próxima tarefa.
ms.assetid: 08f8e7e9-23b9-403f-b00c-8912919d65b1
keywords:
- Tarefas do servidor HTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22455dbda21aca32b26f586eed6e51cef7509af2
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103637263"
---
# <a name="http-server-tasks"></a><span data-ttu-id="8dfa8-104">Tarefas do servidor HTTP</span><span class="sxs-lookup"><span data-stu-id="8dfa8-104">HTTP Server Tasks</span></span>

<span data-ttu-id="8dfa8-105">Normalmente, as tarefas do servidor HTTP são executadas em uma ordem específica; ou seja, uma tarefa deve ser concluída e a saída obtida antes do início da próxima tarefa.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-105">Typically, HTTP server tasks are performed in a specific order; that is, one task must be completed and the output obtained before the next task begins.</span></span>

<span data-ttu-id="8dfa8-106">Uma página de tarefas é criada para apresentar o código de exemplo sobre tarefas específicas que um aplicativo de servidor HTTP executa.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-106">A task page is created to present sample code about specific tasks that an HTTP Server application performs.</span></span> <span data-ttu-id="8dfa8-107">Uma página de tarefas é vinculada ao arquivo de extensão C do exemplo de servidor HTTP.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-107">A task page links to the C extension file of the HTTP server sample.</span></span> <span data-ttu-id="8dfa8-108">Quando você instala o PSDK na unidade C: \\ de um computador local, o aplicativo de exemplo do servidor completo é instalado em C: \\ arquivos de programas \\ Microsoft SDK \\ Samples \\ netds \\ http \\ Server.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-108">When you install the PSDK on drive C:\\ of a local computer, the complete server sample application is installed at C:\\Program Files\\Microsoft SDK\\Samples\\netds\\http\\server.</span></span>

<span data-ttu-id="8dfa8-109">A lista a seguir identifica as tarefas do servidor HTTP:</span><span class="sxs-lookup"><span data-stu-id="8dfa8-109">The following list identifies the HTTP Server tasks:</span></span>

-   [<span data-ttu-id="8dfa8-110">Inicializar o serviço HTTP</span><span class="sxs-lookup"><span data-stu-id="8dfa8-110">Initialize the HTTP Service</span></span>](#initialize-the-http-service)
-   [<span data-ttu-id="8dfa8-111">Registrar as URLs para escuta em</span><span class="sxs-lookup"><span data-stu-id="8dfa8-111">Register the URLs to Listen On</span></span>](#register-the-urls-to-listen-on)
-   [<span data-ttu-id="8dfa8-112">Chamar a rotina para receber uma solicitação</span><span class="sxs-lookup"><span data-stu-id="8dfa8-112">Call the Routine to Receive a Request</span></span>](#call-the-routine-to-receive-a-request)
-   [<span data-ttu-id="8dfa8-113">Receber a solicitação</span><span class="sxs-lookup"><span data-stu-id="8dfa8-113">Receive the Request</span></span>](#receive-the-request)
-   [<span data-ttu-id="8dfa8-114">Manipular a solicitação HTTP</span><span class="sxs-lookup"><span data-stu-id="8dfa8-114">Handle the HTTP Request</span></span>](#handle-the-http-request)
-   [<span data-ttu-id="8dfa8-115">Enviar a resposta HTTP</span><span class="sxs-lookup"><span data-stu-id="8dfa8-115">Send the HTTP Response</span></span>](#send-the-http-response)
-   [<span data-ttu-id="8dfa8-116">Enviar a resposta HTTP POST</span><span class="sxs-lookup"><span data-stu-id="8dfa8-116">Send the HTTP POST Response</span></span>](#send-the-http-post-response)
-   [<span data-ttu-id="8dfa8-117">Limpar a API do servidor HTTP</span><span class="sxs-lookup"><span data-stu-id="8dfa8-117">Clean Up the HTTP Server API</span></span>](#clean-up-the-http-server-api)

## <a name="initialize-the-http-service"></a><span data-ttu-id="8dfa8-118">Inicializar o serviço HTTP</span><span class="sxs-lookup"><span data-stu-id="8dfa8-118">Initialize the HTTP Service</span></span>

<span data-ttu-id="8dfa8-119">O serviço HTTP é inicializado usando a função [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) e o identificador para a fila de solicitações é criado usando [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle).</span><span class="sxs-lookup"><span data-stu-id="8dfa8-119">The HTTP service is initialized by using the [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) function, and the handle to the request queue is created by using [**HttpCreateHttpHandle**](/windows/desktop/api/Http/nf-http-httpcreatehttphandle).</span></span> <span data-ttu-id="8dfa8-120">O servidor deve ser inicializado antes que qualquer outra função de servidor possa ser chamada.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-120">The server must be initialized before any other server functions can be called.</span></span> <span data-ttu-id="8dfa8-121">A fila de solicitações deve ser criada antes que o serviço possa registrar URLs para escutar solicitações HTTP de entrada.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-121">The request queue must be created before the service can register URLs to listen for incoming HTTP requests.</span></span>

<span data-ttu-id="8dfa8-122">Para obter mais informações e um exemplo de código, consulte [inicializar o serviço http](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="8dfa8-122">For more information and a code example, see [Initialize the HTTP Service](http-server-sample-application.md).</span></span>

## <a name="register-the-urls-to-listen-on"></a><span data-ttu-id="8dfa8-123">Registrar as URLs para escuta em</span><span class="sxs-lookup"><span data-stu-id="8dfa8-123">Register the URLs to Listen On</span></span>

<span data-ttu-id="8dfa8-124">Para a API do servidor HTTP escutar solicitações de entrada, as URLs específicas são registradas com a API chamando a função [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) .</span><span class="sxs-lookup"><span data-stu-id="8dfa8-124">For the HTTP Server API to listen for incoming requests, specific URLs are registered with the API by calling the [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function.</span></span> <span data-ttu-id="8dfa8-125">As solicitações de entrada que correspondem a essas URLs são roteadas para a fila de solicitações especificada nesta chamada.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-125">Incoming requests that match these URLs are routed to the request queue specified in this call.</span></span>

<span data-ttu-id="8dfa8-126">Para obter mais informações e um exemplo de código, consulte [registrar as URLs a serem escutadas](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="8dfa8-126">For more information and a code example, see [Register the URLs to Listen On](http-server-sample-application.md).</span></span>

## <a name="call-the-routine-to-receive-a-request"></a><span data-ttu-id="8dfa8-127">Chamar a rotina para receber uma solicitação</span><span class="sxs-lookup"><span data-stu-id="8dfa8-127">Call the Routine to Receive a Request</span></span>

<span data-ttu-id="8dfa8-128">A função DoReceiveRequest aloca o buffer de solicitação, inicializa a ID da solicitação e inicia o loop para receber solicitações.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-128">The DoReceiveRequest function allocates the request buffer, initializes the request ID, and starts the loop to receive requests.</span></span>

<span data-ttu-id="8dfa8-129">Para obter mais informações e um exemplo de código, consulte [chamar a rotina para receber uma solicitação](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="8dfa8-129">For more information and a code example, see [Call the Routine to Receive a Request](http-server-sample-application.md).</span></span>

## <a name="receive-the-request"></a><span data-ttu-id="8dfa8-130">Receber a solicitação</span><span class="sxs-lookup"><span data-stu-id="8dfa8-130">Receive the Request</span></span>

<span data-ttu-id="8dfa8-131">A API do servidor HTTP fornece uma estrutura de solicitação para armazenar a solicitação de entrada analisada.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-131">The HTTP Server API supplies a request structure to store the parsed incoming request.</span></span> <span data-ttu-id="8dfa8-132">Essa estrutura é alocada pelo aplicativo e inicializada quando uma solicitação de entrada é recebida.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-132">This structure is allocated by the application, and initialized when an incoming request is received.</span></span> <span data-ttu-id="8dfa8-133">O aplicativo chama a função [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) para receber a solicitação.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-133">The application calls the [**HttpReceiveHttpRequest**](/windows/desktop/api/Http/nf-http-httpreceivehttprequest) function to receive the request.</span></span> <span data-ttu-id="8dfa8-134">Se o buffer de solicitação for muito pequeno para receber a solicitação, o aplicativo poderá aumentar o tamanho do buffer e chamar **HttpReceiveHttpRequest** novamente para receber a solicitação inteira.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-134">If the request buffer is too small to receive the request, the application can increase the buffer size and call **HttpReceiveHttpRequest** again to receive the entire request.</span></span>

<span data-ttu-id="8dfa8-135">Para obter mais informações e um exemplo de código, consulte [receber uma solicitação](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="8dfa8-135">For more information and a code example, see [Receive a Request](http-server-sample-application.md).</span></span>

## <a name="handle-the-http-request"></a><span data-ttu-id="8dfa8-136">Manipular a solicitação HTTP</span><span class="sxs-lookup"><span data-stu-id="8dfa8-136">Handle the HTTP Request</span></span>

<span data-ttu-id="8dfa8-137">O aplicativo de exemplo mostra como lidar com os verbos de solicitação HTTP GET e POST.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-137">The sample application shows how to handle the HTTP GET and POST request verbs.</span></span> <span data-ttu-id="8dfa8-138">O aplicativo enviará um erro 503 (**não \_ implementado**) se os verbos estiverem presentes na solicitação que o aplicativo não manipula.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-138">The application sends a 503 (**NOT\_IMPLEMENTED**) error if verbs are present in the request that the application does not handle.</span></span>

<span data-ttu-id="8dfa8-139">Observe que a URL a ser usada no tratamento de solicitações é a URL processada contida no membro **CookedUrl** da estrutura [**http \_ Request \_ v1**](/windows/desktop/api/Http/ns-http-http_request_v1) .</span><span class="sxs-lookup"><span data-stu-id="8dfa8-139">Note that the URL to be used in handling requests is the processed URL contained in the **CookedUrl** member of the [**HTTP\_REQUEST\_V1**](/windows/desktop/api/Http/ns-http-http_request_v1) structure.</span></span> <span data-ttu-id="8dfa8-140">Não a URL não processada no membro **pRawUrl** , que é exclusivamente para fins de acompanhamento e estatística.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-140">Do not the unprocessed URL in the **pRawUrl** member, which is solely for tracking and statistical purposes.</span></span>

<span data-ttu-id="8dfa8-141">Para obter mais informações e um exemplo de código, consulte [manipular a solicitação HTTP](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="8dfa8-141">For more information and a code example, see [Handle the HTTP Request](http-server-sample-application.md).</span></span>

## <a name="send-the-http-response"></a><span data-ttu-id="8dfa8-142">Enviar a resposta HTTP</span><span class="sxs-lookup"><span data-stu-id="8dfa8-142">Send the HTTP Response</span></span>

<span data-ttu-id="8dfa8-143">A estrutura de resposta é alocada e inicializada com o código de status e uma frase de motivo na \_ \_ macro inicializar resposta http.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-143">The response structure is allocated and initialized with the status code and a reason phrase in the INITIALIZE\_HTTP\_RESPONSE macro.</span></span> <span data-ttu-id="8dfa8-144">Um cabeçalho HTTP conhecido é adicionado à estrutura de resposta da macro adicionar \_ \_ cabeçalho conhecido e o corpo da entidade é adicionado à resposta de um bloco de dados da memória.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-144">A known HTTP header is added into the response structure in the ADD\_KNOWN\_HEADER macro, and the entity body is added to the response from a data block from memory.</span></span> <span data-ttu-id="8dfa8-145">A função [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) é chamada para enviar a resposta.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-145">The [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse) function is called to send the response.</span></span> <span data-ttu-id="8dfa8-146">Neste exemplo, o aplicativo envia uma resposta simples de 200 OK para a solicitação GET.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-146">In this example, the application sends a simple 200 OK response to the GET request.</span></span>

<span data-ttu-id="8dfa8-147">Para obter mais informações e um exemplo de código, consulte [Enviar uma resposta http](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="8dfa8-147">For more information and a code example, see [Send an HTTP Response](http-server-sample-application.md).</span></span>

## <a name="send-the-http-post-response"></a><span data-ttu-id="8dfa8-148">Enviar a resposta HTTP POST</span><span class="sxs-lookup"><span data-stu-id="8dfa8-148">Send the HTTP POST Response</span></span>

<span data-ttu-id="8dfa8-149">A solicitação POST requer mais processamento do que a solicitação GET.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-149">The POST request requires more processing than the GET request.</span></span> <span data-ttu-id="8dfa8-150">O corpo da entidade de solicitação é recebido chamando a função [**HttpReceiveRequestEntityBody**](/windows/desktop/api/Http/nf-http-httpreceiverequestentitybody) .</span><span class="sxs-lookup"><span data-stu-id="8dfa8-150">The request entity body is received by calling the [**HttpReceiveRequestEntityBody**](/windows/desktop/api/Http/nf-http-httpreceiverequestentitybody) function.</span></span> <span data-ttu-id="8dfa8-151">O aplicativo envia a resposta e o corpo da entidade de resposta em chamadas separadas para a API do servidor HTTP.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-151">The application sends the response and the response entity body in separate calls to the HTTP Server API.</span></span> <span data-ttu-id="8dfa8-152">Os cabeçalhos de resposta são enviados com o [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse).</span><span class="sxs-lookup"><span data-stu-id="8dfa8-152">The response headers are sent with the [**HttpSendHttpResponse**](/windows/desktop/api/Http/nf-http-httpsendhttpresponse).</span></span> <span data-ttu-id="8dfa8-153">O corpo da entidade é enviado em um bloco de dados de um identificador de arquivo com a função [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) .</span><span class="sxs-lookup"><span data-stu-id="8dfa8-153">The entity body is sent in a data block from a file handle with the [**HttpSendResponseEntityBody**](/windows/desktop/api/Http/nf-http-httpsendresponseentitybody) function.</span></span>

<span data-ttu-id="8dfa8-154">Para obter mais informações e um exemplo de código, consulte [Enviar uma resposta http post](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="8dfa8-154">For more information and a code example, see [Send an HTTP POST Response](http-server-sample-application.md).</span></span>

## <a name="clean-up-the-http-server-api"></a><span data-ttu-id="8dfa8-155">Limpar a API do servidor HTTP</span><span class="sxs-lookup"><span data-stu-id="8dfa8-155">Clean Up the HTTP Server API</span></span>

<span data-ttu-id="8dfa8-156">As operações de limpeza para a API do servidor HTTP incluem:</span><span class="sxs-lookup"><span data-stu-id="8dfa8-156">The cleanup operations for the HTTP Server API include:</span></span>

-   <span data-ttu-id="8dfa8-157">Removendo todas as URLs registradas.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-157">Removing all registered URLs.</span></span>
-   <span data-ttu-id="8dfa8-158">Fechando o identificador para a fila de solicitações.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-158">Closing the handle to the request queue.</span></span>
-   <span data-ttu-id="8dfa8-159">Encerrando os recursos criados pela API do servidor HTTP.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-159">Terminating the resources created by the HTTP Server API.</span></span>

<span data-ttu-id="8dfa8-160">O aplicativo chama a função [**HttpRemoveUrl**](/windows/desktop/api/Http/nf-http-httpremoveurl) para cancelar o registro de URLs registradas pela função [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) inicial.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-160">The application calls the [**HttpRemoveUrl**](/windows/desktop/api/Http/nf-http-httpremoveurl) function to deregister URLs registered by the initial [**HttpAddUrl**](/windows/desktop/api/Http/nf-http-httpaddurl) function.</span></span> <span data-ttu-id="8dfa8-161">O aplicativo também chama [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) para cada chamada para [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) com as configurações de sinalizador correspondentes.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-161">The application also calls [**HttpTerminate**](/windows/desktop/api/Http/nf-http-httpterminate) for each call to [**HttpInitialize**](/windows/desktop/api/Http/nf-http-httpinitialize) with matching flag settings.</span></span> <span data-ttu-id="8dfa8-162">Essa chamada encerra todos os recursos criados pela chamada para **HttpInitialize**.</span><span class="sxs-lookup"><span data-stu-id="8dfa8-162">This call terminates all resources created by the call to **HttpInitialize**.</span></span>

<span data-ttu-id="8dfa8-163">Para obter mais informações e um exemplo de código, consulte [limpar a API do servidor http](http-server-sample-application.md).</span><span class="sxs-lookup"><span data-stu-id="8dfa8-163">For more information and a code example, see [Cleanup the HTTP Server API](http-server-sample-application.md).</span></span>

 

 




