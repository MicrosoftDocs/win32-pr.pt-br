---
description: A biblioteca de registro offline é usada para modificar um hive do registro fora do registro do sistema ativo.
ms.assetid: 61db2804-1b67-473f-8dd7-6be6c6a7184e
title: Sobre a biblioteca de registro offline
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e7e08b401a4a77f55a54c48ad147bf38c8796472
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104456908"
---
# <a name="about-the-offline-registry-library"></a><span data-ttu-id="7fde9-103">Sobre a biblioteca de registro offline</span><span class="sxs-lookup"><span data-stu-id="7fde9-103">About the Offline Registry Library</span></span>

<span data-ttu-id="7fde9-104">A biblioteca de registro offline é usada para modificar um hive do registro fora do registro do sistema ativo.</span><span class="sxs-lookup"><span data-stu-id="7fde9-104">The offline registry library is used to modify a registry hive outside of the active system registry.</span></span>

<span data-ttu-id="7fde9-105">A biblioteca de registro offline destina-se a cenários de atualização de registro, como manutenção de uma imagem do sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="7fde9-105">The offline registry library is intended for registry update scenarios such as servicing an operating system image.</span></span> <span data-ttu-id="7fde9-106">As funções de registro offline fornecem os seguintes recursos que não estão disponíveis com as funções de registro padrão:</span><span class="sxs-lookup"><span data-stu-id="7fde9-106">The offline registry functions provide the following capabilities that are not available with the standard registry functions:</span></span>

-   <span data-ttu-id="7fde9-107">As funções de registro offline podem ser usadas para modificar um hive de registro em qualquer formato de registro com suporte.</span><span class="sxs-lookup"><span data-stu-id="7fde9-107">The offline registry functions can be used to modify a registry hive in any supported registry format.</span></span> <span data-ttu-id="7fde9-108">As funções de registro padrão podem fazer alterações apenas em um hive de registro ativo e as alterações devem ser compatíveis com a versão do Windows em execução no sistema.</span><span class="sxs-lookup"><span data-stu-id="7fde9-108">The standard registry functions can make changes only to an active registry hive and the changes must be compatible with the version of Windows running on the system.</span></span>
-   <span data-ttu-id="7fde9-109">A biblioteca de registro offline requer apenas acesso de leitura para abrir um arquivo do hive do registro e acesso de gravação para salvar o arquivo.</span><span class="sxs-lookup"><span data-stu-id="7fde9-109">The offline registry library requires only read access to open a registry hive file and write access to save the file.</span></span> <span data-ttu-id="7fde9-110">Nenhuma outra verificação de acesso é executada em objetos no hive, tornando possível modificar o hive com privilégios de usuário padrão.</span><span class="sxs-lookup"><span data-stu-id="7fde9-110">No other access checks are performed on objects in the hive, making it possible to modify the hive with standard user privileges.</span></span> <span data-ttu-id="7fde9-111">Com as funções de registro padrão, carregar um Hive no registro ativo é uma operação privilegiada que requer acesso administrativo.</span><span class="sxs-lookup"><span data-stu-id="7fde9-111">With the standard registry functions, loading a hive into the active registry is a privileged operation that requires administrative access.</span></span>

<span data-ttu-id="7fde9-112">As funções de registro offline não devem ser usadas como substitutos para as funções de registro do sistema pelos seguintes motivos:</span><span class="sxs-lookup"><span data-stu-id="7fde9-112">The offline registry functions should not be used as a substitute for the system registry functions for the following reasons:</span></span>

-   <span data-ttu-id="7fde9-113">É impossível compartilhar hives do registro entre processos usando as funções de registro offline.</span><span class="sxs-lookup"><span data-stu-id="7fde9-113">It is impossible to share registry hives between processes using the offline registry functions.</span></span>
-   <span data-ttu-id="7fde9-114">As funções de registro offline usam o bloqueio simples que pode levar à degradação de desempenho grave para aplicativos multissegmentados.</span><span class="sxs-lookup"><span data-stu-id="7fde9-114">The offline registry functions use simple locking that can lead to serious performance degradation for multithreaded applications.</span></span>
-   <span data-ttu-id="7fde9-115">As alterações feitas com as funções de registro offline não são salvas até que a função [**ORSaveHive**](orsavehive.md) seja chamada.</span><span class="sxs-lookup"><span data-stu-id="7fde9-115">Changes made with the offline registry functions are not saved until the [**ORSaveHive**](orsavehive.md) function is called.</span></span>

<span data-ttu-id="7fde9-116">Os aplicativos não devem usar as funções de registro offline para ignorar os requisitos de segurança do registro do sistema.</span><span class="sxs-lookup"><span data-stu-id="7fde9-116">Applications should not use the offline registry functions to bypass the security requirements of the system registry.</span></span> <span data-ttu-id="7fde9-117">Para carregar um Hive, um aplicativo em execução sem os privilégios especiais exigidos pela função [RegLoadKey](/windows/win32/api/winreg/nf-winreg-regloadkeya) pode usar a função [RegLoadAppKey](/windows/win32/api/winreg/nf-winreg-regloadappkeya) .</span><span class="sxs-lookup"><span data-stu-id="7fde9-117">To load a hive, an application running without the special privileges required by the [RegLoadKey](/windows/win32/api/winreg/nf-winreg-regloadkeya) function can use the [RegLoadAppKey](/windows/win32/api/winreg/nf-winreg-regloadappkeya) function.</span></span>

<span data-ttu-id="7fde9-118">**Windows Server 2003 e Windows XP:** Não há suporte para a função [RegLoadAppKey](/windows/win32/api/winreg/nf-winreg-regloadappkeya) .</span><span class="sxs-lookup"><span data-stu-id="7fde9-118">**Windows Server 2003 and Windows XP:** The [RegLoadAppKey](/windows/win32/api/winreg/nf-winreg-regloadappkeya) function is not supported.</span></span>

<span data-ttu-id="7fde9-119">Um *hive do registro offline* é um hive do registro que foi carregado na memória usando as funções do registro offline.</span><span class="sxs-lookup"><span data-stu-id="7fde9-119">An *offline registry hive* is a registry hive that has been loaded into memory using the offline registry functions.</span></span> <span data-ttu-id="7fde9-120">Para criar um Hive vazio do registro offline, use a função [**ORCreateHive**](orcreatehive.md) .</span><span class="sxs-lookup"><span data-stu-id="7fde9-120">To create an empty offline registry hive, use the [**ORCreateHive**](orcreatehive.md) function.</span></span> <span data-ttu-id="7fde9-121">Para modificar um hive de registro existente, use a função [RegSaveKey](/windows/win32/api/winreg/nf-winreg-regsavekeya) ou [RegSaveKeyEx](/windows/win32/api/winreg/nf-winreg-regsavekeyexa) para salvar um hive do registro do sistema ativo em um arquivo e, em seguida, use a função [**OROpenHive**](oropenhive.md) para abrir o arquivo.</span><span class="sxs-lookup"><span data-stu-id="7fde9-121">To modify an existing registry hive, use the [RegSaveKey](/windows/win32/api/winreg/nf-winreg-regsavekeya) or [RegSaveKeyEx](/windows/win32/api/winreg/nf-winreg-regsavekeyexa) function to save a hive from the active system registry to a file, and then use the [**OROpenHive**](oropenhive.md) function to open the file.</span></span>

<span data-ttu-id="7fde9-122">As funções [**ORCreateHive**](orcreatehive.md) e [**OROpenHive**](oropenhive.md) retornam um identificador para a chave raiz do hive do registro offline.</span><span class="sxs-lookup"><span data-stu-id="7fde9-122">The [**ORCreateHive**](orcreatehive.md) and [**OROpenHive**](oropenhive.md) functions return a handle to the root key of the offline registry hive.</span></span> <span data-ttu-id="7fde9-123">Esse identificador pode ser usado como um identificador para qualquer outra chave no hive do registro offline com as seguintes exceções: as funções [**ORCreateKey**](orcreatekey.md) e [**OROpenKey**](oropenkey.md) não podem ser usadas para retornar um identificador para a chave raiz; a função [**ORCloseKey**](orclosekey.md) não pode ser usada para fechar a chave raiz; e a função [**ORDeleteKey**](ordeletekey.md) não pode ser usada para excluir a chave raiz.</span><span class="sxs-lookup"><span data-stu-id="7fde9-123">This handle can be used like a handle to any other key in the offline registry hive with the following exceptions: the [**ORCreateKey**](orcreatekey.md) and [**OROpenKey**](oropenkey.md) functions cannot be used to return a handle to the root key; the [**ORCloseKey**](orclosekey.md) function cannot be used to close the root key; and the [**ORDeleteKey**](ordeletekey.md) function cannot be used to delete the root key.</span></span> <span data-ttu-id="7fde9-124">Em todos esses casos, a função falha com um **\_ \_ parâmetro de erro inválido**.</span><span class="sxs-lookup"><span data-stu-id="7fde9-124">In all of these cases, the function fails with **ERROR\_INVALID\_PARAMETER**.</span></span>

<span data-ttu-id="7fde9-125">Use a função [**ORCreateKey**](orcreatekey.md) para adicionar chaves a um hive do registro offline aberto e à função [**ORSetValue**](orsetvalue.md) para definir os valores das chaves.</span><span class="sxs-lookup"><span data-stu-id="7fde9-125">Use the [**ORCreateKey**](orcreatekey.md) function to add keys to an open offline registry hive and the [**ORSetValue**](orsetvalue.md) function to set the keys' values.</span></span> <span data-ttu-id="7fde9-126">A biblioteca de registro offline dá suporte a outras operações básicas de registro, como enumerar, recuperar e excluir chaves e valores, e definir atributos de chave como segurança e comportamento de virtualização.</span><span class="sxs-lookup"><span data-stu-id="7fde9-126">The offline registry library supports other basic registry operations such as enumerating, retrieving, and deleting keys and values, and setting key attributes such as security and virtualization behavior.</span></span> <span data-ttu-id="7fde9-127">Para obter uma lista de funções, consulte [funções da biblioteca do registro offline](offline-registry-library-functions.md).</span><span class="sxs-lookup"><span data-stu-id="7fde9-127">For a list of functions, see [Offline Registry Library Functions](offline-registry-library-functions.md).</span></span>

<span data-ttu-id="7fde9-128">Para salvar as alterações feitas em um hive do registro offline aberto, use a função [**ORSaveHive**](orsavehive.md) para salvar o hive em um arquivo.</span><span class="sxs-lookup"><span data-stu-id="7fde9-128">To save changes made to an open offline registry hive, use the [**ORSaveHive**](orsavehive.md) function to save the hive to a file.</span></span> <span data-ttu-id="7fde9-129">(As alterações não persistim, a menos que **ORSaveHive** seja chamado.) Depois de salvar o Hive, use a função [**ORCloseHive**](orclosehive.md) para fechar o hive e liberar recursos associados a ele.</span><span class="sxs-lookup"><span data-stu-id="7fde9-129">(The changes do not persist unless **ORSaveHive** is called.) After saving the hive, use the [**ORCloseHive**](orclosehive.md) function to close the hive and free resources associated with it.</span></span>

<span data-ttu-id="7fde9-130">Um hive do registro offline é validado somente quando ele é aberto usando a função [**OROpenHive**](oropenhive.md) .</span><span class="sxs-lookup"><span data-stu-id="7fde9-130">An offline registry hive is validated only when it is opened using the [**OROpenHive**](oropenhive.md) function.</span></span> <span data-ttu-id="7fde9-131">Se o hive estiver corrompido, a operação simplesmente falhará; Não é feita nenhuma tentativa de reparar o hive.</span><span class="sxs-lookup"><span data-stu-id="7fde9-131">If the hive is corrupt, the operation simply fails; no attempt is made to repair the hive.</span></span> <span data-ttu-id="7fde9-132">As verificações de acesso em objetos no hive não são executadas até que o hive seja carregado em um registro ativo com a função [RegLoadKey](/windows/win32/api/winreg/nf-winreg-regloadkeya) .</span><span class="sxs-lookup"><span data-stu-id="7fde9-132">Access checks on objects in the hive are not performed until the hive is loaded into an active registry with the [RegLoadKey](/windows/win32/api/winreg/nf-winreg-regloadkeya) function.</span></span>

<span data-ttu-id="7fde9-133">As funções de registro offline não dão suporte às [chaves predefinidas](../sysinfo/predefined-keys.md).</span><span class="sxs-lookup"><span data-stu-id="7fde9-133">The offline registry functions do not support the [predefined keys](../sysinfo/predefined-keys.md).</span></span>

<span data-ttu-id="7fde9-134">Todas as cadeias de caracteres de nome de chave e valor passadas para funções de registro offline devem ser Unicode.</span><span class="sxs-lookup"><span data-stu-id="7fde9-134">All key and value name strings passed to offline registry functions must be Unicode.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7fde9-135">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="7fde9-135">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7fde9-136">Funções da biblioteca do registro offline \_</span><span class="sxs-lookup"><span data-stu-id="7fde9-136">Offline Registry Library\_Functions</span></span>](offline-registry-library-functions.md)
</dt> </dl>

 

 
