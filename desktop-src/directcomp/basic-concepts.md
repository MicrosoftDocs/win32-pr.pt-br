---
title: Conceitos básicos (DirectComposition)
description: Este tópico fornece uma visão geral dos conceitos básicos do Microsoft DirectComposition.
ms.assetid: F442BDCA-C913-4438-BFFA-D3F28B68EE85
keywords:
- Conceitos de DirectComposition
- Conceitos básicos do DirectComposition
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0550dc12cb0dcc5262701658d8e3883ee1ce8d82
ms.sourcegitcommit: 73417d55867c804274a55abe5ca71bcba7006119
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/20/2020
ms.locfileid: "104561857"
---
# <a name="basic-concepts"></a><span data-ttu-id="f8af0-105">Conceitos básicos</span><span class="sxs-lookup"><span data-stu-id="f8af0-105">Basic concepts</span></span>

> [!NOTE]
> <span data-ttu-id="f8af0-106">Para aplicativos no Windows 10, é recomendável usar APIs do Windows. UI. composição em vez de DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="f8af0-106">For apps on Windows 10, we recommend using Windows.UI.Composition APIs instead of DirectComposition.</span></span> <span data-ttu-id="f8af0-107">Para obter mais informações, consulte [modernizar seu aplicativo de área de trabalho usando a camada Visual](/windows/uwp/composition/visual-layer-in-desktop-apps).</span><span class="sxs-lookup"><span data-stu-id="f8af0-107">For more info, see [Modernize your desktop app using the Visual layer](/windows/uwp/composition/visual-layer-in-desktop-apps).</span></span>

<span data-ttu-id="f8af0-108">Este tópico fornece uma visão geral dos conceitos básicos do Microsoft DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="f8af0-108">This topic provides an overview of the basic concepts of Microsoft DirectComposition.</span></span> <span data-ttu-id="f8af0-109">Ele contém as seções a seguir:</span><span class="sxs-lookup"><span data-stu-id="f8af0-109">It contains the following sections:</span></span>

-   [<span data-ttu-id="f8af0-110">Composição</span><span class="sxs-lookup"><span data-stu-id="f8af0-110">Composition</span></span>](#composition-target-window)
-   [<span data-ttu-id="f8af0-111">Visuais</span><span class="sxs-lookup"><span data-stu-id="f8af0-111">Visuals</span></span>](#visuals)
    -   [<span data-ttu-id="f8af0-112">Árvore visual</span><span class="sxs-lookup"><span data-stu-id="f8af0-112">Visual tree</span></span>](#visual-tree)
    -   [<span data-ttu-id="f8af0-113">Propriedades de um objeto visual</span><span class="sxs-lookup"><span data-stu-id="f8af0-113">Properties of a visual object</span></span>](#properties-of-a-visual-object)
-   [<span data-ttu-id="f8af0-114">Objeto de dispositivo</span><span class="sxs-lookup"><span data-stu-id="f8af0-114">Device object</span></span>](#device-object)
-   [<span data-ttu-id="f8af0-115">Janela de destino da composição</span><span class="sxs-lookup"><span data-stu-id="f8af0-115">Composition target window</span></span>](#composition-target-window)
-   [<span data-ttu-id="f8af0-116">Composição transacional</span><span class="sxs-lookup"><span data-stu-id="f8af0-116">Transactional composition</span></span>](#transactional-composition)
    -   [<span data-ttu-id="f8af0-117">Separação em lotes</span><span class="sxs-lookup"><span data-stu-id="f8af0-117">Batching</span></span>](#batching)
    -   [<span data-ttu-id="f8af0-118">Sincronização</span><span class="sxs-lookup"><span data-stu-id="f8af0-118">Synchronization</span></span>](#synchronization)
    -   [<span data-ttu-id="f8af0-119">Árvores visuais de dispositivos cruzados</span><span class="sxs-lookup"><span data-stu-id="f8af0-119">Cross-device visual trees</span></span>](#cross-device-visual-trees)
-   [<span data-ttu-id="f8af0-120">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="f8af0-120">Related topics</span></span>](#related-topics)

## <a name="composition"></a><span data-ttu-id="f8af0-121">Composição</span><span class="sxs-lookup"><span data-stu-id="f8af0-121">Composition</span></span>

<span data-ttu-id="f8af0-122">DirectComposition define uma *composição* como uma coleção de bitmaps que são combinados e manipulados aplicando-se várias transformações, efeitos e animações para produzir um resultado Visual em uma interface do usuário do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f8af0-122">DirectComposition defines a *composition* as a collection of bitmaps that are combined and manipulated by applying various transforms, effects, and animations to produce a visual result in an application UI.</span></span> <span data-ttu-id="f8af0-123">DirectComposition funciona apenas com conteúdo de bitmap; Ele não oferece suporte a vetores ou texto.</span><span class="sxs-lookup"><span data-stu-id="f8af0-123">DirectComposition works with bitmap content only; it does not support vectors or text.</span></span> <span data-ttu-id="f8af0-124">DirectComposition não fornece conteúdo de bitmap.</span><span class="sxs-lookup"><span data-stu-id="f8af0-124">DirectComposition does not provide bitmap content.</span></span> <span data-ttu-id="f8af0-125">Em vez disso, ele fornece interfaces nas quais os usuários podem desenhar com D2D, DXGI ou carregar seu próprio conteúdo de textura.</span><span class="sxs-lookup"><span data-stu-id="f8af0-125">Instead it provides interfaces in which users can draw with D2D, DXGI, or upload their own texture content.</span></span>

<span data-ttu-id="f8af0-126">Um aplicativo DirectComposition cria dois conjuntos de objetos para compor uma cena: bitmaps que são compostos juntos e visuais que definem as relações espaciais entre os bitmaps.</span><span class="sxs-lookup"><span data-stu-id="f8af0-126">A DirectComposition application creates two sets of objects to compose a scene: bitmaps that are composed together, and visuals that define the spatial relationships among the bitmaps.</span></span> <span data-ttu-id="f8af0-127">Para obter mais informações sobre os objetos bitmap com suporte do DirectComposition, consulte [objetos de bitmap](bitmap-surfaces.md).</span><span class="sxs-lookup"><span data-stu-id="f8af0-127">For more information about the bitmap objects supported by DirectComposition, see [Bitmap objects](bitmap-surfaces.md).</span></span>

## <a name="visuals"></a><span data-ttu-id="f8af0-128">Visuais</span><span class="sxs-lookup"><span data-stu-id="f8af0-128">Visuals</span></span>

<span data-ttu-id="f8af0-129">Os *visuais* (ou *objetos visuais*) são os elementos fundamentais de DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="f8af0-129">*Visuals* (or *visual objects*) are the fundamental elements of DirectComposition.</span></span> <span data-ttu-id="f8af0-130">Eles são os blocos de construção básicos que você usa para criar composições e animações na interface do usuário do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f8af0-130">They are the basic building blocks that you use to create compositions and animations in your application UI.</span></span>

<span data-ttu-id="f8af0-131">Em termos de programação, um Visual é um objeto que tem um conjunto de propriedades e expõe uma interface que você usa para definir o valor das propriedades.</span><span class="sxs-lookup"><span data-stu-id="f8af0-131">In programming terms, a visual is an object that has a set of properties, and exposes an interface that you use to set the value of the properties.</span></span> <span data-ttu-id="f8af0-132">A propriedade de conteúdo de um visual associa um bitmap específico ao Visual, enquanto outras propriedades controlam como o DirectComposition posiciona e manipula o Visual conforme ele é renderizado na tela.</span><span class="sxs-lookup"><span data-stu-id="f8af0-132">A visual's Content property associates a particular bitmap with the visual, while other properties control how DirectComposition positions and manipulates the visual as it is rendered to the screen.</span></span>

<span data-ttu-id="f8af0-133">Para obter mais informações, consulte [Propriedades de um Visual](#properties-of-a-visual-object).</span><span class="sxs-lookup"><span data-stu-id="f8af0-133">For more information, see [Properties of a Visual](#properties-of-a-visual-object).</span></span>

### <a name="visual-tree"></a><span data-ttu-id="f8af0-134">Árvore visual</span><span class="sxs-lookup"><span data-stu-id="f8af0-134">Visual tree</span></span>

<span data-ttu-id="f8af0-135">DirectComposition cria uma composição de uma coleção hierárquica de objetos visuais chamada de *árvore visual*.</span><span class="sxs-lookup"><span data-stu-id="f8af0-135">DirectComposition creates a composition from a hierarchical collection of visual objects called a *visual tree*.</span></span> <span data-ttu-id="f8af0-136">O Visual na raiz de uma árvore é chamado de *Visual raiz* e pode ter um ou mais *elementos visuais filho* associados a ele.</span><span class="sxs-lookup"><span data-stu-id="f8af0-136">The visual at the root of a tree is called the *root visual* and it can have one or more *child visuals* associated with it.</span></span> <span data-ttu-id="f8af0-137">Um Visual filho pode ter um ou mais elementos visuais filho próprios.</span><span class="sxs-lookup"><span data-stu-id="f8af0-137">A child visual can have one or more child visuals of its own.</span></span> <span data-ttu-id="f8af0-138">Qualquer visual que tenha elementos visuais filho associados é chamado de *Visual pai*, e todos os visuais filho que compartilham o mesmo pai são chamados de *visuais irmãos*.</span><span class="sxs-lookup"><span data-stu-id="f8af0-138">Any visual that has associated child visuals is called a *parent visual*, and all child visuals that share the same parent are called *sibling visuals*.</span></span> <span data-ttu-id="f8af0-139">Um Visual específico, juntamente com todos os seus elementos visuais filho e descendentes, é chamado de *subárvore Visual*.</span><span class="sxs-lookup"><span data-stu-id="f8af0-139">A particular visual along with all its child and descendent visuals is called a *visual subtree*.</span></span>

<span data-ttu-id="f8af0-140">O local de um Visual na árvore ajuda a determinar sua posição de tela e ordem z em relação aos outros visuais na composição.</span><span class="sxs-lookup"><span data-stu-id="f8af0-140">A visual's location in the tree helps determine its screen position and z-order relative to the other visuals in the composition.</span></span> <span data-ttu-id="f8af0-141">O Visual raiz é posicionado em relação ao canto superior esquerdo da área do cliente da janela de destino em que a composição é renderizada.</span><span class="sxs-lookup"><span data-stu-id="f8af0-141">The root visual is positioned relative to the upper-left corner of the client area of the target window where the composition is rendered.</span></span> <span data-ttu-id="f8af0-142">Todos os visuais filho são posicionados em relação ao canto superior esquerdo de seus elementos visuais pai (ou o Visual especificado pela propriedade TransformParent) e sempre aparecem na frente de seu pai na ordem z.</span><span class="sxs-lookup"><span data-stu-id="f8af0-142">All child visuals are positioned relative to the upper-left corner of their parent visual (or the visual specified by the TransformParent property), and always appear in front of their parent in the z-order.</span></span>

<span data-ttu-id="f8af0-143">A ilustração a seguir mostra uma composição de visuais e a estrutura da árvore visual usada para produzir a composição.</span><span class="sxs-lookup"><span data-stu-id="f8af0-143">The following illustration shows a composition of visuals and the structure of the visual tree used to produce the composition.</span></span> <span data-ttu-id="f8af0-144">O Visual 1 é o Visual raiz e também é o pai dos elementos visuais filho 2 e 3, que são elementos visuais irmãos.</span><span class="sxs-lookup"><span data-stu-id="f8af0-144">Visual 1 is the root visual and is also the parent of child Visuals 2 and 3, which are sibling visuals.</span></span> <span data-ttu-id="f8af0-145">O Visual 3 tem dois elementos visuais filho próprios, visuais 4 e 5.</span><span class="sxs-lookup"><span data-stu-id="f8af0-145">Visual 3 has two child visuals of its own, Visuals 4 and 5.</span></span> <span data-ttu-id="f8af0-146">Juntos, os visuais 3 a 5 compõem uma subárvore Visual.</span><span class="sxs-lookup"><span data-stu-id="f8af0-146">Together, Visuals 3 through 5 make up a visual subtree.</span></span>

![uma composição de visuais e a árvore visual correspondente](images/visuals-and-corresponding-tree.png)

<span data-ttu-id="f8af0-148">Um visual pai mantém uma lista ordenada de seus visuais filho.</span><span class="sxs-lookup"><span data-stu-id="f8af0-148">A parent visual maintains an ordered list of its child visuals.</span></span> <span data-ttu-id="f8af0-149">Quando visuais irmãos são posicionados de forma que se sobreponham um ao outro, DirectComposition define a ordem z dos irmãos com base na ordem em que eles aparecem na lista de filhos do Visual pai.</span><span class="sxs-lookup"><span data-stu-id="f8af0-149">When sibling visuals are positioned such that they overlap one another, DirectComposition sets the z-order of the siblings based on the order in which they appear in the parent visual's children list.</span></span> <span data-ttu-id="f8af0-150">Um irmão que aparece posteriormente na lista é colocado na frente de todos os irmãos que aparecem anteriormente na lista.</span><span class="sxs-lookup"><span data-stu-id="f8af0-150">A sibling that appears later in the list is placed in front of all siblings that appear earlier in the list.</span></span> <span data-ttu-id="f8af0-151">A ilustração a seguir mostra a ordem z de sobreposição de elementos visuais filho.</span><span class="sxs-lookup"><span data-stu-id="f8af0-151">The following illustration shows the z-order of overlapping child visuals.</span></span>

![a ordem z de sobreposição de visuais filho](images/overlapping-child-visuals.png)

### <a name="properties-of-a-visual-object"></a><span data-ttu-id="f8af0-153">Propriedades de um objeto visual</span><span class="sxs-lookup"><span data-stu-id="f8af0-153">Properties of a visual object</span></span>

<span data-ttu-id="f8af0-154">Um objeto visual expõe um conjunto de propriedades que permitem que você defina o conteúdo do bitmap para o Visual e controle como o DirectComposition posiciona e manipula o conteúdo visual.</span><span class="sxs-lookup"><span data-stu-id="f8af0-154">A visual object exposes a set of properties that enable you to set the bitmap content for the visual, and to control how DirectComposition positions and manipulates the visual content.</span></span> <span data-ttu-id="f8af0-155">As seções a seguir descrevem cada propriedade em detalhes.</span><span class="sxs-lookup"><span data-stu-id="f8af0-155">The following sections describe each property in detail.</span></span>

-   [<span data-ttu-id="f8af0-156">Propriedade de conteúdo</span><span class="sxs-lookup"><span data-stu-id="f8af0-156">Content property</span></span>](#content-property)
-   [<span data-ttu-id="f8af0-157">Propriedade de clipe</span><span class="sxs-lookup"><span data-stu-id="f8af0-157">Clip property</span></span>](#clip-property)
-   [<span data-ttu-id="f8af0-158">Propriedade bordermode</span><span class="sxs-lookup"><span data-stu-id="f8af0-158">BorderMode property</span></span>](#bordermode-property)
-   [<span data-ttu-id="f8af0-159">Propriedade BitmapInterpolationMode</span><span class="sxs-lookup"><span data-stu-id="f8af0-159">BitmapInterpolationMode property</span></span>](#bitmapinterpolationmode-property)
-   [<span data-ttu-id="f8af0-160">Propriedade compositemode</span><span class="sxs-lookup"><span data-stu-id="f8af0-160">CompositeMode property</span></span>](#compositemode-property)
-   [<span data-ttu-id="f8af0-161">Propriedades OffsetX e OffsetY</span><span class="sxs-lookup"><span data-stu-id="f8af0-161">OffsetX and OffsetY properties</span></span>](#offsetx-and-offsety-properties)
-   [<span data-ttu-id="f8af0-162">Propriedade Effect</span><span class="sxs-lookup"><span data-stu-id="f8af0-162">Effect property</span></span>](#effect-property)
-   [<span data-ttu-id="f8af0-163">Propriedade Transform</span><span class="sxs-lookup"><span data-stu-id="f8af0-163">Transform property</span></span>](#transform-property)
-   [<span data-ttu-id="f8af0-164">Propriedade TransformParent</span><span class="sxs-lookup"><span data-stu-id="f8af0-164">TransformParent property</span></span>](#transformparent-property)

### <a name="content-property"></a><span data-ttu-id="f8af0-165">Propriedade de conteúdo</span><span class="sxs-lookup"><span data-stu-id="f8af0-165">Content property</span></span>

<span data-ttu-id="f8af0-166">A propriedade de conteúdo de um Visual especifica o conteúdo de bitmap associado ao Visual.</span><span class="sxs-lookup"><span data-stu-id="f8af0-166">A visual's Content property specifies the bitmap content that is associated with the visual.</span></span> <span data-ttu-id="f8af0-167">Esse é o bitmap que o DirectComposition usa quando você inclui o Visual em uma composição.</span><span class="sxs-lookup"><span data-stu-id="f8af0-167">This is the bitmap that DirectComposition uses when you include the visual in a composition.</span></span>

<span data-ttu-id="f8af0-168">Você define a propriedade Content de um Visual chamando o método [**IDCompositionVisual:: setContent**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setcontent) .</span><span class="sxs-lookup"><span data-stu-id="f8af0-168">You set the Content property of a visual by calling the [**IDCompositionVisual::SetContent**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setcontent) method.</span></span>

<span data-ttu-id="f8af0-169">Para obter mais informações sobre os tipos de conteúdo de bitmap com suporte do DirectComposition, consulte [objetos de bitmap](bitmap-surfaces.md).</span><span class="sxs-lookup"><span data-stu-id="f8af0-169">For more information about the types of bitmap content supported by DirectComposition, see [Bitmap objects](bitmap-surfaces.md).</span></span>

### <a name="clip-property"></a><span data-ttu-id="f8af0-170">Propriedade de clipe</span><span class="sxs-lookup"><span data-stu-id="f8af0-170">Clip property</span></span>

<span data-ttu-id="f8af0-171">A propriedade Clip de um Visual especifica uma área retangular chamada região de *recorte* (ou *retângulo de clipe*).</span><span class="sxs-lookup"><span data-stu-id="f8af0-171">The Clip property of a visual specifies a rectangular area called the *clipping region* (or *clip rectangle*).</span></span> <span data-ttu-id="f8af0-172">Quando um Visual é renderizado, somente a parte do Visual que fica dentro da região de recorte é exibida, enquanto qualquer conteúdo que se estende para fora da região de recorte é recortado (ou seja, não é exibido).</span><span class="sxs-lookup"><span data-stu-id="f8af0-172">When a visual is rendered, only the portion of the visual that falls inside the clipping region is displayed, while any content that extends outside the clipping region is clipped (that is, not displayed).</span></span> <span data-ttu-id="f8af0-173">O DirectComposition dá suporte a regiões de recorte que têm cantos arredondados ou quadrados.</span><span class="sxs-lookup"><span data-stu-id="f8af0-173">DirectComposition supports clipping regions that have rounded or squared corners.</span></span>

<span data-ttu-id="f8af0-174">Você define a propriedade Clip de um Visual chamando o método [**IDCompositionVisual:: SetClip**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setclip(constd2d_rect_f_)) .</span><span class="sxs-lookup"><span data-stu-id="f8af0-174">You set the Clip property of a visual by calling the [**IDCompositionVisual::SetClip**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setclip(constd2d_rect_f_)) method.</span></span>

<span data-ttu-id="f8af0-175">Para obter mais informações, consulte [recorte](clipping.md).</span><span class="sxs-lookup"><span data-stu-id="f8af0-175">For more information, see [Clipping](clipping.md).</span></span>

### <a name="bordermode-property"></a><span data-ttu-id="f8af0-176">Propriedade bordermode</span><span class="sxs-lookup"><span data-stu-id="f8af0-176">BorderMode property</span></span>

<span data-ttu-id="f8af0-177">A propriedade Bordermode especifica como compor as bordas de bitmaps e clipes associados a esse visual, ou com elementos visuais na subárvore com raiz neste visual.</span><span class="sxs-lookup"><span data-stu-id="f8af0-177">The BorderMode property specifies how to compose the edges of bitmaps and clips associated with this visual, or with visuals in the subtree rooted at this visual.</span></span>

<span data-ttu-id="f8af0-178">O modo de borda afeta como as bordas de um bitmap são compostas quando o bitmap é transformado de modo que as bordas não são alinhadas ao eixo com coordenadas de inteiros.</span><span class="sxs-lookup"><span data-stu-id="f8af0-178">The border mode affects how the edges of a bitmap are composed when the bitmap is transformed such that the edges are not axis-aligned with integer coordinates.</span></span> <span data-ttu-id="f8af0-179">Ele também afeta como o conteúdo é recortado nos cantos de um clipe que tem cantos arredondados e na borda de um clipe que é transformado de modo que as bordas não são alinhadas ao eixo com coordenadas de inteiros.</span><span class="sxs-lookup"><span data-stu-id="f8af0-179">It also affects how content is clipped at the corners of a clip that has rounded corners, and at the edge of a clip that is transformed such that the edges are not axis-aligned with integer coordinates.</span></span>

<span data-ttu-id="f8af0-180">Para obter mais informações, consulte [**IDCompositionVisual:: Setbordermode**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setbordermode).</span><span class="sxs-lookup"><span data-stu-id="f8af0-180">For more information, see [**IDCompositionVisual::SetBorderMode**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setbordermode).</span></span>

### <a name="bitmapinterpolationmode-property"></a><span data-ttu-id="f8af0-181">Propriedade BitmapInterpolationMode</span><span class="sxs-lookup"><span data-stu-id="f8af0-181">BitmapInterpolationMode property</span></span>

<span data-ttu-id="f8af0-182">A propriedade BitmapInterpolationMode informa ao DirectComposition como compor um bitmap quando ele é transformado para que não haja uma correspondência de um para um entre pixels no bitmap e em pixels na tela.</span><span class="sxs-lookup"><span data-stu-id="f8af0-182">The BitmapInterpolationMode property tells DirectComposition how to compose a bitmap when it is transformed such that there is no one-to-one correspondence between pixels in the bitmap and pixels on the screen.</span></span>

<span data-ttu-id="f8af0-183">Você define a propriedade BitmapInterpolationMode de um Visual chamando o método [**IDCompositionVisual:: SetBitmapInterpolationMode**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setbitmapinterpolationmode) .</span><span class="sxs-lookup"><span data-stu-id="f8af0-183">You set the BitmapInterpolationMode property of a visual by calling the [**IDCompositionVisual::SetBitmapInterpolationMode**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setbitmapinterpolationmode) method.</span></span>

### <a name="compositemode-property"></a><span data-ttu-id="f8af0-184">Propriedade compositemode</span><span class="sxs-lookup"><span data-stu-id="f8af0-184">CompositeMode property</span></span>

<span data-ttu-id="f8af0-185">A propriedade Compositemode informa ao DirectComposition como misturar o conteúdo de bitmap de um Visual com o destino de renderização.</span><span class="sxs-lookup"><span data-stu-id="f8af0-185">The CompositeMode property tells DirectComposition how to blend the bitmap content of a visual with the render target.</span></span> <span data-ttu-id="f8af0-186">Para obter uma descrição dos modos compostos com suporte, [**consulte \_ \_ modo composto DCOMPOSITION**](/windows/desktop/api/DcompTypes/ne-dcomptypes-dcomposition_composite_mode).</span><span class="sxs-lookup"><span data-stu-id="f8af0-186">For a description of the supported composite modes, see [**DCOMPOSITION\_COMPOSITE\_MODE**](/windows/desktop/api/DcompTypes/ne-dcomptypes-dcomposition_composite_mode).</span></span>

<span data-ttu-id="f8af0-187">Você define a propriedade Compositemode de um Visual chamando o método [**IDCompositionVisual:: Setcompostomode**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setcompositemode) .</span><span class="sxs-lookup"><span data-stu-id="f8af0-187">You set the CompositeMode property of a visual by calling the [**IDCompositionVisual::SetCompositeMode**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setcompositemode) method.</span></span>

### <a name="offsetx-and-offsety-properties"></a><span data-ttu-id="f8af0-188">Propriedades OffsetX e OffsetY</span><span class="sxs-lookup"><span data-stu-id="f8af0-188">OffsetX and OffsetY properties</span></span>

<span data-ttu-id="f8af0-189">As propriedades OffsetX e OffsetY dizem ao DirectComposition onde posicionar um Visual horizontal e verticalmente.</span><span class="sxs-lookup"><span data-stu-id="f8af0-189">The OffsetX and OffsetY properties tell DirectComposition where to position a visual horizontally and vertically.</span></span> <span data-ttu-id="f8af0-190">Elas definem a posição fixa bidimensional da qual todas as transformações e efeitos do Visual são calculados.</span><span class="sxs-lookup"><span data-stu-id="f8af0-190">They define the two-dimensional fixed position from which all transforms and effects for the visual are calculated.</span></span>

<span data-ttu-id="f8af0-191">Para um visual raiz, as propriedades OffsetX e OffsetY definem a coordenada x e a coordenada y de um ponto em relação ao canto superior esquerdo da janela que hospeda o Visual.</span><span class="sxs-lookup"><span data-stu-id="f8af0-191">For a root visual, the OffsetX and OffsetY properties define the x-coordinate and y-coordinate of a point relative to the upper-left corner of the window that hosts the visual.</span></span> <span data-ttu-id="f8af0-192">Para um Visual filho, as coordenadas são relativas ao canto superior esquerdo do pai ou, se a [Propriedade TransformParent](#transformparent-property) for especificada, o canto superior esquerdo do Visual especificado.</span><span class="sxs-lookup"><span data-stu-id="f8af0-192">For a child visual, the coordinates are relative to the upper-left corner of the parent or, if the [TransformParent property](#transformparent-property) is specified, the upper-left corner of the specified visual.</span></span> <span data-ttu-id="f8af0-193">Quando um Visual é renderizado, ele é posicionado de modo que o canto superior esquerdo do Visual coincida com as coordenadas especificadas.</span><span class="sxs-lookup"><span data-stu-id="f8af0-193">When a visual is rendered, it is positioned such that the visual's upper-left corner coincides with the specified coordinates.</span></span>

<span data-ttu-id="f8af0-194">Você define as propriedades OffsetX e OffsetY de um Visual chamando os métodos [**IDCompositionVisual:: SetOffsetX**](/previous-versions/windows/desktop/legacy/hh449126(v=vs.85)) e [**setdeslocy**](/previous-versions/windows/desktop/legacy/hh449131(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="f8af0-194">You set the OffsetX and OffsetY properties of a visual by calling the [**IDCompositionVisual::SetOffsetX**](/previous-versions/windows/desktop/legacy/hh449126(v=vs.85)) and [**SetOffsetY**](/previous-versions/windows/desktop/legacy/hh449131(v=vs.85)) methods.</span></span>

### <a name="effect-property"></a><span data-ttu-id="f8af0-195">Propriedade Effect</span><span class="sxs-lookup"><span data-stu-id="f8af0-195">Effect property</span></span>

<span data-ttu-id="f8af0-196">A Propriedade Effect permite especificar um efeito, ou um grupo de efeitos, que modificará como um Visual e sua subárvore são compostos.</span><span class="sxs-lookup"><span data-stu-id="f8af0-196">The Effect property lets you specify an effect, or group of effects, that will modify how a visual and its subtree is composed.</span></span> <span data-ttu-id="f8af0-197">Por exemplo, você pode especificar efeitos que controlam a opacidade de um Visual, misturar o Visual com outro bitmap de várias maneiras e aplicar transformações de perspectiva ao Visual.</span><span class="sxs-lookup"><span data-stu-id="f8af0-197">For example, you can specify effects that control the opacity of a visual, blend the visual with another bitmap in various ways, and apply perspective transforms to the visual.</span></span>

<span data-ttu-id="f8af0-198">Você define a Propriedade Effect de um Visual chamando o método [**IDCompositionVisual:: seteffect**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-seteffect) .</span><span class="sxs-lookup"><span data-stu-id="f8af0-198">You set the Effect property of a visual by calling the [**IDCompositionVisual::SetEffect**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-seteffect) method.</span></span>

<span data-ttu-id="f8af0-199">Para obter mais informações, veja [Efeitos](effects.md).</span><span class="sxs-lookup"><span data-stu-id="f8af0-199">For more information, see [Effects](effects.md).</span></span>

### <a name="transform-property"></a><span data-ttu-id="f8af0-200">Propriedade Transform</span><span class="sxs-lookup"><span data-stu-id="f8af0-200">Transform property</span></span>

<span data-ttu-id="f8af0-201">A propriedade Transform especifica uma transformação bidimensional (2D) ou um grupo de transformações 2D, para DirectComposition executar no Visual.</span><span class="sxs-lookup"><span data-stu-id="f8af0-201">The Transform property specifies a two-dimensional (2D) transformation, or group of 2D transformations, for DirectComposition to perform on the visual.</span></span> <span data-ttu-id="f8af0-202">Uma transformação (ou transformação) é uma operação que modifica o sistema de coordenadas de um Visual relativo ao seu pai ou em relação ao Visual especificado pela [Propriedade TransformParent](#transformparent-property).</span><span class="sxs-lookup"><span data-stu-id="f8af0-202">A transformation (or transform) is an operation that modifies the coordinate system of a visual relative to its parent, or relative to the visual specified by the [TransformParent property](#transformparent-property).</span></span> <span data-ttu-id="f8af0-203">Você pode usar transformações para alterar a posição, o tamanho ou a natureza de um Visual, movendo-o para outro local (tradução), tornando-o maior ou menor (dimensionando), virando-o (rotação), distorcendo sua forma (distorção) e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="f8af0-203">You can use transforms to alter the position, size, or nature of a visual by moving it to another location (translation), making it larger or smaller (scaling), turning it (rotation), distorting its shape (skewing), and so on.</span></span>

<span data-ttu-id="f8af0-204">Você define a propriedade Transform de um Visual chamando o método [**IDCompositionVisual:: SetTransform**](/previous-versions/windows/desktop/legacy/hh449178(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="f8af0-204">You set the Transform property of a visual by calling the [**IDCompositionVisual::SetTransform**](/previous-versions/windows/desktop/legacy/hh449178(v=vs.85)) method.</span></span>

<span data-ttu-id="f8af0-205">Para obter mais informações, consulte [Transformações](transforms.md).</span><span class="sxs-lookup"><span data-stu-id="f8af0-205">For more information, see [Transforms](transforms.md).</span></span>

### <a name="transformparent-property"></a><span data-ttu-id="f8af0-206">Propriedade TransformParent</span><span class="sxs-lookup"><span data-stu-id="f8af0-206">TransformParent property</span></span>

<span data-ttu-id="f8af0-207">O sistema de coordenadas de um Visual é modificado pelas propriedades OffsetX, OffsetY e Transform.</span><span class="sxs-lookup"><span data-stu-id="f8af0-207">The coordinate system of a visual is modified by the OffsetX, OffsetY, and Transform properties.</span></span> <span data-ttu-id="f8af0-208">Normalmente, essas propriedades definem o sistema de coordenadas de um Visual em relação ao seu pai imediato.</span><span class="sxs-lookup"><span data-stu-id="f8af0-208">Normally, these properties define the coordinate system of a visual relative to its immediate parent.</span></span> <span data-ttu-id="f8af0-209">Para usar algum elemento visual diferente do pai como base para o sistema de coordenadas de um Visual filho, use a propriedade TransformParent para especificar um visual diferente como "pai" para fins de transformação.</span><span class="sxs-lookup"><span data-stu-id="f8af0-209">To use some visual other than the parent as the basis for the coordinate system of a child visual, use the TransformParent property to specify a different visual as the "parent" for transform purposes.</span></span>

<span data-ttu-id="f8af0-210">Você define a propriedade TransformParent de um Visual chamando o método [**IDCompositionVisual:: SetTransformParent**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-settransformparent) .</span><span class="sxs-lookup"><span data-stu-id="f8af0-210">You set the TransformParent property of a visual by calling the [**IDCompositionVisual::SetTransformParent**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-settransformparent) method.</span></span>

## <a name="device-object"></a><span data-ttu-id="f8af0-211">Objeto de dispositivo</span><span class="sxs-lookup"><span data-stu-id="f8af0-211">Device object</span></span>

<span data-ttu-id="f8af0-212">Para usar o DirectComposition, você deve criar e manipular uma variedade de objetos COM (Component Object Model).</span><span class="sxs-lookup"><span data-stu-id="f8af0-212">To use DirectComposition, you must create and manipulate a variety of Component Object Model (COM) objects.</span></span> <span data-ttu-id="f8af0-213">O primeiro objeto que você precisa criar é o objeto de *dispositivo* DirectComposition porque ele serve como o alocador para a criação de todos os outros objetos usados em uma composição.</span><span class="sxs-lookup"><span data-stu-id="f8af0-213">The first object that you need to create is the DirectComposition *device object* because it serves as the factory for creating all other objects used in a composition.</span></span>

<span data-ttu-id="f8af0-214">Você cria um objeto de dispositivo chamando a função [**DCompositionCreateDevice**](/windows/desktop/api/Dcomp/nf-dcomp-dcompositioncreatedevice) , que retorna um ponteiro de interface [**IDCompositionDevice**](/windows/win32/api/dcomp/nn-dcomp-idcompositiondevice) .</span><span class="sxs-lookup"><span data-stu-id="f8af0-214">You create a device object by calling the [**DCompositionCreateDevice**](/windows/desktop/api/Dcomp/nf-dcomp-dcompositioncreatedevice) function, which returns an [**IDCompositionDevice**](/windows/win32/api/dcomp/nn-dcomp-idcompositiondevice) interface pointer.</span></span> <span data-ttu-id="f8af0-215">Essa interface expõe um conjunto de métodos que você usa para criar objetos visuais, objetos de clipe, objetos de animação, objetos de transformação, objetos de efeito e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="f8af0-215">This interface exposes a set of methods that you use to create visual objects, clip objects, animation objects, transform objects, effect objects, and so on.</span></span>

<span data-ttu-id="f8af0-216">O objeto de dispositivo atende a outra finalidade, além de ser um alocador para a criação de outros objetos.</span><span class="sxs-lookup"><span data-stu-id="f8af0-216">The device object serves one other purpose besides being a factory for creating other objects.</span></span> <span data-ttu-id="f8af0-217">Ele expõe um método chamado [**Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit) que passa uma árvore visual para DirectComposition para processamento.</span><span class="sxs-lookup"><span data-stu-id="f8af0-217">It exposes a method called [**Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit) that passes a visual tree to DirectComposition for processing.</span></span> <span data-ttu-id="f8af0-218">Para obter mais informações, consulte [composição transacional](#transactional-composition).</span><span class="sxs-lookup"><span data-stu-id="f8af0-218">For more information, see [Transactional Composition](#transactional-composition).</span></span>

<span data-ttu-id="f8af0-219">Lembre-se de que, embora você possa criar várias instâncias do objeto de dispositivo em seu aplicativo, todos os objetos que você usa em uma composição específica devem ser criados pelo mesmo objeto de dispositivo — com uma exceção: você pode combinar objetos visuais de diferentes objetos de dispositivo na mesma árvore visual.</span><span class="sxs-lookup"><span data-stu-id="f8af0-219">Remember that, while you can create multiple instances of the device object in your application, all of the objects that you use in a particular composition must be created by the same device object—with one exception: You can combine visual objects from different device objects in the same visual tree.</span></span> <span data-ttu-id="f8af0-220">Quando você faz isso, o DirectComposition trata a árvore visual normalmente, exceto que as alterações em um objeto visual específico na árvore entram em vigor somente quando o método [**Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit) é chamado no objeto de dispositivo que criou o objeto visual.</span><span class="sxs-lookup"><span data-stu-id="f8af0-220">When you do so, DirectComposition treats the visual tree as it normally would, except that changes to a particular visual object in the tree take effect only when the [**Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit) method is called on the device object that created the visual object.</span></span>

<span data-ttu-id="f8af0-221">A capacidade de usar visuais de diferentes dispositivos na mesma árvore visual permite que vários threads criem e manipulem uma única árvore visual mantendo dois dispositivos independentes que podem ser usados para confirmar as alterações de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="f8af0-221">The ability to use visuals from different devices in the same visual tree enables multiple threads to create and manipulate a single visual tree while maintaining two independent devices that can be used to commit changes asynchronously.</span></span> <span data-ttu-id="f8af0-222">Para obter mais informações, consulte [árvores visuais de dispositivos cruzados](#cross-device-visual-trees).</span><span class="sxs-lookup"><span data-stu-id="f8af0-222">For more information, see [Cross-Device Visual Trees](#cross-device-visual-trees).</span></span>

## <a name="composition-target-window"></a><span data-ttu-id="f8af0-223">Janela de destino da composição</span><span class="sxs-lookup"><span data-stu-id="f8af0-223">Composition target window</span></span>

<span data-ttu-id="f8af0-224">Uma árvore visual deve ser associada a uma janela antes que qualquer um dos visuais da árvore possa ser exibido na tela.</span><span class="sxs-lookup"><span data-stu-id="f8af0-224">A visual tree must be bound to a window before any of the tree's visuals can be displayed on the screen.</span></span> <span data-ttu-id="f8af0-225">A janela, chamada de *janela de destino de composição*, pode ser uma janela de nível superior ou uma janela filho.</span><span class="sxs-lookup"><span data-stu-id="f8af0-225">The window, called the *composition target window*, can be a top-level window or a child window.</span></span> <span data-ttu-id="f8af0-226">Além disso, a janela de destino de composição pode ser uma janela em camadas; ou seja, ele pode ter o estilo de janela em [**\_ \_ camadas WS ex**](/windows/desktop/winmsg/extended-window-styles) .</span><span class="sxs-lookup"><span data-stu-id="f8af0-226">Also, the composition target window can be a layered window; that is, it can have the [**WS\_EX\_LAYERED**](/windows/desktop/winmsg/extended-window-styles) window style.</span></span>

<span data-ttu-id="f8af0-227">O DirectComposition permite que um aplicativo associe um máximo de duas árvores visuais a cada janela.</span><span class="sxs-lookup"><span data-stu-id="f8af0-227">DirectComposition allows an application to bind a maximum of two visual trees to each window.</span></span> <span data-ttu-id="f8af0-228">As árvores visuais incluem uma que é composta sobre a própria janela, mas por trás de todas as janelas filhas da janela, e outra que é composta na parte superior da janela e sobre as janelas filhas.</span><span class="sxs-lookup"><span data-stu-id="f8af0-228">The visual trees include one that is composed on top of the window itself, but behind all of the window’s child windows, and another that is composed on top of the window and on top of the child windows.</span></span> <span data-ttu-id="f8af0-229">Em outras palavras, cada janela tem quatro camadas conceituais e todas as camadas são recortadas na região visível da janela de destino.</span><span class="sxs-lookup"><span data-stu-id="f8af0-229">In other words, each window has four conceptual layers, and all layers are clipped to the target window's visible region.</span></span> <span data-ttu-id="f8af0-230">A ilustração a seguir mostra as quatro camadas conceituais de uma janela.</span><span class="sxs-lookup"><span data-stu-id="f8af0-230">The following illustration shows the four conceptual layers of a window.</span></span>

![as camadas conceituais de uma janela](images/directcomposition-layers.png)

## <a name="transactional-composition"></a><span data-ttu-id="f8af0-232">Composição transacional</span><span class="sxs-lookup"><span data-stu-id="f8af0-232">Transactional composition</span></span>

<span data-ttu-id="f8af0-233">O DirectComposition usa um modelo transacional em que você cria um conjunto em lote de alterações em um Visual e, em seguida, "confirma" o conjunto como DirectComposition para o processamento de todos de uma vez.</span><span class="sxs-lookup"><span data-stu-id="f8af0-233">DirectComposition uses a transactional model where you create a batched set of changes to a visual and then "commit" the set to DirectComposition for processing all at once.</span></span> <span data-ttu-id="f8af0-234">Você pode modificar o mesmo objeto visual DirectComposition e confirmar as alterações várias vezes.</span><span class="sxs-lookup"><span data-stu-id="f8af0-234">You can modify the same DirectComposition visual object and commit the changes any number of times.</span></span> <span data-ttu-id="f8af0-235">Quando o Gerenciador de Janelas da Área de Trabalho (DWM) pega lotes, ele pega todos os lotes pendentes e os aplica ao próximo quadro na ordem em que foram confirmados.</span><span class="sxs-lookup"><span data-stu-id="f8af0-235">When the Desktop Window Manager (DWM) picks up batches, it picks up all pending batches and applies them to the next frame in the order they were committed.</span></span>

<span data-ttu-id="f8af0-236">Todas as alterações em uma única confirmação têm a garantia de serem aplicadas a um único quadro.</span><span class="sxs-lookup"><span data-stu-id="f8af0-236">All changes within a single commit are guaranteed to be applied to a single frame.</span></span> <span data-ttu-id="f8af0-237">Como o DWM coleta lotes uma vez por quadro, você pode modificar qualquer objeto específico apenas uma vez por quadro.</span><span class="sxs-lookup"><span data-stu-id="f8af0-237">Because DWM collects batches once per frame, you can modify any particular object only once per frame.</span></span> <span data-ttu-id="f8af0-238">As confirmações subsequentes que modificam objetos diferentes também podem ser aplicadas ao quadro atual, mas DirectComposition não garante que as alterações ocorrerão no mesmo quadro.</span><span class="sxs-lookup"><span data-stu-id="f8af0-238">Subsequent commits that modify different objects might also be applied to the current frame, but DirectComposition does not guarantee that the changes will occur in the same frame.</span></span>

<span data-ttu-id="f8af0-239">Os métodos [**IDCompositionSurface:: BeginDraw**](/windows/win32/api/dcomp/nf-dcomp-idcompositionsurface-begindraw) e [**IDCompositionSurface:: EndDraw**](/windows/win32/api/dcomp/nf-dcomp-idcompositionsurface-enddraw) permitem sincronizar atualizações de renderização com atualizações visuais.</span><span class="sxs-lookup"><span data-stu-id="f8af0-239">The [**IDCompositionSurface::BeginDraw**](/windows/win32/api/dcomp/nf-dcomp-idcompositionsurface-begindraw) and [**IDCompositionSurface::EndDraw**](/windows/win32/api/dcomp/nf-dcomp-idcompositionsurface-enddraw) methods let you synchronize rendering updates with visual updates.</span></span> <span data-ttu-id="f8af0-240">Por exemplo, você pode chamar **IDCompositionSurface:: BeginDraw**, atualizar as propriedades de OffsetX e de clipe de um Visual, chamar [**IDCompositionDevice:: Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit), desenhar conteúdo com o Microsoft DirectX e, em seguida, chamar **IDCompositionSurface:: EndDraw**.</span><span class="sxs-lookup"><span data-stu-id="f8af0-240">For example, you can call **IDCompositionSurface::BeginDraw**, update the OffsetX and Clip properties of a visual, call [**IDCompositionDevice::Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit), draw content with Microsoft DirectX, and then call **IDCompositionSurface::EndDraw**.</span></span> <span data-ttu-id="f8af0-241">Nesse caso, o Microsoft DirectComposition garante que o conteúdo de bitmap e as propriedades visuais sejam atualizados ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="f8af0-241">In this case, Microsoft DirectComposition ensures that bitmap content and the visual properties are updated at the same time.</span></span>

### <a name="batching"></a><span data-ttu-id="f8af0-242">Separação em lotes</span><span class="sxs-lookup"><span data-stu-id="f8af0-242">Batching</span></span>

<span data-ttu-id="f8af0-243">Você pode confirmar várias alterações no mesmo elemento visual ou várias alterações em elementos visuais diferentes, dentro do mesmo quadro.</span><span class="sxs-lookup"><span data-stu-id="f8af0-243">You can commit multiple changes to the same visual, or multiple changes to different visuals, within the same frame.</span></span> <span data-ttu-id="f8af0-244">Ao fazer várias alterações no mesmo visual dentro do mesmo quadro, tenha em mente os seguintes pontos:</span><span class="sxs-lookup"><span data-stu-id="f8af0-244">When making multiple changes to the same visual within the same frame, keep the following points in mind:</span></span>

-   <span data-ttu-id="f8af0-245">Se você fizer várias alterações na mesma propriedade de um Visual, somente a última alteração será aplicada.</span><span class="sxs-lookup"><span data-stu-id="f8af0-245">If you make multiple changes to the same property of a visual, only the last change is applied.</span></span> <span data-ttu-id="f8af0-246">Por exemplo, se você definir a opacidade como 0, depois para 0,5 e, finalmente, para 1,0, apenas uma opacidade de 1,0 será aplicada ao Visual.</span><span class="sxs-lookup"><span data-stu-id="f8af0-246">For example, if you set the opacity to 0, then to 0.5, and finally to 1.0, only an opacity of 1.0 is applied to the visual.</span></span>
-   <span data-ttu-id="f8af0-247">Se você alterar várias propriedades do mesmo visual, DirectComposition aplicará as alterações primeiro ao Visual e, em seguida, a qualquer elemento visual filho.</span><span class="sxs-lookup"><span data-stu-id="f8af0-247">If you change multiple properties of the same visual, DirectComposition applies the changes first to the visual and then to any child visuals.</span></span> <span data-ttu-id="f8af0-248">As propriedades são aplicadas na ordem a seguir, independentemente da ordem em que você as especificar:</span><span class="sxs-lookup"><span data-stu-id="f8af0-248">The properties are applied in the following order regardless of the order in which you specify them:</span></span>

    1.  <span data-ttu-id="f8af0-249">Deslocamento</span><span class="sxs-lookup"><span data-stu-id="f8af0-249">Offset</span></span>
    2.  <span data-ttu-id="f8af0-250">Transformar</span><span class="sxs-lookup"><span data-stu-id="f8af0-250">Transform</span></span>
    3.  <span data-ttu-id="f8af0-251">Recortar</span><span class="sxs-lookup"><span data-stu-id="f8af0-251">Clip</span></span>
    4.  <span data-ttu-id="f8af0-252">Efeito</span><span class="sxs-lookup"><span data-stu-id="f8af0-252">Effect</span></span>

    <span data-ttu-id="f8af0-253">A ilustração a seguir mostra o resultado da aplicação de todas as quatro propriedades em um Visual.</span><span class="sxs-lookup"><span data-stu-id="f8af0-253">The following illustration shows the result of applying all four properties to a visual.</span></span>

    ![resultado da aplicação de todas as quatro propriedades a um Visual](images/order-of-properties.png)

    <span data-ttu-id="f8af0-255">Lembre-se de que todas as alterações são aplicadas ao Visual de uma vez no contexto do mesmo quadro.</span><span class="sxs-lookup"><span data-stu-id="f8af0-255">Remember that all changes are applied to the visual at once within the context of the same frame.</span></span> <span data-ttu-id="f8af0-256">Isso significa que, da perspectiva do usuário, as alterações no Visual ocorrem instantaneamente.</span><span class="sxs-lookup"><span data-stu-id="f8af0-256">This means that, from the user's perspective, the changes to the visual occur instantaneously.</span></span>

-   <span data-ttu-id="f8af0-257">Para a propriedade Transform, você pode usar [**IDCompositionDevice:: CreateTransform**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createtransformgroup) para criar um grupo de transformações para aplicar a um Visual de uma só vez.</span><span class="sxs-lookup"><span data-stu-id="f8af0-257">For the Transform property, you can use [**IDCompositionDevice::CreateTransformGroup**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createtransformgroup) to create a group of transforms to apply to a visual all at once.</span></span> <span data-ttu-id="f8af0-258">DirectComposition aplica as transformações na ordem especificada.</span><span class="sxs-lookup"><span data-stu-id="f8af0-258">DirectComposition applies the transforms in the order that you specify.</span></span>
-   <span data-ttu-id="f8af0-259">Para a Propriedade Effect, você pode usar [**IDCompositionEffectGroup**](/windows/win32/api/dcomp/nn-dcomp-idcompositioneffectgroup) para aplicar um grupo de efeitos.</span><span class="sxs-lookup"><span data-stu-id="f8af0-259">For the Effect property, you can use [**IDCompositionEffectGroup**](/windows/win32/api/dcomp/nn-dcomp-idcompositioneffectgroup) to apply a group of effects.</span></span> <span data-ttu-id="f8af0-260">DirectComposition aplica os efeitos na ordem que você especificar.</span><span class="sxs-lookup"><span data-stu-id="f8af0-260">DirectComposition applies the effects in the order that you specify.</span></span> <span data-ttu-id="f8af0-261">Além disso, as transformações de perspectiva 3D resultam em achatamento da árvore visual depois que todas as transformações 3D no Visual atual tiverem sido aplicadas.</span><span class="sxs-lookup"><span data-stu-id="f8af0-261">In addition, 3D perspective transformations result in flattening of the visual tree after all 3D transformations in the current visual have been applied.</span></span> <span data-ttu-id="f8af0-262">Isso ajuda a garantir que o Visual resultante pareça o mais próximo possível do 3D.</span><span class="sxs-lookup"><span data-stu-id="f8af0-262">This helps ensure that the resulting visual looks as close to 3D as possible.</span></span>

### <a name="synchronization"></a><span data-ttu-id="f8af0-263">Sincronização</span><span class="sxs-lookup"><span data-stu-id="f8af0-263">Synchronization</span></span>

<span data-ttu-id="f8af0-264">Seu aplicativo pode chamar DirectComposition de vários threads ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="f8af0-264">Your application can call DirectComposition from multiple threads at the same time.</span></span> <span data-ttu-id="f8af0-265">A ordem de execução é garantida para chamadas sequenciais, mas não para chamadas simultâneas.</span><span class="sxs-lookup"><span data-stu-id="f8af0-265">The order of execution is guaranteed for sequential calls, but not for concurrent calls.</span></span> <span data-ttu-id="f8af0-266">Por exemplo, se o thread A modificar um Visual e o thread B confirmar o lote ao mesmo tempo, ele não será definido se essa alteração Visual for incluída no lote confirmado ou se ele iniciará um novo lote.</span><span class="sxs-lookup"><span data-stu-id="f8af0-266">For example, if thread A modifies a visual and thread B commits the batch at the same time, it is not defined whether that visual change is included in the committed batch or whether it starts a new batch.</span></span> <span data-ttu-id="f8af0-267">Por outro lado, se seu aplicativo usar outros mecanismos de sincronização para garantir que um método seja chamado antes do outro, o DirectComposition honrará a ordem de chamada e os processará como se ambas as chamadas fossem emitidas nessa ordem a partir de um único thread.</span><span class="sxs-lookup"><span data-stu-id="f8af0-267">On the other hand, if your application uses other synchronization mechanisms to ensure that one method is called before the other, DirectComposition honors the call order and processes them as if both calls were issued in that order from a single thread.</span></span>

### <a name="cross-device-visual-trees"></a><span data-ttu-id="f8af0-268">Árvores visuais de dispositivos cruzados</span><span class="sxs-lookup"><span data-stu-id="f8af0-268">Cross-device visual trees</span></span>

<span data-ttu-id="f8af0-269">Os objetos DirectComposition não são associados a thread; Você pode usar vários threads para modificar o mesmo conjunto de objetos.</span><span class="sxs-lookup"><span data-stu-id="f8af0-269">DirectComposition objects are not thread bound; you can use multiple threads to modify the same set of objects.</span></span> <span data-ttu-id="f8af0-270">No entanto, esteja ciente dos problemas a seguir ao compartilhar o mesmo objeto de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="f8af0-270">However, be aware of the following issues when sharing the same device object.</span></span>

-   <span data-ttu-id="f8af0-271">Ambos os threads precisam ser capazes de chamar [**IDCompositionDevice:: Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit).</span><span class="sxs-lookup"><span data-stu-id="f8af0-271">Both threads need to be able to call [**IDCompositionDevice::Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit).</span></span> <span data-ttu-id="f8af0-272">Se apenas um dos threads chamar **IDCompositionDevice:: Commit**, o outro thread não poderá confirmar nenhuma de suas alterações para DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="f8af0-272">If only one of the threads calls **IDCompositionDevice::Commit**, the other thread cannot commit any of its changes to DirectComposition.</span></span>
-   <span data-ttu-id="f8af0-273">O comportamento transacional pode ser perdido se um thread chamar [**IDCompositionDevice:: Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit) enquanto o outro thread ainda estiver fazendo alterações que se destinam a fazer parte da mesma transação.</span><span class="sxs-lookup"><span data-stu-id="f8af0-273">Transactional behavior might be lost if one thread calls [**IDCompositionDevice::Commit**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit) while the other thread is still making changes that are intended to be part of the same transaction.</span></span>

<span data-ttu-id="f8af0-274">Se você precisar confirmar várias transações simultâneas em DirectComposition, deverá usar vários objetos de dispositivo, possivelmente de vários threads.</span><span class="sxs-lookup"><span data-stu-id="f8af0-274">If you need to commit multiple simultaneous transactions to DirectComposition, you must use multiple device objects, possibly from multiple threads.</span></span> <span data-ttu-id="f8af0-275">Nesse cenário, a mesma árvore visual é compartilhada por ambos os objetos de dispositivo, e cada objeto de dispositivo confirma suas próprias transações.</span><span class="sxs-lookup"><span data-stu-id="f8af0-275">In this scenario, the same visual tree is shared by both device objects, and each device object commits its own transactions.</span></span>

<span data-ttu-id="f8af0-276">A ilustração a seguir mostra uma árvore visual que é compartilhada por dois objetos de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="f8af0-276">The following illustration shows a visual tree that is shared by two device objects.</span></span> <span data-ttu-id="f8af0-277">Os elementos visuais 1, 2, 4 e 5 pertencem a um dispositivo ou outro, mas o Visual 3 é compartilhado por ambos os dispositivos e, portanto, pode ser usado para conectar duas subárvores em uma única e maior árvores visuais.</span><span class="sxs-lookup"><span data-stu-id="f8af0-277">Visuals 1, 2, 4 and 5 are owned by one device or the other, but visual 3 is shared by both devices, and can therefore be used to connect two sub-trees into a single, larger visual tree.</span></span> <span data-ttu-id="f8af0-278">O compartilhamento da árvore visual permite que os dois dispositivos sejam manipulados de dois threads diferentes de forma assíncrona.</span><span class="sxs-lookup"><span data-stu-id="f8af0-278">Sharing the visual tree allows the two devices to be manipulated from two different threads asynchronously.</span></span>

![uma árvore visual compartilhada por dois dispositivos](images/shared-visual-tree-1.png)

<span data-ttu-id="f8af0-280">Para ilustrar a utilidade de compartilhar uma árvore visual entre dois dispositivos, considere uma arquitetura que permita a entrada por toque de baixa latência.</span><span class="sxs-lookup"><span data-stu-id="f8af0-280">To illustrate the usefulness of sharing a visual tree between two devices, consider an architecture that enables low-latency touch input.</span></span> <span data-ttu-id="f8af0-281">A arquitetura pode usar dois threads, um que manipula a maioria das tarefas de interface do usuário e um segundo thread dedicado ao processamento de eventos de entrada de toque.</span><span class="sxs-lookup"><span data-stu-id="f8af0-281">The architecture could use two threads, one that handles most UI tasks, and a second thread dedicated to processing touch input events.</span></span> <span data-ttu-id="f8af0-282">O thread de toque atualiza a transformação de um Visual específico com base no gesto de entrada do usuário.</span><span class="sxs-lookup"><span data-stu-id="f8af0-282">The touch thread updates the transform of a particular visual based on the user input gesture.</span></span> <span data-ttu-id="f8af0-283">Ao atualizar a transformação, o thread de toque pode fazer com que toda a subárvore sob esse visual siga o dedo do usuário, escale ou reduza verticalmente à medida que o usuário executa um gesto multitoque e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="f8af0-283">By updating the transform, the touch thread can make the entire subtree under that visual follow the user’s finger, scale up or down as the user executes a multi-touch gesture, and so on.</span></span> <span data-ttu-id="f8af0-284">O thread da interface do usuário retém a propriedade da maior parte da árvore de composição, com o thread de toque que possui apenas os poucos visuais marcados para resposta de toque assíncrono.</span><span class="sxs-lookup"><span data-stu-id="f8af0-284">The UI thread retains ownership of most of the composition tree, with the touch thread owning only the few visuals that are tagged for asynchronous touch response.</span></span> <span data-ttu-id="f8af0-285">A ilustração a seguir mostra uma versão simplificada dessa árvore de composição:</span><span class="sxs-lookup"><span data-stu-id="f8af0-285">The following illustration shows a simplified version of such a composition tree:</span></span>

![uma árvore visual compartilhada entre um thread de interface do usuário e um thread de toque](images/shared-visual-tree-2.png)

<span data-ttu-id="f8af0-287">Normalmente, o thread da interface do usuário modifica apenas os visuais que ele possui exclusivamente e o thread de toque modifica apenas o Visual compartilhado.</span><span class="sxs-lookup"><span data-stu-id="f8af0-287">Typically, the UI thread modifies only the visuals that it owns exclusively, and the touch thread modifies only the shared visual.</span></span> <span data-ttu-id="f8af0-288">A única exceção ocorre ao criar ou destruir uma subárvore habilitada para toque.</span><span class="sxs-lookup"><span data-stu-id="f8af0-288">The only exception occurs when creating or destroying a touch-enabled subtree.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f8af0-289">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="f8af0-289">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f8af0-290">**IDCompositionSurface:: BeginDraw**</span><span class="sxs-lookup"><span data-stu-id="f8af0-290">**IDCompositionSurface::BeginDraw**</span></span>](/windows/win32/api/dcomp/nf-dcomp-idcompositionsurface-begindraw)
</dt> <dt>

[<span data-ttu-id="f8af0-291">**IDCompositionSurface:: EndDraw**</span><span class="sxs-lookup"><span data-stu-id="f8af0-291">**IDCompositionSurface::EndDraw**</span></span>](/windows/win32/api/dcomp/nf-dcomp-idcompositionsurface-enddraw)
</dt> <dt>

[<span data-ttu-id="f8af0-292">**IDCompositonDevice:: Commit**</span><span class="sxs-lookup"><span data-stu-id="f8af0-292">**IDCompositonDevice::Commit**</span></span>](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-commit)
</dt> <dt>

[<span data-ttu-id="f8af0-293">Conceitos de DirectComposition</span><span class="sxs-lookup"><span data-stu-id="f8af0-293">DirectComposition Concepts</span></span>](directcomposition-concepts.md)
</dt> </dl>

 

 