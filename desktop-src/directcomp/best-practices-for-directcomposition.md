---
title: Práticas recomendadas para DirectComposition
description: Este tópico descreve as práticas recomendadas para o uso do Microsoft DirectComposition.
ms.assetid: D3A1ECD4-9358-44B9-8A84-7D901219D5CD
keywords:
- práticas recomendadas para DirectComposition
- práticas recomendadas para DirectComposition
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2f0d19b82b188105c7914e89282c08b12dd4bdc4
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103641749"
---
# <a name="best-practices-for-directcomposition"></a><span data-ttu-id="2cf58-105">Práticas recomendadas para DirectComposition</span><span class="sxs-lookup"><span data-stu-id="2cf58-105">Best practices for DirectComposition</span></span>

> [!NOTE]
> <span data-ttu-id="2cf58-106">Para aplicativos no Windows 10, é recomendável usar APIs do Windows. UI. composição em vez de DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="2cf58-106">For apps on Windows 10, we recommend using Windows.UI.Composition APIs instead of DirectComposition.</span></span> <span data-ttu-id="2cf58-107">Para obter mais informações, consulte [modernizar seu aplicativo de área de trabalho usando a camada Visual](/windows/uwp/composition/visual-layer-in-desktop-apps).</span><span class="sxs-lookup"><span data-stu-id="2cf58-107">For more info, see [Modernize your desktop app using the Visual layer](/windows/uwp/composition/visual-layer-in-desktop-apps).</span></span>

<span data-ttu-id="2cf58-108">Este tópico descreve as práticas recomendadas para o uso do Microsoft DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="2cf58-108">This topic describes best practices for using Microsoft DirectComposition.</span></span>

-   [<span data-ttu-id="2cf58-109">Práticas recomendadas</span><span class="sxs-lookup"><span data-stu-id="2cf58-109">Best practices</span></span>](#best-practices-for-directcomposition)
-   [<span data-ttu-id="2cf58-110">Considerações sobre segurança</span><span class="sxs-lookup"><span data-stu-id="2cf58-110">Security considerations</span></span>](#security-considerations)
-   [<span data-ttu-id="2cf58-111">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="2cf58-111">Related topics</span></span>](#related-topics)

## <a name="best-practices"></a><span data-ttu-id="2cf58-112">Melhores práticas</span><span class="sxs-lookup"><span data-stu-id="2cf58-112">Best practices</span></span>

<span data-ttu-id="2cf58-113">A tabela a seguir apresenta as práticas recomendadas para trabalhar com elementos visuais do Microsoft DirectComposition.</span><span class="sxs-lookup"><span data-stu-id="2cf58-113">The following table presents the practices recommended for working with Microsoft DirectComposition visuals.</span></span>



| <span data-ttu-id="2cf58-114">Prática</span><span class="sxs-lookup"><span data-stu-id="2cf58-114">Practice</span></span>                                                                                                                                                                                                                                                        | <span data-ttu-id="2cf58-115">Description</span><span class="sxs-lookup"><span data-stu-id="2cf58-115">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2cf58-116">Depois de criar um dispositivo DirectComposition, chame o método [**IDCompositionDevice:: CheckDeviceState**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-checkdevicestate) em resposta a cada mensagem do [**WM \_ Paint**](/windows/desktop/gdi/wm-paint) para garantir que o dispositivo ainda seja válido.</span><span class="sxs-lookup"><span data-stu-id="2cf58-116">After creating a DirectComposition device, call the [**IDCompositionDevice::CheckDeviceState**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-checkdevicestate) method in response to each [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message to ensure that the device is still valid.</span></span><br/> | <span data-ttu-id="2cf58-117">Se o dispositivo de infraestrutura gráfica do Microsoft DirectX (DXGI) for perdido, o dispositivo DirectComposition associado ao dispositivo DXGI também será perdido.</span><span class="sxs-lookup"><span data-stu-id="2cf58-117">If the Microsoft DirectX Graphics Infrastructure (DXGI) device is lost, the DirectComposition device associated with the DXGI device is also lost.</span></span> <span data-ttu-id="2cf58-118">Quando ele detecta um dispositivo perdido, o DirectComposition envia a mensagem do [**WM \_ Paint**](/windows/desktop/gdi/wm-paint) para todas as janelas.</span><span class="sxs-lookup"><span data-stu-id="2cf58-118">When it detects a lost device, DirectComposition sends the [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message to all windows.</span></span> <span data-ttu-id="2cf58-119">Chamar [**CheckDeviceState**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-checkdevicestate) em resposta a cada mensagem do **WM \_ Paint** permite determinar se o objeto de dispositivo do DirectComposition ainda é válido e, caso contrário, tomar medidas para recuperar o conteúdo.</span><span class="sxs-lookup"><span data-stu-id="2cf58-119">Calling [**CheckDeviceState**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-checkdevicestate) in response to each **WM\_PAINT** message lets you determine whether the DirectComposition device object is still valid and, if not, take steps to recover content.</span></span> <br/> <span data-ttu-id="2cf58-120">Para obter mais informações, consulte [Device Object](basic-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="2cf58-120">For more information, see [Device object](basic-concepts.md).</span></span><br/> |
| <span data-ttu-id="2cf58-121">Crie apenas o número de visuais necessários para uma composição ou animação e destrua os visuais imediatamente após o DirectComposition terminar de usá-los.</span><span class="sxs-lookup"><span data-stu-id="2cf58-121">Create only the number of visuals needed for a composition or animation, and destroy the visuals immediately after DirectComposition finishes using them.</span></span><br/>                                                                                            | <span data-ttu-id="2cf58-122">O DirectComposition usa a GPU (unidade de processamento gráfico), um recurso que seu aplicativo compartilha com outros aplicativos e o sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="2cf58-122">DirectComposition uses the graphics processing unit (GPU), a resource that your application shares with other applications and the operating system.</span></span> <span data-ttu-id="2cf58-123">Essa prática garante que todos os aplicativos e o sistema operacional recebam recursos de GPU adequados.</span><span class="sxs-lookup"><span data-stu-id="2cf58-123">This practice ensures that all applications and the operating system receive adequate GPU resources.</span></span><br/> <span data-ttu-id="2cf58-124">Para obter mais informações, consulte [visuais](basic-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="2cf58-124">For more information, see [Visuals](basic-concepts.md).</span></span><br/>                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="2cf58-125">Não oculte os visuais definindo a opacidade como 0%; em vez disso, remova os visuais da árvore visual.</span><span class="sxs-lookup"><span data-stu-id="2cf58-125">Do not hide visuals by setting opacity to 0%; instead, remove visuals from the visual tree.</span></span><br/>                                                                                                                                                          | <span data-ttu-id="2cf58-126">Definir a opacidade como 0% exige mais recursos do sistema do que removê-los da árvore visual.</span><span class="sxs-lookup"><span data-stu-id="2cf58-126">Setting opacity to 0% requires more system resources than removing them from the visual tree.</span></span><br/> <span data-ttu-id="2cf58-127">Para obter mais informações, consulte [opacidade](effects.md) e [árvore visual](basic-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="2cf58-127">For more information, see [Opacity](effects.md) and [Visual tree](basic-concepts.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                      |
| <span data-ttu-id="2cf58-128">Não oculte um Visual aplicando um retângulo de clipe vazio (tamanho zero) a um Visual.</span><span class="sxs-lookup"><span data-stu-id="2cf58-128">Do not hide a visual by applying an empty (zero sized) clip rectangle to a visual.</span></span> <span data-ttu-id="2cf58-129">Em vez disso, remova o Visual da árvore visual.</span><span class="sxs-lookup"><span data-stu-id="2cf58-129">Instead, remove the visual from the visual tree.</span></span> <br/>                                                                                                                 | <span data-ttu-id="2cf58-130">A remoção de um Visual da árvore visual resulta em um melhor desempenho do que a aplicação de um retângulo de clipe vazio.</span><span class="sxs-lookup"><span data-stu-id="2cf58-130">Removing a visual from the visual tree results in better performance than applying an empty clip rectangle.</span></span><br/> <span data-ttu-id="2cf58-131">Para obter mais informações, consulte [recorte](clipping.md).</span><span class="sxs-lookup"><span data-stu-id="2cf58-131">For more information, see [Clipping](clipping.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="2cf58-132">Não aplique um retângulo de clipe a um Visual se o clipe retângulo não for necessário, como um retângulo de clipe que inclui todo o conteúdo do bitmap do Visual.</span><span class="sxs-lookup"><span data-stu-id="2cf58-132">Do not apply a clip rectangle to a visual if the clip rectangle is not needed, such as a clip rectangle that includes the entire bitmap content of the visual.</span></span><br/>                                                                                       | <span data-ttu-id="2cf58-133">Retângulos de clipes desnecessários danificam o desempenho do sistema.</span><span class="sxs-lookup"><span data-stu-id="2cf58-133">Unnecessary clip rectangles harm system performance.</span></span><br/> <span data-ttu-id="2cf58-134">Para obter mais informações, consulte [recorte](clipping.md).</span><span class="sxs-lookup"><span data-stu-id="2cf58-134">For more information, see [Clipping](clipping.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="2cf58-135">Se você precisar de um bitmap grande, de cor única, crie uma superfície de bitmap menor e, em seguida, aplique uma transformação de escala em vez de criar uma superfície de tamanho total.</span><span class="sxs-lookup"><span data-stu-id="2cf58-135">If you need a large, single-color bitmap, create a smaller bitmap surface and then apply a scale transform instead of creating a full-sized surface.</span></span> <br/>                                                                                                | <span data-ttu-id="2cf58-136">A aplicação de uma transformação de escala a uma superfície menor usa menos recursos do sistema do que uma superfície de tamanho total.</span><span class="sxs-lookup"><span data-stu-id="2cf58-136">Applying a scale transform to a smaller surface is uses fewer system resources than a full-size surface.</span></span><br/> <span data-ttu-id="2cf58-137">Para obter mais informações, consulte [bitmaps](bitmap-surfaces.md) e [transformações](transforms.md).</span><span class="sxs-lookup"><span data-stu-id="2cf58-137">For more information, see [Bitmap objects](bitmap-surfaces.md) and [Transforms](transforms.md).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                     |
| <span data-ttu-id="2cf58-138">Evite aplicar transformações 3D a vários níveis de uma árvore visual, como a um pai e seus descendentes.</span><span class="sxs-lookup"><span data-stu-id="2cf58-138">Avoid applying 3D transforms to multiple levels of a visual tree, such as to a parent and its descendent(s).</span></span> <br/>                                                                                                                                        | <span data-ttu-id="2cf58-139">A aplicação de transformações 3D a vários níveis de uma árvore visual pode produzir resultados indesejados porque as transformações 3D não são multiplicadas na árvore.</span><span class="sxs-lookup"><span data-stu-id="2cf58-139">Applying 3D transforms to multiple levels of a visual tree can produce unintended results because 3D transformations are not multiplied out in the tree.</span></span> <span data-ttu-id="2cf58-140">Por exemplo, uma rotação de 90 graus em volta do eixo y em um filho, e uma rotação de 90 graus em volta do eixo y em um pai, resulta em ambos os visuais sendo girados de forma a nada.</span><span class="sxs-lookup"><span data-stu-id="2cf58-140">For example, a 90 degree rotation around the y-axis on a child, and a  90 degree rotation around the y-axis on a parent, results in both visuals being rotated away to nothing.</span></span><br/> <span data-ttu-id="2cf58-141">Para obter mais informações, veja [Efeitos](effects.md).</span><span class="sxs-lookup"><span data-stu-id="2cf58-141">For more information, see [Effects](effects.md).</span></span><br/>                                                                                                                                                                                                     |



 

## <a name="security-considerations"></a><span data-ttu-id="2cf58-142">Considerações de segurança</span><span class="sxs-lookup"><span data-stu-id="2cf58-142">Security considerations</span></span>

<span data-ttu-id="2cf58-143">Os artigos a seguir fornecem diretrizes para escrever código C++ seguro.</span><span class="sxs-lookup"><span data-stu-id="2cf58-143">The following articles provide guidance for writing secure C++ code.</span></span>

-   [<span data-ttu-id="2cf58-144">Práticas recomendadas de segurança para C++</span><span class="sxs-lookup"><span data-stu-id="2cf58-144">Security Best Practices for C++</span></span>](/cpp/security/security-best-practices-for-cpp?view=vs-2019)
-   <span data-ttu-id="2cf58-145">[Padrões & práticas de segurança diretrizes para aplicativos](/previous-versions/msp-n-p/ff650760(v=pandp.10))</span><span class="sxs-lookup"><span data-stu-id="2cf58-145">[Patterns & Practices Security Guidance for Applications](/previous-versions/msp-n-p/ff650760(v=pandp.10))</span></span>

## <a name="related-topics"></a><span data-ttu-id="2cf58-146">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="2cf58-146">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2cf58-147">Como usar o DirectComposition</span><span class="sxs-lookup"><span data-stu-id="2cf58-147">How to Use DirectComposition</span></span>](how-to-use-directcomposition.md)
</dt> </dl>

 

