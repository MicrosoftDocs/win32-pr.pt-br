---
description: Para que um protocolo de transporte seja acessível por meio do Windows Sockets, ele deve ser instalado corretamente no sistema e registrado com o Windows Sockets.
ms.assetid: 0f0b22e4-81b7-43a7-bc2f-7124fa32d925
title: Configuração e instalação de transporte
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ea980740f727e39338c7568f4cc30a961b5484df
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105764501"
---
# <a name="transport-configuration-and-installation"></a><span data-ttu-id="cd03d-103">Configuração e instalação de transporte</span><span class="sxs-lookup"><span data-stu-id="cd03d-103">Transport Configuration and Installation</span></span>

<span data-ttu-id="cd03d-104">Para que um protocolo de transporte seja acessível por meio do Windows Sockets, ele deve ser instalado corretamente no sistema e registrado com o Windows Sockets.</span><span class="sxs-lookup"><span data-stu-id="cd03d-104">In order for a transport protocol to be accessible through Windows Sockets it must be properly installed on the system and registered with Windows Sockets.</span></span> <span data-ttu-id="cd03d-105">Quando um provedor de serviço de transporte é instalado invocando o programa de instalação de um fornecedor, as informações de configuração devem ser adicionadas a um banco de dados de configuração para fornecer ao Ws2 \_32.dll informações necessárias sobre o provedor de serviços.</span><span class="sxs-lookup"><span data-stu-id="cd03d-105">When a transport service provider is installed by invoking a vendor's installation program, configuration information must be added to a configuration database to give the Ws2\_32.dll required information regarding the service provider.</span></span> <span data-ttu-id="cd03d-106">O ws2 \_32.dll exporta várias funções de instalação, [**WSCInstallProvider**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallprovider) e [**WSCInstallProviderAndChains**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallproviderandchains), para o programa de instalação do fornecedor fornecer as informações relevantes sobre o provedor de serviços a ser instalado.</span><span class="sxs-lookup"><span data-stu-id="cd03d-106">The Ws2\_32.dll exports several installation functions, [**WSCInstallProvider**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallprovider) and [**WSCInstallProviderAndChains**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallproviderandchains), for the vendor's installation program to supply the relevant information about the service provider to be installed.</span></span> <span data-ttu-id="cd03d-107">Essas informações incluem, por exemplo, o nome e o caminho para a DLL do provedor de serviço e uma lista de estruturas de [**\_ informações do WSAPROTOCOL**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) às quais esse provedor pode dar suporte.</span><span class="sxs-lookup"><span data-stu-id="cd03d-107">This information includes, for example, the name and path to the service provider DLL and a list of [**WSAPROTOCOL\_INFO**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) structures that this provider can support.</span></span> <span data-ttu-id="cd03d-108">O \_32.dll Ws2 também fornece uma função, [**WSCDeinstallProvider**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscdeinstallprovider), para o programa de desinstalação de um fornecedor para remover todas as informações relevantes do banco de dados de configuração mantidas pelo32.dll de ws2 \_ .</span><span class="sxs-lookup"><span data-stu-id="cd03d-108">The Ws2\_32.dll also provides a function, [**WSCDeinstallProvider**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscdeinstallprovider), for a vendor's deinstallation program to remove all the relevant information from the configuration database maintained by the Ws2\_32.dll.</span></span> <span data-ttu-id="cd03d-109">O local exato e o formato dessas informações de configuração são privados para o \_32.dll Ws2 e só podem ser manipulados pelas funções mencionadas acima.</span><span class="sxs-lookup"><span data-stu-id="cd03d-109">The exact location and format of this configuration information is private to the Ws2\_32.dll, and can only be manipulated by the above-mentioned functions.</span></span>

<span data-ttu-id="cd03d-110">Em plataformas de 64 bits, há funções semelhantes que operam em catálogos de 32 bits e de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="cd03d-110">On 64-bit platforms, there are similar functions that operate on a 32-bit and 64-bit catalogs.</span></span> <span data-ttu-id="cd03d-111">Essas funções incluem [**WSCInstallProvider64 \_ 32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallprovider64_32), [**WSCInstallProviderAndChains64 \_ 32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallproviderandchains64_32)e [**WSCDeinstallProvider32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscdeinstallprovider32).</span><span class="sxs-lookup"><span data-stu-id="cd03d-111">These functions include [**WSCInstallProvider64\_32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallprovider64_32), [**WSCInstallProviderAndChains64\_32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscinstallproviderandchains64_32), and [**WSCDeinstallProvider32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscdeinstallprovider32).</span></span>

<span data-ttu-id="cd03d-112">A ordem na qual os provedores de serviço de transporte são instalados inicialmente controla a ordem na qual eles são enumerados por meio de [**WSCEnumProtocols**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenumprotocols) e [**WSCEnumProtocols32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenumprotocols32) na interface do provedor de serviço ou por meio de [**WSAEnumProtocols**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumprotocolsa) na interface do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="cd03d-112">The order in which transport service providers are initially installed governs the order in which they are enumerated through [**WSCEnumProtocols**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenumprotocols) and [**WSCEnumProtocols32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenumprotocols32) at the service provider interface, or through [**WSAEnumProtocols**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumprotocolsa) at the application interface.</span></span> <span data-ttu-id="cd03d-113">O mais importante é que essa ordem também governa a ordem em que os protocolos e provedores de serviço são considerados quando um cliente solicita a criação de um soquete com base em sua família de endereços, tipo e identificador de protocolo.</span><span class="sxs-lookup"><span data-stu-id="cd03d-113">More importantly, this order also governs the order in which protocols and service providers are considered when a client requests creation of a socket based on its address family, type, and protocol identifier.</span></span> <span data-ttu-id="cd03d-114">O Windows Sockets 2 inclui um applet chamado Sporder.exe que permite que o catálogo de protocolos instalados seja reordenado interativamente depois que os protocolos já tiverem sido instalados.</span><span class="sxs-lookup"><span data-stu-id="cd03d-114">Windows Sockets 2 includes an applet called Sporder.exe that allows the catalog of installed protocols to be reordered interactively after protocols have already been installed.</span></span> <span data-ttu-id="cd03d-115">O Windows Sockets 2 também inclui uma DLL auxiliar, Sporder.dll, que exporta uma interface de procedimento para reordenar protocolos.</span><span class="sxs-lookup"><span data-stu-id="cd03d-115">Windows Sockets 2 also includes an auxiliary DLL, Sporder.dll, that exports a procedural interface for reordering protocols.</span></span> <span data-ttu-id="cd03d-116">Essa interface de procedimento consiste em um único procedimento chamado [**WSCWriteProviderOrder**](/windows/desktop/api/Sporder/nf-sporder-wscwriteproviderorder).</span><span class="sxs-lookup"><span data-stu-id="cd03d-116">This procedural interface consists of a single procedure called [**WSCWriteProviderOrder**](/windows/desktop/api/Sporder/nf-sporder-wscwriteproviderorder).</span></span>

## <a name="installing-layered-protocols-and-protocol-chains"></a><span data-ttu-id="cd03d-117">Instalando protocolos em camadas e cadeias de protocolos</span><span class="sxs-lookup"><span data-stu-id="cd03d-117">Installing Layered Protocols and Protocol Chains</span></span>

<span data-ttu-id="cd03d-118">A estrutura de [**\_ informações de WSAPROTOCOL**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) fornecida com cada protocolo a ser instalado indica se o protocolo é um protocolo base, um protocolo em camadas ou uma cadeia de protocolos.</span><span class="sxs-lookup"><span data-stu-id="cd03d-118">The [**WSAPROTOCOL\_INFO**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) structure supplied with each protocol to be installed indicates whether the protocol is a base protocol, layered protocol, or protocol chain.</span></span> <span data-ttu-id="cd03d-119">O valor do parâmetro *ProtocolChain. ChainLen* é interpretado conforme mostrado na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="cd03d-119">The value of the *ProtocolChain.ChainLen* parameter is interpreted as shown in the following table.</span></span>

| <span data-ttu-id="cd03d-120">Valor</span><span class="sxs-lookup"><span data-stu-id="cd03d-120">Value</span></span> | <span data-ttu-id="cd03d-121">Significado</span><span class="sxs-lookup"><span data-stu-id="cd03d-121">Meaning</span></span>                                           |
|-------|---------------------------------------------------|
| <span data-ttu-id="cd03d-122">0</span><span class="sxs-lookup"><span data-stu-id="cd03d-122">0</span></span>     | <span data-ttu-id="cd03d-123">Protocolo em camadas.</span><span class="sxs-lookup"><span data-stu-id="cd03d-123">Layered protocol.</span></span>                                 |
| <span data-ttu-id="cd03d-124">1</span><span class="sxs-lookup"><span data-stu-id="cd03d-124">1</span></span>     | <span data-ttu-id="cd03d-125">Protocolo base (ou cadeia com apenas um componente).</span><span class="sxs-lookup"><span data-stu-id="cd03d-125">Base protocol (or chain with only one component).</span></span> |
| <span data-ttu-id="cd03d-126">> 1</span><span class="sxs-lookup"><span data-stu-id="cd03d-126">>1</span></span> | <span data-ttu-id="cd03d-127">Cadeia de protocolos.</span><span class="sxs-lookup"><span data-stu-id="cd03d-127">Protocol chain.</span></span>                                   |



 

<span data-ttu-id="cd03d-128">A instalação de cadeias de protocolo só pode ocorrer após a instalação bem-sucedida de todos os componentes constituintes (protocolos de base e protocolos em camadas).</span><span class="sxs-lookup"><span data-stu-id="cd03d-128">Installation of protocol chains can only occur after successful installation of all of the constituent components (base protocols and layered protocols).</span></span> <span data-ttu-id="cd03d-129">A estrutura de [**\_ informações de WSAPROTOCOL**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) para uma cadeia de protocolos usa o parâmetro *ProtocolChain* para descrever o comprimento da cadeia e a identidade de cada componente.</span><span class="sxs-lookup"><span data-stu-id="cd03d-129">The [**WSAPROTOCOL\_INFO**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) structure for a protocol chain uses the *ProtocolChain* parameter to describe the length of the chain and the identity of each component.</span></span> <span data-ttu-id="cd03d-130">Os protocolos individuais que compõem uma cadeia são listados em ordem na matriz ProtocolChain. ChainEntries, com o elemento inicial da matriz correspondente ao primeiro provedor em camadas.</span><span class="sxs-lookup"><span data-stu-id="cd03d-130">The individual protocols that make up a chain are listed in order in the ProtocolChain.ChainEntries array, with the zeroth element of the array corresponding to the first layered provider.</span></span> <span data-ttu-id="cd03d-131">Os protocolos são identificados por seus valores de *CatalogEntryID* , que são atribuídos pelo Ws2 \_32.dll no momento da instalação do protocolo e podem ser encontrados na estrutura de **\_ informações do WSAPROTOCOL** para cada protocolo.</span><span class="sxs-lookup"><span data-stu-id="cd03d-131">Protocols are identified by their *CatalogEntryID* values, which are assigned by the Ws2\_32.dll at protocol installation time, and can be found in the **WSAPROTOCOL\_INFO** structure for each protocol.</span></span>

<span data-ttu-id="cd03d-132">Os valores para os parâmetros restantes na estrutura de [**\_ informações WSAPROTOCOL**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) da cadeia de protocolos devem ser escolhidos para refletir os atributos e identificadores que melhor caracterizam a cadeia de protocolos como um todo.</span><span class="sxs-lookup"><span data-stu-id="cd03d-132">The values for the remaining parameters in the protocol chain's [**WSAPROTOCOL\_INFO**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) structure should be chosen to reflect the attributes and identifiers that best characterize the protocol chain as a whole.</span></span> <span data-ttu-id="cd03d-133">Ao selecionar esses valores, os desenvolvedores devem ter em mente que as comunicações sobre cadeias de protocolos só podem ocorrer quando ambos os pontos de extremidade têm cadeias de protocolos compatíveis instaladas e esses aplicativos devem ser capazes de reconhecer a estrutura de **\_ informações WSAPROTOCOL** correspondente.</span><span class="sxs-lookup"><span data-stu-id="cd03d-133">When selecting these values, developers should bear in mind that communications over protocol chains can only occur when both endpoints have compatible protocol chains installed, and that applications must be able to recognize the corresponding **WSAPROTOCOL\_INFO** structure.</span></span>

<span data-ttu-id="cd03d-134">Quando um protocolo base é instalado, não é necessário fazer nenhuma entrada na matriz *ProtocolChain. ChainEntries* .</span><span class="sxs-lookup"><span data-stu-id="cd03d-134">When a base protocol is installed, it is not necessary to make any entries in the *ProtocolChain.ChainEntries* array.</span></span> <span data-ttu-id="cd03d-135">Ele é compreendido implicitamente que o único componente dessa cadeia já está identificado no parâmetro *CatalogEntryID* da mesma estrutura de [**\_ informações de WSAPROTOCOL**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) .</span><span class="sxs-lookup"><span data-stu-id="cd03d-135">It is implicitly understood that the sole component of this chain is already identified in the *CatalogEntryID* parameter of the same [**WSAPROTOCOL\_INFO**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) structure.</span></span> <span data-ttu-id="cd03d-136">Observe também que as cadeias de protocolos podem não incluir várias instâncias do mesmo protocolo em camadas.</span><span class="sxs-lookup"><span data-stu-id="cd03d-136">Also note that protocol chains may not include multiple instances of the same layered protocol.</span></span>

 

 
