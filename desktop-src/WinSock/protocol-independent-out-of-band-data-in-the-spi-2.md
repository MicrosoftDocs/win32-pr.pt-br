---
description: Os dados fora de banda (OOB) são um canal de transmissão logicamente independente associado a um par de soquetes de fluxo conectados.
ms.assetid: 30f667cd-5be9-45f2-9d55-bff04834078f
title: Dados de out-of-Band independentes de protocolo no SPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b53e5c7c5c8c8ad7a5985ec101dd157370c5f32f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104501676"
---
# <a name="protocol-independentout-of-band-data-in-the-spi"></a><span data-ttu-id="39e26-103">Dados de out-of-Band independentes de protocolo no SPI</span><span class="sxs-lookup"><span data-stu-id="39e26-103">Protocol IndependentOut-of-Band Data in the SPI</span></span>

<span data-ttu-id="39e26-104">Os dados fora de banda (OOB) são um canal de transmissão logicamente independente associado a um par de soquetes de fluxo conectados.</span><span class="sxs-lookup"><span data-stu-id="39e26-104">Out-of-Band (OOB) data is a logically independent transmission channel associated with a pair of connected stream sockets.</span></span> <span data-ttu-id="39e26-105">Os dados OOB podem ser entregues ao usuário independentemente dos dados normais.</span><span class="sxs-lookup"><span data-stu-id="39e26-105">OOB data may be delivered to the user independently of normal data.</span></span> <span data-ttu-id="39e26-106">A abstração define que os recursos de dados OOB devem dar suporte à entrega confiável de pelo menos um bloco de dados OOB de cada vez.</span><span class="sxs-lookup"><span data-stu-id="39e26-106">The abstraction defines that the OOB data facilities must support the reliable delivery of at least one OOB data block at a time.</span></span> <span data-ttu-id="39e26-107">Esse bloco de dados pode conter pelo menos um byte de dados, e pelo menos um bloco de dados OOB pode estar com entrega pendente para o usuário a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="39e26-107">This data block may contain at least one byte of data, and at least one OOB data block may be pending delivery to the user at any one time.</span></span> <span data-ttu-id="39e26-108">Para protocolos de comunicação que dão suporte à sinalização em banda (ou seja, TCP, em que os dados urgentes são entregues em sequência com os dados normais), o sistema normalmente extrai os dados OOB do fluxo de dados normal e os armazena separadamente (deixando uma lacuna no fluxo de dados normal).</span><span class="sxs-lookup"><span data-stu-id="39e26-108">For communications protocols which support in-band signaling (that is, TCP, where the urgent data is delivered in sequence with the normal data), the system normally extracts the OOB data from the normal data stream and stores it separately (leaving a gap in the normal data stream).</span></span> <span data-ttu-id="39e26-109">Isso permite que os usuários escolham entre receber os dados OOB em ordem e recebê-los fora de sequência sem precisar armazenar em buffer todos os dados intermediários.</span><span class="sxs-lookup"><span data-stu-id="39e26-109">This allows users to choose between receiving the OOB data in order and receiving it out of sequence without having to buffer all the intervening data.</span></span> <span data-ttu-id="39e26-110">É possível inspecionar dados OOB.</span><span class="sxs-lookup"><span data-stu-id="39e26-110">It is possible to peek at OOB data.</span></span>

<span data-ttu-id="39e26-111">Um usuário pode determinar se há algum dado OOB aguardando para ser lido usando a função [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)) (SIOCATMARK).</span><span class="sxs-lookup"><span data-stu-id="39e26-111">A user can determine if there is any OOB data waiting to be read using the [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)) (SIOCATMARK) function.</span></span> <span data-ttu-id="39e26-112">Para protocolos em que o conceito da posição do bloco de dados OOB dentro do fluxo de dados normal é significativo (ou seja, TCP), um provedor de serviços do Windows Sockets manterá um marcador conceitual que indica a posição do último byte de dados OOB dentro do fluxo de dados normal.</span><span class="sxs-lookup"><span data-stu-id="39e26-112">For protocols where the concept of the position of the OOB data block within the normal data stream is meaningful (that is, TCP), a Windows Sockets service provider will maintain a conceptual marker indicating the position of the last byte of OOB data within the normal data stream.</span></span> <span data-ttu-id="39e26-113">Isso não é necessário para a implementação da funcionalidade **WSPIoctl** (SIOCATMARK) — a presença ou a ausência de dados OOB é tudo o que é necessário.</span><span class="sxs-lookup"><span data-stu-id="39e26-113">This is not necessary for the implementation of the **WSPIoctl** (SIOCATMARK) functionality — the presence or absence of OOB data is all that is required.</span></span>

<span data-ttu-id="39e26-114">Para protocolos em que o conceito da posição do bloco de dados OOB dentro do fluxo de dados normal é significativo, um aplicativo pode preferir processar dados fora de banda embutidos, como parte do fluxo de dados normal.</span><span class="sxs-lookup"><span data-stu-id="39e26-114">For protocols where the concept of the position of the OOB data block within the normal data stream is meaningful an application may prefer to process out-of-band data inline, as part of the normal data stream.</span></span> <span data-ttu-id="39e26-115">Isso é feito definindo a opção socket de modo que \_ OOBINLINE (consulte a seção [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85))).</span><span class="sxs-lookup"><span data-stu-id="39e26-115">This is achieved by setting the socket option SO\_OOBINLINE (see section [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85))).</span></span> <span data-ttu-id="39e26-116">Para outros protocolos em que os blocos de dados OOB são verdadeiramente independentes do fluxo de dados normal, a tentativa de definir \_ OOBINLINE resultará em um erro.</span><span class="sxs-lookup"><span data-stu-id="39e26-116">For other protocols where the OOB data blocks are truly independent of the normal data stream, attempting to set SO\_OOBINLINE will result in an error.</span></span> <span data-ttu-id="39e26-117">Um aplicativo pode usar o comando SIOCATMARK WSPIoctl para determinar se há algum dado OOB Não lido antes da marca.</span><span class="sxs-lookup"><span data-stu-id="39e26-117">An application can use the SIOCATMARK WSPIoctl command to determine whether there is any unread OOB data preceding the mark.</span></span> <span data-ttu-id="39e26-118">Por exemplo, ele pode usar isso para ressincronizar com seu par, garantindo que todos os dados até a marca no fluxo de dados sejam descartados quando apropriado.</span><span class="sxs-lookup"><span data-stu-id="39e26-118">For example, it might use this to resynchronize with its peer by ensuring that all data up to the mark in the data stream is discarded when appropriate.</span></span>

<span data-ttu-id="39e26-119">Com o \_ OOBINLINE desabilitado (por padrão):</span><span class="sxs-lookup"><span data-stu-id="39e26-119">With SO\_OOBINLINE disabled (by default):</span></span>

-   <span data-ttu-id="39e26-120">O provedor de serviços Winsock notifica um cliente sobre um evento de OOB do FD \_ , se o cliente estiver registrado para notificação com [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)), exatamente da mesma forma que a leitura de FD \_ é usada para notificar a presença de dados normais.</span><span class="sxs-lookup"><span data-stu-id="39e26-120">The Winsock service provider notifies a client of an FD\_OOB event, if the client registered for notification with [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)), in exactly the same way FD\_READ is used to notify of the presence of normal data.</span></span> <span data-ttu-id="39e26-121">Ou seja, FD \_ OOB é Postado quando dados OOB chegam e não havia dados OOB anteriormente enfileirados, e também quando os dados são lidos usando o sinalizador de OOB de MSG \_ e alguns dados OOB continuam sendo lidos depois que a operação de leitura é retornada.</span><span class="sxs-lookup"><span data-stu-id="39e26-121">That is, FD\_OOB is posted when OOB data arrives and there was no OOB data previously queued, and also when data is read using the MSG\_OOB flag, and some OOB data remains to be read after the read operation has returned.</span></span> <span data-ttu-id="39e26-122">\_As mensagens de leitura do FD não são postadas para dados OOB.</span><span class="sxs-lookup"><span data-stu-id="39e26-122">FD\_READ messages are not posted for OOB data.</span></span>
-   <span data-ttu-id="39e26-123">O provedor de serviço Winsock retornará de [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) com o conjunto de soquetes *exceptfds* apropriado se os dados OOB estiverem na fila no soquete.</span><span class="sxs-lookup"><span data-stu-id="39e26-123">The Winsock service provider returns from [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) with the appropriate *exceptfds* socket set if OOB data is queued on the socket.</span></span>
-   <span data-ttu-id="39e26-124">O cliente pode chamar [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) com MSG \_ OOB para ler o bloco de dados urgentes a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="39e26-124">The client can call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) with MSG\_OOB to read the urgent data block at any time.</span></span> <span data-ttu-id="39e26-125">O bloco de dados OOB salta a fila.</span><span class="sxs-lookup"><span data-stu-id="39e26-125">The block of OOB data jumps the queue.</span></span>
-   <span data-ttu-id="39e26-126">O cliente pode chamar [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) sem \_ o OOB de MSG para ler o fluxo de dados normal.</span><span class="sxs-lookup"><span data-stu-id="39e26-126">The client can call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) without MSG\_OOB to read the normal data stream.</span></span> <span data-ttu-id="39e26-127">O bloco de dados OOB Não será exibido no fluxo de dados com dados normais.</span><span class="sxs-lookup"><span data-stu-id="39e26-127">The OOB data block will not appear in the data stream with normal data.</span></span> <span data-ttu-id="39e26-128">Se os dados OOB permanecerem após qualquer chamada para **WSPRecv**, o provedor de serviços notificará o cliente com FD \_ OOB ou por meio de *exceptfds* ao usar o [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="39e26-128">If OOB data remains after any call to **WSPRecv**, the service provider notifies the client with FD\_OOB or through *exceptfds* when using [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)).</span></span>
-   <span data-ttu-id="39e26-129">Para protocolos em que os dados OOB têm uma posição dentro do fluxo de dados normal, uma única operação [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) não abrange essa posição.</span><span class="sxs-lookup"><span data-stu-id="39e26-129">For protocols where the OOB data has a position within the normal data stream, a single [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) operation will not span that position.</span></span> <span data-ttu-id="39e26-130">Um **WSPRecv** retornará os dados normais antes da marca e um segundo **WSPRecv** será necessário para começar a ler os dados após a marca.</span><span class="sxs-lookup"><span data-stu-id="39e26-130">One **WSPRecv** will return the normal data before the mark, and a second **WSPRecv** is required to begin reading data after the mark.</span></span>

<span data-ttu-id="39e26-131">Com o \_ OOBINLINE habilitado:</span><span class="sxs-lookup"><span data-stu-id="39e26-131">With SO\_OOBINLINE enabled:</span></span>

-   <span data-ttu-id="39e26-132">\_As mensagens OOB do FD não são postadas para dados OOB – para fins das funções [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) e [**WSPASYNCSELECT**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) , os dados OOB são tratados como dados normais e indicados pela configuração do soquete no *readfds* ou pelo envio de uma mensagem de leitura FD, \_ respectivamente.</span><span class="sxs-lookup"><span data-stu-id="39e26-132">FD\_OOB messages are not posted for OOB data — for the purpose of the [**WSPSelect**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) and [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) functions, OOB data is treated as normal data, and indicated by setting the socket in *readfds* or by sending an FD\_READ message respectively.</span></span>
-   <span data-ttu-id="39e26-133">O cliente pode não chamar [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) com o sinalizador de mensagem \_ OOB definido para ler o bloco de dados OOB — o código de erro WSAEINVAL será retornado.</span><span class="sxs-lookup"><span data-stu-id="39e26-133">The client may not call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) with the MSG\_OOB flag set to read the OOB data block — the error code WSAEINVAL will be returned.</span></span>
-   <span data-ttu-id="39e26-134">O cliente pode chamar [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) sem o conjunto de sinalizadores de OOB de MSG \_ .</span><span class="sxs-lookup"><span data-stu-id="39e26-134">The client can call [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) without the MSG\_OOB flag set.</span></span> <span data-ttu-id="39e26-135">Todos os dados OOB serão entregues em sua ordem correta dentro do fluxo de dados normal.</span><span class="sxs-lookup"><span data-stu-id="39e26-135">Any OOB data will be delivered in its correct order within the normal data stream.</span></span> <span data-ttu-id="39e26-136">Os dados OOB nunca serão misturados com dados normais – deve haver três solicitações de leitura para passar os dados OOB.</span><span class="sxs-lookup"><span data-stu-id="39e26-136">OOB data will never be mixed with normal data — there must be three read requests to get past the OOB data.</span></span> <span data-ttu-id="39e26-137">O primeiro retorna os dados normais antes do bloco de dados OOB, o segundo retorna os dados OOB, o terceiro retorna os dados normais que seguem os dados OOB.</span><span class="sxs-lookup"><span data-stu-id="39e26-137">The first returns the normal data prior to the OOB data block, the second returns the OOB data, the third returns the normal data following the OOB data.</span></span> <span data-ttu-id="39e26-138">Em outras palavras, os limites de bloco de dados OOB são preservados.</span><span class="sxs-lookup"><span data-stu-id="39e26-138">In other words, the OOB data block boundaries are preserved.</span></span>

<span data-ttu-id="39e26-139">A rotina [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) é particularmente adequada para lidar com a notificação da presença de dados OOB quando \_ OOBINLINE é desativado.</span><span class="sxs-lookup"><span data-stu-id="39e26-139">The [**WSPAsyncSelect**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) routine is particularly well suited to handling notification of the presence of OOB data when SO\_OOBINLINE is off.</span></span>

 

 
