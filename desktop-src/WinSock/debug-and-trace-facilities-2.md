---
description: Recursos de depuração e rastreamento e Windows Sockets 2.
ms.assetid: eb29fc21-92d6-4471-860a-fd1c531686f6
title: Recursos de depuração e rastreamento
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7288c6b4d72a7a375ee16da23a25b0a04a46df91
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105794592"
---
# <a name="debug-and-trace-facilities"></a><span data-ttu-id="07551-103">Recursos de depuração e rastreamento</span><span class="sxs-lookup"><span data-stu-id="07551-103">Debug and Trace Facilities</span></span>

<span data-ttu-id="07551-104">Os desenvolvedores de aplicativos Windows Sockets 2 precisam isolar bugs em:</span><span class="sxs-lookup"><span data-stu-id="07551-104">Windows Sockets 2 application developers need to isolate bugs in:</span></span>

-   <span data-ttu-id="07551-105">O aplicativo.</span><span class="sxs-lookup"><span data-stu-id="07551-105">The application.</span></span>
-   <span data-ttu-id="07551-106">O *Ws2 \_32.dll* ou uma das DLLs de Shim de compatibilidade.</span><span class="sxs-lookup"><span data-stu-id="07551-106">The *Ws2\_32.dll* or one of the compatibility shim DLLs.</span></span>
-   <span data-ttu-id="07551-107">O provedor de serviços.</span><span class="sxs-lookup"><span data-stu-id="07551-107">The service provider.</span></span>

<span data-ttu-id="07551-108">O Windows Sockets 2 atende a essa necessidade por meio de vários componentes e recursos:</span><span class="sxs-lookup"><span data-stu-id="07551-108">Windows Sockets 2 addresses this need through several components and features:</span></span>

-   <span data-ttu-id="07551-109">Suporte integrado para rastreamento de Winsock no Windows Vista e posterior.</span><span class="sxs-lookup"><span data-stu-id="07551-109">Integrated support for Winsock tracing on Windows Vista and later.</span></span>
-   <span data-ttu-id="07551-110">Uma versão de depuração especialmente elaborada do *Ws2 \_32.dll* no Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="07551-110">A specially devised debug version of the *Ws2\_32.dll* on Windows Vista.</span></span>
-   <span data-ttu-id="07551-111">Um recurso de depuração e rastreamento primitivo separado para uso no Windows Server 2003 e no Windows XP.</span><span class="sxs-lookup"><span data-stu-id="07551-111">A separate primitive debug and trace facility for use on Windows Server 2003 and Windows XP.</span></span>

## <a name="winsock-tracing-using-event-tracing-for-windows"></a><span data-ttu-id="07551-112">Rastreamento de Winsock usando o rastreamento de eventos para Windows</span><span class="sxs-lookup"><span data-stu-id="07551-112">Winsock Tracing using Event Tracing for Windows</span></span>

<span data-ttu-id="07551-113">O suporte integrado para rastreamento de Winsock usando o ETW (rastreamento de eventos para Windows) está incluído no Windows Vista e versões posteriores.</span><span class="sxs-lookup"><span data-stu-id="07551-113">Integrated support for Winsock tracing using Event Tracing for Windows (ETW) is included on Windows Vista and later.</span></span> <span data-ttu-id="07551-114">Esse é o método preferencial para rastrear chamadas Winsock no Windows Vista e versões posteriores.</span><span class="sxs-lookup"><span data-stu-id="07551-114">This is the preferred method for tracing Winsock calls on Windows Vista and later.</span></span> <span data-ttu-id="07551-115">O rastreamento de Winsock usando o ETW é leve e funciona em versões comerciais do Windows.</span><span class="sxs-lookup"><span data-stu-id="07551-115">Winsock tracing using ETW is lightweight and works on retail versions of Windows.</span></span> <span data-ttu-id="07551-116">Nenhum software ou componente adicional é necessário.</span><span class="sxs-lookup"><span data-stu-id="07551-116">No additional software or components are required.</span></span> <span data-ttu-id="07551-117">Esse recurso só precisa ser habilitado no Windows Vista e posterior.</span><span class="sxs-lookup"><span data-stu-id="07551-117">This feature just needs to be enabled on Windows Vista and later.</span></span> <span data-ttu-id="07551-118">Para obter informações mais detalhadas, consulte os tópicos de [rastreamento do Winsock](winsock-tracing.md) .</span><span class="sxs-lookup"><span data-stu-id="07551-118">For more detailed information, see the [Winsock Tracing](winsock-tracing.md) topics.</span></span>

## <a name="using-a-debug-version-of-ws2_32dll"></a><span data-ttu-id="07551-119">Usando uma versão de depuração do ws2 \_32.dll</span><span class="sxs-lookup"><span data-stu-id="07551-119">Using a Debug Version of Ws2\_32.dll</span></span>

<span data-ttu-id="07551-120">A combinação de uma versão de depuração do *\_32.dlldo ws2* no Windows Vista e no rastreamento do Winsock permite que todas as chamadas de procedimento na API ou SPI do Windows Sockets 2 sejam monitoradas e, em certa medida, controladas.</span><span class="sxs-lookup"><span data-stu-id="07551-120">The combination of a debug version of the *Ws2\_32.dll* on Windows Vista and Winsock tracing allows all procedure calls across the Windows Sockets 2 API or SPI to be monitored and, to some extent, controlled.</span></span>

<span data-ttu-id="07551-121">Se uma versão do Microsoft Windows Software Development Kit (SDK) para Windows Vista estiver instalada no local padrão, as versões de depuração do *\_32.dllWs2* para várias arquiteturas estarão localizadas na seguinte pasta:</span><span class="sxs-lookup"><span data-stu-id="07551-121">If a version of the Microsoft Windows Software Development Kit (SDK) for Windows Vista is installed to the default location, debug versions of the *Ws2\_32.dll* for various architectures are located under the following folder:</span></span>

<span data-ttu-id="07551-122">**C: \\ arquivos de programas \\ Microsoft SDKs \\ Windows \\ v 6.0 \\ NoRedist**</span><span class="sxs-lookup"><span data-stu-id="07551-122">**C:\\Program Files\\Microsoft SDKs\\Windows\\v6.0\\NoRedist**</span></span>

<span data-ttu-id="07551-123">Uma versão verificada do *\_32.dllWs2* que corresponde à versão do Windows e o Service Pack que você está testando deve ser usada.</span><span class="sxs-lookup"><span data-stu-id="07551-123">A checked version of the *Ws2\_32.dll* that matches the version of Windows and the Service Pack you are testing on should be used.</span></span> <span data-ttu-id="07551-124">Lembre-se de que os patches de segurança podem ter sido aplicados que atualizaram o *Ws2 \_32.dll* no sistema de teste.</span><span class="sxs-lookup"><span data-stu-id="07551-124">Be aware that security patches may have been applied that updated the *Ws2\_32.dll* on your test system.</span></span> <span data-ttu-id="07551-125">O SDK do Windows para o Windows Vista e as assinaturas de DVD/CD do Software Development Kit (SDK) anteriores incluem compilações marcadas para as várias versões do Windows.</span><span class="sxs-lookup"><span data-stu-id="07551-125">The Windows SDK for Windows Vista and the earlier Platform Software Development Kit (SDK) DVD/CD subscriptions include checked builds for the various versions of Windows.</span></span> <span data-ttu-id="07551-126">Você deve usar a mesma versão verificada do *\_32.dllWs2* como a versão comercial que foi usada no sistema que está sendo testado.</span><span class="sxs-lookup"><span data-stu-id="07551-126">You should use the same checked version of the *Ws2\_32.dll* as the retail version that was used on the system being tested.</span></span> <span data-ttu-id="07551-127">Observe também que o comportamento em execução em uma compilação verificada não será o mesmo que executar com uma compilação de varejo.</span><span class="sxs-lookup"><span data-stu-id="07551-127">Note also that behavior running under a checked build will not be the same as running with a retail build.</span></span>

<span data-ttu-id="07551-128">**Observação**  O SDK do Windows para Windows Server 2008 e posterior não inclui mais versões de depuração especiais do *\_32.dllWs2*.</span><span class="sxs-lookup"><span data-stu-id="07551-128">**Note**  The Windows SDK for Windows Server 2008 and later no longer includes special debug versions of the *Ws2\_32.dll*.</span></span> <span data-ttu-id="07551-129">Os desenvolvedores devem usar o rastreamento do Winsock usando o ETW, já que esse recurso não requer compilações de depuração.</span><span class="sxs-lookup"><span data-stu-id="07551-129">Developers should use Winsock tracing using ETW instead, since this feature does not require debug builds.</span></span>

## <a name="winsock-debug-and-trace-facility-on-windows-server-2003-and-windows-xp"></a><span data-ttu-id="07551-130">Recurso de depuração e rastreamento do Winsock no Windows Server 2003 e no Windows XP</span><span class="sxs-lookup"><span data-stu-id="07551-130">Winsock Debug and Trace Facility on Windows Server 2003 and Windows XP</span></span>

<span data-ttu-id="07551-131">Versões mais antigas do Windows anteriores ao Windows 8 e ao Windows Server 2012 dão suporte a um recurso de depuração e rastreamento primitivos separado que é incluído como um exemplo com o SDK do Windows e o SDK da plataforma mais antigo.</span><span class="sxs-lookup"><span data-stu-id="07551-131">Older versions of Windows prior to Windows 8 and Windows Server 2012 support a separate primitive debug and trace facility that is included as a sample with the Windows SDK and the older Platform SDK.</span></span> <span data-ttu-id="07551-132">O recurso de depuração/rastreamento só deve ser usado no Windows Server 2003 e no Windows XP em que não há suporte para o rastreamento de Winsock.</span><span class="sxs-lookup"><span data-stu-id="07551-132">The debug/trace facility should only be used on Windows Server 2003 and Windows XP where Winsock tracing is not supported.</span></span>

<span data-ttu-id="07551-133">Se o SDK do Windows para o Windows 7 for instalado no local padrão, esse recurso de rastreamento de Winsock primitivo será instalado na seguinte pasta:</span><span class="sxs-lookup"><span data-stu-id="07551-133">If the Windows SDK for Windows 7 is installed to the default location, this primitive Winsock tracing feature is installed in the following folder:</span></span>

<span data-ttu-id="07551-134">**C: \\ arquivos de programas \\ Microsoft SDKs \\ Windows \\ v 7.0 \\ amostras \\ NetDs \\ Winsock \\ dt \_ dll**</span><span class="sxs-lookup"><span data-stu-id="07551-134">**C:\\Program Files\\Microsoft SDKs\\Windows\\v7.0\\Samples\\NetDs\\winsock\\dt\_dll**</span></span>

<span data-ttu-id="07551-135">O arquivo de *DbgSpec.doc* nesta pasta fornece documentação sobre esse recurso de rastreamento primitivo.</span><span class="sxs-lookup"><span data-stu-id="07551-135">The *DbgSpec.doc* file in this folder provides documentation on this primitive trace facility.</span></span> <span data-ttu-id="07551-136">O código de exemplo na \_ pasta DLL de DT precisa ser compilado para usar esse recurso.</span><span class="sxs-lookup"><span data-stu-id="07551-136">The sample code in the dt\_dll folder needs to be compiled to use this facility.</span></span> <span data-ttu-id="07551-137">Os desenvolvedores são livres para usar o código-fonte para desenvolver versões da DLL de depuração/rastreamento que atendam às suas necessidades específicas.</span><span class="sxs-lookup"><span data-stu-id="07551-137">Developers are free to use the source code to develop versions of the debug/trace DLL that meet their specific needs.</span></span>

<span data-ttu-id="07551-138">Observe que esse recurso de rastreamento de Winsock primitivo funcionará apenas com a versão de depuração do *Ws2 \_32.dll* instalada.</span><span class="sxs-lookup"><span data-stu-id="07551-138">Note that this primitive Winsock trace feature will only work with the debug version of *Ws2\_32.dll* installed.</span></span> <span data-ttu-id="07551-139">Portanto, você precisará obter uma versão verificada do *\_32.dllWs2* que corresponde à versão do Windows e ao Service Pack no qual você está testando.</span><span class="sxs-lookup"><span data-stu-id="07551-139">So you will need to get a checked version of the *Ws2\_32.dll* that matches the version of Windows and the Service Pack you are testing on.</span></span>

<span data-ttu-id="07551-140">Uma limitação desse recurso de rastreamento de DLL do DT primitivo \_ é que o código de exemplo usa um bloqueio global (seção crítica) para cada chamada de função do Winsock.</span><span class="sxs-lookup"><span data-stu-id="07551-140">A limitation of this primitive dt\_dll trace facility is that the sample code uses a global lock (critical section) for each Winsock function call.</span></span> <span data-ttu-id="07551-141">Portanto, esse recurso não é útil para lidar com condições de corrida.</span><span class="sxs-lookup"><span data-stu-id="07551-141">So this facility is not useful in dealing with race conditions.</span></span> <span data-ttu-id="07551-142">O código de exemplo precisaria ser consideravelmente reescrito para tornar esse recurso de rastreamento útil para lidar com os problemas de Winsock mais reais (substituindo os bloqueios globais).</span><span class="sxs-lookup"><span data-stu-id="07551-142">The sample code would need to be substantially rewritten to make this trace facility useful for dealing with most real Winsock problems (replacing the global locks).</span></span> <span data-ttu-id="07551-143">Este código de exemplo permite que os desenvolvedores rastreiem as chamadas de procedimento, os procedimentos retornados, os valores de parâmetro e os valores de retorno.</span><span class="sxs-lookup"><span data-stu-id="07551-143">This sample code does allow developers to trace the procedure calls, procedure returns, parameter values, and return values.</span></span>

<span data-ttu-id="07551-144">Os desenvolvedores podem usar esse mecanismo primitivo para rastrear chamadas de procedimento, retornos de procedimento, valores de parâmetro e valores de retorno.</span><span class="sxs-lookup"><span data-stu-id="07551-144">Developers can use this primitive mechanism to trace procedure calls, procedure returns, parameter values, and return values.</span></span> <span data-ttu-id="07551-145">Valores de parâmetro e valores de retorno podem ser alterados em retorno de procedimento ou chamada de procedimento.</span><span class="sxs-lookup"><span data-stu-id="07551-145">Parameter values and return values can be altered on procedure call or procedure return.</span></span> <span data-ttu-id="07551-146">Se desejado, uma chamada de procedimento pode ser impedida ou redirecionada.</span><span class="sxs-lookup"><span data-stu-id="07551-146">If desired, a procedure call can be prevented or redirected.</span></span> <span data-ttu-id="07551-147">Com acesso a esse nível de informações e controle, um desenvolvedor é capaz de isolar melhor um problema no aplicativo, *Ws2 \_32.dll* ou provedor de serviços.</span><span class="sxs-lookup"><span data-stu-id="07551-147">With access to this level of information and control, a developer is better able to isolate a problem in the application, *Ws2\_32.dll*, or service provider.</span></span>

## <a name="related-topics"></a><span data-ttu-id="07551-148">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="07551-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="07551-149">Rastreamento de Winsock</span><span class="sxs-lookup"><span data-stu-id="07551-149">Winsock Tracing</span></span>](winsock-tracing.md)
</dt> </dl>

 

 



