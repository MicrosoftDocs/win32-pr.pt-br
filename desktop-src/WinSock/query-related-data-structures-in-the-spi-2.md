---
description: A estrutura WSAQUERYSET é usada para formar consultas para a função NSPLookupServiceBegin e usada para fornecer resultados de consulta para a função NSPLookupServiceNext.
ms.assetid: 017b5828-bc6e-42b7-aba7-21648b2dd707
title: Query-Related estruturas de dados no SPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 57ce5a7016bd2ad96f464137177036b470c64a95
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104559705"
---
# <a name="query-related-data-structures-in-the-spi"></a><span data-ttu-id="f1a60-103">Query-Related estruturas de dados no SPI</span><span class="sxs-lookup"><span data-stu-id="f1a60-103">Query-Related Data Structures in the SPI</span></span>

<span data-ttu-id="f1a60-104">A estrutura [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) é usada para formar consultas para [**NSPLookupServiceBegin**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin)e é usada para fornecer resultados de consulta para [**NSPLookupServiceNext**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext).</span><span class="sxs-lookup"><span data-stu-id="f1a60-104">The [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure is used to form queries for [**NSPLookupServiceBegin**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin), and used to deliver query results for [**NSPLookupServiceNext**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext).</span></span> <span data-ttu-id="f1a60-105">É uma estrutura complexa porque contém ponteiros para várias outras estruturas, algumas das quais a referência ainda tem outras estruturas.</span><span class="sxs-lookup"><span data-stu-id="f1a60-105">It is a complex structure because it contains pointers to several other structures, some of which reference still other structures.</span></span> <span data-ttu-id="f1a60-106">A relação entre **WSAQUERYSET** e as estruturas referenciadas é ilustrada da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="f1a60-106">The relationship between **WSAQUERYSET** and the structures it references is illustrated as follows:</span></span>

![estruturas WSAQUERYSET](images/ovrvw3-2.png)

<span data-ttu-id="f1a60-108">Na estrutura [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) , a maioria dos membros é auto-explicativa, mas alguns merecem uma explicação adicional.</span><span class="sxs-lookup"><span data-stu-id="f1a60-108">Within the [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure, most of the members are self explanatory, but some deserve additional explanation.</span></span> <span data-ttu-id="f1a60-109">O **dwSize** será preenchido com sizeof ( **WSAQUERYSET**) e pode ser usado por provedores de namespace para detectar e se adaptar a versões diferentes da estrutura **WSAQUERYSET** que podem aparecer.</span><span class="sxs-lookup"><span data-stu-id="f1a60-109">The **dwSize** will be filled in with sizeof( **WSAQUERYSET**), and can be used by namespace providers to detect and adapt to different versions of the **WSAQUERYSET** structure that may appear.</span></span>

<span data-ttu-id="f1a60-110">O membro **dwOutputFlags** é usado por um provedor de namespace para fornecer dados adicionais sobre os resultados da consulta.</span><span class="sxs-lookup"><span data-stu-id="f1a60-110">The **dwOutputFlags** member is used by a namespace provider to provide additional data about query results.</span></span> <span data-ttu-id="f1a60-111">Para obter mais informações, consulte [**NSPLookupServiceNext**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext).</span><span class="sxs-lookup"><span data-stu-id="f1a60-111">For more information, see [**NSPLookupServiceNext**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicenext).</span></span>

<span data-ttu-id="f1a60-112">A estrutura [**WSAECOMPARATOR**](/windows/desktop/api/Winsock2/ne-winsock2-wsaecomparator) referenciada por **lpversion** é usada para a restrição de consulta e os resultados.</span><span class="sxs-lookup"><span data-stu-id="f1a60-112">The [**WSAECOMPARATOR**](/windows/desktop/api/Winsock2/ne-winsock2-wsaecomparator) structure referenced by **lpversion** is used for both query constraint and results.</span></span> <span data-ttu-id="f1a60-113">Para consultas, o membro **DW** indica a versão desejada do serviço.</span><span class="sxs-lookup"><span data-stu-id="f1a60-113">For queries, the **dwVersion** member indicates the desired version of the service.</span></span> <span data-ttu-id="f1a60-114">O membro **ecHow** é um tipo enumerado que especifica como a comparação será feita.</span><span class="sxs-lookup"><span data-stu-id="f1a60-114">The **ecHow** member is an enumerated type which specifies how the comparison will be made.</span></span> <span data-ttu-id="f1a60-115">As opções são COMP \_ Equals, que requer que uma correspondência exata na versão ocorra, ou comp less, que \_ especifica que o número de versão do serviço não é menor que o valor de **DW**.</span><span class="sxs-lookup"><span data-stu-id="f1a60-115">The choices are COMP\_EQUALS which requires that an exact match in version occurs, or COMP\_NOTLESS which specifies that the service's version number be no less than the value of **dwVersion**.</span></span>

<span data-ttu-id="f1a60-116">A interpretação de **dwNameSpace** e **lpNSProviderId** depende de como a estrutura está sendo usada e é descrita mais detalhadamente nas descrições de função individuais que utilizam essa estrutura.</span><span class="sxs-lookup"><span data-stu-id="f1a60-116">The interpretation of **dwNameSpace** and **lpNSProviderId** depends upon how the structure is being used and is described further in the individual function descriptions that utilize this structure.</span></span>

<span data-ttu-id="f1a60-117">O membro **lpszContext** se aplica a namespaces hierárquicos e especifica o ponto de partida de uma consulta ou o local dentro da hierarquia em que o serviço reside.</span><span class="sxs-lookup"><span data-stu-id="f1a60-117">The **lpszContext** member applies to hierarchical namespaces, and specifies the starting point of a query or the location within the hierarchy where the service resides.</span></span> <span data-ttu-id="f1a60-118">As regras gerais são:</span><span class="sxs-lookup"><span data-stu-id="f1a60-118">The general rules are:</span></span>

-   <span data-ttu-id="f1a60-119">Um valor **nulo**, em branco (""), iniciará a pesquisa no contexto padrão.</span><span class="sxs-lookup"><span data-stu-id="f1a60-119">A value of **NULL**, blank ("") will start the search at the default context.</span></span>
-   <span data-ttu-id="f1a60-120">Um valor de " \\ " inicia a pesquisa na parte superior do namespace.</span><span class="sxs-lookup"><span data-stu-id="f1a60-120">A value of "\\" starts the search at the top of the namespace.</span></span>
-   <span data-ttu-id="f1a60-121">Qualquer outro valor inicia a pesquisa no ponto designado.</span><span class="sxs-lookup"><span data-stu-id="f1a60-121">Any other value starts the search at the designated point.</span></span>

<span data-ttu-id="f1a60-122">Os provedores que não dão suporte à contenção poderão retornar um erro se algo diferente de "" ou " \\ " for especificado.</span><span class="sxs-lookup"><span data-stu-id="f1a60-122">Providers that do not support containment may return an error if anything other than "" or "\\" is specified.</span></span> <span data-ttu-id="f1a60-123">Provedores que dão suporte a contenção limitada, como grupos, devem aceitar "", " \\ " ou um ponto designado.</span><span class="sxs-lookup"><span data-stu-id="f1a60-123">Providers that support limited containment, such as groups, should accept "", '\\", or a designated point.</span></span> <span data-ttu-id="f1a60-124">Contextos são específicos do namespace.</span><span class="sxs-lookup"><span data-stu-id="f1a60-124">Contexts are namespace specific.</span></span> <span data-ttu-id="f1a60-125">Se **dwNameSpace** for NS \_ All, somente "" ou " \\ " deverá ser passado como o contexto porque eles são reconhecidos por todos os namespaces.</span><span class="sxs-lookup"><span data-stu-id="f1a60-125">If **dwNameSpace** is NS\_ALL, then only "" or "\\" should be passed as the context because these are recognized by all namespaces.</span></span>

<span data-ttu-id="f1a60-126">O membro **lpszQueryString** é usado para fornecer informações de consulta adicionais específicas de namespace, como uma cadeia de caracteres que descreve um serviço conhecido e um nome de protocolo de transporte, como em "FTP/TCP".</span><span class="sxs-lookup"><span data-stu-id="f1a60-126">The **lpszQueryString** member is used to supply additional, namespace-specific query information such as a string describing a well-known service and transport protocol name, as in "ftp/tcp".</span></span>

<span data-ttu-id="f1a60-127">A estrutura [**AFPROTOCOLS**](/windows/desktop/api/Winsock2/ns-winsock2-afprotocols) referenciada por **lpafpProtocols** é usada apenas para fins de consulta e fornece uma lista de protocolos para restringir a consulta.</span><span class="sxs-lookup"><span data-stu-id="f1a60-127">The [**AFPROTOCOLS**](/windows/desktop/api/Winsock2/ns-winsock2-afprotocols) structure referenced by **lpafpProtocols** is used for query purposes only, and supplies a list of protocols to constrain the query.</span></span> <span data-ttu-id="f1a60-128">Esses protocolos são representados como pares (família de endereços, protocolo), pois os valores de protocolo só têm significado no contexto de uma família de endereços.</span><span class="sxs-lookup"><span data-stu-id="f1a60-128">These protocols are represented as (address family, protocol) pairs, because protocol values only have meaning within the context of an address family.</span></span>

<span data-ttu-id="f1a60-129">A matriz da estrutura de [**\_ informações do CSADDR**](/windows/win32/api/ws2def/ns-ws2def-csaddr_info) referenciada por **lpcsaBuffer** contém todas as informações necessárias para que um serviço seja usado no estabelecimento de uma escuta ou um cliente para usar no estabelecimento de uma conexão com o serviço.</span><span class="sxs-lookup"><span data-stu-id="f1a60-129">The array of [**CSADDR\_INFO**](/windows/win32/api/ws2def/ns-ws2def-csaddr_info) structure referenced by **lpcsaBuffer** contains all of the information required for either a service to use in establishing a listen, or a client to use in establishing a connection to the service.</span></span> <span data-ttu-id="f1a60-130">Os membros **localaddr** e **RemoteAddr** contêm diretamente uma estrutura [**de \_ endereço de soquete**](/windows/desktop/api/Ws2def/ns-ws2def-socket_address) .</span><span class="sxs-lookup"><span data-stu-id="f1a60-130">The **LocalAddr** and **RemoteAddr** members both directly contain a [**SOCKET\_ADDRESS**](/windows/desktop/api/Ws2def/ns-ws2def-socket_address) structure.</span></span> <span data-ttu-id="f1a60-131">Um serviço criaria um soquete usando a tupla (LocalAddr. lpSockaddr->\_ família SA, iSocketType, iProtocol).</span><span class="sxs-lookup"><span data-stu-id="f1a60-131">A service would create a socket using the tuple (LocalAddr.lpSockaddr->sa\_family, iSocketType, iProtocol).</span></span> <span data-ttu-id="f1a60-132">Ele ligaria o soquete a um endereço local usando LocalAddr. lpSockaddr e LocalAddr. lpSockaddrLength.</span><span class="sxs-lookup"><span data-stu-id="f1a60-132">It would bind the socket to a local address using LocalAddr.lpSockaddr, and LocalAddr.lpSockaddrLength.</span></span> <span data-ttu-id="f1a60-133">O cliente cria seu soquete com a tupla (RemoteAddr. lpSockaddr->\_ família SA, iSocketType, iProtocol) e usa a combinação de RemoteAddr. lpSockAddr e RemoteAddr. lpSockaddrLength ao fazer uma conexão remota.</span><span class="sxs-lookup"><span data-stu-id="f1a60-133">The client creates its socket with the tuple (RemoteAddr.lpSockaddr->sa\_family, iSocketType, iProtocol), and uses the combination of RemoteAddr.lpSockaddr, and RemoteAddr.lpSockaddrLength when making a remote connection.</span></span>

 

 
