---
description: O Windows Sockets 2 apresenta e/s sobreposta e requer que todos os provedores de transporte ofereçam suporte a esse recurso.
ms.assetid: 90d49171-e211-4426-aa56-88aaeac7c578
title: Entrada/saída sobreposta
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0d8caa13dd3d50e4f0fdaa1b92fa8e99afd8e2e1
ms.sourcegitcommit: 3d9dce1bd6c84e2b51759e940aa95aa9b459cd20
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/04/2021
ms.locfileid: "103837690"
---
# <a name="overlapped-inputoutput"></a><span data-ttu-id="3d81b-103">Entrada/saída sobreposta</span><span class="sxs-lookup"><span data-stu-id="3d81b-103">Overlapped Input/Output</span></span>

<span data-ttu-id="3d81b-104">O Windows Sockets 2 apresenta e/s sobreposta e requer que todos os provedores de transporte ofereçam suporte a esse recurso.</span><span class="sxs-lookup"><span data-stu-id="3d81b-104">Windows Sockets 2 introduces overlapped I/O and requires that all transport providers support this capability.</span></span> <span data-ttu-id="3d81b-105">A e/s sobreposta pode ser executada somente em soquetes que foram criados por meio da função [**WSPSocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket) com o sinalizador de cabeçalho wsa \_ \_ sobreposto definido e seguir o modelo estabelecido no Windows.</span><span class="sxs-lookup"><span data-stu-id="3d81b-105">Overlapped I/O can be performed only on sockets that were created through the [**WSPSocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket) function with the WSA\_FLAG\_OVERLAPPED flag set, and follow the model established in Windows.</span></span>

<span data-ttu-id="3d81b-106">Para receber, um cliente usa [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) ou [**WSPRecvFrom**](/previous-versions/windows/desktop/legacy/ms742287(v=vs.85)) para fornecer buffers para os quais os dados serão recebidos.</span><span class="sxs-lookup"><span data-stu-id="3d81b-106">For receiving, a client uses [**WSPRecv**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) or [**WSPRecvFrom**](/previous-versions/windows/desktop/legacy/ms742287(v=vs.85)) to supply buffers into which data is to be received.</span></span> <span data-ttu-id="3d81b-107">Se um ou mais buffers forem lançados antes da hora em que os dados foram recebidos pela rede, será possível que os dados sejam colocados nos buffers do usuário imediatamente, conforme eles chegam e, portanto, evitem a operação de cópia que, caso contrário, ocorreria.</span><span class="sxs-lookup"><span data-stu-id="3d81b-107">If one or more buffers are posted prior to the time when data has been received by the network, it is possible that data will be placed into the user's buffers immediately as it arrives and thereby avoid the copy operation that would otherwise occur.</span></span> <span data-ttu-id="3d81b-108">Se os dados chegarem quando os buffers de recebimento já tiverem sido postados, eles serão copiados imediatamente para os buffers do usuário.</span><span class="sxs-lookup"><span data-stu-id="3d81b-108">If data arrives when receive buffers have already been posted, it is copied immediately into the user's buffers.</span></span> <span data-ttu-id="3d81b-109">Se os dados chegarem quando nenhum buffer de recebimento tiver sido postado pelo aplicativo, o provedor de serviços Resort para o estilo síncrono de operação em que os dados de entrada são armazenados em buffer internamente até o momento em que o cliente emite uma chamada de recebimento e, portanto, fornece um buffer no qual os dados podem ser copiados.</span><span class="sxs-lookup"><span data-stu-id="3d81b-109">If data arrives when no receive buffers have been posted by the application, the service provider resorts to the synchronous style of operation where the incoming data is buffered internally until such time as the client issues a receive call and thereby supplies a buffer into which the data may be copied.</span></span> <span data-ttu-id="3d81b-110">Uma exceção a isso seria se o aplicativo usava [**WSPSetSockOpt**](/previous-versions/windows/hardware/network/ff566318(v=vs.85)) para definir o tamanho do buffer de recebimento como zero.</span><span class="sxs-lookup"><span data-stu-id="3d81b-110">An exception to this would be if the application used [**WSPSetSockOpt**](/previous-versions/windows/hardware/network/ff566318(v=vs.85)) to set the size of the receive buffer to zero.</span></span> <span data-ttu-id="3d81b-111">Nessa instância, os protocolos confiáveis só permitirão que os dados sejam recebidos quando os buffers de aplicativo tivessem sido postados, e os dados em protocolos não confiáveis seriam perdidos.</span><span class="sxs-lookup"><span data-stu-id="3d81b-111">In this instance, reliable protocols would only allow data to be received when application buffers had been posted, and data on unreliable protocols would be lost.</span></span>

<span data-ttu-id="3d81b-112">No lado de envio, os clientes usam [**WSPSend**](/previous-versions/windows/hardware/network/ff566316(v=vs.85)) ou [**WSPSendTo**](/previous-versions/windows/desktop/legacy/ms742291(v=vs.85)) para fornecer ponteiros para os buffers preenchidos e, em seguida, concorda em não incomodar os buffers de forma alguma até que a rede consumisse o conteúdo do buffer.</span><span class="sxs-lookup"><span data-stu-id="3d81b-112">On the sending side, clients use [**WSPSend**](/previous-versions/windows/hardware/network/ff566316(v=vs.85)) or [**WSPSendTo**](/previous-versions/windows/desktop/legacy/ms742291(v=vs.85)) to supply pointers to filled buffers and then agree not to disturb the buffers in any way until the network has consumed the buffer's contents.</span></span>

<span data-ttu-id="3d81b-113">Chamadas de envio e recebimento sobrepostas retornam imediatamente.</span><span class="sxs-lookup"><span data-stu-id="3d81b-113">Overlapped send and receive calls return immediately.</span></span> <span data-ttu-id="3d81b-114">Um valor de retorno de zero indica que a operação de e/s foi concluída imediatamente e que a indicação de conclusão correspondente já ocorreu.</span><span class="sxs-lookup"><span data-stu-id="3d81b-114">A return value of zero indicates that the I/O operation completed immediately and that the corresponding completion indication has already occurred.</span></span> <span data-ttu-id="3d81b-115">Ou seja, o objeto de evento associado foi sinalizado ou a rotina de conclusão foi enfileirada por meio de [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span><span class="sxs-lookup"><span data-stu-id="3d81b-115">That is, the associated event object has been signaled, or the completion routine has been queued through [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span></span> <span data-ttu-id="3d81b-116">Um valor de retorno do \_ erro de soquete associado a um código de erro de WSA \_ e/s de cabeçalho \_ pendente indica que a operação sobreposta foi iniciada com êxito e que uma indicação subseqüente será fornecida quando os buffers de envio tiverem sido consumidos ou quando os buffers de recebimento forem preenchidos.</span><span class="sxs-lookup"><span data-stu-id="3d81b-116">A return value of SOCKET\_ERROR coupled with an error code of WSA\_IO\_PENDING indicates that the overlapped operation has been successfully initiated and that a subsequent indication will be provided when send buffers have been consumed or when receive buffers are filled.</span></span> <span data-ttu-id="3d81b-117">Qualquer outro código de erro indica que a operação sobreposta não foi iniciada com êxito e que nenhuma indicação de conclusão estará disponível.</span><span class="sxs-lookup"><span data-stu-id="3d81b-117">Any other error code indicates that the overlapped operation was not successfully initiated and that no completion indication will be forthcoming.</span></span>

<span data-ttu-id="3d81b-118">Ambas as operações de envio e recebimento podem ser sobrepostas.</span><span class="sxs-lookup"><span data-stu-id="3d81b-118">Both send and receive operations can be overlapped.</span></span> <span data-ttu-id="3d81b-119">As funções Receive podem ser invocadas várias vezes para postar buffers de recebimento em preparação para dados de entrada, e as funções Send podem ser invocadas várias vezes para colocar em fila vários buffers a serem enviados.</span><span class="sxs-lookup"><span data-stu-id="3d81b-119">The receive functions may be invoked multiple times to post receive buffers in preparation for incoming data, and the send functions may be invoked multiple times to queue up multiple buffers to be sent.</span></span> <span data-ttu-id="3d81b-120">Observe que, embora uma série de buffers de envio sobrepostos seja enviada na ordem fornecida, as indicações de conclusão correspondentes podem ocorrer em uma ordem diferente.</span><span class="sxs-lookup"><span data-stu-id="3d81b-120">Note that while a series of overlapped send buffers will be sent in the order supplied, the corresponding completion indications may occur in a different order.</span></span> <span data-ttu-id="3d81b-121">Da mesma forma, no lado de recebimento, os buffers serão preenchidos na ordem em que são fornecidos, mas as indicações de conclusão podem ocorrer em uma ordem diferente.</span><span class="sxs-lookup"><span data-stu-id="3d81b-121">Likewise, on the receiving side, buffers will be filled in the order they are supplied, but completion indications may occur in a different order.</span></span>

<span data-ttu-id="3d81b-122">O recurso de conclusão adiada de e/s sobreposta também está disponível para [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="3d81b-122">The deferred completion feature of overlapped I/O is also available for [**WSPIoctl**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)).</span></span>

## <a name="delivering-completion-indications"></a><span data-ttu-id="3d81b-123">Entrega de indicações de conclusão</span><span class="sxs-lookup"><span data-stu-id="3d81b-123">Delivering Completion Indications</span></span>

<span data-ttu-id="3d81b-124">Os provedores de serviço têm duas maneiras de indicar conclusão sobreposta: definir um objeto de evento especificado pelo cliente ou invocar uma rotina de conclusão especificada pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="3d81b-124">Service providers have two ways to indicate overlapped completion: setting a client-specified event object, or invoking a client-specified completion routine.</span></span> <span data-ttu-id="3d81b-125">Em ambos os casos, uma estrutura de dados, [**WSAOVERLAPPED**](/windows/desktop/api/Winsock2/ns-winsock2-wsaoverlapped), é associada a cada operação sobreposta.</span><span class="sxs-lookup"><span data-stu-id="3d81b-125">In both cases a data structure, [**WSAOVERLAPPED**](/windows/desktop/api/Winsock2/ns-winsock2-wsaoverlapped), is associated with each overlapped operation.</span></span> <span data-ttu-id="3d81b-126">Essa estrutura é alocada pelo cliente e usada por ela para indicar qual objeto de evento (se houver) deve ser definido quando a conclusão ocorre.</span><span class="sxs-lookup"><span data-stu-id="3d81b-126">This structure is allocated by the client and used by it to indicate which event object (if any) is to be set when completion occurs.</span></span> <span data-ttu-id="3d81b-127">A estrutura **WSAOVERLAPPED** pode ser usada pelo provedor de serviços como um local para armazenar um identificador nos resultados (por exemplo, número de bytes transferidos, sinalizadores atualizados, códigos de erro, etc.) para uma operação sobreposta em particular.</span><span class="sxs-lookup"><span data-stu-id="3d81b-127">The **WSAOVERLAPPED** structure may be used by the service provider as a place to store a handle to the results (for example, number of bytes transferred, updated flags, error codes, etc.) for a particular overlapped operation.</span></span> <span data-ttu-id="3d81b-128">Para obter esses resultados, os clientes devem invocar [**WSPGetOverlappedResult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult), passando um ponteiro para a estrutura sobreposta correspondente.</span><span class="sxs-lookup"><span data-stu-id="3d81b-128">To obtain these results clients must invoke [**WSPGetOverlappedResult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult), passing in a pointer to the corresponding overlapped structure.</span></span>

<span data-ttu-id="3d81b-129">Se a indicação de conclusão baseada em evento for selecionada para uma determinada solicitação de e/s sobreposta, a rotina [**WSPGetOverlappedResult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult) poderá ser usada por clientes para sondar ou aguardar a conclusão da operação sobreposta.</span><span class="sxs-lookup"><span data-stu-id="3d81b-129">If event based completion indication is selected for a particular overlapped I/O request, the [**WSPGetOverlappedResult**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspgetoverlappedresult) routine may itself be used by clients to either poll or wait for completion of the overlapped operation.</span></span> <span data-ttu-id="3d81b-130">Se a indicação de conclusão baseada em rotina de conclusão for selecionada para uma determinada solicitação de e/s sobreposta, somente a opção de sondagem de **WSPGetOverlappedResult** estará disponível.</span><span class="sxs-lookup"><span data-stu-id="3d81b-130">If completion-routine-based completion indication is selected for a particular overlapped I/O request, only the polling option of **WSPGetOverlappedResult** is available.</span></span> <span data-ttu-id="3d81b-131">Um cliente também pode usar outros meios de aguardar (como usar [**WSAWaitForMultipleEvents**](/windows/desktop/api/Winsock2/nf-winsock2-wsawaitformultipleevents)) até que o objeto de evento correspondente tenha sido sinalizado ou a rotina de conclusão especificada tenha sido invocada pelo provedor de serviços.</span><span class="sxs-lookup"><span data-stu-id="3d81b-131">A client may also use other means to wait (such as using [**WSAWaitForMultipleEvents**](/windows/desktop/api/Winsock2/nf-winsock2-wsawaitformultipleevents)) until the corresponding event object has been signaled or the specified completion routine has been invoked by the service provider.</span></span> <span data-ttu-id="3d81b-132">Depois que a conclusão tiver sido indicada, o cliente poderá invocar **WSPGetOverlappedResult**, com a expectativa de que a chamada seja concluída imediatamente.</span><span class="sxs-lookup"><span data-stu-id="3d81b-132">Once completion has been indicated, the client may invoke **WSPGetOverlappedResult**, with the expectation that the call will complete immediately.</span></span>

## <a name="invoking-socket-io-completion-routines"></a><span data-ttu-id="3d81b-133">Invocando rotinas de conclusão de e/s de soquete</span><span class="sxs-lookup"><span data-stu-id="3d81b-133">Invoking Socket I/O Completion Routines</span></span>

<span data-ttu-id="3d81b-134">Se o parâmetro *lpCompletionRoutine* para uma operação sobreposta não for **NULL**, será responsabilidade do provedor de serviço se organizar para invocar a rotina de conclusão especificada pelo cliente quando a operação sobreposta for concluída.</span><span class="sxs-lookup"><span data-stu-id="3d81b-134">If the *lpCompletionRoutine* parameter to an overlapped operation is not **NULL**, it is the service provider's responsibility to arrange for invocation of the client-specified completion routine when the overlapped operation completes.</span></span> <span data-ttu-id="3d81b-135">Como a rotina de conclusão deve ser executada no contexto do mesmo thread que iniciou a operação sobreposta, ela não pode ser invocada diretamente do provedor de serviços.</span><span class="sxs-lookup"><span data-stu-id="3d81b-135">Since the completion routine must be executed in the context of the same thread that initiated the overlapped operation, it cannot be invoked directly from the service provider.</span></span> <span data-ttu-id="3d81b-136">O \_32.DLL Ws2 oferece um mecanismo de chamada de procedimento assíncrono (APC) para facilitar a invocação de rotinas de conclusão.</span><span class="sxs-lookup"><span data-stu-id="3d81b-136">The Ws2\_32.DLL offers an asynchronous procedure call (APC) mechanism to facilitate invocation of completion routines.</span></span>

<span data-ttu-id="3d81b-137">Um provedor de serviços organiza uma função a ser executada no thread apropriado chamando [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span><span class="sxs-lookup"><span data-stu-id="3d81b-137">A service provider arranges for a function to be executed in the proper thread by calling [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc).</span></span> <span data-ttu-id="3d81b-138">Essa função pode ser chamada de qualquer contexto de processo e thread, até mesmo um contexto diferente do thread e do processo que foi usado para iniciar a operação sobreposta.</span><span class="sxs-lookup"><span data-stu-id="3d81b-138">This function can be called from any process and thread context, even a context different from the thread and process that was used to initiate the overlapped operation.</span></span>

<span data-ttu-id="3d81b-139">[**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) usa como parâmetros de entrada um ponteiro para uma estrutura [**WSATHREADID**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) , um ponteiro para uma função APC a ser invocada e um valor de contexto de 32 bits que é posteriormente passado para a função APC.</span><span class="sxs-lookup"><span data-stu-id="3d81b-139">[**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) takes as input parameters a pointer to a [**WSATHREADID**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) structure, a pointer to an APC function to be invoked, and a 32-bit context value that is subsequently passed to the APC function.</span></span> <span data-ttu-id="3d81b-140">Provedores de serviço são sempre fornecidos com um ponteiro para a estrutura **WSATHREADID** apropriada por meio do parâmetro *lpThreadId* para a função Overlapped.</span><span class="sxs-lookup"><span data-stu-id="3d81b-140">Service providers are always supplied with a pointer to the proper **WSATHREADID** structure through the *lpThreadId* parameter to the overlapped function.</span></span> <span data-ttu-id="3d81b-141">O provedor deve armazenar a estrutura **WSATHREADID** localmente e fornecer um ponteiro para essa cópia da estrutura **WSATHREADID** como um parâmetro de entrada para **WPUQueueApc**.</span><span class="sxs-lookup"><span data-stu-id="3d81b-141">The provider should store the **WSATHREADID** structure locally and supply a pointer to this copy of the **WSATHREADID** structure as an input parameter to **WPUQueueApc**.</span></span> <span data-ttu-id="3d81b-142">Depois que a função **WPUQueueApc** retorna, o provedor pode descartar sua cópia do **WSATHREADID**.</span><span class="sxs-lookup"><span data-stu-id="3d81b-142">Once the **WPUQueueApc** function returns, the provider can dispose of its copy of the **WSATHREADID**.</span></span>

<span data-ttu-id="3d81b-143">O procedimento [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) simplesmente enfileira informações suficientes para chamar a função APC indicada com os parâmetros fornecidos, mas não a chama.</span><span class="sxs-lookup"><span data-stu-id="3d81b-143">The procedure [**WPUQueueApc**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuqueueapc) simply enqueues sufficient information to call the indicated APC function with the given parameters, but does not call it.</span></span> <span data-ttu-id="3d81b-144">Quando o thread-alvo entra em um estado de espera alertável, essas informações são removidas da fila e uma chamada é feita à função APC nesse thread de destino e no contexto do processo.</span><span class="sxs-lookup"><span data-stu-id="3d81b-144">When the target thread enters an alertable wait state, this information is dequeued and a call is made to the APC function in that target thread and process context.</span></span> <span data-ttu-id="3d81b-145">Como o mecanismo da APC dá suporte apenas a um único valor de contexto de 32 bits, a função APC não pode ser a rotina de conclusão especificada pelo cliente, que envolve mais parâmetros.</span><span class="sxs-lookup"><span data-stu-id="3d81b-145">Because the APC mechanism supports only a single 32-bit context value, the APC function cannot itself be the client-specified completion routine, which involves more parameters.</span></span> <span data-ttu-id="3d81b-146">Em vez disso, o provedor de serviços deve fornecer um ponteiro para sua própria função APC, que usa o valor de contexto fornecido para acessar as informações de resultado necessárias para a operação sobreposta e, em seguida, invoca a rotina de conclusão especificada pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="3d81b-146">The service provider must instead supply a pointer to its own APC function which uses the supplied context value to access the needed result information for the overlapped operation, and then invokes the client-specified completion routine.</span></span>

<span data-ttu-id="3d81b-147">Para provedores de serviços em que um componente de modo de usuário implementa e/s sobreposta, um uso típico do mecanismo da APC é o seguinte:</span><span class="sxs-lookup"><span data-stu-id="3d81b-147">For service providers where a user-mode component implements overlapped I/O, a typical usage of the APC mechanism is as follows:</span></span>

-   <span data-ttu-id="3d81b-148">Quando a operação de e/s é concluída, o provedor aloca um buffer pequeno e o compacta com um ponteiro para o procedimento de conclusão fornecido pelo cliente e os valores de parâmetro a serem passados para o procedimento.</span><span class="sxs-lookup"><span data-stu-id="3d81b-148">When the I/O operation completes, the provider allocates a small buffer and packs it with a pointer to the client-supplied completion procedure and parameter values to pass to the procedure.</span></span>
-   <span data-ttu-id="3d81b-149">Ele enfileira uma APC, especificando o ponteiro para o buffer como o valor de contexto e seu próprio procedimento intermediário como o procedimento de destino.</span><span class="sxs-lookup"><span data-stu-id="3d81b-149">It queues an APC, specifying the pointer to the buffer as the context value and its own intermediate procedure as the target procedure.</span></span>
-   <span data-ttu-id="3d81b-150">Quando o thread-alvo eventualmente entra no estado de espera alertável, o procedimento intermediário do provedor de serviço é chamado no contexto de thread apropriado.</span><span class="sxs-lookup"><span data-stu-id="3d81b-150">When the target thread eventually enters alertable wait state, the service provider's intermediate procedure is called in the proper thread context.</span></span>
-   <span data-ttu-id="3d81b-151">O procedimento intermediário simplesmente desempacota os parâmetros, desaloca o buffer e chama o procedimento de conclusão fornecido pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="3d81b-151">The intermediate procedure simply unpacks parameters, deallocates the buffer, and calls the client-supplied completion procedure.</span></span>
-   <span data-ttu-id="3d81b-152">Para provedores de serviços em que um componente de modo kernel implementa e/s sobreposta, uma implementação típica é semelhante, exceto que a implementação usaria as interfaces de kernel padrão para enfileirar a APC.</span><span class="sxs-lookup"><span data-stu-id="3d81b-152">For service providers where a kernel-mode component implements overlapped I/O, a typical implementation is similar, except that the implementation would use standard kernel interfaces to enqueue the APC.</span></span>

<span data-ttu-id="3d81b-153">A descrição das interfaces de kernel relevantes está fora do escopo da especificação do Windows Sockets 2.</span><span class="sxs-lookup"><span data-stu-id="3d81b-153">Description of the relevant kernel interfaces is outside the scope of the Windows Sockets 2 specification.</span></span>

> [!Note]  
> <span data-ttu-id="3d81b-154">Os provedores de serviço devem permitir que clientes do Windows Sockets 2 invoquem operações de envio e recebimento de dentro do contexto da rotina de conclusão de e/s de soquete e garantir que, para um determinado soquete, as rotinas de conclusão de e/s não serão aninhadas.</span><span class="sxs-lookup"><span data-stu-id="3d81b-154">Service providers must allow Windows Sockets 2 clients to invoke send and receive operations from within the context of the socket I/O completion routine and guarantee that for a given socket, I/O completion routines will not be nested.</span></span>

 

<span data-ttu-id="3d81b-155">Em algumas circunstâncias, um provedor de serviços em camadas pode precisar iniciar e concluir operações sobrepostas de dentro de um thread de trabalho interno.</span><span class="sxs-lookup"><span data-stu-id="3d81b-155">Under some circumstances, a layered service provider may need to initiate and complete overlapped operations from within an internal worker thread.</span></span> <span data-ttu-id="3d81b-156">Nesse caso, um [**WSATHREADID**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) não estaria disponível a partir de uma chamada de função de entrada.</span><span class="sxs-lookup"><span data-stu-id="3d81b-156">In this case, a [**WSATHREADID**](/windows/desktop/api/Ws2spi/ns-ws2spi-wsathreadid) would not be available from an incoming function call.</span></span> <span data-ttu-id="3d81b-157">A interface do provedor de serviços fornece uma chamada, [**WPUOpenCurrentThread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuopencurrentthread), para obter um **WSATHREADID** para o thread atual.</span><span class="sxs-lookup"><span data-stu-id="3d81b-157">The service provider interface provides an upcall, [**WPUOpenCurrentThread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuopencurrentthread), to obtain a **WSATHREADID** for the current thread.</span></span> <span data-ttu-id="3d81b-158">Quando esse **WSATHREADID** não for mais necessário, seus recursos deverão ser retornados chamando [**WPUCloseThread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuclosethread).</span><span class="sxs-lookup"><span data-stu-id="3d81b-158">When this **WSATHREADID** is no longer needed, its resources should be returned by calling [**WPUCloseThread**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpuclosethread).</span></span>

 

 
