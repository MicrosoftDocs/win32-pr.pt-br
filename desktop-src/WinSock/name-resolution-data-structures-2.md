---
description: Estruturas de dados de resolução de nomes no Windows Sockets (Winsock).
ms.assetid: 87c54141-41e2-4eaa-ae3b-84598e8281d9
title: Estruturas de dados de resolução de nomes
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bf1f76607ade81503a1057dc21890ac38d5ec265
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104566472"
---
# <a name="name-resolution-data-structures"></a><span data-ttu-id="689ea-103">Estruturas de dados de resolução de nomes</span><span class="sxs-lookup"><span data-stu-id="689ea-103">Name Resolution Data Structures</span></span>

<span data-ttu-id="689ea-104">Há várias estruturas de dados importantes que são usadas extensivamente em todas as funções de resolução de nomes.</span><span class="sxs-lookup"><span data-stu-id="689ea-104">There are several important data structures that are used extensively throughout the name resolution functions.</span></span>

## <a name="query-related-data-structures"></a><span data-ttu-id="689ea-105">Estruturas de dados de Query-Related</span><span class="sxs-lookup"><span data-stu-id="689ea-105">Query-Related Data Structures</span></span>

<span data-ttu-id="689ea-106">A estrutura [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) é usada para formar consultas para [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina)e é usada para fornecer resultados de consulta para [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta).</span><span class="sxs-lookup"><span data-stu-id="689ea-106">The [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure is used to form queries for [**WSALookupServiceBegin**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina), and used to deliver query results for [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta).</span></span> <span data-ttu-id="689ea-107">É uma estrutura complexa, pois contém ponteiros para várias outras estruturas, algumas das quais a referência ainda tem outras estruturas.</span><span class="sxs-lookup"><span data-stu-id="689ea-107">It is a complex structure since it contains pointers to several other structures, some of which reference still other structures.</span></span> <span data-ttu-id="689ea-108">A relação entre a estrutura [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) e as estruturas que ela faz referência é ilustrada a seguir.</span><span class="sxs-lookup"><span data-stu-id="689ea-108">The relationship between the [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure and the structures it references is illustrated as follows.</span></span>

![relação entre WSAQUERYSET e suas estruturas associadas](images/ovrvw3-2.png)

<span data-ttu-id="689ea-110">Na estrutura [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) , a maioria dos membros é auto-explicativa, mas alguns merecem uma explicação adicional.</span><span class="sxs-lookup"><span data-stu-id="689ea-110">Within the [**WSAQUERYSET**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) structure, most of the member are self explanatory, but some deserve additional explanation.</span></span> <span data-ttu-id="689ea-111">O membro **dwSize** sempre deve ser preenchido com sizeof (**WSAQUERYSET**), pois ele é usado por provedores de namespace para detectar e se adaptar a versões diferentes da estrutura **WSAQUERYSET** que podem aparecer ao longo do tempo.</span><span class="sxs-lookup"><span data-stu-id="689ea-111">The **dwSize** member must always be filled in with sizeof(**WSAQUERYSET**), as this is used by namespace providers to detect and adapt to different versions of the **WSAQUERYSET** structure that may appear over time.</span></span>

<span data-ttu-id="689ea-112">O membro **dwOutputFlags** é usado por um provedor de namespace para fornecer informações adicionais sobre os resultados da consulta.</span><span class="sxs-lookup"><span data-stu-id="689ea-112">The **dwOutputFlags** member is used by a namespace provider to provide additional information about query results.</span></span> <span data-ttu-id="689ea-113">Para obter detalhes, consulte a função [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) .</span><span class="sxs-lookup"><span data-stu-id="689ea-113">For details, see the [**WSALookupServiceNext**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) function.</span></span>

<span data-ttu-id="689ea-114">A estrutura [**WSAECOMPARATOR**](/windows/desktop/api/Winsock2/ne-winsock2-wsaecomparator) referenciada pelo membro **lpversion** é usada para a restrição de consulta e os resultados.</span><span class="sxs-lookup"><span data-stu-id="689ea-114">The [**WSAECOMPARATOR**](/windows/desktop/api/Winsock2/ne-winsock2-wsaecomparator) structure referenced by the **lpversion** member is used for both query constraint and results.</span></span> <span data-ttu-id="689ea-115">Para consultas, o membro **DW** indica a versão desejada do serviço.</span><span class="sxs-lookup"><span data-stu-id="689ea-115">For queries, the **dwVersion** member indicates the desired version of the service.</span></span> <span data-ttu-id="689ea-116">O membro **ecHow** é um tipo enumerado que especifica como a comparação pode ser feita.</span><span class="sxs-lookup"><span data-stu-id="689ea-116">The **ecHow** member is an enumerated type which specifies how the comparison can be made.</span></span> <span data-ttu-id="689ea-117">As opções são COMP \_ Equals, que requer que uma correspondência exata na versão ocorra, ou comp less, que \_ especifica que o número de versão do serviço não é menor que o valor do membro **DW** .</span><span class="sxs-lookup"><span data-stu-id="689ea-117">The choices are COMP\_EQUALS which requires that an exact match in version occurs, or COMP\_NOTLESS which specifies that the service's version number be no less than the value of the **dwVersion** member.</span></span>

<span data-ttu-id="689ea-118">A interpretação de **dwNameSpace** e **lpNSProviderId** depende de como a estrutura está sendo usada e é descrita mais detalhadamente nas descrições de função individuais que utilizam essa estrutura.</span><span class="sxs-lookup"><span data-stu-id="689ea-118">The interpretation of **dwNameSpace** and **lpNSProviderId** depends upon how the structure is being used and is described further in the individual function descriptions that utilize this structure.</span></span>

<span data-ttu-id="689ea-119">O membro **lpszContext** se aplica a namespaces hierárquicos e especifica o ponto de partida de uma consulta ou o local dentro da hierarquia em que o serviço reside.</span><span class="sxs-lookup"><span data-stu-id="689ea-119">The **lpszContext** member applies to hierarchical namespaces, and specifies the starting point of a query or the location within the hierarchy where the service resides.</span></span> <span data-ttu-id="689ea-120">As regras gerais são:</span><span class="sxs-lookup"><span data-stu-id="689ea-120">The general rules are:</span></span>

-   <span data-ttu-id="689ea-121">Um valor **nulo**, em branco (""), inicia a pesquisa no contexto padrão.</span><span class="sxs-lookup"><span data-stu-id="689ea-121">A value of **NULL**, blank ("") starts the search at the default context.</span></span>
-   <span data-ttu-id="689ea-122">Um valor de " \\ " inicia a pesquisa na parte superior do namespace.</span><span class="sxs-lookup"><span data-stu-id="689ea-122">A value of "\\" starts the search at the top of the namespace.</span></span>
-   <span data-ttu-id="689ea-123">Qualquer outro valor inicia a pesquisa no ponto designado.</span><span class="sxs-lookup"><span data-stu-id="689ea-123">Any other value starts the search at the designated point.</span></span>

<span data-ttu-id="689ea-124">Os provedores que não dão suporte à contenção poderão retornar um erro se algo diferente de "" ou " \\ " for especificado.</span><span class="sxs-lookup"><span data-stu-id="689ea-124">Providers that do not support containment may return an error if anything other than "" or "\\" is specified.</span></span> <span data-ttu-id="689ea-125">Provedores que dão suporte a contenção limitada, como grupos, devem aceitar "", " \\ " ou um ponto designado.</span><span class="sxs-lookup"><span data-stu-id="689ea-125">Providers that support limited containment, such as groups, should accept "", '\\", or a designated point.</span></span> <span data-ttu-id="689ea-126">Contextos são específicos do namespace.</span><span class="sxs-lookup"><span data-stu-id="689ea-126">Contexts are namespace specific.</span></span> <span data-ttu-id="689ea-127">Se o membro **dwNameSpace** for NS \_ All, somente "" ou " \\ " deverá ser passado como o contexto, pois eles são reconhecidos por todos os namespaces.</span><span class="sxs-lookup"><span data-stu-id="689ea-127">If the **dwNameSpace** member is NS\_ALL, then only "" or "\\" should be passed as the context since these are recognized by all namespaces.</span></span>

<span data-ttu-id="689ea-128">O membro **lpszQueryString** é usado para fornecer informações de consulta adicionais específicas de namespace, como uma cadeia de caracteres que descreve um serviço conhecido e um nome de protocolo de transporte, como em "FTP/TCP".</span><span class="sxs-lookup"><span data-stu-id="689ea-128">The **lpszQueryString** member is used to supply additional, namespace-specific query information such as a string describing a well-known service and transport protocol name, as in "FTP/TCP".</span></span>

<span data-ttu-id="689ea-129">A estrutura [**AFPROTOCOLS**](/windows/desktop/api/Winsock2/ns-winsock2-afprotocols) referenciada pelo membro **lpafpProtocols** é usada apenas para fins de consulta e fornece uma lista de protocolos para restringir a consulta.</span><span class="sxs-lookup"><span data-stu-id="689ea-129">The [**AFPROTOCOLS**](/windows/desktop/api/Winsock2/ns-winsock2-afprotocols) structure referenced by the **lpafpProtocols** member is used for query purposes only, and supplies a list of protocols to constrain the query.</span></span> <span data-ttu-id="689ea-130">Esses protocolos são representados como pares (família de endereços, protocolo), pois os valores de protocolo só têm significado no contexto de uma família de endereços.</span><span class="sxs-lookup"><span data-stu-id="689ea-130">These protocols are represented as (address family, protocol) pairs, since protocol values only have meaning within the context of an address family.</span></span>

<span data-ttu-id="689ea-131">A matriz da estrutura [**de \_ informações do CSADDR**](/windows/win32/api/ws2def/ns-ws2def-csaddr_info) referenciada pelo membro **lpcsaBuffer** contém todas as informações necessárias para que um serviço seja usado no estabelecimento de uma escuta ou para que um cliente use o para estabelecer uma conexão com o serviço.</span><span class="sxs-lookup"><span data-stu-id="689ea-131">The array of the [**CSADDR\_INFO**](/windows/win32/api/ws2def/ns-ws2def-csaddr_info) structure referenced by the **lpcsaBuffer** member contain all of the information needed for either a service to use in establishing a listen, or for a client to use in establishing a connection to the service.</span></span> <span data-ttu-id="689ea-132">Os membros **localaddr** e **RemoteAddr** contêm diretamente uma estrutura [**de \_ endereço de soquete**](/windows/desktop/api/Ws2def/ns-ws2def-socket_address) .</span><span class="sxs-lookup"><span data-stu-id="689ea-132">The **LocalAddr** and **RemoteAddr** members both directly contain a [**SOCKET\_ADDRESS**](/windows/desktop/api/Ws2def/ns-ws2def-socket_address) structure.</span></span>

<span data-ttu-id="689ea-133">Um serviço criaria um soquete chamando a função [**Socket**](/windows/desktop/api/Winsock2/nf-winsock2-socket) ou [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa) usando a tupla de *localaddr. lpSockAddr->SA \_ Family*, *iSocketType* e *iProtocol* como parâmetros.</span><span class="sxs-lookup"><span data-stu-id="689ea-133">A service would create a socket by calling the [**socket**](/windows/desktop/api/Winsock2/nf-winsock2-socket) or [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa) function using the tuple of *LocalAddr.lpSockaddr->sa\_family*, *iSocketType*, and *iProtocol* as parameters.</span></span> <span data-ttu-id="689ea-134">Um serviço associaria o soquete a um endereço local chamando a função [**BIND**](/windows/desktop/api/winsock/nf-winsock-bind) usando *localaddr. lpSockAddr* e *localaddr. lpSockaddrLength* como parâmetros.</span><span class="sxs-lookup"><span data-stu-id="689ea-134">A service would bind the socket to a local address by calling the [**bind**](/windows/desktop/api/winsock/nf-winsock-bind) function using *LocalAddr.lpSockaddr* and *LocalAddr.lpSockaddrLength* as parameters.</span></span>

<span data-ttu-id="689ea-135">Um cliente cria seu soquete chamando o [**soquete**](/windows/desktop/api/Winsock2/nf-winsock2-socket) ou a função [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa) usando a tupla de *localaddr. lpSockAddr->a \_ família SA*, *iSocketType* e *iProtocol* como parâmetros.</span><span class="sxs-lookup"><span data-stu-id="689ea-135">A client creates its socket by calling the [**socket**](/windows/desktop/api/Winsock2/nf-winsock2-socket) or [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa) function using the tuple of *LocalAddr.lpSockaddr->sa\_family*, *iSocketType*, and *iProtocol* as parameters.</span></span> <span data-ttu-id="689ea-136">Um cliente usa a combinação de *RemoteAddr. lpSockAddr* e *RemoteAddr. lpSockaddrLength* como parâmetros ao fazer uma conexão remota usando a função [**Connect**](/windows/desktop/api/Winsock2/nf-winsock2-connect), [**ConnectEx**](/windows/desktop/api/Mswsock/nc-mswsock-lpfn_connectex)ou [**WSAConnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsaconnect) .</span><span class="sxs-lookup"><span data-stu-id="689ea-136">A client uses the combination of *RemoteAddr.lpSockaddr* and *RemoteAddr.lpSockaddrLength* as parameters when making a remote connection using the [**connect**](/windows/desktop/api/Winsock2/nf-winsock2-connect), [**ConnectEx**](/windows/desktop/api/Mswsock/nc-mswsock-lpfn_connectex), or [**WSAConnect**](/windows/desktop/api/Winsock2/nf-winsock2-wsaconnect) function.</span></span>

## <a name="service-class-data-structures"></a><span data-ttu-id="689ea-137">Estruturas de dados de classe de serviço</span><span class="sxs-lookup"><span data-stu-id="689ea-137">Service Class Data Structures</span></span>

<span data-ttu-id="689ea-138">Quando uma nova classe de serviço é instalada, uma estrutura [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) deve ser preparada e fornecida.</span><span class="sxs-lookup"><span data-stu-id="689ea-138">When a new service class is installed, a [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure must be prepared and supplied.</span></span> <span data-ttu-id="689ea-139">Essa estrutura também consiste em subestruturas que contêm uma série de membros que se aplicam a namespaces específicos.</span><span class="sxs-lookup"><span data-stu-id="689ea-139">This structure also consists of substructures that contain a series of members that apply to specific namespaces.</span></span> <span data-ttu-id="689ea-140">Uma estrutura de dados de informações de classe é a seguinte:</span><span class="sxs-lookup"><span data-stu-id="689ea-140">A class info data structure is as follows:</span></span>

![arquitetura de estruturas de dados de classe de serviço](images/ovrvw3-3.png)

<span data-ttu-id="689ea-142">Para cada classe de serviço, há uma única estrutura [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) .</span><span class="sxs-lookup"><span data-stu-id="689ea-142">For each service class, there is a single [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure.</span></span> <span data-ttu-id="689ea-143">Na estrutura [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) , o identificador exclusivo da classe de serviço está contido no membro **lpServiceClassId** e uma cadeia de caracteres de exibição associada é referenciada pelo membro **lpServiceClassName** .</span><span class="sxs-lookup"><span data-stu-id="689ea-143">Within the [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure, the service class' unique identifier is contained in the **lpServiceClassId** member, and an associated display string is referenced by the **lpServiceClassName** member.</span></span> <span data-ttu-id="689ea-144">Essa é a cadeia de caracteres retornada pela função [**WSAGetServiceClassNameByClassId**](/windows/desktop/api/Winsock2/nf-winsock2-wsagetserviceclassnamebyclassida) .</span><span class="sxs-lookup"><span data-stu-id="689ea-144">This is the string that is returned by the [**WSAGetServiceClassNameByClassId**](/windows/desktop/api/Winsock2/nf-winsock2-wsagetserviceclassnamebyclassida) function.</span></span>

<span data-ttu-id="689ea-145">O membro **lpClassInfos** na estrutura [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) faz referência a uma matriz de estruturas **WSANSCLASSINFO** , cada uma delas fornece um membro nomeado e digitado que se aplica a um namespace especificado.</span><span class="sxs-lookup"><span data-stu-id="689ea-145">The **lpClassInfos** member in the [**WSASERVICECLASSINFO**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) structure references an array of **WSANSCLASSINFO** structures, each of which supplies a named and typed member that applies to a specified namespace.</span></span> <span data-ttu-id="689ea-146">Exemplos de valores para o membro **lpszName** incluem: "SAPID", "TCPPort", "UDPport", etc. Essas cadeias de caracteres são geralmente específicas do namespace identificado no membro **dwNameSpace** .</span><span class="sxs-lookup"><span data-stu-id="689ea-146">Examples of values for the **lpszName** member include: "SapId", "TcpPort", "UdpPort", etc. These strings are generally specific to the namespace identified in the **dwNameSpace** member.</span></span> <span data-ttu-id="689ea-147">Os valores típicos para o membro **dwValueType** podem ser reg \_ DWORD, Reg \_ sz, etc. O membro **dwValueSize** indica o comprimento do item de dados apontado por **lpValue**.</span><span class="sxs-lookup"><span data-stu-id="689ea-147">Typical values for the **dwValueType** member might be REG\_DWORD, REG\_SZ, etc. The **dwValueSize** member indicates the length of the data item pointed to by **lpValue**.</span></span>

<span data-ttu-id="689ea-148">Toda a coleção de dados representada em uma estrutura **WSASERVICECLASSINFO** é fornecida para cada provedor de namespace quando a função [**WSAInstallServiceClass**](/windows/desktop/api/Winsock2/nf-winsock2-wsainstallserviceclassa) é invocada.</span><span class="sxs-lookup"><span data-stu-id="689ea-148">The entire collection of data represented in a **WSASERVICECLASSINFO** structure is provided to each namespace provider when the [**WSAInstallServiceClass**](/windows/desktop/api/Winsock2/nf-winsock2-wsainstallserviceclassa) function is invoked.</span></span> <span data-ttu-id="689ea-149">Em seguida, cada provedor de namespace individual percorre a lista de estruturas **WSANSCLASSINFO** e retém as informações aplicáveis a ela.</span><span class="sxs-lookup"><span data-stu-id="689ea-149">Each individual namespace provider then sifts through the list of **WSANSCLASSINFO** structures and retains the information applicable to it.</span></span>

## <a name="related-topics"></a><span data-ttu-id="689ea-150">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="689ea-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="689ea-151">**AFPROTOCOLS**</span><span class="sxs-lookup"><span data-stu-id="689ea-151">**AFPROTOCOLS**</span></span>](/windows/desktop/api/Winsock2/ns-winsock2-afprotocols)
</dt> <dt>

[<span data-ttu-id="689ea-152">**informações de CSADDR \_**</span><span class="sxs-lookup"><span data-stu-id="689ea-152">**CSADDR\_INFO**</span></span>](/windows/win32/api/ws2def/ns-ws2def-csaddr_info)
</dt> <dt>

[<span data-ttu-id="689ea-153">Modelo de resolução de nomes</span><span class="sxs-lookup"><span data-stu-id="689ea-153">Name Resolution Model</span></span>](name-resolution-model-2.md)
</dt> <dt>

[<span data-ttu-id="689ea-154">Resolução de nomes independente de protocolo</span><span class="sxs-lookup"><span data-stu-id="689ea-154">Protocol-Independent Name Resolution</span></span>](protocol-independent-name-resolution-2.md)
</dt> <dt>

[<span data-ttu-id="689ea-155">Registro e resolução de nome</span><span class="sxs-lookup"><span data-stu-id="689ea-155">Registration and Name Resolution</span></span>](registration-and-name-resolution-2.md)
</dt> <dt>

[<span data-ttu-id="689ea-156">**Endereço do soquete \_**</span><span class="sxs-lookup"><span data-stu-id="689ea-156">**SOCKET\_ADDRESS**</span></span>](/windows/desktop/api/Ws2def/ns-ws2def-socket_address)
</dt> <dt>

[<span data-ttu-id="689ea-157">Resumo das funções de resolução de nomes</span><span class="sxs-lookup"><span data-stu-id="689ea-157">Summary of Name Resolution Functions</span></span>](summary-of-name-resolution-functions-2.md)
</dt> <dt>

[<span data-ttu-id="689ea-158">**WSAECOMPARATOR**</span><span class="sxs-lookup"><span data-stu-id="689ea-158">**WSAECOMPARATOR**</span></span>](/windows/desktop/api/Winsock2/ne-winsock2-wsaecomparator)
</dt> <dt>

[<span data-ttu-id="689ea-159">**WSAGetServiceClassNameByClassId**</span><span class="sxs-lookup"><span data-stu-id="689ea-159">**WSAGetServiceClassNameByClassId**</span></span>](/windows/desktop/api/Winsock2/nf-winsock2-wsagetserviceclassnamebyclassida)
</dt> <dt>

[<span data-ttu-id="689ea-160">**WSAInstallServiceClass**</span><span class="sxs-lookup"><span data-stu-id="689ea-160">**WSAInstallServiceClass**</span></span>](/windows/desktop/api/Winsock2/nf-winsock2-wsainstallserviceclassa)
</dt> <dt>

[<span data-ttu-id="689ea-161">**WSALookupServiceBegin**</span><span class="sxs-lookup"><span data-stu-id="689ea-161">**WSALookupServiceBegin**</span></span>](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina)
</dt> <dt>

[<span data-ttu-id="689ea-162">**WSAQUERYSET**</span><span class="sxs-lookup"><span data-stu-id="689ea-162">**WSAQUERYSET**</span></span>](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw)
</dt> <dt>

[<span data-ttu-id="689ea-163">**WSASERVICECLASSINFO**</span><span class="sxs-lookup"><span data-stu-id="689ea-163">**WSASERVICECLASSINFO**</span></span>](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow)
</dt> </dl>

 

 
