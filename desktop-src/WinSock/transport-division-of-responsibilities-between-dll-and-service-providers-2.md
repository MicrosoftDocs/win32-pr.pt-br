---
description: Esta seção fornece uma visão geral da divisão de responsabilidade entre os \_ provedores de serviço de transporte e32.dll de Ws2.
ms.assetid: e1ea1e99-a2bc-4e76-91f6-e388c39dfbbb
title: Divisão de responsabilidades de transporte entre DLL e provedores de serviços
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 142ac98c95e95c310c2eefb7bfdaf1f70a03bf28
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105790450"
---
# <a name="transport-division-of-responsibilities-between-dll-and-service-providers"></a><span data-ttu-id="1c89f-103">Divisão de responsabilidades de transporte entre DLL e provedores de serviços</span><span class="sxs-lookup"><span data-stu-id="1c89f-103">Transport Division of Responsibilities Between DLL and Service Providers</span></span>

<span data-ttu-id="1c89f-104">Esta seção fornece uma visão geral da divisão de responsabilidade entre os \_ provedores de serviço de transporte e32.dll de Ws2.</span><span class="sxs-lookup"><span data-stu-id="1c89f-104">This section provides an overview of the division of responsibility between the Ws2\_32.dll and transport service providers.</span></span>

## <a name="ws2_32dll-functionality-for-transport"></a><span data-ttu-id="1c89f-105">Ws2 \_32.dll funcionalidade para transporte</span><span class="sxs-lookup"><span data-stu-id="1c89f-105">Ws2\_32.dll Functionality for Transport</span></span>

<span data-ttu-id="1c89f-106">A principal tarefa da parte de transporte de dados do \_32.dll Ws2 é servir como Gerenciador de tráfego entre provedores de serviço e aplicativos.</span><span class="sxs-lookup"><span data-stu-id="1c89f-106">The major task of the data transport portion of the Ws2\_32.dll is to serve as traffic manager between service providers and applications.</span></span> <span data-ttu-id="1c89f-107">Com vários provedores de serviços diferentes interagindo com o mesmo aplicativo, cada provedor de serviços interage estritamente com o \_32.dll Ws2.</span><span class="sxs-lookup"><span data-stu-id="1c89f-107">With several different service providers interacting with the same application, each service provider interacts strictly with the Ws2\_32.dll.</span></span> <span data-ttu-id="1c89f-108">A DLL cuida de:</span><span class="sxs-lookup"><span data-stu-id="1c89f-108">The DLL takes care of:</span></span>

-   <span data-ttu-id="1c89f-109">Selecionando um provedor de serviços apropriado para criar soquetes com base em uma descrição de protocolo.</span><span class="sxs-lookup"><span data-stu-id="1c89f-109">Selecting an appropriate service provider for creating sockets based on a protocol description.</span></span>
-   <span data-ttu-id="1c89f-110">Encaminhamento de chamadas de procedimento de aplicativo envolvendo um soquete para o provedor de serviços apropriado que criou ou controla esse soquete.</span><span class="sxs-lookup"><span data-stu-id="1c89f-110">Forwarding application procedure calls involving a socket to the appropriate service provider that created or controls that socket.</span></span> <span data-ttu-id="1c89f-111">Os provedores de serviços não sabem que isso está ocorrendo.</span><span class="sxs-lookup"><span data-stu-id="1c89f-111">Service providers are unaware that any of this is happening.</span></span>

<span data-ttu-id="1c89f-112">Eles não precisam se preocupar com os detalhes da cooperação entre si ou até mesmo a existência de outros provedores de serviços.</span><span class="sxs-lookup"><span data-stu-id="1c89f-112">They do not need to be concerned about the details of cooperating with one another or even the existence of other service providers.</span></span> <span data-ttu-id="1c89f-113">Ao abstrair os provedores de serviço em uma interface de DLL consistente e executar essa função de roteamento de tráfego automático, o ws2 \_32.dll permite que os aplicativos interajam com uma variedade de provedores sem exigir que os aplicativos estejam cientes das divisões entre os provedores, onde provedores diferentes são instalados.</span><span class="sxs-lookup"><span data-stu-id="1c89f-113">By abstracting the service providers into a consistent DLL interface and performing this automatic traffic routing function, the Ws2\_32.dll allows applications to interact with a variety of providers without requiring the applications to be aware of the divisions between providers, where different providers are installed.</span></span>

<span data-ttu-id="1c89f-114">O \_32.dll Ws2 se baseia nos parâmetros das funções de criação de soquete de API ( [**Socket**](/windows/desktop/api/Winsock2/nf-winsock2-socket) e [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa)) para determinar qual provedor de serviços utilizar.</span><span class="sxs-lookup"><span data-stu-id="1c89f-114">The Ws2\_32.dll relies on the parameters of the API socket creation functions ( [**socket**](/windows/desktop/api/Winsock2/nf-winsock2-socket) and [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa)) to determine which service provider to utilize.</span></span> <span data-ttu-id="1c89f-115">O provedor de serviço de transporte selecionado será invocado por meio da função [**WSPSocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket) .</span><span class="sxs-lookup"><span data-stu-id="1c89f-115">The selected transport service provider will be invoked through the [**WSPSocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket) function.</span></span> <span data-ttu-id="1c89f-116">No caso da função **Socket** , o ws2 \_32.dll localiza a primeira entrada no conjunto de estruturas de informações de [**WSAPROTOCOL \_**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) instaladas que corresponde aos valores fornecidos na tupla formada pelos parâmetros (*família de endereços*, tipo de *soquete*, *protocolo*).</span><span class="sxs-lookup"><span data-stu-id="1c89f-116">In the case of the **socket** function, the Ws2\_32.dll finds the first entry in the set of installed [**WSAPROTOCOL\_INFO**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) structures that matches the values supplied in the tuple formed by the (*address family*, *socket type*, *protocol*) parameters.</span></span> <span data-ttu-id="1c89f-117">Para preservar a compatibilidade com versões anteriores, o \_32.dll Ws2 trata o valor de zero para a *família de endereços* ou *tipo de soquete* como um valor curinga.</span><span class="sxs-lookup"><span data-stu-id="1c89f-117">To preserve backward compatibility, the Ws2\_32.dll treats the value of zero for either *address family* or *socket type* as a wildcard value.</span></span> <span data-ttu-id="1c89f-118">O valor de zero para protocolo não é considerado um valor de curinga pelo \_32.dll Ws2, a menos que esse comportamento seja indicado para um protocolo específico, fazendo com que a PFL \_ corresponda o \_ sinalizador zero de protocolo \_ definido na estrutura de **\_ informações de WSAPROTOCOL** .</span><span class="sxs-lookup"><span data-stu-id="1c89f-118">The value of zero for protocol is not considered a wildcard value by the Ws2\_32.dll unless such behavior is indicated for a particular protocol by having the PFL\_MATCHES\_PROTOCOL\_ZERO flag set in the **WSAPROTOCOL\_INFO** structure.</span></span>

<span data-ttu-id="1c89f-119">Para a função [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa) , se NULL for fornecido para *lpProtocolInfo*, o comportamento será exatamente o mesmo descrito para [**Socket**](/windows/desktop/api/Winsock2/nf-winsock2-socket).</span><span class="sxs-lookup"><span data-stu-id="1c89f-119">For the [**WSASocket**](/windows/desktop/api/Winsock2/nf-winsock2-wsasocketa) function, if null is supplied for *lpProtocolInfo*, the behavior is exactly as just described for [**socket**](/windows/desktop/api/Winsock2/nf-winsock2-socket).</span></span> <span data-ttu-id="1c89f-120">No entanto, se uma estrutura de [**\_ informações WSAPROTOCOL**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) for referenciada, o32.dll de ws2 \_ não executará nenhuma função correspondente, mas retransmitirá imediatamente a solicitação de criação de soquete para o provedor de serviços de transporte associado à estrutura de **\_ informações WSAPROTOCOL** indicada.</span><span class="sxs-lookup"><span data-stu-id="1c89f-120">If a [**WSAPROTOCOL\_INFO**](/windows/win32/api/winsock2/ns-winsock2-wsaprotocol_infoa) structure is referenced, however, the Ws2\_32.dll does not perform any matching function but immediately relays the socket creation request to the transport service provider associated with the indicated **WSAPROTOCOL\_INFO** structure.</span></span> <span data-ttu-id="1c89f-121">Os valores da tupla (*família de endereços,* *tipo de soquete*) são fornecidos intactos para o provedor de serviços na função [**WSPSocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket) .</span><span class="sxs-lookup"><span data-stu-id="1c89f-121">The values for the (*address family,* *socket type,*) tuple are supplied intact to the service provider in the [**WSPSocket**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspsocket) function.</span></span> <span data-ttu-id="1c89f-122">Os provedores de serviço são livres para ignorar ou prestar atenção aos valores dos parâmetros (*família de endereços,* *tipo de soquete),* conforme apropriado, mas não devem indicar uma condição de erro quando o valor da *família de endereços* ou tipo de *soquete* for zero.</span><span class="sxs-lookup"><span data-stu-id="1c89f-122">Service providers are free to ignore or pay attention to the values of the (*address family,* *socket type,*) parameters as is appropriate, but they must not indicate an error condition when the value of either *address family* or *socket type* is zero.</span></span> <span data-ttu-id="1c89f-123">Além disso, os provedores de serviço não devem indicar uma condição de erro quando a constante de manifesto das \_ informações de protocolo \_ estiver contida em qualquer um dos parâmetros (*família de endereços,* *tipo de soquete*).</span><span class="sxs-lookup"><span data-stu-id="1c89f-123">In addition, service providers must not indicate an error condition when the manifest constant FROM\_PROTOCOL\_INFO is contained in any of the (*address family,* *socket type,*) parameters.</span></span> <span data-ttu-id="1c89f-124">Esse valor simplesmente indica que o aplicativo deseja usar os valores encontrados nos parâmetros correspondentes da estrutura de **\_ informações de WSAPROTOCOL** : (**iAddressFamily**, **iSocketType**, **iProtocol**).</span><span class="sxs-lookup"><span data-stu-id="1c89f-124">This value simply indicates that the application wishes to use the values found in the corresponding parameters of the **WSAPROTOCOL\_INFO** structure: (**iAddressFamily**, **iSocketType**, **iProtocol**).</span></span>

<span data-ttu-id="1c89f-125">Como parte da criação de soquetes, um provedor de serviços informa o ws2 \_32.dll sobre a associação entre si mesmo e o novo soquete por meio de parâmetros passados para [**WPUCreateSocketHandle**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpucreatesockethandle) ou [**WPUModifyIFSHandle**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpumodifyifshandle).</span><span class="sxs-lookup"><span data-stu-id="1c89f-125">As part of socket creation, a service provider informs the Ws2\_32.dll about the association between itself and the new socket by means of parameters passed to [**WPUCreateSocketHandle**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpucreatesockethandle) or [**WPUModifyIFSHandle**](/windows/desktop/api/Ws2spi/nf-ws2spi-wpumodifyifshandle).</span></span> <span data-ttu-id="1c89f-126">O \_32.dll Ws2 controla essa associação entre identificadores de soquete e provedores de serviço específicos.</span><span class="sxs-lookup"><span data-stu-id="1c89f-126">The Ws2\_32.dll keeps track of this association between socket handles and particular service providers.</span></span> <span data-ttu-id="1c89f-127">Sempre que uma função de interface de aplicativo que se refere a um identificador de soquete é chamada, o ws2 \_32.dll pesquisa a associação e chama a função de interface de provedor de serviço correspondente do provedor de serviços apropriado.</span><span class="sxs-lookup"><span data-stu-id="1c89f-127">Whenever an application interface function that refers to a socket handle is called, the Ws2\_32.dll looks up the association and calls the corresponding service provider interface function of the appropriate service provider.</span></span>

<span data-ttu-id="1c89f-128">Além de seu principal serviço de roteamento de tráfego, o ws2 \_32.dll fornece vários outros serviços, como enumeração de protocolo, gerenciamento de descritor de soquete (alocação, desalocação e Associação de valor de contexto) para provedores de serviço de sistema de arquivos, bloqueando o gerenciamento de gancho por thread, utilitários de troca de bytes, Enfileiramento de chamadas de procedimento assíncronos (APCs) para facilitar a invocação de rotinas de conclusão de e/s e a negociação de versão entre aplicativos e o32.dll de ws2 \_ , bem como entre o ws2 \_32.dll e</span><span class="sxs-lookup"><span data-stu-id="1c89f-128">In addition to its major traffic routing service, the Ws2\_32.dll provides a number of other services such as protocol enumeration, socket descriptor management (allocation, deallocation, and context value association) for nonfile-system service providers, blocking hook management on a per-thread basis, byte-swapping utilities, queuing of asynchronous procedure calls (APCs) to facilitate invocation of I/O completion routines, and version negotiation between applications and the Ws2\_32.dll, as well as between the Ws2\_32.dll and service providers.</span></span>

## <a name="transport-service-provider-functionality"></a><span data-ttu-id="1c89f-129">Funcionalidade do provedor de serviço de transporte</span><span class="sxs-lookup"><span data-stu-id="1c89f-129">Transport Service Provider Functionality</span></span>

<span data-ttu-id="1c89f-130">Os provedores de serviço implementam o protocolo de transporte real que inclui funções como configurar conexões, transferir dados, exercer controle de fluxo e controle de erro, etc. O \_32.dll Ws2 não tem conhecimento sobre como as solicitações para provedores de serviço são realizadas; essa é a implementação do provedor de serviços.</span><span class="sxs-lookup"><span data-stu-id="1c89f-130">Service providers implement the actual transport protocol which includes such functions as setting up connections, transferring data, exercising flow control and error control, etc. The Ws2\_32.dll has no knowledge about how requests to service providers are realized; this is up to the service provider implementation.</span></span> <span data-ttu-id="1c89f-131">A implementação dessas funções pode diferir muito de um provedor para outro.</span><span class="sxs-lookup"><span data-stu-id="1c89f-131">The implementation of such functions may differ greatly from one provider to another.</span></span> <span data-ttu-id="1c89f-132">Os provedores de serviço ocultam os detalhes específicos da implementação de como as operações de rede são realizadas.</span><span class="sxs-lookup"><span data-stu-id="1c89f-132">Service providers hide the implementation-specific details of how network operations are accomplished.</span></span>

<span data-ttu-id="1c89f-133">Os provedores de serviço de transporte podem ser amplamente divididos em duas categorias: aqueles cujos descritores de soquete são identificadores de sistema de arquivos reais (e estão daqui em diante como provedores de IFS (sistema de arquivos instaláveis); o restante é conhecido como provedores não IFS.</span><span class="sxs-lookup"><span data-stu-id="1c89f-133">Transport service providers can be broadly divided into two categories: those whose socket descriptors are real file system handles (and are hereafter referred to as Installable File System (IFS) providers; the remainder are referred to as non-IFS providers.</span></span> <span data-ttu-id="1c89f-134">O ws2 \_32.dll sempre passa o descritor de soquete do provedor do serviço de transporte até o aplicativo do Windows Sockets, para que os aplicativos sejam livres para aproveitar os descritores de soquete que são identificadores do sistema de arquivos, se escolherem.</span><span class="sxs-lookup"><span data-stu-id="1c89f-134">The Ws2\_32.dll always passes the transport service provider's socket descriptor on up to the Windows Sockets application, so applications are free to take advantage of socket descriptors that are file system handles if they so choose.</span></span>

<span data-ttu-id="1c89f-135">Para resumir: os provedores de serviço implementam os protocolos específicos de rede de nível baixo.</span><span class="sxs-lookup"><span data-stu-id="1c89f-135">To summarize: service providers implement the low-level network-specific protocols.</span></span> <span data-ttu-id="1c89f-136">O \_32.dll Ws2 fornece o gerenciamento de tráfego de nível médio que interconecta esses protocolos de transporte com aplicativos.</span><span class="sxs-lookup"><span data-stu-id="1c89f-136">The Ws2\_32.dll provides the medium-level traffic management that interconnects these transport protocols with applications.</span></span> <span data-ttu-id="1c89f-137">Os aplicativos, por sua vez, fornecem a política de como esses fluxos de tráfego e operações específicas de rede são usados para realizar as funções desejadas pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="1c89f-137">Applications in turn provide the policy of how these traffic streams and network-specific operations are used to accomplish the functions desired by the user.</span></span>

 

 
