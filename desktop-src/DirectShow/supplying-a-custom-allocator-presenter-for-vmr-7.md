---
description: Fornecendo um Allocator-Presenter personalizado para o VMR-7
ms.assetid: 19b43c9b-2578-418f-b03b-af7c7a3a46e4
title: Fornecendo um Allocator-Presenter personalizado para o VMR-7
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e79f191401f990214b2551f9210fab4dfe4d43b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104559984"
---
# <a name="supplying-a-custom-allocator-presenter-for-vmr-7"></a><span data-ttu-id="54d12-103">Fornecendo um Allocator-Presenter personalizado para o VMR-7</span><span class="sxs-lookup"><span data-stu-id="54d12-103">Supplying a Custom Allocator-Presenter for VMR-7</span></span>

<span data-ttu-id="54d12-104">O alocador-Presenter é responsável por alocar superfícies do DirectDraw e apresentar os quadros de vídeo para renderização.</span><span class="sxs-lookup"><span data-stu-id="54d12-104">The allocator-presenter is responsible for allocating DirectDraw surfaces and presenting the video frames for rendering.</span></span> <span data-ttu-id="54d12-105">Na grande maioria dos cenários, a funcionalidade do apresentador de alocador padrão será mais do que suficiente para as necessidades de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="54d12-105">In the vast majority of scenarios, the functionality of the default allocator-presenter will be more than sufficient for an application's needs.</span></span> <span data-ttu-id="54d12-106">Mas ao conectar um apresentador de alocador personalizado, um aplicativo pode obter acesso direto aos bits de vídeo e controlar completamente o processo de renderização.</span><span class="sxs-lookup"><span data-stu-id="54d12-106">But by plugging in a custom allocator-presenter, an application can obtain direct access to the video bits and completely control the rendering process.</span></span> <span data-ttu-id="54d12-107">A desvantagem dessa maior potência é que o aplicativo deve lidar com a complexidade adicional do gerenciamento de superfície do DirectDraw.</span><span class="sxs-lookup"><span data-stu-id="54d12-107">The trade-off for this increased power is that the application must handle the added complexity of DirectDraw surface management.</span></span>

![usando um apresentador de alocador personalizado](images/custom-ap.png)

<span data-ttu-id="54d12-109">A figura anterior mostra as interfaces de comunicação usadas pelo VMR e pelo alocador-Presenter.</span><span class="sxs-lookup"><span data-stu-id="54d12-109">The preceding figure shows the communication interfaces used by the VMR and the allocator-presenter.</span></span> <span data-ttu-id="54d12-110">Um apresentador de alocador personalizado que substitui todas as funcionalidades padrão de alocação e apresentação deve implementar as interfaces [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) e [**IVMRSurfaceAllocator**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocator) e, opcionalmente, [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol).</span><span class="sxs-lookup"><span data-stu-id="54d12-110">A custom allocator-presenter that overrides all of the default allocation and presentation functionality must implement the [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) and [**IVMRSurfaceAllocator**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocator) interfaces, and optionally, [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol).</span></span>

<span data-ttu-id="54d12-111">Para substituir o apresentador de alocador padrão, um aplicativo chama o método [**IVMRSurfaceAllocatorNotify:: AdviseSurfaceAllocator**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-advisesurfaceallocator) e passa um ponteiro para o novo apresentador de alocador.</span><span class="sxs-lookup"><span data-stu-id="54d12-111">To replace the default allocator-presenter, an application calls the [**IVMRSurfaceAllocatorNotify::AdviseSurfaceAllocator**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-advisesurfaceallocator) method and passes in a pointer to the new allocator-presenter.</span></span> <span data-ttu-id="54d12-112">Em resposta a essa chamada, o VMR chamará o método [**IVMRSurfaceAllocator:: AdviseNotify**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocator-advisenotify) do apresentador-Presenter para fornecer o ponteiro para a interface [**IVMRSurfaceAllocatorNotify**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocatornotify) do VMR.</span><span class="sxs-lookup"><span data-stu-id="54d12-112">In response to this call, the VMR will call the allocator-presenter's [**IVMRSurfaceAllocator::AdviseNotify**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocator-advisenotify) method to provide the pointer to the VMR's [**IVMRSurfaceAllocatorNotify**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocatornotify) interface.</span></span> <span data-ttu-id="54d12-113">O apresentador de alocador usará esse ponteiro de interface ao passar eventos para o VMR com o método [**IVMRSurfaceAllocatorNotify:: NotifyEvent**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-notifyevent) .</span><span class="sxs-lookup"><span data-stu-id="54d12-113">The allocator-presenter will use this interface pointer when passing events to the VMR with the [**IVMRSurfaceAllocatorNotify::NotifyEvent**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-notifyevent) method.</span></span>

<span data-ttu-id="54d12-114">Como uma solução alternativa, um aplicativo pode usar seu próprio apresentador de alocador e o apresentador de alocador padrão.</span><span class="sxs-lookup"><span data-stu-id="54d12-114">As an alternate solution, an application can use both its own allocator-presenter and the default allocator-presenter.</span></span> <span data-ttu-id="54d12-115">Nesse cenário, o apresentador de alocador personalizado trata apenas das chamadas em que a funcionalidade personalizada é necessária e passa o restante das chamadas do VMR até o alocador de origem padrão.</span><span class="sxs-lookup"><span data-stu-id="54d12-115">In this scenario, the custom allocator-presenter handles only those calls where custom functionality is needed, and passes the rest of the calls from the VMR through to the default allocator-presenter.</span></span> <span data-ttu-id="54d12-116">Em muitos casos, só é necessário substituir a interface [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) .</span><span class="sxs-lookup"><span data-stu-id="54d12-116">In many cases, it is only necessary to override the [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) interface.</span></span>

![usando dois alocadores-apresentadores](images/custom-ap2.png)

<span data-ttu-id="54d12-118">Para usar um apresentador de alocador personalizado e o apresentador de alocador padrão, um aplicativo primeiro chamaria [**IVMRSurfaceAllocatorNotify:: AdviseSurfaceAllocator**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-advisesurfaceallocator) para fornecer um ponteiro para o novo apresentador de alocador.</span><span class="sxs-lookup"><span data-stu-id="54d12-118">To use both a custom allocator-presenter and the default allocator-presenter, an application would first call [**IVMRSurfaceAllocatorNotify::AdviseSurfaceAllocator**](/windows/desktop/api/Strmif/nf-strmif-ivmrsurfaceallocatornotify-advisesurfaceallocator) to provide a pointer to the new allocator-presenter.</span></span> <span data-ttu-id="54d12-119">Isso faz com que o apresentador de alocador padrão seja destruído e, portanto, o aplicativo deve criar outra instância dele chamando **QueryInterface** no VMR e solicitando a interface [**IVMRSurfaceAllocator**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocator) .</span><span class="sxs-lookup"><span data-stu-id="54d12-119">This causes the default allocator-presenter to be destroyed, so the application must create another instance of it by calling **QueryInterface** on the VMR and requesting the [**IVMRSurfaceAllocator**](/windows/desktop/api/Strmif/nn-strmif-ivmrsurfaceallocator) interface.</span></span> <span data-ttu-id="54d12-120">Conforme mostrado na figura anterior, o apresentador de alocador personalizado substitui os métodos de interface [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) e simplesmente passa todas as chamadas para a interface **IVMRSurfaceAllocator** para a implementação padrão.</span><span class="sxs-lookup"><span data-stu-id="54d12-120">As shown in the preceding figure, the custom allocator-presenter overrides the [**IVMRImagePresenter**](/windows/desktop/api/Strmif/nn-strmif-ivmrimagepresenter) interface methods, and simply passes all calls to the **IVMRSurfaceAllocator** interface through to the default implementation.</span></span> <span data-ttu-id="54d12-121">A figura também mostra a interface [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol) como sendo implementada no apresentador de alocador.</span><span class="sxs-lookup"><span data-stu-id="54d12-121">The figure also shows the [**IVMRWindowlessControl**](/windows/desktop/api/Strmif/nn-strmif-ivmrwindowlesscontrol) interface as being implemented on the allocator-presenter.</span></span>

## <a name="related-topics"></a><span data-ttu-id="54d12-122">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="54d12-122">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="54d12-123">Fornecendo um Allocator-Presenter personalizado para o VMR-9</span><span class="sxs-lookup"><span data-stu-id="54d12-123">Supplying a Custom Allocator-Presenter for VMR-9</span></span>](supplying-a-custom-allocator-presenter-for-vmr-9.md)
</dt> <dt>

[<span data-ttu-id="54d12-124">Modo de reprodução do VMR (alocador personalizado-apresentadores)</span><span class="sxs-lookup"><span data-stu-id="54d12-124">VMR Renderless Playback Mode (Custom Allocator-Presenters)</span></span>](vmr-renderless-playback-mode--custom-allocator-presenters.md)
</dt> </dl>

 

 



