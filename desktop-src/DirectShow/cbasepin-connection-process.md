---
description: Processo de conexão do CBasePin
ms.assetid: 4b3a9023-0267-4caa-9d89-88237009df05
title: Processo de conexão do CBasePin
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1441b0daba58857e00da0139d3312fb277287fc2
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/06/2021
ms.locfileid: "103919872"
---
# <a name="cbasepin-connection-process"></a><span data-ttu-id="42f1e-103">Processo de conexão do CBasePin</span><span class="sxs-lookup"><span data-stu-id="42f1e-103">CBasePin Connection Process</span></span>

<span data-ttu-id="42f1e-104">Esta seção descreve como a classe [**CBasePin**](cbasepin.md) implementa o processo de conexão do PIN.</span><span class="sxs-lookup"><span data-stu-id="42f1e-104">This section describes how the [**CBasePin**](cbasepin.md) class implements the pin connection process.</span></span>

<span data-ttu-id="42f1e-105">O Gerenciador de gráfico de filtro inicia todas as conexões de PIN.</span><span class="sxs-lookup"><span data-stu-id="42f1e-105">The Filter Graph Manager initiates all pin connections.</span></span> <span data-ttu-id="42f1e-106">Ele chama o método [**IPin:: Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) do pino de saída, especificando o pino de entrada.</span><span class="sxs-lookup"><span data-stu-id="42f1e-106">It calls the output pin's [**IPin::Connect**](/windows/desktop/api/Strmif/nf-strmif-ipin-connect) method, specifying the input pin.</span></span> <span data-ttu-id="42f1e-107">O pino de saída conclui a conexão chamando o método [**IPin:: ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) do pino de entrada.</span><span class="sxs-lookup"><span data-stu-id="42f1e-107">The output pin completes the connection by calling the input pin's [**IPin::ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) method.</span></span> <span data-ttu-id="42f1e-108">O PIN de entrada pode aceitar ou rejeitar a conexão.</span><span class="sxs-lookup"><span data-stu-id="42f1e-108">The input pin can accept or reject the connection.</span></span>

<span data-ttu-id="42f1e-109">O Gerenciador do grafo de filtro também pode especificar um tipo de mídia para a conexão.</span><span class="sxs-lookup"><span data-stu-id="42f1e-109">The Filter Graph Manager can also specify a media type for the connection.</span></span> <span data-ttu-id="42f1e-110">Nesse caso, os Pins tentam se conectar com esse tipo.</span><span class="sxs-lookup"><span data-stu-id="42f1e-110">If so, the pins try to connect with that type.</span></span> <span data-ttu-id="42f1e-111">Caso contrário, os Pins devem negociar o tipo.</span><span class="sxs-lookup"><span data-stu-id="42f1e-111">If not, the pins must negotiate the type.</span></span> <span data-ttu-id="42f1e-112">O Gerenciador do grafo de filtro também pode especificar um tipo de mídia *parcial* , que tem o valor GUID \_ NULL para o tipo principal, subtipo ou tipo de formato.</span><span class="sxs-lookup"><span data-stu-id="42f1e-112">The Filter Graph Manager may also specify a *partial* media type, which has the value GUID\_NULL for either the major type, subtype, or format type.</span></span> <span data-ttu-id="42f1e-113">Nesse caso, os Pins tentam corresponder a qualquer parte do tipo de mídia especificada; o valor de GUID \_ NULL funciona como um caractere curinga.</span><span class="sxs-lookup"><span data-stu-id="42f1e-113">In that case, the pins try to match whichever portions of the media type were specified; the value GUID\_NULL acts as a wildcard.</span></span>

<span data-ttu-id="42f1e-114">O método [**CBasePin:: Connect**](cbasepin-connect.md) começa verificando se o PIN pode aceitar uma conexão.</span><span class="sxs-lookup"><span data-stu-id="42f1e-114">The [**CBasePin::Connect**](cbasepin-connect.md) method starts by verifying that the pin can accept a connection.</span></span> <span data-ttu-id="42f1e-115">Por exemplo, ele verifica se o PIN ainda não está conectado.</span><span class="sxs-lookup"><span data-stu-id="42f1e-115">For example, it checks that the pin is not already connected.</span></span> <span data-ttu-id="42f1e-116">Ele delega o restante do processo de conexão para o método [**CBasePin:: AgreeMediaType**](cbasepin-agreemediatype.md) .</span><span class="sxs-lookup"><span data-stu-id="42f1e-116">It delegates the rest of the connection process to the [**CBasePin::AgreeMediaType**](cbasepin-agreemediatype.md) method.</span></span> <span data-ttu-id="42f1e-117">Tudo o que segue é executado pelo **AgreeMediaType**.</span><span class="sxs-lookup"><span data-stu-id="42f1e-117">Everything that follows is performed by **AgreeMediaType**.</span></span>

<span data-ttu-id="42f1e-118">Se o tipo de mídia for totalmente especificado, o PIN chamará o método [**CBasePin:: AttemptConnection**](cbasepin-attemptconnection.md) para tentar a conexão.</span><span class="sxs-lookup"><span data-stu-id="42f1e-118">If the media type is fully specified, the pin calls the [**CBasePin::AttemptConnection**](cbasepin-attemptconnection.md) method to attempt the connection.</span></span> <span data-ttu-id="42f1e-119">Caso contrário, ele tentará os tipos de mídia na seguinte ordem:</span><span class="sxs-lookup"><span data-stu-id="42f1e-119">Otherwise, it tries media types in the following order:</span></span>

1.  <span data-ttu-id="42f1e-120">Os tipos preferenciais do pino de entrada.</span><span class="sxs-lookup"><span data-stu-id="42f1e-120">The input pin's preferred types.</span></span>
2.  <span data-ttu-id="42f1e-121">Os tipos preferenciais do pino de saída.</span><span class="sxs-lookup"><span data-stu-id="42f1e-121">The output pin's preferred types.</span></span>

<span data-ttu-id="42f1e-122">Você pode reverter essa ordem definindo o sinalizador [**CBasePin:: m \_ BTryMyTypesFirst**](cbasepin-m-btrymytypesfirst.md) como **true**.</span><span class="sxs-lookup"><span data-stu-id="42f1e-122">You can reverse this order by setting the [**CBasePin::m\_bTryMyTypesFirst**](cbasepin-m-btrymytypesfirst.md) flag to **TRUE**.</span></span>

<span data-ttu-id="42f1e-123">Em cada caso, o PIN chama [**IPin:: EnumMediaTypes**](/windows/desktop/api/Strmif/nf-strmif-ipin-enummediatypes) para enumerar os tipos de mídia.</span><span class="sxs-lookup"><span data-stu-id="42f1e-123">In each case, the pin calls [**IPin::EnumMediaTypes**](/windows/desktop/api/Strmif/nf-strmif-ipin-enummediatypes) to enumerate the media types.</span></span> <span data-ttu-id="42f1e-124">Esse método recupera um objeto Enumerator, que é passado para o método [**CBasePin:: TryMediaTypes**](cbasepin-trymediatypes.md) .</span><span class="sxs-lookup"><span data-stu-id="42f1e-124">This method retrieves an enumerator object, which is passed to the [**CBasePin::TryMediaTypes**](cbasepin-trymediatypes.md) method.</span></span> <span data-ttu-id="42f1e-125">O método **TryMediaTypes** percorre cada tipo de mídia e chama [**AttemptConnection**](cbasepin-attemptconnection.md) para cada tipo.</span><span class="sxs-lookup"><span data-stu-id="42f1e-125">The **TryMediaTypes** method loops through each media type and calls [**AttemptConnection**](cbasepin-attemptconnection.md) for each type.</span></span>

<span data-ttu-id="42f1e-126">Dentro do método [**AttemptConnection**](cbasepin-attemptconnection.md) , o pino de saída chama os seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="42f1e-126">Within the [**AttemptConnection**](cbasepin-attemptconnection.md) method, the output pin calls the following methods:</span></span>

-   <span data-ttu-id="42f1e-127">Ele chama [**CBasePin:: CheckConnect**](cbasepin-checkconnect.md) em si mesmo, para verificar se o PIN de entrada é adequado.</span><span class="sxs-lookup"><span data-stu-id="42f1e-127">It calls [**CBasePin::CheckConnect**](cbasepin-checkconnect.md) on itself, to check whether the input pin is suitable.</span></span>
-   <span data-ttu-id="42f1e-128">Ele chama [**CBasePin:: CheckMediaType**](cbasepin-checkmediatype.md) , para validar o tipo de mídia.</span><span class="sxs-lookup"><span data-stu-id="42f1e-128">It calls [**CBasePin::CheckMediaType**](cbasepin-checkmediatype.md) on itself, to validate the media type.</span></span>
-   <span data-ttu-id="42f1e-129">Ele chama [**IPin:: ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) no pino de entrada.</span><span class="sxs-lookup"><span data-stu-id="42f1e-129">It calls [**IPin::ReceiveConnection**](/windows/desktop/api/Strmif/nf-strmif-ipin-receiveconnection) on the input pin.</span></span> <span data-ttu-id="42f1e-130">O PIN de entrada usa esse método para determinar se ele deve aceitar a conexão.</span><span class="sxs-lookup"><span data-stu-id="42f1e-130">The input pin uses this method to determine whether it should accept the connection.</span></span>
-   <span data-ttu-id="42f1e-131">Ele chama [**CBasePin:: CompleteConnect**](cbasepin-completeconnect.md) sozinho para concluir a conexão.</span><span class="sxs-lookup"><span data-stu-id="42f1e-131">It calls [**CBasePin::CompleteConnect**](cbasepin-completeconnect.md) on itself to completes the connection.</span></span>

<span data-ttu-id="42f1e-132">Observe o seguinte:</span><span class="sxs-lookup"><span data-stu-id="42f1e-132">Note the following:</span></span>

-   <span data-ttu-id="42f1e-133">[**CheckConnect**](cbasepin-checkconnect.md) é um método virtual.</span><span class="sxs-lookup"><span data-stu-id="42f1e-133">[**CheckConnect**](cbasepin-checkconnect.md) is a virtual method.</span></span> <span data-ttu-id="42f1e-134">Na classe base, esse método verifica se as direções do PIN são compatíveis.</span><span class="sxs-lookup"><span data-stu-id="42f1e-134">In the base class, this method checks whether the pin directions are compatible.</span></span> <span data-ttu-id="42f1e-135">Os Pins de saída devem se conectar aos pins de entrada, e vice-versa.</span><span class="sxs-lookup"><span data-stu-id="42f1e-135">Output pins must connect to input pins, and vice versa.</span></span> <span data-ttu-id="42f1e-136">A classe PIN derivada normalmente substituirá esse método para executar outras verificações.</span><span class="sxs-lookup"><span data-stu-id="42f1e-136">The derived pin class will typically override this method to perform other checks.</span></span> <span data-ttu-id="42f1e-137">Por exemplo, ele pode consultar o outro PIN para uma interface que é necessária para a conexão.</span><span class="sxs-lookup"><span data-stu-id="42f1e-137">For example, it might query the other pin for an interface that is required for the connection.</span></span> <span data-ttu-id="42f1e-138">Se a classe derivada substituir **CheckConnect**, ela também deverá chamar o método [**CBasePin**](cbasepin.md) .</span><span class="sxs-lookup"><span data-stu-id="42f1e-138">If the derived class overrides **CheckConnect**, it should also call the [**CBasePin**](cbasepin.md) method.</span></span>
-   <span data-ttu-id="42f1e-139">[**CheckMediaType**](cbasepin-checkmediatype.md) é um método virtual puro, que a classe derivada deve implementar.</span><span class="sxs-lookup"><span data-stu-id="42f1e-139">[**CheckMediaType**](cbasepin-checkmediatype.md) is a pure virtual method, which the derived class must implement.</span></span>
-   <span data-ttu-id="42f1e-140">[**CompleteConnect**](cbasepin-completeconnect.md) é um método virtual que não faz nada na classe base.</span><span class="sxs-lookup"><span data-stu-id="42f1e-140">[**CompleteConnect**](cbasepin-completeconnect.md) is a virtual method that does nothing in the base class.</span></span> <span data-ttu-id="42f1e-141">As classes derivadas podem substituir esse método para executar qualquer trabalho adicional necessário para concluir a conexão, como a decisão de um alocador de memória.</span><span class="sxs-lookup"><span data-stu-id="42f1e-141">Derived classes can override this method to perform any additional work needed to complete the connection, such as deciding a memory allocator.</span></span>

<span data-ttu-id="42f1e-142">Se qualquer uma dessas etapas falhar, o pino de saída chamará o método [**CBasePin:: BreakConnect**](cbasepin-breakconnect.md) para desfazer quaisquer etapas executadas pelo [**CheckConnect**](cbasepin-checkconnect.md).</span><span class="sxs-lookup"><span data-stu-id="42f1e-142">If any of these steps fails, the output pin calls the [**CBasePin::BreakConnect**](cbasepin-breakconnect.md) method to undo whatever steps were taken by [**CheckConnect**](cbasepin-checkconnect.md).</span></span>

<span data-ttu-id="42f1e-143">O método [**ReceiveConnection**](cbasepin-receiveconnection.md) do pino de entrada chama os métodos [**CheckConnect**](cbasepin-checkconnect.md), [**CheckMediaType**](cbasepin-checkmediatype.md)e [**CompleteConnect**](cbasepin-completeconnect.md) do pino de entrada.</span><span class="sxs-lookup"><span data-stu-id="42f1e-143">The input pin's [**ReceiveConnection**](cbasepin-receiveconnection.md) method calls the input pin's [**CheckConnect**](cbasepin-checkconnect.md), [**CheckMediaType**](cbasepin-checkmediatype.md), and [**CompleteConnect**](cbasepin-completeconnect.md) methods.</span></span> <span data-ttu-id="42f1e-144">Se qualquer uma delas falhar, a tentativa de conexão também falhará.</span><span class="sxs-lookup"><span data-stu-id="42f1e-144">If any of these fail, the connection attempt also fails.</span></span>

<span data-ttu-id="42f1e-145">O diagrama a seguir mostra o processo de conexão no [**CBasePin**](cbasepin.md):</span><span class="sxs-lookup"><span data-stu-id="42f1e-145">The following diagram shows the connection process in [**CBasePin**](cbasepin.md):</span></span>

![processo de conexão do CBasePin](images/cbasepin-connect.png)

## <a name="related-topics"></a><span data-ttu-id="42f1e-147">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="42f1e-147">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="42f1e-148">**CBasePin**</span><span class="sxs-lookup"><span data-stu-id="42f1e-148">**CBasePin**</span></span>](cbasepin.md)
</dt> </dl>

 

 



