---
description: Carimbos de Data/Hora
ms.assetid: 445fe6b9-9d5b-45fd-9c9e-8c632c5228ae
title: Carimbos de Data/Hora
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 855d2c472d7964ccad6ec8bbc87efd39b1c4cdd6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105779833"
---
# <a name="time-stamps"></a><span data-ttu-id="28a96-103">Carimbos de Data/Hora</span><span class="sxs-lookup"><span data-stu-id="28a96-103">Time Stamps</span></span>

<span data-ttu-id="28a96-104">O *carimbo de data/hora* define as horas de início e término de um exemplo de mídia, medido em tempo de fluxo.</span><span class="sxs-lookup"><span data-stu-id="28a96-104">The *time stamp* defines a media sample's start and finish times, measured in stream time.</span></span> <span data-ttu-id="28a96-105">O carimbo de data/hora é, às vezes, chamado de *tempo de apresentação*.</span><span class="sxs-lookup"><span data-stu-id="28a96-105">The time stamp is sometimes called the *presentation time*.</span></span> <span data-ttu-id="28a96-106">Ao ler o restante deste artigo, é importante lembrar que nem todos os formatos usam carimbos de data/hora da mesma maneira.</span><span class="sxs-lookup"><span data-stu-id="28a96-106">When reading the rest of this article, it is important to remember that not all formats use time stamps in the same way.</span></span> <span data-ttu-id="28a96-107">Por exemplo, nem todas as amostras MPEG são carimbadas por tempo.</span><span class="sxs-lookup"><span data-stu-id="28a96-107">For example, not all MPEG samples are time stamped.</span></span> <span data-ttu-id="28a96-108">Em gráficos de filtro MPEG, o carimbo de data/hora não é aplicado a cada quadro até que eles sejam impressos do decodificador.</span><span class="sxs-lookup"><span data-stu-id="28a96-108">In MPEG filter graphs, the time stamp is not applied to each frame until they are output from the decoder.</span></span>

<span data-ttu-id="28a96-109">Quando um filtro de renderizador recebe um exemplo, ele agenda a renderização com base no carimbo de data/hora.</span><span class="sxs-lookup"><span data-stu-id="28a96-109">When a renderer filter receives a sample, it schedules rendering based on the time stamp.</span></span> <span data-ttu-id="28a96-110">Se o exemplo chegar atrasado ou não tiver carimbo de data/hora, o filtro renderizará o exemplo imediatamente.</span><span class="sxs-lookup"><span data-stu-id="28a96-110">If the sample arrives late, or has no time stamp, the filter renders the sample immediately.</span></span> <span data-ttu-id="28a96-111">Caso contrário, o filtro aguardará até a hora de início da amostra antes de renderizar o exemplo.</span><span class="sxs-lookup"><span data-stu-id="28a96-111">Otherwise, the filter waits until the sample's start time before it renders the sample.</span></span> <span data-ttu-id="28a96-112">(Ele aguarda a hora de início chamando o método [**IReferenceClock:: aconselhetime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-advisetime) .)</span><span class="sxs-lookup"><span data-stu-id="28a96-112">(It waits for the start time by calling the [**IReferenceClock::AdviseTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-advisetime) method.)</span></span>

<span data-ttu-id="28a96-113">Filtros de origem e filtros do analisador são responsáveis por definir os carimbos de data/hora corretos nos exemplos que eles processam.</span><span class="sxs-lookup"><span data-stu-id="28a96-113">Source filters and parser filters are responsible for setting the correct time stamps on the samples they process.</span></span> <span data-ttu-id="28a96-114">Use as diretrizes a seguir.</span><span class="sxs-lookup"><span data-stu-id="28a96-114">Use the following guidelines.</span></span>

-   <span data-ttu-id="28a96-115">Reprodução de arquivo: a primeira amostra é a hora carimbada com uma hora de início igual a zero.</span><span class="sxs-lookup"><span data-stu-id="28a96-115">File playback: The first sample is time stamped with a start time of zero.</span></span> <span data-ttu-id="28a96-116">Os carimbos de data/hora subsequentes são determinados pelo tamanho da amostra e pela taxa de reprodução, que é determinada pelo formato de arquivo.</span><span class="sxs-lookup"><span data-stu-id="28a96-116">Subsequent time stamps are determined by the sample length and the playback rate, which itself is determined by the file format.</span></span> <span data-ttu-id="28a96-117">O filtro que analisa o arquivo é responsável por calcular os carimbos de data/hora corretos (por exemplo, o [divisor AVI](avi-splitter-filter.md)).</span><span class="sxs-lookup"><span data-stu-id="28a96-117">The filter that parses the file is responsible for calculating the correct time stamps (for example, the [AVI Splitter](avi-splitter-filter.md)).</span></span>
-   <span data-ttu-id="28a96-118">Captura de vídeo e áudio: cada amostra é o tempo marcado com uma hora de início igual ao tempo de transmissão quando foi capturado, com as seguintes advertências:</span><span class="sxs-lookup"><span data-stu-id="28a96-118">Video and audio capture: Every sample is time stamped with a start time equal to the stream time when it was captured, with the following caveats:</span></span>
    -   <span data-ttu-id="28a96-119">Os quadros de vídeo de um pino de visualização (em oposição a um PIN de captura) não são marcados com o tempo.</span><span class="sxs-lookup"><span data-stu-id="28a96-119">Video frames from a preview pin (as opposed to a capture pin) are not time stamped.</span></span> <span data-ttu-id="28a96-120">Devido à latência do grafo, um quadro de vídeo que é carimbado com o tempo de captura sempre chegará ao final do processador de vídeo.</span><span class="sxs-lookup"><span data-stu-id="28a96-120">Because of graph latency, a video frame that is stamped with the capture time will always arrive late at the video renderer.</span></span> <span data-ttu-id="28a96-121">Isso pode fazer com que o renderizador descarte os quadros, em uma tentativa de controle de qualidade.</span><span class="sxs-lookup"><span data-stu-id="28a96-121">This may cause the renderer to drop frames, in an attempt at quality control.</span></span> <span data-ttu-id="28a96-122">Para obter informações sobre o controle de qualidade, consulte [Gerenciamento de controle de qualidade](quality-control-management.md).</span><span class="sxs-lookup"><span data-stu-id="28a96-122">For information about quality control, see [Quality-Control Management](quality-control-management.md).</span></span>
    -   <span data-ttu-id="28a96-123">Captura de áudio: o filtro de captura de áudio usa seu próprio conjunto de buffers, que são separados daqueles usados pelo driver de áudio.</span><span class="sxs-lookup"><span data-stu-id="28a96-123">Audio capture: The audio capture filter uses its own set of buffers, which are separate from those used by the audio driver.</span></span> <span data-ttu-id="28a96-124">O driver de áudio preenche os buffers do filtro de captura em intervalos fixos.</span><span class="sxs-lookup"><span data-stu-id="28a96-124">The audio driver fills the capture filter's buffers at fixed intervals.</span></span> <span data-ttu-id="28a96-125">O intervalo depende do driver, mas geralmente não tem mais de 10 milissegundos.</span><span class="sxs-lookup"><span data-stu-id="28a96-125">The interval depends on the driver, but generally is not more than 10 milliseconds.</span></span> <span data-ttu-id="28a96-126">Os carimbos de data/hora nos exemplos de áudio refletem a hora em que o driver preencheu os buffers do filtro de captura de áudio.</span><span class="sxs-lookup"><span data-stu-id="28a96-126">The time stamps on the audio samples reflect the time when the driver filled the audio capture filter's buffers.</span></span> <span data-ttu-id="28a96-127">Esses horários podem ser um pouco imprecisos, especialmente se o aplicativo estiver usando um tamanho de buffer muito pequeno.</span><span class="sxs-lookup"><span data-stu-id="28a96-127">These times can be slightly inaccurate, especially if the application is using a very small buffer size.</span></span> <span data-ttu-id="28a96-128">No entanto, os horários de mídia refletirão com precisão o número de amostras de áudio no buffer.</span><span class="sxs-lookup"><span data-stu-id="28a96-128">However, the media times will accurately reflect the number audio samples in the buffer.</span></span>
-   <span data-ttu-id="28a96-129">Filtros MUX: dependendo do formato de saída, um filtro Mux pode precisar gerar carimbos de data/hora ou talvez não.</span><span class="sxs-lookup"><span data-stu-id="28a96-129">Mux filters: Depending on the output format, a mux filter may need to generate time stamps, or it may not.</span></span> <span data-ttu-id="28a96-130">Por exemplo, o formato de arquivo AVI usa uma taxa de quadros fixa sem carimbos de data/hora, portanto, o filtro [AVI Mux](avi-mux-filter.md) assume que as amostras chegam em aproximadamente a hora certa.</span><span class="sxs-lookup"><span data-stu-id="28a96-130">For example, the AVI file format uses a fixed frame rate with no time stamps, so the [AVI Mux](avi-mux-filter.md) filter assumes that samples are arriving at approximately the right time.</span></span> <span data-ttu-id="28a96-131">No entanto, se os carimbos de hora de entrada mostrarem uma lacuna maior do que um quadro, o AVI Mux gravará uma entrada de índice com o tamanho zero, para indicar um quadro Descartado.</span><span class="sxs-lookup"><span data-stu-id="28a96-131">If the incoming time stamps show a gap larger than one frame, however, the AVI Mux writes an index entry with size zero, to indicate a dropped frame.</span></span> <span data-ttu-id="28a96-132">Na reprodução do arquivo, novos carimbos de data/hora são gerados em tempo de execução, conforme descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="28a96-132">On file playback, new time stamps are generated at run time, as described previously.</span></span>

<span data-ttu-id="28a96-133">Para definir o carimbo de data/hora em um exemplo, chame o método [**IMediaSample:: SetTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-settime) .</span><span class="sxs-lookup"><span data-stu-id="28a96-133">To set the time stamp on a sample, call the [**IMediaSample::SetTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-settime) method.</span></span>

<span data-ttu-id="28a96-134">**Horários de mídia**</span><span class="sxs-lookup"><span data-stu-id="28a96-134">**Media Times**</span></span>

<span data-ttu-id="28a96-135">Opcionalmente, o filtro também pode especificar um *tempo de mídia* para o exemplo.</span><span class="sxs-lookup"><span data-stu-id="28a96-135">Optionally, the filter can also specify a *media time* for the sample.</span></span> <span data-ttu-id="28a96-136">Em um fluxo de vídeo, o tempo de mídia representa o número do quadro.</span><span class="sxs-lookup"><span data-stu-id="28a96-136">In a video stream, media time represents the frame number.</span></span> <span data-ttu-id="28a96-137">Em um fluxo de áudio, o tempo de mídia representa o número de exemplo no pacote.</span><span class="sxs-lookup"><span data-stu-id="28a96-137">In an audio stream, media time represents the sample number in the packet.</span></span> <span data-ttu-id="28a96-138">Por exemplo, se cada pacote contiver um segundo áudio de 44,1 kilohertz (kHz), o primeiro pacote terá uma hora de início de mídia igual a zero e uma hora de parada de mídia de 44100.</span><span class="sxs-lookup"><span data-stu-id="28a96-138">For example, if each packet contains one second of 44.1 kilohertz (kHz) audio, the first packet has a media start time of zero and a media stop time of 44100.</span></span> <span data-ttu-id="28a96-139">Em um fluxo pesquisável, o tempo de mídia é sempre relativo à hora de início do fluxo.</span><span class="sxs-lookup"><span data-stu-id="28a96-139">In a seekable stream, the media time is always relative to the start time of the stream.</span></span> <span data-ttu-id="28a96-140">Por exemplo, suponha que você busque 2 segundos desde o início de um fluxo de vídeo de 15 fps.</span><span class="sxs-lookup"><span data-stu-id="28a96-140">For example, suppose you seek to 2 seconds from the start of a 15-fps video stream.</span></span> <span data-ttu-id="28a96-141">O primeiro exemplo de mídia após a busca tem um carimbo de data/hora igual a zero, mas um tempo de mídia de 30.</span><span class="sxs-lookup"><span data-stu-id="28a96-141">The first media sample after the seek has a time stamp of zero but a media time of 30.</span></span>

<span data-ttu-id="28a96-142">Os filtros de renderizador e MUX podem usar o tempo de mídia para determinar se os quadros ou amostras foram descartados, verificando se há lacunas.</span><span class="sxs-lookup"><span data-stu-id="28a96-142">Renderer and mux filters can use the media time to determine whether frames or samples have been dropped, by checking for gaps.</span></span> <span data-ttu-id="28a96-143">No entanto, os filtros não são necessários para definir o tempo de mídia.</span><span class="sxs-lookup"><span data-stu-id="28a96-143">However, filters are not required to set the media time.</span></span> <span data-ttu-id="28a96-144">Para definir o tempo de mídia em um exemplo, chame o método [**IMediaSample:: SetMediaTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-setmediatime) .</span><span class="sxs-lookup"><span data-stu-id="28a96-144">To set the media time on a sample, call the [**IMediaSample::SetMediaTime**](/windows/desktop/api/Strmif/nf-strmif-imediasample-setmediatime) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="28a96-145">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="28a96-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="28a96-146">Tempo e relógios no DirectShow</span><span class="sxs-lookup"><span data-stu-id="28a96-146">Time and Clocks in DirectShow</span></span>](time-and-clocks-in-directshow.md)
</dt> </dl>

 

 



