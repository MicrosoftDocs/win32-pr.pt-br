---
description: Tipos de mídia DMO
ms.assetid: 40958e12-09c7-4ce5-aa4d-5ed8b1f40aa3
title: Tipos de mídia DMO
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1997abb1cc3c8eb10301778982ef7a46690855ed
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/03/2021
ms.locfileid: "104506360"
---
# <a name="dmo-media-types"></a><span data-ttu-id="f8775-103">Tipos de mídia DMO</span><span class="sxs-lookup"><span data-stu-id="f8775-103">DMO Media Types</span></span>

<span data-ttu-id="f8775-104">Um tipo de mídia descreve o formato associado a um fluxo de dados de mídia.</span><span class="sxs-lookup"><span data-stu-id="f8775-104">A media type describes the format associated with a stream of media data.</span></span> <span data-ttu-id="f8775-105">Este artigo descreve como o DMOs lida com tipos de mídia.</span><span class="sxs-lookup"><span data-stu-id="f8775-105">This article describes how DMOs handle media types.</span></span> <span data-ttu-id="f8775-106">Ele destina-se principalmente a desenvolvedores que estão escrevendo seu próprio DMOs personalizado.</span><span class="sxs-lookup"><span data-stu-id="f8775-106">It is primarily intended for developers who are writing their own custom DMOs.</span></span>

<span data-ttu-id="f8775-107">Os tipos de mídia são definidos usando a estrutura do [**\_ \_ tipo de mídia DMO**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) .</span><span class="sxs-lookup"><span data-stu-id="f8775-107">Media types are defined using the [**DMO\_MEDIA\_TYPE**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_media_type) structure.</span></span> <span data-ttu-id="f8775-108">Essa estrutura inclui as seguintes informações:</span><span class="sxs-lookup"><span data-stu-id="f8775-108">This structure includes the following information:</span></span>

-   <span data-ttu-id="f8775-109">O *tipo principal* é um GUID (identificador global exclusivo) que define uma categoria ampla, como áudio ou vídeo.</span><span class="sxs-lookup"><span data-stu-id="f8775-109">The *major type* is a globally unique identifier (GUID) that defines a broad category, such as audio or video.</span></span>
-   <span data-ttu-id="f8775-110">O *subtipo* é um GUID que define aspectos mais específicos do tipo.</span><span class="sxs-lookup"><span data-stu-id="f8775-110">The *subtype* is a GUID that defines more specific aspects of the type.</span></span> <span data-ttu-id="f8775-111">Por exemplo, no vídeo, os subtipos incluem RGB de 16 bits, RGB de 24 bits, UYVY, vídeo codificado por DV e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="f8775-111">For example, within video, the subtypes include 16-bit RGB, 24-bit RGB, UYVY, DV-encoded video, and so forth.</span></span>
-   <span data-ttu-id="f8775-112">O *bloco de formato* é uma estrutura secundária que especifica totalmente o formato.</span><span class="sxs-lookup"><span data-stu-id="f8775-112">The *format block* is a secondary structure that fully specifies the format.</span></span> <span data-ttu-id="f8775-113">O layout do bloco de formato depende do tipo de dados.</span><span class="sxs-lookup"><span data-stu-id="f8775-113">The layout of the format block depends on the type of data.</span></span> <span data-ttu-id="f8775-114">Por exemplo, o áudio PCM usa a estrutura **WAVEFORMATEX** .</span><span class="sxs-lookup"><span data-stu-id="f8775-114">For example, PCM audio uses the **WAVEFORMATEX** structure.</span></span> <span data-ttu-id="f8775-115">O vídeo usa várias outras estruturas, incluindo **VIDEOINFOHEADER** e **VIDEOINFOHEADER2**.</span><span class="sxs-lookup"><span data-stu-id="f8775-115">Video uses various other structures, including **VIDEOINFOHEADER** and **VIDEOINFOHEADER2**.</span></span> <span data-ttu-id="f8775-116">O layout do bloco de formato é identificado por um GUID de tipo de formato.</span><span class="sxs-lookup"><span data-stu-id="f8775-116">The layout of the format block is identified by a format type GUID.</span></span> <span data-ttu-id="f8775-117">Por exemplo, FORMAT \_ WaveFormatEx especifica uma estrutura **WaveFormatEx** .</span><span class="sxs-lookup"><span data-stu-id="f8775-117">For example, FORMAT\_WaveFormatEx specifies a **WAVEFORMATEX** structure.</span></span>

<span data-ttu-id="f8775-118">Quando um DMO é criado pela primeira vez, os fluxos não têm um tipo de mídia.</span><span class="sxs-lookup"><span data-stu-id="f8775-118">When a DMO is first created, the streams do not have a media type.</span></span> <span data-ttu-id="f8775-119">Antes que o DMO possa processar quaisquer dados, o cliente deve definir um tipo de mídia para cada fluxo.</span><span class="sxs-lookup"><span data-stu-id="f8775-119">Before the DMO can process any data, the client must set a media type for each stream.</span></span> <span data-ttu-id="f8775-120">Esse processo é descrito da perspectiva do cliente na [definição de tipos de mídia em um DMO](setting-media-types-on-a-dmo.md).</span><span class="sxs-lookup"><span data-stu-id="f8775-120">This process is described from the client's perspective in [Setting Media Types on a DMO](setting-media-types-on-a-dmo.md).</span></span>

<span data-ttu-id="f8775-121">**Tipos de mídia no registro**</span><span class="sxs-lookup"><span data-stu-id="f8775-121">**Media Types in the Registry**</span></span>

<span data-ttu-id="f8775-122">Um DMO pode adicionar uma lista de tipos de mídia que ele dá suporte ao registro, chamando a função [**DMORegister**](/previous-versions/windows/desktop/api/Dmoreg/nf-dmoreg-dmoregister) .</span><span class="sxs-lookup"><span data-stu-id="f8775-122">A DMO can add a list of media types that it supports to the registry, by calling the [**DMORegister**](/previous-versions/windows/desktop/api/Dmoreg/nf-dmoreg-dmoregister) function.</span></span> <span data-ttu-id="f8775-123">Um aplicativo pode usar essas informações para procurar DMOs que correspondam a um formato específico.</span><span class="sxs-lookup"><span data-stu-id="f8775-123">An application can use this information to search for DMOs that match a particular format.</span></span> <span data-ttu-id="f8775-124">As informações no registro não devem ser abrangentes.</span><span class="sxs-lookup"><span data-stu-id="f8775-124">The information in the registry is not meant to be comprehensive.</span></span> <span data-ttu-id="f8775-125">Normalmente, você deve incluir apenas os tipos principais aos quais o DMO dá suporte.</span><span class="sxs-lookup"><span data-stu-id="f8775-125">Typically, you would include only the main types that the DMO supports.</span></span> <span data-ttu-id="f8775-126">A entrada do registro tem chaves separadas para tipos de entrada e saída, mas não faz distinção entre fluxos individuais.</span><span class="sxs-lookup"><span data-stu-id="f8775-126">The registry entry has separate keys for input and output types, but does not distinguish among individual streams.</span></span>

<span data-ttu-id="f8775-127">A função **DMORegister** usa a estrutura de [**\_ \_ MediaType parcial do DMO**](/previous-versions/windows/desktop/api/Dmoreg/ns-dmoreg-dmo_partial_mediatype) para descrever os tipos de mídia.</span><span class="sxs-lookup"><span data-stu-id="f8775-127">The **DMORegister** function uses the [**DMO\_PARTIAL\_MEDIATYPE**](/previous-versions/windows/desktop/api/Dmoreg/ns-dmoreg-dmo_partial_mediatype) structure to describe media types.</span></span> <span data-ttu-id="f8775-128">Essa estrutura contém um subconjunto das informações encontradas na estrutura **do \_ \_ tipo de mídia DMO** , ou seja, o tipo principal e o subtipo.</span><span class="sxs-lookup"><span data-stu-id="f8775-128">This structure contains a subset of the information found in the **DMO\_MEDIA\_TYPE** structure—namely the major type and the subtype.</span></span> <span data-ttu-id="f8775-129">Ele não inclui um bloco de formato, porque o bloco de formato normalmente contém informações que são muito granulares para serem incluídas no registro, como a altura e a largura de uma imagem de vídeo.</span><span class="sxs-lookup"><span data-stu-id="f8775-129">It does not include a format block, because the format block typically contains information that is too granular to include in the registry, such as the height and width of a video image.</span></span>

<span data-ttu-id="f8775-130">**Tipos de mídia preferenciais**</span><span class="sxs-lookup"><span data-stu-id="f8775-130">**Preferred Media Types**</span></span>

<span data-ttu-id="f8775-131">Depois que o aplicativo tiver criado um DMO, ele poderá consultar o DMO para os tipos de mídia aos quais ele dá suporte.</span><span class="sxs-lookup"><span data-stu-id="f8775-131">After the application has created a DMO, it can query the DMO for the media types it supports.</span></span> <span data-ttu-id="f8775-132">Para cada fluxo, o DMO cria uma lista de tipos de mídia (possivelmente vazio), classificados em ordem de preferência.</span><span class="sxs-lookup"><span data-stu-id="f8775-132">For each stream, the DMO creates a list of media types (possibly empty), ranked in order of preference.</span></span> <span data-ttu-id="f8775-133">Os métodos [**IMediaObject:: GetInputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getinputtype) e [**IMediaObject:: GetOutputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getoutputtype) enumeram os tipos preferenciais.</span><span class="sxs-lookup"><span data-stu-id="f8775-133">The [**IMediaObject::GetInputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getinputtype) and [**IMediaObject::GetOutputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-getoutputtype) methods enumerate the preferred types.</span></span> <span data-ttu-id="f8775-134">Os tipos preferenciais de um fluxo podem ser alterados dinamicamente quando o aplicativo define os tipos de mídia em outros fluxos.</span><span class="sxs-lookup"><span data-stu-id="f8775-134">A stream's preferred types can change dynamically when the application sets media types on other streams.</span></span> <span data-ttu-id="f8775-135">Por exemplo, a lista de tipos de saída preferenciais pode mudar depois que o tipo de entrada é definido, ou vice-versa.</span><span class="sxs-lookup"><span data-stu-id="f8775-135">For example, the list of preferred output types might change after the input type is set, or vice versa.</span></span> <span data-ttu-id="f8775-136">No entanto, o DMO não é necessário para atualizar seus tipos preferenciais dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="f8775-136">However, the DMO is not required to update its preferred types dynamically.</span></span> <span data-ttu-id="f8775-137">O aplicativo não pode pressupor que todos os tipos recebidos são válidos.</span><span class="sxs-lookup"><span data-stu-id="f8775-137">The application cannot assume that every type it receives is valid.</span></span> <span data-ttu-id="f8775-138">Por esse motivo, os métodos [**IMediaObject:: SetInputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-setinputtype) e [**IMediaObject:: SetOutputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-setoutputtype) são compatíveis com um sinalizador para testar um tipo específico.</span><span class="sxs-lookup"><span data-stu-id="f8775-138">For this reason, the [**IMediaObject::SetInputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-setinputtype) and [**IMediaObject::SetOutputType**](/previous-versions/windows/desktop/api/Mediaobj/nf-mediaobj-imediaobject-setoutputtype) methods support a flag for testing a specific type.</span></span>

<span data-ttu-id="f8775-139">Os métodos **GetInputType** e **GetOutputType** retornam uma estrutura **de \_ \_ tipo de mídia DMO** .</span><span class="sxs-lookup"><span data-stu-id="f8775-139">The **GetInputType** and **GetOutputType** methods both return a **DMO\_MEDIA\_TYPE** structure.</span></span> <span data-ttu-id="f8775-140">O DMO pode deixar algumas das informações nessa estrutura em branco, para indicar um intervalo de tipos.</span><span class="sxs-lookup"><span data-stu-id="f8775-140">The DMO can leave some of the information in this structure blank, to indicate a range of types.</span></span> <span data-ttu-id="f8775-141">O tipo ou subtipo principal pode ser \_ NULL GUID e o bloco de formato pode estar vazio (zero bytes).</span><span class="sxs-lookup"><span data-stu-id="f8775-141">The major type or subtype can be GUID\_NULL, and the format block can be empty (zero bytes).</span></span> <span data-ttu-id="f8775-142">Se o bloco de formato estiver vazio, o tipo de formato deverá ser \_ NULL GUID.</span><span class="sxs-lookup"><span data-stu-id="f8775-142">If the format block is empty, the format type must be GUID\_NULL.</span></span>

<span data-ttu-id="f8775-143">Depois que o aplicativo define todos os tipos de entrada de DMO, o DMO geralmente deve retornar pelo menos um tipo completo para cada fluxo de saída.</span><span class="sxs-lookup"><span data-stu-id="f8775-143">After the application sets all of a DMO's input types, the DMO should generally return at least one complete type for each output stream.</span></span> <span data-ttu-id="f8775-144">Um tipo de saída completo facilita os testes, e os aplicativos podem usá-lo como um padrão razoável.</span><span class="sxs-lookup"><span data-stu-id="f8775-144">A complete output type facilitates testing, and applications can use it as a reasonable default.</span></span> <span data-ttu-id="f8775-145">O aplicativo de teste do DMO depende desse comportamento.</span><span class="sxs-lookup"><span data-stu-id="f8775-145">The DMO test application relies on this behavior.</span></span> <span data-ttu-id="f8775-146">(Consulte [usando o aplicativo DMOTest](using-the-dmotest-application.md).)</span><span class="sxs-lookup"><span data-stu-id="f8775-146">(See [Using the DMOTest Application](using-the-dmotest-application.md).)</span></span>

<span data-ttu-id="f8775-147">**Definindo os tipos de mídia**</span><span class="sxs-lookup"><span data-stu-id="f8775-147">**Setting the Media Types**</span></span>

<span data-ttu-id="f8775-148">Os aplicativos usam os métodos **SetInputType** e **SetOutputType** para testar, definir ou limpar os tipos em um fluxo especificado.</span><span class="sxs-lookup"><span data-stu-id="f8775-148">Applications use the **SetInputType** and **SetOutputType** methods to test, set, or clear types on a specified stream.</span></span> <span data-ttu-id="f8775-149">O aplicativo deve especificar totalmente o tipo.</span><span class="sxs-lookup"><span data-stu-id="f8775-149">The application must fully specify the type.</span></span> <span data-ttu-id="f8775-150">O DMO verifica se ele pode aceitar o tipo proposto.</span><span class="sxs-lookup"><span data-stu-id="f8775-150">The DMO verifies whether it can accept the proposed type.</span></span> <span data-ttu-id="f8775-151">A resposta pode depender de quais tipos foram definidos em outros fluxos.</span><span class="sxs-lookup"><span data-stu-id="f8775-151">The answer may depend on which types have been set on other streams.</span></span> <span data-ttu-id="f8775-152">O \_ sinalizador de \_ limpeza Set TYPEF do DMO limpa o \_ tipo de um fluxo, portanto, o aplicativo pode "fazer backup" e tentar outra combinação.</span><span class="sxs-lookup"><span data-stu-id="f8775-152">The DMO\_SET\_TYPEF\_CLEAR flag clears a stream's type, so the application can "back out" and try another combination.</span></span>

<span data-ttu-id="f8775-153">**Cenários de exemplo**</span><span class="sxs-lookup"><span data-stu-id="f8775-153">**Example Scenarios**</span></span>

<span data-ttu-id="f8775-154">Os exemplos a seguir descrevem alguns cenários típicos, para ilustrar os pontos feitos nas seções anteriores.</span><span class="sxs-lookup"><span data-stu-id="f8775-154">The following examples describe some typical scenarios, to illustrate the points made in the previous sections.</span></span>

-   <span data-ttu-id="f8775-155">**Decodificadores de vídeo.**</span><span class="sxs-lookup"><span data-stu-id="f8775-155">**Video Decoders.**</span></span> <span data-ttu-id="f8775-156">Em um decodificador de vídeo típico, o tipo de entrada determina parcialmente o tipo de saída.</span><span class="sxs-lookup"><span data-stu-id="f8775-156">In a typical video decoder, the input type partly determines the output type.</span></span> <span data-ttu-id="f8775-157">Por exemplo, geralmente ambos os fluxos devem ter a mesma taxa de quadros e dimensões de imagem.</span><span class="sxs-lookup"><span data-stu-id="f8775-157">For example, usually both streams must have the same frame rate and image dimensions.</span></span> <span data-ttu-id="f8775-158">Uma opção não define nenhum tipo de saída preferencial até que o tipo de entrada seja definido.</span><span class="sxs-lookup"><span data-stu-id="f8775-158">One option is not to define any preferred output types until the input type is set.</span></span> <span data-ttu-id="f8775-159">Outra opção é enumerar um conjunto de tipos incompletos, omitindo o bloco de formato.</span><span class="sxs-lookup"><span data-stu-id="f8775-159">Another option is to enumerate a set of incomplete types, omitting the format block.</span></span> <span data-ttu-id="f8775-160">Use o subtipo para indicar os tipos descompactados com suporte, como RGB de 16 bits, RGB de 24 bits e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="f8775-160">Use the subtype to indicate the supported uncompressed types, such as 16-bit RGB, 24-bit RGB, and so forth.</span></span> <span data-ttu-id="f8775-161">Além disso, os decodificadores de vídeo geralmente não dão suporte à definição do tipo de saída antes do tipo de entrada.</span><span class="sxs-lookup"><span data-stu-id="f8775-161">Also, video decoders generally do not support setting the output type before the input type.</span></span> <span data-ttu-id="f8775-162">O cenário usual é decodificar de um formato de entrada conhecido, portanto, essa limitação é razoável.</span><span class="sxs-lookup"><span data-stu-id="f8775-162">The usual scenario is to decode from a known input format, so this limitation is reasonable.</span></span>
-   <span data-ttu-id="f8775-163">**Decodificadores de áudio.**</span><span class="sxs-lookup"><span data-stu-id="f8775-163">**Audio Decoders.**</span></span> <span data-ttu-id="f8775-164">Um decodificador de áudio pode dar suporte a um conjunto fixo limitado de formatos de saída.</span><span class="sxs-lookup"><span data-stu-id="f8775-164">An audio decoder might support a limited, fixed set of output formats.</span></span> <span data-ttu-id="f8775-165">Nesse caso, talvez seja possível criar uma lista de formatos de saída preferenciais antes que o formato de entrada seja conhecido.</span><span class="sxs-lookup"><span data-stu-id="f8775-165">In that case, it may be able to create a list of preferred output formats before the input format is known.</span></span>
-   <span data-ttu-id="f8775-166">**Compactadores.**</span><span class="sxs-lookup"><span data-stu-id="f8775-166">**Compressors.**</span></span> <span data-ttu-id="f8775-167">Na maioria dos casos, um compressor de vídeo não pode especificar totalmente seus formatos de saída preferenciais até que o aplicativo defina o formato de entrada e vice-versa.</span><span class="sxs-lookup"><span data-stu-id="f8775-167">In most cases, a video compressor cannot fully specify its preferred output formats until the application sets the input format, and vice versa.</span></span> <span data-ttu-id="f8775-168">Em vez disso, o DMO deve retornar um tipo incompleto sem nenhum bloco de formato.</span><span class="sxs-lookup"><span data-stu-id="f8775-168">Instead, the DMO should return an incomplete type with no format block.</span></span> <span data-ttu-id="f8775-169">Para a compactação de áudio e vídeo, o aplicativo geralmente precisa definir vários parâmetros de saída, como a taxa de bits.</span><span class="sxs-lookup"><span data-stu-id="f8775-169">For both audio and video compression, the application usually needs to set various output parameters, such as the bit rate.</span></span> <span data-ttu-id="f8775-170">No entanto, depois que o tipo de entrada é definido, o compressor deve retornar pelo menos um tipo de saída completo, pelos motivos mencionados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="f8775-170">However, after the input type is set, the compressor should return at least one complete output type, for the reasons mentioned previously.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f8775-171">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="f8775-171">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f8775-172">Escrevendo um DMO</span><span class="sxs-lookup"><span data-stu-id="f8775-172">Writing a DMO</span></span>](writing-a-dmo.md)
</dt> </dl>

 

 



