---
description: Fontes dinâmicas
ms.assetid: 571fe5e5-9616-463b-837c-f8dbb8adf1be
title: Fontes dinâmicas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 43486cf3db797f493c9446bf782989b8beaae829
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104456632"
---
# <a name="live-sources"></a><span data-ttu-id="45609-103">Fontes dinâmicas</span><span class="sxs-lookup"><span data-stu-id="45609-103">Live Sources</span></span>

<span data-ttu-id="45609-104">Uma fonte ao vivo, também chamada de *fonte Push*, recebe dados em tempo real.</span><span class="sxs-lookup"><span data-stu-id="45609-104">A live source, also called a *push source*, receives data in real time.</span></span> <span data-ttu-id="45609-105">Os exemplos incluem captura de vídeo e difusões de rede.</span><span class="sxs-lookup"><span data-stu-id="45609-105">Examples include video capture and network broadcasts.</span></span> <span data-ttu-id="45609-106">Em geral, uma fonte dinâmica não pode controlar a taxa na qual os dados chegam.</span><span class="sxs-lookup"><span data-stu-id="45609-106">In general, a live source cannot control the rate at which data arrives.</span></span>

<span data-ttu-id="45609-107">Um filtro é considerado uma fonte ao vivo se uma das seguintes opções for verdadeira:</span><span class="sxs-lookup"><span data-stu-id="45609-107">A filter is considered to be a live source if either of the following are true:</span></span>

-   <span data-ttu-id="45609-108">O filtro retorna os \_ sinalizadores diversos do filtro am \_ é o \_ \_ \_ sinalizador de origem do método [**IAMFilterMiscFlags:: GetMiscFlags**](/windows/desktop/api/Strmif/nf-strmif-iamfiltermiscflags-getmiscflags) e pelo menos um de seus PINs de saída expõe a interface [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) .</span><span class="sxs-lookup"><span data-stu-id="45609-108">The filter returns the AM\_FILTER\_MISC\_FLAGS\_IS\_SOURCE flag from the [**IAMFilterMiscFlags::GetMiscFlags**](/windows/desktop/api/Strmif/nf-strmif-iamfiltermiscflags-getmiscflags) method, AND at least one of its output pins exposes the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface.</span></span>
-   <span data-ttu-id="45609-109">O filtro expõe a interface [**IKsPropertySet**](ikspropertyset.md) e tem um PIN de captura (fixar \_ categoria \_ Capture).</span><span class="sxs-lookup"><span data-stu-id="45609-109">The filter exposes the [**IKsPropertySet**](ikspropertyset.md) interface and has a capture pin (PIN\_CATEGORY\_CAPTURE).</span></span> <span data-ttu-id="45609-110">Consulte [fixar conjunto de propriedades](pin-property-set.md) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="45609-110">See [Pin Property Set](pin-property-set.md) for more information.</span></span>

<span data-ttu-id="45609-111">Se um filtro de origem ao vivo fornecer um relógio, o Gerenciador de grafo de filtro preferirá esse relógio quando escolher o relógio de referência do grafo.</span><span class="sxs-lookup"><span data-stu-id="45609-111">If a live source filter provides a clock, the Filter Graph Manager will prefer that clock when it chooses the graph reference clock.</span></span> <span data-ttu-id="45609-112">Consulte [relógios de referência](reference-clocks.md) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="45609-112">See [Reference Clocks](reference-clocks.md) for more information.</span></span>

<span data-ttu-id="45609-113">**Latência**</span><span class="sxs-lookup"><span data-stu-id="45609-113">**Latency**</span></span>

<span data-ttu-id="45609-114">A latência de um filtro é a quantidade de tempo que leva para o filtro processar um exemplo.</span><span class="sxs-lookup"><span data-stu-id="45609-114">A filter's latency is the amount of time it takes the filter to process a sample.</span></span> <span data-ttu-id="45609-115">Para fontes dinâmicas, a latência é determinada pelo tamanho do buffer usado para manter amostras.</span><span class="sxs-lookup"><span data-stu-id="45609-115">For live sources, the latency is determined by the size of the buffer used to hold samples.</span></span> <span data-ttu-id="45609-116">Por exemplo, suponha que o grafo de filtro tenha uma fonte de vídeo com uma latência de 33 milissegundos (MS) e uma fonte de áudio com uma latência de 500 ms.</span><span class="sxs-lookup"><span data-stu-id="45609-116">For example, suppose the filter graph has a video source with a latency of 33 milliseconds (ms) and an audio source with a latency of 500 ms.</span></span> <span data-ttu-id="45609-117">Cada quadro de vídeo chega no processador de vídeo cerca de 470 MS antes da amostra de áudio correspondente atingir o processador de áudio.</span><span class="sxs-lookup"><span data-stu-id="45609-117">Each video frame arrives at the video renderer about 470 ms before the matching audio sample reaches the audio renderer.</span></span> <span data-ttu-id="45609-118">A menos que o grafo compensasse a diferença, o áudio e o vídeo não serão sincronizados.</span><span class="sxs-lookup"><span data-stu-id="45609-118">Unless the graph compensates for the difference, the audio and video will not be synchronized.</span></span>

<span data-ttu-id="45609-119">As fontes dinâmicas podem ser sincronizadas por meio da interface [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) .</span><span class="sxs-lookup"><span data-stu-id="45609-119">Live sources can be synchronized through the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface.</span></span> <span data-ttu-id="45609-120">O Gerenciador de gráfico de filtro não sincroniza fontes dinâmicas, a menos que o aplicativo habilite a sincronização chamando o método [**IAMGraphStreams:: SyncUsingStreamOffset**](/windows/desktop/api/Strmif/nf-strmif-iamgraphstreams-syncusingstreamoffset) .</span><span class="sxs-lookup"><span data-stu-id="45609-120">The Filter Graph Manager does not synchronize live sources unless the application enables synchronization by calling the [**IAMGraphStreams::SyncUsingStreamOffset**](/windows/desktop/api/Strmif/nf-strmif-iamgraphstreams-syncusingstreamoffset) method.</span></span> <span data-ttu-id="45609-121">Se a sincronização estiver habilitada, o Gerenciador de gráfico de filtro consultará cada filtro de origem para **IAMPushSource**.</span><span class="sxs-lookup"><span data-stu-id="45609-121">If synchronization is enabled, the Filter Graph Manager queries each source filter for **IAMPushSource**.</span></span> <span data-ttu-id="45609-122">Se o filtro der suporte a **IAMPushSource**, o Gerenciador de gráfico de filtro chamará [**IAMLatency:: getlatência**](/windows/desktop/api/Strmif/nf-strmif-iamlatency-getlatency) para recuperar a latência esperada do filtro.</span><span class="sxs-lookup"><span data-stu-id="45609-122">If the filter supports **IAMPushSource**, the Filter Graph Manager calls [**IAMLatency::GetLatency**](/windows/desktop/api/Strmif/nf-strmif-iamlatency-getlatency) to retrieve the filter's expected latency.</span></span> <span data-ttu-id="45609-123">(A interface **IAMPushSource** herda [**IAMLatency**](/windows/desktop/api/Strmif/nn-strmif-iamlatency).) Dos valores de latência combinados, o Gerenciador de gráfico de filtro determina a latência máxima esperada no grafo.</span><span class="sxs-lookup"><span data-stu-id="45609-123">(The **IAMPushSource** interface inherits [**IAMLatency**](/windows/desktop/api/Strmif/nn-strmif-iamlatency).) From the combined latency values, the Filter Graph Manager determines the maximum expected latency in the graph.</span></span> <span data-ttu-id="45609-124">Em seguida, ele chama [**IAMPushSource:: SetStreamOffset**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-setstreamoffset) para dar a cada filtro de origem um deslocamento de fluxo, que o filtro adiciona aos carimbos de data/hora que ele gera.</span><span class="sxs-lookup"><span data-stu-id="45609-124">It then calls [**IAMPushSource::SetStreamOffset**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-setstreamoffset) to give each source filter a stream offset, which that filter adds to the time stamps that it generates.</span></span>

<span data-ttu-id="45609-125">Esse método destina-se principalmente à visualização dinâmica.</span><span class="sxs-lookup"><span data-stu-id="45609-125">This method is intended primarily for live preview.</span></span> <span data-ttu-id="45609-126">No entanto, observe que um pino de visualização em um dispositivo de captura ao vivo (como uma câmera) não define carimbos de data/hora nas amostras que ele fornece.</span><span class="sxs-lookup"><span data-stu-id="45609-126">However, note that a preview pin on a live capture device (such as a camera) does not set time stamps on the samples it delivers.</span></span> <span data-ttu-id="45609-127">Portanto, para usar esse método com um dispositivo de captura ao vivo, você deve Visualizar a partir do PIN de captura.</span><span class="sxs-lookup"><span data-stu-id="45609-127">Therefore, to use this method with a live capture device, you must preview from the capture pin.</span></span> <span data-ttu-id="45609-128">Para obter mais informações, consulte [filtros de captura de vídeo do DirectShow](directshow-video-capture-filters.md).</span><span class="sxs-lookup"><span data-stu-id="45609-128">For more information, see [DirectShow Video Capture Filters](directshow-video-capture-filters.md).</span></span>

<span data-ttu-id="45609-129">Atualmente, a interface [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) é suportada pelo filtro de [captura VFW](vfw-capture-filter.md) e pelo filtro de [captura de áudio](audio-capture-filter.md) .</span><span class="sxs-lookup"><span data-stu-id="45609-129">Currently the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface is supported by the [VFW Capture](vfw-capture-filter.md) filter and the [Audio Capture](audio-capture-filter.md) filter.</span></span>

<span data-ttu-id="45609-130">**Correspondência de taxa**</span><span class="sxs-lookup"><span data-stu-id="45609-130">**Rate Matching**</span></span>

<span data-ttu-id="45609-131">Se um filtro de processador agendar amostras usando um relógio de referência, mas o filtro de origem os produzir usando um relógio diferente, poderão ocorrer problemas na reprodução.</span><span class="sxs-lookup"><span data-stu-id="45609-131">If a renderer filter schedules samples using one reference clock, but the source filter produces them using a different clock, glitches can occur in playback.</span></span> <span data-ttu-id="45609-132">O renderizador pode ser executado mais rápido do que a origem, causando lacunas nos dados.</span><span class="sxs-lookup"><span data-stu-id="45609-132">The renderer might run faster than the source, causing gaps in the data.</span></span> <span data-ttu-id="45609-133">Ou pode ser executado de forma mais lenta do que a origem, fazendo com que as amostras "se montem" até, em algum momento, o grafo descartará os exemplos.</span><span class="sxs-lookup"><span data-stu-id="45609-133">Or it might run slower than the source, causing samples to "bunch up," until at some point the graph will drop samples.</span></span> <span data-ttu-id="45609-134">Normalmente, uma fonte dinâmica não pode controlar sua taxa de produção e, portanto, o renderizador deve corresponder a taxas com a origem.</span><span class="sxs-lookup"><span data-stu-id="45609-134">Typically, a live source cannot control its production rate, so instead the renderer should match rates with the source.</span></span>

<span data-ttu-id="45609-135">Atualmente, somente o processador de áudio executa a correspondência de taxa, pois os problemas na reprodução de áudio são mais perceptíveis do que os problemas em vídeo.</span><span class="sxs-lookup"><span data-stu-id="45609-135">Currently, only the audio renderer performs rate matching, because glitches in audio playback are more noticeable than glitches in video.</span></span> <span data-ttu-id="45609-136">Para executar a correspondência de taxa, o processador de áudio deve selecionar algo no qual ele corresponderá às taxas.</span><span class="sxs-lookup"><span data-stu-id="45609-136">To perform rate-matching, the audio renderer must select something against which it will match rates.</span></span> <span data-ttu-id="45609-137">Ele usa o seguinte algoritmo:</span><span class="sxs-lookup"><span data-stu-id="45609-137">It uses the following algorithm:</span></span>

-   <span data-ttu-id="45609-138">Se o grafo não estiver usando um relógio de referência, o processador de áudio não tentará corresponder as taxas.</span><span class="sxs-lookup"><span data-stu-id="45609-138">If the graph is not using a reference clock, the audio renderer does not try to match rates.</span></span> <span data-ttu-id="45609-139">(Sempre que o grafo não tem um relógio de referência, os exemplos são sempre renderizados imediatamente à medida que chegam.)</span><span class="sxs-lookup"><span data-stu-id="45609-139">(Whenever the graph has no reference clock, samples are always rendered immediately as they arrive.)</span></span>
-   <span data-ttu-id="45609-140">Caso contrário, se houver um relógio de referência para o grafo, o processador de áudio verificará se há um upstream de origem ao vivo, usando os critérios descritos anteriormente.</span><span class="sxs-lookup"><span data-stu-id="45609-140">Otherwise, if there is a reference clock for the graph, the audio renderer checks whether there is a live source upstream, using the criteria described previously.</span></span> <span data-ttu-id="45609-141">Caso contrário, o processador de áudio não corresponde às taxas.</span><span class="sxs-lookup"><span data-stu-id="45609-141">If not, the audio renderer does not match rates.</span></span>
-   <span data-ttu-id="45609-142">Se houver um upstream de origem ao vivo e essa origem expor a interface [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) em seu pino de saída, o processador de áudio chamará [**IAMPushSource:: GetPushSourceFlags**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-getpushsourceflags).</span><span class="sxs-lookup"><span data-stu-id="45609-142">If there is a live source upstream, and that source exposes the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface on its output pin, the audio renderer calls [**IAMPushSource::GetPushSourceFlags**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-getpushsourceflags).</span></span> <span data-ttu-id="45609-143">Ele procura um dos seguintes sinalizadores:</span><span class="sxs-lookup"><span data-stu-id="45609-143">It looks for one of the following flags:</span></span>
    -   <span data-ttu-id="45609-144">\_PUSHSOURCECAPS \_ Internal \_ RM.</span><span class="sxs-lookup"><span data-stu-id="45609-144">AM\_PUSHSOURCECAPS\_INTERNAL\_RM.</span></span> <span data-ttu-id="45609-145">Esse sinalizador significa que o filtro de origem tem seu próprio mecanismo de correspondência de taxa, portanto, o processador de áudio não corresponde às taxas.</span><span class="sxs-lookup"><span data-stu-id="45609-145">This flag means the source filter has its own rate-matching mechanism, so the audio renderer does not match rates.</span></span>
    -   <span data-ttu-id="45609-146">\_PUSHSOURCECAPS \_ não está \_ online.</span><span class="sxs-lookup"><span data-stu-id="45609-146">AM\_PUSHSOURCECAPS\_NOT\_LIVE.</span></span> <span data-ttu-id="45609-147">Esse sinalizador significa que o filtro de origem não é realmente uma fonte ao vivo, embora exponha a interface [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) .</span><span class="sxs-lookup"><span data-stu-id="45609-147">This flag means the source filter is not really a live source, even though it exposes the [**IAMPushSource**](/windows/desktop/api/Strmif/nn-strmif-iampushsource) interface.</span></span> <span data-ttu-id="45609-148">Portanto, o processador de áudio não corresponde às taxas.</span><span class="sxs-lookup"><span data-stu-id="45609-148">Therefore, the audio renderer does not match rates.</span></span>
    -   <span data-ttu-id="45609-149">\_relógio PUSHSOURCECAPS \_ particular \_ .</span><span class="sxs-lookup"><span data-stu-id="45609-149">AM\_PUSHSOURCECAPS\_PRIVATE\_CLOCK.</span></span> <span data-ttu-id="45609-150">Esse sinalizador significa que o filtro de origem está usando um relógio privado para gerar carimbos de data/hora.</span><span class="sxs-lookup"><span data-stu-id="45609-150">This flag means the source filter is using a private clock to generate time stamps.</span></span> <span data-ttu-id="45609-151">Nesse caso, o renderizador de áudio corresponde às taxas em relação aos carimbos de data/hora.</span><span class="sxs-lookup"><span data-stu-id="45609-151">In this case, the audio renderer matches rates against the time stamps.</span></span> <span data-ttu-id="45609-152">(Se os exemplos não tiverem carimbos de data/hora, o renderizador ignorará esse sinalizador.)</span><span class="sxs-lookup"><span data-stu-id="45609-152">(If the samples have no time stamps, however, the renderer ignores this flag.)</span></span>
-   <span data-ttu-id="45609-153">Se [**GetPushSourceFlags**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-getpushsourceflags) não retornar nenhum sinalizador (zero), o comportamento do processador de áudio dependerá do relógio do grafo e se os exemplos têm carimbos de data/hora:</span><span class="sxs-lookup"><span data-stu-id="45609-153">If [**GetPushSourceFlags**](/windows/desktop/api/Strmif/nf-strmif-iampushsource-getpushsourceflags) returns no flags (zero), the audio renderer's behavior depends on the graph clock and whether the samples have time stamps:</span></span>
    -   <span data-ttu-id="45609-154">Se o processador de áudio não for o relógio do grafo e os exemplos tiverem carimbos de data/hora, o renderizador de áudio corresponderá às taxas nos carimbos de data/hora.</span><span class="sxs-lookup"><span data-stu-id="45609-154">If the audio renderer is not the graph clock, AND the samples have time stamps, the audio renderer matches rates against the time stamps.</span></span>
    -   <span data-ttu-id="45609-155">Se os exemplos não tiverem carimbos de data/hora, o processador de áudio tentará corresponder à taxa de dados de áudio de entrada.</span><span class="sxs-lookup"><span data-stu-id="45609-155">If the samples do not have time stamps, the audio renderer tries to match the rate of incoming audio data.</span></span>
    -   <span data-ttu-id="45609-156">Se o processador de áudio for o relógio do grafo, ele tentará corresponder à taxa de dados de entrada.</span><span class="sxs-lookup"><span data-stu-id="45609-156">If the audio renderer is the graph clock, it tries to match the incoming data rate.</span></span>

<span data-ttu-id="45609-157">O motivo do último caso é o seguinte: se o processador de áudio for o relógio de referência e o filtro de origem estiver usando o mesmo relógio para gerar carimbos de data/hora, o processador de áudio não poderá corresponder as taxas em relação aos carimbos de data/hora.</span><span class="sxs-lookup"><span data-stu-id="45609-157">The reason for the last case is the following: If the audio renderer is the reference clock, and the source filter is using the same clock to generate time stamps, then the audio renderer cannot match rates against the time stamps.</span></span> <span data-ttu-id="45609-158">Se tiver feito isso, em vigor, ele estaria tentando corresponder as taxas, o que poderia fazer com que o relógio fosse descompasso.</span><span class="sxs-lookup"><span data-stu-id="45609-158">If it did, in effect it would be trying to match rates with itself, which could cause the clock to drift.</span></span> <span data-ttu-id="45609-159">Portanto, nesse caso, o renderizador corresponde à taxa de dados de áudio de entrada.</span><span class="sxs-lookup"><span data-stu-id="45609-159">Therefore, in this case the renderer matches the rate of incoming audio data.</span></span>

## <a name="related-topics"></a><span data-ttu-id="45609-160">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="45609-160">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="45609-161">Tempo e relógios no DirectShow</span><span class="sxs-lookup"><span data-stu-id="45609-161">Time and Clocks in DirectShow</span></span>](time-and-clocks-in-directshow.md)
</dt> </dl>

 

 



