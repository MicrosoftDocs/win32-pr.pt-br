---
description: Liberação
ms.assetid: 868218c4-3e1a-4da0-89fa-30a9848da0e8
title: Liberação
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 575f311020c2c7a567e544b80ba323a29051cc38
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104500637"
---
# <a name="flushing"></a><span data-ttu-id="3ae4c-103">Liberação</span><span class="sxs-lookup"><span data-stu-id="3ae4c-103">Flushing</span></span>

<span data-ttu-id="3ae4c-104">Enquanto o grafo de filtro está em execução, quantidades arbitrárias de dados podem ser percorrendo o grafo.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-104">While the filter graph is running, arbitrary amounts of data can be moving through the graph.</span></span> <span data-ttu-id="3ae4c-105">Algumas delas podem estar em filas, aguardando para serem entregues.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-105">Some of it might be in queues, waiting to be delivered.</span></span> <span data-ttu-id="3ae4c-106">Há ocasiões em que o grafo de filtro precisa remover esses dados pendentes o mais rápido possível e substituí-los por novos dados.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-106">There are times when the filter graph needs to remove this pending data as quickly as possible and replace it with new data.</span></span> <span data-ttu-id="3ae4c-107">Depois de um comando de busca, por exemplo, o filtro de origem gera amostras de uma nova posição na origem.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-107">After a seek command, for example, the source filter generates samples from a new position in the source.</span></span> <span data-ttu-id="3ae4c-108">Para minimizar a latência, os filtros downstream devem descartar quaisquer exemplos que foram criados antes do comando de busca.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-108">To minimize latency, downstream filters should discard any samples that were created before the seek command.</span></span> <span data-ttu-id="3ae4c-109">O processo de descartar amostras é chamado de *liberação*.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-109">The process of discarding samples is called *flushing*.</span></span> <span data-ttu-id="3ae4c-110">Ele permite que o grafo seja mais responsivo quando os eventos alteram o fluxo de dados normal.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-110">It enables the graph to be more responsive when events alter the normal data flow.</span></span>

<span data-ttu-id="3ae4c-111">A liberação é tratada de forma ligeiramente diferente pelo modelo de pull do que o modelo de push.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-111">Flushing is handled slightly differently by the pull model than the push model.</span></span> <span data-ttu-id="3ae4c-112">Este artigo começa descrevendo o modelo de push; em seguida, ele descreve as diferenças no modelo de pull.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-112">This article starts by describing the push model; then it describes the differences in the pull model.</span></span>

<span data-ttu-id="3ae4c-113">A liberação ocorre em dois estágios.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-113">Flushing happens in two stages.</span></span>

-   <span data-ttu-id="3ae4c-114">Primeiro, o filtro de origem chama [**IPin:: BeginFlush**](/windows/desktop/api/Strmif/nf-strmif-ipin-beginflush) no pino de entrada do filtro downstream.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-114">First, the source filter calls [**IPin::BeginFlush**](/windows/desktop/api/Strmif/nf-strmif-ipin-beginflush) on the downstream filter's input pin.</span></span> <span data-ttu-id="3ae4c-115">O filtro downstream começa a rejeitar amostras de upstream.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-115">The downstream filter starts rejecting samples from upstream.</span></span> <span data-ttu-id="3ae4c-116">Ele também descarta todos os exemplos que estão mantendo e envia a chamada **BeginFlush** de downstream para o próximo filtro.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-116">It also discards any samples it is holding, and sends the **BeginFlush** call downstream to the next filter.</span></span>
-   <span data-ttu-id="3ae4c-117">Quando o filtro de origem está pronto para enviar novos dados, ele chama [**IPin:: EndFlush**](/windows/desktop/api/Strmif/nf-strmif-ipin-endflush) no pino de entrada.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-117">When the source filter is ready to send new data, it calls [**IPin::EndFlush**](/windows/desktop/api/Strmif/nf-strmif-ipin-endflush) on the input pin.</span></span> <span data-ttu-id="3ae4c-118">Isso sinaliza o filtro downstream de que ele pode receber novos exemplos.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-118">This signals the downstream filter that it can receive new samples.</span></span> <span data-ttu-id="3ae4c-119">O filtro downstream envia a chamada **EndFlush** para o próximo filtro.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-119">The downstream filter sends the **EndFlush** call to the next filter.</span></span>

<span data-ttu-id="3ae4c-120">No método **BeginFlush** , o pino de entrada faz o seguinte:</span><span class="sxs-lookup"><span data-stu-id="3ae4c-120">In the **BeginFlush** method, the input pin does the following:</span></span>

1.  <span data-ttu-id="3ae4c-121">Chama **BeginFlush** em Pins de entrada downstream.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-121">Calls **BeginFlush** on downstream input pins.</span></span>
2.  <span data-ttu-id="3ae4c-122">Rejeita todas as chamadas adicionais que transmitem dados, incluindo **Receive** e **EndOfStream**.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-122">Rejects any further calls that stream data, including **Receive** and **EndOfStream**.</span></span>
3.  <span data-ttu-id="3ae4c-123">Desbloqueia todos os filtros upstream que estão bloqueados aguardando uma amostra do alocador do filtro.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-123">Unblocks any upstream filters that are blocked waiting for a sample from the filter's allocator.</span></span> <span data-ttu-id="3ae4c-124">Alguns filtros desconfirmam seus alocadores para essa finalidade.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-124">Some filters decommit their allocators for this purpose.</span></span>
4.  <span data-ttu-id="3ae4c-125">Sai de qualquer espera que bloqueie o streaming.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-125">Exits from any waits that block streaming.</span></span> <span data-ttu-id="3ae4c-126">Por exemplo, os filtros de renderização são bloqueados quando pausados.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-126">For example, renderer filters block when paused.</span></span> <span data-ttu-id="3ae4c-127">Eles também bloqueiam quando estão aguardando para renderizar uma amostra no tempo de fluxo correto.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-127">They also block when they are waiting to render a sample at the correct stream time.</span></span> <span data-ttu-id="3ae4c-128">O filtro deve desbloquear, de modo que os exemplos enfileirados no upstream possam ser entregues e rejeitados.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-128">The filter must unblock, so that samples queued upstream can be delivered and rejected.</span></span> <span data-ttu-id="3ae4c-129">Essa etapa garante que todos os filtros upstream eventualmente desbloqueiem.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-129">This step ensures that all upstream filters eventually unblock.</span></span>

<span data-ttu-id="3ae4c-130">No método **EndFlush** , o pino de entrada faz o seguinte:</span><span class="sxs-lookup"><span data-stu-id="3ae4c-130">In the **EndFlush** method, the input pin does the following:</span></span>

1.  <span data-ttu-id="3ae4c-131">Aguarda que todas as amostras em fila sejam descartadas.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-131">Waits for all queued samples to be discarded.</span></span>
2.  <span data-ttu-id="3ae4c-132">Libera todos os dados armazenados em buffer.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-132">Frees any buffered data.</span></span> <span data-ttu-id="3ae4c-133">Às vezes, essa etapa pode ser executada no método **BeginFlush** .</span><span class="sxs-lookup"><span data-stu-id="3ae4c-133">This step can sometimes be performed in the **BeginFlush** method.</span></span> <span data-ttu-id="3ae4c-134">No entanto, **BeginFlush** não é sincronizado com o thread de streaming.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-134">However, **BeginFlush** is not synchronized with the streaming thread.</span></span> <span data-ttu-id="3ae4c-135">O filtro não deve processar nem armazenar mais dados entre a chamada para **BeginFlush** e a chamada para **EndFlush**.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-135">The filter must not process or buffer any more data between the call to **BeginFlush** and the call to **EndFlush**.</span></span>
3.  <span data-ttu-id="3ae4c-136">Limpa todas as notificações pendentes do EC \_ Complete.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-136">Clears any pending EC\_COMPLETE notifications.</span></span>
4.  <span data-ttu-id="3ae4c-137">Chama downstream de **liberação** .</span><span class="sxs-lookup"><span data-stu-id="3ae4c-137">Calls **EndFlush** downstream.</span></span>

<span data-ttu-id="3ae4c-138">Neste ponto, o filtro pode aceitar amostras novamente.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-138">At this point, the filter can accept samples again.</span></span> <span data-ttu-id="3ae4c-139">Todas as amostras têm a garantia de serem mais recentes do que a liberação.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-139">All samples are guaranteed to be more recent than the flush.</span></span>

<span data-ttu-id="3ae4c-140">No modelo de pull, o filtro do analisador inicia a liberação, em vez do filtro de origem.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-140">In the pull model, the parser filter initiates flushing, rather than the source filter.</span></span> <span data-ttu-id="3ae4c-141">Ele não apenas chama **IPin:: BeginFlush** e **IPin:: EndFlush** no filtro downstream, ele também chama [**IAsyncReader:: BeginFlush**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-beginflush) e [**IAsyncReader:: EndFlush**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-endflush) no pino de *saída* do filtro de origem.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-141">Not only does it call **IPin::BeginFlush** and **IPin::EndFlush** on the downstream filter, it also calls [**IAsyncReader::BeginFlush**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-beginflush) and [**IAsyncReader::EndFlush**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-endflush) on the *output* pin of the source filter.</span></span> <span data-ttu-id="3ae4c-142">Se o filtro de origem tiver solicitações de leitura pendentes, elas serão descartadas.</span><span class="sxs-lookup"><span data-stu-id="3ae4c-142">If the source filter has pending read requests, it will discard them.</span></span>

## <a name="related-topics"></a><span data-ttu-id="3ae4c-143">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="3ae4c-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="3ae4c-144">Liberando dados</span><span class="sxs-lookup"><span data-stu-id="3ae4c-144">Flushing Data</span></span>](flushing-data.md)
</dt> </dl>

 

 



