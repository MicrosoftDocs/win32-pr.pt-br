---
description: Validando a cadeia de certificados
ms.assetid: e0c36f04-1694-40d8-94a1-06ee7de08777
title: Validando a cadeia de certificados
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 13436513ae9199feb7ba5fcba399537da198ba85
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104170268"
---
# <a name="validating-the-certificate-chain"></a><span data-ttu-id="2c5ad-103">Validando a cadeia de certificados</span><span class="sxs-lookup"><span data-stu-id="2c5ad-103">Validating the Certificate Chain</span></span>

<span data-ttu-id="2c5ad-104">Este tópico descreve como validar a cadeia de certificados do driver ao usar o protocolo COPP (certificado de proteção de saída).</span><span class="sxs-lookup"><span data-stu-id="2c5ad-104">This topic describes how to validate the driver's certificate chain when using Certified Output Protection Protocol (COPP).</span></span>

<span data-ttu-id="2c5ad-105">A cadeia de certificados do driver gráfico é um documento XML.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-105">The graphic driver's certificate chain is an XML document.</span></span> <span data-ttu-id="2c5ad-106">A cadeia de certificados contém três certificados.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-106">The certificate chain contains three certificates.</span></span> <span data-ttu-id="2c5ad-107">O primeiro certificado é chamado de *certificado de folha* e é o certificado Copp do driver.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-107">The first certificate is called the *leaf certificate*, and is the driver's COPP certificate.</span></span> <span data-ttu-id="2c5ad-108">O próximo certificado é o certificado de autenticação do fornecedor de hardware independente (IHV).</span><span class="sxs-lookup"><span data-stu-id="2c5ad-108">The next certificate is the signing certificate of the Independent Hardware Vendor (IHV).</span></span> <span data-ttu-id="2c5ad-109">O último certificado é o certificado de autenticação da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-109">The last certificate is Microsoft's signing certificate.</span></span> <span data-ttu-id="2c5ad-110">Para garantir que o driver de gráficos seja um dispositivo COPP legítimo, o aplicativo deve validar todos os três certificados.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-110">To ensure that the graphics driver is a legitimate COPP device, the application must validate all three of these certificates.</span></span> <span data-ttu-id="2c5ad-111">Um programa mal-intencionado pode impedir que o COPP funcione se um aplicativo não validar corretamente os certificados na cadeia.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-111">A malicious program can prevent COPP from working if an application does not correctly validate the certificates in the chain.</span></span>

<span data-ttu-id="2c5ad-112">As cadeias de certificados COPP usam o conjunto de caracteres UTF-8.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-112">COPP certificate chains use the UTF-8 character set.</span></span> <span data-ttu-id="2c5ad-113">Os dados binários nos certificados, como a chave pública RSA, são codificados em Base64 e armazenados na ordem big-endian.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-113">Binary data in the certificates, such as the RSA public key, are base64-encoded and stored in big-endian order.</span></span> <span data-ttu-id="2c5ad-114">(*Big-endian* significa que o byte mais significativo é armazenado no local da memória com o endereço mais baixo.)</span><span class="sxs-lookup"><span data-stu-id="2c5ad-114">(*Big-endian* means that the most significant byte is stored in the memory location with the lowest address.)</span></span>

<span data-ttu-id="2c5ad-115">Alguns elementos dentro de um certificado contêm valores Boolianos para denotar que existe um recurso do certificado.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-115">Some elements within a certificate contain Boolean values to denote that a feature of the certificate exists.</span></span> <span data-ttu-id="2c5ad-116">Se o recurso existir, o valor do elemento filho correspondente será definido como 1.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-116">If the feature exists, the corresponding child element value is set to 1.</span></span> <span data-ttu-id="2c5ad-117">Se um recurso não estiver presente, esse elemento filho não estará presente no certificado.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-117">If a feature is not present, that child element is not present in the certificate.</span></span>

### <a name="xml-element-definitions"></a><span data-ttu-id="2c5ad-118">Definições de elemento XML</span><span class="sxs-lookup"><span data-stu-id="2c5ad-118">XML Element Definitions</span></span>

<span data-ttu-id="2c5ad-119">Veja a seguir as definições para elementos no esquema de certificado:</span><span class="sxs-lookup"><span data-stu-id="2c5ad-119">The following are definitions for elements in the certificate schema:</span></span>

-   <span data-ttu-id="2c5ad-120">**CertificateCollection**.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-120">**CertificateCollection**.</span></span> <span data-ttu-id="2c5ad-121">O elemento raiz do documento XML.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-121">The root element of the XML document.</span></span> <span data-ttu-id="2c5ad-122">Ele contém elementos de certificado, um para cada certificado na cadeia.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-122">It contains Certificate elements, one for each certificate in the chain.</span></span>
-   <span data-ttu-id="2c5ad-123">**Certificado**.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-123">**Certificate**.</span></span> <span data-ttu-id="2c5ad-124">Contém um certificado.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-124">Contains one certificate.</span></span> <span data-ttu-id="2c5ad-125">Este elemento contém dados e elementos de assinatura.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-125">This element contains Data and Signature elements.</span></span>
-   <span data-ttu-id="2c5ad-126">**Dados**.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-126">**Data**.</span></span> <span data-ttu-id="2c5ad-127">Contém informações sobre o certificado.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-127">Contains information about the certificate.</span></span> <span data-ttu-id="2c5ad-128">Em particular, ele contém a chave pública do certificado e o tipo.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-128">In particular, it contains the certificate's public key and type.</span></span> <span data-ttu-id="2c5ad-129">O elemento data contém os seguintes elementos filho:</span><span class="sxs-lookup"><span data-stu-id="2c5ad-129">The Data element contains the following child elements:</span></span>
    -   <span data-ttu-id="2c5ad-130">**PublicKey**.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-130">**PublicKey**.</span></span> <span data-ttu-id="2c5ad-131">Contém a chave pública RSA do certificado.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-131">Contains the certificate's RSA public key.</span></span> <span data-ttu-id="2c5ad-132">O elemento PublicKey contém um elemento KeyValue, que contém um elemento RSAKeyValue.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-132">The PublicKey element contains a KeyValue element, which contains an RSAKeyValue element.</span></span> <span data-ttu-id="2c5ad-133">O elemento RSAKeyValue tem dois elementos filho, módulo e expoente, e eles definem a chave pública.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-133">The RSAKeyValue element has two child elements, Modulus and Exponent, and these define the public key.</span></span> <span data-ttu-id="2c5ad-134">Os elementos de módulo e expoente são codificados na Base64 e armazenados na ordem big-endian.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-134">The Modulus and Exponent elements are base64-encoded and stored in big-endian order.</span></span>
    -   <span data-ttu-id="2c5ad-135">**Uso** de Key.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-135">**KeyUsage**.</span></span> <span data-ttu-id="2c5ad-136">Se o certificado for o certificado COPP do driver, esse elemento deverá conter um elemento filho chamado EncryptKey.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-136">If the certificate is the driver's COPP certificate, this element should contain a child element called EncryptKey.</span></span> <span data-ttu-id="2c5ad-137">Se o certificado for o certificado de autenticação do IHV ou o certificado de autenticação da Microsoft, ele deverá conter um elemento filho chamado SignCertificate.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-137">If the certificate is the IHV's signing certificate or Microsoft's signing certificate, it should contain a child element called SignCertificate.</span></span> <span data-ttu-id="2c5ad-138">Ambos os elementos filho contêm valores Boolianos.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-138">Both of these child elements contain Boolean values.</span></span>
    -   <span data-ttu-id="2c5ad-139">**SecurityLevel**.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-139">**SecurityLevel**.</span></span> <span data-ttu-id="2c5ad-140">Esse elemento deve ser ignorado.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-140">This element should be ignored.</span></span>
    -   <span data-ttu-id="2c5ad-141">**ManufacturerData**.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-141">**ManufacturerData**.</span></span> <span data-ttu-id="2c5ad-142">Especifica o fabricante e o modelo do dispositivo de gráficos.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-142">Specifies the manufacturer and model of the graphics device.</span></span> <span data-ttu-id="2c5ad-143">Este elemento é apenas informativo.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-143">This element is informational only.</span></span>
    -   <span data-ttu-id="2c5ad-144">**Recursos**.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-144">**Features**.</span></span> <span data-ttu-id="2c5ad-145">Contém elementos filho que especificam o uso do certificado.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-145">Contains child elements that specify the usage of the certificate.</span></span> <span data-ttu-id="2c5ad-146">O único relevante para COPP é o elemento COPPCertificate.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-146">The only one relevant to COPP is the COPPCertificate element.</span></span> <span data-ttu-id="2c5ad-147">Outros elementos filho podem estar presentes; Nesse caso, eles devem ser ignorados.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-147">Other child elements might be present; if so, they should be ignored.</span></span> <span data-ttu-id="2c5ad-148">Se o elemento COPPCertificate existir, o certificado será um certificado COPP.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-148">If the COPPCertificate element exists, the certificate is a COPP certificate.</span></span> <span data-ttu-id="2c5ad-149">Esse elemento deve estar presente no nó folha de um certificado COPP válido.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-149">This element must be present in the leaf node of a valid COPP certificate.</span></span> <span data-ttu-id="2c5ad-150">Esse elemento contém um valor booliano.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-150">This element contains a Boolean value.</span></span>
-   <span data-ttu-id="2c5ad-151">**Assinatura**.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-151">**Signature**.</span></span> <span data-ttu-id="2c5ad-152">Contém a assinatura para este certificado.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-152">Contains the signature for this certificate.</span></span> <span data-ttu-id="2c5ad-153">Ele contém os seguintes elementos filho:</span><span class="sxs-lookup"><span data-stu-id="2c5ad-153">It contains the following child elements:</span></span>
    -   <span data-ttu-id="2c5ad-154">**SignedInfo**.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-154">**SignedInfo**.</span></span> <span data-ttu-id="2c5ad-155">Contém informações sobre a assinatura.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-155">Contains information about the signature.</span></span> <span data-ttu-id="2c5ad-156">O elemento filho importante desse elemento é o elemento DigestValue, que contém o valor codificado na base64 do hash SHA-1 sobre o elemento de dados.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-156">The important child element of this element is the DigestValue element, which contains the base64-encoded value of the SHA-1 hash over the Data element.</span></span> <span data-ttu-id="2c5ad-157">O valor de Digest é usado ao verificar o certificado em relação à CRL (lista de certificados revogados).</span><span class="sxs-lookup"><span data-stu-id="2c5ad-157">The digest value is used when checking the certificate against the certificate revocation list (CRL).</span></span>
    -   <span data-ttu-id="2c5ad-158">**SignatureValue**.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-158">**SignatureValue**.</span></span> <span data-ttu-id="2c5ad-159">Esse valor é calculado sobre o elemento de dados e é calculado de acordo com o esquema de assinatura digital RSASSA-PSS definido nos padrões de criptografia de Public-Key (PKCS) \# 1 (versão 2,1).</span><span class="sxs-lookup"><span data-stu-id="2c5ad-159">This value is computed over the Data element and is computed according to the RSASSA-PSS digital signature scheme defined in Public-Key Cryptography Standards (PKCS) \#1 (version 2.1).</span></span> <span data-ttu-id="2c5ad-160">Para obter informações sobre o PKCS \# 1, visite [https://www.rsa.com/](https://www.rsa.com/) .</span><span class="sxs-lookup"><span data-stu-id="2c5ad-160">For information about PKCS \#1, visit [https://www.rsa.com/](https://www.rsa.com/).</span></span>
    -   <span data-ttu-id="2c5ad-161">**KeyInfo**.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-161">**KeyInfo**.</span></span> <span data-ttu-id="2c5ad-162">Contém a chave pública RSA do próximo certificado na cadeia.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-162">Contains the RSA public key of the next certificate in the chain.</span></span> <span data-ttu-id="2c5ad-163">Esse elemento é usado para verificar se os dados no elemento de dados não foram adulterados.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-163">This element is used to verify that the data in the Data element has not been tampered with.</span></span> <span data-ttu-id="2c5ad-164">Esse elemento tem o mesmo formato que o elemento PublicKey.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-164">This element has the same format as the PublicKey element.</span></span>

### <a name="certificate-validation"></a><span data-ttu-id="2c5ad-165">Validação de certificado</span><span class="sxs-lookup"><span data-stu-id="2c5ad-165">Certificate Validation</span></span>

<span data-ttu-id="2c5ad-166">O aplicativo deve executar as etapas a seguir para validar corretamente a cadeia de certificados.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-166">The application must perform the following steps to correctly validate the certificate chain.</span></span> <span data-ttu-id="2c5ad-167">Se qualquer etapa falhar ou se qualquer elemento mencionado nesses procedimentos não existir, a validação falhará.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-167">If any step fails, or if any element referred to in these procedures does not exist, the validation fails.</span></span>

### <a name="validate-certificate-collection-procedure"></a><span data-ttu-id="2c5ad-168">Procedimento para validar a coleção de certificados</span><span class="sxs-lookup"><span data-stu-id="2c5ad-168">Validate Certificate Collection Procedure</span></span>

<span data-ttu-id="2c5ad-169">Para validar a cadeia de certificados, execute as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="2c5ad-169">To validate the certificate chain, perform the following steps:</span></span>

1.  <span data-ttu-id="2c5ad-170">Verifique se Certificacollection é XML bem formado.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-170">Verify that the CertificateCollection is well-formed XML.</span></span>
2.  <span data-ttu-id="2c5ad-171">Verifique se Certificacollection está codificado no formato UTF-8.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-171">Verify that the CertificateCollection is encoded in UTF-8 format.</span></span>
3.  <span data-ttu-id="2c5ad-172">Verifique se o atributo Version no elemento CertificateCollection é 2,0 ou posterior.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-172">Check that the Version attribute in the CertificateCollection element is 2.0 or later.</span></span>
4.  <span data-ttu-id="2c5ad-173">Verifique se a cadeia de certificados contém exatamente três elementos de certificado.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-173">Verify that the certificate chain contains exactly three Certificate elements.</span></span>
5.  <span data-ttu-id="2c5ad-174">Faça um loop através de cada elemento de certificado na cadeia de certificados e execute o procedimento de validação de certificado, descrito abaixo, em cada um.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-174">Loop through each Certificate element in the certificate chain and perform the Validate Certificate procedure, described below, on each.</span></span>

### <a name="validate-certificate-procedure"></a><span data-ttu-id="2c5ad-175">Procedimento de validação de certificado</span><span class="sxs-lookup"><span data-stu-id="2c5ad-175">Validate Certificate Procedure</span></span>

<span data-ttu-id="2c5ad-176">Para validar um certificado na cadeia, execute as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="2c5ad-176">To validate a certificate in the chain, perform the following steps:</span></span>

1.  <span data-ttu-id="2c5ad-177">Verifique se nenhum dos elementos filho no elemento de dados está duplicado.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-177">Verify that none of the child elements in the Data element is duplicated.</span></span> <span data-ttu-id="2c5ad-178">Por exemplo, deve haver apenas um elemento PublicKey.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-178">For example, there should be only one PublicKey element.</span></span>
2.  <span data-ttu-id="2c5ad-179">Verifique se o elemento data/PublicKey/KeyValue/RSAKeyValue/módulo existe.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-179">Ensure that the Data/PublicKey/KeyValue/RSAKeyValue/Modulus element exists.</span></span> <span data-ttu-id="2c5ad-180">O valor decodificado em base64 deve ter 256 bytes de comprimento para todos os certificados, exceto a raiz.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-180">The base64-decoded value must be 256 bytes long for all certificates except the root.</span></span> <span data-ttu-id="2c5ad-181">No certificado raiz, esse elemento deve ter 128 bytes de comprimento.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-181">In the root certificate, this element must be 128 bytes long.</span></span>
3.  <span data-ttu-id="2c5ad-182">Verifique se o elemento data/PublicKey/KeyValue/RSAKeyValue/expoente existe.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-182">Ensure that the Data/PublicKey/KeyValue/RSAKeyValue/Exponent element exists.</span></span> <span data-ttu-id="2c5ad-183">O valor decodificado em base64 não deve ser maior que 4 bytes.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-183">The base64-decoded value must not be larger than 4 bytes.</span></span>
4.  <span data-ttu-id="2c5ad-184">Se esse certificado for o certificado de folha, verifique o seguinte:</span><span class="sxs-lookup"><span data-stu-id="2c5ad-184">If this certificate is the leaf certificate, verify the following:</span></span>
    -   <span data-ttu-id="2c5ad-185">O elemento KeyUsage contém um elemento EncryptKey com o valor 1.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-185">The KeyUsage element contains an EncryptKey element with the value 1.</span></span>
    -   <span data-ttu-id="2c5ad-186">O elemento Features contém um elemento COPPCertificate com o valor 1.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-186">The Features element contains a COPPCertificate element with the value 1.</span></span>
5.  <span data-ttu-id="2c5ad-187">Se esse certificado não for o certificado de folha, verifique o seguinte:</span><span class="sxs-lookup"><span data-stu-id="2c5ad-187">If this certificate is not the leaf certificate, verify the following:</span></span>
    -   <span data-ttu-id="2c5ad-188">O módulo e o expoente do elemento data/PublicKey correspondem exatamente ao módulo e ao expoente do elemento Signature/KeyInfo do certificado anterior.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-188">The modulus and exponent from the Data/PublicKey element exactly match the modulus and exponent from the Signature/KeyInfo element of the previous certificate.</span></span>
    -   <span data-ttu-id="2c5ad-189">O elemento KeyUsage contém um elemento SignCertificate, com o valor 1.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-189">The KeyUsage element contains a SignCertificate element, with the value 1.</span></span>
6.  <span data-ttu-id="2c5ad-190">Use o algoritmo de hash SHA-1 para aplicar hash a cada byte no elemento de dados do certificado.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-190">Use the SHA-1 hash algorithm to hash every byte in the certificate's Data element.</span></span> <span data-ttu-id="2c5ad-191">Todos os bytes do primeiro caractere na <Data> marca até o último caractere na marca de fechamento </Data> devem ser codificados em hash.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-191">Every byte from the first character in the <Data> tag to the last character in the closing </Data> tag should be hashed.</span></span> <span data-ttu-id="2c5ad-192">O valor de hash é usado para verificar o certificado em relação à CRL (lista de certificados revogados), conforme descrito em [listas de certificados revogados](certificate-revocation-lists.md)</span><span class="sxs-lookup"><span data-stu-id="2c5ad-192">The hash value is used to check the certificate against the certificate revocation list (CRL), as described in [Certificate Revocation Lists](certificate-revocation-lists.md)</span></span>
7.  <span data-ttu-id="2c5ad-193">Compare o valor de hash da etapa 6 com o valor decodificado em base64 do elemento Signature/SignedInfo/Reference/DigestValue.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-193">Compare the hash value from step 6 with the base64-decoded value of the Signature/SignedInfo/Reference/DigestValue element.</span></span> <span data-ttu-id="2c5ad-194">Estes valores devem ser correspondentes.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-194">These values must match.</span></span>
8.  <span data-ttu-id="2c5ad-195">Execute o procedimento de verificação de assinatura, descrito abaixo.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-195">Perform the Verify Signature procedure, described below.</span></span>
9.  <span data-ttu-id="2c5ad-196">Se esse certificado não for o certificado final na cadeia, salve o valor Signature/KeyInfo/KeyValue/RSAKeyValue para a próxima iteração do loop.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-196">If this certificate is not the final certificate in the chain, save the Signature/KeyInfo/KeyValue/RSAKeyValue value for the next iteration of the loop.</span></span>
10. <span data-ttu-id="2c5ad-197">Se esse certificado for o certificado final na cadeia, verifique se o valor de Signature/KeyInfo/KeyValue/RSAKeyValue corresponde à chave pública da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-197">If this certificate is the final certificate in the chain, ensure that the value of Signature/KeyInfo/KeyValue/RSAKeyValue matches Microsoft's public key.</span></span> <span data-ttu-id="2c5ad-198">A chave pública da Microsoft tem os seguintes valores codificados em base64:</span><span class="sxs-lookup"><span data-stu-id="2c5ad-198">The Microsoft public key has the following base64-encoded values:</span></span>
    -   <span data-ttu-id="2c5ad-199">Igual</span><span class="sxs-lookup"><span data-stu-id="2c5ad-199">Modulus:</span></span>

        `pjoeWLSTLDonQG8She6QhkYbYott9fPZ8tHdB128ZETcghn5KHoyin7HkJEcPJ0Eg4UdSv a0KDIYDjA3EXd69R3CN2Wp/QyOo0ZPYWYp3NXpJ700tKPgIplzo5wVd/69g7j+j8M66W7V NmDwaNs9mDc1p2+VVMsDhOsV/Au6E+E=`

    -   <span data-ttu-id="2c5ad-200">Lado `AQAB`</span><span class="sxs-lookup"><span data-stu-id="2c5ad-200">Exponent: `AQAB`</span></span>

### <a name="verify-signature-procedure"></a><span data-ttu-id="2c5ad-201">Procedimento de verificação de assinatura</span><span class="sxs-lookup"><span data-stu-id="2c5ad-201">Verify Signature Procedure</span></span>

<span data-ttu-id="2c5ad-202">O valor do elemento SignatureValue é calculado sobre o elemento de dados de acordo com o esquema de assinatura digital RSASSA-PSS definido no PKCS \# 1 versão 2,1 (doravante referenciado como Pkcs).</span><span class="sxs-lookup"><span data-stu-id="2c5ad-202">The value of the SignatureValue element is computed over the Data element according to the RSASSA-PSS digital signature scheme defined in PKCS \#1 version 2.1 (hereinafter referred to as PKCS).</span></span> <span data-ttu-id="2c5ad-203">Para verificar essa assinatura, execute as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="2c5ad-203">To verify this signature, perform the following steps:</span></span>

1.  <span data-ttu-id="2c5ad-204">Decodifique os valores de módulo e expoente no elemento Signature/KeyInfo/KeyValue/RSAKeyValue.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-204">Decode the Modulus and Exponent values in the Signature/KeyInfo/KeyValue/RSAKeyValue element.</span></span> <span data-ttu-id="2c5ad-205">Esses valores definem a chave pública RSA do certificado de autenticação.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-205">These values define the RSA public key of the signing certificate.</span></span>
2.  <span data-ttu-id="2c5ad-206">Decodifique o elemento Signature/SignatureValue.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-206">Decode the Signature/SignatureValue element.</span></span>
3.  <span data-ttu-id="2c5ad-207">Compute a operação RSASSA-PSS-Verify, definida na seção 8.1.2 do PKCS.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-207">Compute the RSASSA-PSS-Verify operation, defined in section 8.1.2 of PKCS.</span></span>

<span data-ttu-id="2c5ad-208">Para a operação RSASSA-PSS-Verify, use as seguintes entradas:</span><span class="sxs-lookup"><span data-stu-id="2c5ad-208">For the RSASSA-PSS-Verify operation, use the following inputs:</span></span>

-   <span data-ttu-id="2c5ad-209">(*n*,*e*) é a chave pública da etapa 1.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-209">(*n*,*e*) is the public key from step 1.</span></span>
-   <span data-ttu-id="2c5ad-210">*M* é todos os bytes no elemento data, incluindo as marcas <Data> e</Data> que delimitam o elemento.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-210">*M* is all of the bytes in the Data element, including the <Data> and </Data> tags that enclose the element.</span></span>
-   <span data-ttu-id="2c5ad-211">*S* é o valor de assinatura decodificada da etapa 2.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-211">*S* is the decoded signature value from step 2.</span></span>

<span data-ttu-id="2c5ad-212">A operação RSASSA-PSS-Verify usa a operação EMSA-PSS-Encode, definida na seção 9.1.1.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-212">The RSASSA-PSS-Verify operation uses the EMSA-PSS-ENCODE operation, defined in section 9.1.1.</span></span> <span data-ttu-id="2c5ad-213">de PKCS.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-213">of PKCS.</span></span> <span data-ttu-id="2c5ad-214">Para essa operação, a COPP usa as seguintes opções:</span><span class="sxs-lookup"><span data-stu-id="2c5ad-214">For this operation, COPP uses the following options:</span></span>

-   <span data-ttu-id="2c5ad-215">Hash = SHA-1</span><span class="sxs-lookup"><span data-stu-id="2c5ad-215">Hash = SHA-1</span></span>
-   <span data-ttu-id="2c5ad-216">*hLen* = 20</span><span class="sxs-lookup"><span data-stu-id="2c5ad-216">*hLen* = 20</span></span>
-   <span data-ttu-id="2c5ad-217">MGF (função de geração de máscara) = MGF1</span><span class="sxs-lookup"><span data-stu-id="2c5ad-217">MGF (mask generation function) = MGF1</span></span>
-   <span data-ttu-id="2c5ad-218">*sLen* = 0</span><span class="sxs-lookup"><span data-stu-id="2c5ad-218">*sLen* = 0</span></span>

<span data-ttu-id="2c5ad-219">A função de geração de máscara MGF1 é definida no apêndice B. 2 de PKCS.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-219">The mask generation function MGF1 is defined in Appendix B.2 of PKCS.</span></span> <span data-ttu-id="2c5ad-220">Para essa função, COPP usa as seguintes opções:</span><span class="sxs-lookup"><span data-stu-id="2c5ad-220">For this function, COPP uses the following options:</span></span>

-   <span data-ttu-id="2c5ad-221">Hash = SHA-1</span><span class="sxs-lookup"><span data-stu-id="2c5ad-221">Hash = SHA-1</span></span>
-   <span data-ttu-id="2c5ad-222">*hLen* = 20</span><span class="sxs-lookup"><span data-stu-id="2c5ad-222">*hLen* = 20</span></span>

<span data-ttu-id="2c5ad-223">A saída da operação RSASSA-PSS-Verify indica se a assinatura é válida ou inválida.</span><span class="sxs-lookup"><span data-stu-id="2c5ad-223">The output of the RSASSA-PSS-Verify operation indicates whether the signature is valid or invalid.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2c5ad-224">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="2c5ad-224">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2c5ad-225">Usando o protocolo COPP (certificado de proteção de saída)</span><span class="sxs-lookup"><span data-stu-id="2c5ad-225">Using Certified Output Protection Protocol (COPP)</span></span>](using-certified-output-protection-protocol--copp.md)
</dt> </dl>

 

 



