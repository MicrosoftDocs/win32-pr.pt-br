---
description: Relógios de referência
ms.assetid: 43f1a4d6-dbed-4940-a301-d863ddd34bce
title: Relógios de referência
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f9b958787f4dbdb20cd595b10cf486f59222a072
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/06/2021
ms.locfileid: "105778427"
---
# <a name="reference-clocks"></a><span data-ttu-id="f6e3e-103">Relógios de referência</span><span class="sxs-lookup"><span data-stu-id="f6e3e-103">Reference Clocks</span></span>

<span data-ttu-id="f6e3e-104">Uma função do Gerenciador de gráficos de filtro é sincronizar todos os filtros no grafo com o mesmo relógio, chamado *relógio de referência*.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-104">One function of the Filter Graph Manager is to synchronize all of the filters in the graph to the same clock, called the *reference clock*.</span></span>

<span data-ttu-id="f6e3e-105">Qualquer objeto que expõe a interface [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock) pode atuar como o relógio de referência.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-105">Any object that exposes the [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock) interface can act as the reference clock.</span></span> <span data-ttu-id="f6e3e-106">O relógio de referência pode ser fornecido por um filtro do DirectShow — normalmente o processador de áudio, que tem acesso a um temporizador de hardware.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-106">The reference clock might be provided by a DirectShow filter—typically the audio renderer, which has access to a hardware timer.</span></span> <span data-ttu-id="f6e3e-107">Como um fallback, o Gerenciador do grafo de filtro pode usar a hora do sistema.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-107">As a fallback, the Filter Graph Manager can use the system time.</span></span>

<span data-ttu-id="f6e3e-108">No mínimo, um relógio de referência mede o tempo em intervalos de 100 nanossegundos, embora a precisão real do relógio possa ser menor.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-108">Nominally, a reference clock measures time in 100-nanosecond intervals, although the actual accuracy of the clock might be less.</span></span> <span data-ttu-id="f6e3e-109">Para recuperar a hora atual do relógio, chame o método [**IReferenceClock:: getTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-gettime) .</span><span class="sxs-lookup"><span data-stu-id="f6e3e-109">To retrieve the clock's current time, call the [**IReferenceClock::GetTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-gettime) method.</span></span> <span data-ttu-id="f6e3e-110">A linha de base do relógio — o tempo de início da contagem — depende da implementação, de modo que o valor retornado por **getTime** não é inerentemente significativo.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-110">The clock's baseline—the time from which it starts counting—depends on the implementation, so the value returned by **GetTime** is not inherently meaningful.</span></span> <span data-ttu-id="f6e3e-111">O que importa é o Delta de quando o grafo começou a ser executado.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-111">What matters is the delta from when the graph started running.</span></span>

<span data-ttu-id="f6e3e-112">Embora a precisão de um relógio de referência possa variar, os tempos retornados pelo método [**getTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-gettime) têm a garantia de aumentar o monotônico.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-112">Although the accuracy of a reference clock can vary, the times returned by the [**GetTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-gettime) method are guaranteed to increase monotonically.</span></span> <span data-ttu-id="f6e3e-113">Em outras palavras, os horários do relógio nunca serão revertidos.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-113">In other words, clock times will never go backward.</span></span> <span data-ttu-id="f6e3e-114">Se um relógio de referência estiver gerando tempos de relógio de uma fonte de hardware e o relógio de hardware saltar para trás (por exemplo, se houver um ajuste no relógio), o método **getTime** deverá continuar a retornar o último tempo relatado até que o relógio de hardware seja atualizado.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-114">If a reference clock is generating clock times from a hardware source and the hardware clock jumps backward (for example, if there is an adjustment to the clock), the **GetTime** method should continue to return the last reported time until the hardware clock catches up.</span></span> <span data-ttu-id="f6e3e-115">Para obter mais informações, consulte [**classe CBaseReferenceClock**](cbasereferenceclock.md).</span><span class="sxs-lookup"><span data-stu-id="f6e3e-115">For more information, see [**CBaseReferenceClock Class**](cbasereferenceclock.md).</span></span>

<span data-ttu-id="f6e3e-116">**Relógio de referência padrão**</span><span class="sxs-lookup"><span data-stu-id="f6e3e-116">**Default Reference Clock**</span></span>

<span data-ttu-id="f6e3e-117">O Gerenciador de gráfico de filtro seleciona automaticamente um relógio de referência quando o grafo é executado.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-117">The Filter Graph Manager automatically selects a reference clock when the graph runs.</span></span> <span data-ttu-id="f6e3e-118">Ele usa o seguinte algoritmo para selecionar o relógio:</span><span class="sxs-lookup"><span data-stu-id="f6e3e-118">It uses the following algorithm to select the clock:</span></span>

-   <span data-ttu-id="f6e3e-119">Se o aplicativo tiver selecionado um relógio (veja abaixo), use esse relógio.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-119">If the application has selected a clock (see below), use that clock.</span></span>
-   <span data-ttu-id="f6e3e-120">Se o grafo contiver um filtro de origem ao vivo que dá suporte a [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock), use esse filtro.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-120">If the graph contains a live source filter that supports [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock), use that filter.</span></span> <span data-ttu-id="f6e3e-121">Para obter a definição de uma fonte dinâmica, consulte [fontes dinâmicas](live-sources.md).</span><span class="sxs-lookup"><span data-stu-id="f6e3e-121">For the definition of a live source, see [Live Sources](live-sources.md).</span></span>
-   <span data-ttu-id="f6e3e-122">Se o grafo não contiver nenhum filtro de origem ao vivo, use todos os filtros no grafo que ofereçam suporte a [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock), começando com os renderizadores e trabalhando upstream.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-122">If the graph does NOT contain any live source filters, use any filter in the graph that supports [**IReferenceClock**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock), starting from the renderers and working upstream.</span></span> <span data-ttu-id="f6e3e-123">Prefira filtros conectados em filtros não conectados.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-123">Prefer connected filters over unconnected filters.</span></span> <span data-ttu-id="f6e3e-124">(Se o grafo estiver renderizando um fluxo de áudio, essa etapa no algoritmo normalmente selecionará o filtro de processador de áudio.)</span><span class="sxs-lookup"><span data-stu-id="f6e3e-124">(If the graph is rendering an audio stream, this step in the algorithm will normally select the audio renderer filter.)</span></span>
-   <span data-ttu-id="f6e3e-125">Se nenhum filtro fornecer um relógio adequado, use o [relógio de referência do sistema](system-reference-clock.md), que se baseia na hora do sistema.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-125">If no filter provides a suitable clock, use the [System Reference Clock](system-reference-clock.md), which is based on the system time.</span></span>

<span data-ttu-id="f6e3e-126">**Configurando o relógio de referência**</span><span class="sxs-lookup"><span data-stu-id="f6e3e-126">**Setting the Reference Clock**</span></span>

<span data-ttu-id="f6e3e-127">Um aplicativo pode selecionar um relógio chamando o método [**IMediaFilter:: Setsincronizate**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) no Gerenciador de gráfico de filtro.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-127">An application can select a clock by calling the [**IMediaFilter::SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) method on the Filter Graph Manager.</span></span> <span data-ttu-id="f6e3e-128">Você deve fazer isso somente se tiver um motivo específico para preferir outro relógio.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-128">You should do this only if you have a particular reason to prefer another clock.</span></span>

<span data-ttu-id="f6e3e-129">Você pode instruir o Gerenciador do grafo de filtro a não usar um relógio de referência chamando [**Setsyncprovider**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) com o valor **NULL**.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-129">You can instruct the Filter Graph Manager not to use a reference clock by calling [**SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) with the value **NULL**.</span></span> <span data-ttu-id="f6e3e-130">Por exemplo, você pode fazer isso para processar amostras o mais rápido possível.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-130">For example, you might do this to process samples as quickly as possible.</span></span> <span data-ttu-id="f6e3e-131">Para restaurar o relógio de referência padrão, chame o método [**IFilterGraph:: SetDefaultSyncSource**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-setdefaultsyncsource) no Gerenciador do grafo de filtro.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-131">To restore the default reference clock, call the [**IFilterGraph::SetDefaultSyncSource**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-setdefaultsyncsource) method on the Filter Graph Manager.</span></span>

<span data-ttu-id="f6e3e-132">Sempre que o relógio de referência é alterado, o Gerenciador de gráfico de filtro notifica cada filtro chamando o método [**IMediaFilter:: setsync**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) .</span><span class="sxs-lookup"><span data-stu-id="f6e3e-132">Whenever the reference clock changes, the Filter Graph Manager notifies each filter by calling its [**IMediaFilter::SetSyncSource**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) method.</span></span> <span data-ttu-id="f6e3e-133">Os aplicativos nunca devem chamar esse método em filtros.</span><span class="sxs-lookup"><span data-stu-id="f6e3e-133">Applications should never call this method on filters.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f6e3e-134">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="f6e3e-134">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f6e3e-135">Configurando o relógio do grafo</span><span class="sxs-lookup"><span data-stu-id="f6e3e-135">Setting the Graph Clock</span></span>](setting-the-graph-clock.md)
</dt> <dt>

[<span data-ttu-id="f6e3e-136">Tempo e relógios no DirectShow</span><span class="sxs-lookup"><span data-stu-id="f6e3e-136">Time and Clocks in DirectShow</span></span>](time-and-clocks-in-directshow.md)
</dt> </dl>

 

 



