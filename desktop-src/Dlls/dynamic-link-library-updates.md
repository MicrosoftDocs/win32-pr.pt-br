---
description: Às vezes, é necessário substituir uma DLL por uma versão mais recente.
ms.assetid: 82349a33-dc2c-4309-b0fc-890f230e3f2c
title: Dynamic-Link atualizações da biblioteca
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a10f76103ddebc723466fb7e32a216c0c039691d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104010657"
---
# <a name="dynamic-link-library-updates"></a><span data-ttu-id="3c67f-103">Dynamic-Link atualizações da biblioteca</span><span class="sxs-lookup"><span data-stu-id="3c67f-103">Dynamic-Link Library Updates</span></span>

<span data-ttu-id="3c67f-104">Às vezes, é necessário substituir uma DLL por uma versão mais recente.</span><span class="sxs-lookup"><span data-stu-id="3c67f-104">It is sometimes necessary to replace a DLL with a newer version.</span></span> <span data-ttu-id="3c67f-105">Antes de substituir uma DLL, execute uma verificação de versão para garantir que você está substituindo uma versão mais antiga por uma versão mais recente.</span><span class="sxs-lookup"><span data-stu-id="3c67f-105">Before replacing a DLL, perform a version check to ensure that you are replacing an older version with a newer version.</span></span> <span data-ttu-id="3c67f-106">É possível substituir uma DLL que está em uso.</span><span class="sxs-lookup"><span data-stu-id="3c67f-106">It is possible to replace a DLL that is in use.</span></span> <span data-ttu-id="3c67f-107">O método usado para substituir DLLs que estão em uso depende do sistema operacional que você está usando.</span><span class="sxs-lookup"><span data-stu-id="3c67f-107">The method you use to replace DLLs that are in use depends on the operating system you are using.</span></span> <span data-ttu-id="3c67f-108">No Windows XP e posterior, os aplicativos devem usar [aplicativos isolados e assemblies lado a lado](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span><span class="sxs-lookup"><span data-stu-id="3c67f-108">On Windows XP and later, applications should use [Isolated Applications and Side-by-side Assemblies](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span></span>

<span data-ttu-id="3c67f-109">Não é necessário reiniciar o computador se você executar as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="3c67f-109">It is not necessary to restart the computer if you perform the following steps:</span></span>

1.  <span data-ttu-id="3c67f-110">Use a função [**MoveFileEx**](/windows/desktop/api/winbase/nf-winbase-movefileexa) para renomear a DLL que está sendo substituída.</span><span class="sxs-lookup"><span data-stu-id="3c67f-110">Use the [**MoveFileEx**](/windows/desktop/api/winbase/nf-winbase-movefileexa) function to rename the DLL being replaced.</span></span> <span data-ttu-id="3c67f-111">Não especifique a cópia MOVEfile \_ \_ permitida e verifique se o arquivo renomeado está no mesmo volume que contém o arquivo original.</span><span class="sxs-lookup"><span data-stu-id="3c67f-111">Do not specify MOVEFILE\_COPY\_ALLOWED, and make sure the renamed file is on the same volume that contains the original file.</span></span> <span data-ttu-id="3c67f-112">Você também pode simplesmente renomear o arquivo no mesmo diretório, dando a ele uma extensão diferente.</span><span class="sxs-lookup"><span data-stu-id="3c67f-112">You could also simply rename the file in the same directory by giving it a different extension.</span></span>
2.  <span data-ttu-id="3c67f-113">Copie a nova DLL para o diretório que contém a DLL renomeada.</span><span class="sxs-lookup"><span data-stu-id="3c67f-113">Copy the new DLL to the directory that contains the renamed DLL.</span></span> <span data-ttu-id="3c67f-114">Todos os aplicativos agora usarão a nova DLL.</span><span class="sxs-lookup"><span data-stu-id="3c67f-114">All applications will now use the new DLL.</span></span>
3.  <span data-ttu-id="3c67f-115">Use [**MoveFileEx**](/windows/desktop/api/winbase/nf-winbase-movefileexa) com atraso de MoveFile \_ \_ até \_ a reinicialização para excluir a dll renomeada.</span><span class="sxs-lookup"><span data-stu-id="3c67f-115">Use [**MoveFileEx**](/windows/desktop/api/winbase/nf-winbase-movefileexa) with MOVEFILE\_DELAY\_UNTIL\_REBOOT to delete the renamed DLL.</span></span>

<span data-ttu-id="3c67f-116">Antes de fazer essa substituição, os aplicativos usarão a DLL original até que ela seja descarregada.</span><span class="sxs-lookup"><span data-stu-id="3c67f-116">Before you make this replacement, applications will use the original DLL until it is unloaded.</span></span> <span data-ttu-id="3c67f-117">Depois de fazer a substituição, os aplicativos usarão a nova DLL.</span><span class="sxs-lookup"><span data-stu-id="3c67f-117">After you make the replacement, applications will use the new DLL.</span></span> <span data-ttu-id="3c67f-118">Ao escrever uma DLL, você deve ter cuidado para garantir que ela esteja preparada para essa situação, especialmente se a DLL mantiver informações de estado global ou se comunicar com outros serviços.</span><span class="sxs-lookup"><span data-stu-id="3c67f-118">When you write a DLL, you must be careful to ensure that it is prepared for this situation, especially if the DLL maintains global state information or communicates with other services.</span></span> <span data-ttu-id="3c67f-119">Se a DLL não estiver preparada para uma alteração nas informações de estado global ou protocolos de comunicação, a atualização da DLL exigirá que você reinicie o computador para garantir que todos os aplicativos estejam usando a mesma versão da DLL.</span><span class="sxs-lookup"><span data-stu-id="3c67f-119">If the DLL is not prepared for a change in global state information or communication protocols, updating the DLL will require you to restart the computer to ensure that all applications are using the same version of the DLL.</span></span>

 

 
