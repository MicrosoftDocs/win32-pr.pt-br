---
description: Os aplicativos podem controlar o local do qual uma DLL é carregada, especificando um caminho completo ou usando outro mecanismo, como um manifesto. Se esses métodos não forem usados, o sistema pesquisará a DLL no tempo de carregamento, conforme descrito neste tópico.
ms.assetid: 44228cf2-6306-466c-8f16-f513cd3ba8b5
title: Ordem de pesquisa da biblioteca de Dynamic-Link
ms.topic: article
ms.date: 09/11/2020
ms.custom: contperf-fy21q1
ms.openlocfilehash: 928cf9030e24c91145ae95e1eed680017bf68533
ms.sourcegitcommit: f374b50b37160b683da16b59ac9340282a8f50a5
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/04/2021
ms.locfileid: "104500120"
---
# <a name="dynamic-link-library-search-order"></a><span data-ttu-id="bd3ae-104">Ordem de pesquisa da biblioteca de Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="bd3ae-104">Dynamic-Link Library Search Order</span></span>

<span data-ttu-id="bd3ae-105">Um sistema pode conter várias versões da mesma DLL (biblioteca de vínculo dinâmico).</span><span class="sxs-lookup"><span data-stu-id="bd3ae-105">A system can contain multiple versions of the same dynamic-link library (DLL).</span></span> <span data-ttu-id="bd3ae-106">Os aplicativos podem controlar o local do qual uma DLL é carregada, especificando um caminho completo ou usando outro mecanismo, como um manifesto.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-106">Applications can control the location from which a DLL is loaded by specifying a full path or using another mechanism such as a manifest.</span></span> <span data-ttu-id="bd3ae-107">Se esses métodos não forem usados, o sistema pesquisará a DLL no tempo de carregamento, conforme descrito neste tópico.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-107">If these methods are not used, the system searches for the DLL at load time as described in this topic.</span></span>

-   [<span data-ttu-id="bd3ae-108">Fatores que afetam a pesquisa</span><span class="sxs-lookup"><span data-stu-id="bd3ae-108">Factors That Affect Searching</span></span>](#factors-that-affect-searching)
-   [<span data-ttu-id="bd3ae-109">Ordem de pesquisa para aplicativos UWP</span><span class="sxs-lookup"><span data-stu-id="bd3ae-109">Search Order for UWP Apps</span></span>](#search-order-for-uwp-apps)
    -   [<span data-ttu-id="bd3ae-110">Ordem de pesquisa padrão para aplicativos UWP</span><span class="sxs-lookup"><span data-stu-id="bd3ae-110">Standard Search Order for UWP Apps</span></span>](#standard-search-order-for-uwp-apps)
    -   [<span data-ttu-id="bd3ae-111">Ordem de pesquisa alternativa para aplicativos UWP</span><span class="sxs-lookup"><span data-stu-id="bd3ae-111">Alternate Search Order for UWP Apps</span></span>](#alternate-search-order-for-uwp-apps)
-   [<span data-ttu-id="bd3ae-112">Ordem de pesquisa para aplicativos da área de trabalho</span><span class="sxs-lookup"><span data-stu-id="bd3ae-112">Search Order for Desktop Applications</span></span>](#search-order-for-desktop-applications)
    -   [<span data-ttu-id="bd3ae-113">Ordem de pesquisa padrão para aplicativos da área de trabalho</span><span class="sxs-lookup"><span data-stu-id="bd3ae-113">Standard Search Order for Desktop Applications</span></span>](#standard-search-order-for-desktop-applications)
    -   [<span data-ttu-id="bd3ae-114">Ordem de pesquisa alternativa para aplicativos de área de trabalho</span><span class="sxs-lookup"><span data-stu-id="bd3ae-114">Alternate Search Order for Desktop Applications</span></span>](#alternate-search-order-for-desktop-applications)
    -   [<span data-ttu-id="bd3ae-115">Ordem de pesquisa usando sinalizadores de **\_ \_ pesquisa da biblioteca de carregamento**</span><span class="sxs-lookup"><span data-stu-id="bd3ae-115">Search Order Using **LOAD\_LIBRARY\_SEARCH** Flags</span></span>](/windows)
-   [<span data-ttu-id="bd3ae-116">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="bd3ae-116">Related topics</span></span>](#related-topics)

## <a name="factors-that-affect-searching"></a><span data-ttu-id="bd3ae-117">Fatores que afetam a pesquisa</span><span class="sxs-lookup"><span data-stu-id="bd3ae-117">Factors That Affect Searching</span></span>

<span data-ttu-id="bd3ae-118">Os seguintes fatores afetam se o sistema procura uma DLL:</span><span class="sxs-lookup"><span data-stu-id="bd3ae-118">The following factors affect whether the system searches for a DLL:</span></span>

-   <span data-ttu-id="bd3ae-119">Se uma DLL com o mesmo nome de módulo já estiver carregada na memória, o sistema verificará apenas o redirecionamento e um manifesto antes de resolver para a DLL carregada, não importa em qual diretório ele está.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-119">If a DLL with the same module name is already loaded in memory, the system checks only for redirection and a manifest before resolving to the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="bd3ae-120">O sistema não pesquisa a DLL.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-120">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="bd3ae-121">Se a DLL estiver na lista de DLLs conhecidas para a versão do Windows na qual o aplicativo está sendo executado, o sistema usará sua cópia da DLL conhecida (e as DLLs dependentes da DLL conhecida, se houver) em vez de Pesquisar a DLL.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-121">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any) instead of searching for the DLL.</span></span> <span data-ttu-id="bd3ae-122">Para obter uma lista de DLLs conhecidas no sistema atual, consulte a seguinte chave do registro: **HKEY \_ local \_ Machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLLs**.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-122">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>
-   <span data-ttu-id="bd3ae-123">Se uma DLL tiver dependências, o sistema pesquisará as DLLs dependentes como se elas fossem carregadas com apenas seus nomes de módulo.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-123">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="bd3ae-124">Isso é verdadeiro mesmo que a primeira DLL tenha sido carregada especificando um caminho completo.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-124">This is true even if the first DLL was loaded by specifying a full path.</span></span>

## <a name="search-order-for-uwp-apps"></a><span data-ttu-id="bd3ae-125">Ordem de pesquisa para aplicativos UWP</span><span class="sxs-lookup"><span data-stu-id="bd3ae-125">Search Order for UWP apps</span></span>

<span data-ttu-id="bd3ae-126">Quando um aplicativo UWP para Windows 10 (ou um aplicativo da Store para Windows 8. x) carrega um módulo empacotado chamando a função [**LoadPackagedLibrary**](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary) , a DLL deve estar no grafo de dependência do pacote do processo.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-126">When a UWP app for Windows 10 (or a Store app for Windows 8.x) loads a packaged module by calling the [**LoadPackagedLibrary**](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary) function, the DLL must be in the package dependency graph of the process.</span></span> <span data-ttu-id="bd3ae-127">Para obter mais informações, consulte **LoadPackagedLibrary**.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-127">For more information, see **LoadPackagedLibrary**.</span></span> <span data-ttu-id="bd3ae-128">Quando um aplicativo UWP carrega um módulo por outros meios e não especifica um caminho completo, o sistema procura a DLL e suas dependências no tempo de carregamento, conforme descrito nesta seção.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-128">When a UWP app loads a module by other means and does not specify a full path, the system searches for the DLL and its dependencies at load time as described in this section.</span></span>

<span data-ttu-id="bd3ae-129">Antes que o sistema procure uma DLL, ele verifica o seguinte:</span><span class="sxs-lookup"><span data-stu-id="bd3ae-129">Before the system searches for a DLL, it checks the following:</span></span>

-   <span data-ttu-id="bd3ae-130">Se uma DLL com o mesmo nome de módulo já estiver carregada na memória, o sistema usará a DLL carregada, não importa em qual diretório ele está.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-130">If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="bd3ae-131">O sistema não pesquisa a DLL.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-131">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="bd3ae-132">Se a DLL estiver na lista de DLLs conhecidas para a versão do Windows na qual o aplicativo está sendo executado, o sistema usará sua cópia da DLL conhecida (e as DLLs dependentes da DLL conhecida, se houver).</span><span class="sxs-lookup"><span data-stu-id="bd3ae-132">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any).</span></span> <span data-ttu-id="bd3ae-133">O sistema não pesquisa a DLL.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-133">The system does not search for the DLL.</span></span> <span data-ttu-id="bd3ae-134">Para obter uma lista de DLLs conhecidas no sistema atual, consulte a seguinte chave do registro: **HKEY \_ local \_ Machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLLs**.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-134">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>

<span data-ttu-id="bd3ae-135">Se o sistema precisar pesquisar um módulo ou suas dependências, ele sempre usará a ordem de pesquisa para aplicativos UWP, mesmo se uma dependência não for um código de aplicativo UWP.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-135">If the system must search for a module or its dependencies, it always uses the search order for UWP apps even if a dependency is not UWP app code.</span></span>

### <a name="standard-search-order-for-uwp-apps"></a><span data-ttu-id="bd3ae-136">Ordem de pesquisa padrão para aplicativos UWP</span><span class="sxs-lookup"><span data-stu-id="bd3ae-136">Standard Search Order for UWP apps</span></span>

<span data-ttu-id="bd3ae-137">Se o módulo ainda não estiver carregado ou na lista de DLLs conhecidas, o sistema pesquisará esses locais nesta ordem:</span><span class="sxs-lookup"><span data-stu-id="bd3ae-137">If the module is not already loaded or on the list of known DLLs, the system searches these locations in this order:</span></span>

1.  <span data-ttu-id="bd3ae-138">O grafo de dependência do pacote do processo.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-138">The package dependency graph of the process.</span></span> <span data-ttu-id="bd3ae-139">Esse é o pacote do aplicativo, além de quaisquer dependências especificadas como `<PackageDependency>` na `<Dependencies>` seção do manifesto do pacote do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-139">This is the application's package plus any dependencies specified as `<PackageDependency>` in the `<Dependencies>` section of the application's package manifest.</span></span> <span data-ttu-id="bd3ae-140">As dependências são pesquisadas na ordem em que aparecem no manifesto.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-140">Dependencies are searched in the order they appear in the manifest.</span></span>
2.  <span data-ttu-id="bd3ae-141">O diretório do qual o processo de chamada foi carregado.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-141">The directory the calling process was loaded from.</span></span>
3.  <span data-ttu-id="bd3ae-142">O diretório do sistema (% SystemRoot% \\ System32).</span><span class="sxs-lookup"><span data-stu-id="bd3ae-142">The system directory (%SystemRoot%\\system32).</span></span>

<span data-ttu-id="bd3ae-143">Se uma DLL tiver dependências, o sistema pesquisará as DLLs dependentes como se elas fossem carregadas com apenas seus nomes de módulo.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-143">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="bd3ae-144">Isso é verdadeiro mesmo que a primeira DLL tenha sido carregada especificando um caminho completo.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-144">This is true even if the first DLL was loaded by specifying a full path.</span></span>

### <a name="alternate-search-order-for-uwp-apps"></a><span data-ttu-id="bd3ae-145">Ordem de pesquisa alternativa para aplicativos UWP</span><span class="sxs-lookup"><span data-stu-id="bd3ae-145">Alternate Search Order for UWP apps</span></span>

<span data-ttu-id="bd3ae-146">Se um módulo alterar a ordem de pesquisa padrão chamando a função [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) com **Load \_ com \_ o \_ \_ caminho de pesquisa alterado**, o sistema pesquisará o diretório no qual o módulo especificado foi carregado, em vez do diretório do processo de chamada.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-146">If a module changes the standard search order by calling the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH**, the system searches the directory the specified module was loaded from instead of the directory of the calling process.</span></span> <span data-ttu-id="bd3ae-147">O sistema pesquisa esses locais nesta ordem:</span><span class="sxs-lookup"><span data-stu-id="bd3ae-147">The system searches these locations in this order:</span></span>

1.  <span data-ttu-id="bd3ae-148">O grafo de dependência do pacote do processo.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-148">The package dependency graph of the process.</span></span> <span data-ttu-id="bd3ae-149">Esse é o pacote do aplicativo, além de quaisquer dependências especificadas como `<PackageDependency>` na `<Dependencies>` seção do manifesto do pacote do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-149">This is the application's package plus any dependencies specified as `<PackageDependency>` in the `<Dependencies>` section of the application's package manifest.</span></span> <span data-ttu-id="bd3ae-150">As dependências são pesquisadas na ordem em que aparecem no manifesto.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-150">Dependencies are searched in the order they appear in the manifest.</span></span>
2.  <span data-ttu-id="bd3ae-151">O diretório do qual o módulo especificado foi carregado.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-151">The directory the specified module was loaded from.</span></span>
3.  <span data-ttu-id="bd3ae-152">O diretório do sistema (% SystemRoot% \\ System32).</span><span class="sxs-lookup"><span data-stu-id="bd3ae-152">The system directory (%SystemRoot%\\system32).</span></span>

## <a name="search-order-for-desktop-applications"></a><span data-ttu-id="bd3ae-153">Ordem de pesquisa para aplicativos da área de trabalho</span><span class="sxs-lookup"><span data-stu-id="bd3ae-153">Search Order for Desktop Applications</span></span>

<span data-ttu-id="bd3ae-154">Os aplicativos de área de trabalho podem controlar o local do qual uma DLL é carregada, especificando um caminho completo, usando o [redirecionamento de dll](dynamic-link-library-redirection.md)ou usando um [manifesto](/windows/desktop/SbsCs/manifests).</span><span class="sxs-lookup"><span data-stu-id="bd3ae-154">Desktop applications can control the location from which a DLL is loaded by specifying a full path, using [DLL redirection](dynamic-link-library-redirection.md), or by using a [manifest](/windows/desktop/SbsCs/manifests).</span></span> <span data-ttu-id="bd3ae-155">Se nenhum desses métodos for usado, o sistema pesquisará a DLL no tempo de carregamento, conforme descrito nesta seção.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-155">If none of these methods are used, the system searches for the DLL at load time as described in this section.</span></span>

<span data-ttu-id="bd3ae-156">Antes que o sistema procure uma DLL, ele verifica o seguinte:</span><span class="sxs-lookup"><span data-stu-id="bd3ae-156">Before the system searches for a DLL, it checks the following:</span></span>

-   <span data-ttu-id="bd3ae-157">Se uma DLL com o mesmo nome de módulo já estiver carregada na memória, o sistema usará a DLL carregada, não importa em qual diretório ele está.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-157">If a DLL with the same module name is already loaded in memory, the system uses the loaded DLL, no matter which directory it is in.</span></span> <span data-ttu-id="bd3ae-158">O sistema não pesquisa a DLL.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-158">The system does not search for the DLL.</span></span>
-   <span data-ttu-id="bd3ae-159">Se a DLL estiver na lista de DLLs conhecidas para a versão do Windows na qual o aplicativo está sendo executado, o sistema usará sua cópia da DLL conhecida (e as DLLs dependentes da DLL conhecida, se houver).</span><span class="sxs-lookup"><span data-stu-id="bd3ae-159">If the DLL is on the list of known DLLs for the version of Windows on which the application is running, the system uses its copy of the known DLL (and the known DLL's dependent DLLs, if any).</span></span> <span data-ttu-id="bd3ae-160">O sistema não pesquisa a DLL.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-160">The system does not search for the DLL.</span></span> <span data-ttu-id="bd3ae-161">Para obter uma lista de DLLs conhecidas no sistema atual, consulte a seguinte chave do registro: **HKEY \_ local \_ Machine \\ System \\ CurrentControlSet \\ Control \\ Session Manager \\ KnownDLLs**.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-161">For a list of known DLLs on the current system, see the following registry key: **HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs**.</span></span>

<span data-ttu-id="bd3ae-162">Se uma DLL tiver dependências, o sistema pesquisará as DLLs dependentes como se elas fossem carregadas com apenas seus nomes de módulo.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-162">If a DLL has dependencies, the system searches for the dependent DLLs as if they were loaded with just their module names.</span></span> <span data-ttu-id="bd3ae-163">Isso é verdadeiro mesmo que a primeira DLL tenha sido carregada especificando um caminho completo.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-163">This is true even if the first DLL was loaded by specifying a full path.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="bd3ae-164">Se um invasor obtiver o controle de um dos diretórios que é pesquisado, ele poderá fazer uma cópia mal-intencionada da DLL nesse diretório.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-164">If an attacker gains control of one of the directories that is searched, it can place a malicious copy of the DLL in that directory.</span></span> <span data-ttu-id="bd3ae-165">Para obter maneiras de ajudar a evitar esses ataques, consulte [segurança da biblioteca de vínculo dinâmico](dynamic-link-library-security.md).</span><span class="sxs-lookup"><span data-stu-id="bd3ae-165">For ways to help prevent such attacks, see [Dynamic-Link Library Security](dynamic-link-library-security.md).</span></span>

### <a name="standard-search-order-for-desktop-applications"></a><span data-ttu-id="bd3ae-166">Ordem de pesquisa padrão para aplicativos da área de trabalho</span><span class="sxs-lookup"><span data-stu-id="bd3ae-166">Standard Search Order for Desktop Applications</span></span>

<span data-ttu-id="bd3ae-167">A ordem de pesquisa padrão da DLL usada pelo sistema depende de se o modo de pesquisa de DLL seguro está habilitado ou desabilitado.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-167">The standard DLL search order used by the system depends on whether safe DLL search mode is enabled or disabled.</span></span> <span data-ttu-id="bd3ae-168">O modo de pesquisa de DLL seguro coloca o diretório atual do usuário mais tarde na ordem de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-168">Safe DLL search mode places the user's current directory later in the search order.</span></span>

<span data-ttu-id="bd3ae-169">O modo de pesquisa de DLL seguro é habilitado por padrão.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-169">Safe DLL search mode is enabled by default.</span></span> <span data-ttu-id="bd3ae-170">Para desabilitar esse recurso, crie o valor do registro **HKEY \_ local \_ System do \\ sistema \\ CurrentControlSet \\ Control \\ Session Manager** \\ **SafeDllSearchMode** e defina-o como 0.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-170">To disable this feature, create the **HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager**\\**SafeDllSearchMode** registry value and set it to 0.</span></span> <span data-ttu-id="bd3ae-171">Chamar a função [**SetDllDirectory**](/windows/desktop/api/winbase/nf-winbase-setdlldirectorya) efetivamente desabilita **SafeDllSearchMode** enquanto o diretório especificado está no caminho de pesquisa e altera a ordem de pesquisa, conforme descrito neste tópico.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-171">Calling the [**SetDllDirectory**](/windows/desktop/api/winbase/nf-winbase-setdlldirectorya) function effectively disables **SafeDllSearchMode** while the specified directory is in the search path and changes the search order as described in this topic.</span></span>

<span data-ttu-id="bd3ae-172">Se **SafeDllSearchMode** estiver habilitado, a ordem de pesquisa será a seguinte:</span><span class="sxs-lookup"><span data-stu-id="bd3ae-172">If **SafeDllSearchMode** is enabled, the search order is as follows:</span></span>

1.  <span data-ttu-id="bd3ae-173">O diretório do qual o aplicativo foi carregado.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-173">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="bd3ae-174">O diretório do sistema.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-174">The system directory.</span></span> <span data-ttu-id="bd3ae-175">Use a função [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) para obter o caminho desse diretório.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-175">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
3.  <span data-ttu-id="bd3ae-176">O diretório do sistema de 16 bits.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-176">The 16-bit system directory.</span></span> <span data-ttu-id="bd3ae-177">Não há nenhuma função que obtenha o caminho desse diretório, mas ela é pesquisada.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-177">There is no function that obtains the path of this directory, but it is searched.</span></span>
4.  <span data-ttu-id="bd3ae-178">O diretório do Windows.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-178">The Windows directory.</span></span> <span data-ttu-id="bd3ae-179">Use a função [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) para obter o caminho desse diretório.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-179">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
5.  <span data-ttu-id="bd3ae-180">O diretório atual.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-180">The current directory.</span></span>
6.  <span data-ttu-id="bd3ae-181">Os diretórios listados na variável de ambiente PATH.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-181">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="bd3ae-182">Observe que isso não inclui o caminho por aplicativo especificado pela chave do registro de **caminhos do aplicativo** .</span><span class="sxs-lookup"><span data-stu-id="bd3ae-182">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="bd3ae-183">A chave de **caminhos do aplicativo** não é usada ao calcular o caminho de pesquisa da dll.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-183">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="bd3ae-184">Se **SafeDllSearchMode** estiver desabilitado, a ordem de pesquisa será a seguinte:</span><span class="sxs-lookup"><span data-stu-id="bd3ae-184">If **SafeDllSearchMode** is disabled, the search order is as follows:</span></span>

1.  <span data-ttu-id="bd3ae-185">O diretório do qual o aplicativo foi carregado.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-185">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="bd3ae-186">O diretório atual.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-186">The current directory.</span></span>
3.  <span data-ttu-id="bd3ae-187">O diretório do sistema.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-187">The system directory.</span></span> <span data-ttu-id="bd3ae-188">Use a função [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) para obter o caminho desse diretório.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-188">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
4.  <span data-ttu-id="bd3ae-189">O diretório do sistema de 16 bits.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-189">The 16-bit system directory.</span></span> <span data-ttu-id="bd3ae-190">Não há nenhuma função que obtenha o caminho desse diretório, mas ela é pesquisada.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-190">There is no function that obtains the path of this directory, but it is searched.</span></span>
5.  <span data-ttu-id="bd3ae-191">O diretório do Windows.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-191">The Windows directory.</span></span> <span data-ttu-id="bd3ae-192">Use a função [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) para obter o caminho desse diretório.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-192">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="bd3ae-193">Os diretórios listados na variável de ambiente PATH.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-193">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="bd3ae-194">Observe que isso não inclui o caminho por aplicativo especificado pela chave do registro de **caminhos do aplicativo** .</span><span class="sxs-lookup"><span data-stu-id="bd3ae-194">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="bd3ae-195">A chave de **caminhos do aplicativo** não é usada ao calcular o caminho de pesquisa da dll.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-195">The **App Paths** key is not used when computing the DLL search path.</span></span>

### <a name="alternate-search-order-for-desktop-applications"></a><span data-ttu-id="bd3ae-196">Ordem de pesquisa alternativa para aplicativos de área de trabalho</span><span class="sxs-lookup"><span data-stu-id="bd3ae-196">Alternate Search Order for Desktop Applications</span></span>

<span data-ttu-id="bd3ae-197">A ordem de pesquisa padrão usada pelo sistema pode ser alterada chamando a função [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) com **Load \_ com o \_ \_ \_ caminho de pesquisa alterado**.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-197">The standard search order used by the system can be changed by calling the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH**.</span></span> <span data-ttu-id="bd3ae-198">A ordem de pesquisa padrão também pode ser alterada chamando a função [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="bd3ae-198">The standard search order can also be changed by calling the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function.</span></span>

> [!NOTE]
> <span data-ttu-id="bd3ae-199">A ordem de pesquisa padrão do processo também será afetada chamando a função [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) no processo pai antes do início do processo atual.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-199">The standard search order of the process will also be affected by calling the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function in the parent process before start of the current process.</span></span>

<span data-ttu-id="bd3ae-200">Se você especificar uma estratégia de pesquisa alternativa, seu comportamento continuará até que todos os módulos executáveis associados tenham sido localizados.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-200">If you specify an alternate search strategy, its behavior continues until all associated executable modules have been located.</span></span> <span data-ttu-id="bd3ae-201">Depois que o sistema inicia o processamento de rotinas de inicialização de DLL, o sistema reverte para a estratégia de pesquisa padrão.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-201">After the system starts processing DLL initialization routines, the system reverts to the standard search strategy.</span></span>

<span data-ttu-id="bd3ae-202">A função [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) dará suporte a uma ordem de pesquisa alternativa se a chamada especificar **Load com o \_ \_ \_ \_ caminho de pesquisa alterado** e o parâmetro *lpFileName* especificar um caminho absoluto.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-202">The [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function supports an alternate search order if the call specifies **LOAD\_WITH\_ALTERED\_SEARCH\_PATH** and the *lpFileName* parameter specifies an absolute path.</span></span>

<span data-ttu-id="bd3ae-203">Observe que a estratégia de pesquisa padrão e a estratégia de pesquisa alternativa especificada por [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) com **carga \_ com o \_ \_ \_ caminho de pesquisa alterado** diferem de apenas uma maneira: a pesquisa padrão começa no diretório do aplicativo de chamada e a pesquisa alternativa começa no diretório do módulo executável que o **LoadLibraryEx** está carregando.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-203">Note that the standard search strategy and the alternate search strategy specified by [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) with **LOAD\_WITH\_ALTERED\_SEARCH\_PATH** differ in just one way: The standard search begins in the calling application's directory, and the alternate search begins in the directory of the executable module that **LoadLibraryEx** is loading.</span></span>

<span data-ttu-id="bd3ae-204">Se **SafeDllSearchMode** estiver habilitado, a ordem de pesquisa alternativa será a seguinte:</span><span class="sxs-lookup"><span data-stu-id="bd3ae-204">If **SafeDllSearchMode** is enabled, the alternate search order is as follows:</span></span>

1.  <span data-ttu-id="bd3ae-205">O diretório especificado por *lpFileName*.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-205">The directory specified by *lpFileName*.</span></span>
2.  <span data-ttu-id="bd3ae-206">O diretório do sistema.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-206">The system directory.</span></span> <span data-ttu-id="bd3ae-207">Use a função [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) para obter o caminho desse diretório.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-207">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
3.  <span data-ttu-id="bd3ae-208">O diretório do sistema de 16 bits.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-208">The 16-bit system directory.</span></span> <span data-ttu-id="bd3ae-209">Não há nenhuma função que obtenha o caminho desse diretório, mas ela é pesquisada.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-209">There is no function that obtains the path of this directory, but it is searched.</span></span>
4.  <span data-ttu-id="bd3ae-210">O diretório do Windows.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-210">The Windows directory.</span></span> <span data-ttu-id="bd3ae-211">Use a função [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) para obter o caminho desse diretório.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-211">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
5.  <span data-ttu-id="bd3ae-212">O diretório atual.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-212">The current directory.</span></span>
6.  <span data-ttu-id="bd3ae-213">Os diretórios listados na variável de ambiente PATH.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-213">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="bd3ae-214">Observe que isso não inclui o caminho por aplicativo especificado pela chave do registro de **caminhos do aplicativo** .</span><span class="sxs-lookup"><span data-stu-id="bd3ae-214">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="bd3ae-215">A chave de **caminhos do aplicativo** não é usada ao calcular o caminho de pesquisa da dll.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-215">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="bd3ae-216">Se **SafeDllSearchMode** estiver desabilitado, a ordem de pesquisa alternativa será a seguinte:</span><span class="sxs-lookup"><span data-stu-id="bd3ae-216">If **SafeDllSearchMode** is disabled, the alternate search order is as follows:</span></span>

1.  <span data-ttu-id="bd3ae-217">O diretório especificado por *lpFileName*.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-217">The directory specified by *lpFileName*.</span></span>
2.  <span data-ttu-id="bd3ae-218">O diretório atual.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-218">The current directory.</span></span>
3.  <span data-ttu-id="bd3ae-219">O diretório do sistema.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-219">The system directory.</span></span> <span data-ttu-id="bd3ae-220">Use a função [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) para obter o caminho desse diretório.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-220">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span>
4.  <span data-ttu-id="bd3ae-221">O diretório do sistema de 16 bits.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-221">The 16-bit system directory.</span></span> <span data-ttu-id="bd3ae-222">Não há nenhuma função que obtenha o caminho desse diretório, mas ela é pesquisada.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-222">There is no function that obtains the path of this directory, but it is searched.</span></span>
5.  <span data-ttu-id="bd3ae-223">O diretório do Windows.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-223">The Windows directory.</span></span> <span data-ttu-id="bd3ae-224">Use a função [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) para obter o caminho desse diretório.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-224">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="bd3ae-225">Os diretórios listados na variável de ambiente PATH.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-225">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="bd3ae-226">Observe que isso não inclui o caminho por aplicativo especificado pela chave do registro de **caminhos do aplicativo** .</span><span class="sxs-lookup"><span data-stu-id="bd3ae-226">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="bd3ae-227">A chave de **caminhos do aplicativo** não é usada ao calcular o caminho de pesquisa da dll.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-227">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="bd3ae-228">A função [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) dará suporte a uma ordem de pesquisa alternativa se o parâmetro *lpPathName* especificar um caminho.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-228">The [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function supports an alternate search order if the *lpPathName* parameter specifies a path.</span></span> <span data-ttu-id="bd3ae-229">A ordem de pesquisa alternativa é a seguinte:</span><span class="sxs-lookup"><span data-stu-id="bd3ae-229">The alternate search order is as follows:</span></span>

1.  <span data-ttu-id="bd3ae-230">O diretório do qual o aplicativo foi carregado.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-230">The directory from which the application loaded.</span></span>
2.  <span data-ttu-id="bd3ae-231">O diretório especificado pelo parâmetro *lpPathName* de [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya).</span><span class="sxs-lookup"><span data-stu-id="bd3ae-231">The directory specified by the *lpPathName* parameter of [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya).</span></span>
3.  <span data-ttu-id="bd3ae-232">O diretório do sistema.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-232">The system directory.</span></span> <span data-ttu-id="bd3ae-233">Use a função [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) para obter o caminho desse diretório.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-233">Use the [**GetSystemDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) function to get the path of this directory.</span></span> <span data-ttu-id="bd3ae-234">O nome desse diretório é system32.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-234">The name of this directory is System32.</span></span>
4.  <span data-ttu-id="bd3ae-235">O diretório do sistema de 16 bits.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-235">The 16-bit system directory.</span></span> <span data-ttu-id="bd3ae-236">Não há nenhuma função que obtenha o caminho desse diretório, mas ela é pesquisada.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-236">There is no function that obtains the path of this directory, but it is searched.</span></span> <span data-ttu-id="bd3ae-237">O nome desse diretório é System.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-237">The name of this directory is System.</span></span>
5.  <span data-ttu-id="bd3ae-238">O diretório do Windows.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-238">The Windows directory.</span></span> <span data-ttu-id="bd3ae-239">Use a função [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) para obter o caminho desse diretório.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-239">Use the [**GetWindowsDirectory**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) function to get the path of this directory.</span></span>
6.  <span data-ttu-id="bd3ae-240">Os diretórios listados na variável de ambiente PATH.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-240">The directories that are listed in the PATH environment variable.</span></span> <span data-ttu-id="bd3ae-241">Observe que isso não inclui o caminho por aplicativo especificado pela chave do registro de **caminhos do aplicativo** .</span><span class="sxs-lookup"><span data-stu-id="bd3ae-241">Note that this does not include the per-application path specified by the **App Paths** registry key.</span></span> <span data-ttu-id="bd3ae-242">A chave de **caminhos do aplicativo** não é usada ao calcular o caminho de pesquisa da dll.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-242">The **App Paths** key is not used when computing the DLL search path.</span></span>

<span data-ttu-id="bd3ae-243">Se o parâmetro *lpPathName* for uma cadeia de caracteres vazia, a chamada removerá o diretório atual da ordem de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-243">If the *lpPathName* parameter is an empty string, the call removes the current directory from the search order.</span></span>

<span data-ttu-id="bd3ae-244">[**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) efetivamente desabilita o modo de pesquisa de dll seguro enquanto o diretório especificado está no caminho de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-244">[**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) effectively disables safe DLL search mode while the specified directory is in the search path.</span></span> <span data-ttu-id="bd3ae-245">Para restaurar o modo de pesquisa de DLL seguro com base no valor de registro **SafeDllSearchMode** e restaurar o diretório atual para a ordem de pesquisa, chame **SetDllDirectory** com *lpPathName* como nulo.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-245">To restore safe DLL search mode based on the **SafeDllSearchMode** registry value and restore the current directory to the search order, call **SetDllDirectory** with *lpPathName* as NULL.</span></span>

### <a name="search-order-using-load_library_search-flags"></a><span data-ttu-id="bd3ae-246">Ordem de pesquisa usando sinalizadores de **\_ \_ pesquisa da biblioteca de carregamento**</span><span class="sxs-lookup"><span data-stu-id="bd3ae-246">Search Order Using **LOAD\_LIBRARY\_SEARCH** Flags</span></span>

<span data-ttu-id="bd3ae-247">Um aplicativo pode especificar uma ordem de pesquisa usando um ou mais sinalizadores de **\_ \_ pesquisa da biblioteca de carregamento** com a função [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) .</span><span class="sxs-lookup"><span data-stu-id="bd3ae-247">An application can specify a search order by using one or more **LOAD\_LIBRARY\_SEARCH** flags with the [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) function.</span></span> <span data-ttu-id="bd3ae-248">Um aplicativo também pode usar sinalizadores de **\_ \_ pesquisa da biblioteca de carregamento** com a função [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) para estabelecer uma ordem de pesquisa de dll para um processo.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-248">An application can also use **LOAD\_LIBRARY\_SEARCH** flags with the [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) function to establish a DLL search order for a process.</span></span> <span data-ttu-id="bd3ae-249">O aplicativo pode especificar diretórios adicionais para a ordem de pesquisa da DLL de processo usando as funções [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) ou [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="bd3ae-249">The application can specify additional directories for the process DLL search order by using the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) or [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) functions.</span></span>

<span data-ttu-id="bd3ae-250">Os diretórios pesquisados dependem dos sinalizadores especificados com [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) ou [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span><span class="sxs-lookup"><span data-stu-id="bd3ae-250">The directories that are searched depend on the flags specified with [**SetDefaultDllDirectories**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span></span> <span data-ttu-id="bd3ae-251">Se mais de um sinalizador for usado, os diretórios correspondentes serão pesquisados na seguinte ordem:</span><span class="sxs-lookup"><span data-stu-id="bd3ae-251">If more than one flag is used, the corresponding directories are searched in the following order:</span></span>

1.  <span data-ttu-id="bd3ae-252">O diretório que contém a DLL (**Load \_ library \_ Search \_ dll \_ de \_ carregamento da biblioteca de carregamento**).</span><span class="sxs-lookup"><span data-stu-id="bd3ae-252">The directory that contains the DLL (**LOAD\_LIBRARY\_SEARCH\_DLL\_LOAD\_DIR**).</span></span> <span data-ttu-id="bd3ae-253">Esse diretório é pesquisado apenas para dependências da DLL a serem carregadas.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-253">This directory is searched only for dependencies of the DLL to be loaded.</span></span>
2.  <span data-ttu-id="bd3ae-254">O diretório do aplicativo (**Load \_ library Search Directory \_ \_ \_ dir**).</span><span class="sxs-lookup"><span data-stu-id="bd3ae-254">The application directory (**LOAD\_LIBRARY\_SEARCH\_APPLICATION\_DIR**).</span></span>
3.  <span data-ttu-id="bd3ae-255">Caminhos adicionados explicitamente com a função [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) (**diretórios de \_ usuário de pesquisa da biblioteca \_ \_ \_ de carregamento**) ou a função [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) .</span><span class="sxs-lookup"><span data-stu-id="bd3ae-255">Paths explicitly added with the [**AddDllDirectory**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory) function (**LOAD\_LIBRARY\_SEARCH\_USER\_DIRS**) or the [**SetDllDirectory**](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya) function.</span></span> <span data-ttu-id="bd3ae-256">Se mais de um caminho tiver sido adicionado, a ordem na qual os caminhos são pesquisados não será especificada.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-256">If more than one path has been added, the order in which the paths are searched is unspecified.</span></span>
4.  <span data-ttu-id="bd3ae-257">O diretório do sistema (**Load \_ library \_ Search \_ System32**).</span><span class="sxs-lookup"><span data-stu-id="bd3ae-257">The System directory (**LOAD\_LIBRARY\_SEARCH\_SYSTEM32**).</span></span>

<span data-ttu-id="bd3ae-258">Se o aplicativo não chamar [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) com nenhum sinalizador **de \_ \_ pesquisa de biblioteca de carga** ou estabelecer uma ordem de pesquisa de dll para o processo, o sistema pesquisará DLLs usando a ordem de pesquisa padrão ou a ordem de pesquisa alternativa.</span><span class="sxs-lookup"><span data-stu-id="bd3ae-258">If the application does not call [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa) with any **LOAD\_LIBRARY\_SEARCH** flags or establish a DLL search order for the process, the system searches for DLLs using either the standard search order or the alternate search order.</span></span>

## <a name="related-topics"></a><span data-ttu-id="bd3ae-259">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="bd3ae-259">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="bd3ae-260">**AddDllDirectory**</span><span class="sxs-lookup"><span data-stu-id="bd3ae-260">**AddDllDirectory**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-adddlldirectory)
</dt> <dt>

[<span data-ttu-id="bd3ae-261">registro de Aplicativo</span><span class="sxs-lookup"><span data-stu-id="bd3ae-261">Application Registration</span></span>](/windows/desktop/shell/app-registration)
</dt> <dt>

[<span data-ttu-id="bd3ae-262">Redirecionamento de biblioteca de vínculo dinâmico</span><span class="sxs-lookup"><span data-stu-id="bd3ae-262">Dynamic-Link Library Redirection</span></span>](dynamic-link-library-redirection.md)
</dt> <dt>

[<span data-ttu-id="bd3ae-263">Segurança da biblioteca de vínculo dinâmico</span><span class="sxs-lookup"><span data-stu-id="bd3ae-263">Dynamic-Link Library Security</span></span>](dynamic-link-library-security.md)
</dt> <dt>

[<span data-ttu-id="bd3ae-264">**LoadLibrary**</span><span class="sxs-lookup"><span data-stu-id="bd3ae-264">**LoadLibrary**</span></span>](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya)
</dt> <dt>

[<span data-ttu-id="bd3ae-265">**LoadLibraryEx**</span><span class="sxs-lookup"><span data-stu-id="bd3ae-265">**LoadLibraryEx**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa)
</dt> <dt>

[<span data-ttu-id="bd3ae-266">**LoadPackagedLibrary**</span><span class="sxs-lookup"><span data-stu-id="bd3ae-266">**LoadPackagedLibrary**</span></span>](/windows/desktop/api/Winbase/nf-winbase-loadpackagedlibrary)
</dt> <dt>

[<span data-ttu-id="bd3ae-267">**SetDefaultDllDirectories**</span><span class="sxs-lookup"><span data-stu-id="bd3ae-267">**SetDefaultDllDirectories**</span></span>](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-setdefaultdlldirectories)
</dt> <dt>

[<span data-ttu-id="bd3ae-268">**SetDllDirectory**</span><span class="sxs-lookup"><span data-stu-id="bd3ae-268">**SetDllDirectory**</span></span>](/windows/desktop/api/Winbase/nf-winbase-setdlldirectorya)
</dt> <dt>

[<span data-ttu-id="bd3ae-269">Componentes lado a lado</span><span class="sxs-lookup"><span data-stu-id="bd3ae-269">Side-by-side Components</span></span>](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal)
</dt> </dl>

 

 