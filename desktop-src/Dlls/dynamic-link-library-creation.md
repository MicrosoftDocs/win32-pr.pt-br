---
description: Para criar uma DLL (biblioteca de Dynamic-Link), você deve criar um ou mais arquivos de código-fonte e, possivelmente, um arquivo vinculador para exportar as funções.
ms.assetid: b66ea0e8-84c3-40be-bf02-765b9dd61f9f
title: Criação de biblioteca de Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c12d296b1494cfcedcdfa823eb1a3dd4d408427a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103647719"
---
# <a name="dynamic-link-library-creation"></a><span data-ttu-id="01e8d-103">Criação de biblioteca de Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="01e8d-103">Dynamic-Link Library Creation</span></span>

<span data-ttu-id="01e8d-104">Para criar uma DLL (biblioteca de Dynamic-Link), você deve criar um ou mais arquivos de código-fonte e, possivelmente, um arquivo vinculador para exportar as funções.</span><span class="sxs-lookup"><span data-stu-id="01e8d-104">To create a Dynamic-Link Library (DLL), you must create one or more source code files, and possibly a linker file for exporting the functions.</span></span> <span data-ttu-id="01e8d-105">Se você planeja permitir que os aplicativos que usam sua DLL usem vinculação dinâmica de tempo de carregamento, você também deve criar uma biblioteca de importação.</span><span class="sxs-lookup"><span data-stu-id="01e8d-105">If you plan to allow applications that use your DLL to use load-time dynamic linking, you must also create an import library.</span></span>

## <a name="creating-source-files"></a><span data-ttu-id="01e8d-106">Criando arquivos de origem</span><span class="sxs-lookup"><span data-stu-id="01e8d-106">Creating Source Files</span></span>

<span data-ttu-id="01e8d-107">Os arquivos de origem de uma DLL contêm dados e funções exportadas, funções e dados internos e uma [função de ponto de entrada](dynamic-link-library-entry-point-function.md) opcional para a dll.</span><span class="sxs-lookup"><span data-stu-id="01e8d-107">The source files for a DLL contain exported functions and data, internal functions and data, and an optional [entry-point function](dynamic-link-library-entry-point-function.md) for the DLL.</span></span> <span data-ttu-id="01e8d-108">Você pode usar qualquer ferramenta de desenvolvimento que ofereça suporte à criação de DLLs baseadas no Windows.</span><span class="sxs-lookup"><span data-stu-id="01e8d-108">You may use any development tools that support the creation of Windows-based DLLs.</span></span>

<span data-ttu-id="01e8d-109">Se sua DLL pode ser usada por um aplicativo multi-threaded, você deve tornar sua DLL "thread-safe".</span><span class="sxs-lookup"><span data-stu-id="01e8d-109">If your DLL may be used by a multithreaded application, you should make your DLL "thread-safe".</span></span> <span data-ttu-id="01e8d-110">Você deve sincronizar o acesso a todos os dados globais da DLL para evitar dados corrompidos.</span><span class="sxs-lookup"><span data-stu-id="01e8d-110">You must synchronize access to all of the DLL's global data to avoid data corruption.</span></span> <span data-ttu-id="01e8d-111">Você também deve garantir que você vincule somente com bibliotecas que também são thread-safe.</span><span class="sxs-lookup"><span data-stu-id="01e8d-111">You must also ensure that you link only with libraries that are thread-safe as well.</span></span> <span data-ttu-id="01e8d-112">Por exemplo, Microsoft Visual C++ contém várias versões da biblioteca de tempo de execução C, uma que não é thread-safe e duas que são.</span><span class="sxs-lookup"><span data-stu-id="01e8d-112">For example, Microsoft Visual C++ contains multiple versions of the C Run-time Library, one that is not thread-safe and two that are.</span></span>

## <a name="exporting-functions"></a><span data-ttu-id="01e8d-113">Exportando funções</span><span class="sxs-lookup"><span data-stu-id="01e8d-113">Exporting Functions</span></span>

<span data-ttu-id="01e8d-114">A maneira como você especifica quais funções em uma DLL devem ser exportadas depende das ferramentas que você está usando para desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="01e8d-114">How you specify which functions in a DLL should be exported depends on the tools that you are using for development.</span></span> <span data-ttu-id="01e8d-115">Alguns compiladores permitem que você exporte uma função diretamente no código-fonte usando um modificador na declaração da função.</span><span class="sxs-lookup"><span data-stu-id="01e8d-115">Some compilers allow you to export a function directly in the source code by using a modifier in the function declaration.</span></span> <span data-ttu-id="01e8d-116">Em outras ocasiões, você deve especificar as exportações em um arquivo passado para o vinculador.</span><span class="sxs-lookup"><span data-stu-id="01e8d-116">Other times, you must specify exports in a file that you pass to the linker.</span></span>

<span data-ttu-id="01e8d-117">Por exemplo, usando Visual C++, há duas maneiras possíveis de exportar funções de dll: com o modificador [**\_ \_ declspec (dllexport)**](https://msdn.microsoft.com/library/3y1sfaz2(v=VS.71).aspx) ou com um arquivo de definição de módulo (. def).</span><span class="sxs-lookup"><span data-stu-id="01e8d-117">For example, using Visual C++, there are two possible ways to export DLL functions: with the [**\_\_declspec(dllexport)**](https://msdn.microsoft.com/library/3y1sfaz2(v=VS.71).aspx) modifier or with a module-definition (.def) file.</span></span> <span data-ttu-id="01e8d-118">Se você usar o modificador **\_ \_ declspec (dllexport)** , não será necessário usar um arquivo. def.</span><span class="sxs-lookup"><span data-stu-id="01e8d-118">If you use the **\_\_declspec(dllexport)** modifier, it is not necessary to use a .def file.</span></span> <span data-ttu-id="01e8d-119">Para obter mais informações, consulte [exportando de uma DLL](/cpp/build/exporting-from-a-dll?view=vs-2019).</span><span class="sxs-lookup"><span data-stu-id="01e8d-119">For more information, see [Exporting from a DLL](/cpp/build/exporting-from-a-dll?view=vs-2019).</span></span>

## <a name="creating-an-import-library"></a><span data-ttu-id="01e8d-120">Criando uma biblioteca de importação</span><span class="sxs-lookup"><span data-stu-id="01e8d-120">Creating an Import Library</span></span>

<span data-ttu-id="01e8d-121">Um arquivo de biblioteca de importação (. lib) contém informações que o vinculador precisa para resolver referências externas a funções DLL exportadas, para que o sistema possa localizar a DLL especificada e exportar as funções de DLL em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="01e8d-121">An import library (.lib) file contains information the linker needs to resolve external references to exported DLL functions, so the system can locate the specified DLL and exported DLL functions at run time.</span></span> <span data-ttu-id="01e8d-122">Você pode criar uma biblioteca de importação para sua DLL ao compilar sua DLL.</span><span class="sxs-lookup"><span data-stu-id="01e8d-122">You can create an import library for your DLL when you build your DLL.</span></span>

<span data-ttu-id="01e8d-123">Para obter mais informações, consulte [criando uma biblioteca de importação e um arquivo de exportação](/cpp/build/reference/building-an-import-library-and-export-file?view=vs-2019).</span><span class="sxs-lookup"><span data-stu-id="01e8d-123">For more information, see [Building an Import Library and Export File](/cpp/build/reference/building-an-import-library-and-export-file?view=vs-2019).</span></span>

## <a name="using-an-import-library"></a><span data-ttu-id="01e8d-124">Usando uma biblioteca de importação</span><span class="sxs-lookup"><span data-stu-id="01e8d-124">Using an Import Library</span></span>

<span data-ttu-id="01e8d-125">Por exemplo, para chamar a função [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) , você deve vincular seu código com a biblioteca de importação user32. lib.</span><span class="sxs-lookup"><span data-stu-id="01e8d-125">For example, to call the [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) function, you must link your code with the import library User32.lib.</span></span> <span data-ttu-id="01e8d-126">O motivo é que a **CreateWindow** reside em uma DLL do sistema chamada User32.dll, e user32. lib é a biblioteca de importação usada para resolver as chamadas para funções exportadas em User32.dll no seu código.</span><span class="sxs-lookup"><span data-stu-id="01e8d-126">The reason is that **CreateWindow** resides in a system DLL named User32.dll, and User32.lib is the import library used to resolve the calls to exported functions in User32.dll in your code.</span></span> <span data-ttu-id="01e8d-127">O vinculador cria uma tabela que contém o endereço de cada chamada de função.</span><span class="sxs-lookup"><span data-stu-id="01e8d-127">The linker creates a table that contains the address of each function call.</span></span> <span data-ttu-id="01e8d-128">Chamadas para funções em uma DLL serão corrigidas quando a DLL for carregada.</span><span class="sxs-lookup"><span data-stu-id="01e8d-128">Calls to functions in a DLL will be fixed up when the DLL is loaded.</span></span> <span data-ttu-id="01e8d-129">Enquanto o sistema está inicializando o processo, ele carrega User32.dll porque o processo depende das funções exportadas nessa DLL e atualiza as entradas na tabela de endereços da função.</span><span class="sxs-lookup"><span data-stu-id="01e8d-129">While the system is initializing the process, it loads User32.dll because the process depends on exported functions in that DLL, and it updates the entries in the function address table.</span></span> <span data-ttu-id="01e8d-130">Todas as chamadas para **CreateWindow** invocam a função exportada de User32.dll.</span><span class="sxs-lookup"><span data-stu-id="01e8d-130">All calls to **CreateWindow** invoke the function exported from User32.dll.</span></span>

<span data-ttu-id="01e8d-131">Para obter informações, consulte [Vinculando implicitamente com uma DLL](/previous-versions/d14wsce5(v=vs.140)).</span><span class="sxs-lookup"><span data-stu-id="01e8d-131">For information, see [Linking Implicitly with a DLL](/previous-versions/d14wsce5(v=vs.140)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="01e8d-132">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="01e8d-132">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="01e8d-133">Criando uma biblioteca de vínculo dinâmico simples</span><span class="sxs-lookup"><span data-stu-id="01e8d-133">Creating a Simple Dynamic-link Library</span></span>](creating-a-simple-dynamic-link-library.md)
</dt> <dt>

[<span data-ttu-id="01e8d-134">DLLs (Visual C++)</span><span class="sxs-lookup"><span data-stu-id="01e8d-134">DLLs (Visual C++)</span></span>](/cpp/build/dlls-in-visual-cpp?view=vs-2019)
</dt> </dl>

 

 
