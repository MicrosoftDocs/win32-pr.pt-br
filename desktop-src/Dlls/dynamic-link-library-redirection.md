---
description: Os aplicativos podem depender de uma versão específica de uma DLL compartilhada e começar a falhar se outro aplicativo for instalado com uma versão mais recente ou mais antiga da mesma DLL.
ms.assetid: 3b426b6c-1ad5-43b9-81ea-5e6d3c6588c8
title: Redirecionamento de biblioteca de Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6b575d566231058cca13c10a067a3c2e20078073
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105758042"
---
# <a name="dynamic-link-library-redirection"></a><span data-ttu-id="00612-103">Redirecionamento de biblioteca de Dynamic-Link</span><span class="sxs-lookup"><span data-stu-id="00612-103">Dynamic-Link Library Redirection</span></span>

<span data-ttu-id="00612-104">Os aplicativos podem depender de uma versão específica de uma DLL compartilhada e começar a falhar se outro aplicativo for instalado com uma versão mais recente ou mais antiga da mesma DLL.</span><span class="sxs-lookup"><span data-stu-id="00612-104">Applications can depend on a specific version of a shared DLL and start to fail if another application is installed with a newer or older version of the same DLL.</span></span> <span data-ttu-id="00612-105">Há duas maneiras de garantir que seu aplicativo use o redirecionamento correto de dll: DLL e componentes lado a lado.</span><span class="sxs-lookup"><span data-stu-id="00612-105">There are two ways to ensure that your application uses the correct DLL: DLL redirection and side-by-side components.</span></span> <span data-ttu-id="00612-106">Os desenvolvedores e administradores devem usar o redirecionamento de DLL para aplicativos existentes, pois não exigem nenhuma alteração no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="00612-106">Developers and administrators should use DLL redirection for existing applications, because it does not require any changes to the application.</span></span> <span data-ttu-id="00612-107">Se você estiver criando um novo aplicativo ou atualizando um aplicativo e quiser isolar o aplicativo de problemas potenciais, crie um [componente lado a lado](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span><span class="sxs-lookup"><span data-stu-id="00612-107">If you are creating a new application or updating an application and want to isolate your application from potential problems, create a [side-by-side component](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).</span></span>

<span data-ttu-id="00612-108">Para habilitar a máquina de redirecionamento de DLL, você deve criar uma nova chave do registro.</span><span class="sxs-lookup"><span data-stu-id="00612-108">To enable DLL redirection machine-wide, you must create a new registry key.</span></span> <span data-ttu-id="00612-109">Crie uma nova chave DWORD chamada **DevOverrideEnable** em **HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image opções de execução de arquivo** e defina-a como 1.</span><span class="sxs-lookup"><span data-stu-id="00612-109">Create a new DWORD key called **DevOverrideEnable** at **HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options** and set it to 1.</span></span> <span data-ttu-id="00612-110">Depois disso, você deve reiniciar o computador para ver os efeitos.</span><span class="sxs-lookup"><span data-stu-id="00612-110">After this, you must restart your computer to see the effects.</span></span>

<span data-ttu-id="00612-111">Para usar o redirecionamento de DLL, crie um *arquivo de redirecionamento* para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="00612-111">To use DLL redirection, create a *redirection file* for your application.</span></span> <span data-ttu-id="00612-112">O arquivo de redirecionamento deve ser nomeado da seguinte maneira: *\_ nome do aplicativo*. local.</span><span class="sxs-lookup"><span data-stu-id="00612-112">The redirection file must be named as follows: *App\_name*.local.</span></span> <span data-ttu-id="00612-113">Por exemplo, se o nome do aplicativo for Editor.exe, o arquivo de redirecionamento deverá ser nomeado Editor.exe. local.</span><span class="sxs-lookup"><span data-stu-id="00612-113">For example, if the application name is Editor.exe, the redirection file should be named Editor.exe.local.</span></span> <span data-ttu-id="00612-114">Você deve instalar o arquivo. local no diretório do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="00612-114">You must install the .local file in the application directory.</span></span> <span data-ttu-id="00612-115">Você também deve instalar as DLLs no diretório do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="00612-115">You must also install the DLLs in the application directory.</span></span>

<span data-ttu-id="00612-116">O conteúdo de um arquivo de redirecionamento é ignorado, mas sua presença faz com que o Windows Verifique o diretório do aplicativo primeiro sempre que ele carrega uma DLL, independentemente do caminho especificado para [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) ou [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span><span class="sxs-lookup"><span data-stu-id="00612-116">The contents of a redirection file are ignored, but its presence causes Windows to check the application directory first whenever it loads a DLL, regardless of the path specified to [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) or [**LoadLibraryEx**](/windows/desktop/api/LibLoaderAPI/nf-libloaderapi-loadlibraryexa).</span></span> <span data-ttu-id="00612-117">Se a DLL não for encontrada no diretório do aplicativo, essas funções usarão sua ordem de pesquisa usual.</span><span class="sxs-lookup"><span data-stu-id="00612-117">If the DLL is not found in the application directory, then these functions use their usual search order.</span></span> <span data-ttu-id="00612-118">Por exemplo, se o aplicativo c: \\ myapp \\myapp.exe chamar **LoadLibrary** usando o seguinte caminho:</span><span class="sxs-lookup"><span data-stu-id="00612-118">For example, if the application c:\\myapp\\myapp.exe calls **LoadLibrary** using the following path:</span></span>

<span data-ttu-id="00612-119">c: \\ arquivos de programa arquivos \\ comuns do \\ sistema \\mydll.dll</span><span class="sxs-lookup"><span data-stu-id="00612-119">c:\\program files\\common files\\system\\mydll.dll</span></span>

<span data-ttu-id="00612-120">E, se a unidade c: \\ myapp \\myapp.exe. local e c: \\ MyApp \\mydll.dll existir, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) carregará c: \\ MyApp \\mydll.dll.</span><span class="sxs-lookup"><span data-stu-id="00612-120">And, if both c:\\myapp\\myapp.exe.local and c:\\myapp\\mydll.dll exist, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) loads c:\\myapp\\mydll.dll.</span></span> <span data-ttu-id="00612-121">Caso contrário, **LoadLibrary** carrega c: \\ arquivos de programa \\ Arquivos comuns \\mydll.dll do sistema \\ .</span><span class="sxs-lookup"><span data-stu-id="00612-121">Otherwise, **LoadLibrary** loads c:\\program files\\common files\\system\\mydll.dll.</span></span>

<span data-ttu-id="00612-122">Como alternativa, se um diretório chamado c: \\ myapp \\myapp.exe. local existir e contiver mydll.dll, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) carregará c: \\ MyApp \\myapp.exe. local \\mydll.dll.</span><span class="sxs-lookup"><span data-stu-id="00612-122">Alternatively, if a directory named c:\\myapp\\myapp.exe.local exists and contains mydll.dll, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) loads c:\\myapp\\myapp.exe.local\\mydll.dll.</span></span>

<span data-ttu-id="00612-123">Se o aplicativo tiver um manifesto, todos os arquivos. local serão ignorados.</span><span class="sxs-lookup"><span data-stu-id="00612-123">If the application has a manifest, then any .local files are ignored.</span></span>

<span data-ttu-id="00612-124">Se você estiver usando o redirecionamento de DLL e o aplicativo não tiver acesso a todas as unidades e diretórios na ordem de pesquisa, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) interromperá a pesquisa assim que o acesso for negado.</span><span class="sxs-lookup"><span data-stu-id="00612-124">If you are using DLL redirection and the application does not have access to all drives and directories in the search order, [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) stops searching as soon as access is denied.</span></span> <span data-ttu-id="00612-125">(Se você não estiver usando o redirecionamento de DLL, **LoadLibrary** ignora os diretórios que ele não pode acessar e, em seguida, continua pesquisando.)</span><span class="sxs-lookup"><span data-stu-id="00612-125">(If you are not using DLL redirection, **LoadLibrary** skips directories that it cannot access and then continues searching.)</span></span>

<span data-ttu-id="00612-126">É uma boa prática instalar DLLs de aplicativo no mesmo diretório que contém o aplicativo, mesmo que você não esteja usando o redirecionamento de DLL.</span><span class="sxs-lookup"><span data-stu-id="00612-126">It is good practice to install application DLLs in the same directory that contains the application, even if you are not using DLL redirection.</span></span> <span data-ttu-id="00612-127">Isso garante que a instalação do aplicativo não substitui outras cópias da DLL e faz com que outros aplicativos falhem.</span><span class="sxs-lookup"><span data-stu-id="00612-127">This ensures that installing the application does not overwrite other copies of the DLL and cause other applications to fail.</span></span> <span data-ttu-id="00612-128">Além disso, se você seguir essa boa prática, outros aplicativos não substituirão sua cópia da DLL e farão com que seu aplicativo falhe.</span><span class="sxs-lookup"><span data-stu-id="00612-128">Also, if you follow this good practice, other applications do not overwrite your copy of the DLL and cause your application to fail.</span></span>

 

 
