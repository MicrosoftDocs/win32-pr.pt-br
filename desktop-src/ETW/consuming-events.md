---
description: Os consumidores de rastreamento de eventos podem processar eventos de um ou mais provedores.
ms.assetid: 039a9f66-228e-4258-9967-2b2cd7d31091
title: Consumindo eventos (rastreamento de eventos)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 68ad8234cc66d07b5a52c10ab39c7d7b3c8aa029
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104968226"
---
# <a name="consuming-events-event-tracing"></a><span data-ttu-id="fc617-103">Consumindo eventos (rastreamento de eventos)</span><span class="sxs-lookup"><span data-stu-id="fc617-103">Consuming Events (Event Tracing)</span></span>

<span data-ttu-id="fc617-104">Os consumidores de rastreamento de eventos podem processar eventos de um ou mais provedores.</span><span class="sxs-lookup"><span data-stu-id="fc617-104">Event trace consumers can process events from one or more providers.</span></span> <span data-ttu-id="fc617-105">Os consumidores podem processar eventos de um arquivo de log ou em tempo real.</span><span class="sxs-lookup"><span data-stu-id="fc617-105">Consumers can process events from a log file or in real time.</span></span> <span data-ttu-id="fc617-106">Você só poderá consumir eventos em tempo real se o controlador especificar o modo de log em tempo real para a sessão.</span><span class="sxs-lookup"><span data-stu-id="fc617-106">You can consume events in real time only if the controller specifies the real time logging mode for the session.</span></span> <span data-ttu-id="fc617-107">Por motivos de desempenho, o processamento em tempo real não é recomendado antes do Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="fc617-107">For performance reasons, real-time processing is not recommended prior to Windows Vista.</span></span>

<span data-ttu-id="fc617-108">Para especificar a sessão de rastreamento da qual você deseja processar eventos, use a estrutura de arquivo de [**\_ \_ log do rastreamento de eventos**](/windows/win32/api/evntrace/ns-evntrace-event_trace_logfilea) .</span><span class="sxs-lookup"><span data-stu-id="fc617-108">To specify the trace session from which you want to process events, you use the [**EVENT\_TRACE\_LOGFILE**](/windows/win32/api/evntrace/ns-evntrace-event_trace_logfilea) structure.</span></span> <span data-ttu-id="fc617-109">Você deve inicializar uma cópia dessa estrutura para cada arquivo de log ou sessão em tempo real que você deseja processar.</span><span class="sxs-lookup"><span data-stu-id="fc617-109">You must initialize a copy of this structure for each log file or real time session that you want to process.</span></span>

<span data-ttu-id="fc617-110">Para consumir eventos de um arquivo de log, defina o membro **LogFileName** como o nome do arquivo de log.</span><span class="sxs-lookup"><span data-stu-id="fc617-110">To consume events from a log file, set the **LogFileName** member to the name of the log file.</span></span> <span data-ttu-id="fc617-111">Para consumir eventos da sessão em tempo real, defina o membro **loggername** como o nome da sessão.</span><span class="sxs-lookup"><span data-stu-id="fc617-111">To consume events from real time session, set the **LoggerName** member to the session name.</span></span> <span data-ttu-id="fc617-112">Você também usa essa estrutura para especificar o retorno de chamada [*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka) e o retorno de chamada [*EventCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_callback) ou [**EventRecordCallback**](/windows/win32/api/evntrace/nc-evntrace-pevent_record_callback) usado para processar os eventos.</span><span class="sxs-lookup"><span data-stu-id="fc617-112">You also use this structure to specify the [*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka) callback and the [*EventCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_callback) or [**EventRecordCallback**](/windows/win32/api/evntrace/nc-evntrace-pevent_record_callback) callback used to process the events.</span></span>

-   <span data-ttu-id="fc617-113">[**EventRecordCallback**](/windows/win32/api/evntrace/nc-evntrace-pevent_record_callback)– recebe e processa todos os eventos (incluindo o evento de cabeçalho) de um ou mais arquivos de log e uma sessão em tempo real.</span><span class="sxs-lookup"><span data-stu-id="fc617-113">[**EventRecordCallback**](/windows/win32/api/evntrace/nc-evntrace-pevent_record_callback)—Receives and processes all events (including the header event) from one or more log files and a real-time session.</span></span> <span data-ttu-id="fc617-114">Você implementará esse retorno de chamada se usar as funções auxiliares de dados de rastreamento para analisar os dados de evento ou se quiser recuperar metadados sobre o evento.</span><span class="sxs-lookup"><span data-stu-id="fc617-114">You implement this callback if you use the trace data helper functions to parse the event data or you want to retrieve metadata about the event.</span></span>
-   <span data-ttu-id="fc617-115">[*EventCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_callback)– recebe e processa todos os eventos (incluindo o evento de cabeçalho) de um ou mais arquivos de log e uma sessão em tempo real.</span><span class="sxs-lookup"><span data-stu-id="fc617-115">[*EventCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_callback)—Receives and processes all events (including the header event) from one or more log files and a real-time session.</span></span>
-   <span data-ttu-id="fc617-116">[*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka)– recebe e processa informações de resumo sobre o buffer atual, como eventos perdidos.</span><span class="sxs-lookup"><span data-stu-id="fc617-116">[*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka)—Receives and processes summary information about the current buffer, such as events lost.</span></span> <span data-ttu-id="fc617-117">O ETW chama o retorno de chamada depois de fornecer todos os eventos no buffer para o consumidor.</span><span class="sxs-lookup"><span data-stu-id="fc617-117">ETW calls the callback after delivering all events in the buffer to the consumer.</span></span> <span data-ttu-id="fc617-118">O consumidor também pode usar esse retorno de chamada para cancelar o processamento de eventos; no entanto, se você estiver consumindo eventos em tempo real, o ETW entregará eventos até que o controlador interrompa a sessão.</span><span class="sxs-lookup"><span data-stu-id="fc617-118">The consumer can also use this callback to cancel event processing; however, if you are consuming events in real time, ETW delivers events until the controller stops the session.</span></span>

<span data-ttu-id="fc617-119">Depois de definir uma ou mais sessões de rastreamento, chame a função [**OpenTrace**](/windows/win32/api/evntrace/nf-evntrace-opentracea) para cada sessão de rastreamento que você deseja processar; Você pode processar eventos de um ou mais arquivos de log, mas apenas de uma sessão em tempo real.</span><span class="sxs-lookup"><span data-stu-id="fc617-119">After defining one or more trace sessions, call the [**OpenTrace**](/windows/win32/api/evntrace/nf-evntrace-opentracea) function for each trace session that you want to process; you can process events from one or more log files, but from only one real-time session.</span></span> <span data-ttu-id="fc617-120">Em seguida, você passa a lista de identificadores de sessão de rastreamento que **OpenTrace** retorna para a função [**ProcessTrace**](/windows/win32/api/evntrace/nf-evntrace-processtrace) .</span><span class="sxs-lookup"><span data-stu-id="fc617-120">You then pass the list of trace session handles that **OpenTrace** returns to the [**ProcessTrace**](/windows/win32/api/evntrace/nf-evntrace-processtrace) function.</span></span> <span data-ttu-id="fc617-121">A função **ProcessTrace** combina os eventos, classifica-os em ordem cronológica e, em seguida, os entrega aos retornos de chamada um de cada vez.</span><span class="sxs-lookup"><span data-stu-id="fc617-121">The **ProcessTrace** function combines the events, sorts them into chronological order, and then delivers them to the callbacks one at a time.</span></span> <span data-ttu-id="fc617-122">Os eventos podem ser filtrados para incluir somente aqueles que se enquadram em um período de tempo específico usando os parâmetros *StartTime* e *EndTime* .</span><span class="sxs-lookup"><span data-stu-id="fc617-122">The events can be filtered to include only those that fall into a specific time frame using the *StartTime* and *EndTime* parameters.</span></span> <span data-ttu-id="fc617-123">A função **ProcessTrace** bloqueia o thread até que seu consumidor processe todos os eventos nas sessões de rastreamento, o [*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka) retorna **false** ou você chama [**CloseTrace**](/windows/win32/api/evntrace/nf-evntrace-closetrace).</span><span class="sxs-lookup"><span data-stu-id="fc617-123">The **ProcessTrace** function blocks the thread until your consumer processes all events in the trace sessions, the [*BufferCallback*](/windows/win32/api/evntrace/nc-evntrace-pevent_trace_buffer_callbacka) returns **FALSE**, or you call [**CloseTrace**](/windows/win32/api/evntrace/nf-evntrace-closetrace).</span></span>

<span data-ttu-id="fc617-124">**Antes do Windows Vista:** Você pode chamar [**CloseTrace**](/windows/win32/api/evntrace/nf-evntrace-closetrace) somente após o retorno de [**ProcessTrace**](/windows/win32/api/evntrace/nf-evntrace-processtrace) .</span><span class="sxs-lookup"><span data-stu-id="fc617-124">**Prior to Windows Vista:** You can call [**CloseTrace**](/windows/win32/api/evntrace/nf-evntrace-closetrace) only after [**ProcessTrace**](/windows/win32/api/evntrace/nf-evntrace-processtrace) returns.</span></span>

<span data-ttu-id="fc617-125">Para obter um exemplo que mostra como consumir eventos publicados usando um manifesto, MOF ou arquivos TMF, consulte [recuperando dados de evento usando TDH](retrieving-event-data-using-tdh.md).</span><span class="sxs-lookup"><span data-stu-id="fc617-125">For an example that shows how to consume events published using a manifest, MOF, or TMF files, see [Retrieving Event Data Using TDH](retrieving-event-data-using-tdh.md).</span></span> <span data-ttu-id="fc617-126">Observe que, a partir do Windows Vista, você deve usar as funções auxiliar de dados de rastreamento (TDH) para consumir eventos.</span><span class="sxs-lookup"><span data-stu-id="fc617-126">Note that beginning with Windows Vista, you should use the trace data helper (TDH) functions to consume events.</span></span>

<span data-ttu-id="fc617-127">Para obter um exemplo que mostra como consumir eventos publicados usando o MOF, consulte [recuperando dados de evento usando o MOF](retrieving-event-data-using-mof.md).</span><span class="sxs-lookup"><span data-stu-id="fc617-127">For an example that shows how to consume events published using MOF, see [Retrieving Event Data Using MOF](retrieving-event-data-using-mof.md).</span></span>

 

 
