---
description: O agrupamento ponto a ponto é uma tecnologia que permite que um desenvolvedor crie uma rede de mesmo nível seguro de maneira rápida e eficaz.
ms.assetid: ee72f60b-1e5b-4b69-bda0-2ae80734c144
title: Como trabalhar com grupos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f7bebf958d0c3fdee6ad0dc400d495c54ec2e6fe
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104505885"
---
# <a name="how-to-work-with-groups"></a><span data-ttu-id="51e72-103">Como trabalhar com grupos</span><span class="sxs-lookup"><span data-stu-id="51e72-103">How to Work With Groups</span></span>

<span data-ttu-id="51e72-104">O agrupamento ponto a ponto é uma tecnologia que permite que um desenvolvedor crie uma rede de mesmo nível seguro de maneira rápida e eficaz.</span><span class="sxs-lookup"><span data-stu-id="51e72-104">Peer-to-peer Grouping is a technology that allows a developer to create a secure peer network quickly and effectively.</span></span> <span data-ttu-id="51e72-105">A lista a seguir identifica as principais considerações na criação de um aplicativo de agrupamento de mesmo nível.</span><span class="sxs-lookup"><span data-stu-id="51e72-105">The following list identifies the major considerations in creating a peer grouping application.</span></span>

-   [<span data-ttu-id="51e72-106">Obtendo uma identidade de par</span><span class="sxs-lookup"><span data-stu-id="51e72-106">Obtaining a Peer Identity</span></span>](#obtaining-a-peer-identity)
-   [<span data-ttu-id="51e72-107">Iniciando um grupo de pares</span><span class="sxs-lookup"><span data-stu-id="51e72-107">Starting Up a Peer Group</span></span>](#starting-up-the-peer-grouping-infrastructure)
-   [<span data-ttu-id="51e72-108">Registrando para eventos de agrupamento</span><span class="sxs-lookup"><span data-stu-id="51e72-108">Registering for Grouping Events</span></span>](#registering-for-peer-grouping-events)
-   [<span data-ttu-id="51e72-109">Conectando a um grupo</span><span class="sxs-lookup"><span data-stu-id="51e72-109">Connecting to a Group</span></span>](#obtaining-a-group-handle)
-   [<span data-ttu-id="51e72-110">Criando funções de administrador e membro</span><span class="sxs-lookup"><span data-stu-id="51e72-110">Creating Administrator and Member Roles</span></span>](#creating-administrator-and-member-roles)
-   [<span data-ttu-id="51e72-111">Encontrando um par</span><span class="sxs-lookup"><span data-stu-id="51e72-111">Finding a Peer</span></span>](#finding-a-peer)
-   [<span data-ttu-id="51e72-112">Conectando diretamente a um par</span><span class="sxs-lookup"><span data-stu-id="51e72-112">Connecting Directly to a Peer</span></span>](#connecting-directly-to-a-peer)
-   [<span data-ttu-id="51e72-113">Fechando e desligando um grupo</span><span class="sxs-lookup"><span data-stu-id="51e72-113">Closing and Shutting Down a Group</span></span>](#closing-and-shutting-down-a-peer-group)

## <a name="obtaining-a-peer-identity"></a><span data-ttu-id="51e72-114">Obtendo uma identidade de par</span><span class="sxs-lookup"><span data-stu-id="51e72-114">Obtaining a Peer Identity</span></span>

<span data-ttu-id="51e72-115">Antes de criar ou se conectar a um grupo, um par deve obter uma identidade de par, que é um nome usado para identificar exclusivamente um ponto a um grupo.</span><span class="sxs-lookup"><span data-stu-id="51e72-115">Before creating or connecting to a group, a peer must obtain a peer identity, which is a name used to uniquely identify a peer to a group.</span></span> <span data-ttu-id="51e72-116">Para obter uma lista enumerada de todas as identidades de pares definidas no par, chame [**PeerEnumIdentities**](/windows/desktop/api/P2P/nf-p2p-peerenumidentities), que retorna um identificador para a enumeração.</span><span class="sxs-lookup"><span data-stu-id="51e72-116">To obtain an enumerated list of all peer identities defined on the peer, call [**PeerEnumIdentities**](/windows/desktop/api/P2P/nf-p2p-peerenumidentities), which returns a handle to the enumeration.</span></span> <span data-ttu-id="51e72-117">Para obter as identidades de par, chame [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) com o identificador de enumeração e o número de membros a serem recuperados.</span><span class="sxs-lookup"><span data-stu-id="51e72-117">To obtain the peer identities, call [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) with the enumeration handle and the number of members to retrieve.</span></span> <span data-ttu-id="51e72-118">Continue chamando **PeerGetNextItem** até que o parâmetro *pCount* retorne um valor menor que o número de identidades de pares solicitadas.</span><span class="sxs-lookup"><span data-stu-id="51e72-118">Continue calling **PeerGetNextItem** until the *pCount* parameter returns a value less than the number of peer identities requested.</span></span>

<span data-ttu-id="51e72-119">Se uma identidade de par para o par não existir, ela poderá ser criada chamando [**PeerIdentityCreate**](/windows/desktop/api/P2P/nf-p2p-peeridentitycreate).</span><span class="sxs-lookup"><span data-stu-id="51e72-119">If a peer identity for the peer does not exist, it can be created by calling [**PeerIdentityCreate**](/windows/desktop/api/P2P/nf-p2p-peeridentitycreate).</span></span> <span data-ttu-id="51e72-120">Depois de criar uma identidade de par, o par gera um blob XML de identidade que contém a chave pública atribuída a ele</span><span class="sxs-lookup"><span data-stu-id="51e72-120">After creating a peer identity, the peer generates an identity XML blob that contains the public key assigned to it</span></span>

<span data-ttu-id="51e72-121">As informações de identidade do par são obtidas chamando [**PeerIdentityGetXML**](/windows/desktop/api/P2P/nf-p2p-peeridentitygetxml).</span><span class="sxs-lookup"><span data-stu-id="51e72-121">The peer identity information is obtained by calling [**PeerIdentityGetXML**](/windows/desktop/api/P2P/nf-p2p-peeridentitygetxml).</span></span> <span data-ttu-id="51e72-122">Essas informações de identidade de par são usadas pelo criador do grupo ou por um administrador para emitir as credenciais necessárias para ingressar no grupo, como um blob XML de convite.</span><span class="sxs-lookup"><span data-stu-id="51e72-122">This peer identity information is used by the group creator or an administrator to issue the credentials needed to join the group, as an invitation XML blob.</span></span>

<span data-ttu-id="51e72-123">Para obter mais informações sobre identidades de pares, consulte a documentação da [API do Identity Manager](identity-manager-api.md)</span><span class="sxs-lookup"><span data-stu-id="51e72-123">For more information on peer identities, please refer to the [Identity Manager API](identity-manager-api.md) documentation</span></span>

## <a name="starting-up-the-peer-grouping-infrastructure"></a><span data-ttu-id="51e72-124">Iniciando a infraestrutura de agrupamento de pares</span><span class="sxs-lookup"><span data-stu-id="51e72-124">Starting Up the Peer Grouping Infrastructure</span></span>

<span data-ttu-id="51e72-125">Antes que qualquer função na API de agrupamento de mesmo nível seja chamada por um aplicativo, [**PeerGroupStartup**](/windows/desktop/api/P2P/nf-p2p-peergroupstartup) deve ser chamado.</span><span class="sxs-lookup"><span data-stu-id="51e72-125">Before any function in the Peer Grouping API is called by an application, [**PeerGroupStartup**](/windows/desktop/api/P2P/nf-p2p-peergroupstartup) must be called.</span></span> <span data-ttu-id="51e72-126">Essa função inicializa a infraestrutura de agrupamento de pares para o aplicativo e define a versão com suporte.</span><span class="sxs-lookup"><span data-stu-id="51e72-126">This function initializes the Peer Grouping Infrastructure for the application and sets the supported version.</span></span>

## <a name="obtaining-a-group-handle"></a><span data-ttu-id="51e72-127">Obtendo um identificador de grupo</span><span class="sxs-lookup"><span data-stu-id="51e72-127">Obtaining a Group Handle</span></span>

<span data-ttu-id="51e72-128">Para se conectar a um grupo e começar a participar, é necessário obter um identificador para um grupo de pares.</span><span class="sxs-lookup"><span data-stu-id="51e72-128">To connect to a group and begin participating, a handle to a peer group must be obtained.</span></span> <span data-ttu-id="51e72-129">A lista a seguir identifica as três maneiras de se conectar a um grupo de pares:</span><span class="sxs-lookup"><span data-stu-id="51e72-129">The following list identifies the three ways to connect to a peer group:</span></span>

-   <span data-ttu-id="51e72-130">Criar um grupo de pares chamando [**PeerGroupCreate**](/windows/desktop/api/P2P/nf-p2p-peergroupcreate), que inicializa um novo grupo de pares e retorna um identificador válido com o par como o proprietário e o único administrador.</span><span class="sxs-lookup"><span data-stu-id="51e72-130">Creating a peer group by calling [**PeerGroupCreate**](/windows/desktop/api/P2P/nf-p2p-peergroupcreate), which initializes a new peer group and returns a valid handle with the peer as the owner and sole administrator.</span></span>
-   <span data-ttu-id="51e72-131">Ingressando em um grupo de pares chamando [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin).</span><span class="sxs-lookup"><span data-stu-id="51e72-131">Joining a peer group by calling [**PeerGroupJoin**](/windows/desktop/api/P2P/nf-p2p-peergroupjoin).</span></span> <span data-ttu-id="51e72-132">Para ingressar em um grupo par, um par deve receber um convite de um administrador de grupo de mesmo nível.</span><span class="sxs-lookup"><span data-stu-id="51e72-132">To join a peer group, a peer must receive an invitation from a peer group administrator.</span></span> <span data-ttu-id="51e72-133">Para obter um convite, envie o blob XML de informações de identidade para o administrador que cria um convite e o envia para você por um mecanismo externo, como email ou FTP.</span><span class="sxs-lookup"><span data-stu-id="51e72-133">To obtain an invitation, send the identity information XML blob to the administrator who creates an invitation and sends it to you by an external mechanism, such as email or FTP.</span></span> <span data-ttu-id="51e72-134">O convite e a identidade do par são passados para **PeerGroupJoin**, que retorna um identificador válido para o grupo.</span><span class="sxs-lookup"><span data-stu-id="51e72-134">The invitation and peer identity are passed to **PeerGroupJoin**, which returns a valid handle to the group.</span></span>
-   <span data-ttu-id="51e72-135">Abrindo um grupo de pares ao qual um par ingressou anteriormente chamando [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen).</span><span class="sxs-lookup"><span data-stu-id="51e72-135">Opening a peer group that a peer has joined previously by calling [**PeerGroupOpen**](/windows/desktop/api/P2P/nf-p2p-peergroupopen).</span></span> <span data-ttu-id="51e72-136">Nessa situação, não é necessário obter um convite.</span><span class="sxs-lookup"><span data-stu-id="51e72-136">In this situation, obtaining an invitation is not necessary.</span></span>

<span data-ttu-id="51e72-137">Depois de obter um identificador de grupo de pares válido de uma das funções acima, você pode se conectar a um grupo de pares chamando [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) com o novo identificador.</span><span class="sxs-lookup"><span data-stu-id="51e72-137">After you obtain a valid peer group handle from one of the above functions, you can connect to a peer group by calling [**PeerGroupConnect**](/windows/desktop/api/P2P/nf-p2p-peergroupconnect) with the new handle.</span></span>

> [!Note]  
> <span data-ttu-id="51e72-138">Se a conexão a um grupo de pares falhar, \_ ocorrerá o evento de falha na conexão de evento do grupo de pares \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="51e72-138">If the connection to a peer group fails, the PEER\_GROUP\_EVENT\_CONNECTION\_FAILED event occurs.</span></span> <span data-ttu-id="51e72-139">O manipulador pode tentar restabelecer a conexão com o grupo de pares.</span><span class="sxs-lookup"><span data-stu-id="51e72-139">The handler can attempt to reestablish the connection to the peer group.</span></span>

 

## <a name="registering-for-peer-grouping-events"></a><span data-ttu-id="51e72-140">Registrando para eventos de agrupamento de pares</span><span class="sxs-lookup"><span data-stu-id="51e72-140">Registering for Peer Grouping Events</span></span>

<span data-ttu-id="51e72-141">Antes que um par participe de um grupo de pares, o par deve se registrar em eventos de grupo de pares.</span><span class="sxs-lookup"><span data-stu-id="51e72-141">Before a peer participates in a peer group, the peer must register for peer group events.</span></span> <span data-ttu-id="51e72-142">Para se registrar para eventos de mesmo nível específicos, chame [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent)e passe um ou mais dos tipos de evento de pares definidos no tipo de evento de grupo de pares \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="51e72-142">To register for specific peer events, call [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent), and pass in one or more of the peer event types defined in PEER\_GROUP\_EVENT\_TYPE.</span></span> <span data-ttu-id="51e72-143">Você deve se registrar para cada evento de mesmo nível que se aplica ao seu aplicativo; por exemplo, para receber dados em uma conexão direta, registre-se para \_ os \_ eventos conexão direta de evento de grupo de pares \_ \_ e dados de entrada de evento de grupo de pares \_ \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="51e72-143">You must register for each peer event that applies to your application; for example, to receive data over a direct connection, register for the PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION and PEER\_GROUP\_EVENT\_INCOMING\_DATA events.</span></span> <span data-ttu-id="51e72-144">Cada chamada usa um identificador de evento e retorna um identificador **HPEEREVENT** para esse evento de mesmo nível.</span><span class="sxs-lookup"><span data-stu-id="51e72-144">Each call takes an event handle and returns an **HPEEREVENT** handle for that peer event.</span></span>

<span data-ttu-id="51e72-145">Os manipuladores de eventos podem obter os dados associados a um evento de mesmo nível passando o identificador para eventos de pares registrados para [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="51e72-145">Event handlers can obtain the data associated with a peer event by passing the handle to registered peer events to [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span></span> <span data-ttu-id="51e72-146">Esses dados de evento de mesmo nível são retornados como uma União de dados de evento de grupo de pares \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="51e72-146">This peer event data is returned as a PEER\_GROUP\_EVENT\_DATA union.</span></span> <span data-ttu-id="51e72-147">Se a fila de eventos de pares estiver vazia, essa função \_ retornará \_ nenhum \_ dado de evento de pares \_ .</span><span class="sxs-lookup"><span data-stu-id="51e72-147">If the peer event queue is empty, this function returns PEER\_S\_NO\_EVENT\_DATA.</span></span>

<span data-ttu-id="51e72-148">Você pode cancelar o registro de eventos de pares chamando [**PeerGroupUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupunregisterevent) e fornecendo o identificador para o evento de mesmo nível que deseja cancelar o registro.</span><span class="sxs-lookup"><span data-stu-id="51e72-148">You can unregister for peer events by calling [**PeerGroupUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupunregisterevent) and providing the handle for the peer event you want to unregister.</span></span> <span data-ttu-id="51e72-149">Depois que a função for chamada, os eventos de pares associados ao identificador não serão mais registrados.</span><span class="sxs-lookup"><span data-stu-id="51e72-149">After the function is called, the peer events associated with the handle are no longer registered.</span></span>

## <a name="creating-administrator-and-member-roles"></a><span data-ttu-id="51e72-150">Criando funções de administrador e membro</span><span class="sxs-lookup"><span data-stu-id="51e72-150">Creating Administrator and Member Roles</span></span>

<span data-ttu-id="51e72-151">O ponto que cria o grupo de pares é conhecido como criador do grupo de pares e tem a função de administrador por padrão.</span><span class="sxs-lookup"><span data-stu-id="51e72-151">The peer who creates the peer group is known as the peer group creator, and has the administrator role by default.</span></span> <span data-ttu-id="51e72-152">Somente o criador do grupo de pares pode definir as propriedades do grupo.</span><span class="sxs-lookup"><span data-stu-id="51e72-152">Only the peer group creator can set the group properties.</span></span>

<span data-ttu-id="51e72-153">Os colegas convidados para o grupo de pares podem ser um administrador ou um membro.</span><span class="sxs-lookup"><span data-stu-id="51e72-153">Peers invited to the peer group can be either an administrator or a member.</span></span> <span data-ttu-id="51e72-154">Se eles forem atribuídos a uma função de administrador pelo administrador que emite o convite, eles poderão convidar novos membros para o grupo de mesmo nível e, da mesma forma, atribuir a função de administrador a outros membros.</span><span class="sxs-lookup"><span data-stu-id="51e72-154">If they are assigned an administrator role by the administrator issuing the invitation, they can invite new members to the peer group, and likewise assign the administrator role to other members.</span></span>

<span data-ttu-id="51e72-155">As funções dos membros do grupo de pares são definidas nos convites que o administrador fornece a um membro.</span><span class="sxs-lookup"><span data-stu-id="51e72-155">The roles of peer group members are set in the invitations the administrator gives to a member.</span></span> <span data-ttu-id="51e72-156">Para adicionar mais administradores, defina o valor do parâmetro *pRoles* de [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) como administrador da \_ função de grupo par \_ \_ ao criar um convite.</span><span class="sxs-lookup"><span data-stu-id="51e72-156">To add more administrators, set the value of the *pRoles* parameter of [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) to PEER\_GROUP\_ROLE\_ADMIN when creating an invitation.</span></span>

<span data-ttu-id="51e72-157">Os membros podem participar de um grupo de pares, mas não podem convidar e autorizar novos membros, definir propriedades de grupo ou atualizar ou excluir registros de grupo que não criam especificamente.</span><span class="sxs-lookup"><span data-stu-id="51e72-157">Members can participate in a peer group, but cannot invite and authorize new members, set group properties, or update or delete group records that they do not specifically create.</span></span> <span data-ttu-id="51e72-158">Para atribuir o status de membro a um par participante, defina o valor do parâmetro **pRoles** de [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) como \_ membro da função de grupo par \_ \_ ao criar um convite para esse par.</span><span class="sxs-lookup"><span data-stu-id="51e72-158">To assign member status to a participating peer, set the value of the **pRoles** parameter of [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) to PEER\_GROUP\_ROLE\_MEMBER when you create an invitation for that peer.</span></span>

<span data-ttu-id="51e72-159">Para alterar a função de um membro, novas credenciais contendo a nova função devem ser emitidas para esse membro.</span><span class="sxs-lookup"><span data-stu-id="51e72-159">To change the role of a member, new credentials containing the new role must be issued to that member.</span></span> <span data-ttu-id="51e72-160">Para fazer isso, obtenha a estrutura de [**\_ \_ informações de credenciais de par**](/windows/desktop/api/P2P/ns-p2p-peer_credential_info) para esse membro da estrutura de membro par \_ retornada por [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers).</span><span class="sxs-lookup"><span data-stu-id="51e72-160">To accomplish this, obtain the [**PEER\_CREDENTIAL\_INFO**](/windows/desktop/api/P2P/ns-p2p-peer_credential_info) structure for this member from the PEER\_MEMBER structure returned by [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers).</span></span> <span data-ttu-id="51e72-161">Altere o campo **pRoles** nas **\_ \_ informações de credencial de par** para a nova função e passe a estrutura para [**PeerGroupIssueCredentials**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials).</span><span class="sxs-lookup"><span data-stu-id="51e72-161">Change the **pRoles** field in **PEER\_CREDENTIAL\_INFO** to the new role, and pass the structure to [**PeerGroupIssueCredentials**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials).</span></span>

<span data-ttu-id="51e72-162">As novas credenciais não entrarão em vigor para o par até que se conectem ao grupo de pares.</span><span class="sxs-lookup"><span data-stu-id="51e72-162">The new credentials will not go into effect for the peer until they connect to the peer group.</span></span> <span data-ttu-id="51e72-163">Se eles estiverem conectados no momento, eles deverão fechar o grupo e se reconectar para obter as credenciais atualizadas.</span><span class="sxs-lookup"><span data-stu-id="51e72-163">If they are currently connected, they must close the group and reconnect to obtain the updated credentials.</span></span>

## <a name="finding-a-peer"></a><span data-ttu-id="51e72-164">Encontrando um par</span><span class="sxs-lookup"><span data-stu-id="51e72-164">Finding a Peer</span></span>

<span data-ttu-id="51e72-165">Para obter uma lista enumerada de todos os pares que participam do grupo par, chame [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers) com o identificador de grupo, que retorna um identificador para a enumeração.</span><span class="sxs-lookup"><span data-stu-id="51e72-165">To obtain an enumerated list of all peers participating in the peer group, call [**PeerGroupEnumMembers**](/windows/desktop/api/P2P/nf-p2p-peergroupenummembers) with the group handle, which returns a handle to the enumeration.</span></span> <span data-ttu-id="51e72-166">Para obter os membros, chame [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) com o identificador de enumeração e o número de membros a serem recuperados.</span><span class="sxs-lookup"><span data-stu-id="51e72-166">To obtain the members, call [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) with the enum handle and the number of members to retrieve.</span></span> <span data-ttu-id="51e72-167">Continue chamando **PeerGetNextItem** até que o parâmetro *pCount* retorne um valor menor que o número de membros solicitados.</span><span class="sxs-lookup"><span data-stu-id="51e72-167">Continue calling **PeerGetNextItem** until the *pCount* parameter returns a value less than the number of members requested.</span></span> <span data-ttu-id="51e72-168">Observe que a lista completa de membros disponíveis não pode ser retornada.</span><span class="sxs-lookup"><span data-stu-id="51e72-168">Note that the complete list of available members may not be returned.</span></span>

<span data-ttu-id="51e72-169">Cada membro é representado como uma estrutura de [**\_ membro par**](/windows/desktop/api/P2P/ns-p2p-peer_member) , que contém a identidade do par, IDs de nó e endereços IP para pares ativos.</span><span class="sxs-lookup"><span data-stu-id="51e72-169">Each member is represented as a [**PEER\_MEMBER**](/windows/desktop/api/P2P/ns-p2p-peer_member) structure, which contains the identity of the peer, node IDs, and IP addresses for active peers.</span></span>

<span data-ttu-id="51e72-170">Quando terminar, feche a enumeração e libere a memória associada chamando [**PeerEndEnumeration**](/windows/desktop/api/P2P/nf-p2p-peerendenumeration).</span><span class="sxs-lookup"><span data-stu-id="51e72-170">When finished, close the enumeration and release the associated memory by calling [**PeerEndEnumeration**](/windows/desktop/api/P2P/nf-p2p-peerendenumeration).</span></span>

## <a name="connecting-directly-to-a-peer"></a><span data-ttu-id="51e72-171">Conectando diretamente a um par</span><span class="sxs-lookup"><span data-stu-id="51e72-171">Connecting Directly to a Peer</span></span>

<span data-ttu-id="51e72-172">Quando um par está conectado a um grupo de pares, o direcionamento de trocas de um para um com outros membros conectados é iniciado chamando [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection) e fornecendo a identidade do outro par.</span><span class="sxs-lookup"><span data-stu-id="51e72-172">When a peer is connected to a peer group, direct one-to-one exchanges with other connected members are initiated by calling [**PeerGroupOpenDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupopendirectconnection) and supplying the identity of the other peer.</span></span> <span data-ttu-id="51e72-173">Essa chamada é assíncrona e retorna uma ID de conexão de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="51e72-173">This call is asynchronous, and returns a 64-bit connection ID.</span></span> <span data-ttu-id="51e72-174">Se a chamada for bem-sucedida, você receberá o \_ evento \_ peer de conexão direta de evento de grupo par \_ \_ \_ para indicar que a conexão foi bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="51e72-174">If the call is successful, you receive the PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION\_EVENT peer event to indicate that the connection is successful.</span></span> <span data-ttu-id="51e72-175">Se a conexão for bem-sucedida, a ID de conexão será válida e poderá ser usada para enviar e receber dados por meio da conexão direta.</span><span class="sxs-lookup"><span data-stu-id="51e72-175">If the connection is successful, the connection ID is valid and can be used to send and receive data through the direct connection.</span></span>

<span data-ttu-id="51e72-176">Para poder receber conexões diretas, o outro par também deve ter sido registrado anteriormente para o \_ \_ \_ evento peer de conexão direta de evento de grupo par \_ .</span><span class="sxs-lookup"><span data-stu-id="51e72-176">To be able to receive direct connections, the other peer must also have previously registered for the PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION peer event.</span></span>

<span data-ttu-id="51e72-177">Para enviar dados para um par, chame [**PeerGroupSendData**](/windows/desktop/api/P2P/nf-p2p-peergroupsenddata) com uma ID de conexão válida.</span><span class="sxs-lookup"><span data-stu-id="51e72-177">To send data to a peer, call [**PeerGroupSendData**](/windows/desktop/api/P2P/nf-p2p-peergroupsenddata) with a valid connection ID.</span></span> <span data-ttu-id="51e72-178">Para receber dados, o outro par deve ser registrado para o evento de pares de dados de entrada de evento de grupo de pares \_ \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="51e72-178">To receive data, the other peer must be registered for the PEER\_GROUP\_EVENT\_INCOMING\_DATA peer event.</span></span> <span data-ttu-id="51e72-179">Da mesma forma, se o ponto de envio quiser receber dados por vez, ele também deverá ser registrado para o evento de pares de dados de entrada do evento de grupo de pares \_ \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="51e72-179">Likewise, if the sending peer wants to receive data in turn, it also must be registered for the PEER\_GROUP\_EVENT\_INCOMING\_DATA peer event.</span></span>

<span data-ttu-id="51e72-180">Para receber o conjunto total de conexões diretas atualmente ativas com outros pares em um grupo, chame [**PeerGroupEnumConnections**](/windows/desktop/api/P2P/nf-p2p-peergroupenumconnections) para abrir a enumeração e iterar na lista de conexões usando [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem).</span><span class="sxs-lookup"><span data-stu-id="51e72-180">To receive the total set of currently active direct connections with other peers in a group, call [**PeerGroupEnumConnections**](/windows/desktop/api/P2P/nf-p2p-peergroupenumconnections) to open the enumeration and iterate through the list of connections by using [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem).</span></span>

<span data-ttu-id="51e72-181">Para fechar uma conexão direta, chame [**PeerGroupCloseDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupclosedirectconnection) e passe a ID da conexão.</span><span class="sxs-lookup"><span data-stu-id="51e72-181">To close a direct connection, call [**PeerGroupCloseDirectConnection**](/windows/desktop/api/P2P/nf-p2p-peergroupclosedirectconnection) and pass in the connection ID.</span></span>

## <a name="closing-and-shutting-down-a-peer-group"></a><span data-ttu-id="51e72-182">Fechando e desligando um grupo de pares</span><span class="sxs-lookup"><span data-stu-id="51e72-182">Closing and Shutting Down a Peer Group</span></span>

<span data-ttu-id="51e72-183">Para fechar uma conexão com um grupo de pares, chame [**PeerGroupClose**](/windows/desktop/api/P2P/nf-p2p-peergroupclose), que invalida o identificador de grupo, mas não encerra a infraestrutura de agrupamento de pares.</span><span class="sxs-lookup"><span data-stu-id="51e72-183">To close a connection to a peer group, call [**PeerGroupClose**](/windows/desktop/api/P2P/nf-p2p-peergroupclose), which invalidates the group handle, but does not shut down the Peer Grouping Infrastructure.</span></span> <span data-ttu-id="51e72-184">Os dados do grupo ponto a ponto são excluídos chamando [**PeerGroupDelete**](/windows/desktop/api/P2P/nf-p2p-peergroupdelete).</span><span class="sxs-lookup"><span data-stu-id="51e72-184">Peer-to-peer group data is deleted by calling [**PeerGroupDelete**](/windows/desktop/api/P2P/nf-p2p-peergroupdelete).</span></span>

<span data-ttu-id="51e72-185">Quando o aplicativo for concluído usando a infraestrutura de agrupamento de pares, ele deverá chamar [**PeerGroupShutdown**](/windows/desktop/api/P2P/nf-p2p-peergroupshutdown).</span><span class="sxs-lookup"><span data-stu-id="51e72-185">When the application is finished using the Peer Grouping Infrastructure, it must call [**PeerGroupShutdown**](/windows/desktop/api/P2P/nf-p2p-peergroupshutdown).</span></span>

 

 



