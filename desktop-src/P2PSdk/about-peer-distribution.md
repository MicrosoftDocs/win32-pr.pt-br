---
description: A API de Distribuição par, que dá suporte ao recurso Cache de Branch no Windows 7, Windows Server 2008 R2, Windows 8 e Windows Server 2012, oferece um conjunto de APIs de plataforma que podem aumentar a capacidade de resposta de rede de aplicativos centralizados quando acessados de escritórios remotos e ajudar a reduzir a utilização geral da WAN (rede de longa distância) sem interferir nas tecnologias de segurança de rede.
ms.assetid: feb9666e-563a-49f4-ad1c-f166a0faff31
title: Sobre a distribuição de pares
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c996aed35ac691284ba61b757d6ff5a88033aad
ms.sourcegitcommit: b32433cc0394159c7263809ae67615ab5792d40d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/30/2021
ms.locfileid: "113120431"
---
# <a name="about-peer-distribution"></a><span data-ttu-id="97f20-103">Sobre a distribuição de pares</span><span class="sxs-lookup"><span data-stu-id="97f20-103">About Peer Distribution</span></span>

<span data-ttu-id="97f20-104">A API de Distribuição par, que dá suporte ao recurso Cache de Branch no Windows 7, Windows Server 2008 R2, Windows 8 e Windows Server 2012, oferece um conjunto de APIs de plataforma que podem aumentar a capacidade de resposta de rede de aplicativos centralizados quando acessados de escritórios remotos e ajudar a reduzir a utilização geral da WAN (rede de longa distância) sem interferir nas tecnologias de segurança de rede.</span><span class="sxs-lookup"><span data-stu-id="97f20-104">The Peer Distribution API, which supports the Branch Cache feature in Windows 7, Windows Server 2008 R2, Windows 8, and Windows Server 2012 offers a set of platform APIs that can increase network responsiveness of centralized applications when accessed from remote offices and aid in reducing overall wide area network (WAN) utilization without interfering with the network security technologies.</span></span>

<span data-ttu-id="97f20-105">O sistema de Distribuição de Pares oferece um conjunto de APIs de plataforma utilizadas pelos editores que fornecem conteúdo digital e consumidores que o solicitam.</span><span class="sxs-lookup"><span data-stu-id="97f20-105">The Peer Distribution system offers a set of platform APIs utilized by both the publishers that provide digital content and consumers that request it.</span></span> <span data-ttu-id="97f20-106">Para diferenciar facilmente essas funções, pode ser mais fácil pensar no publicador em uma função de servidor e no consumidor em uma função de cliente.</span><span class="sxs-lookup"><span data-stu-id="97f20-106">To easily differentiate these roles, it may be easier to think of the publisher in a server role and the consumer in a client role.</span></span> <span data-ttu-id="97f20-107">Além disso, é importante lembrar que, além dessas funções conceituais, o serviço distribuição de pares é um sistema par verdadeiro, conforme indicado pela capacidade de qualquer nó de Distribuição de Pares publicar e consumir conteúdo digital.</span><span class="sxs-lookup"><span data-stu-id="97f20-107">That aside, it is important to remember that aside from these conceptual roles, the Peer Distribution service is a true peer system, as indicated by the ability for any Peer Distribution node to both publish and consume digital content.</span></span> <span data-ttu-id="97f20-108">As APIs da plataforma distribuição de pares são expostas a editores e consumidores por uma biblioteca de importação do Win32 (**PeerDist.Lib**).</span><span class="sxs-lookup"><span data-stu-id="97f20-108">The Peer Distribution platform APIs are exposed to publishers and consumers by a Win32 import library (**PeerDist.Lib**).</span></span>

<span data-ttu-id="97f20-109">O ciclo de vida do conteúdo fornecido por um editor e recuperado por um consumidor com o serviço distribuição de pares é composto pelas seguintes operações:</span><span class="sxs-lookup"><span data-stu-id="97f20-109">The lifecycle of content supplied by a publisher and retrieved by a consumer with the Peer Distribution service is composed of the following operations:</span></span>



|                         | <span data-ttu-id="97f20-110">Descrição</span><span class="sxs-lookup"><span data-stu-id="97f20-110">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|-------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="97f20-111">**Publicação de conteúdo**</span><span class="sxs-lookup"><span data-stu-id="97f20-111">**Content Publication**</span></span> | <span data-ttu-id="97f20-112">A publicação é feita para produzir uma descrição do conteúdo com o termo Informações de **Conteúdo** ou Informações **de Conteúdo** para resumir.</span><span class="sxs-lookup"><span data-stu-id="97f20-112">Publishing is done to produce a description of content termed **Content Information**, or **Content Info** for short.</span></span> <span data-ttu-id="97f20-113">Essas Informações de Conteúdo podem ser usadas por uma instância do serviço distribuição de pares para autenticar e recriar o conteúdo.</span><span class="sxs-lookup"><span data-stu-id="97f20-113">This Content Info can then be used by an instance of the Peer Distribution service to authenticate and rebuild the content.</span></span> <span data-ttu-id="97f20-114">Quando o conteúdo é publicado por um aplicativo no serviço distribuição de pares, que é conceitualmente uma operação do lado do servidor, esse conteúdo se torna associado à Identidade do Publicador, que se baseia no SID do usuário associado ao token de acesso de thread.</span><span class="sxs-lookup"><span data-stu-id="97f20-114">When content is published by an application into the Peer Distribution service, which is conceptually a server-side operation, that content becomes associated with the Publisher Identity, which is based on the SID of the user associated with the thread access token.</span></span> <span data-ttu-id="97f20-115">Essa associação é feita para limitar o acesso ao conteúdo por entidades não autorizadas.</span><span class="sxs-lookup"><span data-stu-id="97f20-115">This binding is done to limit access to content by unauthorized entities.</span></span> <span data-ttu-id="97f20-116">No entanto, é importante observar que o acesso às informações de conteúdo é equivalente ao acesso ao próprio conteúdo, pois as informações de conteúdo podem ser usadas para obter o conteúdo de pares ou de um cache hospedado.</span><span class="sxs-lookup"><span data-stu-id="97f20-116">However, it is important to note that access to the content information is equivalent to access to the content itself, as the content information can be used to obtain the content from peers or a hosted cache.</span></span><br/> <span data-ttu-id="97f20-117">Há uma nova versão da estrutura de dados de informações de conteúdo no Windows 8; no entanto, a versão anterior ainda tem suporte.</span><span class="sxs-lookup"><span data-stu-id="97f20-117">There is a new version of the content information data structure in Windows 8; however, the previous version is still supported.</span></span> <span data-ttu-id="97f20-118">Para interoperar com clientes do Windows 7, um administrador pode configurar o serviço distribuição de pares para usar a versão anterior da estrutura de dados de informações de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="97f20-118">To interoperate with Windows 7 clients, an administrator may configure the Peer Distribution service to use the previous version of the content information data structure.</span></span><br/> |
| <span data-ttu-id="97f20-119">**Recuperação de conteúdo**</span><span class="sxs-lookup"><span data-stu-id="97f20-119">**Content Retrieval**</span></span>   | <span data-ttu-id="97f20-120">Para que um consumidor recupere conteúdo do serviço distribuição de pares, o acesso deve ser fornecido às Informações de Conteúdo publicadas associadas a esse conteúdo.</span><span class="sxs-lookup"><span data-stu-id="97f20-120">For a consumer to retrieve content from the Peer Distribution service, access must be provided to the published Content Info associated with that content.</span></span> <span data-ttu-id="97f20-121">O serviço distribuição de pares usado para publicar o conteúdo pode fornecer as Informações de Conteúdo associadas.</span><span class="sxs-lookup"><span data-stu-id="97f20-121">The Peer Distribution service used to publish the content can provide the associated Content Info.</span></span> <span data-ttu-id="97f20-122">Depois que o consumidor tiver as Informações de Conteúdo, outras APIs de Distribuição de Pares poderão ser usadas para solicitar conteúdo do serviço distribuição de pares.</span><span class="sxs-lookup"><span data-stu-id="97f20-122">Once the consumer has the Content Info, other Peer Distribution APIs can be used to request content from the Peer Distribution service.</span></span> <span data-ttu-id="97f20-123">O serviço distribuição de pares tentará recuperar o conteúdo da rede local.</span><span class="sxs-lookup"><span data-stu-id="97f20-123">The Peer Distribution service will attempt to retrieve the content from the local network.</span></span> <span data-ttu-id="97f20-124">Se o conteúdo não estiver disponível, o aplicativo cliente será responsável por recuperar o conteúdo do servidor de origem.</span><span class="sxs-lookup"><span data-stu-id="97f20-124">If the content is not available, the client application is responsible for retrieving the content from the source server.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| <span data-ttu-id="97f20-125">**Remoção de publicação**</span><span class="sxs-lookup"><span data-stu-id="97f20-125">**Publication Removal**</span></span> | <span data-ttu-id="97f20-126">Para aplicativos que publicaram conteúdo no serviço distribuição de pares, a função [**PeerDistServerUnpublish**](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserverunpublish) foi fornecida para permitir que o conteúdo seja não publicado.</span><span class="sxs-lookup"><span data-stu-id="97f20-126">For applications that have published content into the Peer Distribution service, the [**PeerDistServerUnpublish**](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserverunpublish) function has been provided to allow content to be unpublished.</span></span> <span data-ttu-id="97f20-127">Depois que o conteúdo tiver sido publicado, o serviço de Distribuição de Pares local não fornecerá mais as informações de conteúdo associadas a esse conteúdo.</span><span class="sxs-lookup"><span data-stu-id="97f20-127">Once content has been unpublished, the local Peer Distribution service will no longer provide the content info associated with that content.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="asynchronous-completions"></a><span data-ttu-id="97f20-128">Preenchimentos assíncronos</span><span class="sxs-lookup"><span data-stu-id="97f20-128">Asynchronous Completions</span></span>

<span data-ttu-id="97f20-129">A API de Distribuição de Pares dá suporte a um modelo de API assíncrona e, como resultado, as APIs de Distribuição Par permitem o uso de Portas de Conclusão de E/S ou Eventos como mecanismos de sinalização para processamento de preenchimentos de operação de distribuição par assíncrona.</span><span class="sxs-lookup"><span data-stu-id="97f20-129">The Peer Distribution API supports an asynchronous API model, and as a result Peer Distribution APIs allow for the use of either I/O Completion Ports or Events as the signaling mechanisms for processing asynchronous Peer Distribution operation completions.</span></span> <span data-ttu-id="97f20-130">Para qualquer mecanismo, a Distribuição de Pares usa uma [**estrutura OVERLAPPED.**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped)</span><span class="sxs-lookup"><span data-stu-id="97f20-130">For either mechanism, Peer Distribution uses an [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure.</span></span> <span data-ttu-id="97f20-131">Em geral, a Distribuição de Pares assume a propriedade de uma estrutura **OVERLAPPED** e todos os parâmetros que o Cliente passa para funções de API assíncronas.</span><span class="sxs-lookup"><span data-stu-id="97f20-131">In general, Peer Distribution takes the ownership of an **OVERLAPPED** structure and any out parameters that the Client passes to asynchronous API functions.</span></span> <span data-ttu-id="97f20-132">O Cliente não deve acessar esses recursos até que a função assíncrona específica seja concluída.</span><span class="sxs-lookup"><span data-stu-id="97f20-132">The Client must not access these resources until the particular asynchronous function completes.</span></span> <span data-ttu-id="97f20-133">Assim que as funções assíncronas são concluídas, o serviço distribuição de pares não exigirá mais acesso a esses recursos e eles poderão ser reutilizados conforme o aplicativo de chamada for adequado.</span><span class="sxs-lookup"><span data-stu-id="97f20-133">As soon as the asynchronous functions completes, the Peer Distribution service will no longer require access to these resources and they may be reused as the calling application sees fit.</span></span>

<span data-ttu-id="97f20-134">Não haverá nenhuma conclusão assíncrona se a função retornar qualquer código de erro diferente de **ERROR \_ IO \_ PENDING.**</span><span class="sxs-lookup"><span data-stu-id="97f20-134">There will not be any asynchronous completion if the function returns any error code other than **ERROR\_IO\_PENDING**.</span></span> <span data-ttu-id="97f20-135">O retorno de um valor diferente de **ERROR \_ E/S \_ PENDING** significa que a chamada falhou de forma síncrona.</span><span class="sxs-lookup"><span data-stu-id="97f20-135">The return of a value other than **ERROR\_IO\_PENDING** means that the call has failed synchronously.</span></span> <span data-ttu-id="97f20-136">Se a API de Distribuição de Pares retornar **ERRO \_ DE \_ E/S PENDENTE,** o chamador deverá aguardar a conclusão assíncrona.</span><span class="sxs-lookup"><span data-stu-id="97f20-136">If the Peer Distribution API returns **ERROR\_IO\_PENDING**, the caller must wait for asynchronous completion.</span></span>

<span data-ttu-id="97f20-137">O código de erro da conclusão assíncrona pode ser recuperado de uma das duas maneiras:</span><span class="sxs-lookup"><span data-stu-id="97f20-137">The error code of the asynchronous completion can be retrieved in one of two ways:</span></span>

<span data-ttu-id="97f20-138">**Preenchimento baseado em porta de conclusão de E/S**</span><span class="sxs-lookup"><span data-stu-id="97f20-138">**I/O Completion Port Based Completion**</span></span>

<span data-ttu-id="97f20-139">O usuário invoca o mecanismo de porta de conclusão de E/S fornecendo uma alça de porta de conclusão e uma chave de conclusão para as seguintes funções de API:</span><span class="sxs-lookup"><span data-stu-id="97f20-139">User invokes the I/O completion port mechanism by providing a completion port handle and completion key to the following API functions:</span></span>

<dl>

[<span data-ttu-id="97f20-140">**PeerDistRegisterForStatusChangeNotification**</span><span class="sxs-lookup"><span data-stu-id="97f20-140">**PeerDistRegisterForStatusChangeNotification**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistregisterforstatuschangenotification)  
[<span data-ttu-id="97f20-141">**PeerDistServerPublishStream**</span><span class="sxs-lookup"><span data-stu-id="97f20-141">**PeerDistServerPublishStream**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserverpublishstream)  
[<span data-ttu-id="97f20-142">**PeerDistServerOpenContentInformation**</span><span class="sxs-lookup"><span data-stu-id="97f20-142">**PeerDistServerOpenContentInformation**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistserveropencontentinformation)  
[<span data-ttu-id="97f20-143">**PeerDistClientOpenContent**</span><span class="sxs-lookup"><span data-stu-id="97f20-143">**PeerDistClientOpenContent**</span></span>](/windows/desktop/api/PeerDist/nf-peerdist-peerdistclientopencontent)  
</dl>

<span data-ttu-id="97f20-144">O usuário cria uma porta de conclusão chamando [**CreateIoCompletionPort.**](/windows/desktop/FileIO/createiocompletionport)</span><span class="sxs-lookup"><span data-stu-id="97f20-144">The User creates a completion port by calling [**CreateIoCompletionPort**](/windows/desktop/FileIO/createiocompletionport).</span></span> <span data-ttu-id="97f20-145">Esse alça de porta de conclusão pode ser usado simultaneamente para outras operações de E/S assíncronas, bem como operações específicas de Distribuição de Pares.</span><span class="sxs-lookup"><span data-stu-id="97f20-145">This completion port handle can be simultaneously used for other asynchronous I/O operations as well as Peer Distribution specific operations.</span></span>

<span data-ttu-id="97f20-146">O chamador deve usar [**a função GetQueuedCompletionStatus**](/windows/desktop/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) para gerenciar a conclusão assíncrona.</span><span class="sxs-lookup"><span data-stu-id="97f20-146">The caller should use [**GetQueuedCompletionStatus**](/windows/desktop/api/ioapiset/nf-ioapiset-getqueuedcompletionstatus) function to manage asynchronous completion.</span></span> <span data-ttu-id="97f20-147">Se a operação assíncrona falhar, a função **GetQueuedCompletionStatus** retornará **FALSE** e [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) retornará o código de erro apropriado.</span><span class="sxs-lookup"><span data-stu-id="97f20-147">If the asynchronous operation fails the **GetQueuedCompletionStatus** function will return **FALSE** and [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) will return the appropriate error code.</span></span> <span data-ttu-id="97f20-148">O chamador deverá ignorar todos os campos da estrutura [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) se o código de erro for diferente de **ERROR \_ SUCCESS.**</span><span class="sxs-lookup"><span data-stu-id="97f20-148">The caller should ignore all the fields of the [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure if the error code is anything other than **ERROR\_SUCCESS**.</span></span> <span data-ttu-id="97f20-149">A operação assíncrona terá êxito se a **função GetQueuedCompletionStatus** retornar **TRUE.**</span><span class="sxs-lookup"><span data-stu-id="97f20-149">The asynchronous operation succeeds if the **GetQueuedCompletionStatus** function returns **TRUE**.</span></span>

<span data-ttu-id="97f20-150">Para obter mais informações, consulte [Portas de conclusão de E/S](/windows/desktop/FileIO/i-o-completion-ports).</span><span class="sxs-lookup"><span data-stu-id="97f20-150">For more information see [I/O Completion Ports](/windows/desktop/FileIO/i-o-completion-ports).</span></span>

<span data-ttu-id="97f20-151">**Conclusão baseada em evento**</span><span class="sxs-lookup"><span data-stu-id="97f20-151">**Event Based Completion**</span></span>

<span data-ttu-id="97f20-152">Se o chamador define um alça de evento válido para o campo *hEvent* da estrutura [**OVERLAPPED,**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) a Distribuição de Pares o usará para sinalizar que a operação de E/S assíncrona associada foi concluída.</span><span class="sxs-lookup"><span data-stu-id="97f20-152">If the caller sets a valid Event handle to the *hEvent* field of [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure, Peer Distribution uses it to signal that the associated asynchronous I/O operation has completed.</span></span>

<span data-ttu-id="97f20-153">Um chamador de thread pode gerenciar operações sobreposição especificando um identificador para o objeto de evento de redefinição manual da estrutura [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) em uma das funções de espera.</span><span class="sxs-lookup"><span data-stu-id="97f20-153">A thread caller can manage overlapped operations by specifying a handle to the [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) structure's manual-reset event object in one of the wait functions.</span></span> <span data-ttu-id="97f20-154">Depois que o Evento for sinalizado, o chamador deverá chamar [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**) passando a estrutura **OVERLAPPED** apropriada.</span><span class="sxs-lookup"><span data-stu-id="97f20-154">After the Event is signaled the caller must call [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**) passing in the appropriate **OVERLAPPED** structure.</span></span> <span data-ttu-id="97f20-155">**PeerGetOverlappedResult** retornará **FALSE** e o chamador deverá chamar [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) para recuperar o código de erro.</span><span class="sxs-lookup"><span data-stu-id="97f20-155">**PeerGetOverlappedResult** will return **FALSE** and the caller must call [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) in order to retrieve the error code.</span></span> <span data-ttu-id="97f20-156">O chamador deverá ignorar todos os campos da estrutura **OVERLAPPED** se o código de erro for diferente de **ERROR \_ SUCCESS.**</span><span class="sxs-lookup"><span data-stu-id="97f20-156">The caller should ignore all the fields of the **OVERLAPPED** structure if the error code is anything other than **ERROR\_SUCCESS**.</span></span> <span data-ttu-id="97f20-157">A operação assíncrona terá êxito se a **função PeerGetOverlappedResult** retornar **TRUE.**</span><span class="sxs-lookup"><span data-stu-id="97f20-157">The asynchronous operation succeeds if the **PeerGetOverlappedResult** function returns **TRUE**.</span></span>

<span data-ttu-id="97f20-158">Se o chamador fornece uma porta de conclusão juntamente com um evento, o evento será usado como o mecanismo de conclusão.</span><span class="sxs-lookup"><span data-stu-id="97f20-158">If the caller provides a completion port along with an event, the event will be used as the completion mechanism.</span></span>

<span data-ttu-id="97f20-159">**Windows 7:** Use a [**função GetOverlappedResult**](/windows/desktop/api/ioapiset/nf-ioapiset-getoverlappedresult) em vez de [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**).</span><span class="sxs-lookup"><span data-stu-id="97f20-159">**Windows 7:** Use the [**GetOverlappedResult**](/windows/desktop/api/ioapiset/nf-ioapiset-getoverlappedresult) function instead of [**PeerGetOverlappedResult**](https://www.bing.com/search?q=**PeerGetOverlappedResult**).</span></span>

## <a name="related-topics"></a><span data-ttu-id="97f20-160">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="97f20-160">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="97f20-161">Referência da API de Distribuição de Pares</span><span class="sxs-lookup"><span data-stu-id="97f20-161">Peer Distribution API Reference</span></span>](peer-distribution-api-reference.md)
</dt> </dl>

 

