---
description: A infraestrutura de mesmo nível usa eventos para notificar aplicativos de alterações que ocorreram em uma rede de mesmo nível, por exemplo, um nó que é adicionado ou removido de um grafo.
ms.assetid: a056da1c-b8f9-4dad-8df9-df24c6b359b7
title: Infraestrutura de eventos de pares
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6347ad6a7dd0cf2fae4a0aa623bfda48ab0aa9f8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105756881"
---
# <a name="peer-events-infrastructure"></a><span data-ttu-id="0a0c6-103">Infraestrutura de eventos de pares</span><span class="sxs-lookup"><span data-stu-id="0a0c6-103">Peer Events Infrastructure</span></span>

<span data-ttu-id="0a0c6-104">A infraestrutura de mesmo nível usa eventos para notificar aplicativos de alterações que ocorreram em uma rede de mesmo nível, por exemplo, um nó que é adicionado ou removido de um grafo.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-104">The Peer Infrastructure uses events to notify applications of changes that have occurred within a peer network, for example, a node that is added or removed from a graph.</span></span> <span data-ttu-id="0a0c6-105">O grafo de pares e as infraestruturas de agrupamento de pares usam a infraestrutura de eventos de pares.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-105">The Peer Graphing and Peer Grouping Infrastructures use the peer events infrastructure.</span></span>

## <a name="receiving-peer-event-notification"></a><span data-ttu-id="0a0c6-106">Recebendo notificação de eventos de pares</span><span class="sxs-lookup"><span data-stu-id="0a0c6-106">Receiving Peer Event Notification</span></span>

<span data-ttu-id="0a0c6-107">Um par pode se registrar para receber notificações quando um atributo de um grafo ou grupo for alterado ou ocorrer um evento de mesmo nível específico.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-107">A peer can register to receive notification when an attribute of a graph or group changes, or a specific peer event occurs.</span></span> <span data-ttu-id="0a0c6-108">Um aplicativo de mesmo nível chama a função [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent) ou [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent) e passa um identificador de evento para a infraestrutura de mesmo nível, que é criada anteriormente por uma chamada para [**CreateEvent**](graphing-reference-links.md).</span><span class="sxs-lookup"><span data-stu-id="0a0c6-108">A peer application calls the [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent) or [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent) function, and passes an event handle to the Peer Infrastructure, which is created previously by a call to [**CreateEvent**](graphing-reference-links.md).</span></span> <span data-ttu-id="0a0c6-109">A infraestrutura de mesmo nível usa o identificador para sinalizar um aplicativo que ocorreu um evento de mesmo nível.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-109">The Peer Infrastructure uses the handle to signal an application that a peer event has occurred.</span></span>

<span data-ttu-id="0a0c6-110">O aplicativo também passa uma série de estruturas de [**\_ \_ \_ registro**](/windows/desktop/api/P2P/ns-p2p-peer_group_event_registration) de eventos de [**\_ grafo \_ \_**](/windows/desktop/api/P2P/ns-p2p-peer_graph_event_registration) de pares ou de grupo de pares que indicam à infraestrutura de pares os eventos de pares específicos para os quais o aplicativo está solicitando a notificação.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-110">The application also passes a series of [**PEER\_GRAPH\_EVENT\_REGISTRATION**](/windows/desktop/api/P2P/ns-p2p-peer_graph_event_registration) or [**PEER\_GROUP\_EVENT\_REGISTRATION**](/windows/desktop/api/P2P/ns-p2p-peer_group_event_registration) structures that indicate to the Peer Infrastructure the specific peer events for which the application is requesting notification.</span></span> <span data-ttu-id="0a0c6-111">O aplicativo também deve especificar exatamente quantas estruturas estão sendo passadas.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-111">The application must also specify exactly how many structures are being passed.</span></span>

## <a name="peer-graphing-events"></a><span data-ttu-id="0a0c6-112">Eventos de grafo de pares</span><span class="sxs-lookup"><span data-stu-id="0a0c6-112">Peer Graphing Events</span></span>

<span data-ttu-id="0a0c6-113">Um aplicativo de grafo de pares pode se registrar para receber notificações para 9 eventos de grafo de pares.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-113">A Peer Graphing application can register to receive notification for 9 peer graph events.</span></span> <span data-ttu-id="0a0c6-114">Cada nome de evento é precedido com o **\_ \_ evento \_ de grafo par**, por exemplo, o **status do grafo de pares \_ \_ \_ foi alterado**.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-114">Each event name is prefaced with **PEER\_GRAPH\_EVENT\_**, for example, **PEER\_GRAPH\_STATUS\_CHANGED**.</span></span> <span data-ttu-id="0a0c6-115">Salvo indicação em contrário, as informações sobre uma alteração são recuperadas usando [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="0a0c6-115">Unless otherwise noted, information about a change is retrieved by using [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata).</span></span>

-   <span data-ttu-id="0a0c6-116">**Par \_ O \_ status do evento de grafo \_ \_ alterado** indica que o status de um grafo foi alterado, por exemplo, um nó foi sincronizado com um grafo.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-116">**PEER\_GRAPH\_EVENT\_STATUS\_CHANGED** indicates that the status of a graph is changed, for example, a node has synchronized with a graph.</span></span>
-   <span data-ttu-id="0a0c6-117">**Par \_ A \_ propriedade de evento do grafo \_ \_ alterada** indica que uma propriedade de um grafo ou grupo foi alterada, por exemplo, o nome amigável de um grafo foi alterado.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-117">**PEER\_GRAPH\_EVENT\_PROPERTY\_CHANGED** indicates that a property of a graph or group is changed, for example, the friendly name of a graph has changed.</span></span>
    > [!Note]  
    > <span data-ttu-id="0a0c6-118">O aplicativo deve chamar [**PeerGraphGetProperties**](/windows/desktop/api/P2P/nf-p2p-peergraphgetproperties) para obter as informações alteradas.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-118">The application must call [**PeerGraphGetProperties**](/windows/desktop/api/P2P/nf-p2p-peergraphgetproperties) to obtain the changed information.</span></span>

     

-   <span data-ttu-id="0a0c6-119">**Par \_ O \_ registro de evento de grafo \_ \_ alterado** indica que um registro foi alterado, por exemplo, um registro é excluído.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-119">**PEER\_GRAPH\_EVENT\_RECORD\_CHANGED** indicates that a record is changed, for example, a record is deleted.</span></span>
-   <span data-ttu-id="0a0c6-120">**Par \_ \_ \_ \_ Conexão direta de evento de grafo** indica que uma conexão direta foi alterada, por exemplo, um nó conectado.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-120">**PEER\_GRAPH\_EVENT\_DIRECT\_CONNECTION** indicates that a direct connection is changed, for example, a node has connected.</span></span>
-   <span data-ttu-id="0a0c6-121">**Par \_ \_Conexão de \_ vizinho \_ de evento de grafo** indica que uma conexão com um nó vizinho é alterada, por exemplo, um nó se conectou.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-121">**PEER\_GRAPH\_EVENT\_NEIGHBOR\_CONNECTION** indicates that a connection to a neighbor node is changed, for example, a node has connected.</span></span>
-   <span data-ttu-id="0a0c6-122">**Par \_ \_Dados de \_ entrada \_ de evento de grafo** indicam que os dados foram recebidos de uma conexão direta ou de vizinho.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-122">**PEER\_GRAPH\_EVENT\_INCOMING\_DATA** indicates that data has been received from a direct or neighbor connection.</span></span>
-   <span data-ttu-id="0a0c6-123">**Par \_ Conexão de evento de grafo \_ \_ \_ necessária** indica que a infraestrutura de gráfico requer uma nova conexão.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-123">**PEER\_GRAPH\_EVENT\_CONNECTION\_REQUIRED** indicates that the Graphing Infrastructure requires a new connection.</span></span>
    > [!Note]  
    > <span data-ttu-id="0a0c6-124">Uma chamada para [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) se conecta a um novo nó.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-124">A call to [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) connects to a new node.</span></span> <span data-ttu-id="0a0c6-125">Uma chamada para [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata) não retorna dados.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-125">A call to [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata) does not return data.</span></span>

     

-   <span data-ttu-id="0a0c6-126">**Par \_ Nó de evento de grafo \_ \_ \_ alterado** indica que as informações de presença de nó foram alteradas, por exemplo, um endereço IP foi alterado.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-126">**PEER\_GRAPH\_EVENT\_NODE\_CHANGED** indicates that node presence information is changed, for example, an IP address has changed.</span></span>
-   <span data-ttu-id="0a0c6-127">**Par \_ O \_ evento \_ sincronizado do Graph** indica que um tipo de registro específico está sincronizado.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-127">**PEER\_GRAPH\_EVENT\_SYNCHRONIZED** indicates that a specific record type is synchronized.</span></span>

<span data-ttu-id="0a0c6-128">Depois que um aplicativo recebe uma notificação de que ocorreu um evento de par, o aplicativo chama [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata)e passa o identificador de evento de par retornado por [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span><span class="sxs-lookup"><span data-stu-id="0a0c6-128">After an application receives notification that a peer event has occurred, the application calls [**PeerGraphGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergraphgeteventdata), and passes the peer event handle returned by [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span></span> <span data-ttu-id="0a0c6-129">A infraestrutura de pares retorna um ponteiro para uma estrutura de [**\_ dados de \_ evento \_ de grafo par**](/windows/desktop/api/P2P/ns-p2p-peer_graph_event_data) que contém os dados solicitados.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-129">The Peer Infrastructure returns a pointer to a [**PEER\_GRAPH\_EVENT\_DATA**](/windows/desktop/api/P2P/ns-p2p-peer_graph_event_data) structure that contains the requested data.</span></span> <span data-ttu-id="0a0c6-130">Essa função deve ser chamada até **que \_ pares \_ nenhum \_ \_ dado de evento** seja retornado.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-130">This function should be called until **PEER\_S\_NO\_EVENT\_DATA** is returned.</span></span>

<span data-ttu-id="0a0c6-131">Depois que um aplicativo não requer uma notificação de evento de mesmo nível, o aplicativo chama [**PeerGraphUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphunregisterevent)e passa o identificador de evento de par retornado pelo [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent) quando o aplicativo é registrado.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-131">After an application does not require a peer event notification, the application calls either [**PeerGraphUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphunregisterevent), and passes the peer event handle returned by [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent) when the application registered.</span></span>

## <a name="handling-graph-connection-referrals"></a><span data-ttu-id="0a0c6-132">Manipulando referências de conexão do grafo</span><span class="sxs-lookup"><span data-stu-id="0a0c6-132">Handling Graph Connection Referrals</span></span>

<span data-ttu-id="0a0c6-133">Quando [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) é chamado, o ponto de conexão é notificado sobre êxito ou falha por meio do evento de **conexão de vizinho de evento de grafo de pares \_ \_ \_ \_** assíncrono.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-133">When [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) is called, the connecting peer is notified of success or failure through the asynchronous **PEER\_GRAPH\_EVENT\_NEIGHBOR\_CONNECTION** event.</span></span> <span data-ttu-id="0a0c6-134">Se a conexão falhou devido a problemas de rede específicos (como um firewall configurado incorretamente), o evento **de \_ \_ conexão de \_ vizinho \_ do evento de grafo par** é gerado, com o status da conexão definido como **par \_ conexão \_ falhou**.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-134">If the connection failed due to a specific networking issues (such as a misconfigured firewall), the **PEER\_GRAPH\_EVENT\_NEIGHBOR\_CONNECTION** event is raised, with the connection status set to **PEER\_CONNECTION\_FAILED**.</span></span>

<span data-ttu-id="0a0c6-135">No entanto, quando um par recebe uma referência quando tenta se conectar a um nó ocupado, **a \_ \_ conexão de \_ vizinho \_ do evento de grafo par** é gerada no ponto de conexão, com o status da conexão definido como **par \_ conexão \_ falha**.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-135">However, when a peer receives a referral when it attempts to connect to a busy node, the **PEER\_GRAPH\_EVENT\_NEIGHBOR\_CONNECTION** is raised on the connecting peer, with the connection status set to **PEER\_CONNECTION\_FAILED**.</span></span> <span data-ttu-id="0a0c6-136">O ponto de conexão pode ser referenciado em outro nó que está ocupado e pode enviar uma referência, e o mesmo evento e status são gerados no ponto de conexão.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-136">The connecting peer may be referred to another node which itself is busy and may send a referral, and the same event and status are raised on the connecting peer.</span></span> <span data-ttu-id="0a0c6-137">Essa cadeia de referências que resultam em status de evento de **\_ \_ falha na conexão de pares** pode continuar até que o número máximo de tentativas de conexão seja esgotado.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-137">This chain of referrals that result in **PEER\_CONNECTION\_FAILED** event statuses can continue until the maximum number of connection attempts has been exhausted.</span></span> <span data-ttu-id="0a0c6-138">O par não tem um mecanismo para determinar a diferença entre uma tentativa de conexão completa e a referência de conexão.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-138">The peer does not have a mechanism to determine the difference between a full connection attempt and the connection referral.</span></span>

<span data-ttu-id="0a0c6-139">Para resolver esse problema, os desenvolvedores devem considerar o uso de eventos de alteração de status do grafo de pares para determinar se a tentativa de conexão bem-sucedido.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-139">To address this issue, developers should consider using the peer graph status change events to determine if the connection attempt suceeded.</span></span> <span data-ttu-id="0a0c6-140">Se o evento não for recebido dentro de um período de tempo específico, o aplicativo poderá assumir que o ponto de conexão está sendo referenciado e que o aplicativo par deve considerar a tentativa de conexão com uma falha.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-140">If the event is not received within a specific amount of time, the application can assume that the connecting peer is being referred and that the peer application should consider the connection attempt a failure.</span></span>

## <a name="peer-grouping-events"></a><span data-ttu-id="0a0c6-141">Eventos de agrupamento de pares</span><span class="sxs-lookup"><span data-stu-id="0a0c6-141">Peer Grouping Events</span></span>

<span data-ttu-id="0a0c6-142">Um aplicativo de agrupamento de pares pode se registrar para receber notificações de 8 eventos de mesmo nível.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-142">A Peer Grouping application can register to receive notification for 8 peer events.</span></span> <span data-ttu-id="0a0c6-143">Cada nome de evento é precedido com o **\_ \_ evento \_ de grupo de pares**; por exemplo, o status do evento de grupo de **pares \_ \_ \_ \_ foi alterado**.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-143">Each event name is prefaced with **PEER\_GROUP\_EVENT\_**; for example, **PEER\_GROUP\_EVENT\_STATUS\_CHANGED**.</span></span> <span data-ttu-id="0a0c6-144">Salvo indicação em contrário, as informações sobre uma alteração são recuperadas usando [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="0a0c6-144">Unless otherwise noted, information about a change is retrieved by using [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span></span>

-   <span data-ttu-id="0a0c6-145">**Par \_ O \_ status do evento de grupo \_ \_ alterado** indica que o status do grupo foi alterado.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-145">**PEER\_GROUP\_EVENT\_STATUS\_CHANGED** indicates that the group status has changed.</span></span> <span data-ttu-id="0a0c6-146">Há dois valores de status possíveis: **\_ escuta de \_ status \_ do grupo de pares**, que indica que o grupo não tem conexões e está aguardando novos membros; e o status do grupo de **pares \_ \_ \_ tem conexões**, o que indica que o grupo tem pelo menos uma conexão.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-146">There are two status values possible: **PEER\_GROUP\_STATUS\_LISTENING**, which indicates that the group has no connections and is waiting for new members; and **PEER\_GROUP\_STATUS\_HAS CONNECTIONS**, which indicates that the group has at least one connection.</span></span> <span data-ttu-id="0a0c6-147">Esse valor de status pode ser obtido chamando [**PeerGroupGetStatus**](/windows/desktop/api/P2P/nf-p2p-peergroupgetstatus) depois que esse evento é gerado.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-147">This status value can be obtained by calling [**PeerGroupGetStatus**](/windows/desktop/api/P2P/nf-p2p-peergroupgetstatus) after this event is raised.</span></span>
-   <span data-ttu-id="0a0c6-148">**Par \_ A \_ propriedade de evento de grupo \_ \_ alterada** indica que as propriedades do grupo foram alteradas ou atualizadas pelo criador do grupo.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-148">**PEER\_GROUP\_EVENT\_PROPERTY\_CHANGED** indicates that the group properties have been changed or updated by the group creator.</span></span>
-   <span data-ttu-id="0a0c6-149">**Par \_ Registro de evento de grupo \_ \_ \_ alterado** indica que uma operação de registro foi executada.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-149">**PEER\_GROUP\_EVENT\_RECORD\_CHANGED** indicates that a record operation has been performed.</span></span> <span data-ttu-id="0a0c6-150">Esse evento é gerado quando um par que participa do grupo publica, atualiza ou exclui um registro.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-150">This event is raised when a peer participating in the group publishes, updates, or deletes a record.</span></span> <span data-ttu-id="0a0c6-151">Por exemplo, esse evento é gerado quando um aplicativo de chat envia uma mensagem de chat.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-151">For example, this event is raised when a chat application sends a chat message.</span></span>
-   <span data-ttu-id="0a0c6-152">**Par \_ O \_ membro de evento de grupo \_ \_ alterado** indica que o status de um membro dentro do grupo foi alterado.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-152">**PEER\_GROUP\_EVENT\_MEMBER\_CHANGED** indicates that a member's status within the group has changed.</span></span> <span data-ttu-id="0a0c6-153">As alterações de status incluem:</span><span class="sxs-lookup"><span data-stu-id="0a0c6-153">Status changes include:</span></span>
    -   <span data-ttu-id="0a0c6-154">**Par \_ MEMBRO \_ conectado**.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-154">**PEER\_MEMBER\_CONNECTED**.</span></span> <span data-ttu-id="0a0c6-155">Um par se conectou ao grupo.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-155">A peer has connected to the group.</span></span>
    -   <span data-ttu-id="0a0c6-156">**Par \_ MEMBRO \_ desconectado**.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-156">**PEER\_MEMBER\_DISCONNECTED**.</span></span> <span data-ttu-id="0a0c6-157">Um par foi desconectado do grupo.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-157">A peer has disconnected from the group.</span></span>
    -   <span data-ttu-id="0a0c6-158">**Par \_ MEMBRO \_ associado**.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-158">**PEER\_MEMBER\_JOINED**.</span></span> <span data-ttu-id="0a0c6-159">Novas informações de associação foram publicadas para um par.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-159">New membership information has been published for a peer.</span></span>
    -   <span data-ttu-id="0a0c6-160">**Par \_ MEMBRO \_ atualizado**.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-160">**PEER\_MEMBER\_UPDATED**.</span></span> <span data-ttu-id="0a0c6-161">Um par foi atualizado com novas informações, como um novo endereço IP.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-161">A peer has updated with new information, such as a new IP address.</span></span>
-   <span data-ttu-id="0a0c6-162">**Par \_ \_conexão de \_ vizinho \_ do evento de grupo**.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-162">**PEER\_GROUP\_EVENT\_NEIGHBOR\_CONNECTION**.</span></span> <span data-ttu-id="0a0c6-163">Os pares que participarão de conexões vizinhas dentro do grupo devem ser registrados para esse evento.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-163">Peers who will participate in neighbor connections within the group must register for this event.</span></span> <span data-ttu-id="0a0c6-164">Observe que o registro para esse evento não permite que o par receba dados; o registro para esse evento garante apenas a notificação quando uma solicitação de uma conexão vizinha é recebida.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-164">Note that registering for this event does not enable the peer to receive data; registration for this event only ensures notification when a request for a neighbor connection is received.</span></span>
-   <span data-ttu-id="0a0c6-165">**Par \_ \_ \_ \_ conexão direta de evento de grupo**.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-165">**PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION**.</span></span> <span data-ttu-id="0a0c6-166">Os colegas que participarão de conexões diretas dentro do grupo deverão se registrar nesse evento.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-166">Peers who will participate in direct connections within the group must register for this event.</span></span> <span data-ttu-id="0a0c6-167">Observe que o registro para esse evento não permite que o par receba dados; o registro para esse evento garante apenas a notificação quando uma solicitação de conexão direta é recebida.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-167">Note that registering for this event does not enable the peer to receive data; registration for this event only ensures notification when a request for a direct connection is received.</span></span>
-   <span data-ttu-id="0a0c6-168">**Par \_ AGRUPAR \_ \_ \_ dados de entrada de evento**.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-168">**PEER\_GROUP\_EVENT\_INCOMING\_DATA**.</span></span> <span data-ttu-id="0a0c6-169">Os pares que receberão dados sobre um vizinho ou conexão direta deverão se registrar para esse evento.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-169">Peers who will receive data over a neighbor or direct connection must register for this event.</span></span> <span data-ttu-id="0a0c6-170">Quando esse evento é gerado, os dados opacos transmitidos pelo outro par participante podem ser obtidos chamando [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="0a0c6-170">When this event is raised, the opaque data transmitted by the other participating peer can be obtained by calling [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span></span> <span data-ttu-id="0a0c6-171">Observe que para receber esse evento, o par deve ter sido registrado anteriormente **para \_ \_ \_ \_ conexão direta de evento de grupo de pares** ou **\_ \_ \_ \_ conexão de vizinho de evento de grupo de pares**.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-171">Note that to receive this event, the peer must have previously registered for **PEER\_GROUP\_EVENT\_DIRECT\_CONNECTION** or **PEER\_GROUP\_EVENT\_NEIGHBOR\_CONNECTION**.</span></span>
-   <span data-ttu-id="0a0c6-172">**Par \_ \_ \_ \_ falha na conexão de evento de grupo**.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-172">**PEER\_GROUP\_EVENT\_CONNECTION\_FAILED**.</span></span> <span data-ttu-id="0a0c6-173">Uma conexão falhou por algum motivo.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-173">A connection failed for some reason.</span></span> <span data-ttu-id="0a0c6-174">Nenhum dado é fornecido quando esse evento é gerado e [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata) não deve ser chamado.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-174">No data is provided when this event is raised, and [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata) should not be called.</span></span>

<span data-ttu-id="0a0c6-175">Depois que um aplicativo recebe uma notificação de que um evento de mesmo nível ocorreu (excluindo **\_ \_ \_ \_ falha na conexão de evento de grupo de pares**), o aplicativo chama [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata)e passa o identificador de evento de par retornado por [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent).</span><span class="sxs-lookup"><span data-stu-id="0a0c6-175">After an application receives notification that a peer event has occurred (excluding **PEER\_GROUP\_EVENT\_CONNECTION\_FAILED**), the application calls [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata), and passes the peer event handle returned by [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent).</span></span> <span data-ttu-id="0a0c6-176">A infraestrutura de pares retorna um ponteiro para uma estrutura de dados de evento de grupo de pares que contém os dados solicitados. [**\_ \_ \_**](/windows/win32/api/p2p/ns-p2p-peer_group_event_data-r1)</span><span class="sxs-lookup"><span data-stu-id="0a0c6-176">The Peer Infrastructure returns a pointer to a [**PEER\_GROUP\_EVENT\_DATA**](/windows/win32/api/p2p/ns-p2p-peer_group_event_data-r1) structure that contains the requested data.</span></span> <span data-ttu-id="0a0c6-177">Essa função deve ser chamada até **que \_ pares \_ nenhum \_ \_ dado de evento** seja retornado.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-177">This function must be called until **PEER\_S\_NO\_EVENT\_DATA** is returned.</span></span> <span data-ttu-id="0a0c6-178">Quando um aplicativo não requer mais uma notificação para um evento de mesmo nível, uma chamada deve ser feita ao [**PeerGroupUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupunregisterevent), passando o identificador de evento de par retornado por **PeerGroupRegisterEvent** quando o aplicativo é registrado para o evento específico.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-178">When an application no longer requires notification for a peer event, a call must be made to [**PeerGroupUnregisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupunregisterevent), passing the peer event handle returned by **PeerGroupRegisterEvent** when the application registered for the particular event.</span></span>

## <a name="example-of-registering-for-peer-graphing-events"></a><span data-ttu-id="0a0c6-179">Exemplo de registro para eventos de grafo de pares</span><span class="sxs-lookup"><span data-stu-id="0a0c6-179">Example of Registering for Peer Graphing Events</span></span>

<span data-ttu-id="0a0c6-180">O exemplo de código a seguir mostra como registrar-se com os eventos de grafo de pares.</span><span class="sxs-lookup"><span data-stu-id="0a0c6-180">The following code sample shows you how to register with the Peer Graphing events.</span></span>


```C++
//-----------------------------------------------------------------------------
// Function: RegisterForEvents
//
// Purpose:  Registers the EventCallback function so it can be called for only
//           the events that are specified.
//
// Returns:  HRESULT
//
HRESULT RegisterForEvents()
{
    HPEEREVENT  g_hPeerEvent = NULL;        // The one PeerEvent handle
    HANDLE      g_hEvent = NULL;            // Handle signaled by Graphing when we have an event
    HRESULT hr = S_OK;
    PEER_GRAPH_EVENT_REGISTRATION regs[] = {
        { PEER_GRAPH_EVENT_RECORD_CHANGED, 0 },
        { PEER_GRAPH_EVENT_NODE_CHANGED,   0 },
        { PEER_GRAPH_EVENT_STATUS_CHANGED, 0 },
        { PEER_GRAPH_EVENT_DIRECT_CONNECTION, 0 },
        { PEER_GRAPH_EVENT_INCOMING_DATA, 0 },
    };

    g_hEvent = CreateEvent(NULL, FALSE, FALSE, NULL);
    if (g_hEvent == NULL)
    {
        wprintf(L"CreateEvent call failed.\n");
        hr = E_OUTOFMEMORY;
    }
    else
    {
        hr = PeerGraphRegisterEvent(g_hGraph, g_hEvent, celems(regs), regs,  &g_hPeerEvent);
        if (FAILED(hr))
        {
           wprintf(L"PeerGraphRegisterEvent call failed.\n");
            CloseHandle(g_hEvent);
            g_hEvent = NULL;
        }
    }

    if (SUCCEEDED(hr))
    {
        if (!RegisterWaitForSingleObject(&g_hWait, g_hEvent, EventCallback, NULL, INFINITE, WT_EXECUTEDEFAULT))
        {
            hr = HRESULT_FROM_WIN32(GetLastError());
            wprintf(L"Could not set up event callback.\n");
            CloseHandle(g_hEvent);
            g_hEvent = NULL;
        }
    }

    return hr;
}
```



 

 



