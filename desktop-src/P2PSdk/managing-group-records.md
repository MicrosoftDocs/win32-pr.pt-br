---
description: Um registro de grupo são dados específicos publicados em todos os membros ativos de um grupo de pares, por exemplo, uma mensagem de chat ou uma atualização de status específica do aplicativo.
ms.assetid: 073ee4e9-0e97-451a-a808-8265575d073c
title: Gerenciando registros de grupo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3b6d9e3257cc597b715dc9c65eb5945c00c15286
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105753423"
---
# <a name="managing-group-records"></a><span data-ttu-id="2a296-103">Gerenciando registros de grupo</span><span class="sxs-lookup"><span data-stu-id="2a296-103">Managing Group Records</span></span>

<span data-ttu-id="2a296-104">Um registro de grupo são dados específicos publicados em todos os membros ativos de um grupo de pares, por exemplo, uma mensagem de chat ou uma atualização de status específica do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2a296-104">A group record is specific data published to all active members of a peer group, for example, a chat message or an application-specific status update.</span></span> <span data-ttu-id="2a296-105">Um registro é representado pela estrutura [**de \_ registro de pares**](/windows/desktop/api/P2P/ns-p2p-peer_record) e contém as seguintes informações sobre um par:</span><span class="sxs-lookup"><span data-stu-id="2a296-105">A record is represented by the [**PEER\_RECORD**](/windows/desktop/api/P2P/ns-p2p-peer_record) structure, and contains the following information about a peer:</span></span>

-   <span data-ttu-id="2a296-106">A ID do registro é um valor que identifica exclusivamente um registro no grupo par.</span><span class="sxs-lookup"><span data-stu-id="2a296-106">The record ID is a value that uniquely identifies a record in the peer group.</span></span>
-   <span data-ttu-id="2a296-107">Um GUID que especifica o tipo de registro.</span><span class="sxs-lookup"><span data-stu-id="2a296-107">A GUID that specifies the record type.</span></span> <span data-ttu-id="2a296-108">Os aplicativos podem dar suporte a diferentes tipos de registro.</span><span class="sxs-lookup"><span data-stu-id="2a296-108">Applications can support different record types.</span></span> <span data-ttu-id="2a296-109">Um aplicativo interpreta o campo de **dados** de um registro com base no tipo de registro.</span><span class="sxs-lookup"><span data-stu-id="2a296-109">An application interprets the **data** field of a record based on the record type.</span></span> <span data-ttu-id="2a296-110">Alguns GUIDs são reservados e a chamada à API retorna o **par \_ E não é \_ \_ autorizado** quando o aplicativo tenta usá-los.</span><span class="sxs-lookup"><span data-stu-id="2a296-110">Some GUIDs are reserved, and the API call returns **PEER\_E\_NOT\_AUTHORIZED** when the application attempts to use them.</span></span>
-   <span data-ttu-id="2a296-111">Um conjunto de atributos de registro descritos como uma cadeia de caracteres XML.</span><span class="sxs-lookup"><span data-stu-id="2a296-111">A set of record attributes described as an XML string.</span></span> <span data-ttu-id="2a296-112">Os atributos são usados durante a pesquisa de registros.</span><span class="sxs-lookup"><span data-stu-id="2a296-112">The attributes are used when searching records.</span></span> <span data-ttu-id="2a296-113">Para obter mais informações sobre atributos, consulte [gravar o esquema de atributo](record-attribute-schema.md).</span><span class="sxs-lookup"><span data-stu-id="2a296-113">For more information about attributes, see [Record Attribute Schema](record-attribute-schema.md).</span></span>
-   <span data-ttu-id="2a296-114">A hora do ponto em que um registro é criado.</span><span class="sxs-lookup"><span data-stu-id="2a296-114">The peer time that a record is created.</span></span>
-   <span data-ttu-id="2a296-115">A hora do ponto em que um registro expira.</span><span class="sxs-lookup"><span data-stu-id="2a296-115">The peer time that a record expires.</span></span>
-   <span data-ttu-id="2a296-116">A hora do ponto em que um registro é modificado.</span><span class="sxs-lookup"><span data-stu-id="2a296-116">The peer time that a record is modified.</span></span>
-   <span data-ttu-id="2a296-117">O criador de um registro.</span><span class="sxs-lookup"><span data-stu-id="2a296-117">The creator of a record.</span></span>
-   <span data-ttu-id="2a296-118">O membro que modifica um registro.</span><span class="sxs-lookup"><span data-stu-id="2a296-118">The member who modifies a record.</span></span>
-   <span data-ttu-id="2a296-119">Uma estrutura de [**\_ dados de mesmo nível**](/windows/desktop/api/P2P/ns-p2p-peer_data) que contém a assinatura criptográfica para todos os campos nesta estrutura de [**\_ registro de pares**](/windows/desktop/api/P2P/ns-p2p-peer_record) .</span><span class="sxs-lookup"><span data-stu-id="2a296-119">A [**PEER\_DATA**](/windows/desktop/api/P2P/ns-p2p-peer_data) structure that contains the cryptographic signature for all of the fields in this [**PEER\_RECORD**](/windows/desktop/api/P2P/ns-p2p-peer_record) structure.</span></span> <span data-ttu-id="2a296-120">Este campo não pode ser atualizado ou alterado diretamente por um par.</span><span class="sxs-lookup"><span data-stu-id="2a296-120">This field cannot be directly updated or altered by a peer.</span></span>
-   <span data-ttu-id="2a296-121">Uma estrutura de [**\_ dados de mesmo nível**](/windows/desktop/api/P2P/ns-p2p-peer_data) que contém os dados específicos do aplicativo associados a esse registro como uma matriz de bytes.</span><span class="sxs-lookup"><span data-stu-id="2a296-121">A [**PEER\_DATA**](/windows/desktop/api/P2P/ns-p2p-peer_data) structure that contains the application-specific data associated with this record as an array of bytes.</span></span> <span data-ttu-id="2a296-122">O tipo de dados presente nesse campo é determinado pelo tipo de registro definido pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2a296-122">The type of data present in this field is determined by application-defined record type.</span></span>

## <a name="obtaining-peer-group-records"></a><span data-ttu-id="2a296-123">Obtendo registros de grupo de pares</span><span class="sxs-lookup"><span data-stu-id="2a296-123">Obtaining Peer Group Records</span></span>

<span data-ttu-id="2a296-124">Registros individuais são obtidos chamando [**PeerGroupGetRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupgetrecord) com a ID do registro.</span><span class="sxs-lookup"><span data-stu-id="2a296-124">Individual records are obtained by calling [**PeerGroupGetRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupgetrecord) with the ID of the record.</span></span> <span data-ttu-id="2a296-125">Ao processar todos os registros de um tipo específico, o conjunto enumerado de todos os registros de grupo de pares atuais é obtido primeiro chamando [**PeerGroupEnumRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupenumrecords) para abrir a enumeração e, em seguida, chamando iterativamente [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) até que todos os registros sejam recuperados.</span><span class="sxs-lookup"><span data-stu-id="2a296-125">When processing all records of a specific type, the enumerated set of all current peer group records is obtained by first calling [**PeerGroupEnumRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupenumrecords) to open the enumeration and then iteratively calling [**PeerGetNextItem**](/windows/desktop/api/P2P/nf-p2p-peergetnextitem) until all records are retrieved.</span></span> <span data-ttu-id="2a296-126">Quando terminar, feche a enumeração e libere a memória associada a ela chamando [**PeerEndEnumeration**](/windows/desktop/api/P2P/nf-p2p-peerendenumeration).</span><span class="sxs-lookup"><span data-stu-id="2a296-126">When finished, close the enumeration and release the memory associated with it by calling [**PeerEndEnumeration**](/windows/desktop/api/P2P/nf-p2p-peerendenumeration).</span></span>

<span data-ttu-id="2a296-127">Quando um registro é criado, excluído ou atualizado por um par, o registro afetado é publicado em todos os membros do grupo de pontos por meio do evento **de \_ \_ alteração de \_ registro \_ de evento do grupo de pares** .</span><span class="sxs-lookup"><span data-stu-id="2a296-127">When a record is created, deleted, or updated by a peer, the affected record is published to all members of the peer group by way of the **PEER\_GROUP\_EVENT\_RECORD\_CHANGE** event.</span></span> <span data-ttu-id="2a296-128">Observe que, se um par não estiver conectado ao grupo, ele receberá o registro atualizado e, na próxima vez que se conectar.</span><span class="sxs-lookup"><span data-stu-id="2a296-128">Note that if a peer is not connected to the group, it will receive the updated record then next time it connects.</span></span> <span data-ttu-id="2a296-129">É importante se registrar para esse evento com [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent) se seu aplicativo mantiver ou gerenciar registros de forma significativa.</span><span class="sxs-lookup"><span data-stu-id="2a296-129">It is important to register for this event with [**PeerGroupRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergroupregisterevent) if your application maintains or manages records in any meaningful way.</span></span> <span data-ttu-id="2a296-130">Como alternativa, o aplicativo pode consultar o banco de dados de registro sob demanda usando [**PeerGroupSearchRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupsearchrecords).</span><span class="sxs-lookup"><span data-stu-id="2a296-130">Alternatively, the application can query the record database on demand using [**PeerGroupSearchRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupsearchrecords).</span></span>

<span data-ttu-id="2a296-131">Quando o evento de alteração de registro de evento de grupo de pares é gerado, a ID e o tipo de registro específicos, bem como o tipo de alteração (adicionar, atualizar, excluir) é recebido como uma estrutura de [**dados de alteração de registro de evento de pares \_ \_ \_ \_**](/windows/desktop/api/P2P/ns-p2p-peer_event_record_change_data) . **\_ \_ \_ \_**</span><span class="sxs-lookup"><span data-stu-id="2a296-131">When the **PEER\_GROUP\_EVENT\_RECORD\_CHANGE** event is raised, the specific record ID and type as well as the type of change (add, update, delete) is received as a [**PEER\_EVENT\_RECORD\_CHANGE\_DATA**](/windows/desktop/api/P2P/ns-p2p-peer_event_record_change_data) structure.</span></span> <span data-ttu-id="2a296-132">Essa estrutura é obtida com uma chamada para [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span><span class="sxs-lookup"><span data-stu-id="2a296-132">This structure is obtained with a call to [**PeerGroupGetEventData**](/windows/desktop/api/P2P/nf-p2p-peergroupgeteventdata).</span></span> <span data-ttu-id="2a296-133">Se a alteração for uma adição ou uma atualização, você deverá usar [**PeerGroupGetRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupgetrecord) para obter o registro com a ID fornecida.</span><span class="sxs-lookup"><span data-stu-id="2a296-133">If the change is an add or an update, you should use [**PeerGroupGetRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupgetrecord) to obtain the record with the supplied ID.</span></span> <span data-ttu-id="2a296-134">O banco de dados de registro local para a infraestrutura é atualizado automaticamente.</span><span class="sxs-lookup"><span data-stu-id="2a296-134">The local record database for the infrastructure is updated automatically.</span></span>

<span data-ttu-id="2a296-135">Você também pode pesquisar registros específicos com base em atributos personalizados específicos fornecidos no campo **pwzAttributes** do [**\_ registro de pares**](/windows/desktop/api/P2P/ns-p2p-peer_record), bem como quaisquer atributos predefinidos.</span><span class="sxs-lookup"><span data-stu-id="2a296-135">You can also search for specific records based on specific custom attributes supplied in the **pwzAttributes** field of [**PEER\_RECORD**](/windows/desktop/api/P2P/ns-p2p-peer_record), as well as any predefined attributes.</span></span> <span data-ttu-id="2a296-136">Para fazer isso, use a função [**PeerGroupSearchRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupsearchrecords) com uma consulta de pesquisa XML formatada conforme especificado no tópico [formato de consulta de pesquisa de registro](record-search-query-format.md) .</span><span class="sxs-lookup"><span data-stu-id="2a296-136">To accomplish this, use the [**PeerGroupSearchRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupsearchrecords) function with an XML search query formatted as specified in the [Record Search Query Format](record-search-query-format.md) topic.</span></span>

<span data-ttu-id="2a296-137">Para obter mais detalhes sobre como trabalhar com registros na infraestrutura par, consulte o tópico [registros](records.md) em [usando a infraestrutura de pares](using-the-peer-infrastructure.md).</span><span class="sxs-lookup"><span data-stu-id="2a296-137">For more details on working with records in the Peer Infrastructure, please refer to the [Records](records.md) topic in [Using the Peer Infrastructure](using-the-peer-infrastructure.md).</span></span>

## <a name="administration-of-peer-group-records"></a><span data-ttu-id="2a296-138">Administração de registros de grupo de pares</span><span class="sxs-lookup"><span data-stu-id="2a296-138">Administration of Peer Group Records</span></span>

<span data-ttu-id="2a296-139">Quando os convites iniciais são emitidos pelo criador do grupo de pares, ele pode especificar que determinados membros sirvam em uma função administrativa (administrador da função de grupo de pares \_ \_ \_ ) sempre que emitir novas credenciais para o usuário (por meio de [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) ou [**PeerGroupIssueCredentials**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials)).</span><span class="sxs-lookup"><span data-stu-id="2a296-139">When the initial invitations are issued by the peer group's creator, it can specify that certain members serve in an administrative role (PEER\_GROUP\_ROLE\_ADMIN) whenever it issues new credentials to the user (via either [**PeerGroupCreateInvitation**](/windows/desktop/api/P2P/nf-p2p-peergroupcreateinvitation) or [**PeerGroupIssueCredentials**](/windows/desktop/api/P2P/nf-p2p-peergroupissuecredentials)).</span></span> <span data-ttu-id="2a296-140">Um administrador tem a capacidade de adicionar, excluir e atualizar diretamente qualquer registro de grupo de mesmo nível.</span><span class="sxs-lookup"><span data-stu-id="2a296-140">An administrator has the ability to directly add, delete, and update any peer group records.</span></span> <span data-ttu-id="2a296-141">Por outro lado, um membro do grupo de pares com sua função definida como membro da **\_ \_ função \_ de grupo par** ou **função de grupo par \_ \_ \_ convidando \_ membro** só pode adicionar, atualizar e excluir seus próprios registros.</span><span class="sxs-lookup"><span data-stu-id="2a296-141">Conversely, a peer group member with it's role set to either **PEER\_GROUP\_ROLE\_MEMBER** or **PEER\_GROUP\_ROLE\_INVITING\_MEMBER** can only add, update, and delete its own record(s).</span></span>

<span data-ttu-id="2a296-142">O criador tem a função de administrador por padrão.</span><span class="sxs-lookup"><span data-stu-id="2a296-142">The creator has the administrator role by default.</span></span>

<span data-ttu-id="2a296-143">Para atualizar um registro, obtenha o registro com [**PeerGroupGetRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupgetrecord) ou [**PeerGroupEnumRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupenumrecords), faça as alterações e passe o registro atualizado para [**PeerGroupUpdateRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupupdaterecord).</span><span class="sxs-lookup"><span data-stu-id="2a296-143">To update a record, obtain the record with [**PeerGroupGetRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupgetrecord) or [**PeerGroupEnumRecords**](/windows/desktop/api/P2P/nf-p2p-peergroupenumrecords), make the changes, and pass the updated record to [**PeerGroupUpdateRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupupdaterecord).</span></span>

<span data-ttu-id="2a296-144">Para excluir um registro, passe a ID do registro para excluir para [**PeerGroupDeleteRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupdeleterecord).</span><span class="sxs-lookup"><span data-stu-id="2a296-144">To delete a record, pass the record ID to delete to [**PeerGroupDeleteRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupdeleterecord).</span></span>

<span data-ttu-id="2a296-145">Para adicionar um registro, crie uma nova estrutura de [**\_ registro de mesmo nível**](/windows/desktop/api/P2P/ns-p2p-peer_record) e preencha os seguintes campos:</span><span class="sxs-lookup"><span data-stu-id="2a296-145">To add a record, create a new [**PEER\_RECORD**](/windows/desktop/api/P2P/ns-p2p-peer_record) structure and populate the following fields:</span></span>

-   <span data-ttu-id="2a296-146">**dwSize**.</span><span class="sxs-lookup"><span data-stu-id="2a296-146">**dwSize**.</span></span> <span data-ttu-id="2a296-147">Este campo contém o valor de **sizeof**([**\_ registro par**](/windows/desktop/api/P2P/ns-p2p-peer_record)).</span><span class="sxs-lookup"><span data-stu-id="2a296-147">This field contains the value of **sizeof**([**PEER\_RECORD**](/windows/desktop/api/P2P/ns-p2p-peer_record)).</span></span>
-   <span data-ttu-id="2a296-148">**ftExpiration**.</span><span class="sxs-lookup"><span data-stu-id="2a296-148">**ftExpiration**.</span></span> <span data-ttu-id="2a296-149">Este campo contém a data e a hora de expiração deste registro, expressos em tempo de emparelhamento como uma estrutura **FILETIME** .</span><span class="sxs-lookup"><span data-stu-id="2a296-149">This field contains the expiration date and time of this record, expressed in peer time as a **FILETIME** structure.</span></span>
-   <span data-ttu-id="2a296-150">**digite**.</span><span class="sxs-lookup"><span data-stu-id="2a296-150">**type**.</span></span> <span data-ttu-id="2a296-151">Este campo contém um valor de **GUID** que identifica o tipo de registro para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2a296-151">This field contains a **GUID** value that identifies the record type to the application.</span></span> <span data-ttu-id="2a296-152">Se esse tipo for personalizado para sua infraestrutura de aplicativo, você também deverá preencher o campo de **dados** .</span><span class="sxs-lookup"><span data-stu-id="2a296-152">If this type is custom to your application infrastructure, you should also populate the **data** field.</span></span>

<span data-ttu-id="2a296-153">Os campos a seguir são preenchidos pela infraestrutura do e serão ignorados se forem definidos pelo aplicativo:</span><span class="sxs-lookup"><span data-stu-id="2a296-153">The following fields are populated by the infrastructure, and will be ignored if set by the application:</span></span>

-   <span data-ttu-id="2a296-154">**id**</span><span class="sxs-lookup"><span data-stu-id="2a296-154">**id**</span></span>
-   <span data-ttu-id="2a296-155">**pwzCreatorId**</span><span class="sxs-lookup"><span data-stu-id="2a296-155">**pwzCreatorId**</span></span>
-   <span data-ttu-id="2a296-156">**pwzLastModifiedById**</span><span class="sxs-lookup"><span data-stu-id="2a296-156">**pwzLastModifiedById**</span></span>
-   <span data-ttu-id="2a296-157">**ftCreation**</span><span class="sxs-lookup"><span data-stu-id="2a296-157">**ftCreation**</span></span>
-   <span data-ttu-id="2a296-158">**ftLastModified**</span><span class="sxs-lookup"><span data-stu-id="2a296-158">**ftLastModified**</span></span>
-   <span data-ttu-id="2a296-159">**securityData**</span><span class="sxs-lookup"><span data-stu-id="2a296-159">**securityData**</span></span>

<span data-ttu-id="2a296-160">Os campos restantes são opcionais.</span><span class="sxs-lookup"><span data-stu-id="2a296-160">The remaining fields are optional.</span></span> <span data-ttu-id="2a296-161">Para adicionar esse novo registro ao grupo par, passe-o para [**PeerGroupAddRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupaddrecord).</span><span class="sxs-lookup"><span data-stu-id="2a296-161">To add this new record to the peer group, pass it to [**PeerGroupAddRecord**](/windows/desktop/api/P2P/nf-p2p-peergroupaddrecord).</span></span>

## <a name="importing-and-exporting-records"></a><span data-ttu-id="2a296-162">Importando e exportando registros</span><span class="sxs-lookup"><span data-stu-id="2a296-162">Importing and Exporting Records</span></span>

<span data-ttu-id="2a296-163">Os registros de grupo ponto a ponto são mantidos localmente como um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="2a296-163">Peer-to-peer group records are maintained locally as a database.</span></span> <span data-ttu-id="2a296-164">Para salvar um instantâneo atual do banco de dados de registro de grupo par em um arquivo local, chame [**PeerGroupExportDatabase**](/windows/desktop/api/P2P/nf-p2p-peergroupexportdatabase)e passe-o para o grupo par.</span><span class="sxs-lookup"><span data-stu-id="2a296-164">To save a current snapshot of the peer group record database to a local file, call [**PeerGroupExportDatabase**](/windows/desktop/api/P2P/nf-p2p-peergroupexportdatabase), and pass it the handle to the peer group.</span></span> <span data-ttu-id="2a296-165">Esse arquivo pode ser transportado para um computador ou aplicativo diferente, que pode extrair e usar esse banco de dados de registro chamando [**PeerGroupImportDatabase**](/windows/desktop/api/P2P/nf-p2p-peergroupimportdatabase).</span><span class="sxs-lookup"><span data-stu-id="2a296-165">This file can then be transported to a different computer or application, which can extract and use this record database by calling [**PeerGroupImportDatabase**](/windows/desktop/api/P2P/nf-p2p-peergroupimportdatabase).</span></span>

 

 



