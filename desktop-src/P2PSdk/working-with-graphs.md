---
description: Ao trabalhar com grafos de pares, as funções devem ser chamadas em uma ordem específica. O fluxo de chamadas depende se você está criando ou abrindo um grafo de mesmo nível. Este tópico identifica o fluxo de chamadas de função em um aplicativo de grafo de pares simples.
ms.assetid: cb4f48d0-d1e2-4a4b-bd5a-6e8f66d03806
title: Trabalhando com grafos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b4328b7a0109139421cf03c72a7228a3dc17e375
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105771825"
---
# <a name="working-with-graphs"></a><span data-ttu-id="3b574-105">Trabalhando com grafos</span><span class="sxs-lookup"><span data-stu-id="3b574-105">Working with Graphs</span></span>

<span data-ttu-id="3b574-106">Ao trabalhar com grafos de pares, as funções devem ser chamadas em uma ordem específica.</span><span class="sxs-lookup"><span data-stu-id="3b574-106">When working with peer graphs, functions must be called in a specific order.</span></span> <span data-ttu-id="3b574-107">O fluxo de chamadas depende se você está criando ou abrindo um grafo de mesmo nível.</span><span class="sxs-lookup"><span data-stu-id="3b574-107">The flow of calls depends on whether you are creating or opening a peer graph.</span></span> <span data-ttu-id="3b574-108">Este tópico identifica o fluxo de chamadas de função em um aplicativo de grafo de pares simples.</span><span class="sxs-lookup"><span data-stu-id="3b574-108">This topic identifies the flow of function calls in a simple peer graph application.</span></span>

## <a name="starting-up-a-graph"></a><span data-ttu-id="3b574-109">Iniciando um grafo</span><span class="sxs-lookup"><span data-stu-id="3b574-109">Starting Up a Graph</span></span>

<span data-ttu-id="3b574-110">Antes que um aplicativo chame uma função na API de grafo de pares, [**PeerGraphStartup**](/windows/desktop/api/P2P/nf-p2p-peergraphstartup) deve ser chamado para inicializar a API de grafo de pares para um aplicativo e, em seguida, definir a versão com suporte.</span><span class="sxs-lookup"><span data-stu-id="3b574-110">Before an application calls a function in the Peer Graphing API, [**PeerGraphStartup**](/windows/desktop/api/P2P/nf-p2p-peergraphstartup) must be called to initialize the Peer Graphing API for an application, and then set the supported version.</span></span>

## <a name="creating-a-peer-graph"></a><span data-ttu-id="3b574-111">Criando um grafo de mesmo nível</span><span class="sxs-lookup"><span data-stu-id="3b574-111">Creating a Peer Graph</span></span>

<span data-ttu-id="3b574-112">O procedimento a seguir identifica o fluxo de chamadas para criar um grafo de mesmo nível.</span><span class="sxs-lookup"><span data-stu-id="3b574-112">The following procedure identifies the flow of calls for creating a peer graph.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="3b574-113">Somente um par deve chamar [**PeerGraphCreate**](/windows/desktop/api/P2P/nf-p2p-peergraphcreate).</span><span class="sxs-lookup"><span data-stu-id="3b574-113">Only one peer should call [**PeerGraphCreate**](/windows/desktop/api/P2P/nf-p2p-peergraphcreate).</span></span> <span data-ttu-id="3b574-114">Todos os outros pares devem chamar [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span><span class="sxs-lookup"><span data-stu-id="3b574-114">All other peers should call [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span></span> <span data-ttu-id="3b574-115">Várias chamadas para **PeerGraphCreate** invalidam um grafo.</span><span class="sxs-lookup"><span data-stu-id="3b574-115">Multiple calls to **PeerGraphCreate** invalidate a graph.</span></span>

 

-   <span data-ttu-id="3b574-116">Crie um grafo par.</span><span class="sxs-lookup"><span data-stu-id="3b574-116">Create a peer graph.</span></span> <span data-ttu-id="3b574-117">Chame [**PeerGraphCreate**](/windows/desktop/api/P2P/nf-p2p-peergraphcreate).</span><span class="sxs-lookup"><span data-stu-id="3b574-117">Call [**PeerGraphCreate**](/windows/desktop/api/P2P/nf-p2p-peergraphcreate).</span></span>
-   <span data-ttu-id="3b574-118">Registre-se para eventos de pares.</span><span class="sxs-lookup"><span data-stu-id="3b574-118">Register for peer events.</span></span> <span data-ttu-id="3b574-119">Chame [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span><span class="sxs-lookup"><span data-stu-id="3b574-119">Call [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span></span>
    > [!Note]  
    > <span data-ttu-id="3b574-120">Para obter mais informações sobre como registrar-se para eventos de pares, consulte [infraestrutura de eventos](peer-events-infrastructure.md).</span><span class="sxs-lookup"><span data-stu-id="3b574-120">For more information about registering for peer events, see [Events Infrastructure](peer-events-infrastructure.md).</span></span>

     

-   <span data-ttu-id="3b574-121">Ouça as conexões a um grafo par.</span><span class="sxs-lookup"><span data-stu-id="3b574-121">Listen for connections to a peer graph.</span></span> <span data-ttu-id="3b574-122">Chame [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span><span class="sxs-lookup"><span data-stu-id="3b574-122">Call [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span></span>
-   <span data-ttu-id="3b574-123">Executar funções dependentes do aplicativo para o restante do tempo de execução, por exemplo, processar eventos de mesmo nível e trabalhar com conexões.</span><span class="sxs-lookup"><span data-stu-id="3b574-123">Perform application-dependent functions for the remainder of the running time, for example, process peer events and work with connections.</span></span>
-   <span data-ttu-id="3b574-124">Feche a conexão com um grafo par.</span><span class="sxs-lookup"><span data-stu-id="3b574-124">Close the connection to a peer graph.</span></span> <span data-ttu-id="3b574-125">Chame [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span><span class="sxs-lookup"><span data-stu-id="3b574-125">Call [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span></span>

## <a name="opening-a-peer-graph"></a><span data-ttu-id="3b574-126">Abrindo um grafo par</span><span class="sxs-lookup"><span data-stu-id="3b574-126">Opening a Peer Graph</span></span>

<span data-ttu-id="3b574-127">O fluxo de chamadas de função para abrir um grafo de mesmo nível depende do valor de retorno da chamada para [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span><span class="sxs-lookup"><span data-stu-id="3b574-127">The flow of function calls to open a peer graph depends on the return value of the call to [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span></span> <span data-ttu-id="3b574-128">Os valores mais importantes são os **s \_ OK** e **\_ \_ os dados \_ de pares criados**, que são explicados nas seções a seguir deste tópico.</span><span class="sxs-lookup"><span data-stu-id="3b574-128">The most important values are **S\_OK** and **PEER\_S\_DATA\_CREATED**, which are explained in the following sections of this topic.</span></span>

> [!Note]  
> <span data-ttu-id="3b574-129">Se uma chamada para [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) não retornar os dados de pares **\_ OK** ou **iguais \_ \_ \_ criados**, manipule o erro.</span><span class="sxs-lookup"><span data-stu-id="3b574-129">If a call to [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) does not return **S\_OK** or **PEER\_S\_DATA\_CREATED**, handle the error.</span></span>

 

## <a name="when-peergraphopen-returns-s_ok"></a><span data-ttu-id="3b574-130">Quando PeerGraphOpen retorna S \_ OK</span><span class="sxs-lookup"><span data-stu-id="3b574-130">When PeerGraphOpen Returns S\_OK</span></span>

<span data-ttu-id="3b574-131">Quando uma chamada para [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) retorna **S \_ OK**, um grafo par e um banco de dados existente foram abertos.</span><span class="sxs-lookup"><span data-stu-id="3b574-131">When a call to [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) returns **S\_OK**, a peer graph and an existing database have been opened.</span></span> <span data-ttu-id="3b574-132">O procedimento a seguir identifica o que você pode fazer para abrir um grafo de mesmo nível quando uma chamada para **PeerGraphOpen** retorna **S \_ OK**</span><span class="sxs-lookup"><span data-stu-id="3b574-132">The following procedure identifies what you can do to open a peer graph when a call to **PeerGraphOpen** returns **S\_OK**</span></span>

-   <span data-ttu-id="3b574-133">Registre-se para eventos de pares.</span><span class="sxs-lookup"><span data-stu-id="3b574-133">Register for peer events.</span></span> <span data-ttu-id="3b574-134">Chame [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span><span class="sxs-lookup"><span data-stu-id="3b574-134">Call [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span></span>
    > [!Note]  
    > <span data-ttu-id="3b574-135">Para obter mais informações sobre como registrar eventos, consulte [infraestrutura de eventos](peer-events-infrastructure.md).</span><span class="sxs-lookup"><span data-stu-id="3b574-135">For more information about registering for events, see [Events Infrastructure](peer-events-infrastructure.md).</span></span>

     

-   <span data-ttu-id="3b574-136">Localize um nó.</span><span class="sxs-lookup"><span data-stu-id="3b574-136">Locate a node.</span></span> <span data-ttu-id="3b574-137">Esse é um processo executado fora da infraestrutura de grafo de pares, usando um método ou aplicativo que você identifica.</span><span class="sxs-lookup"><span data-stu-id="3b574-137">This is a process performed outside of the Peer Graphing Infrastructure, by using a method or application that you identify.</span></span> <span data-ttu-id="3b574-138">A API de grafo de pares não fornece um mecanismo específico para localizar um nó de grafo inicial ao qual se conectar.</span><span class="sxs-lookup"><span data-stu-id="3b574-138">The Peer Graphing API does not provide a specific mechanism to find an initial graph node to connect to.</span></span> <span data-ttu-id="3b574-139">Um aplicativo deve usar outro mecanismo, como a API [PNRP (Peer Name Resolution Protocol)](pnrp-namespace-provider-api.md) , para localizar o nó inicial.</span><span class="sxs-lookup"><span data-stu-id="3b574-139">An application must use another mechanism, such as the [Peer Name Resolution Protocol (PNRP)](pnrp-namespace-provider-api.md) API, to locate the initial node.</span></span>
-   <span data-ttu-id="3b574-140">Se um nó for encontrado, conecte-se a ele.</span><span class="sxs-lookup"><span data-stu-id="3b574-140">If a node is found, connect to it.</span></span> <span data-ttu-id="3b574-141">Chame [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect)e chame [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten) para escutar conexões com o grafo par.</span><span class="sxs-lookup"><span data-stu-id="3b574-141">Call [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect), then call [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten) to listen for connections to the peer graph.</span></span>
    > [!Note]  
    > <span data-ttu-id="3b574-142">Se um nó não for encontrado, não chame [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) e [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span><span class="sxs-lookup"><span data-stu-id="3b574-142">If a node is not found, do not call [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) and [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span></span>

     

-   <span data-ttu-id="3b574-143">Executar funções dependentes do aplicativo para o restante do tempo de execução, por exemplo, processar eventos de mesmo nível e trabalhar com conexões, dependendo se o nó está conectado ao grafo de mesmo nível ou não.</span><span class="sxs-lookup"><span data-stu-id="3b574-143">Perform application-dependent functions for the remainder of the running time, for example, process peer events and work with connections, depending on whether the node is connected to the peer graph or not.</span></span> <span data-ttu-id="3b574-144">Por exemplo, o aplicativo pode escolher o tempo limite ou executar periodicamente a descoberta para um nó ativo no grafo.</span><span class="sxs-lookup"><span data-stu-id="3b574-144">For example, the application can choose to timeout or periodically perform discovery for an active node in the graph.</span></span>
-   <span data-ttu-id="3b574-145">Feche a conexão com o grafo par.</span><span class="sxs-lookup"><span data-stu-id="3b574-145">Close the connection to the peer graph.</span></span> <span data-ttu-id="3b574-146">Chame [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span><span class="sxs-lookup"><span data-stu-id="3b574-146">Call [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span></span>

## <a name="when-peergraphopen-returns-peer_s_data_created"></a><span data-ttu-id="3b574-147">Quando PeerGraphOpen retorna \_ \_ os dados de pares \_ criados</span><span class="sxs-lookup"><span data-stu-id="3b574-147">When PeerGraphOpen Returns PEER\_S\_DATA\_CREATED</span></span>

<span data-ttu-id="3b574-148">Quando [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) retorna **\_ \_ os dados de pares \_ criados**, isso significa que um banco de dado existente para um grafo par não é encontrado, um novo banco de dados é criado e esta é a primeira vez que ele é aberto.</span><span class="sxs-lookup"><span data-stu-id="3b574-148">When [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) returns **PEER\_S\_DATA\_CREATED**, it means that an existing database for a peer graph is not found, a new database is created, and this is the first time it is opened.</span></span> <span data-ttu-id="3b574-149">Para usar ou escutar em um grafo par, um par deve estar conectado e sincronizado com um grafo par.</span><span class="sxs-lookup"><span data-stu-id="3b574-149">To use or listen on a peer graph, a peer must be connected to and synchronized with a peer graph.</span></span>

<span data-ttu-id="3b574-150">O procedimento a seguir identifica o que você pode fazer para abrir um grafo de mesmo nível quando uma chamada para [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) retorna **dados de pares \_ \_ \_ criados**.</span><span class="sxs-lookup"><span data-stu-id="3b574-150">The following procedure identifies what you can do to open a peer graph when a call to [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen) returns **PEER\_S\_DATA\_CREATED**.</span></span>

-   <span data-ttu-id="3b574-151">Abra um grafo par.</span><span class="sxs-lookup"><span data-stu-id="3b574-151">Open a peer graph.</span></span> <span data-ttu-id="3b574-152">Chame [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span><span class="sxs-lookup"><span data-stu-id="3b574-152">Call [**PeerGraphOpen**](/windows/desktop/api/P2P/nf-p2p-peergraphopen).</span></span>
-   <span data-ttu-id="3b574-153">Registre-se para eventos de pares.</span><span class="sxs-lookup"><span data-stu-id="3b574-153">Register for peer events.</span></span> <span data-ttu-id="3b574-154">Chame [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span><span class="sxs-lookup"><span data-stu-id="3b574-154">Call [**PeerGraphRegisterEvent**](/windows/desktop/api/P2P/nf-p2p-peergraphregisterevent).</span></span>
    > [!Note]  
    > <span data-ttu-id="3b574-155">Para obter mais informações sobre como registrar-se para eventos de pares, consulte [infraestrutura de eventos](peer-events-infrastructure.md).</span><span class="sxs-lookup"><span data-stu-id="3b574-155">For more information about registering for peer events, see [Events Infrastructure](peer-events-infrastructure.md).</span></span>

     

-   <span data-ttu-id="3b574-156">Localize um nó.</span><span class="sxs-lookup"><span data-stu-id="3b574-156">Locate a node.</span></span> <span data-ttu-id="3b574-157">Esse é um processo executado fora da infraestrutura de grafo de pares, usando um método ou aplicativo que você identifica.</span><span class="sxs-lookup"><span data-stu-id="3b574-157">This is a process performed outside of the Peer Graphing Infrastructure, by using a method or application that you identify.</span></span> <span data-ttu-id="3b574-158">A API de grafo de pares não fornece um mecanismo específico para localizar um nó de grafo inicial ao qual se conectar.</span><span class="sxs-lookup"><span data-stu-id="3b574-158">The Peer Graphing API does not provide a specific mechanism to find an initial graph node to connect to.</span></span> <span data-ttu-id="3b574-159">Um aplicativo deve usar outro mecanismo, como a API [PNRP (Peer Name Resolution Protocol)](pnrp-namespace-provider-api.md) , para localizar o nó inicial.</span><span class="sxs-lookup"><span data-stu-id="3b574-159">An application must use another mechanism, such as the [Peer Name Resolution Protocol (PNRP)](pnrp-namespace-provider-api.md) API, to locate the initial node.</span></span>
-   <span data-ttu-id="3b574-160">Se um nó for encontrado, conecte-se a ele.</span><span class="sxs-lookup"><span data-stu-id="3b574-160">If a node is found, connect to it.</span></span> <span data-ttu-id="3b574-161">Chame [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect)e chame [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten) para escutar conexões com o grafo par.</span><span class="sxs-lookup"><span data-stu-id="3b574-161">Call [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect), then call [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten) to listen for connections to the peer graph.</span></span>
    > [!Note]  
    > <span data-ttu-id="3b574-162">Se um nó não for encontrado, não chame [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) e [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span><span class="sxs-lookup"><span data-stu-id="3b574-162">If a node is not found, do not call [**PeerGraphConnect**](/windows/desktop/api/P2P/nf-p2p-peergraphconnect) and [**PeerGraphListen**](/windows/desktop/api/P2P/nf-p2p-peergraphlisten).</span></span>

     

-   <span data-ttu-id="3b574-163">Executar funções dependentes do aplicativo para o restante do tempo de execução, por exemplo, processar eventos de mesmo nível e trabalhar com conexões, dependendo se o nó está conectado ao grafo de mesmo nível ou não.</span><span class="sxs-lookup"><span data-stu-id="3b574-163">Perform application-dependent functions for the remainder of the running time, for example, process peer events and work with connections, depending on whether the node is connected to the peer graph or not.</span></span> <span data-ttu-id="3b574-164">Por exemplo, o aplicativo pode escolher o tempo limite ou executar periodicamente a descoberta para um nó ativo no grafo.</span><span class="sxs-lookup"><span data-stu-id="3b574-164">For example, the application can choose to timeout or periodically perform discovery for an active node in the graph.</span></span>
-   <span data-ttu-id="3b574-165">Feche a conexão com o grafo par.</span><span class="sxs-lookup"><span data-stu-id="3b574-165">Close the connection to the peer graph.</span></span> <span data-ttu-id="3b574-166">Chame [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span><span class="sxs-lookup"><span data-stu-id="3b574-166">Call [**PeerGraphClose**](/windows/desktop/api/P2P/nf-p2p-peergraphclose).</span></span>

 

 



