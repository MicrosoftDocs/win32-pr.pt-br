---
title: Entrada e saída de fita
description: Há várias funções que os aplicativos podem usar para executar entrada e saída (e/s) em uma unidade de fita. E/s de fita é semelhante à e/s executada em um dispositivo de comunicações.
ms.assetid: 1862c267-0070-4fe8-bb77-40167913978a
keywords:
- Backup de entrada e saída de fita
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5946659f1ad0246e37981201e4e08611b45b70b1
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104294314"
---
# <a name="tape-input-and-output"></a><span data-ttu-id="2652c-105">Entrada e saída de fita</span><span class="sxs-lookup"><span data-stu-id="2652c-105">Tape Input and Output</span></span>

<span data-ttu-id="2652c-106">Há várias funções que os aplicativos podem usar para executar entrada e saída (e/s) em uma unidade de fita.</span><span class="sxs-lookup"><span data-stu-id="2652c-106">There are several functions that applications can use to perform input and output (I/O) on a tape drive.</span></span> <span data-ttu-id="2652c-107">E/s de fita é semelhante à e/s executada em um dispositivo de comunicações.</span><span class="sxs-lookup"><span data-stu-id="2652c-107">Tape I/O is similar to I/O performed on a communications device.</span></span>

<span data-ttu-id="2652c-108">Ao executar a e/s de fita, algumas unidades de fita armazenam informações de firmware de fita nos primeiros blocos em uma fita, normalmente usando alguma parte dos primeiros 100 blocos.</span><span class="sxs-lookup"><span data-stu-id="2652c-108">When performing tape I/O, some tape drives store tape firmware information in the first few blocks on a tape, typically using some portion of the first 100 blocks.</span></span> <span data-ttu-id="2652c-109">Os aplicativos não devem usar esses blocos.</span><span class="sxs-lookup"><span data-stu-id="2652c-109">Applications should not use those blocks.</span></span> <span data-ttu-id="2652c-110">Informações mais específicas sobre esse assunto estão disponíveis em fabricantes de sistemas de fita individuais.</span><span class="sxs-lookup"><span data-stu-id="2652c-110">More specific information on this subject is available from individual tape system manufacturers.</span></span> <span data-ttu-id="2652c-111">Em geral, um aplicativo que ignora os primeiros 100 blocos em uma fita evitará idiossincrasias de unidade de fita.</span><span class="sxs-lookup"><span data-stu-id="2652c-111">In general, an application that skips the first 100 blocks on a tape will avoid tape drive idiosyncrasies.</span></span>

<span data-ttu-id="2652c-112">As funções [**GetTapePosition**](/windows/desktop/api/Winbase/nf-winbase-gettapeposition) e [**SetTapePosition**](/windows/desktop/api/Winbase/nf-winbase-settapeposition) recuperam e movem a posição da fita atual.</span><span class="sxs-lookup"><span data-stu-id="2652c-112">The [**GetTapePosition**](/windows/desktop/api/Winbase/nf-winbase-gettapeposition) and [**SetTapePosition**](/windows/desktop/api/Winbase/nf-winbase-settapeposition) functions retrieve and move the current tape position.</span></span> <span data-ttu-id="2652c-113">A função [**WriteTapemark**](/windows/desktop/api/Winbase/nf-winbase-writetapemark) grava um número especificado de marcações, marcas de gravação, marcas de gravação curtas e longas marcas de filemarcações.</span><span class="sxs-lookup"><span data-stu-id="2652c-113">The [**WriteTapemark**](/windows/desktop/api/Winbase/nf-winbase-writetapemark) function writes a specified number of setmarks, filemarks, short filemarks, and long filemarks.</span></span> <span data-ttu-id="2652c-114">A função [**EraseTape**](/windows/desktop/api/Winbase/nf-winbase-erasetape) apaga toda ou parte de uma fita.</span><span class="sxs-lookup"><span data-stu-id="2652c-114">The [**EraseTape**](/windows/desktop/api/Winbase/nf-winbase-erasetape) function erases all or part of a tape.</span></span>

<span data-ttu-id="2652c-115">As funções [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) e [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) lêem e gravam dados de arquivo de e para a fita.</span><span class="sxs-lookup"><span data-stu-id="2652c-115">The [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) functions read and write file data from and to the tape.</span></span> <span data-ttu-id="2652c-116">Os dados são lidos e gravados em blocos completos.</span><span class="sxs-lookup"><span data-stu-id="2652c-116">The data is read and written in complete blocks.</span></span> <span data-ttu-id="2652c-117">Se o tamanho do bloco da fita for 512 bytes, todas as operações de leitura e gravação deverão usar buffers que sejam múltiplos inteiros simples desse tamanho de bloco: 512, 1024, 1536, 2048 e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="2652c-117">If the tape's block size is 512 bytes, all read and write operations must use buffers that are simple integer multiples of that block size: 512, 1024, 1536, 2048, and so on.</span></span> <span data-ttu-id="2652c-118">A maioria, se não todas, as unidades só permitem uma operação de gravação depois que a fita é rebobinada ou depois que uma operação de leitura produz uma mensagem de erro de fim de dados.</span><span class="sxs-lookup"><span data-stu-id="2652c-118">Most, if not all, drives only allow a write operation after the tape is rewound or after a read operation produces an end-of-data error message.</span></span>

<span data-ttu-id="2652c-119">Para ler ou gravar dados de arquivo de ou para uma fita em modo de bloco de comprimento variável, execute as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="2652c-119">To read or write file data to or from a tape in variable-length block mode, perform the following steps:</span></span>

1.  <span data-ttu-id="2652c-120">Determine se a unidade de fita dá suporte ao modo de bloco de comprimento variável chamando a função [**Gettapeparameters**](/windows/desktop/api/Winbase/nf-winbase-gettapeparameters) e verificando o \_ \_ bit do bloco variável da unidade de fita \_ do membro **FeaturesLow** da estrutura de [**\_ obter \_ \_ parâmetros da unidade de fita**](/windows/desktop/api/Winnt/ns-winnt-tape_get_drive_parameters) retornada.</span><span class="sxs-lookup"><span data-stu-id="2652c-120">Determine whether the tape drive supports variable-length block mode by calling the [**GetTapeParameters**](/windows/desktop/api/Winbase/nf-winbase-gettapeparameters) function and checking the TAPE\_DRIVE\_VARIABLE\_BLOCK bit of the **FeaturesLow** member of the returned [**TAPE\_GET\_DRIVE\_PARAMETERS**](/windows/desktop/api/Winnt/ns-winnt-tape_get_drive_parameters) structure.</span></span>
2.  <span data-ttu-id="2652c-121">Especifique o modo de tamanho do bloco variável chamando a função [**Settapeparameters**](/windows/desktop/api/Winbase/nf-winbase-settapeparameters) , definindo o membro **BlockSize** da estrutura de parâmetros de mídia do conjunto de fitas como zero. [**\_ \_ \_**](/windows/desktop/api/Winnt/ns-winnt-tape_set_media_parameters)</span><span class="sxs-lookup"><span data-stu-id="2652c-121">Specify the variable block size mode by calling the [**SetTapeParameters**](/windows/desktop/api/Winbase/nf-winbase-settapeparameters) function, setting the **BlockSize** member of the [**TAPE\_SET\_MEDIA\_PARAMETERS**](/windows/desktop/api/Winnt/ns-winnt-tape_set_media_parameters) structure to zero.</span></span> <span data-ttu-id="2652c-122">Em seguida, use [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) ou [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) para ler ou gravar os dados do arquivo.</span><span class="sxs-lookup"><span data-stu-id="2652c-122">Then, use [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) or [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) to read or write the file data.</span></span>

<span data-ttu-id="2652c-123">Se o [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) encontrar uma marca de um, os dados até a marca de filemark serão lidos e a função falhará.</span><span class="sxs-lookup"><span data-stu-id="2652c-123">If [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) encounters a filemark, the data up to the filemark is read and the function fails.</span></span> <span data-ttu-id="2652c-124">(A função [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) retorna um código de erro que indica o tipo de marca de texto que foi encontrado.) O sistema operacional move a fita além da marca de caixa de mensagem e um aplicativo pode chamar **ReadFile** novamente para continuar lendo.</span><span class="sxs-lookup"><span data-stu-id="2652c-124">(The [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) function returns an error code indicating the type of filemark that was encountered.) The operating system moves the tape past the filemark, and an application can call **ReadFile** again to continue reading.</span></span>

<span data-ttu-id="2652c-125">[**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) e [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) lêem e gravam apenas o fluxo de dados.</span><span class="sxs-lookup"><span data-stu-id="2652c-125">[**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) read and write only the data stream.</span></span> <span data-ttu-id="2652c-126">As funções [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) e [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite) lêem e gravam todos os fluxos associados a um arquivo.</span><span class="sxs-lookup"><span data-stu-id="2652c-126">The [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) and [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite) functions read and write all the streams associated with a file.</span></span> <span data-ttu-id="2652c-127">Isso inclui dados, atributos estendidos, segurança e fluxos de dados alternativos.</span><span class="sxs-lookup"><span data-stu-id="2652c-127">These include data, extended attributes, security, and alternative data streams.</span></span> <span data-ttu-id="2652c-128">Os fluxos de dados de segurança e alternativos são relevantes apenas na partição do sistema de arquivos NTFS.</span><span class="sxs-lookup"><span data-stu-id="2652c-128">The security and alternate data streams are relevant only on the NTFS file system partition.</span></span>

<span data-ttu-id="2652c-129">A função [**BackupSeek**](/windows/desktop/api/Winbase/nf-winbase-backupseek) busca adiante em um arquivo inicialmente acessado por [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) ou [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite).</span><span class="sxs-lookup"><span data-stu-id="2652c-129">The [**BackupSeek**](/windows/desktop/api/Winbase/nf-winbase-backupseek) function seeks forward in a file initially accessed by [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) or [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite).</span></span> <span data-ttu-id="2652c-130">Essa função permite que um aplicativo ignore informações que causam erros de acesso.</span><span class="sxs-lookup"><span data-stu-id="2652c-130">This function enables an application to skip information that causes access errors.</span></span>

<span data-ttu-id="2652c-131">Se um aplicativo precisar acessar apenas os dados do arquivo, ele deverá usar [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) e [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile).</span><span class="sxs-lookup"><span data-stu-id="2652c-131">If an application needs to access only the file data, it should use [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile).</span></span> <span data-ttu-id="2652c-132">Essas funções também podem ler fluxos de dados alternativos se os fluxos foram criados usando a função [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) .</span><span class="sxs-lookup"><span data-stu-id="2652c-132">These functions can also read alternative data streams if the streams were created by using the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function.</span></span>

<span data-ttu-id="2652c-133">Um aplicativo de backup em fita deve usar [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) e [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite) para copiar todas as informações pertencentes a um arquivo.</span><span class="sxs-lookup"><span data-stu-id="2652c-133">A tape-backup application must use [**BackupRead**](/windows/desktop/api/Winbase/nf-winbase-backupread) and [**BackupWrite**](/windows/desktop/api/Winbase/nf-winbase-backupwrite) to copy all information pertaining to a file.</span></span> <span data-ttu-id="2652c-134">No entanto, essas funções não lêem ou gravam características do arquivo, como atributos, hora de criação do arquivo e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="2652c-134">However, these functions do not read or write file characteristics such as attributes, file creation time, and so on.</span></span> <span data-ttu-id="2652c-135">Os aplicativos devem usar as funções de entrada e saída de arquivo, como [**GetFileAttributes**](/windows/desktop/api/fileapi/nf-fileapi-getfileattributesa) e [**SetFileAttributes**](/windows/desktop/api/fileapi/nf-fileapi-setfileattributesa), para recuperar e definir esses valores.</span><span class="sxs-lookup"><span data-stu-id="2652c-135">Applications must use the file input and output functions, such as [**GetFileAttributes**](/windows/desktop/api/fileapi/nf-fileapi-getfileattributesa) and [**SetFileAttributes**](/windows/desktop/api/fileapi/nf-fileapi-setfileattributesa), to retrieve and set those values.</span></span>

 

 