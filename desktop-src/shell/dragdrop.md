---
description: Muitos aplicativos permitem que os usuários transfiram dados para outro aplicativo arrastando e soltando os dados com o mouse, ou usando a área de transferência.
title: Transferindo objetos do shell com o recurso de arrastar e soltar e a área de transferência
ms.topic: article
ms.date: 05/31/2018
ms.assetid: bd73098b-2f69-48a4-bb06-e1e0a452e69d
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: b04523d0ae22eac7bef68f37a6d22ac94b21e303
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104967949"
---
# <a name="transferring-shell-objects-with-drag-and-drop-and-the-clipboard"></a><span data-ttu-id="96315-103">Transferindo objetos do shell com o recurso de arrastar e soltar e a área de transferência</span><span class="sxs-lookup"><span data-stu-id="96315-103">Transferring Shell Objects with Drag-and-Drop and the Clipboard</span></span>

<span data-ttu-id="96315-104">Muitos aplicativos permitem que os usuários transfiram dados para outro aplicativo arrastando e soltando os dados com o mouse, ou usando a área de transferência.</span><span class="sxs-lookup"><span data-stu-id="96315-104">Many applications allow users to transfer data to another application by dragging and dropping the data with the mouse, or by using the Clipboard.</span></span> <span data-ttu-id="96315-105">Entre os muitos tipos de dados que podem ser transferidos estão objetos do Shell, como arquivos ou pastas.</span><span class="sxs-lookup"><span data-stu-id="96315-105">Among the many types of data that can be transferred are Shell objects such as files or folders.</span></span> <span data-ttu-id="96315-106">A transferência de dados do shell pode ocorrer entre dois aplicativos, mas os usuários também podem transferir dados do Shell de ou para o desktop ou o Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="96315-106">Shell data transfer can take place between two applications, but users can also transfer Shell data to or from the desktop or Windows Explorer.</span></span>

<span data-ttu-id="96315-107">Embora os arquivos sejam o objeto Shell mais transferido, a transferência de dados do shell pode envolver qualquer variedade de objetos encontrados no [namespace do Shell](namespace-intro.md).</span><span class="sxs-lookup"><span data-stu-id="96315-107">Although files are the most commonly transferred Shell object, Shell data transfer can involve any of the variety of objects found in the [Shell namespace](namespace-intro.md).</span></span> <span data-ttu-id="96315-108">Por exemplo, seu aplicativo pode precisar transferir um arquivo para uma pasta virtual, como a lixeira, ou aceitar um objeto de uma extensão de namespace que não seja da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="96315-108">For instance, your application might need to transfer a file to a virtual folder such as the Recycle Bin, or accept an object from a non-Microsoft namespace extension.</span></span> <span data-ttu-id="96315-109">Se você estiver implementando uma extensão de namespace, ela deverá ser capaz de se comportar corretamente como uma origem e um destino de soltura.</span><span class="sxs-lookup"><span data-stu-id="96315-109">If you are implementing a namespace extension, it must be able to behave properly as a drop source and target.</span></span>

<span data-ttu-id="96315-110">Este documento discute como os aplicativos podem implementar transferências de dados de arrastar e soltar e de área de transferência com objetos do Shell.</span><span class="sxs-lookup"><span data-stu-id="96315-110">This document discusses how applications can implement drag-and-drop and Clipboard data transfers with Shell objects.</span></span>

-   [<span data-ttu-id="96315-111">O objeto de dados do Shell</span><span class="sxs-lookup"><span data-stu-id="96315-111">The Shell Data Object</span></span>](dataobject.md)
-   [<span data-ttu-id="96315-112">Formatos de área de transferência do Shell</span><span class="sxs-lookup"><span data-stu-id="96315-112">Shell Clipboard Formats</span></span>](clipboard.md)
-   [<span data-ttu-id="96315-113">Manipulação de cenários de Transferência de Dados do Shell</span><span class="sxs-lookup"><span data-stu-id="96315-113">Handling Shell Data Transfer Scenarios</span></span>](datascenarios.md)

## <a name="how-drag-and-drop-works-with-shell-objects"></a><span data-ttu-id="96315-114">Como o recurso de arrastar e soltar funciona com objetos shell</span><span class="sxs-lookup"><span data-stu-id="96315-114">How Drag-and-Drop Works with Shell Objects</span></span>

<span data-ttu-id="96315-115">Geralmente, os aplicativos precisam fornecer aos usuários uma maneira de transferir dados do Shell.</span><span class="sxs-lookup"><span data-stu-id="96315-115">Applications often need to provide users with a way to transfer Shell data.</span></span> <span data-ttu-id="96315-116">Alguns exemplos incluem:</span><span class="sxs-lookup"><span data-stu-id="96315-116">Some examples are:</span></span>

-   <span data-ttu-id="96315-117">Arrastar um arquivo do Windows Explorer ou da área de trabalho e soltá-lo em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="96315-117">Dragging a file from Windows Explorer or the desktop and dropping it on an application.</span></span>
-   <span data-ttu-id="96315-118">Copiar um arquivo para a área de transferência no Windows Explorer e colá-lo em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="96315-118">Copying a file to the Clipboard in Windows Explorer and pasting it into an application.</span></span>
-   <span data-ttu-id="96315-119">Arrastando um arquivo de um aplicativo para a lixeira.</span><span class="sxs-lookup"><span data-stu-id="96315-119">Dragging a file from an application to the Recycle Bin.</span></span>

<span data-ttu-id="96315-120">Para obter uma discussão detalhada sobre como lidar com esses e outros cenários, consulte [manipulando cenários de transferência de dados do Shell](datascenarios.md).</span><span class="sxs-lookup"><span data-stu-id="96315-120">For a detailed discussion of how to handle these and other scenarios, see [Handling Shell Data Transfer Scenarios](datascenarios.md).</span></span> <span data-ttu-id="96315-121">Este documento enfoca os princípios gerais por trás da transferência de dados do Shell.</span><span class="sxs-lookup"><span data-stu-id="96315-121">This document focuses on the general principles behind Shell data transfer.</span></span>

<span data-ttu-id="96315-122">O Windows fornece duas maneiras padrão para os aplicativos transferirem dados do Shell:</span><span class="sxs-lookup"><span data-stu-id="96315-122">Windows provides two standard ways for applications to transfer Shell data:</span></span>

-   <span data-ttu-id="96315-123">Um usuário recorta ou copia dados do Shell, como um ou mais arquivos, para a área de transferência.</span><span class="sxs-lookup"><span data-stu-id="96315-123">A user cuts or copies Shell data, such as one or more files, to the Clipboard.</span></span> <span data-ttu-id="96315-124">O outro aplicativo recupera os dados da área de transferência.</span><span class="sxs-lookup"><span data-stu-id="96315-124">The other application retrieves the data from the Clipboard.</span></span>
-   <span data-ttu-id="96315-125">Um usuário arrasta um ícone que representa os dados do aplicativo de origem e descarta o ícone em uma janela de Propriedade do destino.</span><span class="sxs-lookup"><span data-stu-id="96315-125">A user drags an icon that represents the data from the source application and drops the icon on a window owned by the target.</span></span>

<span data-ttu-id="96315-126">Em ambos os casos, os dados transferidos estão contidos em um *objeto de dados*.</span><span class="sxs-lookup"><span data-stu-id="96315-126">In both cases, the transferred data is contained in a *data object*.</span></span> <span data-ttu-id="96315-127">Os objetos de dados são objetos Component Object Model (COM) que expõem a interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) .</span><span class="sxs-lookup"><span data-stu-id="96315-127">Data objects are Component Object Model (COM) objects that expose the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="96315-128">Esquemáticomente, há três etapas essenciais que todas as transferências de dados do Shell devem seguir:</span><span class="sxs-lookup"><span data-stu-id="96315-128">Schematically, there are three essential steps that all Shell data transfers must follow:</span></span>

1.  <span data-ttu-id="96315-129">A origem cria um objeto de dados que representa os dados a serem transferidos.</span><span class="sxs-lookup"><span data-stu-id="96315-129">The source creates a data object that represents the data that is to be transferred.</span></span>
2.  <span data-ttu-id="96315-130">O destino recebe um ponteiro para a interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) do objeto de dados.</span><span class="sxs-lookup"><span data-stu-id="96315-130">The target receives a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
3.  <span data-ttu-id="96315-131">O destino chama a interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) para extrair os dados dela.</span><span class="sxs-lookup"><span data-stu-id="96315-131">The target calls the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface to extract the data from it.</span></span>

<span data-ttu-id="96315-132">A diferença entre transferências de dados de área de transferência e arrastar e soltar depende principalmente de como o ponteiro [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) é transferido da origem para o destino.</span><span class="sxs-lookup"><span data-stu-id="96315-132">The difference between Clipboard and drag-and-drop data transfers lies primarily in how the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) pointer is transferred from the source to the target.</span></span>

### <a name="clipboard-data-transfers"></a><span data-ttu-id="96315-133">Transferências de dados da área de transferência</span><span class="sxs-lookup"><span data-stu-id="96315-133">Clipboard Data Transfers</span></span>

<span data-ttu-id="96315-134">A área de transferência é a maneira mais simples de transferir dados do Shell.</span><span class="sxs-lookup"><span data-stu-id="96315-134">The Clipboard is the simplest way to transfer Shell data.</span></span> <span data-ttu-id="96315-135">O procedimento básico é semelhante a transferências de dados da área de transferência padrão.</span><span class="sxs-lookup"><span data-stu-id="96315-135">The basic procedure is similar to standard Clipboard data transfers.</span></span> <span data-ttu-id="96315-136">No entanto, como você está transferindo um ponteiro para um objeto de dados, não os dados em si, deve usar a API da área de transferência OLE em vez da API da área de transferência padrão.</span><span class="sxs-lookup"><span data-stu-id="96315-136">However, because you are transferring a pointer to a data object, not the data itself, you must use the OLE clipboard API instead of the standard clipboard API.</span></span> <span data-ttu-id="96315-137">O procedimento a seguir descreve como usar a API de área de transferência OLE para transferir dados do shell com a área de transferência:</span><span class="sxs-lookup"><span data-stu-id="96315-137">The following procedure outlines how to use the OLE clipboard API to transfer Shell data with the Clipboard:</span></span>

1.  <span data-ttu-id="96315-138">A fonte de dados cria um objeto de dados para conter os dados.</span><span class="sxs-lookup"><span data-stu-id="96315-138">The data source creates a data object to contain the data.</span></span>
2.  <span data-ttu-id="96315-139">A fonte de dados chama [**OleSetClipboard**](/windows/win32/api/ole2/nf-ole2-olesetclipboard), que coloca um ponteiro para a interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) do objeto de dados na área de transferência.</span><span class="sxs-lookup"><span data-stu-id="96315-139">The data source calls [**OleSetClipboard**](/windows/win32/api/ole2/nf-ole2-olesetclipboard), which places a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface on the Clipboard.</span></span>
3.  <span data-ttu-id="96315-140">O destino chama [**OleGetClipboard**](/windows/win32/api/ole2/nf-ole2-olegetclipboard) para recuperar o ponteiro para a interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) do objeto de dados.</span><span class="sxs-lookup"><span data-stu-id="96315-140">The target calls [**OleGetClipboard**](/windows/win32/api/ole2/nf-ole2-olegetclipboard) to retrieve the pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
4.  <span data-ttu-id="96315-141">O destino extrai os dados chamando o método [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) .</span><span class="sxs-lookup"><span data-stu-id="96315-141">The target extracts the data by calling the [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method.</span></span>
5.  <span data-ttu-id="96315-142">Com algumas transferências de dados do Shell, o destino também pode precisar chamar o método [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) do objeto de dados para fornecer comentários ao objeto de dados no resultado da transferência de dados.</span><span class="sxs-lookup"><span data-stu-id="96315-142">With some Shell data transfers, the target might also need to call the data object's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method to provide feedback to the data object on the outcome of the data transfer.</span></span> <span data-ttu-id="96315-143">Consulte [lidando com operações de movimentação otimizadas](datascenarios.md) para obter um exemplo desse tipo de operação.</span><span class="sxs-lookup"><span data-stu-id="96315-143">See [Handling Optimized Move Operations](datascenarios.md) for an example of this type of operation.</span></span>

### <a name="drag-and-drop-data-transfers"></a><span data-ttu-id="96315-144">Transferências de dados do tipo "arrastar e soltar"</span><span class="sxs-lookup"><span data-stu-id="96315-144">Drag-and-Drop Data Transfers</span></span>

<span data-ttu-id="96315-145">Embora seja um pouco mais complexo de implementar, a transferência de dados de arrastar e soltar tem algumas vantagens significativas na área de transferência:</span><span class="sxs-lookup"><span data-stu-id="96315-145">While somewhat more complex to implement, drag-and-drop data transfer has some significant advantages over the Clipboard:</span></span>

-   <span data-ttu-id="96315-146">Transferências de arrastar e soltar podem ser feitas com um simples movimento de mouse, tornando a operação mais flexível e intuitiva para uso do que a área de transferência.</span><span class="sxs-lookup"><span data-stu-id="96315-146">Drag-and-drop transfers can be done with a simple mouse movement, making operation more flexible and intuitive to use than the Clipboard.</span></span>
-   <span data-ttu-id="96315-147">O recurso arrastar e soltar fornece ao usuário uma representação visual da operação.</span><span class="sxs-lookup"><span data-stu-id="96315-147">Drag-and-drop provides the user with a visual representation of the operation.</span></span> <span data-ttu-id="96315-148">O usuário pode seguir o ícone à medida que ele se move da origem para o destino.</span><span class="sxs-lookup"><span data-stu-id="96315-148">The user can follow the icon as it moves from source to target.</span></span>
-   <span data-ttu-id="96315-149">O recurso de arrastar e soltar notifica o destino quando os dados estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="96315-149">Drag-and-drop notifies the target when the data is available.</span></span>

<span data-ttu-id="96315-150">As operações de arrastar e soltar também usam objetos de dados para transferir dados.</span><span class="sxs-lookup"><span data-stu-id="96315-150">Drag-and-drop operations also use data objects to transfer data.</span></span> <span data-ttu-id="96315-151">No entanto, a origem do descarte deve fornecer funcionalidade além da necessária para transferências da área de transferência:</span><span class="sxs-lookup"><span data-stu-id="96315-151">However, the drop source must provide functionality beyond that required for Clipboard transfers:</span></span>

-   <span data-ttu-id="96315-152">A origem de soltura também deve criar um objeto que expõe uma interface [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) .</span><span class="sxs-lookup"><span data-stu-id="96315-152">The drop source must also create an object that exposes an [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) interface.</span></span> <span data-ttu-id="96315-153">O sistema usa **IDropSource** para se comunicar com a origem enquanto a operação está em andamento.</span><span class="sxs-lookup"><span data-stu-id="96315-153">The system uses **IDropSource** to communicate with the source while the operation is in progress.</span></span>
-   <span data-ttu-id="96315-154">O objeto de dados do tipo "arrastar e soltar" é responsável por acompanhar o movimento do cursor e exibir um ícone para representar o objeto de dados.</span><span class="sxs-lookup"><span data-stu-id="96315-154">The drag-and-drop data object is responsible for tracking cursor movement and displaying an icon to represent the data object.</span></span>

<span data-ttu-id="96315-155">Os destinos de destino também devem fornecer mais funcionalidade do que o necessário para lidar com transferências de área de transferência:</span><span class="sxs-lookup"><span data-stu-id="96315-155">Drop targets must also provide more functionality than is needed to handle Clipboard transfers:</span></span>

-   <span data-ttu-id="96315-156">O destino de soltura deve expor uma interface [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) .</span><span class="sxs-lookup"><span data-stu-id="96315-156">The drop target must expose an [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span> <span data-ttu-id="96315-157">Quando o cursor está sobre uma janela de destino, o sistema usa **IDropTarget** para fornecer o destino com informações como a posição do cursor e notificá-lo quando os dados são descartados.</span><span class="sxs-lookup"><span data-stu-id="96315-157">When the cursor is over a target window, the system uses **IDropTarget** to provide the target with information such as the cursor position, and to notify it when the data is dropped.</span></span>
-   <span data-ttu-id="96315-158">O destino de soltura deve se registrar no sistema chamando [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop).</span><span class="sxs-lookup"><span data-stu-id="96315-158">The drop target must register itself with the system by calling [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop).</span></span> <span data-ttu-id="96315-159">Essa função fornece ao sistema o identificador para uma janela de destino e um ponteiro para a interface [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) do aplicativo de destino.</span><span class="sxs-lookup"><span data-stu-id="96315-159">This function provides the system with the handle to a target window and a pointer to the target application's [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span>

> [!Note]  
> <span data-ttu-id="96315-160">Para operações de arrastar e soltar, seu aplicativo deve inicializar com com [**OleInitialize**](/windows/win32/api/ole2/nf-ole2-oleinitialize), não [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize).</span><span class="sxs-lookup"><span data-stu-id="96315-160">For drag-and-drop operations, your application must initialize COM with [**OleInitialize**](/windows/win32/api/ole2/nf-ole2-oleinitialize), not [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize).</span></span>

 

<span data-ttu-id="96315-161">O procedimento a seguir descreve as etapas essenciais que normalmente são usadas para transferir dados do shell com o recurso de arrastar e soltar:</span><span class="sxs-lookup"><span data-stu-id="96315-161">The following procedure outlines the essential steps that are typically used to transfer Shell data with drag-and-drop:</span></span>

1.  <span data-ttu-id="96315-162">O destino chama [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop) para dar ao sistema um ponteiro para sua interface [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) e registrar uma janela como um destino de soltar.</span><span class="sxs-lookup"><span data-stu-id="96315-162">The target calls [**RegisterDragDrop**](/windows/win32/api/ole2/nf-ole2-registerdragdrop) to give the system a pointer to its [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface and register a window as a drop target.</span></span>
2.  <span data-ttu-id="96315-163">Quando o usuário inicia uma operação de arrastar e soltar, a origem cria um objeto de dados e inicia um *loop de arrastar* chamando [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop).</span><span class="sxs-lookup"><span data-stu-id="96315-163">When the user starts a drag-and-drop operation, the source creates a data object and initiates a *drag loop* by calling [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop).</span></span>
3.  <span data-ttu-id="96315-164">Quando o cursor está sobre a janela de destino, o sistema notifica o destino chamando um dos métodos [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) do destino.</span><span class="sxs-lookup"><span data-stu-id="96315-164">When the cursor is over the target window, the system notifies the target by calling one of the target's [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) methods.</span></span> <span data-ttu-id="96315-165">O sistema chama [**IDropTarget::D ragenter**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragenter) quando o cursor entra na janela de destino e [**IDropTarget::D ragover**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) como o cursor passa pela janela de destino.</span><span class="sxs-lookup"><span data-stu-id="96315-165">The system calls [**IDropTarget::DragEnter**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragenter) when the cursor enters the target window, and [**IDropTarget::DragOver**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) as the cursor passes over the target window.</span></span> <span data-ttu-id="96315-166">Os dois métodos fornecem o destino de soltura com a posição atual do cursor e o estado das teclas modificadoras de teclado, como CTRL ou ALT.</span><span class="sxs-lookup"><span data-stu-id="96315-166">Both methods provide the drop target with the current cursor position and the state of keyboard modifier keys such as CTRL or ALT.</span></span> <span data-ttu-id="96315-167">Quando o cursor sai da janela de destino, o sistema notifica o destino chamando [**IDropTarget::D ragleave**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragleave).</span><span class="sxs-lookup"><span data-stu-id="96315-167">When the cursor leaves the target window, the system notifies the target by calling [**IDropTarget::DragLeave**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragleave).</span></span> <span data-ttu-id="96315-168">Quando qualquer um desses métodos retorna, o sistema chama a interface [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) para passar o valor de retorno para a origem.</span><span class="sxs-lookup"><span data-stu-id="96315-168">When any of these methods return, the system calls the [**IDropSource**](/windows/win32/api/oleidl/nn-oleidl-idropsource) interface to pass the return value to the source.</span></span>
4.  <span data-ttu-id="96315-169">Quando o usuário libera o botão do mouse para descartar os dados, o sistema chama o método [**IDropTarget::D ROP**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop) do destino.</span><span class="sxs-lookup"><span data-stu-id="96315-169">When the user releases the mouse button to drop the data, the system calls the target's [**IDropTarget::Drop**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop) method.</span></span> <span data-ttu-id="96315-170">Entre os parâmetros do método está um ponteiro para a interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) do objeto de dados.</span><span class="sxs-lookup"><span data-stu-id="96315-170">Among the method's parameters is a pointer to the data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span>
5.  <span data-ttu-id="96315-171">O destino chama o método [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) do objeto de dados para extrair os dados.</span><span class="sxs-lookup"><span data-stu-id="96315-171">The target calls the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method to extract the data.</span></span>
6.  <span data-ttu-id="96315-172">Com algumas transferências de dados do Shell, o destino também pode precisar chamar o método [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) do objeto de dados para fornecer comentários à fonte no resultado da transferência de dados.</span><span class="sxs-lookup"><span data-stu-id="96315-172">With some Shell data transfers, the target might also need to call the data object's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method to provide feedback to the source on the outcome of the data transfer.</span></span>
7.  <span data-ttu-id="96315-173">Quando o destino é concluído com o objeto de dados, ele retorna de [**IDropTarget::D ROP**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop).</span><span class="sxs-lookup"><span data-stu-id="96315-173">When the target is finished with the data object, it returns from [**IDropTarget::Drop**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-drop).</span></span> <span data-ttu-id="96315-174">O sistema retorna a chamada [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) da origem para notificar a origem de que a transferência de dados foi concluída.</span><span class="sxs-lookup"><span data-stu-id="96315-174">The system returns the source's [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) call to notify the source that the data transfer is complete.</span></span>
8.  <span data-ttu-id="96315-175">Dependendo do [cenário de transferência de dados](datascenarios.md)específico, a origem pode precisar executar uma ação adicional com base no valor retornado por [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) e os valores que são passados para o objeto de dados pelo destino.</span><span class="sxs-lookup"><span data-stu-id="96315-175">Depending on the particular [data transfer scenario](datascenarios.md), the source might need to take additional action based on the value returned by [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) and the values that are passed to the data object by the target.</span></span> <span data-ttu-id="96315-176">Por exemplo, quando um arquivo é movido, a origem deve verificar esses valores para determinar se ele deve excluir o arquivo original.</span><span class="sxs-lookup"><span data-stu-id="96315-176">For instance, when a file is moved, the source must check these values to determine whether it must delete the original file.</span></span>
9.  <span data-ttu-id="96315-177">A origem libera o objeto de dados.</span><span class="sxs-lookup"><span data-stu-id="96315-177">The source releases the data object.</span></span>

<span data-ttu-id="96315-178">Embora os procedimentos descritos acima forneçam um bom modelo geral para transferência de dados do Shell, há muitos tipos diferentes de dados que podem estar contidos em um objeto de dados do Shell.</span><span class="sxs-lookup"><span data-stu-id="96315-178">While the procedures outlined above provide a good general model for Shell data transfer, there are many different types of data that can be contained in a Shell data object.</span></span> <span data-ttu-id="96315-179">Também há vários cenários de transferência de dados diferentes que seu aplicativo pode precisar manipular.</span><span class="sxs-lookup"><span data-stu-id="96315-179">There are also a number of different data transfer scenarios that your application might need to handle.</span></span> <span data-ttu-id="96315-180">Cada tipo de dados e cenário requer uma abordagem um pouco diferente para três etapas principais no procedimento:</span><span class="sxs-lookup"><span data-stu-id="96315-180">Each data type and scenario requires a somewhat different approach to three key steps in the procedure:</span></span>

-   <span data-ttu-id="96315-181">Como uma fonte constrói um objeto de dados para conter os dados do Shell.</span><span class="sxs-lookup"><span data-stu-id="96315-181">How a source constructs a data object to contain the Shell data.</span></span>
-   <span data-ttu-id="96315-182">Como um destino extrai dados do shell do objeto de dados.</span><span class="sxs-lookup"><span data-stu-id="96315-182">How a target extracts Shell data from the data object.</span></span>
-   <span data-ttu-id="96315-183">Como a origem conclui a operação de transferência de dados.</span><span class="sxs-lookup"><span data-stu-id="96315-183">How the source completes the data transfer operation.</span></span>

<span data-ttu-id="96315-184">O [objeto de dados do Shell](dataobject.md) fornece uma discussão geral de como uma fonte constrói um objeto de dados do Shell e como esse objeto de dados pode ser tratado pelo destino.</span><span class="sxs-lookup"><span data-stu-id="96315-184">The [Shell Data Object](dataobject.md) provides a general discussion of how a source constructs a Shell data object, and how that data object can be handled by the target.</span></span> <span data-ttu-id="96315-185">O [tratamento de cenários de transferência de dados de shell](datascenarios.md) aborda em detalhes como lidar com vários cenários comuns de transferência de dados do Shell.</span><span class="sxs-lookup"><span data-stu-id="96315-185">[Handling Shell Data Transfer Scenarios](datascenarios.md) discusses in detail how to handle a number of common Shell data transfer scenarios.</span></span>

 

 
