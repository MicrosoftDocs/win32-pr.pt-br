---
description: A função de retorno de chamada CPlApplet processa todas as mensagens enviadas a um item do painel de controle pelo Windows. As mensagens enviadas para a função estão em uma ordem específica. Pelo mesmo token, o item. cpl requer que as mensagens sejam processadas de uma maneira específica.
ms.assetid: 70302698-f9d5-4de4-a662-4815002eea52
title: Processamento de mensagens do painel de controle
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0b8b43c6e265030279a6644547f41e3630208325
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103922272"
---
# <a name="control-panel-message-processing"></a><span data-ttu-id="0ccc3-105">Processamento de mensagens do painel de controle</span><span class="sxs-lookup"><span data-stu-id="0ccc3-105">Control Panel Message Processing</span></span>

<span data-ttu-id="0ccc3-106">A função de retorno de chamada [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) processa todas as mensagens enviadas a um item do painel de controle pelo Windows.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-106">The [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) callback function processes all messages sent to a Control Panel item by Windows.</span></span> <span data-ttu-id="0ccc3-107">As mensagens enviadas para a função estão em uma ordem específica.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-107">Messages sent to the function are in a specific order.</span></span> <span data-ttu-id="0ccc3-108">Pelo mesmo token, o item. cpl requer que as mensagens sejam processadas de uma maneira específica.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-108">By the same token, the .cpl item requires the messages to be processed in a specific way.</span></span>

<span data-ttu-id="0ccc3-109">Primeiro, a função [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) recebe a \_ mensagem CPL init quando o Windows carrega o item do painel de controle pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-109">First, the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function receives the CPL\_INIT message when Windows first loads the Control Panel item.</span></span> <span data-ttu-id="0ccc3-110">A função deve executar qualquer inicialização, como alocar memória e retornar diferente de zero.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-110">The function should carry out any initialization, such as allocating memory, and return nonzero.</span></span> <span data-ttu-id="0ccc3-111">Se **CPlApplet** não puder concluir a inicialização, ela deverá retornar zero, direcionando o Windows para encerrar a comunicação e liberar a dll.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-111">If **CPlApplet** cannot complete the initialization, it must return zero, directing Windows to terminate communication and release the DLL.</span></span>

<span data-ttu-id="0ccc3-112">Em seguida, se a mensagem de inicialização de CPL for \_ bem-sucedida, o Windows enviará a \_ mensagem CPL GetCount.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-112">Next, if the CPL\_INIT message succeeded, Windows sends the CPL\_GETCOUNT message.</span></span> <span data-ttu-id="0ccc3-113">A função deve retornar o número de itens do painel de controle com suporte pelo arquivo. dll.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-113">The function must then return the number of Control Panel items supported by the .dll file.</span></span>

<span data-ttu-id="0ccc3-114">A função [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) recebe uma mensagem CPL \_ inquire e uma \_ mensagem CPL NEWINQUIRE para cada item do painel de controle suportado pelo arquivo. dll.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-114">The [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function then receives one CPL\_INQUIRE message and one CPL\_NEWINQUIRE message for each Control Panel item supported by the .dll file.</span></span> <span data-ttu-id="0ccc3-115">A função preenche uma estrutura [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) ou [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) com informações sobre o item, como seu nome, ícone e uma cadeia de caracteres descritiva.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-115">The function fills in a [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure with information about your item, such as its name, icon, and a descriptive string.</span></span> <span data-ttu-id="0ccc3-116">A maioria dos aplicativos deve processar a \_ mensagem de consulta cpl e ignorar a \_ mensagem CPL NEWINQUIRE.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-116">Most applications should process the CPL\_INQUIRE message and ignore the CPL\_NEWINQUIRE message.</span></span> <span data-ttu-id="0ccc3-117">A \_ mensagem CPL inquire fornece informações em um formato que o Windows pode armazenar em cache, o que resulta em um desempenho muito melhor.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-117">The CPL\_INQUIRE message provides information in a form that Windows can cache, which results in much better performance.</span></span> <span data-ttu-id="0ccc3-118">A \_ mensagem CPL NEWINQUIRE será usada somente se você precisar alterar o ícone do item ou exibir cadeias de caracteres com base no estado do computador.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-118">The CPL\_NEWINQUIRE message is used only if you need to change your item's icon or display strings based on the state of the computer.</span></span> <span data-ttu-id="0ccc3-119">Os itens do painel de controle que usam CPL \_ NEWINQUIRE não podem ser encontrados por uma pesquisa de menu **Iniciar** no Windows Vista porque ele depende do cache.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-119">Control Panel items that use CPL\_NEWINQUIRE cannot be found by a **Start** menu search in Windows Vista because it relies on caching.</span></span>

<span data-ttu-id="0ccc3-120">A função [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) em seguida recebe uma \_ mensagem CPL DBLCLK como uma notificação de que o usuário escolheu o ícone que representa o item do painel de controle.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-120">The [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function next receives a CPL\_DBLCLK message as a notification that the user has chosen the icon that represents the Control Panel item.</span></span> <span data-ttu-id="0ccc3-121">A função pode receber essa mensagem várias vezes.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-121">The function might receive this message any number of times.</span></span> <span data-ttu-id="0ccc3-122">A mensagem inclui o identificador de item e o ponteiro **lpData** retornado na estrutura [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) ou [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) na chamada para [**CPL \_ inquire**](cpl-inquire.md) ou [**CPL \_ NEWINQUIRE**](cpl-newinquire.md).</span><span class="sxs-lookup"><span data-stu-id="0ccc3-122">The message includes the item identifier and the **lpData** pointer returned in the [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure in the call to [**CPL\_INQUIRE**](cpl-inquire.md) or [**CPL\_NEWINQUIRE**](cpl-newinquire.md).</span></span> <span data-ttu-id="0ccc3-123">A função deve exibir a caixa de diálogo correspondente e processar a entrada do usuário subsequente.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-123">The function should display the corresponding dialog box and process subsequent user input.</span></span>

<span data-ttu-id="0ccc3-124">Além de CPL \_ DBLCLK, a \_ mensagem CPL STARTWPARMS pode ser enviada se um item do painel de controle for invocado com parâmetros de entrada, como de um prompt de comando ou de outro programa.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-124">Besides CPL\_DBLCLK, the CPL\_STARTWPARMS message can be sent if a Control Panel item is invoked with input parameters, such as from a command prompt or from another program.</span></span> <span data-ttu-id="0ccc3-125">A mensagem inclui o identificador de item junto com a cadeia de caracteres de parâmetro adicional.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-125">The message includes the item identifier along with the additional parameter string.</span></span>

<span data-ttu-id="0ccc3-126">Antes de o aplicativo de controle ser encerrado, o [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) recebe a mensagem de parada de CPL \_ uma vez para cada item do painel de controle suportado pelo arquivo. dll.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-126">Before the controlling application terminates, [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) receives the CPL\_STOP message once for each Control Panel item supported by the .dll file.</span></span> <span data-ttu-id="0ccc3-127">A mensagem inclui o identificador para o item do painel de controle e o ponteiro **lpData** retornado na estrutura [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) ou [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) na chamada para [**CPL \_ inquire**](cpl-inquire.md) ou [**CPL \_ NEWINQUIRE**](cpl-newinquire.md).</span><span class="sxs-lookup"><span data-stu-id="0ccc3-127">The message includes the identifier for the Control Panel item and the **lpData** pointer returned in the [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure in the call to [**CPL\_INQUIRE**](cpl-inquire.md) or [**CPL\_NEWINQUIRE**](cpl-newinquire.md).</span></span> <span data-ttu-id="0ccc3-128">A função deve liberar qualquer memória alocada para a caixa de diálogo especificada.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-128">The function should free any memory that it allocated for the specified dialog box.</span></span>

<span data-ttu-id="0ccc3-129">Após a última mensagem de parada de CPL \_ , [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) recebe uma mensagem de saída de CPL \_ .</span><span class="sxs-lookup"><span data-stu-id="0ccc3-129">After the last CPL\_STOP message, [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) receives a CPL\_EXIT message.</span></span> <span data-ttu-id="0ccc3-130">A função deve liberar toda a memória alocada restante e cancelar o registro de qualquer classe de janela privada que ela possa ter registrado.</span><span class="sxs-lookup"><span data-stu-id="0ccc3-130">The function should free all remaining allocated memory and unregister any private window classes that it might have registered.</span></span> <span data-ttu-id="0ccc3-131">Imediatamente após a função retornar dessa mensagem, o Windows libera o item do painel de controle chamando a função [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) .</span><span class="sxs-lookup"><span data-stu-id="0ccc3-131">Immediately after the function returns from this message, Windows releases the Control Panel item by calling the [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) function.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0ccc3-132">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="0ccc3-132">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0ccc3-133">Itens do painel de controle</span><span class="sxs-lookup"><span data-stu-id="0ccc3-133">Control Panel Items</span></span>](control-panel-applications.md)
</dt> <dt>

[<span data-ttu-id="0ccc3-134">Diretrizes da Experiência do Usuário</span><span class="sxs-lookup"><span data-stu-id="0ccc3-134">User Experience Guidelines</span></span>](user-experience-guidelines.md)
</dt> <dt>

[<span data-ttu-id="0ccc3-135">Registrando itens do painel de controle</span><span class="sxs-lookup"><span data-stu-id="0ccc3-135">Registering Control Panel Items</span></span>](registering-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="0ccc3-136">Usando CPLApplet</span><span class="sxs-lookup"><span data-stu-id="0ccc3-136">Using CPLApplet</span></span>](using-cplapplet.md)
</dt> <dt>

[<span data-ttu-id="0ccc3-137">Executando itens do painel de controle</span><span class="sxs-lookup"><span data-stu-id="0ccc3-137">Executing Control Panel Items</span></span>](executing-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="0ccc3-138">Estendendo itens do painel de controle do sistema</span><span class="sxs-lookup"><span data-stu-id="0ccc3-138">Extending System Control Panel Items</span></span>](extending-system-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="0ccc3-139">Atribuindo categorias do painel de controle</span><span class="sxs-lookup"><span data-stu-id="0ccc3-139">Assigning Control Panel Categories</span></span>](assigning-control-panel-categories.md)
</dt> <dt>

[<span data-ttu-id="0ccc3-140">Criando links de tarefas pesquisáveis para um item do painel de controle</span><span class="sxs-lookup"><span data-stu-id="0ccc3-140">Creating Searchable Task Links for a Control Panel Item</span></span>](creating-searchable-task-links.md)
</dt> <dt>

[<span data-ttu-id="0ccc3-141">Acessando o painel de controle no modo de segurança no Windows Vista</span><span class="sxs-lookup"><span data-stu-id="0ccc3-141">Accessing the Control Panel in Safe Mode under Windows Vista</span></span>](accessing-the-cp-in-safe-mode-under-vista.md)
</dt> </dl>

 

 
