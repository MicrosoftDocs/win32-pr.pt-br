---
description: O procedimento para implementar uma extensão de namespace é semelhante ao de qualquer outro objeto COM (Component Object Model) em processo.
title: Implementando as interfaces de objeto de pasta básica
ms.topic: article
ms.date: 05/31/2018
ms.assetid: a45b8011-5355-429b-8935-4a7bdb5d2316
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: c05f5d2e4c21a923856c7324ad2d407230fa7595
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104968013"
---
# <a name="implementing-the-basic-folder-object-interfaces"></a><span data-ttu-id="0f205-103">Implementando as interfaces de objeto de pasta básica</span><span class="sxs-lookup"><span data-stu-id="0f205-103">Implementing the Basic Folder Object Interfaces</span></span>

<span data-ttu-id="0f205-104">O procedimento para implementar uma extensão de namespace é semelhante ao de qualquer outro objeto COM (Component Object Model) em processo.</span><span class="sxs-lookup"><span data-stu-id="0f205-104">The procedure for implementing a namespace extension is similar to that for any other in-process Component Object Model (COM) object.</span></span> <span data-ttu-id="0f205-105">Todas as extensões devem dar suporte a três interfaces primárias que fornecem ao Windows Explorer as informações básicas necessárias para exibir as pastas da extensão no modo de exibição de árvore.</span><span class="sxs-lookup"><span data-stu-id="0f205-105">All extensions must support three primary interfaces that provide Windows Explorer with the basic information needed to display the extension's folders in the tree view.</span></span> <span data-ttu-id="0f205-106">No entanto, para fazer uso total dos recursos do Windows Explorer, sua extensão também deve expor uma ou mais interfaces opcionais que dão suporte a recursos mais sofisticados, como menus de atalho ou arrastar e soltar, e fornecer uma exibição de pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-106">However, to make full use of the capabilities of Windows Explorer, your extension must also expose one or more optional interfaces that support more sophisticated features, such as shortcut menus or drag-and-drop, and provide a folder view.</span></span>

<span data-ttu-id="0f205-107">Este documento discute como implementar as interfaces primárias e opcionais que o Windows Explorer chama para obter informações sobre o conteúdo de sua extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-107">This document discusses how to implement the primary and optional interfaces that Windows Explorer calls for information about the contents of your extension.</span></span> <span data-ttu-id="0f205-108">Para obter uma discussão sobre como implementar uma exibição de pasta e como personalizar o Windows Explorer, consulte [implementando uma exibição de pasta](../lwef/nse-folderview.md).</span><span class="sxs-lookup"><span data-stu-id="0f205-108">For a discussion of how to implement a folder view and how to customize Windows Explorer, see [Implementing a Folder View](../lwef/nse-folderview.md).</span></span>

-   [<span data-ttu-id="0f205-109">Implementação e registro básicos</span><span class="sxs-lookup"><span data-stu-id="0f205-109">Basic Implementation and Registration</span></span>](#basic-implementation-and-registration)
    -   [<span data-ttu-id="0f205-110">Registrando uma extensão</span><span class="sxs-lookup"><span data-stu-id="0f205-110">Registering an Extension</span></span>](#registering-an-extension)
-   [<span data-ttu-id="0f205-111">Manipulando PIDLs</span><span class="sxs-lookup"><span data-stu-id="0f205-111">Handling PIDLs</span></span>](#handling-pidls)
    -   [<span data-ttu-id="0f205-112">Criando uma estrutura SHITEMID</span><span class="sxs-lookup"><span data-stu-id="0f205-112">Creating an SHITEMID Structure</span></span>](#creating-an-shitemid-structure)
    -   [<span data-ttu-id="0f205-113">Construindo um PIDL</span><span class="sxs-lookup"><span data-stu-id="0f205-113">Constructing a PIDL</span></span>](#constructing-a-pidl)
    -   [<span data-ttu-id="0f205-114">Interpretando PIDLs</span><span class="sxs-lookup"><span data-stu-id="0f205-114">Interpreting PIDLs</span></span>](#interpreting-pidls)
-   [<span data-ttu-id="0f205-115">Implementando as interfaces primárias</span><span class="sxs-lookup"><span data-stu-id="0f205-115">Implementing the Primary Interfaces</span></span>](#implementing-the-primary-interfaces)
    -   [<span data-ttu-id="0f205-116">Interface IPersistFolder</span><span class="sxs-lookup"><span data-stu-id="0f205-116">IPersistFolder Interface</span></span>](#ipersistfolder-interface)
    -   [<span data-ttu-id="0f205-117">Interface IShellFolder</span><span class="sxs-lookup"><span data-stu-id="0f205-117">IShellFolder Interface</span></span>](#ishellfolder-interface)
    -   [<span data-ttu-id="0f205-118">Interface IEnumIDList</span><span class="sxs-lookup"><span data-stu-id="0f205-118">IEnumIDList Interface</span></span>](#ienumidlist-interface)
-   [<span data-ttu-id="0f205-119">Implementando as interfaces opcionais</span><span class="sxs-lookup"><span data-stu-id="0f205-119">Implementing the Optional Interfaces</span></span>](#implementing-the-optional-interfaces)
    -   [<span data-ttu-id="0f205-120">IExtractIcon</span><span class="sxs-lookup"><span data-stu-id="0f205-120">IExtractIcon</span></span>](#iextracticon)
    -   [<span data-ttu-id="0f205-121">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="0f205-121">IContextMenu</span></span>](#icontextmenu)
    -   [<span data-ttu-id="0f205-122">IQueryInfo</span><span class="sxs-lookup"><span data-stu-id="0f205-122">IQueryInfo</span></span>](#iqueryinfo)
    -   [<span data-ttu-id="0f205-123">IDataObject e IDropTarget</span><span class="sxs-lookup"><span data-stu-id="0f205-123">IDataObject and IDropTarget</span></span>](#idataobject-and-idroptarget)
-   [<span data-ttu-id="0f205-124">Trabalhando com a implementação de exibição de pasta do shell padrão</span><span class="sxs-lookup"><span data-stu-id="0f205-124">Working With the Default Shell Folder View Implementation</span></span>](#working-with-the-default-shell-folder-view-implementation)

## <a name="basic-implementation-and-registration"></a><span data-ttu-id="0f205-125">Implementação e registro básicos</span><span class="sxs-lookup"><span data-stu-id="0f205-125">Basic Implementation and Registration</span></span>

<span data-ttu-id="0f205-126">Como um servidor COM em processo, sua DLL deve expor várias funções e interfaces padrão:</span><span class="sxs-lookup"><span data-stu-id="0f205-126">As an in-process COM server, your DLL must expose several standard functions and interfaces:</span></span>

-   [<span data-ttu-id="0f205-127">**DllCanUnloadNow**</span><span class="sxs-lookup"><span data-stu-id="0f205-127">**DllCanUnloadNow**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow)
-   [<span data-ttu-id="0f205-128">**DllGetClassObject**</span><span class="sxs-lookup"><span data-stu-id="0f205-128">**DllGetClassObject**</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject)
-   [<span data-ttu-id="0f205-129">**IClassFactory**</span><span class="sxs-lookup"><span data-stu-id="0f205-129">**IClassFactory**</span></span>](/windows/win32/api/unknwn/nn-unknwn-iclassfactory)
-   [<span data-ttu-id="0f205-130">**IUnknown**</span><span class="sxs-lookup"><span data-stu-id="0f205-130">**IUnknown**</span></span>](/windows/win32/api/unknwn/nn-unknwn-iunknown)

<span data-ttu-id="0f205-131">Essas funções e interfaces são implementadas da mesma maneira que são para a maioria dos outros objetos COM.</span><span class="sxs-lookup"><span data-stu-id="0f205-131">These functions and interfaces are implemented in the same way as they are for most other COM objects.</span></span> <span data-ttu-id="0f205-132">Para obter detalhes, consulte a [documentação com](../com/the-component-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="0f205-132">For details, see the [COM documentation](../com/the-component-object-model.md).</span></span>

### <a name="registering-an-extension"></a><span data-ttu-id="0f205-133">Registrando uma extensão</span><span class="sxs-lookup"><span data-stu-id="0f205-133">Registering an Extension</span></span>

<span data-ttu-id="0f205-134">Assim como acontece com todos os objetos COM, você deve criar um GUID de identificador de classe (CLSID) para sua extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-134">As with all COM objects, you must create a class identifier (CLSID) GUID for your extension.</span></span> <span data-ttu-id="0f205-135">Registre o objeto criando uma subchave do CLSID de **\_ \_ raiz de classes hKey** \\  nomeada para o CLSID de sua extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-135">Register the object by creating a subkey of **HKEY\_CLASSES\_ROOT**\\**CLSID** named for the CLSID of your extension.</span></span> <span data-ttu-id="0f205-136">A DLL deve ser registrada como um servidor em processo e deve especificar o modelo de Threading Apartment.</span><span class="sxs-lookup"><span data-stu-id="0f205-136">The DLL should be registered as an in-process server and should specify the apartment threading model.</span></span> <span data-ttu-id="0f205-137">Você pode personalizar o comportamento da pasta raiz de uma extensão adicionando uma variedade de subchaves e valores à chave CLSID da extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-137">You can customize the behavior of an extension's root folder by adding a variety of subkeys and values to the extension's CLSID key.</span></span>

<span data-ttu-id="0f205-138">Vários desses valores se aplicam somente a extensões com pontos de junção virtuais.</span><span class="sxs-lookup"><span data-stu-id="0f205-138">Several of these values apply only to extensions with virtual junction points.</span></span> <span data-ttu-id="0f205-139">Esses valores não se aplicam a extensões cujos pontos de junção são pastas do sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="0f205-139">These values do not apply to extensions whose junction points are file system folders.</span></span> <span data-ttu-id="0f205-140">Para obter mais informações, consulte [especificando o local de uma extensão de namespace](nse-junction.md).</span><span class="sxs-lookup"><span data-stu-id="0f205-140">For further discussion, see [Specifying a Namespace Extension's Location](nse-junction.md).</span></span> <span data-ttu-id="0f205-141">Para modificar o comportamento de uma extensão com um ponto de junção virtual, adicione um ou mais dos seguintes valores à chave CLSID da extensão:</span><span class="sxs-lookup"><span data-stu-id="0f205-141">To modify the behavior of an extension with a virtual junction point, add one or more of the following values to the extension's CLSID key:</span></span>

-   <span data-ttu-id="0f205-142">WantsFORPARSING.</span><span class="sxs-lookup"><span data-stu-id="0f205-142">WantsFORPARSING.</span></span> <span data-ttu-id="0f205-143">O nome de análise para uma extensão com um ponto de junção virtual normalmente terá o formato: {*GUID*}.</span><span class="sxs-lookup"><span data-stu-id="0f205-143">The parsing name for an extension with a virtual junction point will normally have the form ::{*GUID*}.</span></span> <span data-ttu-id="0f205-144">As extensões desse tipo normalmente contêm itens virtuais.</span><span class="sxs-lookup"><span data-stu-id="0f205-144">Extensions of this type normally contain virtual items.</span></span> <span data-ttu-id="0f205-145">No entanto, algumas extensões, como meus documentos, realmente correspondem às pastas do sistema de arquivos, embora tenham pontos de junção virtuais.</span><span class="sxs-lookup"><span data-stu-id="0f205-145">However, some extensions, such as My Documents, actually correspond to file system folders, even though they have virtual junction points.</span></span> <span data-ttu-id="0f205-146">Se sua extensão representar objetos do sistema de arquivos dessa forma, você poderá definir o valor de WantsFORPARSING.</span><span class="sxs-lookup"><span data-stu-id="0f205-146">If your extension represents file system objects in this way, you can set the WantsFORPARSING value.</span></span> <span data-ttu-id="0f205-147">O Windows Explorer solicitará o nome de análise da pasta raiz chamando o método [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) do objeto de pasta com *UFlags* definido como **SHGDN \_ FORPARSING** e *PIDL* definido como um único ponteiro vazio para uma lista de identificadores de item (PIDL).</span><span class="sxs-lookup"><span data-stu-id="0f205-147">Windows Explorer will then request your root folder's parsing name by calling the folder object's [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) method with *uFlags* set to **SHGDN\_FORPARSING** and *pidl* set to a single empty pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="0f205-148">Um PIDL vazio contém apenas um terminador.</span><span class="sxs-lookup"><span data-stu-id="0f205-148">An empty PIDL contains only a terminator.</span></span> <span data-ttu-id="0f205-149">O método deve retornar o nome da análise da pasta raiz: {*GUID*}.</span><span class="sxs-lookup"><span data-stu-id="0f205-149">Your method should then return the root folder's ::{*GUID*} parsing name.</span></span>
-   <span data-ttu-id="0f205-150">HideFolderVerbs.</span><span class="sxs-lookup"><span data-stu-id="0f205-150">HideFolderVerbs.</span></span> <span data-ttu-id="0f205-151">Os verbos registrados na pasta **\_ \_ raiz de classes hKey** \\  normalmente estão associados a todas as extensões.</span><span class="sxs-lookup"><span data-stu-id="0f205-151">The verbs registered under **HKEY\_CLASSES\_ROOT**\\**Folder** normally are associated with all extensions.</span></span> <span data-ttu-id="0f205-152">Eles aparecem no menu de atalho da extensão e podem ser invocados por [**ShellExecute**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea).</span><span class="sxs-lookup"><span data-stu-id="0f205-152">They appear on the extension's shortcut menu and can be invoked by [**ShellExecute**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea).</span></span> <span data-ttu-id="0f205-153">Para impedir que qualquer um desses verbos seja associado à sua extensão, defina o valor HideFolderVerbs.</span><span class="sxs-lookup"><span data-stu-id="0f205-153">To prevent any of these verbs from being associated with your extension, set the HideFolderVerbs value.</span></span>
-   <span data-ttu-id="0f205-154">HideAsDelete.</span><span class="sxs-lookup"><span data-stu-id="0f205-154">HideAsDelete.</span></span> <span data-ttu-id="0f205-155">Se um usuário tentar excluir sua extensão, o Windows Explorer ocultará a extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-155">If a user attempts to delete your extension, Windows Explorer will instead hide the extension.</span></span>
-   <span data-ttu-id="0f205-156">HideAsDeletePerUser.</span><span class="sxs-lookup"><span data-stu-id="0f205-156">HideAsDeletePerUser.</span></span> <span data-ttu-id="0f205-157">Esse valor tem o mesmo efeito que HideAsDelete, mas em uma base por usuário.</span><span class="sxs-lookup"><span data-stu-id="0f205-157">This value has the same effect as HideAsDelete but on a per-user basis.</span></span> <span data-ttu-id="0f205-158">A extensão é ocultada apenas para os usuários que tentaram excluí-la.</span><span class="sxs-lookup"><span data-stu-id="0f205-158">The extension is hidden only for those users who have attempted to delete it.</span></span> <span data-ttu-id="0f205-159">A extensão é visível para todos os outros usuários.</span><span class="sxs-lookup"><span data-stu-id="0f205-159">The extension is visible to all other users.</span></span>
-   <span data-ttu-id="0f205-160">QueryForOverlay.</span><span class="sxs-lookup"><span data-stu-id="0f205-160">QueryForOverlay.</span></span> <span data-ttu-id="0f205-161">Defina esse valor para indicar que o ícone da pasta raiz pode ter uma sobreposição de ícone.</span><span class="sxs-lookup"><span data-stu-id="0f205-161">Set this value to indicate that the root folder's icon can have an icon overlay.</span></span> <span data-ttu-id="0f205-162">O objeto de pasta deve dar suporte à interface [**IShellIconOverlay**](/windows/win32/api/shlobj_core/nn-shlobj_core-ishelliconoverlay) .</span><span class="sxs-lookup"><span data-stu-id="0f205-162">The folder object must support the [**IShellIconOverlay**](/windows/win32/api/shlobj_core/nn-shlobj_core-ishelliconoverlay) interface.</span></span> <span data-ttu-id="0f205-163">Antes de o Windows Explorer exibir o ícone da pasta raiz, ele solicitará um ícone de sobreposição chamando um dos dois métodos **IShellIconOverlay** com *pidlItem* definido como um PIDL vazio.</span><span class="sxs-lookup"><span data-stu-id="0f205-163">Before Windows Explorer displays the root folder's icon, it will request an overlay icon by calling one of the two **IShellIconOverlay** methods with *pidlItem* set to an empty PIDL.</span></span>

<span data-ttu-id="0f205-164">Os valores e subchaves restantes se aplicam a todas as extensões:</span><span class="sxs-lookup"><span data-stu-id="0f205-164">The remaining values and subkeys apply to all extensions:</span></span>

-   <span data-ttu-id="0f205-165">Para especificar o nome de exibição da pasta do ponto de junção da extensão, defina o valor padrão da subchave CLSID da extensão para uma cadeia de caracteres apropriada.</span><span class="sxs-lookup"><span data-stu-id="0f205-165">To specify the display name of the extension's junction point folder, set the default value of the extension's CLSID subkey to an appropriate string.</span></span>
-   <span data-ttu-id="0f205-166">Quando o cursor passa sobre uma pasta, normalmente é exibido um InfoTip que descreve o conteúdo da pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-166">When the cursor hovers over a folder, an infotip is typically displayed that describes the contents of the folder.</span></span> <span data-ttu-id="0f205-167">Para fornecer um InfoTip para a pasta raiz da extensão, crie um valor **de \_ registro** de configuração InfoTip para a chave CLSID da extensão e defina-o como uma cadeia de caracteres apropriada.</span><span class="sxs-lookup"><span data-stu-id="0f205-167">To provide an infotip for your extension's root folder, create an InfoTip **REG\_SZ** value for the extension's CLSID key, and set it to an appropriate string.</span></span>
-   <span data-ttu-id="0f205-168">Para especificar um ícone personalizado para a pasta raiz da extensão, crie uma subchave da subchave CLSID da extensão chamada **DefaultIcon**.</span><span class="sxs-lookup"><span data-stu-id="0f205-168">To specify a custom icon for your extension's root folder, create a subkey of the extension's CLSID subkey named **DefaultIcon**.</span></span> <span data-ttu-id="0f205-169">Defina o valor padrão de **DefaultIcon** como um valor de **\_ sz reg** contendo o nome do arquivo que contém o ícone, seguido por uma vírgula, seguido por um sinal de subtração, seguido pelo índice do ícone nesse arquivo.</span><span class="sxs-lookup"><span data-stu-id="0f205-169">Set the default value of **DefaultIcon** to a **REG\_SZ** value containing the name of the file that contains the icon, followed by a comma, followed by a minus sign, followed by the index of the icon in that file.</span></span>
-   <span data-ttu-id="0f205-170">Por padrão, o menu de atalho da pasta raiz da extensão conterá os itens definidos em **HKEY \_ classes \_ raiz \\ Folder**.</span><span class="sxs-lookup"><span data-stu-id="0f205-170">By default, the shortcut menu of your extension's root folder will contain the items defined under **HKEY\_CLASSES\_ROOT\\Folder**.</span></span> <span data-ttu-id="0f205-171">Os itens **excluir**, **renomear** e **Propriedades** serão adicionados se você tiver definido os sinalizadores SFGAO \_ xxx apropriados.</span><span class="sxs-lookup"><span data-stu-id="0f205-171">The **Delete**, **Rename**, and **Properties** items are added if you have set the appropriate SFGAO\_XXX flags.</span></span> <span data-ttu-id="0f205-172">Você pode adicionar outros itens ao menu de atalho da pasta raiz ou substituir itens existentes, da mesma forma como faria com um [tipo de arquivo](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="0f205-172">You can add other items to the root folder's shortcut menu, or override existing items, much as you would for a [file type](fa-file-types.md).</span></span> <span data-ttu-id="0f205-173">Crie uma subchave do **shell** na chave CLSID da extensão e defina os comandos conforme discutido na [extensão de menus de atalho](context.md).</span><span class="sxs-lookup"><span data-stu-id="0f205-173">Create a **Shell** subkey under the extension's CLSID key, and define commands as discussed in [Extending Shortcut Menus](context.md).</span></span>
-   <span data-ttu-id="0f205-174">Se você precisar de uma maneira mais flexível para manipular o menu de atalho da pasta raiz, poderá implementar um [manipulador de menu de atalho](context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="0f205-174">If you need a more flexible way to handle the root folder's shortcut menu, you can implement a [shortcut menu handler](context-menu-handlers.md).</span></span> <span data-ttu-id="0f205-175">Para registrar o manipulador de menu de atalho, crie uma chave **shellex** sob a chave CLSID da extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-175">To register the shortcut menu handler, create a **ShellEx** key under the extension's CLSID key.</span></span> <span data-ttu-id="0f205-176">Registre o CLSID do manipulador como você faria para [criar manipuladores de extensão de shell](handlers.md)convencionais.</span><span class="sxs-lookup"><span data-stu-id="0f205-176">Register the handler's CLSID as you would for a conventional [Creating Shell Extension Handlers](handlers.md).</span></span>
-   <span data-ttu-id="0f205-177">Para adicionar uma página à folha de propriedades de propriedades da pasta raiz, dê à pasta o atributo **SFGAO \_ HASPROPSHEET** e implemente um [manipulador de folha de propriedades](propsheet-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="0f205-177">To add a page to the root folder's Properties property sheet, give the folder the **SFGAO\_HASPROPSHEET** attribute and implement a [property sheet handler](propsheet-handlers.md).</span></span> <span data-ttu-id="0f205-178">Para registrar o manipulador de folha de propriedades, crie uma chave **shellex** na chave CLSID da extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-178">To register the property sheet handler, create a **ShellEx** key under the extension's CLSID key.</span></span> <span data-ttu-id="0f205-179">Registre o CLSID do manipulador como você faria para [criar manipuladores de extensão de shell](handlers.md)convencionais.</span><span class="sxs-lookup"><span data-stu-id="0f205-179">Register the handler's CLSID as you would for a conventional [Creating Shell Extension Handlers](handlers.md).</span></span>
-   <span data-ttu-id="0f205-180">Para especificar os atributos da pasta raiz, adicione uma subchave **identificação ShellFolder** à subchave CLSID da extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-180">To specify the attributes of the root folder, add a **ShellFolder** subkey to the extension's CLSID subkey.</span></span> <span data-ttu-id="0f205-181">Crie um valor de atributos e defina-o como a combinação apropriada de sinalizadores [**SFGAO \_ xxx**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) .</span><span class="sxs-lookup"><span data-stu-id="0f205-181">Create an Attributes value, and set it to the appropriate combination of [**SFGAO\_XXX**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) flags.</span></span>

<span data-ttu-id="0f205-182">A tabela a seguir lista alguns atributos comumente usados para pastas raiz.</span><span class="sxs-lookup"><span data-stu-id="0f205-182">The following table lists some commonly used attributes for root folders.</span></span>



| <span data-ttu-id="0f205-183">Sinalizador</span><span class="sxs-lookup"><span data-stu-id="0f205-183">Flag</span></span>                | <span data-ttu-id="0f205-184">Valor</span><span class="sxs-lookup"><span data-stu-id="0f205-184">Value</span></span>      | <span data-ttu-id="0f205-185">Descrição</span><span class="sxs-lookup"><span data-stu-id="0f205-185">Description</span></span>                                                                                                                                                                                                                                                                                                       |
|---------------------|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0f205-186">\_pasta SFGAO</span><span class="sxs-lookup"><span data-stu-id="0f205-186">SFGAO\_FOLDER</span></span>       | <span data-ttu-id="0f205-187">0x20000000</span><span class="sxs-lookup"><span data-stu-id="0f205-187">0x20000000</span></span> | <span data-ttu-id="0f205-188">A pasta raiz da extensão contém um ou mais itens.</span><span class="sxs-lookup"><span data-stu-id="0f205-188">The extension's root folder contains one or more items.</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="0f205-189">SFGAO \_ HASSUBFOLDER</span><span class="sxs-lookup"><span data-stu-id="0f205-189">SFGAO\_HASSUBFOLDER</span></span> | <span data-ttu-id="0f205-190">0x80000000</span><span class="sxs-lookup"><span data-stu-id="0f205-190">0x80000000</span></span> | <span data-ttu-id="0f205-191">A pasta raiz da extensão contém uma ou mais subpastas.</span><span class="sxs-lookup"><span data-stu-id="0f205-191">The extension's root folder contains one or more subfolders.</span></span> <span data-ttu-id="0f205-192">O Windows Explorer coloca um sinal de mais (+) ao lado do ícone de pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-192">Windows Explorer will place a plus sign ( + ) next to the folder icon.</span></span>                                                                                                                                                                               |
| <span data-ttu-id="0f205-193">canSFGAO \_ CANdelete</span><span class="sxs-lookup"><span data-stu-id="0f205-193">SFGAO\_CANDELETE</span></span>    | <span data-ttu-id="0f205-194">0x00000020</span><span class="sxs-lookup"><span data-stu-id="0f205-194">0x00000020</span></span> | <span data-ttu-id="0f205-195">A pasta raiz da extensão pode ser excluída pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="0f205-195">The extension's root folder can be deleted by the user.</span></span> <span data-ttu-id="0f205-196">O menu de atalho da pasta terá um item de **exclusão** .</span><span class="sxs-lookup"><span data-stu-id="0f205-196">The folder's shortcut menu will have a **Delete** item.</span></span> <span data-ttu-id="0f205-197">Esse sinalizador deve ser definido para pontos de junção que são colocados em uma das [pastas virtuais](nse-junction.md).</span><span class="sxs-lookup"><span data-stu-id="0f205-197">This flag should be set for junction points that are placed under one of the [virtual folders](nse-junction.md).</span></span>                                                                                 |
| <span data-ttu-id="0f205-198">SFGAO \_ renomear</span><span class="sxs-lookup"><span data-stu-id="0f205-198">SFGAO\_CANRENAME</span></span>    | <span data-ttu-id="0f205-199">0x00000010</span><span class="sxs-lookup"><span data-stu-id="0f205-199">0x00000010</span></span> | <span data-ttu-id="0f205-200">A pasta raiz da extensão pode ser renomeada pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="0f205-200">The extension's root folder can be renamed by the user.</span></span> <span data-ttu-id="0f205-201">O menu de atalho da pasta terá um item de **renomeação** .</span><span class="sxs-lookup"><span data-stu-id="0f205-201">The folder's shortcut menu will have a **Rename** item.</span></span>                                                                                                                                                                                                   |
| <span data-ttu-id="0f205-202">SFGAO \_ HASPROPSHEET</span><span class="sxs-lookup"><span data-stu-id="0f205-202">SFGAO\_HASPROPSHEET</span></span> | <span data-ttu-id="0f205-203">0x00000040</span><span class="sxs-lookup"><span data-stu-id="0f205-203">0x00000040</span></span> | <span data-ttu-id="0f205-204">A pasta raiz da extensão tem uma folha de propriedades **Propriedades** .</span><span class="sxs-lookup"><span data-stu-id="0f205-204">The extension's root folder has a **Properties** property sheet.</span></span> <span data-ttu-id="0f205-205">O menu de atalho da pasta terá um item de **Propriedades** .</span><span class="sxs-lookup"><span data-stu-id="0f205-205">The folder's shortcut menu will have a **Properties** item.</span></span> <span data-ttu-id="0f205-206">Para fornecer a folha de propriedades, você deve implementar um [manipulador de folha de propriedades](propsheet-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="0f205-206">To provide the property sheet, you must implement a [property sheet handler](propsheet-handlers.md).</span></span> <span data-ttu-id="0f205-207">Registre o manipulador sob a chave CLSID da extensão, conforme discutido anteriormente.</span><span class="sxs-lookup"><span data-stu-id="0f205-207">Register the handler under the extension's CLSID key, as discussed previously.</span></span> |



 

<span data-ttu-id="0f205-208">O exemplo a seguir mostra a entrada de Registro CLSID para uma extensão com um nome de exibição de MyExtension.</span><span class="sxs-lookup"><span data-stu-id="0f205-208">The following example shows the CLSID registry entry for an extension with a display name of MyExtension.</span></span> <span data-ttu-id="0f205-209">A extensão tem um ícone personalizado que está contido na DLL da extensão com um índice de 1.</span><span class="sxs-lookup"><span data-stu-id="0f205-209">The extension has a custom icon that is contained in the extension's DLL with an index of 1.</span></span> <span data-ttu-id="0f205-210">Os atributos **SFGAO \_ Folder**, **SFGAO \_ HASSUBFOLDER** e **SFGAO \_ CanDelete** são definidos.</span><span class="sxs-lookup"><span data-stu-id="0f205-210">The **SFGAO\_FOLDER**, **SFGAO\_HASSUBFOLDER**, and **SFGAO\_CANDELETE** attributes are set.</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      {Extension CLSID}
         (Default) = MyExtension
         InfoTip = Some appropriate text
      DefaultIcon
         (Default) = c:\MyDir\MyExtension.dll,-1
      InProcServer32
         (Default) = c:\MyDir\MyExtension.dll
         ThreadingModel = Apartment
      ShellFolder
         Attributes = 0xA00000020
```

## <a name="handling-pidls"></a><span data-ttu-id="0f205-211">Manipulando PIDLs</span><span class="sxs-lookup"><span data-stu-id="0f205-211">Handling PIDLs</span></span>

<span data-ttu-id="0f205-212">Cada item no namespace do Shell deve ter um PIDL exclusivo.</span><span class="sxs-lookup"><span data-stu-id="0f205-212">Every item in the Shell namespace must have a unique PIDL.</span></span> <span data-ttu-id="0f205-213">O Windows Explorer atribui um PIDL à sua pasta raiz e passa o valor para sua extensão durante a inicialização.</span><span class="sxs-lookup"><span data-stu-id="0f205-213">Windows Explorer assigns a PIDL to your root folder and passes the value to your extension during initialization.</span></span> <span data-ttu-id="0f205-214">Em seguida, sua extensão é responsável por atribuir um PIDL construído corretamente a cada um de seus objetos e fornecer esses PIDLs ao Windows Explorer na solicitação.</span><span class="sxs-lookup"><span data-stu-id="0f205-214">Your extension is then responsible for assigning a properly constructed PIDL to each of its objects and providing those PIDLs to Windows Explorer on request.</span></span> <span data-ttu-id="0f205-215">Quando o Shell usa um PIDL para identificar um dos objetos da extensão, sua extensão deve ser capaz de interpretar o PIDL e identificar o objeto específico.</span><span class="sxs-lookup"><span data-stu-id="0f205-215">When the Shell uses a PIDL to identify one of your extension's objects, your extension must be able to interpret the PIDL and identify the particular object.</span></span> <span data-ttu-id="0f205-216">Sua extensão também deve atribuir um [**nome de exibição**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-setnameof) e um *nome de análise* a cada objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-216">Your extension must also assign a [**display name**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-setnameof) and a *parsing name* to each object.</span></span> <span data-ttu-id="0f205-217">Como PIDLs são usados por praticamente cada interface de pasta, as extensões normalmente implementam um único *Gerenciador de PIDL* para lidar com todas essas tarefas.</span><span class="sxs-lookup"><span data-stu-id="0f205-217">Because PIDLs are used by virtually every folder interface, extensions commonly implement a single *PIDL manager* to handle all these tasks.</span></span>

<span data-ttu-id="0f205-218">O termo PIDL é curto para uma estrutura [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) ou um ponteiro para tal estrutura, dependendo do contexto.</span><span class="sxs-lookup"><span data-stu-id="0f205-218">The term PIDL is short for an [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure or a pointer to such a structure, depending on context.</span></span> <span data-ttu-id="0f205-219">Como declarado, uma estrutura **ITEMIDLIST** tem um único membro, uma estrutura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) .</span><span class="sxs-lookup"><span data-stu-id="0f205-219">As declared, an **ITEMIDLIST** structure has a single member, an [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="0f205-220">A estrutura **ITEMIDLIST** de um objeto é, na verdade, uma matriz empacotada de duas ou mais estruturas **SHITEMID** .</span><span class="sxs-lookup"><span data-stu-id="0f205-220">An object's **ITEMIDLIST** structure is actually a packed array of two or more **SHITEMID** structures.</span></span> <span data-ttu-id="0f205-221">A ordem dessas estruturas define um caminho por meio do namespace, praticamente da mesma forma que c: \\ mydirectory \\ MyFile define um caminho por meio do sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="0f205-221">The order of these structures defines a path through the namespace, in much the same way that c:\\MyDirectory\\MyFile defines a path through the file system.</span></span> <span data-ttu-id="0f205-222">Normalmente, o PIDL de um objeto consistirá em uma série de estruturas **SHITEMID** que correspondem às pastas que definem o caminho do namespace, seguido pela estrutura **SHITEMID** do objeto, seguida por um terminador.</span><span class="sxs-lookup"><span data-stu-id="0f205-222">Typically, an object's PIDL will consist of a series of **SHITEMID** structures that correspond to the folders that define the namespace path, followed by the object's **SHITEMID** structure, followed by a terminator.</span></span>

<span data-ttu-id="0f205-223">O terminador é uma estrutura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) , com o membro *CB* definido como **nulo**.</span><span class="sxs-lookup"><span data-stu-id="0f205-223">The terminator is an [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, with the *cb* member set to **NULL**.</span></span> <span data-ttu-id="0f205-224">O terminador é necessário porque o número de estruturas **SHITEMID** no PIDL de um objeto depende do local do objeto no namespace do Shell e do ponto de partida do caminho.</span><span class="sxs-lookup"><span data-stu-id="0f205-224">The terminator is necessary because the number of **SHITEMID** structures in an object's PIDL depends on the location of the object in the Shell namespace, and the starting point of the path.</span></span> <span data-ttu-id="0f205-225">Além disso, o tamanho das várias estruturas **SHITEMID** pode variar.</span><span class="sxs-lookup"><span data-stu-id="0f205-225">In addition, the size of the various **SHITEMID** structures can vary.</span></span> <span data-ttu-id="0f205-226">Ao receber um PIDL, você não tem uma maneira simples de determinar seu tamanho ou até mesmo o número total de estruturas **SHITEMID** .</span><span class="sxs-lookup"><span data-stu-id="0f205-226">When you receive a PIDL, you have no simple way of determining its size or even the total number of **SHITEMID** structures.</span></span> <span data-ttu-id="0f205-227">Em vez disso, você deve "percorrer" a matriz empacotada, estrutura por estrutura, até chegar ao terminador.</span><span class="sxs-lookup"><span data-stu-id="0f205-227">Instead, you must "walk" the packed array, structure by structure, until you reach the terminator.</span></span>

<span data-ttu-id="0f205-228">Para criar um PIDL, seu aplicativo precisa:</span><span class="sxs-lookup"><span data-stu-id="0f205-228">To create a PIDL, your application needs to:</span></span>

1.  <span data-ttu-id="0f205-229">Crie uma estrutura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) para cada um de seus objetos.</span><span class="sxs-lookup"><span data-stu-id="0f205-229">Create an [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure for each of its objects.</span></span>
2.  <span data-ttu-id="0f205-230">Monte as estruturas [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) relevantes em um PIDL.</span><span class="sxs-lookup"><span data-stu-id="0f205-230">Assemble the relevant [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures into a PIDL.</span></span>

### <a name="creating-an-shitemid-structure"></a><span data-ttu-id="0f205-231">Criando uma estrutura SHITEMID</span><span class="sxs-lookup"><span data-stu-id="0f205-231">Creating an SHITEMID Structure</span></span>

<span data-ttu-id="0f205-232">A estrutura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) de um objeto identifica exclusivamente o objeto dentro de sua pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-232">An object's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure uniquely identifies the object within its folder.</span></span> <span data-ttu-id="0f205-233">Na verdade, um tipo de PIDL usado por muitos dos métodos [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) consiste apenas na estrutura **SHITEMID** do objeto, seguido por um terminador.</span><span class="sxs-lookup"><span data-stu-id="0f205-233">In fact, a type of PIDL used by many of the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods consists of just the object's **SHITEMID** structure, followed by a terminator.</span></span> <span data-ttu-id="0f205-234">A definição de uma estrutura **SHITEMID** é:</span><span class="sxs-lookup"><span data-stu-id="0f205-234">The definition of an **SHITEMID** structure is:</span></span>


```C++
typedef struct _SHITEMID { 
    USHORT cb; 
    BYTE   abID[1]; 
} SHITEMID, * LPSHITEMID;
```



<span data-ttu-id="0f205-235">O membro *abID* é o identificador do objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-235">The *abID* member is the object's identifier.</span></span> <span data-ttu-id="0f205-236">Como o comprimento de *abID* não está definido e pode variar, o membro *CB* é definido como o tamanho da estrutura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) , em bytes.</span><span class="sxs-lookup"><span data-stu-id="0f205-236">Because the length of *abID* is not defined and can vary, the *cb* member is set to the size of the [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, in bytes.</span></span>

<span data-ttu-id="0f205-237">Como nem o comprimento nem o conteúdo de *abID* é padronizado, você pode usar qualquer esquema ao qual deseja atribuir valores de *abID* aos seus objetos.</span><span class="sxs-lookup"><span data-stu-id="0f205-237">Because neither the length nor the content of *abID* is standardized, you can use any scheme you want to assign *abID* values to your objects.</span></span> <span data-ttu-id="0f205-238">O único requisito é que você não possa ter dois objetos na mesma pasta com valores idênticos.</span><span class="sxs-lookup"><span data-stu-id="0f205-238">The only requirement is that you cannot have two objects in the same folder with identical values.</span></span> <span data-ttu-id="0f205-239">No entanto, por motivos de desempenho, sua estrutura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) deve ser alinhada em **DWORD**.</span><span class="sxs-lookup"><span data-stu-id="0f205-239">However, for performance reasons, your [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure should be **DWORD**-aligned.</span></span> <span data-ttu-id="0f205-240">Em outras palavras, você deve construir seus valores de *abID* de forma que *CB* seja um múltiplo integral de 4.</span><span class="sxs-lookup"><span data-stu-id="0f205-240">In other words, you should construct your *abID* values such that *cb* is an integral multiple of 4.</span></span>

<span data-ttu-id="0f205-241">Normalmente, *abID* aponta para uma estrutura definida por extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-241">Typically, *abID* points to an extension-defined structure.</span></span> <span data-ttu-id="0f205-242">Além da ID do objeto, essa estrutura costuma ser usada para manter uma variedade de informações relacionadas, como o tipo ou os atributos do objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-242">In addition to the object's ID, this structure is often used to hold a variety of related information, such as the object's type or attributes.</span></span> <span data-ttu-id="0f205-243">Os objetos de pasta da extensão podem, então, extrair rapidamente as informações do PIDL em vez de ter que consultá-las.</span><span class="sxs-lookup"><span data-stu-id="0f205-243">Your extension's folder objects can then quickly extract the information from the PIDL instead of having to query for it.</span></span>

> [!Note]  
> <span data-ttu-id="0f205-244">Um dos aspectos mais importantes da criação de uma estrutura de dados para um PIDL é tornar a estrutura persistente e transportável.</span><span class="sxs-lookup"><span data-stu-id="0f205-244">One of the most important aspects of designing a data structure for a PIDL is to make the structure persistable and transportable.</span></span> <span data-ttu-id="0f205-245">No contexto de PIDLs, o significado desses termos é:</span><span class="sxs-lookup"><span data-stu-id="0f205-245">In the context of PIDLs, the meaning of these terms is:</span></span>
>
> -   <span data-ttu-id="0f205-246">Persistente.</span><span class="sxs-lookup"><span data-stu-id="0f205-246">Persistable.</span></span> <span data-ttu-id="0f205-247">O sistema geralmente coloca PIDLs em vários tipos de armazenamento de longo prazo, como arquivos de atalho.</span><span class="sxs-lookup"><span data-stu-id="0f205-247">The system frequently places PIDLs in various types of long-term storage, such as shortcut files.</span></span> <span data-ttu-id="0f205-248">Em seguida, ele pode recuperar esses PIDLs do armazenamento mais tarde, possivelmente após a reinicialização do sistema.</span><span class="sxs-lookup"><span data-stu-id="0f205-248">It can then recover these PIDLs from storage later, possibly after the system has been rebooted.</span></span> <span data-ttu-id="0f205-249">Um PIDL que foi recuperado do armazenamento ainda deve ser válido e significativo para sua extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-249">A PIDL that has been recovered from storage must still be valid and meaningful to your extension.</span></span> <span data-ttu-id="0f205-250">Esse requisito significa, por exemplo, que você não deve usar ponteiros ou identificadores em sua estrutura PIDL.</span><span class="sxs-lookup"><span data-stu-id="0f205-250">This requirement means, for instance, that you should not use pointers or handles in your PIDL structure.</span></span> <span data-ttu-id="0f205-251">O PIDLs que contém esse tipo de dados normalmente não fará sentido quando o sistema os recuperar posteriormente do armazenamento.</span><span class="sxs-lookup"><span data-stu-id="0f205-251">PIDLs containing this type of data will normally be meaningless when the system later recovers them from storage.</span></span>
> -   <span data-ttu-id="0f205-252">Transportáveis.</span><span class="sxs-lookup"><span data-stu-id="0f205-252">Transportable.</span></span> <span data-ttu-id="0f205-253">Um PIDL deve permanecer significativo quando transportado de um computador para outro.</span><span class="sxs-lookup"><span data-stu-id="0f205-253">A PIDL must remain meaningful when transported from one computer to another.</span></span> <span data-ttu-id="0f205-254">Por exemplo, um PIDL pode ser gravado em um arquivo de atalho, copiado para um disquete e transportado para outro computador.</span><span class="sxs-lookup"><span data-stu-id="0f205-254">For example, a PIDL can be written to a shortcut file, copied to a floppy disk, and transported to another computer.</span></span> <span data-ttu-id="0f205-255">Esse PIDL ainda deve ser significativo para a extensão em execução no segundo computador.</span><span class="sxs-lookup"><span data-stu-id="0f205-255">That PIDL should still be meaningful to your extension running on the second computer.</span></span> <span data-ttu-id="0f205-256">Por exemplo, para garantir que seus PIDLs sejam transportáveis, use caracteres ANSI ou Unicode explicitamente.</span><span class="sxs-lookup"><span data-stu-id="0f205-256">For instance, to ensure that your PIDLs are transportable, use either ANSI or Unicode characters explicitly.</span></span> <span data-ttu-id="0f205-257">Evite tipos de dados como **TCHAR** ou **LPTSTR**.</span><span class="sxs-lookup"><span data-stu-id="0f205-257">Avoid data types such as **TCHAR** or **LPTSTR**.</span></span> <span data-ttu-id="0f205-258">Se você usar esses tipos de dados, um PIDL criado em um computador que executa uma versão Unicode de sua extensão não poderá ser lido por uma versão ANSI dessa extensão em execução em um computador diferente.</span><span class="sxs-lookup"><span data-stu-id="0f205-258">If you use those data types, a PIDL created on a computer running a Unicode version of your extension will not be readable by an ANSI version of that extension running on a different computer.</span></span>

 

<span data-ttu-id="0f205-259">A declaração a seguir mostra um exemplo simples de uma estrutura de dados.</span><span class="sxs-lookup"><span data-stu-id="0f205-259">The following declaration shows a simple example of a data structure.</span></span>


```C++
typedef struct tagMYPIDLDATA {
  USHORT cb;
  DWORD dwType;
  WCHAR wszDisplayName[40];
} MYPIDLDATA, *LPMYPIDLDATA;
```



<span data-ttu-id="0f205-260">O membro **CB** é definido como o tamanho da estrutura **MYPIDLDATA** .</span><span class="sxs-lookup"><span data-stu-id="0f205-260">The **cb** member is set to the size of the **MYPIDLDATA** structure.</span></span> <span data-ttu-id="0f205-261">Esse membro faz **MYPIDLDATA** uma estrutura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) válida, por si só.</span><span class="sxs-lookup"><span data-stu-id="0f205-261">This member makes **MYPIDLDATA** a valid [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, in and of itself.</span></span> <span data-ttu-id="0f205-262">O restante dos membros são equivalentes ao membro **abID** de uma estrutura **SHITEMID** e contêm dados privados.</span><span class="sxs-lookup"><span data-stu-id="0f205-262">The rest of the members are equivalent to the **abID** member of an **SHITEMID** structure and hold private data.</span></span> <span data-ttu-id="0f205-263">O membro **dwType** é um valor definido pela extensão que indica o tipo de objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-263">The **dwType** member is an extension-defined value that indicates the type of object.</span></span> <span data-ttu-id="0f205-264">Para este exemplo, **dwType** é definido como **true** para pastas e **false** caso contrário.</span><span class="sxs-lookup"><span data-stu-id="0f205-264">For this example, **dwType** is set to **TRUE** for folders and **FALSE** otherwise.</span></span> <span data-ttu-id="0f205-265">Esse membro permite, por exemplo, determinar rapidamente se o objeto é uma pasta ou não.</span><span class="sxs-lookup"><span data-stu-id="0f205-265">This member allows you, for instance, to quickly determine whether the object is a folder or not.</span></span> <span data-ttu-id="0f205-266">O membro **wszDisplayName** contém o nome de exibição do objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-266">The **wszDisplayName** member contains the object's display name.</span></span> <span data-ttu-id="0f205-267">Como você não atribuiria o mesmo nome de exibição a dois objetos diferentes na mesma pasta, o nome de exibição também serve como a ID de objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-267">Since you would not assign the same display name to two different objects in the same folder, the display name also serves as the object ID.</span></span> <span data-ttu-id="0f205-268">Neste exemplo, **wszDisplayName** é definido como 40 caracteres para garantir que a estrutura **SHITEMID** será alinhada em **DWORD**.</span><span class="sxs-lookup"><span data-stu-id="0f205-268">In this example, **wszDisplayName** is set to 40 characters to guarantee that the **SHITEMID** structure will be **DWORD**-aligned.</span></span> <span data-ttu-id="0f205-269">Para limitar o tamanho de seu PIDLs, você pode usar uma matriz de caracteres de comprimento variável e ajustar o valor de CB de acordo.</span><span class="sxs-lookup"><span data-stu-id="0f205-269">To limit the size of your PIDLs, you can instead use a variable-length character array and adjust the value of cb accordingly.</span></span> <span data-ttu-id="0f205-270">Preencha a cadeia de exibição com \\ caracteres ' 0 ' suficientes para manter o alinhamento de **DWORD** da estrutura.</span><span class="sxs-lookup"><span data-stu-id="0f205-270">Pad the display string with enough '\\0' characters to maintain the structure's **DWORD** alignment.</span></span> <span data-ttu-id="0f205-271">Outros membros que podem ser úteis para colocar na estrutura incluem o tamanho do objeto, os atributos ou o nome de análise.</span><span class="sxs-lookup"><span data-stu-id="0f205-271">Other members that might be useful to put in the structure include the object's size, attributes, or parsing name.</span></span>

### <a name="constructing-a-pidl"></a><span data-ttu-id="0f205-272">Construindo um PIDL</span><span class="sxs-lookup"><span data-stu-id="0f205-272">Constructing a PIDL</span></span>

<span data-ttu-id="0f205-273">Depois de definir as estruturas [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) para seus objetos, você poderá usá-las para construir um PIDL.</span><span class="sxs-lookup"><span data-stu-id="0f205-273">Once you have defined [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures for your objects, you can then use them to construct a PIDL.</span></span> <span data-ttu-id="0f205-274">O PIDLs pode ser construído para uma variedade de finalidades, mas a maioria das tarefas usa um dos dois tipos de PIDL.</span><span class="sxs-lookup"><span data-stu-id="0f205-274">PIDLs can be constructed for a variety of purposes, but most tasks use one of two types of PIDL.</span></span> <span data-ttu-id="0f205-275">O mais simples, um PIDL de nível único, identifica o objeto relativo à sua pasta pai.</span><span class="sxs-lookup"><span data-stu-id="0f205-275">The simplest, a single-level PIDL, identifies the object relative to its parent folder.</span></span> <span data-ttu-id="0f205-276">Esse tipo de PIDL é usado por muitos dos métodos [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="0f205-276">This type of PIDL is used by many of the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods.</span></span> <span data-ttu-id="0f205-277">Um PIDL de nível único contém a estrutura **SHITEMID** do objeto, seguida por um terminador.</span><span class="sxs-lookup"><span data-stu-id="0f205-277">A single-level PIDL contains the object's **SHITEMID** structure, followed by a terminator.</span></span> <span data-ttu-id="0f205-278">Um PIDL totalmente qualificado define um caminho por meio da hierarquia de namespace da área de trabalho para o objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-278">A fully qualified PIDL defines a path through the namespace hierarchy from the desktop to the object.</span></span> <span data-ttu-id="0f205-279">Esse tipo de PIDL é iniciado na área de trabalho e contém uma estrutura **SHITEMID** para cada pasta no caminho, seguido pelo objeto e o terminador.</span><span class="sxs-lookup"><span data-stu-id="0f205-279">This type of PIDL starts at the desktop and contains one **SHITEMID** structure for each folder in the path, followed by the object and the terminator.</span></span> <span data-ttu-id="0f205-280">Um PIDL totalmente qualificado identifica exclusivamente o objeto dentro de todo o namespace do Shell.</span><span class="sxs-lookup"><span data-stu-id="0f205-280">A fully qualified PIDL uniquely identifies the object within the entire Shell namespace.</span></span>

<span data-ttu-id="0f205-281">A maneira mais simples de construir um PIDL é trabalhar diretamente com a própria estrutura [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) .</span><span class="sxs-lookup"><span data-stu-id="0f205-281">The simplest way to construct a PIDL is to work directly with the [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure itself.</span></span> <span data-ttu-id="0f205-282">Crie uma estrutura de **ITEMIDLIST** , mas aloque memória suficiente para manter todas as estruturas [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) .</span><span class="sxs-lookup"><span data-stu-id="0f205-282">Create an **ITEMIDLIST** structure, but allocate enough memory to hold all the [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures.</span></span> <span data-ttu-id="0f205-283">O endereço dessa estrutura apontará para a estrutura **SHITEMID** inicial.</span><span class="sxs-lookup"><span data-stu-id="0f205-283">The address of this structure will point to the initial **SHITEMID** structure.</span></span> <span data-ttu-id="0f205-284">Defina valores para os membros dessa estrutura inicial e, em seguida, acrescente quantas estruturas **SHITEMID** adicionais forem necessárias, na ordem apropriada.</span><span class="sxs-lookup"><span data-stu-id="0f205-284">Define values for the members of this initial structure, and then append as many additional **SHITEMID** structures as you need, in the appropriate order.</span></span> <span data-ttu-id="0f205-285">O procedimento a seguir descreve como criar um PIDL de nível único.</span><span class="sxs-lookup"><span data-stu-id="0f205-285">The following procedure outlines how to create a single-level PIDL.</span></span> <span data-ttu-id="0f205-286">Ele contém duas estruturas **SHITEMID** , uma estrutura **MYPIDLDATA** seguida por um terminador:</span><span class="sxs-lookup"><span data-stu-id="0f205-286">It contains two **SHITEMID** structures—a **MYPIDLDATA** structure followed by a terminator:</span></span>

1.  <span data-ttu-id="0f205-287">Use a função [**CoTaskMemAlloc**](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemalloc) para alocar memória para o PIDL.</span><span class="sxs-lookup"><span data-stu-id="0f205-287">Use the [**CoTaskMemAlloc**](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemalloc) function to allocate memory for the PIDL.</span></span> <span data-ttu-id="0f205-288">Aloque memória suficiente para seus dados particulares mais um **UShort** (dois bytes) para o terminador.</span><span class="sxs-lookup"><span data-stu-id="0f205-288">Allocate enough memory for your private data plus a **USHORT** (two bytes) for the terminator.</span></span> <span data-ttu-id="0f205-289">Converta o resultado em LPMYPIDLDATA.</span><span class="sxs-lookup"><span data-stu-id="0f205-289">Cast the result to LPMYPIDLDATA.</span></span>
2.  <span data-ttu-id="0f205-290">Defina o membro CB da primeira estrutura **MYPIDLDATA** para o tamanho dessa estrutura.</span><span class="sxs-lookup"><span data-stu-id="0f205-290">Set the cb member of the first **MYPIDLDATA** structure to the size of that structure.</span></span> <span data-ttu-id="0f205-291">Para este exemplo, você definirá **CB** como sizeof (MYPIDLDATA).</span><span class="sxs-lookup"><span data-stu-id="0f205-291">For this example, you would set **cb** to sizeof(MYPIDLDATA).</span></span> <span data-ttu-id="0f205-292">Se você quiser usar uma estrutura de comprimento variável, precisará calcular o valor de **CB**.</span><span class="sxs-lookup"><span data-stu-id="0f205-292">If you want to use a variable-length structure, you will have to calculate the value of **cb**.</span></span>
3.  <span data-ttu-id="0f205-293">Atribua valores apropriados aos membros de dados privados.</span><span class="sxs-lookup"><span data-stu-id="0f205-293">Assign appropriate values to the private data members.</span></span>
4.  <span data-ttu-id="0f205-294">Calcule o endereço da próxima estrutura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) .</span><span class="sxs-lookup"><span data-stu-id="0f205-294">Calculate the address of the next [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="0f205-295">Converta o endereço da estrutura MYPIDLDATA atual em LPBYTE e adicione esse valor ao valor de **CB** determinado na etapa 3.</span><span class="sxs-lookup"><span data-stu-id="0f205-295">Cast the address of the current MYPIDLDATA structure to LPBYTE, and add that value to the value of **cb** determined in step 3.</span></span>
5.  <span data-ttu-id="0f205-296">Nesse caso, a próxima estrutura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) é o terminador.</span><span class="sxs-lookup"><span data-stu-id="0f205-296">In this case, the next [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure is the terminator.</span></span> <span data-ttu-id="0f205-297">Defina o membro **CB** da estrutura como zero.</span><span class="sxs-lookup"><span data-stu-id="0f205-297">Set the structure's **cb** member to zero.</span></span>

<span data-ttu-id="0f205-298">Para obter mais PIDLs, aloque memória suficiente e repita as etapas de 3-5 para cada estrutura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) adicional.</span><span class="sxs-lookup"><span data-stu-id="0f205-298">For longer PIDLs, allocate sufficient memory and repeat steps 3-5 for each additional [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span>

<span data-ttu-id="0f205-299">A função de exemplo a seguir usa o tipo de um objeto e o nome de exibição e retorna o PIDL de nível único do objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-299">The following sample function takes an object's type and display name and returns the object's single-level PIDL.</span></span> <span data-ttu-id="0f205-300">A função pressupõe que o nome de exibição, incluindo seu caractere **nulo** de terminação, não exceda o número de caracteres declarados para a estrutura **MYPIDLDATA** .</span><span class="sxs-lookup"><span data-stu-id="0f205-300">The function assumes that the display name, including its terminating **null** character, does not exceed the number of characters declared for the **MYPIDLDATA** structure.</span></span> <span data-ttu-id="0f205-301">Se essa suposição se tornar incorreta, a função [**StringCbCopyW**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopya) truncará o nome de exibição.</span><span class="sxs-lookup"><span data-stu-id="0f205-301">If that assumption turns out to be erroneous, the [**StringCbCopyW**](/windows/win32/api/strsafe/nf-strsafe-stringcbcopya) function will truncate the display name.</span></span> <span data-ttu-id="0f205-302">A variável **g \_ pMalloc** é um ponteiro [**IMalloc**](/windows/win32/api/objidlbase/nn-objidlbase-imalloc) criado em outro lugar e armazenado em uma variável global.</span><span class="sxs-lookup"><span data-stu-id="0f205-302">The **g\_pMalloc** variable is an [**IMalloc**](/windows/win32/api/objidlbase/nn-objidlbase-imalloc) pointer created elsewhere and stored in a global variable.</span></span>


```C++
LPITEMIDLIST CreatePIDL(DWORD dwType, LPCWSTR pwszDisplayName)
{
    LPMYPIDLDATA   pidlOut;
    USHORT         uSize;

    pidlOut = NULL;

    //Calculate the size of the MYPIDLDATA structure.
    uSize = sizeof(MYPIDLDATA);

    // Allocate enough memory for the PIDL to hold a MYPIDLDATA structure 
    // plus the terminator
    pidlOut = (LPMYPIDLDATA)m_pMalloc->Alloc(uSize + sizeof(USHORT));

    if(pidlOut)
    {
       //Assign values to the members of the MYPIDLDATA structure
       //that is the PIDL's first SHITEMID structure
       pidlOut->cb = uSize;
       pidlOut->dwType = dwType;
       hr = StringCbCopyW(pidlOut->wszDisplayName, 
                          sizeof(pidlOut->wszDisplayName), pwszDisplayName);
       
       // TODO: Add error handling here to verify the HRESULT returned 
       // by StringCbCopyW.

       //Advance the pointer to the start of the next SHITEMID structure.
       pidlOut = (LPMYPIDLDATA)((LPBYTE)pidlOut + pidlOut->cb);

       //Create the terminating null character by setting cb to 0.
       pidlOut->cb = 0;
    }

    return pidlOut;
```



<span data-ttu-id="0f205-303">Um PIDL totalmente qualificado deve ter estruturas [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) para cada objeto da área de trabalho para seu objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-303">A fully qualified PIDL must have [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures for every object from the desktop to your object.</span></span> <span data-ttu-id="0f205-304">Sua extensão recebe um PIDL totalmente qualificado para sua pasta raiz quando o Shell chama [**IPersistFolder:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize).</span><span class="sxs-lookup"><span data-stu-id="0f205-304">Your extension receives a fully qualified PIDL for your root folder when the Shell calls [**IPersistFolder::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize).</span></span> <span data-ttu-id="0f205-305">Para construir um PIDL totalmente qualificado para um objeto, pegue o PIDL que o Shell atribuiu à sua pasta raiz e acrescente as estruturas **SHITEMID** necessárias para levá-lo da pasta raiz para o objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-305">To construct a fully qualified PIDL for an object, take the PIDL that the Shell has assigned to your root folder, and append the **SHITEMID** structures that are needed to take you from the root folder to the object.</span></span>

### <a name="interpreting-pidls"></a><span data-ttu-id="0f205-306">Interpretando PIDLs</span><span class="sxs-lookup"><span data-stu-id="0f205-306">Interpreting PIDLs</span></span>

<span data-ttu-id="0f205-307">Quando o Shell ou um aplicativo chama uma das interfaces da extensão para solicitar informações sobre um objeto, ele geralmente identifica o objeto por um PIDL.</span><span class="sxs-lookup"><span data-stu-id="0f205-307">When the Shell or an application calls one of your extension's interfaces to request information about an object, it will usually identify the object by a PIDL.</span></span> <span data-ttu-id="0f205-308">Alguns métodos, como [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof), usam PIDLs que são relativos à pasta pai e são simples de interpretar.</span><span class="sxs-lookup"><span data-stu-id="0f205-308">Some methods, such as [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof), use PIDLs that are relative to the parent folder and are straightforward to interpret.</span></span> <span data-ttu-id="0f205-309">No entanto, sua extensão provavelmente também receberá PIDLs totalmente qualificado.</span><span class="sxs-lookup"><span data-stu-id="0f205-309">However, your extension will probably also receive fully qualified PIDLs.</span></span> <span data-ttu-id="0f205-310">O Gerenciador de PIDL deve determinar a quais dos seus objetos o PIDL está se referindo.</span><span class="sxs-lookup"><span data-stu-id="0f205-310">Your PIDL manager must then determine which of your objects that PIDL is referring to.</span></span>

<span data-ttu-id="0f205-311">O que complica a tarefa de associar um objeto a um PIDL totalmente qualificado é que uma ou mais das estruturas [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) iniciais no PIDL podem pertencer a objetos que ficam fora de sua extensão no namespace do Shell.</span><span class="sxs-lookup"><span data-stu-id="0f205-311">What complicates the task of associating an object with a fully qualified PIDL is that one or more of the initial [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures in the PIDL might belong to objects that lie outside your extension in the Shell namespace.</span></span> <span data-ttu-id="0f205-312">Você não tem como interpretar o significado do membro *abID* dessas estruturas.</span><span class="sxs-lookup"><span data-stu-id="0f205-312">You have no way of interpreting the meaning of the *abID* member of those structures.</span></span> <span data-ttu-id="0f205-313">O que sua extensão deve fazer é "percorrer" a lista de estruturas **SHITEMID** até chegar à estrutura que corresponde à sua pasta raiz.</span><span class="sxs-lookup"><span data-stu-id="0f205-313">What your extension must do is to "walk" the list of **SHITEMID** structures, until you reach the structure that corresponds to your root folder.</span></span> <span data-ttu-id="0f205-314">A partir de então, você saberá como interpretar as informações nas estruturas **SHITEMID** .</span><span class="sxs-lookup"><span data-stu-id="0f205-314">From then on, you will know how to interpret the information in the **SHITEMID** structures.</span></span>

<span data-ttu-id="0f205-315">Para percorrer o PIDL, pegue o primeiro valor *CB* e adicione-o ao endereço do PIDL para avançar o ponteiro até o início da próxima estrutura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) .</span><span class="sxs-lookup"><span data-stu-id="0f205-315">To walk the PIDL, take the first *cb* value and add it to the address of the PIDL to advance the pointer to the start of the next [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="0f205-316">Em seguida, ele apontará para o membro *CB* da estrutura, que pode ser usado para avançar o ponteiro até o início da próxima estrutura **SHITEMID** e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="0f205-316">It then will be pointing to that structure's *cb* member, which you can use to advance the pointer to the start of the next **SHITEMID** structure, and so on.</span></span> <span data-ttu-id="0f205-317">Cada vez que você avançar o ponteiro, examine a estrutura **SHITEMID** para determinar se você atingiu a raiz do namespace da extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-317">Each time you advance the pointer, examine the **SHITEMID** structure to determine whether you have reached the root of your extension's namespace.</span></span>

## <a name="implementing-the-primary-interfaces"></a><span data-ttu-id="0f205-318">Implementando as interfaces primárias</span><span class="sxs-lookup"><span data-stu-id="0f205-318">Implementing the Primary Interfaces</span></span>

<span data-ttu-id="0f205-319">Assim como acontece com todos os objetos COM, a implementação de uma extensão é basicamente uma questão de implementar uma coleção de interfaces.</span><span class="sxs-lookup"><span data-stu-id="0f205-319">As with all COM objects, implementing an extension is largely a matter of implementing a collection of interfaces.</span></span> <span data-ttu-id="0f205-320">Esta seção aborda as três interfaces primárias que devem ser implementadas por todas as extensões.</span><span class="sxs-lookup"><span data-stu-id="0f205-320">This section discusses the three primary interfaces that must be implemented by all extensions.</span></span> <span data-ttu-id="0f205-321">Eles são usados para inicialização e fornecem ao Windows Explorer informações básicas sobre o conteúdo da extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-321">They are used for initialization and to provide Windows Explorer with basic information about the contents of the extension.</span></span> <span data-ttu-id="0f205-322">Essas interfaces, além de uma [exibição de pasta](../lwef/nse-folderview.md), são todas necessárias para uma extensão funcional.</span><span class="sxs-lookup"><span data-stu-id="0f205-322">These interfaces, plus a [folder view](../lwef/nse-folderview.md), are all that is required for a functional extension.</span></span> <span data-ttu-id="0f205-323">No entanto, para explorar totalmente os recursos do Windows Explorer, a maioria das extensões também implementa uma ou mais das interfaces opcionais.</span><span class="sxs-lookup"><span data-stu-id="0f205-323">However, to fully exploit the features of Windows Explorer, most extensions also implement one or more of the optional interfaces.</span></span>

### <a name="ipersistfolder-interface"></a><span data-ttu-id="0f205-324">Interface IPersistFolder</span><span class="sxs-lookup"><span data-stu-id="0f205-324">IPersistFolder Interface</span></span>

<span data-ttu-id="0f205-325">A interface [**IPersistFolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) é chamada para inicializar um novo objeto de pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-325">The [**IPersistFolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) interface is called to initialize a new folder object.</span></span> <span data-ttu-id="0f205-326">O método [**IPersistFolder:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) atribui um PIDL totalmente qualificado ao novo objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-326">The [**IPersistFolder::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) method assigns a fully qualified PIDL to the new object.</span></span> <span data-ttu-id="0f205-327">Armazene esse PIDL para uso posterior.</span><span class="sxs-lookup"><span data-stu-id="0f205-327">Store this PIDL for later use.</span></span> <span data-ttu-id="0f205-328">Por exemplo, um objeto de pasta deve usar esse PIDL para construir PIDLs totalmente qualificado para os filhos do objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-328">For instance, a folder object must use this PIDL to construct fully qualified PIDLs for the object's children.</span></span> <span data-ttu-id="0f205-329">O criador do objeto de pasta também pode chamar [**IPersist:: GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) para solicitar o CLSID do objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-329">The folder object's creator can also call [**IPersist::GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) to request the object's CLSID.</span></span>

<span data-ttu-id="0f205-330">Normalmente, um objeto de pasta é criado e inicializado pelo método [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) da pasta pai.</span><span class="sxs-lookup"><span data-stu-id="0f205-330">Typically, a folder object is created and initialized by its parent folder's [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method.</span></span> <span data-ttu-id="0f205-331">No entanto, quando um usuário navega em sua extensão, o Windows Explorer cria e inicializa o objeto da pasta raiz da extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-331">However, when a user browses into your extension, Windows Explorer creates and initializes the extension's root folder object.</span></span> <span data-ttu-id="0f205-332">O PIDL que o objeto de pasta raiz recebe por meio de [**IPersistFolder:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) contém o caminho da área de trabalho para a pasta raiz que você precisará para construir PIDLs totalmente qualificado para sua extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-332">The PIDL that the root folder object receives through [**IPersistFolder::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ipersistfolder-initialize) contains the path from the desktop to the root folder that you will need to construct fully qualified PIDLs for your extension.</span></span>

### <a name="ishellfolder-interface"></a><span data-ttu-id="0f205-333">Interface IShellFolder</span><span class="sxs-lookup"><span data-stu-id="0f205-333">IShellFolder Interface</span></span>

<span data-ttu-id="0f205-334">O Shell trata uma extensão como uma coleção de objetos de pasta ordenada hierarquicamente.</span><span class="sxs-lookup"><span data-stu-id="0f205-334">The Shell treats an extension as a hierarchically ordered collection of folder objects.</span></span> <span data-ttu-id="0f205-335">A interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) é o núcleo de qualquer implementação de extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-335">The [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface is the core of any extension implementation.</span></span> <span data-ttu-id="0f205-336">Ele representa um objeto de pasta e fornece ao Windows Explorer muitas das informações necessárias para exibir o conteúdo da pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-336">It represents a folder object and provides Windows Explorer with much of the information needed to display the contents of the folder.</span></span>

<span data-ttu-id="0f205-337">[**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) normalmente é a única interface de pasta diferente de [**IPersistFolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) que é diretamente exposta por um objeto Folder.</span><span class="sxs-lookup"><span data-stu-id="0f205-337">[**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) is typically the only folder interface other than [**IPersistFolder**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder) that is directly exposed by a folder object.</span></span> <span data-ttu-id="0f205-338">Embora o Windows Explorer use uma variedade de interfaces obrigatórias e opcionais para obter informações sobre o conteúdo da pasta, ele obtém ponteiros para essas interfaces por meio do **IShellFolder**.</span><span class="sxs-lookup"><span data-stu-id="0f205-338">While Windows Explorer uses a variety of required and optional interfaces to obtain information about the contents of the folder, it obtains pointers to those interfaces through **IShellFolder**.</span></span>

<span data-ttu-id="0f205-339">O Windows Explorer Obtém o CLSID da pasta raiz da extensão de várias maneiras.</span><span class="sxs-lookup"><span data-stu-id="0f205-339">Windows Explorer obtains the CLSID of your extension's root folder in a variety of ways.</span></span> <span data-ttu-id="0f205-340">Para obter detalhes, consulte [especificando um local de extensão de namespace](nse-junction.md) ou [exibindo um Self-Contained exibição de uma extensão de namespace](nse-view.md).</span><span class="sxs-lookup"><span data-stu-id="0f205-340">For details, see [Specifying a Namespace Extension's Location](nse-junction.md) or [Displaying a Self-Contained View of a Namespace Extension](nse-view.md).</span></span> <span data-ttu-id="0f205-341">Em seguida, o Windows Explorer usa esse CLSID para criar e inicializar uma instância da pasta raiz e consultar uma interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="0f205-341">Windows Explorer then uses that CLSID to create and initialize an instance of the root folder and query for an [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="0f205-342">Sua extensão cria um objeto de pasta para representar a pasta raiz e retorna a interface **IShellFolder** do objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-342">Your extension creates a folder object to represent the root folder and returns the object's **IShellFolder** interface.</span></span> <span data-ttu-id="0f205-343">A maior parte do restante da interação entre a extensão e o Windows Explorer ocorre por meio de **IShellFolder**.</span><span class="sxs-lookup"><span data-stu-id="0f205-343">Much of the remainder of the interaction between your extension and Windows Explorer then takes place through **IShellFolder**.</span></span> <span data-ttu-id="0f205-344">O Windows Explorer chama **IShellFolder** para:</span><span class="sxs-lookup"><span data-stu-id="0f205-344">Windows Explorer calls **IShellFolder** to:</span></span>

-   <span data-ttu-id="0f205-345">Solicite um objeto que possa enumerar o conteúdo da pasta raiz.</span><span class="sxs-lookup"><span data-stu-id="0f205-345">Request an object that can enumerate the contents of the root folder.</span></span>
-   <span data-ttu-id="0f205-346">Obtenha vários tipos de informações sobre o conteúdo da pasta raiz.</span><span class="sxs-lookup"><span data-stu-id="0f205-346">Obtain various types of information about the contents of the root folder.</span></span>
-   <span data-ttu-id="0f205-347">Solicite um objeto que expõe uma das interfaces opcionais.</span><span class="sxs-lookup"><span data-stu-id="0f205-347">Request an object that exposes one of the optional interfaces.</span></span> <span data-ttu-id="0f205-348">Essas interfaces podem, então, ser consultadas para obter informações adicionais, como ícones ou menus de atalho.</span><span class="sxs-lookup"><span data-stu-id="0f205-348">Those interfaces can then be queried for additional information, such as icons or shortcut menus.</span></span>
-   <span data-ttu-id="0f205-349">Solicite um objeto Folder que represente uma subpasta da pasta raiz.</span><span class="sxs-lookup"><span data-stu-id="0f205-349">Request a folder object that represents a subfolder of the root folder.</span></span>

<span data-ttu-id="0f205-350">Quando um usuário abre uma subpasta da pasta raiz, o Windows Explorer chama [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject).</span><span class="sxs-lookup"><span data-stu-id="0f205-350">When a user opens a subfolder of the root folder, Windows Explorer calls [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject).</span></span> <span data-ttu-id="0f205-351">Sua extensão cria e inicializa um novo objeto de pasta para representar a subpasta e retorna sua interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="0f205-351">Your extension creates and initializes a new folder object to represent the subfolder and returns its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="0f205-352">Em seguida, o Windows Explorer chama essa interface para vários tipos de informações e assim por diante até que o usuário decida navegar em outro lugar no namespace do Shell ou fechar o Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="0f205-352">Windows Explorer then calls this interface for various types of information, and so on until the user decides to navigate elsewhere in the Shell namespace or close Windows Explorer.</span></span>

<span data-ttu-id="0f205-353">O restante desta seção aborda brevemente os métodos [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) mais importantes e como implementá-los.</span><span class="sxs-lookup"><span data-stu-id="0f205-353">The remainder of this section briefly discusses the more important [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods and how to implement them.</span></span>

### <a name="enumobjects"></a><span data-ttu-id="0f205-354">EnumObjects</span><span class="sxs-lookup"><span data-stu-id="0f205-354">EnumObjects</span></span>

<span data-ttu-id="0f205-355">Antes de exibir o conteúdo de uma pasta no modo de exibição de árvore, o Windows Explorer deve primeiro determinar o que a pasta contém chamando o método [**IShellFolder:: EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) .</span><span class="sxs-lookup"><span data-stu-id="0f205-355">Before displaying the contents of a folder in the tree view, Windows Explorer must first determine what the folder contains by calling the [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) method.</span></span> <span data-ttu-id="0f205-356">Esse método cria um objeto de enumeração OLE padrão que expõe uma interface [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) e retorna esse ponteiro de interface.</span><span class="sxs-lookup"><span data-stu-id="0f205-356">This method creates a standard OLE enumeration object that exposes an [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface and returns that interface pointer.</span></span> <span data-ttu-id="0f205-357">A interface **IEnumIDList** permite que o Windows Explorer obtenha o PIDLs de todos os objetos contidos na pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-357">The **IEnumIDList** interface allows Windows Explorer to obtain the PIDLs of all the objects contained by the folder.</span></span> <span data-ttu-id="0f205-358">Esses PIDLs são usados para obter informações sobre os objetos contidos na pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-358">These PIDLs are then used to obtain information about the objects contained by the folder.</span></span> <span data-ttu-id="0f205-359">Para obter mais detalhes, consulte [interface IEnumIDList](#ienumidlist-interface).</span><span class="sxs-lookup"><span data-stu-id="0f205-359">For further details, see [IEnumIDList Interface](#ienumidlist-interface).</span></span>

> [!Note]  
> <span data-ttu-id="0f205-360">O método [**IEnumIDList:: Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) deve retornar apenas PIDLs que são relativos à pasta pai.</span><span class="sxs-lookup"><span data-stu-id="0f205-360">The [**IEnumIDList::Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) method should only return PIDLs that are relative to the parent folder.</span></span> <span data-ttu-id="0f205-361">O PIDL deve conter apenas a estrutura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) do objeto, seguido por um terminador.</span><span class="sxs-lookup"><span data-stu-id="0f205-361">The PIDL should contain only the object's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure, followed by a terminator.</span></span>

 

### <a name="createviewobject"></a><span data-ttu-id="0f205-362">CreateViewObject</span><span class="sxs-lookup"><span data-stu-id="0f205-362">CreateViewObject</span></span>

<span data-ttu-id="0f205-363">Antes que o conteúdo de uma pasta seja exibido, o Windows Explorer chama esse método para solicitar um ponteiro para uma interface [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) .</span><span class="sxs-lookup"><span data-stu-id="0f205-363">Before the contents of a folder are displayed, Windows Explorer calls this method to request a pointer to an [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span> <span data-ttu-id="0f205-364">Essa interface é usada pelo Windows Explorer para gerenciar a exibição de pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-364">This interface is used by Windows Explorer to manage the folder view.</span></span> <span data-ttu-id="0f205-365">Crie um objeto de exibição de pasta e retorne sua interface **IShellView** .</span><span class="sxs-lookup"><span data-stu-id="0f205-365">Create a folder view object and return its **IShellView** interface.</span></span>

<span data-ttu-id="0f205-366">O método [**IShellFolder:: CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) também é chamado para solicitar uma das interfaces opcionais, como [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), para a própria pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-366">The [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) method is also called to request one of the optional interfaces, such as [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), for the folder itself.</span></span> <span data-ttu-id="0f205-367">A implementação desse método deve criar um objeto que expõe a interface solicitada e retorna o ponteiro de interface.</span><span class="sxs-lookup"><span data-stu-id="0f205-367">Your implementation of this method should create an object that exposes the requested interface and returns the interface pointer.</span></span> <span data-ttu-id="0f205-368">Se o Windows Explorer precisar de uma interface opcional para um dos objetos contidos na pasta, ele chamará [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof).</span><span class="sxs-lookup"><span data-stu-id="0f205-368">If Windows Explorer needs an optional interface for one of the objects contained by the folder, it will call [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof).</span></span>

### <a name="getuiobjectof"></a><span data-ttu-id="0f205-369">GetUIObjectOf</span><span class="sxs-lookup"><span data-stu-id="0f205-369">GetUIObjectOf</span></span>

<span data-ttu-id="0f205-370">Embora as informações básicas sobre o conteúdo de uma pasta estejam disponíveis por meio dos métodos [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) , sua extensão também pode fornecer ao Windows Explorer vários tipos de informações adicionais.</span><span class="sxs-lookup"><span data-stu-id="0f205-370">While basic information about the contents of a folder is available through the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods, your extension can also provide Windows Explorer with various kinds of additional information.</span></span> <span data-ttu-id="0f205-371">Por exemplo, você pode especificar ícones para o conteúdo de uma pasta ou menu de atalho de um objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-371">For instance, you can specify icons for the contents of a folder or an object's shortcut menu.</span></span> <span data-ttu-id="0f205-372">O Windows Explorer chama o método [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) para tentar recuperar informações adicionais sobre um objeto contido em uma pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-372">Windows Explorer calls the [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) method to attempt to retrieve additional information about an object that is contained by a folder.</span></span> <span data-ttu-id="0f205-373">O Windows Explorer especifica para qual objeto ele deseja as informações e o IID da interface relevante.</span><span class="sxs-lookup"><span data-stu-id="0f205-373">Windows Explorer specifies which object it wants the information for, and the IID of the relevant interface.</span></span> <span data-ttu-id="0f205-374">Em seguida, o objeto Folder cria um objeto que expõe a interface solicitada e retorna o ponteiro da interface.</span><span class="sxs-lookup"><span data-stu-id="0f205-374">The folder object then creates an object that exposes the requested interface and returns the interface pointer.</span></span>

<span data-ttu-id="0f205-375">Se sua extensão permitir que os usuários transfiram objetos com o recurso de arrastar e soltar ou a área de transferência, o Windows Explorer chamará [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) para solicitar uma interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) ou [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) .</span><span class="sxs-lookup"><span data-stu-id="0f205-375">If your extension allows users to transfer objects with drag-and-drop or the clipboard, Windows Explorer will call [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) to request an [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) or [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span> <span data-ttu-id="0f205-376">Para obter detalhes, consulte [transferindo objetos do shell com o recurso de arrastar e soltar e a área de transferência](dragdrop.md).</span><span class="sxs-lookup"><span data-stu-id="0f205-376">For details, see [Transferring Shell Objects with Drag-and-Drop and the Clipboard](dragdrop.md).</span></span>

<span data-ttu-id="0f205-377">O Windows Explorer chama [**IShellFolder:: CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) quando deseja o mesmo tipo de informação sobre a própria pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-377">Windows Explorer calls [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) when it wants the same sort of information about the folder itself.</span></span>

### <a name="bindtoobject"></a><span data-ttu-id="0f205-378">BindToObject</span><span class="sxs-lookup"><span data-stu-id="0f205-378">BindToObject</span></span>

<span data-ttu-id="0f205-379">O Windows Explorer chama o método [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) quando um usuário tenta abrir uma das subpastas da extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-379">Windows Explorer calls the [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method when a user attempts to open one of your extension's subfolders.</span></span> <span data-ttu-id="0f205-380">Se *riid* estiver definido como IID \_ IShellFolder, você deverá criar e inicializar um objeto Folder que representa a subpasta e retornar a interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) do objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-380">If *riid* is set to IID\_IShellFolder, you should create and initialize a folder object that represents the subfolder and return the object's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span>

> [!Note]  
> <span data-ttu-id="0f205-381">No momento, o Windows Explorer chama esse método somente para solicitar uma interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="0f205-381">At present, Windows Explorer calls this method only to request an [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="0f205-382">No entanto, não assuma que esse será sempre o caso.</span><span class="sxs-lookup"><span data-stu-id="0f205-382">However, do not assume that this will always be the case.</span></span> <span data-ttu-id="0f205-383">Você sempre deve verificar o valor de *riid* antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="0f205-383">You should always check the value of *riid* before proceeding.</span></span>

 

### <a name="getdisplaynameof"></a><span data-ttu-id="0f205-384">GetDisplayNameOf</span><span class="sxs-lookup"><span data-stu-id="0f205-384">GetDisplayNameOf</span></span>

<span data-ttu-id="0f205-385">O Windows Explorer chama o método [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) para converter o PIDL de um dos objetos da pasta em um nome.</span><span class="sxs-lookup"><span data-stu-id="0f205-385">Windows Explorer calls the [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) method to convert the PIDL of one of the folder's objects into a name.</span></span> <span data-ttu-id="0f205-386">Esse PIDL deve ser relativo à pasta pai do objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-386">That PIDL must be relative to the object's parent folder.</span></span> <span data-ttu-id="0f205-387">Em outras palavras, ele deve conter uma única estrutura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) não **nula** .</span><span class="sxs-lookup"><span data-stu-id="0f205-387">In other words, it must contain a single non-**NULL** [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure.</span></span> <span data-ttu-id="0f205-388">Como há mais de uma possível maneira de nomear objetos, o Windows Explorer especifica o tipo de nome definindo um ou mais sinalizadores [**SHGDNF**](/windows/win32/api/shobjidl_core/ne-shobjidl_core-_shgdnf) no parâmetro *uFlags* .</span><span class="sxs-lookup"><span data-stu-id="0f205-388">Because there is more than one possible way to name objects, Windows Explorer specifies the type of name by setting one or more [**SHGDNF**](/windows/win32/api/shobjidl_core/ne-shobjidl_core-_shgdnf) flags in the *uFlags* parameter.</span></span> <span data-ttu-id="0f205-389">Um dos dois valores, **SHGDN \_ normal** ou **SHGDN \_**, será definido para especificar se o nome deve ser relativo à pasta ou em relação à área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="0f205-389">One of two values, **SHGDN\_NORMAL** or **SHGDN\_INFOLDER**, will be set to specify whether the name should be relative to the folder or relative to the desktop.</span></span> <span data-ttu-id="0f205-390">Um dos outros três valores, **SHGDN \_ FOREDITING**, **SHGDN \_ FORADDRESSBAR** ou **SHGDN \_ FORPARSING**, pode ser definido para especificar para que o nome será usado.</span><span class="sxs-lookup"><span data-stu-id="0f205-390">One of the other three values, **SHGDN\_FOREDITING**, **SHGDN\_FORADDRESSBAR**, or **SHGDN\_FORPARSING**, can be set to specify what the name will be used for.</span></span>

<span data-ttu-id="0f205-391">Você deve retornar o nome na forma de uma estrutura [**Strret**](/windows/desktop/api/Shtypes/ns-shtypes-strret) .</span><span class="sxs-lookup"><span data-stu-id="0f205-391">You must return the name in the form of an [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) structure.</span></span> <span data-ttu-id="0f205-392">Se **SHGDN \_ FOREDITING**, **SHGDN \_ FORADDRESSBAR** e **SHGDN \_ FORPARSING** não estiverem definidos, retornará o nome de exibição do objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-392">If **SHGDN\_FOREDITING**, **SHGDN\_FORADDRESSBAR**, and **SHGDN\_FORPARSING** are not set, return the object's display name.</span></span> <span data-ttu-id="0f205-393">Se o sinalizador **SHGDN \_ FORPARSING** for definido, o Windows Explorer está solicitando um nome de análise.</span><span class="sxs-lookup"><span data-stu-id="0f205-393">If the **SHGDN\_FORPARSING** flag is set, Windows Explorer is requesting a parsing name.</span></span> <span data-ttu-id="0f205-394">Os nomes de análise são passados para [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) para obter o PIDL de um objeto, embora ele possa estar localizado um ou mais níveis abaixo da pasta atual na hierarquia de namespace.</span><span class="sxs-lookup"><span data-stu-id="0f205-394">Parsing names are passed to [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) to obtain an object's PIDL, even though it might be located one or more levels below the current folder in the namespace hierarchy.</span></span> <span data-ttu-id="0f205-395">Por exemplo, o nome de análise de um objeto do sistema de arquivos é seu caminho.</span><span class="sxs-lookup"><span data-stu-id="0f205-395">For example, the parsing name of a file system object is its path.</span></span> <span data-ttu-id="0f205-396">Você pode passar o caminho totalmente qualificado de qualquer objeto no sistema de arquivos para o método IShellFolder da área de trabalho **::P arsedisplayname** , e retornará o PIDL totalmente qualificado do objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-396">You can pass the fully qualified path of any object in the file system to the desktop's **IShellFolder::ParseDisplayName** method, and it will return the object's fully qualified PIDL.</span></span>

<span data-ttu-id="0f205-397">Embora os nomes de análise sejam cadeias de caracteres de texto, eles não precisam necessariamente incluir o nome de exibição.</span><span class="sxs-lookup"><span data-stu-id="0f205-397">While parsing names are text strings, they do not necessarily have to include the display name.</span></span> <span data-ttu-id="0f205-398">Você deve atribuir nomes de análise com base no que funcionará mais eficientemente quando [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) for chamado.</span><span class="sxs-lookup"><span data-stu-id="0f205-398">You should assign parsing names based on what will work most efficiently when [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) is called.</span></span> <span data-ttu-id="0f205-399">Por exemplo, muitas das pastas virtuais do shell não fazem parte do sistema de arquivos e não têm um caminho totalmente qualificado.</span><span class="sxs-lookup"><span data-stu-id="0f205-399">For instance, many of the Shell's virtual folders are not part of the file system and do not have a fully qualified path.</span></span> <span data-ttu-id="0f205-400">Em vez disso, cada pasta recebe um GUID e o nome de análise tem o formato: {GUID}.</span><span class="sxs-lookup"><span data-stu-id="0f205-400">Instead, each folder is assigned a GUID and the parsing name takes the form ::{GUID}.</span></span> <span data-ttu-id="0f205-401">Independentemente de qual esquema você usar, ele deve ser capaz de "viagem de ida e volta confiável".</span><span class="sxs-lookup"><span data-stu-id="0f205-401">Regardless of what scheme you use, it should be able to reliably "round trip."</span></span> <span data-ttu-id="0f205-402">Por exemplo, se um chamador passar um nome de análise para **IShellFolder::P arsedisplayname** para recuperar o PIDL de um objeto e, em seguida, passar esse PIDL para [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) **com o sinalizador SHGDN FORPARSING \_** definido, o chamador deverá recuperar o nome de análise original.</span><span class="sxs-lookup"><span data-stu-id="0f205-402">For instance, if a caller passes a parsing name to **IShellFolder::ParseDisplayName** to retrieve an object's PIDL, and then passes that PIDL to [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) with the **SHGDN\_FORPARSING** flag set, the caller should recover the original parsing name.</span></span>

### <a name="getattributesof"></a><span data-ttu-id="0f205-403">GetAttributesOf</span><span class="sxs-lookup"><span data-stu-id="0f205-403">GetAttributesOf</span></span>

<span data-ttu-id="0f205-404">O Windows Explorer chama o método [**IShellFolder:: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) para determinar os atributos de um ou mais itens contidos em um objeto Folder.</span><span class="sxs-lookup"><span data-stu-id="0f205-404">Windows Explorer calls the [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) method to determine the attributes of one or more items contained by a folder object.</span></span> <span data-ttu-id="0f205-405">O valor de *cidl* fornece o número de itens na consulta e *aPidl* aponta para uma lista de seus PIDLs.</span><span class="sxs-lookup"><span data-stu-id="0f205-405">The value of *cidl* gives the number of items in the query, and *aPidl* points to a list of their PIDLs.</span></span>

<span data-ttu-id="0f205-406">Como os testes de alguns atributos podem ser demorados, o Windows Explorer normalmente restringe a consulta a um subconjunto dos sinalizadores disponíveis definindo seus valores em *rfgInOut*.</span><span class="sxs-lookup"><span data-stu-id="0f205-406">Because testing for some attributes can be time consuming, Windows Explorer typically restricts the query to a subset of the available flags by setting their values in *rfgInOut*.</span></span> <span data-ttu-id="0f205-407">Seu método deve testar somente os atributos cujos sinalizadores são definidos em *rfgInOut*.</span><span class="sxs-lookup"><span data-stu-id="0f205-407">Your method should test for only those attributes whose flags are set in *rfgInOut*.</span></span> <span data-ttu-id="0f205-408">Deixe os sinalizadores válidos definidos e desmarque o restante.</span><span class="sxs-lookup"><span data-stu-id="0f205-408">Leave the valid flags set and clear the remainder.</span></span> <span data-ttu-id="0f205-409">Se mais de um item for incluído na consulta, defina somente os sinalizadores que se aplicam a todos os itens.</span><span class="sxs-lookup"><span data-stu-id="0f205-409">If more than one item is included in the query, set only those flags that apply to all items.</span></span>

> [!Note]  
> <span data-ttu-id="0f205-410">Os atributos devem ser definidos corretamente para que um item seja exibido corretamente.</span><span class="sxs-lookup"><span data-stu-id="0f205-410">The attributes must be properly set for an item to be correctly displayed.</span></span> <span data-ttu-id="0f205-411">Por exemplo, se um item for uma pasta que contém subpastas, você deverá definir o sinalizador **SFGAO \_ HASSUBFOLDER** .</span><span class="sxs-lookup"><span data-stu-id="0f205-411">For instance, if an item is a folder that contains subfolders, you must set the **SFGAO\_HASSUBFOLDER** flag.</span></span> <span data-ttu-id="0f205-412">Caso contrário, o Windows Explorer não exibirá um + próximo ao ícone do item no modo de exibição de árvore.</span><span class="sxs-lookup"><span data-stu-id="0f205-412">Otherwise, Windows Explorer will not display a + next to the item's icon in the tree view.</span></span>

 

### <a name="parsedisplayname"></a><span data-ttu-id="0f205-413">ParseDisplayName</span><span class="sxs-lookup"><span data-stu-id="0f205-413">ParseDisplayName</span></span>

<span data-ttu-id="0f205-414">O método [**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) é, de certa forma, uma imagem espelho de [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span><span class="sxs-lookup"><span data-stu-id="0f205-414">The [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) method is in some sense a mirror image of [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span></span> <span data-ttu-id="0f205-415">O uso mais comum desse método é converter o nome de análise de um objeto no PIDL associado.</span><span class="sxs-lookup"><span data-stu-id="0f205-415">The most common use of this method is to convert an object's parsing name into the associated PIDL.</span></span> <span data-ttu-id="0f205-416">O nome de análise pode se referir a qualquer objeto que esteja abaixo da pasta na hierarquia de namespace.</span><span class="sxs-lookup"><span data-stu-id="0f205-416">The parsing name can refer to any object that lies below the folder in the namespace hierarchy.</span></span> <span data-ttu-id="0f205-417">O PIDL retornado é relativo ao objeto Folder que expõe o método e geralmente não é totalmente qualificado.</span><span class="sxs-lookup"><span data-stu-id="0f205-417">The returned PIDL is relative to the folder object that exposes the method and is usually not fully qualified.</span></span> <span data-ttu-id="0f205-418">Em outras palavras, embora o PIDL possa conter várias estruturas [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) , a primeira será a do próprio objeto ou a primeira subpasta no caminho da pasta para o objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-418">In other words, although the PIDL can contain several [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures, the first will either be that of the object itself or the first subfolder in the path from the folder to the object.</span></span> <span data-ttu-id="0f205-419">O chamador terá que acrescentar esse PIDL ao PIDL totalmente qualificado da pasta para obter um PIDL totalmente qualificado para o objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-419">The caller will have to append this PIDL to the folder's fully qualified PIDL to obtain a fully qualified PIDL for the object.</span></span>

<span data-ttu-id="0f205-420">[**IShellFolder::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) também pode ser chamado para solicitar os atributos de um objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-420">[**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) can also be called to request an object's attributes.</span></span> <span data-ttu-id="0f205-421">Como a determinação de todos os atributos aplicáveis pode ser demorada, o chamador definirá apenas os sinalizadores [**SFGAO \_ xxx**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) que representam as informações que o chamador está interessado.</span><span class="sxs-lookup"><span data-stu-id="0f205-421">Because determining all the applicable attributes can be time consuming, the caller will set only those [**SFGAO\_XXX**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) flags that represent information that the caller is interested in.</span></span> <span data-ttu-id="0f205-422">Você deve determinar quais desses atributos são verdadeiros para o objeto e desmarcar os sinalizadores restantes.</span><span class="sxs-lookup"><span data-stu-id="0f205-422">You should determine which of those attributes are true for the object, and clear the remaining flags.</span></span>

### <a name="ienumidlist-interface"></a><span data-ttu-id="0f205-423">Interface IEnumIDList</span><span class="sxs-lookup"><span data-stu-id="0f205-423">IEnumIDList Interface</span></span>

<span data-ttu-id="0f205-424">Quando o Windows Explorer precisa enumerar os objetos que estão contidos em uma pasta, ele chama [**IShellFolder:: EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects).</span><span class="sxs-lookup"><span data-stu-id="0f205-424">When Windows Explorer needs to enumerate the objects that are contained by a folder, it calls [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects).</span></span> <span data-ttu-id="0f205-425">O objeto Folder deve criar um objeto de enumeração que expõe a interface [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) e retornar esse ponteiro de interface.</span><span class="sxs-lookup"><span data-stu-id="0f205-425">The folder object must create an enumeration object that exposes the [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface and return that interface pointer.</span></span> <span data-ttu-id="0f205-426">O Windows Explorer normalmente usará **IEnumIDList** para enumerar o PIDLs de todos os objetos contidos na pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-426">Windows Explorer will then typically use **IEnumIDList** to enumerate the PIDLs of all the objects contained by the folder.</span></span>

<span data-ttu-id="0f205-427">[**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) é uma interface de enumeração OLE padrão e é implementada da maneira usual.</span><span class="sxs-lookup"><span data-stu-id="0f205-427">[**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) is a standard OLE enumeration interface and is implemented in the usual way.</span></span> <span data-ttu-id="0f205-428">Lembre-se, no entanto, de que o PIDLs retornado deve ser relativo à pasta e conter apenas a estrutura [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) do objeto e um terminador.</span><span class="sxs-lookup"><span data-stu-id="0f205-428">Remember, however, that the PIDLs that you return must be relative to the folder and contain only the object's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structure and a terminator.</span></span>

## <a name="implementing-the-optional-interfaces"></a><span data-ttu-id="0f205-429">Implementando as interfaces opcionais</span><span class="sxs-lookup"><span data-stu-id="0f205-429">Implementing the Optional Interfaces</span></span>

<span data-ttu-id="0f205-430">Há várias interfaces de shell opcionais às quais os objetos de pasta da extensão podem dar suporte.</span><span class="sxs-lookup"><span data-stu-id="0f205-430">There are a number of optional Shell interfaces that your extension's folder objects can support.</span></span> <span data-ttu-id="0f205-431">Muitos deles, como o [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona), permitem que você personalize vários aspectos da maneira como o usuário exibe sua extensão.</span><span class="sxs-lookup"><span data-stu-id="0f205-431">Many of them, such as [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona), allow you to customize various aspects of the way the user views your extension.</span></span> <span data-ttu-id="0f205-432">Outros, como [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), permitem que sua extensão dê suporte a recursos como arrastar e soltar.</span><span class="sxs-lookup"><span data-stu-id="0f205-432">Others, such as [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), allow your extension to support features such as drag-and-drop.</span></span>

<span data-ttu-id="0f205-433">Nenhuma das interfaces opcionais é exposta diretamente por um objeto Folder.</span><span class="sxs-lookup"><span data-stu-id="0f205-433">None of the optional interfaces are exposed directly by a folder object.</span></span> <span data-ttu-id="0f205-434">Em vez disso, o Windows Explorer chama um dos dois métodos [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) para solicitar uma interface:</span><span class="sxs-lookup"><span data-stu-id="0f205-434">Instead, Windows Explorer calls one of two [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) methods to request an interface:</span></span>

-   <span data-ttu-id="0f205-435">O Windows Explorer chama o [**IShellFolder:: GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) de um objeto de pasta para solicitar uma interface para um dos objetos contidos na pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-435">Windows Explorer calls a folder object's [**IShellFolder::GetUIObjectOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getuiobjectof) to request an interface for one of the objects contained by the folder.</span></span>
-   <span data-ttu-id="0f205-436">O Windows Explorer chama o [**IShellFolder:: CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) de um objeto de pasta para solicitar uma interface para a própria pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-436">Windows Explorer calls a folder object's [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) to request an interface for the folder itself.</span></span>

<span data-ttu-id="0f205-437">Para fornecer as informações, o objeto Folder cria um objeto que expõe a interface solicitada e retorna o ponteiro da interface.</span><span class="sxs-lookup"><span data-stu-id="0f205-437">To provide the information, the folder object creates an object that exposes the requested interface and returns the interface pointer.</span></span> <span data-ttu-id="0f205-438">Em seguida, o Windows Explorer chama essa interface para recuperar as informações necessárias.</span><span class="sxs-lookup"><span data-stu-id="0f205-438">Windows Explorer then calls that interface to retrieve the needed information.</span></span> <span data-ttu-id="0f205-439">Esta seção aborda as interfaces opcionais usadas com mais frequência.</span><span class="sxs-lookup"><span data-stu-id="0f205-439">This section discusses the most commonly used optional interfaces.</span></span>

### <a name="iextracticon"></a><span data-ttu-id="0f205-440">IExtractIcon</span><span class="sxs-lookup"><span data-stu-id="0f205-440">IExtractIcon</span></span>

<span data-ttu-id="0f205-441">O Windows Explorer solicita uma interface [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona) antes de exibir o conteúdo de uma pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-441">Windows Explorer requests an [**IExtractIcon**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona) interface before it displays the contents of a folder.</span></span> <span data-ttu-id="0f205-442">A interface permite que sua extensão especifique ícones personalizados para os objetos contidos na pasta.</span><span class="sxs-lookup"><span data-stu-id="0f205-442">The interface allows your extension to specify custom icons for the objects that are contained by the folder.</span></span> <span data-ttu-id="0f205-443">Caso contrário, os ícones padrão de arquivo e pasta serão usados.</span><span class="sxs-lookup"><span data-stu-id="0f205-443">Otherwise, the standard file and folder icons will be used.</span></span> <span data-ttu-id="0f205-444">Para fornecer um ícone personalizado, crie um objeto de extração de ícone que expõe **IExtractIcon** e retorne um ponteiro para essa interface.</span><span class="sxs-lookup"><span data-stu-id="0f205-444">To provide a custom icon, create an icon extraction object that exposes **IExtractIcon** and return a pointer to that interface.</span></span> <span data-ttu-id="0f205-445">Para mais discussões, consulte a documentação de referência do **IExtractIcon** ou [criando manipuladores de ícones](./how-to-create-icon-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="0f205-445">For further discussion, see the **IExtractIcon** reference documentation or [Creating Icon Handlers](./how-to-create-icon-handlers.md).</span></span>

### <a name="icontextmenu"></a><span data-ttu-id="0f205-446">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="0f205-446">IContextMenu</span></span>

<span data-ttu-id="0f205-447">Quando um usuário clica com o botão direito do mouse em um objeto, o Windows Explorer solicita uma interface [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) .</span><span class="sxs-lookup"><span data-stu-id="0f205-447">When a user right-clicks an object, Windows Explorer requests an [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) interface.</span></span> <span data-ttu-id="0f205-448">Para fornecer menus de atalho para seus objetos, crie um objeto de manipulador de menu e retorne sua interface **IContextMenu** .</span><span class="sxs-lookup"><span data-stu-id="0f205-448">To provide shortcut menus for your objects, create a menu handler object and return its **IContextMenu** interface.</span></span>

<span data-ttu-id="0f205-449">Os procedimentos para criar um objeto de manipulador de menu são muito semelhantes aos usados para criar uma extensão de Shell de manipulador de menu.</span><span class="sxs-lookup"><span data-stu-id="0f205-449">The procedures for creating a menu handler object are very similar to those used to create a menu handler Shell extension.</span></span> <span data-ttu-id="0f205-450">Para obter detalhes, consulte [criando manipuladores de menu de contexto](context-menu-handlers.md) ou a referência de [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IContextMenu2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2)ou [**IContextMenu3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu3) .</span><span class="sxs-lookup"><span data-stu-id="0f205-450">For details, see [Creating Context Menu Handlers](context-menu-handlers.md) or the [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IContextMenu2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2), or [**IContextMenu3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu3) reference.</span></span>

### <a name="iqueryinfo"></a><span data-ttu-id="0f205-451">IQueryInfo</span><span class="sxs-lookup"><span data-stu-id="0f205-451">IQueryInfo</span></span>

<span data-ttu-id="0f205-452">O Windows Explorer chama a interface [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) para recuperar uma cadeia de caracteres de texto InfoTip.</span><span class="sxs-lookup"><span data-stu-id="0f205-452">Windows Explorer calls the [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) interface to retrieve an infotip text string.</span></span>

### <a name="idataobject-and-idroptarget"></a><span data-ttu-id="0f205-453">IDataObject e IDropTarget</span><span class="sxs-lookup"><span data-stu-id="0f205-453">IDataObject and IDropTarget</span></span>

<span data-ttu-id="0f205-454">Quando os objetos são exibidos pelo Windows Explorer, um objeto de pasta não tem uma maneira direta de saber quando um usuário está tentando recortar, copiar ou arrastar um objeto.</span><span class="sxs-lookup"><span data-stu-id="0f205-454">When your objects are displayed by Windows Explorer, a folder object has no direct way to know when a user is attempting to cut, copy, or drag an object.</span></span> <span data-ttu-id="0f205-455">Em vez disso, o Windows Explorer solicita uma interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) .</span><span class="sxs-lookup"><span data-stu-id="0f205-455">Instead, Windows Explorer requests an [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="0f205-456">Para permitir que o objeto seja transferido, crie um objeto de dados e retorne um ponteiro para a interface **IDataObject** .</span><span class="sxs-lookup"><span data-stu-id="0f205-456">To allow the object to be transferred, create a data object and return a pointer to its **IDataObject** interface.</span></span>

<span data-ttu-id="0f205-457">Da mesma forma, um usuário pode tentar remover um objeto de dados em uma representação do Windows Explorer de um de seus objetos, como um ícone ou caminho da barra de endereços.</span><span class="sxs-lookup"><span data-stu-id="0f205-457">Similarly, a user might attempt to drop a data object on a Windows Explorer representation of one of your objects, such as an icon or address bar path.</span></span> <span data-ttu-id="0f205-458">Em seguida, o Windows Explorer solicita uma interface [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) .</span><span class="sxs-lookup"><span data-stu-id="0f205-458">Windows Explorer then requests an [**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) interface.</span></span> <span data-ttu-id="0f205-459">Para permitir que o objeto de dados seja removido, crie um objeto que expõe uma interface **IDropTarget** e retorne o ponteiro de interface.</span><span class="sxs-lookup"><span data-stu-id="0f205-459">To allow the data object to be dropped, create an object that exposes an **IDropTarget** interface and return the interface pointer.</span></span>

<span data-ttu-id="0f205-460">A manipulação de transferência de dados é um dos aspectos mais complicados da gravação de extensões de namespace.</span><span class="sxs-lookup"><span data-stu-id="0f205-460">Handling data transfer is one of the trickier aspects of writing namespace extensions.</span></span> <span data-ttu-id="0f205-461">Para obter uma discussão detalhada, consulte [transferindo objetos do shell com o recurso de arrastar e soltar e a área de transferência](dragdrop.md).</span><span class="sxs-lookup"><span data-stu-id="0f205-461">For a detailed discussion, see [Transferring Shell Objects with Drag-and-Drop and the Clipboard](dragdrop.md).</span></span>

## <a name="working-with-the-default-shell-folder-view-implementation"></a><span data-ttu-id="0f205-462">Trabalhando com a implementação de exibição de pasta do shell padrão</span><span class="sxs-lookup"><span data-stu-id="0f205-462">Working With the Default Shell Folder View Implementation</span></span>

<span data-ttu-id="0f205-463">As fontes de dados que usam o objeto de exibição de pasta do shell padrão (DefView) devem implementar essas interfaces:</span><span class="sxs-lookup"><span data-stu-id="0f205-463">Data sources that use the default Shell folder view object (DefView) must implement these interfaces:</span></span>

-   [<span data-ttu-id="0f205-464">**IShellFolder**</span><span class="sxs-lookup"><span data-stu-id="0f205-464">**IShellFolder**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder)
-   [<span data-ttu-id="0f205-465">**IShellFolder2**</span><span class="sxs-lookup"><span data-stu-id="0f205-465">**IShellFolder2**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellfolder2)
-   [<span data-ttu-id="0f205-466">**IPersistFolder**</span><span class="sxs-lookup"><span data-stu-id="0f205-466">**IPersistFolder**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder)
-   [<span data-ttu-id="0f205-467">**IPersistFolder2**</span><span class="sxs-lookup"><span data-stu-id="0f205-467">**IPersistFolder2**</span></span>](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2)

<span data-ttu-id="0f205-468">Opcionalmente, eles também podem implementar [**IPersistFolder3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span><span class="sxs-lookup"><span data-stu-id="0f205-468">Optionally, they can also implement [**IPersistFolder3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span></span>

 

 
