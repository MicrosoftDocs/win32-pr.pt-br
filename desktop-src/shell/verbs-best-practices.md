---
description: Entenda as práticas recomendadas para manipuladores de menu de atalho e vários verbos ao implementar um formato de arquivo personalizado no Shell do Windows.
title: Práticas recomendadas para manipuladores de menu de atalho e vários verbos
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 4D352ECB-6214-4f6e-A3E5-F79E154D090A
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 14ec2e8915aa1df47ca21c6436ec963be3f590f5
ms.sourcegitcommit: 91530c19d26ba4c57a6af1f37b57f211f580464e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/19/2021
ms.locfileid: "112396441"
---
# <a name="best-practices-for-shortcut-menu-handlers-and-multiple-verbs"></a><span data-ttu-id="f913b-103">Práticas recomendadas para manipuladores de menu de atalho e vários verbos</span><span class="sxs-lookup"><span data-stu-id="f913b-103">Best Practices for Shortcut Menu Handlers and Multiple Verbs</span></span>

<span data-ttu-id="f913b-104">Este tópico é organizado da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="f913b-104">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="f913b-105">Práticas recomendadas</span><span class="sxs-lookup"><span data-stu-id="f913b-105">Best Practices</span></span>](#best-practices-for-shortcut-menu-handlers-and-multiple-verbs)
    -   [<span data-ttu-id="f913b-106">Práticas recomendadas para implementações de verbo</span><span class="sxs-lookup"><span data-stu-id="f913b-106">Best Practices for Verb Implementations</span></span>](#best-practices-for-verb-implementations)
-   [<span data-ttu-id="f913b-107">Práticas recomendadas para verbos de seleção múltipla</span><span class="sxs-lookup"><span data-stu-id="f913b-107">Best Practices for Multiple Selection Verbs</span></span>](#best-practices-for-multiple-selection-verbs)
    -   [<span data-ttu-id="f913b-108">Seleções heterogêneas</span><span class="sxs-lookup"><span data-stu-id="f913b-108">Heterogenous Selections</span></span>](#heterogenous-selections)
-   [<span data-ttu-id="f913b-109">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="f913b-109">Related topics</span></span>](#related-topics)

## <a name="best-practices"></a><span data-ttu-id="f913b-110">Práticas Recomendadas</span><span class="sxs-lookup"><span data-stu-id="f913b-110">Best Practices</span></span>

<span data-ttu-id="f913b-111">O verbo estático é um verbo mais simples para implementar e fornecer funcionalidade avançada.</span><span class="sxs-lookup"><span data-stu-id="f913b-111">Static verb are simplest verbs to implement, and provide rich functionality.</span></span> <span data-ttu-id="f913b-112">Recomendamos que você implemente um verbo usando um dos métodos de verbo estáticos.</span><span class="sxs-lookup"><span data-stu-id="f913b-112">We strongly encourage you to implement a verb using one of the static verb methods.</span></span>

### <a name="best-practices-for-verb-implementations"></a><span data-ttu-id="f913b-113">Práticas recomendadas para implementações de verbo</span><span class="sxs-lookup"><span data-stu-id="f913b-113">Best Practices for Verb Implementations</span></span>

<span data-ttu-id="f913b-114">A lista a seguir representa as práticas recomendadas para implementações de verbo:</span><span class="sxs-lookup"><span data-stu-id="f913b-114">The following list represents best practices for verb implementations:</span></span>

-   <span data-ttu-id="f913b-115">Sempre escolha o método de verbo mais simples que atenda às suas necessidades.</span><span class="sxs-lookup"><span data-stu-id="f913b-115">Always chose the simplest verb method that meets your needs.</span></span>
-   <span data-ttu-id="f913b-116">Use um método verbo estático, se possível.</span><span class="sxs-lookup"><span data-stu-id="f913b-116">Use a static verb method, if possible.</span></span>
-   <span data-ttu-id="f913b-117">Não execute operações com uso intensivo de recursos ou e/s no thread da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="f913b-117">Do not perform resource-intensive operations or I/O on the UI thread.</span></span> <span data-ttu-id="f913b-118">Ambos os [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) e [**IContextMenu:: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) precisam ser muito conservadores no trabalho que eles executam.</span><span class="sxs-lookup"><span data-stu-id="f913b-118">Both [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) and [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) need to be very conservative in the work they perform.</span></span> <span data-ttu-id="f913b-119">[**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) deve ser executado em outro processo ou você deve criar um novo thread para evitar o bloqueio do chamador.</span><span class="sxs-lookup"><span data-stu-id="f913b-119">[**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) must be performed in another process, or you must create a new thread to avoid blocking the caller.</span></span>
-   <span data-ttu-id="f913b-120">Prefixe os verbos com o nome ISV (fornecedor independente de software) da seguinte maneira, `ISVName.verb` .</span><span class="sxs-lookup"><span data-stu-id="f913b-120">Prefix verbs with the independent software vendor (ISV) name as follows, `ISVName.verb`.</span></span> <span data-ttu-id="f913b-121">O uso de nomes não qualificados pode resultar em colisões com vários ISVs que escolhem o mesmo nome de verbo.</span><span class="sxs-lookup"><span data-stu-id="f913b-121">Using unqualified names can result in collisions with multiple ISVs that chose the same verb name.</span></span>
-   <span data-ttu-id="f913b-122">Sempre use um ProgID específico do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f913b-122">Always use an application-specific ProgID.</span></span> <span data-ttu-id="f913b-123">Como alguns tipos de item não usam esse mapeamento, há uma necessidade de nomes exclusivos de fornecedor.</span><span class="sxs-lookup"><span data-stu-id="f913b-123">Because some item types do not use this mapping, there is a need for vendor-unique names.</span></span>
-   <span data-ttu-id="f913b-124">Posicione a interface do usuário em relação ao método de invocação, mas não execute em um thread do chamador.</span><span class="sxs-lookup"><span data-stu-id="f913b-124">Position the UI relative to the invoking method, but do not run on an invoker thread.</span></span>
-   <span data-ttu-id="f913b-125">Não aceite o valor de retorno **S \_ OK** para verbos canônicos passados para o método [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) .</span><span class="sxs-lookup"><span data-stu-id="f913b-125">Do not accept the return value **S\_OK** for canonical verbs passed to the [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) method.</span></span> <span data-ttu-id="f913b-126">Isso faz com que uma falha para a implementação de verbo real seja invocada e retorna um código de falha para verbos canônicos.</span><span class="sxs-lookup"><span data-stu-id="f913b-126">Doing so causes a failure for the real verb implementation to be invoked, and returns a failure code for canonical verbs.</span></span> <span data-ttu-id="f913b-127">Se você não der suporte a verbos canônicos, retorne a falha quando um valor de HIWORD (lpVerb) diferente de zero for encontrado.</span><span class="sxs-lookup"><span data-stu-id="f913b-127">If you do not support canonical verbs, then return failure when a nonzero HIWORD(lpVerb) value is encountered.</span></span>
-   <span data-ttu-id="f913b-128">Evite o uso de **rundll32.exe** como o host para o verbo.</span><span class="sxs-lookup"><span data-stu-id="f913b-128">Avoid the use of **rundll32.exe** as the host for your verb.</span></span>
-   <span data-ttu-id="f913b-129">Ao implementar [**IContextMenu:: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) , certifique-se de retornar o número de verbos que foram adicionados ao menu por meio do valor **HRESULT** usando a macro ResultFromShort.</span><span class="sxs-lookup"><span data-stu-id="f913b-129">When implementing [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) be sure to return the number of verbs that have been added to the menu through the **HRESULT** value using the ResultFromShort macro.</span></span>
-   <span data-ttu-id="f913b-130">Se você se registrar em uma das seguintes entradas de chave do registro, tenha cuidado e certifique-se de registrar seu manipulador no tipo mais específico para reduzir as consequências possivelmente indesejadas:</span><span class="sxs-lookup"><span data-stu-id="f913b-130">If you register on one of the following registry key entries, then exercise caution and be sure to register your handler on the most specific type to reduce the possibly unintended consequences:</span></span>
    -   <span data-ttu-id="f913b-131">**\_raiz de classes hKey \_\\\***</span><span class="sxs-lookup"><span data-stu-id="f913b-131">**HKEY\_CLASSES\_ROOT\\\***</span></span>
    -   <span data-ttu-id="f913b-132">**\_AllFileSystemObjects de \_ raiz de classes hKey \\**</span><span class="sxs-lookup"><span data-stu-id="f913b-132">**HKEY\_CLASSES\_ROOT\\AllFileSystemObjects**</span></span>
    -   <span data-ttu-id="f913b-133">**\_ \_ Pasta raiz de classes hKey \\**</span><span class="sxs-lookup"><span data-stu-id="f913b-133">**HKEY\_CLASSES\_ROOT\\Folder**</span></span>
    -   <span data-ttu-id="f913b-134">**\_ \_ Diretório raiz de classes hKey \\**</span><span class="sxs-lookup"><span data-stu-id="f913b-134">**HKEY\_CLASSES\_ROOT\\Directory**</span></span>
-   <span data-ttu-id="f913b-135">Defina a chave **MayChangeDefaultMenu** somente se você antecipar que talvez precise alterar o verbo padrão no menu de atalho.</span><span class="sxs-lookup"><span data-stu-id="f913b-135">Set the **MayChangeDefaultMenu** key only if you anticipate that you might need to change the default verb in the shortcut menu.</span></span> <span data-ttu-id="f913b-136">Se o manipulador não alterar o verbo padrão, você não deverá definir essa chave porque isso faz com que o sistema carregue sua DLL desnecessariamente.</span><span class="sxs-lookup"><span data-stu-id="f913b-136">If your handler does not change the default verb, then you should not set this key because doing so causes the system to load your DLL unnecessarily.</span></span>
-   <span data-ttu-id="f913b-137">Minimize o trabalho que você executa em [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize).</span><span class="sxs-lookup"><span data-stu-id="f913b-137">Minimize the work you perform in [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize).</span></span> <span data-ttu-id="f913b-138">Para manipuladores de menu de atalho, Capture o objeto de dados passado para **IShellExtInit:: Initialize** e, em seguida, processe-o em [**IContextMenu:: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu)ou [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand).</span><span class="sxs-lookup"><span data-stu-id="f913b-138">For shortcut menu handlers, capture the data object passed to **IShellExtInit::Initialize**, and then process it in [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu), or [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand).</span></span>

## <a name="best-practices-for-multiple-selection-verbs"></a><span data-ttu-id="f913b-139">Práticas recomendadas para verbos de seleção múltipla</span><span class="sxs-lookup"><span data-stu-id="f913b-139">Best Practices for Multiple Selection Verbs</span></span>

<span data-ttu-id="f913b-140">Como o número de itens em um cenário de verbo de seleção múltipla pode ser grande, é importante que você considere as implicações de desempenho de suas implementações de verbo.</span><span class="sxs-lookup"><span data-stu-id="f913b-140">Because the number of items in a multi-selection verb scenario can be large, it is important that you consider the performance implications of your verb implementations.</span></span> <span data-ttu-id="f913b-141">Por exemplo, quando um usuário procura por " \* " sobre um escopo que inclui um grande número de itens e clica em **selecionar tudo** e clica com o botão direito do mouse, o verbo é apresentado com uma seleção que pode ter milhares de itens.</span><span class="sxs-lookup"><span data-stu-id="f913b-141">For example, when a user searches for "\*" over a scope that includes large numbers of items, and then clicks **Select All** and right-clicks, the verb is presented with a selection that can have thousands of items in it.</span></span> <span data-ttu-id="f913b-142">Como resultado, os verbos devem considerar apenas o primeiro item na seleção e a contagem geral de itens.</span><span class="sxs-lookup"><span data-stu-id="f913b-142">As a result, verbs should only consider the first item in the selection, and the overall item count.</span></span> <span data-ttu-id="f913b-143">O primeiro item é definido como o item na parte superior da exibição ou o item em que o usuário clicou pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="f913b-143">The first item is defined as either the item at the top of the view, or the item that the user first right-clicked.</span></span>

<span data-ttu-id="f913b-144">No Windows 7 e posterior, o número de itens passados para um verbo é limitado a 16 quando um menu de atalho é consultado.</span><span class="sxs-lookup"><span data-stu-id="f913b-144">In Windows 7 and later, the number of items passed to a verb is limited to 16 when a shortcut menu is queried.</span></span> <span data-ttu-id="f913b-145">Em seguida, o verbo é recriado e reinicializado com a seleção completa quando esse verbo é invocado.</span><span class="sxs-lookup"><span data-stu-id="f913b-145">The verb is then re-created and re-initialized with the full selection when that verb is invoked.</span></span>

<span data-ttu-id="f913b-146">Isso é apropriado em alguns casos para considerar um pequeno número de itens fixos.</span><span class="sxs-lookup"><span data-stu-id="f913b-146">It is appropriate in some cases to consider a small number of fixed items.</span></span> <span data-ttu-id="f913b-147">Por exemplo, é apropriado para um verbo "diff" para considerar apenas os dois primeiros itens.</span><span class="sxs-lookup"><span data-stu-id="f913b-147">For example, it is appropriate for a "diff" verb to consider only the first two items.</span></span> <span data-ttu-id="f913b-148">Em geral, você não precisa testar todos os itens na seleção para ver se ele é um determinado tipo ou consultar cada item na seleção para suas propriedades.</span><span class="sxs-lookup"><span data-stu-id="f913b-148">Generally, you need not test every item in the selection to see if it is a certain type, or query every item in the selection for its properties.</span></span> <span data-ttu-id="f913b-149">Observe o primeiro item e decida se é apropriado adicionar o verbo.</span><span class="sxs-lookup"><span data-stu-id="f913b-149">Look rather at the first item and decide if it is appropriate to add your verb.</span></span>

### <a name="heterogenous-selections"></a><span data-ttu-id="f913b-150">Seleções heterogêneas</span><span class="sxs-lookup"><span data-stu-id="f913b-150">Heterogenous Selections</span></span>

<span data-ttu-id="f913b-151">Os verbos otimistas são adicionados automaticamente ao caso de várias seleções, supondo que os itens não inspecionados possam ser manipulados pelo verbo.</span><span class="sxs-lookup"><span data-stu-id="f913b-151">Optimistic verbs are automatically added in the multi-selection case, assuming that uninspected items can be handled by the verb.</span></span> <span data-ttu-id="f913b-152">Por outro lado, os verbos pessimistas não são adicionados quando a seleção contém itens não inspecionados e são adicionados somente em casos em que o número de itens é pequeno.</span><span class="sxs-lookup"><span data-stu-id="f913b-152">In contrast, pessimistic verbs are not added when the selection contains uninspected items, and are only added in cases where the number of items is small.</span></span>

<span data-ttu-id="f913b-153">Os verbos do estilo do jogador devem ser otimistas e ignorar silenciosamente os itens que não são manipulados.</span><span class="sxs-lookup"><span data-stu-id="f913b-153">Player style verbs should be optimistic, and silently skip the items that are not handled.</span></span> <span data-ttu-id="f913b-154">Se uma falha de atuar em itens puder causar perda ou confusão de dados, o verbo deverá avisar os usuários sobre os itens que não podem ser processados.</span><span class="sxs-lookup"><span data-stu-id="f913b-154">If a failure to act on items can cause data loss or confusion, then the verb should warn users about items that cannot be processed.</span></span> <span data-ttu-id="f913b-155">Por exemplo, um verbo de "backup" deve indicar que não foi possível fazer backup de alguns itens.</span><span class="sxs-lookup"><span data-stu-id="f913b-155">For example a "backup" verb should indicate that some items could not be backed up.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f913b-156">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="f913b-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f913b-157">Escolhendo um verbo estático ou dinâmico para o menu de atalho</span><span class="sxs-lookup"><span data-stu-id="f913b-157">Choosing a Static or Dynamic Verb for your Shortcut Menu</span></span>](shortcut-choose-method.md)
</dt> <dt>

[<span data-ttu-id="f913b-158">Como Criar Manipuladores do Menu de Atalho</span><span class="sxs-lookup"><span data-stu-id="f913b-158">Creating Shortcut Menu Handlers</span></span>](context-menu-handlers.md)
</dt> <dt>

[<span data-ttu-id="f913b-159">Personalizando um menu de atalho usando verbos dinâmicos</span><span class="sxs-lookup"><span data-stu-id="f913b-159">Customizing a Shortcut Menu Using Dynamic Verbs</span></span>](shortcut-menu-using-dynamic-verbs.md)
</dt> <dt>

[<span data-ttu-id="f913b-160">Menus de atalho (contexto) e manipuladores de menu de atalho</span><span class="sxs-lookup"><span data-stu-id="f913b-160">Shortcut (Context) Menus and Shortcut Menu Handlers</span></span>](context-menu.md)
</dt> <dt>

[<span data-ttu-id="f913b-161">Verbos e associações de arquivo</span><span class="sxs-lookup"><span data-stu-id="f913b-161">Verbs and File Associations</span></span>](fa-verbs.md)
</dt> <dt>

[<span data-ttu-id="f913b-162">Referência do menu de atalho</span><span class="sxs-lookup"><span data-stu-id="f913b-162">Shortcut Menu Reference</span></span>](context-menu-reference.md)
</dt> </dl>

 

 



