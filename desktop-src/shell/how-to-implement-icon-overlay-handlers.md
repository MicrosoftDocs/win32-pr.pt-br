---
description: Os manipuladores de sobreposição de ícone são objetos COM (Component Object Model) em processo, implementados como DLLs.
ms.assetid: ADF27BFD-CC96-43F9-9EBB-DEBE0DEA7B92
title: Como implementar manipuladores de sobreposição de ícone
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e22c1057f65c50b31c6627846ec77103827a0283
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104967896"
---
# <a name="how-to-implement-icon-overlay-handlers"></a><span data-ttu-id="e0f3f-103">Como implementar manipuladores de sobreposição de ícone</span><span class="sxs-lookup"><span data-stu-id="e0f3f-103">How to Implement Icon Overlay Handlers</span></span>

<span data-ttu-id="e0f3f-104">Os manipuladores de sobreposição de ícone são objetos COM (Component Object Model) em processo, implementados como DLLs.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-104">Icon overlay handlers are in-process Component Object Model (COM) objects, implemented as DLLs.</span></span> <span data-ttu-id="e0f3f-105">Eles exportam uma interface além de [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellIconOverlayIdentifier**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelliconoverlayidentifier).</span><span class="sxs-lookup"><span data-stu-id="e0f3f-105">They export one interface in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellIconOverlayIdentifier**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishelliconoverlayidentifier).</span></span> <span data-ttu-id="e0f3f-106">Essa interface tem três métodos: [**IShellIconOverlayIdentifier:: GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo), [**IShellIconOverlayIdentifier:: getanteriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority)e [**IShellIconOverlayIdentifier:: IsMemberOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof).</span><span class="sxs-lookup"><span data-stu-id="e0f3f-106">This interface has three methods: [**IShellIconOverlayIdentifier::GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo), [**IShellIconOverlayIdentifier::GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority), and [**IShellIconOverlayIdentifier::IsMemberOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof).</span></span>

## <a name="instructions"></a><span data-ttu-id="e0f3f-107">Instruções</span><span class="sxs-lookup"><span data-stu-id="e0f3f-107">Instructions</span></span>

### <a name="step-1-implementing-getoverlayinfo"></a><span data-ttu-id="e0f3f-108">Etapa 1: implementando GetOverlayInfo</span><span class="sxs-lookup"><span data-stu-id="e0f3f-108">Step 1: Implementing GetOverlayInfo</span></span>

<span data-ttu-id="e0f3f-109">O método [**GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) é chamado pela primeira vez durante a inicialização.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-109">The [**GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) method is first called during initialization.</span></span> <span data-ttu-id="e0f3f-110">O método retorna o caminho totalmente qualificado do arquivo que contém a imagem de sobreposição de ícone e seu índice de base zero dentro do arquivo.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-110">The method returns the fully qualified path of the file that contains the icon overlay image, and its zero-based index within the file.</span></span> <span data-ttu-id="e0f3f-111">O Shell, em seguida, adiciona a imagem à lista de imagens do sistema.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-111">The Shell then adds the image to the system image list.</span></span> <span data-ttu-id="e0f3f-112">As sobreposições de ícone podem estar contidas em qualquer um dos tipos de arquivo padrão, incluindo. exe,. dll e. ico.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-112">Icon overlays can be contained in any of the standard file types, including .exe, .dll, and .ico.</span></span>

<span data-ttu-id="e0f3f-113">Após a conclusão da inicialização, o Shell chama [**GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) quando precisa exibir a sobreposição de ícone do manipulador.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-113">After initialization is complete, the Shell calls [**GetOverlayInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getoverlayinfo) when it needs to display the handler's icon overlay.</span></span> <span data-ttu-id="e0f3f-114">O método deve retornar o mesmo nome de arquivo e índice que ele fez durante a inicialização.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-114">The method should return the same file name and index that it did during initialization.</span></span> <span data-ttu-id="e0f3f-115">Embora o shell use a imagem armazenada em cache na lista de imagens do sistema em vez de carregar a imagem do arquivo, uma sobreposição de ícone ainda é identificada por seu nome de arquivo e índice.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-115">Although the Shell uses the image that is cached in the system image list rather than loading the image from the file, an icon overlay is still identified by its file name and index.</span></span>

### <a name="step-2-implementing-getpriority"></a><span data-ttu-id="e0f3f-116">Etapa 2: implementando getanteriority</span><span class="sxs-lookup"><span data-stu-id="e0f3f-116">Step 2: Implementing GetPriority</span></span>

<span data-ttu-id="e0f3f-117">O método [**prepriorion**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) é chamado somente durante a inicialização.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-117">The [**GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) method is called only during initialization.</span></span> <span data-ttu-id="e0f3f-118">Ele atribui um valor de prioridade à sobreposição de ícone do manipulador.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-118">It assigns a priority value to the handler's icon overlay.</span></span> <span data-ttu-id="e0f3f-119">O valor pode variar de zero a 100, em que 100 é a prioridade mais baixa.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-119">The value can range from zero to 100, where 100 is the lowest priority.</span></span> <span data-ttu-id="e0f3f-120">A finalidade desse valor de prioridade é ajudar o Shell a resolver o conflito que surge quando várias sobreposições de ícone são especificadas para um único objeto.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-120">The purpose of this priority value is to help the Shell resolve the conflict that arises when multiple icon overlays are specified for a single object.</span></span> <span data-ttu-id="e0f3f-121">O Shell primeiro usa um conjunto interno de regras para determinar a sobreposição de ícone de prioridade mais alta.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-121">The Shell first uses an internal set of rules to determine the highest-priority icon overlay.</span></span> <span data-ttu-id="e0f3f-122">Se essas regras não resolverem o conflito, os valores atribuídos às sobreposições de ícone por **Getanteriority** determinam a prioridade.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-122">If these rules do not resolve the conflict, the values assigned to the icon overlays by **GetPriority** determine priority.</span></span>

<span data-ttu-id="e0f3f-123">O valor de Priority definido por [**Getanteriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) não é uma maneira confiável de resolver conflitos entre manipuladores de sobreposição de ícone não relacionados.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-123">The priority value set by [**GetPriority**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-getpriority) is not a reliable way to resolve conflicts between unrelated icon overlay handlers.</span></span> <span data-ttu-id="e0f3f-124">Não há como o seu manipulador determinar quais valores de prioridade outros manipuladores estão usando.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-124">There is no way for your handler to determine what priority values other handlers are using.</span></span> <span data-ttu-id="e0f3f-125">Normalmente, você deve definir o valor como zero.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-125">Normally, you should set the value to zero.</span></span> <span data-ttu-id="e0f3f-126">No entanto, o valor de prioridade é útil quando você implementa dois ou mais manipuladores de sobreposição de ícone que podem solicitar ícones de sobreposição de ícone para o mesmo objeto.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-126">However, the priority value is useful when you have implemented two or more icon overlay handlers that can request icon overlay icons for the same object.</span></span> <span data-ttu-id="e0f3f-127">Ao definir os valores de prioridade adequadamente, você pode especificar qual das sobreposições de ícone solicitadas será exibida.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-127">By setting the priority values appropriately, you can specify which of the requested icon overlays will be displayed.</span></span>

### <a name="step-3-implementing-ismemberof"></a><span data-ttu-id="e0f3f-128">Etapa 3: implementando IsMemberOf</span><span class="sxs-lookup"><span data-stu-id="e0f3f-128">Step 3: Implementing IsMemberOf</span></span>

<span data-ttu-id="e0f3f-129">O Shell chama o método [**IsMemberOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof) para determinar se ele deve exibir a sobreposição de ícone de um manipulador para um objeto específico.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-129">The Shell calls the [**IsMemberOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishelliconoverlayidentifier-ismemberof) method to determine whether it should display a handler's icon overlay for a particular object.</span></span> <span data-ttu-id="e0f3f-130">O shell especifica o objeto passando seu nome para o método.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-130">The Shell specifies the object by passing its name to the method.</span></span> <span data-ttu-id="e0f3f-131">Se um manipulador quiser ter sua sobreposição de ícone exibida, **IsMemberOf** retornará S \_ OK.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-131">If a handler wants to have its icon overlay displayed, **IsMemberOf** returns S\_OK.</span></span> <span data-ttu-id="e0f3f-132">Caso contrário, retornará S \_ false.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-132">If not, it returns S\_FALSE.</span></span>

<span data-ttu-id="e0f3f-133">Os manipuladores de sobreposição de ícone normalmente se destinam a trabalhar com um grupo específico de arquivos.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-133">Icon overlay handlers are normally intended to work with a particular group of files.</span></span> <span data-ttu-id="e0f3f-134">Um exemplo típico é um [tipo de arquivo](fa-file-types.md), identificado por uma extensão de nome de arquivo específica.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-134">A typical example is a [file type](fa-file-types.md), identified by a specific file name extension.</span></span> <span data-ttu-id="e0f3f-135">Um manipulador de sobreposição de ícone pode solicitar uma sobreposição de ícone para todos os arquivos do tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-135">An icon overlay handler can request an icon overlay for all files of the file type.</span></span> <span data-ttu-id="e0f3f-136">Alguns manipuladores solicitam uma sobreposição de ícone somente se um arquivo do tipo de arquivo estiver em um estado específico.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-136">Some handlers request an icon overlay only if a file of the file type is in a particular state.</span></span> <span data-ttu-id="e0f3f-137">No entanto, os manipuladores de sobreposição de ícone são livres para solicitar a sobreposição de ícone para qualquer objeto que escolherem.</span><span class="sxs-lookup"><span data-stu-id="e0f3f-137">However, icon overlay handlers are free to request their icon overlay for any object that they choose.</span></span>

 

 
