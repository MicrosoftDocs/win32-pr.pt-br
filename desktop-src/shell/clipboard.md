---
description: Os formatos de área de transferência do shell são usados para identificar o tipo de dados do shell que está sendo transferido pela área de transferência.
ms.assetid: fb8ce5d3-3215-4e05-a916-4d4a803464d2
title: Formatos de área de transferência do Shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 674ccc33db3a35a1a60abb549f5e1ab5b5c96760
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103646841"
---
# <a name="shell-clipboard-formats"></a><span data-ttu-id="de896-103">Formatos de área de transferência do Shell</span><span class="sxs-lookup"><span data-stu-id="de896-103">Shell Clipboard Formats</span></span>

<span data-ttu-id="de896-104">Os formatos de área de transferência do shell são usados para identificar o tipo de dados do shell que está sendo transferido pela área de transferência.</span><span class="sxs-lookup"><span data-stu-id="de896-104">Shell clipboard formats are used to identify the type of Shell data being transferred through the clipboard.</span></span> <span data-ttu-id="de896-105">A maioria dos formatos de área de transferência do Shell identifica um tipo de dados, como uma lista de nomes de arquivos ou ponteiros para listas de identificadores de itens (PIDLs).</span><span class="sxs-lookup"><span data-stu-id="de896-105">Most Shell clipboard formats identify a type of data, such as a list of file names or pointers to item identifier lists (PIDLs).</span></span> <span data-ttu-id="de896-106">No entanto, alguns formatos são usados para comunicação entre a origem e o destino.</span><span class="sxs-lookup"><span data-stu-id="de896-106">However, some formats are used for communication between source and target.</span></span> <span data-ttu-id="de896-107">Eles podem agilizar o processo de transferência de dados oferecendo suporte a operações de Shell, como [movimentação otimizada](datascenarios.md) e [delete_on_paste](datascenarios.md).</span><span class="sxs-lookup"><span data-stu-id="de896-107">They can expedite the data transfer process by supporting Shell operations such as [optimized move](datascenarios.md) and [delete_on_paste](datascenarios.md).</span></span> <span data-ttu-id="de896-108">Os dados do Shell estão sempre contidos em um [objeto de dados](dataobject.md) que usa uma estrutura [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) como uma maneira mais geral de caracterizar dados.</span><span class="sxs-lookup"><span data-stu-id="de896-108">Shell data is always contained in a [data object](dataobject.md) that uses a [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure as a more general way to characterize data.</span></span> <span data-ttu-id="de896-109">O membro **cfFormat** da estrutura é definido como o formato da área de transferência para o item de dados específico.</span><span class="sxs-lookup"><span data-stu-id="de896-109">The structure's **cfFormat** member is set to the clipboard format for the particular item of data.</span></span> <span data-ttu-id="de896-110">Os outros membros fornecem informações adicionais, como o mecanismo de transferência de dados.</span><span class="sxs-lookup"><span data-stu-id="de896-110">The other members provide additional information, such as the data transfer mechanism.</span></span> <span data-ttu-id="de896-111">Os dados estão contidos em uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que o acompanha.</span><span class="sxs-lookup"><span data-stu-id="de896-111">The data is contained in an accompanying [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure.</span></span>

> [!Note]  
> <span data-ttu-id="de896-112">Os identificadores de formato padrão da área de transferência têm a forma CF_ *xxx*.</span><span class="sxs-lookup"><span data-stu-id="de896-112">Standard clipboard format identifiers have the form CF_ *XXX*.</span></span> <span data-ttu-id="de896-113">Um exemplo comum é CF_TEXT, que é usado para transferir dados de texto ANSI.</span><span class="sxs-lookup"><span data-stu-id="de896-113">A common example is CF_TEXT, which is used for transferring ANSI text data.</span></span> <span data-ttu-id="de896-114">Esses identificadores têm valores predefinidos e podem ser usados diretamente com estruturas [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) .</span><span class="sxs-lookup"><span data-stu-id="de896-114">These identifiers have predefined values and can be used directly with [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structures.</span></span> <span data-ttu-id="de896-115">Com exceção de [CF_HDROP](#cf_hdrop), os identificadores de formato de shell não são predefinidos.</span><span class="sxs-lookup"><span data-stu-id="de896-115">With the exception of [CF_HDROP](#cf_hdrop), Shell format identifiers are not predefined.</span></span> <span data-ttu-id="de896-116">Com exceção de DragWindow, eles têm a forma CFSTR_ *xxx*.</span><span class="sxs-lookup"><span data-stu-id="de896-116">With the exception of DragWindow, they have the form CFSTR_ *XXX*.</span></span> <span data-ttu-id="de896-117">Para diferenciar esses valores dos formatos predefinidos, eles costumam ser chamados simplesmente de *formatos*.</span><span class="sxs-lookup"><span data-stu-id="de896-117">To differentiate these values from predefined formats, they are often referred to as simply *formats*.</span></span> <span data-ttu-id="de896-118">No entanto, diferentemente dos formatos predefinidos, eles devem ser registrados pela origem e pelo destino antes que possam ser usados para transferir dados.</span><span class="sxs-lookup"><span data-stu-id="de896-118">However, unlike predefined formats, they must be registered by both source and target before they can be used to transfer data.</span></span> <span data-ttu-id="de896-119">Para registrar um formato de Shell, inclua o arquivo de cabeçalho ShlObj. h e passe o identificador de formato do CFSTR_ *xxx* para [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span><span class="sxs-lookup"><span data-stu-id="de896-119">To register a Shell format, include the Shlobj.h header file and pass the CFSTR_ *XXX* format identifier to [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span></span> <span data-ttu-id="de896-120">Essa função retorna um valor de formato de área de transferência válido, que pode ser usado como o membro **cfFormat** de uma estrutura **FORMATETC** .</span><span class="sxs-lookup"><span data-stu-id="de896-120">This function returns a valid clipboard format value, which can then be used as the **cfFormat** member of a **FORMATETC** structure.</span></span>

 

<span data-ttu-id="de896-121">Os formatos de área de transferência do shell são organizados aqui em três grupos, com base em como eles são usados.</span><span class="sxs-lookup"><span data-stu-id="de896-121">The Shell clipboard formats are organized here into three groups, based on how they are used.</span></span>

-   [<span data-ttu-id="de896-122">Formatos para transferir objetos do sistema de arquivos</span><span class="sxs-lookup"><span data-stu-id="de896-122">Formats for Transferring File System Objects</span></span>](#formats-for-transferring-file-system-objects)
    -   [<span data-ttu-id="de896-123">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="de896-123">CF_HDROP</span></span>](#cf_hdrop)
    -   [<span data-ttu-id="de896-124">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="de896-124">CFSTR_FILECONTENTS</span></span>](#cfstr_filecontents)
    -   [<span data-ttu-id="de896-125">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="de896-125">CFSTR_FILEDESCRIPTOR</span></span>](#cfstr_filedescriptor)
    -   [<span data-ttu-id="de896-126">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="de896-126">CFSTR_FILENAME</span></span>](#cfstr_filename)
    -   [<span data-ttu-id="de896-127">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="de896-127">CFSTR_FILENAMEMAP</span></span>](#cfstr_filenamemap)
    -   [<span data-ttu-id="de896-128">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="de896-128">CFSTR_MOUNTEDVOLUME</span></span>](#cfstr_mountedvolume)
    -   [<span data-ttu-id="de896-129">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="de896-129">CFSTR_SHELLIDLIST</span></span>](#cfstr_shellidlist)
    -   [<span data-ttu-id="de896-130">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="de896-130">CFSTR_SHELLIDLISTOFFSET</span></span>](#cfstr_shellidlistoffset)
-   [<span data-ttu-id="de896-131">Formatos para transferência de objetos virtuais</span><span class="sxs-lookup"><span data-stu-id="de896-131">Formats for Transferring Virtual Objects</span></span>](#formats-for-transferring-virtual-objects)
    -   [<span data-ttu-id="de896-132">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="de896-132">CFSTR_NETRESOURCES</span></span>](#cfstr_netresources)
    -   [<span data-ttu-id="de896-133">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="de896-133">CFSTR_PRINTERGROUP</span></span>](#cfstr_printergroup)
    -   [<span data-ttu-id="de896-134">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="de896-134">CFSTR_INETURL</span></span>](#cfstr_ineturl)
    -   [<span data-ttu-id="de896-135">CFSTR_SHELLURL (preterido)</span><span class="sxs-lookup"><span data-stu-id="de896-135">CFSTR_SHELLURL (deprecated)</span></span>](#cfstr_shellurl-deprecated)
-   [<span data-ttu-id="de896-136">Formatos de comunicação entre a origem e o destino</span><span class="sxs-lookup"><span data-stu-id="de896-136">Formats for Communication Between Source and Target</span></span>](#formats-for-communication-between-source-and-target)
    -   [<span data-ttu-id="de896-137">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="de896-137">CFSTR_INDRAGLOOP</span></span>](#cfstr_indragloop)
    -   [<span data-ttu-id="de896-138">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="de896-138">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>](#cfstr_logicalperformeddropeffect)
    -   [<span data-ttu-id="de896-139">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="de896-139">CFSTR_PASTESUCCEEDED</span></span>](#cfstr_pastesucceeded)
    -   [<span data-ttu-id="de896-140">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="de896-140">CFSTR_PERFORMEDDROPEFFECT</span></span>](#cfstr_performeddropeffect)
    -   [<span data-ttu-id="de896-141">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="de896-141">CFSTR_PREFERREDDROPEFFECT</span></span>](#cfstr_preferreddropeffect)
    -   [<span data-ttu-id="de896-142">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="de896-142">CFSTR_TARGETCLSID</span></span>](#cfstr_targetclsid)
    -   [<span data-ttu-id="de896-143">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="de896-143">CFSTR_UNTRUSTEDDRAGDROP</span></span>](#cfstr_untrusteddragdrop)
    -   [<span data-ttu-id="de896-144">DragWindow</span><span class="sxs-lookup"><span data-stu-id="de896-144">DragWindow</span></span>](#dragwindow)

## <a name="formats-for-transferring-file-system-objects"></a><span data-ttu-id="de896-145">Formatos para transferir objetos do sistema de arquivos</span><span class="sxs-lookup"><span data-stu-id="de896-145">Formats for Transferring File System Objects</span></span>

<span data-ttu-id="de896-146">Esses formatos são usados para transferir um ou mais arquivos ou outros objetos do Shell.</span><span class="sxs-lookup"><span data-stu-id="de896-146">These formats are used to transfer one or more files or other Shell objects.</span></span>

-   [<span data-ttu-id="de896-147">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="de896-147">CF_HDROP</span></span>](#cf_hdrop)
-   [<span data-ttu-id="de896-148">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="de896-148">CFSTR_FILECONTENTS</span></span>](#cfstr_filecontents)
-   [<span data-ttu-id="de896-149">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="de896-149">CFSTR_FILEDESCRIPTOR</span></span>](#cfstr_filedescriptor)
-   [<span data-ttu-id="de896-150">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="de896-150">CFSTR_FILENAME</span></span>](#cfstr_filename)
-   [<span data-ttu-id="de896-151">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="de896-151">CFSTR_FILENAMEMAP</span></span>](#cfstr_filenamemap)
-   [<span data-ttu-id="de896-152">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="de896-152">CFSTR_MOUNTEDVOLUME</span></span>](#cfstr_mountedvolume)
-   [<span data-ttu-id="de896-153">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="de896-153">CFSTR_SHELLIDLIST</span></span>](#cfstr_shellidlist)
-   [<span data-ttu-id="de896-154">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="de896-154">CFSTR_SHELLIDLISTOFFSET</span></span>](#cfstr_shellidlistoffset)

### <a name="cf_hdrop"></a><span data-ttu-id="de896-155">CF_HDROP</span><span class="sxs-lookup"><span data-stu-id="de896-155">CF_HDROP</span></span>

<span data-ttu-id="de896-156">Esse formato de área de transferência é usado ao transferir os locais de um grupo de arquivos existentes.</span><span class="sxs-lookup"><span data-stu-id="de896-156">This clipboard format is used when transferring the locations of a group of existing files.</span></span> <span data-ttu-id="de896-157">Ao contrário dos outros formatos de Shell, ele é predefinido, portanto, não há necessidade de chamar [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span><span class="sxs-lookup"><span data-stu-id="de896-157">Unlike the other Shell formats, it is predefined, so there is no need to call [RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformata).</span></span> <span data-ttu-id="de896-158">Os dados consistem em uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-158">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-159">O membro **HGLOBAL** da estrutura aponta para uma estrutura [**DropFiles**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) como seu membro **HGLOBAL** .</span><span class="sxs-lookup"><span data-stu-id="de896-159">The structure's **hGlobal** member points to a [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure as its **hGlobal** member.</span></span>

<span data-ttu-id="de896-160">O membro **pFiles** da estrutura [**DropFiles**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) contém um deslocamento para uma matriz de caracteres dupla terminada com **nulo** que contém os nomes de arquivo.</span><span class="sxs-lookup"><span data-stu-id="de896-160">The **pFiles** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains an offset to a double **null**-terminated character array that contains the file names.</span></span> <span data-ttu-id="de896-161">Se você estiver extraindo um formato de CF_HDROP de um objeto de dados, poderá usar [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) para extrair nomes de arquivo individuais do objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-161">If you are extracting a CF_HDROP format from a data object, you can use [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) to extract individual file names from the global memory object.</span></span> <span data-ttu-id="de896-162">Se você estiver criando um formato de CF_HDROP a ser colocado em um objeto de dados, será necessário construir a matriz de nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="de896-162">If you are creating a CF_HDROP format to place in a data object, you will need to construct the file name array.</span></span>

<span data-ttu-id="de896-163">A matriz de nome de arquivo consiste em uma série de cadeias de caracteres, cada uma contendo um caminho totalmente qualificado de um arquivo, incluindo o caractere **nulo** de terminação.</span><span class="sxs-lookup"><span data-stu-id="de896-163">The file name array consists of a series of strings, each containing one file's fully qualified path, including the terminating **NULL** character.</span></span> <span data-ttu-id="de896-164">Um caractere **nulo** adicional é acrescentado à cadeia de caracteres final para encerrar a matriz.</span><span class="sxs-lookup"><span data-stu-id="de896-164">An additional **null** character is appended to the final string to terminate the array.</span></span> <span data-ttu-id="de896-165">Por exemplo, se os arquivos c: \\temp1.txt e c: \\temp2.txt estiverem sendo transferidos, a matriz de caracteres terá esta aparência:</span><span class="sxs-lookup"><span data-stu-id="de896-165">For example, if the files c:\\temp1.txt and c:\\temp2.txt are being transferred, the character array looks like this:</span></span>


```CMD
c:\temp1.txt'\0'c:\temp2.txt'\0''\0'
```

> [!Note]  
> <span data-ttu-id="de896-166">Neste exemplo, ' \\ 0 ' é usado para representar o caractere **nulo** , não os caracteres literais que devem ser incluídos.</span><span class="sxs-lookup"><span data-stu-id="de896-166">In this example, '\\0' is used to represent the **null** character, not the literal characters that should be included.</span></span>


<span data-ttu-id="de896-167">Se o objeto foi copiado para a área de transferência como parte de uma operação de arrastar e soltar, o membro **pt** da estrutura [**DropFiles**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) contém as coordenadas do ponto em que o objeto foi Descartado.</span><span class="sxs-lookup"><span data-stu-id="de896-167">If the object was copied to the clipboard as part of a drag-and-drop operation, the **pt** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains the coordinates of the point where the object was dropped.</span></span> <span data-ttu-id="de896-168">Você pode usar [**DragQueryPoint**](/windows/desktop/api/Shellapi/nf-shellapi-dragquerypoint) para extrair as coordenadas do cursor.</span><span class="sxs-lookup"><span data-stu-id="de896-168">You can use [**DragQueryPoint**](/windows/desktop/api/Shellapi/nf-shellapi-dragquerypoint) to extract the cursor coordinates.</span></span>

<span data-ttu-id="de896-169">Se esse formato estiver presente em um objeto de dados, um loop de arrastar do OLE simulará [**WM_DROPFILES**](wm-dropfiles.md) funcionalidade com destinos de destino não OLE.</span><span class="sxs-lookup"><span data-stu-id="de896-169">If this format is present in a data object, an OLE drag loop simulates [**WM_DROPFILES**](wm-dropfiles.md) functionality with non-OLE drop targets.</span></span> <span data-ttu-id="de896-170">Isso é importante se seu aplicativo for a origem de uma operação de arrastar e soltar em um sistema Windows 3,1.</span><span class="sxs-lookup"><span data-stu-id="de896-170">This is important if your application is the source of a drag-and-drop operation on a Windows 3.1 system.</span></span>

### <a name="cfstr_filecontents"></a><span data-ttu-id="de896-171">CFSTR_FILECONTENTS</span><span class="sxs-lookup"><span data-stu-id="de896-171">CFSTR_FILECONTENTS</span></span>

<span data-ttu-id="de896-172">Esse identificador de formato é usado com o formato de [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) para transferir dados como se fosse um arquivo, independentemente de como ele está realmente armazenado.</span><span class="sxs-lookup"><span data-stu-id="de896-172">This format identifier is used with the [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) format to transfer data as if it were a file, regardless of how it is actually stored.</span></span> <span data-ttu-id="de896-173">Os dados consistem em uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que representa o conteúdo de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="de896-173">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that represents the contents of one file.</span></span> <span data-ttu-id="de896-174">Normalmente, o arquivo é representado como um objeto Stream, o que evita que você precise colocar o conteúdo do arquivo na memória.</span><span class="sxs-lookup"><span data-stu-id="de896-174">The file is normally represented as a stream object, which avoids having to place the contents of the file in memory.</span></span> <span data-ttu-id="de896-175">Nesse caso, o membro **TYMED** da estrutura **STGMEDIUM** é definido como TYMED_ISTREAM e o arquivo é representado por uma interface [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) .</span><span class="sxs-lookup"><span data-stu-id="de896-175">In that case, the **tymed** member of the **STGMEDIUM** structure is set to TYMED_ISTREAM, and the file is represented by an [**IStream**](/windows/win32/api/objidl/nn-objidl-istream) interface.</span></span> <span data-ttu-id="de896-176">O arquivo também pode ser um objeto de memória ou armazenamento global (TYMED_ISTORAGE ou TYMED_HGLOBAL).</span><span class="sxs-lookup"><span data-stu-id="de896-176">The file can also be a storage or global memory object (TYMED_ISTORAGE or TYMED_HGLOBAL).</span></span> <span data-ttu-id="de896-177">O formato de CFSTR_FILEDESCRIPTOR associado contém uma estrutura de [**FileDescriptor**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) para cada arquivo que especifica o nome e os atributos do arquivo.</span><span class="sxs-lookup"><span data-stu-id="de896-177">The associated CFSTR_FILEDESCRIPTOR format contains a [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure for each file that specifies the file's name and attributes.</span></span>

<span data-ttu-id="de896-178">O destino trata os dados associados a um formato de CFSTR_FILECONTENTS como se fosse um arquivo.</span><span class="sxs-lookup"><span data-stu-id="de896-178">The target treats the data associated with a CFSTR_FILECONTENTS format as if it were a file.</span></span> <span data-ttu-id="de896-179">Quando o destino chama [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) para extrair os dados, ele especifica um arquivo específico definindo o membro **Lindex** da estrutura [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) como o índice de base zero da estrutura [**filedescriptor**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) do arquivo no formato de [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) que o acompanha.</span><span class="sxs-lookup"><span data-stu-id="de896-179">When the target calls [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) to extract the data, it specifies a particular file by setting the **lindex** member of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure to the zero-based index of the file's [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure in the accompanying [CFSTR_FILEDESCRIPTOR](#cfstr_filedescriptor) format.</span></span> <span data-ttu-id="de896-180">Em seguida, o destino usa o ponteiro de interface retornado ou o identificador de memória global para extrair os dados.</span><span class="sxs-lookup"><span data-stu-id="de896-180">The target then uses the returned interface pointer or global memory handle to extract the data.</span></span>

### <a name="cfstr_filedescriptor"></a><span data-ttu-id="de896-181">CFSTR_FILEDESCRIPTOR</span><span class="sxs-lookup"><span data-stu-id="de896-181">CFSTR_FILEDESCRIPTOR</span></span>

<span data-ttu-id="de896-182">Esse identificador de formato é usado com o formato de [CFSTR_FILECONTENTS](#cfstr_filecontents) para transferir dados como um grupo de arquivos.</span><span class="sxs-lookup"><span data-stu-id="de896-182">This format identifier is used with the [CFSTR_FILECONTENTS](#cfstr_filecontents) format to transfer data as a group of files.</span></span> <span data-ttu-id="de896-183">Esses dois formatos são a maneira preferida de transferir objetos do shell que não são armazenados como arquivos do sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="de896-183">These two formats are the preferred way to transfer Shell objects that are not stored as file-system files.</span></span> <span data-ttu-id="de896-184">Por exemplo, esses formatos podem ser usados para transferir um grupo de mensagens de email como arquivos individuais, mesmo que cada email seja realmente armazenado como um bloco de dados em um banco de dado.</span><span class="sxs-lookup"><span data-stu-id="de896-184">For example, these formats can be used to transfer a group of email messages as individual files, even though each email is actually stored as a block of data in a database.</span></span> <span data-ttu-id="de896-185">Os dados consistem em uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-185">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-186">O membro **HGLOBAL** da estrutura aponta para uma estrutura [**FILEGROUPDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filegroupdescriptora) seguida por uma matriz que contém uma estrutura de [**FileDescriptor**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) para cada arquivo no grupo.</span><span class="sxs-lookup"><span data-stu-id="de896-186">The structure's **hGlobal** member points to a [**FILEGROUPDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filegroupdescriptora) structure that is followed by an array containing one [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure for each file in the group.</span></span> <span data-ttu-id="de896-187">Para cada estrutura de **FileDescriptor** , há um formato de CFSTR_FILECONTENTS separado que contém o conteúdo do arquivo.</span><span class="sxs-lookup"><span data-stu-id="de896-187">For each **FILEDESCRIPTOR** structure, there is a separate CFSTR_FILECONTENTS format that contains the contents of the file.</span></span> <span data-ttu-id="de896-188">Para identificar um formato de CFSTR_FILECONTENTS de um arquivo específico, defina o valor **Lindex** da estrutura [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) para o índice de base zero da estrutura **FileDescriptor** do arquivo.</span><span class="sxs-lookup"><span data-stu-id="de896-188">To identify a particular file's CFSTR_FILECONTENTS format, set the **lIndex** value of the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure to the zero-based index of the file's **FILEDESCRIPTOR** structure.</span></span>

<span data-ttu-id="de896-189">O formato de CFSTR_FILEDESCRIPTOR é comumente usado para transferir dados como se fosse um grupo de arquivos, independentemente de como ele está realmente armazenado.</span><span class="sxs-lookup"><span data-stu-id="de896-189">The CFSTR_FILEDESCRIPTOR format is commonly used to transfer data as if it were a group of files, regardless of how it is actually stored.</span></span> <span data-ttu-id="de896-190">Da perspectiva do destino, cada formato de CFSTR_FILECONTENTS representa um único arquivo e é tratado de acordo.</span><span class="sxs-lookup"><span data-stu-id="de896-190">From the target's perspective, each CFSTR_FILECONTENTS format represents a single file and is treated accordingly.</span></span> <span data-ttu-id="de896-191">No entanto, a origem pode armazenar os dados de qualquer forma que escolher.</span><span class="sxs-lookup"><span data-stu-id="de896-191">However, the source can store the data in any way it chooses.</span></span> <span data-ttu-id="de896-192">Embora um formato de CSFTR_FILECONTENTS possa corresponder a um único arquivo, ele também poderia, por exemplo, representar dados extraídos pela origem de um documento de um banco de dados ou de texto.</span><span class="sxs-lookup"><span data-stu-id="de896-192">While a CSFTR_FILECONTENTS format might correspond to a single file, it could also, for example, represent data extracted by the source from a database or text document.</span></span>

### <a name="cfstr_filename"></a><span data-ttu-id="de896-193">CFSTR_FILENAME</span><span class="sxs-lookup"><span data-stu-id="de896-193">CFSTR_FILENAME</span></span>

<span data-ttu-id="de896-194">Esse identificador de formato é usado para transferir um único arquivo.</span><span class="sxs-lookup"><span data-stu-id="de896-194">This format identifier is used to transfer a single file.</span></span> <span data-ttu-id="de896-195">Os dados consistem em uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-195">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-196">O membro **HGLOBAL** da estrutura aponta para uma única cadeia de caracteres terminada em **nulo** que contém o caminho de arquivo totalmente qualificado do arquivo.</span><span class="sxs-lookup"><span data-stu-id="de896-196">The structure's **hGlobal** member points to a single **null**-terminated string containing the file's fully qualified file path.</span></span> <span data-ttu-id="de896-197">Esse formato foi substituído por [CF_HDROP](#cf_hdrop), mas tem suporte para compatibilidade com versões anteriores com aplicativos do Windows 3,1.</span><span class="sxs-lookup"><span data-stu-id="de896-197">This format has been superseded by [CF_HDROP](#cf_hdrop), but it is supported for backward compatibility with Windows 3.1 applications.</span></span>

### <a name="cfstr_filenamemap"></a><span data-ttu-id="de896-198">CFSTR_FILENAMEMAP</span><span class="sxs-lookup"><span data-stu-id="de896-198">CFSTR_FILENAMEMAP</span></span>

<span data-ttu-id="de896-199">Esse identificador de formato é usado quando um grupo de arquivos no formato [CF_HDROP](#cf_hdrop) está sendo renomeado e transferido.</span><span class="sxs-lookup"><span data-stu-id="de896-199">This format identifier is used when a group of files in [CF_HDROP](#cf_hdrop) format is being renamed as well as transferred.</span></span> <span data-ttu-id="de896-200">Os dados consistem em uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-200">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-201">O membro **HGLOBAL** da estrutura aponta para uma matriz de caracteres dupla de terminação **nula**.</span><span class="sxs-lookup"><span data-stu-id="de896-201">The structure's **hGlobal** member points to a double **null**-terminated character array.</span></span> <span data-ttu-id="de896-202">Essa matriz contém um novo nome para cada arquivo, na mesma ordem em que os arquivos são listados no formato de CF_HDROP que o acompanha.</span><span class="sxs-lookup"><span data-stu-id="de896-202">This array contains a new name for each file, in the same order that the files are listed in the accompanying CF_HDROP format.</span></span> <span data-ttu-id="de896-203">O formato da matriz de caracteres é o mesmo usado pelo CF_HDROP para listar os arquivos transferidos.</span><span class="sxs-lookup"><span data-stu-id="de896-203">The format of the character array is the same as that used by CF_HDROP to list the transferred files.</span></span>

### <a name="cfstr_mountedvolume"></a><span data-ttu-id="de896-204">CFSTR_MOUNTEDVOLUME</span><span class="sxs-lookup"><span data-stu-id="de896-204">CFSTR_MOUNTEDVOLUME</span></span>

<span data-ttu-id="de896-205">Esse identificador de formato é usado para transferir um caminho em um volume montado.</span><span class="sxs-lookup"><span data-stu-id="de896-205">This format identifier is used to transfer a path on a mounted volume.</span></span> <span data-ttu-id="de896-206">Ele é semelhante a [CF_HDROP](#cf_hdrop), mas contém apenas um único caminho e pode manipular as cadeias de caracteres de caminho mais longas que podem ser necessárias para representar um caminho quando o volume é montado em uma pasta.</span><span class="sxs-lookup"><span data-stu-id="de896-206">It is similar to [CF_HDROP](#cf_hdrop), but it contains only a single path and can handle the longer path strings that might be needed to represent a path when the volume is mounted on a folder.</span></span> <span data-ttu-id="de896-207">Os dados consistem em uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-207">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-208">O membro **HGLOBAL** da estrutura aponta para uma única cadeia de caracteres terminada em **nulo** que contém o caminho de arquivo totalmente qualificado.</span><span class="sxs-lookup"><span data-stu-id="de896-208">The structure's **hGlobal** member points to a single **null**-terminated string containing the fully qualified file path.</span></span> <span data-ttu-id="de896-209">A cadeia de caracteres de caminho deve terminar com um \\ caractere ' ', seguido pelo **nulo** de terminação.</span><span class="sxs-lookup"><span data-stu-id="de896-209">The path string must end with a '\\' character, followed by the terminating **NULL**.</span></span>

<span data-ttu-id="de896-210">Antes do Windows 2000, os volumes podiam ser montados somente em letras de unidade.</span><span class="sxs-lookup"><span data-stu-id="de896-210">Prior to Windows 2000, volumes could be mounted only on drive letters.</span></span> <span data-ttu-id="de896-211">Para sistemas Windows 2000 e posteriores com uma unidade formatada NTFS, você também pode montar volumes em pastas vazias.</span><span class="sxs-lookup"><span data-stu-id="de896-211">For Windows 2000 and later systems with an NTFS formatted drive, you can also mount volumes on empty folders.</span></span> <span data-ttu-id="de896-212">Esse recurso permite que um volume seja montado sem a necessidade de uma letra de unidade.</span><span class="sxs-lookup"><span data-stu-id="de896-212">This feature allows a volume to be mounted without taking up a drive letter.</span></span> <span data-ttu-id="de896-213">O volume montado pode usar qualquer formato com suporte no momento, incluindo FAT, FAT32, NTFS e CDFS.</span><span class="sxs-lookup"><span data-stu-id="de896-213">The mounted volume can use any currently supported format, including FAT, FAT32, NTFS, and CDFS.</span></span>

<span data-ttu-id="de896-214">Você pode adicionar páginas a uma folha de propriedades de propriedades da unidade implementando um [manipulador de folha de propriedades](propsheet-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="de896-214">You can add pages to a Drive Properties property sheet by implementing a [property sheet handler](propsheet-handlers.md).</span></span> <span data-ttu-id="de896-215">Se o volume for montado em uma letra de unidade, o Shell passa as informações de caminho para o manipulador com o formato [CF_HDROP](#cf_hdrop) .</span><span class="sxs-lookup"><span data-stu-id="de896-215">If the volume is mounted on a drive letter, the Shell passes path information to the handler with the [CF_HDROP](#cf_hdrop) format.</span></span> <span data-ttu-id="de896-216">Com o Windows 2000 e sistemas posteriores, o formato de CF_HDROP é usado quando um volume é montado em uma letra de unidade, assim como acontece com os sistemas anteriores.</span><span class="sxs-lookup"><span data-stu-id="de896-216">With Windows 2000 and later systems, the CF_HDROP format is used when a volume is mounted on a drive letter, just as with earlier systems.</span></span> <span data-ttu-id="de896-217">No entanto, se um volume for montado em uma pasta, o identificador de formato [CFSTR_MOUNTEDVOLUME](#cfstr_mountedvolume) será usado em vez de CF_HDROP.</span><span class="sxs-lookup"><span data-stu-id="de896-217">However, if a volume is mounted on a folder, the [CFSTR_MOUNTEDVOLUME](#cfstr_mountedvolume) format identifier is used instead of CF_HDROP.</span></span>

<span data-ttu-id="de896-218">Se apenas letras de unidade forem usadas para montar volumes, somente [CF_HDROP](#cf_hdrop) serão usadas, e os manipuladores de folha de propriedades existentes funcionarão como faziam com os sistemas anteriores.</span><span class="sxs-lookup"><span data-stu-id="de896-218">If only drive letters will be used to mount volumes, only [CF_HDROP](#cf_hdrop) will be used, and existing property sheet handlers will work as they did with earlier systems.</span></span> <span data-ttu-id="de896-219">No entanto, se você quiser que seu manipulador exiba uma página para volumes que são montados em pastas, bem como letras de unidade, o manipulador deve ser capaz de entender os formatos CSFTR_MOUNTEDVOLUME e CF_HDROP.</span><span class="sxs-lookup"><span data-stu-id="de896-219">However, if you want your handler to display a page for volumes that are mounted on folders as well as drive letters, the handler must be able to understand both the CSFTR_MOUNTEDVOLUME and CF_HDROP formats.</span></span>

### <a name="cfstr_shellidlist"></a><span data-ttu-id="de896-220">CFSTR_SHELLIDLIST</span><span class="sxs-lookup"><span data-stu-id="de896-220">CFSTR_SHELLIDLIST</span></span>

<span data-ttu-id="de896-221">Esse identificador de formato é usado ao transferir os locais de um ou mais objetos de namespace existentes.</span><span class="sxs-lookup"><span data-stu-id="de896-221">This format identifier is used when transferring the locations of one or more existing namespace objects.</span></span> <span data-ttu-id="de896-222">Ele é usado quase da mesma forma que [CF_HDROP](#cf_hdrop), mas contém PIDLs em vez de caminhos do sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="de896-222">It is used in much the same way as [CF_HDROP](#cf_hdrop), but it contains PIDLs instead of file system paths.</span></span> <span data-ttu-id="de896-223">O uso de PIDLs permite que o formato de CFSTR_SHELLIDLIST manipule objetos virtuais, bem como objetos do sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="de896-223">Using PIDLs allows the CFSTR_SHELLIDLIST format to handle virtual objects as well as file system objects.</span></span> <span data-ttu-id="de896-224">Os dados são uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-224">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-225">O membro **HGLOBAL** da estrutura aponta para uma estrutura [**cida**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) .</span><span class="sxs-lookup"><span data-stu-id="de896-225">The structure's **hGlobal** member points to a [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure.</span></span>

<span data-ttu-id="de896-226">O membro **aoffset** da estrutura [**cida**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) é uma matriz que contém deslocamentos para o início da estrutura [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) para cada PIDL que está sendo transferido.</span><span class="sxs-lookup"><span data-stu-id="de896-226">The **aoffset** member of the [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure is an array containing offsets to the beginning of the [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure for each PIDL that is being transferred.</span></span> <span data-ttu-id="de896-227">Para extrair um PIDL específico, primeiro determine seu índice.</span><span class="sxs-lookup"><span data-stu-id="de896-227">To extract a particular PIDL, first determine its index.</span></span> <span data-ttu-id="de896-228">Em seguida, adicione o valor **aoffset** que corresponde a esse índice ao endereço da estrutura **cida** .</span><span class="sxs-lookup"><span data-stu-id="de896-228">Then, add the **aoffset** value that corresponds to that index to the address of the **CIDA** structure.</span></span>

<span data-ttu-id="de896-229">O primeiro elemento de **aoffset** contém um deslocamento para o PIDL totalmente qualificado de uma pasta pai.</span><span class="sxs-lookup"><span data-stu-id="de896-229">The first element of **aoffset** contains an offset to the fully qualified PIDL of a parent folder.</span></span> <span data-ttu-id="de896-230">Se esse PIDL estiver vazio, a pasta pai será a área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="de896-230">If this PIDL is empty, the parent folder is the desktop.</span></span> <span data-ttu-id="de896-231">Cada um dos elementos restantes da matriz contém um deslocamento para um dos PIDLs a ser transferido.</span><span class="sxs-lookup"><span data-stu-id="de896-231">Each of the remaining elements of the array contains an offset to one of the PIDLs to be transferred.</span></span> <span data-ttu-id="de896-232">Todos esses PIDLs são relativos ao PIDL da pasta pai.</span><span class="sxs-lookup"><span data-stu-id="de896-232">All of these PIDLs are relative to the PIDL of the parent folder.</span></span>

<span data-ttu-id="de896-233">As duas macros a seguir podem ser usadas para recuperar PIDLs de uma estrutura [**cida**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) .</span><span class="sxs-lookup"><span data-stu-id="de896-233">The following two macros can be used to retrieve PIDLs from a [**CIDA**](/windows/win32/api/shlobj_core/ns-shlobj_core-cida) structure.</span></span> <span data-ttu-id="de896-234">A primeira pega um ponteiro para a estrutura e recupera o PIDL da pasta pai.</span><span class="sxs-lookup"><span data-stu-id="de896-234">The first takes a pointer to the structure and retrieves the PIDL of the parent folder.</span></span> <span data-ttu-id="de896-235">O segundo usa um ponteiro para a estrutura e recupera um dos outros PIDLs, identificados por seu índice de base zero.</span><span class="sxs-lookup"><span data-stu-id="de896-235">The second takes a pointer to the structure and retrieves one of the other PIDLs, identified by its zero-based index.</span></span>


```C++
#define GetPIDLFolder(pida) (LPCITEMIDLIST)(((LPBYTE)pida)+(pida)->aoffset[0])

#define GetPIDLItem(pida, i) (LPCITEMIDLIST)(((LPBYTE)pida)+(pida)->aoffset[i+1])
```

> [!Note]  
> <span data-ttu-id="de896-236">O valor retornado por essas macros é um ponteiro para a estrutura [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) do PIDL.</span><span class="sxs-lookup"><span data-stu-id="de896-236">The value that is returned by these macros is a pointer to the PIDL's [**ITEMIDLIST**](/windows/desktop/api/Shtypes/ns-shtypes-itemidlist) structure.</span></span> <span data-ttu-id="de896-237">Como essas estruturas variam em comprimento, você deve determinar o fim da estrutura percorrendo cada uma das estruturas [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) da estrutura de **ITEMIDLIST** até alcançar o **nulo** de dois bytes que marca o final.</span><span class="sxs-lookup"><span data-stu-id="de896-237">Since these structures vary in length, you must determine the end of the structure by walking through each of the **ITEMIDLIST** structure's [**SHITEMID**](/windows/desktop/api/Shtypes/ns-shtypes-shitemid) structures until you reach the two-byte **NULL** that marks the end.</span></span>

### <a name="cfstr_shellidlistoffset"></a><span data-ttu-id="de896-238">CFSTR_SHELLIDLISTOFFSET</span><span class="sxs-lookup"><span data-stu-id="de896-238">CFSTR_SHELLIDLISTOFFSET</span></span>

<span data-ttu-id="de896-239">Esse identificador de formato é usado com formatos como [CF_HDROP](#cf_hdrop), [CFSTR_SHELLIDLIST](#cfstr_shellidlist)e [CFSTR_FILECONTENTS](#cfstr_filecontents) para especificar a posição de um grupo de objetos após uma transferência.</span><span class="sxs-lookup"><span data-stu-id="de896-239">This format identifier is used with formats such as [CF_HDROP](#cf_hdrop), [CFSTR_SHELLIDLIST](#cfstr_shellidlist), and [CFSTR_FILECONTENTS](#cfstr_filecontents) to specify the position of a group of objects following a transfer.</span></span> <span data-ttu-id="de896-240">Os dados consistem em uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-240">The data consists of an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-241">O membro **HGLOBAL** da estrutura aponta para uma matriz de estruturas de [**ponto**](/previous-versions//dd162805(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="de896-241">The structure's **hGlobal** member points to an array of [**POINT**](/previous-versions//dd162805(v=vs.85)) structures.</span></span> <span data-ttu-id="de896-242">A primeira estrutura especifica as coordenadas da tela, em pixels, do canto superior esquerdo do retângulo que se aproxima do grupo.</span><span class="sxs-lookup"><span data-stu-id="de896-242">The first structure specifies the screen coordinates, in pixels, of the upper-left corner of the rectangle that encloses the group.</span></span> <span data-ttu-id="de896-243">O restante das estruturas especifica os locais dos objetos individuais relativos à posição do grupo.</span><span class="sxs-lookup"><span data-stu-id="de896-243">The remainder of the structures specify the locations of the individual objects relative to the group's position.</span></span> <span data-ttu-id="de896-244">Eles devem estar na mesma ordem usada para listar os objetos no formato associado.</span><span class="sxs-lookup"><span data-stu-id="de896-244">They must be in the same order as that used to list the objects in the associated format.</span></span>

## <a name="formats-for-transferring-virtual-objects"></a><span data-ttu-id="de896-245">Formatos para transferência de objetos virtuais</span><span class="sxs-lookup"><span data-stu-id="de896-245">Formats for Transferring Virtual Objects</span></span>

<span data-ttu-id="de896-246">O formato de CFSTR_SHELLIDLIST pode ser usado para transferir o sistema de arquivos e objetos virtuais.</span><span class="sxs-lookup"><span data-stu-id="de896-246">The CFSTR_SHELLIDLIST format can be used to transfer both file system and virtual objects.</span></span> <span data-ttu-id="de896-247">No entanto, há também vários formatos especializados para transferir tipos específicos de objetos virtuais.</span><span class="sxs-lookup"><span data-stu-id="de896-247">However, there are also several specialized formats for transferring particular types of virtual objects.</span></span>

-   [<span data-ttu-id="de896-248">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="de896-248">CFSTR_NETRESOURCES</span></span>](#cfstr_netresources)
-   [<span data-ttu-id="de896-249">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="de896-249">CFSTR_PRINTERGROUP</span></span>](#cfstr_printergroup)
-   [<span data-ttu-id="de896-250">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="de896-250">CFSTR_INETURL</span></span>](#cfstr_ineturl)
-   [<span data-ttu-id="de896-251">CFSTR_SHELLURL (preterido)</span><span class="sxs-lookup"><span data-stu-id="de896-251">CFSTR_SHELLURL (deprecated)</span></span>](#cfstr_shellurl-deprecated)

### <a name="cfstr_netresources"></a><span data-ttu-id="de896-252">CFSTR_NETRESOURCES</span><span class="sxs-lookup"><span data-stu-id="de896-252">CFSTR_NETRESOURCES</span></span>

<span data-ttu-id="de896-253">Esse identificador de formato é usado ao transferir recursos de rede, como um domínio ou servidor.</span><span class="sxs-lookup"><span data-stu-id="de896-253">This format identifier is used when transferring network resources, such as a domain or server.</span></span> <span data-ttu-id="de896-254">Os dados são uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-254">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-255">O membro **HGLOBAL** da estrutura aponta para uma estrutura [**NRESARRAY**](/windows/desktop/api/shlobj_core/ns-shlobj_core-nresarray) .</span><span class="sxs-lookup"><span data-stu-id="de896-255">The structure's **hGlobal** member points to a [**NRESARRAY**](/windows/desktop/api/shlobj_core/ns-shlobj_core-nresarray) structure.</span></span> <span data-ttu-id="de896-256">O membro **NR** dessa estrutura indica uma estrutura de [**NETRESOURCE**](/windows/win32/api/rrascfg/nn-rrascfg-ieapproviderconfig) cujo membro **lpRemoteName** contém uma cadeia de caracteres terminada em **nulo** que identifica o recurso de rede.</span><span class="sxs-lookup"><span data-stu-id="de896-256">The **nr** member of that structure indicates a [**NETRESOURCE**](/windows/win32/api/rrascfg/nn-rrascfg-ieapproviderconfig) structure whose **lpRemoteName** member contains a **null**-terminated string identifying the network resource.</span></span> <span data-ttu-id="de896-257">O destino de soltura pode usar os dados com qualquer uma das funções de API do [WNet (rede do Windows)](../wnet/windows-networking-wnet-.md) , como [**WNetAddConnection**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona), para executar operações de rede no objeto.</span><span class="sxs-lookup"><span data-stu-id="de896-257">The drop target can then use the data with any of the [Windows Networking (WNet)](../wnet/windows-networking-wnet-.md) API functions, such as [**WNetAddConnection**](/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnectiona), to perform network operations on the object.</span></span>

### <a name="cfstr_printergroup"></a><span data-ttu-id="de896-258">CFSTR_PRINTERGROUP</span><span class="sxs-lookup"><span data-stu-id="de896-258">CFSTR_PRINTERGROUP</span></span>

<span data-ttu-id="de896-259">Esse identificador de formato é usado ao transferir os nomes amigáveis de impressoras.</span><span class="sxs-lookup"><span data-stu-id="de896-259">This format identifier is used when transferring the friendly names of printers.</span></span> <span data-ttu-id="de896-260">Os dados são uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-260">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-261">O membro **HGLOBAL** da estrutura aponta para uma cadeia de caracteres no mesmo formato usado com [CF_HDROP](#cf_hdrop).</span><span class="sxs-lookup"><span data-stu-id="de896-261">The structure's **hGlobal** member points to a string in the same format as that used with [CF_HDROP](#cf_hdrop).</span></span> <span data-ttu-id="de896-262">No entanto, o membro **pFiles** da estrutura [**DropFiles**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) contém um ou mais nomes amigáveis de impressoras em vez de caminhos de arquivo.</span><span class="sxs-lookup"><span data-stu-id="de896-262">However, the **pFiles** member of the [**DROPFILES**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropfiles) structure contains one or more friendly names of printers instead of file paths.</span></span>

### <a name="cfstr_ineturl"></a><span data-ttu-id="de896-263">CFSTR_INETURL</span><span class="sxs-lookup"><span data-stu-id="de896-263">CFSTR_INETURL</span></span>

<span data-ttu-id="de896-264">Este identificador de formato substitui [CFSTR_SHELLURL (preterido)](#cfstr_shellurl-deprecated).</span><span class="sxs-lookup"><span data-stu-id="de896-264">This format identifier replaces [CFSTR_SHELLURL (deprecated)](#cfstr_shellurl-deprecated).</span></span> <span data-ttu-id="de896-265">Se você quiser que seu aplicativo manipule URLs da área de transferência, use CFSTR_INETURL em vez de CFSTR_SHELLURL (preterido).</span><span class="sxs-lookup"><span data-stu-id="de896-265">If you want your application to manipulate clipboard URLs, use CFSTR_INETURL instead of CFSTR_SHELLURL (deprecated).</span></span> <span data-ttu-id="de896-266">Esse formato fornece a melhor representação da área de transferência de uma única URL.</span><span class="sxs-lookup"><span data-stu-id="de896-266">This format gives the best clipboard representation of a single URL.</span></span> <span data-ttu-id="de896-267">Se o UNICODE não estiver definido, o aplicativo recuperará a versão CF_TEXT/CFSTR_SHELLURL da URL.</span><span class="sxs-lookup"><span data-stu-id="de896-267">If UNICODE is not defined, the application retrieves the CF_TEXT/CFSTR_SHELLURL version of the URL.</span></span> <span data-ttu-id="de896-268">Se o UNICODE estiver definido, o aplicativo recuperará a versão CF_UNICODE da URL.</span><span class="sxs-lookup"><span data-stu-id="de896-268">If UNICODE is defined, the application retrieves the CF_UNICODE version of the URL.</span></span>

### <a name="cfstr_shellurl-deprecated"></a><span data-ttu-id="de896-269">CFSTR_SHELLURL (preterido)</span><span class="sxs-lookup"><span data-stu-id="de896-269">CFSTR_SHELLURL (deprecated)</span></span>

> [!Note]  
> <span data-ttu-id="de896-270">Este identificador de formato foi preterido; em vez disso, use CFSTR_INETURL.</span><span class="sxs-lookup"><span data-stu-id="de896-270">This format identifier has been deprecated; use CFSTR_INETURL instead.</span></span>

 

## <a name="formats-for-communication-between-source-and-target"></a><span data-ttu-id="de896-271">Formatos de comunicação entre a origem e o destino</span><span class="sxs-lookup"><span data-stu-id="de896-271">Formats for Communication Between Source and Target</span></span>

<span data-ttu-id="de896-272">Esses identificadores de formato permitem a comunicação entre a origem e o destino.</span><span class="sxs-lookup"><span data-stu-id="de896-272">These format identifiers allow communication between source and target.</span></span> <span data-ttu-id="de896-273">Os formatos acompanham os dados e proporcionam aos aplicativos um grau maior de controle sobre as operações de arrastar-copiar-colar ou do tipo Drag-e-drop que envolvem objetos shell.</span><span class="sxs-lookup"><span data-stu-id="de896-273">The formats accompany the data and give applications a greater degree of control over move-copy-paste or drag-and-drop operations involving Shell objects.</span></span>

-   [<span data-ttu-id="de896-274">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="de896-274">CFSTR_INDRAGLOOP</span></span>](#cfstr_indragloop)
-   [<span data-ttu-id="de896-275">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="de896-275">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>](#cfstr_logicalperformeddropeffect)
-   [<span data-ttu-id="de896-276">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="de896-276">CFSTR_PASTESUCCEEDED</span></span>](#cfstr_pastesucceeded)
-   [<span data-ttu-id="de896-277">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="de896-277">CFSTR_PERFORMEDDROPEFFECT</span></span>](#cfstr_performeddropeffect)
-   [<span data-ttu-id="de896-278">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="de896-278">CFSTR_PREFERREDDROPEFFECT</span></span>](#cfstr_preferreddropeffect)
-   [<span data-ttu-id="de896-279">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="de896-279">CFSTR_TARGETCLSID</span></span>](#cfstr_targetclsid)
-   [<span data-ttu-id="de896-280">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="de896-280">CFSTR_UNTRUSTEDDRAGDROP</span></span>](#cfstr_untrusteddragdrop)
-   [<span data-ttu-id="de896-281">DragWindow</span><span class="sxs-lookup"><span data-stu-id="de896-281">DragWindow</span></span>](#dragwindow)

### <a name="cfstr_indragloop"></a><span data-ttu-id="de896-282">CFSTR_INDRAGLOOP</span><span class="sxs-lookup"><span data-stu-id="de896-282">CFSTR_INDRAGLOOP</span></span>

<span data-ttu-id="de896-283">Esse identificador de formato é usado por um objeto de dados para indicar se ele está em um loop de arrastar e soltar.</span><span class="sxs-lookup"><span data-stu-id="de896-283">This format identifier is used by a data object to indicate whether it is in a drag-and-drop loop.</span></span> <span data-ttu-id="de896-284">Os dados são uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-284">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-285">O membro **HGLOBAL** da estrutura aponta para um valor **DWORD** .</span><span class="sxs-lookup"><span data-stu-id="de896-285">The structure's **hGlobal** member points to a **DWORD** value.</span></span> <span data-ttu-id="de896-286">Se o valor **DWORD** for diferente de zero, o objeto de dados estará dentro de um loop de arrastar e soltar.</span><span class="sxs-lookup"><span data-stu-id="de896-286">If the **DWORD** value is nonzero, the data object is within a drag-and-drop loop.</span></span> <span data-ttu-id="de896-287">Se o valor for definido como zero, o objeto de dados não estará dentro de um loop de arrastar e soltar.</span><span class="sxs-lookup"><span data-stu-id="de896-287">If the value is set to zero, the data object is not within a drag-and-drop loop.</span></span>

<span data-ttu-id="de896-288">Alguns destinos de soltura podem chamar [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) e tentar extrair dados enquanto o objeto ainda está dentro do loop do tipo "arrastar e soltar".</span><span class="sxs-lookup"><span data-stu-id="de896-288">Some drop targets might call [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) and attempt to extract data while the object is still within the drag-and-drop loop.</span></span> <span data-ttu-id="de896-289">A renderização total do objeto para cada ocorrência desse tipo pode fazer com que o cursor de arrastar seja interrompido.</span><span class="sxs-lookup"><span data-stu-id="de896-289">Fully rendering the object for each such occurrence might cause the drag cursor to stall.</span></span> <span data-ttu-id="de896-290">Se o objeto de dados der suporte a [CFSTR_INDRAGLOOP](#cfstr_indragloop), o destino poderá usar esse formato para verificar o status do loop do tipo "arrastar e soltar" e evitar a renderização intensiva da memória do objeto até que ele seja realmente removido.</span><span class="sxs-lookup"><span data-stu-id="de896-290">If the data object supports [CFSTR_INDRAGLOOP](#cfstr_indragloop), the target can instead use that format to check the status of the drag-and-drop loop and avoid memory intensive rendering of the object until it is actually dropped.</span></span> <span data-ttu-id="de896-291">Os formatos que têm uso intensivo de memória para renderização ainda devem ser incluídos no enumerador [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) e em chamadas para [**IDataObject:: QueryGetData**](/windows/win32/api/objidl/nf-objidl-idataobject-querygetdata).</span><span class="sxs-lookup"><span data-stu-id="de896-291">The formats that are memory intensive to render should still be included in the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) enumerator and in calls to [**IDataObject::QueryGetData**](/windows/win32/api/objidl/nf-objidl-idataobject-querygetdata).</span></span> <span data-ttu-id="de896-292">Se o objeto de dados não definir CFSTR_INDRAGLOOP, ele deverá agir como se o valor fosse definido como zero.</span><span class="sxs-lookup"><span data-stu-id="de896-292">If the data object does not set CFSTR_INDRAGLOOP, it should act as if the value is set to zero.</span></span>

### <a name="cfstr_logicalperformeddropeffect"></a><span data-ttu-id="de896-293">CFSTR_LOGICALPERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="de896-293">CFSTR_LOGICALPERFORMEDDROPEFFECT</span></span>

<span data-ttu-id="de896-294">[Versão 5,0.](versions.md) Esse identificador de formato permite que uma fonte de soltar chame o método [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) do objeto de dados para determinar o resultado de uma transferência de dados do Shell.</span><span class="sxs-lookup"><span data-stu-id="de896-294">[Version 5.0.](versions.md)This format identifier allows a drop source to call the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method to determine the outcome of a Shell data transfer.</span></span> <span data-ttu-id="de896-295">Os dados são uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-295">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-296">O membro **HGLOBAL** da estrutura aponta para um DWORD que contém um valor [**DROPEFFECT**](../com/dropeffect-constants.md) .</span><span class="sxs-lookup"><span data-stu-id="de896-296">The structure's **hGlobal** member points to a DWORD containing a [**DROPEFFECT**](../com/dropeffect-constants.md) value.</span></span>

<span data-ttu-id="de896-297">O identificador de formato de [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) foi projetado para permitir que o destino indique ao objeto de dados qual operação foi realmente realizada.</span><span class="sxs-lookup"><span data-stu-id="de896-297">The [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format identifier was intended to allow the target to indicate to the data object what operation actually took place.</span></span> <span data-ttu-id="de896-298">No entanto, o Shell usa [movimentações otimizadas](datascenarios.md) para objetos do sistema de arquivos sempre que possível.</span><span class="sxs-lookup"><span data-stu-id="de896-298">However, the Shell uses [optimized moves](datascenarios.md) for file system objects whenever possible.</span></span> <span data-ttu-id="de896-299">Nesse caso, o Shell normalmente define o valor de CFSTR_PERFORMEDDROPEFFECT como DROPEFFECT_NONE, para indicar ao objeto de dados que os dados originais foram excluídos.</span><span class="sxs-lookup"><span data-stu-id="de896-299">In that case, the Shell normally sets the CFSTR_PERFORMEDDROPEFFECT value to DROPEFFECT_NONE, to indicate to the data object that the original data has been deleted.</span></span> <span data-ttu-id="de896-300">Portanto, a origem não pode usar o valor CFSTR_PERFORMEDDROPEFFECT para determinar qual operação foi realizada.</span><span class="sxs-lookup"><span data-stu-id="de896-300">Thus, the source cannot use the CFSTR_PERFORMEDDROPEFFECT value to determine which operation has taken place.</span></span> <span data-ttu-id="de896-301">Embora a maioria das fontes não precise dessas informações, há algumas exceções.</span><span class="sxs-lookup"><span data-stu-id="de896-301">While most sources do not need this information, there are some exceptions.</span></span> <span data-ttu-id="de896-302">Por exemplo, embora as movimentações otimizadas eliminem a necessidade de uma origem excluir qualquer dado, a origem ainda pode precisar atualizar um banco de dados relacionado para indicar que os arquivos foram movidos ou copiados.</span><span class="sxs-lookup"><span data-stu-id="de896-302">For instance, even though optimized moves eliminate the need for a source to delete any data, the source might still need to update a related database to indicate that the files have been moved or copied.</span></span>

<span data-ttu-id="de896-303">Se uma fonte precisar saber qual operação ocorreu, ela poderá chamar o método [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) do objeto de dados e solicitar o formato CFSTR_LOGICALPERFORMEDDROPEFFECT.</span><span class="sxs-lookup"><span data-stu-id="de896-303">If a source needs to know which operation took place, it can call the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method and request the CFSTR_LOGICALPERFORMEDDROPEFFECT format.</span></span> <span data-ttu-id="de896-304">Esse formato essencialmente reflete o que acontece no ponto de vista do usuário depois que a operação é concluída.</span><span class="sxs-lookup"><span data-stu-id="de896-304">This format essentially reflects what happens from the user's point of view after the operation is complete.</span></span> <span data-ttu-id="de896-305">Se um novo arquivo for criado e o arquivo original for excluído, o usuário verá uma operação de movimentação e o valor de dados do formato será definido como DROPEFFECT_MOVE.</span><span class="sxs-lookup"><span data-stu-id="de896-305">If a new file is created and the original file is deleted, the user sees a move operation and the format's data value is set to DROPEFFECT_MOVE.</span></span> <span data-ttu-id="de896-306">Se o arquivo original ainda estiver lá, o usuário verá uma operação de cópia e o valor de dados do formato será definido como DROPEFFECT_COPY.</span><span class="sxs-lookup"><span data-stu-id="de896-306">If the original file is still there, the user sees a copy operation and the format's data value is set to DROPEFFECT_COPY.</span></span> <span data-ttu-id="de896-307">Se um link tiver sido criado, o valor de dados do formato será DROPEFFECT_LINK.</span><span class="sxs-lookup"><span data-stu-id="de896-307">If a link was created, the format's data value will be DROPEFFECT_LINK.</span></span>

### <a name="cfstr_pastesucceeded"></a><span data-ttu-id="de896-308">CFSTR_PASTESUCCEEDED</span><span class="sxs-lookup"><span data-stu-id="de896-308">CFSTR_PASTESUCCEEDED</span></span>

<span data-ttu-id="de896-309">Esse identificador de formato é usado pelo destino para informar o objeto de dados, por meio de seu método [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) , que uma operação de exclusão ao colar foi bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="de896-309">This format identifier is used by the target to inform the data object, through its [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method, that a delete-on-paste operation succeeded.</span></span> <span data-ttu-id="de896-310">Os dados são uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-310">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-311">O membro **HGLOBAL** da estrutura aponta para um **DWORD** que contém um valor [**DROPEFFECT**](../com/dropeffect-constants.md) .</span><span class="sxs-lookup"><span data-stu-id="de896-311">The structure's **hGlobal** member points to a **DWORD** containing a [**DROPEFFECT**](../com/dropeffect-constants.md) value.</span></span> <span data-ttu-id="de896-312">Esse formato é usado para notificar o objeto de dados que ele deve concluir a operação de recorte e excluir os dados originais, se necessário.</span><span class="sxs-lookup"><span data-stu-id="de896-312">This format is used to notify the data object that it should complete the cut operation and delete the original data, if necessary.</span></span> <span data-ttu-id="de896-313">Para obter mais informações, consulte [operações de excluir em colar](datascenarios.md).</span><span class="sxs-lookup"><span data-stu-id="de896-313">For more information, see [Delete-on-Paste Operations](datascenarios.md).</span></span>

### <a name="cfstr_performeddropeffect"></a><span data-ttu-id="de896-314">CFSTR_PERFORMEDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="de896-314">CFSTR_PERFORMEDDROPEFFECT</span></span>

<span data-ttu-id="de896-315">Esse identificador de formato é usado pelo destino para informar o objeto de dados por meio de seu método [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) do resultado de uma transferência de dados.</span><span class="sxs-lookup"><span data-stu-id="de896-315">This format identifier is used by the target to inform the data object through its [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method of the outcome of a data transfer.</span></span> <span data-ttu-id="de896-316">Os dados são uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-316">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-317">O membro **HGLOBAL** da estrutura aponta para um **DWORD** definido como o valor [**DROPEFFECT**](../com/dropeffect-constants.md) apropriado, normalmente DROPEFFECT_MOVE ou DROPEFFECT_COPY.</span><span class="sxs-lookup"><span data-stu-id="de896-317">The structure's **hGlobal** member points to a **DWORD** set to the appropriate [**DROPEFFECT**](../com/dropeffect-constants.md) value, normally DROPEFFECT_MOVE or DROPEFFECT_COPY.</span></span>

<span data-ttu-id="de896-318">Esse formato normalmente é usado quando o resultado de uma operação pode ser mover ou copiar, como em uma operação de [movimentação otimizada](datascenarios.md) ou de exclusão ao colar.</span><span class="sxs-lookup"><span data-stu-id="de896-318">This format is normally used when the outcome of an operation can be either move or copy, such as in an [optimized move](datascenarios.md) or delete-on-paste operation.</span></span> <span data-ttu-id="de896-319">Ele fornece uma maneira confiável para o destino informar ao objeto de dados o que realmente aconteceu.</span><span class="sxs-lookup"><span data-stu-id="de896-319">It provides a reliable way for the target to tell the data object what actually happened.</span></span> <span data-ttu-id="de896-320">Ele foi introduzido porque o valor de *pdwEffect* retornado por [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) não indicou de forma confiável qual operação ocorreu.</span><span class="sxs-lookup"><span data-stu-id="de896-320">It was introduced because the value of *pdwEffect* returned by [**DoDragDrop**](/windows/win32/api/ole2/nf-ole2-dodragdrop) did not reliably indicate which operation had taken place.</span></span> <span data-ttu-id="de896-321">O formato de [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) é a maneira confiável de indicar que uma movimentação não otimizada foi feita.</span><span class="sxs-lookup"><span data-stu-id="de896-321">The [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format is the reliable way to indicate that an unoptimized move has taken place.</span></span>

### <a name="cfstr_preferreddropeffect"></a><span data-ttu-id="de896-322">CFSTR_PREFERREDDROPEFFECT</span><span class="sxs-lookup"><span data-stu-id="de896-322">CFSTR_PREFERREDDROPEFFECT</span></span>

<span data-ttu-id="de896-323">Esse identificador de formato é usado pela origem para especificar se seu método preferencial de transferência de dados é mover ou copiar.</span><span class="sxs-lookup"><span data-stu-id="de896-323">This format identifier is used by the source to specify whether its preferred method of data transfer is move or copy.</span></span> <span data-ttu-id="de896-324">Um destino de soltura solicita esse formato chamando o método [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) do objeto de dados.</span><span class="sxs-lookup"><span data-stu-id="de896-324">A drop target requests this format by calling the data object's [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method.</span></span> <span data-ttu-id="de896-325">Os dados são uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-325">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-326">O membro **HGLOBAL** da estrutura aponta para um valor **DWORD** .</span><span class="sxs-lookup"><span data-stu-id="de896-326">The structure's **hGlobal** member points to a **DWORD** value.</span></span> <span data-ttu-id="de896-327">Esse valor é definido como DROPEFFECT_MOVE se uma operação de movimentação for preferida ou DROPEFFECT_COPY se uma operação de cópia for preferida.</span><span class="sxs-lookup"><span data-stu-id="de896-327">This value is set to DROPEFFECT_MOVE if a move operation is preferred or DROPEFFECT_COPY if a copy operation is preferred.</span></span>

<span data-ttu-id="de896-328">Esse recurso é usado quando uma fonte pode oferecer suporte a uma operação de movimentação ou cópia.</span><span class="sxs-lookup"><span data-stu-id="de896-328">This feature is used when a source can support either a move or copy operation.</span></span> <span data-ttu-id="de896-329">Ele usa o formato [CFSTR_PREFERREDDROPEFFECT](#cfstr_preferreddropeffect) para comunicar sua preferência ao destino.</span><span class="sxs-lookup"><span data-stu-id="de896-329">It uses the [CFSTR_PREFERREDDROPEFFECT](#cfstr_preferreddropeffect) format to communicate its preference to the target.</span></span> <span data-ttu-id="de896-330">Como o destino não é obrigada a honrar a solicitação, o destino deve chamar o método [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) da origem com um formato [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) para informar ao objeto de dados qual operação foi realmente executada.</span><span class="sxs-lookup"><span data-stu-id="de896-330">Because the target is not obligated to honor the request, the target must call the source's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method with a [CFSTR_PERFORMEDDROPEFFECT](#cfstr_performeddropeffect) format to tell the data object which operation was actually performed.</span></span>

<span data-ttu-id="de896-331">Com uma operação [Delete-on-Paste](datascenarios.md) , o formato CFSTR_PREFERREDDROPFORMAT é usado para informar ao destino se a origem fez uma recorte ou cópia.</span><span class="sxs-lookup"><span data-stu-id="de896-331">With a [delete-on-paste](datascenarios.md) operation, the CFSTR_PREFERREDDROPFORMAT format is used to tell the target whether the source did a cut or copy.</span></span> <span data-ttu-id="de896-332">Com uma operação de arrastar e soltar, você pode usar CFSTR_PREFERREDDROPFORMAT para especificar a ação do Shell.</span><span class="sxs-lookup"><span data-stu-id="de896-332">With a drag-and-drop operation, you can use CFSTR_PREFERREDDROPFORMAT to specify the Shell's action.</span></span> <span data-ttu-id="de896-333">Se esse formato não estiver presente, o Shell executará uma ação padrão, com base no contexto.</span><span class="sxs-lookup"><span data-stu-id="de896-333">If this format is not present, the Shell performs a default action, based on context.</span></span> <span data-ttu-id="de896-334">Por exemplo, se um usuário arrastar um arquivo de um volume e o soltar em outro volume, a ação padrão do shell será copiar o arquivo.</span><span class="sxs-lookup"><span data-stu-id="de896-334">For instance, if a user drags a file from one volume and drops it on another volume, the Shell's default action is to copy the file.</span></span> <span data-ttu-id="de896-335">Ao incluir um formato de CFSTR_PREFERREDDROPFORMAT no objeto de dados, você pode substituir a ação padrão e dizer explicitamente ao shell para copiar, mover ou vincular o arquivo.</span><span class="sxs-lookup"><span data-stu-id="de896-335">By including a CFSTR_PREFERREDDROPFORMAT format in the data object, you can override the default action and explicitly tell the Shell to copy, move, or link the file.</span></span> <span data-ttu-id="de896-336">Se o usuário optar por arrastar com o botão à direita, CFSTR_PREFERREDDROPFORMAT especificará o comando padrão no menu de atalho [arrastar e soltar](context-menu-handlers.md) .</span><span class="sxs-lookup"><span data-stu-id="de896-336">If the user chooses to drag with the right button, CFSTR_PREFERREDDROPFORMAT specifies the default command on the [drag-and-drop](context-menu-handlers.md) shortcut menu.</span></span> <span data-ttu-id="de896-337">O usuário ainda está livre para escolher outros comandos no menu.</span><span class="sxs-lookup"><span data-stu-id="de896-337">The user is still free to choose other commands on the menu.</span></span>

<span data-ttu-id="de896-338">Antes do Microsoft Internet Explorer 4,0, um aplicativo indicou que ele estava transferindo tipos de arquivo de atalho, definindo FD_LINKUI no membro **dwFlags** da estrutura [**FileDescriptor**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) .</span><span class="sxs-lookup"><span data-stu-id="de896-338">Before Microsoft Internet Explorer 4.0, an application indicated that it was transferring shortcut file types by setting FD_LINKUI in the **dwFlags** member of the [**FILEDESCRIPTOR**](/windows/win32/api/shlobj_core/ns-shlobj_core-filedescriptora) structure.</span></span> <span data-ttu-id="de896-339">Os destinos precisavam usar uma chamada potencialmente demorada para [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) para descobrir se o sinalizador de FD_LINKUI foi definido.</span><span class="sxs-lookup"><span data-stu-id="de896-339">Targets then had to use a potentially time-consuming call to [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) to find out if the FD_LINKUI flag was set.</span></span> <span data-ttu-id="de896-340">Agora, a maneira preferida de indicar que os atalhos estão sendo transferidos é usar o formato CFSTR_PREFERREDDROPEFFECT definido como DROPEFFECT_LINK.</span><span class="sxs-lookup"><span data-stu-id="de896-340">Now, the preferred way to indicate that shortcuts are being transferred is to use the CFSTR_PREFERREDDROPEFFECT format set to DROPEFFECT_LINK.</span></span> <span data-ttu-id="de896-341">No entanto, para compatibilidade com versões anteriores com sistemas mais antigos, as fontes ainda devem definir o sinalizador FD_LINKUI.</span><span class="sxs-lookup"><span data-stu-id="de896-341">However, for backward compatibility with older systems, sources should still set the FD_LINKUI flag.</span></span>

### <a name="cfstr_targetclsid"></a><span data-ttu-id="de896-342">CFSTR_TARGETCLSID</span><span class="sxs-lookup"><span data-stu-id="de896-342">CFSTR_TARGETCLSID</span></span>

<span data-ttu-id="de896-343">Esse identificador de formato é usado por um destino para fornecer seu CLSID à origem.</span><span class="sxs-lookup"><span data-stu-id="de896-343">This format identifier is used by a target to provide its CLSID to the source.</span></span> <span data-ttu-id="de896-344">Os dados são uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-344">The data is an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-345">O membro **HGLOBAL** da estrutura aponta para o GUID do CLSID do destino de soltura.</span><span class="sxs-lookup"><span data-stu-id="de896-345">The structure's **hGlobal** member points to the CLSID GUID of the drop target.</span></span>

<span data-ttu-id="de896-346">Esse formato é usado principalmente para permitir que os objetos sejam excluídos arrastando-os para a lixeira.</span><span class="sxs-lookup"><span data-stu-id="de896-346">This format is used primarily to allow objects to be deleted by dragging them to the Recycle Bin.</span></span> <span data-ttu-id="de896-347">Quando um objeto é Descartado na lixeira, o método [**IDataObject:: SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) da origem é chamado com um formato CFSTR_TARGETCLSID definido como o CLSID da lixeira (CLSID_RecycleBin).</span><span class="sxs-lookup"><span data-stu-id="de896-347">When an object is dropped in the Recycle Bin, the source's [**IDataObject::SetData**](/windows/win32/api/objidl/nf-objidl-idataobject-setdata) method is called with a CFSTR_TARGETCLSID format set to the Recycle Bin's CLSID (CLSID_RecycleBin).</span></span> <span data-ttu-id="de896-348">A origem pode então excluir o objeto original.</span><span class="sxs-lookup"><span data-stu-id="de896-348">The source can then delete the original object.</span></span>

### <a name="cfstr_untrusteddragdrop"></a><span data-ttu-id="de896-349">CFSTR_UNTRUSTEDDRAGDROP</span><span class="sxs-lookup"><span data-stu-id="de896-349">CFSTR_UNTRUSTEDDRAGDROP</span></span>

<span data-ttu-id="de896-350">Esse identificador de formato é usado pelo Windows Internet Explorer e pelo shell do Windows para fornecer um mecanismo pelo qual bloquear ou solicitar operações de arrastar e soltar originadas do Internet Explorer em conjunto com o sinalizador de [**URLACTION_SHELL_ENHANCED_DRAGDROP_SECURITY**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="de896-350">This format identifier is used by Windows Internet Explorer and the Windows Shell to provide a mechanism through which to block or prompt for drag-and-drop operations originating from Internet Explorer in conjunction with the [**URLACTION_SHELL_ENHANCED_DRAGDROP_SECURITY**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) flag.</span></span>

<span data-ttu-id="de896-351">**CFSTR_UNTRUSTEDDRAGDROP** é adicionado pela origem de uma operação de arrastar e soltar para especificar que o objeto de dados pode conter dados não confiáveis.</span><span class="sxs-lookup"><span data-stu-id="de896-351">**CFSTR_UNTRUSTEDDRAGDROP** is added by the source of a drag-and-drop operation to specify that the data object might contain untrustworthy data.</span></span> <span data-ttu-id="de896-352">Os dados são representados por uma estrutura [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) que contém um objeto de memória global.</span><span class="sxs-lookup"><span data-stu-id="de896-352">The data is represented by an [**STGMEDIUM**](/windows/win32/api/objidl/ns-objidl-ustgmedium-r1) structure that contains a global memory object.</span></span> <span data-ttu-id="de896-353">O membro **HGLOBAL** da estrutura aponta para um **DWORD** definido como um sinalizador de [**ação de URL**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) apropriado para fazer com que uma política Verifique o método [**IInternetSecurityManager::P rocessurlaction**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537136(v=vs.85)) , usando o sinalizador [**PUAF_ENFORCERESTRICTED**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537171(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="de896-353">The structure's **hGlobal** member points to a **DWORD** set to an appropriate [**URL Action**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537178(v=vs.85)) flag to cause a policy check through the [**IInternetSecurityManager::ProcessUrlAction**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537136(v=vs.85)) method, using the [**PUAF_ENFORCERESTRICTED**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms537171(v=vs.85)) flag.</span></span>

### <a name="dragwindow"></a><span data-ttu-id="de896-354">DragWindow</span><span class="sxs-lookup"><span data-stu-id="de896-354">DragWindow</span></span>

<span data-ttu-id="de896-355">Esse formato é usado em uma operação de arrastar e soltar para identificar a imagem de arrastar de um objeto (janela) para que suas informações visuais possam ser atualizadas dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="de896-355">This format is used in a drag-and-drop operation to identify an object's drag image (window) so that its visual information can be updated dynamically.</span></span> <span data-ttu-id="de896-356">Quando um objeto é arrastado sobre um destino de soltar, um aplicativo atualiza sua estrutura [**DROPDESCRIPTION**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropdescription) em resposta ao método [**IDropTarget::D ragover**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) ou [**IDropSource:: GiveFeedback**](/windows/win32/api/oleidl/nf-oleidl-idropsource-givefeedback) .</span><span class="sxs-lookup"><span data-stu-id="de896-356">When an object is dragged over a drop target, an application updates its [**DROPDESCRIPTION**](/windows/desktop/api/shlobj_core/ns-shlobj_core-dropdescription) structure in response to the [**IDropTarget::DragOver**](/windows/win32/api/oleidl/nf-oleidl-idroptarget-dragover) or [**IDropSource::GiveFeedback**](/windows/win32/api/oleidl/nf-oleidl-idropsource-givefeedback) method.</span></span> <span data-ttu-id="de896-357">O **DROPDESCRIPTION** é atualizado com um novo valor [**DROPIMAGETYPE**](/windows/desktop/api/shlobj_core/ne-shlobj_core-dropimagetype) que indica a decoração a ser aplicada ao Visual da janela de arrastar; por exemplo, uma indicação de que o arquivo está sendo copiado em vez de movido ou que o objeto não pode ser Descartado para esse local.</span><span class="sxs-lookup"><span data-stu-id="de896-357">The **DROPDESCRIPTION** is updated with a new [**DROPIMAGETYPE**](/windows/desktop/api/shlobj_core/ne-shlobj_core-dropimagetype) value that indicates the decoration to be applied to the drag window's visual; for instance, an indication that the file is being copied rather than moved or that the object cannot be dropped to that location.</span></span> <span data-ttu-id="de896-358">No entanto, até que o objeto receba uma mensagem de [**DDWM_UPDATEWINDOW**](ddwm-updatewindow.md) , os visuais não serão atualizados.</span><span class="sxs-lookup"><span data-stu-id="de896-358">However, until the object receives a [**DDWM_UPDATEWINDOW**](ddwm-updatewindow.md) message, the visuals are not updated.</span></span> <span data-ttu-id="de896-359">Esse formato fornece o **HWND** da janela de arrastar destinatário para o remetente da mensagem de **DDWM_UPDATEWINDOW** .</span><span class="sxs-lookup"><span data-stu-id="de896-359">This format provides the **HWND** of the recipient drag window to the sender of the **DDWM_UPDATEWINDOW** message.</span></span>

<span data-ttu-id="de896-360">Os dados da área de transferência são do tipo [**TYMED_HGLOBAL**](/windows/win32/api/objidl/ne-objidl-tymed).</span><span class="sxs-lookup"><span data-stu-id="de896-360">The clipboard data is of type [**TYMED_HGLOBAL**](/windows/win32/api/objidl/ne-objidl-tymed).</span></span> <span data-ttu-id="de896-361">É uma representação **DWORD** de um **HWND**.</span><span class="sxs-lookup"><span data-stu-id="de896-361">It is a **DWORD** representation of an **HWND**.</span></span> <span data-ttu-id="de896-362">Os dados podem ser passados para a função **ULongToHandle** , definida em Basetsd. h, para fornecer um **HWND** de 64 bits para uso em janelas de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="de896-362">The data can be passed to the **ULongToHandle** function, defined in Basetsd.h, to provide a 64-bit **HWND** for use on 64-bit Windows.</span></span>

<span data-ttu-id="de896-363">Esse formato não requer a inclusão de shlobj. h.</span><span class="sxs-lookup"><span data-stu-id="de896-363">This format does not require the inclusion of Shlobj.h.</span></span>

 

 
