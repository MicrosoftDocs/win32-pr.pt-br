---
description: Antes do Windows Vista, você criou um item do painel de controle criando um arquivo. dll e nomeando-o com uma extensão. cpl.
ms.assetid: 258dae28-c054-4392-b0e9-99493f23c814
title: Usando CPLApplet
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b1e59b29dd7c082822ed63d425dd4967a542b5d1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104967882"
---
# <a name="using-cplapplet"></a><span data-ttu-id="f4617-103">Usando CPLApplet</span><span class="sxs-lookup"><span data-stu-id="f4617-103">Using CPLApplet</span></span>

<span data-ttu-id="f4617-104">Antes do Windows Vista, você criou um item do painel de controle criando um arquivo. dll e nomeando-o com uma extensão. cpl.</span><span class="sxs-lookup"><span data-stu-id="f4617-104">Prior to Windows Vista, you created a Control Panel item by creating a .dll file and naming it with a .cpl extension.</span></span> <span data-ttu-id="f4617-105">Esse arquivo exportou a função [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) .</span><span class="sxs-lookup"><span data-stu-id="f4617-105">This file exported the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function.</span></span> <span data-ttu-id="f4617-106">Esse esquema ainda tem suporte no Windows Vista e em versões posteriores e é discutido neste tópico.</span><span class="sxs-lookup"><span data-stu-id="f4617-106">This scheme is still supported in Windows Vista and later versions and is discussed in this topic.</span></span> <span data-ttu-id="f4617-107">No entanto, as diretrizes para novos itens do painel de controle recomendam uma abordagem mais simples com o item do painel de controle criado como um arquivo. exe que usa um layout de fluxo de tarefas.</span><span class="sxs-lookup"><span data-stu-id="f4617-107">However, the guidelines for new Control Panel items recommend a simpler approach with the Control Panel item built as a .exe file that uses a task flow layout.</span></span>

<span data-ttu-id="f4617-108">Quando o painel de controle carrega um arquivo. dll (ou. cpl), ele chama a função [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) para obter informações como o número de itens do painel de controle que o arquivo hospeda, bem como informações sobre cada item.</span><span class="sxs-lookup"><span data-stu-id="f4617-108">When Control Panel loads a .dll (or .cpl) file, it calls the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function to get information such as the number of Control Panel items the file hosts, as well as information about each item.</span></span> <span data-ttu-id="f4617-109">O painel de controle também chama a função quando a janela do item é inicializada, aberta ou fechada.</span><span class="sxs-lookup"><span data-stu-id="f4617-109">Control Panel also calls the function when the item's window is initialized, opened, or closed.</span></span>

<span data-ttu-id="f4617-110">Quando o Windows carrega o item do painel de controle pela primeira vez, ele recupera o endereço da função [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) e, subsequentemente, usa esse endereço para chamar a função e passá-la para as mensagens.</span><span class="sxs-lookup"><span data-stu-id="f4617-110">When Windows first loads the Control Panel item, it retrieves the address of the [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) function and subsequently uses that address to call the function and pass it messages.</span></span> <span data-ttu-id="f4617-111">Ele pode enviar as seguintes mensagens.</span><span class="sxs-lookup"><span data-stu-id="f4617-111">It might send the following messages.</span></span>



| <span data-ttu-id="f4617-112">Mensagem</span><span class="sxs-lookup"><span data-stu-id="f4617-112">Message</span></span>                                     | <span data-ttu-id="f4617-113">Descrição</span><span class="sxs-lookup"><span data-stu-id="f4617-113">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|---------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="f4617-114">**CPL \_ DBLCLK**</span><span class="sxs-lookup"><span data-stu-id="f4617-114">**CPL\_DBLCLK**</span></span>](cpl-dblclk.md)           | <span data-ttu-id="f4617-115">Enviado para notificar [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) que o usuário escolheu o ícone associado a um determinado item do painel de controle.</span><span class="sxs-lookup"><span data-stu-id="f4617-115">Sent to notify [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) that the user has chosen the icon associated with a given Control Panel item.</span></span> <span data-ttu-id="f4617-116">**CPlApplet** deve exibir a caixa de diálogo para o item especificado e executar qualquer tarefa especificada pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="f4617-116">**CPlApplet** should display the dialog box for the specified item and carry out any user-specified tasks.</span></span> <span data-ttu-id="f4617-117">O parâmetro **CPlApplet** *lParam1* é um inteiro que representa o índice de base zero do item do painel de controle.</span><span class="sxs-lookup"><span data-stu-id="f4617-117">The **CPlApplet** *lParam1* parameter is an integer that represents the zero-based index of the Control Panel item.</span></span> <span data-ttu-id="f4617-118">O parâmetro *lParam2* é o ponteiro **lpData** retornado na estrutura [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) ou [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) na mensagem [**CPL \_ inquire**](cpl-inquire.md) ou [**CPL \_ NEWINQUIRE**](cpl-newinquire.md) .</span><span class="sxs-lookup"><span data-stu-id="f4617-118">The *lParam2* parameter is the **lpData** pointer returned in the [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure in the [**CPL\_INQUIRE**](cpl-inquire.md) or [**CPL\_NEWINQUIRE**](cpl-newinquire.md) message.</span></span> <span data-ttu-id="f4617-119">O valor de retorno é ignorado.</span><span class="sxs-lookup"><span data-stu-id="f4617-119">The return value is ignored.</span></span>                                                                |
| [<span data-ttu-id="f4617-120">**CPL de \_ saída**</span><span class="sxs-lookup"><span data-stu-id="f4617-120">**CPL\_EXIT**</span></span>](cpl-exit.md)               | <span data-ttu-id="f4617-121">Enviado após a última mensagem de parada de CPL \_ e imediatamente antes de o Windows usar a função [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) para liberar a DLL que contém o item do painel de controle.</span><span class="sxs-lookup"><span data-stu-id="f4617-121">Sent after the last CPL\_STOP message and immediately before Windows uses the [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) function to free the DLL that contains the Control Panel item.</span></span> <span data-ttu-id="f4617-122">O [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) deve liberar qualquer memória restante e se preparar para fechar.</span><span class="sxs-lookup"><span data-stu-id="f4617-122">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) should free any remaining memory and prepare to close.</span></span> <span data-ttu-id="f4617-123">O valor de retorno é ignorado.</span><span class="sxs-lookup"><span data-stu-id="f4617-123">The return value is ignored.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="f4617-124">**CPL \_ GETcount**</span><span class="sxs-lookup"><span data-stu-id="f4617-124">**CPL\_GETCOUNT**</span></span>](cpl-getcount.md)       | <span data-ttu-id="f4617-125">Enviado após a mensagem de inicialização de CPL \_ para solicitar [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) para retornar um número que indica quantos subprogramas ele oferece suporte.</span><span class="sxs-lookup"><span data-stu-id="f4617-125">Sent after the CPL\_INIT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to return a number that indicates how many subprograms it supports.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [<span data-ttu-id="f4617-126">**CPL \_ init**</span><span class="sxs-lookup"><span data-stu-id="f4617-126">**CPL\_INIT**</span></span>](cpl-init.md)               | <span data-ttu-id="f4617-127">Enviado imediatamente depois que a DLL que contém o item do painel de controle é carregada.</span><span class="sxs-lookup"><span data-stu-id="f4617-127">Sent immediately after the DLL that contains the Control Panel item is loaded.</span></span> <span data-ttu-id="f4617-128">A mensagem solicita que o [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) execute procedimentos de inicialização, incluindo a alocação de memória.</span><span class="sxs-lookup"><span data-stu-id="f4617-128">The message prompts [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to perform initialization procedures, including memory allocation.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="f4617-129">**CPL de \_ consulta**</span><span class="sxs-lookup"><span data-stu-id="f4617-129">**CPL\_INQUIRE**</span></span>](cpl-inquire.md)         | <span data-ttu-id="f4617-130">Enviado após a \_ mensagem de sqlcount do CPL para solicitar [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) para fornecer informações sobre um subprograma especificado.</span><span class="sxs-lookup"><span data-stu-id="f4617-130">Sent after the CPL\_GETCOUNT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to provide information about a specified subprogram.</span></span> <span data-ttu-id="f4617-131">O valor de *lParam1* é um inteiro que representa o índice de base zero do subprograma sobre o qual as informações estão sendo solicitadas.</span><span class="sxs-lookup"><span data-stu-id="f4617-131">The *lParam1* value is an integer that represents the zero-based index of the subprogram about which information is being requested.</span></span> <span data-ttu-id="f4617-132">O parâmetro *lParam2* de **CPlApplet** aponta para uma estrutura [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) .</span><span class="sxs-lookup"><span data-stu-id="f4617-132">The *lParam2* parameter of **CPlApplet** points to a [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) structure.</span></span> <span data-ttu-id="f4617-133">O valor de retorno é ignorado.</span><span class="sxs-lookup"><span data-stu-id="f4617-133">The return value is ignored.</span></span>                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="f4617-134">**CPL \_ NEWINQUIRE**</span><span class="sxs-lookup"><span data-stu-id="f4617-134">**CPL\_NEWINQUIRE**</span></span>](cpl-newinquire.md)   | <span data-ttu-id="f4617-135">Enviado após a \_ mensagem de sqlcount do CPL para solicitar [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) para fornecer informações sobre um item do painel de controle especificado.</span><span class="sxs-lookup"><span data-stu-id="f4617-135">Sent after the CPL\_GETCOUNT message to prompt [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) to provide information about a specified Control Panel item.</span></span> <span data-ttu-id="f4617-136">O valor de *lParam1* é um inteiro que representa o índice de base zero do subprograma sobre o qual as informações estão sendo solicitadas.</span><span class="sxs-lookup"><span data-stu-id="f4617-136">The *lParam1* value is an integer that represents the zero-based index of the subprogram about which information is being requested.</span></span> <span data-ttu-id="f4617-137">O parâmetro *lParam2* é um ponteiro para uma estrutura [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) .</span><span class="sxs-lookup"><span data-stu-id="f4617-137">The *lParam2* parameter is a pointer to a [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure.</span></span> <span data-ttu-id="f4617-138">CPL \_ NEWINQUIRE normalmente deve ser ignorado.</span><span class="sxs-lookup"><span data-stu-id="f4617-138">CPL\_NEWINQUIRE normally should be ignored.</span></span> <span data-ttu-id="f4617-139">Seu aplicativo deve processar somente a \_ consulta CPL no windows 95, no Microsoft Windows NT 4,0 e em sistemas posteriores, pois o desempenho do painel de controle sofre quando o CPL \_ NEWINQUIRE é usado.</span><span class="sxs-lookup"><span data-stu-id="f4617-139">Your application should process only CPL\_INQUIRE on Windows 95, Microsoft Windows NT 4.0, and later systems since Control Panel performance suffers when CPL\_NEWINQUIRE is used.</span></span> <span data-ttu-id="f4617-140">Isso ocorre porque as cadeias de caracteres e os ícones retornados não podem ser armazenados em cache.</span><span class="sxs-lookup"><span data-stu-id="f4617-140">This is because the returned strings and icons cannot be cached.</span></span> <span data-ttu-id="f4617-141">O valor de retorno é ignorado.</span><span class="sxs-lookup"><span data-stu-id="f4617-141">The return value is ignored.</span></span> |
| [<span data-ttu-id="f4617-142">**CPL de \_ seleção**</span><span class="sxs-lookup"><span data-stu-id="f4617-142">**CPL\_SELECT**</span></span>](cpl-select.md)           | <span data-ttu-id="f4617-143">Obsoleto.</span><span class="sxs-lookup"><span data-stu-id="f4617-143">Obsolete.</span></span> <span data-ttu-id="f4617-144">As versões atuais do Windows não enviam essa mensagem.</span><span class="sxs-lookup"><span data-stu-id="f4617-144">Current versions of Windows do not send this message.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [<span data-ttu-id="f4617-145">**CPL \_ STARTWPARMS**</span><span class="sxs-lookup"><span data-stu-id="f4617-145">**CPL\_STARTWPARMS**</span></span>](cpl-startwparms.md) | <span data-ttu-id="f4617-146">Enviado para notificar [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) que o usuário escolheu o ícone associado a uma determinada caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="f4617-146">Sent to notify [**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) that the user has chosen the icon associated with a given dialog box.</span></span> <span data-ttu-id="f4617-147">**CPlApplet** deve exibir a caixa de diálogo correspondente e executar qualquer tarefa especificada pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="f4617-147">**CPlApplet** should display the corresponding dialog box and carry out any user-specified tasks.</span></span> <span data-ttu-id="f4617-148">Essa mensagem é semelhante a CPL \_ DBLCLK, mas pode haver algumas informações adicionais.</span><span class="sxs-lookup"><span data-stu-id="f4617-148">This message is similar to CPL\_DBLCLK, but there might be some additional information.</span></span> <span data-ttu-id="f4617-149">O parâmetro *lParam1* é o número de item do painel de controle e *LParam2* é um **LPCTSTR** para qualquer direção extra que possa ser necessária.</span><span class="sxs-lookup"><span data-stu-id="f4617-149">The *lParam1* parameter is the Control Panel item number and *lParam2* is an **LPCTSTR** to any extra directions that might be necessary.</span></span> <span data-ttu-id="f4617-150">Retornar **true** se esta mensagem for tratada; caso contrário, **false**.</span><span class="sxs-lookup"><span data-stu-id="f4617-150">Return **TRUE** if this message is handled; otherwise, **FALSE**.</span></span> <span data-ttu-id="f4617-151">Esta mensagem é válida para a [versão 5, 0](versions.md) e posterior do Shell32.dll.</span><span class="sxs-lookup"><span data-stu-id="f4617-151">This message is valid for [version 5.00](versions.md) and later of Shell32.dll.</span></span>                                                                                         |
| [<span data-ttu-id="f4617-152">**CPL de \_ parada**</span><span class="sxs-lookup"><span data-stu-id="f4617-152">**CPL\_STOP**</span></span>](cpl-stop.md)               | <span data-ttu-id="f4617-153">Enviado uma vez para cada item do painel de controle no arquivo. cpl antes que o Windows descarregue a extensão do painel de controle.</span><span class="sxs-lookup"><span data-stu-id="f4617-153">Sent once for each Control Panel item in the .cpl file before Windows unloads the Control Panel extension.</span></span> <span data-ttu-id="f4617-154">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) deve liberar qualquer memória associada ao número de item fornecido em *lParam1*.</span><span class="sxs-lookup"><span data-stu-id="f4617-154">[**CPlApplet**](/windows/win32/api/cpl/nc-cpl-applet_proc) should free any memory associated with the item number provided in *lParam1*.</span></span> <span data-ttu-id="f4617-155">O parâmetro *lParam2* é um ponteiro **lpData** retornado na [**estrutura CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) ou [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) na mensagem [**CPL \_ inquire**](cpl-inquire.md) ou [**CPL \_ NEWINQUIRE**](cpl-newinquire.md) .</span><span class="sxs-lookup"><span data-stu-id="f4617-155">The *lParam2* parameter is **lpData** pointer returned in the [**CPLINFO**](/windows/win32/api/cpl/ns-cpl-cplinfo) or [**NEWCPLINFO**](/windows/win32/api/cpl/ns-cpl-newcplinfoa) structure in the [**CPL\_INQUIRE**](cpl-inquire.md) or [**CPL\_NEWINQUIRE**](cpl-newinquire.md) message.</span></span> <span data-ttu-id="f4617-156">O valor de retorno é ignorado.</span><span class="sxs-lookup"><span data-stu-id="f4617-156">The return value is ignored.</span></span>                                                                                                                                                                                                       |



 

## <a name="related-topics"></a><span data-ttu-id="f4617-157">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="f4617-157">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f4617-158">Itens do painel de controle</span><span class="sxs-lookup"><span data-stu-id="f4617-158">Control Panel Items</span></span>](control-panel-applications.md)
</dt> <dt>

[<span data-ttu-id="f4617-159">Diretrizes da Experiência do Usuário</span><span class="sxs-lookup"><span data-stu-id="f4617-159">User Experience Guidelines</span></span>](user-experience-guidelines.md)
</dt> <dt>

[<span data-ttu-id="f4617-160">Registrando itens do painel de controle</span><span class="sxs-lookup"><span data-stu-id="f4617-160">Registering Control Panel Items</span></span>](registering-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="f4617-161">Processamento de mensagens do painel de controle</span><span class="sxs-lookup"><span data-stu-id="f4617-161">Control Panel Message Processing</span></span>](message-processing.md)
</dt> <dt>

[<span data-ttu-id="f4617-162">Executando itens do painel de controle</span><span class="sxs-lookup"><span data-stu-id="f4617-162">Executing Control Panel Items</span></span>](executing-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="f4617-163">Estendendo itens do painel de controle do sistema</span><span class="sxs-lookup"><span data-stu-id="f4617-163">Extending System Control Panel Items</span></span>](extending-system-control-panel-items.md)
</dt> <dt>

[<span data-ttu-id="f4617-164">Atribuindo categorias do painel de controle</span><span class="sxs-lookup"><span data-stu-id="f4617-164">Assigning Control Panel Categories</span></span>](assigning-control-panel-categories.md)
</dt> <dt>

[<span data-ttu-id="f4617-165">Criando links de tarefas pesquisáveis para um item do painel de controle</span><span class="sxs-lookup"><span data-stu-id="f4617-165">Creating Searchable Task Links for a Control Panel Item</span></span>](creating-searchable-task-links.md)
</dt> <dt>

[<span data-ttu-id="f4617-166">Acessando o painel de controle no modo de segurança no Windows Vista</span><span class="sxs-lookup"><span data-stu-id="f4617-166">Accessing the Control Panel in Safe Mode under Windows Vista</span></span>](accessing-the-cp-in-safe-mode-under-vista.md)
</dt> </dl>

 

 
