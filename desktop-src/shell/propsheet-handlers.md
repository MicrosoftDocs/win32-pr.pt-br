---
description: Quando um usuário clica com o botão direito do mouse em um objeto do Shell, o menu de atalho que é exibido normalmente inclui um item de propriedades.
title: Manipuladores de folha de propriedades
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 72233ab5-212d-498c-8df1-1a96c8eda892
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 40ccb8d1cee0fffb993aef417b979816597cf707
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103828905"
---
# <a name="property-sheet-handlers"></a><span data-ttu-id="e0b69-103">Manipuladores de folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="e0b69-103">Property Sheet Handlers</span></span>

<span data-ttu-id="e0b69-104">Quando um usuário clica com o botão direito do mouse em um objeto do Shell, o menu de atalho que é exibido normalmente inclui um item de **Propriedades** .</span><span class="sxs-lookup"><span data-stu-id="e0b69-104">When a user right-clicks a Shell object, the shortcut menu that is displayed normally includes a **Properties** item.</span></span> <span data-ttu-id="e0b69-105">A seleção desse item inicia uma folha de propriedades que permite ao usuário exibir e, em alguns casos, modificar as propriedades do objeto.</span><span class="sxs-lookup"><span data-stu-id="e0b69-105">Selecting that item launches a property sheet that allows the user to view, and in some cases modify, the object's properties.</span></span> <span data-ttu-id="e0b69-106">Você pode personalizar essa folha de propriedades implementando e registrando um *manipulador de folha de propriedades*.</span><span class="sxs-lookup"><span data-stu-id="e0b69-106">You can customize this property sheet by implementing and registering a *property sheet handler*.</span></span>

<span data-ttu-id="e0b69-107">Os procedimentos gerais para implementar e registrar um manipulador de extensão de shell são discutidos na [criação de manipuladores de extensão de shell](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="e0b69-107">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](handlers.md).</span></span> <span data-ttu-id="e0b69-108">Este documento se concentra nesses aspectos da implementação que são específicos de manipuladores de folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="e0b69-108">This document focuses on those aspects of implementation that are specific to property sheet handlers.</span></span>

-   [<span data-ttu-id="e0b69-109">Como funcionam os manipuladores de folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="e0b69-109">How Property Sheet Handlers Work</span></span>](#how-property-sheet-handlers-work)
-   [<span data-ttu-id="e0b69-110">Registrando e implementando um manipulador de folha de propriedades para uma unidade montada</span><span class="sxs-lookup"><span data-stu-id="e0b69-110">Registering and Implementing a Property Sheet Handler for a Mounted Drive</span></span>](#registering-and-implementing-a-property-sheet-handler-for-a-mounted-drive)
-   [<span data-ttu-id="e0b69-111">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="e0b69-111">Related topics</span></span>](#related-topics)

## <a name="how-property-sheet-handlers-work"></a><span data-ttu-id="e0b69-112">Como funcionam os manipuladores de folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="e0b69-112">How Property Sheet Handlers Work</span></span>

<span data-ttu-id="e0b69-113">A ilustração a seguir mostra a folha de propriedades Propriedades de um arquivo de texto do Windows XP.</span><span class="sxs-lookup"><span data-stu-id="e0b69-113">The following illustration shows the Properties property sheet for a Windows XP text file.</span></span>

![folha de propriedades](images/propsheethandler1.jpg)

<span data-ttu-id="e0b69-115">Esta ilustração mostra a folha de propriedades de propriedades padrão que é exibida para qualquer arquivo.</span><span class="sxs-lookup"><span data-stu-id="e0b69-115">This illustration shows the default Properties property sheet that is displayed for any file.</span></span> <span data-ttu-id="e0b69-116">Para muitas dessas folhas de propriedades, você pode adicionar uma ou mais páginas à folha de propriedades implementando e registrando um manipulador de folhas de propriedades.</span><span class="sxs-lookup"><span data-stu-id="e0b69-116">For many such property sheets, you can add one or more pages to the property sheet by implementing and registering a property sheet handler.</span></span>

<span data-ttu-id="e0b69-117">Manipuladores de folha de propriedades geralmente são registrados para um [tipo de arquivo](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="e0b69-117">Property sheet handlers are most commonly registered for a [file type](fa-file-types.md).</span></span> <span data-ttu-id="e0b69-118">Cada manipulador pode adicionar uma página personalizada à folha de propriedades de propriedades para a classe.</span><span class="sxs-lookup"><span data-stu-id="e0b69-118">Each handler can add one custom page to the Properties property sheet for the class.</span></span> <span data-ttu-id="e0b69-119">Essas páginas normalmente dão aos usuários acesso a propriedades que são específicas para o tipo de arquivo específico.</span><span class="sxs-lookup"><span data-stu-id="e0b69-119">These pages typically give users access to properties that are specific to the particular file type.</span></span> <span data-ttu-id="e0b69-120">Um tipo de arquivo que consiste em documentos de texto pode, por exemplo, exibir uma página que liste o título e o autor e um resumo do documento.</span><span class="sxs-lookup"><span data-stu-id="e0b69-120">A file type consisting of text documents could, for instance, display a page that listed the title and author, and an abstract of the document.</span></span> <span data-ttu-id="e0b69-121">Um caso especial desse tipo de manipulador de folhas de propriedades é usado para adicionar uma página à folha de propriedades de propriedades de uma unidade montada.</span><span class="sxs-lookup"><span data-stu-id="e0b69-121">A special case of this type of property sheet handler is used to add a page to the Properties property sheet for a mounted drive.</span></span>

<span data-ttu-id="e0b69-122">O outro uso para manipuladores de folha de propriedades é substituir páginas nas folhas de propriedades exibidas por aplicativos do painel de controle.</span><span class="sxs-lookup"><span data-stu-id="e0b69-122">The other use for property sheet handlers is to replace pages in the property sheets displayed by Control Panel applications.</span></span> <span data-ttu-id="e0b69-123">Um fabricante de mouse, por exemplo, pode usar um manipulador de folha de propriedades para substituir a página **botões** da folha de propriedades **Propriedades do mouse** do painel de controle por uma página que é personalizada para as características do seu mouse.</span><span class="sxs-lookup"><span data-stu-id="e0b69-123">A mouse manufacturer, for instance, can use a property sheet handler to replace the **Buttons** page on the Control Panel's **Mouse Properties** property sheet with a page that is customized for the characteristics of its mouse.</span></span>

<span data-ttu-id="e0b69-124">Como todos os manipuladores de extensão do Shell, os manipuladores de folha de propriedades são objetos COM (Component Object Model) em processo implementados como DLLs.</span><span class="sxs-lookup"><span data-stu-id="e0b69-124">Like all Shell extension handlers, property sheet handlers are in-process Component Object Model (COM) objects implemented as DLLs.</span></span> <span data-ttu-id="e0b69-125">Eles devem exportar duas interfaces além de [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) e [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext).</span><span class="sxs-lookup"><span data-stu-id="e0b69-125">They must export two interfaces in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) and [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext).</span></span>

<span data-ttu-id="e0b69-126">A interface [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) é usada pelo shell para inicializar o manipulador.</span><span class="sxs-lookup"><span data-stu-id="e0b69-126">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface is used by the Shell to initialize the handler.</span></span> <span data-ttu-id="e0b69-127">Quando o Shell chama [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), ele passa um objeto de dados com o nome do objeto e o ponteiro para uma PIDL (lista de identificadores de item) da pasta que contém o arquivo.</span><span class="sxs-lookup"><span data-stu-id="e0b69-127">When the Shell calls [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), it passes in a data object with the object's name, and the pointer to an item identifier list (PIDL) of the folder that contains the file.</span></span> <span data-ttu-id="e0b69-128">O parâmetro *hRegKey* não é usado com manipuladores de folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="e0b69-128">The *hRegKey* parameter is not used with property sheet handlers.</span></span> <span data-ttu-id="e0b69-129">O método **IShellExtInit:: Initialize** deve extrair o nome do arquivo do objeto de dados e armazenar o nome e o PIDL da pasta para uso posterior.</span><span class="sxs-lookup"><span data-stu-id="e0b69-129">The **IShellExtInit::Initialize** method must extract the file name from the data object, and store the name and the folder's PIDL for later use.</span></span> <span data-ttu-id="e0b69-130">Para obter mais detalhes, consulte a seção *implementando IShellExtInit* de [criando manipuladores de extensão de shell](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="e0b69-130">For further details, see the *Implementing IShellExtInit* section of [Creating Shell Extension Handlers](handlers.md).</span></span>

<span data-ttu-id="e0b69-131">O restante da operação ocorre por meio da interface [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) do manipulador.</span><span class="sxs-lookup"><span data-stu-id="e0b69-131">The remainder of the operation takes place through the handler's [**IShellPropSheetExt**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) interface.</span></span> <span data-ttu-id="e0b69-132">Se a folha de propriedades estiver associada a um tipo de arquivo, o Shell chamará [**IShellPropSheetExt:: AddPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) para permitir que o manipulador adicione uma página à folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="e0b69-132">If the property sheet is associated with a file type, the Shell calls [**IShellPropSheetExt::AddPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) to allow the handler to add a page to the property sheet.</span></span> <span data-ttu-id="e0b69-133">Se a folha de propriedades estiver associada a um aplicativo do painel de controle, o Shell chamará [**IShellPropSheetExt:: ReplacePage**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) para permitir que o manipulador substitua uma página.</span><span class="sxs-lookup"><span data-stu-id="e0b69-133">If the property sheet is associated with a Control Panel application, the Shell calls [**IShellPropSheetExt::ReplacePage**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) to allow the handler to replace a page.</span></span>

## <a name="registering-and-implementing-a-property-sheet-handler-for-a-mounted-drive"></a><span data-ttu-id="e0b69-134">Registrando e implementando um manipulador de folha de propriedades para uma unidade montada</span><span class="sxs-lookup"><span data-stu-id="e0b69-134">Registering and Implementing a Property Sheet Handler for a Mounted Drive</span></span>

<span data-ttu-id="e0b69-135">Cada unidade montada tem uma folha de propriedades que pode ser exibida pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="e0b69-135">Each mounted drive has a Properties sheet that can be displayed by the user.</span></span> <span data-ttu-id="e0b69-136">A ilustração a seguir mostra uma folha de propriedades de propriedades para uma unidade de CD-ROM.</span><span class="sxs-lookup"><span data-stu-id="e0b69-136">The following illustration shows a Properties property sheet for a CD-ROM drive.</span></span>

![folha de propriedades Propriedades de CD-ROM](images/propsheethandler2.jpg)

<span data-ttu-id="e0b69-138">Há uma ampla variedade de dispositivos que podem ser montados como unidades.</span><span class="sxs-lookup"><span data-stu-id="e0b69-138">There are a wide variety of devices that can be mounted as drives.</span></span> <span data-ttu-id="e0b69-139">Como a folha de propriedades padrão, projetada para unidades de disco, pode não ser suficiente para alguns dispositivos, um manipulador de folhas de propriedades pode ser implementado para adicionar uma página específica ao dispositivo montado.</span><span class="sxs-lookup"><span data-stu-id="e0b69-139">Because the default property sheet, designed for disk drives, might not be sufficient for some devices, a property sheet handler can be implemented to add a page that is specific to the mounted device.</span></span> <span data-ttu-id="e0b69-140">A implementação básica desse tipo de manipulador de folhas de propriedades é idêntica à discutida em [como registrar e implementar um manipulador de folha de propriedades para um tipo de arquivo](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md), com duas exceções.</span><span class="sxs-lookup"><span data-stu-id="e0b69-140">The basic implementation of this type of property sheet handler is identical to that discussed in [How to Register and Implement a Property Sheet Handler for a File Type](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md), with two exceptions.</span></span>

-   <span data-ttu-id="e0b69-141">O objeto de dados passado para o método [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) do manipulador pode conter o caminho da unidade no formato [CFSTR \_ MOUNTEDVOLUME](clipboard.md) em vez do formato [CF \_ HDROP](clipboard.md) .</span><span class="sxs-lookup"><span data-stu-id="e0b69-141">The data object passed to the handler's [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method may contain the drive path in the [CFSTR\_MOUNTEDVOLUME](clipboard.md) format instead of the [CF\_HDROP](clipboard.md) format.</span></span> <span data-ttu-id="e0b69-142">O \_ formato CF HDROP é usado quando o dispositivo é montado em uma letra de unidade.</span><span class="sxs-lookup"><span data-stu-id="e0b69-142">The CF\_HDROP format is used when the device is mounted to a drive letter.</span></span> <span data-ttu-id="e0b69-143">O \_ formato CFSTR MOUNTEDVOLUME é usado com sistemas de arquivos NTFS quando o dispositivo remoto é montado em uma pasta em vez de uma letra de unidade.</span><span class="sxs-lookup"><span data-stu-id="e0b69-143">The CFSTR\_MOUNTEDVOLUME format is used with NTFS file systems when the remote device is mounted to a folder rather than to a drive letter.</span></span>
-   <span data-ttu-id="e0b69-144">O GUID do manipulador é registrado na chave do **HKEY \_ classes \_ raiz** \\  \\ **shellex** \\ **PropertySheetHandlers** Key.</span><span class="sxs-lookup"><span data-stu-id="e0b69-144">The handler's GUID is registered under the **HKEY\_CLASSES\_ROOT**\\**Drive**\\**shellex**\\**PropertySheetHandlers** key.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e0b69-145">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="e0b69-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e0b69-146">Como registrar e implementar um manipulador de folha de propriedades para um tipo de arquivo</span><span class="sxs-lookup"><span data-stu-id="e0b69-146">How to Register and Implement a Property Sheet Handler for a File Type</span></span>](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md)
</dt> <dt>

[<span data-ttu-id="e0b69-147">Como registrar e implementar um manipulador de folha de propriedades para um aplicativo do painel de controle</span><span class="sxs-lookup"><span data-stu-id="e0b69-147">How to Register and Implement a Property Sheet Handler for a Control Panel Application</span></span>](how-to-register-and-implement-a-property-sheet-handler-for-a-control-panel-application.md)
</dt> </dl>

 

 
