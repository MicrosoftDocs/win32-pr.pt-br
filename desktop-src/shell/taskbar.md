---
description: A interface do Windows inclui uma barra de ferramentas de área de trabalho de aplicativo especial chamada barra de tarefas. Você pode usar a barra de tarefas do para essa tarefa, como alternar entre janelas abertas e iniciar novos aplicativos.
ms.assetid: 14d520e7-7c15-441d-9662-24b972d208ac
title: A barra de tarefas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cce37991c6265f02ab92ece62dbae341031d272a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104989055"
---
# <a name="the-taskbar"></a><span data-ttu-id="c5db5-104">A barra de tarefas</span><span class="sxs-lookup"><span data-stu-id="c5db5-104">The Taskbar</span></span>

<span data-ttu-id="c5db5-105">A interface do Windows inclui uma [barra de ferramentas de área de trabalho de aplicativo](application-desktop-toolbars.md) especial chamada barra de *tarefas*.</span><span class="sxs-lookup"><span data-stu-id="c5db5-105">The Windows interface includes a special [application desktop toolbar](application-desktop-toolbars.md) called the *taskbar*.</span></span> <span data-ttu-id="c5db5-106">Você pode usar a barra de tarefas do para essa tarefa, como alternar entre janelas abertas e iniciar novos aplicativos.</span><span class="sxs-lookup"><span data-stu-id="c5db5-106">You can use the taskbar for such tasks as switching between open windows and starting new applications.</span></span>

> [!Note]  
> <span data-ttu-id="c5db5-107">Para obter informações sobre as alterações feitas na barra de tarefas a partir do Windows 7, consulte [extensões da barra de tarefas](taskbar-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="c5db5-107">For information on changes made to the taskbar as of Windows 7, see [Taskbar Extensions](taskbar-extensions.md).</span></span>

 

<span data-ttu-id="c5db5-108">Este tópico inclui as seções a seguir.</span><span class="sxs-lookup"><span data-stu-id="c5db5-108">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="c5db5-109">Sobre a barra de tarefas</span><span class="sxs-lookup"><span data-stu-id="c5db5-109">About the Taskbar</span></span>](#about-the-taskbar)
    -   [<span data-ttu-id="c5db5-110">Opções de exibição da barra de tarefas</span><span class="sxs-lookup"><span data-stu-id="c5db5-110">Taskbar Display Options</span></span>](#taskbar-display-options)
    -   [<span data-ttu-id="c5db5-111">Adicionando atalhos ao menu iniciar</span><span class="sxs-lookup"><span data-stu-id="c5db5-111">Adding Shortcuts to the Start Menu</span></span>](#adding-shortcuts-to-the-start-menu)
    -   [<span data-ttu-id="c5db5-112">Gerenciando botões da barra de tarefas</span><span class="sxs-lookup"><span data-stu-id="c5db5-112">Managing Taskbar Buttons</span></span>](#managing-taskbar-buttons)
    -   [<span data-ttu-id="c5db5-113">Adicionando, modificando e excluindo ícones na área de notificação</span><span class="sxs-lookup"><span data-stu-id="c5db5-113">Adding, Modifying, and Deleting Icons in the Notification Area</span></span>](#adding-modifying-and-deleting-icons-in-the-notification-area)
    -   [<span data-ttu-id="c5db5-114">Notificação de criação da barra de tarefas</span><span class="sxs-lookup"><span data-stu-id="c5db5-114">Taskbar Creation Notification</span></span>](#taskbar-creation-notification)
-   [<span data-ttu-id="c5db5-115">Usando a barra de tarefas</span><span class="sxs-lookup"><span data-stu-id="c5db5-115">Using the Taskbar</span></span>](#using-the-taskbar)
    -   [<span data-ttu-id="c5db5-116">Adicionando e excluindo ícones da barra de tarefas na área de notificação</span><span class="sxs-lookup"><span data-stu-id="c5db5-116">Adding and Deleting Taskbar Icons in the Notification Area</span></span>](#adding-and-deleting-taskbar-icons-in-the-notification-area)
    -   [<span data-ttu-id="c5db5-117">Recebendo eventos do mouse</span><span class="sxs-lookup"><span data-stu-id="c5db5-117">Receiving Mouse Events</span></span>](#receiving-mouse-events)

## <a name="about-the-taskbar"></a><span data-ttu-id="c5db5-118">Sobre a barra de tarefas</span><span class="sxs-lookup"><span data-stu-id="c5db5-118">About the Taskbar</span></span>

<span data-ttu-id="c5db5-119">A barra de tarefas inclui o seguinte:</span><span class="sxs-lookup"><span data-stu-id="c5db5-119">The taskbar includes the following:</span></span>

-   <span data-ttu-id="c5db5-120">Menu **Iniciar**</span><span class="sxs-lookup"><span data-stu-id="c5db5-120">**Start** menu</span></span>
-   <span data-ttu-id="c5db5-121">Barra de início rápido (somente Windows Vista e anterior)</span><span class="sxs-lookup"><span data-stu-id="c5db5-121">Quick Launch bar (Windows Vista and earlier only)</span></span>
-   <span data-ttu-id="c5db5-122">Botões da barra de tarefas</span><span class="sxs-lookup"><span data-stu-id="c5db5-122">Taskbar buttons</span></span>
-   <span data-ttu-id="c5db5-123">Barras de ferramentas (opcional)</span><span class="sxs-lookup"><span data-stu-id="c5db5-123">Toolbars (optional)</span></span>
-   <span data-ttu-id="c5db5-124">Área de notificação</span><span class="sxs-lookup"><span data-stu-id="c5db5-124">Notification area</span></span>

<span data-ttu-id="c5db5-125">O menu **Iniciar** contém comandos que podem acessar programas, documentos e configurações.</span><span class="sxs-lookup"><span data-stu-id="c5db5-125">The **Start** menu contains commands that can access programs, documents, and settings.</span></span> <span data-ttu-id="c5db5-126">Esses comandos incluem **todos os programas**, **documentos**, **painel de controle**, **jogos**, **ajuda e suporte**, **desligamento** e **pesquisa de programas e arquivos**.</span><span class="sxs-lookup"><span data-stu-id="c5db5-126">These commands include **All Programs**, **Documents**, **Control Panel**, **Games**, **Help and Support**, **Shut down**, and **Search programs and files**.</span></span>

<span data-ttu-id="c5db5-127">O **início** em versões anteriores do Windows continha itens como **Localizar** e **executar**, a funcionalidade do que foi incluída em **Pesquisar programas e arquivos** no Windows Vista e versões posteriores.</span><span class="sxs-lookup"><span data-stu-id="c5db5-127">The **Start** in earlier versions of Windows contained items such as **Find** and **Run**, the functionality of which was included in **Search programs and files** in Windows Vista and later.</span></span>

<span data-ttu-id="c5db5-128">A barra de início rápido, disponível em versões do Windows anteriores ao Windows 7, contém atalhos para aplicativos.</span><span class="sxs-lookup"><span data-stu-id="c5db5-128">The Quick Launch bar, available in versions of Windows earlier than Windows 7, contains shortcuts to applications.</span></span> <span data-ttu-id="c5db5-129">O Windows fornece entradas padrão, como o Windows Internet Explorer, e o usuário pode adicionar outros atalhos que escolherem.</span><span class="sxs-lookup"><span data-stu-id="c5db5-129">Windows provides default entries, such as Windows Internet Explorer, and the user can add any further shortcuts that they choose.</span></span> <span data-ttu-id="c5db5-130">Os ícones nessa área respondem a um único clique.</span><span class="sxs-lookup"><span data-stu-id="c5db5-130">Icons in this area respond to a single click.</span></span> <span data-ttu-id="c5db5-131">No Windows 7 e posterior, essa funcionalidade está incluída nos botões da barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-131">In Windows 7 and later, this functionality is included in the taskbar buttons.</span></span>

<span data-ttu-id="c5db5-132">O Shell coloca um botão na barra de tarefas sempre que um aplicativo cria uma janela sem proprietário, ou seja, uma janela que não tem um pai e que tem os bits de estilo estendido apropriados (consulte [Gerenciando botões da barra de tarefas](#managing-taskbar-buttons), abaixo).</span><span class="sxs-lookup"><span data-stu-id="c5db5-132">The Shell places a button on the taskbar whenever an application creates an unowned window—that is, a window that does not have a parent and that has the appropriate extended style bits (see [Managing Taskbar Buttons](#managing-taskbar-buttons), below).</span></span> <span data-ttu-id="c5db5-133">Para alternar para uma janela, o usuário clica em seu botão de janela.</span><span class="sxs-lookup"><span data-stu-id="c5db5-133">To switch to a window, the user clicks its window button.</span></span> <span data-ttu-id="c5db5-134">Essa funcionalidade foi bastante expandida a partir do Windows 7.</span><span class="sxs-lookup"><span data-stu-id="c5db5-134">This functionality has been greatly expanded as of Windows 7.</span></span> <span data-ttu-id="c5db5-135">Para obter mais informações, consulte [extensões da barra de tarefas](taskbar-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="c5db5-135">For more information, see [Taskbar Extensions](taskbar-extensions.md).</span></span>

<span data-ttu-id="c5db5-136">Os aplicativos podem colocar ícones na área de notificação para indicar o status de uma operação ou para notificar o usuário sobre um evento.</span><span class="sxs-lookup"><span data-stu-id="c5db5-136">Applications can put icons in the notification area to indicate the status of an operation or to notify the user about an event.</span></span> <span data-ttu-id="c5db5-137">Por exemplo, um aplicativo pode colocar um ícone de impressora na área de notificação para mostrar que um trabalho de impressão está em caminho.</span><span class="sxs-lookup"><span data-stu-id="c5db5-137">For example, an application might put a printer icon in the notification area to show that a print job is under way.</span></span> <span data-ttu-id="c5db5-138">No entanto, no Windows 7 e posterior, algumas das informações fornecidas anteriormente pela área de notificação devem ser fornecidas por meio do botão da barra de tarefas de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="c5db5-138">However, in Windows 7 and later, some of the information previously provided by the notification area should be provided through an application's taskbar button.</span></span> <span data-ttu-id="c5db5-139">A área de notificação está localizada na borda direita da barra de tarefas (se a barra de tarefas for horizontal) ou na parte inferior (se a barra de tarefas for vertical).</span><span class="sxs-lookup"><span data-stu-id="c5db5-139">The notification area is located at the right edge of the taskbar (if the taskbar is horizontal) or at the bottom (if the taskbar is vertical).</span></span> <span data-ttu-id="c5db5-140">Para obter mais informações, consulte [notificações e a área de notificação](notification-area.md).</span><span class="sxs-lookup"><span data-stu-id="c5db5-140">For more information, see [Notifications and the Notification Area](notification-area.md).</span></span>

<span data-ttu-id="c5db5-141">A área de notificação também exibirá a hora atual se essa opção estiver selecionada.</span><span class="sxs-lookup"><span data-stu-id="c5db5-141">The notification area also displays the current time if that option is selected.</span></span> <span data-ttu-id="c5db5-142">A opção é encontrada como:</span><span class="sxs-lookup"><span data-stu-id="c5db5-142">The option is found as:</span></span>

-   <span data-ttu-id="c5db5-143">**Windows 7 e posterior**: a lista suspensa **relógio** na página **Ativar ou desativar ícones do sistema** do aplicativo do painel de controle **ícones da área de notificação** (também acessível por meio das propriedades da área de notificação).</span><span class="sxs-lookup"><span data-stu-id="c5db5-143">**Windows 7 and later**: The **Clock** drop-down list in the **Turn system icons on or off** page of the **Notification Area Icons** Control Panel application (also accessible through the notification area properties).</span></span>
-   <span data-ttu-id="c5db5-144">**Windows Vista**: a caixa de seleção de **relógio** na página **área de notificação** da barra de tarefas e da janela Propriedades do **menu iniciar** .</span><span class="sxs-lookup"><span data-stu-id="c5db5-144">**Windows Vista**: The **Clock** check box in the **Notification Area** page of the **Taskbar and Start Menu** properties window.</span></span>
-   <span data-ttu-id="c5db5-145">**Windows XP**: a caixa de seleção **mostrar o relógio** na **barra de tarefas e** na janela Propriedades do menu iniciar.</span><span class="sxs-lookup"><span data-stu-id="c5db5-145">**Windows XP**: The **Show the clock** check box in the **Taskbar and Start Menu** properties window.</span></span>

<span data-ttu-id="c5db5-146">O usuário pode clicar com o botão direito do mouse na barra de tarefas para exibir o menu de atalho.</span><span class="sxs-lookup"><span data-stu-id="c5db5-146">The user can right-click the taskbar to display the shortcut menu.</span></span> <span data-ttu-id="c5db5-147">O menu de atalho inclui comandos para janelas em cascata, janelas de pilha, mostrar janelas lado a lado, mostrar a área de trabalho, iniciar o Gerenciador de tarefas e definir propriedades da barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-147">The shortcut menu includes commands to cascade windows, stack windows, show windows side-by-side, show the desktop, start Task Manager, and set taskbar properties.</span></span> <span data-ttu-id="c5db5-148">O menu de atalho também fornece a opção de adicionar ou remover um conjunto de barras de ferramentas da barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-148">The shortcut menu also provides the option to add or remove a set of toolbars from the taskbar.</span></span> <span data-ttu-id="c5db5-149">Você pode adicionar novas barras de ferramentas a esse menu registrando-as na \_ categoria DeskBand de CATID.</span><span class="sxs-lookup"><span data-stu-id="c5db5-149">You can add new toolbars to this menu by registering them under the CATID\_DeskBand category.</span></span> <span data-ttu-id="c5db5-150">Para obter mais informações, consulte [implementando objetos de banda](band-objects.md).</span><span class="sxs-lookup"><span data-stu-id="c5db5-150">For more information, see [Implementing Band Objects](band-objects.md).</span></span> <span data-ttu-id="c5db5-151">Observe que, a partir do Windows 7, a barra de tarefas e a área de notificação têm menus de atalho separados.</span><span class="sxs-lookup"><span data-stu-id="c5db5-151">Note that as of Windows 7, the taskbar and the notification area have separate shortcut menus.</span></span> <span data-ttu-id="c5db5-152">Esses menus de atalho compartilham algumas opções, como a disposição da janela e adicionam outras.</span><span class="sxs-lookup"><span data-stu-id="c5db5-152">These shortcut menus share some options, such as window arrangement, and add others.</span></span>

### <a name="taskbar-display-options"></a><span data-ttu-id="c5db5-153">Opções de exibição da barra de tarefas</span><span class="sxs-lookup"><span data-stu-id="c5db5-153">Taskbar Display Options</span></span>

<span data-ttu-id="c5db5-154">A barra de tarefas dá suporte a duas opções de exibição: Ocultar automaticamente e, no Windows Vista e versões anteriores, Always On superior (a barra de tarefas sempre está nesse modo no Windows 7 e posterior).</span><span class="sxs-lookup"><span data-stu-id="c5db5-154">The taskbar supports two display options: Auto-Hide and, in Windows Vista and earlier only, Always On Top (the taskbar is always in this mode in Windows 7 and later).</span></span> <span data-ttu-id="c5db5-155">Para definir essas opções, o usuário deve abrir o menu de atalho da barra de tarefas, clicar em **Propriedades** e marcar ou desmarcar a caixa de seleção **ocultar automaticamente a barra** de tarefas ou a caixa de seleção **manter a barra de tarefas no topo de outras janelas** .</span><span class="sxs-lookup"><span data-stu-id="c5db5-155">To set these options, the user must open the taskbar shortcut menu, click **Properties**, and select or clear the **Auto-hide the taskbar** check box or the **Keep the taskbar on top of other windows** check box.</span></span> <span data-ttu-id="c5db5-156">Para recuperar o estado dessas opções de exibição, use a [**mensagem \_ GetState do ABM**](abm-getstate.md) .</span><span class="sxs-lookup"><span data-stu-id="c5db5-156">To retrieve the state of these display options, use the [**ABM\_GETSTATE**](abm-getstate.md) message.</span></span> <span data-ttu-id="c5db5-157">Se você quiser ser notificado quando o estado dessas opções de exibição for alterado, processe a mensagem de notificação do [**ABN \_ STATECHANGE**](abn-statechange.md) em seu procedimento de janela.</span><span class="sxs-lookup"><span data-stu-id="c5db5-157">If you would like to be notified when the state of these display options changes, process the [**ABN\_STATECHANGE**](abn-statechange.md) notification message in your window procedure.</span></span> <span data-ttu-id="c5db5-158">Para alterar o estado dessas opções de exibição, use a [**mensagem \_ SetState do ABM**](abm-setstate.md) .</span><span class="sxs-lookup"><span data-stu-id="c5db5-158">To change the state of these display options, use the [**ABM\_SETSTATE**](abm-setstate.md) message.</span></span>

<span data-ttu-id="c5db5-159">A *área de trabalho* é a parte da tela não obscurecida pela barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-159">The *work area* is the portion of the screen not obscured by the taskbar.</span></span> <span data-ttu-id="c5db5-160">Para recuperar o tamanho da área de trabalho, chame a função [**SystemParametersInfo**](/windows/win32/api/winuser/nf-winuser-systemparametersinfoa) com o valor de **SPI \_ GETWORKAREA** definido.</span><span class="sxs-lookup"><span data-stu-id="c5db5-160">To retrieve the size of the work area, call the [**SystemParametersInfo**](/windows/win32/api/winuser/nf-winuser-systemparametersinfoa) function with the **SPI\_GETWORKAREA** value set.</span></span> <span data-ttu-id="c5db5-161">Para recuperar as coordenadas de retângulo que descrevem o local da barra de tarefas, use a mensagem [**ABM \_ GETTASKBARPOS**](abm-gettaskbarpos.md) .</span><span class="sxs-lookup"><span data-stu-id="c5db5-161">To retrieve the rectangle coordinates that describe the location of the taskbar, use the [**ABM\_GETTASKBARPOS**](abm-gettaskbarpos.md) message.</span></span>

<span data-ttu-id="c5db5-162">É possível cobrir a barra de tarefas definindo explicitamente o tamanho do retângulo da janela igual ao tamanho da tela com [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos).</span><span class="sxs-lookup"><span data-stu-id="c5db5-162">It is possible to cover the taskbar by explicitly setting the size of the window rectangle equal to the size of the screen with [**SetWindowPos**](/windows/win32/api/winuser/nf-winuser-setwindowpos).</span></span> <span data-ttu-id="c5db5-163">Para sistemas Windows 2000 ou posterior, a janela deve ter a opção [**WS \_ Caption**](../winmsg/window-styles.md) ou [**WS \_ THICKFRAME**](../winmsg/window-styles.md), ou a janela deve ser dimensionada para que a área do cliente cubra toda a tela.</span><span class="sxs-lookup"><span data-stu-id="c5db5-163">For Windows 2000 systems or later, the window must lack either [**WS\_CAPTION**](../winmsg/window-styles.md) or [**WS\_THICKFRAME**](../winmsg/window-styles.md), or else the window must be sized so that the client area covers the entire screen.</span></span> <span data-ttu-id="c5db5-164">Além desses sistemas, se a barra de tarefas for definida como Always On superior, ela permanecerá oculta somente quando o aplicativo for o aplicativo em primeiro plano.</span><span class="sxs-lookup"><span data-stu-id="c5db5-164">Also particular to those systems, if the taskbar is set to Always On Top, it will remain hidden only while the application is the foreground application.</span></span>

### <a name="adding-shortcuts-to-the-start-menu"></a><span data-ttu-id="c5db5-165">Adicionando atalhos ao menu iniciar</span><span class="sxs-lookup"><span data-stu-id="c5db5-165">Adding Shortcuts to the Start Menu</span></span>

<span data-ttu-id="c5db5-166">Para adicionar um item ao submenu **programas** no Microsoft Windows NT 4,0, Windows 2000 e posterior ou Windows 95 ou posterior, siga estas etapas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-166">To add an item to the **Programs** submenu on Microsoft Windows NT 4.0, Windows 2000 and later, or Windows 95 or later, follow these steps.</span></span>

1.  <span data-ttu-id="c5db5-167">Crie um [link do Shell](./links.md) usando a interface [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) .</span><span class="sxs-lookup"><span data-stu-id="c5db5-167">Create a [shell link](./links.md) by using the [**IShellLink**](/windows/desktop/api/Shobjidl_core/nn-shobjidl_core-ishelllinka) interface.</span></span>
2.  <span data-ttu-id="c5db5-168">Obtenha o PIDL da pasta Programs usando [**SHGetSpecialFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetspecialfolderlocation), passando [**\_ programas de CSIDL**](csidl.md).</span><span class="sxs-lookup"><span data-stu-id="c5db5-168">Obtain the PIDL of the Programs folder by using [**SHGetSpecialFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetspecialfolderlocation), passing [**CSIDL\_PROGRAMS**](csidl.md).</span></span>
3.  <span data-ttu-id="c5db5-169">Adicione o link do Shell à pasta programas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-169">Add the Shell link to the Programs folder.</span></span> <span data-ttu-id="c5db5-170">Você também pode criar uma pasta na pasta programas e adicionar o link a essa pasta.</span><span class="sxs-lookup"><span data-stu-id="c5db5-170">You can also create a folder in the Programs folder and add the link to that folder.</span></span>

### <a name="managing-taskbar-buttons"></a><span data-ttu-id="c5db5-171">Gerenciando botões da barra de tarefas</span><span class="sxs-lookup"><span data-stu-id="c5db5-171">Managing Taskbar Buttons</span></span>

<span data-ttu-id="c5db5-172">O Shell cria um botão na barra de tarefas sempre que um aplicativo cria uma janela que não é de propriedade.</span><span class="sxs-lookup"><span data-stu-id="c5db5-172">The Shell creates a button on the taskbar whenever an application creates a window that isn't owned.</span></span> <span data-ttu-id="c5db5-173">Para garantir que o botão de janela seja colocado na barra de tarefas, crie uma janela sem proprietário com o estilo estendido [**WS \_ ex \_ APPWINDOW**](../winmsg/extended-window-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="c5db5-173">To ensure that the window button is placed on the taskbar, create an unowned window with the [**WS\_EX\_APPWINDOW**](../winmsg/extended-window-styles.md) extended style.</span></span> <span data-ttu-id="c5db5-174">Para impedir que o botão de janela seja colocado na barra de tarefas, crie a janela sem proprietário com o estilo estendido [**WS \_ ex \_ TOOLWINDOW**](../winmsg/extended-window-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="c5db5-174">To prevent the window button from being placed on the taskbar, create the unowned window with the [**WS\_EX\_TOOLWINDOW**](../winmsg/extended-window-styles.md) extended style.</span></span> <span data-ttu-id="c5db5-175">Como alternativa, você pode criar uma janela oculta e tornar essa janela oculta o proprietário da janela visível.</span><span class="sxs-lookup"><span data-stu-id="c5db5-175">As an alternative, you can create a hidden window and make this hidden window the owner of your visible window.</span></span>

<span data-ttu-id="c5db5-176">O Shell removerá o botão de uma janela da barra de tarefas somente se o estilo da janela der suporte a botões visíveis da barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-176">The Shell will remove a window's button from the taskbar only if the window's style supports visible taskbar buttons.</span></span> <span data-ttu-id="c5db5-177">Se você quiser alterar dinamicamente o estilo de uma janela para uma que não dê suporte a botões da barra de tarefas visíveis, deverá ocultar a janela primeiro (chamando [**a janela de apresentação com o**](/windows/win32/api/winuser/nf-winuser-showwindow) **SW \_ Hide**), alterar o estilo da janela e mostrar a janela.</span><span class="sxs-lookup"><span data-stu-id="c5db5-177">If you want to dynamically change a window's style to one that does not support visible taskbar buttons, you must hide the window first (by calling [**ShowWindow**](/windows/win32/api/winuser/nf-winuser-showwindow) with **SW\_HIDE**), change the window style, and then show the window.</span></span>

<span data-ttu-id="c5db5-178">O botão janela normalmente contém o ícone do aplicativo e o título.</span><span class="sxs-lookup"><span data-stu-id="c5db5-178">The window button typically contains the application icon and title.</span></span> <span data-ttu-id="c5db5-179">No entanto, se o aplicativo não contiver um menu do sistema, o botão janela será criado sem o ícone.</span><span class="sxs-lookup"><span data-stu-id="c5db5-179">However, if the application does not contain a system menu, the window button is created without the icon.</span></span>

<span data-ttu-id="c5db5-180">Se você quiser que seu aplicativo obtenha a atenção do usuário quando a janela não estiver ativa, use a função [**FlashWindow**](/windows/win32/api/winuser/nf-winuser-flashwindow) para permitir que o usuário saiba que uma mensagem está aguardando.</span><span class="sxs-lookup"><span data-stu-id="c5db5-180">If you want your application to get the user's attention when the window is not active, use the [**FlashWindow**](/windows/win32/api/winuser/nf-winuser-flashwindow) function to let the user know that a message is waiting.</span></span> <span data-ttu-id="c5db5-181">Essa função pisca o botão de janela.</span><span class="sxs-lookup"><span data-stu-id="c5db5-181">This function flashes the window button.</span></span> <span data-ttu-id="c5db5-182">Depois que o usuário clicar no botão de janela para ativar a janela, seu aplicativo poderá exibir a mensagem.</span><span class="sxs-lookup"><span data-stu-id="c5db5-182">Once the user clicks the window button to activate the window, your application can display the message.</span></span>

### <a name="modifying-the-contents-of-the-taskbar"></a><span data-ttu-id="c5db5-183">Modificando o conteúdo da barra de tarefas</span><span class="sxs-lookup"><span data-stu-id="c5db5-183">Modifying the Contents of the Taskbar</span></span>

<span data-ttu-id="c5db5-184">A [versão 4,71 e posterior](versions.md) do Shell32.dll adiciona a capacidade de modificar o conteúdo da barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-184">[Version 4.71 and later](versions.md) of Shell32.dll adds the capability to modify the contents of the taskbar.</span></span> <span data-ttu-id="c5db5-185">Em um aplicativo, agora você pode adicionar, remover e ativar botões da barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-185">From an application, you can now add, remove, and activate taskbar buttons.</span></span> <span data-ttu-id="c5db5-186">Ativar o item não ativa a janela; Ele mostra o item conforme pressionado na barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-186">Activating the item does not activate the window; it shows the item as pressed on the taskbar.</span></span>

<span data-ttu-id="c5db5-187">Os recursos de modificação da barra de tarefas são implementados em um objeto de Component Object Model (COM) (CLSIDlist \_ ) que expõe a interface [**ITASKBARLIST**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) (IID \_ ITaskbarList).</span><span class="sxs-lookup"><span data-stu-id="c5db5-187">The taskbar modification capabilities are implemented in a Component Object Model (COM) object (CLSID\_TaskbarList ) that exposes the [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) interface (IID\_ITaskbarList).</span></span> <span data-ttu-id="c5db5-188">Você deve chamar o método [**ITaskbarList:: HrInit**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist-hrinit) para inicializar o objeto.</span><span class="sxs-lookup"><span data-stu-id="c5db5-188">You must call the [**ITaskbarList::HrInit**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-itaskbarlist-hrinit) method to initialize the object.</span></span> <span data-ttu-id="c5db5-189">Em seguida, você pode usar os métodos da interface [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) para modificar o conteúdo da barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-189">You can then use the methods of the [**ITaskbarList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-itaskbarlist) interface to modify the contents of the taskbar.</span></span>

### <a name="adding-modifying-and-deleting-icons-in-the-notification-area"></a><span data-ttu-id="c5db5-190">Adicionando, modificando e excluindo ícones na área de notificação</span><span class="sxs-lookup"><span data-stu-id="c5db5-190">Adding, Modifying, and Deleting Icons in the Notification Area</span></span>

<span data-ttu-id="c5db5-191">Use a [**função \_ NotifyIcon do Shell**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) para adicionar, modificar ou excluir ícones da área de notificação.</span><span class="sxs-lookup"><span data-stu-id="c5db5-191">Use the [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) function to add, modify, or delete icons from the notification area.</span></span> <span data-ttu-id="c5db5-192">O parâmetro *dwMessage* do **shell \_ NotifyIcon** é uma mensagem para a barra de tarefas que especifica a ação a ser executada.</span><span class="sxs-lookup"><span data-stu-id="c5db5-192">The *dwMessage* parameter of **Shell\_NotifyIcon** is a message to the taskbar that specifies the action to be taken.</span></span> <span data-ttu-id="c5db5-193">O parâmetro *pnid* é um ponteiro para uma estrutura [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) que é usada para identificar o ícone e passar quaisquer informações adicionais necessárias para o sistema processar a mensagem.</span><span class="sxs-lookup"><span data-stu-id="c5db5-193">The *pnid* parameter is a pointer to a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure that is used to identify the icon and pass any additional information that is needed for the system to process the message.</span></span>

<span data-ttu-id="c5db5-194">Você pode executar as seguintes ações com ícones da área de notificação.</span><span class="sxs-lookup"><span data-stu-id="c5db5-194">You can perform the following actions with notification area icons.</span></span>

-   <span data-ttu-id="c5db5-195">Para adicionar um ícone à área de notificação da barra de tarefas, chame o [**shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) com o parâmetro *dwMessage* definido como Nim \_ Add.</span><span class="sxs-lookup"><span data-stu-id="c5db5-195">To add an icon to the taskbar's notification area, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with the *dwMessage* parameter set to NIM\_ADD.</span></span> <span data-ttu-id="c5db5-196">A estrutura [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) é usada para especificar a alça e o identificador do ícone e qualquer texto de dica de ferramenta.</span><span class="sxs-lookup"><span data-stu-id="c5db5-196">The [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure is used to specify the icon's handle and identifier, and any tooltip text.</span></span> <span data-ttu-id="c5db5-197">Se o usuário tiver selecionado a caixa de seleção **Mostrar relógio** nas propriedades da barra de tarefas, o sistema colocará o ícone à esquerda imediata do relógio.</span><span class="sxs-lookup"><span data-stu-id="c5db5-197">If the user has selected the **Show Clock** check box in the taskbar properties, the system places the icon to the immediate left of the clock.</span></span> <span data-ttu-id="c5db5-198">Caso contrário, o ícone será exibido no lado direito ou na parte inferior da barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-198">Otherwise, the icon appears on the right side or at the bottom of the taskbar.</span></span> <span data-ttu-id="c5db5-199">Todos os ícones existentes são deslocados para a esquerda para liberar espaço para o novo ícone.</span><span class="sxs-lookup"><span data-stu-id="c5db5-199">Any existing icons are shifted to the left to make room for the new icon.</span></span>
-   <span data-ttu-id="c5db5-200">Para modificar as informações de um ícone, incluindo o identificador de ícone, o texto da dica de ferramenta e a mensagem de retorno de chamada, chame o [**shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) com *dwMessage* definido como Nim \_ Modify.</span><span class="sxs-lookup"><span data-stu-id="c5db5-200">To modify an icon's information, including its icon handle, tooltip text, and callback message identifier, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to NIM\_MODIFY.</span></span>
-   <span data-ttu-id="c5db5-201">Para excluir um ícone da área de notificação, chame o [**shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) com o parâmetro *dwMessage* definido como Nim \_ Delete.</span><span class="sxs-lookup"><span data-stu-id="c5db5-201">To delete an icon from the notification area, call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with the *dwMessage* parameter set to NIM\_DELETE.</span></span>

<span data-ttu-id="c5db5-202">Quando você tiver concluído uma operação de interface do usuário, retorne o foco para a área de notificação chamando o [**shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) com *dwMessage* definido como Nim \_ SETFOCUS.</span><span class="sxs-lookup"><span data-stu-id="c5db5-202">When you have completed a user interface operation, return focus to the notification area by calling [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to NIM\_SETFOCUS.</span></span> <span data-ttu-id="c5db5-203">Por exemplo, você pode fazer isso quando um ícone da barra de tarefas exibe um menu de atalho, mas o usuário o cancela pressionando a tecla ESCAPE.</span><span class="sxs-lookup"><span data-stu-id="c5db5-203">For example, you could do this when a taskbar icon displays a shortcut menu, but the user cancels it by pressing the ESCAPE key.</span></span>

### <a name="receiving-notification-area-callback-messages"></a><span data-ttu-id="c5db5-204">Recebendo mensagens de retorno de chamada da área de notificação</span><span class="sxs-lookup"><span data-stu-id="c5db5-204">Receiving Notification Area Callback Messages</span></span>

<span data-ttu-id="c5db5-205">Aplicativos normalmente colocam ícones na área de notificação da barra de tarefas para servir como indicadores de status.</span><span class="sxs-lookup"><span data-stu-id="c5db5-205">Applications commonly put icons in the notification area of the taskbar to serve as status indicators.</span></span> <span data-ttu-id="c5db5-206">Você pode fornecer informações adicionais quando o usuário executa ações do mouse, como mover o ponteiro do mouse sobre o ícone ou clicar no ícone.</span><span class="sxs-lookup"><span data-stu-id="c5db5-206">You can provide additional information when the user performs mouse actions, such as moving the mouse pointer over the icon or clicking the icon.</span></span>

<span data-ttu-id="c5db5-207">O sistema notifica você sobre eventos de mouse e teclado enviando uma mensagem de retorno de chamada definida pelo aplicativo que está associada a um ícone específico.</span><span class="sxs-lookup"><span data-stu-id="c5db5-207">The system notifies you of mouse and keyboard events by sending an application-defined callback message that is associated with a particular icon.</span></span> <span data-ttu-id="c5db5-208">Dessa forma, o sistema pode notificar um aplicativo quando o usuário, por exemplo, clicar no ícone ou selecioná-lo pressionando uma tecla.</span><span class="sxs-lookup"><span data-stu-id="c5db5-208">In this way, the system can notify an application when the user, for instance, clicks the icon or selects it by pressing a key.</span></span>

<span data-ttu-id="c5db5-209">Você define a mensagem de retorno de chamada de um ícone ao adicionar o ícone à barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-209">You define an icon's callback message when you add the icon to the taskbar.</span></span> <span data-ttu-id="c5db5-210">O identificador de mensagem de retorno de chamada é especificado no membro **uCallbackMessage** da estrutura [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) passada com Nim \_ Add.</span><span class="sxs-lookup"><span data-stu-id="c5db5-210">The callback message identifier is specified in the **uCallbackMessage** member of the [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure passed with NIM\_ADD.</span></span> <span data-ttu-id="c5db5-211">Quando um evento ocorre, o sistema envia a mensagem de retorno de chamada para o procedimento de janela da janela especificada pelo membro **HWND** .</span><span class="sxs-lookup"><span data-stu-id="c5db5-211">When an event occurs, the system sends the callback message to the window procedure of the window specified by the **hWnd** member.</span></span> <span data-ttu-id="c5db5-212">O parâmetro *wParam* da mensagem contém o identificador do ícone da barra de tarefas no qual o evento ocorreu.</span><span class="sxs-lookup"><span data-stu-id="c5db5-212">The *wParam* parameter of the message contains the identifier of the taskbar icon in which the event occurred.</span></span> <span data-ttu-id="c5db5-213">O parâmetro *lParam* contém a mensagem de mouse ou de teclado associada ao evento.</span><span class="sxs-lookup"><span data-stu-id="c5db5-213">The *lParam* parameter holds the mouse or keyboard message associated with the event.</span></span> <span data-ttu-id="c5db5-214">Por exemplo, quando o ponteiro do mouse se move para um ícone da barra de tarefas, *lParam* contém o [**WM \_ MOUSEMOVE**](../inputdev/wm-mousemove.md).</span><span class="sxs-lookup"><span data-stu-id="c5db5-214">For example, when the mouse pointer moves onto a taskbar icon, *lParam* contains [**WM\_MOUSEMOVE**](../inputdev/wm-mousemove.md).</span></span>

<span data-ttu-id="c5db5-215">Os resultados de vários eventos de mouse podem ser resumidos da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="c5db5-215">The results of various mouse events can be summarized as follows:</span></span>

-   <span data-ttu-id="c5db5-216">Quando o usuário move o ponteiro do mouse sobre o ícone, o sistema exibe o texto da dica de ferramenta que foi especificado em [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa).</span><span class="sxs-lookup"><span data-stu-id="c5db5-216">When the user moves the mouse pointer over the icon, the system displays the tooltip text that was specified in [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa).</span></span>
-   <span data-ttu-id="c5db5-217">Quando o usuário clica no ícone, seu aplicativo recebe uma notificação do [**WM \_ LBUTTONDOWN**](../inputdev/wm-lbuttondown.md) .</span><span class="sxs-lookup"><span data-stu-id="c5db5-217">When the user clicks the icon, your application receives a [**WM\_LBUTTONDOWN**](../inputdev/wm-lbuttondown.md) notification.</span></span>
-   <span data-ttu-id="c5db5-218">Quando o usuário clica com o botão direito do mouse no ícone, seu aplicativo recebe uma notificação do [**WM \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) .</span><span class="sxs-lookup"><span data-stu-id="c5db5-218">When the user right-clicks the icon, your application receives a [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) notification.</span></span>
-   <span data-ttu-id="c5db5-219">Quando o usuário clica duas vezes no ícone, seu aplicativo recebe uma notificação do [**WM \_ LBUTTONDBLCLK**](../inputdev/wm-lbuttondblclk.md) .</span><span class="sxs-lookup"><span data-stu-id="c5db5-219">When the user double-clicks the icon, your application receives a [**WM\_LBUTTONDBLCLK**](../inputdev/wm-lbuttondblclk.md) notification.</span></span>

<span data-ttu-id="c5db5-220">Normalmente, clicar no ícone faz com que o aplicativo exiba uma janela com informações adicionais, clicar com o botão direito do mouse exibe um menu de atalho e clicar duas vezes executa o comando de menu de atalho padrão.</span><span class="sxs-lookup"><span data-stu-id="c5db5-220">Typically, clicking the icon causes the application to display a window with additional information, right-clicking displays a shortcut menu, and double-clicking executes the default shortcut menu command.</span></span>

<span data-ttu-id="c5db5-221">Para obter um exemplo de como alterar o texto da dica de ferramenta associado a um ícone da área de notificação, consulte [Tooltips de balão para ícones da barra de status](../controls/tooltip-controls.md).</span><span class="sxs-lookup"><span data-stu-id="c5db5-221">For an example of how to change the tooltip text associated with a notification area icon, see [Balloon Tooltips for Status Bar Icons](../controls/tooltip-controls.md).</span></span>

<span data-ttu-id="c5db5-222">As versões 5,0 e posteriores do Shell tratam eventos de mouse e teclado do [**shell \_**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) , de maneiras diferentes das versões anteriores do Shell encontradas no Windows NT 4,0, Windows 95 e Windows 98.</span><span class="sxs-lookup"><span data-stu-id="c5db5-222">Versions 5.0 and later of the Shell handle [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) mouse and keyboard events in different ways than earlier Shell versions found on Windows NT 4.0, Windows 95, and Windows 98.</span></span> <span data-ttu-id="c5db5-223">As diferenças são:</span><span class="sxs-lookup"><span data-stu-id="c5db5-223">The differences are as follows:</span></span>

-   <span data-ttu-id="c5db5-224">Se um usuário solicitar o menu de atalho de um ícone de notificação com o teclado, o Shell da versão 5,0 enviará ao aplicativo associado uma mensagem de [**\_ CONTEXTMENU do WM**](../menurc/wm-contextmenu.md) .</span><span class="sxs-lookup"><span data-stu-id="c5db5-224">If a user requests a notify icon's shortcut menu with the keyboard, the version 5.0 Shell sends the associated application a [**WM\_CONTEXTMENU**](../menurc/wm-contextmenu.md) message.</span></span> <span data-ttu-id="c5db5-225">As versões anteriores enviam as mensagens do [**WM \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) e do [**WM \_ RBUTTONUP**](../inputdev/wm-rbuttonup.md) .</span><span class="sxs-lookup"><span data-stu-id="c5db5-225">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="c5db5-226">Se um usuário selecionar um ícone de notificação com o teclado e ativá-lo com a barra de espaço ou Inserir chave, a versão 5,0 do Shell enviará ao aplicativo associado uma notificação de **\_ seleção de Nin** .</span><span class="sxs-lookup"><span data-stu-id="c5db5-226">If a user selects a notify icon with the keyboard and activates it with the space bar or ENTER key, the version 5.0 Shell sends the associated application an **NIN\_KEYSELECT** notification.</span></span> <span data-ttu-id="c5db5-227">As versões anteriores enviam as mensagens do [**WM \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) e do [**WM \_ RBUTTONUP**](../inputdev/wm-rbuttonup.md) .</span><span class="sxs-lookup"><span data-stu-id="c5db5-227">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="c5db5-228">Se um usuário selecionar um ícone de notificação com o mouse e ativá-lo com a tecla ENTER, a versão 5,0 do Shell enviará ao aplicativo associado uma notificação de **\_ seleção do NIN** .</span><span class="sxs-lookup"><span data-stu-id="c5db5-228">If a user selects a notify icon with the mouse and activates it with the ENTER key, the version 5.0 Shell sends the associated application an **NIN\_SELECT** notification.</span></span> <span data-ttu-id="c5db5-229">As versões anteriores enviam as mensagens do [**WM \_ RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) e do [**WM \_ RBUTTONUP**](../inputdev/wm-rbuttonup.md) .</span><span class="sxs-lookup"><span data-stu-id="c5db5-229">Earlier versions send [**WM\_RBUTTONDOWN**](../inputdev/wm-rbuttondown.md) and [**WM\_RBUTTONUP**](../inputdev/wm-rbuttonup.md) messages.</span></span>
-   <span data-ttu-id="c5db5-230">Se um usuário passar o ponteiro do mouse sobre um ícone com o qual uma dica de ferramenta de balão está associada, o Shell da versão 6,0 (Windows XP) enviará as mensagens a seguir.</span><span class="sxs-lookup"><span data-stu-id="c5db5-230">If a user passes the mouse pointer over an icon with which a balloon tooltip is associated, the version 6.0 Shell (Windows XP)sends the following messages.</span></span>
    -   -   <span data-ttu-id="c5db5-231">**Nin \_ BALLOONSHOW** -enviado quando o balão é mostrado (os balões são colocados na fila).</span><span class="sxs-lookup"><span data-stu-id="c5db5-231">**NIN\_BALLOONSHOW** - Sent when the balloon is shown (balloons are queued).</span></span>
        -   <span data-ttu-id="c5db5-232">**Nin \_ BALLOONHIDE** -enviado quando o balão desaparece — por exemplo, quando o ícone é excluído.</span><span class="sxs-lookup"><span data-stu-id="c5db5-232">**NIN\_BALLOONHIDE** - Sent when the balloon disappears—for example, when the icon is deleted.</span></span> <span data-ttu-id="c5db5-233">Essa mensagem não será enviada se o balão for descartado devido a um tempo limite ou a um clique do mouse.</span><span class="sxs-lookup"><span data-stu-id="c5db5-233">This message is not sent if the balloon is dismissed because of a timeout or a mouse click.</span></span>
        -   <span data-ttu-id="c5db5-234">**Nin \_ BALLOONTIMEOUT** -enviado quando o balão é Descartado devido a um tempo limite.</span><span class="sxs-lookup"><span data-stu-id="c5db5-234">**NIN\_BALLOONTIMEOUT** - Sent when the balloon is dismissed because of a timeout.</span></span>
        -   <span data-ttu-id="c5db5-235">**Nin \_ BALLOONUSERCLICK** -enviado quando o balão é Descartado devido a um clique do mouse.</span><span class="sxs-lookup"><span data-stu-id="c5db5-235">**NIN\_BALLOONUSERCLICK** - Sent when the balloon is dismissed because of a mouse click.</span></span>

<span data-ttu-id="c5db5-236">Você pode selecionar a maneira como o Shell deve se comportar chamando o [**shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) com *dwMessage* definido como **Nim \_ SetVersion**.</span><span class="sxs-lookup"><span data-stu-id="c5db5-236">You can select which way the Shell should behave by calling [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_SETVERSION**.</span></span> <span data-ttu-id="c5db5-237">Defina o membro **uVersion** da estrutura [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) para indicar se você deseja o comportamento da versão 5,0 ou anterior à versão 5,0.</span><span class="sxs-lookup"><span data-stu-id="c5db5-237">Set the **uVersion** member of the [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure to indicate whether you want version 5.0 or pre-version 5.0 behavior.</span></span>

### <a name="taskbar-creation-notification"></a><span data-ttu-id="c5db5-238">Notificação de criação da barra de tarefas</span><span class="sxs-lookup"><span data-stu-id="c5db5-238">Taskbar Creation Notification</span></span>

<span data-ttu-id="c5db5-239">Com o Microsoft Internet Explorer 4,0 e posterior, o Shell notifica os aplicativos que a barra de tarefas foi criada.</span><span class="sxs-lookup"><span data-stu-id="c5db5-239">With Microsoft Internet Explorer 4.0 and later, the Shell notifies applications that the taskbar has been created.</span></span> <span data-ttu-id="c5db5-240">Quando a barra de tarefas é criada, ela registra uma mensagem com a cadeia de caracteres TaskbarCreated e, em seguida, transmite essa mensagem para todas as janelas de nível superior.</span><span class="sxs-lookup"><span data-stu-id="c5db5-240">When the taskbar is created, it registers a message with the TaskbarCreated string and then broadcasts this message to all top-level windows.</span></span> <span data-ttu-id="c5db5-241">Quando o aplicativo da barra de tarefas recebe essa mensagem, ele deve assumir que os ícones da barra de tarefas adicionados foram removidos e adicioná-los novamente.</span><span class="sxs-lookup"><span data-stu-id="c5db5-241">When your taskbar application receives this message, it should assume that any taskbar icons it added have been removed and add them again.</span></span> <span data-ttu-id="c5db5-242">Esse recurso geralmente se aplica apenas a serviços que já estão em execução quando o Shell é iniciado.</span><span class="sxs-lookup"><span data-stu-id="c5db5-242">This feature generally applies only to services that are already running when the Shell launches.</span></span> <span data-ttu-id="c5db5-243">O exemplo a seguir mostra um método muito simplificado para lidar com esse caso.</span><span class="sxs-lookup"><span data-stu-id="c5db5-243">The following example shows a very simplified method for handling this case.</span></span>

<span data-ttu-id="c5db5-244">No Windows 10, a barra de tarefas também transmite essa mensagem quando o DPI da exibição primária é alterado.</span><span class="sxs-lookup"><span data-stu-id="c5db5-244">On Windows 10, the taskbar also broadcasts this message when the DPI of the primary display changes.</span></span>

```
LRESULT CALLBACK WndProc(HWND hWnd, 
                         UINT uMessage, 
                         WPARAM wParam, 
                         LPARAM lParam)
{
    static UINT s_uTaskbarRestart;

    switch(uMessage)
    {
        case WM_CREATE:
            s_uTaskbarRestart = RegisterWindowMessage(TEXT("TaskbarCreated"));
            break;
        
        default:
            if(uMessage == s_uTaskbarRestart)
                AddTaskbarIcons();
            break;
    }

    return DefWindowProc(hWnd, uMessage, wParam, lParam);
}
```



## <a name="using-the-taskbar"></a><span data-ttu-id="c5db5-245">Usando a barra de tarefas</span><span class="sxs-lookup"><span data-stu-id="c5db5-245">Using the Taskbar</span></span>

<span data-ttu-id="c5db5-246">Esta seção inclui exemplos que demonstram como adicionar ícones à área de notificação da barra de tarefas e como processar mensagens de retorno de chamada para ícones da barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-246">This section includes examples that demonstrate how to add icons to the taskbar notification area and how to process callback messages for taskbar icons.</span></span>

### <a name="adding-and-deleting-taskbar-icons-in-the-notification-area"></a><span data-ttu-id="c5db5-247">Adicionando e excluindo ícones da barra de tarefas na área de notificação</span><span class="sxs-lookup"><span data-stu-id="c5db5-247">Adding and Deleting Taskbar Icons in the Notification Area</span></span>

<span data-ttu-id="c5db5-248">Você adiciona um ícone à área de notificação da barra de tarefas preenchendo uma estrutura [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) e, em seguida, passando a estrutura para o [**shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) com *dwMessage* definido como **Nim \_ Add**.</span><span class="sxs-lookup"><span data-stu-id="c5db5-248">You add an icon to the taskbar notification area by filling in a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure and then passing the structure to [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_ADD**.</span></span> <span data-ttu-id="c5db5-249">Os membros da estrutura devem especificar o identificador para a janela que está adicionando o ícone, bem como o identificador de ícone e o identificador de ícone.</span><span class="sxs-lookup"><span data-stu-id="c5db5-249">The structure members must specify the handle to the window that is adding the icon, as well as the icon identifier and icon handle.</span></span> <span data-ttu-id="c5db5-250">Você também pode especificar o texto da dica de ferramenta para o ícone.</span><span class="sxs-lookup"><span data-stu-id="c5db5-250">You can also specify tooltip text for the icon.</span></span> <span data-ttu-id="c5db5-251">Se você precisar receber mensagens do mouse para o ícone, especifique o identificador da mensagem de retorno de chamada que o sistema deve usar para enviar a mensagem para o procedimento de janela.</span><span class="sxs-lookup"><span data-stu-id="c5db5-251">If you need to receive mouse messages for the icon, specify the identifier of the callback message that the system should use to send the message to the window procedure.</span></span>

<span data-ttu-id="c5db5-252">A função no exemplo a seguir demonstra como adicionar um ícone à barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-252">The function in the following example demonstrates how to add an icon to the taskbar.</span></span>


```
// MyTaskBarAddIcon - adds an icon to the notification area. 
// Returns TRUE if successful, or FALSE otherwise. 
// hwnd - handle to the window to receive callback messages 
// uID - identifier of the icon 
// hicon - handle to the icon to add 
// lpszTip - tooltip text 

BOOL MyTaskBarAddIcon(HWND hwnd, UINT uID, HICON hicon, LPSTR lpszTip) 
{ 
    BOOL res; 
    NOTIFYICONDATA tnid; 
 
    tnid.cbSize = sizeof(NOTIFYICONDATA); 
    tnid.hWnd = hwnd; 
    tnid.uID = uID; 
    tnid.uFlags = NIF_MESSAGE | NIF_ICON | NIF_TIP; 
    tnid.uCallbackMessage = MYWM_NOTIFYICON; 
    tnid.hIcon = hicon; 
    if (lpszTip) 
        hr = StringCbCopyN(tnid.szTip, sizeof(tnid.szTip), lpszTip, 
                           sizeof(tnid.szTip));
        // TODO: Add error handling for the HRESULT.
    else 
        tnid.szTip[0] = (TCHAR)'\0'; 
 
    res = Shell_NotifyIcon(NIM_ADD, &tnid); 
 
    if (hicon) 
        DestroyIcon(hicon); 
 
    return res; 
}
```



<span data-ttu-id="c5db5-253">Para excluir um ícone da área de notificação da barra de tarefas, preencha uma estrutura [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) e chame o [**shell \_ NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) com *dwMessage* definido como **Nim \_ delete**.</span><span class="sxs-lookup"><span data-stu-id="c5db5-253">To delete an icon from the taskbar notification area, fill a [**NOTIFYICONDATA**](/windows/desktop/api/Shellapi/ns-shellapi-notifyicondataa) structure and call [**Shell\_NotifyIcon**](/windows/desktop/api/Shellapi/nf-shellapi-shell_notifyicona) with *dwMessage* set to **NIM\_DELETE**.</span></span> <span data-ttu-id="c5db5-254">Ao excluir um ícone da barra de tarefas, especifique somente os membros **cbSize**, **HWND** e **UID** da estrutura.</span><span class="sxs-lookup"><span data-stu-id="c5db5-254">When deleting a taskbar icon, specify only the **cbSize**, **hWnd**, and **uID** members of the structure.</span></span> <span data-ttu-id="c5db5-255">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="c5db5-255">For example:</span></span>


```
// MyTaskBarDeleteIcon - deletes an icon from the notification area. 
// Returns TRUE if successful, or FALSE otherwise. 
// hwnd - handle to the window that added the icon. 
// uID - identifier of the icon to delete. 

BOOL MyTaskBarDeleteIcon(HWND hwnd, UINT uID) 
{ 
    BOOL res; 
    NOTIFYICONDATA tnid; 
 
    tnid.cbSize = sizeof(NOTIFYICONDATA); 
    tnid.hWnd = hwnd; 
    tnid.uID = uID; 
         
    res = Shell_NotifyIcon(NIM_DELETE, &tnid); 
    return res; 
}
```



### <a name="receiving-mouse-events"></a><span data-ttu-id="c5db5-256">Recebendo eventos do mouse</span><span class="sxs-lookup"><span data-stu-id="c5db5-256">Receiving Mouse Events</span></span>

<span data-ttu-id="c5db5-257">Se você especificar uma mensagem de retorno de chamada para um ícone da barra de tarefas, o sistema enviará a mensagem para seu aplicativo sempre que um evento do mouse ocorrer no retângulo delimitador do ícone.</span><span class="sxs-lookup"><span data-stu-id="c5db5-257">If you specify a callback message for a taskbar icon, the system sends the message to your application whenever a mouse event occurs in the icon's bounding rectangle.</span></span> <span data-ttu-id="c5db5-258">O parâmetro *wParam* da mensagem Especifica o identificador do ícone da barra de tarefas e o parâmetro *lParam* da mensagem Especifica a mensagem que o sistema gerou como resultado do evento do mouse.</span><span class="sxs-lookup"><span data-stu-id="c5db5-258">The *wParam* parameter of the message specifies the identifier of the taskbar icon, and the *lParam* parameter of the message specifies the message that the system generated as a result of the mouse event.</span></span>

<span data-ttu-id="c5db5-259">A função no exemplo a seguir é de um aplicativo que adiciona os ícones de bateria e de impressora à barra de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c5db5-259">The function in the following example is from an application that adds both battery and printer icons to the taskbar.</span></span> <span data-ttu-id="c5db5-260">O aplicativo chama a função quando recebe uma mensagem de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="c5db5-260">The application calls the function when it receives a callback message.</span></span> <span data-ttu-id="c5db5-261">A função determina se o usuário clicou em um dos ícones e, se um clique tiver ocorrido, chama uma função definida pelo aplicativo para exibir informações de status.</span><span class="sxs-lookup"><span data-stu-id="c5db5-261">The function determines whether the user has clicked one of the icons and, if a click has occurred, calls an application-defined function to display status information.</span></span>


```
// On_MYWM_NOTIFYICON - processes callback messages for taskbar icons. 
// wParam - first message parameter of the callback message. 
// lParam - second message parameter of the callback message. 

void On_MYWM_NOTIFYICON(WPARAM wParam, LPARAM lParam) 
{ 
    UINT uID; 
    UINT uMouseMsg; 
 
    uID = (UINT) wParam; 
    uMouseMsg = (UINT) lParam; 
 
    if (uMouseMsg == WM_LBUTTONDOWN) 
    { 
        switch (uID) 
        { 
            case IDI_MYBATTERYICON: 
 
                // The user clicked the battery icon. Display the 
                // battery status. 
                ShowBatteryStatus(); 
                break; 
 
            case IDI_MYPRINTERICON: 
 
                // The user clicked the printer icon. Display the 
                // status of the print job. 
                ShowJobStatus(); 
                break; 
 
            default: 
                break; 
        } 
     } 

     return; 
 }
```



 

 
