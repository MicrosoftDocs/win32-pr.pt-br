---
description: A seção obtendo uma pasta ID abordou duas abordagens para obter um ponteiro do objeto de namespace para uma lista de identificadores de item (PIDL).
ms.assetid: c99a2f6c-3144-41ec-ad97-59a30bfec9ab
title: Obtendo informações sobre o conteúdo de uma pasta
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f7eb26e9df28af4811e74f2878eebb7af9d5c92a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104988734"
---
# <a name="getting-information-about-the-contents-of-a-folder"></a><span data-ttu-id="9eedb-103">Obtendo informações sobre o conteúdo de uma pasta</span><span class="sxs-lookup"><span data-stu-id="9eedb-103">Getting Information About the Contents of a Folder</span></span>

<span data-ttu-id="9eedb-104">A seção [obtendo uma pasta ID](folder-id.md) abordou duas abordagens para obter um ponteiro do objeto de namespace para uma lista de identificadores de item (PIDL).</span><span class="sxs-lookup"><span data-stu-id="9eedb-104">The [Getting a Folder's ID](folder-id.md) section discussed two approaches to getting a namespace object's pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="9eedb-105">Uma pergunta óbvia é: quando você tem um PIDL, o que pode fazer com ele?</span><span class="sxs-lookup"><span data-stu-id="9eedb-105">One obvious question is: Once you have a PIDL, what can you do with it?</span></span> <span data-ttu-id="9eedb-106">Uma pergunta relacionada é: e se nenhuma das abordagens funcionar ou for adequada para seu aplicativo?</span><span class="sxs-lookup"><span data-stu-id="9eedb-106">A related question is: What if neither approach works, or is suitable for your application?</span></span> <span data-ttu-id="9eedb-107">A resposta a ambas as perguntas requer uma análise mais detalhada de como o namespace é implementado.</span><span class="sxs-lookup"><span data-stu-id="9eedb-107">The answer to both questions requires taking a closer look at how the namespace is implemented.</span></span> <span data-ttu-id="9eedb-108">A chave é a interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="9eedb-108">The key is the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span>

-   [<span data-ttu-id="9eedb-109">Usando a interface IShellFolder</span><span class="sxs-lookup"><span data-stu-id="9eedb-109">Using the IShellFolder Interface</span></span>](#using-the-ishellfolder-interface)
-   [<span data-ttu-id="9eedb-110">Enumerando o conteúdo de uma pasta</span><span class="sxs-lookup"><span data-stu-id="9eedb-110">Enumerating the Contents of a Folder</span></span>](#enumerating-the-contents-of-a-folder)
-   [<span data-ttu-id="9eedb-111">Determinando nomes de exibição e outras propriedades</span><span class="sxs-lookup"><span data-stu-id="9eedb-111">Determining Display Names and Other Properties</span></span>](#determining-display-names-and-other-properties)
-   [<span data-ttu-id="9eedb-112">Obtendo um ponteiro para a interface IShellFolder de uma subpasta</span><span class="sxs-lookup"><span data-stu-id="9eedb-112">Getting a Pointer to a Subfolder's IShellFolder Interface</span></span>](#getting-a-pointer-to-a-subfolders-ishellfolder-interface)
-   [<span data-ttu-id="9eedb-113">Determinando a pasta pai de um objeto</span><span class="sxs-lookup"><span data-stu-id="9eedb-113">Determining an Object's Parent Folder</span></span>](#determining-an-objects-parent-folder)

## <a name="using-the-ishellfolder-interface"></a><span data-ttu-id="9eedb-114">Usando a interface IShellFolder</span><span class="sxs-lookup"><span data-stu-id="9eedb-114">Using the IShellFolder Interface</span></span>

<span data-ttu-id="9eedb-115">Anteriormente nesta documentação, as pastas de namespace eram conhecidas como objetos.</span><span class="sxs-lookup"><span data-stu-id="9eedb-115">Earlier in this documentation, namespace folders were referred to as objects.</span></span> <span data-ttu-id="9eedb-116">Embora, nesse ponto, o termo tenha sido usado em um sentido flexível, ele também é realmente verdadeiro em um sentido estrito.</span><span class="sxs-lookup"><span data-stu-id="9eedb-116">Although, at that point, the term was used in a loose sense, it is actually true in a strict sense as well.</span></span> <span data-ttu-id="9eedb-117">Cada pasta de namespace é representada por um objeto de Component Object Model (COM).</span><span class="sxs-lookup"><span data-stu-id="9eedb-117">Every namespace folder is represented by a Component Object Model (COM) object.</span></span> <span data-ttu-id="9eedb-118">Cada objeto de pasta expõe várias interfaces que podem ser usadas para uma ampla variedade de tarefas.</span><span class="sxs-lookup"><span data-stu-id="9eedb-118">Each folder object exposes a number of interfaces that can be used for a wide variety of tasks.</span></span> <span data-ttu-id="9eedb-119">Algumas interfaces que são opcionais podem não ser expostas por todas as pastas.</span><span class="sxs-lookup"><span data-stu-id="9eedb-119">Some interfaces that are optional may not be exposed by all folders.</span></span> <span data-ttu-id="9eedb-120">No entanto, todas as pastas devem expor a interface fundamental, [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span><span class="sxs-lookup"><span data-stu-id="9eedb-120">However, all folders must expose the fundamental interface, [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder).</span></span>

<span data-ttu-id="9eedb-121">A primeira etapa no uso de um objeto Folder é recuperar um ponteiro para sua interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="9eedb-121">The first step in using a folder object is to retrieve a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="9eedb-122">Além de fornecer acesso às outras interfaces do objeto, o **IShellFolder** expõe um grupo de métodos que manipulam várias tarefas comuns, várias das quais são discutidas nesta seção.</span><span class="sxs-lookup"><span data-stu-id="9eedb-122">In addition to providing access to the object's other interfaces, **IShellFolder** exposes a group of methods that handle a number of common tasks, several of which are discussed in this section.</span></span>

<span data-ttu-id="9eedb-123">Para recuperar um ponteiro para a interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) de um objeto de namespace, você deve primeiro chamar [**SHGetDesktopFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetdesktopfolder).</span><span class="sxs-lookup"><span data-stu-id="9eedb-123">To retrieve a pointer to a namespace object's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface, you must first call [**SHGetDesktopFolder**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetdesktopfolder).</span></span> <span data-ttu-id="9eedb-124">Essa função retorna um ponteiro para a interface **IShellFolder** da raiz do namespace, a área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9eedb-124">This function returns a pointer to the **IShellFolder** interface of the namespace root, the desktop.</span></span> <span data-ttu-id="9eedb-125">Depois de ter a interface **IShellFolder** da área de trabalho, há várias maneiras de continuar.</span><span class="sxs-lookup"><span data-stu-id="9eedb-125">Once you have the desktop's **IShellFolder** interface, there a variety of ways to proceed.</span></span>

<span data-ttu-id="9eedb-126">Se você já tiver o PIDL da pasta em que está interessado — por exemplo, chamando [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation)– você pode recuperar sua interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) chamando o método [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) da área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="9eedb-126">If you already have the PIDL of the folder you are interested in—for instance, by calling [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation)—you can retrieve its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface by calling the desktop's [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method.</span></span> <span data-ttu-id="9eedb-127">Se você tiver o caminho de um objeto do sistema de arquivos, deverá primeiro obter seu PIDL chamando o método IShellFolder da área de trabalho [**::P arsedisplayname**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) e, em seguida, chamar **IShellFolder:: BindToObject**.</span><span class="sxs-lookup"><span data-stu-id="9eedb-127">If you have the path of a file system object, you must first obtain its PIDL by calling the desktop's [**IShellFolder::ParseDisplayName**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-parsedisplayname) method and then call **IShellFolder::BindToObject**.</span></span> <span data-ttu-id="9eedb-128">Se nenhuma dessas abordagens for aplicável, você poderá usar outros métodos **IShellFolder** para navegar no namespace.</span><span class="sxs-lookup"><span data-stu-id="9eedb-128">If neither of these approaches is applicable, you can use other **IShellFolder** methods to navigate the namespace.</span></span> <span data-ttu-id="9eedb-129">Para obter mais informações, consulte [navegando no namespace](navigate.md).</span><span class="sxs-lookup"><span data-stu-id="9eedb-129">For more information, see [Navigating the Namespace](navigate.md).</span></span>

## <a name="enumerating-the-contents-of-a-folder"></a><span data-ttu-id="9eedb-130">Enumerando o conteúdo de uma pasta</span><span class="sxs-lookup"><span data-stu-id="9eedb-130">Enumerating the Contents of a Folder</span></span>

<span data-ttu-id="9eedb-131">A primeira coisa que você geralmente quer fazer com uma pasta é descobrir o que ela contém.</span><span class="sxs-lookup"><span data-stu-id="9eedb-131">The first thing you usually want to do with a folder is to find out what it contains.</span></span> <span data-ttu-id="9eedb-132">Primeiro, você deve chamar o método [**IShellFolder:: EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) da pasta.</span><span class="sxs-lookup"><span data-stu-id="9eedb-132">You must first call the folder's [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) method.</span></span> <span data-ttu-id="9eedb-133">A pasta criará um objeto de enumeração OLE padrão e retornará sua interface [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) .</span><span class="sxs-lookup"><span data-stu-id="9eedb-133">The folder will create a standard OLE enumeration object and return its [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface.</span></span> <span data-ttu-id="9eedb-134">Essa interface expõe quatro métodos padrão —[**clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone), [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next), [**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset)e [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip)— que podem ser usados para enumerar o conteúdo da pasta.</span><span class="sxs-lookup"><span data-stu-id="9eedb-134">This interface exposes four standard methods—[**Clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone), [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next), [**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), and [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip)—that can be used to enumerate the contents of the folder.</span></span>

<span data-ttu-id="9eedb-135">O procedimento básico para enumerar o conteúdo de uma pasta é:</span><span class="sxs-lookup"><span data-stu-id="9eedb-135">The basic procedure for enumerating a folder's contents is:</span></span>

1.  <span data-ttu-id="9eedb-136">Chame o método Folders [**IShellFolder:: EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) para recuperar um ponteiro para a interface [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) de um objeto de enumeração.</span><span class="sxs-lookup"><span data-stu-id="9eedb-136">Call the folders [**IShellFolder::EnumObjects**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-enumobjects) method to retrieve a pointer to an enumeration object's [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) interface.</span></span>
2.  <span data-ttu-id="9eedb-137">Passe um PIDL não alocado para [**IEnumIDList:: Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span><span class="sxs-lookup"><span data-stu-id="9eedb-137">Pass an unallocated PIDL to [**IEnumIDList::Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span></span> <span data-ttu-id="9eedb-138">**Em seguida** , cuida da alocação do PIDL, mas o aplicativo deve desalocá-lo quando não for mais necessário.</span><span class="sxs-lookup"><span data-stu-id="9eedb-138">**Next** takes care of allocating the PIDL, but the application must deallocate it when it is no longer needed.</span></span> <span data-ttu-id="9eedb-139">Quando **Next** retornar, o PIDL conterá apenas a ID do item do objeto e os caracteres **nulos** de terminação.</span><span class="sxs-lookup"><span data-stu-id="9eedb-139">When **Next** returns, the PIDL will contain just the object's item ID and the terminating **NULL** characters.</span></span> <span data-ttu-id="9eedb-140">Em outras palavras, é um PIDL de nível único, em relação à pasta, não a um PIDL totalmente qualificado.</span><span class="sxs-lookup"><span data-stu-id="9eedb-140">In other words, it is a single-level PIDL, relative to the folder, not a fully qualified PIDL.</span></span>
3.  <span data-ttu-id="9eedb-141">Repita a etapa 2 até [**Avançar**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) retornar S \_ false para indicar que todos os itens foram enumerados.</span><span class="sxs-lookup"><span data-stu-id="9eedb-141">Repeat step 2 until [**Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next) returns S\_FALSE to indicate that all items have been enumerated.</span></span>
4.  <span data-ttu-id="9eedb-142">Chame **IEnumIDList:: Release** para liberar o objeto de enumeração.</span><span class="sxs-lookup"><span data-stu-id="9eedb-142">Call **IEnumIDList::Release** to release the enumeration object.</span></span>

> [!Note]  
> <span data-ttu-id="9eedb-143">É importante controlar se você está trabalhando com um PIDL completo ou relativo.</span><span class="sxs-lookup"><span data-stu-id="9eedb-143">It is important to keep track of whether you are working with a full or relative PIDL.</span></span> <span data-ttu-id="9eedb-144">Algumas funções e métodos aceitarão qualquer um deles, mas outros terão apenas um ou outro.</span><span class="sxs-lookup"><span data-stu-id="9eedb-144">Some functions and methods will accept either, but others will only take one or the other.</span></span>

 

<span data-ttu-id="9eedb-145">Os três métodos [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) restantes ([**redefinição**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), [**ignorar**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip)e [**clonagem**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone)) são úteis se você precisar fazer enumerações repetidas da pasta.</span><span class="sxs-lookup"><span data-stu-id="9eedb-145">The remaining three [**IEnumIDList**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ienumidlist) methods ([**Reset**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-reset), [**Skip**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-skip), and [**Clone**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-clone)) are useful if you need to do repeated enumerations of the folder.</span></span> <span data-ttu-id="9eedb-146">Eles permitem que você redefina a enumeração, pule um ou mais objetos e faça uma cópia do objeto de enumeração para preservar seu estado.</span><span class="sxs-lookup"><span data-stu-id="9eedb-146">They allow you to reset the enumeration, skip one or more objects, and make a copy of the enumeration object to preserve its state.</span></span>

## <a name="determining-display-names-and-other-properties"></a><span data-ttu-id="9eedb-147">Determinando nomes de exibição e outras propriedades</span><span class="sxs-lookup"><span data-stu-id="9eedb-147">Determining Display Names and Other Properties</span></span>

<span data-ttu-id="9eedb-148">Depois de enumerar todos os PIDLs que estão contidos em uma pasta, você pode descobrir que tipo de objetos eles representam.</span><span class="sxs-lookup"><span data-stu-id="9eedb-148">Once you have enumerated all the PIDLs that are contained by a folder, you can find out what sort of objects they represent.</span></span> <span data-ttu-id="9eedb-149">A interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) fornece vários métodos úteis, dois dos quais são discutidos aqui.</span><span class="sxs-lookup"><span data-stu-id="9eedb-149">The [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface provides a number of useful methods, two of which are discussed here.</span></span> <span data-ttu-id="9eedb-150">Outros métodos **IShellFolder** e outras interfaces de pasta do Shell serão discutidos posteriormente.</span><span class="sxs-lookup"><span data-stu-id="9eedb-150">Other **IShellFolder** methods and other Shell folder interfaces are discussed later.</span></span>

<span data-ttu-id="9eedb-151">Uma das propriedades mais úteis é o nome de exibição do objeto.</span><span class="sxs-lookup"><span data-stu-id="9eedb-151">One of the most useful properties is the object's display name.</span></span> <span data-ttu-id="9eedb-152">Para recuperar o nome de exibição de um objeto, passe seu PIDL para [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span><span class="sxs-lookup"><span data-stu-id="9eedb-152">To retrieve the display name of an object, pass its PIDL to [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof).</span></span> <span data-ttu-id="9eedb-153">Embora o objeto possa estar localizado em qualquer lugar abaixo da pasta pai no namespace, seu PIDL deve ser relativo à pasta.</span><span class="sxs-lookup"><span data-stu-id="9eedb-153">Although the object can be located anywhere below the parent folder in the namespace, its PIDL must be relative to the folder.</span></span>

<span data-ttu-id="9eedb-154">[**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) retorna o nome de exibição como parte de uma estrutura [**Strret**](/windows/desktop/api/Shtypes/ns-shtypes-strret) .</span><span class="sxs-lookup"><span data-stu-id="9eedb-154">[**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) returns the display name as part of of a [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) structure.</span></span> <span data-ttu-id="9eedb-155">Como a extração do nome de exibição de uma estrutura **Strret** pode ser um pouco complicada, o Shell fornece duas funções que fazem o trabalho para você, [**StrRetToStr**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettostra) e [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa).</span><span class="sxs-lookup"><span data-stu-id="9eedb-155">Because extracting the display name from a **STRRET** structure can be a little tricky, the Shell provides two functions that do the job for you, [**StrRetToStr**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettostra) and [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa).</span></span> <span data-ttu-id="9eedb-156">Ambas as funções usam uma estrutura **Strret** e retornam o nome de exibição como uma cadeia de caracteres normal.</span><span class="sxs-lookup"><span data-stu-id="9eedb-156">Both functions take a **STRRET** structure, and return the display name as a normal string.</span></span> <span data-ttu-id="9eedb-157">Elas diferem apenas em como a cadeia de caracteres é alocada.</span><span class="sxs-lookup"><span data-stu-id="9eedb-157">They differ only in how the string is allocated.</span></span>

<span data-ttu-id="9eedb-158">Além do seu nome de exibição, um objeto pode ter um número de atributos, como se ele é uma pasta ou se pode ser movido.</span><span class="sxs-lookup"><span data-stu-id="9eedb-158">In addition to its display name, an object can have a number of attributes, such as whether it is a folder or whether it can be moved.</span></span> <span data-ttu-id="9eedb-159">Você pode recuperar os atributos de um objeto passando seu PIDL para [**IShellFolder:: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span><span class="sxs-lookup"><span data-stu-id="9eedb-159">You can retrieve an object's attributes by passing its PIDL to [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span></span> <span data-ttu-id="9eedb-160">A lista completa de atributos é muito grande, portanto, você deve ver a referência para obter detalhes.</span><span class="sxs-lookup"><span data-stu-id="9eedb-160">The complete list of attributes is quite large, so you should see the reference for details.</span></span> <span data-ttu-id="9eedb-161">Observe que o PIDL que você passa para **GetAttributesOf** deve ser de nível único.</span><span class="sxs-lookup"><span data-stu-id="9eedb-161">Note that the PIDL that you pass to **GetAttributesOf** must be single-level.</span></span> <span data-ttu-id="9eedb-162">Em particular, **IShellFolder:: GetAttributesOf** aceitará o PIDLs retornado por [**IEnumIDList:: Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span><span class="sxs-lookup"><span data-stu-id="9eedb-162">In particular, **IShellFolder::GetAttributesOf** will accept the PIDLs returned by [**IEnumIDList::Next**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ienumidlist-next).</span></span> <span data-ttu-id="9eedb-163">Você pode passar uma matriz de PIDLs e **GetAttributesOf** retornará os atributos que todos os objetos na matriz têm em comum.</span><span class="sxs-lookup"><span data-stu-id="9eedb-163">You can pass in an array of PIDLs, and **GetAttributesOf** will return those attributes that all objects in the array have in common.</span></span>

<span data-ttu-id="9eedb-164">Se você tiver um caminho totalmente qualificado do objeto ou PIDL, o [**SHGetFileInfo**](/windows/desktop/api/Shellapi/nf-shellapi-shgetfileinfoa) fornecerá uma maneira simples de recuperar informações sobre um objeto que seja suficiente para muitas finalidades.</span><span class="sxs-lookup"><span data-stu-id="9eedb-164">If you have an object's fully qualified path or PIDL, [**SHGetFileInfo**](/windows/desktop/api/Shellapi/nf-shellapi-shgetfileinfoa) provides a simple way to retrieve information about an object that is sufficient for many purposes.</span></span> <span data-ttu-id="9eedb-165">**SHGetFileInfo** usa um caminho totalmente qualificado ou PIDL e retorna uma variedade de informações sobre o objeto, incluindo:</span><span class="sxs-lookup"><span data-stu-id="9eedb-165">**SHGetFileInfo** takes a fully qualified path or PIDL, and returns a variety of information about the object including:</span></span>

-   <span data-ttu-id="9eedb-166">O nome de exibição do objeto</span><span class="sxs-lookup"><span data-stu-id="9eedb-166">The object's display name</span></span>
-   <span data-ttu-id="9eedb-167">Os atributos do objeto</span><span class="sxs-lookup"><span data-stu-id="9eedb-167">The object's attributes</span></span>
-   <span data-ttu-id="9eedb-168">Manipula os ícones do objeto</span><span class="sxs-lookup"><span data-stu-id="9eedb-168">Handles to the object's icons</span></span>
-   <span data-ttu-id="9eedb-169">Um identificador para a lista de imagens do sistema</span><span class="sxs-lookup"><span data-stu-id="9eedb-169">A handle to the system image list</span></span>
-   <span data-ttu-id="9eedb-170">O caminho do arquivo que contém o ícone do objeto</span><span class="sxs-lookup"><span data-stu-id="9eedb-170">The path of the file containing the object's icon</span></span>

## <a name="getting-a-pointer-to-a-subfolders-ishellfolder-interface"></a><span data-ttu-id="9eedb-171">Obtendo um ponteiro para a interface IShellFolder de uma subpasta</span><span class="sxs-lookup"><span data-stu-id="9eedb-171">Getting a Pointer to a Subfolder's IShellFolder Interface</span></span>

<span data-ttu-id="9eedb-172">Você pode determinar se a pasta contém todas as subpastas chamando [**IShellFolder:: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) e verificando se o sinalizador de \_ pasta SFGAO está definido.</span><span class="sxs-lookup"><span data-stu-id="9eedb-172">You can determine whether your folder contains any subfolders by calling [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof) and checking to see if the SFGAO\_FOLDER flag is set.</span></span> <span data-ttu-id="9eedb-173">Se um objeto for uma pasta, você poderá associá-lo, que fornece um ponteiro para sua interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="9eedb-173">If an object is a folder, you can bind to it, which provides you with a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span>

<span data-ttu-id="9eedb-174">Para associar a uma subpasta, chame o método [**IShellFolder:: BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) da pasta pai.</span><span class="sxs-lookup"><span data-stu-id="9eedb-174">To bind to a subfolder, call the parent folder's [**IShellFolder::BindToObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-bindtoobject) method.</span></span> <span data-ttu-id="9eedb-175">Esse método usa o PIDL da subpasta e retorna um ponteiro para sua interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) .</span><span class="sxs-lookup"><span data-stu-id="9eedb-175">This method takes the subfolder's PIDL and returns a pointer to its [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface.</span></span> <span data-ttu-id="9eedb-176">Depois de ter esse ponteiro, você pode usar os métodos **IShellFolder** para enumerar o conteúdo das subpastas, determinar suas propriedades e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="9eedb-176">Once you have this pointer, you can use the **IShellFolder** methods to enumerate the subfolders contents, determine their properties, and so on.</span></span>

## <a name="determining-an-objects-parent-folder"></a><span data-ttu-id="9eedb-177">Determinando a pasta pai de um objeto</span><span class="sxs-lookup"><span data-stu-id="9eedb-177">Determining an Object's Parent Folder</span></span>

<span data-ttu-id="9eedb-178">Se você tiver o PIDL de um objeto, talvez seja necessário um identificador para uma das interfaces expostas por sua pasta pai.</span><span class="sxs-lookup"><span data-stu-id="9eedb-178">If you have an object's PIDL, you may need a handle to one of the interfaces exposed by its parent folder.</span></span> <span data-ttu-id="9eedb-179">Por exemplo, se você quiser determinar o nome de exibição associado a um PIDL usando [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof), primeiro você deve recuperar a interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) do pai do objeto.</span><span class="sxs-lookup"><span data-stu-id="9eedb-179">For example, if you want to determine the display name associated with a PIDL by using [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof), you must first retrieve the [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface of the object's parent.</span></span> <span data-ttu-id="9eedb-180">É possível fazer isso com as técnicas discutidas nas seções anteriores.</span><span class="sxs-lookup"><span data-stu-id="9eedb-180">It is possible to do this with the techniques discussed in the previous sections.</span></span> <span data-ttu-id="9eedb-181">No entanto, uma abordagem muito mais simples é usar a função Shell, [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent).</span><span class="sxs-lookup"><span data-stu-id="9eedb-181">However, a much simpler approach is to use the Shell function, [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent).</span></span> <span data-ttu-id="9eedb-182">Essa função usa o PIDL totalmente qualificado de um objeto e retorna um ponteiro de interface especificado na pasta pai.</span><span class="sxs-lookup"><span data-stu-id="9eedb-182">This function takes the fully qualified PIDL of an object and returns a specified interface pointer on the parent folder.</span></span> <span data-ttu-id="9eedb-183">Opcionalmente, ele também retorna o PIDL de nível único do item para uso em métodos como [**IShellFolder:: GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span><span class="sxs-lookup"><span data-stu-id="9eedb-183">Optionally, it also returns the item's single-level PIDL for use in methods such as [**IShellFolder::GetAttributesOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getattributesof).</span></span>

<span data-ttu-id="9eedb-184">O exemplo de aplicativo de console a seguir recupera o PIDL da pasta especial do sistema e retorna seu nome de exibição.</span><span class="sxs-lookup"><span data-stu-id="9eedb-184">The following sample console application retrieves the PIDL of the System special folder and returns its display name.</span></span>


```
#include <shlobj.h>
#include <shlwapi.h>
#include <iostream.h>
#include <objbase.h>

int main()
{
    IShellFolder *psfParent = NULL;
    LPITEMIDLIST pidlSystem = NULL;
    LPCITEMIDLIST pidlRelative = NULL;
    STRRET strDispName;
    TCHAR szDisplayName[MAX_PATH];
    HRESULT hr;

    hr = SHGetFolderLocation(NULL, CSIDL_SYSTEM, NULL, NULL, &pidlSystem);

    hr = SHBindToParent(pidlSystem, IID_IShellFolder, (void **) &psfParent, &pidlRelative);

    if(SUCCEEDED(hr))
    {
        hr = psfParent->GetDisplayNameOf(pidlRelative, SHGDN_NORMAL, &strDispName);
        hr = StrRetToBuf(&strDispName, pidlSystem, szDisplayName, sizeof(szDisplayName));
        cout << "SHGDN_NORMAL - " <<szDisplayName << '\n';
    }

    psfParent->Release();
    CoTaskMemFree(pidlSystem);

    return 0;
}
```



<span data-ttu-id="9eedb-185">O aplicativo usa primeiro [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) para recuperar o PIDL da pasta do sistema.</span><span class="sxs-lookup"><span data-stu-id="9eedb-185">The application first uses [**SHGetFolderLocation**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetfolderlocation) to retrieve the System folder's PIDL.</span></span> <span data-ttu-id="9eedb-186">Em seguida, ele chama [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent), que retorna um ponteiro para a interface [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) da pasta pai e a PIDL da pasta do sistema em relação ao seu pai.</span><span class="sxs-lookup"><span data-stu-id="9eedb-186">It then calls [**SHBindToParent**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shbindtoparent), which returns a pointer to the parent folder's [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) interface, and the System folder's PIDL relative to its parent.</span></span> <span data-ttu-id="9eedb-187">Em seguida, ele usa o método [**IShellFolder:: GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) da pasta pai para recuperar o nome de exibição da pasta do sistema.</span><span class="sxs-lookup"><span data-stu-id="9eedb-187">It then uses the parent folder's [**IShellFolder::GetDisplayNameOf**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-getdisplaynameof) method to retrieve the display name of the System folder.</span></span> <span data-ttu-id="9eedb-188">Como **GetDisplayNameOf** retorna uma estrutura [**Strret**](/windows/desktop/api/Shtypes/ns-shtypes-strret) , [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa) é usado para converter o nome de exibição em uma cadeia de caracteres normal.</span><span class="sxs-lookup"><span data-stu-id="9eedb-188">Because **GetDisplayNameOf** returns a [**STRRET**](/windows/desktop/api/Shtypes/ns-shtypes-strret) structure, [**StrRetToBuf**](/windows/desktop/api/Shlwapi/nf-shlwapi-strrettobufa) is used to convert the display name into a normal string.</span></span> <span data-ttu-id="9eedb-189">Depois de exibir o nome de exibição, os ponteiros de interface são liberados e o sistema PIDL liberado.</span><span class="sxs-lookup"><span data-stu-id="9eedb-189">After displaying the display name, the interface pointers are released and the System PIDL freed.</span></span> <span data-ttu-id="9eedb-190">Observe que você não deve liberar o PIDL relativo retornado pelo **SHBindToParent**.</span><span class="sxs-lookup"><span data-stu-id="9eedb-190">Note that you must not free the relative PIDL returned by **SHBindToParent**.</span></span>

 

 
