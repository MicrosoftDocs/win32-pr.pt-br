---
description: Este tópico fornece um exame passo a passo dos requisitos para criar um arquivo DLL que implementa um manipulador a ser usado com a central de sincronização. Essas informações são válidas a partir do Windows Vista.
title: Desenvolvendo um manipulador da central de sincronização do Windows
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 66b40f81-9515-4190-8ced-44f20bb9df86
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 11185aa5976c27b7af95787b081e1eaacd99c8e9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104967962"
---
# <a name="developing-a-windows-sync-center-handler"></a><span data-ttu-id="ad47e-104">Desenvolvendo um manipulador da central de sincronização do Windows</span><span class="sxs-lookup"><span data-stu-id="ad47e-104">Developing a Windows Sync Center Handler</span></span>

<span data-ttu-id="ad47e-105">Este tópico fornece um exame passo a passo dos requisitos para criar um arquivo DLL que implementa um manipulador a ser usado com a central de sincronização.</span><span class="sxs-lookup"><span data-stu-id="ad47e-105">This topic provides a step-by-step examination of the requirements to build a DLL file that implements a handler to be used with Sync Center.</span></span> <span data-ttu-id="ad47e-106">Essas informações são válidas a partir do Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="ad47e-106">This information is valid as of Windows Vista.</span></span>

-   [<span data-ttu-id="ad47e-107">A experiência de sincronização do Windows antes do vista</span><span class="sxs-lookup"><span data-stu-id="ad47e-107">The Windows Synchronization Experience Before Vista</span></span>](#the-windows-synchronization-experience-before-vista)
-   [<span data-ttu-id="ad47e-108">APIs da central de sincronização</span><span class="sxs-lookup"><span data-stu-id="ad47e-108">Sync Center APIs</span></span>](#sync-center-apis)
    -   [<span data-ttu-id="ad47e-109">Interfaces essenciais</span><span class="sxs-lookup"><span data-stu-id="ad47e-109">Essential Interfaces</span></span>](#essential-interfaces)

## <a name="the-windows-synchronization-experience-before-vista"></a><span data-ttu-id="ad47e-110">A experiência de sincronização do Windows antes do vista</span><span class="sxs-lookup"><span data-stu-id="ad47e-110">The Windows Synchronization Experience Before Vista</span></span>

<span data-ttu-id="ad47e-111">O Windows XP fornecia um [Gerenciador de sincronização](syncmgr-start-page.md) (mobsync.exe).</span><span class="sxs-lookup"><span data-stu-id="ad47e-111">Windows XP provided a [Synchronization Manager](syncmgr-start-page.md) (mobsync.exe).</span></span> <span data-ttu-id="ad47e-112">Muitos dispositivos, como players de MP3, celulares e câmeras, também forneciam suas próprias interfaces de sincronização em vez de usar o Gerenciador de sincronização.</span><span class="sxs-lookup"><span data-stu-id="ad47e-112">Many devices such as mp3 players, cell phones, and cameras also provided their own synchronization interfaces rather than using the Synchronization Manager.</span></span> <span data-ttu-id="ad47e-113">Isso resultou em uma experiência de usuário inconsistente e não centralizada.</span><span class="sxs-lookup"><span data-stu-id="ad47e-113">This resulted in an inconsistent and noncentralized user experience.</span></span>

<span data-ttu-id="ad47e-114">O novo recurso da central de sincronização fornecido no Windows Vista tem várias vantagens em relação ao Gerenciador de sincronização mais antigo.</span><span class="sxs-lookup"><span data-stu-id="ad47e-114">The new Sync Center feature provided in Windows Vista has several advantages over the older Synchronization Manager.</span></span>

-   <span data-ttu-id="ad47e-115">Melhor descoberta</span><span class="sxs-lookup"><span data-stu-id="ad47e-115">Better discoverability</span></span>
-   <span data-ttu-id="ad47e-116">Menos necessidade de ação direta do usuário</span><span class="sxs-lookup"><span data-stu-id="ad47e-116">Less need for direct user action</span></span>
-   <span data-ttu-id="ad47e-117">Não bloqueia outras operações</span><span class="sxs-lookup"><span data-stu-id="ad47e-117">Does not block other operations</span></span>
-   <span data-ttu-id="ad47e-118">Melhor visualização do progresso da sincronização</span><span class="sxs-lookup"><span data-stu-id="ad47e-118">Better visualization of the synchronization progress</span></span>
-   <span data-ttu-id="ad47e-119">Mais fácil de entender o modelo de desenvolvimento</span><span class="sxs-lookup"><span data-stu-id="ad47e-119">Easier to understand development model</span></span>

## <a name="sync-center-apis"></a><span data-ttu-id="ad47e-120">APIs da central de sincronização</span><span class="sxs-lookup"><span data-stu-id="ad47e-120">Sync Center APIs</span></span>

<span data-ttu-id="ad47e-121">A central de sincronização se comunica com manipuladores por meio de várias interfaces de Component Object Model (COM).</span><span class="sxs-lookup"><span data-stu-id="ad47e-121">Sync Center communicates with handlers through a number of Component Object Model (COM) interfaces.</span></span> <span data-ttu-id="ad47e-122">Nem todas essas interfaces são necessárias para implementar um manipulador de central de sincronização.</span><span class="sxs-lookup"><span data-stu-id="ad47e-122">Not all of these interfaces are needed to implement a Sync Center handler.</span></span> <span data-ttu-id="ad47e-123">Este tópico foi dividido em duas seções.</span><span class="sxs-lookup"><span data-stu-id="ad47e-123">This topic has been broken into two sections.</span></span> <span data-ttu-id="ad47e-124">A primeira seção explica as interfaces COM essenciais que cada manipulador deve oferecer suporte e a segunda seção examina as interfaces COM opcionais e examina os motivos pelos quais um manipulador ofereceria suporte a elas.</span><span class="sxs-lookup"><span data-stu-id="ad47e-124">The first section explains the essential COM interfaces that every handler must support, and the second section examines the optional COM interfaces and looks at the reasons that a handler would support them.</span></span>

-   [<span data-ttu-id="ad47e-125">Interfaces essenciais</span><span class="sxs-lookup"><span data-stu-id="ad47e-125">Essential Interfaces</span></span>](#essential-interfaces)

### <a name="essential-interfaces"></a><span data-ttu-id="ad47e-126">Interfaces essenciais</span><span class="sxs-lookup"><span data-stu-id="ad47e-126">Essential Interfaces</span></span>

<span data-ttu-id="ad47e-127">Todos os manipuladores da central de sincronização devem dar suporte às seguintes interfaces:</span><span class="sxs-lookup"><span data-stu-id="ad47e-127">All Sync Center handlers must support the following interfaces:</span></span>

-   [<span data-ttu-id="ad47e-128">**ISyncMgrHandler**</span><span class="sxs-lookup"><span data-stu-id="ad47e-128">**ISyncMgrHandler**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandler)
-   [<span data-ttu-id="ad47e-129">**ISyncMgrHandlerInfo**</span><span class="sxs-lookup"><span data-stu-id="ad47e-129">**ISyncMgrHandlerInfo**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandlerinfo)
-   [<span data-ttu-id="ad47e-130">**ISyncMgrSyncItemContainer**</span><span class="sxs-lookup"><span data-stu-id="ad47e-130">**ISyncMgrSyncItemContainer**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitemcontainer)
-   [<span data-ttu-id="ad47e-131">**IEnumSyncMgrSyncItems**</span><span class="sxs-lookup"><span data-stu-id="ad47e-131">**IEnumSyncMgrSyncItems**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-ienumsyncmgrsyncitems)
-   [<span data-ttu-id="ad47e-132">**ISyncMgrSyncItem**</span><span class="sxs-lookup"><span data-stu-id="ad47e-132">**ISyncMgrSyncItem**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem)
-   [<span data-ttu-id="ad47e-133">**ISyncMgrSyncItemInfo**</span><span class="sxs-lookup"><span data-stu-id="ad47e-133">**ISyncMgrSyncItemInfo**</span></span>](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo)

<span data-ttu-id="ad47e-134">[**ISyncMgrSyncItem**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) e [**ISyncMgrSyncItemInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) são usados para descrever um único item de sincronização envolvido na sincronização para a central de sincronização.</span><span class="sxs-lookup"><span data-stu-id="ad47e-134">[**ISyncMgrSyncItem**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) and [**ISyncMgrSyncItemInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) are used to describe a single sync item involved in the synchronization to the Sync Center.</span></span> <span data-ttu-id="ad47e-135">Um item de sincronização geralmente representa um tipo de dados específico (como imagens) ou um local específico de dados.</span><span class="sxs-lookup"><span data-stu-id="ad47e-135">A sync item generally represents either a particular data type (such as images) or a particular location of data.</span></span>

<span data-ttu-id="ad47e-136">Os itens de sincronização que representam diferentes locais de dados permitem sincronizações muito específicas.</span><span class="sxs-lookup"><span data-stu-id="ad47e-136">Sync items that represent different data locations allow for very specific synchronizations.</span></span> <span data-ttu-id="ad47e-137">A granularidade do local é até o autor do manipulador, mas deve-se ter cuidado com o design.</span><span class="sxs-lookup"><span data-stu-id="ad47e-137">The granularity of the location is up to the handler author, but care should be taken in the design.</span></span> <span data-ttu-id="ad47e-138">Se houver poucos itens de sincronização (locais), o usuário será restrito em sua capacidade de sincronizar apenas determinados dados.</span><span class="sxs-lookup"><span data-stu-id="ad47e-138">If there are too few sync items (locations), then the user is restricted in their ability to sync only certain data.</span></span> <span data-ttu-id="ad47e-139">No outro extremo, muita granularidade pode se tornar não gerenciável.</span><span class="sxs-lookup"><span data-stu-id="ad47e-139">At the other extreme, too much granularity can become unmanageable.</span></span>

<span data-ttu-id="ad47e-140">Se um manipulador oferecer suporte a mais de um tipo de dados ou a vários locais de dados, ele precisará dar suporte a mais de um objeto de item de sincronização.</span><span class="sxs-lookup"><span data-stu-id="ad47e-140">If a handler supports more than one data type or multiple data locations, then it needs to support more than one sync item object.</span></span> <span data-ttu-id="ad47e-141">Um exemplo pode ser um PDA (Assistente de dados pessoais) que permite ao usuário sincronizar contatos, itens de calendário e documentos.</span><span class="sxs-lookup"><span data-stu-id="ad47e-141">An example might be a personal data assistant (PDA) that allows the user to sync contacts, calendar items and documents.</span></span> <span data-ttu-id="ad47e-142">Esses três tipos de dados precisariam ser representados por três objetos exclusivos que expõem as interfaces [**ISyncMgrSyncItem**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) e [**ISyncMgrSyncItemInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) .</span><span class="sxs-lookup"><span data-stu-id="ad47e-142">These three data types would need to be represented by three unique objects that each expose the [**ISyncMgrSyncItem**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitem) and [**ISyncMgrSyncItemInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsynciteminfo) interfaces.</span></span>

<span data-ttu-id="ad47e-143">A interface [**IEnumSyncMgrSyncItems**](/windows/desktop/api/Syncmgr/nn-syncmgr-ienumsyncmgrsyncitems) fornece um mecanismo para enumerar por meio de itens de sincronização de um manipulador.</span><span class="sxs-lookup"><span data-stu-id="ad47e-143">The [**IEnumSyncMgrSyncItems**](/windows/desktop/api/Syncmgr/nn-syncmgr-ienumsyncmgrsyncitems) interface provides a mechanism to enumerate through a handler's sync items.</span></span> <span data-ttu-id="ad47e-144">Para recuperar esse enumerador, a central de sincronização chama o método [**ISyncMgrSyncItemContainer:: GetSyncItemEnumerator**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemenumerator) exposto pelo manipulador.</span><span class="sxs-lookup"><span data-stu-id="ad47e-144">To retrieve this enumerator, Sync Center calls the [**ISyncMgrSyncItemContainer::GetSyncItemEnumerator**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemenumerator) method exposed by the handler.</span></span> <span data-ttu-id="ad47e-145">O [**ISyncMgrSyncItemContainer**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitemcontainer) também contém dois outros métodos que a central de sincronização pode usar para recuperar informações sobre os itens de sincronização do manipulador:</span><span class="sxs-lookup"><span data-stu-id="ad47e-145">[**ISyncMgrSyncItemContainer**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrsyncitemcontainer) also contains two other methods that the Sync Center can use to retrieve information about the handler's sync items:</span></span>

-   <span data-ttu-id="ad47e-146">[**GetSyncItem**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitem) retorna um item de sincronização específico.</span><span class="sxs-lookup"><span data-stu-id="ad47e-146">[**GetSyncItem**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitem) returns a specific sync item.</span></span>
-   <span data-ttu-id="ad47e-147">[**GetSyncItemCount**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemcount) retorna o número de itens de sincronização com suporte pelo manipulador.</span><span class="sxs-lookup"><span data-stu-id="ad47e-147">[**GetSyncItemCount**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrsyncitemcontainer-getsyncitemcount) returns the number of sync items supported by the handler.</span></span>

<span data-ttu-id="ad47e-148">[**ISyncMgrHandler**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandler) e [**ISyncMgrHandlerInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandlerinfo) são usados para descrever as propriedades do manipulador e iniciar a sincronização real.</span><span class="sxs-lookup"><span data-stu-id="ad47e-148">[**ISyncMgrHandler**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandler) and [**ISyncMgrHandlerInfo**](/windows/desktop/api/Syncmgr/nn-syncmgr-isyncmgrhandlerinfo) are used to describe the properties of the hander and launch the actual synchronization.</span></span> <span data-ttu-id="ad47e-149">[**ISyncMgrHandler:: Synchronize**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrhandler-synchronize) é onde o código do manipulador executa a sincronização e fornece comentários sobre o progresso e quaisquer problemas que ocorram.</span><span class="sxs-lookup"><span data-stu-id="ad47e-149">[**ISyncMgrHandler::Synchronize**](/windows/desktop/api/Syncmgr/nf-syncmgr-isyncmgrhandler-synchronize) is where the handler code carries out the synchronization and provides feedback on progress and any issues that occur.</span></span>

<span data-ttu-id="ad47e-150">Muitos dos métodos de interface não precisam ser totalmente implementados.</span><span class="sxs-lookup"><span data-stu-id="ad47e-150">Many of the interface methods do not need to be fully implemented.</span></span> <span data-ttu-id="ad47e-151">A central de sincronização fornece uma determinada quantidade de informações padrão.</span><span class="sxs-lookup"><span data-stu-id="ad47e-151">Sync Center provides a certain amount of default information.</span></span> <span data-ttu-id="ad47e-152">As interfaces permitem que um manipulador substitua essas informações e forneça informações personalizadas a serem exibidas, se necessário.</span><span class="sxs-lookup"><span data-stu-id="ad47e-152">The interfaces allow a handler to override this information and provide custom information to display, if needed.</span></span>

 

 



