---
description: Os recursos do Shell podem ser estendidos com entradas de registro e arquivos. ini.
ms.assetid: 74a81e4f-7357-4901-a118-ba44e8892f25
title: Criar Manipuladores de Extensão de Shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 991f3c1684b7491e2ad29fae29f48164ffdd47cb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104988988"
---
# <a name="creating-shell-extension-handlers"></a><span data-ttu-id="e70ed-103">Criar Manipuladores de Extensão de Shell</span><span class="sxs-lookup"><span data-stu-id="e70ed-103">Creating Shell Extension Handlers</span></span>

<span data-ttu-id="e70ed-104">Os recursos do Shell podem ser estendidos com entradas de registro e arquivos. ini.</span><span class="sxs-lookup"><span data-stu-id="e70ed-104">The capabilities of the Shell can be extended with registry entries and .ini files.</span></span> <span data-ttu-id="e70ed-105">Embora essa abordagem para estender o shell seja simples e adequada para muitas finalidades, ela é limitada.</span><span class="sxs-lookup"><span data-stu-id="e70ed-105">While this approach to extending the Shell is simple, and adequate for many purposes, it is limited.</span></span> <span data-ttu-id="e70ed-106">Por exemplo, se você usar o registro para especificar um ícone personalizado para um tipo de arquivo, o mesmo ícone será exibido para cada arquivo desse tipo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-106">For example, if you use the registry to specify a custom icon for a file type, the same icon will appear for every file of that type.</span></span> <span data-ttu-id="e70ed-107">Estender o shell com o registro não permite que você varie o ícone para arquivos diferentes do mesmo tipo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-107">Extending the Shell with the registry does not allow you to vary the icon for different files of the same type.</span></span> <span data-ttu-id="e70ed-108">Outros aspectos do Shell, como a folha de propriedades **Propriedades** que podem ser exibidas quando um arquivo é clicado com o botão direito do mouse, não podem ser modificados com o registro.</span><span class="sxs-lookup"><span data-stu-id="e70ed-108">Other aspects of the Shell, such as the **Properties** property sheet that can be displayed when a file is right-clicked, cannot be modified at all with the registry.</span></span>

<span data-ttu-id="e70ed-109">Uma abordagem mais poderosa e flexível para estender o Shell é implementar *manipuladores de extensão de shell*.</span><span class="sxs-lookup"><span data-stu-id="e70ed-109">A more powerful and flexible approach to extending the Shell is to implement *shell extension handlers*.</span></span> <span data-ttu-id="e70ed-110">Esses manipuladores podem ser implementados para uma variedade de ações que o Shell pode executar.</span><span class="sxs-lookup"><span data-stu-id="e70ed-110">These handlers can be implemented for a variety of actions that the Shell can perform.</span></span> <span data-ttu-id="e70ed-111">Antes de executar a ação, o Shell consulta o manipulador de extensão, dando a ele a oportunidade de modificar a ação.</span><span class="sxs-lookup"><span data-stu-id="e70ed-111">Before taking the action, the Shell queries the extension handler, giving it the opportunity to modify the action.</span></span> <span data-ttu-id="e70ed-112">Um exemplo comum é um manipulador de extensão de menu de atalho.</span><span class="sxs-lookup"><span data-stu-id="e70ed-112">A common example is a shortcut menu extension handler.</span></span> <span data-ttu-id="e70ed-113">Se um for implementado para um tipo de arquivo, ele será consultado toda vez que um dos arquivos for clicado com o botão direito do mouse.</span><span class="sxs-lookup"><span data-stu-id="e70ed-113">If one is implemented for a file type, it will be queried every time one of the files is right-clicked.</span></span> <span data-ttu-id="e70ed-114">O manipulador pode, então, especificar itens de menu adicionais de acordo com o arquivo, em vez de ter o mesmo conjunto para todo o tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-114">The handler can then specify additional menu items on a file-by-file basis, rather than having the same set for the entire file type.</span></span>

<span data-ttu-id="e70ed-115">Este documento discute como implementar os manipuladores de extensão que permitem modificar uma variedade de ações de Shell.</span><span class="sxs-lookup"><span data-stu-id="e70ed-115">This document discusses how to implement the extension handlers that allow you to modify a variety of Shell actions.</span></span> <span data-ttu-id="e70ed-116">Os seguintes manipuladores estão associados a um tipo de arquivo específico e permitem que você especifique em uma base arquivo por arquivo:</span><span class="sxs-lookup"><span data-stu-id="e70ed-116">The following handlers are associated with a particular file type and allow you to specify on a file-by-file basis:</span></span>



| <span data-ttu-id="e70ed-117">Manipulador</span><span class="sxs-lookup"><span data-stu-id="e70ed-117">Handler</span></span>                                               | <span data-ttu-id="e70ed-118">Descrição</span><span class="sxs-lookup"><span data-stu-id="e70ed-118">Description</span></span>                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="e70ed-119">Manipulador de menu de atalho</span><span class="sxs-lookup"><span data-stu-id="e70ed-119">Shortcut menu handler</span></span>](context-menu-handlers.md)    | <span data-ttu-id="e70ed-120">Chamado antes de o menu de atalho de um arquivo ser exibido.</span><span class="sxs-lookup"><span data-stu-id="e70ed-120">Called before a file's shortcut menu is displayed.</span></span> <span data-ttu-id="e70ed-121">Ele permite que você adicione itens ao menu de atalho de acordo com o arquivo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-121">It enables you to add items to the shortcut menu on a file-by-file basis.</span></span>                                               |
| [<span data-ttu-id="e70ed-122">Manipulador de dados</span><span class="sxs-lookup"><span data-stu-id="e70ed-122">Data handler</span></span>](how-to-create-data-handlers.md)       | <span data-ttu-id="e70ed-123">Chamado quando uma operação de arrastar e soltar é executada em objetos dragShell.</span><span class="sxs-lookup"><span data-stu-id="e70ed-123">Called when a drag-and-drop operation is performed on dragShell objects.</span></span> <span data-ttu-id="e70ed-124">Ele permite que você forneça formatos de área de transferência adicionais para o destino de soltar.</span><span class="sxs-lookup"><span data-stu-id="e70ed-124">It enables you to provide additional clipboard formats to the drop target.</span></span>                        |
| [<span data-ttu-id="e70ed-125">Descartar manipulador</span><span class="sxs-lookup"><span data-stu-id="e70ed-125">Drop handler</span></span>](how-to-create-drop-handlers.md)       | <span data-ttu-id="e70ed-126">Chamado quando um objeto de dados é arrastado ou solto em um arquivo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-126">Called when a data object is dragged over or dropped on a file.</span></span> <span data-ttu-id="e70ed-127">Ele permite que você faça um arquivo em um destino de soltura.</span><span class="sxs-lookup"><span data-stu-id="e70ed-127">It enables you to make a file into a drop target.</span></span>                                                          |
| [<span data-ttu-id="e70ed-128">Manipulador de ícone</span><span class="sxs-lookup"><span data-stu-id="e70ed-128">Icon handler</span></span>](how-to-create-icon-handlers.md)       | <span data-ttu-id="e70ed-129">Chamado antes do ícone de um arquivo ser exibido.</span><span class="sxs-lookup"><span data-stu-id="e70ed-129">Called before a file's icon is displayed.</span></span> <span data-ttu-id="e70ed-130">Ele permite que você substitua o ícone padrão do arquivo por um ícone personalizado em cada arquivo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-130">It enables you to replace the file's default icon with a custom icon on a file-by-file basis.</span></span>                                    |
| [<span data-ttu-id="e70ed-131">Manipulador de folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="e70ed-131">Property sheet handler</span></span>](propsheet-handlers.md)      | <span data-ttu-id="e70ed-132">Chamado antes da exibição da folha de propriedades de **Propriedades** de um objeto.</span><span class="sxs-lookup"><span data-stu-id="e70ed-132">Called before an object's **Properties** property sheet is displayed.</span></span> <span data-ttu-id="e70ed-133">Ele permite que você adicione ou substitua páginas.</span><span class="sxs-lookup"><span data-stu-id="e70ed-133">It enables you to add or replace pages.</span></span>                                                              |
| [<span data-ttu-id="e70ed-134">**Manipulador de imagem em miniatura**</span><span class="sxs-lookup"><span data-stu-id="e70ed-134">**Thumbnail Image handler**</span></span>](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | <span data-ttu-id="e70ed-135">Fornece uma imagem para representar o item.</span><span class="sxs-lookup"><span data-stu-id="e70ed-135">Provides an image to represent the item.</span></span>                                                                                                                                   |
| [<span data-ttu-id="e70ed-136">**Manipulador de infodicas**</span><span class="sxs-lookup"><span data-stu-id="e70ed-136">**Infotip handler**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | <span data-ttu-id="e70ed-137">Fornece texto pop-up quando o usuário passa o ponteiro do mouse sobre o objeto.</span><span class="sxs-lookup"><span data-stu-id="e70ed-137">Provides pop-up text when the user hovers the mouse pointer over the object.</span></span>                                                                                               |
| [<span data-ttu-id="e70ed-138">**Manipulador de metadados**</span><span class="sxs-lookup"><span data-stu-id="e70ed-138">**Metadata handler**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore)     | <span data-ttu-id="e70ed-139">Fornece acesso de leitura e gravação a metadados (Propriedades) armazenados em um arquivo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-139">Provides read and write access to metadata (properties) stored in a file.</span></span> <span data-ttu-id="e70ed-140">Isso pode ser usado para estender a exibição de detalhes, infotips, a página de propriedades e agrupar recursos.</span><span class="sxs-lookup"><span data-stu-id="e70ed-140">This can be used to extend the Details view, infotips, the property page, and grouping features.</span></span> |



 

<span data-ttu-id="e70ed-141">Outros manipuladores não estão associados a um tipo de arquivo específico, mas são chamados antes de algumas operações de Shell:</span><span class="sxs-lookup"><span data-stu-id="e70ed-141">Other handlers are not associated with a particular file type but are called before some Shell operations:</span></span>



| <span data-ttu-id="e70ed-142">Manipulador</span><span class="sxs-lookup"><span data-stu-id="e70ed-142">Handler</span></span>                                                            | <span data-ttu-id="e70ed-143">Descrição</span><span class="sxs-lookup"><span data-stu-id="e70ed-143">Description</span></span>                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="e70ed-144">Manipulador de coluna</span><span class="sxs-lookup"><span data-stu-id="e70ed-144">Column handler</span></span>](../lwef/column-handlers.md)                             | <span data-ttu-id="e70ed-145">Chamado pelo Windows Explorer antes de exibir a exibição de detalhes de uma pasta.</span><span class="sxs-lookup"><span data-stu-id="e70ed-145">Called by Windows Explorer before it displays the Details view of a folder.</span></span> <span data-ttu-id="e70ed-146">Ele permite que você adicione colunas personalizadas à exibição de detalhes.</span><span class="sxs-lookup"><span data-stu-id="e70ed-146">It enables you to add custom columns to the Details view.</span></span>        |
| [<span data-ttu-id="e70ed-147">Copiar manipulador de gancho</span><span class="sxs-lookup"><span data-stu-id="e70ed-147">Copy hook handler</span></span>](how-to-create-copy-hook-handlers.md)          | <span data-ttu-id="e70ed-148">Chamado quando um objeto de pasta ou de impressora está prestes a ser movido, copiado, excluído ou renomeado.</span><span class="sxs-lookup"><span data-stu-id="e70ed-148">Called when a folder or printer object is about to be moved, copied, deleted, or renamed.</span></span> <span data-ttu-id="e70ed-149">Ele permite que você aprove ou veta a operação.</span><span class="sxs-lookup"><span data-stu-id="e70ed-149">It enables you to approve or veto the operation.</span></span>   |
| [<span data-ttu-id="e70ed-150">Manipulador do tipo "arrastar e soltar"</span><span class="sxs-lookup"><span data-stu-id="e70ed-150">Drag-and-drop handler</span></span>](context-menu-handlers.md)                 | <span data-ttu-id="e70ed-151">Chamado quando um arquivo é arrastado com o botão direito do mouse.</span><span class="sxs-lookup"><span data-stu-id="e70ed-151">Called when a file is dragged with the right mouse button.</span></span> <span data-ttu-id="e70ed-152">Ele permite que você modifique o menu de atalho que é exibido.</span><span class="sxs-lookup"><span data-stu-id="e70ed-152">It enables you to modify the shortcut menu that is displayed.</span></span>                     |
| [<span data-ttu-id="e70ed-153">Manipulador de sobreposição de ícone</span><span class="sxs-lookup"><span data-stu-id="e70ed-153">Icon Overlay handler</span></span>](how-to-implement-icon-overlay-handlers.md) | <span data-ttu-id="e70ed-154">Chamado antes do ícone de um arquivo ser exibido.</span><span class="sxs-lookup"><span data-stu-id="e70ed-154">Called before a file's icon is displayed.</span></span> <span data-ttu-id="e70ed-155">Ele permite que você especifique uma sobreposição para o ícone do arquivo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-155">It enables you to specify an overlay for the file's icon.</span></span>                                          |
| [<span data-ttu-id="e70ed-156">Manipulador de pesquisa</span><span class="sxs-lookup"><span data-stu-id="e70ed-156">Search handler</span></span>](../lwef/search-handlers.md)                             | <span data-ttu-id="e70ed-157">Chamado para iniciar um mecanismo de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="e70ed-157">Called to launch a search engine.</span></span> <span data-ttu-id="e70ed-158">Ele permite que você implemente um mecanismo de pesquisa personalizado acessível no menu **Iniciar** ou no Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="e70ed-158">It enables you to implement a custom search engine accessible from the **Start** menu or Windows Explorer.</span></span> |



 

<span data-ttu-id="e70ed-159">Os detalhes de como implementar manipuladores de extensão específicos são abordados nas seções listadas acima.</span><span class="sxs-lookup"><span data-stu-id="e70ed-159">The details of how to implement specific extension handlers are covered in the sections listed above.</span></span> <span data-ttu-id="e70ed-160">O restante deste documento aborda alguns problemas de implementação que são comuns a todos os manipuladores de extensão do Shell.</span><span class="sxs-lookup"><span data-stu-id="e70ed-160">The remainder of this document covers some implementation issues that are common to all Shell extension handlers.</span></span>

-   [<span data-ttu-id="e70ed-161">Implementando manipuladores de extensão de Shell</span><span class="sxs-lookup"><span data-stu-id="e70ed-161">Implementing Shell Extension Handlers</span></span>](#implementing-shell-extension-handlers)
    -   [<span data-ttu-id="e70ed-162">Implementando IPersistFile</span><span class="sxs-lookup"><span data-stu-id="e70ed-162">Implementing IPersistFile</span></span>](#implementing-ipersistfile)
    -   [<span data-ttu-id="e70ed-163">Implementando IShellExtInit</span><span class="sxs-lookup"><span data-stu-id="e70ed-163">Implementing IShellExtInit</span></span>](#implementing-ishellextinit)
    -   [<span data-ttu-id="e70ed-164">Personalização de InfoTip</span><span class="sxs-lookup"><span data-stu-id="e70ed-164">Infotip Customization</span></span>](#infotip-customization)
-   [<span data-ttu-id="e70ed-165">Aprimorando o Windows Search com manipuladores de extensão de Shell</span><span class="sxs-lookup"><span data-stu-id="e70ed-165">Enhancing Windows Search with Shell Extension Handlers</span></span>](#enhancing-windows-search-with-shell-extension-handlers)
-   [<span data-ttu-id="e70ed-166">Registrando manipuladores de extensão do Shell</span><span class="sxs-lookup"><span data-stu-id="e70ed-166">Registering Shell Extension Handlers</span></span>](#registering-shell-extension-handlers)
    -   [<span data-ttu-id="e70ed-167">Nomes de manipuladores</span><span class="sxs-lookup"><span data-stu-id="e70ed-167">Handler Names</span></span>](#handler-names)
    -   [<span data-ttu-id="e70ed-168">Objetos de shell predefinidos</span><span class="sxs-lookup"><span data-stu-id="e70ed-168">Predefined Shell Objects</span></span>](#predefined-shell-objects)
    -   [<span data-ttu-id="e70ed-169">Exemplo de um registro de manipulador de extensão</span><span class="sxs-lookup"><span data-stu-id="e70ed-169">Example of an Extension Handler Registration</span></span>](#example-of-an-extension-handler-registration)
-   [<span data-ttu-id="e70ed-170">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="e70ed-170">Related topics</span></span>](#related-topics)

## <a name="implementing-shell-extension-handlers"></a><span data-ttu-id="e70ed-171">Implementando manipuladores de extensão de Shell</span><span class="sxs-lookup"><span data-stu-id="e70ed-171">Implementing Shell Extension Handlers</span></span>

<span data-ttu-id="e70ed-172">Grande parte da implementação de um objeto de manipulador de extensão de shell depende de seu tipo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-172">Much of the implementation of a Shell extension handler object depends on its type.</span></span> <span data-ttu-id="e70ed-173">No entanto, há alguns elementos comuns.</span><span class="sxs-lookup"><span data-stu-id="e70ed-173">There are, however, some common elements.</span></span> <span data-ttu-id="e70ed-174">Esta seção aborda esses aspectos da implementação que são compartilhados por todos os manipuladores de extensão do Shell.</span><span class="sxs-lookup"><span data-stu-id="e70ed-174">This section discusses those aspects of implementation that are shared by all Shell extension handlers.</span></span>

<span data-ttu-id="e70ed-175">Muitos manipuladores de extensão de shell são objetos COM (Component Object Model) em processo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-175">Many Shell extension handlers are in-process Component Object Model (COM) objects.</span></span> <span data-ttu-id="e70ed-176">Eles devem ser atribuídos a um GUID e registrados conforme descrito em Registrando manipuladores de extensão do Shell.</span><span class="sxs-lookup"><span data-stu-id="e70ed-176">They must be assigned a GUID and registered as described in Registering Shell Extension Handlers.</span></span> <span data-ttu-id="e70ed-177">Eles são implementados como DLLs e devem exportar as seguintes funções padrão:</span><span class="sxs-lookup"><span data-stu-id="e70ed-177">They are implemented as DLLs and must export the following standard functions:</span></span>

-   <span data-ttu-id="e70ed-178">[**DllMain**](../dlls/dllmain.md).</span><span class="sxs-lookup"><span data-stu-id="e70ed-178">[**DllMain**](../dlls/dllmain.md).</span></span> <span data-ttu-id="e70ed-179">O ponto de entrada padrão para a DLL.</span><span class="sxs-lookup"><span data-stu-id="e70ed-179">The standard entry point to the DLL.</span></span>
-   <span data-ttu-id="e70ed-180">[**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject).</span><span class="sxs-lookup"><span data-stu-id="e70ed-180">[**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject).</span></span> <span data-ttu-id="e70ed-181">Expõe a fábrica de classes do objeto.</span><span class="sxs-lookup"><span data-stu-id="e70ed-181">Exposes the object's class factory.</span></span>
-   <span data-ttu-id="e70ed-182">[**DllCanUnloadNow**](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow).</span><span class="sxs-lookup"><span data-stu-id="e70ed-182">[**DllCanUnloadNow**](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow).</span></span> <span data-ttu-id="e70ed-183">COM chama essa função para determinar se o objeto está atendendo a clientes.</span><span class="sxs-lookup"><span data-stu-id="e70ed-183">COM calls this function to determine whether the object is serving any clients.</span></span> <span data-ttu-id="e70ed-184">Caso contrário, o sistema pode descarregar a DLL e liberar a memória associada.</span><span class="sxs-lookup"><span data-stu-id="e70ed-184">If not, the system can unload the DLL and free the associated memory.</span></span>

<span data-ttu-id="e70ed-185">Como todos os objetos COM, os manipuladores de extensão do Shell devem implementar uma interface [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) e uma [fábrica de classes](../com/implementing-iclassfactory.md).</span><span class="sxs-lookup"><span data-stu-id="e70ed-185">Like all COM objects, Shell extension handlers must implement an [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface and a [class factory](../com/implementing-iclassfactory.md).</span></span> <span data-ttu-id="e70ed-186">A maioria dos manipuladores de extensão também deve implementar uma interface [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) ou [**ISHELLEXTINIT**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) no Windows XP ou anterior.</span><span class="sxs-lookup"><span data-stu-id="e70ed-186">Most extension handlers must also implement either an [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) or [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface in Windows XP or earlier.</span></span> <span data-ttu-id="e70ed-187">Elas foram substituídas por [**IInitializeWithStream**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) e [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile) no Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="e70ed-187">These were replaced by [**IInitializeWithStream**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) and [**IInitializeWithFile**](/windows/desktop/api/Propsys/nn-propsys-iinitializewithfile) in Windows Vista.</span></span> <span data-ttu-id="e70ed-188">O Shell usa essas interfaces para inicializar o manipulador.</span><span class="sxs-lookup"><span data-stu-id="e70ed-188">The Shell uses these interfaces to initialize the handler.</span></span>

<span data-ttu-id="e70ed-189">A interface [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) deve ser implementada pelo seguinte:</span><span class="sxs-lookup"><span data-stu-id="e70ed-189">The [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface must be implemented by the following:</span></span>

-   <span data-ttu-id="e70ed-190">Manipuladores de dados</span><span class="sxs-lookup"><span data-stu-id="e70ed-190">Data handlers</span></span>
-   <span data-ttu-id="e70ed-191">Descartar manipuladores</span><span class="sxs-lookup"><span data-stu-id="e70ed-191">Drop handlers</span></span>

<span data-ttu-id="e70ed-192">No passado, os manipuladores de ícones também eram obrigados a implementar [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), mas isso não é mais verdade.</span><span class="sxs-lookup"><span data-stu-id="e70ed-192">In the past, icon handlers were also required to implement [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), but this is no longer true.</span></span> <span data-ttu-id="e70ed-193">Para manipuladores de ícones, **IPersistFile** agora é opcional e outras interfaces, como [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) , são preferenciais.</span><span class="sxs-lookup"><span data-stu-id="e70ed-193">For icon handlers, **IPersistFile** is now optional and other interfaces such as [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem) are preferred.</span></span>

<span data-ttu-id="e70ed-194">A interface [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) deve ser implementada pelo seguinte:</span><span class="sxs-lookup"><span data-stu-id="e70ed-194">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface must be implemented by the following:</span></span>

-   <span data-ttu-id="e70ed-195">Manipuladores de menu de atalho</span><span class="sxs-lookup"><span data-stu-id="e70ed-195">Shortcut menu handlers</span></span>
-   <span data-ttu-id="e70ed-196">Manipuladores de arrastar e soltar</span><span class="sxs-lookup"><span data-stu-id="e70ed-196">Drag-and-drop handlers</span></span>
-   <span data-ttu-id="e70ed-197">Manipuladores de folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="e70ed-197">Property sheet handlers</span></span>

### <a name="implementing-ipersistfile"></a><span data-ttu-id="e70ed-198">Implementando IPersistFile</span><span class="sxs-lookup"><span data-stu-id="e70ed-198">Implementing IPersistFile</span></span>

<span data-ttu-id="e70ed-199">A interface [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) destina-se a permitir que um objeto seja carregado ou salvo em um arquivo de disco.</span><span class="sxs-lookup"><span data-stu-id="e70ed-199">The [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) interface is intended to permit an object to be loaded from or saved to a disk file.</span></span> <span data-ttu-id="e70ed-200">Ele tem seis métodos além de [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), cinco de sua própria e o método [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) que ele herda de [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist).</span><span class="sxs-lookup"><span data-stu-id="e70ed-200">It has six methods in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), five of its own, and the [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) method that it inherits from [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist).</span></span> <span data-ttu-id="e70ed-201">Com extensões de Shell, **IPersist** é usado apenas para inicializar um objeto de manipulador de extensão de Shell.</span><span class="sxs-lookup"><span data-stu-id="e70ed-201">With Shell extensions, **IPersist** is used only to initialize a Shell extension handler object.</span></span> <span data-ttu-id="e70ed-202">Como normalmente não há necessidade de ler ou gravar no disco, somente os métodos **GetClassID** e [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) exigem uma implementação sem token.</span><span class="sxs-lookup"><span data-stu-id="e70ed-202">Because there is typically no need to read from or write to the disk, only the **GetClassID** and [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) methods require a nontoken implementation.</span></span>

<span data-ttu-id="e70ed-203">O Shell chama [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) primeiro e a função retorna o identificador de classe (CLSID) do objeto do manipulador de extensão.</span><span class="sxs-lookup"><span data-stu-id="e70ed-203">The Shell calls [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) first, and the function returns the class identifier (CLSID) of the extension handler object.</span></span> <span data-ttu-id="e70ed-204">Em seguida, o Shell chama [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) e passa em dois valores.</span><span class="sxs-lookup"><span data-stu-id="e70ed-204">The Shell then calls [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) and passes in two values.</span></span> <span data-ttu-id="e70ed-205">O primeiro, *pszFileName*, é uma cadeia de caracteres Unicode com o nome do arquivo ou da pasta em que o Shell está prestes a operar.</span><span class="sxs-lookup"><span data-stu-id="e70ed-205">The first, *pszFileName*, is a Unicode string with the name of the file or folder that Shell is about to operate on.</span></span> <span data-ttu-id="e70ed-206">O segundo é *dwMode*, que indica o modo de acesso do arquivo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-206">The second is *dwMode*, which indicates the file access mode.</span></span> <span data-ttu-id="e70ed-207">Como normalmente não há necessidade de acessar arquivos, o *dwMode* geralmente é zero.</span><span class="sxs-lookup"><span data-stu-id="e70ed-207">Because there is typically no need to access files, *dwMode* is usually zero.</span></span> <span data-ttu-id="e70ed-208">O método armazena esses valores conforme necessário para referência posterior.</span><span class="sxs-lookup"><span data-stu-id="e70ed-208">The method stores these values as needed for later reference.</span></span>

<span data-ttu-id="e70ed-209">O fragmento de código a seguir ilustra como um manipulador de extensão de shell típico implementa os métodos [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) e [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) .</span><span class="sxs-lookup"><span data-stu-id="e70ed-209">The following code fragment illustrates how a typical Shell extension handler implements the [**GetClassID**](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) and [**Load**](/windows/win32/api/objidl/nf-objidl-ipersistfile-load) methods.</span></span> <span data-ttu-id="e70ed-210">Ele foi projetado para lidar com ANSI ou Unicode.</span><span class="sxs-lookup"><span data-stu-id="e70ed-210">It is designed to handle either ANSI or Unicode.</span></span> <span data-ttu-id="e70ed-211">CLSID \_ SampleExtHandler é o GUID do objeto do manipulador de extensão e CSampleExtHandler é o nome da classe usada para implementar a interface.</span><span class="sxs-lookup"><span data-stu-id="e70ed-211">CLSID\_SampleExtHandler is the extension handler object's GUID, and CSampleExtHandler is the name of the class used to implement the interface.</span></span> <span data-ttu-id="e70ed-212">As variáveis **m \_ szFileName** e **m \_ dwMode** são variáveis privadas que são usadas para armazenar o nome do arquivo e os sinalizadores de acesso.</span><span class="sxs-lookup"><span data-stu-id="e70ed-212">The **m\_szFileName** and **m\_dwMode** variables are private variables that are used to store the file's name and access flags.</span></span>


```C++
wchar_t m_szFileName[MAX_PATH];    // The file name
DWORD m_dwMode;                  // The file access mode

CSampleExtHandler::GetClassID(CLSID *pCLSID)
{
    *pCLSID = CLSID_SampleExtHandler;
}

CSampleExtHandler::Load(PCWSTR pszFile, DWORD dwMode)
{
    m_dwMode = dwMode;
    return StringCchCopy(_szFileName, ARRAYSIZE(m_szFileName), pszFile);
}
```

### <a name="implementing-ishellextinit"></a><span data-ttu-id="e70ed-213">Implementando IShellExtInit</span><span class="sxs-lookup"><span data-stu-id="e70ed-213">Implementing IShellExtInit</span></span>

<span data-ttu-id="e70ed-214">A interface [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) tem apenas um método, [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), além de [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="e70ed-214">The [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface has only one method, [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), in addition to [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span> <span data-ttu-id="e70ed-215">O método tem três parâmetros que o Shell pode usar para passar vários tipos de informações.</span><span class="sxs-lookup"><span data-stu-id="e70ed-215">The method has three parameters that the Shell can use to pass in various types of information.</span></span> <span data-ttu-id="e70ed-216">Os valores passados dependem do tipo de manipulador e alguns podem ser definidos como **NULL**.</span><span class="sxs-lookup"><span data-stu-id="e70ed-216">The values passed in depend on the type of handler, and some can be set to **NULL**.</span></span>

-   <span data-ttu-id="e70ed-217">*pIDFolder* mantém o ponteiro de uma pasta para uma lista de identificadores de item (PIDL).</span><span class="sxs-lookup"><span data-stu-id="e70ed-217">*pIDFolder* holds a folder's pointer to an item identifier list (PIDL).</span></span> <span data-ttu-id="e70ed-218">Para extensões de folha de propriedades, é **nulo**.</span><span class="sxs-lookup"><span data-stu-id="e70ed-218">For property sheet extensions, it is **NULL**.</span></span> <span data-ttu-id="e70ed-219">Para extensões de menu de atalho, é o PIDL da pasta que contém o item cujo menu de atalho está sendo exibido.</span><span class="sxs-lookup"><span data-stu-id="e70ed-219">For shortcut menu extensions, it is the PIDL of the folder that contains the item whose shortcut menu is being displayed.</span></span> <span data-ttu-id="e70ed-220">Para manipuladores do tipo "arrastar e soltar" não padrão, é o PIDL da pasta de destino.</span><span class="sxs-lookup"><span data-stu-id="e70ed-220">For nondefault drag-and-drop handlers, it is the PIDL of the target folder.</span></span>
-   <span data-ttu-id="e70ed-221">*pDataObject* mantém um ponteiro para a interface [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) de um objeto de dados.</span><span class="sxs-lookup"><span data-stu-id="e70ed-221">*pDataObject* holds a pointer to a data object's [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) interface.</span></span> <span data-ttu-id="e70ed-222">O objeto de dados contém um ou mais nomes de arquivo no formato [CF \_ HDROP](dragdrop.md) .</span><span class="sxs-lookup"><span data-stu-id="e70ed-222">The data object holds one or more file names in [CF\_HDROP](dragdrop.md) format.</span></span>
-   <span data-ttu-id="e70ed-223">*hRegKey* mantém uma chave do registro para o tipo de objeto ou pasta de arquivo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-223">*hRegKey* holds a registry key for the file object or folder type.</span></span>

<span data-ttu-id="e70ed-224">O método [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) armazena o nome do arquivo, o ponteiro do [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) e a chave do registro conforme necessário para uso posterior.</span><span class="sxs-lookup"><span data-stu-id="e70ed-224">The [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method stores the file name, [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) pointer, and registry key as needed for later use.</span></span> <span data-ttu-id="e70ed-225">O fragmento de código a seguir ilustra uma implementação de **IShellExtInit:: Initialize**.</span><span class="sxs-lookup"><span data-stu-id="e70ed-225">The following code fragment illustrates an implementation of **IShellExtInit::Initialize**.</span></span> <span data-ttu-id="e70ed-226">Para simplificar, este exemplo supõe que o objeto de dados contenha apenas um único arquivo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-226">For simplicity, this example assumes that the data object contains only a single file.</span></span> <span data-ttu-id="e70ed-227">Em geral, ele pode conter vários arquivos que precisarão ser extraídos.</span><span class="sxs-lookup"><span data-stu-id="e70ed-227">In general, it might contain multiple files that will each need to be extracted.</span></span>


```C++
LPCITEMIDLIST  m_pIDFolder;           //The folder's PIDL
wchar_t        m_szFile[MAX_PATH];    //The file name
IDataObject   *m_pDataObj;            //The IDataObject pointer
HKEY           m_hRegKey;             //The file or folder's registry key

STDMETHODIMP CShellExt::Initialize(LPCITEMIDLIST pIDFolder, 
                                   IDataObject *pDataObj, 
                                   HKEY hRegKey) 
{ 
    // If Initialize has already been called, release the old PIDL
    ILFree(m_pIDFolder);
    m_pIDFolder = nullptr;

    // Store the new PIDL.
    if (pIDFolder)
    {
        m_pIDFolder = ILClone(pIDFolder);
    }
    
    // If Initialize has already been called, release the old
    // IDataObject pointer.
    if (m_pDataObj)
    { 
        m_pDataObj->Release(); 
    }
     
    // If a data object pointer was passed in, save it and
    // extract the file name. 
    if (pDataObj) 
    { 
        m_pDataObj = pDataObj; 
        pDataObj->AddRef(); 
      
        STGMEDIUM   medium;
        FORMATETC   fe = {CF_HDROP, NULL, DVASPECT_CONTENT, -1, TYMED_HGLOBAL};
        UINT        uCount;

        if (SUCCEEDED(m_pDataObj->GetData(&fe, &medium)))
        {
            // Get the count of files dropped.
            uCount = DragQueryFile((HDROP)medium.hGlobal, (UINT)-1, NULL, 0);

            // Get the first file name from the CF_HDROP.
            if (uCount)
                DragQueryFile((HDROP)medium.hGlobal, 0, m_szFile, 
                              sizeof(m_szFile)/sizeof(TCHAR));

            ReleaseStgMedium(&medium);
        }
    }

    // Duplicate the registry handle. 
    if (hRegKey) 
        RegOpenKeyEx(hRegKey, nullptr, 0L, MAXIMUM_ALLOWED, &m_hRegKey); 
    return S_OK; 
}
```

<span data-ttu-id="e70ed-228">CSampleExtHandler é o nome da classe usada para implementar a interface.</span><span class="sxs-lookup"><span data-stu-id="e70ed-228">CSampleExtHandler is the name of the class used to implement the interface.</span></span> <span data-ttu-id="e70ed-229">As **variáveis \_ m pIDFolder**, **m \_ pDataObject**, **m \_ szFileName** e **m \_ hRegKey** são variáveis privadas usadas para armazenar as informações que são passadas.</span><span class="sxs-lookup"><span data-stu-id="e70ed-229">The **m\_pIDFolder**, **m\_pDataObject**, **m\_szFileName**, and **m\_hRegKey** variables are private variables used to store the information that is passed in.</span></span> <span data-ttu-id="e70ed-230">Para simplificar, este exemplo supõe que apenas um nome de arquivo será mantido pelo objeto de dados.</span><span class="sxs-lookup"><span data-stu-id="e70ed-230">For simplicity, this example assumes that only one file name will be held by the data object.</span></span> <span data-ttu-id="e70ed-231">Depois que a estrutura [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) é recuperada do objeto de dados, [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) é usado para extrair o nome do arquivo do membro **médio. HGLOBAL** da estrutura **FORMATETC** .</span><span class="sxs-lookup"><span data-stu-id="e70ed-231">After the [**FORMATETC**](/windows/win32/api/objidl/ns-objidl-formatetc) structure is retrieved from the data object, [**DragQueryFile**](/windows/desktop/api/Shellapi/nf-shellapi-dragqueryfilea) is used to extract the file name from the **FORMATETC** structure's **medium.hGlobal** member.</span></span> <span data-ttu-id="e70ed-232">Se uma chave do registro for passada, o método usará [**RegOpenKeyEx**](/windows/win32/api/winreg/nf-winreg-regopenkeyexa) para abrir a chave e atribuir o identificador a **m \_ hRegKey**.</span><span class="sxs-lookup"><span data-stu-id="e70ed-232">If a registry key is passed in, the method uses [**RegOpenKeyEx**](/windows/win32/api/winreg/nf-winreg-regopenkeyexa) to open the key and assigns the handle to **m\_hRegKey**.</span></span>

### <a name="infotip-customization"></a><span data-ttu-id="e70ed-233">Personalização de InfoTip</span><span class="sxs-lookup"><span data-stu-id="e70ed-233">Infotip Customization</span></span>

<span data-ttu-id="e70ed-234">Há duas maneiras de personalizar o Infotips:</span><span class="sxs-lookup"><span data-stu-id="e70ed-234">There are two ways to customize infotips:</span></span>

-   <span data-ttu-id="e70ed-235">Implemente um objeto que dê suporte a [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) e registre esse objeto sob a subchave apropriada no registro (consulte [Registrando manipuladores de extensão de shell](#registering-shell-extension-handlers) abaixo).</span><span class="sxs-lookup"><span data-stu-id="e70ed-235">Implement an object that supports [**IQueryInfo**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo) and then register that object under the proper subkey in the registry (see [Registering Shell Extension Handlers](#registering-shell-extension-handlers) below).</span></span>
-   <span data-ttu-id="e70ed-236">Especifique uma cadeia de caracteres fixa ou uma lista de propriedades de arquivo específicas a serem exibidas.</span><span class="sxs-lookup"><span data-stu-id="e70ed-236">Specify a fixed string or a list of specific file properties to be displayed.</span></span>

<span data-ttu-id="e70ed-237">Para exibir uma cadeia de caracteres fixa para uma extensão de namespace, crie uma entrada chamada `InfoTip` na chave *{CLSID}* da extensão do namespace.</span><span class="sxs-lookup"><span data-stu-id="e70ed-237">To display a fixed string for a namespace extension, create an entry called `InfoTip` in the *{CLSID}* key of your namespace extension.</span></span> <span data-ttu-id="e70ed-238">Defina o valor dessa entrada como a cadeia de caracteres literal que você deseja exibir, como mostrado neste exemplo, ou uma cadeia de caracteres indireta que especifica um recurso e um índice dentro desse recurso (para fins de localização).</span><span class="sxs-lookup"><span data-stu-id="e70ed-238">Set the value of that entry to be either the literal string you want to display, as shown in this example, or an indirect string that specifies a resource and index within that resource (for localization purposes).</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      {CLSID}
         InfoTip = InfoTip string for your namespace extension
```

<span data-ttu-id="e70ed-239">Para exibir uma cadeia de caracteres fixa para um tipo de arquivo, crie uma entrada chamada `InfoTip` na chave *ProgID* desse tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-239">To display a fixed string for a file type, create an entry called `InfoTip` in the *ProgID* key of that file type.</span></span> <span data-ttu-id="e70ed-240">Defina o valor dessa entrada como a cadeia de caracteres literal que você deseja exibir ou uma cadeia de caracteres indireta que especifique um recurso e um índice dentro desse recurso (para fins de localização), conforme mostrado neste exemplo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-240">Set the value of that entry to be either the literal string you want to display or an indirect string that specifies a resource and index within that resource (for localization purposes), as shown in this example.</span></span>

```
HKEY_CLASSES_ROOT
   ProgID
      InfoTip = Resource.dll, 3
```

<span data-ttu-id="e70ed-241">Se você quiser que o Shell exiba Propriedades de arquivo específicas em InfoTip para um tipo de arquivo específico, crie uma entrada chamada `InfoTip` na chave *ProgID* para esse tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-241">If you want the Shell to display specific file properties in the infotip for a specific file type, create an entry called `InfoTip` in the *ProgID* key for that file type.</span></span> <span data-ttu-id="e70ed-242">Defina o valor dessa entrada como uma lista delineada por ponto-e-vírgula de nomes de propriedade canônicas, pares de identificadores de formato (FMTID)/Property (PID) ou ambos.</span><span class="sxs-lookup"><span data-stu-id="e70ed-242">Set the value of that entry to be a semicolon-delineated list of canonical property names, format identifier (FMTID)/property identifier (PID) pairs, or both.</span></span> <span data-ttu-id="e70ed-243">Esse valor deve começar com "prop:" para identificá-lo como uma cadeia de caracteres da lista de propriedades.</span><span class="sxs-lookup"><span data-stu-id="e70ed-243">This value must begin with "prop:" to identify it as a property list string.</span></span> <span data-ttu-id="e70ed-244">Se você omitir "prop:", o valor será visto como uma cadeia de caracteres literal e exibido como tal.</span><span class="sxs-lookup"><span data-stu-id="e70ed-244">If you omit "prop:", the value is seen as a literal string and displayed as such.</span></span>

<span data-ttu-id="e70ed-245">No exemplo a seguir, *propName* é um nome de propriedade canônico (como System. Date) e *{fmtid}, PID* é um par [**fmtid/PID**](./objects.md) .</span><span class="sxs-lookup"><span data-stu-id="e70ed-245">In the following example, *propname* is a canonical property name (such as System.Date) and *{fmtid},pid* is an [**FMTID/PID**](./objects.md) pair.</span></span>

```
HKEY_CLASSES_ROOT
   ProgID
      InfoTip = prop:propname;propname;{fmtid},pid;{fmtid},pid
```

<span data-ttu-id="e70ed-246">Os seguintes nomes de propriedade podem ser usados:</span><span class="sxs-lookup"><span data-stu-id="e70ed-246">The following property names can be used:</span></span>



| <span data-ttu-id="e70ed-247">Nome da propriedade</span><span class="sxs-lookup"><span data-stu-id="e70ed-247">Property Name</span></span>    | <span data-ttu-id="e70ed-248">Descrição</span><span class="sxs-lookup"><span data-stu-id="e70ed-248">Description</span></span>                   | <span data-ttu-id="e70ed-249">Recuperado de</span><span class="sxs-lookup"><span data-stu-id="e70ed-249">Retrieved From</span></span>                                                                             |
|------------------|-------------------------------|--------------------------------------------------------------------------------------------|
| <span data-ttu-id="e70ed-250">Autor</span><span class="sxs-lookup"><span data-stu-id="e70ed-250">Author</span></span>           | <span data-ttu-id="e70ed-251">Autor do documento</span><span class="sxs-lookup"><span data-stu-id="e70ed-251">Author of the document</span></span>        | [<span data-ttu-id="e70ed-252">**autor do PIDSI \_**</span><span class="sxs-lookup"><span data-stu-id="e70ed-252">**PIDSI\_AUTHOR**</span></span>](../stg/the-summary-information-property-set.md)                              |
| <span data-ttu-id="e70ed-253">Título</span><span class="sxs-lookup"><span data-stu-id="e70ed-253">Title</span></span>            | <span data-ttu-id="e70ed-254">Título do documento</span><span class="sxs-lookup"><span data-stu-id="e70ed-254">Title of the document</span></span>         | [<span data-ttu-id="e70ed-255">**título do PIDSI \_**</span><span class="sxs-lookup"><span data-stu-id="e70ed-255">**PIDSI\_TITLE**</span></span>](../stg/the-summary-information-property-set.md)                               |
| <span data-ttu-id="e70ed-256">Assunto</span><span class="sxs-lookup"><span data-stu-id="e70ed-256">Subject</span></span>          | <span data-ttu-id="e70ed-257">Resumo do assunto</span><span class="sxs-lookup"><span data-stu-id="e70ed-257">Subject summary</span></span>               | [<span data-ttu-id="e70ed-258">**assunto do PIDSI \_**</span><span class="sxs-lookup"><span data-stu-id="e70ed-258">**PIDSI\_SUBJECT**</span></span>](../stg/the-summary-information-property-set.md)                             |
| <span data-ttu-id="e70ed-259">Comentário</span><span class="sxs-lookup"><span data-stu-id="e70ed-259">Comment</span></span>          | <span data-ttu-id="e70ed-260">Comentários do documento</span><span class="sxs-lookup"><span data-stu-id="e70ed-260">Document comments</span></span>             | <span data-ttu-id="e70ed-261">[**PIDSI \_**](../stg/the-summary-information-property-set.md) Propriedades de comentário ou pasta/driver</span><span class="sxs-lookup"><span data-stu-id="e70ed-261">[**PIDSI\_COMMENT**](../stg/the-summary-information-property-set.md) or folder/driver properties</span></span> |
| <span data-ttu-id="e70ed-262">PageCount</span><span class="sxs-lookup"><span data-stu-id="e70ed-262">PageCount</span></span>        | <span data-ttu-id="e70ed-263">Número de páginas</span><span class="sxs-lookup"><span data-stu-id="e70ed-263">Number of pages</span></span>               | [<span data-ttu-id="e70ed-264">**PIDSI \_ PageCount**</span><span class="sxs-lookup"><span data-stu-id="e70ed-264">**PIDSI\_PAGECOUNT**</span></span>](../stg/the-summary-information-property-set.md)                           |
| <span data-ttu-id="e70ed-265">Name</span><span class="sxs-lookup"><span data-stu-id="e70ed-265">Name</span></span>             | <span data-ttu-id="e70ed-266">Nome amigável</span><span class="sxs-lookup"><span data-stu-id="e70ed-266">Friendly name</span></span>                 | <span data-ttu-id="e70ed-267">Exibição de pasta padrão</span><span class="sxs-lookup"><span data-stu-id="e70ed-267">Standard folder view</span></span>                                                                       |
| <span data-ttu-id="e70ed-268">OriginalLocation</span><span class="sxs-lookup"><span data-stu-id="e70ed-268">OriginalLocation</span></span> | <span data-ttu-id="e70ed-269">Local do arquivo original</span><span class="sxs-lookup"><span data-stu-id="e70ed-269">Location of original file</span></span>     | <span data-ttu-id="e70ed-270">Pasta do porta-arquivos e pasta lixeira</span><span class="sxs-lookup"><span data-stu-id="e70ed-270">Briefcase folder and Recycle Bin folder</span></span>                                                    |
| <span data-ttu-id="e70ed-271">DateDeleted</span><span class="sxs-lookup"><span data-stu-id="e70ed-271">DateDeleted</span></span>      | <span data-ttu-id="e70ed-272">O arquivo de data foi excluído</span><span class="sxs-lookup"><span data-stu-id="e70ed-272">Date file was deleted</span></span>         | <span data-ttu-id="e70ed-273">Pasta da lixeira</span><span class="sxs-lookup"><span data-stu-id="e70ed-273">Recycle Bin folder</span></span>                                                                         |
| <span data-ttu-id="e70ed-274">Tipo</span><span class="sxs-lookup"><span data-stu-id="e70ed-274">Type</span></span>             | <span data-ttu-id="e70ed-275">Tipo de arquivo</span><span class="sxs-lookup"><span data-stu-id="e70ed-275">Type of file</span></span>                  | <span data-ttu-id="e70ed-276">Exibição de detalhes da pasta padrão</span><span class="sxs-lookup"><span data-stu-id="e70ed-276">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="e70ed-277">Tamanho</span><span class="sxs-lookup"><span data-stu-id="e70ed-277">Size</span></span>             | <span data-ttu-id="e70ed-278">Tamanho do arquivo</span><span class="sxs-lookup"><span data-stu-id="e70ed-278">Size of file</span></span>                  | <span data-ttu-id="e70ed-279">Exibição de detalhes da pasta padrão</span><span class="sxs-lookup"><span data-stu-id="e70ed-279">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="e70ed-280">SyncCopyIn</span><span class="sxs-lookup"><span data-stu-id="e70ed-280">SyncCopyIn</span></span>       | <span data-ttu-id="e70ed-281">O mesmo que OriginalLocation</span><span class="sxs-lookup"><span data-stu-id="e70ed-281">Same as OriginalLocation</span></span>      | <span data-ttu-id="e70ed-282">O mesmo que OriginalLocation</span><span class="sxs-lookup"><span data-stu-id="e70ed-282">Same as OriginalLocation</span></span>                                                                   |
| <span data-ttu-id="e70ed-283">Modificado</span><span class="sxs-lookup"><span data-stu-id="e70ed-283">Modified</span></span>         | <span data-ttu-id="e70ed-284">Data da última modificação</span><span class="sxs-lookup"><span data-stu-id="e70ed-284">Date last modified</span></span>            | <span data-ttu-id="e70ed-285">Exibição de detalhes da pasta padrão</span><span class="sxs-lookup"><span data-stu-id="e70ed-285">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="e70ed-286">Criado</span><span class="sxs-lookup"><span data-stu-id="e70ed-286">Created</span></span>          | <span data-ttu-id="e70ed-287">Data de criação</span><span class="sxs-lookup"><span data-stu-id="e70ed-287">Date created</span></span>                  | <span data-ttu-id="e70ed-288">Exibição de detalhes da pasta padrão</span><span class="sxs-lookup"><span data-stu-id="e70ed-288">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="e70ed-289">Acessíveis</span><span class="sxs-lookup"><span data-stu-id="e70ed-289">Accessed</span></span>         | <span data-ttu-id="e70ed-290">Data do último acesso</span><span class="sxs-lookup"><span data-stu-id="e70ed-290">Date last accessed</span></span>            | <span data-ttu-id="e70ed-291">Exibição de detalhes da pasta padrão</span><span class="sxs-lookup"><span data-stu-id="e70ed-291">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="e70ed-292">Inpasta</span><span class="sxs-lookup"><span data-stu-id="e70ed-292">InFolder</span></span>         | <span data-ttu-id="e70ed-293">Diretório que contém o arquivo</span><span class="sxs-lookup"><span data-stu-id="e70ed-293">Directory containing the file</span></span> | <span data-ttu-id="e70ed-294">Resultados da pesquisa de documentos</span><span class="sxs-lookup"><span data-stu-id="e70ed-294">Document search results</span></span>                                                                    |
| <span data-ttu-id="e70ed-295">Rank</span><span class="sxs-lookup"><span data-stu-id="e70ed-295">Rank</span></span>             | <span data-ttu-id="e70ed-296">Qualidade de correspondência de pesquisa</span><span class="sxs-lookup"><span data-stu-id="e70ed-296">Quality of search match</span></span>       | <span data-ttu-id="e70ed-297">Resultados da pesquisa de documentos</span><span class="sxs-lookup"><span data-stu-id="e70ed-297">Document search results</span></span>                                                                    |
| <span data-ttu-id="e70ed-298">FreeSpace</span><span class="sxs-lookup"><span data-stu-id="e70ed-298">FreeSpace</span></span>        | <span data-ttu-id="e70ed-299">Espaço de armazenamento disponível</span><span class="sxs-lookup"><span data-stu-id="e70ed-299">Available storage space</span></span>       | <span data-ttu-id="e70ed-300">Unidades de disco</span><span class="sxs-lookup"><span data-stu-id="e70ed-300">Disk drives</span></span>                                                                                |
| <span data-ttu-id="e70ed-301">NumberOfVisits</span><span class="sxs-lookup"><span data-stu-id="e70ed-301">NumberOfVisits</span></span>   | <span data-ttu-id="e70ed-302">Número de visitas</span><span class="sxs-lookup"><span data-stu-id="e70ed-302">Number of visits</span></span>              | <span data-ttu-id="e70ed-303">Pasta Favoritos</span><span class="sxs-lookup"><span data-stu-id="e70ed-303">Favorites folder</span></span>                                                                           |
| <span data-ttu-id="e70ed-304">Atributos</span><span class="sxs-lookup"><span data-stu-id="e70ed-304">Attributes</span></span>       | <span data-ttu-id="e70ed-305">Atributos do arquivo</span><span class="sxs-lookup"><span data-stu-id="e70ed-305">File Attributes</span></span>               | <span data-ttu-id="e70ed-306">Exibição de detalhes da pasta padrão</span><span class="sxs-lookup"><span data-stu-id="e70ed-306">Standard folder details view</span></span>                                                               |
| <span data-ttu-id="e70ed-307">Empresa</span><span class="sxs-lookup"><span data-stu-id="e70ed-307">Company</span></span>          | <span data-ttu-id="e70ed-308">Nome da empresa</span><span class="sxs-lookup"><span data-stu-id="e70ed-308">Company name</span></span>                  | [<span data-ttu-id="e70ed-309">**\_empresa PIDDSI**</span><span class="sxs-lookup"><span data-stu-id="e70ed-309">**PIDDSI\_COMPANY**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)    |
| <span data-ttu-id="e70ed-310">Categoria</span><span class="sxs-lookup"><span data-stu-id="e70ed-310">Category</span></span>         | <span data-ttu-id="e70ed-311">Categoria do documento</span><span class="sxs-lookup"><span data-stu-id="e70ed-311">Document category</span></span>             | [<span data-ttu-id="e70ed-312">**\_categoria PIDDSI**</span><span class="sxs-lookup"><span data-stu-id="e70ed-312">**PIDDSI\_CATEGORY**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)   |
| <span data-ttu-id="e70ed-313">Direitos autorais</span><span class="sxs-lookup"><span data-stu-id="e70ed-313">Copyright</span></span>        | <span data-ttu-id="e70ed-314">Direitos autorais da mídia</span><span class="sxs-lookup"><span data-stu-id="e70ed-314">Media copyright</span></span>               | [<span data-ttu-id="e70ed-315">**\_direitos autorais do PIDMSI**</span><span class="sxs-lookup"><span data-stu-id="e70ed-315">**PIDMSI\_COPYRIGHT**</span></span>](../stg/the-documentsummaryinformation-and-userdefined-property-sets.md)  |
| <span data-ttu-id="e70ed-316">HTMLInfoTipFile</span><span class="sxs-lookup"><span data-stu-id="e70ed-316">HTMLInfoTipFile</span></span>  | <span data-ttu-id="e70ed-317">Arquivo InfoTip HTML</span><span class="sxs-lookup"><span data-stu-id="e70ed-317">HTML InfoTip file</span></span>             | <span data-ttu-id="e70ed-318">Arquivo de Desktop.ini para a pasta</span><span class="sxs-lookup"><span data-stu-id="e70ed-318">Desktop.ini file for folder</span></span>                                                                |



 

## <a name="enhancing-windows-search-with-shell-extension-handlers"></a><span data-ttu-id="e70ed-319">Aprimorando o Windows Search com manipuladores de extensão de Shell</span><span class="sxs-lookup"><span data-stu-id="e70ed-319">Enhancing Windows Search with Shell Extension Handlers</span></span>

<span data-ttu-id="e70ed-320">Os manipuladores de extensão do Shell podem ser usados para aprimorar a experiência do usuário fornecida por um manipulador de protocolo de pesquisa do Windows.</span><span class="sxs-lookup"><span data-stu-id="e70ed-320">Shell extension handlers may be used to enhance the user experience provided by a Windows Search protocol handler.</span></span> <span data-ttu-id="e70ed-321">Para habilitar esses aprimoramentos, o manipulador de extensão do Shell de suporte deve ser projetado para integrar com o manipulador de protocolo de pesquisa como uma fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="e70ed-321">To enable such enhancements, the supporting Shell extension handler must be designed to integrate with the search protocol handler as a data source.</span></span> <span data-ttu-id="e70ed-322">Para obter informações sobre como aprimorar um manipulador de protocolo de pesquisa do Windows por meio da integração com um manipulador de extensão de Shell, consulte [adicionando ícones, visualizações e menus de atalho](../search/-search-3x-wds-ph-ui-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="e70ed-322">For information about how to enhance a Windows Search protocol handler through integration with a Shell extension handler, see [Adding Icons, Previews and Shortcut Menus](../search/-search-3x-wds-ph-ui-extensions.md).</span></span> <span data-ttu-id="e70ed-323">Para obter mais informações sobre os manipuladores de protocolo de pesquisa do Windows, consulte [desenvolvendo manipuladores de protocolo](../search/-search-3x-wds-phaddins.md).</span><span class="sxs-lookup"><span data-stu-id="e70ed-323">For more information about Windows Search protocol handlers, see [Developing Protocol Handlers](../search/-search-3x-wds-phaddins.md).</span></span>

## <a name="registering-shell-extension-handlers"></a><span data-ttu-id="e70ed-324">Registrando manipuladores de extensão do Shell</span><span class="sxs-lookup"><span data-stu-id="e70ed-324">Registering Shell Extension Handlers</span></span>

<span data-ttu-id="e70ed-325">Um objeto de manipulador de extensão de Shell deve ser registrado antes que o Shell possa usá-lo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-325">A Shell extension handler object must be registered before the Shell can use it.</span></span> <span data-ttu-id="e70ed-326">Esta seção é uma discussão geral sobre como registrar um manipulador de extensão de Shell.</span><span class="sxs-lookup"><span data-stu-id="e70ed-326">This section is a general discussion of how to register a Shell extension handler.</span></span>

<span data-ttu-id="e70ed-327">Sempre que você criar ou alterar um manipulador de extensão de Shell, será importante notificar o sistema de que você fez uma alteração com [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify), especificando o evento **SHCNE \_ assocchanged** .</span><span class="sxs-lookup"><span data-stu-id="e70ed-327">Any time you create or change a Shell extension handler, it is important to notify the system that you have made a change with [**SHChangeNotify**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify), specifying the **SHCNE\_ASSOCCHANGED** event.</span></span> <span data-ttu-id="e70ed-328">Se você não chamar **SHChangeNotify**, a alteração poderá não ser reconhecida até que o sistema seja reinicializado.</span><span class="sxs-lookup"><span data-stu-id="e70ed-328">If you do not call **SHChangeNotify**, the change might not be recognized until the system is rebooted.</span></span>

<span data-ttu-id="e70ed-329">Assim como acontece com todos os objetos COM, você deve criar um GUID para o manipulador usando uma ferramenta como UUIDGEN.exe.</span><span class="sxs-lookup"><span data-stu-id="e70ed-329">As with all COM objects, you must create a GUID for the handler using a tool such as UUIDGEN.exe.</span></span> <span data-ttu-id="e70ed-330">Crie uma chave em **\_ classe HKEY \_ raiz** \\ **CLSID** cujo nome é a forma de cadeia de caracteres do GUID.</span><span class="sxs-lookup"><span data-stu-id="e70ed-330">Create a key under **HKEY\_CLASSES\_ROOT**\\**CLSID** whose name is the string form of the GUID.</span></span> <span data-ttu-id="e70ed-331">Como os manipuladores de extensão do shell são servidores em processo, você deve criar uma chave **InprocServer32** na chave de GUID com o valor padrão definido como o caminho da dll do manipulador.</span><span class="sxs-lookup"><span data-stu-id="e70ed-331">Because Shell extension handlers are in-process servers, you must create an **InProcServer32** key under the GUID key with the default value set to the path of the handler's DLL.</span></span> <span data-ttu-id="e70ed-332">Use o modelo de Threading Apartment.</span><span class="sxs-lookup"><span data-stu-id="e70ed-332">Use the Apartment threading model.</span></span>

<span data-ttu-id="e70ed-333">Sempre que o Shell executar uma ação que possa envolver um manipulador de extensão de Shell, ele verificará a chave do registro apropriada.</span><span class="sxs-lookup"><span data-stu-id="e70ed-333">Any time the Shell takes an action that can involve a Shell extension handler, it checks the appropriate registry key.</span></span> <span data-ttu-id="e70ed-334">A chave sob a qual um manipulador de extensão é registrado, portanto, controla quando ele será chamado.</span><span class="sxs-lookup"><span data-stu-id="e70ed-334">The key under which an extension handler is registered thus controls when it will be called.</span></span> <span data-ttu-id="e70ed-335">Por exemplo, é uma prática comum ter um manipulador de menu de atalho chamado quando o Shell exibe um menu de atalho para um membro de um [tipo de arquivo](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="e70ed-335">For instance, it is a common practice to have a shortcut menu handler called when the Shell displays a shortcut menu for a member of a [file type](fa-file-types.md).</span></span> <span data-ttu-id="e70ed-336">Nesse caso, o manipulador deve ser registrado na chave **ProgID** do tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-336">In this case, the handler must be registered under the file type's **ProgID** key.</span></span>

### <a name="handler-names"></a><span data-ttu-id="e70ed-337">Nomes de manipuladores</span><span class="sxs-lookup"><span data-stu-id="e70ed-337">Handler Names</span></span>

<span data-ttu-id="e70ed-338">Para habilitar um manipulador de extensão de Shell, crie uma subchave com o nome da subchave do manipulador (veja abaixo) na subchave **shellex** do **ProgID** (para tipos de arquivo) ou o nome do tipo de objeto do Shell (para [objetos shell predefinidos](#predefined-shell-objects)).</span><span class="sxs-lookup"><span data-stu-id="e70ed-338">To enable a Shell extension handler, create a subkey with the handler subkey name (see below) under the **ShellEx** subkey of either the **ProgID** (for file types) or the Shell object type name (for [Predefined Shell Objects](#predefined-shell-objects)).</span></span>

<span data-ttu-id="e70ed-339">Por exemplo, se você quisesse registrar um manipulador de extensão de menu de atalho para myprogram. 1, começaria criando a seguinte subchave:</span><span class="sxs-lookup"><span data-stu-id="e70ed-339">For example, if you wanted to register a shortcut menu extension handler for MyProgram.1, you would begin by creating the following subkey:</span></span>

```
HKEY_CLASSES_ROOT
   MyProgram.1
      ShellEx
         ContextMenuHandlers
```

<span data-ttu-id="e70ed-340">Para os seguintes manipuladores, crie uma subchave sob a chave "nome da subchave do manipulador" cujo nome é a versão da cadeia de caracteres do CLSID da extensão do Shell.</span><span class="sxs-lookup"><span data-stu-id="e70ed-340">For the following handlers, create a subkey underneath the "Handler Subkey name" key whose name is the string version of the CLSID of the Shell extension.</span></span> <span data-ttu-id="e70ed-341">Várias extensões podem ser registradas na chave de nome da subchave do manipulador criando várias subchaves.</span><span class="sxs-lookup"><span data-stu-id="e70ed-341">Multiple extensions can be registered under the handler subkey name key by creating multiple subkeys.</span></span>



| <span data-ttu-id="e70ed-342">Manipulador</span><span class="sxs-lookup"><span data-stu-id="e70ed-342">Handler</span></span>                                               | <span data-ttu-id="e70ed-343">Interface</span><span class="sxs-lookup"><span data-stu-id="e70ed-343">Interface</span></span>          | <span data-ttu-id="e70ed-344">Nome da subchave do manipulador</span><span class="sxs-lookup"><span data-stu-id="e70ed-344">Handler Subkey Name</span></span>       |
|-------------------------------------------------------|--------------------|---------------------------|
| <span data-ttu-id="e70ed-345">Manipulador de menu de atalho</span><span class="sxs-lookup"><span data-stu-id="e70ed-345">Shortcut menu handler</span></span>                                 | <span data-ttu-id="e70ed-346">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="e70ed-346">IContextMenu</span></span>       | <span data-ttu-id="e70ed-347">**ContextMenuHandlers**</span><span class="sxs-lookup"><span data-stu-id="e70ed-347">**ContextMenuHandlers**</span></span>   |
| <span data-ttu-id="e70ed-348">Manipulador de Copyhook</span><span class="sxs-lookup"><span data-stu-id="e70ed-348">Copyhook handler</span></span>                                      | <span data-ttu-id="e70ed-349">ICopyHook</span><span class="sxs-lookup"><span data-stu-id="e70ed-349">ICopyHook</span></span>          | <span data-ttu-id="e70ed-350">**CopyHookHandlers**</span><span class="sxs-lookup"><span data-stu-id="e70ed-350">**CopyHookHandlers**</span></span>      |
| <span data-ttu-id="e70ed-351">Manipulador do tipo "arrastar e soltar"</span><span class="sxs-lookup"><span data-stu-id="e70ed-351">Drag-and-drop handler</span></span>                                 | <span data-ttu-id="e70ed-352">IContextMenu</span><span class="sxs-lookup"><span data-stu-id="e70ed-352">IContextMenu</span></span>       | <span data-ttu-id="e70ed-353">**DragDropHandlers**</span><span class="sxs-lookup"><span data-stu-id="e70ed-353">**DragDropHandlers**</span></span>      |
| <span data-ttu-id="e70ed-354">Manipulador de folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="e70ed-354">Property sheet handler</span></span>                                | <span data-ttu-id="e70ed-355">IShellPropSheetExt</span><span class="sxs-lookup"><span data-stu-id="e70ed-355">IShellPropSheetExt</span></span> | <span data-ttu-id="e70ed-356">**PropertySheetHandlers**</span><span class="sxs-lookup"><span data-stu-id="e70ed-356">**PropertySheetHandlers**</span></span> |
| <span data-ttu-id="e70ed-357">Manipulador de provedor de coluna (preterido no Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="e70ed-357">Column provider handler (deprecated in Windows Vista)</span></span> | <span data-ttu-id="e70ed-358">IColumnProvider</span><span class="sxs-lookup"><span data-stu-id="e70ed-358">IColumnProvider</span></span>    | <span data-ttu-id="e70ed-359">**ColumnHandlers**</span><span class="sxs-lookup"><span data-stu-id="e70ed-359">**ColumnHandlers**</span></span>        |



 

<span data-ttu-id="e70ed-360">Para os seguintes manipuladores, o valor padrão da chave "nome da subchave do manipulador" é a versão da cadeia de caracteres do CLSID da extensão do Shell.</span><span class="sxs-lookup"><span data-stu-id="e70ed-360">For the following handlers, the default value of the "Handler Subkey Name" key is the string version of the CLSID of the Shell extension.</span></span> <span data-ttu-id="e70ed-361">Somente uma extensão pode ser registrada para esses manipuladores.</span><span class="sxs-lookup"><span data-stu-id="e70ed-361">Only one extension can be registered for these handlers.</span></span>



| <span data-ttu-id="e70ed-362">Manipulador</span><span class="sxs-lookup"><span data-stu-id="e70ed-362">Handler</span></span>                 | <span data-ttu-id="e70ed-363">Interface</span><span class="sxs-lookup"><span data-stu-id="e70ed-363">Interface</span></span>                                         | <span data-ttu-id="e70ed-364">Nome da subchave do manipulador</span><span class="sxs-lookup"><span data-stu-id="e70ed-364">Handler Subkey Name</span></span>                        |
|-------------------------|---------------------------------------------------|--------------------------------------------|
| <span data-ttu-id="e70ed-365">Manipulador de dados</span><span class="sxs-lookup"><span data-stu-id="e70ed-365">Data handler</span></span>            | <span data-ttu-id="e70ed-366">IDataObject</span><span class="sxs-lookup"><span data-stu-id="e70ed-366">IDataObject</span></span>                                       | <span data-ttu-id="e70ed-367">**DataHandler**</span><span class="sxs-lookup"><span data-stu-id="e70ed-367">**DataHandler**</span></span>                            |
| <span data-ttu-id="e70ed-368">Descartar manipulador</span><span class="sxs-lookup"><span data-stu-id="e70ed-368">Drop handler</span></span>            | <span data-ttu-id="e70ed-369">IDropTarget</span><span class="sxs-lookup"><span data-stu-id="e70ed-369">IDropTarget</span></span>                                       | <span data-ttu-id="e70ed-370">**DropHandler**</span><span class="sxs-lookup"><span data-stu-id="e70ed-370">**DropHandler**</span></span>                            |
| <span data-ttu-id="e70ed-371">Manipulador de ícone</span><span class="sxs-lookup"><span data-stu-id="e70ed-371">Icon handler</span></span>            | <span data-ttu-id="e70ed-372">IExtractIconA/W</span><span class="sxs-lookup"><span data-stu-id="e70ed-372">IExtractIconA/W</span></span>                                   | <span data-ttu-id="e70ed-373">**IconHandler**</span><span class="sxs-lookup"><span data-stu-id="e70ed-373">**IconHandler**</span></span>                            |
| <span data-ttu-id="e70ed-374">Manipulador de imagem</span><span class="sxs-lookup"><span data-stu-id="e70ed-374">Image handler</span></span>           | <span data-ttu-id="e70ed-375">IExtractImage</span><span class="sxs-lookup"><span data-stu-id="e70ed-375">IExtractImage</span></span>                                     | <span data-ttu-id="e70ed-376">**{BB2E617C-0920-11d1-9A0B-00C04FC2D6C1}**</span><span class="sxs-lookup"><span data-stu-id="e70ed-376">**{BB2E617C-0920-11d1-9A0B-00C04FC2D6C1}**</span></span> |
| <span data-ttu-id="e70ed-377">Manipulador de imagem em miniatura</span><span class="sxs-lookup"><span data-stu-id="e70ed-377">Thumbnail image handler</span></span> | <span data-ttu-id="e70ed-378">Manipuladordeminiaturai</span><span class="sxs-lookup"><span data-stu-id="e70ed-378">IThumbnailProvider</span></span>                                | <span data-ttu-id="e70ed-379">**{E357FCCD-A995-4576-B01F-234630154E96}**</span><span class="sxs-lookup"><span data-stu-id="e70ed-379">**{E357FCCD-A995-4576-B01F-234630154E96}**</span></span> |
| <span data-ttu-id="e70ed-380">Manipulador de infodicas</span><span class="sxs-lookup"><span data-stu-id="e70ed-380">Infotip handler</span></span>         | <span data-ttu-id="e70ed-381">IQueryInfo</span><span class="sxs-lookup"><span data-stu-id="e70ed-381">IQueryInfo</span></span>                                        | <span data-ttu-id="e70ed-382">**{00021500-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="e70ed-382">**{00021500-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="e70ed-383">Link do Shell (ANSI)</span><span class="sxs-lookup"><span data-stu-id="e70ed-383">Shell link (ANSI )</span></span>      | <span data-ttu-id="e70ed-384">IShellLinkA</span><span class="sxs-lookup"><span data-stu-id="e70ed-384">IShellLinkA</span></span>                                       | <span data-ttu-id="e70ed-385">**{000214EE-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="e70ed-385">**{000214EE-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="e70ed-386">Link do Shell (UNICODE)</span><span class="sxs-lookup"><span data-stu-id="e70ed-386">Shell link (UNICODE)</span></span>    | <span data-ttu-id="e70ed-387">IShellLinkW</span><span class="sxs-lookup"><span data-stu-id="e70ed-387">IShellLinkW</span></span>                                       | <span data-ttu-id="e70ed-388">**{000214F9-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="e70ed-388">**{000214F9-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="e70ed-389">Armazenamento estruturado</span><span class="sxs-lookup"><span data-stu-id="e70ed-389">Structured storage</span></span>      | <span data-ttu-id="e70ed-390">IStorage</span><span class="sxs-lookup"><span data-stu-id="e70ed-390">IStorage</span></span>                                          | <span data-ttu-id="e70ed-391">**{0000000B-0000-0000-C000-000000000046}**</span><span class="sxs-lookup"><span data-stu-id="e70ed-391">**{0000000B-0000-0000-C000-000000000046}**</span></span> |
| <span data-ttu-id="e70ed-392">Metadados</span><span class="sxs-lookup"><span data-stu-id="e70ed-392">Metadata</span></span>                | <span data-ttu-id="e70ed-393">IPropertyStore</span><span class="sxs-lookup"><span data-stu-id="e70ed-393">IPropertyStore</span></span>                                    | <span data-ttu-id="e70ed-394">**PropertyHandler**</span><span class="sxs-lookup"><span data-stu-id="e70ed-394">**PropertyHandler**</span></span>                        |
| <span data-ttu-id="e70ed-395">Metadados</span><span class="sxs-lookup"><span data-stu-id="e70ed-395">Metadata</span></span>                | <span data-ttu-id="e70ed-396">IPropertySetStorage (preterido no Windows Vista)</span><span class="sxs-lookup"><span data-stu-id="e70ed-396">IPropertySetStorage (deprecated in Windows Vista)</span></span> | <span data-ttu-id="e70ed-397">**PropertyHandler**</span><span class="sxs-lookup"><span data-stu-id="e70ed-397">**PropertyHandler**</span></span>                        |
| <span data-ttu-id="e70ed-398">Fixar no menu iniciar</span><span class="sxs-lookup"><span data-stu-id="e70ed-398">Pin to Start Menu</span></span>       | <span data-ttu-id="e70ed-399">IStartMenuPinnedList</span><span class="sxs-lookup"><span data-stu-id="e70ed-399">IStartMenuPinnedList</span></span>                              | <span data-ttu-id="e70ed-400">**{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}**</span><span class="sxs-lookup"><span data-stu-id="e70ed-400">**{a2a9545d-a0c2-42b4-9708-a0b2badd77c8}**</span></span> |
| <span data-ttu-id="e70ed-401">Fixar à barra de tarefas</span><span class="sxs-lookup"><span data-stu-id="e70ed-401">Pin to Taskbar</span></span>          |                                                   | <span data-ttu-id="e70ed-402">**{90AA3A4E-1CBA-4233-B8BB-535773D48449}**</span><span class="sxs-lookup"><span data-stu-id="e70ed-402">**{90AA3A4E-1CBA-4233-B8BB-535773D48449}**</span></span> |



 

<span data-ttu-id="e70ed-403">As subchaves especificadas para adicionar **Pin ao menu iniciar** e **fixar à barra de tarefas** no menu de atalho de um item só são necessárias para tipos de arquivo que incluem a entrada [IsShortcut](./links.md) .</span><span class="sxs-lookup"><span data-stu-id="e70ed-403">The subkeys specified to add **Pin to Start Menu** and **Pin to Taskbar** to an item's shortcut menu are only required for file types that include the [IsShortCut](./links.md) entry.</span></span>

<span data-ttu-id="e70ed-404">O suporte para manipuladores de provedor de coluna foi removido no Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="e70ed-404">Support for column provider handlers was removed in Windows Vista.</span></span> <span data-ttu-id="e70ed-405">Além disso, a partir do Windows Vista, o [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) foi preterido em favor do [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span><span class="sxs-lookup"><span data-stu-id="e70ed-405">Also, as of Windows Vista, [**IPropertySetStorage**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage) has been deprecated in favor of [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span></span>

<span data-ttu-id="e70ed-406">Embora o [**IExtractImage**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iextractimage) permaneça com suporte, o [**manipuladordeminiaturai**](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) é preferencial para o Windows Vista e posterior.</span><span class="sxs-lookup"><span data-stu-id="e70ed-406">While [**IExtractImage**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iextractimage) remains supported, [**IThumbnailProvider**](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) is preferred for Windows Vista and later.</span></span>

### <a name="predefined-shell-objects"></a><span data-ttu-id="e70ed-407">Objetos de shell predefinidos</span><span class="sxs-lookup"><span data-stu-id="e70ed-407">Predefined Shell Objects</span></span>

<span data-ttu-id="e70ed-408">O Shell define objetos adicionais na **\_ \_ raiz de classes hKey** que podem ser estendidas da mesma maneira que os tipos de arquivo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-408">The Shell defines additional objects under **HKEY\_CLASSES\_ROOT** which can be extended in the same way as file types.</span></span> <span data-ttu-id="e70ed-409">Por exemplo, para adicionar um manipulador de folha de propriedades para todos os arquivos, você pode registrar sob a chave **PropertySheetHandlers** .</span><span class="sxs-lookup"><span data-stu-id="e70ed-409">For example, to add a property sheet handler for all files, you can register under the **PropertySheetHandlers** key.</span></span>

```
HKEY_CLASSES_ROOT
   *
      shellex
         PropertySheetHandlers
```

<span data-ttu-id="e70ed-410">A tabela a seguir fornece as várias subchaves da **\_ \_ raiz de classes hKey** em que os manipuladores de extensão podem ser registrados.</span><span class="sxs-lookup"><span data-stu-id="e70ed-410">The following table gives the various subkeys of **HKEY\_CLASSES\_ROOT** under which extension handlers can be registered.</span></span> <span data-ttu-id="e70ed-411">Observe que muitos manipuladores de extensão não podem ser registrados em todas as subchaves listadas.</span><span class="sxs-lookup"><span data-stu-id="e70ed-411">Note that many extension handlers cannot be registered under all of the listed subkeys.</span></span> <span data-ttu-id="e70ed-412">Para obter mais detalhes, consulte a documentação do manipulador específico.</span><span class="sxs-lookup"><span data-stu-id="e70ed-412">For further details, see the specific handler's documentation.</span></span>



| <span data-ttu-id="e70ed-413">Subchave</span><span class="sxs-lookup"><span data-stu-id="e70ed-413">Subkey</span></span>                    | <span data-ttu-id="e70ed-414">Description</span><span class="sxs-lookup"><span data-stu-id="e70ed-414">Description</span></span>                                                          | <span data-ttu-id="e70ed-415">Possíveis manipuladores</span><span class="sxs-lookup"><span data-stu-id="e70ed-415">Possible Handlers</span></span>                                | <span data-ttu-id="e70ed-416">Versão</span><span class="sxs-lookup"><span data-stu-id="e70ed-416">Version</span></span> |
|---------------------------|----------------------------------------------------------------------|--------------------------------------------------|---------|
| <span data-ttu-id="e70ed-417">\**\** _</span><span class="sxs-lookup"><span data-stu-id="e70ed-417">\**\** _</span></span>                    | <span data-ttu-id="e70ed-418">Todos os arquivos</span><span class="sxs-lookup"><span data-stu-id="e70ed-418">All files</span></span>                                                            | <span data-ttu-id="e70ed-419">Menu de atalho, folha de propriedades, verbos (veja abaixo)</span><span class="sxs-lookup"><span data-stu-id="e70ed-419">Shortcut Menu, Property Sheet, Verbs (see below)</span></span> | <span data-ttu-id="e70ed-420">Tudo</span><span class="sxs-lookup"><span data-stu-id="e70ed-420">All</span></span>     |
| <span data-ttu-id="e70ed-421">_ *AllFileSystemObjects*\*</span><span class="sxs-lookup"><span data-stu-id="e70ed-421">_ *AllFileSystemObjects*\*</span></span>  | <span data-ttu-id="e70ed-422">Todos os arquivos e pastas de arquivos</span><span class="sxs-lookup"><span data-stu-id="e70ed-422">All files and file folders</span></span>                                           | <span data-ttu-id="e70ed-423">Menu de atalho, folha de propriedades, verbos</span><span class="sxs-lookup"><span data-stu-id="e70ed-423">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="e70ed-424">4,71</span><span class="sxs-lookup"><span data-stu-id="e70ed-424">4.71</span></span>    |
| <span data-ttu-id="e70ed-425">**Pasta**</span><span class="sxs-lookup"><span data-stu-id="e70ed-425">**Folder**</span></span>                | <span data-ttu-id="e70ed-426">Todas as pastas</span><span class="sxs-lookup"><span data-stu-id="e70ed-426">All folders</span></span>                                                          | <span data-ttu-id="e70ed-427">Menu de atalho, folha de propriedades, verbos</span><span class="sxs-lookup"><span data-stu-id="e70ed-427">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="e70ed-428">Tudo</span><span class="sxs-lookup"><span data-stu-id="e70ed-428">All</span></span>     |
| <span data-ttu-id="e70ed-429">**Active**</span><span class="sxs-lookup"><span data-stu-id="e70ed-429">**Directory**</span></span>             | <span data-ttu-id="e70ed-430">Pastas de arquivos</span><span class="sxs-lookup"><span data-stu-id="e70ed-430">File folders</span></span>                                                         | <span data-ttu-id="e70ed-431">Menu de atalho, folha de propriedades, verbos</span><span class="sxs-lookup"><span data-stu-id="e70ed-431">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="e70ed-432">Tudo</span><span class="sxs-lookup"><span data-stu-id="e70ed-432">All</span></span>     |
| <span data-ttu-id="e70ed-433">**Plano de fundo do diretório \\**</span><span class="sxs-lookup"><span data-stu-id="e70ed-433">**Directory\\Background**</span></span> | <span data-ttu-id="e70ed-434">Plano de fundo da pasta de arquivos</span><span class="sxs-lookup"><span data-stu-id="e70ed-434">File folder background</span></span>                                               | <span data-ttu-id="e70ed-435">Somente menu de atalho</span><span class="sxs-lookup"><span data-stu-id="e70ed-435">Shortcut Menu only</span></span>                               | <span data-ttu-id="e70ed-436">4,71</span><span class="sxs-lookup"><span data-stu-id="e70ed-436">4.71</span></span>    |
| <span data-ttu-id="e70ed-437">**Unidade**</span><span class="sxs-lookup"><span data-stu-id="e70ed-437">**Drive**</span></span>                 | <span data-ttu-id="e70ed-438">Todas as unidades em MyComputer, como "C: \\ "</span><span class="sxs-lookup"><span data-stu-id="e70ed-438">All drives in MyComputer, such as "C:\\"</span></span>                             | <span data-ttu-id="e70ed-439">Menu de atalho, folha de propriedades, verbos</span><span class="sxs-lookup"><span data-stu-id="e70ed-439">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="e70ed-440">Tudo</span><span class="sxs-lookup"><span data-stu-id="e70ed-440">All</span></span>     |
| <span data-ttu-id="e70ed-441">**Rede**</span><span class="sxs-lookup"><span data-stu-id="e70ed-441">**Network**</span></span>               | <span data-ttu-id="e70ed-442">Rede inteira (em meus locais de rede)</span><span class="sxs-lookup"><span data-stu-id="e70ed-442">Entire network (under My Network Places)</span></span>                             | <span data-ttu-id="e70ed-443">Menu de atalho, folha de propriedades, verbos</span><span class="sxs-lookup"><span data-stu-id="e70ed-443">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="e70ed-444">Tudo</span><span class="sxs-lookup"><span data-stu-id="e70ed-444">All</span></span>     |
| <span data-ttu-id="e70ed-445">**Tipo de rede \\\\\#**</span><span class="sxs-lookup"><span data-stu-id="e70ed-445">**Network\\Type\\\#**</span></span>     | <span data-ttu-id="e70ed-446">Todos os objetos do tipo \# (veja abaixo)</span><span class="sxs-lookup"><span data-stu-id="e70ed-446">All objects of type \# (see below)</span></span>                                   | <span data-ttu-id="e70ed-447">Menu de atalho, folha de propriedades, verbos</span><span class="sxs-lookup"><span data-stu-id="e70ed-447">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="e70ed-448">4,71</span><span class="sxs-lookup"><span data-stu-id="e70ed-448">4.71</span></span>    |
| <span data-ttu-id="e70ed-449">**NetShare**</span><span class="sxs-lookup"><span data-stu-id="e70ed-449">**NetShare**</span></span>              | <span data-ttu-id="e70ed-450">Todos os compartilhamentos de rede</span><span class="sxs-lookup"><span data-stu-id="e70ed-450">All network shares</span></span>                                                   | <span data-ttu-id="e70ed-451">Menu de atalho, folha de propriedades, verbos</span><span class="sxs-lookup"><span data-stu-id="e70ed-451">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="e70ed-452">4,71</span><span class="sxs-lookup"><span data-stu-id="e70ed-452">4.71</span></span>    |
| <span data-ttu-id="e70ed-453">**NetServer**</span><span class="sxs-lookup"><span data-stu-id="e70ed-453">**NetServer**</span></span>             | <span data-ttu-id="e70ed-454">Todos os servidores de rede</span><span class="sxs-lookup"><span data-stu-id="e70ed-454">All network servers</span></span>                                                  | <span data-ttu-id="e70ed-455">Menu de atalho, folha de propriedades, verbos</span><span class="sxs-lookup"><span data-stu-id="e70ed-455">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="e70ed-456">4,71</span><span class="sxs-lookup"><span data-stu-id="e70ed-456">4.71</span></span>    |
| <span data-ttu-id="e70ed-457">*\_nome do provedor de rede \_*</span><span class="sxs-lookup"><span data-stu-id="e70ed-457">*network\_provider\_name*</span></span> | <span data-ttu-id="e70ed-458">Todos os objetos fornecidos pelo "*nome do \_ provedor \_ de rede*" do provedor de rede</span><span class="sxs-lookup"><span data-stu-id="e70ed-458">All objects provided by network provider "*network\_provider\_name*"</span></span> | <span data-ttu-id="e70ed-459">Menu de atalho, folha de propriedades, verbos</span><span class="sxs-lookup"><span data-stu-id="e70ed-459">Shortcut menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="e70ed-460">Tudo</span><span class="sxs-lookup"><span data-stu-id="e70ed-460">All</span></span>     |
| <span data-ttu-id="e70ed-461">**Impressoras**</span><span class="sxs-lookup"><span data-stu-id="e70ed-461">**Printers**</span></span>              | <span data-ttu-id="e70ed-462">Todas as impressoras</span><span class="sxs-lookup"><span data-stu-id="e70ed-462">All printers</span></span>                                                         | <span data-ttu-id="e70ed-463">Menu de atalho, folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="e70ed-463">Shortcut Menu, Property Sheet</span></span>                    | <span data-ttu-id="e70ed-464">Tudo</span><span class="sxs-lookup"><span data-stu-id="e70ed-464">All</span></span>     |
| <span data-ttu-id="e70ed-465">**AudioCD**</span><span class="sxs-lookup"><span data-stu-id="e70ed-465">**AudioCD**</span></span>               | <span data-ttu-id="e70ed-466">CD de áudio na unidade de CD</span><span class="sxs-lookup"><span data-stu-id="e70ed-466">Audio CD in CD drive</span></span>                                                 | <span data-ttu-id="e70ed-467">Somente verbos</span><span class="sxs-lookup"><span data-stu-id="e70ed-467">Verbs only</span></span>                                       | <span data-ttu-id="e70ed-468">Tudo</span><span class="sxs-lookup"><span data-stu-id="e70ed-468">All</span></span>     |
| <span data-ttu-id="e70ed-469">**DVD**</span><span class="sxs-lookup"><span data-stu-id="e70ed-469">**DVD**</span></span>                   | <span data-ttu-id="e70ed-470">Unidade de DVD (Windows 2000)</span><span class="sxs-lookup"><span data-stu-id="e70ed-470">DVD drive (Windows 2000)</span></span>                                             | <span data-ttu-id="e70ed-471">Menu de atalho, folha de propriedades, verbos</span><span class="sxs-lookup"><span data-stu-id="e70ed-471">Shortcut Menu, Property Sheet, Verbs</span></span>             | <span data-ttu-id="e70ed-472">4,71</span><span class="sxs-lookup"><span data-stu-id="e70ed-472">4.71</span></span>    |



 

<span data-ttu-id="e70ed-473">Observações:</span><span class="sxs-lookup"><span data-stu-id="e70ed-473">Notes:</span></span>

-   <span data-ttu-id="e70ed-474">O menu de atalho de segundo plano da pasta de arquivo é acessado clicando com o botão direito do mouse em uma pasta de arquivo, mas não em qualquer conteúdo da pasta.</span><span class="sxs-lookup"><span data-stu-id="e70ed-474">The file folder background shortcut menu is accessed by right-clicking within a file folder, but not over any of the folder's contents.</span></span>
-   <span data-ttu-id="e70ed-475">"Verbos" são comandos especiais registrados sob o verbo do Shell de subchave do **HKEY \_ classes \_ raiz** \\  \\  \\  .</span><span class="sxs-lookup"><span data-stu-id="e70ed-475">"Verbs" are special commands registered under **HKEY\_CLASSES\_ROOT**\\*Subkey*\\**Shell**\\**Verb** .</span></span>
-   <span data-ttu-id="e70ed-476">Para o tipo de **rede** \\  \\ **\#** , " \# " é um código de tipo de provedor de rede em decimal.</span><span class="sxs-lookup"><span data-stu-id="e70ed-476">For **Network**\\**Type**\\**\#** , "\#" is a network provider type code in decimal.</span></span> <span data-ttu-id="e70ed-477">O código do tipo de provedor de rede é a palavra alta de um tipo de rede.</span><span class="sxs-lookup"><span data-stu-id="e70ed-477">The network provider type code is the high word of a network type.</span></span> <span data-ttu-id="e70ed-478">A lista de tipos de rede é fornecida no arquivo de cabeçalho Winnetwk. h (WNNC \_ net \_ \* Values).</span><span class="sxs-lookup"><span data-stu-id="e70ed-478">The list of network types is given in the Winnetwk.h header file (WNNC\_NET\_\* values).</span></span> <span data-ttu-id="e70ed-479">Por exemplo, WNNC \_ net \_ Shiva é 0x00330000, portanto, a chave de tipo correspondente seria tipo de rede **\_ \_ raiz de classe HKEY** \\  \\  \\ **51** .</span><span class="sxs-lookup"><span data-stu-id="e70ed-479">For example, WNNC\_NET\_SHIVA is 0x00330000, so the corresponding type key would be **HKEY\_CLASSES\_ROOT**\\**Network**\\**Type**\\**51** .</span></span>
-   <span data-ttu-id="e70ed-480">"*\_ \_ nome do provedor de rede*" é um nome de provedor de rede, conforme especificado por [**WNetGetProviderName**](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetprovidernamea), com os espaços convertidos em sublinhados.</span><span class="sxs-lookup"><span data-stu-id="e70ed-480">"*network\_provider\_name*" is a network provider name as specified by [**WNetGetProviderName**](/windows/win32/api/winnetwk/nf-winnetwk-wnetgetprovidernamea), with the spaces converted into underscores.</span></span> <span data-ttu-id="e70ed-481">Por exemplo, se o provedor de rede de rede da Microsoft estiver instalado, o nome do provedor será "rede do Microsoft Windows" e o *\_ \_ nome do provedor de rede* correspondente será a **\_ \_ rede do Microsoft Windows**.</span><span class="sxs-lookup"><span data-stu-id="e70ed-481">For example, if the Microsoft Networking network provider is installed, its provider name is "Microsoft Windows Network", and the corresponding *network\_provider\_name* is **Microsoft\_Windows\_Network**.</span></span>

### <a name="example-of-an-extension-handler-registration"></a><span data-ttu-id="e70ed-482">Exemplo de um registro de manipulador de extensão</span><span class="sxs-lookup"><span data-stu-id="e70ed-482">Example of an Extension Handler Registration</span></span>

<span data-ttu-id="e70ed-483">Para habilitar um manipulador específico, crie uma subchave sob a chave do tipo de manipulador de extensão com o nome do manipulador.</span><span class="sxs-lookup"><span data-stu-id="e70ed-483">To enable a particular handler, create a subkey under the extension handler type key with the name of the handler.</span></span> <span data-ttu-id="e70ed-484">O shell não usa o nome do manipulador, mas ele deve ser diferente de todos os outros nomes nessa subchave de tipo.</span><span class="sxs-lookup"><span data-stu-id="e70ed-484">The Shell does not use the handler's name, but it must be different from all other names under that type subkey.</span></span> <span data-ttu-id="e70ed-485">Defina o valor padrão da subchave Name para a forma de cadeia de caracteres do GUID do manipulador.</span><span class="sxs-lookup"><span data-stu-id="e70ed-485">Set the default value of the name subkey to the string form of the handler's GUID.</span></span>

<span data-ttu-id="e70ed-486">O exemplo a seguir ilustra as entradas do registro que habilitam manipuladores de extensão de folha de propriedades e menu de atalho, usando um tipo de arquivo de exemplo. MYP:</span><span class="sxs-lookup"><span data-stu-id="e70ed-486">The following example illustrates registry entries that enable shortcut menu and property sheet extension handlers, using an example .myp file type:</span></span>

```
HKEY_CLASSES_ROOT
   .myp
      (Default) = MyProgram.1
   CLSID
      {00000000-1111-2222-3333-444444444444}
         InProcServer32
            (Default) = C:\MyDir\MyCommand.dll
            ThreadingModel = Apartment
      {11111111-2222-3333-4444-555555555555}
         InProcServer32
            (Default) = C:\MyDir\MyPropSheet.dll
            ThreadingModel = Apartment
   MyProgram.1
      (Default) = MyProgram Application
      Shellex
         ContextMenuHandler
            MyCommand
               (Default) = {00000000-1111-2222-3333-444444444444}
         PropertySheetHandlers
            MyPropSheet
               (Default) = {11111111-2222-3333-4444-555555555555}
```

<span data-ttu-id="e70ed-487">O procedimento de registro discutido nesta seção deve ser seguido para todos os sistemas Windows.</span><span class="sxs-lookup"><span data-stu-id="e70ed-487">The registration procedure discussed in this section must be followed for all Windows systems.</span></span>

## <a name="related-topics"></a><span data-ttu-id="e70ed-488">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="e70ed-488">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e70ed-489">Diretrizes para implementar extensões de In-Process</span><span class="sxs-lookup"><span data-stu-id="e70ed-489">Guidance for Implementing In-Process Extensions</span></span>](shell-and-managed-code.md)
</dt> </dl>

 

 
