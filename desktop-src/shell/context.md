---
description: Clicar com o botão direito do mouse em um objeto normalmente causa a exibição de um menu de atalho. Esse menu contém uma lista de comandos que o usuário pode selecionar para executar várias ações no objeto. Esta seção é uma introdução aos menus de atalho para objetos do sistema de arquivos.
ms.assetid: d951d1e8-0f88-49c4-8373-e6db0e18cd72
title: Estendendo menus de atalho
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 895550ff050d559b3523676ddaa2a58099398a97
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104557912"
---
# <a name="extending-shortcut-menus"></a><span data-ttu-id="8a9fb-105">Estendendo menus de atalho</span><span class="sxs-lookup"><span data-stu-id="8a9fb-105">Extending Shortcut Menus</span></span>

<span data-ttu-id="8a9fb-106">Clicar com o botão direito do mouse em um objeto normalmente causa a exibição de um *menu de atalho*.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-106">Right-clicking an object normally causes the display of a *shortcut menu*.</span></span> <span data-ttu-id="8a9fb-107">Esse menu contém uma lista de comandos que o usuário pode selecionar para executar várias ações no objeto.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-107">This menu contains a list of commands that the user can select to perform various actions on the object.</span></span> <span data-ttu-id="8a9fb-108">Esta seção é uma introdução aos menus de atalho para objetos do sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-108">This section is an introduction to shortcut menus for file system objects.</span></span>

-   [<span data-ttu-id="8a9fb-109">Menus de atalho para objetos do sistema de arquivos</span><span class="sxs-lookup"><span data-stu-id="8a9fb-109">Shortcut Menus for File System Objects</span></span>](#shortcut-menus-for-file-system-objects)
-   [<span data-ttu-id="8a9fb-110">Verbos do menu de atalho</span><span class="sxs-lookup"><span data-stu-id="8a9fb-110">Shortcut Menu Verbs</span></span>](#shortcut-menu-verbs)
    -   [<span data-ttu-id="8a9fb-111">Verbos canônicos</span><span class="sxs-lookup"><span data-stu-id="8a9fb-111">Canonical Verbs</span></span>](#canonical-verbs)
    -   [<span data-ttu-id="8a9fb-112">Verbos estendidos</span><span class="sxs-lookup"><span data-stu-id="8a9fb-112">Extended Verbs</span></span>](#extended-verbs)
-   [<span data-ttu-id="8a9fb-113">Estendendo o menu de atalho para um tipo de arquivo</span><span class="sxs-lookup"><span data-stu-id="8a9fb-113">Extending the Shortcut Menu for a File Type</span></span>](#extending-the-shortcut-menu-for-a-file-type)
-   [<span data-ttu-id="8a9fb-114">Estendendo o menu de atalho para objetos shell predefinidos</span><span class="sxs-lookup"><span data-stu-id="8a9fb-114">Extending the Shortcut Menu for Predefined Shell Objects</span></span>](#extending-the-shortcut-menu-for-predefined-shell-objects)
-   [<span data-ttu-id="8a9fb-115">Registrando um aplicativo para lidar com tipos de arquivo arbitrários</span><span class="sxs-lookup"><span data-stu-id="8a9fb-115">Registering an Application to Handle Arbitrary File Types</span></span>](#registering-an-application-to-handle-arbitrary-file-types)
-   [<span data-ttu-id="8a9fb-116">Estendendo o novo submenu</span><span class="sxs-lookup"><span data-stu-id="8a9fb-116">Extending the New Submenu</span></span>](#extending-the-new-submenu)

<span data-ttu-id="8a9fb-117">Informações adicionais estão disponíveis aqui:</span><span class="sxs-lookup"><span data-stu-id="8a9fb-117">Additional information is available here:</span></span>

-   [<span data-ttu-id="8a9fb-118">Como definir verbos estendidos</span><span class="sxs-lookup"><span data-stu-id="8a9fb-118">How To Define Extended Verbs</span></span>](how-to-define-extended-verbs.md)
-   [<span data-ttu-id="8a9fb-119">Como associar verbos a comandos DDE</span><span class="sxs-lookup"><span data-stu-id="8a9fb-119">How To Associate Verbs with DDE Commands</span></span>](how-to-associate-verbs-with-dde-commands.md)

## <a name="shortcut-menus-for-file-system-objects"></a><span data-ttu-id="8a9fb-120">Menus de atalho para objetos do sistema de arquivos</span><span class="sxs-lookup"><span data-stu-id="8a9fb-120">Shortcut Menus for File System Objects</span></span>

<span data-ttu-id="8a9fb-121">Quando um usuário clica com o botão direito do mouse em um objeto, como um arquivo, que é exibido no Windows Explorer ou na área de trabalho, um menu de atalho é exibido com uma lista de comandos.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-121">When a user right-clicks an object, such as a file, that is displayed in Windows Explorer or on the desktop, a shortcut menu appears with a list of commands.</span></span> <span data-ttu-id="8a9fb-122">Em seguida, o usuário pode executar uma ação no arquivo, como abri-lo ou excluí-lo, selecionando o comando apropriado.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-122">The user can then perform an action on the file, such as opening or deleting it, by selecting the appropriate command.</span></span>

<span data-ttu-id="8a9fb-123">Como os menus de atalho são frequentemente usados para gerenciamento de arquivos, o Shell fornece um conjunto de comandos padrão, como recortar e copiar, que aparecem no menu de atalho para qualquer arquivo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-123">Because shortcut menus are often used for file management, the Shell provides a set of default commands, such as Cut and Copy, that appear on the shortcut menu for any file.</span></span> <span data-ttu-id="8a9fb-124">Observe que, embora o Open with seja um comando padrão, ele não é exibido para alguns tipos de arquivo padrão, como. wav.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-124">Note that although Open With is a default command, it is not displayed for some standard file types, such as .wav.</span></span> <span data-ttu-id="8a9fb-125">A ilustração a seguir do diretório de exemplo meus documentos, que também foi usado como exemplo na [personalização de ícones](icon.md), mostra um menu de atalho padrão que foi exibido ao clicar com o botão direito do mouse em MyDocs4.xyz.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-125">The following illustration of the sample My Documents directory, which was also used as an example in [Customizing Icons](icon.md), shows a default shortcut menu that was displayed by right-clicking MyDocs4.xyz.</span></span>

![captura de tela do menu de atalho padrão para objetos do sistema de arquivos](images/context1.jpg)

<span data-ttu-id="8a9fb-127">O motivo pelo qual o MyDocs4.xyz mostra um menu de atalho padrão é que ele não é membro de um [tipo de arquivo](fa-file-types.md)registrado.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-127">The reason that MyDocs4.xyz shows a default shortcut menu is that it is not a member of a registered [file type](fa-file-types.md).</span></span> <span data-ttu-id="8a9fb-128">Por outro lado,. txt é um tipo de arquivo registrado.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-128">On the other hand, .txt is a registered file type.</span></span> <span data-ttu-id="8a9fb-129">Se você clicar com o botão direito do mouse em um dos arquivos. txt, verá um menu de atalho com dois comandos adicionais na seção superior: **abrir** e **Imprimir**.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-129">If you right-click one of the .txt files, you will instead see a shortcut menu with two additional commands in its upper section: **Open** and **Print**.</span></span>

![captura de tela do menu de atalho personalizado para objetos do sistema de arquivos](images/context2.jpg)

<span data-ttu-id="8a9fb-131">Depois que um tipo de arquivo é registrado, você pode estender seu menu de atalho com comandos adicionais.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-131">Once a file type is registered, you can extend its shortcut menu with additional commands.</span></span> <span data-ttu-id="8a9fb-132">Eles são exibidos acima dos comandos padrão quando qualquer arquivo desse tipo é clicado com o botão direito do mouse.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-132">They are displayed above the default commands when any file of that type is right-clicked.</span></span> <span data-ttu-id="8a9fb-133">Embora a maioria dos comandos adicionados dessa maneira sejam comuns, como **Imprimir** ou **abrir**, você tem a liberdade de adicionar qualquer comando que um usuário possa achar útil.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-133">Although most of the commands added in this way are common ones, such as **Print** or **Open**, you are free to add any command that a user might find helpful.</span></span>

<span data-ttu-id="8a9fb-134">Tudo o que é necessário para estender o menu de atalho para um tipo de arquivo é criar uma entrada de registro para cada comando.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-134">All that is required to extend the shortcut menu for a file type is to create a registry entry for each command.</span></span> <span data-ttu-id="8a9fb-135">Uma abordagem mais sofisticada é implementar um *manipulador de menu de atalho*, que permite estender o menu de atalho para um tipo de arquivo de acordo com o arquivo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-135">A more sophisticated approach is to implement a *shortcut menu handler*, which allows you to extend the shortcut menu for a file type on a file-by-file basis.</span></span> <span data-ttu-id="8a9fb-136">Para obter mais informações, consulte [criando manipuladores de menu de contexto](context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="8a9fb-136">For more information, see [Creating Context Menu Handlers](context-menu-handlers.md).</span></span>

## <a name="shortcut-menu-verbs"></a><span data-ttu-id="8a9fb-137">Verbos do menu de atalho</span><span class="sxs-lookup"><span data-stu-id="8a9fb-137">Shortcut Menu Verbs</span></span>

<span data-ttu-id="8a9fb-138">Cada comando no menu de atalho é identificado no registro por seu *verbo*.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-138">Each command on the shortcut menu is identified in the registry by its *verb*.</span></span> <span data-ttu-id="8a9fb-139">Esses verbos são os mesmos usados pelo [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa) ao iniciar aplicativos programaticamente.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-139">These verbs are the same as those used by [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa) when launching applications programmatically.</span></span> <span data-ttu-id="8a9fb-140">Para obter mais informações sobre o uso de **ShellExecuteEx**, consulte a discussão em [iniciando aplicativos](launch.md).</span><span class="sxs-lookup"><span data-stu-id="8a9fb-140">For further information about the use of **ShellExecuteEx**, see the discussion in [Launching Applications](launch.md).</span></span>

<span data-ttu-id="8a9fb-141">Um verbo é uma cadeia de caracteres de texto simples que é usada pelo shell para identificar o comando associado.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-141">A verb is a simple text string that is used by the Shell to identify the associated command.</span></span> <span data-ttu-id="8a9fb-142">Cada verbo corresponde à *cadeia de caracteres de comando* usada para iniciar o comando em uma janela de console ou arquivo de lote (. bat).</span><span class="sxs-lookup"><span data-stu-id="8a9fb-142">Each verb corresponds to the *command string* used to launch the command in a console window or batch (.bat) file.</span></span> <span data-ttu-id="8a9fb-143">Por exemplo, o verbo **Open** normalmente inicia um programa para abrir um arquivo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-143">For example, the **open** verb normally launches a program to open a file.</span></span> <span data-ttu-id="8a9fb-144">Em geral, sua cadeia de caracteres de comando é semelhante a:</span><span class="sxs-lookup"><span data-stu-id="8a9fb-144">Its command string typically looks something like this:</span></span>

``` syntax
"My Program.exe" "%1"
```

<span data-ttu-id="8a9fb-145">"%1" é o espaço reservado padrão para um parâmetro de linha de comando fornecido com o nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-145">"%1" is the standard placeholder for a command line parameter provided with the filename.</span></span> <span data-ttu-id="8a9fb-146">Por exemplo, ele pode especificar uma página específica para ser exibida em uma exibição com guias.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-146">For instance, it can specify a particular page to display in a tabbed view.</span></span>

> [!Note]  
> <span data-ttu-id="8a9fb-147">Se qualquer elemento da cadeia de caracteres de comando contiver ou puder conter espaços, ele deverá ser colocado entre aspas.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-147">If any element of the command string contains or might contain spaces, it must be enclosed in quotation marks.</span></span> <span data-ttu-id="8a9fb-148">Caso contrário, se o elemento contiver um espaço, ele não será analisado corretamente.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-148">Otherwise, if the element contains a space, it will not parse correctly.</span></span> <span data-ttu-id="8a9fb-149">Por exemplo, "meu Program.exe" iniciará o aplicativo corretamente.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-149">For instance, "My Program.exe" will launch the application properly.</span></span> <span data-ttu-id="8a9fb-150">Se você usar meu Program.exe, o sistema tentará iniciar "My" com "Program.exe" como seu primeiro argumento de linha de comando.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-150">If you use My Program.exe, the system will attempt to launch "My" with "Program.exe" as its first command line argument.</span></span> <span data-ttu-id="8a9fb-151">Você sempre deve usar aspas com argumentos como "%1" que são expandidos para cadeias de caracteres pelo shell, pois não é possível ter certeza de que a cadeia de caracteres não conterá um espaço.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-151">You should always use quotation marks with arguments such as "%1" that are expanded to strings by the Shell, because you cannot be certain that the string will not contain a space.</span></span>

 

<span data-ttu-id="8a9fb-152">Os verbos também podem ter uma *cadeia de caracteres de exibição* associada a eles, que é exibida no menu de atalho em vez da própria cadeia de caracteres de verbo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-152">Verbs can also have a *display string* associated with them, which is displayed on the shortcut menu instead of the verb string itself.</span></span> <span data-ttu-id="8a9fb-153">Por exemplo, a cadeia de caracteres de exibição para **openas** é aberta com.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-153">For example, the display string for **openas** is Open With.</span></span> <span data-ttu-id="8a9fb-154">Como as cadeias de menu normais, incluindo um e comercial (&) na cadeia de caracteres de exibição permite a seleção de teclado do comando.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-154">Like normal menu strings, including an ampersand (&) in the display string allows keyboard selection of the command.</span></span>

### <a name="canonical-verbs"></a><span data-ttu-id="8a9fb-155">Verbos canônicos</span><span class="sxs-lookup"><span data-stu-id="8a9fb-155">Canonical Verbs</span></span>

<span data-ttu-id="8a9fb-156">Em geral, os aplicativos são responsáveis por fornecer cadeias de caracteres de exibição localizadas para os verbos que eles definem.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-156">In general, applications are responsible for providing localized display strings for the verbs they define.</span></span> <span data-ttu-id="8a9fb-157">No entanto, para fornecer um grau de independência de idioma, o sistema define um conjunto padrão de verbos usados comumente chamados de *verbos canônicos*.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-157">However, to provide a degree of language independence, the system defines a standard set of commonly used verbs called *canonical verbs*.</span></span> <span data-ttu-id="8a9fb-158">Um verbo canônico pode ser usado com qualquer linguagem e o sistema gera automaticamente uma cadeia de caracteres de exibição localizada corretamente.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-158">A canonical verb can be used with any language, and the system automatically generates a properly localized display string.</span></span> <span data-ttu-id="8a9fb-159">Por exemplo, a cadeia de caracteres de exibição do verbo **aberto** será definida como aberta em um sistema em inglês e para öffnen em um sistema em alemão.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-159">For instance, the **open** verb's display string will be set to Open on an English system, and to Öffnen on a German system.</span></span>

<span data-ttu-id="8a9fb-160">Os verbos canônicos incluem:</span><span class="sxs-lookup"><span data-stu-id="8a9fb-160">The canonical verbs include:</span></span>



| <span data-ttu-id="8a9fb-161">Valor</span><span class="sxs-lookup"><span data-stu-id="8a9fb-161">Value</span></span>      | <span data-ttu-id="8a9fb-162">Descrição</span><span class="sxs-lookup"><span data-stu-id="8a9fb-162">Description</span></span>                                                                                 |
|------------|---------------------------------------------------------------------------------------------|
| <span data-ttu-id="8a9fb-163">Abrir</span><span class="sxs-lookup"><span data-stu-id="8a9fb-163">open</span></span>       | <span data-ttu-id="8a9fb-164">Abre o arquivo ou a pasta.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-164">Opens the file or folder.</span></span>                                                                   |
| <span data-ttu-id="8a9fb-165">opennew</span><span class="sxs-lookup"><span data-stu-id="8a9fb-165">opennew</span></span>    | <span data-ttu-id="8a9fb-166">Abre o arquivo ou a pasta em uma nova janela.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-166">Opens the file or folder in a new window.</span></span>                                                   |
| <span data-ttu-id="8a9fb-167">print</span><span class="sxs-lookup"><span data-stu-id="8a9fb-167">print</span></span>      | <span data-ttu-id="8a9fb-168">Imprime o arquivo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-168">Prints the file.</span></span>                                                                            |
| <span data-ttu-id="8a9fb-169">explorar</span><span class="sxs-lookup"><span data-stu-id="8a9fb-169">explore</span></span>    | <span data-ttu-id="8a9fb-170">Abre o Windows Explorer com a pasta selecionada.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-170">Opens Windows Explorer with the folder selected.</span></span>                                            |
| <span data-ttu-id="8a9fb-171">localizar</span><span class="sxs-lookup"><span data-stu-id="8a9fb-171">find</span></span>       | <span data-ttu-id="8a9fb-172">Abre a caixa de diálogo **pesquisa do Windows** com a pasta definida como o local de pesquisa padrão.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-172">Opens the **Windows Search** dialog box with the folder set as the default search location.</span></span> |
| <span data-ttu-id="8a9fb-173">openas</span><span class="sxs-lookup"><span data-stu-id="8a9fb-173">openas</span></span>     | <span data-ttu-id="8a9fb-174">Abre a caixa de diálogo **abrir com** .</span><span class="sxs-lookup"><span data-stu-id="8a9fb-174">Opens the **Open With** dialog box.</span></span>                                                         |
| <span data-ttu-id="8a9fb-175">properties</span><span class="sxs-lookup"><span data-stu-id="8a9fb-175">properties</span></span> | <span data-ttu-id="8a9fb-176">Abre a folha de propriedades do objeto.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-176">Opens the object's property sheet.</span></span>                                                          |



 

<span data-ttu-id="8a9fb-177">O verbo Printto também é canônico, mas nunca é exibido.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-177">The printto verb is also canonical but is never displayed.</span></span> <span data-ttu-id="8a9fb-178">Ele permite que o usuário imprima um arquivo arrastando-o para um objeto de impressora.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-178">It allows the user to print a file by dragging it to a printer object.</span></span>

### <a name="extended-verbs"></a><span data-ttu-id="8a9fb-179">Verbos estendidos</span><span class="sxs-lookup"><span data-stu-id="8a9fb-179">Extended Verbs</span></span>

<span data-ttu-id="8a9fb-180">Quando o usuário clica com o botão direito do mouse em um objeto, o menu de atalho contém todos os verbos normais.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-180">When the user right-clicks an object, the shortcut menu contains all the normal verbs.</span></span> <span data-ttu-id="8a9fb-181">No entanto, pode haver comandos para os quais você deseja dar suporte, mas que não tenham sido exibidos em todos os menus de atalho.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-181">However, there could be commands that you want to support but not have displayed on every shortcut menu.</span></span> <span data-ttu-id="8a9fb-182">Por exemplo, você pode ter comandos que não são comumente usados ou que se destinam a usuários experientes.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-182">For example, you could have commands that are not commonly used or that are intended for experienced users.</span></span> <span data-ttu-id="8a9fb-183">Por esse motivo, você também pode definir um ou mais *verbos estendidos*.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-183">For this reason, you can also define one or more *extended verbs*.</span></span> <span data-ttu-id="8a9fb-184">Esses verbos também são cadeias de caracteres e são semelhantes aos verbos normais.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-184">These verbs are also character strings and are similar to normal verbs.</span></span> <span data-ttu-id="8a9fb-185">Eles são diferenciados de verbos normais pela maneira como são registrados.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-185">They are distinguished from normal verbs by the way they are registered.</span></span> <span data-ttu-id="8a9fb-186">Para ter acesso aos comandos associados a verbos estendidos, o usuário deve clicar com o botão direito do mouse em um objeto enquanto pressiona a tecla SHIFT.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-186">To have access to the commands associated with extended verbs, the user must right-click an object while pressing the SHIFT key.</span></span> <span data-ttu-id="8a9fb-187">Os verbos estendidos serão exibidos juntamente com os verbos normais.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-187">The extended verbs will then be displayed along with the normal verbs.</span></span>

## <a name="extending-the-shortcut-menu-for-a-file-type"></a><span data-ttu-id="8a9fb-188">Estendendo o menu de atalho para um tipo de arquivo</span><span class="sxs-lookup"><span data-stu-id="8a9fb-188">Extending the Shortcut Menu for a File Type</span></span>

<span data-ttu-id="8a9fb-189">A maneira mais simples de estender o menu de atalho para um tipo de arquivo é com o registro.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-189">The simplest way to extend the shortcut menu for a file type is with the registry.</span></span> <span data-ttu-id="8a9fb-190">Para fazer isso, adicione uma subchave de **shell** abaixo da chave do ProgID do aplicativo associado ao [tipo de arquivo](fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="8a9fb-190">To do this, add a **Shell** subkey below the key for the ProgID of the application associated with the [file type](fa-file-types.md).</span></span> <span data-ttu-id="8a9fb-191">Opcionalmente, você pode definir um *verbo padrão* para o tipo de arquivo, tornando-o o valor padrão da subchave **shell** .</span><span class="sxs-lookup"><span data-stu-id="8a9fb-191">Optionally, you can define a *default verb* for the file type by making it the default value of the **Shell** subkey.</span></span>

<span data-ttu-id="8a9fb-192">O verbo padrão é exibido primeiro no menu de atalho.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-192">The default verb is displayed first on the shortcut menu.</span></span> <span data-ttu-id="8a9fb-193">Sua finalidade é fornecer ao shell um verbo que ele possa usar quando [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa) é chamado, mas nenhum verbo é especificado.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-193">Its purpose is to provide the Shell with a verb it can use when [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa) is called but no verb is specified.</span></span> <span data-ttu-id="8a9fb-194">O shell não seleciona necessariamente o verbo padrão quando **ShellExecuteEx** é usado dessa maneira.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-194">The Shell does not necessarily select the default verb when **ShellExecuteEx** is used in this fashion.</span></span> <span data-ttu-id="8a9fb-195">Para versões do Shell [5,0](versions.md) e posteriores, encontradas no Windows 2000 e sistemas posteriores, o Shell usa o primeiro verbo disponível da lista a seguir.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-195">For Shell [versions 5.0](versions.md) and later, found on Windows 2000 and later systems, the Shell uses the first available verb from the following list.</span></span> <span data-ttu-id="8a9fb-196">Se nenhum estiver disponível, a operação falhará.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-196">If none are available, the operation fails.</span></span>

-   <span data-ttu-id="8a9fb-197">O verbo abrir</span><span class="sxs-lookup"><span data-stu-id="8a9fb-197">The open verb</span></span>
-   <span data-ttu-id="8a9fb-198">O verbo padrão</span><span class="sxs-lookup"><span data-stu-id="8a9fb-198">The default verb</span></span>
-   <span data-ttu-id="8a9fb-199">O primeiro verbo no registro</span><span class="sxs-lookup"><span data-stu-id="8a9fb-199">The first verb in the registry</span></span>
-   <span data-ttu-id="8a9fb-200">O verbo OpenWith</span><span class="sxs-lookup"><span data-stu-id="8a9fb-200">The openwith verb</span></span>

<span data-ttu-id="8a9fb-201">Para versões do Shell anteriores à [versão 5,0](versions.md), omita o terceiro item.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-201">For Shell versions prior to [version 5.0](versions.md), omit the third item.</span></span>

<span data-ttu-id="8a9fb-202">Abaixo da subchave do **shell** , crie uma subchave para cada verbo que você deseja adicionar.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-202">Below the **Shell** subkey, create one subkey for each verb you want to add.</span></span> <span data-ttu-id="8a9fb-203">Cada uma dessas subchaves terá um valor do **reg \_ sz** definido como a cadeia de caracteres de exibição do verbo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-203">Each of these subkeys will have a **REG\_SZ** value set to the verb's display string.</span></span> <span data-ttu-id="8a9fb-204">Você pode omitir a cadeia de caracteres de exibição para verbos canônicos, pois o sistema exibirá automaticamente uma cadeia de caracteres localizada corretamente.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-204">You can omit the display string for canonical verbs because the system will automatically display a properly localized string.</span></span> <span data-ttu-id="8a9fb-205">Se você omitir a cadeia de caracteres de exibição para verbos não Canon, a cadeia de caracteres de verbo será exibida.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-205">If you omit the display string for noncanonical verbs, the verb string will be displayed.</span></span> <span data-ttu-id="8a9fb-206">Para cada subchave de verbo, crie uma subchave de **comando** com o valor padrão definido como a cadeia de caracteres de comando.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-206">For each verb subkey, create a **command** subkey with the default value set to the command string.</span></span>

<span data-ttu-id="8a9fb-207">A ilustração a seguir mostra um menu de atalho para o tipo de arquivo. MYP usado em [tipos de arquivo](fa-file-types.md) e [personalização de ícones](icon.md).</span><span class="sxs-lookup"><span data-stu-id="8a9fb-207">The following illustration shows a shortcut menu for the .myp file type used in [File Types](fa-file-types.md) and [Customizing Icons](icon.md).</span></span> <span data-ttu-id="8a9fb-208">Agora, ele tem verbos Open, doit, Print e Printto em seu menu de atalho, com doit como o verbo padrão.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-208">It now has open, doit, print, and printto verbs on its shortcut menu, with doit as the default verb.</span></span> <span data-ttu-id="8a9fb-209">O menu de atalho é semelhante a este.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-209">The shortcut menu looks like this.</span></span>

![captura de tela do menu de atalho personalizado](images/context3.jpg)

<span data-ttu-id="8a9fb-211">As entradas do registro usadas para estender o menu de atalho mostrado na ilustração anterior são:</span><span class="sxs-lookup"><span data-stu-id="8a9fb-211">The registry entries used to extend the shortcut menu shown in the preceding illustration are:</span></span>

```
HKEY_CLASSES_ROOT
   .myp
      (Default) = MyProgram.1
   MyProgram.1
      (Default) = MyProgram Application
      Shell
         (Default) = doit
         open
            command
               (Default) = C:\MyDir\MyProgram.exe "%1"
         doit
            (Default) = &Do It
            command
               (Default) = C:\MyDir\MyProgram.exe /d "%1"
         print
            command
               (Default) = C:\MyDir\MyProgram.exe /p "%1"
         printto
            command
               (Default) = C:\MyDir\MyProgram.exe /p "%1" "%2" %3 %4
```

<span data-ttu-id="8a9fb-212">Embora o comando **Open with** esteja acima do primeiro separador, ele é criado automaticamente pelo sistema e não requer uma entrada de registro.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-212">Although the **Open With** command is above the first separator, it is automatically created by the system and does not require a registry entry.</span></span> <span data-ttu-id="8a9fb-213">O sistema cria automaticamente nomes de exibição para os verbos canônicos abertos e impressos.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-213">The system automatically creates display names for the canonical verbs open and print.</span></span> <span data-ttu-id="8a9fb-214">Como doit não é um verbo canônico, ele recebe um nome de exibição, "&fazer", que pode ser selecionado pressionando a tecla D.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-214">Because doit is not a canonical verb, it is assigned a display name, "&Do It", which can be selected by pressing the D key.</span></span> <span data-ttu-id="8a9fb-215">O verbo Printto não aparece no menu de atalho, mas incluí-lo permite que o usuário imprima arquivos soltando-os em um ícone de impressora.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-215">The printto verb does not appear on the shortcut menu, but including it allows the user to print files by dropping them on a printer icon.</span></span> <span data-ttu-id="8a9fb-216">Neste exemplo, %1 representa o nome do arquivo e %2 o nome da impressora.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-216">In this example, %1 represents the file name and %2 the printer name.</span></span>

<span data-ttu-id="8a9fb-217">Os verbos podem ser suprimidos por meio de configurações de política adicionando um valor SuppressionPolicy à chave do verbo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-217">Verbs can be suppressed through policy settings by adding a SuppressionPolicy value to the verb's key.</span></span> <span data-ttu-id="8a9fb-218">Defina o valor de SuppressionPolicy como a ID da política.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-218">Set the value of SuppressionPolicy to the policy ID.</span></span> <span data-ttu-id="8a9fb-219">Se a política for ativada, o verbo e sua entrada de menu de atalho associada serão suprimidos.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-219">If the policy is turned on, the verb and its associated shortcut menu entry are suppressed.</span></span> <span data-ttu-id="8a9fb-220">Para obter possíveis valores de ID de política, consulte a enumeração de [**restrições**](/windows/desktop/api/shlobj_core/ne-shlobj_core-restrictions) .</span><span class="sxs-lookup"><span data-stu-id="8a9fb-220">For possible policy ID values, see the [**RESTRICTIONS**](/windows/desktop/api/shlobj_core/ne-shlobj_core-restrictions) enumeration.</span></span>

## <a name="extending-the-shortcut-menu-for-predefined-shell-objects"></a><span data-ttu-id="8a9fb-221">Estendendo o menu de atalho para objetos shell predefinidos</span><span class="sxs-lookup"><span data-stu-id="8a9fb-221">Extending the Shortcut Menu for Predefined Shell Objects</span></span>

<span data-ttu-id="8a9fb-222">Muitos objetos de shell predefinidos têm menus de atalho que podem ser estendidos.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-222">Many predefined Shell objects have shortcut menus that can be extended.</span></span> <span data-ttu-id="8a9fb-223">Registre o comando praticamente da mesma maneira que você registra tipos de arquivo típicos, mas use o nome do objeto predefinido como o nome do tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-223">Register the command in much the same way that you register typical file types, but use the name of the predefined object as the file type name.</span></span>

<span data-ttu-id="8a9fb-224">Uma lista de objetos predefinidos pode ser encontrada na seção *objetos do Shell predefinidos* de [criando manipuladores de extensão do Shell](handlers.md).</span><span class="sxs-lookup"><span data-stu-id="8a9fb-224">A list of predefined objects can be found in the *Predefined Shell Objects* section of [Creating Shell Extension Handlers](handlers.md).</span></span> <span data-ttu-id="8a9fb-225">Esses objetos de shell predefinidos cujos menus de atalho podem ser estendidos com a adição de verbos no registro são marcados na tabela com a palavra "verbo".</span><span class="sxs-lookup"><span data-stu-id="8a9fb-225">Those predefined Shell objects whose shortcut menus can be extended by adding verbs in the registry are marked in the table with the word "Verb."</span></span>

## <a name="registering-an-application-to-handle-arbitrary-file-types"></a><span data-ttu-id="8a9fb-226">Registrando um aplicativo para lidar com tipos de arquivo arbitrários</span><span class="sxs-lookup"><span data-stu-id="8a9fb-226">Registering an Application to Handle Arbitrary File Types</span></span>

<span data-ttu-id="8a9fb-227">As seções anteriores deste documento discutiram como definir itens de menu de atalho para um determinado tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-227">The preceding sections of this document have discussed how to define shortcut menu items for a particular file type.</span></span> <span data-ttu-id="8a9fb-228">Entre outras coisas, definir o menu de atalho permite que você especifique como o aplicativo associado abre um membro do tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-228">Among other things, defining the shortcut menu allows you to specify how the associated application opens a member of the file type.</span></span> <span data-ttu-id="8a9fb-229">No entanto, como discutido em [tipos de arquivo](fa-file-types.md), os aplicativos também podem registrar um procedimento padrão separado a ser usado quando um usuário tenta usar seu aplicativo para abrir um tipo de arquivo que você não associou ao aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-229">However, as discussed in [File Types](fa-file-types.md), applications can also register a separate default procedure to be used when a user attempts to use your application to open a file type that you have not associated with the application.</span></span> <span data-ttu-id="8a9fb-230">Este tópico é discutido aqui porque você registra o procedimento padrão da mesma maneira que registra itens de menu de atalho.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-230">This topic is discussed here because you register the default procedure in much the same way you register shortcut menu items.</span></span>

<span data-ttu-id="8a9fb-231">O procedimento padrão atende a duas finalidades básicas.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-231">The default procedure serves two basic purposes.</span></span> <span data-ttu-id="8a9fb-232">Uma é especificar como seu aplicativo deve ser chamado para abrir um tipo de arquivo arbitrário.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-232">One is to specify how your application should be invoked to open an arbitrary file type.</span></span> <span data-ttu-id="8a9fb-233">Você pode, por exemplo, usar um sinalizador de linha de comando para indicar que um tipo de arquivo desconhecido está sendo aberto.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-233">You could, for instance, use a command-line flag to indicate that an unknown file type is being opened.</span></span> <span data-ttu-id="8a9fb-234">A outra finalidade é definir as várias características de um tipo de arquivo, como os itens de menu de atalho e o ícone.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-234">The other purpose is to define the various characteristics of a file type, such as the shortcut menu items and the icon.</span></span> <span data-ttu-id="8a9fb-235">Se um usuário associar seu aplicativo a um tipo de arquivo adicional, esse tipo terá essas características.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-235">If a user associates your application with an additional file type, that type will have these characteristics.</span></span> <span data-ttu-id="8a9fb-236">Se o tipo de arquivo adicional tiver sido associado anteriormente a outro aplicativo, essas características substituirão os originais.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-236">If the additional file type was previously associated with another application, these characteristics will replace the originals.</span></span>

<span data-ttu-id="8a9fb-237">Para registrar o procedimento padrão, coloque as mesmas chaves do registro que você criou para o ProgID do seu aplicativo na subchave do aplicativo de aplicativos **\_ \_ raiz de classes hKey** \\ .</span><span class="sxs-lookup"><span data-stu-id="8a9fb-237">To register the default procedure, place the same registry keys you created for your application's ProgID under the application's subkey of **HKEY\_CLASSES\_ROOT**\\**Applications**.</span></span> <span data-ttu-id="8a9fb-238">Você também pode incluir um valor de FriendlyAppName para fornecer ao sistema um nome amigável para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-238">You can also include a FriendlyAppName value to provide the system with a friendly name for your application.</span></span> <span data-ttu-id="8a9fb-239">O nome amigável do aplicativo também pode ser extraído de seu arquivo executável, mas somente se o valor FriendlyAppName estiver ausente.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-239">The application's friendly name may also be extracted from its executable file, but only if the FriendlyAppName value is absent.</span></span> <span data-ttu-id="8a9fb-240">O fragmento do registro a seguir mostra um exemplo de procedimento padrão para MyProgram.exe que define um nome amigável e vários itens de menu de atalho.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-240">The following registry fragment shows a sample default procedure for MyProgram.exe that defines a friendly name and several shortcut menu items.</span></span> <span data-ttu-id="8a9fb-241">As cadeias de caracteres de comando incluem o sinalizador/a para notificar o aplicativo de que ele está abrindo um tipo de arquivo arbitrário.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-241">The command strings include the /a flag to notify the application that it is opening an arbitrary file type.</span></span> <span data-ttu-id="8a9fb-242">Se você incluir uma subchave **DefaultIcon** , deverá usar um ícone genérico.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-242">If you include a **DefaultIcon** subkey, you should use a generic icon.</span></span>

```
HKEY_CLASSES_ROOT
   Applications
      MyProgram.exe
         FriendlyAppName = Friendly Name
         shell
            open
               command
                  (Default) = C:\MyDir\MyProgram.exe /a "%1"
            print
               command
                  (Default) = C:\MyDir\MyProgram.exe /a /p "%1"
            printto
               command
                  (Default) = C:\MyDir\MyProgram.exe /a /p "%1" "%2" %3 %4
```

## <a name="extending-the-new-submenu"></a><span data-ttu-id="8a9fb-243">Estendendo o novo submenu</span><span class="sxs-lookup"><span data-stu-id="8a9fb-243">Extending the New Submenu</span></span>

<span data-ttu-id="8a9fb-244">Quando um usuário abre o menu **arquivo** no Windows Explorer, o primeiro comando é **novo**.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-244">When a user opens the **File** menu in Windows Explorer, the first command is **New**.</span></span> <span data-ttu-id="8a9fb-245">A seleção desse comando exibe um submenu.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-245">Selecting this command displays a submenu.</span></span> <span data-ttu-id="8a9fb-246">Por padrão, ele contém dois comandos, **pasta** e **atalho**, que permitem aos usuários criar subpastas e atalhos.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-246">By default, it contains two commands, **Folder** and **Shortcut**, that allow users to create subfolders and shortcuts.</span></span> <span data-ttu-id="8a9fb-247">Esse submenu pode ser estendido para incluir comandos de criação de arquivo para qualquer tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-247">This submenu can be extended to include file creation commands for any file type.</span></span>

<span data-ttu-id="8a9fb-248">Para adicionar um comando de criação de arquivo ao **novo** submenu, os arquivos do aplicativo devem ter um [tipo de arquivo](fa-file-types.md) associado a eles.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-248">To add a file-creation command to the **New** submenu, your application's files must have a [file type](fa-file-types.md) associated with them.</span></span> <span data-ttu-id="8a9fb-249">Inclua uma subchave **ShellNew** sob a chave para a extensão de nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-249">Include a **ShellNew** subkey under the key for the file name extension.</span></span> <span data-ttu-id="8a9fb-250">Quando o comando **novo** do menu **arquivo** for selecionado, o Shell irá adicioná-lo ao **novo** submenu.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-250">When the **File** menu's **New** command is selected, the Shell will add it to the **New** submenu.</span></span> <span data-ttu-id="8a9fb-251">A cadeia de caracteres de exibição do comando será a cadeia de caracteres descritiva atribuída ao ProgID do programa.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-251">The command's display string will be the descriptive string that is assigned to the program's ProgID.</span></span>

<span data-ttu-id="8a9fb-252">Atribua um ou mais valores de dados à subchave **ShellNew** para especificar o método de criação de arquivo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-252">Assign one or more data values to the **ShellNew** subkey to specify the file creation method.</span></span> <span data-ttu-id="8a9fb-253">Os valores disponíveis são seguidos.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-253">The available values follow.</span></span>



| <span data-ttu-id="8a9fb-254">Valor</span><span class="sxs-lookup"><span data-stu-id="8a9fb-254">Value</span></span>    | <span data-ttu-id="8a9fb-255">Descrição</span><span class="sxs-lookup"><span data-stu-id="8a9fb-255">Description</span></span>                                                                                                                                                   |
|----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="8a9fb-256">Comando</span><span class="sxs-lookup"><span data-stu-id="8a9fb-256">Command</span></span>  | <span data-ttu-id="8a9fb-257">Executa um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-257">Executes an application.</span></span> <span data-ttu-id="8a9fb-258">Esse é um **valor \_ sz de reg** que especifica o caminho do aplicativo a ser executado.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-258">This is a **REG\_SZ** value specifying the path of the application to be executed.</span></span> <span data-ttu-id="8a9fb-259">Por exemplo, você pode defini-lo para iniciar um assistente.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-259">For example, you could set it to launch a wizard.</span></span> |
| <span data-ttu-id="8a9fb-260">Dados</span><span class="sxs-lookup"><span data-stu-id="8a9fb-260">Data</span></span>     | <span data-ttu-id="8a9fb-261">Cria um arquivo que contém os dados especificados.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-261">Creates a file containing specified data.</span></span> <span data-ttu-id="8a9fb-262">Os dados são um valor **\_ binário reg** com os dados do arquivo.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-262">Data is a **REG\_BINARY** value with the file's data.</span></span> <span data-ttu-id="8a9fb-263">Os dados serão ignorados se Nullfile ou FileName forem especificados.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-263">Data is ignored if either NullFile or FileName is specified.</span></span>  |
| <span data-ttu-id="8a9fb-264">FileName</span><span class="sxs-lookup"><span data-stu-id="8a9fb-264">FileName</span></span> | <span data-ttu-id="8a9fb-265">Cria um arquivo que é uma cópia de um arquivo especificado.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-265">Creates a file that is a copy of a specified file.</span></span> <span data-ttu-id="8a9fb-266">FileName é um **valor \_ sz de reg** , definido como o caminho totalmente qualificado do arquivo a ser copiado.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-266">FileName is a **REG\_SZ** value, set to the fully qualified path of the file to be copied.</span></span>                 |
| <span data-ttu-id="8a9fb-267">Valor nulo</span><span class="sxs-lookup"><span data-stu-id="8a9fb-267">NullFile</span></span> | <span data-ttu-id="8a9fb-268">Cria um arquivo vazio.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-268">Creates an empty file.</span></span> <span data-ttu-id="8a9fb-269">Nullfile não é atribuído a um valor.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-269">NullFile is not assigned a value.</span></span> <span data-ttu-id="8a9fb-270">Se Nullfile for especificado, os valores de data e FileName serão ignorados.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-270">If NullFile is specified, the Data and FileName values are ignored.</span></span>                                  |



 

<span data-ttu-id="8a9fb-271">A ilustração a seguir mostra o **novo** submenu para o tipo de arquivo. MYP usado como um exemplo em [tipos de arquivo](fa-file-types.md) e personalização de [ícones](icon.md).</span><span class="sxs-lookup"><span data-stu-id="8a9fb-271">The following illustration shows the **New** submenu for the .myp file type used as an example in [File Types](fa-file-types.md) and [Customizing Icons](icon.md).</span></span> <span data-ttu-id="8a9fb-272">Agora, ele tem um comando, **aplicativo myprogram**.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-272">It now has a command, **MyProgram Application**.</span></span> <span data-ttu-id="8a9fb-273">Quando um usuário seleciona o **aplicativo myprogram** no **novo** submenu, o Shell cria um arquivo chamado "New myprogram Application. MYP" e o passa para MyProgram.exe.</span><span class="sxs-lookup"><span data-stu-id="8a9fb-273">When a user selects **MyProgram Application** from the **New** submenu, the Shell creates a file named "New MyProgram Application.myp" and passes it to MyProgram.exe.</span></span>

![captura de tela do menu novo personalizado](images/context5.png)

<span data-ttu-id="8a9fb-275">A entrada do registro agora é a seguinte:</span><span class="sxs-lookup"><span data-stu-id="8a9fb-275">The registry entry is now as follows:</span></span>

```
HKEY_CLASSES_ROOT
   .myp
      (Default) = MyProgram.1
      MyProgram.1
         ShellNew
            NullFile
   MyProgram.1
      (Default) = MyProgram Application
      DefaultIcon
         (Default) = C:\MyDir\MyProgram.exe,2
      Shell
         (Default) = doit
         open
            command
               (Default) = C:\MyDir\MyProgram.exe "%1"
         doit
            (Default) = &Do It
            command
               (Default) = C:\MyDir\MyProgram.exe /d "%1"
         print
            command
               (Default) = C:\MyDir\MyProgram.exe /p "%1"
         printto
            command
               (Default) = C:\MyDir\MyProgram.exe /p "%1" "%2" %3 %4
```

 

 



