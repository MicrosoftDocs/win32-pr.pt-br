---
description: Este conjunto de tópicos discute como implementar os manipuladores de extensão que permitem modificar uma variedade de ações de Shell.
ms.assetid: 794b6369-665f-49a9-a263-7c736c5ce8ac
title: Trabalhando com extensões de Shell
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dbb696f4536cdb0fb6869be073771d431bd8d2de
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104968175"
---
# <a name="working-with-shell-extensions"></a><span data-ttu-id="90607-103">Trabalhando com extensões de Shell</span><span class="sxs-lookup"><span data-stu-id="90607-103">Working with Shell Extensions</span></span>

<span data-ttu-id="90607-104">Os recursos do Shell podem ser estendidos com entradas de registro e arquivos. ini.</span><span class="sxs-lookup"><span data-stu-id="90607-104">The capabilities of the Shell can be extended with registry entries and .ini files.</span></span> <span data-ttu-id="90607-105">Embora essa abordagem para estender o shell seja simples e adequada para muitas finalidades, ela é limitada.</span><span class="sxs-lookup"><span data-stu-id="90607-105">While this approach to extending the Shell is simple, and adequate for many purposes, it is limited.</span></span> <span data-ttu-id="90607-106">Por exemplo, se você usar o registro para especificar um ícone personalizado para um tipo de arquivo, o mesmo ícone será exibido para cada arquivo desse tipo.</span><span class="sxs-lookup"><span data-stu-id="90607-106">For example, if you use the registry to specify a custom icon for a file type, the same icon will appear for every file of that type.</span></span> <span data-ttu-id="90607-107">Estender o shell com o registro não permite que você varie o ícone para diferentes membros do tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="90607-107">Extending the Shell with the registry does not allow you to vary the icon for different members of the file type.</span></span> <span data-ttu-id="90607-108">Outros aspectos do Shell, como a folha de propriedades **Propriedades** que podem ser exibidas quando um arquivo é clicado com o botão direito do mouse, não podem ser modificados com o registro.</span><span class="sxs-lookup"><span data-stu-id="90607-108">Other aspects of the Shell, such as the **Properties** property sheet that can be displayed when a file is right-clicked, cannot be modified at all with the registry.</span></span>

<span data-ttu-id="90607-109">Uma abordagem mais poderosa e flexível para estender o Shell é implementar *manipuladores de extensão de shell*.</span><span class="sxs-lookup"><span data-stu-id="90607-109">A more powerful and flexible approach to extending the Shell is to implement *shell extension handlers*.</span></span> <span data-ttu-id="90607-110">Esses manipuladores podem ser implementados para uma variedade de ações que o Shell pode executar.</span><span class="sxs-lookup"><span data-stu-id="90607-110">These handlers can be implemented for a variety of actions that the Shell can take.</span></span> <span data-ttu-id="90607-111">Antes de executar a ação, o Shell consulta o manipulador de extensão, dando a ele a oportunidade de modificar a ação.</span><span class="sxs-lookup"><span data-stu-id="90607-111">Before taking the action, the Shell queries the extension handler, giving it the opportunity to modify the action.</span></span> <span data-ttu-id="90607-112">Um exemplo comum é um manipulador de extensão de menu de atalho.</span><span class="sxs-lookup"><span data-stu-id="90607-112">A common example is a shortcut menu extension handler.</span></span> <span data-ttu-id="90607-113">Se um for implementado para um tipo de arquivo, ele será consultado toda vez que um dos arquivos for clicado com o botão direito do mouse.</span><span class="sxs-lookup"><span data-stu-id="90607-113">If one is implemented for a file type, it will be queried every time one of the files is right-clicked.</span></span> <span data-ttu-id="90607-114">O manipulador pode, então, especificar itens de menu adicionais de acordo com o arquivo, em vez de ter o mesmo conjunto para todos os arquivos desse tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="90607-114">The handler can then specify additional menu items on a file-by-file basis, rather than having the same set for all files of that file type.</span></span>

<span data-ttu-id="90607-115">Este conjunto de tópicos discute como implementar os manipuladores de extensão que permitem modificar uma variedade de ações de Shell.</span><span class="sxs-lookup"><span data-stu-id="90607-115">This set of topics discusses how to implement the extension handlers that allow you to modify a variety of Shell actions.</span></span> <span data-ttu-id="90607-116">Os manipuladores a seguir estão associados a um tipo de arquivo específico e permitem que você especifique em uma base arquivo por arquivo.</span><span class="sxs-lookup"><span data-stu-id="90607-116">The following handlers are associated with a particular file type and allow you to specify on a file-by-file basis.</span></span>



| <span data-ttu-id="90607-117">Manipulador</span><span class="sxs-lookup"><span data-stu-id="90607-117">Handler</span></span>                                               | <span data-ttu-id="90607-118">Descrição</span><span class="sxs-lookup"><span data-stu-id="90607-118">Description</span></span>                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="90607-119">Manipulador de menu de atalho</span><span class="sxs-lookup"><span data-stu-id="90607-119">Shortcut menu handler</span></span>](context-menu-handlers.md)    | <span data-ttu-id="90607-120">Chamado antes de o menu de atalho de um arquivo ser exibido.</span><span class="sxs-lookup"><span data-stu-id="90607-120">Called before a file's shortcut menu is displayed.</span></span> <span data-ttu-id="90607-121">Ele permite que você adicione itens ao menu de atalho de acordo com o arquivo.</span><span class="sxs-lookup"><span data-stu-id="90607-121">It enables you to add items to the shortcut menu on a file-by-file basis.</span></span>                                               |
| [<span data-ttu-id="90607-122">Manipulador de dados</span><span class="sxs-lookup"><span data-stu-id="90607-122">Data handler</span></span>](how-to-create-data-handlers.md)       | <span data-ttu-id="90607-123">Chamado quando uma operação de arrastar e soltar é executada em objetos do Shell.</span><span class="sxs-lookup"><span data-stu-id="90607-123">Called when a drag-and-drop operation is performed on Shell objects.</span></span> <span data-ttu-id="90607-124">Ele permite que você forneça formatos de área de transferência adicionais para o destino de soltar.</span><span class="sxs-lookup"><span data-stu-id="90607-124">It enables you to provide additional clipboard formats to the drop target.</span></span>                            |
| [<span data-ttu-id="90607-125">Descartar manipulador</span><span class="sxs-lookup"><span data-stu-id="90607-125">Drop handler</span></span>](how-to-create-drop-handlers.md)       | <span data-ttu-id="90607-126">Chamado quando um objeto de dados é arrastado ou solto em um arquivo.</span><span class="sxs-lookup"><span data-stu-id="90607-126">Called when a data object is dragged over or dropped on a file.</span></span> <span data-ttu-id="90607-127">Ele permite que você faça um arquivo em um destino de soltura.</span><span class="sxs-lookup"><span data-stu-id="90607-127">It enables you to make a file into a drop target.</span></span>                                                          |
| [<span data-ttu-id="90607-128">Manipulador de ícone</span><span class="sxs-lookup"><span data-stu-id="90607-128">Icon handler</span></span>](how-to-create-icon-handlers.md)       | <span data-ttu-id="90607-129">Chamado antes do ícone de um arquivo ser exibido.</span><span class="sxs-lookup"><span data-stu-id="90607-129">Called before a file's icon is displayed.</span></span> <span data-ttu-id="90607-130">Ele permite que você substitua o ícone padrão do arquivo por um ícone personalizado em cada arquivo.</span><span class="sxs-lookup"><span data-stu-id="90607-130">It enables you to replace the file's default icon with a custom icon on a file-by-file basis.</span></span>                                    |
| [<span data-ttu-id="90607-131">Manipulador de folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="90607-131">Property sheet handler</span></span>](propsheet-handlers.md)      | <span data-ttu-id="90607-132">Chamado antes da exibição da folha de propriedades de **Propriedades** de um objeto.</span><span class="sxs-lookup"><span data-stu-id="90607-132">Called before an object's **Properties** property sheet is displayed.</span></span> <span data-ttu-id="90607-133">Ele permite que você adicione ou substitua páginas.</span><span class="sxs-lookup"><span data-stu-id="90607-133">It enables you to add or replace pages.</span></span>                                                              |
| [<span data-ttu-id="90607-134">**Manipulador de imagem em miniatura**</span><span class="sxs-lookup"><span data-stu-id="90607-134">**Thumbnail Image handler**</span></span>](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | <span data-ttu-id="90607-135">Fornece uma imagem para representar o item.</span><span class="sxs-lookup"><span data-stu-id="90607-135">Provides an image to represent the item.</span></span>                                                                                                                                   |
| [<span data-ttu-id="90607-136">**Manipulador de infodicas**</span><span class="sxs-lookup"><span data-stu-id="90607-136">**Infotip handler**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | <span data-ttu-id="90607-137">Fornece texto pop-up quando o usuário passa o ponteiro do mouse sobre o objeto.</span><span class="sxs-lookup"><span data-stu-id="90607-137">Provides pop-up text when the user hovers the mouse pointer over the object.</span></span>                                                                                               |
| [<span data-ttu-id="90607-138">**Manipulador de metadados**</span><span class="sxs-lookup"><span data-stu-id="90607-138">**Metadata handler**</span></span>](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage)       | <span data-ttu-id="90607-139">Fornece acesso de leitura e gravação a metadados (Propriedades) armazenados em um arquivo.</span><span class="sxs-lookup"><span data-stu-id="90607-139">Provides read and write access to metadata (properties) stored in a file.</span></span> <span data-ttu-id="90607-140">Isso pode ser usado para estender a exibição de detalhes, infotips, a página de propriedades e agrupar recursos.</span><span class="sxs-lookup"><span data-stu-id="90607-140">This can be used to extend the Details view, infotips, the property page, and grouping features.</span></span> |



 

<span data-ttu-id="90607-141">Outros não estão associados a um tipo de arquivo específico, mas são chamados antes de algumas operações de Shell.</span><span class="sxs-lookup"><span data-stu-id="90607-141">Others are not associated with a particular file type but are called before some Shell operations.</span></span>



| <span data-ttu-id="90607-142">Manipulador</span><span class="sxs-lookup"><span data-stu-id="90607-142">Handler</span></span>                                                            | <span data-ttu-id="90607-143">Descrição</span><span class="sxs-lookup"><span data-stu-id="90607-143">Description</span></span>                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="90607-144">Manipulador de coluna</span><span class="sxs-lookup"><span data-stu-id="90607-144">Column handler</span></span>](../lwef/column-handlers.md)                             | <span data-ttu-id="90607-145">Chamado pelo Windows Explorer antes de exibir a exibição de detalhes de uma pasta.</span><span class="sxs-lookup"><span data-stu-id="90607-145">Called by Windows Explorer before it displays the Details view of a folder.</span></span> <span data-ttu-id="90607-146">Ele permite que você adicione colunas personalizadas à exibição de detalhes.</span><span class="sxs-lookup"><span data-stu-id="90607-146">It enables you to add custom columns to the Details view.</span></span>        |
| [<span data-ttu-id="90607-147">Copiar manipulador de gancho</span><span class="sxs-lookup"><span data-stu-id="90607-147">Copy hook handler</span></span>](how-to-create-copy-hook-handlers.md)          | <span data-ttu-id="90607-148">Chamado quando um objeto de pasta ou de impressora está prestes a ser movido, copiado, excluído ou renomeado.</span><span class="sxs-lookup"><span data-stu-id="90607-148">Called when a folder or printer object is about to be moved, copied, deleted, or renamed.</span></span> <span data-ttu-id="90607-149">Ele permite que você aprove ou veta a operação.</span><span class="sxs-lookup"><span data-stu-id="90607-149">It enables you to approve or veto the operation.</span></span>   |
| [<span data-ttu-id="90607-150">Manipulador do tipo "arrastar e soltar"</span><span class="sxs-lookup"><span data-stu-id="90607-150">Drag-and-drop handler</span></span>](context-menu-handlers.md)                 | <span data-ttu-id="90607-151">Chamado quando um arquivo é arrastado com o botão direito do mouse.</span><span class="sxs-lookup"><span data-stu-id="90607-151">Called when a file is dragged with the right mouse button.</span></span> <span data-ttu-id="90607-152">Ele permite que você modifique o menu de atalho que é exibido.</span><span class="sxs-lookup"><span data-stu-id="90607-152">It enables you to modify the shortcut menu that is displayed.</span></span>                     |
| [<span data-ttu-id="90607-153">Manipulador de sobreposição de ícone</span><span class="sxs-lookup"><span data-stu-id="90607-153">Icon Overlay handler</span></span>](how-to-implement-icon-overlay-handlers.md) | <span data-ttu-id="90607-154">Chamado antes do ícone de um arquivo ser exibido.</span><span class="sxs-lookup"><span data-stu-id="90607-154">Called before a file's icon is displayed.</span></span> <span data-ttu-id="90607-155">Ele permite que você especifique uma sobreposição para o ícone do arquivo.</span><span class="sxs-lookup"><span data-stu-id="90607-155">It enables you to specify an overlay for the file's icon.</span></span>                                          |
| [<span data-ttu-id="90607-156">Manipulador de pesquisa</span><span class="sxs-lookup"><span data-stu-id="90607-156">Search handler</span></span>](../lwef/search-handlers.md)                             | <span data-ttu-id="90607-157">Chamado para iniciar um mecanismo de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="90607-157">Called to launch a search engine.</span></span> <span data-ttu-id="90607-158">Ele permite que você implemente um mecanismo de pesquisa personalizado acessível no menu **Iniciar** ou no Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="90607-158">It enables you to implement a custom search engine accessible from the **Start** menu or Windows Explorer.</span></span> |



 

<span data-ttu-id="90607-159">Os detalhes de como implementar manipuladores de extensão específicos são abordados nas seções listadas acima.</span><span class="sxs-lookup"><span data-stu-id="90607-159">The details of how to implement specific extension handlers are covered in the sections listed above.</span></span> <span data-ttu-id="90607-160">Para discussões sobre problemas de implementação que são comuns a todos os manipuladores de extensão do Shell, consulte estes tópicos:</span><span class="sxs-lookup"><span data-stu-id="90607-160">For discussions of implementation issues that are common to all Shell extension handlers, see these topics:</span></span>

-   [<span data-ttu-id="90607-161">Inicializando manipuladores de extensão do Shell</span><span class="sxs-lookup"><span data-stu-id="90607-161">Initializing Shell Extension Handlers</span></span>](int-shell-exts.md)
-   [<span data-ttu-id="90607-162">Registrando manipuladores de extensão do Shell</span><span class="sxs-lookup"><span data-stu-id="90607-162">Registering Shell Extension Handlers</span></span>](reg-shell-exts.md)

 

 
