---
description: Um Gerenciador de transações (TM) é uma instância de um log. No KTM, os objetos TM especificam o log e algumas das funcionalidades do TM. Normalmente, há muitos objetos TM em um nó específico. Os gerenciadores de recursos (RMs) devem ser associados a um TM específico.
ms.assetid: 8d43977a-84cf-4109-b7db-f9c94a226c5d
title: Gerenciadores de transações
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 313215816642201c75ae5f0facae3bf98799c8d1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105759489"
---
# <a name="transaction-managers"></a><span data-ttu-id="57327-106">Gerenciadores de transações</span><span class="sxs-lookup"><span data-stu-id="57327-106">Transaction Managers</span></span>

<span data-ttu-id="57327-107">Um Gerenciador de transações (TM) é uma instância de um log.</span><span class="sxs-lookup"><span data-stu-id="57327-107">A transaction manager (TM) is an instance of a log.</span></span> <span data-ttu-id="57327-108">No KTM, os objetos TM especificam o log e algumas das funcionalidades do TM.</span><span class="sxs-lookup"><span data-stu-id="57327-108">In KTM, the TM objects specify the log and some of the functionality of the TM.</span></span> <span data-ttu-id="57327-109">Normalmente, há muitos objetos TM em um nó específico.</span><span class="sxs-lookup"><span data-stu-id="57327-109">There are typically many TM objects on a particular node.</span></span> <span data-ttu-id="57327-110">Os gerenciadores de recursos (RMs) devem ser associados a um TM específico.</span><span class="sxs-lookup"><span data-stu-id="57327-110">Resource managers (RMs) must be associated with a specific TM.</span></span> <span data-ttu-id="57327-111">Há três tipos de TMs:</span><span class="sxs-lookup"><span data-stu-id="57327-111">There are three types of TMs:</span></span>

-   <span data-ttu-id="57327-112">Um volátil TM, que não tem nenhum log.</span><span class="sxs-lookup"><span data-stu-id="57327-112">A volatile TM, which has no log.</span></span>
-   <span data-ttu-id="57327-113">Um TM normal, que tem um log e é usado para coordenar as transações de um ou mais RMs.</span><span class="sxs-lookup"><span data-stu-id="57327-113">A regular TM, which has a log and is used to coordinate the transactions of one or more RMs.</span></span>
-   <span data-ttu-id="57327-114">Um Gerenciador de transações superior.</span><span class="sxs-lookup"><span data-stu-id="57327-114">A superior transaction manager.</span></span>

## <a name="volatile-transaction-managers"></a><span data-ttu-id="57327-115">Gerenciadores de transações voláteis</span><span class="sxs-lookup"><span data-stu-id="57327-115">Volatile Transaction Managers</span></span>

<span data-ttu-id="57327-116">Um volátil TM é um TM para somente leitura ou volátil do RMs.</span><span class="sxs-lookup"><span data-stu-id="57327-116">A volatile TM is a TM for read-only or volatile RMs.</span></span> <span data-ttu-id="57327-117">Ele não tem um log e não mantém o estado das transações entre as reinicializações do sistema.</span><span class="sxs-lookup"><span data-stu-id="57327-117">It does not have a log and does not persist the state of transactions across system restarts.</span></span>

## <a name="transaction-managers"></a><span data-ttu-id="57327-118">Gerenciadores de transações</span><span class="sxs-lookup"><span data-stu-id="57327-118">Transaction Managers</span></span>

<span data-ttu-id="57327-119">TMs têm um log, um ou mais RMs durável ou volátil, ou ambos.</span><span class="sxs-lookup"><span data-stu-id="57327-119">TMs have a log, one or more durable or volatile RMs, or both.</span></span> <span data-ttu-id="57327-120">O TM persistirá o estado de uma transação entre reinicializações do sistema até que as transações sejam concluídas.</span><span class="sxs-lookup"><span data-stu-id="57327-120">The TM will persist the state of a transaction across system restarts until the transactions are completed.</span></span> <span data-ttu-id="57327-121">Um modelo de anulação presumido é usado, de modo que as transações que estavam ativas, mas não preparadas quando o objeto TM é desligado, são revertidas.</span><span class="sxs-lookup"><span data-stu-id="57327-121">A presumed-abort model is used, so transactions which were active but not prepared when the TM object is shut down are rolled back.</span></span> <span data-ttu-id="57327-122">Ao abrir um TM pela primeira vez, você deve recuperar o TM chamando a função [**RecoverTransactionManager**](/windows/desktop/api/Ktmw32/nf-ktmw32-recovertransactionmanager) .</span><span class="sxs-lookup"><span data-stu-id="57327-122">When you open a TM for the first time, you must recover the TM by calling the [**RecoverTransactionManager**](/windows/desktop/api/Ktmw32/nf-ktmw32-recovertransactionmanager) function.</span></span>

## <a name="superior-transaction-managers"></a><span data-ttu-id="57327-123">Gerenciadores de transações superiores</span><span class="sxs-lookup"><span data-stu-id="57327-123">Superior Transaction Managers</span></span>

<span data-ttu-id="57327-124">Uma TM superior é uma TM para outros TMs.</span><span class="sxs-lookup"><span data-stu-id="57327-124">A superior TM is a TM for other TMs.</span></span> <span data-ttu-id="57327-125">Ele coordena transações.</span><span class="sxs-lookup"><span data-stu-id="57327-125">It coordinates transactions.</span></span> <span data-ttu-id="57327-126">Ele também emite notificações de **\_ \_ preparação de notificação de transação** para o KTM (kernel Transaction Manager).</span><span class="sxs-lookup"><span data-stu-id="57327-126">It also issues **TRANSACTION\_NOTIFY\_PREPARE** notifications to the Kernel Transaction Manager (KTM).</span></span> <span data-ttu-id="57327-127">Um exemplo de TM superior é o Microsoft Coordenador de Transações Distribuídas (DTC).</span><span class="sxs-lookup"><span data-stu-id="57327-127">An example of a superior TM is the Microsoft Distributed Transaction Coordinator (DTC).</span></span> <span data-ttu-id="57327-128">Essa capacidade vem com uma responsabilidade de tempo de recuperação adicional.</span><span class="sxs-lookup"><span data-stu-id="57327-128">This ability comes with an added recovery-time responsibility.</span></span> <span data-ttu-id="57327-129">Durante a recuperação, o RM deve primeiro chamar a função [**OpenEnlistment**](/windows/desktop/api/Ktmw32/nf-ktmw32-openenlistment) para reabrir a inscrição.</span><span class="sxs-lookup"><span data-stu-id="57327-129">During recovery, the RM must first call the [**OpenEnlistment**](/windows/desktop/api/Ktmw32/nf-ktmw32-openenlistment) function to re-open the enlistment.</span></span> <span data-ttu-id="57327-130">Ele também deve entregar (ou entregar novamente) o resultado da transação se a transação foi confirmada; é gratuito fornecer um resultado chamando a função [**CommitTransaction**](/windows/desktop/api/Ktmw32/nf-ktmw32-committransaction) ou a função [**RollbackTransaction**](/windows/desktop/api/Ktmw32/nf-ktmw32-rollbacktransaction) .</span><span class="sxs-lookup"><span data-stu-id="57327-130">It must also deliver (or re-deliver) the transaction's outcome if the transaction was committed; it is free to deliver an outcome by calling either the [**CommitTransaction**](/windows/desktop/api/Ktmw32/nf-ktmw32-committransaction) function or the [**RollbackTransaction**](/windows/desktop/api/Ktmw32/nf-ktmw32-rollbacktransaction) function.</span></span> <span data-ttu-id="57327-131">Essa obrigação não termina até que tenha recebido um evento de notificação de **confirmação de transação associada \_ \_ \_ concluída** ou de **\_ \_ reversão \_** da reinício de notificação de transação. Se uma TM superior falhar em executar essas operações no momento da recuperação, o KTM limpará todas as transações que não receberam resultados no final da fase de recuperação.</span><span class="sxs-lookup"><span data-stu-id="57327-131">This obligation does not end until it has received an associated **TRANSACTION\_NOTIFY\_COMMIT\_COMPLETE** or **TRANSACTION\_NOTIFY\_ROLLBACK\_COMPLETE** notification event.If a superior TM fails to perform these operations at recovery time, the KTM will clean up any transactions that have not received outcomes by the end of the recovery phase.</span></span> <span data-ttu-id="57327-132">No entanto, isso pode resultar em resultados de transação inconsistentes.</span><span class="sxs-lookup"><span data-stu-id="57327-132">However, this can result in inconsistent transaction outcomes.</span></span>

## <a name="transaction-manager-functions"></a><span data-ttu-id="57327-133">Funções do Gerenciador de transações</span><span class="sxs-lookup"><span data-stu-id="57327-133">Transaction Manager Functions</span></span>

<span data-ttu-id="57327-134">As funções a seguir são usadas com gerenciadores de transações.</span><span class="sxs-lookup"><span data-stu-id="57327-134">The following functions are used with transaction managers.</span></span>



| <span data-ttu-id="57327-135">Função</span><span class="sxs-lookup"><span data-stu-id="57327-135">Function</span></span>                                                                            | <span data-ttu-id="57327-136">Descrição</span><span class="sxs-lookup"><span data-stu-id="57327-136">Description</span></span>                                                                                    |
|-------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="57327-137">**Createtransactionmanager**</span><span class="sxs-lookup"><span data-stu-id="57327-137">**CreateTransactionManager**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-createtransactionmanager)                        | <span data-ttu-id="57327-138">Cria um novo objeto do Gerenciador de transações (TM) e retorna um identificador com o acesso especificado.</span><span class="sxs-lookup"><span data-stu-id="57327-138">Creates a new transaction manager (TM) object and returns a handle with the specified access.</span></span>  |
| [<span data-ttu-id="57327-139">**GetCurrentClockTransactionManager**</span><span class="sxs-lookup"><span data-stu-id="57327-139">**GetCurrentClockTransactionManager**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-getcurrentclocktransactionmanager) | <span data-ttu-id="57327-140">Obtém um valor de relógio virtual de um Gerenciador de transações.</span><span class="sxs-lookup"><span data-stu-id="57327-140">Obtains a virtual clock value from a transaction manager.</span></span>                                      |
| [<span data-ttu-id="57327-141">**GetTransactionManagerId**</span><span class="sxs-lookup"><span data-stu-id="57327-141">**GetTransactionManagerId**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-gettransactionmanagerid)                          | <span data-ttu-id="57327-142">Obtém um identificador para o Gerenciador de transações especificado.</span><span class="sxs-lookup"><span data-stu-id="57327-142">Obtains an identifier for the specified transaction manager.</span></span>                                   |
| [<span data-ttu-id="57327-143">**OpenTransactionManager**</span><span class="sxs-lookup"><span data-stu-id="57327-143">**OpenTransactionManager**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-opentransactionmanager)                            | <span data-ttu-id="57327-144">Abre um Gerenciador de transações existente.</span><span class="sxs-lookup"><span data-stu-id="57327-144">Opens an existing transaction manager.</span></span>                                                         |
| [<span data-ttu-id="57327-145">**RecoverTransactionManager**</span><span class="sxs-lookup"><span data-stu-id="57327-145">**RecoverTransactionManager**</span></span>](/windows/desktop/api/Ktmw32/nf-ktmw32-recovertransactionmanager)                      | <span data-ttu-id="57327-146">Recupera o estado de um Gerenciador de transações de seu arquivo de log.</span><span class="sxs-lookup"><span data-stu-id="57327-146">Recovers a transaction manager's state from its log file.</span></span>                                      |
| [<span data-ttu-id="57327-147">**RollforwardTransactionManager**</span><span class="sxs-lookup"><span data-stu-id="57327-147">**RollforwardTransactionManager**</span></span>](/windows/desktop/api/KtmW32/nf-ktmw32-rollforwardtransactionmanager)              | <span data-ttu-id="57327-148">Recupera o estado de um Gerenciador de transações de seu arquivo de log para o valor de relógio virtual especificado.</span><span class="sxs-lookup"><span data-stu-id="57327-148">Recovers a transaction manager's state from its log file to the specified virtual clock value.</span></span> |



 

 

 



