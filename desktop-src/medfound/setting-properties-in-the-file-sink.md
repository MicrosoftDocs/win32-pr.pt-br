---
description: Saiba mais sobre como definir propriedades no coletor de arquivos ASF, que um aplicativo pode usar para arquivar dados de mídia ASF em um arquivo.
ms.assetid: a47caabd-23e3-4d22-b4b6-5fdb79d62ca1
title: Definindo propriedades no coletor de arquivos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 64b6b000ed04c7858251f7388d3edc6a40e0b213
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/19/2021
ms.locfileid: "112407509"
---
# <a name="setting-properties-in-the-file-sink"></a><span data-ttu-id="cdaaa-103">Definindo propriedades no coletor de arquivos</span><span class="sxs-lookup"><span data-stu-id="cdaaa-103">Setting Properties in the File Sink</span></span>

<span data-ttu-id="cdaaa-104">O coletor de arquivos ASF é uma implementação de [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) fornecida pelo Media Foundation que um aplicativo pode usar para arquivar dados de mídia ASF em um arquivo.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-104">The ASF file sink is an implementation of [**IMFMediaSink**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) provided by Media Foundation that an application can use to archive ASF media data to a file.</span></span> <span data-ttu-id="cdaaa-105">Para obter informações sobre o modelo de objeto do coletor de mídia ASF e o uso geral, consulte [coletores de mídia ASF](asf-media-sinks.md).</span><span class="sxs-lookup"><span data-stu-id="cdaaa-105">For information about ASF Media Sinks' object model and general usage, see [ASF Media Sinks](asf-media-sinks.md).</span></span>

<span data-ttu-id="cdaaa-106">Depois de [criar o coletor de arquivo ASF](creating-the-asf-file-sink.md), ele deve ser configurado com informações sobre os fluxos no arquivo de saída.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-106">After [Creating the ASF file sink](creating-the-asf-file-sink.md), it must be configured with information about the streams in the output file.</span></span> <span data-ttu-id="cdaaa-107">Esse procedimento é descrito em [adicionando informações de fluxo ao coletor de arquivo ASF](adding-stream-information-to-the-asf-file-sink.md).</span><span class="sxs-lookup"><span data-stu-id="cdaaa-107">This procedure is described in [Adding Stream Information to the ASF File Sink](adding-stream-information-to-the-asf-file-sink.md).</span></span> <span data-ttu-id="cdaaa-108">Você pode definir propriedades adicionais no coletor de arquivos dependendo do tipo de codificação; buckets vazados; Propriedades gerais do arquivo.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-108">You can set additional properties on the file sink depending on the type of encoding; leaky buckets; general file properties.</span></span> <span data-ttu-id="cdaaa-109">Essas configurações não são gravadas no objeto de cabeçalho ASF final.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-109">These settings are not written in the final ASF Header Object.</span></span> <span data-ttu-id="cdaaa-110">Este tópico descreve o processo de adicionar essas propriedades no repositório de propriedades do coletor de arquivos.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-110">This topic describes process of adding these properties in the file sink's property store.</span></span>

<span data-ttu-id="cdaaa-111">O objeto ContentInfo mantém as propriedades de arquivo global e as propriedades de fluxo individuais para o coletor de arquivos.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-111">The ContentInfo object maintains the global file properties and individual stream properties for the file sink.</span></span> <span data-ttu-id="cdaaa-112">Para obter informações sobre como obter uma referência ao objeto ASF ContentInfo do coletor de arquivos, consulte [criando o coletor de arquivo ASF](creating-the-asf-file-sink.md).</span><span class="sxs-lookup"><span data-stu-id="cdaaa-112">For information about getting a reference to the file sink's ASF ContentInfo object, see [Creating the ASF File Sink](creating-the-asf-file-sink.md).</span></span>

<span data-ttu-id="cdaaa-113">Para obter uma referência ao repositório de propriedades do coletor de arquivos ([**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore)), chame [**IMFASFContentInfo:: GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) na referência do objeto ContentInfo do coletor de arquivos.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-113">To get a reference to the file sink's property store ([**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore)), call [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) on the file sink's ContentInfo object's reference.</span></span>

## <a name="stream-encoding-properties"></a><span data-ttu-id="cdaaa-114">Propriedades de codificação de fluxo</span><span class="sxs-lookup"><span data-stu-id="cdaaa-114">Stream Encoding Properties</span></span>

<span data-ttu-id="cdaaa-115">Para codificar o conteúdo corretamente, o arquivo precisa saber certas informações de codificação, como tipo de codificação e os parâmetros de codificação relacionados.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-115">To encode content properly the file needs to know certain encoding information such as type of encoding and the related encoding parameters.</span></span> <span data-ttu-id="cdaaa-116">Esses valores são definidos no coletor de arquivos como valores de propriedade em um repositório de propriedades que é mantido pelo objeto ContentInfo do ASF.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-116">These values are set on the file sink as property values in a property store that is maintained by the ASF ContentInfo object.</span></span> <span data-ttu-id="cdaaa-117">Se você estiver configurando o coletor de arquivos antes de instanciar os codificadores relevantes, poderá usar o objeto ContentInfo com todas as propriedades preenchidas para criar os codificadores de mídia do Windows.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-117">If you are configuring the file sink before instantiating the relevant encoders, you can use the ContentInfo object with all the populated properties to create the Windows Media encoders.</span></span> <span data-ttu-id="cdaaa-118">Nesse caso, as propriedades são definidas automaticamente nos codificadores instanciados.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-118">In this case, the properties are automatically set on the instantiated encoders.</span></span> <span data-ttu-id="cdaaa-119">Por outro lado, se você estiver criando os codificadores antes do coletor, certifique-se de que as propriedades definidas nos codificadores sejam copiadas no repositório de propriedades do coletor de arquivos.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-119">Conversely, if you are creating the encoders before the sink, make sure that the properties that you set on the encoders are copied into the file sink's property store.</span></span>

<span data-ttu-id="cdaaa-120">Para definir as propriedades de codificação, você precisa ter acesso ao armazenamento de propriedades no nível de fluxo do coletor de arquivos.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-120">To set encoding properties, you need access to the file sink's stream-level property store.</span></span> <span data-ttu-id="cdaaa-121">Passe o número do fluxo no parâmetro *wStreamNumber* do método [**IMFASFContentInfo:: GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) .</span><span class="sxs-lookup"><span data-stu-id="cdaaa-121">Pass the stream number in the *wStreamNumber* parameter of the [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) method.</span></span> <span data-ttu-id="cdaaa-122">Os números de fluxo devem corresponder aos valores definidos durante a configuração de cada fluxo no perfil.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-122">The stream numbers must match the values set while configuring each stream in the profile.</span></span> <span data-ttu-id="cdaaa-123">Os valores de propriedade são definidos chamando [**IPropertyStore:: SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span><span class="sxs-lookup"><span data-stu-id="cdaaa-123">Property values are set by calling [**IPropertyStore::SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span></span> <span data-ttu-id="cdaaa-124">A tabela a seguir descreve as propriedades com suporte.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-124">The following table describes the supported properties.</span></span>

<span data-ttu-id="cdaaa-125">As propriedades dependem do tipo de codificação.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-125">The properties depend on the type of encoding.</span></span> <span data-ttu-id="cdaaa-126">Para obter informações sobre as propriedades e os respectivos valores que você deve definir, consulte [Propriedades de codificação](configuring-the-encoder.md).</span><span class="sxs-lookup"><span data-stu-id="cdaaa-126">For information about the properties and the respective values that you must set, see [Encoding Properties](configuring-the-encoder.md).</span></span>

## <a name="leaky-bucket-property"></a><span data-ttu-id="cdaaa-127">Propriedade de Bucket vazado</span><span class="sxs-lookup"><span data-stu-id="cdaaa-127">Leaky Bucket Property</span></span>

<span data-ttu-id="cdaaa-128">Os parâmetros de Bucket de vazamento determinam a janela de buffer real usada pelo codificador para o fluxo.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-128">Leaky bucket parameters determine the actual buffer window used by the encoder for the stream.</span></span> <span data-ttu-id="cdaaa-129">A propriedade [**\_ LEAKYBUCKET MFPKEY ASFSTREAMSINK \_ corrigida \_**](mfpkey-asfstreamsink-corrected-leakybucket-property.md) do coletor de arquivos contém os parâmetros de Bucket de vazamento, a taxa de bits, a janela de buffer e a totalidade do buffer inicial. Essa propriedade é definida no repositório de propriedades de propriedade de nível de fluxo para o coletor de arquivo e deve ser definida depois que os codificadores tiverem sido criados e configurados.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-129">The file sink's [**MFPKEY\_ASFSTREAMSINK\_CORRECTED\_LEAKYBUCKET**](mfpkey-asfstreamsink-corrected-leakybucket-property.md) property contains the leaky bucket parameters, bit rate, buffer window, and initial buffer fullness.This property is set in the stream-level property property store for the file sink and must be set after encoders have been created and configured.</span></span> <span data-ttu-id="cdaaa-130">Esse valor é definido em.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-130">This value is set in the .</span></span> <span data-ttu-id="cdaaa-131">Durante a negociação do tipo de mídia, o codificador decide a janela de buffer e a taxa de bits a ser usada.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-131">During the media type negotiation, the encoder decides the buffer window and the bit rate to use.</span></span> <span data-ttu-id="cdaaa-132">Você pode obter esses valores usando a interface **IWMCodecLeakyBucket** , que é definida em wmcodecifaces. h, e você deve vincular a wmcodecdspuuid. lib para chamar seus métodos.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-132">You can get these values by using the **IWMCodecLeakyBucket** interface, which is defined in wmcodecifaces.h and you must link to wmcodecdspuuid.lib to call its methods.</span></span>

<span data-ttu-id="cdaaa-133">Os valores recuperados podem ser definidos para essa propriedade para cada fluxo no coletor de arquivo ASF.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-133">The retrieved values can be set for this property for each stream in the ASF file sink.</span></span>

## <a name="global-file-sink-properties"></a><span data-ttu-id="cdaaa-134">Propriedades do coletor de arquivo global</span><span class="sxs-lookup"><span data-stu-id="cdaaa-134">Global File Sink Properties</span></span>

<span data-ttu-id="cdaaa-135">Para obter o repositório de propriedades globais do coletor de arquivos, passe 0 no parâmetro *wStreamNumber* do método [**IMFASFContentInfo:: GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) .</span><span class="sxs-lookup"><span data-stu-id="cdaaa-135">To get the file sink's global property store, pass 0 in the *wStreamNumber* parameter of the [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) method.</span></span> <span data-ttu-id="cdaaa-136">Os valores de propriedade são definidos chamando [**IPropertyStore:: SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span><span class="sxs-lookup"><span data-stu-id="cdaaa-136">Property values are set by calling [**IPropertyStore::SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore).</span></span> <span data-ttu-id="cdaaa-137">A tabela a seguir descreve as propriedades com suporte.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-137">The following table describes the supported properties.</span></span>

| <span data-ttu-id="cdaaa-138">Propriedades de nível de arquivo</span><span class="sxs-lookup"><span data-stu-id="cdaaa-138">File-level Properties</span></span>                                                                                | <span data-ttu-id="cdaaa-139">Descrição</span><span class="sxs-lookup"><span data-stu-id="cdaaa-139">Description</span></span>                                                                                                                                                                                                                                                                                           |
|------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="cdaaa-140">**\_Enviar MFPKEY ASFMEDIASINK \_ base \_**</span><span class="sxs-lookup"><span data-stu-id="cdaaa-140">**MFPKEY\_ASFMEDIASINK\_BASE\_SENDTIME**</span></span>](mfpkey-asfmediasink-base-sendtime-property.md)           | <span data-ttu-id="cdaaa-141">O tempo de envio indica quando a carga dentro do Bucket de vazamento será liberada.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-141">The send time indicates when the payload inside the leaky bucket will be released.</span></span> <span data-ttu-id="cdaaa-142">Esse valor de propriedade indica a primeira hora de envio.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-142">This property value indicates the first send time.</span></span> <span data-ttu-id="cdaaa-143">O multiplexador usa esse valor para calcular os tempos de envio subsequentes para os pacotes gerados e garante que os dados fluem de forma estável por meio do Bucket vazado.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-143">The multiplexer uses this value to calculate the subsequent send times for the generated packets and ensures that data flows steadily through the leaky bucket.</span></span> |
| [<span data-ttu-id="cdaaa-144">**MFPKEY \_ ASFMEDIASINK \_ AutoAjuste de \_ taxa de bits**</span><span class="sxs-lookup"><span data-stu-id="cdaaa-144">**MFPKEY\_ASFMEDIASINK\_AUTOADJUST\_BITRATE**</span></span>](mfpkey-asfmediasink-autoadjust-bitrate-property.md) | <span data-ttu-id="cdaaa-145">Esse valor BOOL indica se o multiplexador precisa ajustar a taxa de bits automaticamente para garantir que os dados não estourem o Bucket de vazamentos.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-145">This BOOL value indicates whether the multiplexer needs to adjust the bit rate automatically to ensure that data does not overflow the leaky bucket.</span></span>                                                                                                                                                  |
| [<span data-ttu-id="cdaaa-146">**MFPKEY \_ ASFMEDIASINK \_ DRMACTION**</span><span class="sxs-lookup"><span data-stu-id="cdaaa-146">**MFPKEY\_ASFMEDIASINK\_DRMACTION**</span></span>](mfpkey-asfmediasink-drmaction-property.md)                    | <span data-ttu-id="cdaaa-147">Isso indica a ação de DRM do coletor de mídia do ASF para geração de arquivos.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-147">This indicates the ASF media sink DRM action for file generation.</span></span> <span data-ttu-id="cdaaa-148">Nesta versão, somente a transcodificação DRM tem suporte.</span><span class="sxs-lookup"><span data-stu-id="cdaaa-148">In this release, only DRM transcode is supported.</span></span>                                                                                                                                                                                   |



 

## <a name="related-topics"></a><span data-ttu-id="cdaaa-149">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="cdaaa-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cdaaa-150">Coletores de mídia ASF</span><span class="sxs-lookup"><span data-stu-id="cdaaa-150">ASF Media Sinks</span></span>](asf-media-sinks.md)
</dt> <dt>

[<span data-ttu-id="cdaaa-151">Componentes ASF da camada de pipeline</span><span class="sxs-lookup"><span data-stu-id="cdaaa-151">Pipeline Layer ASF Components</span></span>](pipeline-layer-asf-components.md)
</dt> <dt>

[<span data-ttu-id="cdaaa-152">Suporte a ASF no Media Foundation</span><span class="sxs-lookup"><span data-stu-id="cdaaa-152">ASF Support in Media Foundation</span></span>](asf-support-in-media-foundation.md)
</dt> </dl>

 

 
