---
description: Um objeto que encapsula vários DSPs relacionados à captura de voz.
ms.assetid: 6c77c8f6-289e-4130-b56a-e1f0bcc40f3e
title: DSP de captura de voz (Wmcodecdsp. h)
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 6e48c3b3194873008f45ef80ef3a21dad416158b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103661813"
---
# <a name="voice-capture-dsp"></a><span data-ttu-id="6256d-103">DSP de captura de voz</span><span class="sxs-lookup"><span data-stu-id="6256d-103">Voice Capture DSP</span></span>

<span data-ttu-id="6256d-104">Um objeto que encapsula vários DSPs relacionados à captura de voz.</span><span class="sxs-lookup"><span data-stu-id="6256d-104">An object that encapsulates several DSPs related to voice capture.</span></span>

## <a name="clsid"></a><span data-ttu-id="6256d-105">CLSID</span><span class="sxs-lookup"><span data-stu-id="6256d-105">CLSID</span></span>

<span data-ttu-id="6256d-106">\_CWMAUDIOAEC CLSID</span><span class="sxs-lookup"><span data-stu-id="6256d-106">CLSID\_CWMAudioAEC</span></span>

## <a name="interfaces"></a><span data-ttu-id="6256d-107">Interfaces</span><span class="sxs-lookup"><span data-stu-id="6256d-107">Interfaces</span></span>

-   [<span data-ttu-id="6256d-108">**IMediaObject**</span><span class="sxs-lookup"><span data-stu-id="6256d-108">**IMediaObject**</span></span>](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject)
-   <span data-ttu-id="6256d-109">**IPropertyStore**</span><span class="sxs-lookup"><span data-stu-id="6256d-109">**IPropertyStore**</span></span>

## <a name="properties"></a><span data-ttu-id="6256d-110">Propriedades</span><span class="sxs-lookup"><span data-stu-id="6256d-110">Properties</span></span>



| <span data-ttu-id="6256d-111">Propriedade</span><span class="sxs-lookup"><span data-stu-id="6256d-111">Property</span></span>                                                                                     | <span data-ttu-id="6256d-112">Descrição</span><span class="sxs-lookup"><span data-stu-id="6256d-112">Description</span></span>                                                                                       |
|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6256d-113">MFPKEY \_ \_ índices de dispositivo WMAAECMA \_</span><span class="sxs-lookup"><span data-stu-id="6256d-113">MFPKEY\_WMAAECMA\_DEVICE\_INDEXES</span></span>](mfpkey-wmaaecma-device-indexesproperty.md)              | <span data-ttu-id="6256d-114">Especifica quais dispositivos de áudio o DMO usa para capturar e renderizar áudio.</span><span class="sxs-lookup"><span data-stu-id="6256d-114">Specifies which audio devices the DMO uses for capturing and rendering audio.</span></span>                     |
| [<span data-ttu-id="6256d-115">MFPKEY \_ WMAAECMA \_ DEVICEPAIR \_ GUID</span><span class="sxs-lookup"><span data-stu-id="6256d-115">MFPKEY\_WMAAECMA\_DEVICEPAIR\_GUID</span></span>](mfpkey-wmaaecma-devicepair-guidproperty.md)            | <span data-ttu-id="6256d-116">Identifica a combinação de dispositivos de áudio que o aplicativo está usando no momento.</span><span class="sxs-lookup"><span data-stu-id="6256d-116">Identifies the combination of audio devices that the application is currently using.</span></span>              |
| [<span data-ttu-id="6256d-117">\_modo de origem MFPKEY WMAAECMA \_ DMO \_ \_</span><span class="sxs-lookup"><span data-stu-id="6256d-117">MFPKEY\_WMAAECMA\_DMO\_SOURCE\_MODE</span></span>](mfpkey-wmaaecma-dmo-source-modeproperty.md)           | <span data-ttu-id="6256d-118">Especifica se o DMO usa o modo de origem ou o modo de filtro.</span><span class="sxs-lookup"><span data-stu-id="6256d-118">Specifies whether the DMO uses source mode or filter mode.</span></span>                                        |
| [<span data-ttu-id="6256d-119">AES do MFPKEY \_ WMAAECMA \_ \_</span><span class="sxs-lookup"><span data-stu-id="6256d-119">MFPKEY\_WMAAECMA\_FEATR\_AES</span></span>](mfpkey-wmaaecma-featr-aesproperty.md)                        | <span data-ttu-id="6256d-120">Especifica quantas vezes o DMO executa a supressão de eco acústico (AES) no sinal residual.</span><span class="sxs-lookup"><span data-stu-id="6256d-120">Specifies how many times the DMO performs acoustic echo suppression (AES) on the residual signal.</span></span> |
| [<span data-ttu-id="6256d-121">\_AGC MFPKEY WMAAECMA \_ \_</span><span class="sxs-lookup"><span data-stu-id="6256d-121">MFPKEY\_WMAAECMA\_FEATR\_AGC</span></span>](mfpkey-wmaaecma-featr-agcproperty.md)                        | <span data-ttu-id="6256d-122">Especifica se o DMO executa o controle de lucro automático.</span><span class="sxs-lookup"><span data-stu-id="6256d-122">Specifies whether the DMO performs automatic gain control.</span></span>                                        |
| [<span data-ttu-id="6256d-123">\_clipe do \_ \_ Centro \_ do MFPKEY WMAAECMA</span><span class="sxs-lookup"><span data-stu-id="6256d-123">MFPKEY\_WMAAECMA\_FEATR\_CENTER\_CLIP</span></span>](mfpkey-wmaaecma-featr-center-clipproperty.md)       | <span data-ttu-id="6256d-124">Especifica se o DMO executa recorte de centro.</span><span class="sxs-lookup"><span data-stu-id="6256d-124">Specifies whether the DMO performs center clipping.</span></span>                                               |
| [<span data-ttu-id="6256d-125">MFPKEY \_ WMAAECMA com \_ comprimento de \_ eco \_</span><span class="sxs-lookup"><span data-stu-id="6256d-125">MFPKEY\_WMAAECMA\_FEATR\_ECHO\_LENGTH</span></span>](mfpkey-wmaaecma-featr-echo-lengthproperty.md)       | <span data-ttu-id="6256d-126">Especifica a duração do eco que o algoritmo de cancelamento de eco acústico (AEC) pode manipular.</span><span class="sxs-lookup"><span data-stu-id="6256d-126">Specifies the duration of echo that the acoustic echo cancellation (AEC) algorithm can handle.</span></span>    |
| [<span data-ttu-id="6256d-127">\_tamanho do \_ \_ quadro \_ do MFPKEY WMAAECMA</span><span class="sxs-lookup"><span data-stu-id="6256d-127">MFPKEY\_WMAAECMA\_FEATR\_FRAME\_SIZE</span></span>](mfpkey-wmaaecma-featr-frame-sizeproperty.md)         | <span data-ttu-id="6256d-128">Especifica o tamanho do quadro de áudio.</span><span class="sxs-lookup"><span data-stu-id="6256d-128">Specifies the audio frame size.</span></span>                                                                   |
| [<span data-ttu-id="6256d-129">MFPKEY \_ WMAAECMA com \_ \_ MICARR \_ feixe</span><span class="sxs-lookup"><span data-stu-id="6256d-129">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_BEAM</span></span>](mfpkey-wmaaecma-featr-micarr-beamproperty.md)       | <span data-ttu-id="6256d-130">Especifica qual transmissão o DMO usa para processamento de matriz de microfone.</span><span class="sxs-lookup"><span data-stu-id="6256d-130">Specifies which beam the DMO uses for microphone array processing.</span></span>                                |
| [<span data-ttu-id="6256d-131">\_ \_ \_ modo MICARR do MFPKEY WMAAECMA \_</span><span class="sxs-lookup"><span data-stu-id="6256d-131">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_MODE</span></span>](mfpkey-wmaaecma-featr-micarr-modeproperty.md)       | <span data-ttu-id="6256d-132">Especifica como o DMO executa o processamento da matriz de microfone.</span><span class="sxs-lookup"><span data-stu-id="6256d-132">Specifies how the DMO performs microphone array processing.</span></span>                                       |
| [<span data-ttu-id="6256d-133">MFPKEY \_ WMAAECMA refeito \_ \_ MICARR \_ preproc</span><span class="sxs-lookup"><span data-stu-id="6256d-133">MFPKEY\_WMAAECMA\_FEATR\_MICARR\_PREPROC</span></span>](mfpkey-wmaaecma-featr-micarr-preprocproperty.md) | <span data-ttu-id="6256d-134">Especifica se o DMO executa o pré-processamento da matriz do microfone.</span><span class="sxs-lookup"><span data-stu-id="6256d-134">Specifies whether the DMO performs microphone array preprocessing.</span></span>                                |
| [<span data-ttu-id="6256d-135">\_preenchimento de \_ \_ ruído \_ do MFPKEY WMAAECMA</span><span class="sxs-lookup"><span data-stu-id="6256d-135">MFPKEY\_WMAAECMA\_FEATR\_NOISE\_FILL</span></span>](mfpkey-wmaaecma-featr-noise-fillproperty.md)         | <span data-ttu-id="6256d-136">Especifica se o DMO executa o preenchimento de ruído.</span><span class="sxs-lookup"><span data-stu-id="6256d-136">Specifies whether the DMO performs noise filling.</span></span>                                                 |
| [<span data-ttu-id="6256d-137">\_ns MFPKEY WMAAECMA \_ \_</span><span class="sxs-lookup"><span data-stu-id="6256d-137">MFPKEY\_WMAAECMA\_FEATR\_NS</span></span>](mfpkey-wmaaecma-featr-nsproperty.md)                          | <span data-ttu-id="6256d-138">Especifica se o DMO executa a supressão de ruído.</span><span class="sxs-lookup"><span data-stu-id="6256d-138">Specifies whether the DMO performs noise suppression.</span></span>                                             |
| [<span data-ttu-id="6256d-139">MFPKEY \_ WMAAECMA para \_ \_ VAD</span><span class="sxs-lookup"><span data-stu-id="6256d-139">MFPKEY\_WMAAECMA\_FEATR\_VAD</span></span>](mfpkey-wmaaecma-featr-vadproperty.md)                        | <span data-ttu-id="6256d-140">Especifica o tipo de detecção de atividade de voz que o DMO executa.</span><span class="sxs-lookup"><span data-stu-id="6256d-140">Specifies the type of voice activity detection that the DMO performs.</span></span>                             |
| [<span data-ttu-id="6256d-141">modo de recurso do MFPKEY \_ WMAAECMA \_ \_</span><span class="sxs-lookup"><span data-stu-id="6256d-141">MFPKEY\_WMAAECMA\_FEATURE\_MODE</span></span>](mfpkey-wmaaecma-feature-modeproperty.md)                  | <span data-ttu-id="6256d-142">Permite que o aplicativo substitua as configurações padrão em várias propriedades.</span><span class="sxs-lookup"><span data-stu-id="6256d-142">Enables the application to override the default settings on various properties.</span></span>                   |
| [<span data-ttu-id="6256d-143">\_limitador de MFPKEY WMAAECMA \_ MIC \_ \_</span><span class="sxs-lookup"><span data-stu-id="6256d-143">MFPKEY\_WMAAECMA\_MIC\_GAIN\_BOUNDER</span></span>](mfpkey-wmaaecma-mic-gain-bounderproperty.md)         | <span data-ttu-id="6256d-144">Especifica se o DMO aplica o limite de lucro do microfone.</span><span class="sxs-lookup"><span data-stu-id="6256d-144">Specifies whether the DMO applies microphone gain bounding.</span></span>                                       |
| [<span data-ttu-id="6256d-145">MFPKEY \_ WMAAECMA \_ MICARRAY \_ DESCPTR</span><span class="sxs-lookup"><span data-stu-id="6256d-145">MFPKEY\_WMAAECMA\_MICARRAY\_DESCPTR</span></span>](mfpkey-wmaaecma-micarray-descptrproperty.md)          | <span data-ttu-id="6256d-146">Especifica a geometria da matriz do microfone.</span><span class="sxs-lookup"><span data-stu-id="6256d-146">Specifies the microphone array geometry.</span></span>                                                          |
| [<span data-ttu-id="6256d-147">\_ \_ métricas de qualidade MFPKEY WMAAECMA \_</span><span class="sxs-lookup"><span data-stu-id="6256d-147">MFPKEY\_WMAAECMA\_QUALITY\_METRICS</span></span>](mfpkey-wmaaecma-quality-metricsproperty.md)            | <span data-ttu-id="6256d-148">Recupera métricas de qualidade para AEC.</span><span class="sxs-lookup"><span data-stu-id="6256d-148">Retrieves quality metrics for AEC.</span></span>                                                                |
| [<span data-ttu-id="6256d-149">MFPKEY \_ WMAAECMA \_ recuperar \_ Estatísticas de TS \_</span><span class="sxs-lookup"><span data-stu-id="6256d-149">MFPKEY\_WMAAECMA\_RETRIEVE\_TS\_STATS</span></span>](mfpkey-wmaaecma-retrieve-ts-statsproperty.md)       | <span data-ttu-id="6256d-150">Especifica se o DMO armazena estatísticas de carimbo de data/hora no registro.</span><span class="sxs-lookup"><span data-stu-id="6256d-150">Specifies whether the DMO stores time stamp statistics in the registry.</span></span>                           |
| [<span data-ttu-id="6256d-151">MFPKEY \_ WMAAECMA \_ modo de sistema \_</span><span class="sxs-lookup"><span data-stu-id="6256d-151">MFPKEY\_WMAAECMA\_SYSTEM\_MODE</span></span>](mfpkey-wmaaecma-system-modeproperty.md)                    | <span data-ttu-id="6256d-152">Define o modo de processamento.</span><span class="sxs-lookup"><span data-stu-id="6256d-152">Sets the processing mode.</span></span>                                                                         |



 

## <a name="remarks"></a><span data-ttu-id="6256d-153">Comentários</span><span class="sxs-lookup"><span data-stu-id="6256d-153">Remarks</span></span>

<span data-ttu-id="6256d-154">Ao contrário dos outros DSPs, o objeto de captura de voz encapsula vários DSPs em um único objeto e o objeto é apenas um objeto DMO (ele não implementa [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform)).</span><span class="sxs-lookup"><span data-stu-id="6256d-154">Unlike the other DSPs, the voice capture object encapsulates multiple DSPs in a single object, and the object is a DMO object only (it does not implement [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform)).</span></span> <span data-ttu-id="6256d-155">O Voice Capture DMO inclui os seguintes componentes do DSP:</span><span class="sxs-lookup"><span data-stu-id="6256d-155">The voice capture DMO includes the following DSP components:</span></span>

-   <span data-ttu-id="6256d-156">Cancelamento de eco acústico (AEC)</span><span class="sxs-lookup"><span data-stu-id="6256d-156">Acoustic echo cancellation (AEC)</span></span>
-   <span data-ttu-id="6256d-157">Processamento de matriz de microfone</span><span class="sxs-lookup"><span data-stu-id="6256d-157">Microphone array processing</span></span>
-   <span data-ttu-id="6256d-158">Supressão de ruído</span><span class="sxs-lookup"><span data-stu-id="6256d-158">Noise suppression</span></span>
-   <span data-ttu-id="6256d-159">Controle de lucro automático</span><span class="sxs-lookup"><span data-stu-id="6256d-159">Automatic gain control</span></span>
-   <span data-ttu-id="6256d-160">Detecção de atividade de voz</span><span class="sxs-lookup"><span data-stu-id="6256d-160">Voice activity detection</span></span>

<span data-ttu-id="6256d-161">Os aplicativos podem ativar e desativar cada componente individualmente.</span><span class="sxs-lookup"><span data-stu-id="6256d-161">Applications can turn each component on and off individually.</span></span>

<span data-ttu-id="6256d-162">O Voice Capture DMO dá suporte a dois modos de operação, modo de *filtro* e modo de *origem* .</span><span class="sxs-lookup"><span data-stu-id="6256d-162">The voice capture DMO supports two modes of operation, *filter* mode and *source* mode.</span></span> <span data-ttu-id="6256d-163">No modo de filtro, o aplicativo envia amostras de áudio do microfone e da linha do viva-voz para o DMO, e o DMO produz a saída.</span><span class="sxs-lookup"><span data-stu-id="6256d-163">In filter mode, the application sends audio samples from the microphone and from the speaker line to the DMO, and the DMO produces output.</span></span>

<span data-ttu-id="6256d-164">No modo de origem, o aplicativo não precisa fornecer exemplos para o DMO.</span><span class="sxs-lookup"><span data-stu-id="6256d-164">In source mode, the application does not need to deliver samples to the DMO.</span></span> <span data-ttu-id="6256d-165">Em vez disso, o DMO gerencia todas as operações nos dispositivos de áudio, inclusive inicializando os dispositivos, capturando e sincronizando os fluxos de áudio, calculando carimbos de data/hora e recuperando a geometria da matriz de microfone.</span><span class="sxs-lookup"><span data-stu-id="6256d-165">Instead, the DMO manages all of the operations on the audio devices, including initializing the devices, capturing and synchronizing the audio streams, calculating time stamps, and retrieving the geometry of the microphone array.</span></span> <span data-ttu-id="6256d-166">Usando o modo de origem, o aplicativo simplesmente configura o DMO, e a saída do DMO é um sinal de microfone limpo e processado.</span><span class="sxs-lookup"><span data-stu-id="6256d-166">Using source mode, the application simply configures the DMO, and the output from the DMO is a clean, processed microphone signal.</span></span> <span data-ttu-id="6256d-167">O modo de origem é significativamente mais fácil de usar do que o modo de filtro e é recomendado para a maioria dos aplicativos.</span><span class="sxs-lookup"><span data-stu-id="6256d-167">Source mode is significantly easier to use than filter mode, and is recommended for most applications.</span></span>

<span data-ttu-id="6256d-168">Atualmente, o Voice Capture DMO dá suporte apenas a AEC (cancelamento de eco acústico) de canal único, de modo que a saída da linha do orador deve ser de canal único.</span><span class="sxs-lookup"><span data-stu-id="6256d-168">Currently the voice capture DMO supports only single-channel acoustic echo cancellation (AEC), so the output from the speaker line must be single-channel.</span></span> <span data-ttu-id="6256d-169">Se o processamento da matriz de microfone estiver desabilitado, a entrada multicanal será dobrada para um canal para processamento de AEC.</span><span class="sxs-lookup"><span data-stu-id="6256d-169">If microphone array processing is disabled, multi-channel input is folded down to one channel for AEC processing.</span></span> <span data-ttu-id="6256d-170">Se o processamento da matriz de microfone e o processamento de AEC estiverem habilitados, o AEC será executado em cada elemento do microfone antes do processamento da matriz do microfone.</span><span class="sxs-lookup"><span data-stu-id="6256d-170">If both microphone array processing and AEC processing are enabled, AEC is performed on each microphone element before microphone array processing.</span></span>

### <a name="microphone-array-processing"></a><span data-ttu-id="6256d-171">Processamento de matriz de microfone</span><span class="sxs-lookup"><span data-stu-id="6256d-171">Microphone Array Processing</span></span>

<span data-ttu-id="6256d-172">Uma matriz de microfone é um conjunto de microtelefones com posicionamento próximo.</span><span class="sxs-lookup"><span data-stu-id="6256d-172">A microphone array is a set of closely positioned microphones.</span></span> <span data-ttu-id="6256d-173">As matrizes de microfone atingem uma direcionalidade melhor do que um único microfone, pois as ondas acústicas chegam em cada microfone em um momento ligeiramente diferente.</span><span class="sxs-lookup"><span data-stu-id="6256d-173">Microphone arrays achieve better directionality than a single microphone, because the acoustic waves arrive at each microphone at a slightly different time.</span></span> <span data-ttu-id="6256d-174">Para obter mais informações sobre matrizes de microfone, consulte os artigos da Web [suporte de matriz de microfone no Windows Vista](/windows-hardware/design/component-guidelines/audio) e [como criar e usar matrizes de microfone para o Windows Vista](/windows-hardware/drivers/audio/microphone-array-geometry-descriptor-format).</span><span class="sxs-lookup"><span data-stu-id="6256d-174">For more information on microphone arrays see the web articles [Microphone Array Support in Windows Vista](/windows-hardware/design/component-guidelines/audio) and [How to Build and Use Microphone Arrays for Windows Vista](/windows-hardware/drivers/audio/microphone-array-geometry-descriptor-format).</span></span>

### <a name="using-the-voice-capture-dsp"></a><span data-ttu-id="6256d-175">Usando o DSP de captura de voz</span><span class="sxs-lookup"><span data-stu-id="6256d-175">Using the Voice Capture DSP</span></span>

<span data-ttu-id="6256d-176">Para usar o DSP de captura de voz, execute as etapas a seguir.</span><span class="sxs-lookup"><span data-stu-id="6256d-176">To use the Voice Capture DSP, perform the following steps.</span></span>

### <a name="1-initialize-the-dmo"></a><span data-ttu-id="6256d-177">1. Inicialize o DMO</span><span class="sxs-lookup"><span data-stu-id="6256d-177">1. Initialize the DMO</span></span>

<span data-ttu-id="6256d-178">Crie o Voice Capture DMO chamando [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) com o CLSID **CLSID \_ CWMAudioAEC**.</span><span class="sxs-lookup"><span data-stu-id="6256d-178">Create the voice capture DMO by calling [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) with the CLSID **CLSID\_CWMAudioAEC**.</span></span> <span data-ttu-id="6256d-179">O DSDP de captura de voz expõe apenas as interfaces [**IMediaObject**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject) e [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) , portanto, ela só pode ser usada como um DMO.</span><span class="sxs-lookup"><span data-stu-id="6256d-179">The voice capture DSDP exposes only the [**IMediaObject**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediaobject) and [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) interfaces, so it can only be used as a DMO.</span></span>

<span data-ttu-id="6256d-180">O padrão de DMO é o modo de origem.</span><span class="sxs-lookup"><span data-stu-id="6256d-180">The DMO defaults to source mode.</span></span> <span data-ttu-id="6256d-181">Para selecionar o modo de filtro, defina a propriedade [ \_ modo de origem MFPKEY WMAAECMA \_ DMO \_ \_](mfpkey-wmaaecma-dmo-source-modeproperty.md) como **variante \_ false**.</span><span class="sxs-lookup"><span data-stu-id="6256d-181">To select filter mode, set the [MFPKEY\_WMAAECMA\_DMO\_SOURCE\_MODE](mfpkey-wmaaecma-dmo-source-modeproperty.md) property to **VARIANT\_FALSE**.</span></span>

<span data-ttu-id="6256d-182">Em seguida, configure as propriedades internas do DMO usando a interface [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) .</span><span class="sxs-lookup"><span data-stu-id="6256d-182">Next, configure the internal properties of the DMO by using the [**IPropertyStore**](/windows/win32/api/propsys/nn-propsys-ipropertystore) interface.</span></span> <span data-ttu-id="6256d-183">A única propriedade que um aplicativo deve definir é a propriedade do [ \_ modo do \_ sistema \_ MFPKEY WMAAECMA](mfpkey-wmaaecma-system-modeproperty.md) .</span><span class="sxs-lookup"><span data-stu-id="6256d-183">The only property that an application must set is the [MFPKEY\_WMAAECMA\_SYSTEM\_MODE](mfpkey-wmaaecma-system-modeproperty.md) property.</span></span> <span data-ttu-id="6256d-184">Essa propriedade configura o pipeline de processamento no DMO.</span><span class="sxs-lookup"><span data-stu-id="6256d-184">This property configures the processing pipeline within the DMO.</span></span> <span data-ttu-id="6256d-185">As outras propriedades são opcionais.</span><span class="sxs-lookup"><span data-stu-id="6256d-185">The other properties are optional.</span></span>

### <a name="2-set-the-input-and-output-formats"></a><span data-ttu-id="6256d-186">2. definir os formatos de entrada e saída</span><span class="sxs-lookup"><span data-stu-id="6256d-186">2. Set the Input and Output Formats</span></span>

<span data-ttu-id="6256d-187">Se você estiver usando o DMO no modo de filtro, defina o formato de entrada chamando [**IMediaObject:: SetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype).</span><span class="sxs-lookup"><span data-stu-id="6256d-187">If you are using the DMO in filter mode, set the input format by calling [**IMediaObject::SetInputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setinputtype).</span></span> <span data-ttu-id="6256d-188">O formato de entrada pode ser quase qualquer tipo de áudio de ponto flutuante de formato PCM ou IEEE não compactado válido.</span><span class="sxs-lookup"><span data-stu-id="6256d-188">The input format can be almost any valid uncompressed PCM or IEEE floating-point audio type.</span></span> <span data-ttu-id="6256d-189">Se o formato de entrada não corresponder ao formato de saída, o DMO executará automaticamente a conversão de taxa de amostragem.</span><span class="sxs-lookup"><span data-stu-id="6256d-189">If the input format does not match the output format, the DMO automatically performs sample-rate conversion.</span></span>

<span data-ttu-id="6256d-190">Se você estiver usando o DMO no modo de origem, não defina o formato de entrada.</span><span class="sxs-lookup"><span data-stu-id="6256d-190">If you are using the DMO in source mode, do not set the input format.</span></span> <span data-ttu-id="6256d-191">O DMO configura automaticamente o formato de entrada com base nos dispositivos de áudio.</span><span class="sxs-lookup"><span data-stu-id="6256d-191">The DMO automatically configures the input format based on the audio devices.</span></span>

<span data-ttu-id="6256d-192">Em ambos os modos, defina o formato de saída chamando [**IMediaObject:: SetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype).</span><span class="sxs-lookup"><span data-stu-id="6256d-192">In either mode, set the output format by calling [**IMediaObject::SetOutputType**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-setoutputtype).</span></span> <span data-ttu-id="6256d-193">O DMO pode aceitar os seguintes formatos de saída:</span><span class="sxs-lookup"><span data-stu-id="6256d-193">The DMO can accept the following output formats:</span></span>

-   <span data-ttu-id="6256d-194">Subtipo: **MEDIASUBTYPE \_ PCM** ou **MEDIASUBTYPE \_ IEEE \_ float**</span><span class="sxs-lookup"><span data-stu-id="6256d-194">Subtype: **MEDIASUBTYPE\_PCM** or **MEDIASUBTYPE\_IEEE\_FLOAT**</span></span>
-   <span data-ttu-id="6256d-195">Bloco de formato: [**WAVEFORMAT**](/windows/win32/api/mmreg/ns-mmreg-waveformat) ou [**WAVEFORMATEX**](/previous-versions/dd757713(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="6256d-195">Format block: [**WAVEFORMAT**](/windows/win32/api/mmreg/ns-mmreg-waveformat) or [**WAVEFORMATEX**](/previous-versions/dd757713(v=vs.85))</span></span>
-   <span data-ttu-id="6256d-196">Exemplos por segundo: 8.000; 11.025; 16.000; ou 22.050</span><span class="sxs-lookup"><span data-stu-id="6256d-196">Samples per second: 8,000; 11,025; 16,000; or 22,050</span></span>
-   <span data-ttu-id="6256d-197">Canais: 1 para modo somente AEC, 2 ou 4 para processamento de matriz de microfone</span><span class="sxs-lookup"><span data-stu-id="6256d-197">Channels: 1 for AEC-only mode, 2 or 4 for microphone array processing</span></span>
-   <span data-ttu-id="6256d-198">Bits por amostra: 16</span><span class="sxs-lookup"><span data-stu-id="6256d-198">Bits per sample: 16</span></span>

<span data-ttu-id="6256d-199">O código a seguir define o tipo de saída como áudio PCM de canal único de 16 bits:</span><span class="sxs-lookup"><span data-stu-id="6256d-199">The following code sets the output type to 16-bit single-channel PCM audio:</span></span>


```
DMO_MEDIA_TYPE mt;  // Media type.
mt.majortype = MEDIATYPE_Audio;
mt.subtype = MEDIASUBTYPE_PCM;
mt.lSampleSize = 0;
mt.bFixedSizeSamples = TRUE;
mt.bTemporalCompression = FALSE;
mt.formattype = FORMAT_WaveFormatEx;

// Allocate the format block to hold the WAVEFORMATEX structure.
hr = MoInitMediaType(&mt, sizeof(WAVEFORMATEX));
if (SUCCEEDED(hr))
{
    WAVEFORMATEX *pwav = (WAVEFORMATEX*)mt.pbFormat;
    pwav->wFormatTag = WAVE_FORMAT_PCM;
    pwav->nChannels = 1;
    pwav->nSamplesPerSec = 16000;
    pwav->nAvgBytesPerSec = 32000;
    pwav->nBlockAlign = 2;
    pwav->wBitsPerSample = 16;
    pwav->cbSize = 0;

    // Set the output type.
    if (SUCCEEDED(hr))
    {
        hr = pDMO->SetOutputType(0, &mt, 0); 
    }
    // Free the format block.
    MoFreeMediaType(&mt);
}
```



### <a name="3-process-data"></a><span data-ttu-id="6256d-200">3. processar dados</span><span class="sxs-lookup"><span data-stu-id="6256d-200">3. Process Data</span></span>

<span data-ttu-id="6256d-201">Antes de processar quaisquer dados, é recomendável chamar [**IMediaObject:: AllocateStreamingResources**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-allocatestreamingresources).</span><span class="sxs-lookup"><span data-stu-id="6256d-201">Before processing any data, it is recommended to call [**IMediaObject::AllocateStreamingResources**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-allocatestreamingresources).</span></span> <span data-ttu-id="6256d-202">Esse método aloca os recursos usados internamente pelo DMO.</span><span class="sxs-lookup"><span data-stu-id="6256d-202">This method allocates the resources used internally by the DMO.</span></span> <span data-ttu-id="6256d-203">Chame **AllocateStreamingResources** após as etapas listadas anteriormente, não antes.</span><span class="sxs-lookup"><span data-stu-id="6256d-203">Call **AllocateStreamingResources** after the steps listed previously, not before.</span></span> <span data-ttu-id="6256d-204">Se você não chamar esse método, o DMO alocará automaticamente os recursos quando o processamento de dados for iniciado.</span><span class="sxs-lookup"><span data-stu-id="6256d-204">If you do not call this method, the DMO automatically allocates resources when data processing starts.</span></span>

<span data-ttu-id="6256d-205">Se você estiver usando o DMO no modo de filtro, deverá passar os dados de entrada para o DMO chamando [**IMediaObject::P rocessinput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processinput).</span><span class="sxs-lookup"><span data-stu-id="6256d-205">If you are using the DMO in filter mode, you must pass input data to the DMO by calling [**IMediaObject::ProcessInput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processinput).</span></span> <span data-ttu-id="6256d-206">Os dados de áudio do microfone vão para o fluxo 0 e os dados de áudio da linha do orador vão para o fluxo 1.</span><span class="sxs-lookup"><span data-stu-id="6256d-206">The audio data from the microphone goes to stream 0, and the audio data from the speaker line goes to stream 1.</span></span> <span data-ttu-id="6256d-207">Se você estiver usando o DMO no modo de origem, não será necessário chamar **ProcessInput**.</span><span class="sxs-lookup"><span data-stu-id="6256d-207">If you are using the DMO in source mode, you do not need to call **ProcessInput**.</span></span>

<span data-ttu-id="6256d-208">Para obter dados de saída do DSP, execute as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="6256d-208">To get output data from the DSP, perform the following steps:</span></span>

1.  <span data-ttu-id="6256d-209">Crie um objeto de buffer para armazenar os dados de saída.</span><span class="sxs-lookup"><span data-stu-id="6256d-209">Create a buffer object to hold the output data.</span></span> <span data-ttu-id="6256d-210">O objeto de buffer deve implementar a interface [**IMediaBuffer**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediabuffer) .</span><span class="sxs-lookup"><span data-stu-id="6256d-210">The buffer object must implement the [**IMediaBuffer**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediabuffer) interface.</span></span> <span data-ttu-id="6256d-211">O tamanho do buffer depende dos requisitos do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="6256d-211">The size of the buffer depends on the requirements of your application.</span></span> <span data-ttu-id="6256d-212">Alocar um buffer maior pode reduzir as chances de falhas ocorrendo.</span><span class="sxs-lookup"><span data-stu-id="6256d-212">Allocating a larger buffer can reduce the chances of glitches occurring.</span></span>
2.  <span data-ttu-id="6256d-213">Declare uma estrutura de [**buffer de \_ dados de saída \_ \_ DMO**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) e defina o membro **pBuffer** para apontar para o objeto buffer.</span><span class="sxs-lookup"><span data-stu-id="6256d-213">Declare a [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure and set the **pBuffer** member to point to your buffer object.</span></span>
3.  <span data-ttu-id="6256d-214">Passe a estrutura do buffer de dados de saída do DMO para o método [**IMediaObject::P rocessoutput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput) . [**\_ \_ \_**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer)</span><span class="sxs-lookup"><span data-stu-id="6256d-214">Pass the [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure to the [**IMediaObject::ProcessOutput**](/previous-versions/windows/desktop/api/mediaobj/nf-mediaobj-imediaobject-processoutput) method.</span></span>
4.  <span data-ttu-id="6256d-215">Continue a chamar esse método enquanto o DMO tiver dados de saída.</span><span class="sxs-lookup"><span data-stu-id="6256d-215">Continue to call this method for as long as the DMO has output data.</span></span> <span data-ttu-id="6256d-216">O DSP sinaliza que ele tem mais saída definindo o sinalizador de **dados de saída de DMO \_ \_ \_ BUFFERF \_ incompleto** no membro **dwStatus** da estrutura do buffer de [**dados de saída do DMO \_ \_ \_**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) .</span><span class="sxs-lookup"><span data-stu-id="6256d-216">The DSP signals that it has more output by setting the **DMO\_OUTPUT\_DATA\_BUFFERF\_INCOMPLETE** flag in the **dwStatus** member of the [**DMO\_OUTPUT\_DATA\_BUFFER**](/previous-versions/windows/desktop/api/mediaobj/ns-mediaobj-dmo_output_data_buffer) structure.</span></span>

## <a name="requirements"></a><span data-ttu-id="6256d-217">Requisitos</span><span class="sxs-lookup"><span data-stu-id="6256d-217">Requirements</span></span>



| <span data-ttu-id="6256d-218">Requisito</span><span class="sxs-lookup"><span data-stu-id="6256d-218">Requirement</span></span> | <span data-ttu-id="6256d-219">Valor</span><span class="sxs-lookup"><span data-stu-id="6256d-219">Value</span></span> |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| <span data-ttu-id="6256d-220">Cliente mínimo com suporte</span><span class="sxs-lookup"><span data-stu-id="6256d-220">Minimum supported client</span></span><br/> | <span data-ttu-id="6256d-221">\[Somente aplicativos da área de trabalho do Windows Vista\]</span><span class="sxs-lookup"><span data-stu-id="6256d-221">Windows Vista \[desktop apps only\]</span></span><br/>                                          |
| <span data-ttu-id="6256d-222">Servidor mínimo com suporte</span><span class="sxs-lookup"><span data-stu-id="6256d-222">Minimum supported server</span></span><br/> | <span data-ttu-id="6256d-223">\[Somente aplicativos da área de trabalho do Windows Server 2008\]</span><span class="sxs-lookup"><span data-stu-id="6256d-223">Windows Server 2008 \[desktop apps only\]</span></span><br/>                                    |
| <span data-ttu-id="6256d-224">parâmetro</span><span class="sxs-lookup"><span data-stu-id="6256d-224">Header</span></span><br/>                   | <dl> <span data-ttu-id="6256d-225"><dt>Wmcodecdsp. h</dt></span><span class="sxs-lookup"><span data-stu-id="6256d-225"><dt>Wmcodecdsp.h</dt></span></span> </dl> |
| <span data-ttu-id="6256d-226">DLL</span><span class="sxs-lookup"><span data-stu-id="6256d-226">DLL</span></span><br/>                      | <dl> <span data-ttu-id="6256d-227"><dt>Mfwmaaec.dll</dt></span><span class="sxs-lookup"><span data-stu-id="6256d-227"><dt>Mfwmaaec.dll</dt></span></span> </dl> |



## <a name="see-also"></a><span data-ttu-id="6256d-228">Confira também</span><span class="sxs-lookup"><span data-stu-id="6256d-228">See also</span></span>

<dl> <dt>

[<span data-ttu-id="6256d-229">Processadores de sinais digitais</span><span class="sxs-lookup"><span data-stu-id="6256d-229">Digital Signal Processors</span></span>](windowsmediadigitalsignalprocessors.md)
</dt> </dl>

 

 
