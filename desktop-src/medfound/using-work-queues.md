---
description: Este tópico descreve como usar as filas de trabalho no Microsoft Media Foundation.
ms.assetid: 6be05df7-e8ff-4110-8f73-a62eb31fd414
title: Usando filas de trabalho
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2d7bb41b830742ca871d44cadac9bd26a9967aa1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104164880"
---
# <a name="using-work-queues"></a><span data-ttu-id="21f2d-103">Usando filas de trabalho</span><span class="sxs-lookup"><span data-stu-id="21f2d-103">Using Work Queues</span></span>

<span data-ttu-id="21f2d-104">Este tópico descreve como usar as filas de trabalho no Microsoft Media Foundation.</span><span class="sxs-lookup"><span data-stu-id="21f2d-104">This topic describes how to use work queues in Microsoft Media Foundation.</span></span>

-   [<span data-ttu-id="21f2d-105">Usando filas de trabalho</span><span class="sxs-lookup"><span data-stu-id="21f2d-105">Using Work Queues</span></span>](#using-work-queues)
-   [<span data-ttu-id="21f2d-106">Desligando filas de trabalho</span><span class="sxs-lookup"><span data-stu-id="21f2d-106">Shutting Down Work Queues</span></span>](#shutting-down-work-queues)
-   [<span data-ttu-id="21f2d-107">Usando itens de trabalho agendados</span><span class="sxs-lookup"><span data-stu-id="21f2d-107">Using Scheduled Work Items</span></span>](#using-scheduled-work-items)
-   [<span data-ttu-id="21f2d-108">Usando retornos de chamada periódicos</span><span class="sxs-lookup"><span data-stu-id="21f2d-108">Using Periodic Callbacks</span></span>](#using-periodic-callbacks)
-   [<span data-ttu-id="21f2d-109">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="21f2d-109">Related topics</span></span>](#related-topics)

## <a name="using-work-queues"></a><span data-ttu-id="21f2d-110">Usando filas de trabalho</span><span class="sxs-lookup"><span data-stu-id="21f2d-110">Using Work Queues</span></span>

<span data-ttu-id="21f2d-111">Uma fila de trabalho é uma maneira eficiente de executar operações assíncronas em outro thread.</span><span class="sxs-lookup"><span data-stu-id="21f2d-111">A work queue is an efficient way to perform asynchronous operations on another thread.</span></span> <span data-ttu-id="21f2d-112">Conceitualmente, você coloca itens de trabalho na fila e a fila tem um thread que recebe cada item da fila e o despacha.</span><span class="sxs-lookup"><span data-stu-id="21f2d-112">Conceptually, you put work items in the queue, and the queue has a thread that pulls each item from the queue and dispatches it.</span></span> <span data-ttu-id="21f2d-113">Os itens de trabalho são implementados como retornos de chamada usando a interface [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) .</span><span class="sxs-lookup"><span data-stu-id="21f2d-113">Work items are implemented as callbacks by using the [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) interface.</span></span>

<span data-ttu-id="21f2d-114">Media Foundation cria várias filas de trabalho padrão, chamadas de *filas de trabalho da plataforma*.</span><span class="sxs-lookup"><span data-stu-id="21f2d-114">Media Foundation creates several standard work queues, called *platform work queues*.</span></span> <span data-ttu-id="21f2d-115">Os aplicativos também podem criar suas próprias filas de trabalho, chamadas de *filas de trabalho privadas*.</span><span class="sxs-lookup"><span data-stu-id="21f2d-115">Applications can also create their own work queues, called *private work queues*.</span></span> <span data-ttu-id="21f2d-116">Para obter uma lista das filas de trabalho da plataforma, consulte [identificadores de fila de trabalho](work-queue-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="21f2d-116">For a list of the platform work queues, see [Work Queue Identifiers](work-queue-identifiers.md).</span></span> <span data-ttu-id="21f2d-117">Para criar uma fila de trabalho particular, chame [**MFAllocateWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueue).</span><span class="sxs-lookup"><span data-stu-id="21f2d-117">To create a private work queue, call [**MFAllocateWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueue).</span></span> <span data-ttu-id="21f2d-118">Essa função retorna um identificador para a nova fila de trabalho.</span><span class="sxs-lookup"><span data-stu-id="21f2d-118">This function returns an identifier for the new work queue.</span></span> <span data-ttu-id="21f2d-119">Para colocar um item na fila, chame [**MFPutWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) ou [**MFPutWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex).</span><span class="sxs-lookup"><span data-stu-id="21f2d-119">To put an item in the queue, call [**MFPutWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) or [**MFPutWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex).</span></span> <span data-ttu-id="21f2d-120">Em ambos os casos, você deve especificar uma interface de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="21f2d-120">In both cases, you must specify a callback interface.</span></span>

-   <span data-ttu-id="21f2d-121">[**MFPutWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) usa um ponteiro para a interface [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) , além de um objeto de estado opcional que implementa **IUnknown**.</span><span class="sxs-lookup"><span data-stu-id="21f2d-121">[**MFPutWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) takes a pointer to the [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) interface, plus an optional state object that implements **IUnknown**.</span></span> <span data-ttu-id="21f2d-122">Esses são os mesmos parâmetros usados em métodos assíncronos, conforme descrito no tópico [métodos de retorno de chamada assíncronos](asynchronous-callback-methods.md).</span><span class="sxs-lookup"><span data-stu-id="21f2d-122">These are the same parameters used in asynchronous methods, as described in the topic [Asynchronous Callback Methods](asynchronous-callback-methods.md).</span></span> <span data-ttu-id="21f2d-123">Internamente, essa função cria um objeto de resultado assíncrono, que é passado para o método [**Invoke**](/windows/desktop/api/mfobjects/nf-mfobjects-imfasynccallback-invoke) do retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="21f2d-123">Internally, this function creates an asynchronous result object, which is passed to the callback's [**Invoke**](/windows/desktop/api/mfobjects/nf-mfobjects-imfasynccallback-invoke) method.</span></span>
-   <span data-ttu-id="21f2d-124">[**MFPutWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex) usa um ponteiro para a interface [**IMFAsyncResult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) .</span><span class="sxs-lookup"><span data-stu-id="21f2d-124">[**MFPutWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex) takes a pointer to the [**IMFAsyncResult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) interface.</span></span> <span data-ttu-id="21f2d-125">Essa interface representa um objeto de resultado assíncrono.</span><span class="sxs-lookup"><span data-stu-id="21f2d-125">This interface represents an asynchronous result object.</span></span> <span data-ttu-id="21f2d-126">Crie esse objeto chamando [**MFCreateAsyncResult**](/windows/desktop/api/mfapi/nf-mfapi-mfcreateasyncresult) e especificando sua interface de retorno de chamada e, opcionalmente, um objeto de estado.</span><span class="sxs-lookup"><span data-stu-id="21f2d-126">Create this object by calling [**MFCreateAsyncResult**](/windows/desktop/api/mfapi/nf-mfapi-mfcreateasyncresult) and specifying your callback interface and, optionally, a state object.</span></span>

<span data-ttu-id="21f2d-127">Em ambos os casos, o thread da fila de trabalho chama o método [**IMFAsyncCallback:: Invoke**](/windows/desktop/api/mfobjects/nf-mfobjects-imfasynccallback-invoke) .</span><span class="sxs-lookup"><span data-stu-id="21f2d-127">In both cases, the work queue thread calls your [**IMFAsyncCallback::Invoke**](/windows/desktop/api/mfobjects/nf-mfobjects-imfasynccallback-invoke) method.</span></span> <span data-ttu-id="21f2d-128">Use o método **Invoke** para executar o item de trabalho.</span><span class="sxs-lookup"><span data-stu-id="21f2d-128">Use the **Invoke** method to perform the work item.</span></span>

<span data-ttu-id="21f2d-129">Se mais de um thread ou componente compartilhar a mesma fila de trabalho, você poderá chamar [**MFLockWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mflockworkqueue) para bloquear a fila de trabalho, o que impede que a plataforma a libere.</span><span class="sxs-lookup"><span data-stu-id="21f2d-129">If more than one thread or component shares the same work queue, you can call [**MFLockWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mflockworkqueue) to lock the work queue, which prevents the platform from releasing it.</span></span> <span data-ttu-id="21f2d-130">Para cada chamada para [**MFAllocateWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueue) ou **MFLockWorkQueue**, você deve chamar [**MFUnlockWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockworkqueue) uma vez para liberar a fila de trabalho.</span><span class="sxs-lookup"><span data-stu-id="21f2d-130">For each call to [**MFAllocateWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueue) or **MFLockWorkQueue**, you must call [**MFUnlockWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockworkqueue) once to release the work queue.</span></span> <span data-ttu-id="21f2d-131">Por exemplo, se você criar uma nova fila de trabalho e, em seguida, bloqueá-la uma vez, deverá chamar **MFUnlockWorkQueue** duas vezes, uma vez para a chamada para **MFAllocateWorkQueue** e uma vez para a chamada para **MFLockWorkQueue**.</span><span class="sxs-lookup"><span data-stu-id="21f2d-131">For example, if you create a new work queue and then lock it once, you must call **MFUnlockWorkQueue** twice, once for the call to **MFAllocateWorkQueue** and once for the call to **MFLockWorkQueue**.</span></span>

<span data-ttu-id="21f2d-132">O código a seguir mostra como criar uma nova fila de trabalho, colocar um item de trabalho na fila e liberar a fila de trabalho.</span><span class="sxs-lookup"><span data-stu-id="21f2d-132">The following code shows how to create a new work queue, put a work item in the queue, and release the work queue.</span></span>

<span data-ttu-id="21f2d-133">Consulte [melhorias na fila de trabalho e threading](media-foundation-work-queue-and-threading-improvements.md) para obter informações adicionais sobre as filas de trabalho no Windows 8.</span><span class="sxs-lookup"><span data-stu-id="21f2d-133">See [Work Queue and Threading Improvements](media-foundation-work-queue-and-threading-improvements.md) for additional information on work queues in Windows 8.</span></span>


```C++
DWORD idWorkQueue = 0;
HRESULT hr = S_OK;

// Create a new work queue.
hr = MFAllocateWorkQueue(&idWorkQueue);

// Put an item on the queue.
if (SUCCEEDED(hr))
{
    hr = MFPutWorkItem(idWorkQueue, pCallback, NULL);
}

// Wait for the callback to be invoked.
if (SUCCEEDED(hr))
{
    WaitForSingleObject(hEvent, INFINITE);
}

// Release the work queue.
if (SUCCEEDED(hr))
{
    hr = MFUnlockWorkQueue(idWorkQueue);
}
```



<span data-ttu-id="21f2d-134">Este exemplo pressupõe que *pCallback* é um ponteiro para a interface [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="21f2d-134">This example assumes that *pCallback* is a pointer to the application's [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) interface.</span></span> <span data-ttu-id="21f2d-135">Ele também pressupõe que o retorno de chamada define o identificador de evento *hEvent* .</span><span class="sxs-lookup"><span data-stu-id="21f2d-135">It also assumes that the callback sets the *hEvent* event handle.</span></span> <span data-ttu-id="21f2d-136">O código aguarda esse evento ser definido antes de chamar [**MFUnlockWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockworkqueue).</span><span class="sxs-lookup"><span data-stu-id="21f2d-136">The code waits for this event to be set before calling [**MFUnlockWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockworkqueue).</span></span>

<span data-ttu-id="21f2d-137">Os threads da fila de trabalho são sempre criados no processo do chamador.</span><span class="sxs-lookup"><span data-stu-id="21f2d-137">Work queue threads are always created in the caller's process.</span></span> <span data-ttu-id="21f2d-138">Em cada fila de trabalho, os retornos de chamada são serializados.</span><span class="sxs-lookup"><span data-stu-id="21f2d-138">Within each work queue, the callbacks are serialized.</span></span> <span data-ttu-id="21f2d-139">Se você chamar [**MFPutWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) duas vezes com a mesma fila de trabalho, o segundo retorno de chamada não será invocado até que o primeiro retorno de chamada seja retornado.</span><span class="sxs-lookup"><span data-stu-id="21f2d-139">If you call [**MFPutWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) twice with the same work queue, the second callback is not invoked until the first callback has returned.</span></span>

## <a name="shutting-down-work-queues"></a><span data-ttu-id="21f2d-140">Desligando filas de trabalho</span><span class="sxs-lookup"><span data-stu-id="21f2d-140">Shutting Down Work Queues</span></span>

<span data-ttu-id="21f2d-141">Antes de chamar [**MFShutdown**](/windows/desktop/api/mfapi/nf-mfapi-mfshutdown), libere todos os recursos que estão sendo usados por threads da fila de trabalho.</span><span class="sxs-lookup"><span data-stu-id="21f2d-141">Before calling [**MFShutdown**](/windows/desktop/api/mfapi/nf-mfapi-mfshutdown), release any resources that are being used by work queue threads.</span></span> <span data-ttu-id="21f2d-142">Para sincronizar esse processo, você pode bloquear a plataforma Media Foundation, o que impede que a função **MFShutdown** feche todos os threads da fila de trabalho.</span><span class="sxs-lookup"><span data-stu-id="21f2d-142">To synchronize this process, you can lock the Media Foundation platform, which prevents the **MFShutdown** function from closing any work queue threads.</span></span> <span data-ttu-id="21f2d-143">Se **MFShutdown** for chamado enquanto a plataforma estiver bloqueada, o **MFShutdown** aguardará algumas centenas de milissegundos para que a plataforma seja desbloqueada.</span><span class="sxs-lookup"><span data-stu-id="21f2d-143">If **MFShutdown** is called while the platform is locked, **MFShutdown** waits a few hundred milliseconds for the platform to be unlocked.</span></span> <span data-ttu-id="21f2d-144">Se não estiver desbloqueado dentro desse período, o **MFShutdown** fechará os threads da fila de trabalho.</span><span class="sxs-lookup"><span data-stu-id="21f2d-144">If it is not unlocked within that time, **MFShutdown** closes the work queue threads.</span></span>

<span data-ttu-id="21f2d-145">A implementação padrão do [**IMFAsyncResult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) bloqueia automaticamente a plataforma Media Foundation quando o objeto de resultado é criado.</span><span class="sxs-lookup"><span data-stu-id="21f2d-145">The default implementation of [**IMFAsyncResult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) automatically locks the Media Foundation platform when the result object is created.</span></span> <span data-ttu-id="21f2d-146">A liberação da interface desbloqueia a plataforma.</span><span class="sxs-lookup"><span data-stu-id="21f2d-146">Releasing the interface unlocks the platform.</span></span> <span data-ttu-id="21f2d-147">Portanto, quase nunca será necessário bloquear a plataforma diretamente.</span><span class="sxs-lookup"><span data-stu-id="21f2d-147">Therefore, you will almost never need to lock the platform directly.</span></span> <span data-ttu-id="21f2d-148">Mas se você escrever sua própria implementação personalizada do **IMFAsyncResult**, deverá bloquear e desbloquear a plataforma manualmente.</span><span class="sxs-lookup"><span data-stu-id="21f2d-148">But if you write your own custom implementation of **IMFAsyncResult**, then you should manually lock and unlock the platform.</span></span> <span data-ttu-id="21f2d-149">Para bloquear a plataforma, chame [**MFLockPlatform**](/windows/desktop/api/mfapi/nf-mfapi-mflockplatform).</span><span class="sxs-lookup"><span data-stu-id="21f2d-149">To lock the platform, call [**MFLockPlatform**](/windows/desktop/api/mfapi/nf-mfapi-mflockplatform).</span></span> <span data-ttu-id="21f2d-150">Para desbloquear a plataforma, chame [**MFUnlockPlatform**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockplatform).</span><span class="sxs-lookup"><span data-stu-id="21f2d-150">To unlock the platform, call [**MFUnlockPlatform**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockplatform).</span></span> <span data-ttu-id="21f2d-151">Para obter um exemplo, consulte [objetos de resultados assíncronos personalizados](custom-asynchronous-result-objects.md).</span><span class="sxs-lookup"><span data-stu-id="21f2d-151">For an example, see [Custom Asynchronous Result Objects](custom-asynchronous-result-objects.md).</span></span>

<span data-ttu-id="21f2d-152">Depois de chamar o [**MFShutdown**](/windows/desktop/api/mfapi/nf-mfapi-mfshutdown), você precisa garantir que a plataforma seja desbloqueada dentro do período de tempo limite de 5 segundos.</span><span class="sxs-lookup"><span data-stu-id="21f2d-152">After you call [**MFShutdown**](/windows/desktop/api/mfapi/nf-mfapi-mfshutdown), you need to ensure that the platform is unlocked within the 5-second time-out period.</span></span> <span data-ttu-id="21f2d-153">Faça isso liberando todos os ponteiros do [**IMFAsyncResult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) e chamando [**MFUnlockPlatform**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockplatform) se você tiver bloqueado a plataforma manualmente.</span><span class="sxs-lookup"><span data-stu-id="21f2d-153">Do this by releasing all [**IMFAsyncResult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) pointers, and by calling [**MFUnlockPlatform**](/windows/desktop/api/mfapi/nf-mfapi-mfunlockplatform) if you locked the platform manually.</span></span> <span data-ttu-id="21f2d-154">Certifique-se de liberar todos os recursos que estão sendo usados por threads de fila de trabalho, ou seu aplicativo pode vazar memória.</span><span class="sxs-lookup"><span data-stu-id="21f2d-154">Make sure to release any resources that are being used by work queue threads, or your application might leak memory.</span></span>

<span data-ttu-id="21f2d-155">Normalmente, se o aplicativo for desligado e lançar cada objeto de Media Foundation antes de chamar [**MFShutdown**](/windows/desktop/api/mfapi/nf-mfapi-mfshutdown), você não precisará se preocupar com o bloqueio.</span><span class="sxs-lookup"><span data-stu-id="21f2d-155">Typically, if your application shuts down and releases every Media Foundation object before calling [**MFShutdown**](/windows/desktop/api/mfapi/nf-mfapi-mfshutdown), you do not have to worry about locking.</span></span> <span data-ttu-id="21f2d-156">O mecanismo de bloqueio simplesmente permite que os threads da fila de trabalho saiam normalmente depois de chamar **MFShutdown**.</span><span class="sxs-lookup"><span data-stu-id="21f2d-156">The locking mechanism simply allows work queue threads to exit gracefully after you call **MFShutdown**.</span></span>

## <a name="using-scheduled-work-items"></a><span data-ttu-id="21f2d-157">Usando itens de trabalho agendados</span><span class="sxs-lookup"><span data-stu-id="21f2d-157">Using Scheduled Work Items</span></span>

<span data-ttu-id="21f2d-158">Você pode agendar um retorno de chamada para ocorrer após um determinado período de tempo chamando [**MFScheduleWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitem) ou [**MFScheduleWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitemex).</span><span class="sxs-lookup"><span data-stu-id="21f2d-158">You can schedule a callback to occur after a set period of time by calling [**MFScheduleWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitem) or [**MFScheduleWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitemex).</span></span>

-   <span data-ttu-id="21f2d-159">[**MFScheduleWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitem) usa um ponteiro para o retorno de chamada, um objeto de estado opcional e um intervalo de tempo limite.</span><span class="sxs-lookup"><span data-stu-id="21f2d-159">[**MFScheduleWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitem) takes a pointer to your callback, an optional state object, and a time-out interval.</span></span>
-   <span data-ttu-id="21f2d-160">[**MFScheduleWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitemex) usa um ponteiro para um objeto de resultado assíncrono e um valor de tempo limite.</span><span class="sxs-lookup"><span data-stu-id="21f2d-160">[**MFScheduleWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfscheduleworkitemex) takes a pointer to an asynchronous result object and a time-out value.</span></span>

<span data-ttu-id="21f2d-161">Especifique o tempo limite como um valor negativo em milissegundos.</span><span class="sxs-lookup"><span data-stu-id="21f2d-161">Specify the time-out as a negative value in milliseconds.</span></span> <span data-ttu-id="21f2d-162">Por exemplo, para agendar um retorno de chamada a ser invocado em 5 segundos, use o valor − 5000.</span><span class="sxs-lookup"><span data-stu-id="21f2d-162">For example, to schedule a callback to be invoked in 5 seconds, use the value −5000.</span></span> <span data-ttu-id="21f2d-163">Ambas as funções retornam um valor de **\_ chave MFWORKITEM** , que pode ser usado para cancelar o retorno de chamada, passando-o para a função [**MFCancelWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfcancelworkitem) .</span><span class="sxs-lookup"><span data-stu-id="21f2d-163">Both functions return an **MFWORKITEM\_KEY** value, which you can use to cancel the callback by passing it to the [**MFCancelWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfcancelworkitem) function.</span></span>

<span data-ttu-id="21f2d-164">Os itens de trabalho agendados sempre usam a fila de trabalho do timer da fila de retorno de chamada do MFASYNC \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="21f2d-164">Scheduled work items always use the MFASYNC\_CALLBACK\_QUEUE\_TIMER platform work queue.</span></span>

## <a name="using-periodic-callbacks"></a><span data-ttu-id="21f2d-165">Usando retornos de chamada periódicos</span><span class="sxs-lookup"><span data-stu-id="21f2d-165">Using Periodic Callbacks</span></span>

<span data-ttu-id="21f2d-166">A função [**MFAddPeriodicCallback**](/windows/desktop/api/mfapi/nf-mfapi-mfaddperiodiccallback) agenda um retorno de chamada para ser invocado periodicamente até você cancelá-lo.</span><span class="sxs-lookup"><span data-stu-id="21f2d-166">The [**MFAddPeriodicCallback**](/windows/desktop/api/mfapi/nf-mfapi-mfaddperiodiccallback) function schedules a callback to be invoked periodically until you cancel it.</span></span> <span data-ttu-id="21f2d-167">O intervalo de retorno de chamada é fixo; os aplicativos não podem alterá-lo.</span><span class="sxs-lookup"><span data-stu-id="21f2d-167">The callback interval is fixed; applications cannot change it.</span></span> <span data-ttu-id="21f2d-168">Para descobrir o intervalo exato, chame [**MFGetTimerPeriodicity**](/windows/desktop/api/mfapi/nf-mfapi-mfgettimerperiodicity).</span><span class="sxs-lookup"><span data-stu-id="21f2d-168">To find out the exact interval, call [**MFGetTimerPeriodicity**](/windows/desktop/api/mfapi/nf-mfapi-mfgettimerperiodicity).</span></span> <span data-ttu-id="21f2d-169">O intervalo está na ordem de 10 milissegundos, portanto, essa função é destinada a situações em que você precisa de um "tique", como a implementação de um relógio de apresentação.</span><span class="sxs-lookup"><span data-stu-id="21f2d-169">The interval is on the order of 10 milliseconds, so this function is meant for situations where you need a frequent "tick," such as implementing a presentation clock.</span></span> <span data-ttu-id="21f2d-170">Se você quiser agendar a ocorrência de uma operação com menos frequência, use um item de trabalho agendado, conforme descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="21f2d-170">If you want to schedule an operation to occur less frequently, use a scheduled work item, as described previously.</span></span>

<span data-ttu-id="21f2d-171">Ao contrário dos outros retornos de chamada descritos neste tópico, o retorno de chamada periódico não usa a interface [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) .</span><span class="sxs-lookup"><span data-stu-id="21f2d-171">Unlike the other callbacks described in this topic, the periodic callback does not use the [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback) interface.</span></span> <span data-ttu-id="21f2d-172">Em vez disso, ele usa um ponteiro de função.</span><span class="sxs-lookup"><span data-stu-id="21f2d-172">Instead, it uses a function pointer.</span></span> <span data-ttu-id="21f2d-173">Para obter mais informações, consulte [**retorno de chamada MFPERIODICCALLBACK**](/windows/win32/api/mfapi/nc-mfapi-mfperiodiccallback).</span><span class="sxs-lookup"><span data-stu-id="21f2d-173">For more information, see [**MFPERIODICCALLBACK Callback**](/windows/win32/api/mfapi/nc-mfapi-mfperiodiccallback).</span></span>

<span data-ttu-id="21f2d-174">Para cancelar o retorno de chamada periódico, chame [**MFRemovePeriodicCallback**](/windows/desktop/api/mfapi/nf-mfapi-mfremoveperiodiccallback).</span><span class="sxs-lookup"><span data-stu-id="21f2d-174">To cancel the periodic callback, call [**MFRemovePeriodicCallback**](/windows/desktop/api/mfapi/nf-mfapi-mfremoveperiodiccallback).</span></span>

<span data-ttu-id="21f2d-175">Retornos de chamada periódicos usam a \_ fila de trabalho da plataforma de retorno de chamada MFASYNC \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="21f2d-175">Periodic callbacks use the MFASYNC\_CALLBACK\_QUEUE\_TIMER platform work queue.</span></span>

## <a name="related-topics"></a><span data-ttu-id="21f2d-176">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="21f2d-176">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="21f2d-177">Filas de trabalho</span><span class="sxs-lookup"><span data-stu-id="21f2d-177">Work Queues</span></span>](work-queues.md)
</dt> <dt>

[<span data-ttu-id="21f2d-178">**MFASYNCRESULT**</span><span class="sxs-lookup"><span data-stu-id="21f2d-178">**MFASYNCRESULT**</span></span>](/windows/win32/api/mfapi/ns-mfapi-mfasyncresult)
</dt> <dt>

[<span data-ttu-id="21f2d-179">Aprimoramentos na fila de trabalho e threading</span><span class="sxs-lookup"><span data-stu-id="21f2d-179">Work Queue and Threading Improvements</span></span>](media-foundation-work-queue-and-threading-improvements.md)
</dt> </dl>

 

 
