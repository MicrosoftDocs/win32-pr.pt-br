---
description: Este tópico descreve as melhorias no Windows 8 para filas de trabalho e threading na plataforma Microsoft Media Foundation.
ms.assetid: 9E2A1D94-BF82-488E-8297-D524683ABE17
title: Aprimoramentos na fila de trabalho e threading
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 07b307cb00316696e075e9e9cc2a138e98e149be
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/03/2021
ms.locfileid: "104011954"
---
# <a name="work-queue-and-threading-improvements"></a><span data-ttu-id="949a4-103">Aprimoramentos na fila de trabalho e threading</span><span class="sxs-lookup"><span data-stu-id="949a4-103">Work Queue and Threading Improvements</span></span>

<span data-ttu-id="949a4-104">Este tópico descreve as melhorias no Windows 8 para filas de trabalho e threading na plataforma Microsoft Media Foundation.</span><span class="sxs-lookup"><span data-stu-id="949a4-104">This topic describes improvements in Windows 8 for work queues and threading in the Microsoft Media Foundation platform.</span></span>

-   [<span data-ttu-id="949a4-105">Comportamento do Windows 7</span><span class="sxs-lookup"><span data-stu-id="949a4-105">Windows 7 Behavior</span></span>](#windows-7-behavior)
    -   [<span data-ttu-id="949a4-106">Filas de trabalho</span><span class="sxs-lookup"><span data-stu-id="949a4-106">Work Queues</span></span>](#work-queues)
    -   [<span data-ttu-id="949a4-107">Suporte do MMCSS</span><span class="sxs-lookup"><span data-stu-id="949a4-107">MMCSS Support</span></span>](#mmcss-support)
    -   [<span data-ttu-id="949a4-108">IMFRealTimeClient</span><span class="sxs-lookup"><span data-stu-id="949a4-108">IMFRealTimeClient</span></span>](#imfrealtimeclientex)
-   [<span data-ttu-id="949a4-109">Aprimoramentos do Windows 8</span><span class="sxs-lookup"><span data-stu-id="949a4-109">Windows 8 Improvements</span></span>](#windows-8-improvements)
    -   [<span data-ttu-id="949a4-110">Filas de trabalho multi-threaded</span><span class="sxs-lookup"><span data-stu-id="949a4-110">Multithreaded Work Queues</span></span>](#multithreaded-work-queues)
    -   [<span data-ttu-id="949a4-111">Filas de trabalho da tarefa compartilhada</span><span class="sxs-lookup"><span data-stu-id="949a4-111">Shared Task Work Queues</span></span>](#shared-task-work-queues)
    -   [<span data-ttu-id="949a4-112">Aguardar fila</span><span class="sxs-lookup"><span data-stu-id="949a4-112">Wait Queue</span></span>](#wait-queue)
    -   [<span data-ttu-id="949a4-113">Aprimoramentos no suporte do MMCSS</span><span class="sxs-lookup"><span data-stu-id="949a4-113">Enhancements to MMCSS Support</span></span>](#enhancements-to-mmcss-support)
    -   [<span data-ttu-id="949a4-114">IMFRealTimeClientEx</span><span class="sxs-lookup"><span data-stu-id="949a4-114">IMFRealTimeClientEx</span></span>](#imfrealtimeclientex)
    -   [<span data-ttu-id="949a4-115">Branches de topologia</span><span class="sxs-lookup"><span data-stu-id="949a4-115">Topology Branches</span></span>](#topology-branches)
-   [<span data-ttu-id="949a4-116">Recomendações</span><span class="sxs-lookup"><span data-stu-id="949a4-116">Recommendations</span></span>](#recommendations)
-   [<span data-ttu-id="949a4-117">Resumo</span><span class="sxs-lookup"><span data-stu-id="949a4-117">Summary</span></span>](#summary)
-   [<span data-ttu-id="949a4-118">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="949a4-118">Related topics</span></span>](#related-topics)

## <a name="windows-7-behavior"></a><span data-ttu-id="949a4-119">Comportamento do Windows 7</span><span class="sxs-lookup"><span data-stu-id="949a4-119">Windows 7 Behavior</span></span>

<span data-ttu-id="949a4-120">Esta seção resume o comportamento de Media Foundation filas de trabalho no Windows 7.</span><span class="sxs-lookup"><span data-stu-id="949a4-120">This section summarizes the behavior of Media Foundation work queues in Windows 7.</span></span>

### <a name="work-queues"></a><span data-ttu-id="949a4-121">Filas de trabalho</span><span class="sxs-lookup"><span data-stu-id="949a4-121">Work Queues</span></span>

<span data-ttu-id="949a4-122">A plataforma Media Foundation cria várias filas de trabalho padrão.</span><span class="sxs-lookup"><span data-stu-id="949a4-122">The Media Foundation platform creates several standard work queues.</span></span> <span data-ttu-id="949a4-123">Somente dois são documentados como sendo usados para uso geral do aplicativo:</span><span class="sxs-lookup"><span data-stu-id="949a4-123">Only two are documented as being for general application use:</span></span>

-   <span data-ttu-id="949a4-124">**padrão de fila de retorno de \_ chamada MFASYNC \_ \_**</span><span class="sxs-lookup"><span data-stu-id="949a4-124">**MFASYNC\_CALLBACK\_QUEUE\_STANDARD**</span></span>
-   <span data-ttu-id="949a4-125">**\_ \_ função longa da fila de retorno de chamada MFASYNC \_ \_**</span><span class="sxs-lookup"><span data-stu-id="949a4-125">**MFASYNC\_CALLBACK\_QUEUE\_LONG\_FUNCTION**</span></span>

<span data-ttu-id="949a4-126">Um aplicativo ou componente pode alocar novas filas de trabalho chamando [**MFAllocateWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueue) ou [**MFAllocateWorkQueueEx**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueueex).</span><span class="sxs-lookup"><span data-stu-id="949a4-126">An application or component can allocate new work queues by calling [**MFAllocateWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueue) or [**MFAllocateWorkQueueEx**](/windows/desktop/api/mfapi/nf-mfapi-mfallocateworkqueueex).</span></span> <span data-ttu-id="949a4-127">A função **MFAllocateWorkQueueEx** define dois tipos de fila de trabalho:</span><span class="sxs-lookup"><span data-stu-id="949a4-127">The **MFAllocateWorkQueueEx** function defines two types of work queue:</span></span>

-   <span data-ttu-id="949a4-128">**MF \_ A \_** fila de trabalhos padrão cria uma fila de trabalho sem um loop de mensagem.</span><span class="sxs-lookup"><span data-stu-id="949a4-128">**MF\_STANDARD\_WORKQUEUE** creates a work queue without a message loop.</span></span>
-   <span data-ttu-id="949a4-129">**MF \_ A janela \_ fila** cria uma fila de trabalho com um loop de mensagem.</span><span class="sxs-lookup"><span data-stu-id="949a4-129">**MF\_WINDOW\_WORKQUEUE** creates a work queue with a message loop.</span></span>

<span data-ttu-id="949a4-130">Para enfileirar um item de trabalho, chame [**MFPutWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) ou [**MFPutWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex).</span><span class="sxs-lookup"><span data-stu-id="949a4-130">To queue a work item, call [**MFPutWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem) or [**MFPutWorkItemEx**](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex).</span></span> <span data-ttu-id="949a4-131">A plataforma executa o item de trabalho invocando a implementação fornecida pelo chamador de [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback).</span><span class="sxs-lookup"><span data-stu-id="949a4-131">The platform executes the work item by invoking the caller-provided implementation of [**IMFAsyncCallback**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasynccallback).</span></span> <span data-ttu-id="949a4-132">No Windows 7 e versões anteriores, a plataforma cria um thread por fila de trabalho.</span><span class="sxs-lookup"><span data-stu-id="949a4-132">In Windows 7 and earlier, the platform creates one thread per work queue.</span></span>

### <a name="mmcss-support"></a><span data-ttu-id="949a4-133">Suporte do MMCSS</span><span class="sxs-lookup"><span data-stu-id="949a4-133">MMCSS Support</span></span>

<span data-ttu-id="949a4-134">O [serviço do Agendador de classes de multimídia](../procthread/multimedia-class-scheduler-service.md) (MMCSS) gerencia prioridades de thread para que os aplicativos de multimídia obtenham fatias regulares de tempo de CPU, sem negar recursos de CPU a aplicativos de prioridade mais baixa.</span><span class="sxs-lookup"><span data-stu-id="949a4-134">The [Multimedia Class Scheduler Service](../procthread/multimedia-class-scheduler-service.md) (MMCSS) manages thread priorities so that multimedia applications get regular slices of CPU time, without denying CPU resources to lower-priority applications.</span></span> <span data-ttu-id="949a4-135">O MMCSS define um conjunto de *tarefas* que têm perfis de utilização de CPU diferentes.</span><span class="sxs-lookup"><span data-stu-id="949a4-135">MMCSS defines a set of *tasks* that have different CPU utilization profiles.</span></span> <span data-ttu-id="949a4-136">Quando um thread ingressa em uma tarefa do MMCSS, o MMCSS define a prioridade do thread com base em vários fatores:</span><span class="sxs-lookup"><span data-stu-id="949a4-136">When a thread joins an MMCSS task, MMCSS sets the priority of the thread based on several factors:</span></span>

-   <span data-ttu-id="949a4-137">A prioridade base da tarefa, que é definida no registro.</span><span class="sxs-lookup"><span data-stu-id="949a4-137">The base priority of the task, which is set in the registry.</span></span>
-   <span data-ttu-id="949a4-138">A prioridade de thread relativa, que é definida em tempo de execução chamando [**AvSetMmThreadPriority**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadpriority).</span><span class="sxs-lookup"><span data-stu-id="949a4-138">The relative thread priority, which is set at run time by calling [**AvSetMmThreadPriority**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadpriority).</span></span>
-   <span data-ttu-id="949a4-139">Várias características de tempo de execução, como se o aplicativo está em primeiro plano e quanto tempo de CPU está sendo consumido pelos threads em cada classe do MMCSS.</span><span class="sxs-lookup"><span data-stu-id="949a4-139">Various run-time characteristics, such as whether the application is in the foreground, and how much CPU time is being consumed by the threads in each MMCSS class.</span></span>

<span data-ttu-id="949a4-140">Um aplicativo pode registrar uma fila de trabalho com o MMCSS chamando [**MFBeginRegisterWorkQueueWithMMCSS**](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcss).</span><span class="sxs-lookup"><span data-stu-id="949a4-140">An application can register a work queue with MMCSS by calling [**MFBeginRegisterWorkQueueWithMMCSS**](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcss).</span></span> <span data-ttu-id="949a4-141">Essa função usa uma ID de fila de trabalho, uma classe do MMCSS (nome da tarefa) e o identificador de tarefa do MMCSS.</span><span class="sxs-lookup"><span data-stu-id="949a4-141">This function takes a work queue ID, an MMCSS class (task name), and the MMCSS task identifier.</span></span> <span data-ttu-id="949a4-142">Internamente, ele chama [**AvSetMmThreadCharacteristics**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadcharacteristicsa) com o nome da tarefa e a ID da tarefa.</span><span class="sxs-lookup"><span data-stu-id="949a4-142">Internally, it calls [**AvSetMmThreadCharacteristics**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadcharacteristicsa) with the task name and task ID.</span></span> <span data-ttu-id="949a4-143">Depois que uma fila de trabalho é registrada com o MMCSS, você pode obter a ID da classe e da tarefa chamando [**MFGetWorkQueueMMCSSClass**](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcssclass) e [**MFGetWorkQueueMMCSSTaskId**](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcsstaskid).</span><span class="sxs-lookup"><span data-stu-id="949a4-143">After a work queue is registered with MMCSS, you can get the class and task ID by calling [**MFGetWorkQueueMMCSSClass**](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcssclass) and [**MFGetWorkQueueMMCSSTaskId**](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcsstaskid).</span></span>

<span data-ttu-id="949a4-144">A [sessão de mídia](media-session.md) fornece um acesso de nível mais alto a essas APIs, por meio da interface [**IMFWorkQueueServices**](/windows/desktop/api/mfidl/nn-mfidl-imfworkqueueservices) .</span><span class="sxs-lookup"><span data-stu-id="949a4-144">The [Media Session](media-session.md) provides somewhat higher-level access to these APIs, through the [**IMFWorkQueueServices**](/windows/desktop/api/mfidl/nn-mfidl-imfworkqueueservices) interface.</span></span> <span data-ttu-id="949a4-145">Essa interface fornece dois métodos principais:</span><span class="sxs-lookup"><span data-stu-id="949a4-145">This interface provides two primary methods:</span></span>

| <span data-ttu-id="949a4-146">Método</span><span class="sxs-lookup"><span data-stu-id="949a4-146">Method</span></span>                                                                                                            | <span data-ttu-id="949a4-147">Descrição</span><span class="sxs-lookup"><span data-stu-id="949a4-147">Description</span></span>                                                                                                                                                                                                                                                                                   |
|-------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="949a4-148">**BeginRegisterPlatformWorkQueueWithMMCSS**</span><span class="sxs-lookup"><span data-stu-id="949a4-148">**BeginRegisterPlatformWorkQueueWithMMCSS**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregisterplatformworkqueuewithmmcss)   | <span data-ttu-id="949a4-149">Registra uma fila de trabalho com uma tarefa do MMCSS.</span><span class="sxs-lookup"><span data-stu-id="949a4-149">Registers a work queue with an MMCSS task.</span></span> <span data-ttu-id="949a4-150">Esse método é essencialmente um wrapper fino em volta de [**MFBeginRegisterWorkQueueWithMMCSS**](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcss), mas você pode passar o valor **MFASYNC \_ fila de retorno de chamada \_ \_** para registrar todas as filas de trabalho da plataforma de uma vez.</span><span class="sxs-lookup"><span data-stu-id="949a4-150">This method is essentially a thin wrapper around [**MFBeginRegisterWorkQueueWithMMCSS**](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcss), but you can pass the value **MFASYNC\_CALLBACK\_QUEUE\_ALL** to register all of the platform work queues at once.</span></span> |
| [<span data-ttu-id="949a4-151">**BeginRegisterTopologyWorkQueuesWithMMCSS**</span><span class="sxs-lookup"><span data-stu-id="949a4-151">**BeginRegisterTopologyWorkQueuesWithMMCSS**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) | <span data-ttu-id="949a4-152">Registra uma ramificação da topologia com uma fila de trabalho.</span><span class="sxs-lookup"><span data-stu-id="949a4-152">Registers a branch of the topology with a work queue.</span></span>                                                                                                                                                                                                                                         |



 

<span data-ttu-id="949a4-153">Para registrar uma ramificação de topologia, faça o seguinte.</span><span class="sxs-lookup"><span data-stu-id="949a4-153">To register a topology branch, do the following.</span></span>

1.  <span data-ttu-id="949a4-154">Defina o atributo de ID de fila de TOPONODE do MF no nó de origem para a ramificação. [ \_ \_ \_ ](mf-toponode-workqueue-id-attribute.md)</span><span class="sxs-lookup"><span data-stu-id="949a4-154">Set the [MF\_TOPONODE\_WORKQUEUE\_ID](mf-toponode-workqueue-id-attribute.md) attribute on the source node for the branch.</span></span> <span data-ttu-id="949a4-155">Use qualquer valor definido pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="949a4-155">Use any application-defined value.</span></span>
2.  <span data-ttu-id="949a4-156">Opcionalmente, defina a **\_ classe MF TOPONODE Queue \_ \_ MMCSS \_** para unir a fila de trabalho a uma tarefa do MMCSS.</span><span class="sxs-lookup"><span data-stu-id="949a4-156">Optionally, set the **MF\_TOPONODE\_WORKQUEUE\_MMCSS\_CLASS** to join the work queue to an MMCSS task.</span></span>
3.  <span data-ttu-id="949a4-157">Chame [**BeginRegisterTopologyWorkQueuesWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) na topologia resolvida.</span><span class="sxs-lookup"><span data-stu-id="949a4-157">Call [**BeginRegisterTopologyWorkQueuesWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) on the resolved topology.</span></span>

<span data-ttu-id="949a4-158">A sessão de mídia aloca uma nova fila de trabalho para cada valor exclusivo da [ \_ ID de \_ fila \_ de filas MF TOPONODE](mf-toponode-workqueue-id-attribute.md).</span><span class="sxs-lookup"><span data-stu-id="949a4-158">The Media Session allocates a new work queue for each unique value of [MF\_TOPONODE\_WORKQUEUE\_ID](mf-toponode-workqueue-id-attribute.md).</span></span> <span data-ttu-id="949a4-159">Para cada ramificação de topologia, as operações de pipeline assíncronas são executadas na fila de trabalho que é atribuída à ramificação.</span><span class="sxs-lookup"><span data-stu-id="949a4-159">For each topology branch, asynchronous pipeline operations are performed on the work queue that is assigned to the branch.</span></span>

### <a name="imfrealtimeclient"></a><span data-ttu-id="949a4-160">IMFRealTimeClient</span><span class="sxs-lookup"><span data-stu-id="949a4-160">IMFRealTimeClient</span></span>

<span data-ttu-id="949a4-161">A interface [**IMFRealTimeClient**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclient) é destinada a componentes de pipeline que criam seus próprios threads ou usam filas de trabalho para operações assíncronas.</span><span class="sxs-lookup"><span data-stu-id="949a4-161">The [**IMFRealTimeClient**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclient) interface is intended for pipeline components that either create their own threads or use work queues for asynchronous operations.</span></span> <span data-ttu-id="949a4-162">A sessão de mídia usa essa interface para notificar o componente de pipeline do comportamento correto, da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="949a4-162">The Media Session uses this interface to notify the pipeline component of the correct behavior, as follows:</span></span>

-   <span data-ttu-id="949a4-163">Se o componente de pipeline criar um thread de trabalho, o método [**IMFRealTimeClient:: RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-registerthreads) notificará o componente que a classe do MMCSS deve ingressar.</span><span class="sxs-lookup"><span data-stu-id="949a4-163">If the pipeline component creates a worker thread, the [**IMFRealTimeClient::RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-registerthreads) method notifies the component which MMCSS class to join.</span></span>
-   <span data-ttu-id="949a4-164">Se o componente de pipeline usa uma fila de trabalho, o método [**IMFRealTimeClient:: SetWorkQueue**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-setworkqueue) informa o componente que a fila de trabalho deve usar.</span><span class="sxs-lookup"><span data-stu-id="949a4-164">If the pipeline component uses a work queue, the [**IMFRealTimeClient::SetWorkQueue**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-setworkqueue) method tells the component which work queue to use.</span></span>

<span data-ttu-id="949a4-165">Normalmente, um componente de pipeline usa um thread ou uma fila de trabalho para executar tarefas assíncronas, mas não ambos.</span><span class="sxs-lookup"><span data-stu-id="949a4-165">Typically, a pipeline component uses either a thread or a work queue to perform asynchronous tasks, but not both.</span></span>

## <a name="windows-8-improvements"></a><span data-ttu-id="949a4-166">Aprimoramentos do Windows 8</span><span class="sxs-lookup"><span data-stu-id="949a4-166">Windows 8 Improvements</span></span>

### <a name="multithreaded-work-queues"></a><span data-ttu-id="949a4-167">Filas de trabalho multi-threaded</span><span class="sxs-lookup"><span data-stu-id="949a4-167">Multithreaded Work Queues</span></span>

<span data-ttu-id="949a4-168">No Windows 8, o Media Foundation dá suporte a um novo tipo de fila de trabalho chamado *fila multi-threaded*.</span><span class="sxs-lookup"><span data-stu-id="949a4-168">In Windows 8, Media Foundation supports a new type of work queue called the *multithreaded queue*.</span></span> <span data-ttu-id="949a4-169">Uma fila multi-threaded usa um pool de segmentos do sistema para distribuir itens de trabalho.</span><span class="sxs-lookup"><span data-stu-id="949a4-169">A multithreaded queue uses a system thread pool to dispatch work items.</span></span> <span data-ttu-id="949a4-170">A fila multi-threaded escala melhor do que as filas de thread único anteriores.</span><span class="sxs-lookup"><span data-stu-id="949a4-170">The multithreaded queue scales better than the previous single-threaded queues.</span></span> <span data-ttu-id="949a4-171">Por exemplo,</span><span class="sxs-lookup"><span data-stu-id="949a4-171">For example,</span></span>

-   <span data-ttu-id="949a4-172">Vários componentes podem compartilhar uma fila multi-threaded sem bloquear um ao outro, exigindo a criação de menos threads.</span><span class="sxs-lookup"><span data-stu-id="949a4-172">Several components can share a multithreaded queue without blocking one another, requiring the creation of fewer threads.</span></span>

-   <span data-ttu-id="949a4-173">Os itens de trabalho são otimizados para evitar alternâncias de contexto se um evento já estiver definido.</span><span class="sxs-lookup"><span data-stu-id="949a4-173">Work items are optimized to avoid context switches if an event is already set.</span></span> <span data-ttu-id="949a4-174">Isso é mais eficiente do que criar seus próprios threads para aguardar eventos.</span><span class="sxs-lookup"><span data-stu-id="949a4-174">This is more efficient than creating your own threads to wait on events.</span></span>

<span data-ttu-id="949a4-175">Ao usar o [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex), os aplicativos devem evitar a rotação de threads e, em vez disso, devem usar as filas de trabalho.</span><span class="sxs-lookup"><span data-stu-id="949a4-175">When using [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex), applications should avoid spinning up threads and instead should use the work queues.</span></span> <span data-ttu-id="949a4-176">Para fazer isso, os aplicativos devem implementar [**SetWorkQueueEx**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-setworkqueueex) e não usar [**RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-registerthreadsex) e [**UnregisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-unregisterthreads).</span><span class="sxs-lookup"><span data-stu-id="949a4-176">To accomplish this, applications should implement [**SetWorkQueueEx**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-setworkqueueex) and not use [**RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-registerthreadsex) and [**UnregisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-unregisterthreads).</span></span>

<span data-ttu-id="949a4-177">Quando a plataforma de Media Foundation é inicializada, ela cria uma fila multi-threaded com a fila de retorno de chamada MFASYNC do identificador com **\_ \_ \_ vários threads**.</span><span class="sxs-lookup"><span data-stu-id="949a4-177">When the Media Foundation platform is initialized, it creates a multithreaded queue with the identifier **MFASYNC\_CALLBACK\_QUEUE\_MULTITHREADED**.</span></span>

<span data-ttu-id="949a4-178">Uma fila multi-threaded não serializa itens de trabalho.</span><span class="sxs-lookup"><span data-stu-id="949a4-178">A multithreaded queue does not serialize work items.</span></span> <span data-ttu-id="949a4-179">Sempre que um thread do pool de threads se tornar disponível, o próximo item de trabalho na fila será expedido.</span><span class="sxs-lookup"><span data-stu-id="949a4-179">Whenever a thread from the thread pool becomes available, the next work item on the queue is dispatched.</span></span> <span data-ttu-id="949a4-180">O chamador deve garantir que o trabalho seja serializado corretamente.</span><span class="sxs-lookup"><span data-stu-id="949a4-180">The caller must ensure that work is serialized correctly.</span></span> <span data-ttu-id="949a4-181">Para tornar isso mais fácil, Media Foundation define uma *fila de trabalho serial*.</span><span class="sxs-lookup"><span data-stu-id="949a4-181">To make this easier, Media Foundation defines a *serial work queue*.</span></span> <span data-ttu-id="949a4-182">Uma fila serial encapsula outra fila de trabalho, mas garante a execução totalmente serializada.</span><span class="sxs-lookup"><span data-stu-id="949a4-182">A serial queue wraps another work queue but guarantees fully serialized execution.</span></span> <span data-ttu-id="949a4-183">O próximo item na fila não é expedido até que o item anterior seja concluído.</span><span class="sxs-lookup"><span data-stu-id="949a4-183">The next item on the queue is not dispatched until the previous item completes.</span></span>

<span data-ttu-id="949a4-184">O código a seguir cria uma fila de serializador na fila multithread de plataforma.</span><span class="sxs-lookup"><span data-stu-id="949a4-184">The following code creates a serializer queue over the platform multithreaded queue.</span></span>


```C++
DWORD workQueueID;
hr = MFAllocateSerialWorkQueue(MFASYNC_CALLBACK_QUEUE_MULTITHREADED, &workQueueID); 
```



<span data-ttu-id="949a4-185">Mais de uma fila serial pode encapsular a mesma fila multi-threaded.</span><span class="sxs-lookup"><span data-stu-id="949a4-185">More than one serial queue can wrap the same multithreaded queue.</span></span> <span data-ttu-id="949a4-186">Em seguida, as filas de série compartilham o mesmo pool de threads e a execução serializada é imposta dentro de cada fila.</span><span class="sxs-lookup"><span data-stu-id="949a4-186">The serial queues then share the same thread pool, and serialized execution is enforced within each queue.</span></span>

<span data-ttu-id="949a4-187">As filas de trabalho padrão que existiam antes do Windows 8 agora são implementadas como filas de trabalho seriais que encapsulam a fila multi-threaded de plataforma.</span><span class="sxs-lookup"><span data-stu-id="949a4-187">The standard work queues that existed prior to Windows 8 are now implemented as serial work queues that wrap the platform multithreaded queue.</span></span> <span data-ttu-id="949a4-188">Essa alteração preserva a compatibilidade com versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="949a4-188">This change preserves backward compatibility.</span></span>

### <a name="shared-task-work-queues"></a><span data-ttu-id="949a4-189">Filas de trabalho da tarefa compartilhada</span><span class="sxs-lookup"><span data-stu-id="949a4-189">Shared Task Work Queues</span></span>

<span data-ttu-id="949a4-190">Para funcionar corretamente com o Agendador de kernel, deve haver uma fila de trabalho multi-threaded para cada tarefa do MMCSS que você usar.</span><span class="sxs-lookup"><span data-stu-id="949a4-190">To work correctly with the kernel scheduler, there should be one multithreaded work queue for each MMCSS task that you use.</span></span> <span data-ttu-id="949a4-191">A plataforma Media Foundation aloca isso conforme necessário, até uma por tarefa do MMCSS, por processo.</span><span class="sxs-lookup"><span data-stu-id="949a4-191">The Media Foundation platform allocates these as needed, up to one per MMCSS task, per process.</span></span> <span data-ttu-id="949a4-192">Para obter a fila de trabalho compartilhada para uma tarefa do MMCSS em particular, chame [**MFLockSharedWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mflocksharedworkqueue) e especifique o nome da tarefa.</span><span class="sxs-lookup"><span data-stu-id="949a4-192">To get the shared work queue for a particular MMCSS task, call [**MFLockSharedWorkQueue**](/windows/desktop/api/mfapi/nf-mfapi-mflocksharedworkqueue) and specify the task name.</span></span> <span data-ttu-id="949a4-193">A função pesquisa o nome da tarefa em uma tabela.</span><span class="sxs-lookup"><span data-stu-id="949a4-193">The function looks up the task name in a table.</span></span> <span data-ttu-id="949a4-194">Se uma fila de trabalho ainda não existir para essa tarefa, a função alocará uma nova fila de trabalho MT e a unirá imediatamente à tarefa do MMCSS.</span><span class="sxs-lookup"><span data-stu-id="949a4-194">If a work queue does not already exist for this task, the function allocates a new MT work queue and immediately joins it to the MMCSS task.</span></span> <span data-ttu-id="949a4-195">Se uma fila de trabalho já existir para essa tarefa, a função retornará o identificador da fila de trabalho existente.</span><span class="sxs-lookup"><span data-stu-id="949a4-195">If a work queue already exists for that task, the function returns the identifier of the existing work queue.</span></span>

### <a name="wait-queue"></a><span data-ttu-id="949a4-196">Aguardar fila</span><span class="sxs-lookup"><span data-stu-id="949a4-196">Wait Queue</span></span>

<span data-ttu-id="949a4-197">A *fila de espera* é uma fila de trabalho de plataforma especial que aguarda eventos a serem sinalizados.</span><span class="sxs-lookup"><span data-stu-id="949a4-197">The *wait queue* is a special platform work queue that waits on events to be signaled.</span></span> <span data-ttu-id="949a4-198">Se um componente precisar aguardar que um evento seja sinalizado, ele poderá usar a fila de espera em vez de criar um thread de trabalho para aguardar o evento.</span><span class="sxs-lookup"><span data-stu-id="949a4-198">If a component needs to wait for an event to be signaled, it can use the wait queue instead of creating a worker thread to wait on the event.</span></span>

<span data-ttu-id="949a4-199">Para usar a fila de espera, chame [**MFPutWaitingWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputwaitingworkitem).</span><span class="sxs-lookup"><span data-stu-id="949a4-199">To use the wait queue, call [**MFPutWaitingWorkItem**](/windows/desktop/api/mfapi/nf-mfapi-mfputwaitingworkitem).</span></span> <span data-ttu-id="949a4-200">Os parâmetros incluem o identificador de evento e um ponteiro [**IMFAsyncResult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) .</span><span class="sxs-lookup"><span data-stu-id="949a4-200">The parameters include the event handle and an [**IMFAsyncResult**](/windows/desktop/api/mfobjects/nn-mfobjects-imfasyncresult) pointer.</span></span> <span data-ttu-id="949a4-201">Quando o evento é sinalizado, a fila de espera invoca o retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="949a4-201">When the event is signaled, the wait queue invokes your callback.</span></span> <span data-ttu-id="949a4-202">Há uma única fila de espera de plataforma; os aplicativos não podem criar suas próprias filas de espera.</span><span class="sxs-lookup"><span data-stu-id="949a4-202">There is a single platform wait queue; applications cannot create their own wait queues.</span></span>

### <a name="enhancements-to-mmcss-support"></a><span data-ttu-id="949a4-203">Aprimoramentos no suporte do MMCSS</span><span class="sxs-lookup"><span data-stu-id="949a4-203">Enhancements to MMCSS Support</span></span>

<span data-ttu-id="949a4-204">As novas funções de plataforma de Media Foundation a seguir estão relacionadas ao MMCSS.</span><span class="sxs-lookup"><span data-stu-id="949a4-204">The following new Media Foundation platform functions relate to MMCSS.</span></span>



| <span data-ttu-id="949a4-205">Função</span><span class="sxs-lookup"><span data-stu-id="949a4-205">Function</span></span>                                                                           | <span data-ttu-id="949a4-206">Descrição</span><span class="sxs-lookup"><span data-stu-id="949a4-206">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                           |
|------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="949a4-207">**MFBeginRegisterWorkQueueWithMMCSSEx**</span><span class="sxs-lookup"><span data-stu-id="949a4-207">**MFBeginRegisterWorkQueueWithMMCSSEx**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcssex) | <span data-ttu-id="949a4-208">Registra uma fila de trabalho com o MMCSS.</span><span class="sxs-lookup"><span data-stu-id="949a4-208">Registers a work queue with MMCSS.</span></span> <span data-ttu-id="949a4-209">Essa função inclui um parâmetro para especificar a prioridade de thread relativa.</span><span class="sxs-lookup"><span data-stu-id="949a4-209">This function includes a parameter to specify relative thread priority.</span></span> <span data-ttu-id="949a4-210">Internamente, esse valor é convertido em uma chamada para [**AvSetMmThreadPriority**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadpriority).</span><span class="sxs-lookup"><span data-stu-id="949a4-210">Internally, this value is translated into a call to [**AvSetMmThreadPriority**](/windows/win32/api/avrt/nf-avrt-avsetmmthreadpriority).</span></span>                                                                                                                                                                               |
| [<span data-ttu-id="949a4-211">**MFGetWorkQueueMMCSSPriority**</span><span class="sxs-lookup"><span data-stu-id="949a4-211">**MFGetWorkQueueMMCSSPriority**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcsspriority)                 | <span data-ttu-id="949a4-212">Consulta a prioridade de uma fila de trabalho.</span><span class="sxs-lookup"><span data-stu-id="949a4-212">Queries the priority of a work queue.</span></span>                                                                                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="949a4-213">**MFRegisterPlatformWithMMCSS**</span><span class="sxs-lookup"><span data-stu-id="949a4-213">**MFRegisterPlatformWithMMCSS**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfregisterplatformwithmmcss)                 | <span data-ttu-id="949a4-214">Registra todas as filas de trabalho da plataforma com uma tarefa do MMCSS.</span><span class="sxs-lookup"><span data-stu-id="949a4-214">Registers all of the platform work queues with an MMCSS task.</span></span> <span data-ttu-id="949a4-215">Essa função é semelhante ao método [**IMFWorkQueueServices:: BeginRegisterPlatformWorkQueueWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregisterplatformworkqueuewithmmcss) , mas pode ser usada sem criar uma instância da sessão de mídia.</span><span class="sxs-lookup"><span data-stu-id="949a4-215">This function is similar to the [**IMFWorkQueueServices::BeginRegisterPlatformWorkQueueWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregisterplatformworkqueuewithmmcss) method, but it can be used without creating an instance of the Media Session.</span></span> <span data-ttu-id="949a4-216">Além disso, a função inclui um parâmetro para especificar a prioridade de thread base.</span><span class="sxs-lookup"><span data-stu-id="949a4-216">In addition, the function includes a parameter to specify the base thread priority.</span></span> |



 

<span data-ttu-id="949a4-217">Os aplicativos que usam a sessão de mídia devem definir o atributo de [ \_ classe MF TOPONODE \_ fila do \_ MMCSS \_ ](mf-toponode-workqueue-mmcss-class-attribute.md) como "áudio" para a ramificação de renderização de áudio.</span><span class="sxs-lookup"><span data-stu-id="949a4-217">Applications that use the Media Session should set the [MF\_TOPONODE\_WORKQUEUE\_MMCSS\_CLASS](mf-toponode-workqueue-mmcss-class-attribute.md) attribute to "Audio" for the audio rendering branch.</span></span> <span data-ttu-id="949a4-218">Defina o atributo como "reprodução" para a ramificação de renderização de vídeo.</span><span class="sxs-lookup"><span data-stu-id="949a4-218">Set the attribute to "Playback" for the video rendering branch.</span></span>

### <a name="imfrealtimeclientex"></a><span data-ttu-id="949a4-219">IMFRealTimeClientEx</span><span class="sxs-lookup"><span data-stu-id="949a4-219">IMFRealTimeClientEx</span></span>

<span data-ttu-id="949a4-220">A interface [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex) substitui IMFRealTimeClient, para componentes de pipeline que executam operações assíncronas.</span><span class="sxs-lookup"><span data-stu-id="949a4-220">The [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex) interface to replaces IMFRealTimeClient, for pipeline components that perform asynchronous operations.</span></span>



| <span data-ttu-id="949a4-221">Método</span><span class="sxs-lookup"><span data-stu-id="949a4-221">Method</span></span>                                                             | <span data-ttu-id="949a4-222">Descrição</span><span class="sxs-lookup"><span data-stu-id="949a4-222">Description</span></span>                                                                                                                                                                                                                    |
|--------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="949a4-223">**RegisterThreadsEx**</span><span class="sxs-lookup"><span data-stu-id="949a4-223">**RegisterThreadsEx**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-registerthreadsex) | <span data-ttu-id="949a4-224">Notifica o componente para registrar seus threads com o MMCSS.</span><span class="sxs-lookup"><span data-stu-id="949a4-224">Notifies the component to register its threads with MMCSS.</span></span> <span data-ttu-id="949a4-225">Esse método é equivalente a [**IMFRealTimeClient:: RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-registerthreads), mas adiciona um parâmetro para a prioridade de thread base.</span><span class="sxs-lookup"><span data-stu-id="949a4-225">This method is equivalent to [**IMFRealTimeClient::RegisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-registerthreads), but it adds a parameter for the base thread priority.</span></span> |
| [<span data-ttu-id="949a4-226">**SetWorkQueueEx**</span><span class="sxs-lookup"><span data-stu-id="949a4-226">**SetWorkQueueEx**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-setworkqueueex)       | <span data-ttu-id="949a4-227">Notifica o componente para usar uma fila de trabalho específica.</span><span class="sxs-lookup"><span data-stu-id="949a4-227">Notifies the component to use a specific work queue.</span></span> <span data-ttu-id="949a4-228">Esse método é equivalente a [**IMFReadTimeClient:: SetWorkQueue**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-setworkqueue), mas adiciona um parâmetro para a prioridade de item de trabalho.</span><span class="sxs-lookup"><span data-stu-id="949a4-228">This method is equivalent to [**IMFReadTimeClient::SetWorkQueue**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-setworkqueue), but it adds a parameter for the work item priority.</span></span>               |
| [<span data-ttu-id="949a4-229">**UnregisterThreads**</span><span class="sxs-lookup"><span data-stu-id="949a4-229">**UnregisterThreads**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclientex-unregisterthreads) | <span data-ttu-id="949a4-230">Notifica o componente para cancelar o registro de seus threads do MMCSS.</span><span class="sxs-lookup"><span data-stu-id="949a4-230">Notifies the component to unregister its threads from MMCSS.</span></span> <span data-ttu-id="949a4-231">Esse método é idêntico ao método [**IMFRealTimeClient:: UnregisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-unregisterthreads) .</span><span class="sxs-lookup"><span data-stu-id="949a4-231">This method is identical to the [**IMFRealTimeClient::UnregisterThreads**](/windows/desktop/api/mfidl/nf-mfidl-imfrealtimeclient-unregisterthreads) method.</span></span>                                       |



 

<span data-ttu-id="949a4-232">Os componentes de pipeline devem usar filas de trabalho e não devem criar threads de trabalho, pelos seguintes motivos:</span><span class="sxs-lookup"><span data-stu-id="949a4-232">Pipeline components should use work queues, and should not create worker threads, for the following reasons:</span></span>

-   <span data-ttu-id="949a4-233">As filas de trabalho são melhor dimensionadas, pois usam os pools de threads do sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="949a4-233">Work queues scale better, because they use the OS thread pools.</span></span>
-   <span data-ttu-id="949a4-234">A plataforma manipula os detalhes do registro de filas de trabalho com o MMCSS.</span><span class="sxs-lookup"><span data-stu-id="949a4-234">The platform handles the details of registering work queues with MMCSS.</span></span>
-   <span data-ttu-id="949a4-235">Um thread de trabalho pode facilmente causar um deadlock que é difícil de depurar.</span><span class="sxs-lookup"><span data-stu-id="949a4-235">A worker thread can easily cause a deadlock that is hard to debug.</span></span>

<span data-ttu-id="949a4-236">Além disso, considere o uso da fila de trabalho do serializador se você precisar serializar suas operações assíncronas.</span><span class="sxs-lookup"><span data-stu-id="949a4-236">Also, consider using the serializer work queue if you need to serialize your asynchronous operations.</span></span>

### <a name="topology-branches"></a><span data-ttu-id="949a4-237">Branches de topologia</span><span class="sxs-lookup"><span data-stu-id="949a4-237">Topology Branches</span></span>

<span data-ttu-id="949a4-238">Se o atributo da [ \_ \_ \_ \_ classe MF TOPONODE Queue MMCSS](mf-toponode-workqueue-mmcss-class-attribute.md) registrar uma ramificação de topologia com o MMCSS, no Windows 8, a sessão de mídia USARá as filas de trabalho MT compartilhadas.</span><span class="sxs-lookup"><span data-stu-id="949a4-238">If the [MF\_TOPONODE\_WORKQUEUE\_MMCSS\_CLASS](mf-toponode-workqueue-mmcss-class-attribute.md) attribute registers a topology branch with MMCSS, in Windows 8 the Media Session uses the shared MT work queues.</span></span> <span data-ttu-id="949a4-239">Em versões anteriores do Windows, a sessão de mídia alocou uma nova fila de trabalho.</span><span class="sxs-lookup"><span data-stu-id="949a4-239">In earlier versions of Windows, the Media Session allocated a new work queue.</span></span>

<span data-ttu-id="949a4-240">Dois novos atributos são definidos para registrar uma ramificação de topologia com o MMCSS.</span><span class="sxs-lookup"><span data-stu-id="949a4-240">Two new attributes are defined for registering a topology branch with MMCSS.</span></span>



| <span data-ttu-id="949a4-241">Atributo</span><span class="sxs-lookup"><span data-stu-id="949a4-241">Attribute</span></span>                                                                            | <span data-ttu-id="949a4-242">Descrição</span><span class="sxs-lookup"><span data-stu-id="949a4-242">Description</span></span>                         |
|--------------------------------------------------------------------------------------|-------------------------------------|
| [<span data-ttu-id="949a4-243">prioridade do TOPONODE de fila do MF do \_ \_ \_ MMCSS \_</span><span class="sxs-lookup"><span data-stu-id="949a4-243">MF\_TOPONODE\_WORKQUEUE\_MMCSS\_PRIORITY</span></span>](mf-toponode-workqueue-mmcss-priority.md) | <span data-ttu-id="949a4-244">Especifica a prioridade de thread base.</span><span class="sxs-lookup"><span data-stu-id="949a4-244">Specifies the base thread priority.</span></span> |
| [<span data-ttu-id="949a4-245">\_prioridade de \_ item de fila de TOPONODE MF \_ \_</span><span class="sxs-lookup"><span data-stu-id="949a4-245">MF\_TOPONODE\_WORKQUEUE\_ITEM\_PRIORITY</span></span>](mf-toponode-workqueue-item-priority.md)   | <span data-ttu-id="949a4-246">Especifica a prioridade do item de trabalho.</span><span class="sxs-lookup"><span data-stu-id="949a4-246">Specifies the work item priority.</span></span>   |



 

## <a name="recommendations"></a><span data-ttu-id="949a4-247">Recomendações</span><span class="sxs-lookup"><span data-stu-id="949a4-247">Recommendations</span></span>

-   <span data-ttu-id="949a4-248">Os aplicativos que usam a sessão de mídia devem definir a [ \_ classe MF TOPONODE \_ fila \_ \_ ](mf-toponode-workqueue-mmcss-class-attribute.md) de execução do MMCSS como "áudio" para a ramificação de renderização de áudio e "reprodução" para a ramificação de renderização de vídeo.</span><span class="sxs-lookup"><span data-stu-id="949a4-248">Applications that use the Media Session should set [MF\_TOPONODE\_WORKQUEUE\_MMCSS\_CLASS](mf-toponode-workqueue-mmcss-class-attribute.md) to "Audio" for the audio rendering branch and "Playback" for the video rendering branch.</span></span>
-   <span data-ttu-id="949a4-249">Os aplicativos que usam a sessão de mídia devem chamar [**IMFWorkQueueServices:: BeginRegisterTopologyWorkQueuesWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) na topologia.</span><span class="sxs-lookup"><span data-stu-id="949a4-249">Applications that use the Media Session should call [**IMFWorkQueueServices::BeginRegisterTopologyWorkQueuesWithMMCSS**](/windows/desktop/api/mfidl/nf-mfidl-imfworkqueueservices-beginregistertopologyworkqueueswithmmcss) on the topology.</span></span>
-   <span data-ttu-id="949a4-250">Para componentes de pipeline, as filas de trabalho são recomendadas em vez de threads de trabalho.</span><span class="sxs-lookup"><span data-stu-id="949a4-250">For pipeline components, work queues are recommended instead of worker threads.</span></span> <span data-ttu-id="949a4-251">Se o componente usar filas de trabalho ou threads de trabalho, implemente [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex).</span><span class="sxs-lookup"><span data-stu-id="949a4-251">If the component uses either work queues or worker threads, implement [**IMFRealTimeClientEx**](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex).</span></span>
-   <span data-ttu-id="949a4-252">Não crie filas de trabalho particulares, pois isso anula a finalidade das filas de trabalho da plataforma.</span><span class="sxs-lookup"><span data-stu-id="949a4-252">Do not create private work queues, as this defeats the purpose of the platform work queues.</span></span> <span data-ttu-id="949a4-253">Use a fila multi-threaded da plataforma ou uma fila serial que encapsula a fila multi-threaded da plataforma.</span><span class="sxs-lookup"><span data-stu-id="949a4-253">Use either the platform multithreaded queue or a serial queue that wraps the platform multithreaded queue.</span></span>
-   <span data-ttu-id="949a4-254">Se você precisar serializar operações assíncronas, use uma fila serial.</span><span class="sxs-lookup"><span data-stu-id="949a4-254">If you need to serialize asynchronous operations, use a serial queue.</span></span>

## <a name="summary"></a><span data-ttu-id="949a4-255">Resumo</span><span class="sxs-lookup"><span data-stu-id="949a4-255">Summary</span></span>

<span data-ttu-id="949a4-256">As seguintes Media Foundation APIs de plataforma relacionadas a threads e filas de trabalho são novas para o Windows 8.</span><span class="sxs-lookup"><span data-stu-id="949a4-256">The following Media Foundation platform APIs that relate to threads and work queues are new for Windows 8.</span></span>

-   [<span data-ttu-id="949a4-257">\_prioridade de \_ item de fila de TOPONODE MF \_ \_</span><span class="sxs-lookup"><span data-stu-id="949a4-257">MF\_TOPONODE\_WORKQUEUE\_ITEM\_PRIORITY</span></span>](mf-toponode-workqueue-item-priority.md)
-   [<span data-ttu-id="949a4-258">prioridade do TOPONODE de fila do MF do \_ \_ \_ MMCSS \_</span><span class="sxs-lookup"><span data-stu-id="949a4-258">MF\_TOPONODE\_WORKQUEUE\_MMCSS\_PRIORITY</span></span>](mf-toponode-workqueue-mmcss-priority.md)
-   [<span data-ttu-id="949a4-259">**MFAllocateSerialWorkQueue**</span><span class="sxs-lookup"><span data-stu-id="949a4-259">**MFAllocateSerialWorkQueue**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfallocateserialworkqueue)
-   [<span data-ttu-id="949a4-260">**MFBeginRegisterWorkQueueWithMMCSSEx**</span><span class="sxs-lookup"><span data-stu-id="949a4-260">**MFBeginRegisterWorkQueueWithMMCSSEx**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfbeginregisterworkqueuewithmmcssex)
-   [<span data-ttu-id="949a4-261">**MFGetWorkQueueMMCSSPriority**</span><span class="sxs-lookup"><span data-stu-id="949a4-261">**MFGetWorkQueueMMCSSPriority**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfgetworkqueuemmcsspriority)
-   [<span data-ttu-id="949a4-262">**MFPutWaitingWorkItem**</span><span class="sxs-lookup"><span data-stu-id="949a4-262">**MFPutWaitingWorkItem**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfputwaitingworkitem)
-   [<span data-ttu-id="949a4-263">**MFPutWorkItem2**</span><span class="sxs-lookup"><span data-stu-id="949a4-263">**MFPutWorkItem2**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitem2)
-   [<span data-ttu-id="949a4-264">**MFPutWorkItemEx2**</span><span class="sxs-lookup"><span data-stu-id="949a4-264">**MFPutWorkItemEx2**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfputworkitemex2)
-   [<span data-ttu-id="949a4-265">**MFRegisterPlatformWithMMCSS**</span><span class="sxs-lookup"><span data-stu-id="949a4-265">**MFRegisterPlatformWithMMCSS**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfregisterplatformwithmmcss)
-   [<span data-ttu-id="949a4-266">**MFUnregisterPlatformFromMMCSS**</span><span class="sxs-lookup"><span data-stu-id="949a4-266">**MFUnregisterPlatformFromMMCSS**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mfunregisterplatformfrommmcss)
-   [<span data-ttu-id="949a4-267">**MFLockSharedWorkQueue**</span><span class="sxs-lookup"><span data-stu-id="949a4-267">**MFLockSharedWorkQueue**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mflocksharedworkqueue)
-   [<span data-ttu-id="949a4-268">**IMFRealTimeClientEx**</span><span class="sxs-lookup"><span data-stu-id="949a4-268">**IMFRealTimeClientEx**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfrealtimeclientex)

## <a name="related-topics"></a><span data-ttu-id="949a4-269">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="949a4-269">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="949a4-270">Filas de trabalho</span><span class="sxs-lookup"><span data-stu-id="949a4-270">Work Queues</span></span>](work-queues.md)
</dt> </dl>

 

 
