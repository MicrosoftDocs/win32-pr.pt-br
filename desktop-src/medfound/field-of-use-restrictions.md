---
description: Campo de restrições de uso
ms.assetid: 36f28e4c-2baf-4618-9935-5d4615f6bc77
title: Campo de restrições de uso
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b16f57de7642fa789a08c886a32bf906faffb72b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104296143"
---
# <a name="field-of-use-restrictions"></a><span data-ttu-id="a34a4-103">Campo de restrições de uso</span><span class="sxs-lookup"><span data-stu-id="a34a4-103">Field of Use Restrictions</span></span>

> [!Note]  
> <span data-ttu-id="a34a4-104">Este tópico aplica-se ao Windows 7 ou posterior.</span><span class="sxs-lookup"><span data-stu-id="a34a4-104">This topic applies to Windows 7 or later.</span></span>

 

<span data-ttu-id="a34a4-105">Uma restrição *de campo de uso* é um provisionamento que limita como uma licença para uma tecnologia específica pode ser usada.</span><span class="sxs-lookup"><span data-stu-id="a34a4-105">A *field-of-use* restriction is a provision that limits how a license for a particular technology can be used.</span></span>

<span data-ttu-id="a34a4-106">Media Foundation fornece um mecanismo para impor restrições de campo de uso em transformações de Media Foundation (MFTs), especialmente em codecs.</span><span class="sxs-lookup"><span data-stu-id="a34a4-106">Media Foundation provides a mechanism for enforcing field-of-use restrictions on Media Foundation transforms (MFTs), particularly codecs.</span></span> <span data-ttu-id="a34a4-107">Esse mecanismo exige que o MFT bloqueie seu próprio uso por aplicativos até que o aplicativo tenha executado um handshake com o MFT.</span><span class="sxs-lookup"><span data-stu-id="a34a4-107">This mechanism requires the MFT to block its own use by applications until the application has performed a handshake with the MFT.</span></span> <span data-ttu-id="a34a4-108">Media Foundation não define o handshake — normalmente, ele envolveria algum tipo de troca de criptografia.</span><span class="sxs-lookup"><span data-stu-id="a34a4-108">Media Foundation does not define the handshake—typically, it would involve some sort of cryptographic exchange.</span></span>

### <a name="registration-and-enumeration"></a><span data-ttu-id="a34a4-109">Registro e enumeração</span><span class="sxs-lookup"><span data-stu-id="a34a4-109">Registration and Enumeration</span></span>

<span data-ttu-id="a34a4-110">Se uma MFT tiver restrições de campo de uso, defina o sinalizador **\_ FIELDOFUSE do \_ sinalizador \_ de enumeração de MFT** ao registrar o MFT.</span><span class="sxs-lookup"><span data-stu-id="a34a4-110">If an MFT has field-of-use restrictions, set the **MFT\_ENUM\_FLAG\_FIELDOFUSE** flag when you register the MFT.</span></span> <span data-ttu-id="a34a4-111">Esse sinalizador se aplica às seguintes APIs de registro de MFT:</span><span class="sxs-lookup"><span data-stu-id="a34a4-111">This flag applies to the following MFT registration APIs:</span></span>

-   [<span data-ttu-id="a34a4-112">**MFTRegister**</span><span class="sxs-lookup"><span data-stu-id="a34a4-112">**MFTRegister**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mftregister)
-   [<span data-ttu-id="a34a4-113">**MFTRegisterLocal**</span><span class="sxs-lookup"><span data-stu-id="a34a4-113">**MFTRegisterLocal**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mftregisterlocal)
-   [<span data-ttu-id="a34a4-114">**MFTRegisterLocalByCLSID**</span><span class="sxs-lookup"><span data-stu-id="a34a4-114">**MFTRegisterLocalByCLSID**</span></span>](/windows/desktop/api/mfapi/nf-mfapi-mftregisterlocalbyclsid)
-   [<span data-ttu-id="a34a4-115">**IMFLocalMFTRegistration::RegisterMFTs**</span><span class="sxs-lookup"><span data-stu-id="a34a4-115">**IMFLocalMFTRegistration::RegisterMFTs**</span></span>](/windows/desktop/api/mfidl/nf-mfidl-imflocalmftregistration-registermfts)

<span data-ttu-id="a34a4-116">Por padrão, o MFTs registrado com esse sinalizador é excluído dos resultados da enumeração.</span><span class="sxs-lookup"><span data-stu-id="a34a4-116">By default, MFTs registered with this flag are excluded from enumeration results.</span></span> <span data-ttu-id="a34a4-117">Para enumerar MFTs com restrições de campo de uso, chame [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex) e especifique o **sinalizador \_ \_ \_ FIELDOFUSE do sinalizador de enumeração de MFT** no parâmetro *flags* .</span><span class="sxs-lookup"><span data-stu-id="a34a4-117">To enumerate MFTs with field-of-use restrictions, call [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex) and specify the **MFT\_ENUM\_FLAG\_FIELDOFUSE** flag in the *Flags* parameter.</span></span> <span data-ttu-id="a34a4-118">O diagrama a seguir ilustra esse processo.</span><span class="sxs-lookup"><span data-stu-id="a34a4-118">The following diagram illustrates this process.</span></span>

![diagrama mostrando MFT e um aplicativo enviando dados para o registro](images/mft-fou01.gif)

<span data-ttu-id="a34a4-120">A função [**MFTEnum**](/windows/desktop/api/mfapi/nf-mfapi-mftenum) sempre exclui qualquer MFTs que tenha restrições de campo de uso.</span><span class="sxs-lookup"><span data-stu-id="a34a4-120">The [**MFTEnum**](/windows/desktop/api/mfapi/nf-mfapi-mftenum) function always excludes any MFTs that have field-of-use restrictions.</span></span>

### <a name="unlocking-the-mft"></a><span data-ttu-id="a34a4-121">Desbloqueando o MFT</span><span class="sxs-lookup"><span data-stu-id="a34a4-121">Unlocking the MFT</span></span>

<span data-ttu-id="a34a4-122">Para usar uma MFT com restrições de campo de uso, execute as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="a34a4-122">To use an MFT with field-of-use restrictions, perform the following steps:</span></span>

1.  <span data-ttu-id="a34a4-123">O aplicativo implementa a interface [**IMFFieldOfUseMFTUnlock**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) .</span><span class="sxs-lookup"><span data-stu-id="a34a4-123">The application implements the [**IMFFieldOfUseMFTUnlock**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) interface.</span></span>
2.  <span data-ttu-id="a34a4-124">O método [**IMFFieldOfUseMFTUnlock:: Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) usa um ponteiro para a interface **IUnknown** do MFT.</span><span class="sxs-lookup"><span data-stu-id="a34a4-124">The [**IMFFieldOfUseMFTUnlock::Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) method takes a pointer to the **IUnknown** interface of the MFT.</span></span>
3.  <span data-ttu-id="a34a4-125">No método [**Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) , o aplicativo executa o handshake necessário, usando qualquer mecanismo definido pela MFT.</span><span class="sxs-lookup"><span data-stu-id="a34a4-125">In the [**Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) method, the application performs the required handshake, using whatever mechanism is defined by the MFT.</span></span> <span data-ttu-id="a34a4-126">Esta etapa não é definida pela API Media Foundation.</span><span class="sxs-lookup"><span data-stu-id="a34a4-126">This step is not defined by Media Foundation API.</span></span>
4.  <span data-ttu-id="a34a4-127">Se o método [**Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) for executado com sucesso, o MFT se desbloqueará.</span><span class="sxs-lookup"><span data-stu-id="a34a4-127">If the [**Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) method succeeds, the MFT unlocks itself.</span></span>

<span data-ttu-id="a34a4-128">O aplicativo especifica o ponteiro [**IMFFieldOfUseMFTUnlock**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) definindo o atributo [de \_ \_ \_ atributo de desbloqueio de MFT FIELDOFUSE](mft-fieldofuse-unlock-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="a34a4-128">The application specifies the [**IMFFieldOfUseMFTUnlock**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) pointer by setting the [MFT\_FIELDOFUSE\_UNLOCK\_Attribute](mft-fieldofuse-unlock-attribute.md) attribute.</span></span> <span data-ttu-id="a34a4-129">Há várias maneiras diferentes de definir esse atributo, dependendo de como seu aplicativo cria o decodificador ou o pipeline de codificação:</span><span class="sxs-lookup"><span data-stu-id="a34a4-129">There are several different ways to set this attribute, depending on how your application creates the decoder or encoding pipeline:</span></span>



| <span data-ttu-id="a34a4-130">API</span><span class="sxs-lookup"><span data-stu-id="a34a4-130">API</span></span>                   | <span data-ttu-id="a34a4-131">Como desbloquear o campo de uso</span><span class="sxs-lookup"><span data-stu-id="a34a4-131">How to Unlock Field-Of-Use</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|-----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a34a4-132">Leitor de origem</span><span class="sxs-lookup"><span data-stu-id="a34a4-132">Source Reader</span></span>         | <span data-ttu-id="a34a4-133">Se seu aplicativo usar o [leitor de origem](source-reader.md) para decodificar um arquivo de mídia, defina o atributo [ \_ \_ \_ atributo de desbloqueio de MFT FIELDOFUSE](mft-fieldofuse-unlock-attribute.md) nos parâmetros de configuração.</span><span class="sxs-lookup"><span data-stu-id="a34a4-133">If your application uses the [Source Reader](source-reader.md) to decode a media file, set the [MFT\_FIELDOFUSE\_UNLOCK\_Attribute](mft-fieldofuse-unlock-attribute.md) attribute in the configuration parameters.</span></span> <span data-ttu-id="a34a4-134">Consulte [atributos do leitor de origem](source-reader-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="a34a4-134">See [Source Reader Attributes](source-reader-attributes.md).</span></span>                                                                                                                                                                                                                                                                         |
| <span data-ttu-id="a34a4-135">Gravador do coletor</span><span class="sxs-lookup"><span data-stu-id="a34a4-135">Sink Writer</span></span>           | <span data-ttu-id="a34a4-136">Se seu aplicativo usar o gravador de coletor para codificar um arquivo de mídia, defina o atributo [ \_ \_ \_ atributo de desbloqueio de MFT FIELDOFUSE](mft-fieldofuse-unlock-attribute.md) nos parâmetros de configuração.</span><span class="sxs-lookup"><span data-stu-id="a34a4-136">If your application uses the sink writer to encode a media file, set the [MFT\_FIELDOFUSE\_UNLOCK\_Attribute](mft-fieldofuse-unlock-attribute.md) attribute in the configuration parameters.</span></span> <span data-ttu-id="a34a4-137">Consulte [atributos do gravador do coletor](sink-writer-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="a34a4-137">See [Sink Writer Attributes](sink-writer-attributes.md).</span></span>                                                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="a34a4-138">Transcodificação rápida</span><span class="sxs-lookup"><span data-stu-id="a34a4-138">Fast Transcode</span></span>        | <span data-ttu-id="a34a4-139">Se seu aplicativo usar o recurso de transcodificação rápida para criar uma topologia de codificação, defina o [ \_ \_ \_ atributo de desbloqueio de MFT FIELDOFUSE](mft-fieldofuse-unlock-attribute.md) ao chamar [**IMFTranscodeProfile:: setcontainerattributes**](/windows/desktop/api/mfidl/nf-mfidl-imftranscodeprofile-setcontainerattributes).</span><span class="sxs-lookup"><span data-stu-id="a34a4-139">If your application uses the Fast Transcode feature to create an encoding topology, set the [MFT\_FIELDOFUSE\_UNLOCK\_Attribute](mft-fieldofuse-unlock-attribute.md) when you call [**IMFTranscodeProfile::SetContainerAttributes**](/windows/desktop/api/mfidl/nf-mfidl-imftranscodeprofile-setcontainerattributes).</span></span> <span data-ttu-id="a34a4-140">Para obter mais informações sobre o recurso de transcodificação rápida, consulte [API de transcodificação](transcode-api.md).</span><span class="sxs-lookup"><span data-stu-id="a34a4-140">For more information about the Fast Transcode feature, see [Transcode API](transcode-api.md).</span></span>                                                                                                                                                                      |
| <span data-ttu-id="a34a4-141">Topologia</span><span class="sxs-lookup"><span data-stu-id="a34a4-141">Topology</span></span>              | <span data-ttu-id="a34a4-142">Se você criar uma topologia diretamente, defina o [ \_ atributo FIELDOFUSE \_ de \_ desbloqueio de MFT](mft-fieldofuse-unlock-attribute.md) como um atributo na topologia.</span><span class="sxs-lookup"><span data-stu-id="a34a4-142">If you create a topology directly, set the [MFT\_FIELDOFUSE\_UNLOCK\_Attribute](mft-fieldofuse-unlock-attribute.md) as an attribute on the topology.</span></span> <span data-ttu-id="a34a4-143">Consulte [atributos de topologia](topology-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="a34a4-143">See [Topology Attributes](topology-attributes.md).</span></span>                                                                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="a34a4-144">Objeto de ativação de MFT</span><span class="sxs-lookup"><span data-stu-id="a34a4-144">MFT Activation Object</span></span> | <span data-ttu-id="a34a4-145">Se seu aplicativo enumerar diretamente os decodificadores ou codificadores que ele usará, defina o [ \_ atributo FIELDOFUSE de \_ desbloqueio \_ de MFT](mft-fieldofuse-unlock-attribute.md) nos ponteiros [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) retornados pela função [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex) .</span><span class="sxs-lookup"><span data-stu-id="a34a4-145">If your application directly enumerates the decoders or encoders that it will use, set the [MFT\_FIELDOFUSE\_UNLOCK\_Attribute](mft-fieldofuse-unlock-attribute.md) on the [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) pointers returned by the [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex) function.</span></span> <br/> <span data-ttu-id="a34a4-146">Defina o atributo antes de chamar [**IMFActivate:: activateobject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) para criar o MFT.</span><span class="sxs-lookup"><span data-stu-id="a34a4-146">Set the attribute before calling [**IMFActivate::ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) to create the MFT.</span></span> <span data-ttu-id="a34a4-147">O objeto de ativação chama [**IMFFieldOfUseMFTUnlock:: Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) quando cria o MFT.</span><span class="sxs-lookup"><span data-stu-id="a34a4-147">The activation object calls [**IMFFieldOfUseMFTUnlock::Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) when it creates the MFT.</span></span><br/> |



 

<span data-ttu-id="a34a4-148">O diagrama a seguir mostra a relação entre os objetos de ativação de MFT e a interface [**IMFFieldOfUseMFTUnlock**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) .</span><span class="sxs-lookup"><span data-stu-id="a34a4-148">The following diagram shows the relation between MFT activation objects and the [**IMFFieldOfUseMFTUnlock**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) interface.</span></span>

![diagrama mostrando um aplicativo, um objeto de ativação e uma MFT com setas para um objeto fou, que tem uma seta de volta para o MFT](images/mft-fou02.gif)

## <a name="related-topics"></a><span data-ttu-id="a34a4-150">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="a34a4-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a34a4-151">Transformações de Media Foundation</span><span class="sxs-lookup"><span data-stu-id="a34a4-151">Media Foundation Transforms</span></span>](media-foundation-transforms.md)
</dt> </dl>

 

 




