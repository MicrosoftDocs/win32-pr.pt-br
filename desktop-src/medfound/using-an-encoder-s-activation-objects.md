---
description: Para converter arquivos de mídia em formato ASF, você pode usar codificadores de mídia do Windows. Para usar esses codificadores, eles devem ser registrados com o sistema.
ms.assetid: 18c26619-6047-4f7f-bb65-ca418f02e5b1
title: Usando um objeto de ativação de codificadores
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bfd44a1b97ad0f133b7215ff4474835ddfba66bb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103827797"
---
# <a name="using-an-encoders-activation-objects"></a><span data-ttu-id="0c246-104">Usando objetos de ativação de um codificador</span><span class="sxs-lookup"><span data-stu-id="0c246-104">Using an Encoder's Activation Objects</span></span>

<span data-ttu-id="0c246-105">Para converter arquivos de mídia em formato ASF, você pode usar codificadores de mídia do Windows.</span><span class="sxs-lookup"><span data-stu-id="0c246-105">For converting media files into ASF format, you can use Windows Media encoders.</span></span> <span data-ttu-id="0c246-106">Para usar esses codificadores, eles devem ser registrados com o sistema.</span><span class="sxs-lookup"><span data-stu-id="0c246-106">To use these encoders, they must be registered with the system.</span></span>

<span data-ttu-id="0c246-107">Para obter informações sobre o registro do codificador, consulte [instanciando um MFT do codificador](instantiating-the-encoder-mft.md).</span><span class="sxs-lookup"><span data-stu-id="0c246-107">For information about encoder registration, see [Instantiating an Encoder MFT](instantiating-the-encoder-mft.md).</span></span>

-   [<span data-ttu-id="0c246-108">Usando objetos de ativação de um codificador</span><span class="sxs-lookup"><span data-stu-id="0c246-108">Using an Encoder's Activation Objects</span></span>](#using-an-encoders-activation-objects)
-   [<span data-ttu-id="0c246-109">Enumeração de codificador no Windows 7 e posterior</span><span class="sxs-lookup"><span data-stu-id="0c246-109">Encoder Enumeration in Windows 7 and Later</span></span>](#encoder-enumeration-in-windows-7-and-later)
-   [<span data-ttu-id="0c246-110">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="0c246-110">Related topics</span></span>](#related-topics)

## <a name="using-an-encoders-activation-objects"></a><span data-ttu-id="0c246-111">Usando objetos de ativação de um codificador</span><span class="sxs-lookup"><span data-stu-id="0c246-111">Using an Encoder's Activation Objects</span></span>

<span data-ttu-id="0c246-112">Como alternativa ao uso da interface [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) de um codificador (descrita na [criação de um codificador usando CoCreateInstance](using-an-encoder-s-imftransform--interface.md)), você pode criar uma instância do objeto de ativação para o codificador.</span><span class="sxs-lookup"><span data-stu-id="0c246-112">As an alternative to using an encoder's [**IMFTransform**](/windows/desktop/api/mftransform/nn-mftransform-imftransform) interface (described in [Creating an Encoder by Using CoCreateInstance](using-an-encoder-s-imftransform--interface.md)), you can create an instance of the activation object for the encoder.</span></span> <span data-ttu-id="0c246-113">Os objetos de ativação facilitam a criação do codificador e o Media Foundation fornece as duas funções a seguir para essa abordagem:</span><span class="sxs-lookup"><span data-stu-id="0c246-113">Activation objects facilitates encoder creation and Media Foundation provides the following two functions for this approach:</span></span>

-   <span data-ttu-id="0c246-114">[**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) para instanciar o codificador de áudio do Windows Media.</span><span class="sxs-lookup"><span data-stu-id="0c246-114">[**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) for instantiating the Windows Media audio encoder.</span></span>
-   <span data-ttu-id="0c246-115">[**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate) para instanciar o codificador de vídeo do Windows Media.</span><span class="sxs-lookup"><span data-stu-id="0c246-115">[**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate) for instantiating the Windows Media video encoder.</span></span>

<span data-ttu-id="0c246-116">Ambas as funções exigem que você crie o tipo de mídia de destino e defina as propriedades de codificação antes de chamar essas funções.</span><span class="sxs-lookup"><span data-stu-id="0c246-116">Both these functions require that you create the target media type and set the encoding properties before calling these functions.</span></span> <span data-ttu-id="0c246-117">Se seu aplicativo estiver usando [componentes ASF da camada de pipeline](pipeline-layer-asf-components.md) para codificar um arquivo para o formato ASF e já tiver criado e configurado os [coletores de mídia ASF](asf-media-sinks.md), você poderá obter esse conjunto de informações do coletor de mídia ASF.</span><span class="sxs-lookup"><span data-stu-id="0c246-117">If your application is using [Pipeline Layer ASF Components](pipeline-layer-asf-components.md) to encode a file to ASF format, and have already created and configured the [ASF Media Sinks](asf-media-sinks.md), you can get this set of information from the ASF media sink.</span></span>

<span data-ttu-id="0c246-118">[**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) e [**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate) definem o tipo de saída do codificador para o tipo de mídia especificado pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0c246-118">[**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) and [**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate) set the output type of the encoder to the media type specified by the application.</span></span>

<span data-ttu-id="0c246-119">**Observação**  Se você estiver usando [**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) e [**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate) , poderá ativar o codificador chamando [**IMFActivate:: activateobject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) , mas não poderá alterar a entrada e os tipos de mídia de saída do codificador, nem pode alterar as propriedades de codificação.</span><span class="sxs-lookup"><span data-stu-id="0c246-119">**Note**  If you are using [**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) and [**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate) you can activate the encoder by calling [**IMFActivate::ActivateObject**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) but you cannot change the input and the output media types of the encoder nor can you change any of the encoding properties.</span></span>

<span data-ttu-id="0c246-120">Para obter mais informações sobre como criar objetos de Media Foundation usando objetos de ativação, consulte [objetos de ativação](activation-objects.md).</span><span class="sxs-lookup"><span data-stu-id="0c246-120">For more information about creating Media Foundation objects by using activation objects, see [Activation Objects](activation-objects.md).</span></span>

<span data-ttu-id="0c246-121">**Para obter o tipo de mídia de destino do coletor de mídia do ASF**</span><span class="sxs-lookup"><span data-stu-id="0c246-121">**To get the target media type from the ASF media sink**</span></span>

1.  <span data-ttu-id="0c246-122">Obtenha um ponteiro para o ponteiro [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) do coletor de mídia do ASF chamando **IMFMediaSink:: QueryInterface** no coletor de mídia ASF e passando **\_ IMFASFContentInfo de IID** como o identificador de interface.</span><span class="sxs-lookup"><span data-stu-id="0c246-122">Get a pointer to the [**IMFASFContentInfo**](/windows/desktop/api/wmcontainer/nn-wmcontainer-imfasfcontentinfo) pointer of the ASF media sink by calling **IMFMediaSink::QueryInterface** on the ASF media sink and passing **IID\_IMFASFContentInfo** as the interface identifier.</span></span>
2.  <span data-ttu-id="0c246-123">Obtenha o objeto de perfil ASF associado ao objeto ContentInfo.</span><span class="sxs-lookup"><span data-stu-id="0c246-123">Get the ASF profile object associated with the ContentInfo object.</span></span>
3.  <span data-ttu-id="0c246-124">Enumere os fluxos no perfil para obter o tipo de mídia do fluxo.</span><span class="sxs-lookup"><span data-stu-id="0c246-124">Enumerate the streams in the profile to get the stream's media type.</span></span>

<span data-ttu-id="0c246-125">**Para obter as propriedades de codificação do coletor de mídia ASF**</span><span class="sxs-lookup"><span data-stu-id="0c246-125">**To get the encoding properties from the ASF media sink**</span></span>

1.  <span data-ttu-id="0c246-126">Se você tiver configurado as [Propriedades de codificação](configuring-the-encoder.md) no coletor de mídia (descrito [em Propriedades de configuração no coletor de arquivos](setting-properties-in-the-file-sink.md)), poderá uma referência ao repositório de propriedades do coletor chamando **IMFMediaSink:: QUERYINTERFACE** no coletor de mídia ASF e passando **\_ IPropertyStore de IID** como o identificador de interface.</span><span class="sxs-lookup"><span data-stu-id="0c246-126">If you have configured the [Encoding Properties](configuring-the-encoder.md) in the media sink (described in [Setting Properties in the File Sink](setting-properties-in-the-file-sink.md)), you can a reference to the sink's property store by calling **IMFMediaSink::QueryInterface** on the ASF media sink and passing **IID\_IPropertyStore** as the interface identifier.</span></span>
2.  <span data-ttu-id="0c246-127">Se você tiver um ponteiro para o objeto ContentInfo do coletor, poderá chamar [**IMFASFContentInfo:: GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) para obter uma referência ao repositório de propriedades do coletor de mídia.</span><span class="sxs-lookup"><span data-stu-id="0c246-127">If you have a pointer to the sink's ContentInfo object, you can call [**IMFASFContentInfo::GetEncodingConfigurationPropertyStore**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) to get a reference to the media sink's property store.</span></span>

    <span data-ttu-id="0c246-128">Certifique-se de que todas as propriedades de codificação definidas no coletor de mídia ASF sejam refletidas no repositório de Propriedades passado para [**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) e [**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate).</span><span class="sxs-lookup"><span data-stu-id="0c246-128">Make sure that all of encoding properties that are set on the ASF media sink are reflected in the property store passed to [**MFCreateWMAEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmaencoderactivate) and [**MFCreateWMVEncoderActivate**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreatewmvencoderactivate).</span></span> <span data-ttu-id="0c246-129">O codificador é configurado automaticamente com base nas configurações especificadas pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0c246-129">The encoder is configured automatically based on the settings specified by the application.</span></span>

<span data-ttu-id="0c246-130">Ao criar o nó de transformação na topologia de codificação, você pode definir o tipo de objeto como um ponteiro [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) recebido nessas duas chamadas.</span><span class="sxs-lookup"><span data-stu-id="0c246-130">While creating the transform node in the encoding topology, you can set the object type as an [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) pointer received in these two calls.</span></span> <span data-ttu-id="0c246-131">Quando a topologia é resolvida, a sessão de mídia usa o objeto de ativação para criar uma instância do MFT do codificador.</span><span class="sxs-lookup"><span data-stu-id="0c246-131">When the topology is resolved, the Media Session uses the activation object to create an instance of the encoder MFT.</span></span>

## <a name="encoder-enumeration-in-windows-7-and-later"></a><span data-ttu-id="0c246-132">Enumeração de codificador no Windows 7 e posterior</span><span class="sxs-lookup"><span data-stu-id="0c246-132">Encoder Enumeration in Windows 7 and Later</span></span>

<span data-ttu-id="0c246-133">Para aplicativos em execução no Windows 7, além de [**MFTEnum**](/windows/desktop/api/mfapi/nf-mfapi-mftenum) , você pode enumerar o codificador MFTs chamando [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex).</span><span class="sxs-lookup"><span data-stu-id="0c246-133">For applications that are running on Windows 7, in addition to [**MFTEnum**](/windows/desktop/api/mfapi/nf-mfapi-mftenum) you can enumerate the encoder MFTs by calling [**MFTEnumEx**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex).</span></span> <span data-ttu-id="0c246-134">Essa função retorna um ponteiro para o objeto de ativação do MFT do codificador.</span><span class="sxs-lookup"><span data-stu-id="0c246-134">This function returns a pointer to the activation object of the encoder MFT.</span></span> <span data-ttu-id="0c246-135">A estrutura da função é muito semelhante à **MFTEnum** descrita acima, exceto que **MFTEnumEx** retorna uma matriz de ponteiros [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) para a MFTs do codificador que corresponde aos critérios de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="0c246-135">The structure of the function is very similar to **MFTEnum** described above except **MFTEnumEx** returns an array of [**IMFActivate**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) pointers for the encoder MFTs that match the search criteria.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0c246-136">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="0c246-136">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0c246-137">Criando uma instância de um MFT do codificador</span><span class="sxs-lookup"><span data-stu-id="0c246-137">Instantiating an Encoder MFT</span></span>](instantiating-the-encoder-mft.md)
</dt> <dt>

[<span data-ttu-id="0c246-138">Codificadores de mídia do Windows</span><span class="sxs-lookup"><span data-stu-id="0c246-138">Windows Media Encoders</span></span>](windows-media-encoders.md)
</dt> <dt>

[<span data-ttu-id="0c246-139">Objetos de ativação</span><span class="sxs-lookup"><span data-stu-id="0c246-139">Activation Objects</span></span>](activation-objects.md)
</dt> </dl>

 

 



