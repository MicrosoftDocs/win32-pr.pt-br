---
description: Configurando o objeto divisor de ASF
ms.assetid: 8e2ba659-e1f6-42be-afd6-21fc841dc8d3
title: Configurando o objeto divisor de ASF
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 14f27885e602dd52012808d330d997f9b7a7e983
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104089775"
---
# <a name="configuring-the-asf-splitter-object"></a><span data-ttu-id="5c289-103">Configurando o objeto divisor de ASF</span><span class="sxs-lookup"><span data-stu-id="5c289-103">Configuring the ASF Splitter Object</span></span>

<span data-ttu-id="5c289-104">O objeto *divisor* de ASF é um objeto de camada WMContainer que analisa o objeto de dados ASF de um arquivo ASF (Advanced Systems Format).</span><span class="sxs-lookup"><span data-stu-id="5c289-104">The ASF *splitter* object is a WMContainer layer object that parses the ASF Data Object of an Advanced Systems Format (ASF) file.</span></span> <span data-ttu-id="5c289-105">Depois que o separador é criado e inicializado para analisar o objeto de dados ASF de um arquivo de mídia, o divisor deve ser configurado para gerar amostras para fluxos específicos.</span><span class="sxs-lookup"><span data-stu-id="5c289-105">After the splitter is created and initialized to parse the ASF Data Object of a media file, the splitter must be configured to generate samples for specific streams.</span></span> <span data-ttu-id="5c289-106">Chame [**IMFASFSplitter:: SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams) para selecionar os fluxos necessários.</span><span class="sxs-lookup"><span data-stu-id="5c289-106">Call [**IMFASFSplitter::SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams) to select the required streams.</span></span>

<span data-ttu-id="5c289-107">Opcionalmente, um aplicativo também pode configurá-lo para gerar amostras em ordem inversa ou gerar amostras para conteúdo protegido.</span><span class="sxs-lookup"><span data-stu-id="5c289-107">Optionally, an application can also configure it to generate samples in reverse order or generate samples for protected content.</span></span> <span data-ttu-id="5c289-108">Para definir essas opções, chame [**IMFASFSplitter:: Setsinalizas**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags) e passe a combinação de bits necessária dos sinalizadores com suporte.</span><span class="sxs-lookup"><span data-stu-id="5c289-108">To set these options, call [**IMFASFSplitter::SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags) and pass the required bitwise combination of the supported flags.</span></span> <span data-ttu-id="5c289-109">Antes de chamar esse método, o cliente deve concluir a chamada [**IMFASFSplitter:: Initialize**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-initialize) com êxito; caso contrário, **SetFlags** falhará com o código de erro **MF \_ E \_ não \_ inicializado** .</span><span class="sxs-lookup"><span data-stu-id="5c289-109">Before calling this method, the client must complete the [**IMFASFSplitter::Initialize**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-initialize) call successfully; otherwise, **SetFlags** fails with **MF\_E\_NOT\_INITIALIZED** error code.</span></span> <span data-ttu-id="5c289-110">Para obter informações sobre como inicializar o divisor, consulte [criando o objeto divisor de ASF](creating-the-asf-splitter-object.md).</span><span class="sxs-lookup"><span data-stu-id="5c289-110">For information about initializing the splitter, see [Creating the ASF Splitter Object](creating-the-asf-splitter-object.md).</span></span>

<span data-ttu-id="5c289-111">Para verificar se esse sinalizador está definido atualmente no divisor, chame [**IMFASFSplitter:: GetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-getflags).</span><span class="sxs-lookup"><span data-stu-id="5c289-111">To check whether this flag is currently set on the splitter, call [**IMFASFSplitter::GetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-getflags).</span></span>

## <a name="selecting-streams-for-parsing"></a><span data-ttu-id="5c289-112">Selecionando fluxos para análise</span><span class="sxs-lookup"><span data-stu-id="5c289-112">Selecting Streams for Parsing</span></span>

<span data-ttu-id="5c289-113">Durante o processo de inicialização por meio de chamada [**IMFASFSplitter:: Initialize**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-initialize) , o divisor detecta o número de fluxos e os identificadores de fluxo no arquivo asf.</span><span class="sxs-lookup"><span data-stu-id="5c289-113">During the initialization process through [**IMFASFSplitter::Initialize**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-initialize) call, the splitter detects the number of streams and the stream identifiers in the ASF file.</span></span> <span data-ttu-id="5c289-114">Por padrão, nenhum fluxo é selecionado pelo divisor.</span><span class="sxs-lookup"><span data-stu-id="5c289-114">By default, no streams are selected by the splitter.</span></span> <span data-ttu-id="5c289-115">O aplicativo deve selecionar os fluxos chamando [**IMFASFSplitter:: SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams).</span><span class="sxs-lookup"><span data-stu-id="5c289-115">The application must select the streams by calling [**IMFASFSplitter::SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams).</span></span> <span data-ttu-id="5c289-116">Esse método usa uma matriz de números de fluxo.</span><span class="sxs-lookup"><span data-stu-id="5c289-116">This method takes an array of stream numbers.</span></span> <span data-ttu-id="5c289-117">Para obter o número de fluxo para um fluxo, chame [**IMFASFProfile:: GetStream**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfprofile-getstream) no perfil ASF ou chame [**IMFStreamDescriptor:: GetStreamIdentifier**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamdescriptor-getstreamidentifier) no descritor de fluxo.</span><span class="sxs-lookup"><span data-stu-id="5c289-117">To get the stream number for a stream, call [**IMFASFProfile::GetStream**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfprofile-getstream) on the ASF profile or call [**IMFStreamDescriptor::GetStreamIdentifier**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamdescriptor-getstreamidentifier) on the stream descriptor.</span></span> <span data-ttu-id="5c289-118">(Você pode obter o perfil ASF e o descritor de fluxo do objeto ContentInfo.) Se o cliente passar um número de fluxo que não seja reconhecido pelo divisor, ele falhará com um erro de **MF \_ E \_ INVALIDSTREAMNUMBER** .</span><span class="sxs-lookup"><span data-stu-id="5c289-118">(You can obtain both the ASF profile and the stream descriptor from the ContentInfo object.) If the client passes a stream number that is not recognized by the splitter, it fails with a **MF\_E\_INVALIDSTREAMNUMBER** error.</span></span>

<span data-ttu-id="5c289-119">Chamar [**SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams) apaga as seleções anteriores.</span><span class="sxs-lookup"><span data-stu-id="5c289-119">Calling [**SelectStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-selectstreams) clears the previous selections.</span></span> <span data-ttu-id="5c289-120">Qualquer fluxo não especificado na matriz não é selecionado.</span><span class="sxs-lookup"><span data-stu-id="5c289-120">Any stream that is not specified in the array is not selected.</span></span> <span data-ttu-id="5c289-121">Para obter uma lista de fluxos que estão selecionados atualmente, chame [**IMFASFSplitter:: GetSelectedStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-getselectedstreams).</span><span class="sxs-lookup"><span data-stu-id="5c289-121">To get a list of streams that are currently selected, call [**IMFASFSplitter::GetSelectedStreams**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-getselectedstreams).</span></span> <span data-ttu-id="5c289-122">Esse método usa um ponteiro para uma matriz, que o método preenche com os números de fluxo.</span><span class="sxs-lookup"><span data-stu-id="5c289-122">This method takes a pointer to an array, which the method fills with the stream numbers.</span></span> <span data-ttu-id="5c289-123">Se o tamanho da matriz for menor que o número de fluxos selecionados, o método falhará com o erro de **MF \_ E \_ BUFFERTOOSMALL** .</span><span class="sxs-lookup"><span data-stu-id="5c289-123">If the array size is less than the number of selected streams, the method fails with the **MF\_E\_BUFFERTOOSMALL** error.</span></span> <span data-ttu-id="5c289-124">Nesse caso, o método retorna o número de fluxos selecionados no parâmetro *pwNumStreams* .</span><span class="sxs-lookup"><span data-stu-id="5c289-124">In this case, the method returns the number of selected streams in the *pwNumStreams* parameter.</span></span> <span data-ttu-id="5c289-125">Você pode usar esse número para alocar uma matriz do tamanho correto e chamar o método novamente.</span><span class="sxs-lookup"><span data-stu-id="5c289-125">You can then use this number to allocate an array of the correct size and call the method again.</span></span>

<span data-ttu-id="5c289-126">Para obter um exemplo de código, consulte "selecionar um fluxo para análise" em [tutorial: lendo um arquivo ASF](tutorial--reading-an-asf-file.md).</span><span class="sxs-lookup"><span data-stu-id="5c289-126">For example code, see "Select a Stream for Parsing" in [Tutorial: Reading an ASF File](tutorial--reading-an-asf-file.md).</span></span>

## <a name="reverse-playback-setting"></a><span data-ttu-id="5c289-127">Configuração de reprodução reversa</span><span class="sxs-lookup"><span data-stu-id="5c289-127">Reverse Playback Setting</span></span>

<span data-ttu-id="5c289-128">Durante o processo de inicialização do divisor, ele determina se o conteúdo do ASF dá suporte à reprodução reversa.</span><span class="sxs-lookup"><span data-stu-id="5c289-128">During the initialization process of the splitter, it determines if the ASF content supports reverse playback.</span></span> <span data-ttu-id="5c289-129">Se tiver, o separador poderá ser configurado para gerar amostras em ordem inversa, definindo o **sinalizador \_ \_ inverso do divisor MFASF** .</span><span class="sxs-lookup"><span data-stu-id="5c289-129">If it does, the splitter can be configured to generate samples in reverse order by setting the **MFASF\_SPLITTER\_REVERSE** flag.</span></span> <span data-ttu-id="5c289-130">Se o conteúdo não oferecer suporte à reprodução inversa, os [**sinalizadores IMFASFSplitter::**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags) setretornarão **MF \_ E \_ INVALIDREQUEST**, mas o sinalizador será definido no separador.</span><span class="sxs-lookup"><span data-stu-id="5c289-130">If the content does not support reverse playback, the [**IMFASFSplitter::SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags) returns **MF\_E\_INVALIDREQUEST**, but the flag is set on the splitter.</span></span>

<span data-ttu-id="5c289-131">Se o divisor estiver configurado para analisar na direção inversa, o divisor sempre iniciará a análise no final do buffer que contém o objeto de dados ASF.</span><span class="sxs-lookup"><span data-stu-id="5c289-131">If the splitter is configured to parse in the reverse direction, then the splitter always starts parsing at the end of the buffer that contains the ASF Data Object.</span></span> <span data-ttu-id="5c289-132">Portanto, para a análise reversa do deslocamento de dados e o comprimento dos dados a serem analisados deve ser definido adequadamente.</span><span class="sxs-lookup"><span data-stu-id="5c289-132">Therefore, for reverse parsing the data offset and the length of the data to parse must be set appropriately.</span></span> <span data-ttu-id="5c289-133">Para obter informações sobre como definir os valores corretos, consulte [gerando amostras de fluxo de um objeto de dados ASF existente](generating-stream-samples-from-an-existing-asf-data-object.md).</span><span class="sxs-lookup"><span data-stu-id="5c289-133">For information about setting the correct values, see [Generating Stream Samples from an Existing ASF Data Object](generating-stream-samples-from-an-existing-asf-data-object.md).</span></span>

## <a name="protected-content-setting"></a><span data-ttu-id="5c289-134">Configuração de conteúdo protegido</span><span class="sxs-lookup"><span data-stu-id="5c289-134">Protected Content Setting</span></span>

<span data-ttu-id="5c289-135">O separador pode ser configurado para trabalhar com conteúdo de criptografia no nível de pacote definindo o **MFASF \_ Splitter \_ WMDRM** por meio de [**IMFASFSplitter:: SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags).</span><span class="sxs-lookup"><span data-stu-id="5c289-135">The splitter can be configured to work with packet-level encryption content by setting the **MFASF\_SPLITTER\_WMDRM** through [**IMFASFSplitter::SetFlags**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfsplitter-setflags).</span></span> <span data-ttu-id="5c289-136">Isso instrui o divisor a fornecer exemplos de conteúdo protegido pelo Windows Media Digital Rights Management (DRM).</span><span class="sxs-lookup"><span data-stu-id="5c289-136">This instructs the splitter to deliver samples for content that is protected by Windows Media Digital Rights Management (DRM).</span></span> <span data-ttu-id="5c289-137">Quando esse sinalizador é definido, os exemplos gerados pelo divisor contêm informações necessárias para descriptografar dados de mídia e reconstruir os quadros, como o atributo [**MFSampleExtension \_ PacketCrossOffsets**](mfsampleextension-packetcrossoffsets-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="5c289-137">When this flag is set, the samples generated by the splitter contain information required to decrypt media data and reconstruct the frames, such as the [**MFSampleExtension\_PacketCrossOffsets**](mfsampleextension-packetcrossoffsets-attribute.md) attribute.</span></span> <span data-ttu-id="5c289-138">Esse atributo é um blob que contém uma matriz de **DWORD** s.</span><span class="sxs-lookup"><span data-stu-id="5c289-138">This attribute is a blob that contains an array of **DWORD** s.</span></span> <span data-ttu-id="5c289-139">Cada **DWORD** fornece os limites de carga para o quadro em relação ao início do quadro.</span><span class="sxs-lookup"><span data-stu-id="5c289-139">Each **DWORD** provides you the payload boundaries for the frame relative to the beginning of the frame.</span></span> <span data-ttu-id="5c289-140">Se esse atributo não estiver presente, o quadro estará contido em uma única carga.</span><span class="sxs-lookup"><span data-stu-id="5c289-140">If this attribute is not present, the frame is contained in a single payload.</span></span> <span data-ttu-id="5c289-141">Normalmente, os exemplos gerados pelo divisor contêm vários buffers de mídia, o aplicativo pode copiar todos os buffers em um buffer contíguo chamando [**IMFSample:: ConvertToContiguousBuffer**](/windows/desktop/api/mfobjects/nf-mfobjects-imfsample-converttocontiguousbuffer).</span><span class="sxs-lookup"><span data-stu-id="5c289-141">Typically, the samples generated by the splitter contain multiple media buffers, the application can copy all the buffers into one contiguous buffer by calling [**IMFSample::ConvertToContiguousBuffer**](/windows/desktop/api/mfobjects/nf-mfobjects-imfsample-converttocontiguousbuffer).</span></span> <span data-ttu-id="5c289-142">O buffer resultante contém o quadro e o valor do atributo contém deslocamentos nesse buffer.</span><span class="sxs-lookup"><span data-stu-id="5c289-142">The resulting buffer contains the frame and the attribute value contains offsets into this buffer.</span></span>

## <a name="related-topics"></a><span data-ttu-id="5c289-143">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="5c289-143">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5c289-144">Divisor de ASF</span><span class="sxs-lookup"><span data-stu-id="5c289-144">ASF Splitter</span></span>](asf-splitter.md)
</dt> </dl>

 

 



