---
description: O coletor de arquivos MPEG-4 cria arquivos MP4.
ms.assetid: 069b8e72-d081-466e-ac8d-c3f81c8a6f35
title: Coletor de arquivos MPEG-4
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 6c27517463bca7dfa88fdbc09d77f7a6512c896d
ms.sourcegitcommit: 9c8ddec1e955f181beecad0478c1fb79013b5e9d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/21/2021
ms.locfileid: "105750563"
---
# <a name="mpeg-4-file-sink"></a><span data-ttu-id="6249e-103">Coletor de arquivos MPEG-4</span><span class="sxs-lookup"><span data-stu-id="6249e-103">MPEG-4 File Sink</span></span>

<span data-ttu-id="6249e-104">O coletor de arquivos MPEG-4 cria arquivos MP4.</span><span class="sxs-lookup"><span data-stu-id="6249e-104">The MPEG-4 file sink creates MP4 files.</span></span> <span data-ttu-id="6249e-105">Para obter mais informações sobre o formato de arquivo MP4, consulte os seguintes documentos de padrões:</span><span class="sxs-lookup"><span data-stu-id="6249e-105">For more information about the MP4 file format, refer to the following standards documents:</span></span>

-   <span data-ttu-id="6249e-106">ISO/IEC 14496-12: *tecnologia da informação – codificação de objetos de áudio-visual--parte 12: formato de arquivo de mídia base ISO*</span><span class="sxs-lookup"><span data-stu-id="6249e-106">ISO/IEC 14496-12: *Information technology -- Coding of audio-visual objects -- Part 12: ISO Base Media File Format*</span></span>
-   <span data-ttu-id="6249e-107">ISO/IEC 14496-14: *tecnologia da informação – codificação de objetos de áudio-visual--parte 14: formato de arquivo MP4*</span><span class="sxs-lookup"><span data-stu-id="6249e-107">ISO/IEC 14496-14: *Information technology -- Coding of audio-visual objects -- Part 14: MP4 File Format*</span></span>

> [!Note]  
> <span data-ttu-id="6249e-108">(Esses recursos podem não estar disponíveis em alguns idiomas e países.)</span><span class="sxs-lookup"><span data-stu-id="6249e-108">(These resources may not be available in some languages and countries.)</span></span>

 

<span data-ttu-id="6249e-109">O coletor de arquivos MPEG-4 não encapsula a funcionalidade de codificação.</span><span class="sxs-lookup"><span data-stu-id="6249e-109">The MPEG-4 file sink does not encapsulate encoding functionality.</span></span>

<span data-ttu-id="6249e-110">Para criar o coletor de arquivos MPEG-4, chame a função [**MFCreateMPEG4MediaSink**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatempeg4mediasink) .</span><span class="sxs-lookup"><span data-stu-id="6249e-110">To create the MPEG-4 file sink, call the [**MFCreateMPEG4MediaSink**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatempeg4mediasink) function.</span></span> <span data-ttu-id="6249e-111">O coletor de arquivos MPEG-4 expõe as seguintes interfaces por meio de **QueryInterface**:</span><span class="sxs-lookup"><span data-stu-id="6249e-111">The MPEG-4 file sink exposes the following interfaces through **QueryInterface**:</span></span>

-   [<span data-ttu-id="6249e-112">**IMFClockStateSink**</span><span class="sxs-lookup"><span data-stu-id="6249e-112">**IMFClockStateSink**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfclockstatesink)
-   [<span data-ttu-id="6249e-113">**IMFFinalizableMediaSink**</span><span class="sxs-lookup"><span data-stu-id="6249e-113">**IMFFinalizableMediaSink**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imffinalizablemediasink)
-   [<span data-ttu-id="6249e-114">**IMFGetService**</span><span class="sxs-lookup"><span data-stu-id="6249e-114">**IMFGetService**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfgetservice)
-   [<span data-ttu-id="6249e-115">**IMFMediaEventGenerator**</span><span class="sxs-lookup"><span data-stu-id="6249e-115">**IMFMediaEventGenerator**</span></span>](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator)
-   [<span data-ttu-id="6249e-116">**IMFMediaSink**</span><span class="sxs-lookup"><span data-stu-id="6249e-116">**IMFMediaSink**</span></span>](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink)

## <a name="sample-description-box"></a><span data-ttu-id="6249e-117">Caixa de descrição de exemplo</span><span class="sxs-lookup"><span data-stu-id="6249e-117">Sample Description Box</span></span>

<span data-ttu-id="6249e-118">MP4 é um formato de contêiner extensível.</span><span class="sxs-lookup"><span data-stu-id="6249e-118">MP4 is an extensible container format.</span></span> <span data-ttu-id="6249e-119">A especificação MP4 não define uma estrutura fixa para descrever os tipos de mídia em um contêiner MP4.</span><span class="sxs-lookup"><span data-stu-id="6249e-119">The MP4 specification does not define a fixed structure for describing media types in an MP4 container.</span></span> <span data-ttu-id="6249e-120">Em vez disso, ele define uma hierarquia de objetos que permite que as estruturas personalizadas sejam definidas para cada formato.</span><span class="sxs-lookup"><span data-stu-id="6249e-120">Instead, it defines an object hierarchy that allows custom structures to be defined for each format.</span></span> <span data-ttu-id="6249e-121">A descrição do formato é armazenada na caixa Descrição de exemplo (' stsd ') para cada fluxo.</span><span class="sxs-lookup"><span data-stu-id="6249e-121">The format description is stored in the sample description ('stsd') box for each stream.</span></span> <span data-ttu-id="6249e-122">A caixa Descrição de exemplo contém uma lista de entradas de exemplo.</span><span class="sxs-lookup"><span data-stu-id="6249e-122">The sample description box contains a list of sample entries.</span></span> <span data-ttu-id="6249e-123">Para cada entrada de exemplo, um código de 4 bytes, semelhante a um FOURCC, define a estrutura de formato.</span><span class="sxs-lookup"><span data-stu-id="6249e-123">For each sample entry, a 4-byte code, similar to a FOURCC, defines the format structure.</span></span>

<span data-ttu-id="6249e-124">O coletor de arquivos MPEG-4 pode gerar a caixa de descrição de exemplo para os seguintes formatos:</span><span class="sxs-lookup"><span data-stu-id="6249e-124">The MPEG-4 File Sink can generate the sample description box for the following formats:</span></span>

-   <span data-ttu-id="6249e-125">Vídeo H. 264/AVC</span><span class="sxs-lookup"><span data-stu-id="6249e-125">H.264/AVC video</span></span>
-   <span data-ttu-id="6249e-126">Áudio AAC</span><span class="sxs-lookup"><span data-stu-id="6249e-126">AAC audio</span></span>
-   <span data-ttu-id="6249e-127">Áudio MP3</span><span class="sxs-lookup"><span data-stu-id="6249e-127">MP3 audio</span></span>

<span data-ttu-id="6249e-128">Para outros formatos, a caixa Descrição de exemplo deve ser fornecida no tipo de mídia para cada fluxo.</span><span class="sxs-lookup"><span data-stu-id="6249e-128">For other formats, the sample description box must be provided in the media type for each stream.</span></span> <span data-ttu-id="6249e-129">Para especificar a caixa Descrição de exemplo, defina os seguintes atributos no tipo de mídia:</span><span class="sxs-lookup"><span data-stu-id="6249e-129">To specify the sample description box, set the following attributes on the media type:</span></span>



| <span data-ttu-id="6249e-130">Atributo</span><span class="sxs-lookup"><span data-stu-id="6249e-130">Attribute</span></span>                                                                     | <span data-ttu-id="6249e-131">Descrição</span><span class="sxs-lookup"><span data-stu-id="6249e-131">Description</span></span>                                                                                                                                                   |
|-------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="6249e-132">\_Descrição de \_ exemplo de MPEG4 \_ \_ do MF MT</span><span class="sxs-lookup"><span data-stu-id="6249e-132">MF\_MT\_MPEG4\_SAMPLE\_DESCRIPTION</span></span>](mf-mt-mpeg4-sample-description.md)      | <span data-ttu-id="6249e-133">Contém a caixa de descrição de exemplo como um blob binário.</span><span class="sxs-lookup"><span data-stu-id="6249e-133">Contains the sample description box as a binary blob.</span></span>                                                                                                         |
| [<span data-ttu-id="6249e-134">\_Entrada de \_ \_ exemplo atual \_ \_ do MF MT MPEG4</span><span class="sxs-lookup"><span data-stu-id="6249e-134">MF\_MT\_MPEG4\_CURRENT\_SAMPLE\_ENTRY</span></span>](mf-mt-mpeg4-current-sample-entry.md) | <span data-ttu-id="6249e-135">Especifica quais das entradas de exemplo na caixa de descrição de exemplo estão ativas no momento.</span><span class="sxs-lookup"><span data-stu-id="6249e-135">Specifies which of the sample entries in the sample description box is currently active.</span></span> <span data-ttu-id="6249e-136">(Opcional).</span><span class="sxs-lookup"><span data-stu-id="6249e-136">(Optional.)</span></span><br/> <span data-ttu-id="6249e-137">No momento, o valor deve ser zero.</span><span class="sxs-lookup"><span data-stu-id="6249e-137">Currently, the value must be zero.</span></span><br/> |



 

<span data-ttu-id="6249e-138">Em alguns casos, não é possível gerar uma caixa de descrição de exemplo até que todos os dados tenham sido codificados.</span><span class="sxs-lookup"><span data-stu-id="6249e-138">In some cases, it is not possible to generate a sample description box until all of the data has been encoded.</span></span> <span data-ttu-id="6249e-139">Por exemplo, informações como a taxa média de bits podem não ser conhecidas antes do tempo.</span><span class="sxs-lookup"><span data-stu-id="6249e-139">For example, information such as the average bit rate might not be known ahead of time.</span></span> <span data-ttu-id="6249e-140">Nesse caso, você pode atualizar o tipo de mídia usando a interface [**IMFMediaTypeHandler**](/windows/desktop/api/mfidl/nn-mfidl-imfmediatypehandler) no coletor de arquivos MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="6249e-140">In that case, you can update the media type by using the [**IMFMediaTypeHandler**](/windows/desktop/api/mfidl/nn-mfidl-imfmediatypehandler) interface on the MPEG-4 file sink.</span></span> <span data-ttu-id="6249e-141">Isso deve ser feito antes de o coletor de mídia ser finalizado.</span><span class="sxs-lookup"><span data-stu-id="6249e-141">This must be done before the media sink is finalized.</span></span>

<span data-ttu-id="6249e-142">Normalmente, o tipo de mídia é criado por um codificador upstream.</span><span class="sxs-lookup"><span data-stu-id="6249e-142">Typically the media type is created by an upstream encoder.</span></span> <span data-ttu-id="6249e-143">O codificador pode gerar um novo tipo de mídia durante o streaming, por meio de uma alteração de formato dinâmico.</span><span class="sxs-lookup"><span data-stu-id="6249e-143">The encoder can generate a new media type during streaming, through a dynamic format change.</span></span> <span data-ttu-id="6249e-144">Para obter mais informações, consulte [Dynamic Format Changes](basic-mft-processing-model.md).</span><span class="sxs-lookup"><span data-stu-id="6249e-144">For more information, see [Dynamic Format Changes](basic-mft-processing-model.md).</span></span>

## <a name="h264avc-video"></a><span data-ttu-id="6249e-145">Vídeo H. 264/AVC</span><span class="sxs-lookup"><span data-stu-id="6249e-145">H.264/AVC Video</span></span>

<span data-ttu-id="6249e-146">O coletor de arquivos MPEG-4 dá suporte à versão do fluxo AVC que tem um fluxo de vídeo elementar, com SPS (conjunto de parâmetros de sequência) e NALUs de conjunto de parâmetros de imagem (PPS) contidos na caixa de descrição de exemplo, conforme definido na seção ISO/IEC 14496 parte 15 5,1.</span><span class="sxs-lookup"><span data-stu-id="6249e-146">The MPEG-4 file sink supports the version of the AVC stream that has an elementary video stream, with sequence parameter set (SPS) and picture parameter set (PPS) NALUs contained in the sample description box, as defined in ISO/IEC 14496 part 15 section 5.1.</span></span> <span data-ttu-id="6249e-147">O coletor de arquivos não oferece suporte ao método alternativo de armazenamento do SPS/PPS NALUs como um fluxo elementar do conjunto de parâmetros separado.</span><span class="sxs-lookup"><span data-stu-id="6249e-147">The file sink does not support the alternate method of storing SPS/PPS NALUs as a separate parameter-set elementary stream.</span></span>

<span data-ttu-id="6249e-148">O coletor de arquivos MPEG-4 pode gerar a caixa de descrição de exemplo, mas deve ser fornecido com o SPS e o PPS NALUs.</span><span class="sxs-lookup"><span data-stu-id="6249e-148">The MPEG-4 file sink can generate the sample description box, but must be provided with the SPS and PPS NALUs.</span></span> <span data-ttu-id="6249e-149">Especifique essas informações no tipo de mídia definindo o atributo [**de \_ \_ cabeçalho de \_ sequência \_ MF MT MPEG**](mf-mt-mpeg-sequence-header-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="6249e-149">Specify this information in the media type by setting the [**MF\_MT\_MPEG\_SEQUENCE\_HEADER**](mf-mt-mpeg-sequence-header-attribute.md) attribute.</span></span> <span data-ttu-id="6249e-150">O valor do atributo é o cabeçalho de sequência H. 264.</span><span class="sxs-lookup"><span data-stu-id="6249e-150">The value of the attribute is the H.264 sequence header.</span></span> <span data-ttu-id="6249e-151">O cabeçalho de sequência deve consistir no SPS e no PPS NALUs delimitados por códigos de inicialização de 3 ou de 4 bytes.</span><span class="sxs-lookup"><span data-stu-id="6249e-151">The sequence header must consist of the SPS and PPS NALUs delimited by either 3-byte or 4-byte start codes.</span></span>

<span data-ttu-id="6249e-152">Opcionalmente, ao configurar o coletor de arquivos, você pode omitir o atributo de [**\_ cabeçalho de sequência MF MT \_ MPEG \_ \_**](mf-mt-mpeg-sequence-header-attribute.md) do tipo de mídia inicial.</span><span class="sxs-lookup"><span data-stu-id="6249e-152">Optionally, when you configure the file sink, you can omit the [**MF\_MT\_MPEG\_SEQUENCE\_HEADER**](mf-mt-mpeg-sequence-header-attribute.md) attribute from the initial media type.</span></span> <span data-ttu-id="6249e-153">Nesse caso, você deve atualizar o tipo de mídia posteriormente para incluir o cabeçalho de sequência.</span><span class="sxs-lookup"><span data-stu-id="6249e-153">In that case, you must update the media type later to include the sequence header.</span></span>

<span data-ttu-id="6249e-154">O coletor de arquivos MPEG-4 tem os seguintes requisitos para AVC fragmentado:</span><span class="sxs-lookup"><span data-stu-id="6249e-154">The MPEG-4 file sink has the following requirements for AVC bitstreams:</span></span>

-   <span data-ttu-id="6249e-155">O fragmentado deve estar em conformidade com a especificação de formato H. 264 anexo B.</span><span class="sxs-lookup"><span data-stu-id="6249e-155">The bitstream must conform to the H.264 Annex B format specification.</span></span> <span data-ttu-id="6249e-156">Em particular, NALUs deve ser delimitado com códigos de início de 3 ou 4 bytes.</span><span class="sxs-lookup"><span data-stu-id="6249e-156">In particular, NALUs must be delimited with either 3-byte or 4-byte start codes.</span></span>
-   <span data-ttu-id="6249e-157">Os exemplos de mídia devem conter todos os NALUs de dados e fatias que correspondam a um único tempo de apresentação.</span><span class="sxs-lookup"><span data-stu-id="6249e-157">Media samples must contain all slice and data NALUs that correspond to a single presentation time.</span></span>
-   <span data-ttu-id="6249e-158">Ao escrever quadros B em um arquivo MP4, você deve definir o carimbo de data/hora da apresentação e o carimbo de data/hora de decodificação.</span><span class="sxs-lookup"><span data-stu-id="6249e-158">When writing B-frames into an MP4 file, you must set both the presentation time stamp and the decode time stamp.</span></span> <span data-ttu-id="6249e-159">Se Stream tiver um quadro B e o carimbo de data/hora de decodificação não estiver definido, o gravador MP4 verá o tempo de quadro voltado para trás e descartará o quadro.</span><span class="sxs-lookup"><span data-stu-id="6249e-159">If stream has a B frame and the decode timestamp is not set, the MP4 writer will see the frame time going backwards and will drop the frame.</span></span> 

## <a name="aac-audio"></a><span data-ttu-id="6249e-160">Áudio AAC</span><span class="sxs-lookup"><span data-stu-id="6249e-160">AAC Audio</span></span>

<span data-ttu-id="6249e-161">Para o áudio AAC, o coletor de arquivos MPEG-4 pode gerar a caixa de descrição de exemplo para os seguintes subtipos:</span><span class="sxs-lookup"><span data-stu-id="6249e-161">For AAC audio, the MPEG-4 file sink can generate the sample description box for the following subtypes:</span></span>

-   <span data-ttu-id="6249e-162">**\_AAC MFAudioFormat**</span><span class="sxs-lookup"><span data-stu-id="6249e-162">**MFAudioFormat\_AAC**</span></span>
-   <span data-ttu-id="6249e-163">**\_AAC1 bruto \_ MEDIASUBTYPE**</span><span class="sxs-lookup"><span data-stu-id="6249e-163">**MEDIASUBTYPE\_RAW\_AAC1**</span></span>

<span data-ttu-id="6249e-164">Para obter mais informações sobre esses substypes, consulte [tipos de mídia AAC](aac-media-types.md).</span><span class="sxs-lookup"><span data-stu-id="6249e-164">For more information about these substypes, see [AAC Media Types](aac-media-types.md).</span></span>

<span data-ttu-id="6249e-165">Para o subtipo **MFAudioFormat \_ AAC** , o tipo de mídia contém opcionalmente o atributo de [**\_ dados de \_ usuário \_ MF MT**](mf-mt-user-data-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="6249e-165">For the **MFAudioFormat\_AAC** subtype, the media type optionally contains the [**MF\_MT\_USER\_DATA**](mf-mt-user-data-attribute.md) attribute.</span></span> <span data-ttu-id="6249e-166">Se estiver presente, esse atributo será a parte da estrutura [**HEAACWAVEINFO**](/windows/win32/api/mmreg/ns-mmreg-heaacwaveinfo) que aparece após a estrutura **WAVEFORMATEX** (ou seja, após o membro **WFX** ).</span><span class="sxs-lookup"><span data-stu-id="6249e-166">If present, this attribute the portion of the [**HEAACWAVEINFO**](/windows/win32/api/mmreg/ns-mmreg-heaacwaveinfo) structure that appears after the **WAVEFORMATEX** structure (that is, after the **wfx** member).</span></span> <span data-ttu-id="6249e-167">Isso é seguido pelos dados de AudioSpecificConfig (), conforme definido por ISO/IEC 14496-3.</span><span class="sxs-lookup"><span data-stu-id="6249e-167">This is followed by the AudioSpecificConfig() data, as defined by ISO/IEC 14496-3.</span></span> <span data-ttu-id="6249e-168">Se o atributo de **\_ dados de \_ usuário \_ MF MT** não estiver presente, o fluxo será considerado como perfil de LC (complexidade baixa) e o coletor de arquivos MPEG-4 gerará uma caixa de descrição de exemplo adequada.</span><span class="sxs-lookup"><span data-stu-id="6249e-168">If the **MF\_MT\_USER\_DATA** attribute is not present, the stream is assumed to be AAC Low Complexity (LC) profile, and the MPEG-4 file sink generates a suitable sample description box.</span></span>

<span data-ttu-id="6249e-169">Para o subtipo **\_ \_ AAC1 bruto MEDIASUBTYPE** , o coletor de mídia deve conter o atributo de [**\_ dados de \_ usuário \_ MF MT**](mf-mt-user-data-attribute.md) e o atributo deve conter os dados AudioSpecificConfig ().</span><span class="sxs-lookup"><span data-stu-id="6249e-169">For the **MEDIASUBTYPE\_RAW\_AAC1** subtype, the media sink must contain the [**MF\_MT\_USER\_DATA**](mf-mt-user-data-attribute.md) attribute, and the attribute must contain the AudioSpecificConfig() data.</span></span>

<span data-ttu-id="6249e-170">O coletor de arquivos MPEG-4 cria a variante MPEG-4 da caixa de descrição de exemplo AAC, usando uma entrada de exemplo ' mp4a ' com objectTypeIndication = 0x40.</span><span class="sxs-lookup"><span data-stu-id="6249e-170">The MPEG-4 file sink creates the MPEG-4 variant of the AAC sample description box, using an 'mp4a' sample entry with objectTypeIndication = 0x40.</span></span> <span data-ttu-id="6249e-171">Ele não usa tipos de objeto MPEG-2.</span><span class="sxs-lookup"><span data-stu-id="6249e-171">It does not use MPEG-2 object types.</span></span>

## <a name="mp3-audio"></a><span data-ttu-id="6249e-172">Áudio MP3</span><span class="sxs-lookup"><span data-stu-id="6249e-172">MP3 Audio</span></span>

<span data-ttu-id="6249e-173">Para áudio MP3, o coletor de arquivos MPEG-4 pode gerar a caixa de descrição de exemplo de um tipo de mídia de áudio padrão.</span><span class="sxs-lookup"><span data-stu-id="6249e-173">For MP3 audio, the MPEG-4 file sink can generate the sample description box from a standard audio media type.</span></span> <span data-ttu-id="6249e-174">(Consulte [tipos de mídia de áudio](audio-media-types.md).)</span><span class="sxs-lookup"><span data-stu-id="6249e-174">(See [Audio Media Types](audio-media-types.md).)</span></span>

<span data-ttu-id="6249e-175">O coletor de arquivos MPEG-4 cria a variante MPEG-4 da caixa de descrição de exemplo MP3, usando uma entrada de exemplo ' mp4a ' com objectTypeIndication = 0x6b para áudio MPEG-1.</span><span class="sxs-lookup"><span data-stu-id="6249e-175">The MPEG-4 file sink creates the MPEG-4 variant of the MP3 sample description box, using an 'mp4a' sample entry with objectTypeIndication = 0x6b for MPEG-1 audio.</span></span>

## <a name="limitations"></a><span data-ttu-id="6249e-176">Limitações</span><span class="sxs-lookup"><span data-stu-id="6249e-176">Limitations</span></span>

-   <span data-ttu-id="6249e-177">O tamanho máximo do arquivo criado é de 4 GB.</span><span class="sxs-lookup"><span data-stu-id="6249e-177">The maximum size of the authored file is 4 GB.</span></span> <span data-ttu-id="6249e-178">No Windows 8, há suporte para arquivos de tamanho superior a 4 GBGB.</span><span class="sxs-lookup"><span data-stu-id="6249e-178">In Windows 8, files large than 4 GBGB are supported.</span></span>
-   <span data-ttu-id="6249e-179">O coletor de arquivos MPEG-4 não oferece suporte a listas de edição (caixas ' EDTs ' e ' Elst ').</span><span class="sxs-lookup"><span data-stu-id="6249e-179">The MPEG-4 file sink does not support edit lists ('edts' and 'elst' boxes).</span></span>

## <a name="windows-8-updates-to-mpeg-4-source-and-sink"></a><span data-ttu-id="6249e-180">Atualizações do Windows 8 para fonte e coletor MPEG-4</span><span class="sxs-lookup"><span data-stu-id="6249e-180">Windows 8 updates to MPEG-4 source and sink</span></span>

-   <span data-ttu-id="6249e-181">Suporte de leitura e gravação de rotação adicionado na fonte e no coletor do Windows 8 MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="6249e-181">Rotation read and write support added in Windows 8 MPEG-4 source and sink.</span></span> <span data-ttu-id="6249e-182">Não há suporte para isso na fonte e no coletor do Windows 7 MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="6249e-182">This is not supported in the Windows 7 MPEG-4 source and sink.</span></span>

    <span data-ttu-id="6249e-183">A origem MPEG-4 lê o ângulo de rotação de uma faixa de vídeo ativa como a soma do ângulo de rotação de ' mvhd ' e de ' tkhd '.</span><span class="sxs-lookup"><span data-stu-id="6249e-183">MPEG-4 source reads the rotation angle for an active video track as the sum of the rotation angle from ‘mvhd’ and from ‘tkhd’.</span></span>

    <span data-ttu-id="6249e-184">O coletor MPEG-4 da Microsoft grava o ângulo de rotação em ' tkhd ', mas grava a matriz de 0 grau (identidade) em ' mvhd '.</span><span class="sxs-lookup"><span data-stu-id="6249e-184">Microsoft MPEG-4 sink writes the rotation angle in ‘tkhd’ but writes 0 degree (identity) matrix in ‘mvhd’.</span></span> <span data-ttu-id="6249e-185">Observe que o coletor MPEG-4 da Microsoft oferece suporte apenas a faixa de vídeo único.</span><span class="sxs-lookup"><span data-stu-id="6249e-185">Note, Microsoft MPEG-4 sink only supports single video track.</span></span>

    <span data-ttu-id="6249e-186">IPropertyStore lê o ângulo de rotação somente para a primeira faixa de vídeo que a soma do ângulo de rotação de ' mvhd ' e de ' tkhd '.</span><span class="sxs-lookup"><span data-stu-id="6249e-186">IPropertyStore reads the rotation angle for only the first video track as the sum of the rotation angle from ‘mvhd’ and from ‘tkhd’.</span></span>

    <span data-ttu-id="6249e-187">IPropertyStore grava o ângulo de rotação somente para a primeira faixa de vídeo em ' tkhd ' depois que o ângulo de rotação é ajustado de acordo com o ângulo de rotação em ' mvhd ', se existir.</span><span class="sxs-lookup"><span data-stu-id="6249e-187">IPropertyStore writes the rotation angle for only the first video track in ‘tkhd’ after the rotation angle is adjusted according to the rotation angle in ‘mvhd’, if it exists.</span></span>

-   <span data-ttu-id="6249e-188">Os fragmentos de filme (' Moof ') têm suporte na origem e no coletor do Windows 8 MPEG-4, mas ' mfra ' não.</span><span class="sxs-lookup"><span data-stu-id="6249e-188">Movie fragments ('moof') is supported in Windows 8 MPEG-4 source and sink, but 'mfra' is not.</span></span>
-   <span data-ttu-id="6249e-189">H. 263 tem suporte na origem do Windows 8 MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="6249e-189">H.263 is supported in Windows 8 MPEG-4 source.</span></span>

    <span data-ttu-id="6249e-190">A origem MPEG-4 agora mapeia dois FOURCC de ' H263 ' e de 263 ' no formato de arquivo MPEG-4 para o tipo de mídia de **MFVideoFormat \_ H263**.</span><span class="sxs-lookup"><span data-stu-id="6249e-190">MPEG-4 source now maps two fourcc’s of ‘h263’ and ‘s263’ in MPEG-4 file format to the media type of **MFVideoFormat\_H263**.</span></span>

-   <span data-ttu-id="6249e-191">Suporte mais FOURCC adicionado para MJPEG na origem do Windows 8 MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="6249e-191">More fourcc support added for MJPEG in Windows 8 MPEG-4 source.</span></span>

    <span data-ttu-id="6249e-192">A origem MPEG-4 mapeia foucc de ' dmb1 ' para o tipo de mídia de **\_ MJPG MFVideoFormat**.</span><span class="sxs-lookup"><span data-stu-id="6249e-192">MPEG-4 source maps foucc of ‘dmb1’ to the media type of **MFVideoFormat\_MJPG**.</span></span>

-   <span data-ttu-id="6249e-193">Suporte a metadados Furigana adicionado à origem do Windows 8 MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="6249e-193">Furigana metadata support added in Windows 8 MPEG-4 source.</span></span>

    <span data-ttu-id="6249e-194">A origem MPEG-4 lê metadados Furigana de ' soal ', ' disparar ', ' Soaa ', ' sonm ' e ' soco '.</span><span class="sxs-lookup"><span data-stu-id="6249e-194">MPEG-4 source reads Furigana metadata from ’soal’, ‘soar’, ‘soaa’, ‘sonm’, and ‘soco’.</span></span> <span data-ttu-id="6249e-195">IPropertyStore lê os metadados do Furignana por meio do conjunto de PKEYs correspondentes.</span><span class="sxs-lookup"><span data-stu-id="6249e-195">IPropertyStore reads Furignana metadata through the set of corresponding PKEYs.</span></span>

    <span data-ttu-id="6249e-196">A tabela a seguir mostra o mapeamento entre o nome canônico do Shell, a chave de propriedade e a ID da caixa/marca no formato de arquivo MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="6249e-196">The following table shows the mapping between the shell canonical name, the property key, and the box/tag ID in MPEG-4 file format.</span></span>

    

    | <span data-ttu-id="6249e-197">Campo</span><span class="sxs-lookup"><span data-stu-id="6249e-197">Field</span></span>                                | <span data-ttu-id="6249e-198">Chave de propriedade</span><span class="sxs-lookup"><span data-stu-id="6249e-198">Property Key</span></span>                         | <span data-ttu-id="6249e-199">ID da marca/caixa</span><span class="sxs-lookup"><span data-stu-id="6249e-199">Tag/Box ID</span></span> |
    |--------------------------------------|--------------------------------------|------------|
    | <span data-ttu-id="6249e-200">System. Music. AlbumTitleSortOverride</span><span class="sxs-lookup"><span data-stu-id="6249e-200">System.Music.AlbumTitleSortOverride</span></span>  | <span data-ttu-id="6249e-201">PKEY \_ Music \_ AlbumTitleSortOverride</span><span class="sxs-lookup"><span data-stu-id="6249e-201">PKEY\_Music\_AlbumTitleSortOverride</span></span>  | <span data-ttu-id="6249e-202">soal</span><span class="sxs-lookup"><span data-stu-id="6249e-202">soal</span></span>       |
    | <span data-ttu-id="6249e-203">System. Music. ArtistSortOverride</span><span class="sxs-lookup"><span data-stu-id="6249e-203">System.Music.ArtistSortOverride</span></span>      | <span data-ttu-id="6249e-204">PKEY \_ Music \_ ArtistSortOverride</span><span class="sxs-lookup"><span data-stu-id="6249e-204">PKEY\_Music\_ArtistSortOverride</span></span>      | <span data-ttu-id="6249e-205">disparar</span><span class="sxs-lookup"><span data-stu-id="6249e-205">soar</span></span>       |
    | <span data-ttu-id="6249e-206">System. Music. AlbumArtistSortOverride</span><span class="sxs-lookup"><span data-stu-id="6249e-206">System.Music.AlbumArtistSortOverride</span></span> | <span data-ttu-id="6249e-207">PKEY \_ Music \_ AlbumArtistSortOverride</span><span class="sxs-lookup"><span data-stu-id="6249e-207">PKEY\_Music\_AlbumArtistSortOverride</span></span> | <span data-ttu-id="6249e-208">soaa</span><span class="sxs-lookup"><span data-stu-id="6249e-208">soaa</span></span>       |
    | <span data-ttu-id="6249e-209">System. TitleSortOverride</span><span class="sxs-lookup"><span data-stu-id="6249e-209">System.TitleSortOverride</span></span>             | <span data-ttu-id="6249e-210">PKEY \_ TitleSortOverride</span><span class="sxs-lookup"><span data-stu-id="6249e-210">PKEY \_TitleSortOverride</span></span>             | <span data-ttu-id="6249e-211">sonm</span><span class="sxs-lookup"><span data-stu-id="6249e-211">sonm</span></span>       |
    | <span data-ttu-id="6249e-212">System. Music. ComposerSortOverride</span><span class="sxs-lookup"><span data-stu-id="6249e-212">System.Music.ComposerSortOverride</span></span>    | <span data-ttu-id="6249e-213">PKEY \_ Music \_ ComposerSortOverride</span><span class="sxs-lookup"><span data-stu-id="6249e-213">PKEY\_Music\_ComposerSortOverride</span></span>    | <span data-ttu-id="6249e-214">soco</span><span class="sxs-lookup"><span data-stu-id="6249e-214">soco</span></span>       |

    

     

-   <span data-ttu-id="6249e-215">O suporte ao Atom 3D estéreo foi adicionado à origem do Windows 8 MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="6249e-215">Stereo 3D atom support added in Windows 8 MPEG-4 source.</span></span>

-   <span data-ttu-id="6249e-216">AC3 e DD + suporte adicionado na fonte e no coletor do Windows 8 MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="6249e-216">AC3 and DD+ support added in Windows 8 MPEG-4 source and sink.</span></span>
-   <span data-ttu-id="6249e-217">Há suporte para arquivos com mais de 4 GB no coletor MPEG-4 do Windows 8 para MP4 não fragmentado.</span><span class="sxs-lookup"><span data-stu-id="6249e-217">Files larger than 4 GB are supported in Windows 8 MPEG-4 sink for non-fragmental MP4.</span></span>
-   <span data-ttu-id="6249e-218">A depuração foi otimizada na origem do Windows 8 MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="6249e-218">Scrubbing has been optimized in Windows 8 MPEG-4 source.</span></span>

    <span data-ttu-id="6249e-219">Para reduzir a latência, as informações para os dois quadros-chave mais próximos para uma determinada posição de busca são expostas por meio de [**IMFSeekInfo:: GetNearestKeyFrames**](/windows/desktop/api/mfidl/nf-mfidl-imfseekinfo-getnearestkeyframes).</span><span class="sxs-lookup"><span data-stu-id="6249e-219">To reduce latency, information for the two nearest key frames for a particular seek position are exposed through [**IMFSeekInfo::GetNearestKeyFrames**](/windows/desktop/api/mfidl/nf-mfidl-imfseekinfo-getnearestkeyframes).</span></span> <span data-ttu-id="6249e-220">Como o quadro-chave não tem quadros dependentes, ele apresenta o quadro depois da decodificação de apenas um quadro.</span><span class="sxs-lookup"><span data-stu-id="6249e-220">Since the key frame does not have dependent frames, it presents the frame after decoding only one frame.</span></span> <span data-ttu-id="6249e-221">Use [**IMFGetService:: GetService**](/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice) para obter essa interface por meio da origem, do pipeline ou do aplicativo de mídia.</span><span class="sxs-lookup"><span data-stu-id="6249e-221">Use [**IMFGetService::GetService**](/windows/desktop/api/mfidl/nf-mfidl-imfgetservice-getservice) to obtain this interface through the media source, pipeline, or application.</span></span>

    <span data-ttu-id="6249e-222">Defina a taxa como zero na fonte MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="6249e-222">Set rate to zero in MPEG-4 source.</span></span> <span data-ttu-id="6249e-223">Quando o pipeline está no modo de depuração, a taxa é zero.</span><span class="sxs-lookup"><span data-stu-id="6249e-223">When the pipeline is in scrubbing mode, the rate is zero.</span></span>

-   <span data-ttu-id="6249e-224">O SPS e o PPS podem ser armazenados em dados de exemplo no coletor MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="6249e-224">SPS and PPS can be stored in sample data in MPEG-4 sink.</span></span>

    <span data-ttu-id="6249e-225">[MF \_ O atributo de \_ \_ passagem MPEG4SINK SPSPPS](mf-mpeg4sink-spspps-passthrough.md) no coletor MPEG-4 é definido para permitir que SPS e PPS sejam salvos junto com os exemplos de entrada (dados de vídeo H. 264).</span><span class="sxs-lookup"><span data-stu-id="6249e-225">[MF\_MPEG4SINK\_SPSPPS\_PASSTHROUGH](mf-mpeg4sink-spspps-passthrough.md) attribute on MPEG-4 sink is defined to allow SPS’s and PPS’s to be saved together with input samples (H.264 video data).</span></span> <span data-ttu-id="6249e-226">Os clipes MP4 produzidos são capazes de ser reproduzidos pela fonte do Windows 7 MPEG-4 e outros.</span><span class="sxs-lookup"><span data-stu-id="6249e-226">The produced mp4 clips are play-able by Windows 7 MPEG-4 source and others.</span></span>

-   <span data-ttu-id="6249e-227">O SPS e o PPS podem ser extraídos de exemplos de entrada no coletor MPEG-4.</span><span class="sxs-lookup"><span data-stu-id="6249e-227">SPS and PPS can be extracted from input samples in MPEG-4 sink.</span></span>

    <span data-ttu-id="6249e-228">Quando o SPS e o PPS não estiverem definidos por meio do [ \_ cabeçalho de sequência MF MT \_ MPEG \_ \_ ](mf-mt-mpeg-sequence-header-attribute.md) no tipo de mídia de entrada do coletor MPEG-4, o coletor MPEG-4 tentará extrair o SPS e o PPS de exemplos de entrada.</span><span class="sxs-lookup"><span data-stu-id="6249e-228">When SPS and PPS are not set through [MF\_MT\_MPEG\_SEQUENCE\_HEADER](mf-mt-mpeg-sequence-header-attribute.md) on input media type of the MPEG-4 sink, MPEG-4 sink will try to extract SPS and PPS from input samples.</span></span> <span data-ttu-id="6249e-229">O coletor MPEG-4 ignora qualquer amostra de entrada até encontrar o primeiro SPS e o PPS, pois todos os exemplos de entrada sem SPS e PPS não são capazes de decodificar.</span><span class="sxs-lookup"><span data-stu-id="6249e-229">MPEG-4 sink ignores any input samples until it finds the first SPS and PPS, because all input samples without SPS and PPS are not decode-able.</span></span>

-   <span data-ttu-id="6249e-230">as informações 3D no registro de configuração AVC têm suporte para MP4 não fragmentado.</span><span class="sxs-lookup"><span data-stu-id="6249e-230">3D information in AVC configuration record is supported for non-fragmental MP4.</span></span>
-   <span data-ttu-id="6249e-231">O comprimento de NALU é exposto para exemplos compactados de H. 264 para otimizar a decodificação de H. 264 VLD DXVA.</span><span class="sxs-lookup"><span data-stu-id="6249e-231">NALU length is exposed for H.264 compressed samples to optimize H.264 VLD DXVA decoding.</span></span>

    <span data-ttu-id="6249e-232">Os conjuntos de origem MPEG-4 [NALU o tamanho do MF em \_ \_ \_ conjunto](mf-nalu-length-set.md) no tipo de mídia de saída de **MFVideoFormat \_ H264** ou **MFVideoFormat \_ H264**.</span><span class="sxs-lookup"><span data-stu-id="6249e-232">MPEG-4 source sets [MF\_NALU\_LENGTH\_SET](mf-nalu-length-set.md) on the output media type of **MFVideoFormat\_H264** or **MFVideoFormat\_h264**.</span></span> <span data-ttu-id="6249e-233">Ele define o blob de [ \_ informações de \_ comprimento \_ de NALU MF](mf-nalu-length-information.md) em cada amostra de saída, com comprimento de NALU de quatro bytes para diferentes NALU em uma amostra compactada.</span><span class="sxs-lookup"><span data-stu-id="6249e-233">It sets the blob of [MF\_NALU\_LENGTH\_INFORMATION](mf-nalu-length-information.md) on each output sample, with four-byte NALU length for different NALU’s in one compressed sample.</span></span>

-   <span data-ttu-id="6249e-234">Suporte adicionado para áudio MPEG2 ADTS na fonte MP4.</span><span class="sxs-lookup"><span data-stu-id="6249e-234">Support added for MPEG2 ADTS audio in MP4 source.</span></span>

## <a name="requirements"></a><span data-ttu-id="6249e-235">Requisitos</span><span class="sxs-lookup"><span data-stu-id="6249e-235">Requirements</span></span>



| <span data-ttu-id="6249e-236">Requisito</span><span class="sxs-lookup"><span data-stu-id="6249e-236">Requirement</span></span> | <span data-ttu-id="6249e-237">Valor</span><span class="sxs-lookup"><span data-stu-id="6249e-237">Value</span></span> |
|-------------------------------------|---------------------------------------------------------|
| <span data-ttu-id="6249e-238">Cliente mínimo com suporte</span><span class="sxs-lookup"><span data-stu-id="6249e-238">Minimum supported client</span></span><br/> | <span data-ttu-id="6249e-239">\[Somente aplicativos de área de trabalho do Windows 7\]</span><span class="sxs-lookup"><span data-stu-id="6249e-239">Windows 7 \[desktop apps only\]</span></span><br/>              |
| <span data-ttu-id="6249e-240">Servidor mínimo com suporte</span><span class="sxs-lookup"><span data-stu-id="6249e-240">Minimum supported server</span></span><br/> | <span data-ttu-id="6249e-241">\[Somente aplicativos da área de trabalho do Windows Server 2008 R2\]</span><span class="sxs-lookup"><span data-stu-id="6249e-241">Windows Server 2008 R2 \[desktop apps only\]</span></span><br/> |



## <a name="see-also"></a><span data-ttu-id="6249e-242">Confira também</span><span class="sxs-lookup"><span data-stu-id="6249e-242">See also</span></span>

<dl> <dt>

[<span data-ttu-id="6249e-243">Fontes de mídia e coletores</span><span class="sxs-lookup"><span data-stu-id="6249e-243">Media Sources and Sinks</span></span>](media-sources-and-sinks.md)
</dt> <dt>

[<span data-ttu-id="6249e-244">Coletores de mídia</span><span class="sxs-lookup"><span data-stu-id="6249e-244">Media Sinks</span></span>](media-sinks.md)
</dt> <dt>

[<span data-ttu-id="6249e-245">Suporte a MPEG-4 no Media Foundation</span><span class="sxs-lookup"><span data-stu-id="6249e-245">MPEG-4 Support in Media Foundation</span></span>](mpeg-4-support-in-media-foundation.md)
</dt> <dt>

[<span data-ttu-id="6249e-246">Formatos de mídia compatíveis com o Media Foundation</span><span class="sxs-lookup"><span data-stu-id="6249e-246">Supported Media Formats in Media Foundation</span></span>](supported-media-formats-in-media-foundation.md)
</dt> </dl>

 

 
