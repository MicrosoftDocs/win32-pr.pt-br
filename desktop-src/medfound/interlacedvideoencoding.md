---
description: Codificação de vídeo entrelaçado
ms.assetid: 7695d4e3-4a75-4972-ab02-bc532d6a4dce
title: Codificação de vídeo entrelaçado (Microsoft Media Foundation)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fafacb56f29964e81b040c59cdb75d8ebb35830b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103922571"
---
# <a name="interlaced-video-encoding-microsoft-media-foundation"></a><span data-ttu-id="dfa40-103">Codificação de vídeo entrelaçado (Microsoft Media Foundation)</span><span class="sxs-lookup"><span data-stu-id="dfa40-103">Interlaced Video Encoding (Microsoft Media Foundation)</span></span>

<span data-ttu-id="dfa40-104">Os dados de vídeo destinados ao uso com computadores normalmente são *progressivos*, o que significa que cada quadro é codificado como uma única imagem.</span><span class="sxs-lookup"><span data-stu-id="dfa40-104">Video data intended for use with computers is typically *progressive*, meaning that each frame is encoded as a single image.</span></span> <span data-ttu-id="dfa40-105">Alguns dispositivos, como televisões, não exibem um quadro de uma só vez, mas como duas imagens.</span><span class="sxs-lookup"><span data-stu-id="dfa40-105">Some devices, like televisions, do not display a frame all at once, but as two images.</span></span> <span data-ttu-id="dfa40-106">Uma das imagens, ou campos, contém todas as linhas ainda numeradas.</span><span class="sxs-lookup"><span data-stu-id="dfa40-106">One of the images, or fields, contains all of the even numbered rows.</span></span> <span data-ttu-id="dfa40-107">O outro campo contém os dados de todas as linhas ímpares numeradas.</span><span class="sxs-lookup"><span data-stu-id="dfa40-107">The other field contains the data for all of the odd numbered rows.</span></span> <span data-ttu-id="dfa40-108">O vídeo codificado com mais de um campo por quadro é chamado de entrelaçado, pois é renderizado alternando entre o campo par e o campo ímpar.</span><span class="sxs-lookup"><span data-stu-id="dfa40-108">Video encoded with more than one field per frame is called interlaced, because it is rendered by switching between the even field and the odd field.</span></span>

<span data-ttu-id="dfa40-109">No passado, o conteúdo de vídeo entrelaçado era sempre desentrelaçado antes da codificação com o codec de vídeo do Windows Media.</span><span class="sxs-lookup"><span data-stu-id="dfa40-109">In the past, interlaced video content was always de-interlaced before encoding with the Windows Media Video codec.</span></span> <span data-ttu-id="dfa40-110">No entanto, a partir do Windows Media 9 Series, o codificador de vídeo dá suporte à compactação de conteúdo entrelaçado sem primeiro convertê-lo para progressivo.</span><span class="sxs-lookup"><span data-stu-id="dfa40-110">Beginning with Windows Media 9 Series, however, the video encoder supports compression of interlaced content without first converting it to progressive.</span></span> <span data-ttu-id="dfa40-111">Manter o entrelaçamento em um arquivo codificado é importante se o conteúdo for renderizado em uma exibição entrelaçada, como uma televisão.</span><span class="sxs-lookup"><span data-stu-id="dfa40-111">Maintaining interlacing in an encoded file is important if the content is ever rendered on an interlaced display, such as a television.</span></span> <span data-ttu-id="dfa40-112">Esse recurso é de maior importância, como o suporte para o espelhamento de conteúdo baseado no Windows Media para players de DVD, caixas superiores de conjunto e outras eletrônicas domésticas.</span><span class="sxs-lookup"><span data-stu-id="dfa40-112">This feature is of increasing importance, as support for Windows Media-based content spreads to DVD players, set-top boxes, and other home electronics.</span></span>

<span data-ttu-id="dfa40-113">A maneira mais fácil de codificar e fornecer vídeo entrelaçado é desenvolver seu aplicativo usando o Windows Media Format SDK e armazenar o conteúdo em arquivos ASF.</span><span class="sxs-lookup"><span data-stu-id="dfa40-113">The easiest way to encode and deliver interlaced video is to develop your application using the Windows Media Format SDK and storing the content in ASF files.</span></span> <span data-ttu-id="dfa40-114">As informações entrelaçadas sobre quadros são passadas para o codec usando extensões de unidade de dados, que funcionam bem para conteúdo ASF, mas são um pouco mais complicados de dar suporte a outros contêineres.</span><span class="sxs-lookup"><span data-stu-id="dfa40-114">The interlaced information about frames is passed to the codec using data unit extensions, which work well for ASF content, but are a little trickier to support in other containers.</span></span> <span data-ttu-id="dfa40-115">Para obter mais informações sobre extensões de unidade de dados, consulte [usando extensões de unidade de dados](usingdataunitextensions.md).</span><span class="sxs-lookup"><span data-stu-id="dfa40-115">For more information about data unit extensions, see [Using Data Unit Extensions](usingdataunitextensions.md).</span></span>

<span data-ttu-id="dfa40-116">Para dar suporte à codificação entrelaçada envolve duas etapas principais: obter as informações do quadro para o codificador e fornecer as informações para o aplicativo de renderização.</span><span class="sxs-lookup"><span data-stu-id="dfa40-116">To support interlaced encoding involves two major steps: getting the frame information to the encoder, and delivering the information to the rendering application.</span></span> <span data-ttu-id="dfa40-117">Essas etapas são descritas nos parágrafos a seguir.</span><span class="sxs-lookup"><span data-stu-id="dfa40-117">These steps are described in the following paragraphs.</span></span>

## <a name="interlaced-video-and-the-encoder"></a><span data-ttu-id="dfa40-118">Vídeo entrelaçado e o codificador</span><span class="sxs-lookup"><span data-stu-id="dfa40-118">Interlaced Video and the Encoder</span></span>

<span data-ttu-id="dfa40-119">A primeira etapa na codificação de vídeo com entrelaçamento mantido é configurar o codificador para codificar campos entrelaçados.</span><span class="sxs-lookup"><span data-stu-id="dfa40-119">The first step in encoding video with maintained interlacing is to configure the encoder to encode interlaced fields.</span></span> <span data-ttu-id="dfa40-120">Para fazer isso, defina a propriedade [MFPKEY \_ INTERLACEDCODINGENABLED](mfpkey-interlacedcodingenabledproperty.md) como **true**.</span><span class="sxs-lookup"><span data-stu-id="dfa40-120">To do this, set the [MFPKEY\_INTERLACEDCODINGENABLED](mfpkey-interlacedcodingenabledproperty.md) property to **TRUE**.</span></span> <span data-ttu-id="dfa40-121">Isso prepara o codificador para receber amostras entrelaçadas.</span><span class="sxs-lookup"><span data-stu-id="dfa40-121">This prepares the encoder to receive interlaced samples.</span></span> <span data-ttu-id="dfa40-122">Cada amostra de entrada deve conter ambos os campos.</span><span class="sxs-lookup"><span data-stu-id="dfa40-122">Each input sample must contain both fields.</span></span>

<span data-ttu-id="dfa40-123">Cada exemplo que você processa com o codificador após a ativação da codificação entrelaçada deve ter uma extensão de unidade de dados anexada.</span><span class="sxs-lookup"><span data-stu-id="dfa40-123">Each sample that you process with the encoder after activating interlaced encoding should have a data unit extension attached.</span></span> <span data-ttu-id="dfa40-124">Os exemplos sem a extensão de unidade de dados esperada são considerados progressivos.</span><span class="sxs-lookup"><span data-stu-id="dfa40-124">Samples without the expected data unit extension are assumed to be progressive.</span></span> <span data-ttu-id="dfa40-125">O GUID que identifica a extensão é D590DC20-07BC-436C-9CF7-F3BBFBF1A4DC.</span><span class="sxs-lookup"><span data-stu-id="dfa40-125">The GUID identifying the extension is D590DC20-07BC-436C-9CF7-F3BBFBF1A4DC.</span></span> <span data-ttu-id="dfa40-126">Os valores passados pelos objetos do Windows Media Format SDK são definidos na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="dfa40-126">The values passed by the objects of the Windows Media Format SDK are defined in the following table.</span></span>



| <span data-ttu-id="dfa40-127">Valor</span><span class="sxs-lookup"><span data-stu-id="dfa40-127">Value</span></span>      | <span data-ttu-id="dfa40-128">Descrição</span><span class="sxs-lookup"><span data-stu-id="dfa40-128">Description</span></span>                                                                                                                              |
|------------|------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="dfa40-129">0x00000020</span><span class="sxs-lookup"><span data-stu-id="dfa40-129">0x00000020</span></span> | <span data-ttu-id="dfa40-130">Especifica que o exemplo é codificado primeiro com o campo inferior.</span><span class="sxs-lookup"><span data-stu-id="dfa40-130">Specifies that the sample is encoded with the bottom field first.</span></span> <span data-ttu-id="dfa40-131">Esse valor só é significativo quando combinado com o valor entrelaçado.</span><span class="sxs-lookup"><span data-stu-id="dfa40-131">This value is only meaningful when combined with the interlaced value.</span></span> |
| <span data-ttu-id="dfa40-132">0x00000040</span><span class="sxs-lookup"><span data-stu-id="dfa40-132">0x00000040</span></span> | <span data-ttu-id="dfa40-133">Especifica que o exemplo é codificado primeiro com o campo superior.</span><span class="sxs-lookup"><span data-stu-id="dfa40-133">Specifies that the sample is encoded with the top field first.</span></span> <span data-ttu-id="dfa40-134">Esse valor só é significativo quando combinado com o valor entrelaçado.</span><span class="sxs-lookup"><span data-stu-id="dfa40-134">This value is only meaningful when combined with the interlaced value.</span></span>    |
| <span data-ttu-id="dfa40-135">0x00000080</span><span class="sxs-lookup"><span data-stu-id="dfa40-135">0x00000080</span></span> | <span data-ttu-id="dfa40-136">Especifica que o exemplo é entrelaçado.</span><span class="sxs-lookup"><span data-stu-id="dfa40-136">Specifies that the sample is interlaced.</span></span> <span data-ttu-id="dfa40-137">Esse é o único valor que é significativo para o codec DMOs.</span><span class="sxs-lookup"><span data-stu-id="dfa40-137">This is the only value that is meaningful to the codec DMOs.</span></span>                                    |



 

<span data-ttu-id="dfa40-138">Um dos dois primeiros valores é sempre combinado com 0x80 usando um OR bit a bit **ou** antes de ser definido no exemplo.</span><span class="sxs-lookup"><span data-stu-id="dfa40-138">One of the first two values is always combined with 0x80 using a bitwise **OR** before being set on the sample.</span></span> <span data-ttu-id="dfa40-139">No entanto, o codificador verifica apenas 0x80 e ignora o restante da extensão.</span><span class="sxs-lookup"><span data-stu-id="dfa40-139">However, the encoder only checks for 0x80 and disregards the rest of the extension.</span></span> <span data-ttu-id="dfa40-140">Se a extensão identificar o exemplo como entrelaçado, o codificador manterá o entrelaçamento de exemplo no fluxo compactado e inserirá um sinalizador de indicação no fluxo para que o decodificador possa identificar quadros entrelaçados.</span><span class="sxs-lookup"><span data-stu-id="dfa40-140">If the extension identifies the sample as interlaced, the encoder maintains the sample interlacing in the compressed stream, and embeds an indication flag in the stream so that the decoder can identify interlaced frames.</span></span> <span data-ttu-id="dfa40-141">Cada amostra entrelaçada é marcada, de modo que o conteúdo de origem que é uma mistura progressiva e entrelaçada pode ser codificado em um fluxo em conjunto.</span><span class="sxs-lookup"><span data-stu-id="dfa40-141">Each interlaced sample is marked, so that source content that is a mix of progressive and interlaced can be encoded into a stream together.</span></span>

<span data-ttu-id="dfa40-142">O objeto gravador do SDK do Windows Media Format inclui as extensões de unidade de dados do tipo de conteúdo nos exemplos que ele grava na seção de dados do contêiner do ASF para uso no momento da renderização.</span><span class="sxs-lookup"><span data-stu-id="dfa40-142">The Windows Media Format SDK writer object includes the content type data unit extensions in the samples that it writes to the data section of the ASF container for use at the time of rendering.</span></span>

## <a name="reading-and-rendering-interlaced-video"></a><span data-ttu-id="dfa40-143">Leitura e renderização de vídeo entrelaçado</span><span class="sxs-lookup"><span data-stu-id="dfa40-143">Reading and Rendering Interlaced Video</span></span>

<span data-ttu-id="dfa40-144">O decodificador identifica amostras entrelaçadas com base no sinalizador definido no fluxo pelo codificador.</span><span class="sxs-lookup"><span data-stu-id="dfa40-144">The decoder identifies interlaced samples based on the flag set in the stream by the encoder.</span></span> <span data-ttu-id="dfa40-145">Como padrão, o decodificador Desentrelaça os exemplos e entrega saídas progressivas.</span><span class="sxs-lookup"><span data-stu-id="dfa40-145">As a default, the decoder deinterlaces the samples and delivers progressive outputs.</span></span> <span data-ttu-id="dfa40-146">O aplicativo de player pode configurar o decodificador para processar as saídas com o entrelaçamento mantido, definindo a propriedade de [ \_ \_ desentrelaçamento de deMFPKEY de decodificação](mfpkey-decoder-deinterlacingproperty.md) .</span><span class="sxs-lookup"><span data-stu-id="dfa40-146">The player application can configure the decoder to process outputs with interlacing maintained by setting the [MFPKEY\_DECODER\_DEINTERLACING](mfpkey-decoder-deinterlacingproperty.md) property.</span></span>

<span data-ttu-id="dfa40-147">A dificuldade na reprodução de vídeo entrelaçado surge depois que o decodificador entrega os exemplos.</span><span class="sxs-lookup"><span data-stu-id="dfa40-147">The difficulty in interlaced video playback arises after the decoder delivers the samples.</span></span> <span data-ttu-id="dfa40-148">O processador (placa de vídeo ou chip em um dispositivo) não pode exibir corretamente o conteúdo do vídeo sem saber qual campo é.</span><span class="sxs-lookup"><span data-stu-id="dfa40-148">The renderer (video card or chip in a device) cannot properly display the video content without knowing which field is which.</span></span> <span data-ttu-id="dfa40-149">Em aplicativos que usam o Windows Media Format SDK, a extensão de unidade de dados de tipo de conteúdo é recuperada de amostras não compactadas e pode ser passada para o dispositivo.</span><span class="sxs-lookup"><span data-stu-id="dfa40-149">In applications using the Windows Media Format SDK, the content type data unit extension is retrieved from the uncompressed samples, and can be passed to the device.</span></span>

<span data-ttu-id="dfa40-150">Ao usar os objetos de codec diretamente, nenhuma dessas transferências de dados é automática.</span><span class="sxs-lookup"><span data-stu-id="dfa40-150">When using the codec objects directly, none of this data transfer is automatic.</span></span> <span data-ttu-id="dfa40-151">Você deve implementar o suporte de extensão de unidade de dados, tanto em seus objetos de buffer quanto no contêiner que você usa para o conteúdo codificado.</span><span class="sxs-lookup"><span data-stu-id="dfa40-151">You must implement data-unit-extension support, both in your buffer objects and in the container that you use for your encoded content.</span></span> <span data-ttu-id="dfa40-152">Os tipos mais comuns de contêineres de mídia (como AVI) não oferecem suporte a metadados de nível de exemplo.</span><span class="sxs-lookup"><span data-stu-id="dfa40-152">Most common types of media containers (like AVI) do not support sample-level metadata.</span></span> <span data-ttu-id="dfa40-153">Você pode implementar seu próprio sistema para armazenar os dados no arquivo e associá-los a exemplos individuais, mas apenas um leitor personalizado poderá recuperá-lo.</span><span class="sxs-lookup"><span data-stu-id="dfa40-153">You can implement your own system to store the data in the file and associate it with individual samples, but only a customized reader would be able to retrieve it.</span></span>

> [!Note]  
> <span data-ttu-id="dfa40-154">Definir a propriedade [MFPKEY \_ INTERLACEDCODINGENABLED](mfpkey-interlacedcodingenabledproperty.md) como **true** e, em seguida, não enviar quaisquer amostras com a extensão de unidade de dados de tipo de conteúdo anexada pode fazer com que o codificador falhe.</span><span class="sxs-lookup"><span data-stu-id="dfa40-154">Setting the [MFPKEY\_INTERLACEDCODINGENABLED](mfpkey-interlacedcodingenabledproperty.md) property to **TRUE**, and then not sending any samples with the content-type data-unit extension attached can cause the encoder to crash.</span></span> <span data-ttu-id="dfa40-155">Defina o codificador para codificação entrelaçada somente se você tiver amostras entrelaçadas a serem entregues.</span><span class="sxs-lookup"><span data-stu-id="dfa40-155">Set the encoder for interlaced encoding only if you have interlaced samples to deliver.</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="dfa40-156">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="dfa40-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="dfa40-157">Trabalhando com vídeo</span><span class="sxs-lookup"><span data-stu-id="dfa40-157">Working with Video</span></span>](workingwithvideo.md)
</dt> </dl>

 

 



