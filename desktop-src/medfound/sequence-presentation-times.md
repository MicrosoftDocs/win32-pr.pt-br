---
description: Este tópico descreve como a origem do sequenciador lida com os tempos de apresentação durante a reprodução.
ms.assetid: 0d095e25-5ccf-4319-8767-07b417ed7ee8
title: Tempos de apresentação da sequência
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d17f5b0ff4bd6f0cfee2b1b461d6fbd11bdbf0fb
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104502250"
---
# <a name="sequence-presentation-times"></a><span data-ttu-id="a58c2-103">Tempos de apresentação da sequência</span><span class="sxs-lookup"><span data-stu-id="a58c2-103">Sequence Presentation Times</span></span>

<span data-ttu-id="a58c2-104">Este tópico descreve como a [origem do sequenciador](sequencer-source.md) lida com os tempos de apresentação durante a reprodução.</span><span class="sxs-lookup"><span data-stu-id="a58c2-104">This topic describes how the [Sequencer Source](sequencer-source.md) handles presentation times during playback.</span></span>

## <a name="overview"></a><span data-ttu-id="a58c2-105">Visão geral</span><span class="sxs-lookup"><span data-stu-id="a58c2-105">Overview</span></span>

<span data-ttu-id="a58c2-106">A origem do sequenciador dá suporte a dois modos diferentes: sequências de playlist e sequências de edição.</span><span class="sxs-lookup"><span data-stu-id="a58c2-106">The sequencer source supports two different modes: playlist sequences and editing sequences.</span></span>

<span data-ttu-id="a58c2-107">Em uma sequência de edição, o aplicativo especifica a duração de cada segmento com antecedência, antes de iniciar a reprodução.</span><span class="sxs-lookup"><span data-stu-id="a58c2-107">In an editing sequence, the application specifies the duration of each segment in advance, before starting playback.</span></span> <span data-ttu-id="a58c2-108">Em uma sequência de playlist, o aplicativo não especifica a duração antecipadamente.</span><span class="sxs-lookup"><span data-stu-id="a58c2-108">In a playlist sequence, the application does not specify the duration in advance.</span></span> <span data-ttu-id="a58c2-109">(Na verdade, a duração pode não ser conhecida.)</span><span class="sxs-lookup"><span data-stu-id="a58c2-109">(In fact, the duration might not be known.)</span></span>

<span data-ttu-id="a58c2-110">Em ambos os casos, você pode especificar a hora de início e de parada de mídia de um segmento.</span><span class="sxs-lookup"><span data-stu-id="a58c2-110">In both cases, you can specify a segment's media start and media stop time.</span></span> <span data-ttu-id="a58c2-111">Essas vezes especificam a posição no arquivo de origem onde o segmento começa e termina.</span><span class="sxs-lookup"><span data-stu-id="a58c2-111">These times specify the position in the source file where the segment begins and ends.</span></span> <span data-ttu-id="a58c2-112">Por exemplo, suponha que o arquivo de origem tenha 90 segundos de comprimento.</span><span class="sxs-lookup"><span data-stu-id="a58c2-112">For example, suppose that the source file is 90 seconds long.</span></span> <span data-ttu-id="a58c2-113">Se você quisesse cortar os primeiros 10 segundos e os últimos 10 segundos, você especificaria os seguintes valores:</span><span class="sxs-lookup"><span data-stu-id="a58c2-113">If you wanted to trim the first 10 seconds and the last 10 seconds, you would specify the following values:</span></span>

-   <span data-ttu-id="a58c2-114">Início da mídia: 10 segundos</span><span class="sxs-lookup"><span data-stu-id="a58c2-114">Media start: 10 seconds</span></span>
-   <span data-ttu-id="a58c2-115">Parada de mídia: 80 segundos</span><span class="sxs-lookup"><span data-stu-id="a58c2-115">Media stop: 80 seconds</span></span>

<span data-ttu-id="a58c2-116">Para especificar a hora de início da mídia, defina o atributo [MF \_ TOPONODE \_ MEDIASTART](mf-toponode-mediastart-attribute.md) no nó de origem.</span><span class="sxs-lookup"><span data-stu-id="a58c2-116">To specify the media start time, set the [MF\_TOPONODE\_MEDIASTART](mf-toponode-mediastart-attribute.md) attribute on the source node.</span></span> <span data-ttu-id="a58c2-117">Para especificar a hora de parada da mídia, defina o atributo [MF \_ TOPONODE \_ MEDIASTOP](mf-toponode-mediastop-attribute.md) no nó de origem.</span><span class="sxs-lookup"><span data-stu-id="a58c2-117">To specify the media stop time, set the [MF\_TOPONODE\_MEDIASTOP](mf-toponode-mediastop-attribute.md) attribute on the source node.</span></span>

<span data-ttu-id="a58c2-118">Para criar uma sequência de edição, defina o atributo [ \_ \_ \_ tempo global de sessão MF](mf-session-global-time-attribute.md) ao criar a sessão de mídia.</span><span class="sxs-lookup"><span data-stu-id="a58c2-118">To create an editing sequence, set the [MF\_SESSION\_GLOBAL\_TIME](mf-session-global-time-attribute.md) attribute when you create the Media Session.</span></span> <span data-ttu-id="a58c2-119">Caso contrário, a sessão de mídia espera sequências de playlist.</span><span class="sxs-lookup"><span data-stu-id="a58c2-119">Otherwise, the Media Session expects playlist sequences.</span></span> <span data-ttu-id="a58c2-120">Em uma sequência de edição, cada topologia de segmento deve ter o atributo [ \_ \_ PROJECTSTART de topologia MF](mf-topology-projectstart-attribute.md) e o atributo [ \_ \_ PROJECTSTOP de topologia MF](mf-topology-projectstop-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="a58c2-120">In an editing sequence, every segment topology must have the [MF\_TOPOLOGY\_PROJECTSTART](mf-topology-projectstart-attribute.md) attribute and the [MF\_TOPOLOGY\_PROJECTSTOP](mf-topology-projectstop-attribute.md) attribute.</span></span>

## <a name="playlist-sequences"></a><span data-ttu-id="a58c2-121">Sequências de playlist</span><span class="sxs-lookup"><span data-stu-id="a58c2-121">Playlist Sequences</span></span>

<span data-ttu-id="a58c2-122">Em uma sequência de playlist, o relógio de apresentação começa em zero e continua em limites de segmento.</span><span class="sxs-lookup"><span data-stu-id="a58c2-122">In a playlist sequence, the presentation clock starts at zero and continues across segment boundaries.</span></span> <span data-ttu-id="a58c2-123">As fontes nativas entregam amostras com carimbos de data/hora iguais ao tempo de mídia.</span><span class="sxs-lookup"><span data-stu-id="a58c2-123">The native sources deliver samples with time stamps equal to the media time.</span></span> <span data-ttu-id="a58c2-124">O pipeline converte os carimbos de data/hora para o horário de apresentação correto da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="a58c2-124">The pipeline converts the time stamps to the correct presentation time as follows:</span></span>

-   <span data-ttu-id="a58c2-125">Novo carimbo de data/hora = tempo de mídia + deslocamento − início da mídia</span><span class="sxs-lookup"><span data-stu-id="a58c2-125">New time stamp = media time + offset − media start</span></span>

<span data-ttu-id="a58c2-126">O valor de *offset* é a hora da apresentação na qual o segmento anterior terminou.</span><span class="sxs-lookup"><span data-stu-id="a58c2-126">The value of *offset* is the presentation time at which the previous segment ended.</span></span> <span data-ttu-id="a58c2-127">Para o primeiro segmento, o deslocamento é zero.</span><span class="sxs-lookup"><span data-stu-id="a58c2-127">For the first segment, the offset is zero.</span></span> <span data-ttu-id="a58c2-128">Aqui estão dois exemplos de como essas conversões de carimbo de data/hora são calculadas:</span><span class="sxs-lookup"><span data-stu-id="a58c2-128">Here are two examples of how these time-stamp conversions are calculated:</span></span>

-   <span data-ttu-id="a58c2-129">Exemplo 1: Suponha que o primeiro segmento (S1) tenha 10 segundos de comprimento e o segundo segmento (S2) tenha uma hora de início de mídia igual a zero.</span><span class="sxs-lookup"><span data-stu-id="a58c2-129">Example 1: Suppose the first segment (S1) is 10 seconds long, and the second segment (S2) has a media start time of zero.</span></span> <span data-ttu-id="a58c2-130">A origem nativa usa o tempo de mídia para seus carimbos de data/hora, portanto, a primeira amostra de S2 tem um carimbo de data/hora igual a zero.</span><span class="sxs-lookup"><span data-stu-id="a58c2-130">The native source uses the media time for its time stamps, so the first sample from S2 has a time stamp of zero.</span></span> <span data-ttu-id="a58c2-131">O deslocamento é de 10 segundos (a duração de S1), portanto, o carimbo de data/hora ajustado é: 0 + 10 − 0 = 10 segundos.</span><span class="sxs-lookup"><span data-stu-id="a58c2-131">The offset is 10 seconds (the duration of S1), so the adjusted time stamp is:0 + 10 − 0 = 10 seconds.</span></span>
-   <span data-ttu-id="a58c2-132">Exemplo 2: Suponha que o segmento S1 seja de 10 segundos e S2 tenha uma hora de início da mídia de 5 segundos.</span><span class="sxs-lookup"><span data-stu-id="a58c2-132">Example 2: Suppose segment S1 is 10 seconds long, and S2 has a media start time of 5 seconds.</span></span> <span data-ttu-id="a58c2-133">A primeira amostra de S2 tem um carimbo de data/hora de 5 segundos (tempo de mídia).</span><span class="sxs-lookup"><span data-stu-id="a58c2-133">The first sample from S2 has a time stamp of 5 seconds (media time).</span></span> <span data-ttu-id="a58c2-134">O deslocamento é de 10 segundos, portanto, o carimbo de data/hora ajustado é: 5 + 10 − 5 = 10 segundos.</span><span class="sxs-lookup"><span data-stu-id="a58c2-134">The offset is 10 seconds, so the adjusted time stamp is:5 + 10 − 5 = 10 seconds.</span></span>

<span data-ttu-id="a58c2-135">Todos os componentes de pipeline downstream dos nós de origem recebem exemplos com os carimbos de data/hora ajustados.</span><span class="sxs-lookup"><span data-stu-id="a58c2-135">All pipeline components downstream from the source nodes receive samples with the adjusted time stamps.</span></span> <span data-ttu-id="a58c2-136">Os nós de origem em uma topologia podem ter horários de início de mídia diferentes, portanto, os ajustes são calculados separadamente para cada ramificação da topologia.</span><span class="sxs-lookup"><span data-stu-id="a58c2-136">The source nodes in a topology can have different media start times, so the adjustments are calculated separately for each branch of the topology.</span></span>

<span data-ttu-id="a58c2-137">Quando a apresentação muda para o próximo segmento, o relógio de apresentação não é interrompido ou redefinido, e o tempo de apresentação aumenta de forma monotônico.</span><span class="sxs-lookup"><span data-stu-id="a58c2-137">When the presentation switches to the next segment, the presentation clock does not stop or reset, and the presentation time increases monotonically.</span></span> <span data-ttu-id="a58c2-138">Antes do início de um novo segmento, a sessão de mídia envia ao aplicativo um evento [MESessionNotifyPresentationTime](mesessionnotifypresentationtime.md) .</span><span class="sxs-lookup"><span data-stu-id="a58c2-138">Before a new segment starts, the Media Session sends the application an [MESessionNotifyPresentationTime](mesessionnotifypresentationtime.md) event.</span></span> <span data-ttu-id="a58c2-139">O evento especifica a hora de início do segmento, em relação ao relógio de apresentação e o valor do deslocamento.</span><span class="sxs-lookup"><span data-stu-id="a58c2-139">The event specifies the starting time of the segment, relative to the presentation clock, and the value of the offset.</span></span> <span data-ttu-id="a58c2-140">Quando um novo segmento é iniciado, o pipeline chama o [**início**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasource-start) na origem do sequenciador com o valor VT \_ vazio.</span><span class="sxs-lookup"><span data-stu-id="a58c2-140">When a new segment starts, the pipeline calls [**Start**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasource-start) on the sequencer source with the value VT\_EMPTY.</span></span> <span data-ttu-id="a58c2-141">A origem do sequenciador envia um evento [MESourceStarted](mesourcestarted.md) sem hora de início.</span><span class="sxs-lookup"><span data-stu-id="a58c2-141">The sequencer source sends an [MESourceStarted](mesourcestarted.md) event with no start time.</span></span>

<span data-ttu-id="a58c2-142">Para buscar, o aplicativo especifica um identificador de segmento mais um deslocamento de tempo dentro do segmento.</span><span class="sxs-lookup"><span data-stu-id="a58c2-142">To seek, the application specifies a segment identifier plus a time offset within the segment.</span></span> <span data-ttu-id="a58c2-143">Após a busca, o relógio de apresentação começa no deslocamento do *segmento* .</span><span class="sxs-lookup"><span data-stu-id="a58c2-143">After the seek, the presentation clock starts at the *segment* offset.</span></span> <span data-ttu-id="a58c2-144">Veja um exemplo de como esse processo funciona:</span><span class="sxs-lookup"><span data-stu-id="a58c2-144">Here is an example of how that process works:</span></span>

-   <span data-ttu-id="a58c2-145">Exemplo 3: o aplicativo busca segmentar S3, com um deslocamento de segmento de 10 segundos.</span><span class="sxs-lookup"><span data-stu-id="a58c2-145">Example 3: The application seeks to segment S3, with a segment offset of 10 seconds.</span></span> <span data-ttu-id="a58c2-146">O relógio de apresentação começa em 10 segundos (o deslocamento de segmento).</span><span class="sxs-lookup"><span data-stu-id="a58c2-146">The presentation clock starts at 10 seconds (the segment offset).</span></span> <span data-ttu-id="a58c2-147">O deslocamento não inclui a duração dos segmentos S1 e S2.</span><span class="sxs-lookup"><span data-stu-id="a58c2-147">The offset does not include the duration of segments S1 and S2.</span></span> <span data-ttu-id="a58c2-148">A origem do sequenciador envia um evento [MESourceStarted](mesourcestarted.md) com uma hora de início igual ao deslocamento do segmento, 10 segundos.</span><span class="sxs-lookup"><span data-stu-id="a58c2-148">The sequencer source sends an [MESourceStarted](mesourcestarted.md) event with a start time equal to the segment offset, 10 seconds.</span></span>

<span data-ttu-id="a58c2-149">Após uma busca, se a reprodução continuar para o próximo segmento, a transição funcionará da mesma forma que os exemplos anteriores, exceto pelo fato de que o deslocamento não inclui os segmentos ignorados.</span><span class="sxs-lookup"><span data-stu-id="a58c2-149">After a seek, if playback continues to the next segment, the transition works just like the previous examples, except that the offset does not include the skipped segments.</span></span>

<span data-ttu-id="a58c2-150">Aqui estão alguns detalhes adicionais que afetam como os exemplos são carimbados por tempo:</span><span class="sxs-lookup"><span data-stu-id="a58c2-150">Here are some further details that affect how samples are time stamped:</span></span>

-   <span data-ttu-id="a58c2-151">Os decodificadores podem precisar de dados além da hora de parada da mídia.</span><span class="sxs-lookup"><span data-stu-id="a58c2-151">Decoders may need data beyond the media stop time.</span></span> <span data-ttu-id="a58c2-152">O pipeline recebe o máximo de dados da origem que o decodificador requer e, em seguida, corta os exemplos de saída do decodificador.</span><span class="sxs-lookup"><span data-stu-id="a58c2-152">The pipeline pulls as much data from the source as the decoder requires, and then trims the decoder's output samples.</span></span>
-   <span data-ttu-id="a58c2-153">As transformações podem armazenar dados em buffer.</span><span class="sxs-lookup"><span data-stu-id="a58c2-153">Transforms might buffer data.</span></span> <span data-ttu-id="a58c2-154">Por exemplo, um efeito de áudio pode precisar fazer isso.</span><span class="sxs-lookup"><span data-stu-id="a58c2-154">For example, an audio effect might need to do this.</span></span> <span data-ttu-id="a58c2-155">Quando um segmento termina, o carimbo de data/hora na última amostra da transformação é anterior ao final do segmento, porque a transformação está revertendo alguns dados.</span><span class="sxs-lookup"><span data-stu-id="a58c2-155">When a segment ends, the time stamp on the last sample from the transform is earlier than the end of the segment, because the transform is holding back some data.</span></span> <span data-ttu-id="a58c2-156">Quando o próximo segmento é iniciado, o carimbo de data/hora no primeiro exemplo é ligeiramente anterior ao início do segmento.</span><span class="sxs-lookup"><span data-stu-id="a58c2-156">When the next segment starts, the time stamp on the first sample is slightly earlier than the start of the segment.</span></span> <span data-ttu-id="a58c2-157">Não há nenhum intervalo nos carimbos de data/hora, portanto, os dados que atingem o coletor de mídia são contínuos.</span><span class="sxs-lookup"><span data-stu-id="a58c2-157">There is no gap in the time stamps, so the data that reaches the media sink is continuous.</span></span> <span data-ttu-id="a58c2-158">Quando o segmento final termina, o pipeline esvazia a transformação, portanto, nenhum dado é perdido.</span><span class="sxs-lookup"><span data-stu-id="a58c2-158">When the final segment ends, the pipeline drains the transform, so no data is lost.</span></span>
-   <span data-ttu-id="a58c2-159">A fonte pode precisar iniciar um pouco antes da hora de início da mídia para selecionar o quadro-chave anterior.</span><span class="sxs-lookup"><span data-stu-id="a58c2-159">The source may need to start slightly earlier than the media start time, to pick up the previous key frame.</span></span> <span data-ttu-id="a58c2-160">Portanto, após o ajuste, o primeiro exemplo pode ter um tempo de apresentação negativo.</span><span class="sxs-lookup"><span data-stu-id="a58c2-160">Therefore, after the adjustment, the first sample might have a negative presentation time.</span></span>

## <a name="editing-sequences"></a><span data-ttu-id="a58c2-161">Sequências de edição</span><span class="sxs-lookup"><span data-stu-id="a58c2-161">Editing Sequences</span></span>

<span data-ttu-id="a58c2-162">Em uma sequência de edição, o aplicativo especifica os limites de segmento antecipadamente, definindo os atributos de topologia [**MF \_ \_ PROJECTSTART**](mf-topology-projectstart-attribute.md) e [**MF Topology \_ \_ PROJECTSTOP**](mf-topology-projectstop-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="a58c2-162">In an editing sequence, the application specifies the segment boundaries in advance, by setting the [**MF\_TOPOLOGY\_PROJECTSTART**](mf-topology-projectstart-attribute.md) and [**MF\_TOPOLOGY\_PROJECTSTOP**](mf-topology-projectstop-attribute.md) attributes.</span></span> <span data-ttu-id="a58c2-163">O pipeline calcula os ajustes para os carimbos de data/hora quase da mesma maneira que para uma sequência de playlist:</span><span class="sxs-lookup"><span data-stu-id="a58c2-163">The pipeline calculates adjustments for the time stamps in almost the same way as for a playlist sequence:</span></span>

-   <span data-ttu-id="a58c2-164">Para o deslocamento, ele usa o valor de [**\_ \_ PROJECTSTART de topologia MF**](mf-topology-projectstart-attribute.md), em vez de usar a extremidade observada do segmento.</span><span class="sxs-lookup"><span data-stu-id="a58c2-164">For the offset, it uses the value of [**MF\_TOPOLOGY\_PROJECTSTART**](mf-topology-projectstart-attribute.md), instead of using the observed end of the segment.</span></span>

-   <span data-ttu-id="a58c2-165">Para procurar, o deslocamento usa um valor igual ao valor de [**PROJECTSTART da \_ topologia \_ MF**](mf-topology-projectstart-attribute.md) do segmento mais o deslocamento do segmento.</span><span class="sxs-lookup"><span data-stu-id="a58c2-165">For seeking, the offset uses a value equal to the segment's [**MF\_TOPOLOGY\_PROJECTSTART**](mf-topology-projectstart-attribute.md) value plus the segment offset.</span></span>

<span data-ttu-id="a58c2-166">Portanto, o tempo de apresentação em uma sequência de edição é sempre relativo ao início da apresentação, mesmo se o aplicativo busca outro segmento.</span><span class="sxs-lookup"><span data-stu-id="a58c2-166">Therefore, the presentation time in an editing sequence is always relative to the start of the presentation, even if the application seeks to another segment.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a58c2-167">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="a58c2-167">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a58c2-168">Sessão de mídia</span><span class="sxs-lookup"><span data-stu-id="a58c2-168">Media Session</span></span>](media-session.md)
</dt> <dt>

[<span data-ttu-id="a58c2-169">Origem do sequenciador</span><span class="sxs-lookup"><span data-stu-id="a58c2-169">Sequencer Source</span></span>](sequencer-source.md)
</dt> </dl>

 

 



