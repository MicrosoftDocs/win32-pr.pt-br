---
description: Este artigo contém diretrizes gerais para usar as APIs de vídeo do Direct3D 12.
ms.assetid: ''
title: Visão geral em vídeo do Direct3D 12
ms.topic: article
ms.date: 06/03/2019
ms.openlocfilehash: b21587f2784b34131da9c050655b6f3fbe43582d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104501178"
---
# <a name="direct3d-12-video-overview"></a><span data-ttu-id="4b7e5-103">Visão geral em vídeo do Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="4b7e5-103">Direct3D 12 Video Overview</span></span>

<span data-ttu-id="4b7e5-104">Este artigo contém diretrizes gerais para usar as APIs de vídeo do Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-104">This article contains general guidance for using the Direct3D 12 video APIs.</span></span>

## <a name="about-direct3d-12-video"></a><span data-ttu-id="4b7e5-105">Sobre o vídeo do Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="4b7e5-105">About Direct3D 12 Video</span></span>

<span data-ttu-id="4b7e5-106">A interface de vídeo do Direct3D 12 fornece uma nova maneira para que os aplicativos implementem a decodificação e o processo de vídeo.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-106">The Direct3D 12 video interface provides a new way for apps to implement video decoding and process.</span></span> <span data-ttu-id="4b7e5-107">A interface do Direct3D 12 é diferente da interface anterior do Direct3D 11 porque foi projetada para ser consistente com os princípios e o estilo do Direct3D 12, que inclui o seguinte:</span><span class="sxs-lookup"><span data-stu-id="4b7e5-107">The Direct3D 12 interface is different from the previous Direct3D 11 interface because it was designed to be consistent with the Direct3D 12 principles and style, which includes the following:</span></span>

- <span data-ttu-id="4b7e5-108">Fornecer aos desenvolvedores mais controle</span><span class="sxs-lookup"><span data-stu-id="4b7e5-108">Give developers more control</span></span>
 - <span data-ttu-id="4b7e5-109">Alocação de memória acessível por hardware</span><span class="sxs-lookup"><span data-stu-id="4b7e5-109">Allocation of hardware-accessible memory</span></span>
 - <span data-ttu-id="4b7e5-110">Threads de CPU usados para gerar & comandos de envio</span><span class="sxs-lookup"><span data-stu-id="4b7e5-110">CPU threads used to generate & submit commands</span></span>
   - <span data-ttu-id="4b7e5-111">Geração e envio independentes</span><span class="sxs-lookup"><span data-stu-id="4b7e5-111">Independent generation and submission</span></span>
   - <span data-ttu-id="4b7e5-112">Sem bloqueio</span><span class="sxs-lookup"><span data-stu-id="4b7e5-112">Non-blocking</span></span>
 - <span data-ttu-id="4b7e5-113">Agendamento de trabalho de hardware</span><span class="sxs-lookup"><span data-stu-id="4b7e5-113">Scheduling of hardware work</span></span>
- <span data-ttu-id="4b7e5-114">Aborda a funcionalidade existente, incluindo a maioria das funcionalidades de vídeo do Direct3D 11, mas, ao mesmo tempo, mantém a simplicidade e a facilidade de uso em mente</span><span class="sxs-lookup"><span data-stu-id="4b7e5-114">Covers existing functionality, including most Direct3D 11 video functionality, but at the same time, keeps simplicity and ease of use in mind</span></span>
- <span data-ttu-id="4b7e5-115">Potência e desempenho dos principais aplicativos do Direct3D 12 iguais ou melhores que o Direct3D 11</span><span class="sxs-lookup"><span data-stu-id="4b7e5-115">Power and performance of main Direct3D 12 applications equal to or better than Direct3D 11</span></span>
- <span data-ttu-id="4b7e5-116">Consistência com outras APIs do Direct3D 12</span><span class="sxs-lookup"><span data-stu-id="4b7e5-116">Consistency with other Direct3D 12 APIs</span></span>
- <span data-ttu-id="4b7e5-117">Interoperabilidade com APIs de gráficos existentes</span><span class="sxs-lookup"><span data-stu-id="4b7e5-117">Interoperability with existing graphics APIs</span></span>


## <a name="video-decoding"></a><span data-ttu-id="4b7e5-118">Decodificação de vídeo</span><span class="sxs-lookup"><span data-stu-id="4b7e5-118">Video decoding</span></span>

<span data-ttu-id="4b7e5-119">As seções a seguir descrevem algumas das tarefas envolvidas na implementação da decodificação de vídeo do Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-119">The following sections describe some of the tasks involved in implementing Direct3D 12 video decoding.</span></span>

### <a name="query-for-decoding-capabilities"></a><span data-ttu-id="4b7e5-120">Consultar recursos de decodificação</span><span class="sxs-lookup"><span data-stu-id="4b7e5-120">Query for decoding capabilities</span></span>

<span data-ttu-id="4b7e5-121">Chame [ID3D12VideoDevice:: CheckFeatureSupport](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-checkfeaturesupport) para verificar os detalhes de suporte para operações de decodificação de vídeo do Direct3D 12.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-121">Call [ID3D12VideoDevice::CheckFeatureSupport](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-checkfeaturesupport) to check for the support details for Direct3D 12 video decoding operations.</span></span> <span data-ttu-id="4b7e5-122">Passe um valor da enumeração [D3D12_FEATURE_VIDEO](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_feature_video) para especificar o recurso para o qual você está solicitando informações de suporte.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-122">Pass a value from the [D3D12_FEATURE_VIDEO](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_feature_video) enumeration to specify the feature for which you are requesting support information.</span></span>

### <a name="create-the-video-decoder"></a><span data-ttu-id="4b7e5-123">Criar o decodificador de vídeo</span><span class="sxs-lookup"><span data-stu-id="4b7e5-123">Create the video decoder</span></span>

<span data-ttu-id="4b7e5-124">Chame [ID3D12VideoDevice:: CreateVideoDecoder](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideodecoder) para criar uma instância da interface [ID3D12VideoDecoder](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videodecoder) .</span><span class="sxs-lookup"><span data-stu-id="4b7e5-124">Call [ID3D12VideoDevice::CreateVideoDecoder](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideodecoder) to create an instance of the [ID3D12VideoDecoder](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videodecoder) interface.</span></span> <span data-ttu-id="4b7e5-125">O decodificador mantém o estado de uma sessão de decodificação, incluindo dados relacionados à referência, como vetores de movimento.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-125">The decoder holds state for a decode session, including reference-related data such as motion vectors.</span></span>  <span data-ttu-id="4b7e5-126">No caso de uma alteração de resolução ou de uma alteração [MaxDecodePictureBufferCount](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decoder_heap_desc) , o objeto decodificador é recriado.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-126">In the event of a resolution change or a [MaxDecodePictureBufferCount](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decoder_heap_desc) change, the decoder object is recreated.</span></span> <span data-ttu-id="4b7e5-127">A largura e a altura de decodificação especificam a resolução do fluxo nativo antes de qualquer escala.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-127">The decode width and height specify the native stream resolution before any scale.</span></span>  <span data-ttu-id="4b7e5-128">A contagem máxima de buffer de imagem de decodificação (DPB) especifica a contagem de DPB maior que pode ser usada sem recriar o decodificador de vídeo.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-128">The maximum Decode Picture Buffer (DPB) count specifies the largest DPB count that can be used without recreating the video decoder.</span></span>

<span data-ttu-id="4b7e5-129">O decodificador pode ser usado para gravar comandos de várias listas de comandos, mas só pode ser associado a uma lista de comandos por vez.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-129">The decoder may be used to record commands from multiple command lists, but may only be associated with one command list at a time.</span></span>  <span data-ttu-id="4b7e5-130">O aplicativo é responsável por sincronizar o acesso ao decodificador.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-130">The application is responsible for synchronizing access to the decoder.</span></span>

### <a name="create-the-video-decoder-heap"></a><span data-ttu-id="4b7e5-131">Criar o heap do decodificador de vídeo</span><span class="sxs-lookup"><span data-stu-id="4b7e5-131">Create the video decoder heap</span></span> 

<span data-ttu-id="4b7e5-132">Chame [ID3D12VideoDevice:: CreateVideoDecoderHeap](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideodecoderheap) para criar uma instância da interface [ID3D12VideoDecoderHeap](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videodecoderheap) .</span><span class="sxs-lookup"><span data-stu-id="4b7e5-132">Call [ID3D12VideoDevice::CreateVideoDecoderHeap](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideodecoderheap) to create an instance of the [ID3D12VideoDecoderHeap](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videodecoderheap) interface.</span></span> <span data-ttu-id="4b7e5-133">Este objeto contém os recursos e o estado do driver dependente de resolução.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-133">This object contains the resolution-dependent driver resources and state.</span></span>

### <a name="decoding-a-frame"></a><span data-ttu-id="4b7e5-134">Decodificando um quadro</span><span class="sxs-lookup"><span data-stu-id="4b7e5-134">Decoding a frame</span></span>

<span data-ttu-id="4b7e5-135">Todos os parâmetros de entrada e saída para as operações de processamento de vídeo são organizados em uma estrutura de parâmetro de entrada, [D3D12_VIDEO_DECODE_INPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_input_stream_arguments)e uma estrutura de parâmetro de saída, [D3D12_VIDEO_DECODE_OUTPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_output_stream_arguments).</span><span class="sxs-lookup"><span data-stu-id="4b7e5-135">All input and output parameters for the video processing operations are organized into an input parameter structure, [D3D12_VIDEO_DECODE_INPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_input_stream_arguments), and an output parameter structure, [D3D12_VIDEO_DECODE_OUTPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_output_stream_arguments).</span></span>
<span data-ttu-id="4b7e5-136">O aplicativo gerencia os quadros de referência e, como tal, precisa definir os quadros de referência para cada operação de decodificação.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-136">The application manages the reference frames, and as such, needs to set the reference frames for every decoding operation.</span></span>
<span data-ttu-id="4b7e5-137">Quando a lista de comandos for registrada corretamente, chame [ID3D12CommandQueue:: ExecuteCommandLists](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-executecommandlists) na fila de comandos de vídeo para enviar a decodificação de quadros para a GPU.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-137">When the command list is properly recorded, call [ID3D12CommandQueue::ExecuteCommandLists](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-executecommandlists) on the video command queue to submit the frame decoding to the GPU.</span></span>


### <a name="enabling-decoder-output-conversions"></a><span data-ttu-id="4b7e5-138">Habilitando conversões de saída de decodificador</span><span class="sxs-lookup"><span data-stu-id="4b7e5-138">Enabling decoder output conversions</span></span>
<span data-ttu-id="4b7e5-139">Se o decodificador der suporte à conversão, habilite as conversões desejadas preenchendo corretamente a estrutura de [D3D12_VIDEO_DECODE_CONVERSION_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_conversion_arguments) .</span><span class="sxs-lookup"><span data-stu-id="4b7e5-139">If the decoder supports conversion, then enable the desired conversions by properly filling the [D3D12_VIDEO_DECODE_CONVERSION_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_decode_conversion_arguments) structure.</span></span> <span data-ttu-id="4b7e5-140">O formato e as resoluções da saída desejada versus a saída nativa do decodificador são comunicados por meio da diferença no espaço de cores e nas resoluções especificadas nos parâmetros de conversão.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-140">The format and resolutions of the desired output versus the native output of the decoder are communicated via the difference in color space and resolutions specified in the conversion parameters.</span></span>

##  <a name="querying-decoding-status"></a><span data-ttu-id="4b7e5-141">Consultando o status de decodificação</span><span class="sxs-lookup"><span data-stu-id="4b7e5-141">Querying decoding status</span></span> 
<span data-ttu-id="4b7e5-142">Use os métodos [ID3D12VideoDecodeCommandList:: BeginQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-beginquery) e [ID3D12VideoDecodeCommandList:: endquery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-endquery) para consultar o status da operação de decodificação.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-142">Use the methods [ID3D12VideoDecodeCommandList::BeginQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-beginquery) and [ID3D12VideoDecodeCommandList::EndQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-endquery) to query the status of the decoding operation.</span></span>

<span data-ttu-id="4b7e5-143">A estrutura de [D3D12_QUERY_DATA_VIDEO_DECODE_STATISTICS](/windows/win32/api/d3d12video/ns-d3d12video-d3d12_query_data_video_decode_statistics) é usada para descrever as estatísticas de decodificação de vídeo.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-143">The [D3D12_QUERY_DATA_VIDEO_DECODE_STATISTICS](/windows/win32/api/d3d12video/ns-d3d12video-d3d12_query_data_video_decode_statistics) structure is used to describe video decode statistics.</span></span> <span data-ttu-id="4b7e5-144">Para obter uma instância dessa estrutura, chame [ID3D12VideoDecodeCommandList:: endquery](/windows/win32/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-endquery), passando o valor do tipo de consulta heap de [D3D12_QUERY_TYPE_VIDEO_DECODE_STATISTIC](/windows/win32/api/d3d12/ne-d3d12-d3d12_query_type).</span><span class="sxs-lookup"><span data-stu-id="4b7e5-144">To get an instance of this structure call [ID3D12VideoDecodeCommandList::EndQuery](/windows/win32/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-endquery), passing in the heap query type value of [D3D12_QUERY_TYPE_VIDEO_DECODE_STATISTIC](/windows/win32/api/d3d12/ne-d3d12-d3d12_query_type).</span></span> <span data-ttu-id="4b7e5-145">Observe que essa consulta não usa [ID3D12VideoDecodeCommandList:: BeginQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-beginquery).</span><span class="sxs-lookup"><span data-stu-id="4b7e5-145">Note that this query does not use [ID3D12VideoDecodeCommandList::BeginQuery](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodecodecommandlist-beginquery).</span></span>

## <a name="video-processing"></a><span data-ttu-id="4b7e5-146">Processamento de vídeo</span><span class="sxs-lookup"><span data-stu-id="4b7e5-146">Video processing</span></span>

<span data-ttu-id="4b7e5-147">As APIs de vídeo do Direct3D 12 adotam uma abordagem simplificada para o processamento de vídeo, eliminando os recursos do Direct3D 11 que não foram amplamente usados e removendo verificações de capacidade de recursos que são obrigatórios entre dispositivos.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-147">Direct3D 12 video APIs take a streamlined approach to video processing, eliminating features of Direct3D 11 that weren't widely used and removing capability checks for features that are mandatory across devices.</span></span> <span data-ttu-id="4b7e5-148">O processo de enumeração para processamento de vídeo é eliminado.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-148">The enumeration process for video processing is eliminated.</span></span> <span data-ttu-id="4b7e5-149">Em vez disso, chame [ID3D12VideoDevice:: CheckFeatureSupport](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-checkfeaturesupport) , que permite que um aplicativo identifique os recursos do processador de vídeo.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-149">Instead, call [ID3D12VideoDevice::CheckFeatureSupport](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-checkfeaturesupport) which allows an app to identify the capabilities of the video processor.</span></span> <span data-ttu-id="4b7e5-150">Os formatos de vídeo, entrelaçamento, estéreo e taxas desejados são fornecidos como entrada para **CheckFeatureSupport**.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-150">The desired video, interlace, stereo formats and rates are provided as as input to **CheckFeatureSupport**.</span></span>

### <a name="removed-capabilities"></a><span data-ttu-id="4b7e5-151">Recursos removidos</span><span class="sxs-lookup"><span data-stu-id="4b7e5-151">Removed capabilities</span></span>

<span data-ttu-id="4b7e5-152">Os seguintes recursos do Direct3D 11 não têm suporte no processamento de vídeo do Direct3D 12:</span><span class="sxs-lookup"><span data-stu-id="4b7e5-152">The following capabilities from Direct3D 11 are not supported in Direct3D 12 video processing:</span></span>
- <span data-ttu-id="4b7e5-153">Taxas personalizadas.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-153">Custom rates.</span></span>  <span data-ttu-id="4b7e5-154">Em vez disso, há uma taxa de entrada e saída fornecida durante a gravação do comando [ID3D12VideoProcessCommandList::P rocessframes](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist-processframes) .</span><span class="sxs-lookup"><span data-stu-id="4b7e5-154">Instead, there is an input and output rate given during the [ID3D12VideoProcessCommandList::ProcessFrames](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist-processframes) command recording.</span></span>
- <span data-ttu-id="4b7e5-155">Há apenas dois modos de desentrelaçamento disponíveis agora: [Bob](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_deinterlace_flags) e [personalizado](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_deinterlace_flags).</span><span class="sxs-lookup"><span data-stu-id="4b7e5-155">There are just two deinterlacing modes available now: [BOB](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_deinterlace_flags) and [CUSTOM](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_deinterlace_flags).</span></span> <span data-ttu-id="4b7e5-156">Outros modos foram eliminados.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-156">Other modes have been eliminated.</span></span> <span data-ttu-id="4b7e5-157">PERSONALIZADO é um modo de desentrelaçamento de alta qualidade fornecido pelo fornecedor de hardware.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-157">CUSTOM is a high-quality deinterlacing mode provided by the hardware vendor.</span></span>
- <span data-ttu-id="4b7e5-158">Não há mais suporte para todos os formatos estéreo opcionais no [D3D11_VIDEO_PROCESSOR_STEREO_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_stereo_caps) .</span><span class="sxs-lookup"><span data-stu-id="4b7e5-158">All of the optional stereo formats in [D3D11_VIDEO_PROCESSOR_STEREO_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_stereo_caps) are no longer supported.</span></span> <span data-ttu-id="4b7e5-159">Em vez disso, [nono](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), [horizontal](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), [vertical](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format)e [separado](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format) serão obrigatórios para todos os dispositivos de hardware se houver suporte para estéreo.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-159">Instead, [nono](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), [horizontal](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), [vertical](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format), and [separate](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_frame_stereo_format) are mandatory for all hardware devices if stereo is supported.</span></span>
- <span data-ttu-id="4b7e5-160">Não há nenhum equivalente para [D3D11_VIDEO_PROCESSOR_FORMAT_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_format_caps) ou [D3D11_VIDEO_PROCESSOR_AUTO_STREAM_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_auto_stream_caps).</span><span class="sxs-lookup"><span data-stu-id="4b7e5-160">There is no equivalent for [D3D11_VIDEO_PROCESSOR_FORMAT_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_format_caps) or [D3D11_VIDEO_PROCESSOR_AUTO_STREAM_CAPS](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_auto_stream_caps).</span></span> <span data-ttu-id="4b7e5-161">Em vez disso, os formatos de entrada e saída são argumentos para a criação do processador de vídeo e, nesse momento, deve ser conhecido se o processador de vídeo puder ou não executar a operação com o formato fornecido.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-161">Instead, input and output formats are arguments to the creation of the video processor, and at that time, it should be known if the video processor can or cannot perform the operation with the given format.</span></span> <span data-ttu-id="4b7e5-162">O [D3D12_VIDEO_PROCESS_AUTO_PROCESSING_FLAGS](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_auto_processing_flags) é usado para indicar se os recursos de processamento automático estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-162">The [D3D12_VIDEO_PROCESS_AUTO_PROCESSING_FLAGS](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_process_auto_processing_flags) is used to indicate if auto processing features are available.</span></span>
- <span data-ttu-id="4b7e5-163">Não há nenhum equivalente para [D3D11_VIDEO_PROCESSOR_CAPS_LEGACY](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_feature_caps).</span><span class="sxs-lookup"><span data-stu-id="4b7e5-163">There is no equivalent for [D3D11_VIDEO_PROCESSOR_CAPS_LEGACY](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_feature_caps).</span></span>
- <span data-ttu-id="4b7e5-164">Não há nenhum equivalente para [D3D11_VIDEO_PROCESSOR_CAPS_CONSTRICTION](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_feature_caps).</span><span class="sxs-lookup"><span data-stu-id="4b7e5-164">There is no equivalent for [D3D11_VIDEO_PROCESSOR_CAPS_CONSTRICTION](/windows/desktop/api/d3d11/ne-d3d11-d3d11_video_processor_feature_caps).</span></span>
- <span data-ttu-id="4b7e5-165">Ao converter de estéreo em mono, supomos que a exibição de linha de base é 0.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-165">When converting from stereo to mono, we assume the baseline view is 0.</span></span>
- <span data-ttu-id="4b7e5-166">O processamento de vídeo do Direct3D 12 não dá suporte à conversão de mono para estéreo e não há suporte para deslocamento mono.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-166">Direct3D 12 video processing does not support converting mono to stereo and there is no support for mono offset.</span></span> 


### <a name="creating-a-video-processor"></a><span data-ttu-id="4b7e5-167">Criando um processador de vídeo</span><span class="sxs-lookup"><span data-stu-id="4b7e5-167">Creating a video processor</span></span>

<span data-ttu-id="4b7e5-168">Chame [ID3D12VideoDevice:: CreateVideoProcessor](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideoprocessor) para criar uma instância do [ID3D12VideoProcessor](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videoprocessor).</span><span class="sxs-lookup"><span data-stu-id="4b7e5-168">Call [ID3D12VideoDevice::CreateVideoProcessor](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videodevice-createvideoprocessor) to create an instance of the [ID3D12VideoProcessor](/windows/desktop/api/d3d12video/nn-d3d12video-id3d12videoprocessor).</span></span> <span data-ttu-id="4b7e5-169">O processador de vídeo mantém o estado de uma sessão de processamento de vídeo, incluindo a memória intermediária necessária, dados de processamento em cache ou outro espaço de trabalho temporário.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-169">The video processor holds state for a video processing session, including required intermediate memory, cached processing data, or other temporary working space.</span></span> <span data-ttu-id="4b7e5-170">Os argumentos de criação do processador de vídeo especificam quais operações são executadas ou estão disponíveis em [ID3D12VideoProcessCommandList1::P rocessframes1](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist1-processframes1) time.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-170">The video processor creation arguments specify which operations are performed or are available at [ID3D12VideoProcessCommandList1::ProcessFrames1](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist1-processframes1) time.</span></span>  <span data-ttu-id="4b7e5-171">As alocações de driver para executar a operação de processo de vídeo (por exemplo, intermediários) são alocadas no momento da criação do processador de vídeo.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-171">Driver allocations to perform the video process operation (e.g. intermediates) are allocated at video processor creation time.</span></span>  <span data-ttu-id="4b7e5-172">Use [D3D12_FEATURE_VIDEO_PROCESSOR_SIZE](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_feature_video) para determinar o tamanho de alocação do processador de vídeo com antecedência.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-172">Use [D3D12_FEATURE_VIDEO_PROCESSOR_SIZE](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_feature_video) to determine the allocation size of the video processor in advance.</span></span>

<span data-ttu-id="4b7e5-173">O processador de vídeo só pode ser usado para gravar comandos de várias listas de comandos, mas só pode ser associado a uma lista de comandos por vez.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-173">The video processor may only be used to record commands from multiple command lists, but may only be associated with one command list at a time.</span></span>  <span data-ttu-id="4b7e5-174">O aplicativo é responsável por sincronizar o acesso ao processador de vídeo.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-174">The application is responsible for synchronizing access to the video processor.</span></span>  <span data-ttu-id="4b7e5-175">O aplicativo também deve gravar comandos de processamento de vídeo em relação ao procoessor de vídeo na ordem em que são executados na GPU.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-175">The application must also record video processing commands against the video procoessor in the order that they are executed on the GPU.</span></span>

<span data-ttu-id="4b7e5-176">Todos os argumentos de entrada e saída para as operações de processamento de vídeo são organizados em uma estrutura de argumento de entrada, [D3D12_VIDEO_PROCESS_INPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_process_input_stream_arguments)e uma estrutura de argumento de saída, [D3D12_VIDEO_PROCESS_OUTPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_process_output_stream_arguments).</span><span class="sxs-lookup"><span data-stu-id="4b7e5-176">All input and output arguments for the video processing operations are organized into an input argument structure, [D3D12_VIDEO_PROCESS_INPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_process_input_stream_arguments), and an output argument structure, [D3D12_VIDEO_PROCESS_OUTPUT_STREAM_ARGUMENTS](/windows/desktop/api/d3d12video/ns-d3d12video-d3d12_video_process_output_stream_arguments).</span></span> <span data-ttu-id="4b7e5-177">O aplicativo deve chamar [ID3D12VideoProcessCommandList::P rocessframes](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist-processframes) para registrar a operação de processamento de vídeo que deseja executar.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-177">The application must call [ID3D12VideoProcessCommandList::ProcessFrames](/windows/desktop/api/d3d12video/nf-d3d12video-id3d12videoprocesscommandlist-processframes) to record the video processing operation it wants to execute.</span></span> 

<span data-ttu-id="4b7e5-178">Quando a lista de comandos é registrada, chame [ID3D12CommandQueue:: ExecuteCommandLists](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-executecommandlists) na fila de comandos de vídeo para enviar o processamento de quadros para a GPU.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-178">When the command list is recorded, call [ID3D12CommandQueue::ExecuteCommandLists](/windows/desktop/api/d3d12/nf-d3d12-id3d12commandqueue-executecommandlists) on the video command queue to submit the frame processing to the GPU.</span></span>


## <a name="tiers"></a><span data-ttu-id="4b7e5-179">Tiers</span><span class="sxs-lookup"><span data-stu-id="4b7e5-179">Tiers</span></span>

<span data-ttu-id="4b7e5-180">O vídeo do Direct3D 12 define camadas que agrupam os recursos de dispositivos de hardware, para que o aplicativo possa ter menos caminhos de código para atender à variedade de hardware.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-180">Direct3D 12 video defines tiers that group the capabilities of hardware devices, so that the app can have fewer code paths to cater to the variety of hardware.</span></span> <span data-ttu-id="4b7e5-181">As camadas são especificadas com a enumeração [D3D12_VIDEO_DECODE_TIER](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_decode_tier) .</span><span class="sxs-lookup"><span data-stu-id="4b7e5-181">The tiers are specified with the [D3D12_VIDEO_DECODE_TIER](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_decode_tier) enumeration.</span></span>

<span data-ttu-id="4b7e5-182">Em todas as camadas, o seguinte estará disponível:</span><span class="sxs-lookup"><span data-stu-id="4b7e5-182">In all the tiers, the following will be available:</span></span>

- <span data-ttu-id="4b7e5-183">Não há necessidade de recriação de decodificador em alterações de resolução.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-183">No need for decoder recreation on resolution changes.</span></span> <span data-ttu-id="4b7e5-184">Somente o heap do decodificador precisa ser recriado na alteração da resolução.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-184">Only the decoder heap needs to be recreated on resolution change.</span></span>
- <span data-ttu-id="4b7e5-185">Todos os quadros de referência serão gerenciados pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-185">All reference frames will be managed by the app.</span></span> <span data-ttu-id="4b7e5-186">Isso permite que o sistema Economize memória, já que não precisamos alocar o número máximo de DPBs no tempo de criação do decodificador em algumas camadas e fornece flexibilidade aos aplicativos em cenários de alteração de resolução.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-186">This allows the system to save memory since we do not need to allocate the maximum number of DPBs at decoder creation time in some tiers, and gives apps flexibility in resolution changing scenarios.</span></span>

<span data-ttu-id="4b7e5-187">Observe que as camadas são superconjuntos.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-187">Note that the tiers are supersets.</span></span> <span data-ttu-id="4b7e5-188">Um aplicativo pode decidir fazer a camada 1 e não usar os recursos de nível superior, que é permitido, mas pode não fornecer o ideal desempenho.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-188">An app may decide to do tier 1, and not use the higher level features, which is allowed but may not provide optimal performace.</span></span> <span data-ttu-id="4b7e5-189">Para obter mais informações sobre os recursos associados a diferentes níveis de camada, consulte [D3D12_VIDEO_DECODE_TIER](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_decode_tier).</span><span class="sxs-lookup"><span data-stu-id="4b7e5-189">For more information on the capabilities associated with different tier levels, see [D3D12_VIDEO_DECODE_TIER](/windows/desktop/api/d3d12video/ne-d3d12video-d3d12_video_decode_tier).</span></span>

## <a name="reference-frames"></a><span data-ttu-id="4b7e5-190">Quadros de referência</span><span class="sxs-lookup"><span data-stu-id="4b7e5-190">Reference frames</span></span>

<span data-ttu-id="4b7e5-191">Com o vídeo do Direct3D 12, os quadros de referência são passados explicitamente.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-191">With Direct3D 12 video, reference frames are passed explicitly.</span></span> <span data-ttu-id="4b7e5-192">Isso permite o uso claro da matriz de texturas ou matrizes de textura quando estamos decodificando quadros.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-192">This allows for clear usage of array of textures or texture arrays when we are decoding frames.</span></span> <span data-ttu-id="4b7e5-193">Não é necessário que o aplicativo passe exatamente o mesmo identificador de recurso ao usá-lo como referência; Ele pode, por exemplo, decidir copiar um recurso para outro e, em seguida, passar a cópia em vez do original.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-193">The app is not required to pass the exact same resource handle when using it as a reference; it may, for instance, decide to copy one resource to another and then pass the copy instead of the original one.</span></span> <span data-ttu-id="4b7e5-194">Os índices DXVA *RefFrameList* e *CurrPic* ainda são usados pelo driver para armazenar dados relevantes para cada quadro decodificado.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-194">The DXVA *RefFrameList* and *CurrPic* indices are still used by the driver to store relevant data for each decoded frame.</span></span>


## <a name="directx-12-fences"></a><span data-ttu-id="4b7e5-195">Limites do DirectX 12</span><span class="sxs-lookup"><span data-stu-id="4b7e5-195">DirectX 12 fences</span></span>

<span data-ttu-id="4b7e5-196">No DirectX 12, o aplicativo é responsável por sincronizar o acesso a seus buffers.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-196">In DirectX 12, the app is responsible for synchronizing the access to their buffers.</span></span> <span data-ttu-id="4b7e5-197">Para o caso de decodificação, haverá a necessidade de adicionar limites aos buffers de entrada e aos buffers de saída.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-197">For the decoding case, there will be the need for adding fences to the input buffers and to the output buffers.</span></span> <span data-ttu-id="4b7e5-198">Cada cerca tem um valor associado a ele e é usado para sincronização da CPU e dos mecanismos de hardware.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-198">Each fence has a value associated with it, and are used for synchronization of the CPU and the hardware engines.</span></span> <span data-ttu-id="4b7e5-199">Para obter mais informações, consulte [usando barreiras de recursos para sincronizar Estados de recursos no Direct3D 12](/windows/desktop/direct3d12/using-resource-barriers-to-synchronize-resource-states-in-direct3d-12).</span><span class="sxs-lookup"><span data-stu-id="4b7e5-199">For more information, see [Using Resource Barriers to Synchronize Resource States in Direct3D 12](/windows/desktop/direct3d12/using-resource-barriers-to-synchronize-resource-states-in-direct3d-12).</span></span>

<span data-ttu-id="4b7e5-200">Uma implementação típica terá um limite para cada buffer de entrada.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-200">A typical implementation will have a fence for each input buffer.</span></span> <span data-ttu-id="4b7e5-201">No caso de buffers de entrada, é possível que o buffer possa estar disponível antes que todo o processo de decodificação seja feito.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-201">In the case of input buffers, it is possible that the buffer may be available before the whole decoding process is done.</span></span> <span data-ttu-id="4b7e5-202">O sistema ignorará esse caso e assumirá que o buffer de entrada está disponível quando a decodificação for feita.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-202">The system will ignore this case and assume that the input buffer is available when decoding is done.</span></span>
<span data-ttu-id="4b7e5-203">Uma implementação normalmente também terá um limite para cada buffer de saída.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-203">An implementation will also usually have a fence for each output buffer.</span></span> <span data-ttu-id="4b7e5-204">No caso de envio da saída para o compositor, por exemplo, é necessário que uma cerca seja sinalizada quando essa apresentação desse quadro for concluída, indicando que a saída está novamente disponível para o decodificador.</span><span class="sxs-lookup"><span data-stu-id="4b7e5-204">In the case of sending the output to the compositor, for instance, a fence is needed that is signaled when that presentation of that frame is finally done, indicating that the output is again available for the decoder.</span></span>


## <a name="related-topics"></a><span data-ttu-id="4b7e5-205">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="4b7e5-205">Related topics</span></span>

<dl> <span data-ttu-id="4b7e5-206"><dt>APIs de vídeo do 
[Direct3D 12](direct3d-12-video-apis.md) 
 [Guia de programação Media Foundation](media-foundation-programming-guide.md)
</dt> </span><span class="sxs-lookup"><span data-stu-id="4b7e5-206"><dt>
[Direct3D 12 Video APIs](direct3d-12-video-apis.md)
[Media Foundation Programming Guide](media-foundation-programming-guide.md)
</dt> </span></span></dl>

 

 
