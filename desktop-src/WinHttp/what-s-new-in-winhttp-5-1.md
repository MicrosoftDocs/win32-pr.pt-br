---
description: Este tópico descreve as diferenças mais importantes entre o WinHTTP versão 5,1 e a versão 5,0.
ms.assetid: df3fcf27-3012-4818-b29c-b8a4dc409828
title: Novidades no WinHTTP 5,1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 909d5ae8fb1d169af01782d21d2ead56b25c940c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105812357"
---
# <a name="whats-new-in-winhttp-51"></a><span data-ttu-id="ad262-103">O que há de novo no WinHTTP 5,1</span><span class="sxs-lookup"><span data-stu-id="ad262-103">What's New in WinHTTP 5.1</span></span>

<span data-ttu-id="ad262-104">Este tópico descreve as diferenças mais importantes entre o WinHTTP versão 5,1 e a versão 5,0.</span><span class="sxs-lookup"><span data-stu-id="ad262-104">This topic describes the most important differences between WinHTTP version 5.1 and version 5.0.</span></span> <span data-ttu-id="ad262-105">Muitas dessas diferenças exigem alterações de código em aplicativos que migram da versão 5,0 para a versão 5,1.</span><span class="sxs-lookup"><span data-stu-id="ad262-105">Many of these differences require code changes in applications migrating from version 5.0 to version 5.1.</span></span> <span data-ttu-id="ad262-106">Alguns dos recursos da versão 5,1 estão disponíveis apenas a partir do Windows Server 2003 e do Windows XP com Service Pack 2 (SP2), particularmente os recursos relacionados ao aprimoramento da segurança do cliente em servidores Web mal-intencionados.</span><span class="sxs-lookup"><span data-stu-id="ad262-106">Some of the features in version 5.1 are only available starting with Windows Server 2003 and Windows XP with Service Pack 2 (SP2), particularly features related to improving the security of the client against malicious Web servers.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ad262-107">Com o lançamento do WinHTTP versão 5,1, o download do WinHTTP 5,0 não está mais disponível.</span><span class="sxs-lookup"><span data-stu-id="ad262-107">With the release of WinHTTP Version 5.1, the WinHTTP 5.0 download is no longer available.</span></span> <span data-ttu-id="ad262-108">A partir de 1º de outubro de 2004, a Microsoft removeu o download do SDK do WinHTTP 5,0 do MSDN e terminou o suporte do produto para a versão 5,0.</span><span class="sxs-lookup"><span data-stu-id="ad262-108">As of October 1, 2004, Microsoft has removed the WinHTTP 5.0 SDK download from MSDN and has terminated product support for version 5.0.</span></span>

 

## <a name="dll-name-change"></a><span data-ttu-id="ad262-109">Alteração de nome de DLL</span><span class="sxs-lookup"><span data-stu-id="ad262-109">DLL Name Change</span></span>

<span data-ttu-id="ad262-110">O nome da nova DLL do WinHTTP 5,1 é Winhttp.dll, enquanto o nome da DLL do WinHTTP 5,0 é Winhttp5.dll.</span><span class="sxs-lookup"><span data-stu-id="ad262-110">The name of the new WinHTTP 5.1 DLL is Winhttp.dll, whereas the name of the WinHTTP 5.0 DLL is Winhttp5.dll.</span></span>

<span data-ttu-id="ad262-111">O WinHTTP 5,0 e o 5,1 podem coexistir no mesmo sistema; O WinHTTP 5,1 não substitui, nem instala, o WinHTTP 5,0.</span><span class="sxs-lookup"><span data-stu-id="ad262-111">WinHTTP 5.0 and 5.1 can coexist on the same system; WinHTTP 5.1 does not replace, or install over, WinHTTP 5.0.</span></span>

## <a name="redistribution"></a><span data-ttu-id="ad262-112">Redistribuição</span><span class="sxs-lookup"><span data-stu-id="ad262-112">Redistribution</span></span>

<span data-ttu-id="ad262-113">O WinHTTP 5,1 está disponível apenas com o Windows Server 2003, Windows 2000 Professional com Service Pack 3 (SP3), Windows XP com Service Pack 1 (SP1) e sistemas operacionais posteriores.</span><span class="sxs-lookup"><span data-stu-id="ad262-113">WinHTTP 5.1 is available only with Windows Server 2003, Windows 2000 Professional with Service Pack 3 (SP3), Windows XP with Service Pack 1 (SP1), and later operating systems.</span></span> <span data-ttu-id="ad262-114">Um arquivo de módulo de mesclagem redistribuível (. msm) não está disponível para o WinHTTP 5,1.</span><span class="sxs-lookup"><span data-stu-id="ad262-114">A redistributable merge module (.msm) file is not available for WinHTTP 5.1.</span></span>

## <a name="winhttprequest-progid"></a><span data-ttu-id="ad262-115">ProgID de WinHttpRequest</span><span class="sxs-lookup"><span data-stu-id="ad262-115">WinHttpRequest ProgID</span></span>

<span data-ttu-id="ad262-116">O ProgID do componente WinHttpRequest mudou de "WinHttp. WinHttpRequest. 5" para "WinHttp. WinHttpRequest. 5.1".</span><span class="sxs-lookup"><span data-stu-id="ad262-116">The ProgID of the WinHttpRequest component has changed from "WinHttp.WinHttpRequest.5" to "WinHttp.WinHttpRequest.5.1".</span></span> <span data-ttu-id="ad262-117">O CLSID da classe [**WinHttpRequest**](winhttprequest.md) também foi alterado.</span><span class="sxs-lookup"><span data-stu-id="ad262-117">The CLSID of the [**WinHttpRequest**](winhttprequest.md) class has also changed.</span></span>

## <a name="async-callback-behavior-change"></a><span data-ttu-id="ad262-118">Alteração de comportamento de retorno de chamada assíncrono</span><span class="sxs-lookup"><span data-stu-id="ad262-118">Async Callback Behavior Change</span></span>

<span data-ttu-id="ad262-119">Ao chamar as funções [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata), [**WinHttpQueryDataAvailable**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable) e [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata) no modo assíncrono, não dependa dos respectivos parâmetros *lpdwNumberOfBytesWritten*, *lpdwNumberOfBytesAvailable* e *lpdwNumberOfBytesRead* out a serem definidos.</span><span class="sxs-lookup"><span data-stu-id="ad262-119">When calling the [**WinHttpWriteData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpwritedata), [**WinHttpQueryDataAvailable**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpquerydataavailable) and [**WinHttpReadData**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpreaddata) functions in asynchronous mode, do not rely on the respective *lpdwNumberOfBytesWritten*, *lpdwNumberOfBytesAvailable*, and *lpdwNumberOfBytesRead* OUT parameters to be set.</span></span> <span data-ttu-id="ad262-120">Se a chamada de função for concluída de forma assíncrona, o WinHTTP não gravará nesses ponteiros fornecidos pelo código do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ad262-120">If the function call completes asynchronously, WinHTTP does not write to these pointers supplied by the application code.</span></span> <span data-ttu-id="ad262-121">Em vez disso, o aplicativo deve recuperar esses valores usando parâmetros *lpvStatusInformation* e *dwStatusInformationLength* para a função de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="ad262-121">Instead, the application should retrieve these values using *lpvStatusInformation* and *dwStatusInformationLength* parameters to the callback function.</span></span>

## <a name="changes-to-default-settings"></a><span data-ttu-id="ad262-122">Alterações nas configurações padrão</span><span class="sxs-lookup"><span data-stu-id="ad262-122">Changes to Default Settings</span></span>

<span data-ttu-id="ad262-123">As alterações nas configurações padrão incluem:</span><span class="sxs-lookup"><span data-stu-id="ad262-123">Changes to default settings include:</span></span>

-   <span data-ttu-id="ad262-124">A verificação de certificado do servidor SSL está habilitada por padrão no WinHTTP 5,1.</span><span class="sxs-lookup"><span data-stu-id="ad262-124">SSL server certificate verification is enabled by default in WinHTTP 5.1.</span></span> <span data-ttu-id="ad262-125">O WinHTTP 5,0 não trata as falhas encontradas ao validar o certificado do servidor como erros fatais; Eles são relatados ao aplicativo usando uma notificação de retorno de chamada de **\_ falha segura** , mas não fazem com que a solicitação seja anulada.</span><span class="sxs-lookup"><span data-stu-id="ad262-125">WinHTTP 5.0 does not handle failures encountered when validating the server certificate as fatal errors; they are reported to the application using a **SECURE\_FAILURE** callback notification, but does not cause the request to be aborted.</span></span> <span data-ttu-id="ad262-126">O WinHTTP 5,1, como alternativa, trata falhas de validação de certificado do servidor como erros fatais que anulam a solicitação.</span><span class="sxs-lookup"><span data-stu-id="ad262-126">WinHTTP 5.1, alternatively, handles server certificate validation failures as fatal errors that abort the request.</span></span> <span data-ttu-id="ad262-127">O aplicativo pode instruir o WinHTTP a ignorar um pequeno subconjunto de erros de certificado, como autoridade de certificação desconhecida, data de certificado inválida/expirada ou nome de entidade de certificado inválido, usando a opção de **\_ sinalizadores de \_ segurança \_ de opção WinHTTP** .</span><span class="sxs-lookup"><span data-stu-id="ad262-127">The application can instruct WinHTTP to ignore a small subset of certificate errors such as unknown CA, invalid/expired certificate date, or invalid certificate subject name, using the **WINHTTP\_OPTION\_SECURITY\_FLAGS** option.</span></span>
-   <span data-ttu-id="ad262-128">O suporte à autenticação do Passport está desabilitado por padrão no WinHTTP 5,1.</span><span class="sxs-lookup"><span data-stu-id="ad262-128">Passport authentication support is disabled by default in WinHTTP 5.1.</span></span> <span data-ttu-id="ad262-129">O suporte do Passport pode ser habilitado com a **opção WinHTTP configurar a opção \_ \_ \_ Passport \_ auth** .</span><span class="sxs-lookup"><span data-stu-id="ad262-129">Passport support can be enabled with the **WINHTTP\_OPTION\_CONFIGURE\_PASSPORT\_AUTH** option.</span></span> <span data-ttu-id="ad262-130">A pesquisa automática de credenciais do Passport no keyring também é desabilitada por padrão.</span><span class="sxs-lookup"><span data-stu-id="ad262-130">Automatic Passport credential look-up in the Keyring is also disabled by default.</span></span>
-   <span data-ttu-id="ad262-131">Redirecionar alteração de comportamento: redirecionamentos de HTTP de um **https seguro:** a URL para um **http:** a URL regular não é mais seguida automaticamente por padrão por motivos de segurança.</span><span class="sxs-lookup"><span data-stu-id="ad262-131">Redirect behavior change: HTTP redirects from a secure **https:** URL to a regular **http:** URL are no longer followed automatically by default for security reasons.</span></span> <span data-ttu-id="ad262-132">Há uma nova opção, a **\_ \_ \_ política de redirecionamento de opção WinHTTP**, para substituir o comportamento de redirecionamento padrão no WinHTTP 5,1.</span><span class="sxs-lookup"><span data-stu-id="ad262-132">There is a new option, **WINHTTP\_OPTION\_REDIRECT\_POLICY**, to override the default redirect behavior in WinHTTP 5.1.</span></span> <span data-ttu-id="ad262-133">Com o componente com **WinHttpRequest** , use a nova opção **WinHttpRequestOption \_ EnableHttpsToHttpRedirects** para habilitar redirecionamentos de https: para http: URLs.</span><span class="sxs-lookup"><span data-stu-id="ad262-133">With the **WinHttpRequest** COM component, use the new **WinHttpRequestOption\_EnableHttpsToHttpRedirects** option to enable redirects from https: to http: URLs.</span></span>
-   <span data-ttu-id="ad262-134">Quando um arquivo de rastreamento WinHTTP é criado, o acesso é restrito a uma ACL, de modo que somente os administradores possam ler ou gravar o arquivo.</span><span class="sxs-lookup"><span data-stu-id="ad262-134">When a WinHTTP trace file is created, access is restricted with an ACL such that only administrators can read or write the file.</span></span> <span data-ttu-id="ad262-135">A conta de usuário sob a qual o TraceFile foi criado também pode modificar a ACL para conceder a outros acessos.</span><span class="sxs-lookup"><span data-stu-id="ad262-135">The user account under which the tracefile was created can also modify the ACL to grant others access.</span></span> <span data-ttu-id="ad262-136">Essa proteção está disponível somente em sistemas de arquivos que dão suporte à segurança; ou seja, NTFS, não FAT32).</span><span class="sxs-lookup"><span data-stu-id="ad262-136">This protection is available only on file systems which support security; that is, NTFS, not FAT32).</span></span>
-   <span data-ttu-id="ad262-137">A partir do Windows Server 2003 e do Windows XP com SP2, o envio de solicitações para as seguintes portas não-HTTP conhecidas é restrito por motivos de segurança: 21 (FTP), 25 (SMTP), 70 (GOPHER), 110 (POP3), 119 (NNTP), 143 (IMAP).</span><span class="sxs-lookup"><span data-stu-id="ad262-137">Starting with Windows Server 2003 and Windows XP with SP2, sending requests to the following well-known, non-HTTP, ports is restricted for security reasons: 21 (FTP), 25 (SMTP), 70 (GOPHER), 110 (POP3), 119 (NNTP), 143 (IMAP).</span></span>
-   <span data-ttu-id="ad262-138">A partir do Windows Server 2003 e do Windows XP com SP2, a quantidade máxima de dados de cabeçalho que o WinHTTP aceita em uma resposta HTTP é de 64K, por padrão.</span><span class="sxs-lookup"><span data-stu-id="ad262-138">Starting with Windows Server 2003, and Windows XP with SP2, the maximum amount of header data WinHTTP accepts in an HTTP response is 64K, by default.</span></span> <span data-ttu-id="ad262-139">Se a resposta HTTP do servidor contiver mais de 64K de dados de cabeçalho totais, WinHTTP falhará na solicitação com um erro WinHTTP erro de **\_ \_ \_ \_ resposta do servidor inválido** .</span><span class="sxs-lookup"><span data-stu-id="ad262-139">If the server HTTP response contains more that 64K of total header data, WinHTTP fails the request with an **ERROR\_WINHTTP\_INVALID\_SERVER\_RESPONSE** error.</span></span> <span data-ttu-id="ad262-140">Esse limite de 64K pode ser substituído usando a opção nova **opção de tamanho do \_ cabeçalho de \_ \_ resposta de \_ \_ máximo de WinHTTP** .</span><span class="sxs-lookup"><span data-stu-id="ad262-140">This 64K limit can be overridden using the new **WINHTTP\_OPTION\_MAX\_RESPONSE\_HEADER\_SIZE** option.</span></span>

## <a name="ipv6-support"></a><span data-ttu-id="ad262-141">Suporte a IPv6</span><span class="sxs-lookup"><span data-stu-id="ad262-141">IPv6 Support</span></span>

<span data-ttu-id="ad262-142">O WinHTTP 5,1 adiciona suporte para o protocolo IP versão 6 (IPv6).</span><span class="sxs-lookup"><span data-stu-id="ad262-142">WinHTTP 5.1 adds support for Internet Protocol Version 6 (IPv6).</span></span> <span data-ttu-id="ad262-143">O WinHTTP pode enviar solicitações HTTP para um servidor cujo nome DNS seja resolvido em um endereço IPv6 e, a partir do Windows Server 2003 e do Windows XP com SP2, o WinHTTP também oferece suporte a endereços IPv6 literais.</span><span class="sxs-lookup"><span data-stu-id="ad262-143">WinHTTP can send HTTP requests to a server whose DNS name resolves into an IPv6 address, and starting with Windows Server 2003 and Windows XP with SP2, WinHTTP also supports IPv6 literal addresses.</span></span>

## <a name="new-options-in-the-cc-api-for-winhttp"></a><span data-ttu-id="ad262-144">Novas opções na API C/C++ para WinHTTP</span><span class="sxs-lookup"><span data-stu-id="ad262-144">New Options in the C/C++ API for WinHTTP</span></span>

<span data-ttu-id="ad262-145">O WinHTTP 5,1 implementa as seguintes novas opções:</span><span class="sxs-lookup"><span data-stu-id="ad262-145">WinHTTP 5.1 implements the following new options:</span></span>

<dl> <span data-ttu-id="ad262-146">" \# definir a \_ opção WinHTTP \_ sair do Passport \_ \_ 86"</span><span class="sxs-lookup"><span data-stu-id="ad262-146">"\#define WINHTTP\_OPTION\_PASSPORT\_SIGN\_OUT 86"</span></span>  
<span data-ttu-id="ad262-147">" \# definir a \_ opção WinHTTP \_ URL de retorno do Passport \_ \_ 87"</span><span class="sxs-lookup"><span data-stu-id="ad262-147">"\#define WINHTTP\_OPTION\_PASSPORT\_RETURN\_URL 87"</span></span>  
<span data-ttu-id="ad262-148">" \# definir a \_ \_ política de redirecionamento de opção WinHTTP \_ 88"</span><span class="sxs-lookup"><span data-stu-id="ad262-148">"\#define WINHTTP\_OPTION\_REDIRECT\_POLICY 88"</span></span>  
</dl>

<span data-ttu-id="ad262-149">A partir do Windows Server 2003 e do Windows XP com SP2, o WinHTTP 5,1 implementa as novas opções a seguir.</span><span class="sxs-lookup"><span data-stu-id="ad262-149">Starting with Windows Server 2003 and Windows XP with SP2, WinHTTP 5.1 implements the following new options.</span></span> <span data-ttu-id="ad262-150">No Windows 2000 Professional com SP3 ou Windows XP com SP1, no entanto, as chamadas para [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) ou [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) com essas IDs de opção falham:</span><span class="sxs-lookup"><span data-stu-id="ad262-150">On Windows 2000 Professional with SP3 or Windows XP with SP1, however, calls to [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) or [**WinHttpQueryOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpqueryoption) with these option IDs fail:</span></span>

<dl> <span data-ttu-id="ad262-151">" \# definir a \_ opção de WinHTTP \_ \_ tempo limite de resposta de recebimento \_ 7"</span><span class="sxs-lookup"><span data-stu-id="ad262-151">"\#define WINHTTP\_OPTION\_RECEIVE\_RESPONSE\_TIMEOUT 7"</span></span>  
<span data-ttu-id="ad262-152">" \# definir a \_ opção WinHTTP máx. de \_ \_ \_ redirecionamentos automáticos de http \_ 89"</span><span class="sxs-lookup"><span data-stu-id="ad262-152">"\#define WINHTTP\_OPTION\_MAX\_HTTP\_AUTOMATIC\_REDIRECTS 89"</span></span>  
<span data-ttu-id="ad262-153">" \# definir o \_ \_ status http máximo da opção WinHTTP \_ \_ \_ continuar 90"</span><span class="sxs-lookup"><span data-stu-id="ad262-153">"\#define WINHTTP\_OPTION\_MAX\_HTTP\_STATUS\_CONTINUE 90"</span></span>  
<span data-ttu-id="ad262-154">" \# definir o \_ tamanho do cabeçalho de resposta máximo da opção de WinHTTP \_ \_ \_ \_ 91"</span><span class="sxs-lookup"><span data-stu-id="ad262-154">"\#define WINHTTP\_OPTION\_MAX\_RESPONSE\_HEADER\_SIZE 91"</span></span>  
<span data-ttu-id="ad262-155">" \# definir o \_ tamanho de dreno de resposta máximo da opção de WinHTTP \_ \_ \_ \_ 92"</span><span class="sxs-lookup"><span data-stu-id="ad262-155">"\#define WINHTTP\_OPTION\_MAX\_RESPONSE\_DRAIN\_SIZE 92"</span></span>  
</dl>

## <a name="new-options-in-the-winhttprequest-51-component"></a><span data-ttu-id="ad262-156">Novas opções no componente WinHttpRequest 5,1</span><span class="sxs-lookup"><span data-stu-id="ad262-156">New Options in the WinHttpRequest 5.1 Component</span></span>

<span data-ttu-id="ad262-157">O componente WinHttpRequest 5,1 implementa as seguintes novas opções:</span><span class="sxs-lookup"><span data-stu-id="ad262-157">The WinHttpRequest 5.1 component implements the following new options:</span></span>

<dl> <span data-ttu-id="ad262-158">"WinHttpRequestOption \_ RevertImpersonationOverSsl"</span><span class="sxs-lookup"><span data-stu-id="ad262-158">"WinHttpRequestOption\_RevertImpersonationOverSsl"</span></span>  
<span data-ttu-id="ad262-159">"WinHttpRequestOption \_ EnableHttpsToHttpRedirects"</span><span class="sxs-lookup"><span data-stu-id="ad262-159">"WinHttpRequestOption\_EnableHttpsToHttpRedirects"</span></span>  
<span data-ttu-id="ad262-160">"WinHttpRequestOption \_ EnablePassportAuthentication"</span><span class="sxs-lookup"><span data-stu-id="ad262-160">"WinHttpRequestOption\_EnablePassportAuthentication"</span></span>  
</dl>

<span data-ttu-id="ad262-161">As seguintes novas opções WinHttpRequest 5,1 estão disponíveis a partir do Windows Server 2003 e do Windows XP com SP2:</span><span class="sxs-lookup"><span data-stu-id="ad262-161">The following new WinHttpRequest 5.1 options are available starting with Windows Server 2003 and Windows XP with SP2:</span></span>

<dl> <span data-ttu-id="ad262-162">"WinHttpRequestOption \_ MaxAutomaticRedirects"</span><span class="sxs-lookup"><span data-stu-id="ad262-162">"WinHttpRequestOption\_MaxAutomaticRedirects"</span></span>  
<span data-ttu-id="ad262-163">"WinHttpRequestOption \_ MaxResponseHeaderSize"</span><span class="sxs-lookup"><span data-stu-id="ad262-163">"WinHttpRequestOption\_MaxResponseHeaderSize"</span></span>  
<span data-ttu-id="ad262-164">"WinHttpRequestOption \_ MaxResponseDrainSize"</span><span class="sxs-lookup"><span data-stu-id="ad262-164">"WinHttpRequestOption\_MaxResponseDrainSize"</span></span>  
<span data-ttu-id="ad262-165">"WinHttpRequestOptions \_ EnableHttp1 \_ 1"</span><span class="sxs-lookup"><span data-stu-id="ad262-165">"WinHttpRequestOptions\_EnableHttp1\_1"</span></span>  
</dl>

## <a name="proxies-are-not-trusted-when-auto-logon-security-is-set-to-high"></a><span data-ttu-id="ad262-166">Os proxies não são confiáveis quando a segurança de logon automático está definida como alta</span><span class="sxs-lookup"><span data-stu-id="ad262-166">Proxies Are Not Trusted When Auto-Logon Security is Set to High</span></span>

<span data-ttu-id="ad262-167">No WinHTTP 5,0, os servidores proxy são sempre confiáveis para logon automático.</span><span class="sxs-lookup"><span data-stu-id="ad262-167">In WinHTTP 5.0, proxy servers are always trusted for auto-logon.</span></span> <span data-ttu-id="ad262-168">Isso não é mais válido para o WinHTTP 5,1 em execução no Windows Server 2003 e no Windows XP com SP2 quando a opção de política **alta de nível de segurança do WinHTTP \_ autologonn \_ \_ \_** estiver definida.</span><span class="sxs-lookup"><span data-stu-id="ad262-168">This is no longer valid for WinHTTP 5.1 running on Windows Server 2003 and Windows XP with SP2 when the **WINHTTP\_AUTOLOGON\_SECURITY\_LEVEL\_HIGH** policy option is set.</span></span>

## <a name="web-proxy-auto-discovery-autoproxy-api"></a><span data-ttu-id="ad262-169">API de descoberta automática de proxy da Web (AutoProxy)</span><span class="sxs-lookup"><span data-stu-id="ad262-169">Web Proxy Auto-Discovery (AutoProxy) API</span></span>

<span data-ttu-id="ad262-170">Para facilitar a configuração de configurações de proxy para aplicativos baseados em WinHTTP, o WinHTTP agora implementa o protocolo WPAD (descoberta automática de proxy da Web), também conhecido como *AutoProxy*.</span><span class="sxs-lookup"><span data-stu-id="ad262-170">To ease the configuration of proxy settings for WinHTTP-based applications, WinHTTP now implements the Web Proxy Auto-Discovery (WPAD) protocol, also referred to as *autoproxy*.</span></span> <span data-ttu-id="ad262-171">Esse é o mesmo protocolo que os navegadores da Web, como o Internet Explorer, implementam para descobrir a configuração de proxy automaticamente sem exigir que um usuário final especifique um servidor proxy manualmente.</span><span class="sxs-lookup"><span data-stu-id="ad262-171">This is the same protocol that web browsers, such as Internet Explorer, implement to discover the proxy configuration automatically without requiring an end-user to specify a proxy server manually.</span></span> <span data-ttu-id="ad262-172">Para dar suporte ao AutoProxy, o WinHTTP 5,1 implementa uma nova função C/C++, [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl), além de duas funções de suporte, [**WinHttpDetectAutoProxyConfigUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpdetectautoproxyconfigurl) e [**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser).</span><span class="sxs-lookup"><span data-stu-id="ad262-172">To support autoproxy, WinHTTP 5.1 implements a new C/C++ function, [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl), plus two supporting functions, [**WinHttpDetectAutoProxyConfigUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpdetectautoproxyconfigurl) and [**WinHttpGetIEProxyConfigForCurrentUser**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetieproxyconfigforcurrentuser).</span></span>

## <a name="known-issues"></a><span data-ttu-id="ad262-173">Problemas conhecidos</span><span class="sxs-lookup"><span data-stu-id="ad262-173">Known Issues</span></span>

<span data-ttu-id="ad262-174">Os problemas a seguir são conhecidos por existir no WinHTTP 5,1 no Windows 2000 Professional com SP3 e no Windows XP com SP1.</span><span class="sxs-lookup"><span data-stu-id="ad262-174">The following issues are known to exist in WinHTTP 5.1 on Windows 2000 Professional with SP3 and Windows XP with SP1.</span></span> <span data-ttu-id="ad262-175">Esses problemas são resolvidos para o WinHTTP a partir do Windows Server 2003 e do Windows XP com SP2:</span><span class="sxs-lookup"><span data-stu-id="ad262-175">These issues are resolved for WinHTTP starting with Windows Server 2003 and Windows XP with SP2:</span></span>

-   <span data-ttu-id="ad262-176">Se o aplicativo usar a função [**WinHttpSetTimeouts**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsettimeouts) ou o método [**settempo_limites**](iwinhttprequest-settimeouts.md) no componente [**WinHttpRequest**](iwinhttprequest-interface.md) para definir um tempo limite de resolução de DNS não infinito, como o parâmetro *dwResolveTimeout* , ocorrerá um vazamento de identificador de thread cada vez que o WinHTTP resolver um nome DNS.</span><span class="sxs-lookup"><span data-stu-id="ad262-176">If the application uses the [**WinHttpSetTimeouts**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsettimeouts) function or the [**SetTimeouts**](iwinhttprequest-settimeouts.md) method on the [**WinHttpRequest**](iwinhttprequest-interface.md) component to set a non-infinite DNS resolve timeout such as the *dwResolveTimeout* parameter, a thread handle leak occurs each time WinHTTP resolves a DNS name.</span></span> <span data-ttu-id="ad262-177">Em um grande número de solicitações HTTP, isso causa um vazamento significativo na memória.</span><span class="sxs-lookup"><span data-stu-id="ad262-177">Over a large number of HTTP requests, this causes a significant memory leak.</span></span> <span data-ttu-id="ad262-178">A solução alternativa é deixar a configuração de tempo limite de resolução infinita padrão inalterada (um valor de 0 especifica um tempo limite infinito).</span><span class="sxs-lookup"><span data-stu-id="ad262-178">The workaround is to leave the default infinite resolve timeout setting unchanged (a value of 0 specifies an infinite timeout).</span></span> <span data-ttu-id="ad262-179">Isso é altamente recomendável em qualquer caso, pois os tempos limite de suporte em resoluções de nomes DNS no WinHTTP são caros em termos de desempenho.</span><span class="sxs-lookup"><span data-stu-id="ad262-179">This is strongly recommended in any case as supporting timeouts on DNS name resolutions in WinHTTP is expensive in terms of performance.</span></span> <span data-ttu-id="ad262-180">Para o Windows 2000 e posterior, a definição de um tempo limite de resolução de DNS no WinHTTP é desnecessária, pois o serviço cliente DNS subjacente implementa seu próprio tempo limite de resolução.</span><span class="sxs-lookup"><span data-stu-id="ad262-180">For Windows 2000 and later, setting a DNS resolve timeout in WinHTTP is unnecessary as the underlying DNS client service implements its own resolve timeout.</span></span>
-   <span data-ttu-id="ad262-181">Ao processar solicitações assíncronas, o WinHTTP não manipula a representação de thread corretamente.</span><span class="sxs-lookup"><span data-stu-id="ad262-181">When processing asynchronous requests, WinHTTP does not handle thread impersonation properly.</span></span> <span data-ttu-id="ad262-182">Isso faz com que as solicitações que exigem a autenticação NTLM/Negotiate falhem, a menos que as credenciais sejam explicitamente dadas usando as funções [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials) ou [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) .</span><span class="sxs-lookup"><span data-stu-id="ad262-182">This causes requests that require NTLM/Negotiate authentication to fail, unless credentials are explicitly given using the [**WinHttpSetCredentials**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetcredentials) or [**WinHttpSetOption**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpsetoption) functions.</span></span>

 

 



