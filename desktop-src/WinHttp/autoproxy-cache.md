---
description: Cache de AutoProxy
ms.assetid: 087104e8-ab38-4ba4-be70-23a5ea2bb130
title: Cache de AutoProxy
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6d0492bec116bad8a82da0e961cf6d851d27c787
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105808259"
---
# <a name="autoproxy-cache"></a><span data-ttu-id="149ba-103">Cache de AutoProxy</span><span class="sxs-lookup"><span data-stu-id="149ba-103">AutoProxy Cache</span></span>

<span data-ttu-id="149ba-104">A função [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) executa a pesquisa de AutoProxy em uma base por solicitação para a URL especificada.</span><span class="sxs-lookup"><span data-stu-id="149ba-104">The [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) function performs autoproxy lookup on a per-request basis for the specified URL.</span></span> <span data-ttu-id="149ba-105">Se vários proxies forem retornados, os aplicativos cliente devem testar cada proxy antes de enviar a solicitação (para obter mais informações, consulte a seção [somente um servidor proxy tem suporte no momento](autoproxy-issues-in-winhttp.md) em problemas de AutoProxy no WinHTTP).</span><span class="sxs-lookup"><span data-stu-id="149ba-105">If multiple proxies are returned, client applications should test each proxy before sending the request (for more information, see the [Only One Proxy Server is Currently Supported](autoproxy-issues-in-winhttp.md) section in AutoProxy Issues in WinHTTP).</span></span> <span data-ttu-id="149ba-106">As informações neste tópico se aplicam a chamadas para **WinHttpGetProxyForUrl** quando o cliente especifica a descoberta de proxy automática.</span><span class="sxs-lookup"><span data-stu-id="149ba-106">The information in this topic applies to calls to **WinHttpGetProxyForUrl** when the client specifies automatic proxy discovery.</span></span>

<span data-ttu-id="149ba-107">[**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) opcionalmente localiza a URL de AutoProxy e baixa o script de AutoProxy desse site.</span><span class="sxs-lookup"><span data-stu-id="149ba-107">[**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) optionally locates the autoproxy URL and downloads the autoproxy script from that site.</span></span> <span data-ttu-id="149ba-108">O WinHttp usa o script AutoProxy para localizar os servidores proxy.</span><span class="sxs-lookup"><span data-stu-id="149ba-108">WinHttp uses the autoproxy script to locate the proxy servers.</span></span> <span data-ttu-id="149ba-109">A URL do AutoProxy e o script de AutoProxy são armazenados em cache para a sessão especificada.</span><span class="sxs-lookup"><span data-stu-id="149ba-109">Both the autoproxy URL and the autoproxy script are cached for the specified session.</span></span> <span data-ttu-id="149ba-110">Somente uma URL e um script de AutoProxy são armazenados em cache para cada sessão.</span><span class="sxs-lookup"><span data-stu-id="149ba-110">Only one autoproxy URL and script are cached for each session.</span></span> <span data-ttu-id="149ba-111">Normalmente, o script e a URL de AutoProxy são armazenados em cache até que o endereço IP associado ao computador seja alterado.</span><span class="sxs-lookup"><span data-stu-id="149ba-111">Typically, the autoproxy script and URL are cached until the IP address associated with the computer changes.</span></span> <span data-ttu-id="149ba-112">Se um novo endereço IP for detectado durante uma chamada para **WinHttpGetProxyForUrl**, a chamada tentará localizar uma nova URL e um script de AutoProxy e armazenar em cache os resultados.</span><span class="sxs-lookup"><span data-stu-id="149ba-112">If a new IP address is detected during a call to **WinHttpGetProxyForUrl**, the call will attempt to locate a new autoproxy URL and script and cache the results.</span></span> <span data-ttu-id="149ba-113">Somente um usuário deve ser permitido por sessão, para que os dados armazenados em cache não sejam compartilhados com outros usuários no computador.</span><span class="sxs-lookup"><span data-stu-id="149ba-113">Only one user should be allowed per session, so that the cached data is not shared with other users on the computer.</span></span> <span data-ttu-id="149ba-114">Para obter mais informações, consulte [visão geral das sessões do WinHTTP](winhttp-sessions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="149ba-114">For more information, see [WinHTTP Sessions Overview](winhttp-sessions-overview.md).</span></span>

<span data-ttu-id="149ba-115">Se o serviço fora do processo estiver ativo quando [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) for chamado, a URL e o script do AutoProxy armazenados em cache estarão disponíveis para todo o computador.</span><span class="sxs-lookup"><span data-stu-id="149ba-115">If the out-of-process service is active when [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) is called, the cached autoproxy URL and script are available to the whole computer.</span></span> <span data-ttu-id="149ba-116">No entanto, se o serviço fora do processo for usado e o sinalizador **fAutoLogonIfChallenged** na estrutura *pAutoProxyOptions* for true, a URL e o script do AutoProxy não serão armazenados em cache.</span><span class="sxs-lookup"><span data-stu-id="149ba-116">However, if the out-of-process service is used, and the **fAutoLogonIfChallenged** flag in the *pAutoProxyOptions* structure is true, then the autoproxy URL and script are not cached.</span></span> <span data-ttu-id="149ba-117">Portanto, chamar **WinHttpGetProxyForUrl** com o membro **FAutoLogonIfChallenged** definido como **true** resulta em operações de sobrecarga adicionais que podem afetar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="149ba-117">Therefore, calling **WinHttpGetProxyForUrl** with the **fAutoLogonIfChallenged** member set to **TRUE** results in additional overhead operations that may affect performance.</span></span> <span data-ttu-id="149ba-118">As etapas a seguir podem ser usadas para melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="149ba-118">The following steps can be used to improve performance.</span></span>

<span data-ttu-id="149ba-119">**Para melhorar o desempenho**</span><span class="sxs-lookup"><span data-stu-id="149ba-119">**To improve performance**</span></span>

1.  <span data-ttu-id="149ba-120">Chame [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) com o parâmetro fAutoLogonIfChallenged definido como **false**.</span><span class="sxs-lookup"><span data-stu-id="149ba-120">Call [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) with the fAutoLogonIfChallenged parameter set to **false**.</span></span> <span data-ttu-id="149ba-121">A URL e o script do AutoProxy são armazenados em cache para chamadas futuras para **WinHttpGetProxyForUrl**.</span><span class="sxs-lookup"><span data-stu-id="149ba-121">The autoproxy URL and script are cached for future calls to **WinHttpGetProxyForUrl**.</span></span>
2.  <span data-ttu-id="149ba-122">Se a etapa 1 falhar, com **erro de \_ \_ \_ falha de logon WinHTTP**, chame [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) com o membro **fAutoLogonIfChallenged** definido como **true**.</span><span class="sxs-lookup"><span data-stu-id="149ba-122">If Step 1 fails, with **ERROR\_WINHTTP\_LOGIN\_FAILURE**, then call [**WinHttpGetProxyForUrl**](/windows/desktop/api/Winhttp/nf-winhttp-winhttpgetproxyforurl) with the **fAutoLogonIfChallenged** member set to **TRUE**.</span></span>

 

 



