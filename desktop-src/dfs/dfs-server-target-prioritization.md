---
title: Priorização de destino do servidor DFS
description: A priorização de destino do servidor DFS é um recurso disponível no Microsoft Windows Server 2003 com Service Pack 1 (SP1) e sistemas operacionais posteriores.
ms.assetid: 0aacebf7-49cc-4287-a5c4-0d25a416d227
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3e784a540a67f624ca5b8075009cd862c6063427
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104164155"
---
# <a name="dfs-server-target-prioritization"></a><span data-ttu-id="e6309-103">Priorização de destino do servidor DFS</span><span class="sxs-lookup"><span data-stu-id="e6309-103">DFS Server Target Prioritization</span></span>

<span data-ttu-id="e6309-104">A priorização de destino do servidor DFS é um recurso disponível no Microsoft Windows Server 2003 com Service Pack 1 (SP1) e sistemas operacionais posteriores.</span><span class="sxs-lookup"><span data-stu-id="e6309-104">DFS Server Target Prioritization is a feature available in Microsoft Windows Server 2003 with Service Pack 1 (SP1) and later operating systems.</span></span> <span data-ttu-id="e6309-105">Esse recurso permite que os servidores DFS tirem proveito do Active Directory informações de custo de site disponíveis para priorizar os destinos nas referências do cliente.</span><span class="sxs-lookup"><span data-stu-id="e6309-105">This feature enables DFS servers to take advantage of available Active Directory site-cost information to prioritize the targets in client referrals.</span></span>

<span data-ttu-id="e6309-106">Antes do Windows Server 2003 com SP1, os destinos foram agrupados em dois conjuntos: um grupo para conter todos os destinos no mesmo site que o cliente; e outro grupo para todos os outros destinos.</span><span class="sxs-lookup"><span data-stu-id="e6309-106">Before Windows Server 2003 with SP1, targets were grouped into two sets: one group for containing all targets in the same site as the client; and another group for all other targets.</span></span> <span data-ttu-id="e6309-107">Esses destinos que compartilham o mesmo site que o cliente são chamados "no local" e, se o custo do site estiver habilitado, eles receberão um valor de custo específico relativo ao site em geral, com custos de site mais baixos preferenciais mais altos.</span><span class="sxs-lookup"><span data-stu-id="e6309-107">Those targets sharing the same site as the client are called "in-site", and if site-costing is enabled, they are assigned a specific cost value relative to the site overall, with lower site costs preferred over higher ones.</span></span>

<span data-ttu-id="e6309-108">Com a disponibilidade desses dados de custo de site, os destinos de servidor podem ser priorizados para estratégias de failover de servidor DFS mais eficazes.</span><span class="sxs-lookup"><span data-stu-id="e6309-108">With the availability of this site-costing data, server targets can be prioritized for more effective DFS server failover strategies.</span></span> <span data-ttu-id="e6309-109">No passado, esse nível granular de detalhes não estava disponível, e os administradores tinham que recorrer a meios artificiais (como sites fictícios no AD) para dar suporte a requisitos ainda simples, como a designação de servidores específicos como um servidor de "backup" ou "secundário" no caso em que um servidor DFS "primário" falha.</span><span class="sxs-lookup"><span data-stu-id="e6309-109">In the past, this granular level of detail was not available, and administrators had to resort to artificial means (such as dummy sites in AD) to support even simple requirements like the designation of specific servers as a "backup" or "secondary" server in the case where a "primary" DFS server fails.</span></span> <span data-ttu-id="e6309-110">Agora, com os detalhes adicionais fornecidos pelas estratégias de failover de vários níveis e de custo de site, é possível.</span><span class="sxs-lookup"><span data-stu-id="e6309-110">Now, with the additional detail provided by site-costing, multi-level failover strategies are possible.</span></span>

<span data-ttu-id="e6309-111">A discussão a seguir pressupõe que o custo do site está habilitado.</span><span class="sxs-lookup"><span data-stu-id="e6309-111">The following discussion assumes that site-costing is enabled.</span></span>

## <a name="target-prioritization"></a><span data-ttu-id="e6309-112">Priorização de destino</span><span class="sxs-lookup"><span data-stu-id="e6309-112">Target Prioritization</span></span>

<span data-ttu-id="e6309-113">A prioridade de destino é uma ordem específica de uma perspectiva administrativa, classificando e classificando servidores no site em termos de preferência explícita com base no custo do site de um cliente DFS.</span><span class="sxs-lookup"><span data-stu-id="e6309-113">Target priority is a specific ordering from an administrative perspective, classifying and ranking in-site servers in terms of explicit preference based on their site cost from a DFS client.</span></span> <span data-ttu-id="e6309-114">A prioridade global é independente do custo do site.</span><span class="sxs-lookup"><span data-stu-id="e6309-114">Global priority is independent of the site-cost.</span></span> <span data-ttu-id="e6309-115">Observe que as classes de prioridade global não indicam necessariamente os destinos mais ideais da perspectiva de um cliente de DFS, mas sim a importância, ou a falta de importância, de destinos específicos da perspectiva de um administrador de site.</span><span class="sxs-lookup"><span data-stu-id="e6309-115">Note that global priority classes do not necessarily indicate the most optimal targets from a DFS client's perspective, but instead reflect the importance, or lack of importance, of specific targets from a site administrator's perspective.</span></span>

<span data-ttu-id="e6309-116">A prioridade de destino do servidor é dividida em duas categorias de valor: classe de prioridade e classificação de prioridade.</span><span class="sxs-lookup"><span data-stu-id="e6309-116">Server target priority is divided into two value categories: priority class and priority rank.</span></span> <span data-ttu-id="e6309-117">As classes de prioridade são divididas em dois níveis: local e global.</span><span class="sxs-lookup"><span data-stu-id="e6309-117">Priority classes are divided into two levels: local and global.</span></span> <span data-ttu-id="e6309-118">Nessas classes, há uma ordem aproximada dos destinos com base no custo do site, agrupados como alta, normal e baixa prioridade.</span><span class="sxs-lookup"><span data-stu-id="e6309-118">Within these classes there is a rough ordering of targets based on site cost, grouped as high, normal, and low priority.</span></span> <span data-ttu-id="e6309-119">O resultado é cinco classes de prioridade, de acordo com a prioridade mais alta para a mais baixa, como a seguir:</span><span class="sxs-lookup"><span data-stu-id="e6309-119">The result is five priority classes, in order from highest to lowest priority as follows:</span></span>

- <span data-ttu-id="e6309-120">Alta prioridade global</span><span class="sxs-lookup"><span data-stu-id="e6309-120">Global high priority</span></span>
- <span data-ttu-id="e6309-121">Prioridade alta de custo de site</span><span class="sxs-lookup"><span data-stu-id="e6309-121">Site-cost high priority</span></span>
- <span data-ttu-id="e6309-122">Prioridade normal de custo do site</span><span class="sxs-lookup"><span data-stu-id="e6309-122">Site-cost normal priority</span></span>
- <span data-ttu-id="e6309-123">Prioridade baixa de custo de site</span><span class="sxs-lookup"><span data-stu-id="e6309-123">Site-cost low priority</span></span>
- <span data-ttu-id="e6309-124">Prioridade baixa global</span><span class="sxs-lookup"><span data-stu-id="e6309-124">Global low priority</span></span>

<span data-ttu-id="e6309-125">As classes de custo de site podem ser consideradas como subdivisãos de "prioridade normal global".</span><span class="sxs-lookup"><span data-stu-id="e6309-125">The site-cost classes can be considered as subdivisions of "global normal priority".</span></span> <span data-ttu-id="e6309-126">A classificação de prioridade é uma classificação de inteiro simples com base em valores ordinais: 0, 1, 2 e em diante, sendo que 0 é o valor mais alto e todos os valores subsequentes que indicam a classificação decrescente.</span><span class="sxs-lookup"><span data-stu-id="e6309-126">Priority rank is a simple integer ranking based on ordinal values: 0, 1, 2, and onward, with 0 being the highest value and all subsequent values indicating decreasing rank.</span></span>

<span data-ttu-id="e6309-127">As prioridades globais alta e baixa não consideram os valores de custo de site.</span><span class="sxs-lookup"><span data-stu-id="e6309-127">The global high and low priorities do not consider site-cost values.</span></span> <span data-ttu-id="e6309-128">Destinos com uma preferência de recebimento de alta prioridade global em todos os outros destinos e destinos com uma prioridade baixa global recebem a preferência menos.</span><span class="sxs-lookup"><span data-stu-id="e6309-128">Targets with a global high priority receive preference over all other targets, and targets with a global low priority receive the least preference.</span></span>

<span data-ttu-id="e6309-129">Ao ordenar uma referência, o processo completo tem as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="e6309-129">In ordering a referral, the complete process has the following steps:</span></span>

1. <span data-ttu-id="e6309-130">Os conjuntos de destinos global alto e baixo são identificados, juntamente com os destinos "globais normais" restantes.</span><span class="sxs-lookup"><span data-stu-id="e6309-130">The sets of global high and low targets are identified, along with the remaining "global normal" targets.</span></span>
2. <span data-ttu-id="e6309-131">Se a opção "Insite" for definida, todos os destinos fora do site do cliente serão removidos.</span><span class="sxs-lookup"><span data-stu-id="e6309-131">If the "INSITE" option is set, all targets outside of the client's site are removed.</span></span> <span data-ttu-id="e6309-132">A opção "Insite" não é aplicada aos conjuntos de prioridade global alta e baixa.</span><span class="sxs-lookup"><span data-stu-id="e6309-132">The "INSITE" option is not applied to the global high and low priority sets.</span></span>
3. <span data-ttu-id="e6309-133">Em cada um desses três conjuntos, os destinos são ordenados usando o mecanismo de custo de site do AD, usando o custo local ou de site completo.</span><span class="sxs-lookup"><span data-stu-id="e6309-133">Within each of these three sets, the targets are ordered using the AD site-cost mechanism, using either local or full site costing.</span></span> <span data-ttu-id="e6309-134">O resultado são conjuntos de destinos de custo de site igual.</span><span class="sxs-lookup"><span data-stu-id="e6309-134">The result is sets of targets of equal site cost.</span></span>
4. <span data-ttu-id="e6309-135">Dentro dos conjuntos de destinos "globais normais" de custo de site igual, os destinos são atribuídos a uma classe de prioridade das classificações de prioridade alta, normal e baixa de custo do site.</span><span class="sxs-lookup"><span data-stu-id="e6309-135">Within the sets of "global normal" targets of equal site cost, targets are assigned a priority class from the site-cost high, normal, and low priority rankings.</span></span>
5. <span data-ttu-id="e6309-136">Dentro dos conjuntos de destinos de classe de prioridade e custo de site igual, os destinos agora são ordenados por classificação de prioridade, sendo que 0 é a classificação mais alta.</span><span class="sxs-lookup"><span data-stu-id="e6309-136">Within the sets of targets of equal site cost and priority class, targets are now ordered by priority rank, with 0 being the highest rank.</span></span>
6. <span data-ttu-id="e6309-137">Dentro dos conjuntos de destinos de custo de site igual, classe de prioridade e classificação de prioridade, os destinos são aleatoriamente aleatórios para balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="e6309-137">Within the sets of targets of equal site cost, priority class, and priority rank, targets are randomly shuffled for load balancing.</span></span>

<span data-ttu-id="e6309-138">Graficamente, um conjunto de destinos é ordenado como mostrado abaixo:</span><span class="sxs-lookup"><span data-stu-id="e6309-138">Graphically, a set of targets are ordered as seen below:</span></span>

- <span data-ttu-id="e6309-139">destinos de classe de alta prioridade global</span><span class="sxs-lookup"><span data-stu-id="e6309-139">global high priority class targets</span></span> 
- <span data-ttu-id="e6309-140">destinos de classe de alta prioridade de custo de site com custo do site = 0</span><span class="sxs-lookup"><span data-stu-id="e6309-140">site-cost high priority class targets with site cost = 0</span></span>
- <span data-ttu-id="e6309-141">normal com custo do site = 0</span><span class="sxs-lookup"><span data-stu-id="e6309-141">normal with site cost = 0</span></span>
- <span data-ttu-id="e6309-142">baixo com custo do site = 0</span><span class="sxs-lookup"><span data-stu-id="e6309-142">low with site cost = 0</span></span>
- <span data-ttu-id="e6309-143">destinos de classe de alta prioridade de custo de site com custo de site = 1</span><span class="sxs-lookup"><span data-stu-id="e6309-143">site-cost high priority class targets with site cost = 1</span></span>
- <span data-ttu-id="e6309-144">normal com custo do site = 1</span><span class="sxs-lookup"><span data-stu-id="e6309-144">normal with site cost = 1</span></span>
- <span data-ttu-id="e6309-145">baixo com custo do site = 1</span><span class="sxs-lookup"><span data-stu-id="e6309-145">low with site cost = 1</span></span>
- <span data-ttu-id="e6309-146">e assim por diante</span><span class="sxs-lookup"><span data-stu-id="e6309-146">and so on</span></span>
- <span data-ttu-id="e6309-147">destinos de classe de baixa prioridade global</span><span class="sxs-lookup"><span data-stu-id="e6309-147">global low priority class targets</span></span>

<span data-ttu-id="e6309-148">Dentro de cada um desses conjuntos, os destinos são classificados de acordo com a classificação de prioridade.</span><span class="sxs-lookup"><span data-stu-id="e6309-148">Within each of these sets, targets are sorted according to priority rank.</span></span> <span data-ttu-id="e6309-149">A classificação mais alta é zero, com cada valor inteiro subsequente (1, 2 e assim por diante) indicando uma classificação cada vez mais baixa.</span><span class="sxs-lookup"><span data-stu-id="e6309-149">The highest rank is zero, with each subsequent integer value (1, 2, and so on) indicating an increasingly lower rank.</span></span>

<span data-ttu-id="e6309-150">A prioridade de destino é definida em um destino específico de um link (ou raiz) em um namespace do DFS.</span><span class="sxs-lookup"><span data-stu-id="e6309-150">Target priority is set on a specific target of a link (or root) in a DFS namespace.</span></span> <span data-ttu-id="e6309-151">A prioridade de um destino para um link não influenciará a ordenação de outros links se o mesmo caminho de destino for usado várias vezes.</span><span class="sxs-lookup"><span data-stu-id="e6309-151">A target's priority for one link does not influence the ordering of other links if that same target path is used multiple times.</span></span> <span data-ttu-id="e6309-152">Por exemplo, se dois links tiverem \\ \\ \\ o servidor share1 como um destino, a prioridade do \\ \\ servidor \\ share1 será definida separadamente para ambos os links.</span><span class="sxs-lookup"><span data-stu-id="e6309-152">For example, if two links have \\\\server\\share1 as a target, the priority of \\\\server\\share1 is set separately for both links.</span></span>

<span data-ttu-id="e6309-153">A prioridade padrão para todos os links é a prioridade normal de custo de site com uma classificação de 0.</span><span class="sxs-lookup"><span data-stu-id="e6309-153">The default priority for all links is the site-cost normal priority with a rank of 0.</span></span> <span data-ttu-id="e6309-154">A prioridade de destino não afeta a ordenação de referências, a menos que seja usada, e todos os links existentes são ordenados à medida que são recebidos.</span><span class="sxs-lookup"><span data-stu-id="e6309-154">Target priority does not affect the ordering of referrals unless it is used, and all existing links are ordered as they are received.</span></span>

<span data-ttu-id="e6309-155">A resposta de referência de um servidor DFS consiste em conjuntos de destino ordenados conforme indicado acima, com cada conjunto de destino não global que contém destinos do mesmo custo do site, classe de prioridade e classificação de prioridade.</span><span class="sxs-lookup"><span data-stu-id="e6309-155">The referral response from a DFS server consists of target sets ordered as indicated above, with each non-global target set containing targets of the same site cost, priority class, and priority rank.</span></span> <span data-ttu-id="e6309-156">Os destinos dentro de cada conjunto são ordenados aleatoriamente.</span><span class="sxs-lookup"><span data-stu-id="e6309-156">Targets within each set are ordered randomly.</span></span> <span data-ttu-id="e6309-157">Clientes DFS que recebem a referência começam com o primeiro destino do primeiro conjunto e continuam na lista até que um destino disponível para uma determinada raiz ou link do DFS seja encontrado.</span><span class="sxs-lookup"><span data-stu-id="e6309-157">DFS clients that receive the referral start with the first target of the first set, and continue through the list until an available target for a given DFS root or link is found.</span></span>

<span data-ttu-id="e6309-158">Para a implementação de API específica desse recurso, consulte os seguintes tópicos de referência:</span><span class="sxs-lookup"><span data-stu-id="e6309-158">For the specific API implementation of this feature, please see the following reference topics:</span></span>

<span data-ttu-id="e6309-159">[**DFS_INFO_6**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_info_6) 
 [**DFS_INFO_104**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_info_104) 
 [**DFS_INFO_106**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_info_106) 
 [**DFS_TARGET_PRIORITY**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_target_priority) 
 [**DFS_TARGET_PRIORITY_CLASS**](/windows/win32/api/lmdfs/ne-lmdfs-dfs_target_priority_class~r1)</span><span class="sxs-lookup"><span data-stu-id="e6309-159">[**DFS_INFO_6**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_info_6)
[**DFS_INFO_104**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_info_104)
[**DFS_INFO_106**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_info_106)
[**DFS_TARGET_PRIORITY**](/windows/desktop/api/lmdfs/ns-lmdfs-dfs_target_priority)
[**DFS_TARGET_PRIORITY_CLASS**](/windows/win32/api/lmdfs/ne-lmdfs-dfs_target_priority_class~r1)</span></span>
