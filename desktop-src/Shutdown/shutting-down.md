---
description: 'Há três maneiras de um aplicativo desligar computadores locais ou remotos: Desligue o systemshut do sistema e reinicie o itshut do aplicativo, desligue e reinicie o sistema e reinicie todos os aplicativos que foram registrados para reinicialização'
ms.assetid: acadf58f-3f68-4fa1-bdcf-8f85c8479263
title: Desligando
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e436dd9e3b115112e63b0440b4d51de4c7f9f619
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105753708"
---
# <a name="shutting-down"></a><span data-ttu-id="eccf6-103">Desligando</span><span class="sxs-lookup"><span data-stu-id="eccf6-103">Shutting Down</span></span>

<span data-ttu-id="eccf6-104">Há três maneiras de um aplicativo desligar computadores locais ou remotos:</span><span class="sxs-lookup"><span data-stu-id="eccf6-104">There are three ways for an application to shut down local or remote computers:</span></span>

-   <span data-ttu-id="eccf6-105">desligar o sistema</span><span class="sxs-lookup"><span data-stu-id="eccf6-105">shut down the system</span></span>
-   <span data-ttu-id="eccf6-106">desligar o sistema e reiniciá-lo</span><span class="sxs-lookup"><span data-stu-id="eccf6-106">shut down the system and restart it</span></span>
-   <span data-ttu-id="eccf6-107">Desligue o aplicativo, desligue e reinicie o sistema e reinicie todos os aplicativos que foram registrados para reinicialização</span><span class="sxs-lookup"><span data-stu-id="eccf6-107">shut down the application, shut down and restart the system, and restart any applications that have been registered for restart</span></span>

<span data-ttu-id="eccf6-108">Para desligar o sistema, use a função [**ExitWindowsEx**](/windows/desktop/api/Winuser/nf-winuser-exitwindowsex) com o sinalizador de \_ desligamento EWX.</span><span class="sxs-lookup"><span data-stu-id="eccf6-108">To shut down the system, use the [**ExitWindowsEx**](/windows/desktop/api/Winuser/nf-winuser-exitwindowsex) function with the EWX\_SHUTDOWN flag.</span></span> <span data-ttu-id="eccf6-109">Para obter um exemplo, consulte [como desligar o sistema](how-to-shut-down-the-system.md).</span><span class="sxs-lookup"><span data-stu-id="eccf6-109">For an example, see [How to Shut Down the System](how-to-shut-down-the-system.md).</span></span> <span data-ttu-id="eccf6-110">Para desligar e reiniciar o sistema, use o sinalizador de \_ reinicialização EWX.</span><span class="sxs-lookup"><span data-stu-id="eccf6-110">To shut down and restart the system, use the EWX\_REBOOT flag.</span></span> <span data-ttu-id="eccf6-111">Para reiniciar os aplicativos que foram registrados para reinicialização usando a função [**RegisterApplicationRestart**](/windows/win32/api/winbase/nf-winbase-registerapplicationrestart) , use o \_ sinalizador EXW RESTARTAPPS.</span><span class="sxs-lookup"><span data-stu-id="eccf6-111">To restart any applications that have been registered for restart using the [**RegisterApplicationRestart**](/windows/win32/api/winbase/nf-winbase-registerapplicationrestart) function, use the EXW\_RESTARTAPPS flag.</span></span>

<span data-ttu-id="eccf6-112">As funções [**InitiateShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiateshutdowna), [**InitiateSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdowna)e [**InitiateSystemShutdownEx**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdownexa) iniciam um temporizador e exibem uma caixa de diálogo que solicita que o usuário faça logoff.</span><span class="sxs-lookup"><span data-stu-id="eccf6-112">The [**InitiateShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiateshutdowna), [**InitiateSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdowna), and [**InitiateSystemShutdownEx**](/windows/desktop/api/Winreg/nf-winreg-initiatesystemshutdownexa) functions start a timer and display a dialog box that prompts the user to log off.</span></span> <span data-ttu-id="eccf6-113">Enquanto essa caixa de diálogo é exibida, a função [**AbortSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-abortsystemshutdowna) pode parar o temporizador e impedir que o computador seja desligado.</span><span class="sxs-lookup"><span data-stu-id="eccf6-113">While this dialog box is displayed, the [**AbortSystemShutdown**](/windows/desktop/api/Winreg/nf-winreg-abortsystemshutdowna) function can stop the timer and prevent the computer from shutting down.</span></span> <span data-ttu-id="eccf6-114">No entanto, se o temporizador expirar, o computador será desligado.</span><span class="sxs-lookup"><span data-stu-id="eccf6-114">However, if the timer expires, the computer is shut down.</span></span> <span data-ttu-id="eccf6-115">Essas funções também podem reiniciar o computador após uma operação de desligamento.</span><span class="sxs-lookup"><span data-stu-id="eccf6-115">These functions can also restart the computer following a shutdown operation.</span></span> <span data-ttu-id="eccf6-116">Para obter mais informações, consulte [exibindo a caixa de diálogo de desligamento](displaying-the-shutdown-dialog-box.md).</span><span class="sxs-lookup"><span data-stu-id="eccf6-116">For more information, see [Displaying the Shutdown Dialog Box](displaying-the-shutdown-dialog-box.md).</span></span>

## <a name="shutdown-notifications"></a><span data-ttu-id="eccf6-117">Notificações de desligamento</span><span class="sxs-lookup"><span data-stu-id="eccf6-117">Shutdown Notifications</span></span>

<span data-ttu-id="eccf6-118">Os aplicativos com uma janela e fila de mensagens recebem notificações de desligamento por meio das mensagens de [**\_ EndSession**](wm-endsession.md) do [**WM \_ QUERYENDSESSION**](wm-queryendsession.md) e do WM.</span><span class="sxs-lookup"><span data-stu-id="eccf6-118">Applications with a window and message queue receive shutdown notifications through the [**WM\_QUERYENDSESSION**](wm-queryendsession.md) and [**WM\_ENDSESSION**](wm-endsession.md) messages.</span></span> <span data-ttu-id="eccf6-119">Esses aplicativos devem retornar **true** para indicar que eles podem ser encerrados.</span><span class="sxs-lookup"><span data-stu-id="eccf6-119">These applications should return **TRUE** to indicate that they can be terminated.</span></span> <span data-ttu-id="eccf6-120">Os aplicativos não devem bloquear o desligamento do sistema, a menos que seja absolutamente necessário.</span><span class="sxs-lookup"><span data-stu-id="eccf6-120">Applications should not block system shutdown unless it is absolutely necessary.</span></span> <span data-ttu-id="eccf6-121">Os aplicativos devem executar qualquer limpeza necessária durante o processamento do **WM \_ EndSession**.</span><span class="sxs-lookup"><span data-stu-id="eccf6-121">Applications should perform any required cleanup while processing **WM\_ENDSESSION**.</span></span> <span data-ttu-id="eccf6-122">Os aplicativos que têm dados não salvos podem salvar os dados em um local temporário e restaurá-los na próxima vez que o aplicativo for iniciado.</span><span class="sxs-lookup"><span data-stu-id="eccf6-122">Applications that have unsaved data could save the data to a temporary location and restore it the next time the application starts.</span></span> <span data-ttu-id="eccf6-123">É recomendável que os aplicativos salvem seus dados e Estados com frequência; por exemplo, salve automaticamente os dados entre as operações de salvamento iniciadas pelo usuário para reduzir a quantidade de dados a serem salvos no desligamento.</span><span class="sxs-lookup"><span data-stu-id="eccf6-123">It is recommended that applications save their data and state frequently; for example, automatically save data between save operations initiated by the user to reduce the amount of data to be saved at shutdown.</span></span>

<span data-ttu-id="eccf6-124">Os aplicativos de console recebem notificações de desligamento em suas rotinas de manipulador.</span><span class="sxs-lookup"><span data-stu-id="eccf6-124">Console applications receive shutdown notifications in their handler routines.</span></span> <span data-ttu-id="eccf6-125">Para registrar um manipulador de console, use a função [**SetConsoleCtrlHandler**](/windows/console/setconsolectrlhandler) .</span><span class="sxs-lookup"><span data-stu-id="eccf6-125">To register a console handler, use the [**SetConsoleCtrlHandler**](/windows/console/setconsolectrlhandler) function.</span></span>

<span data-ttu-id="eccf6-126">Os aplicativos de serviço recebem notificações de desligamento em suas rotinas de manipulador.</span><span class="sxs-lookup"><span data-stu-id="eccf6-126">Service applications receive shutdown notifications in their handler routines.</span></span> <span data-ttu-id="eccf6-127">Para registrar um manipulador de controle de serviço, use a função [**RegisterServiceCtrlHandlerEx**](/windows/win32/api/winsvc/nf-winsvc-registerservicectrlhandlerexa) .</span><span class="sxs-lookup"><span data-stu-id="eccf6-127">To register a service control handler, use the [**RegisterServiceCtrlHandlerEx**](/windows/win32/api/winsvc/nf-winsvc-registerservicectrlhandlerexa) function.</span></span>

## <a name="blocking-shutdown"></a><span data-ttu-id="eccf6-128">Desligando o bloqueio</span><span class="sxs-lookup"><span data-stu-id="eccf6-128">Blocking Shutdown</span></span>

<span data-ttu-id="eccf6-129">Se um aplicativo precisar bloquear um possível desligamento do sistema, ele poderá chamar a função [**ShutdownBlockReasonCreate**](/windows/desktop/api/Winuser/nf-winuser-shutdownblockreasoncreate) .</span><span class="sxs-lookup"><span data-stu-id="eccf6-129">If an application must block a potential system shutdown, it can call the [**ShutdownBlockReasonCreate**](/windows/desktop/api/Winuser/nf-winuser-shutdownblockreasoncreate) function.</span></span> <span data-ttu-id="eccf6-130">O chamador fornece uma cadeia de caracteres de motivo que será exibida para o usuário.</span><span class="sxs-lookup"><span data-stu-id="eccf6-130">The caller provides a reason string that will be displayed to the user.</span></span> <span data-ttu-id="eccf6-131">A cadeia de caracteres de motivo deve ser curta e clara, fornecendo ao usuário as informações necessárias para decidir se deseja continuar desligando o sistema.</span><span class="sxs-lookup"><span data-stu-id="eccf6-131">The reason string should be short and clear, providing the user with the information necessary to decide whether to continue shutting down the system.</span></span>

## <a name="related-topics"></a><span data-ttu-id="eccf6-132">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="eccf6-132">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="eccf6-133">Como desligar o sistema</span><span class="sxs-lookup"><span data-stu-id="eccf6-133">How to Shut Down the System</span></span>](how-to-shut-down-the-system.md)
</dt> </dl>

 

 
