---
description: Saiba mais sobre o controle de versão do TSPI. Com o tempo, versões diferentes de TAPI, aplicativos e provedores de serviços podem ser produzidos.
ms.assetid: 994fad0e-5958-4d93-8952-9db2bbe01f44
title: Controle de versão do TSPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e0a0663a1fcc685df8643c634ec627f669aafe8
ms.sourcegitcommit: 6fc8a7419bd01787cf6a1c52c355a4a2d1aec471
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/10/2021
ms.locfileid: "111989231"
---
# <a name="tspi-versioning"></a><span data-ttu-id="3498e-104">Controle de versão do TSPI</span><span class="sxs-lookup"><span data-stu-id="3498e-104">TSPI Versioning</span></span>

<span data-ttu-id="3498e-105">Com o tempo, versões diferentes de TAPI, aplicativos e provedores de serviços podem ser produzidos.</span><span class="sxs-lookup"><span data-stu-id="3498e-105">Over time, different versions of TAPI, applications, and service providers may be produced.</span></span> <span data-ttu-id="3498e-106">Essas novas versões podem fazer novas definições, como para novos recursos, novos membros em estruturas de dados e novos campos de bits.</span><span class="sxs-lookup"><span data-stu-id="3498e-106">These new versions can make new definitions, such as for new features, new members in data structures, and new bit fields.</span></span> <span data-ttu-id="3498e-107">Portanto, os números de versão são necessários para indicar como interpretar várias estruturas de dados.</span><span class="sxs-lookup"><span data-stu-id="3498e-107">Version numbers are therefore necessary to indicate how to interpret various data structures.</span></span>

<span data-ttu-id="3498e-108">Para permitir a interoperabilidade ideal de diferentes versões de aplicativos, versões da própria TAPI e versões de provedores de serviço por diferentes fornecedores, a telefonia da Microsoft fornece um mecanismo de negociação de versão simples para aplicativos.</span><span class="sxs-lookup"><span data-stu-id="3498e-108">To allow optimal interoperability of different versions of applications, versions of TAPI itself, and versions of service providers by different vendors, Microsoft Telephony provides a simple version negotiation mechanism for applications.</span></span> <span data-ttu-id="3498e-109">Há duas versões diferentes que precisam ser acordadas pela TAPI e pelo provedor de serviços de telefonia para cada dispositivo de linha.</span><span class="sxs-lookup"><span data-stu-id="3498e-109">There are two different versions that need to be agreed on by TAPI and the telephony service provider for each line device.</span></span> <span data-ttu-id="3498e-110">O primeiro é o número de versão para o SPI de telefonia básico e suplementar, chamado de versão da *interface TSPI*.</span><span class="sxs-lookup"><span data-stu-id="3498e-110">The first is the version number for the Basic and Supplementary Telephony SPI, referred to as the *TSPI interface version*.</span></span> <span data-ttu-id="3498e-111">O outro é para extensões específicas do provedor, se houver, e é chamado de versão de *extensão*.</span><span class="sxs-lookup"><span data-stu-id="3498e-111">The other is for provider-specific extensions, if any, and is referred to as the *extension version*.</span></span> <span data-ttu-id="3498e-112">O formato das estruturas e dos tipos de dados usados pelos recursos básicos e complementares do TSPI é definido pela versão do TSPI, enquanto a versão da extensão determina o formato das estruturas de dados definidas pelas extensões específicas do fornecedor.</span><span class="sxs-lookup"><span data-stu-id="3498e-112">The format of the data structures and datatypes used by TSPI's Basic and Supplementary features is defined by the TSPI version, while the extension version determines the format of data structures defined by the vendor-specific extensions.</span></span>

<span data-ttu-id="3498e-113">Esses dois tipos de negociação de versão são tratados por dois procedimentos diferentes: [**TSPI \_ lineNegotiateTSPIVersion**](/windows/win32/api/tspi/nf-tspi-tspi_linenegotiatetspiversion) é usado para negociar a versão da interface TSPI e [**TSPI \_ lineNegotiateExtVersion**](/windows/win32/api/tspi/nf-tspi-tspi_linenegotiateextversion) é usado para negociar a versão da extensão.</span><span class="sxs-lookup"><span data-stu-id="3498e-113">These two types of version negotiation are handled by two different procedures: [**TSPI\_lineNegotiateTSPIVersion**](/windows/win32/api/tspi/nf-tspi-tspi_linenegotiatetspiversion) is used to negotiate the TSPI interface version, and [**TSPI\_lineNegotiateExtVersion**](/windows/win32/api/tspi/nf-tspi-tspi_linenegotiateextversion) is used to negotiate the extension version.</span></span> <span data-ttu-id="3498e-114">A negociação de versão de extensão poderá ser ignorada se as extensões não forem desejadas.</span><span class="sxs-lookup"><span data-stu-id="3498e-114">Extension version negotiation can be skipped if extensions are not wanted.</span></span> <span data-ttu-id="3498e-115">Se esses intervalos forem inseridos durante a sobreposição de negociação, o provedor de serviços deverá retornar um valor dentro da parte sobreposta do intervalo como o resultado da negociação.</span><span class="sxs-lookup"><span data-stu-id="3498e-115">If these ranges input during negotiation overlap, the service provider must return a value within the overlapping portion of the range as the result of the negotiation.</span></span> <span data-ttu-id="3498e-116">Normalmente, isso deve ser o maior valor possível.</span><span class="sxs-lookup"><span data-stu-id="3498e-116">Usually, this should be the highest possible value.</span></span> <span data-ttu-id="3498e-117">Se os intervalos não se sobrepõem, as duas partes são incompatíveis e a função retorna um erro.</span><span class="sxs-lookup"><span data-stu-id="3498e-117">If the ranges do not overlap, the two parties are incompatible and the function returns an error.</span></span>

<span data-ttu-id="3498e-118">Os resultados de uma negociação simplesmente indicam que o provedor de serviços está disposto a operar em um determinado número de versão, mas não confirma o provedor de serviços para fazê-lo.</span><span class="sxs-lookup"><span data-stu-id="3498e-118">Results of a negotiation simply indicate that the service provider is willing to operate at a particular version number, but do not commit the service provider to doing so.</span></span> <span data-ttu-id="3498e-119">Por exemplo, a TAPI pode ser renegociada para determinar uma versão ideal depois de ter negociado uma versão possível.</span><span class="sxs-lookup"><span data-stu-id="3498e-119">For example, TAPI can renegotiate to determine an ideal version after having negotiated a possible version.</span></span> <span data-ttu-id="3498e-120">A versão da interface TSPI só é confirmada quando uma linha é aberta usando [**\_ lineOpen TSPI**](/windows/win32/api/tspi/nf-tspi-tspi_lineopen) e sobreviver até que o dispositivo seja fechado.</span><span class="sxs-lookup"><span data-stu-id="3498e-120">The TSPI interface version is only committed when a line is opened using [**TSPI\_lineOpen**](/windows/win32/api/tspi/nf-tspi-tspi_lineopen) and survives until the device is closed.</span></span> <span data-ttu-id="3498e-121">A versão de extensão é confirmada quando a função [**TSPI \_ lineSelectExtVersion**](/windows/win32/api/tspi/nf-tspi-tspi_lineselectextversion) é chamada e sobreviver até que a seleção seja cancelada selecionando a versão de extensão zero.</span><span class="sxs-lookup"><span data-stu-id="3498e-121">The extension version is committed when the [**TSPI\_lineSelectExtVersion**](/windows/win32/api/tspi/nf-tspi-tspi_lineselectextversion) function is called, and survives until the selection is canceled by selecting extension version zero.</span></span>

<span data-ttu-id="3498e-122">A seleção de versão de extensão pode ocorrer muitas vezes, incluindo enquanto uma versão de extensão está em vigor.</span><span class="sxs-lookup"><span data-stu-id="3498e-122">Extension version selection can happen many times, including while an extension version is in effect.</span></span> <span data-ttu-id="3498e-123">Como o provedor de serviços está comprometido com a versão de extensão, seu intervalo de versões com suporte limita exatamente essa versão de extensão.</span><span class="sxs-lookup"><span data-stu-id="3498e-123">Because the service provider is committed to the extension version, its range of supported versions narrows to exactly that extension version.</span></span> <span data-ttu-id="3498e-124">Por exemplo, considere um provedor de serviços que normalmente é compatível com as versões de extensão 1,0 a 5,5.</span><span class="sxs-lookup"><span data-stu-id="3498e-124">For example, consider a service provider that is normally compatible with extension versions 1.0 through 5.5.</span></span> <span data-ttu-id="3498e-125">Se a versão 3,0 estiver em vigor enquanto um chamador tentar negociar uma versão dentro do intervalo de 1,0 a 5,5, a negociação retornará 3,0.</span><span class="sxs-lookup"><span data-stu-id="3498e-125">If version 3.0 is in effect while a caller attempts to negotiate a version within the range 1.0 to 5.5, the negotiation returns 3.0.</span></span>

<span data-ttu-id="3498e-126">Como a TAPI negocia a versão, você pode atualizar um provedor de serviços para novas versões da interface sem exigir que a TAPI também seja atualizada.</span><span class="sxs-lookup"><span data-stu-id="3498e-126">Because TAPI negotiates the version, you can upgrade a service provider to new versions of the interface without requiring that TAPI also be upgraded.</span></span> <span data-ttu-id="3498e-127">Da mesma forma, a TAPI pode ser atualizada e ainda usar o provedor de serviços mais antigo.</span><span class="sxs-lookup"><span data-stu-id="3498e-127">Similarly, TAPI can be upgraded, yet still use your older service provider.</span></span>

 

 
