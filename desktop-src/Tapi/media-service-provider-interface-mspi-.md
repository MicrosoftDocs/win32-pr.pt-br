---
description: A MSPI (interface do provedor de serviços de mídia) é um conjunto de interfaces e métodos implementados por um MSP para permitir um controle de aplicativo TAPI 3 sobre o transporte de mídia durante uma sessão de comunicações.
ms.assetid: 53b7bcbd-571a-44da-a6db-10d4c3e5d30a
title: MSPI (interface do provedor de serviços de mídia)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6b1ce09e626ede14515c0abbbd5c3a35921026d6
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/03/2021
ms.locfileid: "105779452"
---
# <a name="media-service-provider-interface-mspi"></a><span data-ttu-id="c9831-103">MSPI (interface do provedor de serviços de mídia)</span><span class="sxs-lookup"><span data-stu-id="c9831-103">Media Service Provider Interface (MSPI)</span></span>

<span data-ttu-id="c9831-104">A MSPI (interface do provedor de serviços de mídia) é um conjunto de interfaces e métodos implementados por um MSP para permitir um controle de aplicativo TAPI 3 sobre o transporte de mídia durante uma sessão de comunicações.</span><span class="sxs-lookup"><span data-stu-id="c9831-104">The Media Service Provider Interface (MSPI) is a set of interfaces and methods implemented by an MSP to allow a TAPI 3 application control over media transport during a communications session.</span></span> <span data-ttu-id="c9831-105">Um MSP manipula os mecanismos específicos do dispositivo e do protocolo necessários para aplicar esses controles e se comunica com seu TSP ou aplicativo emparelhado usando os métodos fornecidos no MSPI.</span><span class="sxs-lookup"><span data-stu-id="c9831-105">An MSP handles the device-specific and protocol-specific mechanisms needed to enact these controls, and communicates with its paired TSP or an application through use of the methods provided in the MSPI.</span></span>

<span data-ttu-id="c9831-106">A seção a seguir ( [referência de MSPI (interface do provedor de serviços de mídia](media-service-provider-interface-mspi-reference.md))) detalha as interfaces que o MSP expõe para interagir com o ambiente de telefonia da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="c9831-106">The following section ( [Media Service Provider Interface (MSPI) Reference](media-service-provider-interface-mspi-reference.md)) details the interfaces an MSP exposes in order to interact with the Microsoft Telephony environment.</span></span>

<span data-ttu-id="c9831-107">Além disso, um MSP pode expor interfaces privadas e métodos específicos do provedor para auxiliar ainda mais no controle de mídia.</span><span class="sxs-lookup"><span data-stu-id="c9831-107">In addition, an MSP may expose provider-specific private interfaces and methods to further assist in media control.</span></span> <span data-ttu-id="c9831-108">Por exemplo, o [IP Conference MSP](ipconf-msp.md) expõe interfaces que fornecem controle de participante.</span><span class="sxs-lookup"><span data-stu-id="c9831-108">For example, the [IP Conference MSP](ipconf-msp.md) exposes interfaces that provide participant control.</span></span> <span data-ttu-id="c9831-109">Consulte [interfaces específicas do provedor](provider-specific-interfaces.md) para obter informações sobre como os objetos privados funcionam e [IPConf as interfaces MSP](ipconf-msp-interfaces.md) para obter uma listagem de referência de IPConf.</span><span class="sxs-lookup"><span data-stu-id="c9831-109">See [Provider-Specific Interfaces](provider-specific-interfaces.md) for information on how private objects work and [IPConf MSP Interfaces](ipconf-msp-interfaces.md) for a reference listing of IPConf.</span></span>

<span data-ttu-id="c9831-110">A maior parte do esforço de programação na criação de um MSP é altamente específica para uma determinada plataforma, dispositivo e protocolo de transporte e está fora do escopo deste documento.</span><span class="sxs-lookup"><span data-stu-id="c9831-110">The majority of the programming effort in creating an MSP is highly specific to a given platform, device, and transport protocol, and is outside the scope of this document.</span></span> <span data-ttu-id="c9831-111">No entanto, a Microsoft fornece um conjunto de classes base MSP, que será útil para a maioria dos autores MSP.</span><span class="sxs-lookup"><span data-stu-id="c9831-111">However, Microsoft supplies a set of MSP base classes, which will be useful to most MSP authors.</span></span> <span data-ttu-id="c9831-112">Consulte [classes base TAPI 3 MSP](tapi-3-msp-base-classes.md) para obter informações sobre como usar essas classes.</span><span class="sxs-lookup"><span data-stu-id="c9831-112">See [TAPI 3 MSP Base Classes](tapi-3-msp-base-classes.md) for information on using these classes.</span></span>

<span data-ttu-id="c9831-113">A interface [**ITMSPAddress**](/windows/desktop/api/msp/nn-msp-itmspaddress) representa um provedor de serviços de mídia para a dll TAPI.</span><span class="sxs-lookup"><span data-stu-id="c9831-113">The [**ITMSPAddress**](/windows/desktop/api/msp/nn-msp-itmspaddress) interface represents a media service provider to the TAPI DLL.</span></span> <span data-ttu-id="c9831-114">Essa interface não é usada pelo ou exposta a um aplicativo de usuário final.</span><span class="sxs-lookup"><span data-stu-id="c9831-114">This interface is not used by or exposed to an end-user application.</span></span> <span data-ttu-id="c9831-115">A DLL TAPI 3 chama **CoCreateInstance** nessa interface para criar o objeto MSP principal.</span><span class="sxs-lookup"><span data-stu-id="c9831-115">The TAPI 3 DLL calls **CoCreateInstance** on this interface to create the main MSP object.</span></span> <span data-ttu-id="c9831-116">Os métodos nesse objeto permitem que um aplicativo carregue e descarregue o MSP, receba informações de um TSP e crie a interface [**ITStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itstreamcontrol) , que é exposta no objeto de chamada.</span><span class="sxs-lookup"><span data-stu-id="c9831-116">Methods on this object allow an application to load and unload the MSP, receive information from a TSP, and create the [**ITStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itstreamcontrol) interface, which is exposed on the call object.</span></span>

<span data-ttu-id="c9831-117">As interfaces [**ITSubStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itsubstreamcontrol) e [**ITSubStream**](/windows/win32/api/tapi3if/nn-tapi3if-itsubstream) fornecem métodos paralelos em relação aos subfluxos.</span><span class="sxs-lookup"><span data-stu-id="c9831-117">The [**ITSubStreamControl**](/windows/win32/api/tapi3if/nn-tapi3if-itsubstreamcontrol) and [**ITSubStream**](/windows/win32/api/tapi3if/nn-tapi3if-itsubstream) interfaces provide parallel methods with respect to substreams.</span></span> <span data-ttu-id="c9831-118">O suporte a Subfluxo é opcional.</span><span class="sxs-lookup"><span data-stu-id="c9831-118">Substream support is optional.</span></span> <span data-ttu-id="c9831-119">Todas as outras interfaces devem ser implementadas por um MSP.</span><span class="sxs-lookup"><span data-stu-id="c9831-119">All other interfaces must be implemented by an MSP.</span></span>

> [!Note]  
> <span data-ttu-id="c9831-120">As operações implementadas por um par de TSP/MSP devem estar localizadas em uma DLL para permitir que um usuário atualize o provedor de serviços sem reinicializar seu sistema.</span><span class="sxs-lookup"><span data-stu-id="c9831-120">Operations implemented by a TSP/MSP pair must be located in one DLL to allow a user to update the service provider without rebooting his or her system.</span></span>

 

 

 
