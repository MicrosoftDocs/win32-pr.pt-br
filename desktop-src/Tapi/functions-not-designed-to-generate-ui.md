---
description: Suponha que o provedor de serviços deve exibir uma caixa de diálogo (como a caixa de diálogo Unimodem ou ATSP Talk/desligamento) durante o processamento de lineMakeCall ou lineDial.
ms.assetid: 46f87947-bfcd-48ad-8c33-7ea4d9caa34c
title: Funções não projetadas para gerar interface do usuário
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 70bd7ed1395136d1a2d2a31b060127395e8804ac
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104505865"
---
# <a name="functions-not-designed-to-generate-ui"></a><span data-ttu-id="2f35b-103">Funções não projetadas para gerar interface do usuário</span><span class="sxs-lookup"><span data-stu-id="2f35b-103">Functions Not Designed to Generate UI</span></span>

<span data-ttu-id="2f35b-104">Suponha que o provedor de serviços deve exibir uma caixa de diálogo (como a caixa de diálogo Unimodem ou ATSP **Talk/desligamento** ) durante o processamento de [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) ou [**lineDial**](/windows/win32/api/tapi/nf-tapi-linedial).</span><span class="sxs-lookup"><span data-stu-id="2f35b-104">Assume that the service provider must display a dialog box (like the Unimodem or ATSP **Talk/Hangup** dialog box) during the processing of [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) or [**lineDial**](/windows/win32/api/tapi/nf-tapi-linedial).</span></span> <span data-ttu-id="2f35b-105">Nesse caso, é o provedor de serviços, não o aplicativo, que decide que a interface do usuário deve ser exibida.</span><span class="sxs-lookup"><span data-stu-id="2f35b-105">In this case, it is the service provider, not the application, that decides that UI must be displayed.</span></span>

<span data-ttu-id="2f35b-106">Para invocar a DLL de interface do usuário no processo do aplicativo, o provedor de serviços chama o retorno de chamada de [*\_ evento de linha*](/windows/win32/api/tspi/nc-tspi-lineevent) TSPI, gerando uma mensagem [**\_ CREATEDIALOGINSTANCE de linha**](line-createdialoginstance.md) , passando um ponteiro para uma estrutura do tipo [**TUISPICREATEDIALOGINSTANCEPARAMS**](/windows/win32/api/tspi/ns-tspi-tuispicreatedialoginstanceparams).</span><span class="sxs-lookup"><span data-stu-id="2f35b-106">To invoke the UI DLL in the application process, the service provider calls the TSPI [*Line\_Event*](/windows/win32/api/tspi/nc-tspi-lineevent) callback, generating a [**LINE\_CREATEDIALOGINSTANCE**](line-createdialoginstance.md) message, passing in a pointer to a structure of type [**TUISPICREATEDIALOGINSTANCEPARAMS**](/windows/win32/api/tspi/ns-tspi-tuispicreatedialoginstanceparams).</span></span> <span data-ttu-id="2f35b-107">Essa estrutura contém o **dwRequestID** da função com a qual a interface do usuário está associada, permitindo que TAPISRV identifique o aplicativo cliente no qual a interface do usuário deve ser gerada.</span><span class="sxs-lookup"><span data-stu-id="2f35b-107">This structure contains the **dwRequestID** of the function with which the UI is associated, allowing TAPISRV to identify the client application in which the UI is to be generated.</span></span>

<span data-ttu-id="2f35b-108">O TAPISRV solicita a instância do aplicativo TAPI correta para carregar a DLL da interface do usuário e criar um thread para a interface do usuário dentro do processo do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2f35b-108">TAPISRV requests the correct application's instance of TAPI to load the UI DLL and create a thread for the UI within the application's process.</span></span> <span data-ttu-id="2f35b-109">Desse novo thread de interface do usuário, a TAPI chama a função [**TUISPI \_ PROVIDERGENERICDIALOG**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) da dll da interface do usuário, passando dados que foram especificados pelo provedor de serviços de telefonia na estrutura passada com a mensagem [**\_ CREATEDIALOGINSTANCE**](line-createdialoginstance.md) Message; a DLL da interface do usuário exibe a caixa de diálogo apropriada (que é uma questão para o design privado entre a DLL da interface do usuário e o provedor de serviços de telefonia).</span><span class="sxs-lookup"><span data-stu-id="2f35b-109">From this new UI thread, TAPI calls the UI DLL's [**TUISPI\_providerGenericDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) function, passing in data that was specified by the telephony service provider in the structure passed in with the [**LINE\_CREATEDIALOGINSTANCE**](line-createdialoginstance.md) message; the UI DLL displays the appropriate dialog box (which is a matter for private design between the UI DLL and the telephony service provider).</span></span> <span data-ttu-id="2f35b-110">A DLL da interface do usuário não retorna de **TUISPI \_ providerGenericDialog** até que a caixa de diálogo seja fechada.</span><span class="sxs-lookup"><span data-stu-id="2f35b-110">The UI DLL does not return from **TUISPI\_providerGenericDialog** until the dialog box is closed.</span></span>

<span data-ttu-id="2f35b-111">O provedor de serviços de telefonia pode gerar dados atualizados para exibir na caixa de diálogo (ou, por exemplo, instruir a caixa de diálogo a ser fechada, se a chamada for abandonada ou se outros eventos ocorrerem) enviando uma mensagem de [**\_ SENDDIALOGINSTANCEDATA de linha**](line-senddialoginstancedata.md) .</span><span class="sxs-lookup"><span data-stu-id="2f35b-111">The telephony service provider can generate updated data to display in the dialog box (or, for example, instruct the dialog box to be closed, if the call is abandoned or other events occur) by sending a [**LINE\_SENDDIALOGINSTANCEDATA**](line-senddialoginstancedata.md) message.</span></span> <span data-ttu-id="2f35b-112">O TAPISRV transmite os dados para a TAPI, que chama a função [**\_ ProviderGenericDialogData do TUISPI**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialogdata) da dll da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="2f35b-112">TAPISRV conveys the data to TAPI, which calls the UI DLL's [**TUISPI\_providerGenericDialogData**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialogdata) function.</span></span> <span data-ttu-id="2f35b-113">Esse mecanismo fornece um "envio" unidirecional para a DLL da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="2f35b-113">This mechanism provides a unidirectional "send" to the UI DLL.</span></span> <span data-ttu-id="2f35b-114">Se a DLL da interface do usuário quiser informar o provedor de serviços de telefonia dos resultados da caixa de diálogo ou obter outros dados, ela poderá chamar a função [*DllCallbackProc*](/windows/win32/api/tspi/nc-tspi-tuispidllcallback) (um ponteiro para o qual ele recebeu quando [**TUISPI \_ providerGenericDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) for chamado).</span><span class="sxs-lookup"><span data-stu-id="2f35b-114">If the UI DLL wants to inform the telephony service provider of the results of the dialog box or obtain other data, it can call the [*DllCallbackProc*](/windows/win32/api/tspi/nc-tspi-tuispidllcallback) function (a pointer to which it received when [**TUISPI\_providerGenericDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) was called).</span></span>

<span data-ttu-id="2f35b-115">Quando a caixa de diálogo é ignorada, [**TUISPI \_ providerGenericDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) retorna à TAPI.</span><span class="sxs-lookup"><span data-stu-id="2f35b-115">When the dialog box is dismissed, [**TUISPI\_providerGenericDialog**](/windows/win32/api/tspi/nf-tspi-tuispi_providergenericdialog) returns to TAPI.</span></span> <span data-ttu-id="2f35b-116">A TAPI chama [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary) para liberar a DLL da interface do usuário e sai do thread de interface do usuário criado no contexto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2f35b-116">TAPI calls [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary) to release the UI DLL, and exits the UI thread it had created in the application context.</span></span> <span data-ttu-id="2f35b-117">Em seguida, ele solicita TAPISRV para chamar a função [**\_ providerFreeDialogInstance TSPI**](/windows/win32/api/tspi/nf-tspi-tspi_providerfreedialoginstance) do provedor de serviços de telefonia para desassociar a associação criada quando o provedor de serviços de telefonia enviou originalmente a [**linha \_ CREATEDIALOGINSTANCE**](line-createdialoginstance.md) Message.</span><span class="sxs-lookup"><span data-stu-id="2f35b-117">It then requests TAPISRV to call the telephony service provider's [**TSPI\_providerFreeDialogInstance**](/windows/win32/api/tspi/nf-tspi-tspi_providerfreedialoginstance) function to unbind the association created when the telephony service provider originally sent the [**LINE\_CREATEDIALOGINSTANCE**](line-createdialoginstance.md) message.</span></span> <span data-ttu-id="2f35b-118">Essa função também será chamada se o processo do aplicativo for encerrado inesperadamente antes de **TUISPI \_ providerGenericDialog** retornar.</span><span class="sxs-lookup"><span data-stu-id="2f35b-118">This function is also called if the application process terminates unexpectedly before **TUISPI\_providerGenericDialog** returns.</span></span>

 

 
