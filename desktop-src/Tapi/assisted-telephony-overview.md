---
description: Um recurso valioso de telefonia é o pequeno conjunto de funções chamadas de telefonia assistida.
ms.assetid: 1c41f52b-f8bf-410e-a966-9323a690a4d5
title: Visão geral de telefonia assistida
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7b6a8826fd0c273936204d9250fb91504333d807
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103922090"
---
# <a name="assisted-telephony-overview"></a><span data-ttu-id="9e03e-103">Visão geral de telefonia assistida</span><span class="sxs-lookup"><span data-stu-id="9e03e-103">Assisted Telephony Overview</span></span>

<span data-ttu-id="9e03e-104">Um recurso valioso de telefonia é o pequeno conjunto de funções chamadas de telefonia assistida.</span><span class="sxs-lookup"><span data-stu-id="9e03e-104">A valuable feature of telephony is the small set of functions called Assisted Telephony.</span></span> <span data-ttu-id="9e03e-105">A telefonia assistida foi projetada para fazer o estabelecimento de chamadas de voz e de chamadas de mídia disponíveis para qualquer aplicativo, não apenas aquelas dedicadas à funcionalidade de telefonia.</span><span class="sxs-lookup"><span data-stu-id="9e03e-105">Assisted Telephony is designed to make the establishment of voice calls and of media calls available to any application, not just those dedicated to telephonic functionality.</span></span> <span data-ttu-id="9e03e-106">Em outras palavras, a telefonia assistida permite que os aplicativos façam chamadas telefônicas sem a necessidade de estar atento aos detalhes dos serviços da API de telefonia completa.</span><span class="sxs-lookup"><span data-stu-id="9e03e-106">In other words, Assisted Telephony lets applications make telephone calls without needing to be aware of the details of the services of the full Telephony API.</span></span> <span data-ttu-id="9e03e-107">Ele estende a telefonia para aplicativos de processamento de texto, planilhas, bancos de dados, gerenciadores de informações pessoais e outros aplicativos sem telefonia.</span><span class="sxs-lookup"><span data-stu-id="9e03e-107">It extends telephony to word-processing applications, spreadsheets, databases, personal information managers, and other non-telephony applications.</span></span>

<span data-ttu-id="9e03e-108">Para obter uma lista de funções de telefonia assistidas da TAPI 2. x de telefonia básica, consulte [referência de função rápida TAPI](./tapi-quick-function-reference.md).</span><span class="sxs-lookup"><span data-stu-id="9e03e-108">For a list of TAPI 2.x Assisted Telephony functions of Basic Telephony, see [TAPI Quick Function Reference](./tapi-quick-function-reference.md).</span></span> <span data-ttu-id="9e03e-109">A TAPI 3. x dá suporte à telefonia assistida por meio da interface [**ITRequest**](/windows/desktop/api/tapi3if/nn-tapi3if-itrequest) .</span><span class="sxs-lookup"><span data-stu-id="9e03e-109">TAPI 3.x supports assisted telephony through the [**ITRequest**](/windows/desktop/api/tapi3if/nn-tapi3if-itrequest) interface.</span></span>

<span data-ttu-id="9e03e-110">A utilidade da telefonia assistida pode ser ilustrada pelo exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="9e03e-110">The usefulness of Assisted Telephony can be illustrated by the following example.</span></span> <span data-ttu-id="9e03e-111">Um aplicativo de planilha pode incorporar funções que discam um número de telefone para uma chamada de fala.</span><span class="sxs-lookup"><span data-stu-id="9e03e-111">A spreadsheet application can incorporate functions that dial a telephone number for a speech call.</span></span> <span data-ttu-id="9e03e-112">Desde que o aplicativo não precise de nenhum controle de chamada detalhado fornecido pela API de telefonia completa, a telefonia assistida é a maneira mais fácil e eficiente de fornecer a funcionalidade de telefonia.</span><span class="sxs-lookup"><span data-stu-id="9e03e-112">As long as the application needs none of the detailed call control provided by the full Telephony API, Assisted Telephony is the easiest and most efficient way to give it telephonic functionality.</span></span>

![telefonia assistida com um aplicativo de planilha](images/assist4.png)

<span data-ttu-id="9e03e-114">A telefonia assistida e a API de telefonia completa são usadas e implementadas de maneiras diferentes, portanto, não é recomendável misturar chamadas de função de telefonia assistidas e chamadas de função de API de telefonia em um único aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9e03e-114">Assisted Telephony and the full Telephony API are used and implemented in different ways, so it is not advised to mix Assisted Telephony function calls and Telephony API function calls within a single application.</span></span>

## <a name="using-assisted-telephony"></a><span data-ttu-id="9e03e-115">Usando a telefonia assistida</span><span class="sxs-lookup"><span data-stu-id="9e03e-115">Using Assisted Telephony</span></span>

<span data-ttu-id="9e03e-116">Os aplicativos que usam serviços de telefonia assistida iniciam apenas solicitações de chamada que são enfileiradas temporariamente pela TAPI.</span><span class="sxs-lookup"><span data-stu-id="9e03e-116">Applications that use Assisted Telephony services only initiate call requests that are temporarily queued by TAPI.</span></span> <span data-ttu-id="9e03e-117">O aplicativo destinatário da solicitação recupera essas solicitações e as executa em nome do aplicativo de telefonia assistido.</span><span class="sxs-lookup"><span data-stu-id="9e03e-117">The request recipient application retrieves these requests and executes them on behalf of the Assisted Telephony application.</span></span> <span data-ttu-id="9e03e-118">A função [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) solicita o estabelecimento de uma chamada de voz.</span><span class="sxs-lookup"><span data-stu-id="9e03e-118">The [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) function requests the establishment of a voice call.</span></span> <span data-ttu-id="9e03e-119">O aplicativo solicitante não controla a chamada.</span><span class="sxs-lookup"><span data-stu-id="9e03e-119">The requesting application does not control the call.</span></span>

<span data-ttu-id="9e03e-120">A TAPI permite que o usuário estabeleça diferentes ou os mesmos aplicativos de destinatário de solicitação para cada um desses serviços.</span><span class="sxs-lookup"><span data-stu-id="9e03e-120">TAPI allows the user to establish different or the same request recipient applications for each of these services.</span></span> <span data-ttu-id="9e03e-121">Um aplicativo torna-se um destinatário de solicitação registrando-se com [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), em que **true** é especificado como o valor para o parâmetro *bEnable*.</span><span class="sxs-lookup"><span data-stu-id="9e03e-121">An application becomes a request recipient by registering with [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), in which **TRUE** is specified as the value for the parameter *bEnable*.</span></span> <span data-ttu-id="9e03e-122">(A especificação de **false** cancela o registro do aplicativo como um destinatário da solicitação, que deve ser feito quando determinou que suas tarefas de destinatário estão por meio da sessão atual.) O aplicativo seleciona os serviços que deseja manipular no parâmetro *dwRequestMode* de **lineRegisterRequestRecipient**.</span><span class="sxs-lookup"><span data-stu-id="9e03e-122">(Specifying **FALSE** deregisters the application as a request recipient, which it should do when it has determined that its recipient duties are through for the current session.) The application selects the services it wants to handle in the *dwRequestMode* parameter of **lineRegisterRequestRecipient**.</span></span> <span data-ttu-id="9e03e-123">Um valor possível para uma solicitação é LINEREQUESTMODE \_ MAKECALL, para mostrar que o aplicativo tratará as solicitações [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) .</span><span class="sxs-lookup"><span data-stu-id="9e03e-123">A possible value for a request is LINEREQUESTMODE\_MAKECALL, to show that the application will handle [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) requests.</span></span> <span data-ttu-id="9e03e-124">Se vários aplicativos se registrarem para os mesmos serviços, um esquema de prioridade será usado para permitir que o usuário selecione qual aplicativo é preferencial para lidar com solicitações.</span><span class="sxs-lookup"><span data-stu-id="9e03e-124">If multiple applications register for the same services, a priority scheme is used to allow the user to select which application is preferred for handling requests.</span></span> <span data-ttu-id="9e03e-125">Esse esquema de prioridade é idêntico ao usado para a entrega de chamada e o roteamento de chamadas de entrada com base em uma lista de nomes de arquivo em **HandoffPriorities** no registro.</span><span class="sxs-lookup"><span data-stu-id="9e03e-125">This priority scheme is identical to that used for call handoff and the routing of incoming calls based on a list of file names in **HandoffPriorities** in the registry.</span></span>

## <a name="call-requests"></a><span data-ttu-id="9e03e-126">Solicitações de chamada</span><span class="sxs-lookup"><span data-stu-id="9e03e-126">Call Requests</span></span>

<span data-ttu-id="9e03e-127">A telefonia assistida fornece aplicativos habilitados para telefonia com um mecanismo fácil de usar para fazer chamadas telefônicas sem exigir que o desenvolvedor se torne totalmente compensante em telefonia.</span><span class="sxs-lookup"><span data-stu-id="9e03e-127">Assisted Telephony provides telephony-enabled applications with an easy-to-use mechanism for making phone calls without requiring the developer to become fully literate in telephony.</span></span>

<span data-ttu-id="9e03e-128">A função [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) solicita uma chamada de voz entre o usuário e uma parte remota especificada por seu número de telefone.</span><span class="sxs-lookup"><span data-stu-id="9e03e-128">The [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall) function requests a voice call between the user and a remote party specified by its phone number.</span></span> <span data-ttu-id="9e03e-129">A solicitação é feita à TAPI, que a transmite para um aplicativo que é registrado como um destinatário dessas solicitações.</span><span class="sxs-lookup"><span data-stu-id="9e03e-129">The request is made to TAPI, which passes it to an application that is registered as a recipient of such requests.</span></span> <span data-ttu-id="9e03e-130">Esse destinatário é um aplicativo do Gerenciador de chamadas.</span><span class="sxs-lookup"><span data-stu-id="9e03e-130">This recipient is a call manager application.</span></span>

<span data-ttu-id="9e03e-131">Depois que o aplicativo tiver feito a solicitação, a chamada será controlada inteiramente do aplicativo do Gerenciador de chamadas, porque os aplicativos de telefonia assistida não podem gerenciar chamadas.</span><span class="sxs-lookup"><span data-stu-id="9e03e-131">After the application has made the request, the call is controlled entirely from the call manager application because Assisted Telephony applications cannot manage calls.</span></span> <span data-ttu-id="9e03e-132">Como os aspectos mais complexos de telefonia e todas as operações de interface do usuário são tratados pelo aplicativo do Gerenciador de chamadas, os aplicativos habilitados para telefonia não precisam ser modificados de forma substancial.</span><span class="sxs-lookup"><span data-stu-id="9e03e-132">Because the more complex aspects of telephony and all user-interface operations are handled by the call manager application, telephony-enabled applications need not be modified in any substantial way.</span></span> <span data-ttu-id="9e03e-133">Na verdade, os aplicativos que permitem que essa operação seja invocada de sua linguagem de script interna talvez não precisem ser modificados.</span><span class="sxs-lookup"><span data-stu-id="9e03e-133">In fact, applications that allow this operation to be invoked from their built-in script language may not need to be modified at all.</span></span>

<span data-ttu-id="9e03e-134">A função [**tapiGetLocationInfo**](/windows/win32/api/tapi/nf-tapi-tapigetlocationinfo) retorna para o aplicativo o código de país ou região e o código de cidade (área) que o usuário definiu nos parâmetros do local atual no painel de controle de telefonia.</span><span class="sxs-lookup"><span data-stu-id="9e03e-134">The [**tapiGetLocationInfo**](/windows/win32/api/tapi/nf-tapi-tapigetlocationinfo) function returns to the application the country or region code and city (area) code that the user has set in the current location parameters in the Telephony Control Panel.</span></span> <span data-ttu-id="9e03e-135">O aplicativo pode usar essas informações para ajudar o usuário a formar números de telefone canônicos adequados, por exemplo, oferecendo esses valores como padrões quando novos números são inseridos em uma entrada de catálogo telefônico ou registro de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="9e03e-135">The application can use this information to assist the user in forming proper canonical telephone numbers, such as by offering these as defaults when new numbers are entered in a phone book entry or database record.</span></span>

## <a name="request-recipients"></a><span data-ttu-id="9e03e-136">Solicitar destinatários</span><span class="sxs-lookup"><span data-stu-id="9e03e-136">Request Recipients</span></span>

<span data-ttu-id="9e03e-137">Dois tipos de aplicativos são necessários para executar a telefonia assistida.</span><span class="sxs-lookup"><span data-stu-id="9e03e-137">Two kinds of applications are needed to run Assisted Telephony.</span></span> <span data-ttu-id="9e03e-138">*Clientes* de telefonia assistida são aplicativos que usam telefonia assistida chamando as funções que têm o prefixo "TAPI".</span><span class="sxs-lookup"><span data-stu-id="9e03e-138">Assisted Telephony *clients* are applications that use Assisted Telephony by calling the functions that have the prefix "tapi."</span></span> <span data-ttu-id="9e03e-139">Um exemplo de tal aplicativo cliente seria uma planilha à qual um comando de menu de **discagem** ou botão de barra de ferramentas é adicionado.</span><span class="sxs-lookup"><span data-stu-id="9e03e-139">An example of such a client application would be a spreadsheet to which a **Dial** menu command or toolbar button is added.</span></span>

<span data-ttu-id="9e03e-140">Os *servidores* de telefonia assistida são aplicativos que podem executar funções de API de telefonia que resultam da chamada de outro aplicativo para uma função prefixada "TAPI".</span><span class="sxs-lookup"><span data-stu-id="9e03e-140">Assisted Telephony *servers* are applications that can execute Telephony API functions that result from another application's call to a "tapi"-prefixed function.</span></span> <span data-ttu-id="9e03e-141">Para se tornar conhecido como um servidor de telefonia assistido, tal aplicativo é registrado como um usando a função [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) .</span><span class="sxs-lookup"><span data-stu-id="9e03e-141">To make itself known as an Assisted Telephony server, such an application registers as one using the [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) function.</span></span>

<span data-ttu-id="9e03e-142">As funções de telefonia assistida (que começam com o prefixo "TAPI") são conhecidas como *funções de solicitação*.</span><span class="sxs-lookup"><span data-stu-id="9e03e-142">The functions of Assisted Telephony (which begin with the prefix "tapi") are known as *request functions*.</span></span> <span data-ttu-id="9e03e-143">Os aplicativos de telefonia assistida que processam essas solicitações — servidores de telefonia assistida — são chamados de *destinatários de solicitação*.</span><span class="sxs-lookup"><span data-stu-id="9e03e-143">Assisted Telephony applications that process these requests—Assisted Telephony servers—are called *request recipients*.</span></span>

## <a name="processing-assisted-telephony-requests"></a><span data-ttu-id="9e03e-144">Processando solicitações de telefonia assistidas</span><span class="sxs-lookup"><span data-stu-id="9e03e-144">Processing Assisted Telephony Requests</span></span>

<span data-ttu-id="9e03e-145">O processo com o qual as solicitações são entregues e é atendido é o seguinte:</span><span class="sxs-lookup"><span data-stu-id="9e03e-145">The process with which requests are delivered and serviced is as follows:</span></span>

1.  <span data-ttu-id="9e03e-146">Quando a TAPI recebe uma solicitação de telefonia assistida, ela verifica se há um destinatário de solicitação, ou seja, um aplicativo atualmente registrado para processar esse tipo de solicitação.</span><span class="sxs-lookup"><span data-stu-id="9e03e-146">When TAPI receives an Assisted Telephony request, it checks for a request recipient, that is, an application currently registered to process that type of request.</span></span> <span data-ttu-id="9e03e-147">Se houver um destinatário de solicitação, a solicitação será enfileirada e o aplicativo de prioridade mais alta que foi registrado para o serviço da solicitação será enviado uma mensagem de [**\_ solicitação de linha**](./line-request.md) .</span><span class="sxs-lookup"><span data-stu-id="9e03e-147">If there is a request recipient, the request is queued, and the highest-priority application that has registered for that request's service is sent a [**LINE\_REQUEST**](./line-request.md) message.</span></span> <span data-ttu-id="9e03e-148">A mensagem notifica o destinatário da solicitação de que uma nova solicitação chegou e transporta uma indicação do modo da solicitação.</span><span class="sxs-lookup"><span data-stu-id="9e03e-148">The message notifies the request recipient that a new request has arrived, and it carries an indication of the request's mode.</span></span>
2.  <span data-ttu-id="9e03e-149">Se a TAPI não puder encontrar um aplicativo em execução no momento para processar essa solicitação, ele tentará iniciar um aplicativo que tenha sido registrado como sendo capaz de fazer isso.</span><span class="sxs-lookup"><span data-stu-id="9e03e-149">If TAPI cannot find a currently running application to process such a request, it tries to launch an application that has been registered as capable of doing so.</span></span> <span data-ttu-id="9e03e-150">Essas informações de registro são registradas em **HandoffPriorities** no registro.</span><span class="sxs-lookup"><span data-stu-id="9e03e-150">This registration information is recorded in **HandoffPriorities** in the registry.</span></span> <span data-ttu-id="9e03e-151">A TAPI tenta iniciar aplicativos na ordem em que estão listados na seção **HandoffPriorities** .</span><span class="sxs-lookup"><span data-stu-id="9e03e-151">TAPI tries to launch applications in the order in which they are listed in the **HandoffPriorities** section.</span></span> <span data-ttu-id="9e03e-152">(Consulte a etapa a seguir.)</span><span class="sxs-lookup"><span data-stu-id="9e03e-152">(See the following step.)</span></span>

    <span data-ttu-id="9e03e-153">Se nenhum aplicativo estiver registrado no momento, a TAPI examinará a lista de aplicativos de processamento de solicitações na entrada associada no **HandoffPriorities**.</span><span class="sxs-lookup"><span data-stu-id="9e03e-153">If no application is currently registered, TAPI examines the list of request-processing applications on the associated entry in **HandoffPriorities**.</span></span> <span data-ttu-id="9e03e-154">Se a linha associada estiver ausente no arquivo, se não houver nenhum aplicativo listado nela, ou se nenhum dos aplicativos na lista puder ser iniciado, a solicitação será rejeitada com o erro TAPIERR \_ NOREQUESTRECIPIENT.</span><span class="sxs-lookup"><span data-stu-id="9e03e-154">If the associated line is missing from the file, if there are no applications listed on it, or if none of the applications in the list can be launched, the request is rejected with the error TAPIERR\_NOREQUESTRECIPIENT.</span></span>

    <span data-ttu-id="9e03e-155">Quando um destinatário de solicitação é iniciado (quer ele tenha sido iniciado pela TAPI), é sua obrigação chamar [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) durante o processo de inicialização e se registrar como um destinatário de solicitação.</span><span class="sxs-lookup"><span data-stu-id="9e03e-155">When a request recipient is launched (whether or not it has been launched by TAPI) it is its duty to call [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient) during the startup process and register itself as a request recipient.</span></span>

3.  <span data-ttu-id="9e03e-156">Se um ou mais aplicativos estiverem listados na entrada, a TAPI começará com o primeiro aplicativo listado (prioridade mais alta) e tentará iniciá-lo usando a função [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) .</span><span class="sxs-lookup"><span data-stu-id="9e03e-156">If one or more applications are listed in the entry, TAPI begins with the first listed application (highest priority), and attempts to launch it using the [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) function.</span></span> <span data-ttu-id="9e03e-157">Se a tentativa de iniciar o aplicativo falhar, a TAPI tentará iniciar o próximo aplicativo na lista.</span><span class="sxs-lookup"><span data-stu-id="9e03e-157">If the attempt to launch the application fails, TAPI attempts to launch the next application in the list.</span></span> <span data-ttu-id="9e03e-158">Quando qualquer aplicativo é iniciado com êxito, a TAPI simplesmente enfileira a solicitação e retorna uma indicação de êxito para o aplicativo, embora a solicitação ainda não tenha sido sinalizada para o destinatário da solicitação.</span><span class="sxs-lookup"><span data-stu-id="9e03e-158">When any application launches successfully, TAPI simply queues the request and returns a success indication to the application even though the request hasn't yet been signaled to the request recipient.</span></span>

    <span data-ttu-id="9e03e-159">Depois que o aplicativo destinatário da solicitação é iniciado, ele chama [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), que faz com que uma mensagem de [**\_ solicitação de linha**](./line-request.md) seja enviada, sinalizando que a solicitação está na fila.</span><span class="sxs-lookup"><span data-stu-id="9e03e-159">After the request recipient application is launched, it calls [**lineRegisterRequestRecipient**](/windows/win32/api/tapi/nf-tapi-lineregisterrequestrecipient), which causes a [**LINE\_REQUEST**](./line-request.md) message to be sent, signaling that the request is queued.</span></span> <span data-ttu-id="9e03e-160">Se, por algum motivo, o aplicativo iniciado nunca se registrar, a solicitação permanecerá na fila e permanecerá na fila indefinidamente até que um aplicativo seja registrado para esse tipo de solicitação.</span><span class="sxs-lookup"><span data-stu-id="9e03e-160">If for some reason the launched application never registers, the request remains queued and remains in the queue indefinitely until an application registers for that type of request.</span></span>

4.  <span data-ttu-id="9e03e-161">Se a TAPI encontrar esse aplicativo registrado já em execução ou iniciar com êxito um, ele enfileirará a solicitação, enviando uma mensagem de solicitação de linha \_ para o aplicativo de servidor e retornará uma indicação de êxito para a chamada de função para o aplicativo de telefonia assistido.</span><span class="sxs-lookup"><span data-stu-id="9e03e-161">If TAPI finds such a registered application already running or successfully launches one, it queues the request, sending a LINE\_REQUEST message to the server application, and returns a success indication for the function call to the Assisted Telephony application.</span></span> <span data-ttu-id="9e03e-162">Essa mensagem de êxito indica apenas que a solicitação foi aceita e enfileirada, não que tenha sido executada com êxito.</span><span class="sxs-lookup"><span data-stu-id="9e03e-162">This success message states only that the request has been accepted and queued, not that it has been successfully executed.</span></span>

<span data-ttu-id="9e03e-163">Quando o aplicativo de servidor está pronto para processar uma solicitação, ele chama a função [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) .</span><span class="sxs-lookup"><span data-stu-id="9e03e-163">When the server application is ready to process a request, it calls the [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) function.</span></span> <span data-ttu-id="9e03e-164">Isso permite que ele receba todas as informações necessárias, como um endereço para discagem.</span><span class="sxs-lookup"><span data-stu-id="9e03e-164">This lets it receive any information it needs, such as an address to dial.</span></span> <span data-ttu-id="9e03e-165">Em seguida, ele processa a solicitação, usando as funções TAPI (como [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) e [**lineDrop**](/windows/win32/api/tapi/nf-tapi-linedrop)) que, de outra forma, seriam usadas para fazer a chamada.</span><span class="sxs-lookup"><span data-stu-id="9e03e-165">It then processes the request, using the TAPI functions (such as [**lineMakeCall**](/windows/win32/api/tapi/nf-tapi-linemakecall) and [**lineDrop**](/windows/win32/api/tapi/nf-tapi-linedrop)) that would otherwise be used to place the call.</span></span> <span data-ttu-id="9e03e-166">Invocar **lineGetRequest** remove a solicitação da TAPI e os parâmetros de solicitação são copiados em um buffer de solicitação alocado pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9e03e-166">Invoking **lineGetRequest** removes the request from TAPI, and the request parameters are copied in an application-allocated request buffer.</span></span> <span data-ttu-id="9e03e-167">O tamanho e a interpretação do conteúdo do buffer dependem do modo de solicitação.</span><span class="sxs-lookup"><span data-stu-id="9e03e-167">The size and interpretation of the contents of the buffer depend on the request mode.</span></span>

<span data-ttu-id="9e03e-168">O servidor deve garantir que ele use os parâmetros corretos ao executar solicitações.</span><span class="sxs-lookup"><span data-stu-id="9e03e-168">The server must ensure that it uses the correct parameters when executing requests.</span></span> <span data-ttu-id="9e03e-169">Ao fazer isso, estas etapas são seguidas:</span><span class="sxs-lookup"><span data-stu-id="9e03e-169">When doing so, these steps are followed:</span></span>

1.  <span data-ttu-id="9e03e-170">O destinatário da solicitação recebe primeiro uma mensagem de [**\_ solicitação de linha**](./line-request.md) informando que as solicitações podem existir para ela na fila de solicitações.</span><span class="sxs-lookup"><span data-stu-id="9e03e-170">The request recipient first receives a [**LINE\_REQUEST**](./line-request.md) message informing it that requests can exist for it in the request queue.</span></span> <span data-ttu-id="9e03e-171">Isso diz ao aplicativo para chamar [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) e continuar chamando-o até que a fila seja drenada (se a solicitação for para fazer uma nova chamada) ou para remover uma chamada existente.</span><span class="sxs-lookup"><span data-stu-id="9e03e-171">This tells the application to call [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) and keep calling it until the queue is drained (if the request is for making a new call), or to drop an existing call.</span></span> <span data-ttu-id="9e03e-172">Essa mensagem não contém os parâmetros para a solicitação, exceto no caso de uma solicitação para remover uma chamada existente.</span><span class="sxs-lookup"><span data-stu-id="9e03e-172">This message does not contain the parameters for the request, except in the case of a request to drop an existing call.</span></span>
2.  <span data-ttu-id="9e03e-173">Se a solicitação for fazer uma nova chamada, o servidor de telefonia assistido usará a função [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) para recuperar a solicitação completa, que inclui os parâmetros da solicitação.</span><span class="sxs-lookup"><span data-stu-id="9e03e-173">If the request is to make a new call, the Assisted Telephony server uses the [**lineGetRequest**](/windows/win32/api/tapi/nf-tapi-linegetrequest) function to retrieve the full request, which includes the request's parameters.</span></span> <span data-ttu-id="9e03e-174">O servidor agora tem todas as informações de que precisa, como o número a ser discado ou a identificação do criador da solicitação.</span><span class="sxs-lookup"><span data-stu-id="9e03e-174">The server now has all the information it needs, such as the number to dial or the identification of the maker of the request.</span></span> <span data-ttu-id="9e03e-175">No entanto, primeiro o servidor deve alocar a memória necessária para armazenar essas informações.</span><span class="sxs-lookup"><span data-stu-id="9e03e-175">First, however, the server must allocate the memory needed to store this information.</span></span>
3.  <span data-ttu-id="9e03e-176">Por fim, o servidor executa a solicitação invocando a função TAPI apropriada ou o conjunto de funções.</span><span class="sxs-lookup"><span data-stu-id="9e03e-176">Finally, the server executes the request by invoking the appropriate TAPI function or set of functions.</span></span>

<span data-ttu-id="9e03e-177">Se a TAPI não puder iniciar um aplicativo capaz de servir como um destinatário de solicitação, a chamada de telefonia assistida falhará e retornará o erro TAPIERR \_ NOREQUESTRECIPIENT.</span><span class="sxs-lookup"><span data-stu-id="9e03e-177">If TAPI cannot launch an application capable of serving as a request recipient, the Assisted Telephony call fails and returns the error TAPIERR\_NOREQUESTRECIPIENT.</span></span>

## <a name="notes-on-request-recipient-operations"></a><span data-ttu-id="9e03e-178">Observações sobre operações de destinatário da solicitação</span><span class="sxs-lookup"><span data-stu-id="9e03e-178">Notes on Request Recipient Operations</span></span>

<span data-ttu-id="9e03e-179">As informações a seguir referem-se aos sistemas nos quais as solicitações de telefonia assistidas são processadas:</span><span class="sxs-lookup"><span data-stu-id="9e03e-179">The following information concerns systems on which Assisted Telephony requests are processed:</span></span>

-   <span data-ttu-id="9e03e-180">O registro padrão deve listar um aplicativo do Gerenciador de chamadas na lista de prioridade para [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall).</span><span class="sxs-lookup"><span data-stu-id="9e03e-180">The default registry should list a call manager application in the priority list for [**tapiRequestMakeCall**](/windows/win32/api/tapi/nf-tapi-tapirequestmakecall).</span></span> <span data-ttu-id="9e03e-181">Seria útil, mas não essencial, para que o aplicativo do Gerenciador de chamadas tenha uma opção de menu que permita aos usuários defini-lo com a prioridade mais alta.</span><span class="sxs-lookup"><span data-stu-id="9e03e-181">It would be helpful, but not essential, for the call manager application to have a menu option that allows users to set it to the highest priority.</span></span>
-   <span data-ttu-id="9e03e-182">Quando um aplicativo de destinatário de telefonia assistido é iniciado automaticamente pela TAPI e se é o único aplicativo TAPI no sistema, essa ação Inicializa a TAPI.</span><span class="sxs-lookup"><span data-stu-id="9e03e-182">When an Assisted Telephony recipient application is launched automatically by TAPI and if it is the only TAPI application in the system, this action initializes TAPI.</span></span> <span data-ttu-id="9e03e-183">Se o aplicativo de destinatário de telefonia assistido inicializar e desligar o dispositivo de linha antes de se registrar para solicitações de telefonia assistidas, a TAPI também será desligada e a solicitação de telefonia assistida será perdida.</span><span class="sxs-lookup"><span data-stu-id="9e03e-183">If the Assisted Telephony recipient application initializes and shuts down the line device before registering for Assisted Telephony requests, TAPI is shut down as well, and the Assisted Telephony request is lost.</span></span> <span data-ttu-id="9e03e-184">As solicitações de telefonia assistidas também podem ser perdidas quando outro aplicativo TAPI que é iniciado executa uma inicialização e um desligamento.</span><span class="sxs-lookup"><span data-stu-id="9e03e-184">Assisted Telephony requests might also be lost when another TAPI application that is launched performs an initialize and shutdown.</span></span>

 

 
