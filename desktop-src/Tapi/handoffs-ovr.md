---
description: Quando um aplicativo tem privilégio de proprietário para uma sessão de comunicações, o aplicativo pode optar por entregar a propriedade a outro aplicativo.
ms.assetid: d6d188c9-9cbd-45af-93f0-b78850374919
title: Entregas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 343815e35f1fc331c57c4aa2d9d311697cab7022
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105759476"
---
# <a name="handoffs"></a><span data-ttu-id="13b4b-103">Entregas</span><span class="sxs-lookup"><span data-stu-id="13b4b-103">Handoffs</span></span>

<span data-ttu-id="13b4b-104">Quando um aplicativo tem [privilégio](privilege-ovr.md) de proprietário para uma sessão de comunicações, o aplicativo pode optar por entregar a propriedade a outro aplicativo.</span><span class="sxs-lookup"><span data-stu-id="13b4b-104">When an application has owner [privilege](privilege-ovr.md) for a communications session, the application may choose to hand off ownership to another application.</span></span> <span data-ttu-id="13b4b-105">A operação de entrega normalmente é usada para permitir que o tipo de mídia da chamada seja alterado.</span><span class="sxs-lookup"><span data-stu-id="13b4b-105">The handoff operation is normally used to allow the call's media type to be changed.</span></span> <span data-ttu-id="13b4b-106">O aplicativo de prioridade mais alta para o novo tipo de mídia deve tomar e tratar a chamada.</span><span class="sxs-lookup"><span data-stu-id="13b4b-106">The highest-priority application for the new media type should take and handle the call.</span></span> <span data-ttu-id="13b4b-107">A alteração do tipo de mídia geralmente ocorre por um dos motivos a seguir.</span><span class="sxs-lookup"><span data-stu-id="13b4b-107">Media type changing usually occurs for one of the following reasons.</span></span>

<span data-ttu-id="13b4b-108">**Comando do usuário:** Por meio de uma interface do usuário ou de mensagens de janela, o aplicativo aprende que o usuário local deseja alterar o tipo de mídia.</span><span class="sxs-lookup"><span data-stu-id="13b4b-108">**User command:** Through a user interface or through window messages, the application learns that the local user wants to change media type.</span></span> <span data-ttu-id="13b4b-109">Por exemplo, o usuário informou ao novo aplicativo de destino (que ainda não é um proprietário) para obter uma chamada de voz existente para transmitir dados.</span><span class="sxs-lookup"><span data-stu-id="13b4b-109">For example, the user has told the new target application (which is not yet an owner) to obtain an existing voice call for transmitting data.</span></span> <span data-ttu-id="13b4b-110">O aplicativo de destino agora deve assumir o controle da chamada.</span><span class="sxs-lookup"><span data-stu-id="13b4b-110">The target application must now take control of the call.</span></span> <span data-ttu-id="13b4b-111">Nesse caso, o proprietário atual observa o número de proprietários aumenta e, em seguida, abandona seu controle da chamada.</span><span class="sxs-lookup"><span data-stu-id="13b4b-111">In this case, the current owner notices the number of owners increase, and then relinquishes its control of the call.</span></span> <span data-ttu-id="13b4b-112">Como alternativa, o usuário poderia instruir o proprietário atual da chamada para entregá-la a um aplicativo que possa manipular o novo tipo de mídia.</span><span class="sxs-lookup"><span data-stu-id="13b4b-112">Alternatively, the user could instruct the current owner of the call to hand it off to an application that can handle the new media type.</span></span>

<span data-ttu-id="13b4b-113">**Alteração do tipo de mídia:** O provedor de serviços pode detectar uma alteração de tipo de mídia.</span><span class="sxs-lookup"><span data-stu-id="13b4b-113">**Media type change:** The service provider can detect a media type change.</span></span> <span data-ttu-id="13b4b-114">Por exemplo, o aplicativo local está reproduzindo uma mensagem de voz gravada para o chamador.</span><span class="sxs-lookup"><span data-stu-id="13b4b-114">For example, the local application is playing a recorded voice message to the caller.</span></span> <span data-ttu-id="13b4b-115">Durante essa mensagem, o chamador decide espontaneamente a transmissão de um tom de chamada de fax, e o aplicativo local pode responder de acordo alterando o tipo de mídia para fax e, se necessário, entregando a chamada para um aplicativo de fax.</span><span class="sxs-lookup"><span data-stu-id="13b4b-115">During this message, the caller spontaneously decides to transmit a fax calling tone, and the local application can respond accordingly by changing the media type to fax and, if necessary, handing the call off to a fax application.</span></span> <span data-ttu-id="13b4b-116">Outra maneira de trabalhar com um aplicativo de monitoramento para habilitar o monitoramento do tipo de mídia e, quando o tipo de mídia no qual ele está interessado é detectado em uma chamada, ele pode solicitar a propriedade da chamada.</span><span class="sxs-lookup"><span data-stu-id="13b4b-116">Another way this can work is for a monitoring application to enable media type monitoring, and, when the media type in which it is interested is detected on a call, it can request ownership of the call.</span></span> <span data-ttu-id="13b4b-117">Esse mecanismo torna desnecessário para cada aplicativo monitorar cada chamada para cada tipo de mídia.</span><span class="sxs-lookup"><span data-stu-id="13b4b-117">This mechanism makes it unnecessary for every application to monitor every call for every media type.</span></span>

<span data-ttu-id="13b4b-118">**Comando da parte remota:** A parte remota pode indicar interativamente uma alteração nos tipos de mídia durante uma chamada existente, como se o aplicativo local estiver monitorando a entrada DTMF pelo chamador remoto.</span><span class="sxs-lookup"><span data-stu-id="13b4b-118">**Remote party command:** The remote party can interactively indicate a change in media types during an existing call, such as if the local application is monitoring DTMF input by the remote caller.</span></span> <span data-ttu-id="13b4b-119">Por meio desse monitoramento, o chamador indica, por exemplo, que um fax está prestes a ser enviado.</span><span class="sxs-lookup"><span data-stu-id="13b4b-119">Through this monitoring, the caller indicates, for example, that a fax is about to be sent.</span></span> <span data-ttu-id="13b4b-120">Outras maneiras pelas quais o chamador pode controlar aplicativos locais são com comandos recebidos em outras conexões de dados e por meio de mensagens de informações de usuário do usuário ISDN.</span><span class="sxs-lookup"><span data-stu-id="13b4b-120">Other ways the caller can control local applications are with commands received on other data connections and through ISDN user-user information messages.</span></span>

<span data-ttu-id="13b4b-121">Uma entrega de chamada terá um destes resultados:</span><span class="sxs-lookup"><span data-stu-id="13b4b-121">A call handoff will have one of these outcomes:</span></span>

-   <span data-ttu-id="13b4b-122">A chamada é dada a outro aplicativo (êxito).</span><span class="sxs-lookup"><span data-stu-id="13b4b-122">The call is given to another application (SUCCESS).</span></span>
-   <span data-ttu-id="13b4b-123">O aplicativo de entrega é o próprio destino (TARGETSELF).</span><span class="sxs-lookup"><span data-stu-id="13b4b-123">The handing-off application is itself the target (TARGETSELF).</span></span>
-   <span data-ttu-id="13b4b-124">A entrega falha (TARGETNOTFOUND).</span><span class="sxs-lookup"><span data-stu-id="13b4b-124">The handoff fails (TARGETNOTFOUND).</span></span>

<span data-ttu-id="13b4b-125">Se o aplicativo que está recebendo a chamada de retirada já tiver um identificador de chamada para a chamada, esse identificador de chamada antigo será usado.</span><span class="sxs-lookup"><span data-stu-id="13b4b-125">If the application that is receiving the handed-off call already has a call handle to the call, this old call handle is used.</span></span> <span data-ttu-id="13b4b-126">Caso contrário, um novo identificador de chamada será criado.</span><span class="sxs-lookup"><span data-stu-id="13b4b-126">Otherwise, a new call handle is created.</span></span> <span data-ttu-id="13b4b-127">Em ambos os casos, o aplicativo termina com os privilégios de proprietário para a chamada.</span><span class="sxs-lookup"><span data-stu-id="13b4b-127">In either case, the application ends up with owner privileges to the call.</span></span> <span data-ttu-id="13b4b-128">Sempre que o aplicativo de entrega não for o mesmo que o aplicativo de destino, o destino será informado sobre a entrega em uma mensagem de estado de sessão como se estivesse recebendo uma nova chamada.</span><span class="sxs-lookup"><span data-stu-id="13b4b-128">Whenever the handing-off application is not the same as the target application, the target is informed about the handoff in a session state message as if it were receiving a new call.</span></span>

<span data-ttu-id="13b4b-129">Se o aplicativo proprietário atual for instruído a alterar os tipos de mídia, ele fará isso entregando a chamada para um aplicativo usado para o tipo de mídia de destino.</span><span class="sxs-lookup"><span data-stu-id="13b4b-129">If the current owner application is told to change media types, it does so by handing off the call to an application used for the target media type.</span></span> <span data-ttu-id="13b4b-130">Os dois tipos de entregas de chamada são descritos em [entregas direcionadas](#directed-handoffs) e [entregas de tipo de mídia](#media-type-handoffs).</span><span class="sxs-lookup"><span data-stu-id="13b4b-130">The two types of call handoffs are described in [Directed Handoffs](#directed-handoffs) and [Media type Handoffs](#media-type-handoffs).</span></span>

<span data-ttu-id="13b4b-131">Nem todos os provedores de serviço dão suporte ao uso desta operação.</span><span class="sxs-lookup"><span data-stu-id="13b4b-131">Not all service providers support use of this operation.</span></span>

<span data-ttu-id="13b4b-132">**TAPI 2. x:** Consulte [**lineHandoff**](/windows/win32/api/tapi/nf-tapi-linehandoff), com *lpszFileName* definido como o nome do aplicativo para uma entrega direta ou *dwMediaMode* definido como um tipo de mídia para uma entrega indireta.</span><span class="sxs-lookup"><span data-stu-id="13b4b-132">**TAPI 2.x:** See [**lineHandoff**](/windows/win32/api/tapi/nf-tapi-linehandoff), with *lpszFileName* set to the application name for a direct handoff or *dwMediaMode* set to one media type for an indirect handoff.</span></span>

<span data-ttu-id="13b4b-133">**TAPI 3. x:** Consulte [**ITBasicCallControl:: HandoffDirect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-handoffdirect), [**ITBasicCallControl:: HandoffIndirect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-handoffindirect).</span><span class="sxs-lookup"><span data-stu-id="13b4b-133">**TAPI 3.x:** See [**ITBasicCallControl::HandoffDirect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-handoffdirect), [**ITBasicCallControl::HandoffIndirect**](/windows/desktop/api/tapi3if/nf-tapi3if-itbasiccallcontrol-handoffindirect).</span></span>

## <a name="directed-handoffs"></a><span data-ttu-id="13b4b-134">Entregas direcionadas</span><span class="sxs-lookup"><span data-stu-id="13b4b-134">Directed Handoffs</span></span>

<span data-ttu-id="13b4b-135">Uma *entrega direcionada* ocorre quando o aplicativo de destino é conhecido pelo nome para o aplicativo original.</span><span class="sxs-lookup"><span data-stu-id="13b4b-135">A *directed handoff* takes place when the target application is known by name to the original application.</span></span> <span data-ttu-id="13b4b-136">Essa situação ocorreria, por exemplo, entre um conjunto de aplicativos gravados pelo mesmo fornecedor.</span><span class="sxs-lookup"><span data-stu-id="13b4b-136">This situation would occur, for example, among a set of applications written by the same vendor.</span></span> <span data-ttu-id="13b4b-137">O usuário geralmente pode configurar o controle de entregas direcionadas.</span><span class="sxs-lookup"><span data-stu-id="13b4b-137">The user can usually configure control of directed handoffs.</span></span> <span data-ttu-id="13b4b-138">Com tal entrega, a chamada será dada ao aplicativo especificado se ele tiver aberto a linha na qual a chamada existe.</span><span class="sxs-lookup"><span data-stu-id="13b4b-138">With such a handoff, the call is given to the specified application if it has opened the line on which the call exists.</span></span> <span data-ttu-id="13b4b-139">O tipo de mídia especificado no momento em que o aplicativo abriu a linha é ignorado.</span><span class="sxs-lookup"><span data-stu-id="13b4b-139">The media type specified at the time the application opened the line is ignored.</span></span> <span data-ttu-id="13b4b-140">Um exemplo comum é uma chamada de voz seguida por uma transmissão de fax na mesma chamada.</span><span class="sxs-lookup"><span data-stu-id="13b4b-140">One common example is a voice call followed by a fax transmission in the same call.</span></span> <span data-ttu-id="13b4b-141">A entrega direcionada geralmente seria usada por aplicativos do mesmo desenvolvedor que estão vinculados de outras maneiras também.</span><span class="sxs-lookup"><span data-stu-id="13b4b-141">Directed handoff would most often be used by applications from the same developer that are linked in other ways as well.</span></span>

<span data-ttu-id="13b4b-142">A entrega direcionada também pode ser usada em versões futuras como parte do processo de arbitrar vários aplicativos aguardando chamadas de entrada do mesmo tipo de mídia, com a seleção do aplicativo para tratar a chamada com base na detecção de protocolo de dados ou de nível superior em vez de tipo de mídia.</span><span class="sxs-lookup"><span data-stu-id="13b4b-142">Directed handoff may also be used in future versions as part of the process of arbitrating multiple applications waiting for incoming calls of the same media type, with the selection of the application to handle the call being based on data-link or higher-level protocol detection rather than media type.</span></span> <span data-ttu-id="13b4b-143">Um exemplo de uso seria uma linha de modem de dados de entrada com aplicativos como tomada remotos, BBS, acesso remoto à rede e acesso remoto a email, todos esperando por chamadas simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="13b4b-143">An example of its use would be an incoming data modem line with applications such as remote takeover, bulletin board, remote network access, and remote e-mail access all waiting for calls simultaneously.</span></span>

## <a name="media-type-handoffs"></a><span data-ttu-id="13b4b-144">Entregas de tipo de mídia</span><span class="sxs-lookup"><span data-stu-id="13b4b-144">Media Type Handoffs</span></span>

<span data-ttu-id="13b4b-145">Um *tipo de mídia entrega* ocorre quando há um novo tipo de mídia direcionado, geralmente quando o aplicativo proprietário determina que o tipo de mídia necessário para a chamada não está presente ou está prestes a ser alterado.</span><span class="sxs-lookup"><span data-stu-id="13b4b-145">A *media type handoff* takes place when there is a new, targeted media type, usually when the owning application determines that the media type needed for the call is not present or is about to change.</span></span>

<span data-ttu-id="13b4b-146">O processo para uma entrega dependente de mídia pode ser um processo de investigação se o bit de tipo de mídia desconhecido estiver ativado.</span><span class="sxs-lookup"><span data-stu-id="13b4b-146">The process for a media-dependent handoff can be a probing process if the media type UNKNOWN bit is on.</span></span> <span data-ttu-id="13b4b-147">É responsabilidade do aplicativo proprietário percorrer os tipos de mídia para encontrar o aplicativo de prioridade mais alta.</span><span class="sxs-lookup"><span data-stu-id="13b4b-147">It is the responsibility of the owning application to cycle through media types to find the highest-priority application.</span></span> <span data-ttu-id="13b4b-148">A TAPI faz esse ciclo apenas na chamada de entrada inicial para encontrar o primeiro proprietário.</span><span class="sxs-lookup"><span data-stu-id="13b4b-148">TAPI does this cycling only on the initial incoming call to find the first owner.</span></span> <span data-ttu-id="13b4b-149">Ele não faz isso para uma operação de entrega.</span><span class="sxs-lookup"><span data-stu-id="13b4b-149">It does not do this for a handoff operation.</span></span> <span data-ttu-id="13b4b-150">Caso contrário, uma entrega é praticamente a mesma para a atribuição inicial de uma chamada para um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="13b4b-150">Otherwise, a handoff is virtually the same as for the initial assignment of a call to an application.</span></span> <span data-ttu-id="13b4b-151">A diferença é o fato de que apenas um tipo de mídia pode ser definido para uma entrega indireta (tipo de mídia).</span><span class="sxs-lookup"><span data-stu-id="13b4b-151">The difference is the fact that only one media type can be set for an indirect (media type) handoff.</span></span>

<span data-ttu-id="13b4b-152">Como apenas um único bit de tipo de mídia pode ser especificado, a chamada é dada ao aplicativo de prioridade mais alta para esse tipo de mídia.</span><span class="sxs-lookup"><span data-stu-id="13b4b-152">Because only a single media type bit can be specified, the call is given to the highest priority application for that media type.</span></span> <span data-ttu-id="13b4b-153">No entanto, é possível que mais de um tipo de mídia seja considerado para a entrega.</span><span class="sxs-lookup"><span data-stu-id="13b4b-153">However, it is possible that more than one media type is to be considered for the handoff.</span></span> <span data-ttu-id="13b4b-154">Nesse caso, o aplicativo de entrega deve especificar a prioridade mais alta dos tipos de mídia possíveis como um parâmetro.</span><span class="sxs-lookup"><span data-stu-id="13b4b-154">In this case, the handing-off application should specify the highest priority of the possible media types as a parameter.</span></span>

<span data-ttu-id="13b4b-155">Se um aplicativo especificar o bit desconhecido ao executar uma entrega de tipo de mídia e a entrega falhar, isso significa que um aplicativo desconhecido capaz de executar a determinação do tipo de mídia não está em execução no momento.</span><span class="sxs-lookup"><span data-stu-id="13b4b-155">If an application specifies the UNKNOWN bit when performing a media-type handoff and the handoff fails, this means that an unknown application capable of performing media type determination is not currently running.</span></span> <span data-ttu-id="13b4b-156">O aplicativo que está sendo entregue deve, então, tentar entregar a chamada para o aplicativo de prioridade mais alta registrado para o próximo tipo de mídia mais alto.</span><span class="sxs-lookup"><span data-stu-id="13b4b-156">The application that is handing off should then try to hand the call off to the highest-priority application registered for the next-higher media type.</span></span>

<span data-ttu-id="13b4b-157">O aplicativo receptor agora é responsável pela chamada.</span><span class="sxs-lookup"><span data-stu-id="13b4b-157">The receiving application is now responsible for the call.</span></span> <span data-ttu-id="13b4b-158">Agora, ele investiga o tipo de mídia real da chamada.</span><span class="sxs-lookup"><span data-stu-id="13b4b-158">It now probes for the call's actual media type.</span></span> <span data-ttu-id="13b4b-159">Se o aplicativo puder lidar com o tipo de mídia da chamada, ele deverá garantir que seja o aplicativo de prioridade mais alta registrado para esse tipo de mídia.</span><span class="sxs-lookup"><span data-stu-id="13b4b-159">If the application can handle the call's media type, it must ensure that it is the highest-priority application registered for that media type.</span></span> <span data-ttu-id="13b4b-160">Nesse caso, ele mantém a chamada e os processa normalmente.</span><span class="sxs-lookup"><span data-stu-id="13b4b-160">If so, it keeps the call and processes it normally.</span></span> <span data-ttu-id="13b4b-161">Caso contrário, ele entrega a chamada para outro aplicativo registrado para esse tipo de mídia.</span><span class="sxs-lookup"><span data-stu-id="13b4b-161">If not, it hands the call off to another application registered for that media type.</span></span>

<span data-ttu-id="13b4b-162">No entanto, se a investigação desse tipo de mídia falhar, o aplicativo investigará novamente, tentando as possibilidades de modo de mídia restante.</span><span class="sxs-lookup"><span data-stu-id="13b4b-162">If, however, the probe for that media type fails, the application probes again, attempting the remaining media-mode possibilities.</span></span> <span data-ttu-id="13b4b-163">Primeiro, ele deve desligar o bit do tipo de mídia atual e, em seguida, tentar outra entrega com um tipo diferente.</span><span class="sxs-lookup"><span data-stu-id="13b4b-163">It must first turn off the current media type bit, then try another handoff with a different type.</span></span>

<span data-ttu-id="13b4b-164">Esse processo de investigação e de entrega continua e os tipos de mídia restantes são eliminados um a um.</span><span class="sxs-lookup"><span data-stu-id="13b4b-164">This process of probing and handing off continues, and the remaining media types are eliminated one by one.</span></span> <span data-ttu-id="13b4b-165">Ao longo do caminho, um dos aplicativos pode ver que o tipo de mídia que ele manipula está na chamada e a entrega é bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="13b4b-165">Along the way, one of the applications may see that the media type it handles is on the call, and the handoff is successful.</span></span>

<span data-ttu-id="13b4b-166">O aplicativo deve então definir o tipo de mídia correto e limpar todos os outros bits do tipo de mídia.</span><span class="sxs-lookup"><span data-stu-id="13b4b-166">The application should then set the correct media type and clear all other media-type bits.</span></span> <span data-ttu-id="13b4b-167">Isso informa outros aplicativos interessados do tipo de mídia correto.</span><span class="sxs-lookup"><span data-stu-id="13b4b-167">This informs other interested applications of the correct media type.</span></span> <span data-ttu-id="13b4b-168">Esses outros aplicativos recebem uma mensagem de notificação de eventos informando que o tipo de mídia da chamada foi alterado.</span><span class="sxs-lookup"><span data-stu-id="13b4b-168">These other applications receive an event notification message stating that the call's media type has changed.</span></span>

 

 
