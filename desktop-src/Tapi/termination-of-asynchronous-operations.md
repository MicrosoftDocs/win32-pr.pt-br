---
description: Quando um aplicativo chama a função lineClose com uma ou mais operações assíncronas pendentes, a TAPI pode instruir o provedor de serviços a encerrar operações assíncronas associadas a uma chamada.
ms.assetid: b26ce074-76dc-4a50-8c17-d3412c336d59
title: Término de operações assíncronas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f8ed2acb0f442e5f4f07427f0e224d7a288087d6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105754727"
---
# <a name="termination-of-asynchronous-operations"></a><span data-ttu-id="792c5-103">Término de operações assíncronas</span><span class="sxs-lookup"><span data-stu-id="792c5-103">Termination of Asynchronous Operations</span></span>

<span data-ttu-id="792c5-104">Quando um aplicativo chama a função [**lineClose**](/windows/win32/api/tapi/nf-tapi-lineclose) com uma ou mais operações assíncronas pendentes, a TAPI pode instruir o provedor de serviços a encerrar operações assíncronas associadas a uma chamada, dependendo se o aplicativo é o único proprietário da chamada e tem o único identificador para a chamada.</span><span class="sxs-lookup"><span data-stu-id="792c5-104">When an application calls the [**lineClose**](/windows/win32/api/tapi/nf-tapi-lineclose) function with one or more outstanding asynchronous operations, TAPI may direct the service provider to terminate asynchronous operations associated with a call, depending on whether the application is the sole owner of the call and has the only handle to the call.</span></span>

<span data-ttu-id="792c5-105">Se o aplicativo for o único proprietário de uma chamada, a TAPI chamará [**TSPI \_ LineDropOnClose**](./tspi-linedroponclose.md) ou [**TSPI \_ lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop) (dependendo do provedor) para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="792c5-105">If the application is the sole owner of a call, TAPI calls [**TSPI\_lineDropOnClose**](./tspi-linedroponclose.md) or [**TSPI\_lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop) (depending on the provider) for each such call.</span></span> <span data-ttu-id="792c5-106">O provedor de serviços deve verificar se há operações assíncronas pendentes associadas à chamada que está sendo descartada.</span><span class="sxs-lookup"><span data-stu-id="792c5-106">The service provider should check for any pending asynchronous operations associated with the call being dropped.</span></span> <span data-ttu-id="792c5-107">Se houver uma operação pendente, o provedor de serviços deverá executar a ação apropriada, possivelmente encerrando a operação em andamento.</span><span class="sxs-lookup"><span data-stu-id="792c5-107">If a pending operation exists, the service provider should take the appropriate action, possibly terminating the operation in progress.</span></span>

<span data-ttu-id="792c5-108">Se o aplicativo tiver o único identificador para uma chamada (ou seja, não houver outros proprietários ou monitores), a TAPI chamará a função [**TSPI \_ lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) .</span><span class="sxs-lookup"><span data-stu-id="792c5-108">If the application has the only handle to a call (that is, there are no other owners or monitors), TAPI calls the [**TSPI\_lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) function.</span></span> <span data-ttu-id="792c5-109">O provedor de serviços deve considerar essa chamada para ser a indicação absoluta de que operações assíncronas pendentes devem ser abandonadas.</span><span class="sxs-lookup"><span data-stu-id="792c5-109">The service provider must consider this call to be the absolute indication that pending asynchronous operations must be abandoned.</span></span> <span data-ttu-id="792c5-110">O provedor de serviços deve garantir uma conclusão ordenada da chamada e deve chamar a função de retorno de chamada de [**\_ conclusão assíncrona**](/windows/win32/api/tspi/nc-tspi-async_completion) para todas as operações assíncronas pendentes, especificando o \_ valor de erro LINEERR OPERATIONFAILED.</span><span class="sxs-lookup"><span data-stu-id="792c5-110">The service provider must ensure an orderly completion of the call, and must call the [**ASYNC\_COMPLETION**](/windows/win32/api/tspi/nc-tspi-async_completion) callback function for all outstanding asynchronous operations, specifying the LINEERR\_OPERATIONFAILED error value.</span></span> <span data-ttu-id="792c5-111">Se a TAPI chamou anteriormente a função [**TSPI \_ LineDropOnClose**](./tspi-linedroponclose.md) ou [**TSPI \_ LineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop) , ela chamará **TSPI \_ lineCloseCall** imediatamente depois que o provedor de serviços retornar da outra chamada; ele não aguardará a operação assíncrona associada à função TSPI **\_ lineDrop** para ser concluída.</span><span class="sxs-lookup"><span data-stu-id="792c5-111">If TAPI previously called the [**TSPI\_lineDropOnClose**](./tspi-linedroponclose.md) or [**TSPI\_lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop) function, it calls **TSPI\_lineCloseCall** immediately after the service provider returns from the other call; it does not wait for the asynchronous operation associated with the **TSPI\_lineDrop** function to complete.</span></span>

<span data-ttu-id="792c5-112">Se o aplicativo não for o único proprietário da chamada, a TAPI não chamará [**TSPI \_ LineDropOnClose**](./tspi-linedroponclose.md) ou [**TSPI \_ lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop).</span><span class="sxs-lookup"><span data-stu-id="792c5-112">If the application is not the sole owner of the call, TAPI does not call [**TSPI\_lineDropOnClose**](./tspi-linedroponclose.md) or [**TSPI\_lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop).</span></span> <span data-ttu-id="792c5-113">Se o aplicativo não tiver o único identificador para a chamada, a TAPI não chamará a função [**TSPI \_ lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) .</span><span class="sxs-lookup"><span data-stu-id="792c5-113">If the application does not have the only handle to the call, TAPI does not call the [**TSPI\_lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) function.</span></span> <span data-ttu-id="792c5-114">Se o aplicativo não for o proprietário exclusivo nem o único possessor de um identificador para a chamada, a TAPI não enviará nenhuma notificação para o provedor de serviços e, portanto, quaisquer operações assíncronas pendentes permanecerão intactas.</span><span class="sxs-lookup"><span data-stu-id="792c5-114">If the application is neither the sole owner nor the sole possessor of a handle to the call, TAPI sends no notification to the service provider, and therefore, any pending asynchronous operations remain intact.</span></span> <span data-ttu-id="792c5-115">Isso significa que esses aplicativos não podem finalizar operações assíncronas que começaram usando a função [**lineClose**](/windows/win32/api/tapi/nf-tapi-lineclose) .</span><span class="sxs-lookup"><span data-stu-id="792c5-115">This means that such applications cannot terminate asynchronous operations that they have started by using the [**lineClose**](/windows/win32/api/tapi/nf-tapi-lineclose) function.</span></span> <span data-ttu-id="792c5-116">No entanto, como cada operação assíncrona exige que o aplicativo de invocação seja um proprietário da chamada, a probabilidade de um aplicativo não ser capaz de encerrar as operações assíncronas é muito rara.</span><span class="sxs-lookup"><span data-stu-id="792c5-116">However, because every asynchronous operation requires the invoking application to be an owner of the call, the likelihood of an application not being able to terminate asynchronous operations is very rare.</span></span> <span data-ttu-id="792c5-117">Se isso ocorrer, os outros proprietários das chamadas deverão assumir a responsabilidade pela disposição da (s) chamada (ões).</span><span class="sxs-lookup"><span data-stu-id="792c5-117">If it does occur, the other owner(s) of the call(s) must take responsibility for the disposition of the call(s).</span></span>

<span data-ttu-id="792c5-118">Se a TAPI chamar [**TSPI \_ LineDropOnClose**](./tspi-linedroponclose.md) ou [**TSPI \_ lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop), o provedor de serviços deverá, eventualmente, enviar uma \_ mensagem de LINECALLSTATE ociosa para a chamada associada (a menos que [**TSPI \_ lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) seja chamado primeiro) para que os monitores na chamada possam ser limpos.</span><span class="sxs-lookup"><span data-stu-id="792c5-118">If TAPI calls [**TSPI\_lineDropOnClose**](./tspi-linedroponclose.md) or [**TSPI\_lineDrop**](/windows/win32/api/tspi/nf-tspi-tspi_linedrop), the service provider must eventually send a LINECALLSTATE\_IDLE message for the associated call (unless [**TSPI\_lineCloseCall**](/windows/win32/api/tspi/nf-tspi-tspi_lineclosecall) is called first) so that monitors on the call can clean up.</span></span> <span data-ttu-id="792c5-119">Quando o último monitor chamou a função [**lineDeallocateCall**](/windows/win32/api/tapi/nf-tapi-linedeallocatecall) , a TAPI chama a **função \_ lineCloseCall TSPI** ; todas as operações pendentes devem ser concluídas ou terminadas e a [**\_ conclusão assíncrona**](/windows/win32/api/tspi/nc-tspi-async_completion) chamada, conforme descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="792c5-119">When the last monitor has called the [**lineDeallocateCall**](/windows/win32/api/tapi/nf-tapi-linedeallocatecall) function, TAPI calls the **TSPI\_lineCloseCall** function; any pending operations must be completed or terminated and [**ASYNC\_COMPLETION**](/windows/win32/api/tspi/nc-tspi-async_completion) called, as described earlier.</span></span>

 

 
