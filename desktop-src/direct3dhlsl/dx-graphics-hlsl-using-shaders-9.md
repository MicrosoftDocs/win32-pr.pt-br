---
title: Usando sombreadores no Direct3D 9
description: Usando sombreadores no Direct3D 9
ms.assetid: 8d8f5124-fbf3-4af5-8399-43ba28aa6eb9
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: 6455b47d24c1c83683ce8b85c48990bb32e221ae
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104988653"
---
# <a name="using-shaders-in-direct3d-9"></a><span data-ttu-id="e4296-103">Usando sombreadores no Direct3D 9</span><span class="sxs-lookup"><span data-stu-id="e4296-103">Using Shaders in Direct3D 9</span></span>

-   [<span data-ttu-id="e4296-104">Compilando um sombreador para hardware específico</span><span class="sxs-lookup"><span data-stu-id="e4296-104">Compiling a Shader for Specific Hardware</span></span>](#compiling-a-shader-for-specific-hardware)
-   [<span data-ttu-id="e4296-105">Inicializando constantes do sombreador</span><span class="sxs-lookup"><span data-stu-id="e4296-105">Initializing Shader Constants</span></span>](#initializing-shader-constants)
-   [<span data-ttu-id="e4296-106">Associando um parâmetro de sombreador a um registro específico</span><span class="sxs-lookup"><span data-stu-id="e4296-106">Binding a Shader Parameter to a Particular Register</span></span>](#binding-a-shader-parameter-to-a-particular-register)
-   [<span data-ttu-id="e4296-107">Renderizando um sombreador programável</span><span class="sxs-lookup"><span data-stu-id="e4296-107">Rendering a Programmable Shader</span></span>](#rendering-a-programmable-shader)
-   [<span data-ttu-id="e4296-108">Depurando sombreadores</span><span class="sxs-lookup"><span data-stu-id="e4296-108">Debugging Shaders</span></span>](#debugging-shaders)
-   [<span data-ttu-id="e4296-109">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="e4296-109">Related topics</span></span>](#related-topics)

## <a name="compiling-a-shader-for-specific-hardware"></a><span data-ttu-id="e4296-110">Compilando um sombreador para hardware específico</span><span class="sxs-lookup"><span data-stu-id="e4296-110">Compiling a Shader for Specific Hardware</span></span>

<span data-ttu-id="e4296-111">Os sombreadores foram adicionados primeiro ao Microsoft DirectX no DirectX 8,0.</span><span class="sxs-lookup"><span data-stu-id="e4296-111">Shaders were first added to Microsoft DirectX in DirectX 8.0.</span></span> <span data-ttu-id="e4296-112">Nesse momento, várias máquinas virtuais de sombreador foram definidas, cada uma correspondendo aproximadamente a um processador gráfico específico produzido pelos principais fornecedores de gráficos 3D.</span><span class="sxs-lookup"><span data-stu-id="e4296-112">At that time, several virtual shader machines were defined, each roughly corresponding to a particular graphics processor produced by the top 3D graphics vendors.</span></span> <span data-ttu-id="e4296-113">Para cada um desses computadores de sombreador virtual, uma linguagem de assembly foi projetada.</span><span class="sxs-lookup"><span data-stu-id="e4296-113">For each of these virtual shader machines, an assembly language was designed.</span></span> <span data-ttu-id="e4296-114">Os programas escritos nos modelos de sombreador (nomes vs \_ 1 \_ e PS \_ 1 \_ 1-PS \_ 1 \_ 4) eram relativamente curtos e geralmente eram escritos por desenvolvedores diretamente na linguagem de assembly apropriada.</span><span class="sxs-lookup"><span data-stu-id="e4296-114">Programs written to the shader models (names vs\_1\_1 and ps\_1\_1 - ps\_1\_4) were relatively short and were generally written by developers directly in the appropriate assembly language.</span></span> <span data-ttu-id="e4296-115">O aplicativo passaria esse código de linguagem de assembly legível por humanos para a biblioteca D3DX usando [**D3DXAssembleShader**](/windows/desktop/direct3d9/d3dxassembleshader) e obteria uma representação binária do sombreador que, por sua vez, seria passado usando [**CreateVertexShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createvertexshader) ou [**CreatePixelShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createpixelshader).</span><span class="sxs-lookup"><span data-stu-id="e4296-115">The application would pass this human-readable assembly language code to the D3DX library using [**D3DXAssembleShader**](/windows/desktop/direct3d9/d3dxassembleshader) and get back a binary representation of the shader which would in turn get passed using [**CreateVertexShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createvertexshader) or [**CreatePixelShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createpixelshader).</span></span> <span data-ttu-id="e4296-116">Para obter mais detalhes, consulte o Software Development Kit (SDK).</span><span class="sxs-lookup"><span data-stu-id="e4296-116">For more detail, see the software development kit (SDK).</span></span>

<span data-ttu-id="e4296-117">A situação no Direct3D 9 é semelhante.</span><span class="sxs-lookup"><span data-stu-id="e4296-117">The situation in Direct3D 9 is similar.</span></span> <span data-ttu-id="e4296-118">Um aplicativo passa um sombreador HLSL para D3DX usando [**D3DXCompileShader**](/windows/desktop/direct3d9/d3dxcompileshader) e obtém de volta uma representação binária do sombreador compilado que, por sua vez, é passado para o Microsoft Direct3D usando [**CreatePixelShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createpixelshader) ou [**CreateVertexShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createvertexshader).</span><span class="sxs-lookup"><span data-stu-id="e4296-118">An application passes an HLSL shader to D3DX using [**D3DXCompileShader**](/windows/desktop/direct3d9/d3dxcompileshader) and gets back a binary representation of the compiled shader which in turn is passed to Microsoft Direct3D using [**CreatePixelShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createpixelshader) or [**CreateVertexShader**](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-createvertexshader).</span></span> <span data-ttu-id="e4296-119">O tempo de execução não sabe nada sobre HLSL, apenas os modelos de sombreador de assembly binário.</span><span class="sxs-lookup"><span data-stu-id="e4296-119">The runtime does not know anything about HLSL, only the binary assembly shader models.</span></span> <span data-ttu-id="e4296-120">Isso é bom porque significa que o compilador HLSL pode ser atualizado independentemente do tempo de execução do Direct3D.</span><span class="sxs-lookup"><span data-stu-id="e4296-120">This is nice because it means that the HLSL compiler can be updated independent of the Direct3D runtime.</span></span> <span data-ttu-id="e4296-121">Você também pode compilar sombreadores offline usando [FXC](/windows/desktop/direct3dtools/fxc).</span><span class="sxs-lookup"><span data-stu-id="e4296-121">You can also compile shaders offline using [fxc](/windows/desktop/direct3dtools/fxc).</span></span>

<span data-ttu-id="e4296-122">Além do desenvolvimento do compilador HLSL, o Direct3D 9 também introduziu os modelos de sombreamento de nível de assembly para expor a funcionalidade da última geração de hardware de gráficos.</span><span class="sxs-lookup"><span data-stu-id="e4296-122">In addition to the development of the HLSL compiler, Direct3D 9 also introduced the assembly-level shader models to expose the functionality of the latest generation of graphics hardware.</span></span> <span data-ttu-id="e4296-123">Os desenvolvedores de aplicativos podem trabalhar no assembly para esses novos modelos (vs \_ 2 \_ 0, vs \_ 3 \_ 0, PS \_ 2 \_ 0, PS \_ 3 \_ 0), mas esperamos que a maioria dos desenvolvedores mude para o HLSL para o desenvolvimento de sombreador.</span><span class="sxs-lookup"><span data-stu-id="e4296-123">Application developers can work in assembly for these new models (vs\_2\_0, vs\_3\_0, ps\_2\_0, ps\_3\_0) but we expect most developers to move to HLSL for shader development.</span></span>

<span data-ttu-id="e4296-124">É claro que a capacidade de escrever um programa HLSL para expressar um determinado algoritmo de sombreamento não permite que ele seja executado automaticamente em um determinado hardware.</span><span class="sxs-lookup"><span data-stu-id="e4296-124">Of course, the ability to write an HLSL program to express a particular shading algorithm does not automatically enable it to run on any given hardware.</span></span> <span data-ttu-id="e4296-125">Um aplicativo chama D3DX para compilar um sombreador no código de assembly binário com [**D3DXCompileShader**](/windows/desktop/direct3d9/d3dxcompileshader).</span><span class="sxs-lookup"><span data-stu-id="e4296-125">An application calls D3DX to compile a shader into binary assembly code with [**D3DXCompileShader**](/windows/desktop/direct3d9/d3dxcompileshader).</span></span> <span data-ttu-id="e4296-126">Uma das limitações com esse ponto de entrada é um parâmetro que define quais dos modelos de nível de assembly (ou destinos de compilação) o compilador HLSL deve usar para expressar o código final do sombreador.</span><span class="sxs-lookup"><span data-stu-id="e4296-126">One of the limitations with this entry point is a parameter that defines which of the assembly-level models (or compilation targets) the HLSL compiler should use to express the final shader code.</span></span> <span data-ttu-id="e4296-127">Se um aplicativo estiver fazendo a compilação do sombreador HLSL em tempo de execução (em oposição ao tempo de compilação ou offline), o aplicativo poderá examinar os recursos do dispositivo Direct3D e selecionar o destino de compilação para corresponder.</span><span class="sxs-lookup"><span data-stu-id="e4296-127">If an application is doing HLSL shader compilation at run time (as opposed to compile time or offline), the application could examine the capabilities of the Direct3D device and select the compilation target to match.</span></span> <span data-ttu-id="e4296-128">Se o algoritmo expresso no sombreador HLSL for muito complexo para ser executado no destino de compilação selecionado, ocorrerá uma falha na compilação.</span><span class="sxs-lookup"><span data-stu-id="e4296-128">If the algorithm expressed in the HLSL shader is too complex to execute on the selected compilation target, compilation will fail.</span></span> <span data-ttu-id="e4296-129">Isso significa que, embora HLSL seja um grande benefício para o desenvolvimento de sombreador, ele não libera os desenvolvedores da realidade de enviar jogos para um público-alvo com dispositivos gráficos de diferentes recursos.</span><span class="sxs-lookup"><span data-stu-id="e4296-129">This means that while HLSL is a huge benefit to shader development, it does not free developers from the realities of shipping games to a target audience with graphics devices of varying capabilities.</span></span> <span data-ttu-id="e4296-130">Como desenvolvedor de jogos, você ainda precisa gerenciar uma abordagem em camadas para seus visuais; Isso significa escrever melhores sombreadores para placas gráficas mais compatíveis e escrever versões mais básicas para cartões mais antigos.</span><span class="sxs-lookup"><span data-stu-id="e4296-130">As a game developer, you still have to manage a tiered approach to your visuals; this means writing better shaders for more capable graphics cards and writing more basic versions for older cards.</span></span> <span data-ttu-id="e4296-131">No entanto, com HLSL bem escrito, essa carga pode ser facilitouda de forma significativa.</span><span class="sxs-lookup"><span data-stu-id="e4296-131">With well written HLSL, however, this burden can be eased significantly.</span></span>

<span data-ttu-id="e4296-132">Em vez de Compilar sombreadores HLSL usando o D3DX na máquina do cliente no momento da carga do aplicativo ou no primeiro uso, muitos desenvolvedores optam por compilar seu sombreador de HLSL para código de assembly binário antes que eles sejam entregues.</span><span class="sxs-lookup"><span data-stu-id="e4296-132">Rather than compile HLSL shaders using D3DX on the customer's machine at application load time or on first use, many developers choose to compile their shader from HLSL to binary assembly code before they even ship.</span></span> <span data-ttu-id="e4296-133">Isso mantém seu código-fonte HLSL longe dos olhos curiosos e também garante que todos os sombreadores que seus aplicativos serão executados terão passado pelo seu processo de controle de qualidade interno.</span><span class="sxs-lookup"><span data-stu-id="e4296-133">This keeps their HLSL source code away from prying eyes and also ensures that all the shaders their application will ever run have gone through their internal quality assurance process.</span></span> <span data-ttu-id="e4296-134">Um utilitário conveniente para a compilação de sombreadores offline é o [FXC](/windows/desktop/direct3dtools/fxc).</span><span class="sxs-lookup"><span data-stu-id="e4296-134">A convenient utility for compiling shaders offline is [fxc](/windows/desktop/direct3dtools/fxc).</span></span> <span data-ttu-id="e4296-135">Essa ferramenta tem várias opções que você pode usar para compilar o código para o destino de compilação especificado.</span><span class="sxs-lookup"><span data-stu-id="e4296-135">This tool has a number of options that you can use to compile code for the specified compile target.</span></span> <span data-ttu-id="e4296-136">Estudar a saída desmontada pode ser muito educativo durante o desenvolvimento se você quiser otimizar seus sombreadores ou, geralmente, conhecer os recursos da máquina do sombreador virtual em um nível mais detalhado.</span><span class="sxs-lookup"><span data-stu-id="e4296-136">Studying the disassembled output can be very educational during development if you want to optimize your shaders or just generally get to know the virtual shader machine's capabilities at a more detailed level.</span></span> <span data-ttu-id="e4296-137">Essas opções são resumidas abaixo:</span><span class="sxs-lookup"><span data-stu-id="e4296-137">These options are summarized below:</span></span>

## <a name="initializing-shader-constants"></a><span data-ttu-id="e4296-138">Inicializando constantes do sombreador</span><span class="sxs-lookup"><span data-stu-id="e4296-138">Initializing Shader Constants</span></span>

<span data-ttu-id="e4296-139">As constantes do sombreador estão contidas na tabela de constantes.</span><span class="sxs-lookup"><span data-stu-id="e4296-139">Shader constants are contained in the constant table.</span></span> <span data-ttu-id="e4296-140">Isso pode ser acessado com a interface [**ID3DXConstantTable**](/windows/desktop/direct3d9/id3dxconstanttable) .</span><span class="sxs-lookup"><span data-stu-id="e4296-140">This can be accessed with the [**ID3DXConstantTable**](/windows/desktop/direct3d9/id3dxconstanttable) interface.</span></span> <span data-ttu-id="e4296-141">As variáveis de sombreador global podem ser inicializadas no código do sombreador.</span><span class="sxs-lookup"><span data-stu-id="e4296-141">Global shader variables can be initialized in shader code.</span></span> <span data-ttu-id="e4296-142">Eles são inicializados em tempo de execução chamando [**setpadrões**](/windows/desktop/direct3d9/id3dxconstanttable--setdefaults).</span><span class="sxs-lookup"><span data-stu-id="e4296-142">These are initialized at run time by calling [**SetDefaults**](/windows/desktop/direct3d9/id3dxconstanttable--setdefaults).</span></span>

## <a name="binding-a-shader-parameter-to-a-particular-register"></a><span data-ttu-id="e4296-143">Associando um parâmetro de sombreador a um registro específico</span><span class="sxs-lookup"><span data-stu-id="e4296-143">Binding a Shader Parameter to a Particular Register</span></span>

<span data-ttu-id="e4296-144">O compilador atribuirá automaticamente os registros a variáveis globais.</span><span class="sxs-lookup"><span data-stu-id="e4296-144">The compiler will automatically assign registers to global variables.</span></span> <span data-ttu-id="e4296-145">O compilador atribuiria o ambiente para o registro de amostra S0, SparkleNoise para o registro de amostra S1 e k \_ s para o registro constante C0 (supondo que nenhuma outra amostra ou registro constante já foi atribuído) para as três seguintes variáveis globais:</span><span class="sxs-lookup"><span data-stu-id="e4296-145">The compiler would assign Environment to sampler register s0, SparkleNoise to sampler register s1, and k\_s to constant register c0 (assuming no other sampler or constant registers were already assigned) for the following three global variables:</span></span>


```
sampler Environment;
sampler SparkleNoise;
float4 k_s;
```



<span data-ttu-id="e4296-146">Também é possível associar variáveis a um registro específico.</span><span class="sxs-lookup"><span data-stu-id="e4296-146">It is also possible to bind variables to a specific register.</span></span> <span data-ttu-id="e4296-147">Para forçar o compilador a atribuir a um registro específico, use a seguinte sintaxe:</span><span class="sxs-lookup"><span data-stu-id="e4296-147">To force the compiler to assign to a particular register, use the following syntax:</span></span>


```
register(RegisterName)
```



<span data-ttu-id="e4296-148">em que Registrname é o nome do registro específico.</span><span class="sxs-lookup"><span data-stu-id="e4296-148">where RegisterName is the name of the specific register.</span></span> <span data-ttu-id="e4296-149">Os exemplos a seguir demonstram a sintaxe de atribuição de Registro específica, em que o ambiente de amostra será associado ao registro de amostra S1, SparkleNoise será associado ao registro de amostra S0 e k \_ s serão associados a C12 de registro constante:</span><span class="sxs-lookup"><span data-stu-id="e4296-149">The following examples demonstrate the specific register assignment syntax, where the sampler Environment will be bound to sampler register s1, SparkleNoise will be bound to sampler register s0, and k\_s will be bound to constant register c12:</span></span>


```
sampler Environment : register(s1);
sampler SparkleNoise : register(s0);
float4 k_s : register(c12);
```



## <a name="rendering-a-programmable-shader"></a><span data-ttu-id="e4296-150">Renderizando um sombreador programável</span><span class="sxs-lookup"><span data-stu-id="e4296-150">Rendering a Programmable Shader</span></span>

<span data-ttu-id="e4296-151">Um sombreador é renderizado definindo o sombreador atual no dispositivo, inicializando as constantes do sombreador, informando ao dispositivo de onde os dados de entrada variados são provenientes e, finalmente, Renderizando os primitivos.</span><span class="sxs-lookup"><span data-stu-id="e4296-151">A shader is rendered by setting the current shader in the device, initializing the shader constants, telling the device where the varying input data is coming from, and finally rendering the primitives.</span></span> <span data-ttu-id="e4296-152">Cada um deles pode ser feito chamando os seguintes métodos, respectivamente:</span><span class="sxs-lookup"><span data-stu-id="e4296-152">Each of these can be accomplished by calling the following methods respectively:</span></span>

-   [<span data-ttu-id="e4296-153">**SetVertexShader**</span><span class="sxs-lookup"><span data-stu-id="e4296-153">**SetVertexShader**</span></span>](/windows/desktop/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setvertexshader)
-   [<span data-ttu-id="e4296-154">**SetVertexShaderConstantF**</span><span class="sxs-lookup"><span data-stu-id="e4296-154">**SetVertexShaderConstantF**</span></span>](/windows/desktop/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setvertexshaderconstantf)
-   [<span data-ttu-id="e4296-155">**Setstreaming**</span><span class="sxs-lookup"><span data-stu-id="e4296-155">**SetStreamSource**</span></span>](/windows/desktop/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setstreamsource)
-   [<span data-ttu-id="e4296-156">**DrawPrimitive**</span><span class="sxs-lookup"><span data-stu-id="e4296-156">**DrawPrimitive**</span></span>](/windows/desktop/api/d3d9/nf-d3d9-idirect3ddevice9-drawprimitive)

## <a name="debugging-shaders"></a><span data-ttu-id="e4296-157">Depurando sombreadores</span><span class="sxs-lookup"><span data-stu-id="e4296-157">Debugging Shaders</span></span>

<span data-ttu-id="e4296-158">A extensão do DirectX para Microsoft Visual Studio .NET fornece um depurador HLSL totalmente integrado no ambiente de desenvolvimento integrado (IDE) do Visual Studio .NET.</span><span class="sxs-lookup"><span data-stu-id="e4296-158">The DirectX extension for Microsoft Visual Studio .NET is provides a fully integrated HLSL debugger within the Visual Studio .NET Integrated Development Environment (IDE).</span></span> <span data-ttu-id="e4296-159">Para se preparar para a depuração de sombreador, você deve instalar as ferramentas corretas em seu computador (consulte [sombreadores de depuração no Visual Studio (Direct3D 9)](dx-graphics-hlsl-debug-visual-studio.md)).</span><span class="sxs-lookup"><span data-stu-id="e4296-159">In order to prepare for shader debugging, you must install the right tools on your machine (see [Debugging Shaders in Visual Studio (Direct3D 9)](dx-graphics-hlsl-debug-visual-studio.md)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="e4296-160">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="e4296-160">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="e4296-161">Guia de programação para HLSL</span><span class="sxs-lookup"><span data-stu-id="e4296-161">Programming Guide for HLSL</span></span>](dx-graphics-hlsl-pguide.md)
</dt> </dl>

 

 