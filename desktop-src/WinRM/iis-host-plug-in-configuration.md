---
title: Configuração de plug-in de host do IIS
description: A configuração de plug-in do host do Gerenciamento Remoto do Windows (WinRM) Serviços de Informações da Internet (IIS) fornece um mecanismo de hospedagem que permite que plug-ins do WinRM de terceiros exponham dados de gerenciamento na infraestrutura do WinRM.
ms.assetid: 234e6f7b-310f-499a-83e4-699ecf3816f0
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 714139c25836f5929ca6cfa3fe6797a90e80dde8
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103917337"
---
# <a name="iis-host-plug-in-configuration"></a>Configuração de plug-in de host do IIS

A configuração de plug-in do host do Gerenciamento Remoto do Windows (WinRM) Serviços de Informações da Internet (IIS) fornece um mecanismo de hospedagem que permite que plug-ins do WinRM de terceiros exponham dados de gerenciamento na infraestrutura do WinRM.

As seções a seguir descrevem a configuração de plug-in do host do IIS:

-   [Detalhes de hospedagem do IIS](#iis-hosting-details)
-   [Modelo de configuração de host do IIS](#iis-host-configuration-model)
-   [Detalhes e instalação da configuração do host do IIS (WinRM)](/windows)
-   [Lendo a configuração do host do IIS](#reading-iis-host-configuration)
-   [Enumerando plug-ins no serviço WinRM](#enumerating-plug-ins-on-the-winrm-service)

## <a name="iis-hosting-details"></a>Detalhes de hospedagem do IIS

Um aplicativo que configura e inicializa o processador SOAP do WinRM no IIS receberá solicitações diretamente de um cliente WinRM em outro computador usando o protocolo WS-Management. O aplicativo também deve configurar um ponto de extremidade HTTP que identifica o aplicativo para garantir que todas as solicitações sejam roteadas diretamente para os plug-ins específicos do aplicativo. O aplicativo também deve configurar quais plug-ins carregar no host do IIS e os mecanismos de autorização e autenticação necessários. Ao usar o serviço WinRM no IIS, os seguintes fatores devem ser considerados:

-   O IIS não oferece suporte à autenticação Kerberos por padrão. No entanto, um módulo do IIS pode ser criado para dar suporte à autenticação Kerberos.
-   O serviço IIS não aceitará solicitações de serviço WinRM criptografadas por HTTP.
-   Depois de configurar um ponto de extremidade do IIS, a primeira solicitação enviada com credenciais implícitas falhará; no entanto, todas as solicitações subsequentes serão realizadas com sucesso. Esse é um problema conhecido com um site do IIS configurado com a autenticação de modo kernel padrão. Se esse for um problema de bloqueio, é recomendável que você desative a autenticação do modo kernel.

## <a name="iis-host-configuration-model"></a>Modelo de configuração de host do IIS

Todos os aplicativos que hospedam um processador SOAP do WinRM no IIS requerem configuração antes de funcionarem.

Cada configuração de aplicativo é separada da de outros aplicativos. Os seguintes conjuntos de configurações são necessários, embora possivelmente nem todas as configurações precisem ser alteradas, e elas são feitas por meio do serviço WinRM principal:

-   Configuração geral do aplicativo, incluindo o tempo limite da operação.
-   Um plug-in de autorização para autorizar solicitações do LiveID ou mapear a conta de usuário do Windows para uma conta de serviço mais genérica.
-   Plug-ins de operação a serem hospedados e usados pelo processador SOAP do WinRM para realizar as solicitações reais.

As configurações a seguir podem precisar ser configuradas no IIS:

-   Informações de ponto de extremidade de [*ouvinte*](windows-remote-management-glossary.md) que definem quais portas e endereços estão escutando solicitações junto com quaisquer certificados de protocolo SSL (SSL).
-   Mapeamento de certificado de cliente para mapear certificados de cliente para contas de usuário.
-   Configuração de autorização para limitar quem tem acesso ao site virtual.

O serviço WinRM registra a porta 5985 com o prefixo "WSMan" por padrão. Se o ouvinte de HTTP de compatibilidade estiver habilitado, o serviço WinRM registrará a porta 80 com o prefixo "WSMan" por padrão. Como o IIS também escuta na porta 80 por padrão, é recomendável que os serviços de host do IIS criem [*ouvintes*](windows-remote-management-glossary.md) em uma porta diferente.

Se o serviço do IIS e do WinRM compartilharem a porta 80, a configuração a seguir será necessária para compartilhar a porta:

-   O serviço de host do IIS precisa habilitar o WinRM em um aplicativo sob o site.
-   O nome do aplicativo precisa ser adicionado ao URI. Por exemplo: https://servername/myapplication.

Cada aplicativo host do IIS é armazenado na configuração do IIS como um arquivo web.config que reside no diretório físico correspondente ao diretório virtual configurado. A seção a seguir descreve como o sistema de configuração do IIS funciona e como ele pode ser estendido para dar suporte à configuração de host do IIS do WinRM.

### <a name="how-iis-configuration-works"></a>Como funciona a configuração do IIS

A infraestrutura de configuração do IIS consiste em um conjunto de arquivos XML usados para armazenar dados de configuração e um conjunto de arquivos de esquema usados para validar dados gravados ou lidos por meio de APIs de administração do IIS. No nível raiz, há um arquivo de ApplicationHost.config no mesmo diretório que o IIS (normalmente,% windir% \\ System32 \\ inetsrv \\ config). Esse é o arquivo de configuração principal para o IIS, onde a lista de sites, aplicativos, diretórios virtuais, configurações gerais, registro em log, cache e assim por diante são armazenados. Os dados de configuração são divididos e acessados como entidades independentes chamadas **seções**.

Por exemplo, há **seções** separadas para sites, registro em log, cache e assim por diante. Todos os dados de configuração contidos no ApplicationHost.config são aplicados a todos os sites, aplicativos e diretórios virtuais configurados no IIS. No nível do diretório virtual, um arquivo de web.config define dados de configuração específicos do aplicativo, possivelmente substituindo outros dados já definidos em ApplicationHost.config. Web.config arquivos são armazenados na raiz (diretório físico) correspondente ao site, ao aplicativo ou ao diretório virtual ao qual a configuração se aplica.

Para obter mais informações sobre a configuração do IIS, consulte o seguinte:

-   [Esquema de configurações do IIS 7,0](/previous-versions/iis/settings-schema/aa347559(v=vs.90))
-   [/archive/blogs/carlosag/](/archive/blogs/carlosag/)
-   [https://www.iis.net/articles/view.aspx/IIS7/Use-IIS7-Administration-Tools/Using-XML-Configuration/Deep-Dive-into-IIS7](https://www.iis.net/learn/get-started/planning-your-iis-architecture/deep-dive-into-iis-configuration-with-iis-7-and-iis-8)

O esquema de configuração do IIS usado para validar os dados de configuração do IIS são arquivos XML armazenados no diretório de esquema do IIS (normalmente,% windir% \\ System32 \\ inetsrv \\ config \\ Schema). O esquema de configuração do IIS não é XSD. A configuração do IIS dá suporte à extensibilidade. Novas seções de configuração podem ser diretamente integradas ao sistema de configuração do IIS, e as configurações do sistema de configuração do IIS podem ser manipuladas usando as APIs de administração existentes.

A seguir estão as principais etapas envolvidas:

-   Defina uma nova seção de configuração em um arquivo de esquema XML.
-   Coloque o arquivo no diretório de esquema do IIS 7 (% windir% \\ System32 \\ inetsrv \\ config \\ Schema).
-   Registre a nova seção no arquivo de configuração global do IIS (ApplicationHost.config).

## <a name="iis-host-winrm-configuration-setup-and-details"></a>Detalhes e instalação da configuração do host do IIS (WinRM)

Esta seção descreve as etapas a serem executadas durante a instalação para integrar e inicializar a configuração do host do IIS. Aqui, a configuração do host do IIS refere-se aos dados de configuração necessários para executar o serviço WinRM no IIS. O módulo de extensão do IIS do WinRM é um componente opcional que é instalado usando o **Gerenciador do servidor**.

A seção de configuração do IIS que define a configuração necessária é chamada de **system.management.wsmanagement.config**. Normalmente, a configuração do host do IIS é definida durante a instalação. Isso pode ser feito criando um arquivo de web.config e adicionando o XML apropriado. As alterações no arquivo de web.config exigem a reinicialização do site que hospeda o serviço WinRM.

O procedimento a seguir descreve a configuração da extensão do IIS do WinRM em detalhes.

**Para instalar a extensão do IIS do WinRM**

1.  Na seção **Resumo de recursos** do **Gerenciador do servidor**, clique em **Adicionar recursos**.
2.  No Assistente para adicionar recursos, selecione extensão do IIS do WinRM.
3.  Siga as instruções do assistente, incluindo a instalação do software necessário, se algum for indicado. Para obter mais informações sobre como usar o assistente para adicionar recursos, consulte a ajuda online do **Gerenciador do servidor** .

### <a name="initializing-winrm-configuration-for-the-hosted-application"></a>Inicializando a configuração do WinRM para o aplicativo hospedado

Esta etapa envolve a definição do XML de configuração do host do IIS no arquivo web.config. Esse arquivo reside no diretório físico correspondente ao diretório virtual em que o aplicativo hospedado está configurado. O conteúdo XML para a seção de **system.management.wsmanagement.config** deve estar em conformidade com o esquema definido em WSManConfig \_schema.xml; caso contrário, as APIs de administração do IIS não poderão processá-lo. Veja a seguir um exemplo de conteúdo XML que pode estar contido no arquivo de web.config:


```XML
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
 <system.webServer>
  <system.management.wsmanagement.config>
   <OperationsConfiguration MaxEnvelopeSizeKB="150" 
                            MaxOperationTimeoutSeconds="60"  
                            MaxEnumerateIdleTimeoutSeconds="60"  
                            MaxSubscribeIdleTimeoutSeconds="60"  
                            MaxShellIdleTimeoutMinutes="15"
                            QuotaRefreshIntervalSeconds="900"
                            QuotaSystemWindowSeconds="2"
                            QuotaSystemWindowOperations-"1000"/>
    <PluginModules>
     <AuthorizationPlugin Name="Auth1" Filename="Auth.dll" SDKVersion="1" SupportsQuota="true"/>
     <OperationsPlugins>
      <Plugin Name="PL1" Filename="PL1.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters>
        <Param name="myParam1" value="myValue1"/>
       </InitializationParameters>
       <Resources>
        <Resource ResourceUri="myUri1">
        <Capability Type="Shell"/>
        </Resource>
       </Resources>
      </Plugin>
      <Plugin Name="PL2" Filename="PL2.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters/>
       <Resources>
        <Resource ResourceUri="myUri1">
         <Capability Type="Get"/>
         <Capability Type="Put"/>
         <Capability Type="Delete"/>
        </Resource>
       </Resources>
      </Plugin>
     </OperationsPlugins>
    </PluginModules>
   </OperationsConfiguration>
  </system.management.wsmanagement.config>
 </system.webServer>
</configuration>
```



A lista a seguir descreve os elementos XML em mais detalhes e é seguida por um exemplo de um \_ arquivo wsmanconfigschema.xml.



| Elemento                                                        | Descrição                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| OperationsConfiguration/MaxEnvelopeSizeKB                      | O tamanho máximo dos pacotes SOAP que o serviço WinRM processará. O valor padrão é 150 KB.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| OperationsConfiguration/MaxOperationTimeoutSeconds             | O intervalo de tempo limite máximo para todas as operações. Esse valor substitui qualquer valor recebido em um pacote SOAP. Se um provedor exceder esse valor, um tempo limite será enviado para o cliente e a operação será cancelada. (Algumas operações, como enumerações, podem manter uma enumeração aberta após um tempo limite.) O padrão é 60 segundos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| OperationsConfiguration/MaxEnumerationIdleTimeoutSeconds       | O intervalo de tempo limite máximo para enumerações. Se o tempo entre as solicitações de enumeração for maior que esse valor, a enumeração será cancelada e o contexto de enumeração emitido anteriormente não será mais válido. O padrão é 60 segundos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/MaxSubscribeIdleTimeoutSeconds         | O intervalo de tempo limite máximo para operações de assinatura. O padrão é 60 segundos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OperationsConfiguration/MaxShellIdleTimeoutMinutes             | O tempo máximo em minutos antes que um shell remoto inativo seja excluído. O padrão é de 15 minutos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OperationsConfiguration/QuotaRefreshIntervalSeconds            | O intervalo antes que as informações de cota de um usuário sejam atualizadas. As solicitações pendentes para o usuário especificado continuam a ser executadas sob a autorização anterior e o contexto de cota até que a atualização seja concluída. O padrão é 900 segundos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/QuotaSystemWindowSeconds               | A duração da janela deslizante de limitação do sistema. O padrão é 2 segundos.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| OperationsConfiguration/QuotaSystemWindowOperations            | O número de operações que são admitidas por meio da limitação do sistema durante a janela deslizante. O padrão é 1000 operações.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| PlugInModules/AuthorizationPlugin                              | Esse nó é opcional. Um plug-in de autorização permite uma maneira programática de aceitar ou rejeitar um usuário de entrada com base em esquemas de autenticação diferentes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| PlugInModules/AuthorizationPlugin/Name                         | Especifica o nome de exibição a ser usado para o plug-in. Se um erro for retornado do plug-in, esse nome será colocado no XML de erro que é retornado para o aplicativo cliente. O nome não é específico da localidade.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/AuthorizationPlugin/filename                     | Especifica o nome do arquivo do plug-in de autorização. Todas as variáveis de ambiente colocadas nessa entrada serão expandidas com base na identidade em que o host IIS está sendo executado, como serviço de rede. O valor padrão dessa entrada é vazio, o que significa que nenhum plug-in de autorização é usado.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| PlugInModules/AuthorizationPlugin/SDKVersion                   | Especifica a versão do Software Development Kit (SDK) para o qual um plug-in específico foi gravado. Esse elemento deve ser definido como 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| PlugInModules/AuthorizationPlugin/SupportsQuota                | Especifica se o plug-in de autorização dá suporte a cotas.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| PlugInModules/OperationsPlugins/Name                           | Especifica o nome de exibição a ser usado para o plug-in. Se um erro for retornado do plug-in, esse nome será colocado no XML de erro que é retornado para o aplicativo cliente. O nome não é específico da localidade.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/OperationsPlugins/FileName                       | Especifica o nome do arquivo do plug-in de operação. Todas as variáveis de ambiente colocadas nessa entrada serão expandidas no contexto do usuário quando uma solicitação chegar. Cada usuário pode ter uma versão diferente da mesma variável de ambiente, de modo que cada usuário poderia acabar com um plug-in diferente. Essa entrada não pode ficar em branco e deve apontar para um plug-in válido.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| PlugInModules/OperationsPlugins/SDKVersion                     | Especifica a versão do SDK para o qual um plug-in específico foi gravado. Esse elemento deve ser definido como 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| PlugInModules/OperationsPlugins/xmlrenderizatype               | Configura o formato em que o XML é passado para plug-ins por meio do objeto de [**\_ dados WSMan**](/windows/desktop/api/Wsman/ns-wsman-wsman_data) . **Xmlrenderizatype** definido como texto. Os dados XML de entrada estão contidos em uma \_ estrutura de texto de tipo de dados WSMan \_ \_ , que representa o XML como um buffer de memória **PCWSTR** .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PlugInModules/OperationsPlugins/InitializationParameters       | Esse nó é opcional e permite que um plug-in configure o XML extra que será passado para o método [**WSManPluginStartup**](/windows/desktop/api/Wsman/nc-wsman-wsman_plugin_startup) . A maioria dos plug-ins não precisará dessas informações adicionais, mas se um plug-in precisar ser usado em mais de um cenário que requer semântica de tempo de execução diferente, esse XML dará ao plug-in a flexibilidade para fazer isso.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| PlugInModules/OperationsPlugins/recursos                      | Especifica uma lista de [*URIs de recursos*](windows-remote-management-glossary.md) aos quais esse plug-in dá suporte. Pelo menos uma entrada **ResourceURI** deve ser especificada; caso contrário, o XML será rejeitado.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| PlugInModules/OperationsPlugins/recursos/recurso             | Representa uma configuração de [*URI de recurso*](windows-remote-management-glossary.md) único.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| PlugInModules/OperationsPlugins/recursos/recurso/ResourceURI | Especifica um único [*URI de recurso*](windows-remote-management-glossary.md) em completo ou como uma cadeia de caracteres de correspondência parcial com base no atributo **ExactMatch** . Se **ExactMatch** não estiver presente, o padrão será **false**, o que significa que o processador SOAP do WinRM fará uma correspondência parcial com o início do *URI do recurso* e, se houver uma correspondência, passá-lo para o plug-in. O atributo de **suporteoptions** poderá ser especificado se esse *URI de recurso* tiver permissão para ter qualquer opção passada. Por padrão, não há suporte para nenhuma opção e, se houver alguma presente na solicitação do cliente, será retornado um erro. Se houver suporte para as opções do plug-in, é importante que o plug-in retorne o erro correto se uma opção estiver presente de que o plug-in não entende quando o sinalizador **MustUnderstand** está definido como **true**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| PlugInModules/OperationsPlugins/recurso/capacidade            | Especifica um recurso que está disponível neste [*URI de recurso*](windows-remote-management-glossary.md). Haverá uma entrada para cada tipo de operação que ele suporta. As seguintes opções estão disponíveis:<br/> <dl> <dt><span id="Get"></span><span id="get"></span><span id="GET"></span>Obter</dt> <dd> Há suporte para operações Get no [*URI do recurso*](windows-remote-management-glossary.md). O atributo **SupportFragment** será usado se a operação get der suporte ao conceito. O atributo **SupportFiltering** não é válido e deve ser definido como **false**. Esse recurso não será válido para um *URI de recurso* se também houver suporte para operações de Shell.<br/> </dd> <dt><span id="Put"></span><span id="put"></span><span id="PUT"></span>Posicione</dt> <dd> As operações Put têm suporte no [*URI de recurso*](windows-remote-management-glossary.md). O atributo **SupportFragment** será usado se a operação Put der suporte ao conceito. O atributo **SupportFiltering** não é válido e deve ser definido como **false**. Esse recurso não será válido para um *URI de recurso* se também houver suporte para operações de Shell.<br/> </dd> <dt><span id="Create"></span><span id="create"></span><span id="CREATE"></span>Criada</dt> <dd> Há suporte para operações de criação no [*URI de recurso*](windows-remote-management-glossary.md). O atributo **SupportFragment** será usado se a operação de criação der suporte ao conceito. O atributo **SupportFiltering** não é válido e deve ser definido como **false**. Esse recurso não será válido para um *URI de recurso* se também houver suporte para operações de Shell.<br/> </dd> <dt><span id="Delete"></span><span id="delete"></span><span id="DELETE"></span>Apagar</dt> <dd> As operações de exclusão têm suporte no [*URI de recurso*](windows-remote-management-glossary.md). O atributo **SupportFragment** será usado se a operação de exclusão der suporte ao conceito. O atributo **SupportFiltering** não é válido e deve ser definido como **false**. Esse recurso não será válido para um *URI de recurso* se também houver suporte para operações de Shell.<br/> </dd> <dt><span id="Invoke"></span><span id="invoke"></span><span id="INVOKE"></span>Chame</dt> <dd> As operações Invoke têm suporte no [*URI de recurso*](windows-remote-management-glossary.md). O atributo **SupportFragment** não tem suporte para operações Invoke e deve ser definido como **false**. O atributo **SupportFiltering** não é válido e deve ser definido como **false**. Esse recurso não será válido para um *URI de recurso* se também houver suporte para operações de Shell.<br/> </dd> <dt><span id="Enumerate"></span><span id="enumerate"></span><span id="ENUMERATE"></span>Enumerar</dt> <dd> As operações de enumeração têm suporte no [*URI de recurso*](windows-remote-management-glossary.md). O atributo **SupportFragment** não tem suporte para operações de enumeração e deve ser definido como **false**. O atributo **SupportFiltering** é válido e, se o plug-in der suporte à filtragem, esse atributo deverá ser definido como **true**. Esse recurso não será válido para um *URI de recurso* se também houver suporte para operações de Shell.<br/> </dd> <dt><span id="Subscribe"></span><span id="subscribe"></span><span id="SUBSCRIBE"></span>Assinar</dt> <dd> As operações de assinatura têm suporte no [*URI de recurso*](windows-remote-management-glossary.md). O atributo **SupportFragment** não tem suporte para operações de assinatura e deve ser definido como **false**. O atributo **SupportFiltering** não é válido e deve ser definido como **false**. Esse recurso não será válido para um *URI de recurso* se também houver suporte para operações de Shell.<br/> </dd> <dt><span id="Shell"></span><span id="shell"></span><span id="SHELL"></span>Shell</dt> <dd> Há suporte para operações de Shell no [*URI de recurso*](windows-remote-management-glossary.md). O atributo **SupportFragment** não tem suporte para operações de shell e deve ser definido como **false**. O atributo **SupportFiltering** não é válido e deve ser definido como **false**. Esse recurso não será válido para um *URI de recurso* se qualquer outra funcionalidade de operação também tiver suporte. Se uma funcionalidade de operação do Shell estiver configurada para um *URI de recurso*, as operações obter, colocar, criar, excluir, invocar e enumerar serão processadas internamente no serviço WinRM para gerenciar shells. Como resultado, o plug-in não pode lidar com as operações em si.<br/> </dd> </dl> |



 

### <a name="example-wsmanconfig_schemaxml-file"></a>Arquivo deschema.xml de exemplo WSManConfig \_

Durante a configuração, um arquivo XML chamado WSManConfig \_schema.xml contendo o seguinte conteúdo é Descartado no diretório de esquema do IIS:


```XML
<configSchema>
 <sectionSchema name="system.webServer/system.management.wsmanagement.config">
  <element name="OperationsConfiguration">
   <attribute name="MaxEnvelopeSizeKB" 
              type="uint" 
              defaultValue="150" 
              validationType="integerRange" 
              validationParameter="32,4294967295"/>
   <attribute name="MaxOperationTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxEnumerateIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxSubscribeIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxShellIdleTimeoutMinutes" 
              type="uint" 
              defaultValue="15" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaRefreshIntervalSeconds" 
              type="uint" 
              defaultValue="900" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowSeconds" 
              type="uint" 
              defaultValue="2" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowOperations" 
              type="uint" 
              defaultValue="1000" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
  </element>
  <element name="PluginModules">
   <collection addElement="AuthorizationPlugin">
    <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
    <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
    <attribute name="SDKVersion" type="uint" required="true"/>
    <attribute name="SupportsQuota" type="bool" defaultValue="false"/>
   </collection>
   <element name="OperationsPlugins">
    <collection addElement="Plugin">
     <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
     <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
     <attribute name="SDKVersion" type="uint" required="true"/>
     <attribute name="XmlRenderingType" type="enum" defaultValue="text">
      <enum name="text" value="1"/>
      <enum name="XmlReader" value="2"/>
     </attribute>
     <attribute name="Enabled" type="bool" defaultValue="true"/>
     <element name="InitializationParameters">
      <collection addElement="Param">
       <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="Value" type="string" required="true" validationType="nonEmptyString"/>
      </collection>
     </element>
     <element name="Resources">
      <collection addElement="Resource">
       <attribute name="ResourceUri" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="SupportsOptions" type="bool" defaultValue="false"/>
       <attribute name="ExactMatch" type="bool" defaultValue="false"/>
       <collection addElement="Capability">
        <attribute name="Type" type="enum" isUniqueKey="true" required="true">
         <enum name="Get" value="1"/>
         <enum name="Put" value="2"/>
         <enum name="Create" value="3"/>
         <enum name="Delete" value="4"/>
         <enum name="Invoke" value="5"/>
         <enum name="Enumerate" value="6"/>
         <enum name="Subscribe" value="7"/>
         <enum name="Shell" value="8"/>
        </attribute>
        <attribute name="SupportsFragment" type="bool" default="false"/>
        <attribute name="SupportsFiltering" type="bool" default="false"/>
       </collection>
      </collection>
     </element>
    </collection>
   </element>
  </element>
 </sectionSchema>
</configSchema>
```



## <a name="reading-iis-host-configuration"></a>Lendo a configuração do host do IIS

A configuração do host do IIS é lida durante o processo de inicialização do processador SOAP no aplicativo hospedado. Como web.config arquivos podem ser editados manualmente e, portanto, estão sujeitos a erros de validação de esquema, pode haver problemas quando uma configuração é lida. Durante uma falha de leitura ou de validação de configuração, o aplicativo hospedado não será iniciado e retornará uma mensagem de erro apropriada para o cliente. Um evento será registrado contendo uma descrição detalhada do que causou a falha.

As falhas comuns incluem o seguinte:

-   Acesso negado
-   XML de configuração inválido
-   Nenhum plug-in configurado (pelo menos um é necessário)

Os plug-ins padrão não são configurados por padrão. Eles precisam ser explicitamente configurados no arquivo de web.config antes de começarem a receber solicitações.

## <a name="enumerating-plug-ins-on-the-winrm-service"></a>Enumerando plug-ins no serviço WinRM

O comando a seguir demonstra como usar o utilitário WinRM para determinar quais plug-ins estão disponíveis no serviço WinRM: **WinRM Enumerate WinRM/config/plugin-Format: bem**.

 

