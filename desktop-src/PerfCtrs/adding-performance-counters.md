---
description: Os contadores de desempenho específicos ao seu aplicativo podem ajudá-lo a ajustar o desempenho enquanto você desenvolve e depura o aplicativo.
ms.assetid: 016386f6-4675-409e-8446-599e4ff96109
title: Adicionando contadores de desempenho
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8660af9406de4dedec3ecbd76169a23b342aa7d2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105758936"
---
# <a name="adding-performance-counters"></a><span data-ttu-id="ffea6-103">Adicionando contadores de desempenho</span><span class="sxs-lookup"><span data-stu-id="ffea6-103">Adding Performance Counters</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ffea6-104">Devido a limitações significativas de desempenho e confiabilidade, o método para fornecer dados do contador de desempenho que este tópico descreve pode ser alterado ou indisponível no futuro.</span><span class="sxs-lookup"><span data-stu-id="ffea6-104">Due to significant performance and reliability limitations, the method for providing performance counter data that this topic describes may be altered or unavailable in the future.</span></span> <span data-ttu-id="ffea6-105">Em vez disso, a Microsoft recomenda que você use o método descrito em [fornecendo dados de contador usando a versão 2,0](providing-counter-data-using-version-2-0.md) para criar novos contadores de desempenho e migrar contadores de desempenho existentes para usar esse método também.</span><span class="sxs-lookup"><span data-stu-id="ffea6-105">Instead, Microsoft recommends that you use the method described in [Providing Counter Data Using Version 2.0](providing-counter-data-using-version-2-0.md) for creating new performance counters, and that you migrate existing performance counters to use that method as well.</span></span>

<span data-ttu-id="ffea6-106">Os contadores de desempenho específicos ao seu aplicativo podem ajudá-lo a ajustar o desempenho enquanto você desenvolve e depura o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ffea6-106">Performance counters specific to your application can help you tune performance while you develop and debug the application.</span></span> <span data-ttu-id="ffea6-107">Depois que o aplicativo for concluído e instalado nos sistemas de destino, os contadores poderão ajudar os administradores do sistema a ajustar as configurações configuráveis para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ffea6-107">After your application is complete and installed on target systems, the counters can help system administrators adjust configurable settings for your application.</span></span>

## <a name="adding-a-performance-object-and-its-counters"></a><span data-ttu-id="ffea6-108">Adicionando um objeto de desempenho e seus contadores</span><span class="sxs-lookup"><span data-stu-id="ffea6-108">Adding a performance object and its counters</span></span>

1. <span data-ttu-id="ffea6-109">Crie os tipos de objeto e contadores para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ffea6-109">Design the object types and counters for the application.</span></span> <span data-ttu-id="ffea6-110">Para obter detalhes, consulte [design de objeto e contador](object-and-counter-design.md).</span><span class="sxs-lookup"><span data-stu-id="ffea6-110">For details, see [Object and Counter Design](object-and-counter-design.md).</span></span>
2. <span data-ttu-id="ffea6-111">Crie um arquivo de inicialização (. ini) contendo os nomes e descrições dos objetos e contadores de desempenho que você fornecer.</span><span class="sxs-lookup"><span data-stu-id="ffea6-111">Create an initialization (.ini) file containing the names and descriptions of the performance objects and counters that you provide.</span></span> <span data-ttu-id="ffea6-112">Para obter detalhes, consulte [adicionando nomes e descrições de contadores ao registro](adding-counter-names-and-descriptions-to-the-registry.md).</span><span class="sxs-lookup"><span data-stu-id="ffea6-112">For details, see [Adding Counter Names and Descriptions to the Registry](adding-counter-names-and-descriptions-to-the-registry.md).</span></span>
3. <span data-ttu-id="ffea6-113">Crie um arquivo de cabeçalho (. h) contendo os deslocamentos relativos nos quais os objetos do contador e os contadores serão instalados no registro.</span><span class="sxs-lookup"><span data-stu-id="ffea6-113">Create a header (.h) file containing the relative offsets at which the counter objects and counters will be installed in the registry.</span></span> <span data-ttu-id="ffea6-114">Para obter detalhes, consulte [adicionando nomes e descrições de contadores ao registro](adding-counter-names-and-descriptions-to-the-registry.md).</span><span class="sxs-lookup"><span data-stu-id="ffea6-114">For details, see [Adding Counter Names and Descriptions to the Registry](adding-counter-names-and-descriptions-to-the-registry.md).</span></span>
4. <span data-ttu-id="ffea6-115">Configure as entradas de monitoramento de desempenho necessárias no registro.</span><span class="sxs-lookup"><span data-stu-id="ffea6-115">Set up the necessary performance monitoring entries in the registry.</span></span> <span data-ttu-id="ffea6-116">Isso inclui as etapas a seguir.</span><span class="sxs-lookup"><span data-stu-id="ffea6-116">This includes the following steps.</span></span>
    1. <span data-ttu-id="ffea6-117">Crie uma chave do registro na chave de **Serviços** para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ffea6-117">Create a registry key in the **Services** key for the application.</span></span> <span data-ttu-id="ffea6-118">Se você não tiver esse nó, crie-o na seguinte chave do registro: `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services` .</span><span class="sxs-lookup"><span data-stu-id="ffea6-118">If you do not have such a node, create it under the following registry key: `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services`.</span></span> <span data-ttu-id="ffea6-119">Para obter detalhes, consulte [criando a chave de desempenho do aplicativo](creating-the-applications-performance-key.md).</span><span class="sxs-lookup"><span data-stu-id="ffea6-119">For details, see [Creating the Application's Performance Key](creating-the-applications-performance-key.md).</span></span>
    2. <span data-ttu-id="ffea6-120">Use o utilitário **lodctr** com os arquivos. ini e. h para instalar as informações no registro.</span><span class="sxs-lookup"><span data-stu-id="ffea6-120">Use the **lodctr** utility with the .ini and .h files to install the information in the registry.</span></span> <span data-ttu-id="ffea6-121">Esse utilitário só terá sucesso se houver uma chave de desempenho na chave de **Serviços** para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ffea6-121">This utility succeeds only if a performance key exists in the **Services** key for the application.</span></span> <span data-ttu-id="ffea6-122">Para obter detalhes, consulte [adicionando nomes e descrições de contadores ao registro](adding-counter-names-and-descriptions-to-the-registry.md).</span><span class="sxs-lookup"><span data-stu-id="ffea6-122">For details, see [Adding Counter Names and Descriptions to the Registry](adding-counter-names-and-descriptions-to-the-registry.md).</span></span>
5. <span data-ttu-id="ffea6-123">Crie uma DLL de desempenho que contenha um conjunto de funções exportadas que forneçam os dados do contador consultado ao consumidor.</span><span class="sxs-lookup"><span data-stu-id="ffea6-123">Create a performance DLL containing a set of exported functions that provide the queried counter data to the consumer.</span></span> <span data-ttu-id="ffea6-124">Para obter detalhes, consulte [criando uma DLL de extensão de desempenho](creating-a-performance-extension-dll.md).</span><span class="sxs-lookup"><span data-stu-id="ffea6-124">For details, see [Creating a Performance Extension DLL](creating-a-performance-extension-dll.md).</span></span>
6. <span data-ttu-id="ffea6-125">Modifique o arquivo de instalação do aplicativo para automatizar a adição de informações ao registro (conforme descrito na etapa 4) e copie a DLL de desempenho para o diretório do aplicativo na instalação.</span><span class="sxs-lookup"><span data-stu-id="ffea6-125">Modify the application's setup file to automate adding information to the registry (as described in step 4) and copy your performance DLL to your application's directory at setup.</span></span>

<span data-ttu-id="ffea6-126">Para obter informações sobre entradas de registro adicionais, consulte [criando outras entradas de registro](creating-other-registry-entries.md).</span><span class="sxs-lookup"><span data-stu-id="ffea6-126">For information about additional registry entries, see [Creating Other Registry Entries](creating-other-registry-entries.md).</span></span>
