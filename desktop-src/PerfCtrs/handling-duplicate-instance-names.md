---
description: Embora os provedores sejam incentivados a usar nomes de instância exclusivos, nem todos os provedores.
ms.assetid: 3c8fcb8d-2ea4-4b24-b649-7bd375c1133d
title: Manipulando nomes de instância duplicada
ms.topic: article
ms.date: 08/17/2020
ms.openlocfilehash: 220e5d7d0181a79c1d1415486cc946d484e11952
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105750778"
---
# <a name="handling-duplicate-instance-names"></a><span data-ttu-id="0d37c-103">Manipulando nomes de instância duplicada</span><span class="sxs-lookup"><span data-stu-id="0d37c-103">Handling Duplicate Instance Names</span></span>

<span data-ttu-id="0d37c-104">Embora os provedores sejam altamente incentivados a usar nomes de instância exclusivos, nem todos os provedores fazem.</span><span class="sxs-lookup"><span data-stu-id="0d37c-104">Although providers are strongly encouraged to use unique instance names, not all providers do.</span></span> <span data-ttu-id="0d37c-105">A Convenção para exibir nomes de instâncias duplicadas é acrescentar um `#` caractere e um número de série ao nome da instância, com exceção da primeira ocorrência do nome.</span><span class="sxs-lookup"><span data-stu-id="0d37c-105">The convention for displaying duplicate instance names is to append a `#` character and a serial number to the instance name, except for the first occurrence of the name.</span></span> <span data-ttu-id="0d37c-106">Por exemplo, se houver três instâncias de `svchost` em uma amostra, os três nomes serão exibidos como `svchost` , `svchost#1` e `svchost#2` .</span><span class="sxs-lookup"><span data-stu-id="0d37c-106">For example, if there are three instances of `svchost` in a sample, the three names are displayed as `svchost`, `svchost#1`, and `svchost#2`.</span></span>

<span data-ttu-id="0d37c-107">Infelizmente, essa Convenção não resolve completamente o problema.</span><span class="sxs-lookup"><span data-stu-id="0d37c-107">Unfortunately, this convention does not completely resolve the issue.</span></span> <span data-ttu-id="0d37c-108">Os números de série são atribuídos com base na ordem em que um nome de instância específico aparece em um exemplo, e essa ordem pode ser inconsistente de amostra para amostra.</span><span class="sxs-lookup"><span data-stu-id="0d37c-108">Serial numbers are assigned based on the order in which a particular instance name appears in a sample, and this order may be inconsistent from sample to sample.</span></span> <span data-ttu-id="0d37c-109">Por exemplo, um exemplo A pode ver `svchost` (pid 100), `svchost#1` (PID 200) e `svchost#2` (PID 300).</span><span class="sxs-lookup"><span data-stu-id="0d37c-109">For example, sample A might see `svchost` (PID 100), `svchost#1` (PID 200), and `svchost#2` (PID 300).</span></span> <span data-ttu-id="0d37c-110">Em seguida, se o svchost com PID 100 for desligado, o próximo exemplo verá `svchost` (pid 200) e `svchost#1` (PID 300).</span><span class="sxs-lookup"><span data-stu-id="0d37c-110">Then if the svchost with PID 100 shuts down, the next sample would see `svchost` (PID 200) and `svchost#1` (PID 300).</span></span> <span data-ttu-id="0d37c-111">A lógica de correspondência básica tentaria corresponder as estatísticas de amostra A `svchost#1` (de pid 200) nas estatísticas de amostra b `svchost#1` (de PID 300), resultando em resultados inválidos para a amostra b. os erros ocorrem quando uma nova instância não exclusiva é exibida em uma amostra ou quando uma instância não exclusiva é interrompida em uma amostra (a menos que a instância adicionada/removida seja a última</span><span class="sxs-lookup"><span data-stu-id="0d37c-111">Basic matching logic would try to match sample A's `svchost#1` statistics (from PID 200) against sample B's `svchost#1` statistics (from PID 300), resulting in invalid results for sample B. Errors occur when a new non-unique instance shows up in a sample or when a non-unique instance stops showing up in a sample (unless the added/removed instance was the last one).</span></span>

## <a name="process-counterset"></a><span data-ttu-id="0d37c-112">Contador de processoset</span><span class="sxs-lookup"><span data-stu-id="0d37c-112">Process counterset</span></span>

<span data-ttu-id="0d37c-113">Esse problema é especialmente problemático para o `Process` CounterSet porque ele usa apenas o nome do exe do processo como o nome da instância, mesmo que o nome do exe não seja exclusivo.</span><span class="sxs-lookup"><span data-stu-id="0d37c-113">This issue is especially problematic for the `Process` counterset because it uses only the process's EXE name as the instance name even though the EXE name is not unique.</span></span> <span data-ttu-id="0d37c-114">O comportamento padrão do `Process` CounterSet no Windows não pode ser alterado devido a problemas de compatibilidade.</span><span class="sxs-lookup"><span data-stu-id="0d37c-114">The default behavior of the `Process` counterset on Windows cannot be changed due to compatibility issues.</span></span>

<span data-ttu-id="0d37c-115">Você pode alterar o comportamento dos `Process` conjuntos e `Thread` configurados para usar nomes de instância exclusivos definindo `ProcessNameFormat` os `ThreadNameFormat` valores de registro ou na `HKLM\System\CurrentControlSet\Services\Perfproc\Performance` chave do registro.</span><span class="sxs-lookup"><span data-stu-id="0d37c-115">You can alter the behavior of the `Process` and `Thread` countersets to use unique instance names by setting the `ProcessNameFormat` or `ThreadNameFormat` registry values under the `HKLM\System\CurrentControlSet\Services\Perfproc\Performance` registry key.</span></span>

> [!CAUTION]
> <span data-ttu-id="0d37c-116">A habilitação de nomes de instância exclusivos para o `Process` CounterSet pode fazer com que alguns programas se comportem incorretamente, pois muitos programas esperam o padrão de nomenclatura não exclusivo.</span><span class="sxs-lookup"><span data-stu-id="0d37c-116">Enabling unique instance names for the `Process` counterset may cause some programs to behave incorrectly, since many programs expect the non-unique naming pattern.</span></span> <span data-ttu-id="0d37c-117">Por exemplo, um programa que está procurando uma instância com um nome de EXE conhecido específico não poderá mais encontrar essa instância depois de habilitar nomes de instância exclusivos.</span><span class="sxs-lookup"><span data-stu-id="0d37c-117">For example, a program that is looking for an instance with a specific well-known EXE name will no longer be able to find that instance after enabling unique instance names.</span></span>

<span data-ttu-id="0d37c-118">O tipo de registro para esses valores é `REG_DWORD` .</span><span class="sxs-lookup"><span data-stu-id="0d37c-118">The registry type for these values is `REG_DWORD`.</span></span> <span data-ttu-id="0d37c-119">Definir o valor para `2` acrescentar o identificador do processo (PID) ao nome da instância do processo e o identificador de thread (TID) ao nome da instância do thread.</span><span class="sxs-lookup"><span data-stu-id="0d37c-119">Setting the value to `2` appends the process identifier (PID) to the process instance name and the thread identifier (TID) to the thread instance name.</span></span> <span data-ttu-id="0d37c-120">Para desabilitar esse recurso, defina o valor como 1 ou exclua o valor.</span><span class="sxs-lookup"><span data-stu-id="0d37c-120">To disable this feature, set the value to 1 or delete the value.</span></span>
