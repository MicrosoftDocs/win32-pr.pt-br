---
description: A ferramenta CTRPP é um pré-processador que avalia e valida o manifesto dos contadores.
ms.assetid: 3939f6a1-0a94-429d-a71e-b37f045fea13
title: CTRPP
ms.topic: reference
ms.date: 08/17/2020
topic_type:
- APIRef
- kbSyntax
api_name:
- CTRPP
api_type:
- NA
api_location: ''
ms.openlocfilehash: eacfbb83abd56becc579c6b9bbaedacda96f94b4
ms.sourcegitcommit: b32433cc0394159c7263809ae67615ab5792d40d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/30/2021
ms.locfileid: "113119101"
---
# <a name="ctrpp"></a><span data-ttu-id="736f1-103">CTRPP</span><span class="sxs-lookup"><span data-stu-id="736f1-103">CTRPP</span></span>

<span data-ttu-id="736f1-104">A ferramenta CTRPP é um pré-processador que avalia e valida o manifesto para seu provedor V2.</span><span class="sxs-lookup"><span data-stu-id="736f1-104">The CTRPP tool is a pre-processor that parses and validates the manifest for your V2 provider.</span></span> <span data-ttu-id="736f1-105">A ferramenta gera recursos com as cadeias de caracteres necessárias para os consumidores do seu provedor e gera um header com o código que você usa para fornecer os dados `.rc` `.h` do contador.</span><span class="sxs-lookup"><span data-stu-id="736f1-105">The tool generates `.rc` resources with the strings needed by consumers of your provider, and it generates a `.h` header with code that you use to provide your counter data.</span></span> <span data-ttu-id="736f1-106">Você deve executar a ferramenta CTRPP durante o build do seu provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-106">You should run the CTRPP tool during the build of your provider.</span></span> <span data-ttu-id="736f1-107">Você deve usar o código gerado como um ponto de partida ao desenvolver seu provedor em vez de tentar gerar esse código por conta própria.</span><span class="sxs-lookup"><span data-stu-id="736f1-107">You should use the generated code as a starting point when developing your provider instead of trying to generate this code yourself.</span></span>

```syntax
ctrpp -o codeFile -rc rcFile [-legacy] [-MemoryRoutines] [-NotificationCallback] [-prefix prefix] [-ch symFile] [-backcompat] inputFile
```

## <a name="arguments"></a><span data-ttu-id="736f1-108">Argumentos</span><span class="sxs-lookup"><span data-stu-id="736f1-108">Arguments</span></span>

|<span data-ttu-id="736f1-109">Opção</span><span class="sxs-lookup"><span data-stu-id="736f1-109">Option</span></span>              |<span data-ttu-id="736f1-110">Descrição</span><span class="sxs-lookup"><span data-stu-id="736f1-110">Description</span></span>
|--------------------|-----------
|<span data-ttu-id="736f1-111">*inputFile*</span><span class="sxs-lookup"><span data-stu-id="736f1-111">*inputFile*</span></span>         |<span data-ttu-id="736f1-112">**Obrigatório:** Especifica o nome do arquivo `.man` (manifesto XML) que define seus contadores.</span><span class="sxs-lookup"><span data-stu-id="736f1-112">**Required:** Specifies the name of the `.man` (XML manifest) file that defines your counters.</span></span>
|<span data-ttu-id="736f1-113">**-o** *codeFile*</span><span class="sxs-lookup"><span data-stu-id="736f1-113">**-o** *codeFile*</span></span>   |<span data-ttu-id="736f1-114">**Obrigatório:** Especifica o nome do arquivo `.h` de código a ser gerado pelo CTRPP.</span><span class="sxs-lookup"><span data-stu-id="736f1-114">**Required:** Specifies the name of the `.h` code file to be generated by CTRPP.</span></span> <span data-ttu-id="736f1-115">Esse arquivo conterá funções auxiliares em linha C/C++ que simplificam a inicialização e a não inicialização do provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-115">This file will contain C/C++ inline helper functions that simplify initializing and uninitializing your provider.</span></span>
|<span data-ttu-id="736f1-116">**-rc** *rcFile*</span><span class="sxs-lookup"><span data-stu-id="736f1-116">**-rc** *rcFile*</span></span>    |<span data-ttu-id="736f1-117">**Obrigatório:** Especifica o nome do `.rc` (arquivo de recurso) a ser gerado por CTRPP.</span><span class="sxs-lookup"><span data-stu-id="736f1-117">**Required:** Specifies the name of the `.rc` (resource file) to be generated by CTRPP.</span></span> <span data-ttu-id="736f1-118">Esse arquivo conterá a tabela de cadeia de caracteres do provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-118">This file will contain the provider's string table.</span></span>
|<span data-ttu-id="736f1-119">**-ch** *symFile*</span><span class="sxs-lookup"><span data-stu-id="736f1-119">**-ch** *symFile*</span></span>   |<span data-ttu-id="736f1-120">Especifica o nome do arquivo de símbolo opcional `.h` a ser gerado por CTRPP.</span><span class="sxs-lookup"><span data-stu-id="736f1-120">Specifies the name of the optional `.h` symbol file to be generated by CTRPP.</span></span> <span data-ttu-id="736f1-121">Esse arquivo conterá símbolos C/C++ para os nomes e GUIDs de cada contador no provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-121">This file will contain C/C++ symbols for the names and GUIDs of each counterset in the provider.</span></span>
|<span data-ttu-id="736f1-122">**-prefixo de** *prefixo*</span><span class="sxs-lookup"><span data-stu-id="736f1-122">**-prefix** *prefix*</span></span>|<span data-ttu-id="736f1-123">Especifica o prefixo a ser usado para as variáveis e funções definidas no arquivo de título gerado.</span><span class="sxs-lookup"><span data-stu-id="736f1-123">Specifies the prefix to use for the variables and functions defined in the generated header file.</span></span>
|<span data-ttu-id="736f1-124">**-NotificationCallback**</span><span class="sxs-lookup"><span data-stu-id="736f1-124">**-NotificationCallback**</span></span>|<span data-ttu-id="736f1-125">Altera a assinatura padrão da função [**CounterInitialize**](counterinitialize.md) para incluir parâmetros para especificar o nome das funções de retorno de chamada [*ControlCallback,*](/windows/desktop/api/Perflib/nc-perflib-perflibrequest) [*AllocateMemory*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_alloc)e [*FreeMemory.*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_free)</span><span class="sxs-lookup"><span data-stu-id="736f1-125">Changes the default signature of the [**CounterInitialize**](counterinitialize.md) function to include parameters for specifying the name of [*ControlCallback*](/windows/desktop/api/Perflib/nc-perflib-perflibrequest), [*AllocateMemory*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_alloc), and [*FreeMemory*](/windows/desktop/api/Perflib/nc-perflib-perf_mem_free) callback functions.</span></span> <span data-ttu-id="736f1-126">Esse argumento tem o mesmo efeito que incluir o `callback` atributo no elemento [**do**](/windows/desktop/PerfCtrs/performance-counters-provider--counters--element) provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-126">This argument has the same effect as including the `callback` attribute in the [**provider**](/windows/desktop/PerfCtrs/performance-counters-provider--counters--element) element.</span></span>
|<span data-ttu-id="736f1-127">**-migrar** *outputFile*</span><span class="sxs-lookup"><span data-stu-id="736f1-127">**-migrate** *outputFile*</span></span>|<span data-ttu-id="736f1-128">Em vez de gerar arquivos e , atualiza o manifesto inputFile para a versão mais recente e `.h` `.rc` salva-o em *outputFile*. </span><span class="sxs-lookup"><span data-stu-id="736f1-128">Instead of generating `.h` and `.rc` files, upgrades the *inputFile* manifest to the latest version and saves it to *outputFile*.</span></span> <span data-ttu-id="736f1-129">Essa opção não pode ser usada com outras opções.</span><span class="sxs-lookup"><span data-stu-id="736f1-129">This switch cannot be used with other switches.</span></span> <span data-ttu-id="736f1-130">Uso: `CTRPP -migrate NewFile.man OldFile.man`</span><span class="sxs-lookup"><span data-stu-id="736f1-130">Usage: `CTRPP -migrate NewFile.man OldFile.man`</span></span>
|<span data-ttu-id="736f1-131">**-BackCompat**</span><span class="sxs-lookup"><span data-stu-id="736f1-131">**-BackCompat**</span></span>     |<span data-ttu-id="736f1-132">**Preterido:** O suporte para provedores de modo kernel foi adicionado no Windows 7.</span><span class="sxs-lookup"><span data-stu-id="736f1-132">**Deprecated:** Support for kernel-mode providers was added in Windows 7.</span></span> <span data-ttu-id="736f1-133">Por padrão, o código gerado por CTRPP para provedores de modo kernel será incompatível com versões anteriores do Windows (o driver não será carregado devido a `Pcw***` APIs ausentes).</span><span class="sxs-lookup"><span data-stu-id="736f1-133">By default, the code generated by CTRPP for kernel-mode providers will be incompatible with earlier versions of Windows (driver will fail to load due to missing `Pcw***` APIs).</span></span> <span data-ttu-id="736f1-134">Definido `-BackCompat` para habilitar a compatibilidade com versões anteriores do Windows.</span><span class="sxs-lookup"><span data-stu-id="736f1-134">Set `-BackCompat` to enable compatibility with earlier versions of Windows.</span></span> <span data-ttu-id="736f1-135">O driver carregará dinamicamente as APIs necessárias e o código gerado desabilitará silenciosamente o provedor se as APIs não estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="736f1-135">The driver will dynamically load the necessary APIs and the generated code will silently disable the provider if the APIs are not available.</span></span>
|<span data-ttu-id="736f1-136">**-MemoryRoutines**</span><span class="sxs-lookup"><span data-stu-id="736f1-136">**-MemoryRoutines**</span></span> |<span data-ttu-id="736f1-137">**Preterido:** Quando usado com a `-Legacy` opção , inclui modelos para rotinas de memória no código gerado.</span><span class="sxs-lookup"><span data-stu-id="736f1-137">**Deprecated:** When used with the `-Legacy` switch, includes templates for memory routines in the generated code.</span></span> <span data-ttu-id="736f1-138">Caso contrário, esse argumento terá o mesmo efeito que a `-NotificationCallback` opção .</span><span class="sxs-lookup"><span data-stu-id="736f1-138">Otherwise, this argument has the same effect as the `-NotificationCallback` switch.</span></span>
|<span data-ttu-id="736f1-139">**-Legacy**</span><span class="sxs-lookup"><span data-stu-id="736f1-139">**-Legacy**</span></span>         |<span data-ttu-id="736f1-140">**Preterido:** Gera arquivos , , e usando os modelos de código do `*.h` `*.c` Windows Vista `*.rc` `*_r.h` (gera PerfAutoInitialize e PerfAutoCleanup em vez de CounterInitialize e CounterCleanup).</span><span class="sxs-lookup"><span data-stu-id="736f1-140">**Deprecated:** Generates `*.h`, `*.c`, `*.rc`, and `*_r.h` files using the Windows Vista code templates (generates PerfAutoInitialize and PerfAutoCleanup instead of CounterInitialize and CounterCleanup).</span></span> <span data-ttu-id="736f1-141">Essa opção pode ser usada com **-MemoryRoutines** e **-NotificationCallback,** mas não pode ser usada com nenhuma outra opção.</span><span class="sxs-lookup"><span data-stu-id="736f1-141">This switch can be used with **-MemoryRoutines** and **-NotificationCallback** but cannot be used with any other switches.</span></span> <span data-ttu-id="736f1-142">Não use as opções **-o ou** **-rc** com essa opção.</span><span class="sxs-lookup"><span data-stu-id="736f1-142">Do not use the **-o** or **-rc** switches with this switch.</span></span> <span data-ttu-id="736f1-143">Os arquivos gerados serão nomeados com base no nome do manifesto e serão gravados no diretório que continha o manifesto.</span><span class="sxs-lookup"><span data-stu-id="736f1-143">The generated files will be named based on the name of the manifest and will be written to the directory that contained the manifest.</span></span> <span data-ttu-id="736f1-144">Uso: `CTRPP -legacy OldFile.man`</span><span class="sxs-lookup"><span data-stu-id="736f1-144">Usage: `CTRPP -legacy OldFile.man`</span></span>

## <a name="remarks"></a><span data-ttu-id="736f1-145">Comentários</span><span class="sxs-lookup"><span data-stu-id="736f1-145">Remarks</span></span>

<span data-ttu-id="736f1-146">A ferramenta CTRPP gera um arquivo de código, um arquivo `.h` de recurso e, opcionalmente, gera um `.rc` arquivo de `.h` símbolo.</span><span class="sxs-lookup"><span data-stu-id="736f1-146">The CTRPP tool generates a `.h` code file, an `.rc` resource file, and optionally generates a `.h` symbol file.</span></span>

### <a name="using-the-generated-resource-file"></a><span data-ttu-id="736f1-147">Usando o arquivo de recurso gerado</span><span class="sxs-lookup"><span data-stu-id="736f1-147">Using the generated resource file</span></span>

<span data-ttu-id="736f1-148">A ferramenta CTRPP gerará um arquivo de recurso que contém as cadeias de caracteres localizáveis necessárias para os consumidores dos contadores `.rc` do provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-148">The CTRPP tool will generate a `.rc` resource file that contains the localizable strings needed by consumers of the provider's countersets.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="736f1-149">Os recursos desse arquivo devem ser incluídos no binário do provedor e o caminho completo para o binário do provedor deve ser registrado durante a instalação do manifesto do provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-149">The resources from this file must be included into your provider binary and the full path to the provider binary must be registered during the installation of your provider's manifest.</span></span> <span data-ttu-id="736f1-150">Os consumidores que não conseguem localizar e carregar os recursos não poderão usar os contadores do provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-150">Consumers that are unable to locate and load the resources will be unable to use your provider's countersets.</span></span>

<span data-ttu-id="736f1-151">Os recursos de cadeia de caracteres devem ser tratados da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="736f1-151">The string resources should be handled as follows:</span></span>

- <span data-ttu-id="736f1-152">O desenvolvedor edita o arquivo de manifesto do provedor ( ) para definir o atributo do provedor como o nome de um binário do provedor (.DLL, .SYS ou .EXE) que conterá os recursos de cadeia de caracteres para o provedor e será instalado como parte do componente do `.man` `applicationIdentity` provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-152">The developer edits the provider manifest (`.man`) file to set the `applicationIdentity` attribute of the provider to the name of a provider binary (.DLL, .SYS, or .EXE) that will contain the string resources for the provider and will be installed as part of the provider component.</span></span>
- <span data-ttu-id="736f1-153">A ferramenta CTRPP lê o manifesto do provedor e gera um `.rc` arquivo.</span><span class="sxs-lookup"><span data-stu-id="736f1-153">The CTRPP tool reads the provider manifest and generates an `.rc` file.</span></span>
- <span data-ttu-id="736f1-154">A [ferramenta RC (compilador de recursos)](../menurc/resource-compiler.md) compila os dados do arquivo gerado por CTRPP para gerar um arquivo que contém `.rc` os recursos `.res` binários.</span><span class="sxs-lookup"><span data-stu-id="736f1-154">The [RC (resource compiler)](../menurc/resource-compiler.md) tool compiles the data from the CTRPP-generated `.rc` file to generate a `.res` file containing the binary resources.</span></span> <span data-ttu-id="736f1-155">Isso pode ser feito compilando diretamente o arquivo gerado por CTRPP OU compilando outro arquivo que inclui o arquivo gerado por `.rc` CTRPP por meio de `.rc` `.rc` uma diretiva `#include` .</span><span class="sxs-lookup"><span data-stu-id="736f1-155">This can be done either by directly compiling the CTRPP-generated `.rc` file OR by compiling another `.rc` file that includes the CTRPP-generated `.rc` file via an `#include` directive.</span></span>
- <span data-ttu-id="736f1-156">O vinculador inseri os dados do arquivo gerado pelo RC `.res` no binário do provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-156">The linker embeds the data from the RC-generated `.res` file into the provider binary.</span></span>
- <span data-ttu-id="736f1-157">Durante a instalação, o binário do provedor é copiado para o sistema do usuário e o manifesto do provedor é registrado usando a [ferramenta lodctr](/windows-server/administration/windows-commands/lodctr).</span><span class="sxs-lookup"><span data-stu-id="736f1-157">During installation, the provider binary is copied onto the user's system and the provider manifest is registered using the [lodctr tool](/windows-server/administration/windows-commands/lodctr).</span></span> <span data-ttu-id="736f1-158">A ferramenta lodctr converte o atributo do manifesto do provedor em um caminho completo e registra o caminho completo para o binário do `applicationIdentity` provedor no Registro.</span><span class="sxs-lookup"><span data-stu-id="736f1-158">The lodctr tool converts the `applicationIdentity` attribute of the provider manifest into a full path and records the full path to the provider binary in the registry.</span></span>
  - <span data-ttu-id="736f1-159">Se o binário do provedor estiver no mesmo diretório que o manifesto, use: `lodctr.exe /m:"C:\full\manifest\path\manifest.man"` .</span><span class="sxs-lookup"><span data-stu-id="736f1-159">If the provider binary is in the same directory as the manifest, use: `lodctr.exe /m:"C:\full\manifest\path\manifest.man"`.</span></span> <span data-ttu-id="736f1-160">lodctr combinará o caminho do manifesto especificado com o atributo do `applicationIdentity` manifesto para formar o caminho completo.</span><span class="sxs-lookup"><span data-stu-id="736f1-160">lodctr will combine the specified manifest path with the manifest's `applicationIdentity` attribute to form the full path.</span></span>
  - <span data-ttu-id="736f1-161">Caso contrário, use `lodctr.exe /m:"C:\full\manifest\path\manifest.man" "c:\full\binary\path"`.</span><span class="sxs-lookup"><span data-stu-id="736f1-161">Otherwise, use `lodctr.exe /m:"C:\full\manifest\path\manifest.man" "c:\full\binary\path"`.</span></span> <span data-ttu-id="736f1-162">lodctr combinará o caminho binário especificado com o atributo do `applicationIdentity` manifesto para formar o caminho completo.</span><span class="sxs-lookup"><span data-stu-id="736f1-162">lodctr will combine the specified binary path with the manifest's `applicationIdentity` attribute to form the full path.</span></span>
  - <span data-ttu-id="736f1-163">Para fins de diagnóstico, você pode inspecionar o caminho completo gravado verificando o `ApplicationIdentity` valor da chave do Registro `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Perflib\_V2Providers\{<ProviderGuid>}` .</span><span class="sxs-lookup"><span data-stu-id="736f1-163">For diagnostic purposes, you can inspect the recorded full path by checking the `ApplicationIdentity` value of registry key `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Perflib\_V2Providers\{<ProviderGuid>}`.</span></span>
  - <span data-ttu-id="736f1-164">Se o binário estiver usando a MUI para localização, copie o arquivo MUI junto com o binário.</span><span class="sxs-lookup"><span data-stu-id="736f1-164">If the binary is using MUI for localization, be sure to copy the MUI file along with the binary.</span></span>
- <span data-ttu-id="736f1-165">Durante a coleta do conjunto de contadores, o consumidor usa o caminho completo registrado para o binário do provedor para localizar e carregar as cadeias de caracteres necessárias dos recursos do binário do provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-165">During counterset collection, the consumer uses the recorded full path to the provider binary to locate and load the necessary strings from the provider binary's resources.</span></span>

### <a name="using-the-generated-code-file-in-a-user-mode-provider"></a><span data-ttu-id="736f1-166">Usando o arquivo de código gerado em um provedor de modo de usuário</span><span class="sxs-lookup"><span data-stu-id="736f1-166">Using the generated code file in a user-mode provider</span></span>

<span data-ttu-id="736f1-167">A ferramenta CTRPP gerará um `.h` arquivo de código C/C++.</span><span class="sxs-lookup"><span data-stu-id="736f1-167">The CTRPP tool will generate a `.h` C/C++ code file.</span></span> <span data-ttu-id="736f1-168">Se o atributo do manifesto do provedor for definido como , o arquivo de código gerado conterá as seguintes definições úteis na codificação de um `providerType` provedor de modo de `userMode` usuário:</span><span class="sxs-lookup"><span data-stu-id="736f1-168">If the provider manifest's `providerType` attribute is set to `userMode`, the generated code file will contain the following definitions that are helpful in coding a user-mode provider:</span></span>

- <span data-ttu-id="736f1-169">Uma função de inicialização de provedor chamada [ \* **prefix\*CounterInitialize.**](counterinitialize.md)</span><span class="sxs-lookup"><span data-stu-id="736f1-169">An provider initialization function named [\***prefix\*CounterInitialize**](counterinitialize.md).</span></span>
- <span data-ttu-id="736f1-170">Uma função de limpeza do provedor chamada [ \* **prefix\*CounterCleanup.**](countercleanup.md)</span><span class="sxs-lookup"><span data-stu-id="736f1-170">A provider cleanup function named [\***prefix\*CounterCleanup**](countercleanup.md).</span></span>
- <span data-ttu-id="736f1-171">Um provedor \*\*\*\*\* global _ variável que armazena o handle do provedor aberto pela função _ \*_prefix_CounterInitialize\*\*.</span><span class="sxs-lookup"><span data-stu-id="736f1-171">A global ***provider** _ variable that stores the provider handle opened by the _ *_prefix_CounterInitialize** function.</span></span> <span data-ttu-id="736f1-172">O nome da variável é o valor `symbol` do atributo do elemento no `provider` manifesto.</span><span class="sxs-lookup"><span data-stu-id="736f1-172">The variable's name is the value of the `symbol` attribute of the `provider` element in the manifest.</span></span> <span data-ttu-id="736f1-173">Essa variável deve ser usada em chamadas para , e outras `PerfCreateInstance` `PerfDeleteInstance` APIs para controlar os dados do provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-173">This variable should be used in calls to `PerfCreateInstance`, `PerfDeleteInstance`, and other APIs for controlling your provider's data.</span></span>
- <span data-ttu-id="736f1-174">Para cada contador, uma variável global \***counterset\*GUID** com o GUID do counterset.</span><span class="sxs-lookup"><span data-stu-id="736f1-174">For each counterset, a global \***counterset\*GUID** variable with the counterset GUID.</span></span> <span data-ttu-id="736f1-175">O nome da variável é o valor do atributo do elemento mais o `counterSet` `symbol` sufixo "GUID", por exemplo, `MyCounterSetGUID` .</span><span class="sxs-lookup"><span data-stu-id="736f1-175">The variable's name is the value of the `counterSet` element's `symbol` attribute plus the suffix "GUID", e.g. `MyCounterSetGUID`.</span></span> <span data-ttu-id="736f1-176">Essa variável deve ser usada em chamadas para , e outras `PerfCreateInstance` `PerfDeleteInstance` APIs para controlar os dados do provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-176">This variable should be used in calls to `PerfCreateInstance`, `PerfDeleteInstance`, and other APIs for controlling your provider's data.</span></span>
- <span data-ttu-id="736f1-177">Para cada contador, uma macro ***de*** contador com o valor do `id` contador.</span><span class="sxs-lookup"><span data-stu-id="736f1-177">For each counter, a ***counter*** macro with the counter's `id` value.</span></span> <span data-ttu-id="736f1-178">O nome da macro é o valor `counter` do atributo do `symbol` elemento.</span><span class="sxs-lookup"><span data-stu-id="736f1-178">The macro's name is the value of the `counter` element's `symbol` attribute.</span></span> <span data-ttu-id="736f1-179">Essa macro deve ser usada em chamadas para , e outras `PerfSetCounterRefValue` `PerfSetULongLongCounterValue` APIs para definir os dados do provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-179">This macro should be used in calls to `PerfSetCounterRefValue`, `PerfSetULongLongCounterValue`, and other APIs for setting your provider's data.</span></span>

<span data-ttu-id="736f1-180">Nos nomes de função, ***prefixo*** refere-se ao valor do parâmetro `-prefix` de linha de comando.</span><span class="sxs-lookup"><span data-stu-id="736f1-180">In the function names, ***prefix*** refers to the value of the `-prefix` command-line parameter.</span></span> <span data-ttu-id="736f1-181">Se o `-prefix` parâmetro não for usado, as funções serão nomeadas `CounterInitialize` e `CounterCleanup` .</span><span class="sxs-lookup"><span data-stu-id="736f1-181">If the `-prefix` parameter is not used the functions will be named `CounterInitialize` and `CounterCleanup`.</span></span>

### <a name="using-the-generated-code-file-in-a-kernel-mode-provider"></a><span data-ttu-id="736f1-182">Usando o arquivo de código gerado em um provedor de modo kernel</span><span class="sxs-lookup"><span data-stu-id="736f1-182">Using the generated code file in a kernel-mode provider</span></span>

<span data-ttu-id="736f1-183">A ferramenta CTRPP gerará um `.h` arquivo de código C/C++.</span><span class="sxs-lookup"><span data-stu-id="736f1-183">The CTRPP tool will generate a `.h` C/C++ code file.</span></span> <span data-ttu-id="736f1-184">Se o atributo do manifesto do provedor for definido como , o arquivo de código gerado conterá as seguintes definições úteis para codificar os contadores de um provedor de modo `providerType` `kernelMode` kernel:</span><span class="sxs-lookup"><span data-stu-id="736f1-184">If the provider manifest's `providerType` attribute is set to `kernelMode`, the generated code file will contain the following definitions that are helpful in coding a kernel-mode provider's countersets:</span></span>

- <span data-ttu-id="736f1-185">Uma função de inicialização de conjuntos de contadores chamada <b> *prefixo* Register *Counterset*</b>.</span><span class="sxs-lookup"><span data-stu-id="736f1-185">A counterset initialization function named <b>*prefix* Register *Counterset*</b>.</span></span> <span data-ttu-id="736f1-186">Essa função preenche uma estrutura [RegInfo](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information) e, em seguida, invoca [PcwRegister](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwregister), colocando o alçamento de registro do counterset resultante na variável global ***Counterset.***</span><span class="sxs-lookup"><span data-stu-id="736f1-186">This function fills in a [RegInfo](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information) structure then invokes [PcwRegister](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwregister), putting the resulting counterset registration handle into the global ***Counterset*** variable.</span></span>
- <span data-ttu-id="736f1-187">Uma função de limpeza do counterset chamada <b> *prefix* Unregister *Counterset*</b>.</span><span class="sxs-lookup"><span data-stu-id="736f1-187">A counterset cleanup function named <b>*prefix* Unregister *Counterset*</b>.</span></span> <span data-ttu-id="736f1-188">Essa função invoca [PcwUnregister na alça](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwunregister) de registro do counterset na variável global ***Counterset.***</span><span class="sxs-lookup"><span data-stu-id="736f1-188">This function invokes [PcwUnregister](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwunregister) on the counterset registration handle in the global ***Counterset*** variable.</span></span>
- <span data-ttu-id="736f1-189">Uma função de criação de instância chamada <b> *prefixo* Create *Counterset*</b>.</span><span class="sxs-lookup"><span data-stu-id="736f1-189">An instance creation function named <b>*prefix* Create *Counterset*</b>.</span></span> <span data-ttu-id="736f1-190">Essa função preenche uma matriz de estruturas [PcwData](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) e, em seguida, invoca [PcwCreateInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcreateinstance) usando o alça de registro do conjunto de contadores na variável global ***Counterset.***</span><span class="sxs-lookup"><span data-stu-id="736f1-190">This function fills in an array of [PcwData](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) structures then invokes [PcwCreateInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcreateinstance) using the counterset registration handle in the global ***Counterset*** variable.</span></span>
- <span data-ttu-id="736f1-191">Uma função de limpeza de instância chamada <b> *prefixo* Close *Counterset*</b>.</span><span class="sxs-lookup"><span data-stu-id="736f1-191">An instance cleanup function named <b>*prefix* Close *Counterset*</b>.</span></span> <span data-ttu-id="736f1-192">Essa função invoca [PcwCloseInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcloseinstance).</span><span class="sxs-lookup"><span data-stu-id="736f1-192">This function invokes [PcwCloseInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwcloseinstance).</span></span>
- <span data-ttu-id="736f1-193">Uma função de relatório de instância chamada <b> *prefix* Add *Counterset*</b> a ser usada da função de retorno de chamada do counterset.</span><span class="sxs-lookup"><span data-stu-id="736f1-193">An instance reporting function named <b>*prefix* Add *Counterset*</b> to be used from the counterset callback function.</span></span> <span data-ttu-id="736f1-194">Essa função preenche uma matriz de estruturas [PcwData](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) e, em seguida, invoca [PcwAddInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwaddinstance).</span><span class="sxs-lookup"><span data-stu-id="736f1-194">This function fills in an array of [PcwData](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_data) structures then invokes [PcwAddInstance](/windows-hardware/drivers/ddi/wdm/nf-wdm-pcwaddinstance).</span></span>
- <span data-ttu-id="736f1-195">**SDK do Windows 20H1 e posterior:** Uma função de inicialização RegInfo chamada <b> *prefix* InitRegistrationInformation *Counterset*</b> para uso em cenários avançados.</span><span class="sxs-lookup"><span data-stu-id="736f1-195">**Windows SDK 20H1 and later:** A RegInfo initialization function named <b>*prefix* InitRegistrationInformation *Counterset*</b> for use in advanced scenarios.</span></span> <span data-ttu-id="736f1-196">Essa função preenche uma estrutura [RegInfo.](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information)</span><span class="sxs-lookup"><span data-stu-id="736f1-196">This function fills in a [RegInfo](/windows-hardware/drivers/ddi/wdm/ns-wdm-_pcw_registration_information) structure.</span></span> <span data-ttu-id="736f1-197">Essa função pode ser usada em casos em que o <b> *prefixo* gerado Registrar *Counterset*</b> não atender às suas necessidades, por exemplo, quando você deseja personalizar os valores na estrutura RegInfo ou quando você deseja armazenar o alça retornado em outra variável.</span><span class="sxs-lookup"><span data-stu-id="736f1-197">This function can be used in cases where the generated <b>*prefix* Register *Counterset*</b> does not meet your needs, e.g. when you want to customize the values in the RegInfo structure or when you want to store the returned handle in another variable.</span></span>

<span data-ttu-id="736f1-198">Nos nomes de função, ***prefixo*** refere-se ao valor do parâmetro `-prefix` de linha de comando.</span><span class="sxs-lookup"><span data-stu-id="736f1-198">In the function names, ***prefix*** refers to the value of the `-prefix` command-line parameter.</span></span> <span data-ttu-id="736f1-199">Se o `-prefix` parâmetro não for usado, as funções não terão prefixo.</span><span class="sxs-lookup"><span data-stu-id="736f1-199">If the `-prefix` parameter is not used the functions will have no prefix.</span></span>

> [!NOTE]
> <span data-ttu-id="736f1-200">A função <b>Add *Counterset do* *prefixo*</b> gerado é usada quando você tem um retorno de chamada de counterset.</span><span class="sxs-lookup"><span data-stu-id="736f1-200">The generated <b>*prefix* Add *Counterset*</b> function is used when you have a counterset callback.</span></span> <span data-ttu-id="736f1-201">O <b> *prefixo* gerado criar *contadores*</b> e as funções <b>*CounterSet* de fechamento de *prefixo*</b> são usados quando você não tem um retorno de chamada CounterSet.</span><span class="sxs-lookup"><span data-stu-id="736f1-201">The generated <b>*prefix* Create *Counterset*</b> and <b>*prefix* Close *Counterset*</b> functions are used when you do not have a counterset callback.</span></span>

### <a name="using-the-generated-symbol-file"></a><span data-ttu-id="736f1-202">Usando o arquivo de símbolo gerado</span><span class="sxs-lookup"><span data-stu-id="736f1-202">Using the generated symbol file</span></span>

<span data-ttu-id="736f1-203">Se o parâmetro **-ch** for especificado na linha de comando, a ferramenta ctrpp irá gerar um `.h` arquivo de símbolo.</span><span class="sxs-lookup"><span data-stu-id="736f1-203">If the **-ch** parameter is specified on the command line, the CTRPP tool will generate a `.h` symbol file.</span></span> <span data-ttu-id="736f1-204">Esse arquivo contém os símbolos C/C++ para os nomes e GUIDs de cada CounterSet no provedor.</span><span class="sxs-lookup"><span data-stu-id="736f1-204">This file contains the C/C++ symbols for the names and GUIDs of each counterset in the provider.</span></span> <span data-ttu-id="736f1-205">Os símbolos podem ser usados ao escrever programas que são embutidos em código para consumir os dados desse CounterSet usando as [funções de consumidor do PerfLib v2](using-the-perflib-functions-to-consume-counter-data.md).</span><span class="sxs-lookup"><span data-stu-id="736f1-205">The symbols can be used when writing programs that are hard-coded to consume the data from this counterset using the [PerfLib V2 Consumer functions](using-the-perflib-functions-to-consume-counter-data.md).</span></span>

## <a name="requirements"></a><span data-ttu-id="736f1-206">Requisitos</span><span class="sxs-lookup"><span data-stu-id="736f1-206">Requirements</span></span>

| <span data-ttu-id="736f1-207">Requisito</span><span class="sxs-lookup"><span data-stu-id="736f1-207">Requirement</span></span>             | <span data-ttu-id="736f1-208">Valor</span><span class="sxs-lookup"><span data-stu-id="736f1-208">Value</span></span> |
|-------------------------|-------|
| <span data-ttu-id="736f1-209">Cliente mínimo com suporte</span><span class="sxs-lookup"><span data-stu-id="736f1-209">Minimum supported client</span></span>| <span data-ttu-id="736f1-210">\[Somente aplicativos da área de trabalho do Windows Vista\]</span><span class="sxs-lookup"><span data-stu-id="736f1-210">Windows Vista \[desktop apps only\]</span></span>
| <span data-ttu-id="736f1-211">Servidor mínimo com suporte</span><span class="sxs-lookup"><span data-stu-id="736f1-211">Minimum supported server</span></span>| <span data-ttu-id="736f1-212">\[Somente aplicativos da área de trabalho do Windows Server 2008\]</span><span class="sxs-lookup"><span data-stu-id="736f1-212">Windows Server 2008 \[desktop apps only\]</span></span>
