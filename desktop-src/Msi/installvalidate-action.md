---
description: A ação InstallValidate verifica se todos os volumes aos quais o custo foi atribuído têm espaço suficiente para a instalação. A ação InstallValidate finalizará a instalação com um erro fatal se qualquer volume tiver espaço em disco insuficiente.
ms.assetid: 1c55794d-1ecc-43bf-956f-96afc5f36964
title: Ação InstallValidate
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e650ce136ac3b1b62e41ce34f79f5d28540d1292
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104171290"
---
# <a name="installvalidate-action"></a><span data-ttu-id="1b253-104">Ação InstallValidate</span><span class="sxs-lookup"><span data-stu-id="1b253-104">InstallValidate Action</span></span>

<span data-ttu-id="1b253-105">A ação InstallValidate verifica se todos os [*volumes*](v-gly.md) aos quais o [*custo*](c-gly.md) foi atribuído têm espaço suficiente para a instalação.</span><span class="sxs-lookup"><span data-stu-id="1b253-105">The InstallValidate action verifies that all [*volumes*](v-gly.md) to which [*cost*](c-gly.md) has been attributed have sufficient space for the installation.</span></span> <span data-ttu-id="1b253-106">A ação InstallValidate finalizará a instalação com um erro fatal se qualquer volume tiver espaço em disco insuficiente.</span><span class="sxs-lookup"><span data-stu-id="1b253-106">The InstallValidate action ends the installation with a fatal error if any volume is short of disk space.</span></span>

<span data-ttu-id="1b253-107">A ação InstallValidate também notificará o usuário se um ou mais arquivos a serem substituídos ou removidos estiverem em uso no momento por um processo ativo.</span><span class="sxs-lookup"><span data-stu-id="1b253-107">The InstallValidate action also notifies the user if one or more files to be overwritten or removed are currently in use by an active process.</span></span> <span data-ttu-id="1b253-108">Para obter mais informações, consulte [reinicializações do sistema](system-reboots.md).</span><span class="sxs-lookup"><span data-stu-id="1b253-108">For more information, see [System Reboots](system-reboots.md).</span></span>

## <a name="sequence-restrictions"></a><span data-ttu-id="1b253-109">Restrições de sequência</span><span class="sxs-lookup"><span data-stu-id="1b253-109">Sequence Restrictions</span></span>

<span data-ttu-id="1b253-110">A ação [CostFinalize](costfinalize-action.md) e todas as sequências de caixa de diálogo da interface do usuário que permitem que os usuários modifiquem os Estados de seleção e/ou diretórios devem ser sequenciadas antes da ação InstallValidate.</span><span class="sxs-lookup"><span data-stu-id="1b253-110">The [CostFinalize](costfinalize-action.md) action and any UI dialog box sequences that allow the user to modify selection states and/or directories should be sequenced before the InstallValidate action.</span></span>

<span data-ttu-id="1b253-111">[Ações personalizadas](custom-actions.md) que alteram o estado de instalação de recursos ou componentes devem ser sequenciadas antes da ação InstallValidate.</span><span class="sxs-lookup"><span data-stu-id="1b253-111">[Custom actions](custom-actions.md) that change the installation state of features or components must be sequenced before the InstallValidate action.</span></span>

## <a name="actiondata-messages"></a><span data-ttu-id="1b253-112">Mensagens ActionData</span><span class="sxs-lookup"><span data-stu-id="1b253-112">ActionData Messages</span></span>

<span data-ttu-id="1b253-113">Não há nenhuma mensagem ActionData.</span><span class="sxs-lookup"><span data-stu-id="1b253-113">There are no ActionData messages.</span></span>

## <a name="remarks"></a><span data-ttu-id="1b253-114">Comentários</span><span class="sxs-lookup"><span data-stu-id="1b253-114">Remarks</span></span>

<span data-ttu-id="1b253-115">Normalmente, uma sequência de caixas de diálogo da interface do usuário anterior deve executar a mesma verificação que a ação InstallValidate quando o usuário tenta iniciar a cópia dos arquivos.</span><span class="sxs-lookup"><span data-stu-id="1b253-115">Typically, an earlier UI dialog box sequence should perform the same verification as the InstallValidate action when the user attempts to initiate the copying of files.</span></span> <span data-ttu-id="1b253-116">Essa sequência de caixa de diálogo da interface do usuário deverá apresentar uma caixa **de diálogo sem espaço em disco** se os volumes selecionados não tiverem espaço suficiente para a instalação.</span><span class="sxs-lookup"><span data-stu-id="1b253-116">This UI dialog box sequence should present an **Out of Disk Space** dialog box if the volumes selected do not have enough space for the installation.</span></span> <span data-ttu-id="1b253-117">As caixas de diálogo da interface do usuário devem ser criadas de forma a impedir que o usuário continue com a instalação se não houver espaço em disco suficiente.</span><span class="sxs-lookup"><span data-stu-id="1b253-117">The UI dialog boxes should be authored in a way to prevent the user from proceeding with the installation if there is insufficient disk space.</span></span> <span data-ttu-id="1b253-118">No caso de uma instalação silenciosa, não há nenhuma interface do usuário e a ação InstallValidate terminará a instalação se não houver espaço em disco suficiente.</span><span class="sxs-lookup"><span data-stu-id="1b253-118">In the case of a quiet installation, there is no user interface and the InstallValidate action terminates the installation if there is insufficient disk space.</span></span> <span data-ttu-id="1b253-119">A causa do encerramento prematuro será registrada no arquivo de log se o log estiver habilitado.</span><span class="sxs-lookup"><span data-stu-id="1b253-119">The cause of the premature termination is recorded in the log file if logging is enabled.</span></span>

<span data-ttu-id="1b253-120">Uma entrada será adicionada a uma tabela interna do FilesInUse se algum arquivo for substituído ou removido enquanto estiver aberto para execução ou modificação por qualquer processo durante o [*custo*](c-gly.md)do arquivo.</span><span class="sxs-lookup"><span data-stu-id="1b253-120">An entry is added to an internal FilesInUse table if any file is overwritten or removed while it is open for execution or modification by any process during file [*costing*](c-gly.md).</span></span> <span data-ttu-id="1b253-121">A tabela FilesInUse contém colunas para o nome e o caminho completo do arquivo.</span><span class="sxs-lookup"><span data-stu-id="1b253-121">The FilesInUse table contains columns for the name and full path of the file.</span></span> <span data-ttu-id="1b253-122">Quando a ação InstallValidate é executada, o instalador consulta a tabela FilesInUse em busca de entradas e determina o nome do processo usando o arquivo.</span><span class="sxs-lookup"><span data-stu-id="1b253-122">When the InstallValidate action executes, the installer queries the FilesInUse table for entries and determines the name of the process using the file.</span></span> <span data-ttu-id="1b253-123">A ação InstallValidate adiciona um registro à tabela de interface do usuário da caixa de [listagem](listbox-table.md) para cada processo exclusivo identificado por essa consulta.</span><span class="sxs-lookup"><span data-stu-id="1b253-123">The InstallValidate action adds one record to the [ListBox](listbox-table.md) user interface table for each unique process identified by this query.</span></span> <span data-ttu-id="1b253-124">O registro contém os seguintes valores em cada coluna:</span><span class="sxs-lookup"><span data-stu-id="1b253-124">The record contains the following values in each column:</span></span>

<span data-ttu-id="1b253-125">**Propriedade**: FileInUseProcess</span><span class="sxs-lookup"><span data-stu-id="1b253-125">**Property**: FileInUseProcess</span></span>

 

<span data-ttu-id="1b253-126">**Valor**: *nome do processo*</span><span class="sxs-lookup"><span data-stu-id="1b253-126">**Value**: *Name of process*</span></span>

 

<span data-ttu-id="1b253-127">**Texto**: *texto contido na legenda da janela principal do processo*</span><span class="sxs-lookup"><span data-stu-id="1b253-127">**Text**: *Text contained in the caption of the main window of the process*</span></span>

<span data-ttu-id="1b253-128">A ação InstallValidate exibe a caixa de diálogo **arquivos em uso** .</span><span class="sxs-lookup"><span data-stu-id="1b253-128">The InstallValidate action then displays the **Files In Use** dialog box.</span></span> <span data-ttu-id="1b253-129">Essa caixa de diálogo exibe os processos que devem ser desligados para evitar a necessidade de reiniciar o sistema para substituir os arquivos em uso.</span><span class="sxs-lookup"><span data-stu-id="1b253-129">This dialog box displays the processes that must be shut down to avoid the requirement of restarting the system to replace files in use.</span></span>

<span data-ttu-id="1b253-130">A ação InstallValidate consulta a tabela de [diálogo](dialog-table.md) em busca de uma caixa de diálogo criada com o nome reservado [FilesInUse](filesinuse-dialog.md) diálogo e o exibe.</span><span class="sxs-lookup"><span data-stu-id="1b253-130">The InstallValidate action queries the [Dialog](dialog-table.md) table for an authored dialog box with the reserved name [FilesInUse](filesinuse-dialog.md) dialog and displays it.</span></span> <span data-ttu-id="1b253-131">Essa caixa de diálogo deve conter um controle [ListBox](listbox-control.md) que esteja vinculado a uma propriedade chamada FileInUseProcess.</span><span class="sxs-lookup"><span data-stu-id="1b253-131">This dialog box must contain a [ListBox](listbox-control.md) control that is tied to a property named FileInUseProcess.</span></span> <span data-ttu-id="1b253-132">Por convenção, essa caixa de diálogo tem um botão **sair**, **repetir** ou **ignorar** , mas isso se aplica ao autor da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="1b253-132">By convention, this dialog box has an **Exit**, **Retry**, or **Ignore** button, but this is up to the UI author.</span></span> <span data-ttu-id="1b253-133">Cada botão deve ser vinculado a um ControlEvent, [EndDialog](enddialog-controlevent.md) na tabela [ControlEvent,](controlevent-table.md) .</span><span class="sxs-lookup"><span data-stu-id="1b253-133">Each button should be tied to an [EndDialog](enddialog-controlevent.md) ControlEvent in the [ControlEvent](controlevent-table.md) table.</span></span> <span data-ttu-id="1b253-134">A ação InstallValidate responde da seguinte forma ao valor retornado pelo ControlEvent, [DoAction](doaction-controlevent.md) , conforme ditado por um desses argumentos [EndDialog](enddialog-controlevent.md) associados ao botão enviado pelo usuário:</span><span class="sxs-lookup"><span data-stu-id="1b253-134">The InstallValidate action responds as follows to the value returned by the [DoAction](doaction-controlevent.md) ControlEvent, as dictated by one of these [EndDialog](enddialog-controlevent.md) arguments associated with the button pushed by the user:</span></span>

<span data-ttu-id="1b253-135">**Repetir**: todos os valores adicionados à tabela [ListBox](listbox-table.md) são desmarcados e o procedimento de [*custo*](c-gly.md) de arquivo inteiro é repetido, verificando novamente se há arquivos que ainda estão em uso.</span><span class="sxs-lookup"><span data-stu-id="1b253-135">**Retry**: All values added to the [ListBox](listbox-table.md) table are cleared, and the entire file [*costing*](c-gly.md) procedure is repeated, rechecking for files that are still in use.</span></span> <span data-ttu-id="1b253-136">Se um ou mais processos ainda forem identificados como usando arquivos a serem substituídos ou excluídos, o processo se repetirá; caso contrário, InstallValidate retornará o controle para o instalador com um status de msiDoActionStatusSuccess.</span><span class="sxs-lookup"><span data-stu-id="1b253-136">If one or more processes are still identified as using files to be overwritten or deleted, the process repeats; otherwise, InstallValidate returns control to the installer with a status of msiDoActionStatusSuccess.</span></span>

<span data-ttu-id="1b253-137">**Exit**: a ação InstallValidate retorna imediatamente o controle para o instalador com um status de msiDoActionStatusUserExit.</span><span class="sxs-lookup"><span data-stu-id="1b253-137">**Exit**: The InstallValidate action immediately returns control to the installer with a status of msiDoActionStatusUserExit.</span></span> <span data-ttu-id="1b253-138">Isso encerra a instalação.</span><span class="sxs-lookup"><span data-stu-id="1b253-138">This terminates the installation.</span></span>

<span data-ttu-id="1b253-139">**Qualquer outro valor de retorno**: a ação InstallValidate retorna imediatamente o controle para o instalador com um status de msiDoActionStatusSuccess.</span><span class="sxs-lookup"><span data-stu-id="1b253-139">**Any other return value**: The InstallValidate action immediately returns control to the installer with a status of msiDoActionStatusSuccess.</span></span> <span data-ttu-id="1b253-140">Nesse caso, como um ou mais arquivos ainda estão em uso, as ações subsequentes [InstallFiles](installfiles-action.md) e/ou [InstallAdminPackage](installadminpackage-action.md) devem agendar os arquivos em uso para serem substituídos ou excluídos quando o sistema for reiniciado.</span><span class="sxs-lookup"><span data-stu-id="1b253-140">In this case, since one or more files are still in use, the subsequent [InstallFiles](installfiles-action.md) and/or [InstallAdminPackage](installadminpackage-action.md) actions must schedule the in-use file(s) to be replaced or deleted when the system is restarted.</span></span>

<span data-ttu-id="1b253-141">Se não houver nenhuma tabela de caixa de [listagem](listbox-table.md) no banco de dados, o InstallValidate será fechado silenciosamente sem um erro.</span><span class="sxs-lookup"><span data-stu-id="1b253-141">If there is no [ListBox](listbox-table.md) table in the database, InstallValidate exits silently without an error.</span></span>

<span data-ttu-id="1b253-142">O ponto-e-vírgula é o delimitador de lista para transformações, fontes e patches e não deve ser usado nesses nomes de arquivo ou caminhos.</span><span class="sxs-lookup"><span data-stu-id="1b253-142">The semicolon is the list delimiter for transforms, sources, and patches, and should not be used in these file names or paths.</span></span>

<span data-ttu-id="1b253-143">Arquivos marcados como somente leitura em um local somente leitura nunca são considerados em uso pelo instalador.</span><span class="sxs-lookup"><span data-stu-id="1b253-143">Files marked read-only in a read-only location are never considered in use by the installer.</span></span>

<span data-ttu-id="1b253-144">Uma caixa **de diálogo padrão sem espaço em disco** que contém os botões **anular** e **repetir** será apresentada ao usuário se o nível da interface do usuário for básico.</span><span class="sxs-lookup"><span data-stu-id="1b253-144">A default **Out of Disk Space** dialog box containing **Abort** and **Retry** buttons is presented to the user if the user interface level is basic.</span></span>

 

 



