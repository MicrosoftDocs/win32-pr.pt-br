---
description: Esta seção descreve como enviar mensagens de ações personalizadas que realmente executam uma parte da instalação chamando uma biblioteca de vínculo dinâmico ou script.
ms.assetid: 637efccf-920d-421d-9183-528cc3515bf8
title: Retornando mensagens de erro de ações personalizadas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 480a9e7891680aadc9d8eb4eedba2bad0d2e3dd4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104091131"
---
# <a name="returning-error-messages-from-custom-actions"></a><span data-ttu-id="2b374-103">Retornando mensagens de erro de ações personalizadas</span><span class="sxs-lookup"><span data-stu-id="2b374-103">Returning Error Messages from Custom Actions</span></span>

<span data-ttu-id="2b374-104">Esta seção descreve como enviar mensagens de ações personalizadas que realmente executam uma parte da instalação chamando uma biblioteca de vínculo dinâmico ou script.</span><span class="sxs-lookup"><span data-stu-id="2b374-104">This section describes how to send messages from custom actions that actually perform a part of the installation by calling a dynamic link library or script.</span></span> <span data-ttu-id="2b374-105">Observe que o [tipo de ação personalizada 19](custom-action-type-19.md) envia apenas uma mensagem de erro especificada, retorna falha e, em seguida, encerra a instalação.</span><span class="sxs-lookup"><span data-stu-id="2b374-105">Note that [Custom Action Type 19](custom-action-type-19.md) only sends a specified error message, returns failure, and then terminates the installation.</span></span> <span data-ttu-id="2b374-106">O tipo de ação personalizada 19 não executa nenhuma parte da instalação.</span><span class="sxs-lookup"><span data-stu-id="2b374-106">Custom Action Type 19 does not perform any part of the installation.</span></span>

<span data-ttu-id="2b374-107">Para enviar uma mensagem de erro de uma ação personalizada que usa uma dll ( [biblioteca de vínculo dinâmico](dynamic-link-libraries.md) ), faça com que a ação personalizada chame [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage).</span><span class="sxs-lookup"><span data-stu-id="2b374-107">To send an error message from a custom action that uses a [dynamic-link library](dynamic-link-libraries.md) (DLL), have the custom action call [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage).</span></span> <span data-ttu-id="2b374-108">Observe que as ações personalizadas iniciadas por um [ControlEvent, de doação](doaction-controlevent.md) podem enviar mensagens com o método [**Message**](session-message.md) , mas não podem enviar uma mensagem com **MsiProcessMessage**.</span><span class="sxs-lookup"><span data-stu-id="2b374-108">Note that custom actions launched by a [DoAction ControlEvent](doaction-controlevent.md) can send messages with the [**Message**](session-message.md) method but cannot send a message with **MsiProcessMessage**.</span></span> <span data-ttu-id="2b374-109">Em sistemas anteriores ao Windows Server 2003, as ações personalizadas iniciadas por uma ação ControlEvent, não podem enviar mensagens com **MsiProcessMessage** ou método de **mensagem** .</span><span class="sxs-lookup"><span data-stu-id="2b374-109">On systems earlier than Windows Server 2003, custom actions launched by a DoAction ControlEvent cannot send messages with **MsiProcessMessage** or **Message** method.</span></span> <span data-ttu-id="2b374-110">Para obter mais informações, consulte [enviando mensagens para Windows Installer usando MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span><span class="sxs-lookup"><span data-stu-id="2b374-110">For more information, see [Sending Messages to Windows Installer Using MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span></span>

<span data-ttu-id="2b374-111">**Para exibir uma mensagem de erro de dentro de uma ação personalizada usando uma DLL**</span><span class="sxs-lookup"><span data-stu-id="2b374-111">**To display an error message from within a custom action using a DLL**</span></span>

1.  <span data-ttu-id="2b374-112">A ação personalizada deve chamar [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) e passar os parâmetros *hInstall*, *eMessageType* e *hRecord*.</span><span class="sxs-lookup"><span data-stu-id="2b374-112">The custom action should call [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) and pass in the parameters *hInstall*, *eMessageType*, and *hRecord*.</span></span> <span data-ttu-id="2b374-113">O identificador para a instalação, [tipo de ação personalizada 19](custom-action-type-19.md), pode ser fornecido para a ação personalizada, conforme descrito em [acessando a sessão do instalador atual de dentro de uma ação personalizada](accessing-the-current-installer-session-from-inside-a-custom-action.md) ou de [**MsiOpenProduct**](/windows/desktop/api/Msi/nf-msi-msiopenproducta) ou [**MsiOpenPackage**](/windows/desktop/api/Msi/nf-msi-msiopenpackagea).</span><span class="sxs-lookup"><span data-stu-id="2b374-113">The handle to the installation, [Custom Action Type 19](custom-action-type-19.md), may be provided to the custom action as described in [Accessing the Current Installer Session from Inside a Custom Action](accessing-the-current-installer-session-from-inside-a-custom-action.md) or from [**MsiOpenProduct**](/windows/desktop/api/Msi/nf-msi-msiopenproducta) or [**MsiOpenPackage**](/windows/desktop/api/Msi/nf-msi-msiopenpackagea).</span></span>
2.  <span data-ttu-id="2b374-114">O parâmetro *eMessageType* deve especificar um dos tipos de mensagem, como listado em [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage).</span><span class="sxs-lookup"><span data-stu-id="2b374-114">The parameter *eMessageType* should specify one of the message types as listed in [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage).</span></span>
3.  <span data-ttu-id="2b374-115">O parâmetro *hRecord* da função [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) depende do tipo de mensagem.</span><span class="sxs-lookup"><span data-stu-id="2b374-115">The *hRecord* parameter of the [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) function depends upon the message type.</span></span> <span data-ttu-id="2b374-116">Consulte [enviando mensagens para Windows Installer usando o MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span><span class="sxs-lookup"><span data-stu-id="2b374-116">See [Sending Messages to Windows Installer Using MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span></span> <span data-ttu-id="2b374-117">Se a mensagem contiver dados formatados, insira a mensagem na tabela de [erros](error-table.md) usando a formatação descrita em [formatado](formatted.md).</span><span class="sxs-lookup"><span data-stu-id="2b374-117">If the message contains formatted data, enter the message into the [Error](error-table.md) table using the formatting described in [Formatted](formatted.md).</span></span>

<span data-ttu-id="2b374-118">Para enviar uma mensagem de erro de uma ação personalizada que usa [scripts](scripts.md), a ação personalizada pode chamar o método [**Message**](session-message.md) do objeto [**Session**](session-object.md) .</span><span class="sxs-lookup"><span data-stu-id="2b374-118">To send an error message from a custom action that uses [Scripts](scripts.md), the custom action may call the [**Message**](session-message.md) method of the [**Session**](session-object.md) object.</span></span>

<span data-ttu-id="2b374-119">**Para exibir uma mensagem de erro de dentro de uma ação personalizada usando script**</span><span class="sxs-lookup"><span data-stu-id="2b374-119">**To display an error message from within a custom action using script**</span></span>

1.  <span data-ttu-id="2b374-120">A ação personalizada deve chamar o método [**Message**](session-message.md) do objeto [**Session**](session-object.md) e passar o *tipo* e o *registro* dos parâmetros.</span><span class="sxs-lookup"><span data-stu-id="2b374-120">The custom action should call the [**Message**](session-message.md) method of the [**Session**](session-object.md) object and pass in the parameters *kind* and *record*.</span></span>
2.  <span data-ttu-id="2b374-121">O *tipo* de parâmetro deve especificar um dos tipos de mensagem listados no método [**Message**](session-message.md) .</span><span class="sxs-lookup"><span data-stu-id="2b374-121">The parameter *kind* should specify one of the message types listed in the [**Message**](session-message.md) method.</span></span>
3.  <span data-ttu-id="2b374-122">O parâmetro de *registro* do método [**Message**](session-message.md) depende do tipo de mensagem.</span><span class="sxs-lookup"><span data-stu-id="2b374-122">The *record* parameter of the [**Message**](session-message.md) method depends upon the message type.</span></span> <span data-ttu-id="2b374-123">Se a mensagem contiver dados formatados, insira a mensagem na tabela de [erros](error-table.md) usando a formatação descrita em [formatado](formatted.md).</span><span class="sxs-lookup"><span data-stu-id="2b374-123">If the message contains formatted data, enter the message into the [Error](error-table.md) table using the formatting described in [Formatted](formatted.md).</span></span>

<span data-ttu-id="2b374-124">As ações personalizadas que usam [arquivos executáveis](executable-files.md) não podem enviar uma mensagem chamando [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) ou o método [**Message**](session-message.md) porque eles não podem obter um identificador para a instalação.</span><span class="sxs-lookup"><span data-stu-id="2b374-124">Custom actions using [Executable Files](executable-files.md) cannot send a message by calling [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) or the [**Message**](session-message.md) method because they cannot get a handle to the installation.</span></span>

## <a name="related-topics"></a><span data-ttu-id="2b374-125">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="2b374-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2b374-126">Valores de retorno de ação personalizada</span><span class="sxs-lookup"><span data-stu-id="2b374-126">Custom Action Return Values</span></span>](custom-action-return-values.md)
</dt> </dl>

 

 



