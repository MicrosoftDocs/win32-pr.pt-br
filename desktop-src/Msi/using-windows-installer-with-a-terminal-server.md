---
description: Os itens a seguir podem afetar Windows Installer instalações ao usar um servidor de terminal. Os desenvolvedores de instalação devem sempre testar se o pacote de Windows Installer é instalado conforme o esperado quando os usuários também estão usando um servidor de terminal.
ms.assetid: deda9efa-a0fc-4b4e-a531-650ac201fd84
title: Usando Windows Installer com um Terminal Server
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d471fa19b4588a01a2730af44fa5e9d978d18859
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104461044"
---
# <a name="using-windows-installer-with-a-terminal-server"></a><span data-ttu-id="2467c-104">Usando Windows Installer com um Terminal Server</span><span class="sxs-lookup"><span data-stu-id="2467c-104">Using Windows Installer with a Terminal Server</span></span>

<span data-ttu-id="2467c-105">Os itens a seguir podem afetar Windows Installer instalações ao usar um servidor de terminal.</span><span class="sxs-lookup"><span data-stu-id="2467c-105">The following may affect Windows Installer installations when using a terminal server.</span></span> <span data-ttu-id="2467c-106">Os desenvolvedores de instalação devem sempre testar se o pacote de Windows Installer é instalado conforme o esperado quando os usuários também estão usando um servidor de terminal.</span><span class="sxs-lookup"><span data-stu-id="2467c-106">Setup developers should always test that their Windows Installer package installs as expected when users are also using a terminal server.</span></span>

-   <span data-ttu-id="2467c-107">Em sistemas operacionais anteriores ao Windows Server 2008 e ao Windows Vista, a política do sistema [EnableAdminTSRemote](enableadmintsremote.md) deve ser definida para permitir que os administradores executem instalações na sessão do cliente.</span><span class="sxs-lookup"><span data-stu-id="2467c-107">On operating systems earlier than Windows Server 2008 and Windows Vista, the [EnableAdminTSRemote](enableadmintsremote.md) system policy must be set to enable administrators to perform installations in the client session.</span></span> <span data-ttu-id="2467c-108">A partir do Windows Server 2008 e do Windows Vista, a política EnableAdminTSRemote não tem mais efeito.</span><span class="sxs-lookup"><span data-stu-id="2467c-108">Beginning with Windows Server 2008 and Windows Vista, the EnableAdminTSRemote policy no longer has any effect.</span></span> <span data-ttu-id="2467c-109">Independentemente de sua configuração, os administradores e os não administradores podem executar uma instalação na sessão do cliente ou na sessão do console.</span><span class="sxs-lookup"><span data-stu-id="2467c-109">Regardless of its setting, administrators and non-administrators can perform an installation in the client session or the console session.</span></span> <span data-ttu-id="2467c-110">Os administradores e os não administradores sempre podem executar Windows Installer instalações na sessão do console.</span><span class="sxs-lookup"><span data-stu-id="2467c-110">Administrators and non-administrators can always perform Windows Installer installations in the console session.</span></span>
-   <span data-ttu-id="2467c-111">O Windows Installer impedirá a instalação no [contexto de instalação](installation-context.md) por usuário se a[política do sistema](system-policy.md) [DisableUserInstalls](disableuserinstalls.md)estiver definida como 1.</span><span class="sxs-lookup"><span data-stu-id="2467c-111">The Windows Installer prevents installation in the per-user [installation context](installation-context.md) if the [DisableUserInstalls](disableuserinstalls.md)[system policy](system-policy.md) is set to 1.</span></span> <span data-ttu-id="2467c-112">Nesse caso, o instalador ignora todos os aplicativos registrados como por usuário e pesquisa apenas os aplicativos registrados como por máquina.</span><span class="sxs-lookup"><span data-stu-id="2467c-112">In this case, the installer ignores all applications registered as per-user and searches only for applications registered as per-machine.</span></span>
-   <span data-ttu-id="2467c-113">Quando um administrador executa uma instalação em uma sessão de cliente de um servidor de terminal hospedado no Windows 2000, a instalação deve usar um caminho UNC e não uma letra de unidade mapeada.</span><span class="sxs-lookup"><span data-stu-id="2467c-113">When an administrator performs an installation in a client session of a terminal server that is hosted in Windows 2000, the installation must use a UNC path and not a mapped drive letter.</span></span>

<span data-ttu-id="2467c-114">Os desenvolvedores devem aderir às diretrizes a seguir ao desenvolver um componente Windows Installer que possa ser usado com um servidor de terminal.</span><span class="sxs-lookup"><span data-stu-id="2467c-114">Developers should adhere to the following guidelines when developing a Windows Installer component that may be used with a terminal server.</span></span>

-   <span data-ttu-id="2467c-115">Grave todas as informações do registro **HKCU** na parte do  \\ **software** HKCU do registro.</span><span class="sxs-lookup"><span data-stu-id="2467c-115">Write all **HKCU** registry information in the **HKCU**\\**Software** part of the registry.</span></span>
-   <span data-ttu-id="2467c-116">Não é recomendável armazenar informações de configuração em arquivos INI.</span><span class="sxs-lookup"><span data-stu-id="2467c-116">Storing configuration information in INI files is not recommended.</span></span>
-   <span data-ttu-id="2467c-117">Gravar informações por usuário no registro quando o aplicativo for executado pela primeira vez e não no momento da instalação.</span><span class="sxs-lookup"><span data-stu-id="2467c-117">Write per-user information to the registry when the application is run for the first time and not at installation time.</span></span> <span data-ttu-id="2467c-118">Se você precisar gravar informações por usuário no registro no momento da instalação, separe as informações por usuário e por computador em diferentes componentes de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="2467c-118">If you must write per-user information to the registry at installation time, separate the per-user and per-machine information into different Windows Installer components.</span></span> <span data-ttu-id="2467c-119">Crie o pacote de modo que o instalador não tente validar e reparar os componentes que contêm informações por usuário quando o aplicativo for instalado.</span><span class="sxs-lookup"><span data-stu-id="2467c-119">Author the package such that the installer does not attempt to validate and repair the components containing per-user information when the application is installed.</span></span>
-   <span data-ttu-id="2467c-120">Um pacote usado somente para instalações por máquina deve gravar variáveis de ambiente no ambiente do computador, incluindo \* na coluna nome da [tabela de ambiente](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="2467c-120">A package used for only per-machine installations should write environment variables to the computer's environment by including \* in the Name column of the [Environment Table](environment-table.md).</span></span> <span data-ttu-id="2467c-121">Se o pacote puder ser usado para instalações por usuário ou instalações por computador, use dois componentes.</span><span class="sxs-lookup"><span data-stu-id="2467c-121">If the package can be used for per-user installations or per-machine installations, use two components.</span></span> <span data-ttu-id="2467c-122">Inclua o componente por usuário na tabela de [componentes](condition-table.md) e insira as configurações de usuário na tabela de ambiente.</span><span class="sxs-lookup"><span data-stu-id="2467c-122">Include the per-user component in the [Component Table](condition-table.md) and enter the user settings in the Environment Table.</span></span> <span data-ttu-id="2467c-123">Inclua o componente por computador na tabela de componentes e insira as configurações do computador na tabela de ambiente.</span><span class="sxs-lookup"><span data-stu-id="2467c-123">Include the per-machine component in the Component Table and enter the computer settings in the Environment Table.</span></span> <span data-ttu-id="2467c-124">Controle qual componente é instalado usando instruções condicionais com base na propriedade [**AllUsers**](allusers.md) no campo condição da tabela de componentes.</span><span class="sxs-lookup"><span data-stu-id="2467c-124">Control which component gets installed by using conditional statements based upon the [**ALLUSERS**](allusers.md) property in the Condition field of the Component Table.</span></span>
-   <span data-ttu-id="2467c-125">Ao executar instalações por máquina de um servidor de terminal, o instalador grava variáveis de ambiente por usuário para **HKCU** \\ **.** \\ **Ambiente** padrão.</span><span class="sxs-lookup"><span data-stu-id="2467c-125">When performing per-machine installations from a terminal server, the installer writes per-user environment variables to **HKCU**\\ **.Default**\\**Environment**.</span></span> <span data-ttu-id="2467c-126">Como o servidor de terminal não replica essa seção do registro, a instalação não define as variáveis de ambiente por usuário.</span><span class="sxs-lookup"><span data-stu-id="2467c-126">Because the terminal server does not replicate this section of the registry, the installation does not set the per-user environment variables.</span></span>
-   <span data-ttu-id="2467c-127">Como um servidor pode ser configurado para impedir que os usuários reparem aplicativos, seu aplicativo deve lidar normalmente com o caso de chaves de registro ausentes.</span><span class="sxs-lookup"><span data-stu-id="2467c-127">Because a server may be configured to prevent users from repairing applications, your application should handle the case of missing registry keys gracefully.</span></span>

<span data-ttu-id="2467c-128">O seguinte se aplica quando um pacote de Windows Installer que usa DLL, EXE ou [ações personalizadas](custom-actions.md) de script é instalado no contexto de instalação por máquina em um servidor de terminal.</span><span class="sxs-lookup"><span data-stu-id="2467c-128">The following applies when a Windows Installer package that uses DLL, EXE, or Script [custom actions](custom-actions.md) is installed in the per-machine installation context on a terminal server.</span></span> <span data-ttu-id="2467c-129">Nesse caso, o instalador define a propriedade [**TerminalServer**](terminalserver.md) .</span><span class="sxs-lookup"><span data-stu-id="2467c-129">In this case, the installer sets the [**TerminalServer**](terminalserver.md) property.</span></span>

-   <span data-ttu-id="2467c-130">Ações personalizadas adiadas são executadas no contexto do sistema local, a menos que a ação tenha o atributo **msidbCustomActionTypeTSAware** .</span><span class="sxs-lookup"><span data-stu-id="2467c-130">Deferred custom actions run in the context of the local system unless the action has the **msidbCustomActionTypeTSAware** attribute.</span></span> <span data-ttu-id="2467c-131">Isso é verdadeiro mesmo que a ação personalizada represente o usuário em um sistema que não seja um servidor de terminal.</span><span class="sxs-lookup"><span data-stu-id="2467c-131">This is true even if the custom action impersonates the user on a system that is not a terminal server.</span></span> <span data-ttu-id="2467c-132">Observe que, se uma ação personalizada que tenha o atributo **msidbCustomActionTypeTSAware** alterar o registro do usuário, o instalador não garantirá automaticamente que essas alterações também sejam feitas no registro de cada usuário no computador.</span><span class="sxs-lookup"><span data-stu-id="2467c-132">Note that if a custom action having the **msidbCustomActionTypeTSAware** attribute changes the user's registry, the installer does not automatically ensure that those changes are also made in the registry of every user on the computer.</span></span>
-   <span data-ttu-id="2467c-133">Qualquer operação de registro em uma ação personalizada adiada que leia do hive do registro **HKCU** vê o hive do registro padrão do sistema e não o hive do registro do usuário atual.</span><span class="sxs-lookup"><span data-stu-id="2467c-133">Any registry operations in a deferred custom action that read from the **HKCU** registry hive sees the system's default registry hive and not the current user's registry hive.</span></span>
-   <span data-ttu-id="2467c-134">Todas as operações de registro em uma ação personalizada adiada que grava no \\ **software** HKCU são detectadas pelo instalador e copiadas para cada usuário do computador no próximo logon do usuário.</span><span class="sxs-lookup"><span data-stu-id="2467c-134">Any registry operations in a deferred custom action that write to **HKCU**\\**Software** are detected by the installer and copied to every user of the computer at the next logon of the user.</span></span>
-   <span data-ttu-id="2467c-135">Todas as operações de registro em uma ação personalizada adiada que gravam em **HKCU**, mas que não estão sob a  \\ chave do registro do **software** HKCU, não são detectadas pelo instalador ou copiadas.</span><span class="sxs-lookup"><span data-stu-id="2467c-135">Any registry operations in a deferred custom action that write to **HKCU**, but are not under the **HKCU**\\**Software** registry key, are not detected by the installer or copied.</span></span>

<span data-ttu-id="2467c-136">Para obter mais informações, consulte [serviços de terminal](../termserv/terminal-services-portal.md) no SDK (Software Development Kit) do Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="2467c-136">For more information, see [Terminal Services](../termserv/terminal-services-portal.md) in the Microsoft Windows Software Development Kit (SDK).</span></span>

## <a name="related-topics"></a><span data-ttu-id="2467c-137">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="2467c-137">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="2467c-138">EnableAdminTSRemote</span><span class="sxs-lookup"><span data-stu-id="2467c-138">EnableAdminTSRemote</span></span>](enableadmintsremote.md)
</dt> <dt>

[<span data-ttu-id="2467c-139">**Propriedade TerminalServer**</span><span class="sxs-lookup"><span data-stu-id="2467c-139">**TerminalServer property**</span></span>](terminalserver.md)
</dt> <dt>

[<span data-ttu-id="2467c-140">**Propriedade RemoteAdminTS**</span><span class="sxs-lookup"><span data-stu-id="2467c-140">**RemoteAdminTS property**</span></span>](remoteadmints.md)
</dt> <dt>

[<span data-ttu-id="2467c-141">Serviços de Terminal</span><span class="sxs-lookup"><span data-stu-id="2467c-141">Terminal Services</span></span>](../termserv/terminal-services-portal.md)
</dt> </dl>

 

 
