---
description: Instalações simultâneas, também chamadas de instalações aninhadas, são um recurso preterido do Windows Installer.
ms.assetid: 579ae4ee-47a0-440e-81ca-ea8bf60c5349
title: Instalações simultâneas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d89f2ef4af062c8151935fefab471603f79d7633
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103829014"
---
# <a name="concurrent-installations"></a><span data-ttu-id="80c60-103">Instalações simultâneas</span><span class="sxs-lookup"><span data-stu-id="80c60-103">Concurrent Installations</span></span>

<span data-ttu-id="80c60-104">Instalações simultâneas, também chamadas de instalações aninhadas, são um recurso preterido do Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="80c60-104">Concurrent Installations, also called Nested Installations, is a deprecated feature of the Windows Installer.</span></span> <span data-ttu-id="80c60-105">Os aplicativos instalados com instalações simultâneas podem eventualmente falhar porque são difíceis para os clientes atenderem corretamente.</span><span class="sxs-lookup"><span data-stu-id="80c60-105">Applications installed with concurrent installations can eventually fail because they are difficult for customers to service correctly.</span></span> <span data-ttu-id="80c60-106">Não use instalações simultâneas para instalar produtos que devem ser liberados para o público.</span><span class="sxs-lookup"><span data-stu-id="80c60-106">Do not use concurrent installations to install products that are intended to be released to the public.</span></span> <span data-ttu-id="80c60-107">As instalações simultâneas podem ter aplicabilidade limitada em ambientes corporativos controlados quando usadas para instalar aplicativos que não são destinados à versão pública.</span><span class="sxs-lookup"><span data-stu-id="80c60-107">Concurrent installations can have limited applicability in controlled corporate environments when used to install applications that are not intended for public release.</span></span> <span data-ttu-id="80c60-108">A documentação de instalações simultâneas é fornecida para os autores de pacotes que desejam usar instalações simultâneas com aplicativos que não são para distribuição pública.</span><span class="sxs-lookup"><span data-stu-id="80c60-108">The concurrent installations documentation is provided for package authors that wish to use concurrent installations with applications that are not for public distribution.</span></span>

<span data-ttu-id="80c60-109">Uma ação de instalação simultânea instala outro pacote de Windows Installer durante uma instalação em execução no momento.</span><span class="sxs-lookup"><span data-stu-id="80c60-109">A concurrent installation action installs another Windows Installer package during a currently running installation.</span></span> <span data-ttu-id="80c60-110">Uma instalação simultânea é adicionada a um pacote por meio da criação de uma ação de instalação simultânea na [tabela CustomAction](customaction-table.md) e do agendamento dessa ação personalizada nas tabelas de sequência.</span><span class="sxs-lookup"><span data-stu-id="80c60-110">A concurrent installation is added to a package by authoring a concurrent installation action into the [CustomAction table](customaction-table.md) and scheduling this custom action into the sequence tables.</span></span> <span data-ttu-id="80c60-111">O campo de destino da tabela CustomAction contém uma cadeia de caracteres das configurações de propriedade pública usadas pela instalação simultânea.</span><span class="sxs-lookup"><span data-stu-id="80c60-111">The Target field of the CustomAction table contains a string of public property settings used by the concurrent installation.</span></span> <span data-ttu-id="80c60-112">O campo de origem da tabela CustomAction identifica o pacote simultâneo.</span><span class="sxs-lookup"><span data-stu-id="80c60-112">The Source field of the CustomAction table identifies the concurrent package.</span></span> <span data-ttu-id="80c60-113">Uma ação de instalação simultânea só pode reinstalar ou remover um aplicativo que foi instalado pelo pacote de instalação do aplicativo atual.</span><span class="sxs-lookup"><span data-stu-id="80c60-113">A concurrent installation action can only reinstall or remove an application that has been installed by the current application's installation package.</span></span>

<span data-ttu-id="80c60-114">O tipo de ação de instalação simultânea é especificado no campo tipo da tabela CustomAction.</span><span class="sxs-lookup"><span data-stu-id="80c60-114">The type of concurrent installation action is specified in the Type field of the CustomAction table.</span></span> <span data-ttu-id="80c60-115">Dependendo do tipo de ação personalizada, o pacote para o aplicativo simultâneo pode residir em um subarmazenamento do pacote principal, como um arquivo em um local especificado por uma propriedade ou como um aplicativo anunciado no computador do usuário.</span><span class="sxs-lookup"><span data-stu-id="80c60-115">Depending upon the custom action type, the package for the concurrent application can reside in a substorage of the main package, as a file at a location specified by a property, or as an advertised application on the user's machine.</span></span> <span data-ttu-id="80c60-116">Os seguintes tipos de ações personalizadas executam uma instalação simultânea.</span><span class="sxs-lookup"><span data-stu-id="80c60-116">The following types of custom actions perform a concurrent installation.</span></span>



| <span data-ttu-id="80c60-117">Tipo de ação personalizada</span><span class="sxs-lookup"><span data-stu-id="80c60-117">Custom action type</span></span>                                 | <span data-ttu-id="80c60-118">Description</span><span class="sxs-lookup"><span data-stu-id="80c60-118">Description</span></span>                                                                     |
|----------------------------------------------------|---------------------------------------------------------------------------------|
| [<span data-ttu-id="80c60-119">Tipo de ação personalizada 7</span><span class="sxs-lookup"><span data-stu-id="80c60-119">Custom Action Type 7</span></span>](custom-action-type-7.md)   | <span data-ttu-id="80c60-120">Instalação simultânea de um produto que reside no pacote de instalação.</span><span class="sxs-lookup"><span data-stu-id="80c60-120">Concurrent installation of a product residing in the installation package.</span></span>      |
| [<span data-ttu-id="80c60-121">Tipo de ação personalizada 23</span><span class="sxs-lookup"><span data-stu-id="80c60-121">Custom Action Type 23</span></span>](custom-action-type-23.md) | <span data-ttu-id="80c60-122">Instalação simultânea de um pacote do instalador na árvore de origem atual.</span><span class="sxs-lookup"><span data-stu-id="80c60-122">Concurrent installation of an installer package within the current source tree.</span></span> |
| [<span data-ttu-id="80c60-123">Tipo de ação personalizada 39</span><span class="sxs-lookup"><span data-stu-id="80c60-123">Custom Action Type 39</span></span>](custom-action-type-39.md) | <span data-ttu-id="80c60-124">Instalação simultânea de um pacote do instalador anunciado.</span><span class="sxs-lookup"><span data-stu-id="80c60-124">Concurrent installation of an advertised installer package.</span></span>                     |



 

<span data-ttu-id="80c60-125">Uma instalação simultânea compartilha a mesma interface do usuário e configurações de log como a instalação principal.</span><span class="sxs-lookup"><span data-stu-id="80c60-125">A concurrent installation shares the same user interface and logging settings as the main installation.</span></span>

<span data-ttu-id="80c60-126">As ações de instalação simultânea devem ser colocadas entre a [ação InstallInitialize](installinitialize-action.md) e a [ação InstallFinalize](installfinalize-action.md) da sequência de ação da instalação principal.</span><span class="sxs-lookup"><span data-stu-id="80c60-126">Concurrent installation actions should be placed between the [InstallInitialize action](installinitialize-action.md) and [InstallFinalize action](installfinalize-action.md) of the main installation's action sequence.</span></span> <span data-ttu-id="80c60-127">Após a reversão da instalação principal, o instalador irá reverter a instalação simultânea também.</span><span class="sxs-lookup"><span data-stu-id="80c60-127">Upon rollback of the main installation, the installer will then rollback the concurrent installation as well.</span></span> <span data-ttu-id="80c60-128">O uso da [execução adiada](deferred-execution-custom-actions.md) com ações de instalação simultânea é desnecessário porque o instalador combina informações de reversão das instalações simultâneas e principais.</span><span class="sxs-lookup"><span data-stu-id="80c60-128">The use of [deferred execution](deferred-execution-custom-actions.md) with concurrent installation actions is unnecessary because the installer combines rollback information from the concurrent and main installations.</span></span> <span data-ttu-id="80c60-129">Todas as alterações são revertidas após uma instalação de reversão.</span><span class="sxs-lookup"><span data-stu-id="80c60-129">All changes are reversed upon a rollback installation.</span></span>

<span data-ttu-id="80c60-130">Os valores de retorno para ações de instalação simultânea são os mesmos para outras ações personalizadas.</span><span class="sxs-lookup"><span data-stu-id="80c60-130">The return values for concurrent installation actions are the same as for other custom actions.</span></span> <span data-ttu-id="80c60-131">Consulte [valores de retorno de ação personalizada](custom-action-return-values.md).</span><span class="sxs-lookup"><span data-stu-id="80c60-131">See [Custom Action Return Values](custom-action-return-values.md).</span></span>

<span data-ttu-id="80c60-132">As ações padrão ou personalizadas que especificam uma reinicialização automática do sistema ou solicitam que o usuário reiniciem também podem executar reinicialização ou solicitação de dentro de uma instalação simultânea.</span><span class="sxs-lookup"><span data-stu-id="80c60-132">Standard or custom actions that specify an automatic restart of the system, or request the user to restart, can also perform restart or request from within a concurrent installation.</span></span>

<span data-ttu-id="80c60-133">Depois que o instalador inicia uma instalação simultânea, ele bloqueia todas as outras instalações até que a instalação simultânea seja concluída e antes de continuar a instalação principal.</span><span class="sxs-lookup"><span data-stu-id="80c60-133">Once the installer begins a concurrent installation, it locks out all other installations until the concurrent installation is complete and before continuing the main installation.</span></span> <span data-ttu-id="80c60-134">O instalador só pode executar instalações simultâneas como ações personalizadas síncronas.</span><span class="sxs-lookup"><span data-stu-id="80c60-134">The installer can only execute concurrent installations as synchronous custom actions.</span></span> <span data-ttu-id="80c60-135">Consulte [ações personalizadas síncronas e assíncronas](synchronous-and-asynchronous-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="80c60-135">See [Synchronous and Asynchronous Custom Actions](synchronous-and-asynchronous-custom-actions.md).</span></span> <span data-ttu-id="80c60-136">Os sinalizadores de opção descritos em [Opções de processamento de retorno de ação personalizadas](custom-action-return-processing-options.md) devem ser definidos como nenhum (+ 0) ou **msidbCustomActionTypeContinue** (+ 64).</span><span class="sxs-lookup"><span data-stu-id="80c60-136">The option flags described in [Custom Action Return Processing Options](custom-action-return-processing-options.md) must be set to none (+0) or **msidbCustomActionTypeContinue** (+64).</span></span>

<span data-ttu-id="80c60-137">Uma ação de instalação simultânea pode instalar um aplicativo para ser executado localmente, para ser executado da origem, para ser reinstalado ou para ser removido da mesma maneira que ao usar o [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta) para uma instalação normal.</span><span class="sxs-lookup"><span data-stu-id="80c60-137">A concurrent installation action can install an application to be run locally, to run from source, to be reinstalled, or to be removed in the same manner as when using [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta) for a regular installation.</span></span> <span data-ttu-id="80c60-138">Para especificar o tipo de instalação, passe a propriedade [**ADDLOCAL**](addlocal.md), [**addsource**](addsource.md), [**REINSTALL**](reinstall.md)ou [**Remove**](remove.md) para a ação de instalação simultânea.</span><span class="sxs-lookup"><span data-stu-id="80c60-138">To specify the type of installation, pass either the [**ADDLOCAL**](addlocal.md), [**ADDSOURCE**](addsource.md), [**REINSTALL**](reinstall.md), or [**REMOVE**](remove.md) property to the concurrent installation action.</span></span>

<span data-ttu-id="80c60-139">As ações de instalação simultânea podem ser criadas em pares, uma ação usada para instalar e a outra ação usada para remover a instalação simultânea.</span><span class="sxs-lookup"><span data-stu-id="80c60-139">Concurrent installation actions can be authored in pairs, one action used for installing and the other action used for removing the concurrent installation.</span></span> <span data-ttu-id="80c60-140">Um [tipo de ação personalizada 7](custom-action-type-7.md) ou [tipo de ação personalizada 23](custom-action-type-23.md) normalmente é usado para instalar o.</span><span class="sxs-lookup"><span data-stu-id="80c60-140">A [Custom Action Type 7](custom-action-type-7.md) or [Custom Action Type 23](custom-action-type-23.md) is typically used to install.</span></span> <span data-ttu-id="80c60-141">Um [tipo de ação personalizada 39](custom-action-type-39.md) normalmente é usado para remover a instalação simultânea quando o produto pai é desinstalado.</span><span class="sxs-lookup"><span data-stu-id="80c60-141">A [Custom Action Type 39](custom-action-type-39.md) is typically used to remove the concurrent installation when the parent product is uninstalled.</span></span> <span data-ttu-id="80c60-142">O registro para a ação personalizada de remoção na [tabela CustomAction](customaction-table.md) pode ter o GUID de código do produto no campo de origem e "Remove = All" no campo de destino.</span><span class="sxs-lookup"><span data-stu-id="80c60-142">The record for the removal custom action in the [CustomAction table](customaction-table.md) can have the product code GUID in the Source field and "REMOVE=ALL" in the Target field.</span></span> <span data-ttu-id="80c60-143">As duas ações personalizadas precisam ser criadas na tabela de sequência de ação com condições mutuamente exclusivas.</span><span class="sxs-lookup"><span data-stu-id="80c60-143">The two custom actions need to be authored in the action sequence table with mutually exclusive conditions.</span></span> <span data-ttu-id="80c60-144">Por exemplo, a ação personalizada que instala o produto pode ter "não instalado" em seu campo de condição e a ação personalizada remove a instalação simultânea pode ter REMOVE = "ALL" em seu campo de condição.</span><span class="sxs-lookup"><span data-stu-id="80c60-144">For example, the custom action that installs the product can have "NOT Installed" in its Condition field and the custom action removes the concurrent installation can have REMOVE="ALL" in its Condition field.</span></span>

<span data-ttu-id="80c60-145">Não há nenhum método para consultar um pacote por seu custo.</span><span class="sxs-lookup"><span data-stu-id="80c60-145">There is no method for querying a package for its cost.</span></span> <span data-ttu-id="80c60-146">Isso torna difícil o custo de instalações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="80c60-146">This makes the costing of a concurrent installations difficult.</span></span> <span data-ttu-id="80c60-147">As linhas devem ser adicionadas à [tabela ReserveCost](reservecost-table.md) para indicar as pastas e os custos de pior caso do componente associado à instalação simultânea.</span><span class="sxs-lookup"><span data-stu-id="80c60-147">Rows must be added to the [ReserveCost table](reservecost-table.md) to indicate the folders and worst-case costs of the component associated with the concurrent install.</span></span>

<span data-ttu-id="80c60-148">As únicas [Opções de processamento de retorno de ação personalizada](custom-action-return-processing-options.md) disponíveis com ações de instalação simultâneas são None (+ 0) ou **msidbCustomActionTypeContinue** (+ 64).</span><span class="sxs-lookup"><span data-stu-id="80c60-148">The only [Custom Action Return Processing Options](custom-action-return-processing-options.md) available with concurrent installation actions are none (+0) or **msidbCustomActionTypeContinue** (+64).</span></span>

<span data-ttu-id="80c60-149">Observe que uma instalação pai não pode chamar seu próprio pacote como uma ação de instalação simultânea.</span><span class="sxs-lookup"><span data-stu-id="80c60-149">Note that a parent installation cannot call its own package as a concurrent installation action.</span></span>

<span data-ttu-id="80c60-150">Observe que, se uma instalação por máquina tentar executar uma instalação simultânea por usuário, o instalador registrará a instalação pai como por usuário por padrão.</span><span class="sxs-lookup"><span data-stu-id="80c60-150">Note that if a per-machine installation attempts to run a per-user concurrent installation, the installer registers the parent installation as per-user by default.</span></span> <span data-ttu-id="80c60-151">Isso pode fazer com que o instalador remova incorretamente o aplicativo, pois o instalador tenta desinstalar o aplicativo por máquina quando ele está realmente registrado como por usuário.</span><span class="sxs-lookup"><span data-stu-id="80c60-151">This can cause the installer to incorrectly remove the application because the installer attempts to uninstall the application per-machine when it is actually registered as per-user.</span></span> <span data-ttu-id="80c60-152">Para forçar o estado de uma instalação simultânea para acompanhar o estado de sua instalação pai, insira ALLUSERS = " \[ AllUsers \] " na coluna de destino da [tabela CustomAction](customaction-table.md).</span><span class="sxs-lookup"><span data-stu-id="80c60-152">To force the state of a concurrent installation to track the state of its parent installation, enter ALLUSERS="\[ALLUSERS\]" in the Target column of the [CustomAction table](customaction-table.md).</span></span> <span data-ttu-id="80c60-153">Nesse caso, a instalação simultânea será por máquina se o pai for por máquina, e a instalação simultânea será por usuário se o pai for por usuário.</span><span class="sxs-lookup"><span data-stu-id="80c60-153">In this case, the concurrent installation is per-machine if the parent is per-machine, and the concurrent installation is per-user if the parent is per-user.</span></span>

<span data-ttu-id="80c60-154">Os desenvolvedores devem observar os seguintes avisos ao criar instalações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="80c60-154">Developers should note the following warnings when authoring concurrent installations.</span></span>

-   <span data-ttu-id="80c60-155">As instalações simultâneas não podem compartilhar componentes.</span><span class="sxs-lookup"><span data-stu-id="80c60-155">Concurrent installations cannot share components.</span></span>
-   <span data-ttu-id="80c60-156">Uma instalação administrativa também não pode conter uma instalação simultânea.</span><span class="sxs-lookup"><span data-stu-id="80c60-156">An administrative installation cannot also contain a concurrent installation.</span></span>
-   <span data-ttu-id="80c60-157">A aplicação de patches e a atualização podem não funcionar com instalações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="80c60-157">Patching and upgrading may not work with concurrent installations.</span></span>
-   <span data-ttu-id="80c60-158">O instalador pode não custar corretamente uma instalação simultânea.</span><span class="sxs-lookup"><span data-stu-id="80c60-158">The installer may not properly cost a concurrent installation.</span></span>
-   <span data-ttu-id="80c60-159">ProgressBars integradas não podem ser usadas com instalações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="80c60-159">Integrated ProgressBars cannot be used with concurrent installations.</span></span>
-   <span data-ttu-id="80c60-160">Os recursos que devem ser anunciados não podem ser instalados pela instalação simultânea.</span><span class="sxs-lookup"><span data-stu-id="80c60-160">Resources that are to be advertised cannot be installed by the concurrent installation.</span></span>
-   <span data-ttu-id="80c60-161">Um pacote que executa uma instalação simultânea de um aplicativo também deve desinstalar o aplicativo simultâneo quando o produto pai é desinstalado.</span><span class="sxs-lookup"><span data-stu-id="80c60-161">A package that performs a concurrent installation of an application should also uninstall the concurrent application when the parent product is uninstalled.</span></span>

<span data-ttu-id="80c60-162">Para impedir que um pacote nunca seja instalado como uma instalação simultânea, adicione uma das instruções condicionais a seguir à tabela [LaunchCondition](launchcondition-table.md) .</span><span class="sxs-lookup"><span data-stu-id="80c60-162">To prevent a package from ever being installed as a concurrent installation, add either of the following conditional statements to the [LaunchCondition](launchcondition-table.md) table.</span></span> <span data-ttu-id="80c60-163">Isso impede que o pacote nunca seja instalado por uma ação de instalação simultânea executada por outra instalação.</span><span class="sxs-lookup"><span data-stu-id="80c60-163">This prevents the package from ever being installed by a concurrent installation action run by another installation.</span></span> <span data-ttu-id="80c60-164">Isso não impede que o pacote seja removido pela ação [RemoveExistingProducts](removeexistingproducts-action.md) .</span><span class="sxs-lookup"><span data-stu-id="80c60-164">This does not prevent the package from being removed by the [RemoveExistingProducts](removeexistingproducts-action.md) action.</span></span> <span data-ttu-id="80c60-165">Consulte também a propriedade [**ParentOriginalDatabase**](parentoriginaldatabase.md) e a propriedade [**ParentProductCode**](parentproductcode.md) .</span><span class="sxs-lookup"><span data-stu-id="80c60-165">See also the [**ParentOriginalDatabase**](parentoriginaldatabase.md) property and [**ParentProductCode**](parentproductcode.md) property.</span></span>

``` syntax
"Not ParentProductCode"
```

``` syntax
"Not ParentOriginalDatabase"
```

 

 



