---
description: O procedimento neste tópico identifica como criar um pacote de Windows Installer para instalar um assembly Win32.
ms.assetid: 2d4bc2be-cce6-45e6-b6a7-7ff96d28eb96
title: Instalando assemblies do Win32 para o uso particular de um aplicativo no Windows XP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e807e22c9c5dea67ece5ead0ded95f06ab203689
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105812919"
---
# <a name="installing-win32-assemblies-for-the-private-use-of-an-application-on-windows-xp"></a><span data-ttu-id="78299-103">Instalando assemblies do Win32 para o uso particular de um aplicativo no Windows XP</span><span class="sxs-lookup"><span data-stu-id="78299-103">Installing Win32 Assemblies for the Private Use of an Application on Windows XP</span></span>

<span data-ttu-id="78299-104">O procedimento neste tópico identifica como criar um pacote de Windows Installer para instalar um assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="78299-104">The procedure in this topic identifies how to create a Windows Installer package to install a Win32 assembly.</span></span> <span data-ttu-id="78299-105">O pacote instala o assembly e um arquivo de manifesto do aplicativo em uma pasta criada que o aplicativo usa.</span><span class="sxs-lookup"><span data-stu-id="78299-105">The package installs the assembly and an application manifest file into an authored folder that the application uses.</span></span> <span data-ttu-id="78299-106">O manifesto do aplicativo especifica a dependência do aplicativo no assembly particular.</span><span class="sxs-lookup"><span data-stu-id="78299-106">The application manifest specifies the dependence of the application on the private assembly.</span></span> <span data-ttu-id="78299-107">Depois de instalar o pacote, o assembly privado estará disponível para uso exclusivo do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="78299-107">After installing the package, the private assembly is available for the exclusive use of the application.</span></span> <span data-ttu-id="78299-108">A dependência do assembly que é especificada no manifesto do aplicativo substitui (para este aplicativo) quaisquer outras dependências de assembly globais especificadas nos arquivos de manifesto do assembly.</span><span class="sxs-lookup"><span data-stu-id="78299-108">The assembly dependence that is specified in the application manifest overrides (for this application) any other global assembly dependencies that are specified in assembly manifest files.</span></span>

<span data-ttu-id="78299-109">Antes de continuar, é uma boa ideia entender como criar um pacote de Windows Installer sem assemblies.</span><span class="sxs-lookup"><span data-stu-id="78299-109">Before you continue, it is a good idea to understand how to author a Windows Installer package without assemblies.</span></span> <span data-ttu-id="78299-110">Para obter mais informações, consulte [um exemplo de instalação](an-installation-example.md).</span><span class="sxs-lookup"><span data-stu-id="78299-110">For more information, see [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="78299-111">**Para instalar um assembly particular no Windows XP**</span><span class="sxs-lookup"><span data-stu-id="78299-111">**To install a private assembly on Windows XP**</span></span>

1.  <span data-ttu-id="78299-112">Defina um componente de Windows Installer que inclui o assembly Win32 e o arquivo de manifesto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="78299-112">Define a Windows Installer component that includes the Win32 assembly and the application manifest file.</span></span> <span data-ttu-id="78299-113">Esse componente pode conter outros recursos que devem ser sempre instalados ou removidos com o assembly.</span><span class="sxs-lookup"><span data-stu-id="78299-113">This component can contain other resources that should always be installed or removed with the assembly.</span></span> <span data-ttu-id="78299-114">As etapas restantes deste procedimento descrevem como criar o banco de dados de instalação para instalar esse componente.</span><span class="sxs-lookup"><span data-stu-id="78299-114">The remaining steps of this procedure describe how to author the installation database to install this component.</span></span>
2.  <span data-ttu-id="78299-115">Adicione uma linha à [tabela de componentes](component-table.md) para o componente que contém o assembly do Win32 e o arquivo de manifesto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="78299-115">Add a row to the [Component table](component-table.md) for the component that contains the Win32 assembly and application manifest file.</span></span> <span data-ttu-id="78299-116">Insira um [GUID](guid.md) de Windows Installer válido para este código de componente.</span><span class="sxs-lookup"><span data-stu-id="78299-116">Enter a valid Windows Installer [GUID](guid.md) for this component code.</span></span> <span data-ttu-id="78299-117">Para obter mais informações, consulte [alterando o código do componente](changing-the-component-code.md) e [o que acontece se as regras de componente forem interrompidas?](what-happens-if-the-component-rules-are-broken.md)</span><span class="sxs-lookup"><span data-stu-id="78299-117">For more information, see [Changing the Component Code](changing-the-component-code.md) and [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md)</span></span>
3.  <span data-ttu-id="78299-118">O instalador copia o arquivo de manifesto do assembly na pasta que contém o arquivo especificado no \_ campo aplicativo de arquivo da [tabela MsiAssembly](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="78299-118">The installer copies the assembly manifest file into the folder that contains the file specified in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span>
4.  <span data-ttu-id="78299-119">Adicione uma linha à [tabela FeatureComponents](featurecomponents-table.md) vinculando o componente a um recurso Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="78299-119">Add a row to the [FeatureComponents table](featurecomponents-table.md) tying the component to a Windows Installer feature.</span></span> <span data-ttu-id="78299-120">Para obter mais informações, consulte [componentes e recursos](components-and-features.md).</span><span class="sxs-lookup"><span data-stu-id="78299-120">For more information, see [Components and Features](components-and-features.md).</span></span> <span data-ttu-id="78299-121">Um recurso de Windows Installer deve ser uma parte da funcionalidade do aplicativo que um usuário pode reconhecer.</span><span class="sxs-lookup"><span data-stu-id="78299-121">A Windows Installer feature should be a piece of the application functionality that a user can recognize.</span></span> <span data-ttu-id="78299-122">O assembly é ativado quando esse recurso é selecionado por um usuário ou com falha no por um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="78299-122">The assembly is activated when this feature is selected by a user or faulted in by an application.</span></span> <span data-ttu-id="78299-123">Se o assembly definir um recurso adicional, adicione uma linha adicional à tabela de [recursos](feature-table.md) para os atributos de recurso.</span><span class="sxs-lookup"><span data-stu-id="78299-123">If the assembly defines an additional feature, then add an additional row to the [Feature table](feature-table.md) for the feature attributes.</span></span> <span data-ttu-id="78299-124">Esta etapa não será necessária se você criar um módulo de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="78299-124">This step is not required if authoring a merge module.</span></span>
5.  <span data-ttu-id="78299-125">Para assemblies lado a lado, as informações de associação e de ativação, por exemplo, classes COM, interfaces e bibliotecas de tipos, são armazenadas em arquivos de manifesto em vez de no registro.</span><span class="sxs-lookup"><span data-stu-id="78299-125">For side-by-side assemblies, binding and activation information, for example, COM classes, interfaces, and type libraries, is stored in manifest files rather than the registry.</span></span> <span data-ttu-id="78299-126">Os assemblies privados armazenam essas informações em um manifesto do assembly.</span><span class="sxs-lookup"><span data-stu-id="78299-126">Private assemblies store this information in an assembly manifest.</span></span> <span data-ttu-id="78299-127">Em sistemas que dão suporte a assemblies lado a lado, o instalador ignora o processamento de qualquer informação sobre o componente que é inserido na [tabela de extensão](extension-table.md), [tabela de verbo](verb-table.md), tabela de [TypeLib](typelib-table.md), tabela [MIME](mime-table.md), tabela de [classes](class-table.md), tabela [ProgID](progid-table.md)e [tabela AppID](appid-table.md).</span><span class="sxs-lookup"><span data-stu-id="78299-127">On systems that support side-by-side assemblies, the installer skips processing any information about the component that is entered in the [Extension table](extension-table.md), [Verb table](verb-table.md), [TypeLib table](typelib-table.md), [MIME table](mime-table.md), [Class table](class-table.md), [ProgId table](progid-table.md), and [AppId table](appid-table.md).</span></span> <span data-ttu-id="78299-128">As informações de associação e ativação podem ser inseridas nas tabelas para uso por sistemas que não dão suporte ao compartilhamento de assembly lado a lado.</span><span class="sxs-lookup"><span data-stu-id="78299-128">Binding and activation information can be entered into the tables for use by systems that do not support side-by-side assembly sharing.</span></span>
6.  <span data-ttu-id="78299-129">A instalação lado a lado não registra o assembly globalmente.</span><span class="sxs-lookup"><span data-stu-id="78299-129">Side-by-side installation does not register the assembly globally.</span></span> <span data-ttu-id="78299-130">O instalador ignora o registro automático do componente se alguma informação de auto-registro for inserida na [tabela selfreg](selfreg-table.md).</span><span class="sxs-lookup"><span data-stu-id="78299-130">The installer skips self-registering the component if any self-registration information is entered in the [SelfReg table](selfreg-table.md).</span></span> <span data-ttu-id="78299-131">As informações de Autoregistro podem ser inseridas na tabela SelfReg para o registro automático do componente em sistemas que não dão suporte ao compartilhamento de assembly lado a lado.</span><span class="sxs-lookup"><span data-stu-id="78299-131">Self-registration information can be entered into the SelfReg table for self-registration of the component on systems that do not support side-by-side assembly sharing.</span></span>
7.  <span data-ttu-id="78299-132">Adicione outras informações de registro, exclusivas de associação e ativação ou Autoregistro do componente, à tabela [do registro](registry-table.md), à [tabela RemoveRegistry](removeregistry-table.md)e à [tabela de ambiente](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="78299-132">Add any other registry information, exclusive of binding and activation or self-registration of the component, to the [Registry table](registry-table.md), [RemoveRegistry table](removeregistry-table.md), and [Environment table](environment-table.md).</span></span>
8.  <span data-ttu-id="78299-133">O instalador ignora a [tabela IsolatedComponent](isolatedcomponent-table.md) para esse componente em sistemas operacionais que dão suporte ao compartilhamento lado a lado.</span><span class="sxs-lookup"><span data-stu-id="78299-133">The installer skips the [IsolatedComponent table](isolatedcomponent-table.md) for this component on operating systems that support side-by-side sharing.</span></span> <span data-ttu-id="78299-134">Insira as informações nesta tabela se você quiser que o assembly seja privado em sistemas que dão suporte a arquivos locais.</span><span class="sxs-lookup"><span data-stu-id="78299-134">Enter information into this table if you want the assembly to be private on systems that support local files.</span></span>
9.  <span data-ttu-id="78299-135">Adicione uma linha à [tabela MsiAssembly](msiassembly-table.md) para o componente que contém o assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="78299-135">Add a row to the [MsiAssembly table](msiassembly-table.md) for the component that contains the Win32 assembly.</span></span> <span data-ttu-id="78299-136">Insira um valor de 1 no campo atributos da tabela MsiAssembly para especificar que este é um assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="78299-136">Enter a value of 1 in the Attributes field of the MsiAssembly table to specify that this is a Win32 assembly.</span></span> <span data-ttu-id="78299-137">Insira a chave de arquivo do assembly privado no \_ campo aplicativo de arquivo da [tabela MsiAssembly](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="78299-137">Enter the file key of the private assembly in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span> <span data-ttu-id="78299-138">Adicione a [ação MsiPublishAssemblies](msipublishassemblies-action.md) à [tabela InstallExecuteSequence](installexecutesequence-table.md) ou à [tabela AdvtExecuteSequence](advtexecutesequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="78299-138">Add the [MsiPublishAssemblies action](msipublishassemblies-action.md) to the [InstallExecuteSequence table](installexecutesequence-table.md) or [AdvtExecuteSequence table](advtexecutesequence-table.md).</span></span> <span data-ttu-id="78299-139">Adicione a [ação MsiUnpublishAssemblies](msiunpublishassemblies-action.md) à tabela InstallExecuteSequence.</span><span class="sxs-lookup"><span data-stu-id="78299-139">Add the [MsiUnpublishAssemblies action](msiunpublishassemblies-action.md) to the InstallExecuteSequence table.</span></span> <span data-ttu-id="78299-140">Crie uma pasta para o assembly e o arquivo de manifesto na [tabela de diretórios](directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="78299-140">Author a folder for the assembly and manifest file into the [Directory table](directory-table.md).</span></span> <span data-ttu-id="78299-141">Essa pasta deve estar no diretório raiz do aplicativo e conter o arquivo especificado no \_ campo aplicativo de arquivo da [tabela MsiAssembly](msiassembly-table.md).</span><span class="sxs-lookup"><span data-stu-id="78299-141">This folder should be in the application's root directory and contain the file specified in the File\_Application field of the [MsiAssembly table](msiassembly-table.md).</span></span> <span data-ttu-id="78299-142">Durante a instalação do aplicativo, o instalador resolve a [tabela de diretórios](directory-table.md) para o caminho para essa pasta.</span><span class="sxs-lookup"><span data-stu-id="78299-142">During the installation of the application, the installer resolves the [Directory table](directory-table.md) for the path to this folder.</span></span> <span data-ttu-id="78299-143">Para obter mais informações, consulte [usando a tabela de diretórios](using-the-directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="78299-143">For more information, see [Using the Directory Table](using-the-directory-table.md).</span></span>
10. <span data-ttu-id="78299-144">Adicione linhas à [tabela MsiAssemblyName](msiassemblyname-table.md) para o componente.</span><span class="sxs-lookup"><span data-stu-id="78299-144">Add rows to the [MsiAssemblyName table](msiassemblyname-table.md) for the component.</span></span> <span data-ttu-id="78299-145">Adicione uma linha para cada par de nome e valor especificado na seção assemblyIdentity do manifesto.</span><span class="sxs-lookup"><span data-stu-id="78299-145">Add one row for each name and value pair specified in the assemblyIdentity section of the manifest.</span></span> <span data-ttu-id="78299-146">Para obter mais informações, consulte [tabela MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="78299-146">For more information, see [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

 

 



