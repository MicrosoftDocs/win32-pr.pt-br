---
description: Veja a seguir uma descrição de como criar um pacote de Windows Installer para instalar um assembly Win32.
ms.assetid: 1234e904-fc7f-4eb7-8c50-0c959bbf5261
title: Instalando assemblies do Win32 para compartilhamento lado a lado
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ea72c9bcb7bd85ac38dfc8857030d6b9d6afbf23
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105782792"
---
# <a name="installing-win32-assemblies-for-side-by-side-sharing"></a><span data-ttu-id="f8abd-103">Instalando assemblies do Win32 para compartilhamento lado a lado</span><span class="sxs-lookup"><span data-stu-id="f8abd-103">Installing Win32 Assemblies for Side-by-Side Sharing</span></span>

<span data-ttu-id="f8abd-104">Veja a seguir uma descrição de como criar um pacote de Windows Installer para instalar um assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="f8abd-104">The following describes how to create a Windows Installer package to install a Win32 assembly.</span></span> <span data-ttu-id="f8abd-105">O pacote instala um assembly lado a lado na pasta WinSxS para o uso compartilhado do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f8abd-105">The package installs a side-by-side assembly in the Winsxs folder for the shared use of the application.</span></span> <span data-ttu-id="f8abd-106">Depois de instalar o pacote, o assembly compartilhado está globalmente disponível para qualquer aplicativo que especifique uma dependência no assembly em um arquivo de manifesto do assembly.</span><span class="sxs-lookup"><span data-stu-id="f8abd-106">After installing the package, the shared assembly is globally available to any application that specifies a dependence on the assembly in an assembly manifest file.</span></span> <span data-ttu-id="f8abd-107">O instalador não registra globalmente o assembly lado a lado no sistema.</span><span class="sxs-lookup"><span data-stu-id="f8abd-107">The installer does not globally register the side-by-side assembly on the system.</span></span>

<span data-ttu-id="f8abd-108">Observe que você pode instalar assemblies compartilhados lado a lado usando módulos de [mesclagem](merge-modules.md).</span><span class="sxs-lookup"><span data-stu-id="f8abd-108">Note that you may install shared side-by-side assemblies using [merge modules](merge-modules.md).</span></span>

<span data-ttu-id="f8abd-109">Antes de continuar, você deve entender como criar um pacote de Windows Installer sem assemblies.</span><span class="sxs-lookup"><span data-stu-id="f8abd-109">Before continuing you should understand how to author a Windows Installer package without assemblies.</span></span> <span data-ttu-id="f8abd-110">Para obter um exemplo de como criar uma instalação simples, consulte [um exemplo de instalação](an-installation-example.md).</span><span class="sxs-lookup"><span data-stu-id="f8abd-110">For an example of how to author a simple installation, see [An Installation Example](an-installation-example.md).</span></span>

<span data-ttu-id="f8abd-111">**Para instalar um assembly compartilhado lado a lado**</span><span class="sxs-lookup"><span data-stu-id="f8abd-111">**To install a shared assembly side-by-side**</span></span>

1.  <span data-ttu-id="f8abd-112">Defina um componente de Windows Installer que inclui o assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="f8abd-112">Define a Windows Installer component that includes the Win32 assembly.</span></span> <span data-ttu-id="f8abd-113">Esse componente pode conter outros recursos que devem ser sempre instalados ou removidos com o assembly.</span><span class="sxs-lookup"><span data-stu-id="f8abd-113">This component may contain other resources that should always be installed or removed with the assembly.</span></span> <span data-ttu-id="f8abd-114">Todos os outros componentes do aplicativo podem ser criados exatamente como para uma instalação sem assemblies.</span><span class="sxs-lookup"><span data-stu-id="f8abd-114">All the other components of the application can be authored just as for an installation without assemblies.</span></span> <span data-ttu-id="f8abd-115">Adicione uma linha à [tabela de componentes](component-table.md) para o componente que contém o assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="f8abd-115">Add a row to the [Component table](component-table.md) for the component containing the Win32 assembly.</span></span> <span data-ttu-id="f8abd-116">Insira um [GUID](guid.md) de Windows Installer válido para este código de componente.</span><span class="sxs-lookup"><span data-stu-id="f8abd-116">Enter a valid Windows Installer [GUID](guid.md) for this component code.</span></span> <span data-ttu-id="f8abd-117">Não use o arquivo de manifesto como o caminho de chave para este componente.</span><span class="sxs-lookup"><span data-stu-id="f8abd-117">Do not use the manifest file as the key path for this component.</span></span>
2.  <span data-ttu-id="f8abd-118">Adicione uma linha à [tabela FeatureComponents](featurecomponents-table.md) vinculando o componente a um recurso Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="f8abd-118">Add a row to the [FeatureComponents table](featurecomponents-table.md) tying the component to a Windows Installer feature.</span></span> <span data-ttu-id="f8abd-119">Para obter informações, consulte [componentes e recursos](components-and-features.md).</span><span class="sxs-lookup"><span data-stu-id="f8abd-119">For information see, [Components and Features](components-and-features.md).</span></span> <span data-ttu-id="f8abd-120">Um recurso de Windows Installer deve ser uma parte da funcionalidade do aplicativo que pode ser reconhecível para um usuário.</span><span class="sxs-lookup"><span data-stu-id="f8abd-120">A Windows Installer feature should be a piece of the application's functionality that is recognizable to a user.</span></span> <span data-ttu-id="f8abd-121">O assembly é ativado quando esse recurso é selecionado por um usuário ou com falha no por um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f8abd-121">The assembly is activated when this feature is selected by a user or faulted in by an application.</span></span> <span data-ttu-id="f8abd-122">Se o assembly definir um recurso adicional, adicione uma linha adicional à tabela de [recursos](feature-table.md) para os atributos do recurso.</span><span class="sxs-lookup"><span data-stu-id="f8abd-122">If the assembly defines an additional feature, then add an additional row to the [Feature table](feature-table.md) for the feature's attributes.</span></span> <span data-ttu-id="f8abd-123">Esta etapa não é necessária ao criar um módulo de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="f8abd-123">This step is not needed when authoring a merge module.</span></span>
3.  <span data-ttu-id="f8abd-124">Para assemblies lado a lado, as informações de associação e de ativação, como classes COM, interfaces e bibliotecas de tipos, são armazenadas em arquivos de manifesto em vez de no registro.</span><span class="sxs-lookup"><span data-stu-id="f8abd-124">For side-by-side assemblies, binding and activation information, such as COM classes, interfaces, and type libraries, is stored in manifest files rather than the registry.</span></span> <span data-ttu-id="f8abd-125">Os assemblies compartilhados armazenam essas informações em um manifesto do assembly.</span><span class="sxs-lookup"><span data-stu-id="f8abd-125">Shared assemblies store this information in an assembly manifest.</span></span> <span data-ttu-id="f8abd-126">Em sistemas que dão suporte a assemblies lado a lado, o instalador ignora o processamento de qualquer informação sobre o componente inserido na [tabela de extensão](extension-table.md), [tabela de verbo](verb-table.md), tabela de [TypeLib](typelib-table.md), tabela de [classes](class-table.md) [MIME](mime-table.md), tabela de classe, tabela de [ProgID](progid-table.md)e [tabela AppID](appid-table.md).</span><span class="sxs-lookup"><span data-stu-id="f8abd-126">On systems that support side-by-side assemblies, the installer skips processing any information about the component entered in the [Extension table](extension-table.md), [Verb table](verb-table.md), [TypeLib table](typelib-table.md), [MIME table](mime-table.md), [Class table](class-table.md), [ProgId table](progid-table.md), and [AppId table](appid-table.md).</span></span> <span data-ttu-id="f8abd-127">As informações de associação e ativação podem ser inseridas nessas tabelas para uso por sistemas que não dão suporte ao compartilhamento de assembly lado a lado.</span><span class="sxs-lookup"><span data-stu-id="f8abd-127">Binding and activation information may be entered into these tables for use by systems that do not support side-by-side assembly sharing.</span></span>
4.  <span data-ttu-id="f8abd-128">A instalação lado a lado não registra globalmente o assembly, o instalador ignora o registro automático do componente se alguma informação de auto-registro tiver sido inserida na [tabela selfreg](selfreg-table.md).</span><span class="sxs-lookup"><span data-stu-id="f8abd-128">Side-by-side installation does not globally register the assembly, the installer skips self-registering the component if any self-registration information has been entered in the [SelfReg table](selfreg-table.md).</span></span> <span data-ttu-id="f8abd-129">As informações de Autoregistro podem ser inseridas na tabela SelfReg para o registro automático do componente em sistemas que não dão suporte ao compartilhamento de assembly lado a lado.</span><span class="sxs-lookup"><span data-stu-id="f8abd-129">Self-registration information may be entered into the SelfReg table for self-registration of the component on systems that do not support side-by-side assembly sharing.</span></span>
5.  <span data-ttu-id="f8abd-130">Adicione outras informações de registro, exclusivas de associação e ativação ou Autoregistro do componente, à tabela [do registro](registry-table.md), à [tabela RemoveRegistry](removeregistry-table.md)e à [tabela de ambiente](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="f8abd-130">Add any other registry information, exclusive of binding and activation or self-registration of the component, to the [Registry table](registry-table.md), [RemoveRegistry table](removeregistry-table.md), and [Environment table](environment-table.md).</span></span>
6.  <span data-ttu-id="f8abd-131">Como esse é um assembly compartilhado, não gere um arquivo. local.</span><span class="sxs-lookup"><span data-stu-id="f8abd-131">Because this is a shared assembly do not generate a .local file.</span></span> <span data-ttu-id="f8abd-132">Não inclua informações para este componente na [tabela IsolatedComponent](isolatedcomponent-table.md).</span><span class="sxs-lookup"><span data-stu-id="f8abd-132">Do not include information for this component in the [IsolatedComponent table](isolatedcomponent-table.md).</span></span> <span data-ttu-id="f8abd-133">O instalador ignora a tabela IsolatedComponent para esse componente em sistemas operacionais que dão suporte ao compartilhamento lado a lado.</span><span class="sxs-lookup"><span data-stu-id="f8abd-133">The installer skips the IsolatedComponent table for this component on operating systems that support side-by-side sharing.</span></span> <span data-ttu-id="f8abd-134">Adicione informações à tabela IsolatedComponent se desejar que o assembly seja privado em sistemas que dão suporte a arquivos. local.</span><span class="sxs-lookup"><span data-stu-id="f8abd-134">Add information to the IsolatedComponent table if you would like the assembly to be private on systems that support .local files.</span></span>
7.  <span data-ttu-id="f8abd-135">Para habilitar o compartilhamento lado a lado, o assembly do Win32 deve ser instalado na pasta WinSxS.</span><span class="sxs-lookup"><span data-stu-id="f8abd-135">To enable side-by-side sharing, the Win32 assembly must be installed into the Winsxs folder.</span></span> <span data-ttu-id="f8abd-136">Isso é feito deixando a \_ coluna de aplicativo de arquivo da [tabela MsiAssembly](msiassembly-table.md) nula para o assembly.</span><span class="sxs-lookup"><span data-stu-id="f8abd-136">This is accomplished by leaving the File\_Application column of the [MsiAssembly table](msiassembly-table.md) null for the assembly.</span></span> <span data-ttu-id="f8abd-137">Isso informa o instalador para instalar o assembly na pasta WinSxS, em vez de na pasta do componente.</span><span class="sxs-lookup"><span data-stu-id="f8abd-137">This tells the installer to install the assembly to the WinSxS folder, instead of to the folder of the component.</span></span> <span data-ttu-id="f8abd-138">Adicione uma linha à [tabela MsiAssembly](msiassembly-table.md) para o componente que contém o assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="f8abd-138">Add a row to the [MsiAssembly table](msiassembly-table.md) for the component that contains the Win32 assembly.</span></span> <span data-ttu-id="f8abd-139">Insira um valor de 1 no campo atributos da tabela MsiAssembly para especificar que este é um assembly Win32.</span><span class="sxs-lookup"><span data-stu-id="f8abd-139">Enter a value of 1 in the Attributes field of the MsiAssembly table to specify that this is a Win32 assembly.</span></span> <span data-ttu-id="f8abd-140">Para um assembly compartilhado, deixe o \_ campo aplicativo de arquivo vazio.</span><span class="sxs-lookup"><span data-stu-id="f8abd-140">For a shared assembly, leave the File\_Application field empty.</span></span> <span data-ttu-id="f8abd-141">Adicione a [ação MsiPublishAssemblies](msipublishassemblies-action.md) à [tabela InstallExecuteSequence](installexecutesequence-table.md) ou à [tabela AdvtExecuteSequence](advtexecutesequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="f8abd-141">Add the [MsiPublishAssemblies action](msipublishassemblies-action.md) to the [InstallExecuteSequence table](installexecutesequence-table.md) or [AdvtExecuteSequence table](advtexecutesequence-table.md).</span></span> <span data-ttu-id="f8abd-142">Adicione a [ação MsiUnpublishAssemblies](msiunpublishassemblies-action.md) à tabela InstallExecuteSequence.</span><span class="sxs-lookup"><span data-stu-id="f8abd-142">Add the [MsiUnpublishAssemblies action](msiunpublishassemblies-action.md) to the InstallExecuteSequence table.</span></span>
8.  <span data-ttu-id="f8abd-143">Adicione linhas à [tabela MsiAssemblyName](msiassemblyname-table.md) para o componente.</span><span class="sxs-lookup"><span data-stu-id="f8abd-143">Add rows to the [MsiAssemblyName table](msiassemblyname-table.md) for the component.</span></span> <span data-ttu-id="f8abd-144">Adicione uma linha para cada par de nome e valor especificado na seção assemblyIdentity do manifesto.</span><span class="sxs-lookup"><span data-stu-id="f8abd-144">Add one row for each name and value pair specified in the assemblyIdentity section of the manifest.</span></span> <span data-ttu-id="f8abd-145">Para obter um exemplo, consulte [tabela MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="f8abd-145">For an example, see [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

 

 



