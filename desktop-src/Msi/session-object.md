---
description: O objeto de sessão controla o processo de instalação.
ms.assetid: 013959d9-900c-45f7-b742-17b0365d6107
title: Objeto Session (Windows Installer)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Session
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: c391249d5ccc58fe9a947c9db761a77521c9776d
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/22/2021
ms.locfileid: "105750595"
---
# <a name="session-object-windows-installer"></a><span data-ttu-id="a74f7-103">Objeto Session (Windows Installer)</span><span class="sxs-lookup"><span data-stu-id="a74f7-103">Session object (Windows Installer)</span></span>

<span data-ttu-id="a74f7-104">O objeto de **sessão** controla o processo de instalação.</span><span class="sxs-lookup"><span data-stu-id="a74f7-104">The **Session** object controls the installation process.</span></span> <span data-ttu-id="a74f7-105">Ele abre o banco de dados do instalador, que contém as tabelas de instalação e os dados.</span><span class="sxs-lookup"><span data-stu-id="a74f7-105">It opens the Installer database, which contains the installation tables and data.</span></span> <span data-ttu-id="a74f7-106">Esse objeto é associado a um conjunto padrão de funções de ação, cada um executando operações específicas em dados de uma ou mais tabelas.</span><span class="sxs-lookup"><span data-stu-id="a74f7-106">This object is associated with a standard set of action functions, each performing particular operations on data from one or more tables.</span></span> <span data-ttu-id="a74f7-107">Ações personalizadas adicionais podem ser adicionadas para instalações de produtos específicas.</span><span class="sxs-lookup"><span data-stu-id="a74f7-107">Additional custom actions may be added for particular product installations.</span></span> <span data-ttu-id="a74f7-108">A função de mecanismo básica é um sequenciador que busca registros sequenciais de uma tabela de sequência designada, avalia qualquer expressão de condição especificada e executa a ação designada.</span><span class="sxs-lookup"><span data-stu-id="a74f7-108">The basic engine function is a sequencer that fetches sequential records from a designated sequence table, evaluates any specified condition expression, and executes the designated action.</span></span> <span data-ttu-id="a74f7-109">As ações não reconhecidas pelo mecanismo são adiadas para o objeto manipulador de interface do usuário para processamento, geralmente sequências de caixas de diálogo.</span><span class="sxs-lookup"><span data-stu-id="a74f7-109">Actions not recognized by the engine are deferred to the UI handler object for processing, usually dialog box sequences.</span></span>

<span data-ttu-id="a74f7-110">Observe que apenas um objeto de **sessão** pode ser aberto por um único processo.</span><span class="sxs-lookup"><span data-stu-id="a74f7-110">Note that only one **Session** object can be opened by a single process.</span></span>

## <a name="members"></a><span data-ttu-id="a74f7-111">Membros</span><span class="sxs-lookup"><span data-stu-id="a74f7-111">Members</span></span>

<span data-ttu-id="a74f7-112">O objeto de **sessão** tem estes tipos de membros:</span><span class="sxs-lookup"><span data-stu-id="a74f7-112">The **Session** object has these types of members:</span></span>

-   [<span data-ttu-id="a74f7-113">Métodos</span><span class="sxs-lookup"><span data-stu-id="a74f7-113">Methods</span></span>](#methods)
-   [<span data-ttu-id="a74f7-114">Propriedades</span><span class="sxs-lookup"><span data-stu-id="a74f7-114">Properties</span></span>](#properties)

### <a name="methods"></a><span data-ttu-id="a74f7-115">Métodos</span><span class="sxs-lookup"><span data-stu-id="a74f7-115">Methods</span></span>

<span data-ttu-id="a74f7-116">O objeto de **sessão** tem esses métodos.</span><span class="sxs-lookup"><span data-stu-id="a74f7-116">The **Session** object has these methods.</span></span>



| <span data-ttu-id="a74f7-117">Método</span><span class="sxs-lookup"><span data-stu-id="a74f7-117">Method</span></span>                                                 | <span data-ttu-id="a74f7-118">Descrição</span><span class="sxs-lookup"><span data-stu-id="a74f7-118">Description</span></span>                                                                                                                                                                                                                                                               |
|:-------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a74f7-119">**DoAction**</span><span class="sxs-lookup"><span data-stu-id="a74f7-119">**DoAction**</span></span>](session-doaction.md)                   | <span data-ttu-id="a74f7-120">Executa a ação especificada.</span><span class="sxs-lookup"><span data-stu-id="a74f7-120">Executes the specified action.</span></span> <br/>                                                                                                                                                                                                                                |
| [<span data-ttu-id="a74f7-121">**EvaluateCondition**</span><span class="sxs-lookup"><span data-stu-id="a74f7-121">**EvaluateCondition**</span></span>](session-evaluatecondition.md) | <span data-ttu-id="a74f7-122">Avalia uma expressão lógica que contém símbolos e valores e retorna um inteiro do msiEvaluateConditionErrorEnum de enumeração.</span><span class="sxs-lookup"><span data-stu-id="a74f7-122">Evaluates a logical expression containing symbols and values and returns an integer of the enumeration msiEvaluateConditionErrorEnum.</span></span><br/>                                                                                                                          |
| [<span data-ttu-id="a74f7-123">**FeatureInfo**</span><span class="sxs-lookup"><span data-stu-id="a74f7-123">**FeatureInfo**</span></span>](session-featureinfo.md)             | <span data-ttu-id="a74f7-124">Retorna um objeto [**FeatureInfo**](featureinfo-object.md) contendo informações descritivas para o recurso especificado.</span><span class="sxs-lookup"><span data-stu-id="a74f7-124">Returns a [**FeatureInfo**](featureinfo-object.md) object containing descriptive information for the specified feature.</span></span><br/>                                                                                                                                       |
| [<span data-ttu-id="a74f7-125">**FormatRecord**</span><span class="sxs-lookup"><span data-stu-id="a74f7-125">**FormatRecord**</span></span>](session-formatrecord.md)           | <span data-ttu-id="a74f7-126">Retorna uma cadeia de caracteres formatada de dados de modelo e registro.</span><span class="sxs-lookup"><span data-stu-id="a74f7-126">Returns a formatted string from template and record data.</span></span><br/>                                                                                                                                                                                                      |
| [<span data-ttu-id="a74f7-127">**Mensagem**</span><span class="sxs-lookup"><span data-stu-id="a74f7-127">**Message**</span></span>](session-message.md)                     | <span data-ttu-id="a74f7-128">Executa qualquer operação de registro em log habilitada e adia a execução para o objeto manipulador de interface do usuário associado ao mecanismo.</span><span class="sxs-lookup"><span data-stu-id="a74f7-128">Performs any enabled logging operations and defers execution to the UI handler object associated with the engine.</span></span><br/>                                                                                                                                              |
| [<span data-ttu-id="a74f7-129">**Ordem**</span><span class="sxs-lookup"><span data-stu-id="a74f7-129">**Sequence**</span></span>](session-sequence.md)                   | <span data-ttu-id="a74f7-130">Abre uma consulta na tabela especificada, ordenando as ações pelos números na coluna sequence.</span><span class="sxs-lookup"><span data-stu-id="a74f7-130">Opens a query on the specified table, ordering the actions by the numbers in the Sequence column.</span></span> <span data-ttu-id="a74f7-131">Para cada linha buscada, o método [**DoAction**](session-doaction.md) é chamado, desde que qualquer expressão de condição fornecida não seja avaliada como false.</span><span class="sxs-lookup"><span data-stu-id="a74f7-131">For each row fetched, the [**DoAction**](session-doaction.md) method is called, provided that any supplied condition expression does not evaluate to False.</span></span><br/> |
| [<span data-ttu-id="a74f7-132">**SetInstallLevel**</span><span class="sxs-lookup"><span data-stu-id="a74f7-132">**SetInstallLevel**</span></span>](session-setinstalllevel.md)     | <span data-ttu-id="a74f7-133">Define o nível de instalação da instalação atual para um valor especificado e recalcula os Estados Select e installed para todos os recursos.</span><span class="sxs-lookup"><span data-stu-id="a74f7-133">Sets the install level for the current installation to a specified value and recalculates the Select and Installed states for all features.</span></span><br/>                                                                                                                    |



 

### <a name="properties"></a><span data-ttu-id="a74f7-134">Propriedades</span><span class="sxs-lookup"><span data-stu-id="a74f7-134">Properties</span></span>

<span data-ttu-id="a74f7-135">O objeto de **sessão** tem essas propriedades.</span><span class="sxs-lookup"><span data-stu-id="a74f7-135">The **Session** object has these properties.</span></span>



| <span data-ttu-id="a74f7-136">Propriedade</span><span class="sxs-lookup"><span data-stu-id="a74f7-136">Property</span></span>                                                                  | <span data-ttu-id="a74f7-137">Tipo de acesso</span><span class="sxs-lookup"><span data-stu-id="a74f7-137">Access type</span></span>           | <span data-ttu-id="a74f7-138">Descrição</span><span class="sxs-lookup"><span data-stu-id="a74f7-138">Description</span></span>                                                                                                                                                                |
|:--------------------------------------------------------------------------|:----------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="a74f7-139">**ComponentCosts**</span><span class="sxs-lookup"><span data-stu-id="a74f7-139">**ComponentCosts**</span></span>](session-componentcosts.md)<br/>               |                       | <span data-ttu-id="a74f7-140">Retorna um objeto [**recordlist**](recordlist-object.md) que enumera o espaço em disco por unidade necessário para instalar um componente.</span><span class="sxs-lookup"><span data-stu-id="a74f7-140">Returns a [**RecordList**](recordlist-object.md) object enumerating the disk space per drive required to install a component.</span></span><br/>                                  |
| [<span data-ttu-id="a74f7-141">**ComponentCurrentState**</span><span class="sxs-lookup"><span data-stu-id="a74f7-141">**ComponentCurrentState**</span></span>](session-componentcurrentstate.md)<br/> |                       | <span data-ttu-id="a74f7-142">Retorna o estado atual instalado do componente designado.</span><span class="sxs-lookup"><span data-stu-id="a74f7-142">Returns the current installed state of the designated component.</span></span><br/>                                                                                                |
| [<span data-ttu-id="a74f7-143">**ComponentRequestState**</span><span class="sxs-lookup"><span data-stu-id="a74f7-143">**ComponentRequestState**</span></span>](session-componentrequeststate.md)<br/> |                       | <span data-ttu-id="a74f7-144">Obtém ou solicita uma alteração no estado de ação de uma linha na tabela de componentes.</span><span class="sxs-lookup"><span data-stu-id="a74f7-144">Obtains or requests a change in the Action state of a row in the Component table.</span></span><br/>                                                                               |
| [<span data-ttu-id="a74f7-145">**Backup de banco de dados**</span><span class="sxs-lookup"><span data-stu-id="a74f7-145">**Database**</span></span>](session-database.md)<br/>                           |                       | <span data-ttu-id="a74f7-146">Retorna o banco de dados para a sessão de instalação atual.</span><span class="sxs-lookup"><span data-stu-id="a74f7-146">Returns the database for the current installation session.</span></span><br/>                                                                                                      |
| [<span data-ttu-id="a74f7-147">**FeatureCost**</span><span class="sxs-lookup"><span data-stu-id="a74f7-147">**FeatureCost**</span></span>](session-featurecost.md)<br/>                     |                       | <span data-ttu-id="a74f7-148">Retorna a quantidade total de espaço em disco (em unidades de 512 bytes) exigida pelo recurso especificado e seus recursos pai (até a raiz da tabela de recursos).</span><span class="sxs-lookup"><span data-stu-id="a74f7-148">Returns the total amount of disk space (in units of 512 bytes) required by the specified feature and its parent features (up to the root of the Feature table).</span></span><br/> |
| [<span data-ttu-id="a74f7-149">**FeatureCurrentState**</span><span class="sxs-lookup"><span data-stu-id="a74f7-149">**FeatureCurrentState**</span></span>](session-featurecurrentstate.md)<br/>     |                       | <span data-ttu-id="a74f7-150">Retorna o estado atual instalado do recurso designado.</span><span class="sxs-lookup"><span data-stu-id="a74f7-150">Returns the current installed state of the designated feature.</span></span><br/>                                                                                                  |
| [<span data-ttu-id="a74f7-151">**FeatureRequestState**</span><span class="sxs-lookup"><span data-stu-id="a74f7-151">**FeatureRequestState**</span></span>](session-featurerequeststate.md)<br/>     | <span data-ttu-id="a74f7-152">Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="a74f7-152">Read/write</span></span><br/> | <span data-ttu-id="a74f7-153">Obtém ou solicita uma alteração no estado de seleção do registro e dos subregistros de um recurso.</span><span class="sxs-lookup"><span data-stu-id="a74f7-153">Obtains or requests a change in the Select state of a feature's record and subrecords.</span></span><br/>                                                                          |
| [<span data-ttu-id="a74f7-154">**FeatureValidStates**</span><span class="sxs-lookup"><span data-stu-id="a74f7-154">**FeatureValidStates**</span></span>](session-featurevalidstates.md)<br/>       |                       | <span data-ttu-id="a74f7-155">Retorna um inteiro que representa os sinalizadores de bit com cada bit relevante que representa um estado de instalação válido para o recurso especificado.</span><span class="sxs-lookup"><span data-stu-id="a74f7-155">Returns an integer representing bit flags with each relevant bit representing a valid installation state for the specified feature.</span></span><br/>                             |
| [<span data-ttu-id="a74f7-156">**Instalador**</span><span class="sxs-lookup"><span data-stu-id="a74f7-156">**Installer**</span></span>](session-installer.md)<br/>                         |                       | <span data-ttu-id="a74f7-157">Retorna o objeto do instalador ativo.</span><span class="sxs-lookup"><span data-stu-id="a74f7-157">Returns the active installer object.</span></span><br/>                                                                                                                            |
| [<span data-ttu-id="a74f7-158">**Idioma (objeto de sessão)**</span><span class="sxs-lookup"><span data-stu-id="a74f7-158">**Language (Session Object)**</span></span>](session-language.md)<br/>          |                       | <span data-ttu-id="a74f7-159">Representa o identificador de idioma numérico usado pela sessão de instalação atual.</span><span class="sxs-lookup"><span data-stu-id="a74f7-159">Represents the numeric language identifier used by the current installation session.</span></span><br/>                                                                            |
| [<span data-ttu-id="a74f7-160">**Mode**</span><span class="sxs-lookup"><span data-stu-id="a74f7-160">**Mode**</span></span>](session-mode.md)<br/>                                   |                       | <span data-ttu-id="a74f7-161">Essa propriedade é um valor que representa o sinalizador de modo designado para a sessão de instalação atual.</span><span class="sxs-lookup"><span data-stu-id="a74f7-161">This property is a value representing the designated mode flag for the current installation session.</span></span><br/>                                                            |
| [<span data-ttu-id="a74f7-162">**Produtoproperty**</span><span class="sxs-lookup"><span data-stu-id="a74f7-162">**ProductProperty**</span></span>](session-productproperty.md)<br/>             |                       | <span data-ttu-id="a74f7-163">Representa o valor da cadeia de caracteres de uma propriedade do instalador nomeada.</span><span class="sxs-lookup"><span data-stu-id="a74f7-163">Represents the string value of a named installer property.</span></span><br/>                                                                                                      |
| [<span data-ttu-id="a74f7-164">**Propriedade (objeto Session)**</span><span class="sxs-lookup"><span data-stu-id="a74f7-164">**Property (Session Object)**</span></span>](session-session.md)<br/>           | <span data-ttu-id="a74f7-165">Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="a74f7-165">Read/write</span></span><br/> | <span data-ttu-id="a74f7-166">Recupera as propriedades do produto do banco de dados do produto.</span><span class="sxs-lookup"><span data-stu-id="a74f7-166">Retrieves product properties from the product database.</span></span><br/>                                                                                                         |
| [<span data-ttu-id="a74f7-167">**SourcePath**</span><span class="sxs-lookup"><span data-stu-id="a74f7-167">**SourcePath**</span></span>](session-sourcepath.md)<br/>                       |                       | <span data-ttu-id="a74f7-168">Fornece o caminho completo para a pasta designada na imagem de mídia ou do servidor de origem.</span><span class="sxs-lookup"><span data-stu-id="a74f7-168">Provides the full path to the designated folder on the source media or server image.</span></span><br/>                                                                            |
| [<span data-ttu-id="a74f7-169">**TargetPath**</span><span class="sxs-lookup"><span data-stu-id="a74f7-169">**TargetPath**</span></span>](session-targetpath.md)<br/>                       | <span data-ttu-id="a74f7-170">Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="a74f7-170">Read/write</span></span><br/> | <span data-ttu-id="a74f7-171">Fornece o caminho completo para a pasta designada na unidade de destino da instalação.</span><span class="sxs-lookup"><span data-stu-id="a74f7-171">Provides the full path to the designated folder on the installation target drive.</span></span><br/>                                                                               |
| [<span data-ttu-id="a74f7-172">**VerifyDiskSpace**</span><span class="sxs-lookup"><span data-stu-id="a74f7-172">**VerifyDiskSpace**</span></span>](session-verifydiskspace.md)<br/>             |                       | <span data-ttu-id="a74f7-173">Retornará true se houver espaço em disco suficiente e false se o disco estiver cheio.</span><span class="sxs-lookup"><span data-stu-id="a74f7-173">Returns true if enough disk space exists, and false if the disk is full.</span></span><br/>                                                                                        |



 

## <a name="requirements"></a><span data-ttu-id="a74f7-174">Requisitos</span><span class="sxs-lookup"><span data-stu-id="a74f7-174">Requirements</span></span>



| <span data-ttu-id="a74f7-175">Requisito</span><span class="sxs-lookup"><span data-stu-id="a74f7-175">Requirement</span></span> | <span data-ttu-id="a74f7-176">Valor</span><span class="sxs-lookup"><span data-stu-id="a74f7-176">Value</span></span> |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a74f7-177">Versão</span><span class="sxs-lookup"><span data-stu-id="a74f7-177">Version</span></span><br/> | <span data-ttu-id="a74f7-178">Windows Installer 5,0 no Windows Server 2012, Windows 8, Windows Server 2008 R2 ou Windows 7.</span><span class="sxs-lookup"><span data-stu-id="a74f7-178">Windows Installer 5.0 on Windows Server 2012, Windows 8, Windows Server 2008 R2 or Windows 7.</span></span> <span data-ttu-id="a74f7-179">Windows Installer 4,0 ou Windows Installer 4,5 no Windows Server 2008 ou no Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="a74f7-179">Windows Installer 4.0 or Windows Installer 4.5 on Windows Server 2008 or Windows Vista.</span></span> <span data-ttu-id="a74f7-180">Windows Installer no Windows Server 2003 ou no Windows XP</span><span class="sxs-lookup"><span data-stu-id="a74f7-180">Windows Installer on Windows Server 2003 or Windows XP</span></span><br/> |
| <span data-ttu-id="a74f7-181">DLL</span><span class="sxs-lookup"><span data-stu-id="a74f7-181">DLL</span></span><br/>     | <dl> <span data-ttu-id="a74f7-182"><dt>Msi.dll</dt></span><span class="sxs-lookup"><span data-stu-id="a74f7-182"><dt>Msi.dll</dt></span></span> </dl>                                                                                                                                                                      |
| <span data-ttu-id="a74f7-183">IID</span><span class="sxs-lookup"><span data-stu-id="a74f7-183">IID</span></span><br/>     | <span data-ttu-id="a74f7-184">IID \_ ISession é definido como 000C109E-0000-0000-C000-000000000046</span><span class="sxs-lookup"><span data-stu-id="a74f7-184">IID\_ISession is defined as 000C109E-0000-0000-C000-000000000046</span></span><br/>                                                                                                                                                                             |



## <a name="see-also"></a><span data-ttu-id="a74f7-185">Confira também</span><span class="sxs-lookup"><span data-stu-id="a74f7-185">See also</span></span>

<dl> <dt>

[<span data-ttu-id="a74f7-186">Exemplos de script de Windows Installer</span><span class="sxs-lookup"><span data-stu-id="a74f7-186">Windows Installer Scripting Examples</span></span>](windows-installer-scripting-examples.md)
</dt> </dl>

 

 




