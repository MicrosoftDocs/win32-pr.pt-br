---
description: As ações personalizadas são agendadas em tabelas de sequência da mesma forma que as ações padrão.
ms.assetid: 1aea75b1-a498-405e-9208-91672455496b
title: Sequência de ações personalizadas de sequenciamento
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ad7c24fb91247a36880cb808c9b8e10437312cf7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104172005"
---
# <a name="sequencing-custom-actions"></a><span data-ttu-id="31e56-103">Sequência de ações personalizadas de sequenciamento</span><span class="sxs-lookup"><span data-stu-id="31e56-103">Sequencing Custom Actions</span></span>

<span data-ttu-id="31e56-104">As ações personalizadas são agendadas em tabelas de sequência da mesma forma que as ações padrão.</span><span class="sxs-lookup"><span data-stu-id="31e56-104">Custom actions are scheduled in sequence tables in the same way as standard actions.</span></span>

<span data-ttu-id="31e56-105">**Para agendar uma ação personalizada em uma tabela de sequência**</span><span class="sxs-lookup"><span data-stu-id="31e56-105">**To schedule a custom action in a sequence table**</span></span>

1.  <span data-ttu-id="31e56-106">Insira o nome da ação personalizada (que é a chave primária da tabela [CustomAction](customaction-table.md)) na coluna ação da tabela de [sequência](sequence-table-detailed-example.md) .</span><span class="sxs-lookup"><span data-stu-id="31e56-106">Enter the custom action name (which is the primary key of the [CustomAction](customaction-table.md)) table into the Action column of the [Sequence](sequence-table-detailed-example.md) table.</span></span>
2.  <span data-ttu-id="31e56-107">Insira a sequência da ação personalizada em relação às outras ações na tabela na coluna sequência da tabela de [sequência](sequence-table-detailed-example.md) .</span><span class="sxs-lookup"><span data-stu-id="31e56-107">Enter the custom action's sequence relative to the other actions in the table into the Sequence column of the [Sequence](sequence-table-detailed-example.md) table.</span></span> <span data-ttu-id="31e56-108">Para obter mais informações sobre tabelas de sequência, consulte [usando uma tabela de sequência](using-a-sequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="31e56-108">For more information about sequence tables, see [Using a Sequence Table](using-a-sequence-table.md).</span></span>
3.  <span data-ttu-id="31e56-109">Para ignorar condicionalmente a ação, insira uma expressão condicional na coluna condição da tabela de [sequência](sequence-table-detailed-example.md) .</span><span class="sxs-lookup"><span data-stu-id="31e56-109">To conditionally skip the action, enter a conditional expression into the Condition column of the [Sequence](sequence-table-detailed-example.md) table.</span></span> <span data-ttu-id="31e56-110">O instalador ignorará essa ação se a expressão for avaliada como FALSE.</span><span class="sxs-lookup"><span data-stu-id="31e56-110">The installer skips this action if the expression evaluates to FALSE.</span></span>

<span data-ttu-id="31e56-111">Como no caso de ações padrão, as ações personalizadas que estão agendadas no [InstallUISequence](installuisequence-table.md) ou [AdminUISequence](adminuisequence-table.md) serão executadas somente se a interface do usuário interna estiver definida como o nível completo.</span><span class="sxs-lookup"><span data-stu-id="31e56-111">As in the case of standard actions, custom actions that are scheduled in the [InstallUISequence](installuisequence-table.md) or [AdminUISequence](adminuisequence-table.md) run only if the internal user interface is set to the full level.</span></span> <span data-ttu-id="31e56-112">O nível da interface do usuário é definido usando a função [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui) .</span><span class="sxs-lookup"><span data-stu-id="31e56-112">The UI level is set by using the [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui) function.</span></span>

<span data-ttu-id="31e56-113">As ações padrão e personalizada agendadas nas tabelas [InstallExecuteSequence](installexecutesequence-table.md), [AdminExecuteSequence](adminexecutesequence-table.md)ou [AdvtExecuteSequence](advtexecutesequence-table.md) não fazem alterações no sistema.</span><span class="sxs-lookup"><span data-stu-id="31e56-113">Standard and custom actions scheduled in the [InstallExecuteSequence](installexecutesequence-table.md), [AdminExecuteSequence](adminexecutesequence-table.md), or [AdvtExecuteSequence](advtexecutesequence-table.md) tables do not make system changes.</span></span> <span data-ttu-id="31e56-114">Em vez disso, o instalador enfileira registros de execução em um script para execução subsequente durante o serviço de instalação.</span><span class="sxs-lookup"><span data-stu-id="31e56-114">Instead the installer queues up execution records in a script for subsequent execution during the install service.</span></span> <span data-ttu-id="31e56-115">Se não houver nenhum serviço de instalação, as ações agendadas nessas tabelas serão executadas no mesmo contexto da sequência da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="31e56-115">If there is no install service, then the actions scheduled in these tables are run in the same context as the UI sequence.</span></span>

<span data-ttu-id="31e56-116">Se o servidor do instalador não estiver registrado, as ações personalizadas serão executadas no lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="31e56-116">If the installer server is not registered, the custom actions are executed on the client side.</span></span> <span data-ttu-id="31e56-117">Se o servidor estiver registrado e usando o modo de interface do usuário completo, as ações personalizadas serão executadas no lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="31e56-117">If the server is registered and using the full UI mode, then the custom actions are run on the server side.</span></span>

<span data-ttu-id="31e56-118">Se estiver usando a interface do usuário completa com o servidor, as ações iniciais anteriores à ação [InstallValidate](installvalidate-action.md) serão executadas no cliente para permitir a interação total.</span><span class="sxs-lookup"><span data-stu-id="31e56-118">If using full UI with the server, the initial actions prior to the [InstallValidate](installvalidate-action.md) action are run on the client to allow full interaction.</span></span> <span data-ttu-id="31e56-119">Em seguida, a execução é alternada para o servidor que repete essas ações e executa as ações de execução de script.</span><span class="sxs-lookup"><span data-stu-id="31e56-119">Execution is then switched to the server which repeats those actions and runs the script execution actions.</span></span> <span data-ttu-id="31e56-120">Isso é seguido por um retorno ao cliente para as ações finais.</span><span class="sxs-lookup"><span data-stu-id="31e56-120">This is followed by a return to the client for the final actions.</span></span>

<span data-ttu-id="31e56-121">Observe que, se um produto for removido definindo seu principal recurso como ausente, a propriedade [**Remove**](remove.md) poderá não ser igual a All após a ação [InstallValidate](installvalidate-action.md) .</span><span class="sxs-lookup"><span data-stu-id="31e56-121">Note that if a product is removed by setting its top feature to absent, the [**REMOVE**](remove.md) property may not equal ALL until after the [InstallValidate](installvalidate-action.md) action.</span></span> <span data-ttu-id="31e56-122">Isso significa que qualquer ação personalizada que dependa de REMOVE = ALL deve ser sequenciada após a ação InstallValidate.</span><span class="sxs-lookup"><span data-stu-id="31e56-122">This means that any custom action that depends on REMOVE=ALL must be sequenced after the InstallValidate action.</span></span> <span data-ttu-id="31e56-123">Uma ação personalizada pode verificar remover para determinar se um produto foi definido para ser completamente desinstalado.</span><span class="sxs-lookup"><span data-stu-id="31e56-123">A custom action may check REMOVE to determine whether a product has been set to be completely uninstalled.</span></span>

<span data-ttu-id="31e56-124">As ações personalizadas que fazem referência a um arquivo instalado como sua fonte, como o tipo de ação personalizada 17 (DLL), o tipo de ação personalizada 18 (EXE), o tipo de ação personalizada 21 (JScript) e o tipo de ação personalizada 22 (VBScript), devem aderir às seguintes restrições de sequenciamento.</span><span class="sxs-lookup"><span data-stu-id="31e56-124">Custom actions that reference an installed file as their source, such as Custom Action Type 17 (DLL), Custom Action Type 18 (EXE), Custom Action Type 21 (JScript), and Custom Action Type 22 (VBScript), must adhere to the following sequencing restrictions.</span></span>

-   <span data-ttu-id="31e56-125">A ação personalizada deve ser sequenciada após a ação [CostFinalize](costfinalize-action.md) para que o caminho para o arquivo referenciado possa ser resolvido.</span><span class="sxs-lookup"><span data-stu-id="31e56-125">The custom action must be sequenced after the [CostFinalize](costfinalize-action.md) action so that the path to the referenced file can be resolved.</span></span>
-   <span data-ttu-id="31e56-126">Se o arquivo de origem ainda não estiver instalado no computador, as ações personalizadas adiadas (em script) deverão ser sequenciadas após o [InstallFiles](installfiles-action.md).</span><span class="sxs-lookup"><span data-stu-id="31e56-126">If the source file is not already installed on the computer, deferred (in-script) custom actions must be sequenced after the [InstallFiles](installfiles-action.md).</span></span>
-   <span data-ttu-id="31e56-127">Se o arquivo de origem ainda não estiver instalado no computador, as ações personalizadas do nondeferred deverão ser sequenciadas após a ação [InstallInitialize](installinitialize-action.md) .</span><span class="sxs-lookup"><span data-stu-id="31e56-127">If the source file is not already installed on the computer, nondeferred custom actions must be sequenced after the [InstallInitialize](installinitialize-action.md) action.</span></span>

<span data-ttu-id="31e56-128">As restrições de sequenciamento a seguir se aplicam a ações personalizadas que alteram ou atualizam um pacote de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="31e56-128">The following sequencing restrictions apply to custom actions that change or update a Windows Installer package.</span></span>

-   <span data-ttu-id="31e56-129">Se a ação personalizada alterar o pacote, como ao adicionar linhas a uma tabela, a ação deverá ser sequenciada antes da ação [InstallInitialize](installinitialize-action.md) .</span><span class="sxs-lookup"><span data-stu-id="31e56-129">If the custom action changes the package, such as by adding rows to a table, the action must be sequenced before the [InstallInitialize](installinitialize-action.md) action.</span></span>
-   <span data-ttu-id="31e56-130">Se a ação personalizada fizer alterações que afetem o custo, elas deverão ser sequenciadas antes da ação [CostInitialize](costfinalize-action.md) .</span><span class="sxs-lookup"><span data-stu-id="31e56-130">If the custom action makes changes that would affect costing, then it should be sequenced before the [CostInitialize](costfinalize-action.md) action.</span></span>
-   <span data-ttu-id="31e56-131">Se a ação personalizada alterar o estado de instalação de recursos ou componentes, ela deverá ser sequenciada antes da ação [InstallValidate](installvalidate-action.md) .</span><span class="sxs-lookup"><span data-stu-id="31e56-131">If the custom action changes the installation state of features or components, it must be sequenced before the [InstallValidate](installvalidate-action.md) action.</span></span>

 

 



