---
description: Este material destina-se a desenvolvedores que estão escrevendo seus próprios programas de instalação e desenvolvedores que desejam saber mais sobre as tabelas de banco de dados do instalador. Para obter informações gerais sobre o instalador, consulte sobre o Windows Installer.
ms.assetid: 95516437-9708-4f4e-a5c2-7bcd4741c776
title: Funções de banco de dados
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e4a4233437d24944c8bb7fe5c7de6412e700022b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103647474"
---
# <a name="database-functions"></a><span data-ttu-id="de44d-104">Funções de banco de dados</span><span class="sxs-lookup"><span data-stu-id="de44d-104">Database Functions</span></span>

<span data-ttu-id="de44d-105">Este material destina-se a desenvolvedores que estão escrevendo seus próprios programas de instalação e desenvolvedores que desejam saber mais sobre as tabelas de banco de dados do instalador.</span><span class="sxs-lookup"><span data-stu-id="de44d-105">This material is intended for developers who are writing their own setup programs and developers who want to learn more about the installer database tables.</span></span> <span data-ttu-id="de44d-106">Para obter informações gerais sobre o instalador, consulte [sobre o Windows Installer](about-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="de44d-106">For general information on the installer, see [About Windows Installer](about-windows-installer.md).</span></span>

<span data-ttu-id="de44d-107">Você pode usar as funções de acesso do instalador para acessar o banco de dados e o processo de instalação.</span><span class="sxs-lookup"><span data-stu-id="de44d-107">You can use the installer access functions to access the database and the installation process.</span></span> <span data-ttu-id="de44d-108">Essas funções só devem ser usadas por ações de instalação personalizadas e por ferramentas de criação.</span><span class="sxs-lookup"><span data-stu-id="de44d-108">These functions should only be used by custom installation actions and authoring tools.</span></span> <span data-ttu-id="de44d-109">Algumas das funções de acesso do instalador exigem cadeias de caracteres de consulta SQL para consultar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="de44d-109">Some of the installer access functions require SQL query strings for querying the database.</span></span> <span data-ttu-id="de44d-110">As consultas devem aderir à sintaxe do instalador [SQL](sql-syntax.md).</span><span class="sxs-lookup"><span data-stu-id="de44d-110">Queries must adhere to the installer [SQL syntax](sql-syntax.md).</span></span>

<span data-ttu-id="de44d-111">Este tópico lista as funções de acesso ao banco de dados do instalador por categoria.</span><span class="sxs-lookup"><span data-stu-id="de44d-111">This topic lists the installer database access functions by category.</span></span>

## <a name="general-database-access-functions"></a><span data-ttu-id="de44d-112">Funções gerais de acesso ao banco de dados</span><span class="sxs-lookup"><span data-stu-id="de44d-112">General Database Access Functions</span></span>



| <span data-ttu-id="de44d-113">Função</span><span class="sxs-lookup"><span data-stu-id="de44d-113">Function</span></span>                                                             | <span data-ttu-id="de44d-114">Descrição</span><span class="sxs-lookup"><span data-stu-id="de44d-114">Description</span></span>                                                                             |
|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [<span data-ttu-id="de44d-115">**MsiDatabaseCommit**</span><span class="sxs-lookup"><span data-stu-id="de44d-115">**MsiDatabaseCommit**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit)                       | <span data-ttu-id="de44d-116">Confirma as alterações em um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="de44d-116">Commits changes to a database.</span></span>                                                          |
| [<span data-ttu-id="de44d-117">**MsiDatabaseGetPrimaryKeys**</span><span class="sxs-lookup"><span data-stu-id="de44d-117">**MsiDatabaseGetPrimaryKeys**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasegetprimarykeysa)       | <span data-ttu-id="de44d-118">Retorna os nomes de todas as colunas de chave primária.</span><span class="sxs-lookup"><span data-stu-id="de44d-118">Returns the names of all the primary key columns.</span></span>                                       |
| [<span data-ttu-id="de44d-119">**MsiDatabaseIsTablePersistent**</span><span class="sxs-lookup"><span data-stu-id="de44d-119">**MsiDatabaseIsTablePersistent**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseistablepersistenta) | <span data-ttu-id="de44d-120">Retorna uma enumeração que descreve o estado de uma tabela.</span><span class="sxs-lookup"><span data-stu-id="de44d-120">Returns an enumeration describing the state of a table.</span></span>                                 |
| [<span data-ttu-id="de44d-121">**MsiDatabaseOpenView**</span><span class="sxs-lookup"><span data-stu-id="de44d-121">**MsiDatabaseOpenView**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa)                   | <span data-ttu-id="de44d-122">Prepara uma consulta de banco de dados e cria um objeto de exibição.</span><span class="sxs-lookup"><span data-stu-id="de44d-122">Prepares a database query and creates a view object.</span></span>                                    |
| [<span data-ttu-id="de44d-123">**MsiGetActiveDatabase**</span><span class="sxs-lookup"><span data-stu-id="de44d-123">**MsiGetActiveDatabase**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetactivedatabase)                 | <span data-ttu-id="de44d-124">Retorna o banco de dados ativo para a instalação.</span><span class="sxs-lookup"><span data-stu-id="de44d-124">Returns the active database for the installation.</span></span>                                       |
| [<span data-ttu-id="de44d-125">**MsiViewGetColumnInfo**</span><span class="sxs-lookup"><span data-stu-id="de44d-125">**MsiViewGetColumnInfo**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgetcolumninfo)                 | <span data-ttu-id="de44d-126">Retorna nomes ou definições de coluna.</span><span class="sxs-lookup"><span data-stu-id="de44d-126">Returns column names or definitions.</span></span>                                                    |
| [<span data-ttu-id="de44d-127">**MsiOpenDatabase**</span><span class="sxs-lookup"><span data-stu-id="de44d-127">**MsiOpenDatabase**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiopendatabasea)                           | <span data-ttu-id="de44d-128">Abre um arquivo de banco de dados para o acesso ao dado.</span><span class="sxs-lookup"><span data-stu-id="de44d-128">Opens a database file for data access.</span></span>                                                  |
| [<span data-ttu-id="de44d-129">**MsiViewClose**</span><span class="sxs-lookup"><span data-stu-id="de44d-129">**MsiViewClose**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewclose)                                 | <span data-ttu-id="de44d-130">Libera o conjunto de resultados para uma exibição executada.</span><span class="sxs-lookup"><span data-stu-id="de44d-130">Releases the result set for an executed view.</span></span>                                           |
| [<span data-ttu-id="de44d-131">**MsiViewExecute**</span><span class="sxs-lookup"><span data-stu-id="de44d-131">**MsiViewExecute**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewexecute)                             | <span data-ttu-id="de44d-132">Executa a consulta de exibição e fornece os parâmetros necessários.</span><span class="sxs-lookup"><span data-stu-id="de44d-132">Executes the view query and supplies required parameters.</span></span>                               |
| [<span data-ttu-id="de44d-133">**MsiViewFetch**</span><span class="sxs-lookup"><span data-stu-id="de44d-133">**MsiViewFetch**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewfetch)                                 | <span data-ttu-id="de44d-134">Busca o próximo registro sequencial da exibição.</span><span class="sxs-lookup"><span data-stu-id="de44d-134">Fetches the next sequential record from the view.</span></span>                                       |
| [<span data-ttu-id="de44d-135">**MsiViewGetError**</span><span class="sxs-lookup"><span data-stu-id="de44d-135">**MsiViewGetError**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora)                           | <span data-ttu-id="de44d-136">Retorna o erro que ocorreu na função [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) .</span><span class="sxs-lookup"><span data-stu-id="de44d-136">Returns the error that occurred in the [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) function.</span></span> |
| [<span data-ttu-id="de44d-137">**MsiViewModify**</span><span class="sxs-lookup"><span data-stu-id="de44d-137">**MsiViewModify**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify)                               | <span data-ttu-id="de44d-138">Atualiza um registro buscado.</span><span class="sxs-lookup"><span data-stu-id="de44d-138">Updates a fetched record.</span></span>                                                               |



 

## <a name="database-management-functions"></a><span data-ttu-id="de44d-139">Funções de gerenciamento de banco de dados</span><span class="sxs-lookup"><span data-stu-id="de44d-139">Database Management Functions</span></span>



| <span data-ttu-id="de44d-140">Função</span><span class="sxs-lookup"><span data-stu-id="de44d-140">Function</span></span>                                                               | <span data-ttu-id="de44d-141">Descrição</span><span class="sxs-lookup"><span data-stu-id="de44d-141">Description</span></span>                                                      |
|------------------------------------------------------------------------|------------------------------------------------------------------|
| [<span data-ttu-id="de44d-142">**MsiCreateTransformSummaryInfo**</span><span class="sxs-lookup"><span data-stu-id="de44d-142">**MsiCreateTransformSummaryInfo**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msicreatetransformsummaryinfoa) | <span data-ttu-id="de44d-143">Cria informações de resumo para uma transformação existente.</span><span class="sxs-lookup"><span data-stu-id="de44d-143">Creates summary information for an existing transform.</span></span>           |
| [<span data-ttu-id="de44d-144">**MsiDatabaseApplyTransform**</span><span class="sxs-lookup"><span data-stu-id="de44d-144">**MsiDatabaseApplyTransform**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseapplytransforma)         | <span data-ttu-id="de44d-145">Aplica uma transformação a um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="de44d-145">Applies a transform to a database.</span></span>                               |
| [<span data-ttu-id="de44d-146">**MsiDatabaseExport**</span><span class="sxs-lookup"><span data-stu-id="de44d-146">**MsiDatabaseExport**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta)                         | <span data-ttu-id="de44d-147">Exporta uma tabela de um banco de dados aberto para um arquivo morto de texto.</span><span class="sxs-lookup"><span data-stu-id="de44d-147">Exports a table from an open database to a text archive file.</span></span>    |
| [<span data-ttu-id="de44d-148">**MsiDatabaseGenerateTransform**</span><span class="sxs-lookup"><span data-stu-id="de44d-148">**MsiDatabaseGenerateTransform**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasegeneratetransforma)   | <span data-ttu-id="de44d-149">Gera um arquivo de transformação de diferenças entre dois bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="de44d-149">Generates a transform file of differences between two databases.</span></span> |
| [<span data-ttu-id="de44d-150">**MsiDatabaseImport**</span><span class="sxs-lookup"><span data-stu-id="de44d-150">**MsiDatabaseImport**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta)                         | <span data-ttu-id="de44d-151">Importa uma tabela de arquivamento de texto do instalador para um banco de dados aberto.</span><span class="sxs-lookup"><span data-stu-id="de44d-151">Imports an installer text archive table into an open database.</span></span>   |
| [<span data-ttu-id="de44d-152">**MsiDatabaseMerge**</span><span class="sxs-lookup"><span data-stu-id="de44d-152">**MsiDatabaseMerge**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea)                           | <span data-ttu-id="de44d-153">Mescla dois bancos de dados juntos.</span><span class="sxs-lookup"><span data-stu-id="de44d-153">Merges two databases together.</span></span>                                   |
| [<span data-ttu-id="de44d-154">**MsiGetDatabaseState**</span><span class="sxs-lookup"><span data-stu-id="de44d-154">**MsiGetDatabaseState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetdatabasestate)                     | <span data-ttu-id="de44d-155">Retorna o estado do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="de44d-155">Returns the state of the database.</span></span>                               |



 

## <a name="record-processing-functions"></a><span data-ttu-id="de44d-156">Funções de processamento de registros</span><span class="sxs-lookup"><span data-stu-id="de44d-156">Record Processing Functions</span></span>



| <span data-ttu-id="de44d-157">Função</span><span class="sxs-lookup"><span data-stu-id="de44d-157">Function</span></span>                                                 | <span data-ttu-id="de44d-158">Descrição</span><span class="sxs-lookup"><span data-stu-id="de44d-158">Description</span></span>                                                     |
|----------------------------------------------------------|-----------------------------------------------------------------|
| [<span data-ttu-id="de44d-159">**MsiCreateRecord**</span><span class="sxs-lookup"><span data-stu-id="de44d-159">**MsiCreateRecord**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msicreaterecord)               | <span data-ttu-id="de44d-160">Cria um novo objeto de registro com o número especificado de campos.</span><span class="sxs-lookup"><span data-stu-id="de44d-160">Creates new record object with specified number of fields.</span></span>      |
| [<span data-ttu-id="de44d-161">**MsiFormatRecord**</span><span class="sxs-lookup"><span data-stu-id="de44d-161">**MsiFormatRecord**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiformatrecorda)               | <span data-ttu-id="de44d-162">Formata dados e propriedades do campo de registro usando uma cadeia de caracteres de formato.</span><span class="sxs-lookup"><span data-stu-id="de44d-162">Formats record field data and properties using a format string.</span></span> |
| [<span data-ttu-id="de44d-163">**MsiRecordClearData**</span><span class="sxs-lookup"><span data-stu-id="de44d-163">**MsiRecordClearData**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordcleardata)         | <span data-ttu-id="de44d-164">Define todos os campos em um registro como nulo.</span><span class="sxs-lookup"><span data-stu-id="de44d-164">Sets all fields in a record to null.</span></span>                            |
| [<span data-ttu-id="de44d-165">**MsiRecordDataSize**</span><span class="sxs-lookup"><span data-stu-id="de44d-165">**MsiRecordDataSize**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecorddatasize)           | <span data-ttu-id="de44d-166">Retorna o comprimento de um campo de registro.</span><span class="sxs-lookup"><span data-stu-id="de44d-166">Returns the length of a record field.</span></span>                           |
| [<span data-ttu-id="de44d-167">**MsiRecordGetFieldCount**</span><span class="sxs-lookup"><span data-stu-id="de44d-167">**MsiRecordGetFieldCount**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordgetfieldcount) | <span data-ttu-id="de44d-168">Retorna o número de campos em um registro.</span><span class="sxs-lookup"><span data-stu-id="de44d-168">Returns the number of fields in a record.</span></span>                       |
| [<span data-ttu-id="de44d-169">**MsiRecordGetInteger**</span><span class="sxs-lookup"><span data-stu-id="de44d-169">**MsiRecordGetInteger**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordgetinteger)       | <span data-ttu-id="de44d-170">Retorna o valor inteiro de um campo de registro.</span><span class="sxs-lookup"><span data-stu-id="de44d-170">Returns the integer value from a record field.</span></span>                  |
| [<span data-ttu-id="de44d-171">**MsiRecordGetString**</span><span class="sxs-lookup"><span data-stu-id="de44d-171">**MsiRecordGetString**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordgetstringa)         | <span data-ttu-id="de44d-172">Retorna o valor da cadeia de caracteres de um campo de registro.</span><span class="sxs-lookup"><span data-stu-id="de44d-172">Returns the string value of a record field.</span></span>                     |
| [<span data-ttu-id="de44d-173">**MsiRecordIsNull**</span><span class="sxs-lookup"><span data-stu-id="de44d-173">**MsiRecordIsNull**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordisnull)               | <span data-ttu-id="de44d-174">Relata se um campo de registro é nulo.</span><span class="sxs-lookup"><span data-stu-id="de44d-174">Reports whether a record field is null.</span></span>                         |
| [<span data-ttu-id="de44d-175">**MsiRecordReadStream**</span><span class="sxs-lookup"><span data-stu-id="de44d-175">**MsiRecordReadStream**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordreadstream)       | <span data-ttu-id="de44d-176">Lê bytes de um campo de fluxo de registro em um buffer.</span><span class="sxs-lookup"><span data-stu-id="de44d-176">Reads bytes from a record stream field into a buffer.</span></span>           |
| [<span data-ttu-id="de44d-177">**MsiRecordSetInteger**</span><span class="sxs-lookup"><span data-stu-id="de44d-177">**MsiRecordSetInteger**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetinteger)       | <span data-ttu-id="de44d-178">Define um campo de registro como um campo de número inteiro.</span><span class="sxs-lookup"><span data-stu-id="de44d-178">Sets a record field to an integer field.</span></span>                        |
| [<span data-ttu-id="de44d-179">**MsiRecordSetStream**</span><span class="sxs-lookup"><span data-stu-id="de44d-179">**MsiRecordSetStream**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama)         | <span data-ttu-id="de44d-180">Define um campo de fluxo de registros de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="de44d-180">Sets a record stream field from a file.</span></span>                         |
| [<span data-ttu-id="de44d-181">**MsiRecordSetString**</span><span class="sxs-lookup"><span data-stu-id="de44d-181">**MsiRecordSetString**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa)         | <span data-ttu-id="de44d-182">Copia uma cadeia de caracteres no campo designado.</span><span class="sxs-lookup"><span data-stu-id="de44d-182">Copies a string into the designated field.</span></span>                      |



 

## <a name="summary-information-property-functions"></a><span data-ttu-id="de44d-183">Funções de propriedade de informações de resumo</span><span class="sxs-lookup"><span data-stu-id="de44d-183">Summary Information Property Functions</span></span>



| <span data-ttu-id="de44d-184">Função</span><span class="sxs-lookup"><span data-stu-id="de44d-184">Function</span></span>                                                                 | <span data-ttu-id="de44d-185">Descrição</span><span class="sxs-lookup"><span data-stu-id="de44d-185">Description</span></span>                                                            |
|--------------------------------------------------------------------------|------------------------------------------------------------------------|
| [<span data-ttu-id="de44d-186">**MsiGetSummaryInformation**</span><span class="sxs-lookup"><span data-stu-id="de44d-186">**MsiGetSummaryInformation**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetsummaryinformationa)             | <span data-ttu-id="de44d-187">Obtém o identificador para o fluxo de informações de resumo do banco de dados do instalador.</span><span class="sxs-lookup"><span data-stu-id="de44d-187">Obtains handle to summary information stream of installer database.</span></span>    |
| [<span data-ttu-id="de44d-188">**MsiSummaryInfoGetProperty**</span><span class="sxs-lookup"><span data-stu-id="de44d-188">**MsiSummaryInfoGetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfogetpropertya)           | <span data-ttu-id="de44d-189">Obtém uma única propriedade das informações de resumo.</span><span class="sxs-lookup"><span data-stu-id="de44d-189">Gets a single property from the summary information.</span></span>                   |
| [<span data-ttu-id="de44d-190">**MsiSummaryInfoGetPropertyCount**</span><span class="sxs-lookup"><span data-stu-id="de44d-190">**MsiSummaryInfoGetPropertyCount**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfogetpropertycount) | <span data-ttu-id="de44d-191">Retorna o número de propriedades no fluxo de informações de resumo.</span><span class="sxs-lookup"><span data-stu-id="de44d-191">Returns number of properties in the summary information stream.</span></span>        |
| [<span data-ttu-id="de44d-192">**MsiSummaryInfoPersist**</span><span class="sxs-lookup"><span data-stu-id="de44d-192">**MsiSummaryInfoPersist**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfopersist)                   | <span data-ttu-id="de44d-193">Grava informações de resumo alteradas de volta no fluxo de informações de resumo.</span><span class="sxs-lookup"><span data-stu-id="de44d-193">Writes changed summary information back to summary information stream.</span></span> |
| [<span data-ttu-id="de44d-194">**MsiSummaryInfoSetProperty**</span><span class="sxs-lookup"><span data-stu-id="de44d-194">**MsiSummaryInfoSetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisummaryinfosetpropertya)           | <span data-ttu-id="de44d-195">Define uma única propriedade de informações de resumo.</span><span class="sxs-lookup"><span data-stu-id="de44d-195">Sets a single summary information property.</span></span>                            |



 

## <a name="installer-state-access-functions"></a><span data-ttu-id="de44d-196">Funções de acesso de estado do instalador</span><span class="sxs-lookup"><span data-stu-id="de44d-196">Installer State Access Functions</span></span>



| <span data-ttu-id="de44d-197">Função</span><span class="sxs-lookup"><span data-stu-id="de44d-197">Function</span></span>                                               | <span data-ttu-id="de44d-198">Descrição</span><span class="sxs-lookup"><span data-stu-id="de44d-198">Description</span></span>                                                 |
|--------------------------------------------------------|-------------------------------------------------------------|
| [<span data-ttu-id="de44d-199">**MsiGetLanguage**</span><span class="sxs-lookup"><span data-stu-id="de44d-199">**MsiGetLanguage**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetlanguage)               | <span data-ttu-id="de44d-200">Retorna o idioma numérico da instalação atual.</span><span class="sxs-lookup"><span data-stu-id="de44d-200">Returns the numeric language of the current installation.</span></span>   |
| [<span data-ttu-id="de44d-201">**MsiGetLastErrorRecord**</span><span class="sxs-lookup"><span data-stu-id="de44d-201">**MsiGetLastErrorRecord**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetlasterrorrecord) | <span data-ttu-id="de44d-202">Retorna o registro de erro retornado pela última vez para o processo de chamada.</span><span class="sxs-lookup"><span data-stu-id="de44d-202">Returns error record last returned for the calling process.</span></span> |
| [<span data-ttu-id="de44d-203">**MsiGetMode**</span><span class="sxs-lookup"><span data-stu-id="de44d-203">**MsiGetMode**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode)                       | <span data-ttu-id="de44d-204">Retorna um dos Estados de instalação interna booliana.</span><span class="sxs-lookup"><span data-stu-id="de44d-204">Returns one of the Boolean internal installation states.</span></span>    |
| [<span data-ttu-id="de44d-205">**MsiGetProperty**</span><span class="sxs-lookup"><span data-stu-id="de44d-205">**MsiGetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetpropertya)               | <span data-ttu-id="de44d-206">Obtém o valor de uma propriedade do instalador.</span><span class="sxs-lookup"><span data-stu-id="de44d-206">Gets the value of an installer property.</span></span>                    |
| [<span data-ttu-id="de44d-207">**MsiSetProperty**</span><span class="sxs-lookup"><span data-stu-id="de44d-207">**MsiSetProperty**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetpropertya)               | <span data-ttu-id="de44d-208">Define o valor de uma propriedade de instalação.</span><span class="sxs-lookup"><span data-stu-id="de44d-208">Sets the value of an installation property.</span></span>                 |
| [<span data-ttu-id="de44d-209">**MsiSetMode**</span><span class="sxs-lookup"><span data-stu-id="de44d-209">**MsiSetMode**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetmode)                       | <span data-ttu-id="de44d-210">Define um estado booliano do mecanismo interno.</span><span class="sxs-lookup"><span data-stu-id="de44d-210">Sets an internal engine Boolean state.</span></span>                      |



 

## <a name="installer-action-functions"></a><span data-ttu-id="de44d-211">Funções de ação do instalador</span><span class="sxs-lookup"><span data-stu-id="de44d-211">Installer Action Functions</span></span>



| <span data-ttu-id="de44d-212">Função</span><span class="sxs-lookup"><span data-stu-id="de44d-212">Function</span></span>                                             | <span data-ttu-id="de44d-213">Descrição</span><span class="sxs-lookup"><span data-stu-id="de44d-213">Description</span></span>                                                               |
|------------------------------------------------------|---------------------------------------------------------------------------|
| [<span data-ttu-id="de44d-214">**MsiDoAction**</span><span class="sxs-lookup"><span data-stu-id="de44d-214">**MsiDoAction**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msidoactiona)                   | <span data-ttu-id="de44d-215">Executa a ação interna, a ação personalizada ou o assistente de interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="de44d-215">Executes built-in action, custom action, or user-interface wizard action.</span></span> |
| [<span data-ttu-id="de44d-216">**MsiEvaluateCondition**</span><span class="sxs-lookup"><span data-stu-id="de44d-216">**MsiEvaluateCondition**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msievaluateconditiona) | <span data-ttu-id="de44d-217">Avalia uma expressão condicional que contém nomes e valores de propriedade.</span><span class="sxs-lookup"><span data-stu-id="de44d-217">Evaluates a conditional expression containing property names and values.</span></span>  |
| [<span data-ttu-id="de44d-218">**MsiProcessMessage**</span><span class="sxs-lookup"><span data-stu-id="de44d-218">**MsiProcessMessage**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage)       | <span data-ttu-id="de44d-219">Envia um registro de erro para o instalador para processamento.</span><span class="sxs-lookup"><span data-stu-id="de44d-219">Sends an error record to the installer for processing.</span></span>                    |
| [<span data-ttu-id="de44d-220">**MsiSequence**</span><span class="sxs-lookup"><span data-stu-id="de44d-220">**MsiSequence**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisequencea)                   | <span data-ttu-id="de44d-221">Executa uma sequência de ação.</span><span class="sxs-lookup"><span data-stu-id="de44d-221">Executes an action sequence.</span></span>                                              |



 

## <a name="installer-location-functions"></a><span data-ttu-id="de44d-222">Funções de localização do instalador</span><span class="sxs-lookup"><span data-stu-id="de44d-222">Installer Location Functions</span></span>



| <span data-ttu-id="de44d-223">Função</span><span class="sxs-lookup"><span data-stu-id="de44d-223">Function</span></span>                                     | <span data-ttu-id="de44d-224">Descrição</span><span class="sxs-lookup"><span data-stu-id="de44d-224">Description</span></span>                                                       |
|----------------------------------------------|-------------------------------------------------------------------|
| [<span data-ttu-id="de44d-225">**MsiGetSourcePath**</span><span class="sxs-lookup"><span data-stu-id="de44d-225">**MsiGetSourcePath**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetsourcepatha) | <span data-ttu-id="de44d-226">Retorna o caminho de origem completo de uma pasta na tabela de diretórios.</span><span class="sxs-lookup"><span data-stu-id="de44d-226">Returns the full source path for a folder in the Directory table.</span></span> |
| [<span data-ttu-id="de44d-227">**MsiGetTargetPath**</span><span class="sxs-lookup"><span data-stu-id="de44d-227">**MsiGetTargetPath**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigettargetpatha) | <span data-ttu-id="de44d-228">Retorna o caminho de destino completo de uma pasta na tabela de diretórios.</span><span class="sxs-lookup"><span data-stu-id="de44d-228">Returns the full target path for a folder in the Directory table.</span></span> |
| [<span data-ttu-id="de44d-229">**MsiSetTargetPath**</span><span class="sxs-lookup"><span data-stu-id="de44d-229">**MsiSetTargetPath**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisettargetpatha) | <span data-ttu-id="de44d-230">Define o caminho de destino completo para uma pasta na tabela de diretórios.</span><span class="sxs-lookup"><span data-stu-id="de44d-230">Sets the full target path for a folder in the Directory table.</span></span>    |



 

## <a name="installer-selection-functions"></a><span data-ttu-id="de44d-231">Funções de seleção do instalador</span><span class="sxs-lookup"><span data-stu-id="de44d-231">Installer Selection Functions</span></span>



| <span data-ttu-id="de44d-232">Função</span><span class="sxs-lookup"><span data-stu-id="de44d-232">Function</span></span>                                                     | <span data-ttu-id="de44d-233">Descrição</span><span class="sxs-lookup"><span data-stu-id="de44d-233">Description</span></span>                                                          |
|--------------------------------------------------------------|----------------------------------------------------------------------|
| [<span data-ttu-id="de44d-234">**MsiEnumComponentCosts**</span><span class="sxs-lookup"><span data-stu-id="de44d-234">**MsiEnumComponentCosts**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msienumcomponentcostsa)       | <span data-ttu-id="de44d-235">Enumera o espaço em disco por unidade necessária para instalar um componente.</span><span class="sxs-lookup"><span data-stu-id="de44d-235">Enumerates the disk-space per drive required to install a component.</span></span> |
| [<span data-ttu-id="de44d-236">**MsiGetComponentState**</span><span class="sxs-lookup"><span data-stu-id="de44d-236">**MsiGetComponentState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetcomponentstatea)         | <span data-ttu-id="de44d-237">Obtém o estado de um componente.</span><span class="sxs-lookup"><span data-stu-id="de44d-237">Obtains the state of a component.</span></span>                                    |
| [<span data-ttu-id="de44d-238">**MsiGetFeatureCost**</span><span class="sxs-lookup"><span data-stu-id="de44d-238">**MsiGetFeatureCost**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetfeaturecosta)               | <span data-ttu-id="de44d-239">Retorna o espaço em disco exigido por um recurso.</span><span class="sxs-lookup"><span data-stu-id="de44d-239">Returns the disk space required by a feature.</span></span>                        |
| [<span data-ttu-id="de44d-240">**MsiGetFeatureState**</span><span class="sxs-lookup"><span data-stu-id="de44d-240">**MsiGetFeatureState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetfeaturestatea)             | <span data-ttu-id="de44d-241">Obtém o estado de um recurso.</span><span class="sxs-lookup"><span data-stu-id="de44d-241">Gets the state of a feature.</span></span>                                         |
| [<span data-ttu-id="de44d-242">**MsiGetFeatureValidStates**</span><span class="sxs-lookup"><span data-stu-id="de44d-242">**MsiGetFeatureValidStates**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msigetfeaturevalidstatesa) | <span data-ttu-id="de44d-243">Retorna um estado de instalação válido.</span><span class="sxs-lookup"><span data-stu-id="de44d-243">Returns a valid installation state.</span></span>                                  |
| [<span data-ttu-id="de44d-244">**MsiSetComponentState**</span><span class="sxs-lookup"><span data-stu-id="de44d-244">**MsiSetComponentState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetcomponentstatea)         | <span data-ttu-id="de44d-245">Define um componente para o estado especificado.</span><span class="sxs-lookup"><span data-stu-id="de44d-245">Sets a component to the specified state.</span></span>                             |
| [<span data-ttu-id="de44d-246">**MsiSetFeatureAttributes**</span><span class="sxs-lookup"><span data-stu-id="de44d-246">**MsiSetFeatureAttributes**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetfeatureattributesa)   | <span data-ttu-id="de44d-247">Modifica os atributos padrão de um recurso em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="de44d-247">Modifies the default attributes of a feature at run time.</span></span>            |
| [<span data-ttu-id="de44d-248">**MsiSetFeatureState**</span><span class="sxs-lookup"><span data-stu-id="de44d-248">**MsiSetFeatureState**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetfeaturestatea)             | <span data-ttu-id="de44d-249">Define um recurso para um estado especificado.</span><span class="sxs-lookup"><span data-stu-id="de44d-249">Sets a feature to a specified state.</span></span>                                 |
| [<span data-ttu-id="de44d-250">**MsiSetInstallLevel**</span><span class="sxs-lookup"><span data-stu-id="de44d-250">**MsiSetInstallLevel**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msisetinstalllevel)             | <span data-ttu-id="de44d-251">Define o nível de instalação de uma instalação completa do produto.</span><span class="sxs-lookup"><span data-stu-id="de44d-251">Sets the installation level of a full product installation.</span></span>          |
| [<span data-ttu-id="de44d-252">**MsiVerifyDiskSpace**</span><span class="sxs-lookup"><span data-stu-id="de44d-252">**MsiVerifyDiskSpace**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msiverifydiskspace)             | <span data-ttu-id="de44d-253">Verifica se há espaço em disco suficiente.</span><span class="sxs-lookup"><span data-stu-id="de44d-253">Checks for sufficient disk space.</span></span>                                    |



 

## <a name="user-interface-functions"></a><span data-ttu-id="de44d-254">Funções da interface do usuário</span><span class="sxs-lookup"><span data-stu-id="de44d-254">User Interface Functions</span></span>



| <span data-ttu-id="de44d-255">Função</span><span class="sxs-lookup"><span data-stu-id="de44d-255">Function</span></span>                                           | <span data-ttu-id="de44d-256">Descrição</span><span class="sxs-lookup"><span data-stu-id="de44d-256">Description</span></span>                                                             |
|----------------------------------------------------|-------------------------------------------------------------------------|
| [<span data-ttu-id="de44d-257">**MsiEnableUIPreview**</span><span class="sxs-lookup"><span data-stu-id="de44d-257">**MsiEnableUIPreview**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msienableuipreview)   | <span data-ttu-id="de44d-258">Habilita o modo de visualização da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="de44d-258">Enables preview mode of the user interface.</span></span>                             |
| [<span data-ttu-id="de44d-259">**MsiPreviewBillboard**</span><span class="sxs-lookup"><span data-stu-id="de44d-259">**MsiPreviewBillboard**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msipreviewbillboarda) | <span data-ttu-id="de44d-260">Exibe um mural com o controle de host na caixa de diálogo exibida.</span><span class="sxs-lookup"><span data-stu-id="de44d-260">Displays a billboard with the host control in the displayed dialog box.</span></span> |
| [<span data-ttu-id="de44d-261">**MsiPreviewDialog**</span><span class="sxs-lookup"><span data-stu-id="de44d-261">**MsiPreviewDialog**</span></span>](/windows/desktop/api/Msiquery/nf-msiquery-msipreviewdialoga)       | <span data-ttu-id="de44d-262">Exibe uma caixa de diálogo como sem janela restrita e inativa.</span><span class="sxs-lookup"><span data-stu-id="de44d-262">Displays a dialog box as modeless and inactive.</span></span>                         |



 

<span data-ttu-id="de44d-263">Todas as funções oferecem suporte a chamadas ANSI e Unicode.</span><span class="sxs-lookup"><span data-stu-id="de44d-263">All functions support both ANSI and Unicode calls.</span></span> <span data-ttu-id="de44d-264">Para usar essas funções, inclua MsiQuery. h e vincule a MSI. lib.</span><span class="sxs-lookup"><span data-stu-id="de44d-264">To use these functions, include MsiQuery.h and link with Msi.lib.</span></span>

## <a name="installation-functions"></a><span data-ttu-id="de44d-265">Funções de instalação</span><span class="sxs-lookup"><span data-stu-id="de44d-265">Installation Functions</span></span>

<span data-ttu-id="de44d-266">Além das funções de acesso ao banco de dados listadas acima, você cria um pacote de instalação para um aplicativo usando as funções do instalador listadas na seção de [referência da função do instalador](installer-function-reference.md) .</span><span class="sxs-lookup"><span data-stu-id="de44d-266">In addition to the database access functions listed above, you create an installation package for an application by using the installer functions listed in the [Installer Function Reference](installer-function-reference.md) section.</span></span>

 

 



