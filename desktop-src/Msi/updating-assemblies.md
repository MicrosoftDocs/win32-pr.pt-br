---
description: As informações neste tópico identificam as diretrizes recomendadas para a atualização de assemblies usando patches de Windows Installer.
ms.assetid: 60c70d48-aae2-4ea5-a880-ac9e2c83c28c
title: Atualizando assemblies
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35b185a9943ba20c81a1fa3431dd590eb05648c9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104011841"
---
# <a name="updating-assemblies"></a><span data-ttu-id="a1cfb-103">Atualizando assemblies</span><span class="sxs-lookup"><span data-stu-id="a1cfb-103">Updating Assemblies</span></span>

<span data-ttu-id="a1cfb-104">As informações neste tópico identificam as diretrizes recomendadas para a atualização de assemblies usando patches de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-104">The information in this topic identifies the recommended guidelines for updating assemblies using Windows Installer patches.</span></span>

<span data-ttu-id="a1cfb-105">Os autores de atualizações de assembly podem usar as seguintes diretrizes, que se aplicam a todos os tipos de assemblies:</span><span class="sxs-lookup"><span data-stu-id="a1cfb-105">Authors of assembly updates can use the following guidelines, which apply to all types of assemblies:</span></span>

-   <span data-ttu-id="a1cfb-106">O método recomendado para atualizar um assembly é alterar o nome forte do assembly na [tabela MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="a1cfb-106">The recommended method for updating an assembly is to change the strong name of the assembly in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span> <span data-ttu-id="a1cfb-107">A nova versão do assembly pode ser fornecida por um novo componente ou pelo mesmo componente que fornece a versão antiga.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-107">The new assembly version can be provided by a new component or by the same component that provides the old version.</span></span>
-   <span data-ttu-id="a1cfb-108">Se a nova versão do assembly for fornecida pelo mesmo componente, não altere o tipo de assembly de um assembly .NET Framework para um assembly Win32 ou vice-versa.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-108">If the new assembly version is provided by the same component, do not change the assembly type from a .NET Framework assembly to a Win32 assembly or vice versa.</span></span>
-   <span data-ttu-id="a1cfb-109">Se todos os aplicativos no sistema precisarem usar o assembly atualizado, você deverá implantar um assembly de política.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-109">If all applications on the system must use the updated assembly, you should deploy a policy assembly.</span></span> <span data-ttu-id="a1cfb-110">Um assembly de política pode redirecionar aplicativos no sistema para usar a nova versão do assembly.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-110">A policy assembly can redirect applications on the system to use the new assembly version.</span></span> <span data-ttu-id="a1cfb-111">Os assemblies de política devem ser fornecidos pela criação de um novo componente.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-111">Policy assemblies should be provided by creating a new component.</span></span>
-   <span data-ttu-id="a1cfb-112">Windows Installer 3,0 ou posterior é necessário para desinstalar as atualizações de assembly.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-112">Windows Installer 3.0 or later is required to uninstall assembly updates.</span></span> <span data-ttu-id="a1cfb-113">Para obter mais informações, consulte [removendo patches](removing-patches.md).</span><span class="sxs-lookup"><span data-stu-id="a1cfb-113">For more information, see [Removing Patches](removing-patches.md).</span></span>
-   <span data-ttu-id="a1cfb-114">A versão mais recente do assembly deve conter as mesmas ou versões mais recentes de arquivos de assemblies lançados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-114">The newer version of the assembly should contain the same or higher versions of files from previously released assemblies.</span></span>
-   <span data-ttu-id="a1cfb-115">Windows Installer 3,0 pode atender a assemblies de .NET Framework e do Win32 por uma substituição de arquivo completa ou por uma atualização Delta menor.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-115">Windows Installer 3.0 can service .NET Framework and Win32 assemblies by a complete file replacement or by a smaller delta update.</span></span> <span data-ttu-id="a1cfb-116">Para obter mais informações, consulte [reduzindo o tamanho do patch](reducing-patch-size.md).</span><span class="sxs-lookup"><span data-stu-id="a1cfb-116">For more information, see [Reducing Patch Size](reducing-patch-size.md).</span></span>
-   <span data-ttu-id="a1cfb-117">Se a atualização alterar o nome forte do assembly, a tabela [MsiPatchOldAssemblyFile](msipatcholdassemblyfile-table.md) e a tabela [MsiPatchOldAssemblyName](msipatcholdassemblyname-table.md) serão necessárias se o pacote de patch não tiver uma tabela [MsiPatchSequence](msipatchsequence-table.md) .</span><span class="sxs-lookup"><span data-stu-id="a1cfb-117">If your update changes the strong name of the assembly, the [MsiPatchOldAssemblyFile](msipatcholdassemblyfile-table.md) table and [MsiPatchOldAssemblyName](msipatcholdassemblyname-table.md) table are required if the patch package does not have a [MsiPatchSequence](msipatchsequence-table.md) table.</span></span> <span data-ttu-id="a1cfb-118">A tabela MsiPatchOldAssemblyFile e a tabela MsiPatchOldAssemblyName não serão necessárias se o pacote de patch tiver informações de sequenciamento de patch em uma tabela MsiPatchSequence.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-118">The MsiPatchOldAssemblyFile table and MsiPatchOldAssemblyName table are not required if the patch package has patch sequencing information in a MsiPatchSequence table.</span></span>
-   <span data-ttu-id="a1cfb-119">Antes de liberar um novo patch, teste o patch aplicando-o a todos os patches lançados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-119">Before releasing a new patch, test the patch by applying it with all previously released patches.</span></span>

## <a name="updating-win32-assemblies"></a><span data-ttu-id="a1cfb-120">Atualizando assemblies do Win32</span><span class="sxs-lookup"><span data-stu-id="a1cfb-120">Updating Win32 Assemblies</span></span>

<span data-ttu-id="a1cfb-121">Use as seguintes diretrizes ao atualizar assemblies do Win32:</span><span class="sxs-lookup"><span data-stu-id="a1cfb-121">Use the following guidelines when you update Win32 assemblies:</span></span>

-   <span data-ttu-id="a1cfb-122">Altere o nome forte do novo assembly que é especificado na [tabela MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="a1cfb-122">Change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>
-   <span data-ttu-id="a1cfb-123">Se você quiser que seu aplicativo sempre use a nova versão do assembly sem afetar a versão do assembly usada por outros aplicativos no sistema, use o mesmo componente para conter a nova versão do assembly que você usou para a versão antiga do assembly.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-123">If you want your application to always use the new version of the assembly without affecting the assembly version used by other applications on the system, use the same component to contain the new assembly version that you used for the old assembly version.</span></span> <span data-ttu-id="a1cfb-124">Mantenha o mesmo ComponentID na tabela de [componentes](component-table.md) .</span><span class="sxs-lookup"><span data-stu-id="a1cfb-124">Keep the same ComponentId in the [Component](component-table.md) table.</span></span> <span data-ttu-id="a1cfb-125">Depois que o aplicativo é corrigido, ele só mantém uma referência à nova versão do assembly.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-125">After your application is patched, it only holds a reference to the new version of the assembly.</span></span> <span data-ttu-id="a1cfb-126">A versão antiga do assembly pode permanecer com a nova versão no cache de assembly global.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-126">The old version of the assembly can remain with the new version in the global assembly cache.</span></span> <span data-ttu-id="a1cfb-127">Isso não afeta outros aplicativos no sistema que usam a versão antiga do assembly.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-127">This does not affect other applications on the system that use the old version of the assembly.</span></span> <span data-ttu-id="a1cfb-128">Quando o mesmo componente é usado para as versões novas e antigas do assembly, sua atualização pode ser um patch Delta menor.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-128">When the same component is used for both the new and old versions of the assembly, your update can be a smaller delta patch.</span></span>
-   <span data-ttu-id="a1cfb-129">Se a nova versão do assembly não for compatível com todos os sistemas nos quais você deseja instalar o aplicativo, você poderá instalar as versões novas e antigas do assembly como assemblies lado a lado.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-129">If the new version of the assembly is not compatible with all the systems that you want to install your application on, you can install the new and old versions of the assembly as side-by-side assemblies.</span></span> <span data-ttu-id="a1cfb-130">Para instalar as duas versões do assembly lado a lado, crie um novo componente para conter a nova versão do assembly.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-130">To install both assembly versions side-by-side, create a new component to contain the new assembly version.</span></span> <span data-ttu-id="a1cfb-131">O ComponentID na tabela de [componentes](component-table.md) para o novo componente deve ser diferente do ComponentID do componente com a versão antiga.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-131">The ComponentId in the [Component](component-table.md) table for the new component should be different from the ComponentId of the component with the old version.</span></span> <span data-ttu-id="a1cfb-132">Depois que o aplicativo é corrigido, ele mantém referências a ambas as versões do assembly.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-132">After your application is patched, it holds references to both assembly versions.</span></span> <span data-ttu-id="a1cfb-133">Em seguida, o aplicativo pode ser direcionado para a versão compatível do assembly por um manifesto.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-133">Then the application can be directed to the compatible version of the assembly by a manifest.</span></span> <span data-ttu-id="a1cfb-134">Quando componentes diferentes são usados para as versões novas e antigas do assembly, sua atualização usa a substituição de arquivo completa.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-134">When different components are used for the new and old versions of the assembly, your update uses complete file replacement.</span></span>

## <a name="updating-net-framework-assemblies"></a><span data-ttu-id="a1cfb-135">Atualizando assemblies de .NET Framework</span><span class="sxs-lookup"><span data-stu-id="a1cfb-135">Updating .NET Framework Assemblies</span></span>

<span data-ttu-id="a1cfb-136">Use as diretrizes a seguir ao atualizar .NET Framework assemblies.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-136">Use the following guidelines when you update .NET Framework assemblies.</span></span>

-   <span data-ttu-id="a1cfb-137">Altere o nome forte do novo assembly que é especificado na [tabela MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="a1cfb-137">Change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>
-   <span data-ttu-id="a1cfb-138">Se você quiser que seu aplicativo sempre use a nova versão do assembly sem afetar a versão do assembly usada por outros aplicativos no sistema, altere o nome forte do novo assembly especificado na [tabela MsiAssemblyName](msiassemblyname-table.md)e use o mesmo componente para conter a nova versão do assembly que você usou para a versão antiga do assembly.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-138">If you want your application to always use the new version of the assembly without affecting the assembly version used by other applications on the system, change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md), and use the same component to contain the new assembly version that you used for the old assembly version.</span></span> <span data-ttu-id="a1cfb-139">Mantenha o mesmo ComponentID na tabela de [componentes](component-table.md) .</span><span class="sxs-lookup"><span data-stu-id="a1cfb-139">Keep the same ComponentId in the [Component](component-table.md) table.</span></span> <span data-ttu-id="a1cfb-140">Depois que o aplicativo é corrigido, ele só mantém uma referência à nova versão do assembly.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-140">After your application is patched, it only holds a reference to the new version of the assembly.</span></span> <span data-ttu-id="a1cfb-141">A versão antiga do assembly pode permanecer com a nova versão no cache global.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-141">The old version of the assembly can remain with the new version in the global cache.</span></span> <span data-ttu-id="a1cfb-142">Isso não afeta outros aplicativos no sistema que usam a versão antiga do assembly.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-142">This does not affect other applications on the system that use the old version of the assembly.</span></span> <span data-ttu-id="a1cfb-143">Quando o mesmo componente é usado para as versões novas e antigas do assembly, sua atualização pode ser um patch Delta menor.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-143">When the same component is used for both the new and old versions of the assembly, your update can be a smaller delta patch.</span></span>
-   <span data-ttu-id="a1cfb-144">Se a nova versão do assembly não for compatível com todos os sistemas nos quais você deseja instalar o aplicativo, você poderá instalar as versões novas e antigas do assembly como assemblies lado a lado.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-144">If the new version of the assembly is not compatible with all systems that you want to install your application on, you can install the new and old versions of the assembly as side-by-side assemblies.</span></span> <span data-ttu-id="a1cfb-145">Para instalar as duas versões do assembly lado a lado, altere o nome forte do novo assembly especificado na [tabela MsiAssemblyName](msiassemblyname-table.md)e crie um novo componente para conter a nova versão do assembly.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-145">To install both assembly versions side-by-side, change the strong name of the new assembly that is specified in the [MsiAssemblyName table](msiassemblyname-table.md), and create a new component to contain the new assembly version.</span></span> <span data-ttu-id="a1cfb-146">O ComponentID na tabela de [componentes](component-table.md) para o novo componente deve ser diferente do componenteid do componente com a versão antiga.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-146">The ComponentId in the [Component](component-table.md) table for the new component should be different than the ComponentId of the component with the old version.</span></span> <span data-ttu-id="a1cfb-147">Depois que o aplicativo é corrigido, ele mantém referências a ambas as versões do assembly.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-147">After your application is patched, it holds references to both assembly versions.</span></span> <span data-ttu-id="a1cfb-148">O aplicativo pode ser direcionado para a versão compatível do assembly por um manifesto.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-148">The application can then be directed to the compatible version of the assembly by a manifest.</span></span> <span data-ttu-id="a1cfb-149">Quando componentes diferentes são usados para as versões novas e antigas do assembly, sua atualização usa a substituição de arquivo completa.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-149">When different components are used for the new and old versions of the assembly, your update uses complete file replacement.</span></span>
-   <span data-ttu-id="a1cfb-150">Uma atualização in-loco substitui a cópia de um assembly .NET Framework no cache de assembly global.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-150">An in-place update overwrites the copy of a .NET Framework Assembly in the global assembly cache.</span></span> <span data-ttu-id="a1cfb-151">Esse tipo de atualização de assembly não altera o nome forte do assembly.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-151">This type of assembly update does not change the strong name of the assembly.</span></span> <span data-ttu-id="a1cfb-152">Somente o valor no campo FileVersion da [tabela MsiAssemblyName](msiassemblyname-table.md) é alterado.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-152">Only the value in the FileVersion field of the [MsiAssemblyName table](msiassemblyname-table.md) is changed.</span></span> <span data-ttu-id="a1cfb-153">A atualização in-loco de um assembly .NET Framework requer o .NET Framework 1,1 SP1 ou superior.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-153">The in-place update of a .NET Framework Assembly requires .NET Framework 1.1 SP1 or greater.</span></span>
    > [!Note]  
    > <span data-ttu-id="a1cfb-154">O tipo de atualização in-loco substitui a cópia do assembly no cache global e pode interromper outros aplicativos se a nova versão do assembly não for totalmente compatível com versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="a1cfb-154">The in-place type of update overwrites the copy of the assembly in the global cache, and can break other applications if the new version of the assembly is not completely backward compatible.</span></span> <span data-ttu-id="a1cfb-155">O método recomendado para atualizar um assembly é alterar o nome forte do assembly na [tabela MsiAssemblyName](msiassemblyname-table.md).</span><span class="sxs-lookup"><span data-stu-id="a1cfb-155">The recommended method for updating an assembly is to change the strong name of the assembly in the [MsiAssemblyName table](msiassemblyname-table.md).</span></span>

     

 

 



