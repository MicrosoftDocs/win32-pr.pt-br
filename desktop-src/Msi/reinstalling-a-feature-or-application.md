---
description: Windows Installer pode reparar, substituir e verificar arquivos contidos em um aplicativo. Uma reinstalação de aplicativo parcial ou completa poderá ser necessária se algum arquivo ou entrada de registro associado a qualquer recurso estiver ausente ou corrompido.
ms.assetid: fab23ab9-f1ab-4743-b883-cffc29b0124b
title: Reinstalando um recurso ou aplicativo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 645f7dbf95204d96202c71a120eafb6e6e054ac6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104091603"
---
# <a name="reinstalling-a-feature-or-application"></a><span data-ttu-id="4b37c-104">Reinstalando um recurso ou aplicativo</span><span class="sxs-lookup"><span data-stu-id="4b37c-104">Reinstalling a Feature or Application</span></span>

<span data-ttu-id="4b37c-105">Windows Installer pode reparar, substituir e verificar arquivos contidos em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4b37c-105">Windows Installer can repair, replace, and verify files contained in an application.</span></span> <span data-ttu-id="4b37c-106">Uma reinstalação de aplicativo parcial ou completa poderá ser necessária se algum arquivo ou entrada de registro associado a qualquer recurso estiver ausente ou corrompido.</span><span class="sxs-lookup"><span data-stu-id="4b37c-106">A partial or complete application reinstallation might be required if any files or registry entries associated with any feature are missing or corrupt.</span></span>

<span data-ttu-id="4b37c-107">Quando um recurso ou aplicativo é reinstalado, todos os serviços, variáveis de ambiente e ações personalizadas que pertencem ao recurso ou ao aplicativo também são reinstalados.</span><span class="sxs-lookup"><span data-stu-id="4b37c-107">When a feature or application is reinstalled, all the services, environment variables, and custom actions belonging to the feature or application are reinstalled as well.</span></span> <span data-ttu-id="4b37c-108">Observe que isso significa que qualquer alteração feita nas variáveis de ambiente entre a instalação original e a reinstalação será perdida.</span><span class="sxs-lookup"><span data-stu-id="4b37c-108">Note that this means that any changes made to environment variables between the original installation and the reinstallation are lost.</span></span>

<span data-ttu-id="4b37c-109">A lista a seguir contém métodos de reinstalação de um recurso ou produto.</span><span class="sxs-lookup"><span data-stu-id="4b37c-109">The following list contains methods of reinstalling a feature or product.</span></span> <span data-ttu-id="4b37c-110">Os dois primeiros métodos foram automatizados pelo instalador:</span><span class="sxs-lookup"><span data-stu-id="4b37c-110">The first two methods have been automated by the installer:</span></span>

-   <span data-ttu-id="4b37c-111">Repare, substitua ou verifique os arquivos chamando a função [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea) .</span><span class="sxs-lookup"><span data-stu-id="4b37c-111">Repair, replace, or verify files by calling the [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea) function.</span></span>
-   <span data-ttu-id="4b37c-112">Reinstale o produto inteiro chamando a função [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) .</span><span class="sxs-lookup"><span data-stu-id="4b37c-112">Reinstall the entire product by calling the [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) function.</span></span>
-   <span data-ttu-id="4b37c-113">Botão reinstalar, substituir ou verificar arquivos com um controle de interface do usuário do instalador por meio da [reinstalação do ControlEvent,](reinstall-controlevent.md).</span><span class="sxs-lookup"><span data-stu-id="4b37c-113">Reinstall, replace, or verify files with an installer UI control button through the [Reinstall ControlEvent](reinstall-controlevent.md).</span></span>
-   <span data-ttu-id="4b37c-114">Reinstale, substitua ou verifique os arquivos de uma linha de comando definindo a propriedade [**reinstalar**](reinstall.md) e a propriedade [**REINSTALLMODE**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="4b37c-114">Reinstall, replace, or verify files from a command line by setting the [**REINSTALL**](reinstall.md) property and the [**REINSTALLMODE**](reinstallmode.md) property.</span></span>

<span data-ttu-id="4b37c-115">Para obter mais informações sobre como reinstalar um recurso ou aplicativo, consulte [resiliência](resiliency.md).</span><span class="sxs-lookup"><span data-stu-id="4b37c-115">For more information on reinstalling a feature or application, see [Resiliency](resiliency.md).</span></span>

<span data-ttu-id="4b37c-116">**Para reinstalar um produto usando o instalador**</span><span class="sxs-lookup"><span data-stu-id="4b37c-116">**To reinstall a product using the installer**</span></span>

-   <span data-ttu-id="4b37c-117">Chame [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta).</span><span class="sxs-lookup"><span data-stu-id="4b37c-117">Call [**MsiReinstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta).</span></span>

<span data-ttu-id="4b37c-118">**Para reinstalar um recurso usando o instalador**</span><span class="sxs-lookup"><span data-stu-id="4b37c-118">**To reinstall a feature using the installer**</span></span>

-   <span data-ttu-id="4b37c-119">Chame [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span><span class="sxs-lookup"><span data-stu-id="4b37c-119">Call [**MsiReinstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span></span>

<span data-ttu-id="4b37c-120">**Para reinstalar um produto ou recurso com uma interface do usuário do instalador**</span><span class="sxs-lookup"><span data-stu-id="4b37c-120">**To reinstall a product or feature with an installer user interface**</span></span>

1.  <span data-ttu-id="4b37c-121">Adicione um botão à caixa de diálogo especificada adicionando uma entrada à tabela de [controle](control-table.md).</span><span class="sxs-lookup"><span data-stu-id="4b37c-121">Add a button to the specified dialog box by adding an entry to the [Control table](control-table.md).</span></span>
2.  <span data-ttu-id="4b37c-122">Adicione um [ControlEvent, REINSTALLMODE](reinstallmode-controlevent.md) à tabela ControlEvent,, com os campos de caixa de diálogo \_ e controle que \_ fazem referência ao controle de botão criado na etapa 1.</span><span class="sxs-lookup"><span data-stu-id="4b37c-122">Add a [ReinstallMode ControlEvent](reinstallmode-controlevent.md) to the ControlEvent table, with the Dialog\_ and Control\_ fields referencing the button control created in step 1.</span></span> <span data-ttu-id="4b37c-123">No campo argumento, insira uma cadeia de caracteres que contém as letras correspondentes aos modos de reinstalação desejados (os valores aceitáveis para esse campo são idênticos aos aceitos para a propriedade [**REinstallmode**](reinstallmode.md) ).</span><span class="sxs-lookup"><span data-stu-id="4b37c-123">In the Argument field, enter a string containing the letters corresponding to the reinstall modes you want (the acceptable values for this field are identical to those accepted for the [**REINSTALLMODE**](reinstallmode.md) property).</span></span> <span data-ttu-id="4b37c-124">O valor na coluna de ordenação deste evento deve ser 1.</span><span class="sxs-lookup"><span data-stu-id="4b37c-124">The value in the Ordering column for this event should be 1.</span></span>
3.  <span data-ttu-id="4b37c-125">Adicione um evento [REINSTALL ControlEvent,](reinstall-controlevent.md) à [tabela ControlEvent,](controlevent-table.md), novamente referenciando o mesmo controle de botão.</span><span class="sxs-lookup"><span data-stu-id="4b37c-125">Add a [Reinstall ControlEvent](reinstall-controlevent.md) event to the [ControlEvent table](controlevent-table.md), again referencing the same button control.</span></span> <span data-ttu-id="4b37c-126">O campo de argumento para esse evento normalmente será tudo, para forçar a reinstalação de todos os recursos, mas você pode posicionar o nome de um recurso específico aqui.</span><span class="sxs-lookup"><span data-stu-id="4b37c-126">The Argument field for this event will normally be ALL, to force reinstallation of all features, but you can place the name of a specific feature here.</span></span> <span data-ttu-id="4b37c-127">O valor na coluna de ordenação deste evento deve ser 2.</span><span class="sxs-lookup"><span data-stu-id="4b37c-127">The value in the Ordering column for this event should be 2.</span></span>
4.  <span data-ttu-id="4b37c-128">Adicione mais um evento vinculado ao mesmo controle de botão, para realmente iniciar a reinstalação.</span><span class="sxs-lookup"><span data-stu-id="4b37c-128">Add one more event tied to the same button control, to actually initiate the reinstallation.</span></span> <span data-ttu-id="4b37c-129">Isso pode ser um evento EndDialog (com um argumento de retorno).</span><span class="sxs-lookup"><span data-stu-id="4b37c-129">This can be an EndDialog event (with an argument of Return).</span></span> <span data-ttu-id="4b37c-130">Em geral, no entanto, um evento NewDialog seria usado aqui para ir para uma caixa de diálogo de confirmação **que você deseja reinstalar?** .</span><span class="sxs-lookup"><span data-stu-id="4b37c-130">More typically, however, a NewDialog event would be used here to jump to an **Are you sure you want to reinstall?** confirmation dialog box.</span></span> <span data-ttu-id="4b37c-131">O valor na coluna ordenação desse evento deve ser 3.</span><span class="sxs-lookup"><span data-stu-id="4b37c-131">The value in the Ordering column for this event should be 3.</span></span>

    <span data-ttu-id="4b37c-132">Se desejar, vários botões de [**reinstalação**](reinstall.md) podem ser criados para uma única caixa de diálogo, permitindo que o usuário selecione o tipo de reinstalação executada.</span><span class="sxs-lookup"><span data-stu-id="4b37c-132">If desired, several [**REINSTALL**](reinstall.md) buttons can be created for a single dialog box, allowing the user to select the type of reinstallation performed.</span></span> <span data-ttu-id="4b37c-133">Nesse caso, cada botão é criado conforme descrito no procedimento anterior, com um parâmetro [REINSTALLMODE ControlEvent,](reinstallmode-controlevent.md) diferente para cada botão.</span><span class="sxs-lookup"><span data-stu-id="4b37c-133">In this case, each button is authored as outlined in the preceding procedure, with a different [ReinstallMode ControlEvent](reinstallmode-controlevent.md) parameter for each button.</span></span>

<span data-ttu-id="4b37c-134">Depois que um produto específico tiver sido instalado (com alguns ou todos os recursos do produto), uma reinstalação poderá ser executada na linha de comando:</span><span class="sxs-lookup"><span data-stu-id="4b37c-134">Once a particular product has been installed (with some or all of the product's features), a reinstallation can be performed at the command line:</span></span>

<span data-ttu-id="4b37c-135">**Para reinstalar um produto ou recurso de uma linha de comando**</span><span class="sxs-lookup"><span data-stu-id="4b37c-135">**To reinstall a product or feature from a command line**</span></span>

1.  <span data-ttu-id="4b37c-136">No prompt de comando, especifique a propriedade [**REINSTALL**](reinstall.md) .</span><span class="sxs-lookup"><span data-stu-id="4b37c-136">From the command prompt, specify the [**REINSTALL**](reinstall.md) property.</span></span>
2.  <span data-ttu-id="4b37c-137">No prompt de comando, especifique a propriedade [**REinstallmode**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="4b37c-137">From the command prompt, specify the [**REINSTALLMODE**](reinstallmode.md) property.</span></span>

    <span data-ttu-id="4b37c-138">A especificação dessas propriedades permite que o usuário reinstale qualquer ou todos os recursos do produto.</span><span class="sxs-lookup"><span data-stu-id="4b37c-138">Specifying these properties allows the user to reinstall any or all of the product's features.</span></span> <span data-ttu-id="4b37c-139">O tipo de reinstalação também pode ser especificado.</span><span class="sxs-lookup"><span data-stu-id="4b37c-139">The type of reinstallation can also be specified.</span></span> <span data-ttu-id="4b37c-140">Por exemplo, você pode especificar que apenas os arquivos que estão completamente ausentes devem ser reinstalados ou que somente arquivos corrompidos (por exemplo, qualquer arquivo executável cuja soma de verificação não corresponda ao conteúdo do arquivo real) sejam substituídos.</span><span class="sxs-lookup"><span data-stu-id="4b37c-140">For example, you can specify that only those files that are completely missing should be reinstalled, or that only corrupt files (for example, any executable file whose checksum does not match the actual file contents) be replaced.</span></span>

 

 



