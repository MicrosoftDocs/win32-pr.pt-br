---
description: O PUASample.msi de exemplo é um exemplo de um pacote de Windows Installer 5,0 de uso duplo que é capaz de ser instalado no contexto de instalação por usuário ou por computador no Windows Server 2008 R2 e no Windows 7.
ms.assetid: be018e8a-ca5f-4135-a019-970ec4173f23
title: Exemplo de criação de pacote único
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e0ed56b8d7aaf8793416ba3ecab24c1f2a48ffe
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105749779"
---
# <a name="single-package-authoring-example"></a><span data-ttu-id="dd496-103">Exemplo de criação de pacote único</span><span class="sxs-lookup"><span data-stu-id="dd496-103">Single Package Authoring Example</span></span>

<span data-ttu-id="dd496-104">O PUASample.msi de exemplo é um exemplo de um pacote de Windows Installer 5,0 de uso duplo que é capaz de ser instalado no [contexto de instalação](installation-context.md) por usuário ou por computador no windows Server 2008 R2 e no Windows 7.</span><span class="sxs-lookup"><span data-stu-id="dd496-104">The sample PUASample.msi is an example of a dual-purpose Windows Installer 5.0 package that is capable of being installed in either the per-user or per-machine [installation context](installation-context.md) on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="dd496-105">Este pacote de exemplo segue as diretrizes de desenvolvimento descritas em [criação de pacote único](single-package-authoring.md).</span><span class="sxs-lookup"><span data-stu-id="dd496-105">This sample package follows the development guidelines described in [Single Package Authoring](single-package-authoring.md).</span></span>

## <a name="obtaining-a-copy-of-the-sample"></a><span data-ttu-id="dd496-106">Obtendo uma cópia do exemplo</span><span class="sxs-lookup"><span data-stu-id="dd496-106">Obtaining a copy of the sample</span></span>

<span data-ttu-id="dd496-107">Uma cópia deste exemplo e um Windows Installer editor de tabela de banco de dados, Orca.exe, estão nos [componentes SDK do Windows para os desenvolvedores de Windows Installer](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="dd496-107">A copy of this sample and a Windows Installer database table editor, Orca.exe, are in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="dd496-108">O editor de exemplo e tabela é fornecido com o kit de desenvolvimento de software do Windows para Windows Server 2008 R2 e Windows 7 como os arquivos de instalação do Windows Installer PUASample1.msi e Orca.msi.</span><span class="sxs-lookup"><span data-stu-id="dd496-108">The sample and table editor are provided with the Windows Software Development Kit for Windows Server 2008 R2 and Windows 7 as the Windows Installer installation files PUASample1.msi and Orca.msi.</span></span>

## <a name="system-requirements"></a><span data-ttu-id="dd496-109">Requisitos do Sistema</span><span class="sxs-lookup"><span data-stu-id="dd496-109">System Requirements</span></span>

<span data-ttu-id="dd496-110">O editor de banco de dados, [Orca.exe](orca-exe.md), requer o windows Server 2008 R2 e versões anteriores e o Windows 7 e versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="dd496-110">The database editor, [Orca.exe](orca-exe.md), requires Windows Server 2008 R2 and earlier and Windows 7 and earlier.</span></span> <span data-ttu-id="dd496-111">O pacote de uso duplo, PUASample1.msi, pode ser instalado no [contexto de instalação](installation-context.md) por computador ou por usuário no windows Server 2008 R2 e no Windows 7.</span><span class="sxs-lookup"><span data-stu-id="dd496-111">The dual-purpose package, PUASample1.msi, can be installed in either the per-machine or per-user [installation context](installation-context.md) on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="dd496-112">PUASample1.msi pode ser instalado somente no contexto por máquina no Windows Server 2008 e versões anteriores e no Windows Vista e versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="dd496-112">PUASample1.msi can be installed only in the per-machine context on Windows Server 2008 and earlier and Windows Vista and earlier.</span></span> <span data-ttu-id="dd496-113">Você pode instalar o editor de banco de dados para examinar o conteúdo de PUASample1.msi sem instalar o exemplo.</span><span class="sxs-lookup"><span data-stu-id="dd496-113">You can install the database editor to examine the contents of PUASample1.msi without installing the sample.</span></span> <span data-ttu-id="dd496-114">Para instalar os pacotes de exemplo ou editor, verifique se a política [DisableMSI](disablemsi.md) não está definida como um valor que bloqueia as instalações de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="dd496-114">To install the sample or editor packages, ensure that the [DisableMSI](disablemsi.md) policy is not set to a value that blocks application installations.</span></span>

## <a name="identifying-a-dual-purpose-package"></a><span data-ttu-id="dd496-115">Identificando um pacote de Dual-Purpose</span><span class="sxs-lookup"><span data-stu-id="dd496-115">Identifying a Dual-Purpose Package</span></span>

<span data-ttu-id="dd496-116">Os pacotes de uso duplo devem inicializar o valor da propriedade [**MSIINSTALLPERUSER**](msiinstallperuser.md) como 1.</span><span class="sxs-lookup"><span data-stu-id="dd496-116">Dual-purpose packages should initialize the value of the [**MSIINSTALLPERUSER**](msiinstallperuser.md) property to 1.</span></span> <span data-ttu-id="dd496-117">Isso identifica o pacote como sendo capaz de ser instalado no contexto por computador ou por usuário no Windows Server 2008 R2 e no Windows 7.</span><span class="sxs-lookup"><span data-stu-id="dd496-117">This identifies the package as capable of being installed in either the per-machine or per-user context on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="dd496-118">Defina a propriedade **MSIINSTALLPERUSER** no pacote somente se ele tiver sido escrito seguindo as diretrizes de desenvolvimento descritas em [criação de pacote único](single-package-authoring.md) e se você pretende fornecer aos usuários a opção de instalar o pacote no contexto por usuário ou por máquina.</span><span class="sxs-lookup"><span data-stu-id="dd496-118">Set the **MSIINSTALLPERUSER** property in the package only if it has been written following the development guidelines described in [Single Package Authoring](single-package-authoring.md) and if you intend to provide users with the option to install the package in either the per-user or per-machine context.</span></span> <span data-ttu-id="dd496-119">Um pacote de uso duplo também deve inicializar o valor da propriedade [**AllUsers**](allusers.md) como 2.</span><span class="sxs-lookup"><span data-stu-id="dd496-119">A dual-purpose package should also initialize the value of the [**ALLUSERS**](allusers.md) property to 2.</span></span> <span data-ttu-id="dd496-120">Isso especifica por usuário como o contexto de instalação padrão para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dd496-120">This specifies per-user as the default installation context for the application.</span></span> <span data-ttu-id="dd496-121">Se o valor da propriedade **AllUsers** for qualquer valor diferente de 2, Windows Installer ignorará a propriedade **MSIINSTALLPERUSER** .</span><span class="sxs-lookup"><span data-stu-id="dd496-121">If the value of the **ALLUSERS** property is any value other than 2, Windows Installer ignores the **MSIINSTALLPERUSER** property.</span></span>

<span data-ttu-id="dd496-122">Use um editor de banco de dados Windows Installer, como [Orca.exe](orca-exe.md), para examinar o conteúdo de PUASample1.msi.</span><span class="sxs-lookup"><span data-stu-id="dd496-122">Use a Windows Installer database editor, such as [Orca.exe](orca-exe.md), to examine the contents of PUASample1.msi.</span></span> <span data-ttu-id="dd496-123">A tabela de [Propriedades](property-table.md) no pacote de exemplo contém as duas entradas a seguir.</span><span class="sxs-lookup"><span data-stu-id="dd496-123">The [Property](property-table.md) table in the sample package contains the following two entries.</span></span>

<span data-ttu-id="dd496-124">[Propriedade](property-table.md) Tabela (parcial)</span><span class="sxs-lookup"><span data-stu-id="dd496-124">[Property](property-table.md) Table (partial)</span></span>

| <span data-ttu-id="dd496-125">Propriedade</span><span class="sxs-lookup"><span data-stu-id="dd496-125">Property</span></span>          | <span data-ttu-id="dd496-126">Valor</span><span class="sxs-lookup"><span data-stu-id="dd496-126">Value</span></span> |
|-------------------|-------|
| <span data-ttu-id="dd496-127">ALLUSERS</span><span class="sxs-lookup"><span data-stu-id="dd496-127">ALLUSERS</span></span>          | <span data-ttu-id="dd496-128">2</span><span class="sxs-lookup"><span data-stu-id="dd496-128">2</span></span>     |
| <span data-ttu-id="dd496-129">MSIINSTALLPERUSER</span><span class="sxs-lookup"><span data-stu-id="dd496-129">MSIINSTALLPERUSER</span></span> | <span data-ttu-id="dd496-130">1</span><span class="sxs-lookup"><span data-stu-id="dd496-130">1</span></span>     |



 

## <a name="custom-dialog-box-for-installation-context"></a><span data-ttu-id="dd496-131">Caixa de diálogo personalizada para contexto de instalação</span><span class="sxs-lookup"><span data-stu-id="dd496-131">Custom Dialog Box for Installation Context</span></span>

<span data-ttu-id="dd496-132">A [interface do usuário](user-interface.md) do pacote de exemplo inclui um exemplo de uma caixa de diálogo personalizada, VerifyReadyDialog, que permite aos usuários selecionar o contexto de instalação por usuário ou por máquina no momento da instalação.</span><span class="sxs-lookup"><span data-stu-id="dd496-132">The [user interface](user-interface.md) of the sample package includes an example of a custom dialog box, VerifyReadyDialog, that enables users to select either the per-user or per-machine installation context at installation time.</span></span> <span data-ttu-id="dd496-133">A tabela de [diálogo](dialog-table.md) contém um registro que descreve a caixa de diálogo VerifyReadyDialog.</span><span class="sxs-lookup"><span data-stu-id="dd496-133">The [Dialog](dialog-table.md) table contains a record that describes the VerifyReadyDialog dialog box.</span></span> <span data-ttu-id="dd496-134">O valor inserido no campo atributos é 39 porque essa caixa de diálogo usa os [bits de estilo de caixa de diálogo](dialog-style-bits.md)msidbDialogAttributesVisible (1), msidbDialogAttributesModal (2), msidbDialogAttributesMinimize (4) e msidbDialogAttributesTrackDiskSpace (32).</span><span class="sxs-lookup"><span data-stu-id="dd496-134">The value entered in the Attributes field is 39 because this dialog box uses the msidbDialogAttributesVisible (1), msidbDialogAttributesModal (2), msidbDialogAttributesMinimize (4), and msidbDialogAttributesTrackDiskSpace (32) [dialog style bits](dialog-style-bits.md).</span></span> <span data-ttu-id="dd496-135">A barra de título da caixa de diálogo exibe um título fornecido pelo valor da propriedade [**ProductName**](productname.md) .</span><span class="sxs-lookup"><span data-stu-id="dd496-135">The title bar of the dialog box displays a title given by the value of the [**ProductName**](productname.md) property.</span></span>

<span data-ttu-id="dd496-136">[Caixa de diálogo](dialog-table.md) Tabela (parcial)</span><span class="sxs-lookup"><span data-stu-id="dd496-136">[Dialog](dialog-table.md) Table (partial)</span></span> 

| <span data-ttu-id="dd496-137">caixa de diálogo</span><span class="sxs-lookup"><span data-stu-id="dd496-137">Dialog</span></span>            | <span data-ttu-id="dd496-138">HCentering</span><span class="sxs-lookup"><span data-stu-id="dd496-138">HCentering</span></span> | <span data-ttu-id="dd496-139">VCentering</span><span class="sxs-lookup"><span data-stu-id="dd496-139">VCentering</span></span> | <span data-ttu-id="dd496-140">Largura</span><span class="sxs-lookup"><span data-stu-id="dd496-140">Width</span></span> | <span data-ttu-id="dd496-141">Altura</span><span class="sxs-lookup"><span data-stu-id="dd496-141">Height</span></span> | <span data-ttu-id="dd496-142">Atributos</span><span class="sxs-lookup"><span data-stu-id="dd496-142">Attributes</span></span> | <span data-ttu-id="dd496-143">Título</span><span class="sxs-lookup"><span data-stu-id="dd496-143">Title</span></span>           | <span data-ttu-id="dd496-144">Controlar \_ primeiro</span><span class="sxs-lookup"><span data-stu-id="dd496-144">Control\_First</span></span> | <span data-ttu-id="dd496-145">Padrão de controle \_</span><span class="sxs-lookup"><span data-stu-id="dd496-145">Control\_Default</span></span> | <span data-ttu-id="dd496-146">\_Cancelar controle</span><span class="sxs-lookup"><span data-stu-id="dd496-146">Control\_Cancel</span></span> |
|-------------------|------------|------------|-------|--------|------------|-----------------|----------------|------------------|-----------------|
| <span data-ttu-id="dd496-147">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-147">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-148">50</span><span class="sxs-lookup"><span data-stu-id="dd496-148">50</span></span>         | <span data-ttu-id="dd496-149">50</span><span class="sxs-lookup"><span data-stu-id="dd496-149">50</span></span>         | <span data-ttu-id="dd496-150">480</span><span class="sxs-lookup"><span data-stu-id="dd496-150">480</span></span>   | <span data-ttu-id="dd496-151">280</span><span class="sxs-lookup"><span data-stu-id="dd496-151">280</span></span>    | <span data-ttu-id="dd496-152">39</span><span class="sxs-lookup"><span data-stu-id="dd496-152">39</span></span>         | <span data-ttu-id="dd496-153">\[ProductName\]</span><span class="sxs-lookup"><span data-stu-id="dd496-153">\[ProductName\]</span></span> | <span data-ttu-id="dd496-154">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="dd496-154">InstallPerUser</span></span> | <span data-ttu-id="dd496-155">Avançar</span><span class="sxs-lookup"><span data-stu-id="dd496-155">Next</span></span>             | <span data-ttu-id="dd496-156">Cancelar</span><span class="sxs-lookup"><span data-stu-id="dd496-156">Cancel</span></span>          |



 

<span data-ttu-id="dd496-157">A tabela de [controle](control-table.md) contém entradas para os [controles](controls.md) exibidos pela caixa de diálogo VerifyReadyDialog.</span><span class="sxs-lookup"><span data-stu-id="dd496-157">The [Control](control-table.md) table contains entries for the [controls](controls.md) displayed by the VerifyReadyDialog dialog box.</span></span> <span data-ttu-id="dd496-158">A caixa de diálogo exibe controles de [pressão](pushbutton-control.md) e um controle de [texto](text-control.md) .</span><span class="sxs-lookup"><span data-stu-id="dd496-158">The dialog box displays [PushButton](pushbutton-control.md) controls and a [Text](text-control.md) control.</span></span> <span data-ttu-id="dd496-159">Todos os controles usam os [atributos de controle](control-attributes.md)msidbControlAttributesEnabled (2) e msidbControlAttributesVisible (1).</span><span class="sxs-lookup"><span data-stu-id="dd496-159">All the controls use the msidbControlAttributesEnabled (2) and msidbControlAttributesVisible (1) [control attributes](control-attributes.md).</span></span> <span data-ttu-id="dd496-160">O controle InstallPerMachine também usa o atributo de controle [ElevationShield](elevationshield-attribute.md) , msidbControlAttributesElevationShield (8388608.) Esse atributo de controle adiciona o ícone de elevação do UAC ( [*controle de conta de usuário*](u-gly.md) ) (ícone de escudo) ao controle InstallPerMachine e informa ao usuário que as credenciais do UAC são necessárias para instalar o aplicativo no contexto por máquina.</span><span class="sxs-lookup"><span data-stu-id="dd496-160">The InstallPerMachine control also uses the [ElevationShield](elevationshield-attribute.md) control attribute, msidbControlAttributesElevationShield (8388608.) This control attribute adds the [*User Account Control*](u-gly.md) (UAC) elevation icon (shield icon) to the InstallPerMachine control and informs the user that UAC credentials are required to install the application in the per-machine context.</span></span> <span data-ttu-id="dd496-161">O valor no campo de texto da tabela de controle é o texto e o estilo de texto exibidos pelo controle.</span><span class="sxs-lookup"><span data-stu-id="dd496-161">The value in the Text field of the Control table is the text-style and text displayed by the control.</span></span> <span data-ttu-id="dd496-162">Consulte a descrição do campo de texto no tópico da tabela de controle para obter mais informações sobre como adicionar texto a um controle usando estilos predefinidos.</span><span class="sxs-lookup"><span data-stu-id="dd496-162">See the description of the Text field in the Control table topic for more information about adding text to a control using predefined styles.</span></span>

<span data-ttu-id="dd496-163">[Controle](control-table.md) do Tabela (parcial)</span><span class="sxs-lookup"><span data-stu-id="dd496-163">[Control](control-table.md) Table (partial)</span></span>

| <span data-ttu-id="dd496-164">caixa de diálogo\_</span><span class="sxs-lookup"><span data-stu-id="dd496-164">Dialog\_</span></span>          | <span data-ttu-id="dd496-165">Control</span><span class="sxs-lookup"><span data-stu-id="dd496-165">Control</span></span>           | <span data-ttu-id="dd496-166">Tipo</span><span class="sxs-lookup"><span data-stu-id="dd496-166">Type</span></span>       | <span data-ttu-id="dd496-167">Atributo</span><span class="sxs-lookup"><span data-stu-id="dd496-167">Attribute</span></span> | <span data-ttu-id="dd496-168">Texto</span><span class="sxs-lookup"><span data-stu-id="dd496-168">Text</span></span>                                                   | <span data-ttu-id="dd496-169">\_Próximo controle</span><span class="sxs-lookup"><span data-stu-id="dd496-169">Control\_Next</span></span>     |
|-------------------|-------------------|------------|-----------|--------------------------------------------------------|-------------------|
| <span data-ttu-id="dd496-170">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-170">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-171">Cancelar</span><span class="sxs-lookup"><span data-stu-id="dd496-171">Cancel</span></span>            | <span data-ttu-id="dd496-172">Botão</span><span class="sxs-lookup"><span data-stu-id="dd496-172">PushButton</span></span> | <span data-ttu-id="dd496-173">3</span><span class="sxs-lookup"><span data-stu-id="dd496-173">3</span></span>         | <span data-ttu-id="dd496-174">{ \\ Tahoma10} &cancelar</span><span class="sxs-lookup"><span data-stu-id="dd496-174">{\\Tahoma10}&Cancel</span></span>                                    | <span data-ttu-id="dd496-175">Avançar</span><span class="sxs-lookup"><span data-stu-id="dd496-175">Next</span></span>              |
| <span data-ttu-id="dd496-176">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-176">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-177">Anterior</span><span class="sxs-lookup"><span data-stu-id="dd496-177">Previous</span></span>          | <span data-ttu-id="dd496-178">Botão</span><span class="sxs-lookup"><span data-stu-id="dd496-178">PushButton</span></span> | <span data-ttu-id="dd496-179">3</span><span class="sxs-lookup"><span data-stu-id="dd496-179">3</span></span>         | <span data-ttu-id="dd496-180">{ \\ Tahoma10} <<&anterior</span><span class="sxs-lookup"><span data-stu-id="dd496-180">{\\Tahoma10}<<&Previous</span></span>                          | <span data-ttu-id="dd496-181">Cancelar</span><span class="sxs-lookup"><span data-stu-id="dd496-181">Cancel</span></span>            |
| <span data-ttu-id="dd496-182">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-182">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-183">Avançar</span><span class="sxs-lookup"><span data-stu-id="dd496-183">Next</span></span>              | <span data-ttu-id="dd496-184">Botão</span><span class="sxs-lookup"><span data-stu-id="dd496-184">PushButton</span></span> | <span data-ttu-id="dd496-185">3</span><span class="sxs-lookup"><span data-stu-id="dd496-185">3</span></span>         | <span data-ttu-id="dd496-186">{ \\ Tahoma10} &próximo >></span><span class="sxs-lookup"><span data-stu-id="dd496-186">{\\Tahoma10}&Next >></span></span>                             | <span data-ttu-id="dd496-187">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="dd496-187">InstallPerUser</span></span>    |
| <span data-ttu-id="dd496-188">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-188">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-189">Text2</span><span class="sxs-lookup"><span data-stu-id="dd496-189">Text2</span></span>             | <span data-ttu-id="dd496-190">Texto</span><span class="sxs-lookup"><span data-stu-id="dd496-190">Text</span></span>       | <span data-ttu-id="dd496-191">3</span><span class="sxs-lookup"><span data-stu-id="dd496-191">3</span></span>         | <span data-ttu-id="dd496-192">Você está pronto para concluir a instalação suspensa?</span><span class="sxs-lookup"><span data-stu-id="dd496-192">Are you ready to complete your suspended installation?</span></span> |                   |
| <span data-ttu-id="dd496-193">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-193">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-194">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="dd496-194">InstallPerUser</span></span>    | <span data-ttu-id="dd496-195">Botão</span><span class="sxs-lookup"><span data-stu-id="dd496-195">PushButton</span></span> | <span data-ttu-id="dd496-196">3</span><span class="sxs-lookup"><span data-stu-id="dd496-196">3</span></span>         | <span data-ttu-id="dd496-197">{ \\ Tahoma10} instalar somente para o &me</span><span class="sxs-lookup"><span data-stu-id="dd496-197">{\\Tahoma10}Install Only for &Me</span></span>                       | <span data-ttu-id="dd496-198">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="dd496-198">InstallPerMachine</span></span> |
| <span data-ttu-id="dd496-199">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-199">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-200">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="dd496-200">InstallPerMachine</span></span> | <span data-ttu-id="dd496-201">Botão</span><span class="sxs-lookup"><span data-stu-id="dd496-201">PushButton</span></span> | <span data-ttu-id="dd496-202">8388611</span><span class="sxs-lookup"><span data-stu-id="dd496-202">8388611</span></span>   | <span data-ttu-id="dd496-203">{ \\ Tahoma10} instalar para &todos</span><span class="sxs-lookup"><span data-stu-id="dd496-203">{\\Tahoma10}Install for &Everyone</span></span>                      | <span data-ttu-id="dd496-204">Anterior</span><span class="sxs-lookup"><span data-stu-id="dd496-204">Previous</span></span>          |
| <span data-ttu-id="dd496-205">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-205">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-206">Cancelar</span><span class="sxs-lookup"><span data-stu-id="dd496-206">Cancel</span></span>            | <span data-ttu-id="dd496-207">Botão</span><span class="sxs-lookup"><span data-stu-id="dd496-207">PushButton</span></span> | <span data-ttu-id="dd496-208">3</span><span class="sxs-lookup"><span data-stu-id="dd496-208">3</span></span>         | <span data-ttu-id="dd496-209">{ \\ Tahoma10} &cancelar</span><span class="sxs-lookup"><span data-stu-id="dd496-209">{\\Tahoma10}&Cancel</span></span>                                    | <span data-ttu-id="dd496-210">Avançar</span><span class="sxs-lookup"><span data-stu-id="dd496-210">Next</span></span>              |



 

<span data-ttu-id="dd496-211">A tabela [ControlEvent,](controlevent-table.md) especifica o [ControlEvents](control-events.md), ou as ações, que o instalador executa quando o usuário interage com um controle.</span><span class="sxs-lookup"><span data-stu-id="dd496-211">The [ControlEvent](controlevent-table.md) table specifies the [ControlEvents](control-events.md), or actions, the installer performs when the user interacts with a control.</span></span> <span data-ttu-id="dd496-212">Quando um usuário ativa o botão de pressão InstallPerUser, a interface do usuário exibe uma caixa de diálogo OutOfDisk se a propriedade [**OutOfDiskSpace**](outofdiskspace.md) for 1, define o valor da propriedade [**MSIINSTALLPERUSER**](msiinstallperuser.md) como 1, define o valor da propriedade [**AllUsers**](allusers.md) como 2, define a propriedade [**MSIFASTINSTALL**](msifastinstall.md) como 1 e retorna.</span><span class="sxs-lookup"><span data-stu-id="dd496-212">When a user activates the InstallPerUser pushbutton, the user interface displays an OutOfDisk dialog box if the [**OutOfDiskSpace**](outofdiskspace.md) property is 1, sets the value of the [**MSIINSTALLPERUSER**](msiinstallperuser.md) property to 1, sets the value of the [**ALLUSERS**](allusers.md) property to 2, sets the [**MSIFASTINSTALL**](msifastinstall.md) property to 1, and returns .</span></span> <span data-ttu-id="dd496-213">Como a propriedade **MSIFASTINSTALL** está definida, nenhum ponto de restauração do sistema é gerado para a instalação.</span><span class="sxs-lookup"><span data-stu-id="dd496-213">Because the **MSIFASTINSTALL** property is set, no System Restore point is generated for the installation.</span></span> <span data-ttu-id="dd496-214">Quando um usuário ativa o botão de pressão InstallPerMachine, a interface do usuário exibe uma caixa de diálogo OutOfDisk se a propriedade **OutOfDiskSpace** for 1, define o valor da propriedade **AllUsers** como 1 e retorna.</span><span class="sxs-lookup"><span data-stu-id="dd496-214">When a user activates the InstallPerMachine pushbutton, the user interface displays an OutOfDisk dialog box if the **OutOfDiskSpace** property is 1, sets the value of the **ALLUSERS** property to 1, and returns.</span></span>

<span data-ttu-id="dd496-215">[ControlEvent,](controlevent-table.md) Tabela (parcial)</span><span class="sxs-lookup"><span data-stu-id="dd496-215">[ControlEvent](controlevent-table.md) Table (partial)</span></span> 

| <span data-ttu-id="dd496-216">caixa de diálogo\_</span><span class="sxs-lookup"><span data-stu-id="dd496-216">Dialog\_</span></span>          | <span data-ttu-id="dd496-217">controle\_</span><span class="sxs-lookup"><span data-stu-id="dd496-217">Control\_</span></span>         | <span data-ttu-id="dd496-218">Evento</span><span class="sxs-lookup"><span data-stu-id="dd496-218">Event</span></span>                 | <span data-ttu-id="dd496-219">Argumento</span><span class="sxs-lookup"><span data-stu-id="dd496-219">Argument</span></span>  | <span data-ttu-id="dd496-220">Condição</span><span class="sxs-lookup"><span data-stu-id="dd496-220">Condition</span></span>                 | <span data-ttu-id="dd496-221">Ordem</span><span class="sxs-lookup"><span data-stu-id="dd496-221">Order</span></span> |
|-------------------|-------------------|-----------------------|-----------|---------------------------|-------|
| <span data-ttu-id="dd496-222">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-222">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-223">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="dd496-223">InstallPerUser</span></span>    | <span data-ttu-id="dd496-224">SpawnDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-224">SpawnDialog</span></span>           | <span data-ttu-id="dd496-225">OutOfDisk</span><span class="sxs-lookup"><span data-stu-id="dd496-225">OutOfDisk</span></span> | <span data-ttu-id="dd496-226">OutOfDiskSpace = 1</span><span class="sxs-lookup"><span data-stu-id="dd496-226">OutOfDiskSpace = 1</span></span>        | <span data-ttu-id="dd496-227">1</span><span class="sxs-lookup"><span data-stu-id="dd496-227">1</span></span>     |
| <span data-ttu-id="dd496-228">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-228">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-229">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="dd496-229">InstallPerUser</span></span>    | <span data-ttu-id="dd496-230">EndDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-230">EndDialog</span></span>             | <span data-ttu-id="dd496-231">Retorno</span><span class="sxs-lookup"><span data-stu-id="dd496-231">Return</span></span>    | <span data-ttu-id="dd496-232">OutOfDiskSpace <> 1</span><span class="sxs-lookup"><span data-stu-id="dd496-232">OutOfDiskSpace <> 1</span></span> | <span data-ttu-id="dd496-233">5</span><span class="sxs-lookup"><span data-stu-id="dd496-233">5</span></span>     |
| <span data-ttu-id="dd496-234">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-234">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-235">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="dd496-235">InstallPerUser</span></span>    | <span data-ttu-id="dd496-236">\[MSIINSTALLPERUSER\]</span><span class="sxs-lookup"><span data-stu-id="dd496-236">\[MSIINSTALLPERUSER\]</span></span> | <span data-ttu-id="dd496-237">1</span><span class="sxs-lookup"><span data-stu-id="dd496-237">1</span></span>         | <span data-ttu-id="dd496-238">1</span><span class="sxs-lookup"><span data-stu-id="dd496-238">1</span></span>                         | <span data-ttu-id="dd496-239">2</span><span class="sxs-lookup"><span data-stu-id="dd496-239">2</span></span>     |
| <span data-ttu-id="dd496-240">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-240">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-241">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="dd496-241">InstallPerUser</span></span>    | <span data-ttu-id="dd496-242">\[ALLUSERS\]</span><span class="sxs-lookup"><span data-stu-id="dd496-242">\[ALLUSERS\]</span></span>          | <span data-ttu-id="dd496-243">2</span><span class="sxs-lookup"><span data-stu-id="dd496-243">2</span></span>         | <span data-ttu-id="dd496-244">1</span><span class="sxs-lookup"><span data-stu-id="dd496-244">1</span></span>                         | <span data-ttu-id="dd496-245">3</span><span class="sxs-lookup"><span data-stu-id="dd496-245">3</span></span>     |
| <span data-ttu-id="dd496-246">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-246">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-247">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="dd496-247">InstallPerMachine</span></span> | <span data-ttu-id="dd496-248">SpawnDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-248">SpawnDialog</span></span>           | <span data-ttu-id="dd496-249">OutOfDisk</span><span class="sxs-lookup"><span data-stu-id="dd496-249">OutOfDisk</span></span> | <span data-ttu-id="dd496-250">OutOfDiskSpace = 1</span><span class="sxs-lookup"><span data-stu-id="dd496-250">OutOfDiskSpace = 1</span></span>        | <span data-ttu-id="dd496-251">1</span><span class="sxs-lookup"><span data-stu-id="dd496-251">1</span></span>     |
| <span data-ttu-id="dd496-252">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-252">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-253">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="dd496-253">InstallPerMachine</span></span> | <span data-ttu-id="dd496-254">EndDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-254">EndDialog</span></span>             | <span data-ttu-id="dd496-255">Retorno</span><span class="sxs-lookup"><span data-stu-id="dd496-255">Return</span></span>    | <span data-ttu-id="dd496-256">OutOfDiskSpace <> 1</span><span class="sxs-lookup"><span data-stu-id="dd496-256">OutOfDiskSpace <> 1</span></span> | <span data-ttu-id="dd496-257">3</span><span class="sxs-lookup"><span data-stu-id="dd496-257">3</span></span>     |
| <span data-ttu-id="dd496-258">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-258">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-259">InstallPerMachine</span><span class="sxs-lookup"><span data-stu-id="dd496-259">InstallPerMachine</span></span> | <span data-ttu-id="dd496-260">\[ALLUSERS\]</span><span class="sxs-lookup"><span data-stu-id="dd496-260">\[ALLUSERS\]</span></span>          | <span data-ttu-id="dd496-261">1</span><span class="sxs-lookup"><span data-stu-id="dd496-261">1</span></span>         | <span data-ttu-id="dd496-262">1</span><span class="sxs-lookup"><span data-stu-id="dd496-262">1</span></span>                         | <span data-ttu-id="dd496-263">2</span><span class="sxs-lookup"><span data-stu-id="dd496-263">2</span></span>     |
| <span data-ttu-id="dd496-264">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-264">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-265">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="dd496-265">InstallPerUser</span></span>    | <span data-ttu-id="dd496-266">\[MSIFASTINSTALL\]</span><span class="sxs-lookup"><span data-stu-id="dd496-266">\[MSIFASTINSTALL\]</span></span>    | <span data-ttu-id="dd496-267">1</span><span class="sxs-lookup"><span data-stu-id="dd496-267">1</span></span>         | <span data-ttu-id="dd496-268">1</span><span class="sxs-lookup"><span data-stu-id="dd496-268">1</span></span>                         | <span data-ttu-id="dd496-269">4</span><span class="sxs-lookup"><span data-stu-id="dd496-269">4</span></span>     |



 

<span data-ttu-id="dd496-270">O controle InstallPerUser deve ser removido da interface do usuário de qualquer instalação usando uma versão Windows Installer anterior à Windows Installer Windows Installer 5,0.</span><span class="sxs-lookup"><span data-stu-id="dd496-270">The InstallPerUser control should be removed from the user interface of any installation using a Windows Installer version earlier than Windows Installer Windows Installer 5.0.</span></span> <span data-ttu-id="dd496-271">A tabela [ControlCondition](controlcondition-table.md) no pacote de exemplo contém quatro entradas que desabilitam e ocultam o controle InstallPerUser se a versão atual for menor que Windows Installer 5,0.</span><span class="sxs-lookup"><span data-stu-id="dd496-271">The [ControlCondition](controlcondition-table.md) table in the sample package contains four entries that disable and hide the InstallPerUser control if the current version is less than Windows Installer 5.0.</span></span> <span data-ttu-id="dd496-272">A tabela usa o valor da propriedade [**VersionMsi**](versionmsi.md) e a [sintaxe de instrução condicional](conditional-statement-syntax.md) para definir essa condição.</span><span class="sxs-lookup"><span data-stu-id="dd496-272">The table uses the value of the [**VersionMsi**](versionmsi.md) property and the [conditional statement syntax](conditional-statement-syntax.md) to define this condition.</span></span> <span data-ttu-id="dd496-273">A ação especificada no campo ação será executada somente se a instrução no campo condição for verdadeira.</span><span class="sxs-lookup"><span data-stu-id="dd496-273">The action specified in the Action field is performed only if the statement in the Condition field is true.</span></span>

<span data-ttu-id="dd496-274">[ControlCondition](controlcondition-table.md) Tabela (parcial)</span><span class="sxs-lookup"><span data-stu-id="dd496-274">[ControlCondition](controlcondition-table.md) Table (partial)</span></span>

| <span data-ttu-id="dd496-275">caixa de diálogo\_</span><span class="sxs-lookup"><span data-stu-id="dd496-275">Dialog\_</span></span>          | <span data-ttu-id="dd496-276">controle\_</span><span class="sxs-lookup"><span data-stu-id="dd496-276">Control\_</span></span>      | <span data-ttu-id="dd496-277">Ação</span><span class="sxs-lookup"><span data-stu-id="dd496-277">Action</span></span>  | <span data-ttu-id="dd496-278">Condição</span><span class="sxs-lookup"><span data-stu-id="dd496-278">Condition</span></span>               |
|-------------------|----------------|---------|-------------------------|
| <span data-ttu-id="dd496-279">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-279">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-280">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="dd496-280">InstallPerUser</span></span> | <span data-ttu-id="dd496-281">Habilitar</span><span class="sxs-lookup"><span data-stu-id="dd496-281">Enable</span></span>  | <span data-ttu-id="dd496-282">VersionMsi >= "5, 0"</span><span class="sxs-lookup"><span data-stu-id="dd496-282">VersionMsi >= "5.00"</span></span> |
| <span data-ttu-id="dd496-283">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-283">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-284">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="dd496-284">InstallPerUser</span></span> | <span data-ttu-id="dd496-285">Desabilitar</span><span class="sxs-lookup"><span data-stu-id="dd496-285">Disable</span></span> | <span data-ttu-id="dd496-286">VersionMsi < "5, 0"</span><span class="sxs-lookup"><span data-stu-id="dd496-286">VersionMsi < "5.00"</span></span>  |
| <span data-ttu-id="dd496-287">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-287">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-288">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="dd496-288">InstallPerUser</span></span> | <span data-ttu-id="dd496-289">Mostrar</span><span class="sxs-lookup"><span data-stu-id="dd496-289">Show</span></span>    | <span data-ttu-id="dd496-290">VersionMsi >= "5, 0"</span><span class="sxs-lookup"><span data-stu-id="dd496-290">VersionMsi >= "5.00"</span></span> |
| <span data-ttu-id="dd496-291">VerifyReadyDialog</span><span class="sxs-lookup"><span data-stu-id="dd496-291">VerifyReadyDialog</span></span> | <span data-ttu-id="dd496-292">InstallPerUser</span><span class="sxs-lookup"><span data-stu-id="dd496-292">InstallPerUser</span></span> | <span data-ttu-id="dd496-293">Ocultar</span><span class="sxs-lookup"><span data-stu-id="dd496-293">Hide</span></span>    | <span data-ttu-id="dd496-294">VersionMsi < "5, 0"</span><span class="sxs-lookup"><span data-stu-id="dd496-294">VersionMsi < "5.00"</span></span>  |



 

## <a name="specifying-directory-structure"></a><span data-ttu-id="dd496-295">Especificando a estrutura do diretório</span><span class="sxs-lookup"><span data-stu-id="dd496-295">Specifying Directory Structure</span></span>

<span data-ttu-id="dd496-296">Use o editor de banco de dados para examinar a tabela de PUASample1.msi de [diretórios](directory-table.md) .</span><span class="sxs-lookup"><span data-stu-id="dd496-296">Use the database editor to examine the [Directory](directory-table.md) table of PUASample1.msi.</span></span> <span data-ttu-id="dd496-297">O registro da tabela de diretórios que tem uma cadeia de caracteres vazia em seu \_ campo pai do diretório representa o diretório raiz das árvores de diretórios de origem e de destino.</span><span class="sxs-lookup"><span data-stu-id="dd496-297">The record of the Directory Table having an empty string in its Directory\_Parent field represents the root directory of both the source and target directory trees.</span></span> <span data-ttu-id="dd496-298">Se a propriedade [**TARGETDIR**](targetdir.md) for indefinida, o instalador definirá seu valor no momento da instalação para o valor da propriedade [**ROOTDRIVE**](rootdrive.md) .</span><span class="sxs-lookup"><span data-stu-id="dd496-298">If the [**TARGETDIR**](targetdir.md) property is undefined, the installer sets its value at installation time to the value of the [**ROOTDRIVE**](rootdrive.md) property.</span></span> <span data-ttu-id="dd496-299">Se a propriedade [**SourceDir**](sourcedir.md) for indefinida, o instalador definirá seu valor como o local do diretório que contém o pacote de Windows Installer (arquivo. msi). Os nomes de diretório são especificados usando o \| formato curto longo.</span><span class="sxs-lookup"><span data-stu-id="dd496-299">If the [**SourceDir**](sourcedir.md) property is undefined, the installer sets its value to the location of the directory containing the Windows Installer package (.msi file.) The directory names are specified using the short\|long format.</span></span>

<span data-ttu-id="dd496-300">[Do diretório](directory-table.md) Tabela (parcial)</span><span class="sxs-lookup"><span data-stu-id="dd496-300">[Directory](directory-table.md) Table (partial)</span></span>

| <span data-ttu-id="dd496-301">Diretório</span><span class="sxs-lookup"><span data-stu-id="dd496-301">Directory</span></span>          | <span data-ttu-id="dd496-302">Pai do diretório \_</span><span class="sxs-lookup"><span data-stu-id="dd496-302">Directory\_Parent</span></span>  | <span data-ttu-id="dd496-303">DefaultDir</span><span class="sxs-lookup"><span data-stu-id="dd496-303">DefaultDir</span></span>               |
|--------------------|--------------------|--------------------------|
| <span data-ttu-id="dd496-304">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="dd496-304">TARGETDIR</span></span>          |                    | <span data-ttu-id="dd496-305">SourceDir</span><span class="sxs-lookup"><span data-stu-id="dd496-305">SourceDir</span></span>                |
| <span data-ttu-id="dd496-306">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="dd496-306">ProgramFilesFolder</span></span> | <span data-ttu-id="dd496-307">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="dd496-307">TARGETDIR</span></span>          | <span data-ttu-id="dd496-308">.</span><span class="sxs-lookup"><span data-stu-id="dd496-308">.</span></span>                        |
| <span data-ttu-id="dd496-309">ProgramMenuFolder</span><span class="sxs-lookup"><span data-stu-id="dd496-309">ProgramMenuFolder</span></span>  | <span data-ttu-id="dd496-310">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="dd496-310">TARGETDIR</span></span>          | <span data-ttu-id="dd496-311">.</span><span class="sxs-lookup"><span data-stu-id="dd496-311">.</span></span>                        |
| <span data-ttu-id="dd496-312">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="dd496-312">INSTALLLOCATION</span></span>    | <span data-ttu-id="dd496-313">Myvendor</span><span class="sxs-lookup"><span data-stu-id="dd496-313">MyVendor</span></span>           | <span data-ttu-id="dd496-314">Sample1 \| msdn – PUASample1</span><span class="sxs-lookup"><span data-stu-id="dd496-314">Sample1\|MSDN-PUASample1</span></span> |
| <span data-ttu-id="dd496-315">Myvendor</span><span class="sxs-lookup"><span data-stu-id="dd496-315">MyVendor</span></span>           | <span data-ttu-id="dd496-316">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="dd496-316">ProgramFilesFolder</span></span> | <span data-ttu-id="dd496-317">MSFT \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="dd496-317">Msft\|Microsoft</span></span>          |



 

<span data-ttu-id="dd496-318">Na origem, essa tabela de [diretório](directory-table.md) é resolvida para os seguintes caminhos de diretório.</span><span class="sxs-lookup"><span data-stu-id="dd496-318">At the source, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span>

<dl> <span data-ttu-id="dd496-319">\[\] \\ Sample1 do MSFT SourceDir \\</span><span class="sxs-lookup"><span data-stu-id="dd496-319">\[SourceDir\]\\Msft\\Sample1</span></span>  
<span data-ttu-id="dd496-320">\[SourceDir\]</span><span class="sxs-lookup"><span data-stu-id="dd496-320">\[SourceDir\]</span></span>  
</dl>

<span data-ttu-id="dd496-321">No destino, a tabela de [diretório](directory-table.md) é resolvida para os caminhos na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="dd496-321">At the target, the [Directory](directory-table.md) table resolves to the paths in the following table.</span></span> <span data-ttu-id="dd496-322">O instalador define os valores das propriedades [**ProgramFilesFolder**](programfilesfolder.md) e [**ProgramMenuFolder**](programmenufolder.md) para locais que dependem do contexto de [instalação](installation-context.md) e se o sistema é as versões de 32 bits ou 64 bits do Windows Server 2008 R2 e do Windows 7.</span><span class="sxs-lookup"><span data-stu-id="dd496-322">The installer sets the values of the [**ProgramFilesFolder**](programfilesfolder.md) and [**ProgramMenuFolder**](programmenufolder.md) properties to locations that depend upon the [installation context](installation-context.md) and whether the system is the 32-bit or 64-bit versions of Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="dd496-323">Os caminhos para as pastas de destino dependem se o usuário seleciona uma instalação por usuário ou por computador.</span><span class="sxs-lookup"><span data-stu-id="dd496-323">The paths to the target folders depend on whether the user selects a per-user or per-machine installation.</span></span>

| <span data-ttu-id="dd496-324">Contexto de instalação</span><span class="sxs-lookup"><span data-stu-id="dd496-324">Installation Context</span></span> | <span data-ttu-id="dd496-325">Sistema</span><span class="sxs-lookup"><span data-stu-id="dd496-325">System</span></span>                                                                              | <span data-ttu-id="dd496-326">Caminhos de exemplo</span><span class="sxs-lookup"><span data-stu-id="dd496-326">Example Paths</span></span>                                                                                                                    |
|----------------------|-------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="dd496-327">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="dd496-327">Per-Machine</span></span>          | <span data-ttu-id="dd496-328">Windows Server 2008 R2 e Windows 7</span><span class="sxs-lookup"><span data-stu-id="dd496-328">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="dd496-329">versão de 32 bits</span><span class="sxs-lookup"><span data-stu-id="dd496-329">32-bit version</span></span><br/>           | <span data-ttu-id="dd496-330">% ProgramFiles% \\ MSFT \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="dd496-330">%ProgramFiles%\\Msft\\Sample1</span></span><br/> <span data-ttu-id="dd496-331">\\ \\ \\ Programas de menu Iniciar do% ALLUSERSPROFILE% do Microsoft Windows \\</span><span class="sxs-lookup"><span data-stu-id="dd496-331">%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/>                  |
| <span data-ttu-id="dd496-332">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="dd496-332">Per-Machine</span></span>          | <span data-ttu-id="dd496-333">Windows Server 2008 R2 e Windows 7</span><span class="sxs-lookup"><span data-stu-id="dd496-333">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="dd496-334">versão de 64 bits</span><span class="sxs-lookup"><span data-stu-id="dd496-334">64-bit version</span></span><br/>           | <span data-ttu-id="dd496-335">% ProgramFiles (x86)% \\ MSFT \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="dd496-335">%ProgramFiles(x86)%\\Msft\\Sample1</span></span><br/> <span data-ttu-id="dd496-336">\\ \\ \\ Programas de menu Iniciar do% ALLUSERSPROFILE% do Microsoft Windows \\</span><span class="sxs-lookup"><span data-stu-id="dd496-336">%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/>             |
| <span data-ttu-id="dd496-337">Per-User</span><span class="sxs-lookup"><span data-stu-id="dd496-337">Per-User</span></span>             | <span data-ttu-id="dd496-338">Windows Server 2008 R2 e Windows 7</span><span class="sxs-lookup"><span data-stu-id="dd496-338">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="dd496-339">versão de 32 bits ou 64 bits</span><span class="sxs-lookup"><span data-stu-id="dd496-339">32-bit or 64-bit version</span></span><br/> | <span data-ttu-id="dd496-340">% USERPROFILE% \\ AppData \\ \\ programas locais \\ MSFT \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="dd496-340">%USERPROFILE%\\AppData\\Local\\Programs\\Msft\\Sample1</span></span><br/> <span data-ttu-id="dd496-341">\\ \\ \\ Programas de menu Iniciar do% AppData% Microsoft Windows \\</span><span class="sxs-lookup"><span data-stu-id="dd496-341">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs</span></span><br/> |



 

<span data-ttu-id="dd496-342">Os aplicativos por usuário devem ser armazenados em subpastas na pasta programas especificada pelo valor da propriedade [**ProgramFilesFolder**](programfilesfolder.md) .</span><span class="sxs-lookup"><span data-stu-id="dd496-342">Per-user applications should be stored in subfolders under the Programs folder specified by the value of [**ProgramFilesFolder**](programfilesfolder.md) property.</span></span> <span data-ttu-id="dd496-343">Normalmente, o caminho para o aplicativo usa o seguinte formulário.</span><span class="sxs-lookup"><span data-stu-id="dd496-343">Typically, the path to the application takes the following form.</span></span>

<span data-ttu-id="dd496-344">% LocalAppData% \\ programas \\ *ISV nome* \\ *AppName*.</span><span class="sxs-lookup"><span data-stu-id="dd496-344">%LOCALAPPDATA%\\Programs\\*ISV name*\\*AppName*.</span></span>

<span data-ttu-id="dd496-345">Os dados de configuração por usuário devem ser armazenados na pasta programas especificada pelo valor da propriedade [**ProgramMenuFolder**](programmenufolder.md) .</span><span class="sxs-lookup"><span data-stu-id="dd496-345">Per-user configuration data should be stored in the Programs folder specified by the value of the [**ProgramMenuFolder**](programmenufolder.md) property.</span></span> <span data-ttu-id="dd496-346">Normalmente, essa pasta está localizada no caminho a seguir.</span><span class="sxs-lookup"><span data-stu-id="dd496-346">Typically, this folder is located at the following path.</span></span>

<span data-ttu-id="dd496-347">\\ \\ \\ Programas de menu Iniciar do% AppData% Microsoft Windows \\</span><span class="sxs-lookup"><span data-stu-id="dd496-347">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs</span></span>

<span data-ttu-id="dd496-348">Se estiver instalando componentes [de pacote de Windows Installer de 32 bits](32-bit-windows-installer-packages.md) , use a propriedade [**ProgramFilesFolder**](programfilesfolder.md) e [**CommonFilesFolder**](commonfilesfolder.md) na tabela de [diretórios](directory-table.md) .</span><span class="sxs-lookup"><span data-stu-id="dd496-348">If installing [32-bit Windows Installer Package](32-bit-windows-installer-packages.md) components, use the [**ProgramFilesFolder**](programfilesfolder.md) and [**CommonFilesFolder**](commonfilesfolder.md) property in the [Directory](directory-table.md) table.</span></span> <span data-ttu-id="dd496-349">Se estiver instalando componentes de [pacote de Windows Installer de 64 bits](64-bit-windows-installer-packages.md) , use as propriedades [**ProgramFiles64Folder**](programfiles64folder.md) e [**CommonFiles64Folder**](commonfiles64folder.md) .</span><span class="sxs-lookup"><span data-stu-id="dd496-349">If installing [64-bit Windows Installer Package](64-bit-windows-installer-packages.md) components, use the [**ProgramFiles64Folder**](programfiles64folder.md) and [**CommonFiles64Folder**](commonfiles64folder.md) properties.</span></span> <span data-ttu-id="dd496-350">Se seu aplicativo contiver versões de 32 bits e de 64 bits do mesmo componente, com o mesmo nome, verifique se essas versões são salvas em diretórios diferentes ou forneça nomes diferentes.</span><span class="sxs-lookup"><span data-stu-id="dd496-350">If your application contains 32-bit and 64-bit versions of the same component, with the same name, ensure that these versions are saved in different directories or give them different names.</span></span>

<span data-ttu-id="dd496-351">A tabela de [diretórios](directory-table.md) a seguir fornece um exemplo de um layout de diretório compatível com um pacote que inclui componentes de 32 bits e 64 bits e inclui alguns componentes que são compartilhados entre aplicativos.</span><span class="sxs-lookup"><span data-stu-id="dd496-351">The following [Directory](directory-table.md) table provides an example of a directory layout compatible with a package that includes 32-bit and 64-bit components and includes some components that are shared across applications.</span></span>

| <span data-ttu-id="dd496-352">Diretório</span><span class="sxs-lookup"><span data-stu-id="dd496-352">Directory</span></span>            | <span data-ttu-id="dd496-353">Pai do diretório \_</span><span class="sxs-lookup"><span data-stu-id="dd496-353">Directory\_Parent</span></span>    | <span data-ttu-id="dd496-354">DefaultDir</span><span class="sxs-lookup"><span data-stu-id="dd496-354">DefaultDir</span></span>                        |
|----------------------|----------------------|-----------------------------------|
| <span data-ttu-id="dd496-355">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="dd496-355">TARGETDIR</span></span>            |                      | <span data-ttu-id="dd496-356">SourceDir</span><span class="sxs-lookup"><span data-stu-id="dd496-356">SourceDir</span></span>                         |
| <span data-ttu-id="dd496-357">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="dd496-357">ProgramFilesFolder</span></span>   | <span data-ttu-id="dd496-358">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="dd496-358">TARGETDIR</span></span>            | <span data-ttu-id="dd496-359">.:P rog32</span><span class="sxs-lookup"><span data-stu-id="dd496-359">.:Prog32</span></span>                          |
| <span data-ttu-id="dd496-360">ProgramFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="dd496-360">ProgramFiles64Folder</span></span> | <span data-ttu-id="dd496-361">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="dd496-361">TARGETDIR</span></span>            | <span data-ttu-id="dd496-362">.:P rog64</span><span class="sxs-lookup"><span data-stu-id="dd496-362">.:Prog64</span></span>                          |
| <span data-ttu-id="dd496-363">CommonFilesFolder</span><span class="sxs-lookup"><span data-stu-id="dd496-363">CommonFilesFolder</span></span>    | <span data-ttu-id="dd496-364">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="dd496-364">TARGETDIR</span></span>            | <span data-ttu-id="dd496-365">.:Share32</span><span class="sxs-lookup"><span data-stu-id="dd496-365">.:Share32</span></span>                         |
| <span data-ttu-id="dd496-366">CommonFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="dd496-366">CommonFiles64Folder</span></span>  | <span data-ttu-id="dd496-367">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="dd496-367">TARGETDIR</span></span>            | <span data-ttu-id="dd496-368">.:Share64</span><span class="sxs-lookup"><span data-stu-id="dd496-368">.:Share64</span></span>                         |
| <span data-ttu-id="dd496-369">ProgramMenuFolder</span><span class="sxs-lookup"><span data-stu-id="dd496-369">ProgramMenuFolder</span></span>    | <span data-ttu-id="dd496-370">TARGETDIR</span><span class="sxs-lookup"><span data-stu-id="dd496-370">TARGETDIR</span></span>            | <span data-ttu-id="dd496-371">.: Sample1 \| msdn-PUASample1</span><span class="sxs-lookup"><span data-stu-id="dd496-371">.:Sample1\|MSDN-PUASample1</span></span>        |
| <span data-ttu-id="dd496-372">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="dd496-372">INSTALLLOCATION</span></span>      | <span data-ttu-id="dd496-373">Myvendor</span><span class="sxs-lookup"><span data-stu-id="dd496-373">MyVendor</span></span>             | <span data-ttu-id="dd496-374">Sample1 \| msdn – PUASample1</span><span class="sxs-lookup"><span data-stu-id="dd496-374">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="dd496-375">INSTALLLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="dd496-375">INSTALLLOCATIONX64</span></span>   | <span data-ttu-id="dd496-376">Vendorx64</span><span class="sxs-lookup"><span data-stu-id="dd496-376">Vendorx64</span></span>            | <span data-ttu-id="dd496-377">Sample1 \| msdn – PUASample1</span><span class="sxs-lookup"><span data-stu-id="dd496-377">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="dd496-378">SHAREDLOCATION</span><span class="sxs-lookup"><span data-stu-id="dd496-378">SHAREDLOCATION</span></span>       | <span data-ttu-id="dd496-379">ShVendor</span><span class="sxs-lookup"><span data-stu-id="dd496-379">ShVendor</span></span>             | <span data-ttu-id="dd496-380">Sample1 \| msdn – PUASample1</span><span class="sxs-lookup"><span data-stu-id="dd496-380">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="dd496-381">SHAREDLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="dd496-381">SHAREDLOCATIONX64</span></span>    | <span data-ttu-id="dd496-382">ShVendorx64</span><span class="sxs-lookup"><span data-stu-id="dd496-382">ShVendorx64</span></span>          | <span data-ttu-id="dd496-383">Sample1 \| msdn – PUASample1</span><span class="sxs-lookup"><span data-stu-id="dd496-383">Sample1\|MSDN-PUASample1</span></span>          |
| <span data-ttu-id="dd496-384">Myvendor</span><span class="sxs-lookup"><span data-stu-id="dd496-384">MyVendor</span></span>             | <span data-ttu-id="dd496-385">ProgramFilesFolder</span><span class="sxs-lookup"><span data-stu-id="dd496-385">ProgramFilesFolder</span></span>   | <span data-ttu-id="dd496-386">MSFT \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="dd496-386">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="dd496-387">Vendorx64</span><span class="sxs-lookup"><span data-stu-id="dd496-387">Vendorx64</span></span>            | <span data-ttu-id="dd496-388">ProgramFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="dd496-388">ProgramFiles64Folder</span></span> | <span data-ttu-id="dd496-389">MSFT \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="dd496-389">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="dd496-390">ShVendor</span><span class="sxs-lookup"><span data-stu-id="dd496-390">ShVendor</span></span>             | <span data-ttu-id="dd496-391">CommonFilesFolder</span><span class="sxs-lookup"><span data-stu-id="dd496-391">CommonFilesFolder</span></span>    | <span data-ttu-id="dd496-392">MSFT \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="dd496-392">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="dd496-393">ShVendorx64</span><span class="sxs-lookup"><span data-stu-id="dd496-393">ShVendorx64</span></span>          | <span data-ttu-id="dd496-394">CommonFiles64Folder</span><span class="sxs-lookup"><span data-stu-id="dd496-394">CommonFiles64Folder</span></span>  | <span data-ttu-id="dd496-395">MSFT \| Microsoft</span><span class="sxs-lookup"><span data-stu-id="dd496-395">Msft\|Microsoft</span></span>                   |
| <span data-ttu-id="dd496-396">Shrx86</span><span class="sxs-lookup"><span data-stu-id="dd496-396">Shrx86</span></span>               | <span data-ttu-id="dd496-397">SHAREDLOCATION</span><span class="sxs-lookup"><span data-stu-id="dd496-397">SHAREDLOCATION</span></span>       | <span data-ttu-id="dd496-398">\|componentes de x32 de 32 bits</span><span class="sxs-lookup"><span data-stu-id="dd496-398">x32\|32-bit components</span></span>            |
| <span data-ttu-id="dd496-399">Shrx64</span><span class="sxs-lookup"><span data-stu-id="dd496-399">Shrx64</span></span>               | <span data-ttu-id="dd496-400">SHAREDLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="dd496-400">SHAREDLOCATIONX64</span></span>    | <span data-ttu-id="dd496-401">\|componentes de 64 bits x64</span><span class="sxs-lookup"><span data-stu-id="dd496-401">x64\|64-bit components</span></span>            |
| <span data-ttu-id="dd496-402">Binx86</span><span class="sxs-lookup"><span data-stu-id="dd496-402">Binx86</span></span>               | <span data-ttu-id="dd496-403">INSTALLLOCATION</span><span class="sxs-lookup"><span data-stu-id="dd496-403">INSTALLLOCATION</span></span>      | <span data-ttu-id="dd496-404">\|componentes de x32 de 32 bits</span><span class="sxs-lookup"><span data-stu-id="dd496-404">x32\|32-bit components</span></span>            |
| <span data-ttu-id="dd496-405">Binx64</span><span class="sxs-lookup"><span data-stu-id="dd496-405">Binx64</span></span>               | <span data-ttu-id="dd496-406">INSTALLLOCATIONX64</span><span class="sxs-lookup"><span data-stu-id="dd496-406">INSTALLLOCATIONX64</span></span>   | <span data-ttu-id="dd496-407">\|componentes de 64 bits x64</span><span class="sxs-lookup"><span data-stu-id="dd496-407">x64\|64-bit components</span></span>            |
| <span data-ttu-id="dd496-408">App32</span><span class="sxs-lookup"><span data-stu-id="dd496-408">App32</span></span>                | <span data-ttu-id="dd496-409">Binx86</span><span class="sxs-lookup"><span data-stu-id="dd496-409">Binx86</span></span>               | <span data-ttu-id="dd496-410">\|componentes de 32 bits não compartilhados de MyApp</span><span class="sxs-lookup"><span data-stu-id="dd496-410">myapp\|unshared 32-bit components</span></span> |
| <span data-ttu-id="dd496-411">App64</span><span class="sxs-lookup"><span data-stu-id="dd496-411">App64</span></span>                | <span data-ttu-id="dd496-412">Binx64</span><span class="sxs-lookup"><span data-stu-id="dd496-412">Binx64</span></span>               | <span data-ttu-id="dd496-413">\|componentes de 64 bits não compartilhados de MyApp</span><span class="sxs-lookup"><span data-stu-id="dd496-413">myapp\|unshared 64-bit components</span></span> |
| <span data-ttu-id="dd496-414">Share32</span><span class="sxs-lookup"><span data-stu-id="dd496-414">Share32</span></span>              | <span data-ttu-id="dd496-415">Shrx86</span><span class="sxs-lookup"><span data-stu-id="dd496-415">Shrx86</span></span>               | <span data-ttu-id="dd496-416">\|componentes compartilhados de 32 bits compartilhados</span><span class="sxs-lookup"><span data-stu-id="dd496-416">shared\|shared 32-bit components</span></span>  |
| <span data-ttu-id="dd496-417">Share64</span><span class="sxs-lookup"><span data-stu-id="dd496-417">Share64</span></span>              | <span data-ttu-id="dd496-418">Shrx64</span><span class="sxs-lookup"><span data-stu-id="dd496-418">Shrx64</span></span>               | <span data-ttu-id="dd496-419">\|componentes compartilhados de 64 bits compartilhados</span><span class="sxs-lookup"><span data-stu-id="dd496-419">shared\|shared 64-bit components</span></span>  |



 

<span data-ttu-id="dd496-420">Na origem, essa tabela de [diretório](directory-table.md) é resolvida para os seguintes caminhos de diretório.</span><span class="sxs-lookup"><span data-stu-id="dd496-420">At the source, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span>

<dl> <span data-ttu-id="dd496-421">\[SourceDir \] Prog32 \\ MSFT \\ Sample1 \\ x32 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="dd496-421">\[SourceDir\]Prog32\\Msft\\Sample1\\x32\\myapp</span></span>  
<span data-ttu-id="dd496-422">\[\]Arquivos comuns de Share32 de SourceDir \\ \\ MSFT \\ Sample1 \\ x32 \\ compartilhado</span><span class="sxs-lookup"><span data-stu-id="dd496-422">\[SourceDir\]Share32\\Common Files\\Msft\\Sample1\\x32\\shared</span></span>  
<span data-ttu-id="dd496-423">\[SourceDir \] Prog64 \\ MSFT \\ Sample1 \\ x64 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="dd496-423">\[SourceDir\]Prog64\\Msft\\Sample1\\x64\\myapp</span></span>  
<span data-ttu-id="dd496-424">\[\]Arquivos comuns de Share64 de SourceDir \\ \\ MSFT \\ Sample1 \\ x64 \\ compartilhado</span><span class="sxs-lookup"><span data-stu-id="dd496-424">\[SourceDir\]Share64\\Common Files\\Msft\\Sample1\\x64\\shared</span></span>  
<span data-ttu-id="dd496-425">\[Sample1 de SourceDir \]</span><span class="sxs-lookup"><span data-stu-id="dd496-425">\[SourceDir\]Sample1</span></span>  
</dl>

<span data-ttu-id="dd496-426">No destino, essa tabela de [diretório](directory-table.md) é resolvida para os seguintes caminhos de diretório.</span><span class="sxs-lookup"><span data-stu-id="dd496-426">At the target, this [Directory](directory-table.md) table resolves to the following directory paths.</span></span> <span data-ttu-id="dd496-427">Os caminhos de destino dependem do [contexto](installation-context.md) e do sistema de instalação.</span><span class="sxs-lookup"><span data-stu-id="dd496-427">The target paths depend on the [installation context](installation-context.md) and system.</span></span>

| <span data-ttu-id="dd496-428">Contexto de instalação</span><span class="sxs-lookup"><span data-stu-id="dd496-428">Installation Context</span></span> | <span data-ttu-id="dd496-429">Sistema</span><span class="sxs-lookup"><span data-stu-id="dd496-429">System</span></span>                                                                              | <span data-ttu-id="dd496-430">Caminhos de exemplo</span><span class="sxs-lookup"><span data-stu-id="dd496-430">Example Paths</span></span>                                                                                                                                                                                                                                                                                                                                         |
|----------------------|-------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="dd496-431">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="dd496-431">Per-Machine</span></span>          | <span data-ttu-id="dd496-432">Windows Server 2008 R2 e Windows 7</span><span class="sxs-lookup"><span data-stu-id="dd496-432">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="dd496-433">versão de 32 bits</span><span class="sxs-lookup"><span data-stu-id="dd496-433">32-bit version</span></span><br/>           | <span data-ttu-id="dd496-434">% ProgramFiles% \\ MSFT \\ Sample1 \\ x32 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="dd496-434">%ProgramFiles%\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="dd496-435">% ProgramFiles% \\ Arquivos comuns \\ MSFT \\ Sample1 \\ x32 \\ compartilhado</span><span class="sxs-lookup"><span data-stu-id="dd496-435">%ProgramFiles%\\Common Files\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="dd496-436">% ProgramFiles (x86)% \\ MSFT \\ Sample1 \\ x64 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="dd496-436">%ProgramFiles(x86)%\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="dd496-437">% ProgramFiles (x86)% \\ Arquivos comuns \\ MSFT \\ Sample1 \\ x64 \\ compartilhado</span><span class="sxs-lookup"><span data-stu-id="dd496-437">%ProgramFiles(x86)%\\Common Files\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="dd496-438">% ProgramData de \\ \\ programas do \\ menu Iniciar do Microsoft Windows \\ \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="dd496-438">%ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/>               |
| <span data-ttu-id="dd496-439">Per-Machine</span><span class="sxs-lookup"><span data-stu-id="dd496-439">Per-Machine</span></span>          | <span data-ttu-id="dd496-440">Windows Server 2008 R2 e Windows 7</span><span class="sxs-lookup"><span data-stu-id="dd496-440">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="dd496-441">versão de 64 bits</span><span class="sxs-lookup"><span data-stu-id="dd496-441">64-bit version</span></span><br/>           | <span data-ttu-id="dd496-442">% ProgramFiles (x86)% \\ MSFT \\ Sample1 \\ x32 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="dd496-442">%ProgramFiles(x86)%\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="dd496-443">% ProgramFiles (x86)% \\ Arquivos comuns \\ MSFT \\ Sample1 \\ x32 \\ compartilhado</span><span class="sxs-lookup"><span data-stu-id="dd496-443">%ProgramFiles(x86)%\\Common Files\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="dd496-444">% ProgramFiles% \\ MSFT \\ Sample1 \\ x64 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="dd496-444">%ProgramFiles%\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="dd496-445">% ProgramFiles% \\ Arquivos comuns \\ MSFT \\ Sample1 \\ x64 \\ compartilhado</span><span class="sxs-lookup"><span data-stu-id="dd496-445">%ProgramFiles%\\Common Files\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="dd496-446">% ProgramData de \\ \\ programas do \\ menu Iniciar do Microsoft Windows \\ \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="dd496-446">%ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/>               |
| <span data-ttu-id="dd496-447">Per-User</span><span class="sxs-lookup"><span data-stu-id="dd496-447">Per-User</span></span>             | <span data-ttu-id="dd496-448">Windows Server 2008 R2 e Windows 7</span><span class="sxs-lookup"><span data-stu-id="dd496-448">Windows Server 2008 R2 and Windows 7</span></span><br/> <span data-ttu-id="dd496-449">versão de 32 bits ou 64 bits</span><span class="sxs-lookup"><span data-stu-id="dd496-449">32-bit or 64-bit version</span></span><br/> | <span data-ttu-id="dd496-450">% LOCALAPPDATA% \\ Programs \\ MSFT \\ Sample1 \\ x32 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="dd496-450">%LOCALAPPDATA%\\Programs\\Msft\\Sample1\\x32\\myapp</span></span><br/> <span data-ttu-id="dd496-451">% LOCALAPPDATA% \\ Programs \\ Common \\ MSFT \\ Sample1 \\ x32 \\ compartilhado</span><span class="sxs-lookup"><span data-stu-id="dd496-451">%LOCALAPPDATA%\\Programs\\Common\\Msft\\Sample1\\x32\\shared</span></span><br/> <span data-ttu-id="dd496-452">% LOCALAPPDATA% \\ Programs \\ MSFT \\ Sample1 \\ x64 \\ MyApp</span><span class="sxs-lookup"><span data-stu-id="dd496-452">%LOCALAPPDATA%\\Programs\\Msft\\Sample1\\x64\\myapp</span></span><br/> <span data-ttu-id="dd496-453">% LOCALAPPDATA% \\ Programs \\ Common \\ MSFT \\ Sample1 \\ x64 \\ compartilhado</span><span class="sxs-lookup"><span data-stu-id="dd496-453">%LOCALAPPDATA%\\Programs\\Common\\Msft\\Sample1\\x64\\shared</span></span><br/> <span data-ttu-id="dd496-454">% APPDATA% \\ \\ programas de \\ menu Iniciar do Microsoft Windows \\ \\ Sample1</span><span class="sxs-lookup"><span data-stu-id="dd496-454">%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Sample1</span></span><br/> |



 

## <a name="application-registration"></a><span data-ttu-id="dd496-455">registro de Aplicativo</span><span class="sxs-lookup"><span data-stu-id="dd496-455">Application Registration</span></span>

<span data-ttu-id="dd496-456">O PUASample.msi adiciona uma subchave à chave do registro de caminhos de aplicativo para o aplicativo e executa registros que permitem que as informações do aplicativo sejam salvas no registro sob essa chave.</span><span class="sxs-lookup"><span data-stu-id="dd496-456">The PUASample.msi adds a subkey to the App Paths registry key for the application and performs registrations that enable application information to be saved in the registry under this key.</span></span> <span data-ttu-id="dd496-457">Para obter mais informações sobre os caminhos de aplicativo e o registro de aplicativos, consulte o [PerceivedTypes, o SystemFileAssociations e o registro de aplicativos](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)) na seção [extensibilidade do Shell](https://msdn.microsoft.com/library/bb762762.aspx) do [Guia do desenvolvedor do Shell](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="dd496-457">For more information about App Paths and application registration, see the [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)) in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="dd496-458">No momento da instalação, o usuário toma a decisão de instalar o aplicativo no contexto de instalação por usuário ou por computador.</span><span class="sxs-lookup"><span data-stu-id="dd496-458">At installation time, the user makes the decision to install the application in either the per-user or per-machine installation context.</span></span> <span data-ttu-id="dd496-459">No momento em que o pacote de uso duplo é criado, o desenvolvedor do pacote não pode saber se os registros devem ser executados no \_ computador local hKey \_ ou HKEY \_ Current \_ User Keys.</span><span class="sxs-lookup"><span data-stu-id="dd496-459">At the time the dual-purpose package is authored, the package developer cannot know if the registrations should be performed under the HKEY\_LOCAL\_MACHINE or HKEY\_CURRENT\_USER keys.</span></span>

<span data-ttu-id="dd496-460">O desenvolvedor do pacote define o identificador de arquivo para o arquivo executável do aplicativo no campo arquivo da tabela de [arquivos](file-table.md) .</span><span class="sxs-lookup"><span data-stu-id="dd496-460">The package developer defines the file identifier for the application's executable file in the File field of the [File](file-table.md) Table.</span></span>

<span data-ttu-id="dd496-461">Do [arquivo](file-table.md) Tabela (parcial)</span><span class="sxs-lookup"><span data-stu-id="dd496-461">[File](file-table.md) Table (partial)</span></span> 

| <span data-ttu-id="dd496-462">Arquivo</span><span class="sxs-lookup"><span data-stu-id="dd496-462">File</span></span>      | <span data-ttu-id="dd496-463">Componente\_</span><span class="sxs-lookup"><span data-stu-id="dd496-463">Component\_</span></span>      | <span data-ttu-id="dd496-464">FileName</span><span class="sxs-lookup"><span data-stu-id="dd496-464">FileName</span></span>                     | <span data-ttu-id="dd496-465">FileSize</span><span class="sxs-lookup"><span data-stu-id="dd496-465">FileSize</span></span> | <span data-ttu-id="dd496-466">Versão</span><span class="sxs-lookup"><span data-stu-id="dd496-466">Version</span></span> | <span data-ttu-id="dd496-467">Idioma</span><span class="sxs-lookup"><span data-stu-id="dd496-467">Language</span></span> | <span data-ttu-id="dd496-468">Atributos</span><span class="sxs-lookup"><span data-stu-id="dd496-468">Attributes</span></span> | <span data-ttu-id="dd496-469">Sequência</span><span class="sxs-lookup"><span data-stu-id="dd496-469">Sequence</span></span> |
|-----------|------------------|------------------------------|----------|---------|----------|------------|----------|
| <span data-ttu-id="dd496-470">MyAppfile</span><span class="sxs-lookup"><span data-stu-id="dd496-470">MyAppFile</span></span> | <span data-ttu-id="dd496-471">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-471">ProductComponent</span></span> | <span data-ttu-id="dd496-472">PUASAMP1.EXE\|PUASample1.exe</span><span class="sxs-lookup"><span data-stu-id="dd496-472">PUASAMP1.EXE\|PUASample1.exe</span></span> | <span data-ttu-id="dd496-473">81920</span><span class="sxs-lookup"><span data-stu-id="dd496-473">81920</span></span>    |         |          | <span data-ttu-id="dd496-474">0</span><span class="sxs-lookup"><span data-stu-id="dd496-474">0</span></span>          | <span data-ttu-id="dd496-475">1</span><span class="sxs-lookup"><span data-stu-id="dd496-475">1</span></span>        |



 

<span data-ttu-id="dd496-476">Os valores a serem salvos no registro podem ser especificados no campo valor da tabela [do registro](registry-table.md) como uma cadeia de caracteres [formatada](formatted.md) .</span><span class="sxs-lookup"><span data-stu-id="dd496-476">Values to be saved in the registry can be specified in the Value field of the [Registry](registry-table.md) table as a [Formatted](formatted.md) string.</span></span> <span data-ttu-id="dd496-477">Use o identificador de arquivo definido no campo arquivo da tabela de [arquivos](file-table.md) e a \[ \#  \] Convenção FileKey do tipo formatado, para especificar o valor padrão para a chave do registro de caminhos do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dd496-477">Use the file identifier defined in the File field of the [File](file-table.md) table, and the \[\#*filekey*\] convention of the Formatted type, to specify the default value for the App Paths registry key.</span></span> <span data-ttu-id="dd496-478">A ação de [instalação](install-action.md) de nível superior executa as ações na tabela [InstallExecuteSequence](installexecutesequence-table.md) .</span><span class="sxs-lookup"><span data-stu-id="dd496-478">The top-level [INSTALL](install-action.md) action performs the actions in the [InstallExecuteSequence](installexecutesequence-table.md) table.</span></span> <span data-ttu-id="dd496-479">Depois que as ações [CostInitialize](costinitialize-action.md), [filecost](filecost-action.md)e [InstallFinalize](installfinalize-action.md) nessa tabela forem concluídas, a Windows Installer substituirá a subcadeia de caracteres \[ \# MyApp formatada \] na tabela do registro pelo caminho completo do arquivo de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dd496-479">After the [CostInitialize](costinitialize-action.md), [FileCost](filecost-action.md), and [InstallFinalize](installfinalize-action.md) actions in this table have completed, the Windows Installer replaces the formatted substring \[\#MyAppFile\] in the Registry table with the full path to the application file.</span></span>

<span data-ttu-id="dd496-480">O exemplo define uma propriedade personalizada, RegRoot, para conter o local da chave raiz e usa uma ação personalizada para redefinir o valor da propriedade se o usuário escolher uma instalação por máquina.</span><span class="sxs-lookup"><span data-stu-id="dd496-480">The sample defines a custom property, RegRoot, to contain the location of the root key and uses a custom action to reset the property value if the user chooses a per-machine installation.</span></span> <span data-ttu-id="dd496-481">Use a propriedade personalizada, RegRoot, em qualquer valor de cadeia de caracteres formatado que referencie o local raiz.</span><span class="sxs-lookup"><span data-stu-id="dd496-481">Use the custom property, RegRoot, in any formatted string values that reference the root location.</span></span> <span data-ttu-id="dd496-482">Na tabela de [Propriedades](property-table.md) , o pacote de PUASample.msi define a propriedade personalizada e define o valor de REGROOT como HKCU.</span><span class="sxs-lookup"><span data-stu-id="dd496-482">In the [Property](property-table.md) table the PUASample.msi package defines the custom property and sets the value of RegRoot to HKCU.</span></span> <span data-ttu-id="dd496-483">Isso inicializa o valor da propriedade para o contexto de instalação por usuário, o contexto padrão recomendado para pacotes de uso duplo.</span><span class="sxs-lookup"><span data-stu-id="dd496-483">This initializes the value of the property for the per-user installation context, the recommended default context for dual-purpose packages.</span></span>

<span data-ttu-id="dd496-484">[Propriedade](property-table.md) Tabela (parcial)</span><span class="sxs-lookup"><span data-stu-id="dd496-484">[Property](property-table.md) Table (partial)</span></span>

| <span data-ttu-id="dd496-485">Propriedade</span><span class="sxs-lookup"><span data-stu-id="dd496-485">Property</span></span> | <span data-ttu-id="dd496-486">Valor</span><span class="sxs-lookup"><span data-stu-id="dd496-486">Value</span></span> |
|----------|-------|
| <span data-ttu-id="dd496-487">RegRoot</span><span class="sxs-lookup"><span data-stu-id="dd496-487">RegRoot</span></span>  | <span data-ttu-id="dd496-488">HKCU</span><span class="sxs-lookup"><span data-stu-id="dd496-488">HKCU</span></span>  |



 

<span data-ttu-id="dd496-489">Na tabela [CustomAction](customaction-table.md) , o pacote define uma ação personalizada chamada Set \_ RegRoot \_ HKLM.</span><span class="sxs-lookup"><span data-stu-id="dd496-489">In the [CustomAction](customaction-table.md) table the package defines a custom action named Set\_RegRoot\_HKLM.</span></span> <span data-ttu-id="dd496-490">O valor no campo tipo identifica isso como uma ação personalizada do [tipo de ação personalizada 51](custom-action-type-51.md) padrão.</span><span class="sxs-lookup"><span data-stu-id="dd496-490">The value in the Type field identifies this as a [Custom Action Type 51](custom-action-type-51.md) standard custom action.</span></span> <span data-ttu-id="dd496-491">O significado dos campos de origem e de destino na tabela CustomAction depende do tipo de ação personalizada.</span><span class="sxs-lookup"><span data-stu-id="dd496-491">The meaning of the Source and Target fields in the CustomAction table depend upon the custom action type.</span></span> <span data-ttu-id="dd496-492">Para obter mais informações sobre os tipos padrão de ações personalizadas, consulte [tipos de ação personalizadas](summary-list-of-all-custom-action-types.md).</span><span class="sxs-lookup"><span data-stu-id="dd496-492">For more information about the standard types of custom actions, see [Custom Action Types](summary-list-of-all-custom-action-types.md).</span></span> <span data-ttu-id="dd496-493">O campo de origem para a \_ \_ ação personalizada Set RegRoot HKLM especifica que o valor da propriedade RegRoot.</span><span class="sxs-lookup"><span data-stu-id="dd496-493">The Source field for the Set\_RegRoot\_HKLM custom action specifies that the value of the RegRoot property.</span></span> <span data-ttu-id="dd496-494">Se o instalador executar a \_ \_ ação personalizada Set RegRoot HKLM, isso redefinirá o valor da propriedade REGROOT como HKLM.</span><span class="sxs-lookup"><span data-stu-id="dd496-494">If the installer performs the Set\_RegRoot\_HKLM custom action, this resets the value of the RegRoot property to HKLM.</span></span>

<span data-ttu-id="dd496-495">[CustomAction](customaction-table.md) Tabela (parcial)</span><span class="sxs-lookup"><span data-stu-id="dd496-495">[CustomAction](customaction-table.md) Table (partial)</span></span>

| <span data-ttu-id="dd496-496">Ação</span><span class="sxs-lookup"><span data-stu-id="dd496-496">Action</span></span>             | <span data-ttu-id="dd496-497">Tipo</span><span class="sxs-lookup"><span data-stu-id="dd496-497">Type</span></span> | <span data-ttu-id="dd496-498">Fonte</span><span class="sxs-lookup"><span data-stu-id="dd496-498">Source</span></span>      | <span data-ttu-id="dd496-499">Destino</span><span class="sxs-lookup"><span data-stu-id="dd496-499">Target</span></span> |
|--------------------|------|-------------|--------|
| <span data-ttu-id="dd496-500">Definir \_ RegRoot \_ HKLM</span><span class="sxs-lookup"><span data-stu-id="dd496-500">Set\_RegRoot\_HKLM</span></span> | <span data-ttu-id="dd496-501">51</span><span class="sxs-lookup"><span data-stu-id="dd496-501">51</span></span>   | <span data-ttu-id="dd496-502">\[RegRoot\]</span><span class="sxs-lookup"><span data-stu-id="dd496-502">\[RegRoot\]</span></span> | <span data-ttu-id="dd496-503">HKLM</span><span class="sxs-lookup"><span data-stu-id="dd496-503">HKLM</span></span>   |



 

<span data-ttu-id="dd496-504">A ação de [instalação](install-action.md) de nível superior executa as ações na tabela [InstallExecuteSequence](installexecutesequence-table.md) , na sequência especificada no campo sequência dessa tabela.</span><span class="sxs-lookup"><span data-stu-id="dd496-504">The top-level [INSTALL](install-action.md) action performs the actions in the [InstallExecuteSequence](installexecutesequence-table.md) table, in the sequence specified in the Sequence field of that table.</span></span> <span data-ttu-id="dd496-505">O valor criado no campo sequência para a \_ ação personalizada Set RegRoot \_ HKLM (1501) especifica que essa ação personalizada seja executada após a ação [InstallInitialize](installinitialize-action.md) (1500) e antes da ação [ProcessComponents](processcomponents-action.md) (1600.) Essa sequência garante que o registro para a \_ \_ ação personalizada Set RegRoot HKLM seja avaliado no momento da instalação.</span><span class="sxs-lookup"><span data-stu-id="dd496-505">The value authored in the Sequence field for the Set\_RegRoot\_HKLM custom action (1501) specifies that this custom action be performed after the [InstallInitialize](installinitialize-action.md) action (1500) and before the [ProcessComponents](processcomponents-action.md) action (1600.) This sequence ensures that the record for the Set\_RegRoot\_HKLM custom action is evaluated at installation time.</span></span> <span data-ttu-id="dd496-506">Para obter mais informações sobre a sequência recomendada de ações na tabela InstallExecuteSequence, consulte o tópico [sugerido InstallExecuteSequence](suggested-installexecutesequence.md) .</span><span class="sxs-lookup"><span data-stu-id="dd496-506">For more information about the recommended sequence of actions in the InstallExecuteSequence table, see the [Suggested InstallExecuteSequence](suggested-installexecutesequence.md) topic.</span></span> <span data-ttu-id="dd496-507">A [sintaxe da instrução condicional](conditional-statement-syntax.md) criada no campo condição especifica que a ação Set \_ RegRoot \_ HKLM será executada somente se o valor da propriedade [**AllUsers**](allusers.md) for avaliado como 1 no momento da instalação.</span><span class="sxs-lookup"><span data-stu-id="dd496-507">The [conditional statement syntax](conditional-statement-syntax.md) authored in the Condition field specifies that the Set\_RegRoot\_HKLM action be performed only if the value of the [**ALLUSERS**](allusers.md) property evaluates to 1 at installation time.</span></span> <span data-ttu-id="dd496-508">Um valor de propriedade **AllUsers** de 1 especifica uma instalação por máquina.</span><span class="sxs-lookup"><span data-stu-id="dd496-508">An **ALLUSERS** property value of 1 specifies a per-machine installation.</span></span>

<span data-ttu-id="dd496-509">[InstallExecuteSequence](installexecutesequence-table.md) Tabela (parcial)</span><span class="sxs-lookup"><span data-stu-id="dd496-509">[InstallExecuteSequence](installexecutesequence-table.md) Table (partial)</span></span>

| <span data-ttu-id="dd496-510">Ação</span><span class="sxs-lookup"><span data-stu-id="dd496-510">Action</span></span>             | <span data-ttu-id="dd496-511">Condição</span><span class="sxs-lookup"><span data-stu-id="dd496-511">Condition</span></span>  | <span data-ttu-id="dd496-512">Sequência</span><span class="sxs-lookup"><span data-stu-id="dd496-512">Sequence</span></span> |
|--------------------|------------|----------|
| <span data-ttu-id="dd496-513">Definir \_ RegRoot \_ HKLM</span><span class="sxs-lookup"><span data-stu-id="dd496-513">Set\_RegRoot\_HKLM</span></span> | <span data-ttu-id="dd496-514">ALLUSERS = 1</span><span class="sxs-lookup"><span data-stu-id="dd496-514">ALLUSERS=1</span></span> | <span data-ttu-id="dd496-515">1501</span><span class="sxs-lookup"><span data-stu-id="dd496-515">1501</span></span>     |



 

<span data-ttu-id="dd496-516">Os registros a seguir na tabela de [registro](registry-table.md) executam os registros se o componente ProductComponent estiver instalado.</span><span class="sxs-lookup"><span data-stu-id="dd496-516">The following records in the [Registry](registry-table.md) table perform the registrations if the ProductComponent component is installed.</span></span> <span data-ttu-id="dd496-517">O valor-1 no campo raiz é necessário para executar o registro em HKEY \_ local \_ Machine para uma instalação por usuário e em hKey \_ Current \_ User para uma instalação por usuário.</span><span class="sxs-lookup"><span data-stu-id="dd496-517">The value -1 in the Root field is required to perform the registration under HKEY\_LOCAL\_MACHINE for a per-user installation and under HKEY\_CURRENT\_USER for a per-user installation.</span></span> <span data-ttu-id="dd496-518">O registro com uma cadeia de caracteres vazia no campo do registro adiciona uma subchave para o aplicativo na chave do registro AppPaths e define o valor "(padrão)" como o caminho completo do arquivo executável do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dd496-518">The record with an empty string in the Registry field adds a subkey for the application under the AppPaths registry key and sets the "(Default)" value to the full path of the application's executable file.</span></span> <span data-ttu-id="dd496-519">O registro MyAppPathAlias mapeia o arquivo executável para um alias de aplicativo e permite que o aplicativo seja iniciado se o usuário digitar o alias "puapct" em um prompt de linha de comando.</span><span class="sxs-lookup"><span data-stu-id="dd496-519">The MyAppPathAlias registration maps the executable file to an application alias and enables the application to be launched if the user types the alias "puapct" at a command line prompt.</span></span> <span data-ttu-id="dd496-520">O registro MyAppPathRegistration mapeia o nome do arquivo executável para o caminho completo do arquivo.</span><span class="sxs-lookup"><span data-stu-id="dd496-520">The MyAppPathRegistration registration maps the name of the executable file to the file's full path.</span></span>



| <span data-ttu-id="dd496-521">Registro</span><span class="sxs-lookup"><span data-stu-id="dd496-521">Registry</span></span>              | <span data-ttu-id="dd496-522">Root</span><span class="sxs-lookup"><span data-stu-id="dd496-522">Root</span></span> | <span data-ttu-id="dd496-523">Chave</span><span class="sxs-lookup"><span data-stu-id="dd496-523">Key</span></span>                                                                     | <span data-ttu-id="dd496-524">Nome</span><span class="sxs-lookup"><span data-stu-id="dd496-524">Name</span></span> | <span data-ttu-id="dd496-525">Valor</span><span class="sxs-lookup"><span data-stu-id="dd496-525">Value</span></span>                                                                            | <span data-ttu-id="dd496-526">Componente</span><span class="sxs-lookup"><span data-stu-id="dd496-526">Component</span></span>        |
|-----------------------|------|-------------------------------------------------------------------------|------|----------------------------------------------------------------------------------|------------------|
|                       | <span data-ttu-id="dd496-527">-1</span><span class="sxs-lookup"><span data-stu-id="dd496-527">-1</span></span>   | <span data-ttu-id="dd496-528">Software \\ Microsoft \\ MyAppPathRegistrationLocation</span><span class="sxs-lookup"><span data-stu-id="dd496-528">Software\\Microsoft\\MyAppPathRegistrationLocation</span></span>                      |      | <span data-ttu-id="dd496-529">\[\] \\ Caminhos de aplicativo RegRoot software \\ Microsoft \\ Windows \\ CurrentVersion \\ \\PUAPCT.exe</span><span class="sxs-lookup"><span data-stu-id="dd496-529">\[RegRoot\]\\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUAPCT.exe</span></span> | <span data-ttu-id="dd496-530">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-530">ProductComponent</span></span> |
| <span data-ttu-id="dd496-531">MyAppPathAlias</span><span class="sxs-lookup"><span data-stu-id="dd496-531">MyAppPathAlias</span></span>        | <span data-ttu-id="dd496-532">-1</span><span class="sxs-lookup"><span data-stu-id="dd496-532">-1</span></span>   | <span data-ttu-id="dd496-533">\\Caminhos de aplicativo do software Microsoft \\ Windows \\ CurrentVersion \\ \\PUAPCT.exe</span><span class="sxs-lookup"><span data-stu-id="dd496-533">Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUAPCT.exe</span></span>     |      | <span data-ttu-id="dd496-534">\[\#MyAppfile\]</span><span class="sxs-lookup"><span data-stu-id="dd496-534">\[\#MyAppFile\]</span></span>                                                                  | <span data-ttu-id="dd496-535">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-535">ProductComponent</span></span> |
| <span data-ttu-id="dd496-536">MyAppPathRegistration</span><span class="sxs-lookup"><span data-stu-id="dd496-536">MyAppPathRegistration</span></span> | <span data-ttu-id="dd496-537">-1</span><span class="sxs-lookup"><span data-stu-id="dd496-537">-1</span></span>   | <span data-ttu-id="dd496-538">\\Caminhos de aplicativo do software Microsoft \\ Windows \\ CurrentVersion \\ \\PUASample1.exe</span><span class="sxs-lookup"><span data-stu-id="dd496-538">Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\PUASample1.exe</span></span> |      | <span data-ttu-id="dd496-539">\[\#MyAppfile\]</span><span class="sxs-lookup"><span data-stu-id="dd496-539">\[\#MyAppFile\]</span></span>                                                                  | <span data-ttu-id="dd496-540">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-540">ProductComponent</span></span> |



 

## <a name="autoplay-cancel-registration"></a><span data-ttu-id="dd496-541">Cancelar o registro de reprodução automática</span><span class="sxs-lookup"><span data-stu-id="dd496-541">AutoPlay Cancel Registration</span></span>

<span data-ttu-id="dd496-542">O PUASample.msi executa registros que permitem ao usuário do aplicativo impedir que a [reprodução automática de hardware](/previous-versions/windows/desktop/legacy/cc144210(v=vs.85)) seja iniciada para os dispositivos selecionados.</span><span class="sxs-lookup"><span data-stu-id="dd496-542">The PUASample.msi performs registrations that enable the application user to prevent [Hardware Autoplay](/previous-versions/windows/desktop/legacy/cc144210(v=vs.85)) from launching for selected devices.</span></span> <span data-ttu-id="dd496-543">Para obter informações sobre como registrar um manipulador para cancelar a reprodução automática em resposta a um evento, consulte o tópico [preparando o hardware e o software para uso com a reprodução automática](/previous-versions//cc144208(v=vs.85)) na seção [extensibilidade do Shell](https://msdn.microsoft.com/library/bb762762.aspx) do [Guia do desenvolvedor do Shell](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="dd496-543">For information about registering a handler to cancel Autoplay in response to an event, see the [Preparing Hardware and Software for Use with AutoPlay](/previous-versions//cc144208(v=vs.85)) topic in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="dd496-544">O registro a seguir registra o manipulador especificado no campo nome quando o componente ProductComponent é instalado.</span><span class="sxs-lookup"><span data-stu-id="dd496-544">The following record registers the handler specified in the Name field when the ProductComponent component is installed.</span></span> <span data-ttu-id="dd496-545">O valor-1 no campo raiz é necessário para especificar o Windows Installer que o registro deve ser redirecionado para um local que depende do contexto de instalação.</span><span class="sxs-lookup"><span data-stu-id="dd496-545">The value -1 in the Root field is required to specify to the Windows Installer that the registration should be redirected to a location that depends upon the installation context.</span></span>

<span data-ttu-id="dd496-546">[Registro do](registry-table.md) Tabela</span><span class="sxs-lookup"><span data-stu-id="dd496-546">[Registry](registry-table.md) Table</span></span> 

| <span data-ttu-id="dd496-547">Registro</span><span class="sxs-lookup"><span data-stu-id="dd496-547">Registry</span></span>                     | <span data-ttu-id="dd496-548">Root</span><span class="sxs-lookup"><span data-stu-id="dd496-548">Root</span></span> | <span data-ttu-id="dd496-549">Chave</span><span class="sxs-lookup"><span data-stu-id="dd496-549">Key</span></span>                                                                                             | <span data-ttu-id="dd496-550">Nome</span><span class="sxs-lookup"><span data-stu-id="dd496-550">Name</span></span>                                 | <span data-ttu-id="dd496-551">Valor</span><span class="sxs-lookup"><span data-stu-id="dd496-551">Value</span></span> | <span data-ttu-id="dd496-552">Componente</span><span class="sxs-lookup"><span data-stu-id="dd496-552">Component</span></span>        |
|------------------------------|------|-------------------------------------------------------------------------------------------------|--------------------------------------|-------|------------------|
| <span data-ttu-id="dd496-553">MyAutoplayCancelRegistration</span><span class="sxs-lookup"><span data-stu-id="dd496-553">MyAutoplayCancelRegistration</span></span> | <span data-ttu-id="dd496-554">-1</span><span class="sxs-lookup"><span data-stu-id="dd496-554">-1</span></span>   | <span data-ttu-id="dd496-555">SOFTWARE \\ Microsoft \\ Windows \\ CurrentVersion \\ Explorer \\ AutoplayHandlers \\ CancelAutoplay \\ CLSID</span><span class="sxs-lookup"><span data-stu-id="dd496-555">SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\AutoplayHandlers\\CancelAutoplay\\CLSID</span></span> | <span data-ttu-id="dd496-556">66A32FE6-229D-427b-A608-D273F40C034C</span><span class="sxs-lookup"><span data-stu-id="dd496-556">66A32FE6-229D-427b-A608-D273F40C034C</span></span> |       | <span data-ttu-id="dd496-557">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-557">ProductComponent</span></span> |



 

## <a name="preview-handler-registration"></a><span data-ttu-id="dd496-558">Registro do Gerenciador de visualização</span><span class="sxs-lookup"><span data-stu-id="dd496-558">Preview Handler Registration</span></span>

<span data-ttu-id="dd496-559">O PUASample.msi executa registros que são necessários para instalar um [Gerenciador de visualização](../shell/preview-handlers.md) que habilita uma visualização somente leitura de arquivos. pua sem iniciar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dd496-559">The PUASample.msi performs registrations that are required to install a [preview handler](../shell/preview-handlers.md) that enables a read-only preview of .pua files without launching the application.</span></span> <span data-ttu-id="dd496-560">Para obter informações sobre como registrar gerenciadores de visualização, consulte o tópico [Registrando manipuladores de visualização](../shell/how-to-register-a-preview-handler.md) na seção [extensibilidade do Shell](https://msdn.microsoft.com/library/bb762762.aspx) do [Guia do desenvolvedor do Shell](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="dd496-560">For information about registering preview handlers, see the [Registering Preview Handlers](../shell/how-to-register-a-preview-handler.md) topic in the [shell extensibility](https://msdn.microsoft.com/library/bb762762.aspx) section of the [Shell Developer's Guide](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)).</span></span> <span data-ttu-id="dd496-561">Os registros a seguir na tabela de [registro](registry-table.md) registram o manipulador quando o componente ProductComponent é instalado.</span><span class="sxs-lookup"><span data-stu-id="dd496-561">The following records in the [Registry](registry-table.md) table register the handler when the ProductComponent component is installed.</span></span> <span data-ttu-id="dd496-562">O valor-1 no campo raiz é necessário para especificar o Windows Installer que o registro deve ser redirecionado para um local que depende do contexto de instalação.</span><span class="sxs-lookup"><span data-stu-id="dd496-562">The value -1 in the Root field is required to specify to the Windows Installer that the registration should be redirected to a location that depends upon the installation context.</span></span>

<span data-ttu-id="dd496-563">[Registro do](registry-table.md) Tabela</span><span class="sxs-lookup"><span data-stu-id="dd496-563">[Registry](registry-table.md) Table</span></span>

| <span data-ttu-id="dd496-564">Registro</span><span class="sxs-lookup"><span data-stu-id="dd496-564">Registry</span></span>                       | <span data-ttu-id="dd496-565">Root</span><span class="sxs-lookup"><span data-stu-id="dd496-565">Root</span></span> | <span data-ttu-id="dd496-566">Chave</span><span class="sxs-lookup"><span data-stu-id="dd496-566">Key</span></span>                                                                              | <span data-ttu-id="dd496-567">Nome</span><span class="sxs-lookup"><span data-stu-id="dd496-567">Name</span></span>                                   | <span data-ttu-id="dd496-568">Valor</span><span class="sxs-lookup"><span data-stu-id="dd496-568">Value</span></span>                                        | <span data-ttu-id="dd496-569">Componente</span><span class="sxs-lookup"><span data-stu-id="dd496-569">Component</span></span>        |
|--------------------------------|------|----------------------------------------------------------------------------------|----------------------------------------|----------------------------------------------|------------------|
| <span data-ttu-id="dd496-570">MyPreviewHandlerRegistration1</span><span class="sxs-lookup"><span data-stu-id="dd496-570">MyPreviewHandlerRegistration1</span></span>  | <span data-ttu-id="dd496-571">-1</span><span class="sxs-lookup"><span data-stu-id="dd496-571">-1</span></span>   | <span data-ttu-id="dd496-572">Classes de software \\ \\ . pua</span><span class="sxs-lookup"><span data-stu-id="dd496-572">Software\\Classes\\.pua</span></span>                                                          |                                        | <span data-ttu-id="dd496-573">puafile</span><span class="sxs-lookup"><span data-stu-id="dd496-573">puafile</span></span>                                      | <span data-ttu-id="dd496-574">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-574">ProductComponent</span></span> |
| <span data-ttu-id="dd496-575">MyPreviewHandlerRegistration2</span><span class="sxs-lookup"><span data-stu-id="dd496-575">MyPreviewHandlerRegistration2</span></span>  | <span data-ttu-id="dd496-576">-1</span><span class="sxs-lookup"><span data-stu-id="dd496-576">-1</span></span>   | <span data-ttu-id="dd496-577">Software \\ Microsoft \\ Windows \\ CurrentVersion \\ PreviewHandlers</span><span class="sxs-lookup"><span data-stu-id="dd496-577">Software\\Microsoft\\Windows\\CurrentVersion\\PreviewHandlers</span></span>                    | <span data-ttu-id="dd496-578">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="dd496-578">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span> | <span data-ttu-id="dd496-579">Gerenciador de visualização de teste do Microsoft Windows PUA</span><span class="sxs-lookup"><span data-stu-id="dd496-579">Microsoft Windows PUA TEST Preview Handler</span></span>   | <span data-ttu-id="dd496-580">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-580">ProductComponent</span></span> |
| <span data-ttu-id="dd496-581">MyPreviewHandlerRegistration3</span><span class="sxs-lookup"><span data-stu-id="dd496-581">MyPreviewHandlerRegistration3</span></span>  | <span data-ttu-id="dd496-582">-1</span><span class="sxs-lookup"><span data-stu-id="dd496-582">-1</span></span>   | <span data-ttu-id="dd496-583">Classes de software \\ \\ puafile \\ shellex \\ {8895b1c6-b41f-4c1c-a562-0d564250836f}</span><span class="sxs-lookup"><span data-stu-id="dd496-583">Software\\Classes\\puafile\\ShellEx\\{8895b1c6-b41f-4c1c-a562-0d564250836f}</span></span>      |                                        | <span data-ttu-id="dd496-584">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="dd496-584">{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>       | <span data-ttu-id="dd496-585">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-585">ProductComponent</span></span> |
| <span data-ttu-id="dd496-586">MyPreviewHandlerRegistration4</span><span class="sxs-lookup"><span data-stu-id="dd496-586">MyPreviewHandlerRegistration4</span></span>  | <span data-ttu-id="dd496-587">-1</span><span class="sxs-lookup"><span data-stu-id="dd496-587">-1</span></span>   | <span data-ttu-id="dd496-588">CLSID de classes de software \\ \\ \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="dd496-588">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 |                                        | <span data-ttu-id="dd496-589">Per-User o Gerenciador de visualização de exemplo 1 aplicativo</span><span class="sxs-lookup"><span data-stu-id="dd496-589">Per-User Applicaton Sample 1 Preview Handler</span></span> | <span data-ttu-id="dd496-590">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-590">ProductComponent</span></span> |
| <span data-ttu-id="dd496-591">MyPreviewHandlerRegistration5</span><span class="sxs-lookup"><span data-stu-id="dd496-591">MyPreviewHandlerRegistration5</span></span>  | <span data-ttu-id="dd496-592">-1</span><span class="sxs-lookup"><span data-stu-id="dd496-592">-1</span></span>   | <span data-ttu-id="dd496-593">CLSID de classes de software \\ \\ \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="dd496-593">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="dd496-594">AppID</span><span class="sxs-lookup"><span data-stu-id="dd496-594">AppID</span></span>                                  | <span data-ttu-id="dd496-595">{6d2b5079-2f0b-48dd-ab7f-97cec514d30b}</span><span class="sxs-lookup"><span data-stu-id="dd496-595">{6d2b5079-2f0b-48dd-ab7f-97cec514d30b}</span></span>       | <span data-ttu-id="dd496-596">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-596">ProductComponent</span></span> |
| <span data-ttu-id="dd496-597">MyPreviewHandlerRegistration6</span><span class="sxs-lookup"><span data-stu-id="dd496-597">MyPreviewHandlerRegistration6</span></span>  | <span data-ttu-id="dd496-598">-1</span><span class="sxs-lookup"><span data-stu-id="dd496-598">-1</span></span>   | <span data-ttu-id="dd496-599">CLSID de classes de software \\ \\ \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="dd496-599">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="dd496-600">DisplayName</span><span class="sxs-lookup"><span data-stu-id="dd496-600">DisplayName</span></span>                            | <span data-ttu-id="dd496-601">@shell32,-38242</span><span class="sxs-lookup"><span data-stu-id="dd496-601">@shell32,-38242</span></span>                              | <span data-ttu-id="dd496-602">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-602">ProductComponent</span></span> |
| <span data-ttu-id="dd496-603">MyPreviewHandlerRegistration7</span><span class="sxs-lookup"><span data-stu-id="dd496-603">MyPreviewHandlerRegistration7</span></span>  | <span data-ttu-id="dd496-604">-1</span><span class="sxs-lookup"><span data-stu-id="dd496-604">-1</span></span>   | <span data-ttu-id="dd496-605">CLSID de classes de software \\ \\ \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22}</span><span class="sxs-lookup"><span data-stu-id="dd496-605">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}</span></span>                 | <span data-ttu-id="dd496-606">ícone</span><span class="sxs-lookup"><span data-stu-id="dd496-606">Icon</span></span>                                   | <span data-ttu-id="dd496-607">notepad.exe, 2</span><span class="sxs-lookup"><span data-stu-id="dd496-607">notepad.exe,2</span></span>                                | <span data-ttu-id="dd496-608">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-608">ProductComponent</span></span> |
| <span data-ttu-id="dd496-609">MyPreviewHandlerRegistration8</span><span class="sxs-lookup"><span data-stu-id="dd496-609">MyPreviewHandlerRegistration8</span></span>  | <span data-ttu-id="dd496-610">-1</span><span class="sxs-lookup"><span data-stu-id="dd496-610">-1</span></span>   | <span data-ttu-id="dd496-611">CLSID de classes de software \\ \\ \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InprocServer32</span><span class="sxs-lookup"><span data-stu-id="dd496-611">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> | <span data-ttu-id="dd496-612">ThreadingModel</span><span class="sxs-lookup"><span data-stu-id="dd496-612">ThreadingModel</span></span>                         | <span data-ttu-id="dd496-613">Sta</span><span class="sxs-lookup"><span data-stu-id="dd496-613">Apartment</span></span>                                    | <span data-ttu-id="dd496-614">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-614">ProductComponent</span></span> |
| <span data-ttu-id="dd496-615">MyPreviewHandlerRegistration9</span><span class="sxs-lookup"><span data-stu-id="dd496-615">MyPreviewHandlerRegistration9</span></span>  | <span data-ttu-id="dd496-616">-1</span><span class="sxs-lookup"><span data-stu-id="dd496-616">-1</span></span>   | <span data-ttu-id="dd496-617">CLSID de classes de software \\ \\ \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InprocServer32</span><span class="sxs-lookup"><span data-stu-id="dd496-617">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> |                                        | <span data-ttu-id="dd496-618">\#%% SystemRoot% \\ system32 \\shell32.dll</span><span class="sxs-lookup"><span data-stu-id="dd496-618">\#%%SystemRoot%\\system32\\shell32.dll</span></span>       | <span data-ttu-id="dd496-619">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-619">ProductComponent</span></span> |
| <span data-ttu-id="dd496-620">MyPreviewHandlerRegistration10</span><span class="sxs-lookup"><span data-stu-id="dd496-620">MyPreviewHandlerRegistration10</span></span> | <span data-ttu-id="dd496-621">-1</span><span class="sxs-lookup"><span data-stu-id="dd496-621">-1</span></span>   | <span data-ttu-id="dd496-622">CLSID de classes de software \\ \\ \\ {1531d583-8375-4d3f-b5fb-d23bbd169f22} \\ InprocServer32</span><span class="sxs-lookup"><span data-stu-id="dd496-622">Software\\Classes\\CLSID\\{1531d583-8375-4d3f-b5fb-d23bbd169f22}\\InProcServer32</span></span> | <span data-ttu-id="dd496-623">ProgID</span><span class="sxs-lookup"><span data-stu-id="dd496-623">ProgID</span></span>                                 | <span data-ttu-id="dd496-624">puafile</span><span class="sxs-lookup"><span data-stu-id="dd496-624">puafile</span></span>                                      | <span data-ttu-id="dd496-625">ProductComponent</span><span class="sxs-lookup"><span data-stu-id="dd496-625">ProductComponent</span></span> |



 

 

 
