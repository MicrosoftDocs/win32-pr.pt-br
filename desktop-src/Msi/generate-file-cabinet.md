---
description: O arquivo VBScript WiMakCab.vbs é fornecido nos componentes SDK do Windows para os desenvolvedores de Windows Installer. Este exemplo mostra como o script é usado para gerar gabinetes de arquivo de um banco de dados Windows Installer.
ms.assetid: 26671cb9-a200-4520-8b52-4cff3f71a2f2
title: Gerar gabinete de arquivo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3df2355c247ff602d644d2865ec3b9d9a8447ca4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103922032"
---
# <a name="generate-file-cabinet"></a><span data-ttu-id="efd5e-104">Gerar gabinete de arquivo</span><span class="sxs-lookup"><span data-stu-id="efd5e-104">Generate File Cabinet</span></span>

<span data-ttu-id="efd5e-105">O arquivo VBScript WiMakCab.vbs é fornecido nos [componentes SDK do Windows para os desenvolvedores de Windows Installer](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="efd5e-105">The VBScript file WiMakCab.vbs is provided in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="efd5e-106">Este exemplo mostra como o script é usado para gerar gabinetes de arquivo de um banco de dados Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="efd5e-106">This sample shows how script is used to generate file cabinets from a Windows Installer database.</span></span>

<span data-ttu-id="efd5e-107">Este exemplo demonstra:</span><span class="sxs-lookup"><span data-stu-id="efd5e-107">This sample demonstrates:</span></span>

-   <span data-ttu-id="efd5e-108">[**Método OpenDatabase (objeto Installer)**](installer-opendatabase.md) e o [**método LastErrorRecord**](installer-lasterrorrecord.md) do [**objeto instalador**](installer-object.md)</span><span class="sxs-lookup"><span data-stu-id="efd5e-108">[**OpenDatabase method (Installer Object)**](installer-opendatabase.md) and the [**LastErrorRecord method**](installer-lasterrorrecord.md) of the [**Installer Object**](installer-object.md)</span></span>
-   <span data-ttu-id="efd5e-109">[**Método Commit**](database-commit.md), o [**método OpenView**](database-openview.md) e a [**Propriedade SummaryInformation (objeto Database)**](database-summaryinformation.md) do [**objeto Database**](database-object.md)</span><span class="sxs-lookup"><span data-stu-id="efd5e-109">[**Commit method**](database-commit.md), the [**OpenView method**](database-openview.md) and [**SummaryInformation property (Database Object)**](database-summaryinformation.md) of the [**Database Object**](database-object.md)</span></span>
-   <span data-ttu-id="efd5e-110">[**Método FETCH**](view-fetch.md), [**método execute**](view-execute.md) e [**método Modify**](view-modify.md) do [**objeto View**](view-object.md)</span><span class="sxs-lookup"><span data-stu-id="efd5e-110">[**Fetch method**](view-fetch.md), [**Execute method**](view-execute.md) and [**Modify method**](view-modify.md) of the [**View Object**](view-object.md)</span></span>
-   <span data-ttu-id="efd5e-111">[**Propriedade StringData**](record-stringdata.md) e [**Propriedade IntegerData**](record-integerdata.md) do [**objeto Record**](record-object.md)</span><span class="sxs-lookup"><span data-stu-id="efd5e-111">[**StringData property**](record-stringdata.md) and [**IntegerData property**](record-integerdata.md) of the [**Record Object**](record-object.md)</span></span>
-   <span data-ttu-id="efd5e-112">[**Método DoAction**](session-doaction.md), a [**Propriedade Property (objeto Session)**](session-session.md)e a [**propriedade Mode**](session-mode.md) do [**objeto Session**](session-object.md)</span><span class="sxs-lookup"><span data-stu-id="efd5e-112">[**DoAction method**](session-doaction.md), the [**Property property (Session Object)**](session-session.md), and the [**Mode property**](session-mode.md) of the [**Session Object**](session-object.md)</span></span>

<span data-ttu-id="efd5e-113">Você precisará da versão CScript.exe ou WScript.exe do Windows Script Host para usar este exemplo.</span><span class="sxs-lookup"><span data-stu-id="efd5e-113">You'll require the CScript.exe or WScript.exe version of Windows Script Host to use this sample.</span></span> <span data-ttu-id="efd5e-114">Para usar CScript.exe para executar este exemplo, digite um comando no prompt de comando usando a sintaxe a seguir.</span><span class="sxs-lookup"><span data-stu-id="efd5e-114">To use CScript.exe to run this sample, type a command at the command prompt using the following syntax.</span></span> <span data-ttu-id="efd5e-115">A ajuda será exibida se o primeiro argumento for/?</span><span class="sxs-lookup"><span data-stu-id="efd5e-115">Help is displayed if the first argument is /?</span></span> <span data-ttu-id="efd5e-116">ou se poucos argumentos forem especificados.</span><span class="sxs-lookup"><span data-stu-id="efd5e-116">or if too few arguments are specified.</span></span> <span data-ttu-id="efd5e-117">Para redirecionar a saída para um arquivo, termine a linha de comando com VBS > \[ *caminho para o arquivo* \] .</span><span class="sxs-lookup"><span data-stu-id="efd5e-117">To redirect the output to a file, end the command line with VBS > \[*path to file*\].</span></span> <span data-ttu-id="efd5e-118">O exemplo retorna um valor de 0 para êxito, 1 se a ajuda for invocada e 2 se o script falhar.</span><span class="sxs-lookup"><span data-stu-id="efd5e-118">The sample returns a value of 0 for success, 1 if help is invoked, and 2 if the script fails.</span></span>

<span data-ttu-id="efd5e-119">**cscript WiMakCab.vbs \[ caminho para o nome base do banco de dados \] \[ \] \[ locais de origem opcionais\]**</span><span class="sxs-lookup"><span data-stu-id="efd5e-119">**cscript WiMakCab.vbs \[path to database\]\[base name\]\[optional source locations\]**</span></span>

<span data-ttu-id="efd5e-120">Para gerar um gabinete, Makecab.exe deve estar no caminho.</span><span class="sxs-lookup"><span data-stu-id="efd5e-120">In order to generate a cabinet, Makecab.exe must be on the PATH.</span></span> <span data-ttu-id="efd5e-121">O utilitário Makecab.exe está incluído nos [componentes SDK do Windows para os desenvolvedores de Windows Installer](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="efd5e-121">The Makecab.exe utility is included in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="efd5e-122">Observe que o exemplo não atualiza a [tabela de mídia](media-table.md) para lidar com vários gabinetes.</span><span class="sxs-lookup"><span data-stu-id="efd5e-122">Note that the sample does not update the [Media table](media-table.md) to handle multiple cabinets.</span></span> <span data-ttu-id="efd5e-123">Para substituir um gabinete incorporado, inclua as opções:/R/C/U/E.</span><span class="sxs-lookup"><span data-stu-id="efd5e-123">To replace an embedded cabinet, include the options: /R /C /U /E.</span></span>

<span data-ttu-id="efd5e-124">Especifique o caminho para o banco de dados do instalador.</span><span class="sxs-lookup"><span data-stu-id="efd5e-124">Specify the path to the installer database.</span></span> <span data-ttu-id="efd5e-125">Isso deve estar localizado na raiz da árvore de origem.</span><span class="sxs-lookup"><span data-stu-id="efd5e-125">This must be located at the root of the source tree.</span></span> <span data-ttu-id="efd5e-126">Especifique o nome base que diferencia maiúsculas de minúsculas para os arquivos de gabinete gerados.</span><span class="sxs-lookup"><span data-stu-id="efd5e-126">Specify the case-sensitive base name for the generated cabinet files.</span></span> <span data-ttu-id="efd5e-127">Se o tipo de origem for compactado, todos os arquivos serão abertos na raiz.</span><span class="sxs-lookup"><span data-stu-id="efd5e-127">If the source type is compressed, all files are opened at the root.</span></span> <span data-ttu-id="efd5e-128">As opções a seguir podem ser especificadas em qualquer ponto na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="efd5e-128">The following options may be specified at any point on the command line.</span></span>



| <span data-ttu-id="efd5e-129">Opção</span><span class="sxs-lookup"><span data-stu-id="efd5e-129">Option</span></span>              | <span data-ttu-id="efd5e-130">Descrição</span><span class="sxs-lookup"><span data-stu-id="efd5e-130">Description</span></span>                                                                                                                               |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="efd5e-131">nenhuma opção especificada</span><span class="sxs-lookup"><span data-stu-id="efd5e-131">no option specified</span></span> |                                                                                                                                           |
| <span data-ttu-id="efd5e-132">/C</span><span class="sxs-lookup"><span data-stu-id="efd5e-132">/C</span></span>                  | <span data-ttu-id="efd5e-133">Execute a compactação.</span><span class="sxs-lookup"><span data-stu-id="efd5e-133">Run compression.</span></span> <span data-ttu-id="efd5e-134">Se/C não for especificado, WiMakCab.vbs gerará apenas o arquivo DDF.</span><span class="sxs-lookup"><span data-stu-id="efd5e-134">If /C is not specified, WiMakCab.vbs only generates the DDF file.</span></span>                                                        |
| <span data-ttu-id="efd5e-135">/L</span><span class="sxs-lookup"><span data-stu-id="efd5e-135">/L</span></span>                  | <span data-ttu-id="efd5e-136">Usar compactação LZX em vez de MSZIP</span><span class="sxs-lookup"><span data-stu-id="efd5e-136">Use LZX compression instead of MSZIP</span></span>                                                                                                      |
| <span data-ttu-id="efd5e-137">/F</span><span class="sxs-lookup"><span data-stu-id="efd5e-137">/F</span></span>                  | <span data-ttu-id="efd5e-138">Limite o tamanho do gabinete para 1,44 MB de tamanho de disquete em vez de CD-ROM</span><span class="sxs-lookup"><span data-stu-id="efd5e-138">Limit cabinet size to 1.44 MB floppy size rather than CD-ROM</span></span>                                                                              |
| <span data-ttu-id="efd5e-139">/U</span><span class="sxs-lookup"><span data-stu-id="efd5e-139">/U</span></span>                  | <span data-ttu-id="efd5e-140">Atualizar o banco de dados para fazer referência ao gabinete gerado</span><span class="sxs-lookup"><span data-stu-id="efd5e-140">Update the database to reference the generated cabinet</span></span>                                                                                    |
| <span data-ttu-id="efd5e-141">/E</span><span class="sxs-lookup"><span data-stu-id="efd5e-141">/E</span></span>                  | <span data-ttu-id="efd5e-142">Inserir o arquivo de gabinete no pacote do instalador como um fluxo</span><span class="sxs-lookup"><span data-stu-id="efd5e-142">Embed the cabinet file in the installer package as a stream</span></span>                                                                               |
| <span data-ttu-id="efd5e-143">/S</span><span class="sxs-lookup"><span data-stu-id="efd5e-143">/S</span></span>                  | <span data-ttu-id="efd5e-144">Usar números de sequência na tabela de arquivos ordenados por diretórios</span><span class="sxs-lookup"><span data-stu-id="efd5e-144">Use sequence numbers in the File table ordered by directories</span></span>                                                                             |
| <span data-ttu-id="efd5e-145">/R</span><span class="sxs-lookup"><span data-stu-id="efd5e-145">/R</span></span>                  | <span data-ttu-id="efd5e-146">Reverta para instalação sem gabinete, remova o gabinete se/E for especificado (a opção/R remove a propriedade SummaryInfo de bit compactada 15 & 2)</span><span class="sxs-lookup"><span data-stu-id="efd5e-146">Revert to non-cabinet install, remove cabinet if /E is specified (The /R option removes the compressed bit - SummaryInfo property 15 & 2)</span></span> |



 

<span data-ttu-id="efd5e-147">Para obter exemplos de script adicionais, consulte [Windows Installer exemplos de script](windows-installer-scripting-examples.md).</span><span class="sxs-lookup"><span data-stu-id="efd5e-147">For additional scripting examples, see [Windows Installer Scripting Examples](windows-installer-scripting-examples.md).</span></span> <span data-ttu-id="efd5e-148">Para utilitários de exemplo que não exigem o Windows Script Host, consulte [Windows Installer ferramentas de desenvolvimento](windows-installer-development-tools.md).</span><span class="sxs-lookup"><span data-stu-id="efd5e-148">For sample utilities that do not require Windows Script Host, see [Windows Installer Development Tools](windows-installer-development-tools.md).</span></span>

 

 



