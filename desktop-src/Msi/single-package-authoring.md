---
description: um pacote de uso duplo é um pacote Windows Installer 5,0 que foi criado para ser capaz de instalar um aplicativo no contexto de instalação por usuário ou por computador.
ms.assetid: b2da9fba-8fdf-48fa-a662-6b3eee1bfe87
title: Criação de pacote único
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4c89a24c692591326d0498ce6da028ca3fa7eccd9b66db642105fad35a0aaccc
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/11/2021
ms.locfileid: "119628206"
---
# <a name="single-package-authoring"></a>Criação de pacote único

um pacote de uso duplo é um pacote Windows Installer 5,0 que foi criado para ser capaz de instalar um aplicativo no [contexto de instalação](installation-context.md)por usuário ou por computador. os desenvolvedores de instalação que usam um pacote de uso duplo para seu aplicativo podem fornecer aos usuários uma opção de contexto de instalação no momento da instalação e podem remover solicitações de credenciais de UAC de instalações por usuário no Windows 7 ou Windows Server 2008 R2. o desenvolvimento de um pacote Windows Installer 5,0 de uso duplo para instalação no Windows 7 e no Windows Server 2008 R2 é chamado de criação de pacote único.

você pode começar a desenvolver pacotes de uso duplo para o Windows 7 e o Windows Server 2008 R2 usando Windows Installer 5,0, a propriedade [**MSIINSTALLPERUSER**](msiinstallperuser.md) , a propriedade [**ALLUSERS**](allusers.md) e as pastas e os registros conhecidos e habilitados por usuário do [Shell de Windows](/previous-versions/windows/desktop/legacy/bb773177(v=vs.85)). quando Windows Installer 5,0 instala um pacote de uso duplo no contexto por usuário no Windows 7 ou no Windows Server 2008 R2, o instalador direciona as entradas de arquivo e registro para locais por usuário e não exibe os prompts do UAC para as credenciais. quando Windows Installer 5,0 instala um pacote de uso duplo no contexto por máquina, o instalador direciona arquivos e entradas de registro para locais por máquina e solicita as credenciais do UAC para confirmar se o usuário tem privilégios suficientes para instalar o software para todos os usuários do computador. uma vez que o Windows Installer 5,0 instala um aplicativo, ele usa o mesmo contexto de instalação para todas as atualizações, reparos ou remoção subsequentes do aplicativo.

**[Windows Installer 4,5 ou anterior](not-supported-in-windows-installer-4-5.md):** a propriedade [**MSIINSTALLPERUSER**](msiinstallperuser.md) e as versões por usuário das pastas referenciadas pelas [**propriedades ProgramFilesFolder**](programfilesfolder.md), [**CommonFilesFolder**](commonfilesfolder.md), [**ProgramFiles64Folder**](programfiles64folder.md)e [**CommonFiles64Folder**](commonfiles64folder.md) não têm suporte. as pastas **folderid \_ userprogramfiles** e **folderid \_ UserProgramFilesCommon** estão disponíveis a partir do Windows 7 e do Windows Server 2008 R2. isso significa que as instalações são desenvolvidas para Windows Installer 4,5 ou para arquivos diretos e entradas de registro anteriores a folderid \_ programfiles, folderid \_ ProgramFilesCommon, folderid \_ ProgramFilesX64 e folderid \_ ProgramFilesCommonX64. como esses são locais acessíveis para outros usuários do computador, Windows Vista e sistemas posteriores exigem a exibição de prompts do UAC para credenciais.

quando um usuário instala um pacote de uso duplo criado para o Windows Installer 5,0 com Windows Installer 4,5 ou anterior, o instalador ignora a propriedade [**MSIINSTALLPERUSER**](msiinstallperuser.md) . Nesse caso, a instalação pode direcionar arquivos e entradas de registro para locais acessíveis a outros usuários e exigir que o sistema exiba as credenciais dos prompts do UAC. Windows o instalador 5,0 pode instalar um pacote desenvolvido para Windows Installer 4,5 ou anterior. no entanto, a instalação direciona arquivos e entradas do registro para locais acessíveis a outros usuários e requer que o sistema exiba as credenciais do UAC.

## <a name="development-guidelines"></a>Diretrizes de desenvolvimento

Siga as seguintes diretrizes de criação de pacote único para garantir que o pacote possa ser instalado no contexto por usuário ou por máquina. Siga estas diretrizes para permitir que o usuário escolha no momento da instalação uma instalação por usuário ou por computador e remova os prompts do UAC de instalações por usuário.

-   a instalação por usuário requer o Windows Installer 5,0 no Windows 7 ou no Windows Server 2008 R2. Você deve informar ao usuário que o pacote dá suporte à instalação por computador do aplicativo em versões anteriores do sistema.
-   Inicialize os valores das propriedades [**AllUsers**](allusers.md) e [**MSIINSTALLPERUSER**](msiinstallperuser.md) na tabela de [Propriedades](property-table.md) do pacote de uso duplo. Use o valor **AllUsers** de 2 e um valor de **MSIINSTALLPERUSER** de 1 como os valores iniciais. Isso especifica a instalação por usuário como o padrão para o pacote de uso duplo.
-   Considere criar uma caixa de diálogo para a [interface do usuário](user-interface.md) do seu pacote de uso duplo que permite que o usuário escolha o contexto no momento da instalação. Crie os controles nessa caixa de diálogo personalizada para definir os valores das propriedades [**AllUsers**](allusers.md) e [**MSIINSTALLPERUSER**](msiinstallperuser.md) . Para o valor **AllUsers** de 2, defina **MSIINSTALLPERUSER** como um valor de 1 para especificar uma instalação por usuário e defina **MSIINSTALLPERUSER** como uma cadeia de caracteres vazia ("") para especificar uma instalação por computador. Os usuários também podem definir **AllUsers** e **MSIINSTALLPERUSER** na linha de comando se instalarem o pacote da linha de comando.
-   Valide o pacote usando [avaliadores de consistência internos-ICES](internal-consistency-evaluators-ices.md). O pacote deve ser capaz de passar na validação pelo [ICE105](ice-105.md) para ser um pacote de uso duplo válido.
-   Use a [tabela de registro](registry-table.md) e a [tabela RemoveRegistry](removeregistry-table.md) para redirecionar entradas de registro para as partes por usuário do registro durante as instalações por usuário. Em uma instalação por usuário, as entradas do registro que têm-1 na coluna raiz são redirecionadas para **HKEY \_ Current \_ User** e, em uma instalação por máquina, elas são direcionadas para a **\_ \_ máquina local hKey**. Em uma instalação por usuário, as entradas do registro que têm msidbRegistryRootClassesRoot (0) na coluna raiz são redirecionadas para classes de software **HKCU** \\  \\ e, em uma instalação por máquina, elas são direcionadas para classes de \\ **software** HKLM \\ .
-   Use a propriedade [**ProgramFilesFolder**](programfilesfolder.md) na [tabela de diretórios](directory-table.md) de [pacotes de Windows Installer de 32 bits](32-bit-windows-installer-packages.md) para especificar os locais de diretórios que contêm componentes de 32 bits que não são compartilhados entre aplicativos. quando um usuário instala o pacote de uso duplo usando o contexto por máquina, esses componentes são salvos na pasta arquivos de programas em versões de 32 bits do Windows e na pasta arquivos de programas (x86) em versões de 64 bits do sistema. Os componentes nesses diretórios podem ser acessados por todos os usuários. quando um usuário instala o pacote de uso duplo no Windows 7 ou no Windows Server 2008 R2 usando o contexto por usuário, esses componentes são salvos na pasta programas do usuário atual (por exemplo, em% LocalAppData% \\ programs) e podem ser acessados somente por esse usuário.
-   Use a propriedade [**CommonFilesFolder**](commonfilesfolder.md) na [tabela de diretórios](directory-table.md) de [pacotes de Windows Installer de 32 bits](32-bit-windows-installer-packages.md) para especificar os locais de diretórios que contêm componentes de 32 bits compartilhados entre aplicativos. Quando um usuário instala o pacote de uso duplo usando o contexto por máquina, esses componentes são salvos na pasta Arquivos comuns e podem ser acessados por todos os usuários. quando um usuário instala o pacote de uso duplo no Windows 7 ou no Windows Server 2008 R2 usando o contexto por usuário, esses componentes são salvos na pasta comum do usuário atual (por exemplo, em% LocalAppData% \\ programs \\ common) e podem ser acessados somente por esse usuário.
-   Use a propriedade [**ProgramFiles64Folder**](programfiles64folder.md) na [tabela de diretórios](directory-table.md) de [pacotes de Windows Installer de 64 bits](64-bit-windows-installer-packages.md) para especificar os locais de diretórios que contêm componentes de 64 bits que não são compartilhados entre aplicativos. Quando um usuário instala o pacote de uso duplo usando o contexto por máquina, esses componentes são salvos na pasta arquivos de programas. Os componentes nesses diretórios podem ser acessados por todos os usuários. quando um usuário instala o pacote de uso duplo no Windows 7 ou no Windows Server 2008 R2 usando o contexto por usuário, esses componentes são salvos na pasta programas do usuário atual (por exemplo, em% LocalAppData% \\ programs) e podem ser acessados somente por esse usuário. para obter mais informações sobre como criar um pacote para instalar um aplicativo em sistemas operacionais de 64 bits, consulte [Windows Installer em sistemas operacionais de 64 bits](windows-installer-on-64-bit-operating-systems.md).
-   Use a propriedade [**CommonFiles64Folder**](commonfiles64folder.md) na [tabela de diretórios](directory-table.md) de [pacotes de Windows Installer de 64 bits](64-bit-windows-installer-packages.md) para especificar os locais de diretórios que contêm componentes de 64 bits compartilhados entre aplicativos. Quando um usuário instala o pacote de uso duplo usando o contexto por máquina, esses componentes são salvos na pasta Arquivos comuns e podem ser acessados por todos os usuários. quando um usuário instala o pacote de uso duplo no Windows 7 ou no Windows Server 2008 R2 usando o contexto por usuário, esses componentes são salvos na pasta comum do usuário atual (por exemplo, em% LocalAppData% \\ programs \\ common) e podem ser acessados somente por esse usuário.
-   Use as propriedades [**ProgramFilesFolder**](programfilesfolder.md) e [**CommonFilesFolder**](commonfilesfolder.md) na [tabela de diretórios](directory-table.md) de [pacotes de Windows Installer de 64 bits](64-bit-windows-installer-packages.md) para especificar o local dos diretórios que contêm componentes de 32 bits. Use nomes diferentes para as versões de 32 bits e 64 bits de quaisquer componentes fornecidos com o mesmo nome ou, como alternativa, salve as versões em pastas diferentes. Por exemplo, adicione informações à tabela de diretórios para especificar o local do diretório que contém a versão de 32 bits como nome do \[ aplicativo de \] \\ *nome ProgramFilesFolder ISV* \\  \\ x86 e o local do diretório que contém a versão de 64 bits como nome do \[ aplicativo de nome do Program64FilesFolder \] \\ *ISV* \\  \\ x64. Em seguida, uma instalação por computador salva a versão de 32 bits em arquivos de programas (x86) nome de ISV nome do \\  \\ *aplicativo* \\ x86 e salva a versão de 64 bits em arquivos de programas \\ *ISV* nome \\ *nome do aplicativo* \\ x64. Uma instalação por usuário salva a versão de 32 bits em% LocalAppData% \\ programas \\ *ISV nome* \\ *aplicativo* nome \\ x86 e instala a versão de 64 bits em% LocalAppData% \\ Programs \\ *ISV Name* \\ *nome do aplicativo* \\ x64.
-   Armazene os dados de configuração por usuário para o aplicativo em \\ usuários nome de usuário \\  \\ AppData.
-   Armazene modelos e arquivos gerados pelo aplicativo em subpastas sob \\ o \\ *nome de usuário* users.
-   se seu aplicativo usar extensões de shell, você deverá usar os pontos de extensibilidade do [shell](https://msdn.microsoft.com/library/bb762762.aspx) compatíveis com o usuário que estão disponíveis a partir do Windows 7 ou Windows Server 2008 R2.
-   Não use ações personalizadas em seu pacote que exigem privilégios elevados para serem executadas. A tabela [CustomAction](customaction-table.md) não deve conter nenhuma ação personalizada que tenha sido marcada para ser executada com privilégios elevados. Para obter mais informações sobre ações personalizadas elevadas, consulte [segurança de ação personalizada](custom-action-security.md).
-   Não grave em nenhuma pasta global do sistema. A tabela de [diretórios](directory-table.md) não deve conter uma referência a nenhuma das seguintes propriedades de pasta do sistema.

    <dl>

[**AdminToolsFolder**](admintoolsfolder.md)  
    [**CommonAppDataFolder**](commonappdatafolder.md)  
    [**FontsFolder**](fontsfolder.md)  
    [**System16Folder**](system16folder.md)  
    [**System64Folder**](system64folder.md)  
    [**SystemFolder**](systemfolder.md)  
    [**TempFolder**](tempfolder.md)  
    [**WindowsFolder**](windowsfolder.md)  
    [**WindowsVolume**](windowsvolume.md)  
    </dl>

-   Não instale um assembly Common Language Runtime no cache de assembly global (GAC). Para obter mais informações sobre como instalar assemblies no cache de assembly global, consulte [adicionando assemblies a um pacote](adding-assemblies-to-a-package.md) e [instalação de assemblies do Common Language Runtime](installation-of-common-language-runtime-assemblies.md).
-   Não instale nenhuma fonte de dados ODBC. Não use a tabela [ODBCDataSource](odbcdatasource-table.md) para instalar uma fonte de dados.
-   Não instale nenhum serviço. Não use a tabela de [instalação](serviceinstall-table.md) para instalar um serviço.

## <a name="example"></a>Exemplo

um exemplo de um pacote de uso duplo é fornecido nos [componentes SDK do Windows para Windows Installer desenvolvedores](platform-sdk-components-for-windows-installer-developers.md) como o arquivo PUASample1.msi. Se você tiver o SDK atual, terá acesso a todas as ferramentas e dados necessários para reproduzir o pacote de instalação de exemplo. Para obter mais informações sobre este exemplo, consulte [exemplo de criação de pacote único](single-package-authoring-example.md).

 

 
