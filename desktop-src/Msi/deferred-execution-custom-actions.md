---
description: A finalidade de uma ação personalizada de execução adiada é atrasar a execução de uma alteração do sistema no momento em que o script de instalação é executado.
ms.assetid: 79bf4d0b-624d-4652-8c4f-0ecd928a88e3
title: Ações personalizadas de execução adiada
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e09b91793f5d5bbc7be7099c92f8d8f212012d12
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103922044"
---
# <a name="deferred-execution-custom-actions"></a><span data-ttu-id="5b16b-103">Ações personalizadas de execução adiada</span><span class="sxs-lookup"><span data-stu-id="5b16b-103">Deferred Execution Custom Actions</span></span>

<span data-ttu-id="5b16b-104">A finalidade de uma ação personalizada de execução adiada é atrasar a execução de uma alteração do sistema no momento em que o script de instalação é executado.</span><span class="sxs-lookup"><span data-stu-id="5b16b-104">The purpose of a deferred execution custom action is to delay the execution of a system change to the time when the installation script is executed.</span></span> <span data-ttu-id="5b16b-105">Isso é diferente de uma ação personalizada regular ou de uma ação padrão, na qual o instalador executa a ação imediatamente ao encontrar em uma tabela de sequência ou em uma chamada para [**MsiDoAction**](/windows/desktop/api/Msiquery/nf-msiquery-msidoactiona).</span><span class="sxs-lookup"><span data-stu-id="5b16b-105">This differs from a regular custom action, or a standard action, in which the installer executes the action immediately upon encountering it in a sequence table or in a call to [**MsiDoAction**](/windows/desktop/api/Msiquery/nf-msiquery-msidoactiona).</span></span> <span data-ttu-id="5b16b-106">Uma ação personalizada de execução adiada permite que um autor de pacote especifique operações do sistema em um ponto específico dentro da execução do script de instalação.</span><span class="sxs-lookup"><span data-stu-id="5b16b-106">A deferred execution custom action enables a package author to specify system operations at a particular point within the execution of the installation script.</span></span>

<span data-ttu-id="5b16b-107">O instalador não executa uma ação personalizada de execução adiada no momento em que a sequência de instalação é processada.</span><span class="sxs-lookup"><span data-stu-id="5b16b-107">The installer does not execute a deferred execution custom action at the time the installation sequence is processed.</span></span> <span data-ttu-id="5b16b-108">Em vez disso, o instalador grava a ação personalizada no script de instalação.</span><span class="sxs-lookup"><span data-stu-id="5b16b-108">Instead the installer writes the custom action into the installation script.</span></span> <span data-ttu-id="5b16b-109">O único parâmetro de modo que o instalador define nesse caso é MSIRUNMODE \_ agendado.</span><span class="sxs-lookup"><span data-stu-id="5b16b-109">The only mode parameter the installer sets in this case is MSIRUNMODE\_SCHEDULED.</span></span> <span data-ttu-id="5b16b-110">Consulte [**MsiGetMode**](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode) para obter uma descrição dos parâmetros do modo de execução.</span><span class="sxs-lookup"><span data-stu-id="5b16b-110">See [**MsiGetMode**](/windows/desktop/api/Msiquery/nf-msiquery-msigetmode) for a description of the run mode parameters.</span></span>

<span data-ttu-id="5b16b-111">Uma ação personalizada de execução adiada deve ser agendada na tabela de sequências de execução na seção que executa a geração de script.</span><span class="sxs-lookup"><span data-stu-id="5b16b-111">A deferred execution custom action must be scheduled in the execute sequence table within the section that performs script generation.</span></span> <span data-ttu-id="5b16b-112">As ações personalizadas de execução adiada devem vir após [InstallInitialize](installinitialize-action.md) e vir antes de [InstallFinalize](installfinalize-action.md) na sequência de ação.</span><span class="sxs-lookup"><span data-stu-id="5b16b-112">Deferred execution custom actions must come after [InstallInitialize](installinitialize-action.md) and come before [InstallFinalize](installfinalize-action.md) in the action sequence.</span></span>

<span data-ttu-id="5b16b-113">Ações personalizadas que definem propriedades, Estados de recursos, Estados de componentes ou diretórios de destino, ou que agendam operações do sistema inserindo linhas em tabelas de sequência, podem, em muitos casos, usar a execução imediata com segurança.</span><span class="sxs-lookup"><span data-stu-id="5b16b-113">Custom actions that set properties, feature states, component states, or target directories, or that schedule system operations by inserting rows into sequence tables, can in many cases use immediate execution safely.</span></span> <span data-ttu-id="5b16b-114">No entanto, as ações personalizadas que alteram o sistema diretamente ou chamam outro serviço do sistema devem ser adiadas para a hora em que o script de instalação é executado.</span><span class="sxs-lookup"><span data-stu-id="5b16b-114">However, custom actions that change the system directly, or call another system service, must be deferred to the time when the installation script is executed.</span></span> <span data-ttu-id="5b16b-115">Consulte [ações personalizadas síncronas e assíncronas](synchronous-and-asynchronous-custom-actions.md) para obter mais informações sobre possíveis conflitos entre suas ações personalizadas e o thread de instalação principal.</span><span class="sxs-lookup"><span data-stu-id="5b16b-115">See [Synchronous and Asynchronous Custom Actions](synchronous-and-asynchronous-custom-actions.md) for more information about potential clashes between their custom actions and the main installation thread.</span></span>

<span data-ttu-id="5b16b-116">Como o script de instalação pode ser executado fora da sessão de instalação na qual ele foi gravado, a sessão pode não existir mais durante a execução do script de instalação.</span><span class="sxs-lookup"><span data-stu-id="5b16b-116">Because the installation script can be executed outside of the installation session in which it was written, the session may no longer exist during execution of the installation script.</span></span> <span data-ttu-id="5b16b-117">Isso significa que o identificador de sessão original e o conjunto de dados de propriedade durante a sequência de instalação não estão disponíveis para uma ação personalizada de execução adiada.</span><span class="sxs-lookup"><span data-stu-id="5b16b-117">This means that the original session handle and property data set during the installation sequence is not available to a deferred execution custom action.</span></span> <span data-ttu-id="5b16b-118">As ações personalizadas adiadas que chamam DLLs (bibliotecas de vínculo dinâmico) passam um identificador que só pode ser usado para obter uma quantidade muito limitada de informações, conforme descrito em [obtendo informações de contexto para ações personalizadas de execução adiada](obtaining-context-information-for-deferred-execution-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="5b16b-118">Deferred custom actions that call dynamic-link libraries (DLLs) pass a handle which can only be used to obtain a very limited amount of information, as described in [Obtaining Context Information for Deferred Execution Custom Actions](obtaining-context-information-for-deferred-execution-custom-actions.md).</span></span>

<span data-ttu-id="5b16b-119">Observe que as ações personalizadas adiadas, incluindo [reversão de ações personalizadas](rollback-custom-actions.md) e [ações personalizadas de confirmação](commit-custom-actions.md), são os únicos tipos de ações que podem ser executadas fora do contexto de segurança dos usuários.</span><span class="sxs-lookup"><span data-stu-id="5b16b-119">Note that deferred custom actions, including [rollback custom actions](rollback-custom-actions.md) and [commit custom actions](commit-custom-actions.md), are the only types of actions that can run outside the users security context.</span></span>

## <a name="related-topics"></a><span data-ttu-id="5b16b-120">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="5b16b-120">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="5b16b-121">Opções de execução de In-Script de ação personalizada</span><span class="sxs-lookup"><span data-stu-id="5b16b-121">Custom Action In-Script Execution Options</span></span>](custom-action-in-script-execution-options.md)
</dt> <dt>

[<span data-ttu-id="5b16b-122">Referência de ação personalizada</span><span class="sxs-lookup"><span data-stu-id="5b16b-122">Custom Action Reference</span></span>](custom-action-reference.md)
</dt> </dl>

 

 



