---
description: O Windows Installer armazena todas as cadeias de caracteres de banco de dados em um único pool de cadeias compartilhada para reduzir o tamanho do banco de dados e para melhorar o desempenho. Para obter uma lista de páginas de código numérico, consulte Localizando as tabelas Error e ActionText.
ms.assetid: 5d413fb7-99da-49f3-ace3-ec285df2e634
title: Manipulação de página de código (Windows Installer)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6db2788a1bfc6bdb49ec1402d5bba8a1a2594b30
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105769325"
---
# <a name="code-page-handling-windows-installer"></a><span data-ttu-id="f66cb-104">Manipulação de página de código (Windows Installer)</span><span class="sxs-lookup"><span data-stu-id="f66cb-104">Code Page Handling (Windows Installer)</span></span>

<span data-ttu-id="f66cb-105">O Windows Installer armazena todas as cadeias de caracteres de banco de dados em um único pool de cadeias compartilhada para reduzir o tamanho do banco de dados e para melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="f66cb-105">The Windows Installer stores all database strings in a single shared string pool to reduce the size of the database, and to improve performance.</span></span> <span data-ttu-id="f66cb-106">Para obter uma lista de páginas de código numérico, consulte [localizando as tabelas Error e ActionText](localizing-the-error-and-actiontext-tables.md).</span><span class="sxs-lookup"><span data-stu-id="f66cb-106">For a list of numeric code pages, see [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md).</span></span>

<span data-ttu-id="f66cb-107">Para obter mais informações, [determinando a página de código de um banco de dados de instalação](determining-an-installation-database-s-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="f66cb-107">For more information, [Determining an Installation Database's Code Page](determining-an-installation-database-s-code-page.md).</span></span>

<span data-ttu-id="f66cb-108">Windows Installer usa [**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) para determinar se a página de código é válida.</span><span class="sxs-lookup"><span data-stu-id="f66cb-108">Windows Installer uses [**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) to determine whether the code page is valid.</span></span>

### <a name="localizing-a-windows-installer-package"></a><span data-ttu-id="f66cb-109">Localizando um pacote de Windows Installer</span><span class="sxs-lookup"><span data-stu-id="f66cb-109">Localizing a Windows Installer Package</span></span>

<span data-ttu-id="f66cb-110">Se você localizar um pacote de Windows Installer, ele poderá envolver a modificação de informações em tabelas de banco de dados, exportar as tabelas para arquivos de texto ANSI e, em seguida, importar os arquivos mortos para o banco de dados que está sendo localizado.</span><span class="sxs-lookup"><span data-stu-id="f66cb-110">If you localize a Windows Installer package, it may involve modifying information in database tables, exporting the tables to ANSI text archive files, and then importing the archive files into the database that is being localized.</span></span> <span data-ttu-id="f66cb-111">Você também pode adicionar alterações de localização a um banco de dados usando um editor de tabela de banco de dados ou as [funções de banco](database-functions.md)de dados.</span><span class="sxs-lookup"><span data-stu-id="f66cb-111">You can also add localization changes to a database by using a database table editor or the [Database Functions](database-functions.md).</span></span> <span data-ttu-id="f66cb-112">É importante definir a página de código do banco de dados que está sendo localizado antes de fazer qualquer alteração de localização no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f66cb-112">It is important to set the code page of the database that is being localized before you make any localization changes to the database.</span></span> <span data-ttu-id="f66cb-113">Não defina a página de código do banco de dados depois de localizar o banco de dados, pois isso pode corromper os caracteres estendidos.</span><span class="sxs-lookup"><span data-stu-id="f66cb-113">Do not set the code page of the database after localizing the database, because this can corrupt extended characters.</span></span> <span data-ttu-id="f66cb-114">Para obter mais informações, consulte [definindo a página de código de um banco de dados](setting-the-code-page-of-a-database.md).</span><span class="sxs-lookup"><span data-stu-id="f66cb-114">For more information, see [Setting the Code Page of a Database](setting-the-code-page-of-a-database.md).</span></span>

<span data-ttu-id="f66cb-115">A abordagem recomendada para lidar com páginas de código é criar um banco de dados neutro que contenha apenas caracteres que possam ser traduzidos em qualquer página de código.</span><span class="sxs-lookup"><span data-stu-id="f66cb-115">The recommended approach for handling code pages is to author a neutral database that only contains characters that can be translated into any code page.</span></span> <span data-ttu-id="f66cb-116">Para obter mais informações, consulte [criando um banco de dados com uma página de código neutra](creating-a-database-with-a-neutral-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="f66cb-116">For more information, see [Creating a Database with a Neutral Code Page](creating-a-database-with-a-neutral-code-page.md).</span></span>

<span data-ttu-id="f66cb-117">Se você adicionar informações de localização com arquivos mortos de banco de dados, poderá usar o [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) para exportar tabelas de um banco de dados que contém alterações de localização para arquivos mortos de texto ANSI e, em seguida, importá-las para o banco de dados que está sendo localizado com [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span><span class="sxs-lookup"><span data-stu-id="f66cb-117">If you add localization information with database archive files, you can use [**MsiDatabaseExport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) to export tables from a database that contains localization changes to ANSI text archive files, and then import these into the database being localized with [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span> <span data-ttu-id="f66cb-118">A página de código de um arquivo morto exportado é sempre igual ao seu banco de dados pai.</span><span class="sxs-lookup"><span data-stu-id="f66cb-118">The code page of an exported archive file is always the same as its parent database.</span></span> <span data-ttu-id="f66cb-119">As páginas de código de um arquivo importado e o banco de dados que está recebendo o arquivo devem ser idênticos ou pelo menos uma das duas páginas de código deve ser neutra.</span><span class="sxs-lookup"><span data-stu-id="f66cb-119">The code pages of an imported file and the database that is receiving the file must be identical, or at least one of the two code pages must be neutral.</span></span> <span data-ttu-id="f66cb-120">Para obter mais informações, consulte [manipulação de página de código de tabelas importadas e](code-page-handling-of-imported-and-exported-tables.md)exportadas.</span><span class="sxs-lookup"><span data-stu-id="f66cb-120">For more information, see [Code Page Handling of Imported and Exported Tables](code-page-handling-of-imported-and-exported-tables.md).</span></span>

<span data-ttu-id="f66cb-121">Se você adicionar informações de localização com um editor de texto ou as [funções de banco de dados](database-functions.md) , tome cuidado para passar parâmetros de cadeia de caracteres para a API Windows Installer que usa a página de código do banco de dados que está sendo localizado.</span><span class="sxs-lookup"><span data-stu-id="f66cb-121">If you add localization information with a text editor or the [Database Functions](database-functions.md) be careful to only pass string parameters to the Windows Installer API that uses the code page of the database that is being localized.</span></span> <span data-ttu-id="f66cb-122">Se um parâmetro de cadeia de caracteres contiver caracteres não representados pela página de código do banco de dados, ocorrerá um erro ao chamar [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span><span class="sxs-lookup"><span data-stu-id="f66cb-122">If a string parameter contains characters not represented by the code page of the database, an error occurs when calling [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span></span> <span data-ttu-id="f66cb-123">Para obter mais informações, consulte [manipulação de página de código de cadeias de caracteres de parâmetro](code-page-handling-of-parameter-strings.md).</span><span class="sxs-lookup"><span data-stu-id="f66cb-123">For more information, see [Code Page Handling of Parameter Strings](code-page-handling-of-parameter-strings.md).</span></span>

<span data-ttu-id="f66cb-124">Se um pacote for usado para instalar várias versões de idioma de um produto, a transformação usada para localizar cadeias de caracteres também poderá alterar a página de código do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f66cb-124">If one package is used to install multiple language versions of a product, the transform that is used to localize strings can also change the code page of the database.</span></span>

 

 
