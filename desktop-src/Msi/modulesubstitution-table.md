---
description: A tabela ModuleSubstitution especifica os campos configuráveis de um banco de dados de módulo e fornece um modelo para a configuração de cada campo.
ms.assetid: 8e94c31f-b3a7-4f3a-aec4-32b0e1dd5400
title: Tabela ModuleSubstitution
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2e27789f723af87e228bada91b79a16d7dc4d2d4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104172025"
---
# <a name="modulesubstitution-table"></a><span data-ttu-id="ce09d-103">Tabela ModuleSubstitution</span><span class="sxs-lookup"><span data-stu-id="ce09d-103">ModuleSubstitution Table</span></span>

<span data-ttu-id="ce09d-104">A tabela ModuleSubstitution especifica os campos configuráveis de um banco de dados de módulo e fornece um modelo para a configuração de cada campo.</span><span class="sxs-lookup"><span data-stu-id="ce09d-104">The ModuleSubstitution table specifies the configurable fields of a module database and provides a template for the configuration of each field.</span></span> <span data-ttu-id="ce09d-105">A ferramenta de usuário ou de mesclagem pode consultar essa tabela para determinar quais operações de configuração devem ocorrer.</span><span class="sxs-lookup"><span data-stu-id="ce09d-105">The user or merge tool may query this table to determine what configuration operations are to take place.</span></span> <span data-ttu-id="ce09d-106">Esta tabela não é mesclada no banco de dados de destino.</span><span class="sxs-lookup"><span data-stu-id="ce09d-106">This table is not merged into the target database.</span></span>

<span data-ttu-id="ce09d-107">As tabelas a seguir não podem conter campos configuráveis e não devem estar listadas nesta tabela:</span><span class="sxs-lookup"><span data-stu-id="ce09d-107">The following tables cannot contain configurable fields and must not be listed in this table:</span></span>

<span data-ttu-id="ce09d-108">Tabela ModuleSubstitution</span><span class="sxs-lookup"><span data-stu-id="ce09d-108">ModuleSubstitution table</span></span>

[<span data-ttu-id="ce09d-109">Tabela ModuleConfiguration</span><span class="sxs-lookup"><span data-stu-id="ce09d-109">ModuleConfiguration table</span></span>](moduleconfiguration-table.md)

[<span data-ttu-id="ce09d-110">Tabela ModuleExclusion</span><span class="sxs-lookup"><span data-stu-id="ce09d-110">ModuleExclusion table</span></span>](moduleexclusion-table.md)

[<span data-ttu-id="ce09d-111">Tabela ModuleSignature</span><span class="sxs-lookup"><span data-stu-id="ce09d-111">ModuleSignature table</span></span>](modulesignature-table.md)

<span data-ttu-id="ce09d-112">A tabela ModuleSubstitution tem as colunas a seguir.</span><span class="sxs-lookup"><span data-stu-id="ce09d-112">The ModuleSubstitution table has the following columns.</span></span>



| <span data-ttu-id="ce09d-113">Coluna</span><span class="sxs-lookup"><span data-stu-id="ce09d-113">Column</span></span> | <span data-ttu-id="ce09d-114">Tipo</span><span class="sxs-lookup"><span data-stu-id="ce09d-114">Type</span></span>                         | <span data-ttu-id="ce09d-115">Chave</span><span class="sxs-lookup"><span data-stu-id="ce09d-115">Key</span></span> | <span data-ttu-id="ce09d-116">Nullable</span><span class="sxs-lookup"><span data-stu-id="ce09d-116">Nullable</span></span> |
|--------|------------------------------|-----|----------|
| <span data-ttu-id="ce09d-117">Tabela</span><span class="sxs-lookup"><span data-stu-id="ce09d-117">Table</span></span>  | [<span data-ttu-id="ce09d-118">Identificador</span><span class="sxs-lookup"><span data-stu-id="ce09d-118">Identifier</span></span>](identifier.md) | <span data-ttu-id="ce09d-119">S</span><span class="sxs-lookup"><span data-stu-id="ce09d-119">Y</span></span>   | <span data-ttu-id="ce09d-120">N</span><span class="sxs-lookup"><span data-stu-id="ce09d-120">N</span></span>        |
| <span data-ttu-id="ce09d-121">Linha</span><span class="sxs-lookup"><span data-stu-id="ce09d-121">Row</span></span>    | [<span data-ttu-id="ce09d-122">Text</span><span class="sxs-lookup"><span data-stu-id="ce09d-122">Text</span></span>](text.md)             | <span data-ttu-id="ce09d-123">S</span><span class="sxs-lookup"><span data-stu-id="ce09d-123">Y</span></span>   | <span data-ttu-id="ce09d-124">N</span><span class="sxs-lookup"><span data-stu-id="ce09d-124">N</span></span>        |
| <span data-ttu-id="ce09d-125">Coluna</span><span class="sxs-lookup"><span data-stu-id="ce09d-125">Column</span></span> | [<span data-ttu-id="ce09d-126">Identificador</span><span class="sxs-lookup"><span data-stu-id="ce09d-126">Identifier</span></span>](identifier.md) | <span data-ttu-id="ce09d-127">S</span><span class="sxs-lookup"><span data-stu-id="ce09d-127">Y</span></span>   | <span data-ttu-id="ce09d-128">N</span><span class="sxs-lookup"><span data-stu-id="ce09d-128">N</span></span>        |
| <span data-ttu-id="ce09d-129">Valor</span><span class="sxs-lookup"><span data-stu-id="ce09d-129">Value</span></span>  | [<span data-ttu-id="ce09d-130">Text</span><span class="sxs-lookup"><span data-stu-id="ce09d-130">Text</span></span>](text.md)             | <span data-ttu-id="ce09d-131">N</span><span class="sxs-lookup"><span data-stu-id="ce09d-131">N</span></span>   | <span data-ttu-id="ce09d-132">S</span><span class="sxs-lookup"><span data-stu-id="ce09d-132">Y</span></span>        |



 

## <a name="columns"></a><span data-ttu-id="ce09d-133">Colunas</span><span class="sxs-lookup"><span data-stu-id="ce09d-133">Columns</span></span>

<dl> <dt>

<span data-ttu-id="ce09d-134"><span id="Table"></span><span id="table"></span><span id="TABLE"></span>Tabela</span><span class="sxs-lookup"><span data-stu-id="ce09d-134"><span id="Table"></span><span id="table"></span><span id="TABLE"></span>Table</span></span>
</dt> <dd>

<span data-ttu-id="ce09d-135">Esta coluna especifica o nome da tabela que está sendo modificada no banco de dados do módulo.</span><span class="sxs-lookup"><span data-stu-id="ce09d-135">This column specifies the name of the table being modified in the module database.</span></span>

</dd> <dt>

<span data-ttu-id="ce09d-136"><span id="Row"></span><span id="row"></span><span id="ROW"></span>Fila</span><span class="sxs-lookup"><span data-stu-id="ce09d-136"><span id="Row"></span><span id="row"></span><span id="ROW"></span>Row</span></span>
</dt> <dd>

<span data-ttu-id="ce09d-137">Este campo especifica as chaves primárias da linha de destino na tabela denominada na coluna tabela.</span><span class="sxs-lookup"><span data-stu-id="ce09d-137">This field specifies the primary keys of the target row in the table named in the Table column.</span></span> <span data-ttu-id="ce09d-138">Várias chaves primárias são separadas por ponto e vírgula.</span><span class="sxs-lookup"><span data-stu-id="ce09d-138">Multiple primary keys are separated by semicolons.</span></span> <span data-ttu-id="ce09d-139">Linhas de destino são selecionadas para modificação antes que qualquer alteração seja feita na tabela de destino.</span><span class="sxs-lookup"><span data-stu-id="ce09d-139">Target rows are selected for modification before any changes are made to the target table.</span></span> <span data-ttu-id="ce09d-140">Se um registro na tabela ModuleSubstitution alterar o campo de chave primária de uma linha de destino, outros registros na tabela ModuleSubstitution serão aplicados com base nos dados da chave primária original, não no resultado de substituições de chave primária.</span><span class="sxs-lookup"><span data-stu-id="ce09d-140">If one record in the ModuleSubstitution table changes the primary key field of a target row, other records in the ModuleSubstitution table are applied based on the original primary key data, not the resulting of primary key substitutions.</span></span> <span data-ttu-id="ce09d-141">A ordem de substituição de linha é indefinida.</span><span class="sxs-lookup"><span data-stu-id="ce09d-141">The order of row substitution is undefined.</span></span>

<span data-ttu-id="ce09d-142">Os valores nesta coluna estão sempre no [formato especial CMSM](cmsm-special-format.md).</span><span class="sxs-lookup"><span data-stu-id="ce09d-142">Values in this column are always in [CMSM special format](cmsm-special-format.md).</span></span> <span data-ttu-id="ce09d-143">Um ponto-e-vírgula literal ('; ') ou sinal de igual (' = ') pode ser adicionado por meio da prefixação do caractere com uma barra invertida.</span><span class="sxs-lookup"><span data-stu-id="ce09d-143">A literal semicolon (';') or equal sign ('=') can be added by prefixing the character with a backslash.</span></span> <span data-ttu-id="ce09d-144">'\\'.</span><span class="sxs-lookup"><span data-stu-id="ce09d-144">'\\'.</span></span> <span data-ttu-id="ce09d-145">Um valor nulo para uma chave é representado por um caractere nulo, um ponto-e-vírgula à esquerda, dois pontos-e-vírgulas consecutivos ou um ponto e vírgula à direita, dependendo se o valor nulo é um valor de coluna de chave único, primeiro, médio ou final.</span><span class="sxs-lookup"><span data-stu-id="ce09d-145">A null value for a key is signified by a null, a leading semicolon, two consecutive semicolons, or a trailing semicolon, depending on whether the null value is a sole, first, middle, or final key column value.</span></span>

</dd> <dt>

<span data-ttu-id="ce09d-146"><span id="Column"></span><span id="column"></span><span id="COLUMN"></span>Pilha</span><span class="sxs-lookup"><span data-stu-id="ce09d-146"><span id="Column"></span><span id="column"></span><span id="COLUMN"></span>Column</span></span>
</dt> <dd>

<span data-ttu-id="ce09d-147">Este campo especifica a coluna de destino na linha denominada na coluna linha.</span><span class="sxs-lookup"><span data-stu-id="ce09d-147">This field specifies the target column in the row named in the Row column.</span></span> <span data-ttu-id="ce09d-148">Se várias linhas na tabela ModuleSubstitution alterarem colunas diferentes da mesma linha de destino, todas as substituições de coluna serão executadas antes que a linha modificada seja inserida no banco de dados.</span><span class="sxs-lookup"><span data-stu-id="ce09d-148">If multiple rows in the ModuleSubstitution table change different columns of the same target row, all the column substitutions are performed before the modified row is inserted into the database.</span></span> <span data-ttu-id="ce09d-149">A ordem de substituição de coluna é indefinida.</span><span class="sxs-lookup"><span data-stu-id="ce09d-149">The order of column substitution is undefined.</span></span>

</dd> <dt>

<span data-ttu-id="ce09d-150"><span id="Value"></span><span id="value"></span><span id="VALUE"></span>Valor</span><span class="sxs-lookup"><span data-stu-id="ce09d-150"><span id="Value"></span><span id="value"></span><span id="VALUE"></span>Value</span></span>
</dt> <dd>

<span data-ttu-id="ce09d-151">Esta coluna contém uma cadeia de caracteres que fornece um modelo de formatação para os dados que estão sendo substituídos no campo de destino especificado por tabela, linha e coluna.</span><span class="sxs-lookup"><span data-stu-id="ce09d-151">This column contains a string that provides a formatting template for the data being substituted into the target field specified by Table, Row, and Column.</span></span> <span data-ttu-id="ce09d-152">Quando uma cadeia de caracteres de substituição do formulário \[ = Itema \] for encontrada, a cadeia de caracteres, incluindo os caracteres de colchete, será substituída pelo valor para o "Itema" configurável.</span><span class="sxs-lookup"><span data-stu-id="ce09d-152">When a substitution string of the form \[=ItemA\] is encountered, the string, including the bracket characters, is replaced by the value for the configurable "ItemA."</span></span> <span data-ttu-id="ce09d-153">O item configurável "Itema" é especificado na coluna Name da [Tabela ModuleConfiguration](moduleconfiguration-table.md) e seu valor é fornecido pela ferramenta de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="ce09d-153">The configurable item "ItemA" is specified in the Name column of the [ModuleConfiguration table](moduleconfiguration-table.md) and its value is provided by the merge tool.</span></span> <span data-ttu-id="ce09d-154">Se a ferramenta de mesclagem declinar para fornecer um valor para qualquer item em uma cadeia de caracteres de substituição, o valor padrão especificado na coluna DefaultValue da Tabela ModuleConfiguration será substituído.</span><span class="sxs-lookup"><span data-stu-id="ce09d-154">If the merge tool declines to provide a value for any item in a replacement string, the default value specified in the DefaultValue column of the ModuleConfiguration Table is substituted.</span></span> <span data-ttu-id="ce09d-155">Se uma cadeia de caracteres fizer referência a um item que não está na Tabela ModuleConfiguration, a mesclagem falhará.</span><span class="sxs-lookup"><span data-stu-id="ce09d-155">If a string references an item not in the ModuleConfiguration table, the merge fails.</span></span>

-   <span data-ttu-id="ce09d-156">Essa coluna usa o [formato especial CMSM](cmsm-special-format.md).</span><span class="sxs-lookup"><span data-stu-id="ce09d-156">This column uses [CMSM special format](cmsm-special-format.md).</span></span> <span data-ttu-id="ce09d-157">Um ponto-e-vírgula literal ('; ') ou sinal de igual (' = ') pode ser adicionado à tabela por meio da prefixação do caractere com uma barra invertida.</span><span class="sxs-lookup"><span data-stu-id="ce09d-157">A literal semicolon (';') or equals sign ('=') can be added to the table by prefixing the character with a backslash.</span></span> <span data-ttu-id="ce09d-158">'\\'.</span><span class="sxs-lookup"><span data-stu-id="ce09d-158">'\\'.</span></span>
-   <span data-ttu-id="ce09d-159">O campo valor pode conter várias cadeias de caracteres de substituição.</span><span class="sxs-lookup"><span data-stu-id="ce09d-159">The Value field may contain multiple substitution strings.</span></span> <span data-ttu-id="ce09d-160">Por exemplo, a configuração dos itens "Food1" e "Food2" na cadeia de caracteres: " \[ = Food1 \] é boa, mas \[ = Food2 \] é melhor porque \[ = Food2 \] é mais nutritious".</span><span class="sxs-lookup"><span data-stu-id="ce09d-160">For example, the configuration of items "Food1" and "Food2" in the string: "\[=Food1\] is good, but \[=Food2\] is better because \[=Food2\] is more nutritious."</span></span>
-   <span data-ttu-id="ce09d-161">As cadeias de caracteres de substituição não devem ser aninhadas.</span><span class="sxs-lookup"><span data-stu-id="ce09d-161">Replacement strings must not be nested.</span></span> <span data-ttu-id="ce09d-162">O modelo " \[ = AB \[ = CDE \] \] " é inválido.</span><span class="sxs-lookup"><span data-stu-id="ce09d-162">The template "\[=AB\[=CDE\]\]" is invalid.</span></span>
-   <span data-ttu-id="ce09d-163">Se o campo valor for avaliado como nulo e o campo de destino não for anulável, a mesclagem falhará e um objeto de erro do tipo msmErrorBadNullSubstitution será criado e adicionado à lista de erros.</span><span class="sxs-lookup"><span data-stu-id="ce09d-163">If the Value field evaluates to null, and the target field is not nullable, the merge fails and an error object of type msmErrorBadNullSubstitution is created and added to the error list.</span></span> <span data-ttu-id="ce09d-164">Para obter detalhes, consulte os tipos de erro descritos na [**\_ função obter tipo**](/windows/win32/api/mergemod/nf-mergemod-imsmerror-get_type).</span><span class="sxs-lookup"><span data-stu-id="ce09d-164">For details, see the error types described in [**get\_Type Function**](/windows/win32/api/mergemod/nf-mergemod-imsmerror-get_type).</span></span>
-   <span data-ttu-id="ce09d-165">Se o campo de valor for avaliado como o GUID NULL: {00000000-0000-0000-0000-000000000000} , o GUID NULL será substituído pelo nome do recurso antes que a linha seja mesclada no módulo.</span><span class="sxs-lookup"><span data-stu-id="ce09d-165">If the Value field evaluates to the null GUID: {00000000-0000-0000-0000-000000000000}, the null GUID is replaced by the name of the feature before the row is merged into the module.</span></span> <span data-ttu-id="ce09d-166">Para obter detalhes, consulte [Referenciando recursos em módulos de mesclagem](referencing-features-in-merge-modules.md).</span><span class="sxs-lookup"><span data-stu-id="ce09d-166">For details, see [Referencing Features in Merge Modules](referencing-features-in-merge-modules.md).</span></span>
-   <span data-ttu-id="ce09d-167">O modelo no campo valor é avaliado antes de ser inserido no campo de destino.</span><span class="sxs-lookup"><span data-stu-id="ce09d-167">The template in the Value field is evaluated before being inserted into the target field.</span></span> <span data-ttu-id="ce09d-168">A substituição em uma linha é feita antes da substituição de qualquer recurso.</span><span class="sxs-lookup"><span data-stu-id="ce09d-168">Substitution into a row is done before replacing any features.</span></span>
-   <span data-ttu-id="ce09d-169">Se a coluna de valor for avaliada como uma cadeia de caracteres de somente números inteiros (com um opcional + ou-), a cadeia de caracteres será convertida em um inteiro antes de ser substituída em um campo de destino do [tipo de formato inteiro](integer-format-types.md).</span><span class="sxs-lookup"><span data-stu-id="ce09d-169">If the Value column evaluates to a string of only integer characters (with an optional + or -), the string is converted into an integer before being substituted into an target field of the [Integer Format Type](integer-format-types.md).</span></span> <span data-ttu-id="ce09d-170">Se o modelo for avaliado como uma cadeia de caracteres que não consiste apenas em caracteres inteiros (e um opcional + ou-), o resultado não poderá ser substituído em um campo de destino de inteiro.</span><span class="sxs-lookup"><span data-stu-id="ce09d-170">If the template evaluates to a string that does not consist only of integer characters (and an optional + or -) the result cannot be substituted into an integer target field.</span></span> <span data-ttu-id="ce09d-171">A tentativa de inserir um não inteiro em um campo inteiro faz com que a mesclagem falhe e adicione um objeto de erro msmErrorBadSubstitutionType à lista de erros.</span><span class="sxs-lookup"><span data-stu-id="ce09d-171">Attempting to insert a non-integer into an integer field causes the merge to fail and adds a msmErrorBadSubstitutionType error object to the error list.</span></span>
-   <span data-ttu-id="ce09d-172">Se a coluna de destino especificada nos campos de tabela e coluna for um [tipo de formato de texto](text-format-types.md), e a avaliação do campo valor resultar em um tipo de [formato inteiro](integer-format-types.md), uma representação decimal do número será inserida no campo de texto de destino.</span><span class="sxs-lookup"><span data-stu-id="ce09d-172">If the target column specified in the Table and Column fields is a [Text Format Type](text-format-types.md), and evaluation of the Value field results in an [Integer Format Type](integer-format-types.md), a decimal representation of the number is inserted into the target text field.</span></span>
-   <span data-ttu-id="ce09d-173">Se o campo de destino for [um tipo de formato inteiro](integer-format-types.md), e o campo de valor consiste em uma lista não delimitada de itens no [formato](bitfield-format-types.md)de campo de bits, o valor no campo de destino é combinado usando o operador **and** bit a bit com o inverso de or de-bit **ou** de todos os valores de máscara dos itens e, em seguida, combinado usando **o operador OR** de inteiros com cada um dos itens de inteiro ou de campo de ocultação quando</span><span class="sxs-lookup"><span data-stu-id="ce09d-173">If the target field is an [Integer Format Type](integer-format-types.md), and the Value field consists of a non-delimited list of items in [Bitfield Format](bitfield-format-types.md), the value in the target field is combined using the bitwise **AND** operator with the inverse of the bitwise **OR** of all of the mask values from the items, then combined using the bitwise **OR** operator with each of the integer or bitfield items when masked by their corresponding mask values.</span></span> <span data-ttu-id="ce09d-174">Essencialmente, isso define explicitamente os bits das propriedades para os valores fornecidos, mas deixa todos os outros bits somente na célula.</span><span class="sxs-lookup"><span data-stu-id="ce09d-174">Essentially, this explicitly sets the bits from the properties to the provided values but leaves all other bits in the cell alone.</span></span>
-   <span data-ttu-id="ce09d-175">Se o campo valor for avaliado como um [tipo de formato de chave](key-format-types.md)e for uma chave em uma tabela que usa várias chaves primárias, o nome do item poderá ser seguido por um ponto e vírgula e um valor inteiro que indica o índice de base 1 no conjunto de valores que juntos fazem uma chave primária.</span><span class="sxs-lookup"><span data-stu-id="ce09d-175">If the Value field evaluates to a [Key Format Type](key-format-types.md), and is a key into a table that uses multiple primary keys, the item name may be followed by a semicolon and an integer value that indicates the 1-based index into the set of values that together make a primary key.</span></span> <span data-ttu-id="ce09d-176">Se nenhum inteiro for especificado, o valor 1 será usado.</span><span class="sxs-lookup"><span data-stu-id="ce09d-176">If no integer is specified, the value 1 is used.</span></span> <span data-ttu-id="ce09d-177">Por exemplo, a [tabela de controle](control-table.md) tem duas colunas de chave primária, caixa \_ de diálogo e controle.</span><span class="sxs-lookup"><span data-stu-id="ce09d-177">For example, the [Control table](control-table.md) has two primary key columns, Dialog\_ and Control.</span></span> <span data-ttu-id="ce09d-178">O valor de um item "Item1" que é uma chave para a tabela de controle estará no formato "Dialogname; ControlName ", em que Dialogname é o valor na tabela de diálogo \_ e ControlName é o valor na coluna Control.</span><span class="sxs-lookup"><span data-stu-id="ce09d-178">The value of an item "Item1" that is a key into the Control table will be of the form "DialogName;ControlName", where DialogName is the value in the Dialog\_ table and ControlName is the value in the Control column.</span></span> <span data-ttu-id="ce09d-179">Para substituir apenas ControlName, a cadeia de caracteres de substituição \[ = Item1; 2 \] deve ser usada.</span><span class="sxs-lookup"><span data-stu-id="ce09d-179">To substitute just ControlName, the substitution string \[=Item1;2\] should be used.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="ce09d-180">Comentários</span><span class="sxs-lookup"><span data-stu-id="ce09d-180">Remarks</span></span>

<span data-ttu-id="ce09d-181">A tabela ModuleSubstition é usada por [módulos de mesclagem configuráveis](configurable-merge-modules.md).</span><span class="sxs-lookup"><span data-stu-id="ce09d-181">The ModuleSubstition table is used by [Configurable Merge Modules](configurable-merge-modules.md).</span></span> <span data-ttu-id="ce09d-182">Mergemod.dll versão 2,0 ou posterior é necessária para criar um módulo de mesclagem configurável.</span><span class="sxs-lookup"><span data-stu-id="ce09d-182">Mergemod.dll version 2.0 or later is required to create a configurable merge module.</span></span>

<span data-ttu-id="ce09d-183">Para garantir a compatibilidade com versões do Mergemod.dll anteriores à versão 2,0, a [Tabela ModuleConfiguration](moduleconfiguration-table.md) e as tabelas ModuleSubstitution devem ser incluídas na [tabela ModuleIgnoreTable](moduleignoretable-table.md) de cada módulo.</span><span class="sxs-lookup"><span data-stu-id="ce09d-183">To ensure compatibility with versions of Mergemod.dll earlier than version 2.0, the [ModuleConfiguration table](moduleconfiguration-table.md) and ModuleSubstitution tables should be included in the [ModuleIgnoreTable table](moduleignoretable-table.md) of every module.</span></span>

 

 
