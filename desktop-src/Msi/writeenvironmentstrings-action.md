---
description: A ação WriteEnvironmentStrings modifica os valores das variáveis de ambiente.
ms.assetid: a91c1ffe-1bdd-49bb-aa6a-71667a1ed812
title: Ação WriteEnvironmentStrings
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dc3a9d64a1140fc883d94e8d3733608d29dc2d39
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104011254"
---
# <a name="writeenvironmentstrings-action"></a><span data-ttu-id="848e8-103">Ação WriteEnvironmentStrings</span><span class="sxs-lookup"><span data-stu-id="848e8-103">WriteEnvironmentStrings Action</span></span>

<span data-ttu-id="848e8-104">A ação WriteEnvironmentStrings modifica os valores das variáveis de ambiente.</span><span class="sxs-lookup"><span data-stu-id="848e8-104">The WriteEnvironmentStrings action modifies the values of environment variables.</span></span>

<span data-ttu-id="848e8-105">As variáveis de ambiente não são alteradas para a instalação em andamento quando a ação WriteEnvironmentStrings ou a [ação RemoveEnvironmentStrings](removeenvironmentstrings-action.md) são executadas.</span><span class="sxs-lookup"><span data-stu-id="848e8-105">Environment variables do not change for the installation in progress when the WriteEnvironmentStrings action or [RemoveEnvironmentStrings action](removeenvironmentstrings-action.md) are run.</span></span> <span data-ttu-id="848e8-106">No Windows 2000, no Windows Server 2003, no Windows XP e no Windows Vista, essas informações são armazenadas no registro e uma mensagem do [**WM \_ SETTINGCHANGE**](../winmsg/wm-settingchange.md) é enviada para notificar o sistema sobre as alterações quando a instalação for concluída.</span><span class="sxs-lookup"><span data-stu-id="848e8-106">On Windows 2000, Windows Server 2003, Windows XP, and Windows Vista this information is stored in the registry and a [**WM\_SETTINGCHANGE**](../winmsg/wm-settingchange.md) message is sent to notify the system of the changes when the installation completes.</span></span> <span data-ttu-id="848e8-107">Outro processo pode receber a notificação das alterações manipulando essas mensagens.</span><span class="sxs-lookup"><span data-stu-id="848e8-107">Another process can receive notification of the changes by handling these messages.</span></span> <span data-ttu-id="848e8-108">Nenhuma mensagem será enviada se uma reinicialização do sistema estiver pendente.</span><span class="sxs-lookup"><span data-stu-id="848e8-108">No message is sent if a restart of the system is pending.</span></span> <span data-ttu-id="848e8-109">Um pacote pode usar a propriedade [**MsiSystemRebootPending**](msisystemrebootpending.md) para verificar se uma reinicialização do sistema está pendente.</span><span class="sxs-lookup"><span data-stu-id="848e8-109">A package can use the [**MsiSystemRebootPending**](msisystemrebootpending.md) property to check whether a system restart is pending.</span></span>

<span data-ttu-id="848e8-110">O instalador executa a ação WriteEnvironmentStrings somente durante a instalação ou reinstalação de um componente e executa a [ação RemoveEnvironmentStrings](removeenvironmentstrings-action.md) somente durante a remoção de um componente.</span><span class="sxs-lookup"><span data-stu-id="848e8-110">The installer runs the WriteEnvironmentStrings action only during the installation or reinstallation of a component, and runs the [RemoveEnvironmentStrings action](removeenvironmentstrings-action.md) only during the removal of a component.</span></span>

<span data-ttu-id="848e8-111">Os valores são gravados ou removidos com base na seleção de ações e modificadores primários.</span><span class="sxs-lookup"><span data-stu-id="848e8-111">Values are written or removed based on the selection of primary actions and modifiers.</span></span> <span data-ttu-id="848e8-112">Eles são descritos na seção mensagens ActionData a seguir.</span><span class="sxs-lookup"><span data-stu-id="848e8-112">These are described in the following ActionData Messages section.</span></span> <span data-ttu-id="848e8-113">Observe que, dependendo da ação especificada, WriteEnvironmentStrings pode remover variáveis e RemoveEnvironmentStrings pode adicioná-las com base na criação da [tabela de ambiente](environment-table.md).</span><span class="sxs-lookup"><span data-stu-id="848e8-113">Note that depending on the action specified, WriteEnvironmentStrings may remove variables, and RemoveEnvironmentStrings may add them based on the authoring of the [Environment table](environment-table.md).</span></span>

## <a name="sequence-restrictions"></a><span data-ttu-id="848e8-114">Restrições de sequência</span><span class="sxs-lookup"><span data-stu-id="848e8-114">Sequence Restrictions</span></span>

<span data-ttu-id="848e8-115">A [ação InstallValidate](installvalidate-action.md) deve ser executada antes da ação RemoveEnvironmentStrings.</span><span class="sxs-lookup"><span data-stu-id="848e8-115">The [InstallValidate action](installvalidate-action.md) must be executed before the RemoveEnvironmentStrings action.</span></span> <span data-ttu-id="848e8-116">Como a ação WriteEnvironmentStrings e a ação RemoveEnvironmentStrings nunca são aplicadas durante uma instalação ou remoção de um componente, sua sequência relativa não é restrita.</span><span class="sxs-lookup"><span data-stu-id="848e8-116">Because the WriteEnvironmentStrings action and RemoveEnvironmentStrings action are never both applied during an install or removal of a component, their relative sequence is not restricted.</span></span>

## <a name="actiondata-messages"></a><span data-ttu-id="848e8-117">Mensagens ActionData</span><span class="sxs-lookup"><span data-stu-id="848e8-117">ActionData Messages</span></span>



| <span data-ttu-id="848e8-118">Campo</span><span class="sxs-lookup"><span data-stu-id="848e8-118">Field</span></span> | <span data-ttu-id="848e8-119">Descrição dos dados da ação</span><span class="sxs-lookup"><span data-stu-id="848e8-119">Description of action data</span></span>                                                                                                                                                                                                  |
|-------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="848e8-120">\[1\]</span><span class="sxs-lookup"><span data-stu-id="848e8-120">\[1\]</span></span> | <span data-ttu-id="848e8-121">Nome da variável de ambiente a ser modificada.</span><span class="sxs-lookup"><span data-stu-id="848e8-121">Name of the environment variable to modify.</span></span>                                                                                                                                                                                 |
| <span data-ttu-id="848e8-122">\[2\]</span><span class="sxs-lookup"><span data-stu-id="848e8-122">\[2\]</span></span> | <span data-ttu-id="848e8-123">O valor da variável de ambiente.</span><span class="sxs-lookup"><span data-stu-id="848e8-123">The environment variable value.</span></span>                                                                                                                                                                                             |
| <span data-ttu-id="848e8-124">\[3\]</span><span class="sxs-lookup"><span data-stu-id="848e8-124">\[3\]</span></span> | <span data-ttu-id="848e8-125">Esse é um campo de sinalizadores de bit que especifica a ação a ser executada.</span><span class="sxs-lookup"><span data-stu-id="848e8-125">This is a field of bit flags that specifies the action to be performed.</span></span> <span data-ttu-id="848e8-126">Inclua apenas um bit para uma ação principal.</span><span class="sxs-lookup"><span data-stu-id="848e8-126">Include only one bit for a primary action.</span></span> <span data-ttu-id="848e8-127">Pode haver mais de um bit modificador incluído neste campo.</span><span class="sxs-lookup"><span data-stu-id="848e8-127">There may be more than one modifier bit included in this field.</span></span> <span data-ttu-id="848e8-128">Consulte as seguintes descrições de sinalizador de bits.</span><span class="sxs-lookup"><span data-stu-id="848e8-128">See the following bit flag descriptions.</span></span> |



 



| <span data-ttu-id="848e8-129">Valor de bit</span><span class="sxs-lookup"><span data-stu-id="848e8-129">Bit Value</span></span> | <span data-ttu-id="848e8-130">Descrição das ações principais</span><span class="sxs-lookup"><span data-stu-id="848e8-130">Description of primary actions</span></span>                                                                                                                                                                                      |
|-----------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="848e8-131">0x1</span><span class="sxs-lookup"><span data-stu-id="848e8-131">0x1</span></span>       | <span data-ttu-id="848e8-132">Definido.</span><span class="sxs-lookup"><span data-stu-id="848e8-132">Set.</span></span> <span data-ttu-id="848e8-133">Define o valor da variável de ambiente em todos os casos.</span><span class="sxs-lookup"><span data-stu-id="848e8-133">Sets the value of the environment variable in all cases.</span></span><br/> <span data-ttu-id="848e8-134">Se esse bit for combinado com um bit de modificador de acréscimo ou de prefixo, a ação adicionará o valor a qualquer valor existente na variável.</span><span class="sxs-lookup"><span data-stu-id="848e8-134">If this bit is combined with an Append or Prefix modifier bit, the action adds the value to any existing value in the variable.</span></span><br/> |
| <span data-ttu-id="848e8-135">0x2</span><span class="sxs-lookup"><span data-stu-id="848e8-135">0x2</span></span>       | <span data-ttu-id="848e8-136">Definido.</span><span class="sxs-lookup"><span data-stu-id="848e8-136">Set.</span></span> <span data-ttu-id="848e8-137">Define o valor se a variável estiver ausente.</span><span class="sxs-lookup"><span data-stu-id="848e8-137">Sets the value if the variable is absent.</span></span><br/> <span data-ttu-id="848e8-138">Se esse bit for combinado com um bit de modificador de acréscimo ou de prefixo, a ação adicionará o valor a qualquer valor existente na variável.</span><span class="sxs-lookup"><span data-stu-id="848e8-138">If this bit is combined with an Append or Prefix modifier bit, the action adds the value to any existing value in the variable.</span></span><br/>                |
| <span data-ttu-id="848e8-139">0x4</span><span class="sxs-lookup"><span data-stu-id="848e8-139">0x4</span></span>       | <span data-ttu-id="848e8-140">Remover.</span><span class="sxs-lookup"><span data-stu-id="848e8-140">Remove.</span></span> <span data-ttu-id="848e8-141">Remove o valor da variável.</span><span class="sxs-lookup"><span data-stu-id="848e8-141">Removes the value from the variable.</span></span><br/> <span data-ttu-id="848e8-142">Se esse bit for combinado com um bit de modificador de acréscimo ou de prefixo, o valor será removido da cadeia de caracteres existente, se o valor existir.</span><span class="sxs-lookup"><span data-stu-id="848e8-142">If this bit is combined with an Append or Prefix modifier bit, the value is removed from the existing string, if the value exists.</span></span><br/>               |



 



| <span data-ttu-id="848e8-143">Valor de bit</span><span class="sxs-lookup"><span data-stu-id="848e8-143">Bit Value</span></span>  | <span data-ttu-id="848e8-144">Descrição do modificador</span><span class="sxs-lookup"><span data-stu-id="848e8-144">Description of modifier</span></span>                                                                                                                                                              |
|------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="848e8-145">0x20000000</span><span class="sxs-lookup"><span data-stu-id="848e8-145">0x20000000</span></span> | <span data-ttu-id="848e8-146">Se esse bit for definido, as ações serão aplicadas às variáveis de ambiente da máquina.</span><span class="sxs-lookup"><span data-stu-id="848e8-146">If this bit is set, actions are applied to the machine environment variables.</span></span><br/> <span data-ttu-id="848e8-147">Se esse bit não estiver definido, as ações serão aplicadas às variáveis de ambiente do usuário.</span><span class="sxs-lookup"><span data-stu-id="848e8-147">If this bit is not set, actions are applied to the user's environment variables.</span></span><br/> |
| <span data-ttu-id="848e8-148">0x40000000</span><span class="sxs-lookup"><span data-stu-id="848e8-148">0x40000000</span></span> | <span data-ttu-id="848e8-149">Anexar.</span><span class="sxs-lookup"><span data-stu-id="848e8-149">Append.</span></span> <span data-ttu-id="848e8-150">Esse bit é opcional.</span><span class="sxs-lookup"><span data-stu-id="848e8-150">This bit is optional.</span></span> <span data-ttu-id="848e8-151">Não defina os modificadores Append e Prefix.</span><span class="sxs-lookup"><span data-stu-id="848e8-151">Do not set both the Append and Prefix modifiers.</span></span><br/>                                                                                            |
| <span data-ttu-id="848e8-152">0x80000000</span><span class="sxs-lookup"><span data-stu-id="848e8-152">0x80000000</span></span> | <span data-ttu-id="848e8-153">Prefixo.</span><span class="sxs-lookup"><span data-stu-id="848e8-153">Prefix.</span></span> <span data-ttu-id="848e8-154">Esse bit é opcional.</span><span class="sxs-lookup"><span data-stu-id="848e8-154">This bit is optional.</span></span> <span data-ttu-id="848e8-155">Não defina os modificadores Append e Prefix.</span><span class="sxs-lookup"><span data-stu-id="848e8-155">Do not set both the Append and Prefix modifiers.</span></span><br/>                                                                                            |



 

 

 
