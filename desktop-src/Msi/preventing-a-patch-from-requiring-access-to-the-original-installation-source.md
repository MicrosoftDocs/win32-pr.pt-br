---
description: Não é possível eliminar todas as circunstâncias sob as quais a aplicação de um patch pode exigir acesso à fonte de instalação original.
ms.assetid: f7028c55-e4a5-4596-af7a-728c9f4f367e
title: Impedir que um patch exija acesso à fonte de instalação original
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: baee8b261ff0a3f6bb94fb141ee765726ffa2ced
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103828023"
---
# <a name="preventing-a-patch-from-requiring-access-to-the-original-installation-source"></a><span data-ttu-id="3ac66-103">Impedir que um patch exija acesso à fonte de instalação original</span><span class="sxs-lookup"><span data-stu-id="3ac66-103">Preventing a Patch from Requiring Access to the Original Installation Source</span></span>

<span data-ttu-id="3ac66-104">Não é possível eliminar todas as circunstâncias sob as quais a aplicação de um patch pode exigir acesso à fonte de instalação original.</span><span class="sxs-lookup"><span data-stu-id="3ac66-104">It is not possible to eliminate all circumstances under which the application of a patch may require access to the original installation source.</span></span>

<span data-ttu-id="3ac66-105">Siga os seguintes pontos para minimizar a possibilidade de que seu patch exija acesso à fonte original:</span><span class="sxs-lookup"><span data-stu-id="3ac66-105">Adhere to following points to minimize the possibility that your patch will require access to the original source:</span></span>

-   <span data-ttu-id="3ac66-106">Usar patches de arquivo inteiro somente.</span><span class="sxs-lookup"><span data-stu-id="3ac66-106">Use whole-file only patches.</span></span> <span data-ttu-id="3ac66-107">Isso elimina a necessidade de criar patches binários para todas as versões lançadas anteriormente do arquivo.</span><span class="sxs-lookup"><span data-stu-id="3ac66-107">This eliminates the need to create binary patches for all previously released versions of the file.</span></span> <span data-ttu-id="3ac66-108">Observe que os patches de arquivo inteiros são geralmente maiores em tamanho que os patches binários.</span><span class="sxs-lookup"><span data-stu-id="3ac66-108">Note that whole file patches are generally larger in size than binary patches.</span></span> <span data-ttu-id="3ac66-109">Você pode definir facilmente um patch para ser um patch de arquivo inteiro, criando a propriedade IncludeWholeFilesOnly com um valor de 1 (um) no arquivo PCP (Propriedades de criação de patch).</span><span class="sxs-lookup"><span data-stu-id="3ac66-109">You can easily set a patch to be a whole file patch by authoring the IncludeWholeFilesOnly property with a value of 1 (one) in the Patch Creation Properties (PCP) file.</span></span>
-   <span data-ttu-id="3ac66-110">Certifique-se de que nenhuma das suas ações personalizadas acesse o local de origem original.</span><span class="sxs-lookup"><span data-stu-id="3ac66-110">Ensure that none of your custom actions access the original source location.</span></span>
-   <span data-ttu-id="3ac66-111">Certifique-se de que a ação resolver seja condicional para que seja executada apenas quando necessário, ou, como alternativa, não esteja presente.</span><span class="sxs-lookup"><span data-stu-id="3ac66-111">Ensure that the ResolveSource action is conditionalized so that it only runs when needed, or alternatively is not present at all.</span></span>
-   <span data-ttu-id="3ac66-112">Preencha a [tabela MsiFileHash](msifilehash-table.md) para todos os arquivos com versão não versionada.</span><span class="sxs-lookup"><span data-stu-id="3ac66-112">Populate the [MsiFileHash Table](msifilehash-table.md) for all unversioned files.</span></span> <span data-ttu-id="3ac66-113">A ferramenta SDK do Windows Installer, Msifiler.exe, pode facilmente fazer isso para você.</span><span class="sxs-lookup"><span data-stu-id="3ac66-113">The Windows Installer SDK tool, Msifiler.exe, can easily do this for you.</span></span>
-   <span data-ttu-id="3ac66-114">Verifique se todos os arquivos têm a versão e as informações de idioma corretas.</span><span class="sxs-lookup"><span data-stu-id="3ac66-114">Ensure that all files have the correct version and language information.</span></span> <span data-ttu-id="3ac66-115">A ferramenta SDK do Windows Installer, Msifiler.exe, pode facilmente fazer isso para você.</span><span class="sxs-lookup"><span data-stu-id="3ac66-115">The Windows Installer SDK tool, Msifiler.exe, can easily do this for you.</span></span>

## <a name="source-requirements-when-patching"></a><span data-ttu-id="3ac66-116">Requisitos de origem ao aplicar patches</span><span class="sxs-lookup"><span data-stu-id="3ac66-116">Source Requirements When Patching</span></span>

<span data-ttu-id="3ac66-117">O acesso às fontes de instalação originais pode ser necessário para aplicar o patch nos seguintes casos:</span><span class="sxs-lookup"><span data-stu-id="3ac66-117">Access to the original installation sources may be required to apply the patch in the following cases:</span></span>

-   <span data-ttu-id="3ac66-118">O patch se aplica a um recurso que é executado no momento da origem.</span><span class="sxs-lookup"><span data-stu-id="3ac66-118">The patch applies to a feature that is currently run from source.</span></span> <span data-ttu-id="3ac66-119">Nesse caso, o recurso é transferido do estado de execução da origem para o estado local.</span><span class="sxs-lookup"><span data-stu-id="3ac66-119">In this case, the feature is transitioned from the run-from-source state to the local state.</span></span>
-   <span data-ttu-id="3ac66-120">O patch se aplica a um componente que tem um arquivo ausente ou corrompido.</span><span class="sxs-lookup"><span data-stu-id="3ac66-120">The patch applies to a component that has a missing or corrupted file.</span></span>
-   <span data-ttu-id="3ac66-121">O patch se aplica a um arquivo em um componente que também contém arquivos sem versão sem entradas MsiFileHash.</span><span class="sxs-lookup"><span data-stu-id="3ac66-121">The patch applies to a file in a component that also contains unversioned files with no MsiFileHash entries.</span></span> <span data-ttu-id="3ac66-122">Uma [tabela MsiFileHash](msifilehash-table.md) populada é necessária para impedir a recópia desnecessária de arquivos não versionáveis do local de origem.</span><span class="sxs-lookup"><span data-stu-id="3ac66-122">A populated [MsiFileHash Table](msifilehash-table.md) is required to prevent unnecessary recopying of unversioned files from the source location.</span></span>
-   <span data-ttu-id="3ac66-123">O patch foi aplicado com uma reinstalaçãomode de amus ou emus.</span><span class="sxs-lookup"><span data-stu-id="3ac66-123">The patch was applied with a REINSTALLMODE of amus or emus.</span></span> <span data-ttu-id="3ac66-124">Essa opção é perigosa, pois executa operações de cópia de arquivo independentemente da versão do arquivo.</span><span class="sxs-lookup"><span data-stu-id="3ac66-124">This option is dangerous in that it performs file copy operations regardless of file version.</span></span> <span data-ttu-id="3ac66-125">Isso pode levar a reving de arquivos e quase sempre requer a origem.</span><span class="sxs-lookup"><span data-stu-id="3ac66-125">This can lead to down-reving of files and almost always requires the source.</span></span> <span data-ttu-id="3ac66-126">O valor recomendado de reinstalaçãomode é omus.</span><span class="sxs-lookup"><span data-stu-id="3ac66-126">The recommended REINSTALLMODE value is omus.</span></span>
-   <span data-ttu-id="3ac66-127">O pacote armazenado em cache para o produto está ausente.</span><span class="sxs-lookup"><span data-stu-id="3ac66-127">The cached package for the product is missing.</span></span> <span data-ttu-id="3ac66-128">O pacote armazenado em cache é necessário para a aplicação de um patch.</span><span class="sxs-lookup"><span data-stu-id="3ac66-128">The cached package is needed for application of a patch.</span></span> <span data-ttu-id="3ac66-129">O pacote armazenado em cache é armazenado na pasta% windir% \\ Installer.</span><span class="sxs-lookup"><span data-stu-id="3ac66-129">The cached package is stored in the %windir%\\Installer folder.</span></span>
-   <span data-ttu-id="3ac66-130">O pacote é criado para fazer uma chamada para a [ação resolver](resolvesource-action.md).</span><span class="sxs-lookup"><span data-stu-id="3ac66-130">The package is authored to make a call to the [ResolveSource Action](resolvesource-action.md).</span></span> <span data-ttu-id="3ac66-131">Essa ação deve, em geral, ser evitada ou condicionalmente apropriada, porque sua execução sempre resulta em um acesso à origem.</span><span class="sxs-lookup"><span data-stu-id="3ac66-131">This action should generally be avoided or conditionalized appropriately, because its execution always results in an access to the source.</span></span>
-   <span data-ttu-id="3ac66-132">O pacote tem uma ação personalizada que tenta acessar a fonte de alguma maneira.</span><span class="sxs-lookup"><span data-stu-id="3ac66-132">The package has a custom action that attempts to access the source in some manner.</span></span> <span data-ttu-id="3ac66-133">O exemplo mais comum é uma ação personalizada de tipo 23 de instalação simultânea.</span><span class="sxs-lookup"><span data-stu-id="3ac66-133">The most common example is a type 23 concurrent installation custom action.</span></span>
    > [!Note]  
    > <span data-ttu-id="3ac66-134">As instalações simultâneas não são recomendadas para a instalação de aplicativos destinados ao lançamento para o público.</span><span class="sxs-lookup"><span data-stu-id="3ac66-134">Concurrent installations are not recommended for the installation of applications intended for release to the public.</span></span> <span data-ttu-id="3ac66-135">Para obter informações sobre instalações simultâneas, consulte [instalações simultâneas](concurrent-installations.md).</span><span class="sxs-lookup"><span data-stu-id="3ac66-135">For information about concurrent installations please see [Concurrent Installations](concurrent-installations.md).</span></span>

     

-   <span data-ttu-id="3ac66-136">O pacote de patch consiste em patches binários que não se aplicam à versão atual do arquivo no computador.</span><span class="sxs-lookup"><span data-stu-id="3ac66-136">The patch package consists of binary patches that do not apply to the current version of the file on the computer.</span></span>

<span data-ttu-id="3ac66-137">Considere o exemplo a seguir em que Windows Installer requer acesso à fonte original ao aplicar um patch:</span><span class="sxs-lookup"><span data-stu-id="3ac66-137">Consider the following example where Windows Installer requires access to the original source when applying a patch:</span></span>

1.  <span data-ttu-id="3ac66-138">Instale a versão RTM do exemplo de produto.</span><span class="sxs-lookup"><span data-stu-id="3ac66-138">Install RTM version of the product Example.</span></span>
2.  <span data-ttu-id="3ac66-139">Aplique o patch Qfe1. msp ao computador.</span><span class="sxs-lookup"><span data-stu-id="3ac66-139">Apply patch Qfe1.msp to the computer.</span></span> <span data-ttu-id="3ac66-140">Esta versão de patches 1,0 do Example.dll para a versão 1,1.</span><span class="sxs-lookup"><span data-stu-id="3ac66-140">This patches version 1.0 of Example.dll to version 1.1.</span></span>
3.  <span data-ttu-id="3ac66-141">Um novo patch, Qfe2. msp, é fornecido, que atualiza Example.dll para a versão 1,2 e os obsoletos Qfe1. msp.</span><span class="sxs-lookup"><span data-stu-id="3ac66-141">A new patch, Qfe2.msp is provided, which updates Example.dll to version 1.2 and obsoletes Qfe1.msp.</span></span> <span data-ttu-id="3ac66-142">No entanto, o patch foi criado apenas para a versão de destino 1,0 do Example.dll porque ele foi gerado usando a versão RTM do produto.</span><span class="sxs-lookup"><span data-stu-id="3ac66-142">However, the patch was only created to target version 1.0 of Example.dll because it was generated using the RTM version of the product.</span></span> <span data-ttu-id="3ac66-143">A versão 1,2 do Example.dll inclui a correção contida na versão 1,1 do Example.dll, mas o arquivo. msp foi gerado entre as imagens RTM e QFE2.</span><span class="sxs-lookup"><span data-stu-id="3ac66-143">Example.dll version 1.2 includes the fix contained in Example.dll version 1.1, but the .msp file was generated between the RTM and QFE2 images.</span></span> <span data-ttu-id="3ac66-144">Assim, quando o Qfe2. msp é aplicado ao computador, Windows Installer precisa acessar a fonte original.</span><span class="sxs-lookup"><span data-stu-id="3ac66-144">So, when Qfe2.msp is applied to the computer, Windows Installer needs to access the original source.</span></span> <span data-ttu-id="3ac66-145">O patch binário do Example.dll não pode ser aplicado à versão 1,1; Ele só pode ser aplicado à versão 1,0.</span><span class="sxs-lookup"><span data-stu-id="3ac66-145">The binary patch for Example.dll cannot apply to version 1.1; it can only apply to version 1.0.</span></span> <span data-ttu-id="3ac66-146">Isso faz com que o instalador recopie a versão 1,0 de Example.dll do local de origem original para que o patch possa ser aplicado com êxito.</span><span class="sxs-lookup"><span data-stu-id="3ac66-146">This results in the Installer recopying version 1.0 of Example.dll from the original source location so that the patch can be applied successfully.</span></span>

## <a name="source-requirements-when-removing-a-patch"></a><span data-ttu-id="3ac66-147">Requisitos de origem ao remover um patch</span><span class="sxs-lookup"><span data-stu-id="3ac66-147">Source Requirements When Removing a Patch</span></span>

<span data-ttu-id="3ac66-148">O acesso às fontes de instalação originais pode ser necessário para remover um patch se o Windows Installer não armazenou informações de linha de base sobre o patch.</span><span class="sxs-lookup"><span data-stu-id="3ac66-148">Access to the original installation sources may be required to remove a patch if the Windows Installer has not stored baseline information about the patch.</span></span> <span data-ttu-id="3ac66-149">A partir do Windows Installer 3,0, o instalador salva seletivamente as informações de linha de base sobre os arquivos quando eles são atualizados.</span><span class="sxs-lookup"><span data-stu-id="3ac66-149">Beginning with Windows Installer 3.0, the installer selectively saves baseline information about files when they are updated.</span></span> <span data-ttu-id="3ac66-150">Para obter mais informações sobre o cache de linha de base, consulte [reduzindo o tamanho do patch](reducing-patch-size.md) .</span><span class="sxs-lookup"><span data-stu-id="3ac66-150">For more information about the baseline cache, see [Reducing Patch Size](reducing-patch-size.md) .</span></span>

 

 



