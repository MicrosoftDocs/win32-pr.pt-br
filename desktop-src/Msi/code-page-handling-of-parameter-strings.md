---
description: Você pode adicionar informações de localização a um banco de dados de instalação usando um editor de tabela de banco de dados, como o orca, fornecido com o SDK do Windows Installer ou chamando as funções de banco de dados de um aplicativo.
ms.assetid: cc1eb336-5dec-40cc-8aa5-564cd167855d
title: Manipulação de página de código de cadeias de caracteres de parâmetro
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22a52872472d5509e1abdf35aa12be5afb6a8d13
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104164740"
---
# <a name="code-page-handling-of-parameter-strings"></a><span data-ttu-id="62ed1-103">Manipulação de página de código de cadeias de caracteres de parâmetro</span><span class="sxs-lookup"><span data-stu-id="62ed1-103">Code Page Handling of Parameter Strings</span></span>

<span data-ttu-id="62ed1-104">Você pode adicionar informações de localização a um banco de dados de instalação usando um editor de tabela de banco de dados, como o orca, fornecido com o SDK do Windows Installer ou chamando as [funções de banco de dados](database-functions.md) de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="62ed1-104">You can add localization information to an installation database by using a database table editor such as Orca that is provided with the Windows Installer SDK, or by calling the [Database Functions](database-functions.md) from an application.</span></span> <span data-ttu-id="62ed1-105">Tenha cuidado para passar apenas parâmetros de cadeia de caracteres que usam a página de código do banco de dados que está sendo localizado.</span><span class="sxs-lookup"><span data-stu-id="62ed1-105">Be careful to only pass string parameters that use the code page of the database that is being localized.</span></span> <span data-ttu-id="62ed1-106">Se um parâmetro de cadeia de caracteres contiver caracteres que não podem ser representados pela página de código do banco de dados, o instalador retornará um erro ao chamar [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span><span class="sxs-lookup"><span data-stu-id="62ed1-106">If a string parameter contains characters that cannot be represented by the code page of the database, the Installer returns an error when calling [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span> <span data-ttu-id="62ed1-107">Para obter uma lista de páginas de código numérico, consulte [localizando as tabelas Error e ActionText](localizing-the-error-and-actiontext-tables.md).</span><span class="sxs-lookup"><span data-stu-id="62ed1-107">For a list of numeric code pages, see [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md).</span></span>

<span data-ttu-id="62ed1-108">Para obter mais informações, consulte [determinando a página de código de um banco de dados de instalação](determining-an-installation-database-s-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="62ed1-108">For more information, see [Determining an Installation Database's Code Page](determining-an-installation-database-s-code-page.md).</span></span>

## <a name="adding-localization-information-to-a-database"></a><span data-ttu-id="62ed1-109">Adicionando informações de localização a um banco de dados</span><span class="sxs-lookup"><span data-stu-id="62ed1-109">Adding Localization Information to a Database</span></span>

<span data-ttu-id="62ed1-110">Quando você adiciona informações de localização a um banco de dados, a página de código do banco de dados deve ser suportada pelo sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="62ed1-110">When you add localization information to a database, the code page of the database must be supported by the operating system.</span></span> <span data-ttu-id="62ed1-111">Não precisa ser a página de código atual do sistema.</span><span class="sxs-lookup"><span data-stu-id="62ed1-111">It does not have to be the current code page of the system.</span></span> <span data-ttu-id="62ed1-112">[**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) deve retornar **true** para a página de código do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="62ed1-112">[**IsValidCodePage**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) must return **TRUE** for the database code page.</span></span> <span data-ttu-id="62ed1-113">Como o sistema converte cadeias de caracteres ANSI em Unicode, haverá um erro se a página de código do usuário atual não for a mesma que a página de código do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="62ed1-113">Because the system converts ANSI strings to Unicode, there is an error if the current user code page is not the same as the database code page.</span></span>

<span data-ttu-id="62ed1-114">Chamar a versão ANSI da API de Windows Installer converte a cadeia de caracteres localizada em Unicode usando a página de código do sistema atual.</span><span class="sxs-lookup"><span data-stu-id="62ed1-114">Calling the ANSI version of the Windows Installer API converts the localized string to Unicode by using the current system code page.</span></span> <span data-ttu-id="62ed1-115">Quando o banco de dados é confirmado, a cadeia de caracteres Unicode é convertida em ANSI usando a página de código do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="62ed1-115">When the database is committed, the Unicode string is converted to ANSI using the code page of the database.</span></span> <span data-ttu-id="62ed1-116">Se a página de código do sistema atual for diferente da página de código da cadeia de caracteres localizada, o resultado poderá ser uma perda de dados e conversão de cadeia de caracteres incorreta.</span><span class="sxs-lookup"><span data-stu-id="62ed1-116">If the current system code page differs from the code page of the localized string, the result can be a loss of data and incorrect string conversion.</span></span>

<span data-ttu-id="62ed1-117">O procedimento a seguir mostra como armazenar os dados de localização.</span><span class="sxs-lookup"><span data-stu-id="62ed1-117">The following procedure shows you how to store the localization data.</span></span>

<span data-ttu-id="62ed1-118">**Para armazenar dados de localização**</span><span class="sxs-lookup"><span data-stu-id="62ed1-118">**To store localization data**</span></span>

1.  <span data-ttu-id="62ed1-119">Defina a página de código do banco de dados para a página de código da cadeia de caracteres localizada.</span><span class="sxs-lookup"><span data-stu-id="62ed1-119">Set the code page of the database to the code page of the localized string.</span></span>
2.  <span data-ttu-id="62ed1-120">Converta a cadeia de caracteres ANSI em Unicode usando a função [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) e especifique a página de código dos dados localizados.</span><span class="sxs-lookup"><span data-stu-id="62ed1-120">Convert the ANSI string to Unicode by using the [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) function, and specify the code page of the localized data.</span></span>
3.  <span data-ttu-id="62ed1-121">Chame a versão Unicode da API de Windows Installer usando a cadeia de caracteres Unicode para adicionar os dados localizados.</span><span class="sxs-lookup"><span data-stu-id="62ed1-121">Call the Unicode version of the Windows Installer API by using the Unicode string to add the localized data.</span></span>
4.  <span data-ttu-id="62ed1-122">Confirme as alterações de localização no banco de dados usando [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span><span class="sxs-lookup"><span data-stu-id="62ed1-122">Commit the localization changes to the database by using [**MsiDatabaseCommit**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).</span></span>

<span data-ttu-id="62ed1-123">Você também pode adicionar informações de localização a um banco de dados de instalação importando e exportando arquivos mortos de texto ASCII.</span><span class="sxs-lookup"><span data-stu-id="62ed1-123">You can also add localization information to an installation database by importing and exporting ASCII text archive files.</span></span> <span data-ttu-id="62ed1-124">Para obter mais informações, consulte [manipulação de página de código de tabelas importadas e](code-page-handling-of-imported-and-exported-tables.md)exportadas.</span><span class="sxs-lookup"><span data-stu-id="62ed1-124">For more information, see [Code Page Handling of Imported and Exported Tables](code-page-handling-of-imported-and-exported-tables.md).</span></span>

 

 
