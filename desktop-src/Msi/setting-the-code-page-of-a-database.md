---
description: Sempre defina a página de código de um banco de dados antes de adicionar qualquer informação de localização.
ms.assetid: 0d8aee30-989a-4093-8718-1bb90029c0fb
title: Configurando a página de código de um banco de dados
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 87ef04c2969d0933c4601bbca2f3897d86de43a1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103647526"
---
# <a name="setting-the-code-page-of-a-database"></a><span data-ttu-id="379bd-103">Configurando a página de código de um banco de dados</span><span class="sxs-lookup"><span data-stu-id="379bd-103">Setting the Code Page of a Database</span></span>

<span data-ttu-id="379bd-104">Sempre defina a página de código de um banco de dados antes de adicionar qualquer informação de localização.</span><span class="sxs-lookup"><span data-stu-id="379bd-104">Always set the code page of a database prior to adding any localization information.</span></span> <span data-ttu-id="379bd-105">Não é recomendável tentar definir a página de código depois de inserir dados no banco de dado, pois isso pode corromper os caracteres estendidos.</span><span class="sxs-lookup"><span data-stu-id="379bd-105">Attempting to set the code page after entering data into the database is not recommended because this could corrupt extended characters.</span></span> <span data-ttu-id="379bd-106">A localização pode ser bastante facilitada com o início de um banco de dados que é uma página de código neutra.</span><span class="sxs-lookup"><span data-stu-id="379bd-106">Localization can be greatly facilitated by starting with a database that is code page neutral.</span></span> <span data-ttu-id="379bd-107">Para obter detalhes, consulte [criando um banco de dados com uma página de código neutra](creating-a-database-with-a-neutral-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="379bd-107">For details, see [Creating a database with a neutral code page](creating-a-database-with-a-neutral-code-page.md).</span></span> <span data-ttu-id="379bd-108">Você pode determinar a página de código atual de um banco de dados conforme descrito em [determinando a página de código de um banco de dados de instalação](determining-an-installation-database-s-code-page.md).</span><span class="sxs-lookup"><span data-stu-id="379bd-108">You may determine the current code page of a database as described in [Determining an installation database's code page](determining-an-installation-database-s-code-page.md).</span></span> <span data-ttu-id="379bd-109">Consulte [localizando as tabelas Error e ActionText](localizing-the-error-and-actiontext-tables.md) para obter uma lista de páginas de código numérico.</span><span class="sxs-lookup"><span data-stu-id="379bd-109">See [Localizing the Error and ActionText Tables](localizing-the-error-and-actiontext-tables.md) for a list of numeric code pages.</span></span>

<span data-ttu-id="379bd-110">Você pode definir a página de código de um banco de dados em branco ou um banco de dados com uma página de código neutra, importando um arquivo morto de texto que tenha uma página de código não neutra com [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span><span class="sxs-lookup"><span data-stu-id="379bd-110">You may set the code page of a blank database, or a database with a neutral code page, by importing a text archive file having a non-neutral code page with [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta).</span></span> <span data-ttu-id="379bd-111">Isso define a página de código do banco de dados para a página de código do arquivo importado.</span><span class="sxs-lookup"><span data-stu-id="379bd-111">This sets the code page of the database to the imported file's code page.</span></span> <span data-ttu-id="379bd-112">Todos os arquivos mortos subsequentemente importados para o banco de dados devem ter a mesma página de código que o primeiro arquivo.</span><span class="sxs-lookup"><span data-stu-id="379bd-112">All archive files subsequently imported into the database must then have the same code page as the first file.</span></span> <span data-ttu-id="379bd-113">Se um arquivo morto de texto for exportado de um banco de dados, a página de código do arquivo morto será a mesma do banco de dados pai.</span><span class="sxs-lookup"><span data-stu-id="379bd-113">If a text archive file is exported from a database, the code page of the archive file is the same as the parent database.</span></span> <span data-ttu-id="379bd-114">Consulte [manipulação de página de código de tabelas importadas e](code-page-handling-of-imported-and-exported-tables.md)exportadas.</span><span class="sxs-lookup"><span data-stu-id="379bd-114">See [Code Page Handling of Imported and Exported Tables](code-page-handling-of-imported-and-exported-tables.md).</span></span>

<span data-ttu-id="379bd-115">A página de código de qualquer banco de dados pode ser definida como uma página de código numérico especificada usando [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta) para importar um arquivo morto de texto com o seguinte formato: duas linhas em branco; seguido por uma linha que contém a página de código numérico, um delimitador de tabulação e a cadeia de caracteres exata: \_ ForceCodepage.</span><span class="sxs-lookup"><span data-stu-id="379bd-115">The code page of any database may be set to a specified numeric code page by using [**MsiDatabaseImport**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta) to import a text archive file with the following format: Two blank lines; followed by a line containing the numeric code page, a tab delimiter, and the exact string: \_ForceCodepage.</span></span> <span data-ttu-id="379bd-116">Observe que, com o Windows 2000, isso traduz todas as cadeias de caracteres no banco de dados para a página de código do \_ ForceCodepage.</span><span class="sxs-lookup"><span data-stu-id="379bd-116">Note that with Windows 2000, this translates all of the strings in the database to the code page of \_ForceCodepage.</span></span> <span data-ttu-id="379bd-117">Isso pode ser destinado ao localizar um banco de dados existente e traduzir todas as cadeias de caracteres não neutras para a nova página de código.</span><span class="sxs-lookup"><span data-stu-id="379bd-117">This may be intended when localizing an existing database and translating all non-neutral strings to the new code page.</span></span> <span data-ttu-id="379bd-118">No entanto, isso causará um erro se o banco de dados contiver cadeias de caracteres não neutras que não devem ser traduzidas.</span><span class="sxs-lookup"><span data-stu-id="379bd-118">However, this causes an error if the database contains non-neutral strings that are not to be translated.</span></span>

<span data-ttu-id="379bd-119">O utilitário WiLangId.vbs fornece um exemplo de como definir a página de código de um pacote usando o [**método de importação**](database-import.md).</span><span class="sxs-lookup"><span data-stu-id="379bd-119">The utility WiLangId.vbs provides an example of how to set the code page of a package using the [**Import method**](database-import.md).</span></span> <span data-ttu-id="379bd-120">Uma cópia de WiLangId.vbs é fornecida no SDK do Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="379bd-120">A copy of WiLangId.vbs is provided in the Windows Installer SDK.</span></span> <span data-ttu-id="379bd-121">Você pode usar esse utilitário para determinar as versões de idioma com suporte do banco de dados (pacote), o idioma usado pelo instalador para qualquer cadeia de caracteres na interface do usuário que não é criada no banco de dados (produto) ou a página de código ANSI única para o pool de cadeias de caracteres (CodePage).</span><span class="sxs-lookup"><span data-stu-id="379bd-121">You can use this utility to determine the language versions that are supported by the database (Package), the language the installer uses for any strings in the user interface that are not authored into the database (Product), or the single ANSI code page for the string pool (Codepage).</span></span> <span data-ttu-id="379bd-122">Para obter informações sobre como usar WiLangId.vbs consulte a página de ajuda: [gerenciar idioma e página de código](manage-language-and-codepage.md).</span><span class="sxs-lookup"><span data-stu-id="379bd-122">For information on using WiLangId.vbs see the help page: [Manage Language and Codepage](manage-language-and-codepage.md).</span></span>

<span data-ttu-id="379bd-123">Para determinar os valores do produto, pacote e página de código, execute WiLangId.vbs da seguinte maneira.</span><span class="sxs-lookup"><span data-stu-id="379bd-123">To determine the values of Product, Package, and Codepage, run WiLangId.vbs as follows.</span></span>

<span data-ttu-id="379bd-124">**cscript wilangid.vbs** *\[ caminho para o \] banco de dados*</span><span class="sxs-lookup"><span data-stu-id="379bd-124">**cscript wilangid.vbs** *\[path to database\]*</span></span>

<span data-ttu-id="379bd-125">Para definir a página de código do pacote, execute a seguinte linha de comando.</span><span class="sxs-lookup"><span data-stu-id="379bd-125">To set the Codepage of the package run the following command line.</span></span>

<span data-ttu-id="379bd-126">**cscript wilangid.vbs** caminho para o *\[ valor \]* **CodePage** do *\[ banco de dados \]*</span><span class="sxs-lookup"><span data-stu-id="379bd-126">**cscript wilangid.vbs** *\[path to database\]* **Codepage** *\[value\]*</span></span>

<span data-ttu-id="379bd-127">Por exemplo, para definir a página de código de test.msi como o valor numérico de páginas de códigos ANSI 1252, execute a linha de comando a seguir.</span><span class="sxs-lookup"><span data-stu-id="379bd-127">For example, to set the Codepage of test.msi to the numeric ANSI code page value 1252, run the following command line.</span></span>

<span data-ttu-id="379bd-128">**cscript wilangid.vbs c: \\ temp \\test.msi página de código 1252**</span><span class="sxs-lookup"><span data-stu-id="379bd-128">**cscript wilangid.vbs c:\\temp\\test.msi Codepage 1252**</span></span>

 

 



