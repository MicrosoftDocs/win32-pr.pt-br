---
description: Windows Installer adere a Proteção de Recursos do Windows (WRP) ao instalar arquivos do sistema, pastas e informações de registro essenciais no Windows Server 2008 e posterior e no Windows Vista e posterior.
ms.assetid: 38865ee1-22ef-430b-99ce-1c6983c3b51f
title: Usando Windows Installer e Proteção de Recursos do Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 72808184ff11b29bfeb02dda576e9393e34189fd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103921959"
---
# <a name="using-windows-installer-and-windows-resource-protection"></a><span data-ttu-id="70adb-103">Usando Windows Installer e Proteção de Recursos do Windows</span><span class="sxs-lookup"><span data-stu-id="70adb-103">Using Windows Installer and Windows Resource Protection</span></span>

<span data-ttu-id="70adb-104">Windows Installer adere a Proteção de Recursos do Windows (WRP) ao instalar arquivos do sistema, pastas e informações de registro essenciais no Windows Server 2008 e posterior e no Windows Vista e posterior.</span><span class="sxs-lookup"><span data-stu-id="70adb-104">Windows Installer adheres to Windows Resource Protection (WRP) when installing essential system files, folders, and registry information in Windows Server 2008 and later and Windows Vista and later.</span></span>

<span data-ttu-id="70adb-105">A WRP no Windows Server 2008 e no Windows Vista substitui a WFP (proteção de arquivo do Windows) no Windows Server 2003, no Windows XP e no Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="70adb-105">WRP in Windows Server 2008 and Windows Vista replaces Windows File Protection (WFP) in Windows Server 2003, Windows XP, and Windows 2000.</span></span> <span data-ttu-id="70adb-106">Windows Installer os desenvolvedores devem observar as seguintes alterações em como o instalador manipula recursos protegidos no Windows Server 2008 e posterior e no Windows Vista e posterior:</span><span class="sxs-lookup"><span data-stu-id="70adb-106">Windows Installer developers should note the following changes in how the installer handles protected resources in Windows Server 2008 and later and Windows Vista and later:</span></span>

-   <span data-ttu-id="70adb-107">Quando executado no Windows Server 2008 e posterior ou no Windows Vista e posterior, o Windows Installer ignora a instalação de qualquer arquivo protegido por WRP, o instalador entra em um aviso no arquivo de log e continua com o restante da instalação sem um erro.</span><span class="sxs-lookup"><span data-stu-id="70adb-107">When running on Windows Server 2008 and later or Windows Vista and later, the Windows Installer skips the installation of any file that is protected by WRP, the installer enters a warning in the log file, and continues with the remainder of the installation without an error.</span></span> <span data-ttu-id="70adb-108">No Windows Server 2003, Windows XP e Windows 2000, quando o Windows Installer encontrou um arquivo protegido por WFP, o instalador solicitaria que a WFP instalasse o arquivo.</span><span class="sxs-lookup"><span data-stu-id="70adb-108">In Windows Server 2003, Windows XP, and Windows 2000, when the Windows Installer encountered a WFP-protected file, the installer would request that WFP install the file.</span></span>
-   <span data-ttu-id="70adb-109">A WRP no Windows Server 2008 e posterior ou no Windows Vista e posterior pode proteger as chaves do registro além dos arquivos.</span><span class="sxs-lookup"><span data-stu-id="70adb-109">WRP on Windows Server 2008 and later or Windows Vista and later can protect registry keys in addition to files.</span></span> <span data-ttu-id="70adb-110">Se o Windows Installer encontrar uma chave de registro protegida por WRP, o instalador ignorará a instalação dessa chave do registro, o instalador inserirá um aviso no arquivo de log e continuará com o restante da instalação sem um erro.</span><span class="sxs-lookup"><span data-stu-id="70adb-110">If the Windows Installer encounters a WRP-protected registry key, the installer skips the installation of that registry key, the installer enters a warning in the log file, and continues with the remainder of the installation without an error.</span></span>
-   <span data-ttu-id="70adb-111">Observe que, se um componente de Windows Installer contiver um arquivo ou chave do Registro protegido por WRP, esse recurso deverá ser usado como o caminho principal para o componente.</span><span class="sxs-lookup"><span data-stu-id="70adb-111">Note that if a Windows Installer component contains a file or registry key that is protected by WRP, this resource must be used as the KeyPath for the component.</span></span> <span data-ttu-id="70adb-112">Nesse caso, Windows Installer não instala, atualiza ou remove o componente.</span><span class="sxs-lookup"><span data-stu-id="70adb-112">In this case, Windows Installer does not install, update, or remove the component.</span></span> <span data-ttu-id="70adb-113">Você não deve incluir nenhum recurso protegido em um pacote de instalação.</span><span class="sxs-lookup"><span data-stu-id="70adb-113">You should not include any protected resources in an installation package.</span></span> <span data-ttu-id="70adb-114">Em vez disso, você deve usar os [mecanismos de substituição de recursos com suporte](../wfp/supported-file-replacement-mechanisms.md) para [proteção de recursos do Windows](../wfp/windows-resource-protection-portal.md).</span><span class="sxs-lookup"><span data-stu-id="70adb-114">Instead, you should use the [supported resource replacement mechanisms](../wfp/supported-file-replacement-mechanisms.md) for [Windows Resource Protection](../wfp/windows-resource-protection-portal.md).</span></span>

<span data-ttu-id="70adb-115">Para obter mais informações sobre a WRP, consulte [proteção de recursos do Windows](../wfp/windows-resource-protection-portal.md) e informações fornecidas no [Microsoft TechNet](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc709691(v=ws.10)).</span><span class="sxs-lookup"><span data-stu-id="70adb-115">For more information about WRP, see [Windows Resource Protection](../wfp/windows-resource-protection-portal.md) and information that is provided on [Microsoft Technet](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc709691(v=ws.10)).</span></span>

## <a name="wfp-for-windows-server-2003-and-windows-xp2000"></a><span data-ttu-id="70adb-116">WFP para Windows Server 2003 e Windows XP/2000</span><span class="sxs-lookup"><span data-stu-id="70adb-116">WFP for Windows Server 2003 and Windows XP/2000</span></span>

<span data-ttu-id="70adb-117">Windows Installer obedece à WFP (proteção de arquivo do Windows) ao instalar arquivos de sistema essenciais no Windows Server 2003, Windows XP e Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="70adb-117">Windows Installer adheres to Windows File Protection (WFP) when installing essential system files on Windows Server 2003, Windows XP and Windows 2000.</span></span> <span data-ttu-id="70adb-118">Se um arquivo do sistema protegido for modificado por uma instalação autônoma de um aplicativo, a WFP restaurará o arquivo para a versão do arquivo verificado.</span><span class="sxs-lookup"><span data-stu-id="70adb-118">If a protected system file is modified by an unattended installation of an application, WFP restores the file to the verified file version.</span></span>

<span data-ttu-id="70adb-119">Windows Installer nunca tenta instalar ou substituir um arquivo protegido.</span><span class="sxs-lookup"><span data-stu-id="70adb-119">Windows Installer never attempts to install or replace a protected file.</span></span> <span data-ttu-id="70adb-120">Quando a ação [InstallFiles](installfiles-action.md) ou qualquer outra ação agendada antes de o InstallFiles tentar instalar um arquivo protegido no windows Server 2003, Windows XP ou Windows 2000, o instalador chama a WFP com uma solicitação para instalar ou substituir o arquivo protegido.</span><span class="sxs-lookup"><span data-stu-id="70adb-120">When the [InstallFiles](installfiles-action.md) action or any other action scheduled before InstallFiles attempts to install a file protected on Windows Server 2003, Windows XP or Windows 2000, the installer calls WFP with a request to install or replace the protected file.</span></span> <span data-ttu-id="70adb-121">O instalador solicita a instalação do arquivo do WFP imediatamente após a execução da ação InstallFiles.</span><span class="sxs-lookup"><span data-stu-id="70adb-121">The installer requests the file installation from WFP immediately after executing the InstallFiles action.</span></span> <span data-ttu-id="70adb-122">A WFP instala ou substitui o arquivo no sistema do usuário por uma versão armazenada em cache do arquivo protegido.</span><span class="sxs-lookup"><span data-stu-id="70adb-122">WFP installs or replaces the file on the user's system with a cached version of the protected file.</span></span> <span data-ttu-id="70adb-123">Observe que isso não garante que a versão do arquivo instalado do cache seja a versão exigida pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="70adb-123">Note that this does not guarantee that the version of the file installed from the cache is the version required by the application.</span></span> <span data-ttu-id="70adb-124">Depois que o WFP tiver instalado o arquivo, o instalador determinará se essa versão corresponde à versão no pacote.</span><span class="sxs-lookup"><span data-stu-id="70adb-124">After WFP has installed the file, the installer determines whether this version matches the version in the package.</span></span> <span data-ttu-id="70adb-125">Se a versão do arquivo no pacote for maior que a versão instalada, o instalador informará ao usuário que ele não pode atualizar o sistema e que uma atualização do sistema operacional pode ser necessária para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="70adb-125">If the file version in the package is greater than the installed version, the installer informs the user that it cannot update the system and that an update of the operating system may be required for the application.</span></span>

<span data-ttu-id="70adb-126">Se qualquer ação sequenciada após o [InstallFiles](installfiles-action.md) tentar instalar ou substituir um arquivo protegido ainda não instalado no sistema, o instalador não poderá chamar a WFP para instalar o arquivo.</span><span class="sxs-lookup"><span data-stu-id="70adb-126">If any action sequenced after [InstallFiles](installfiles-action.md) attempts to install or replace a protected file not already installed on the system, the installer cannot call WFP to install the file.</span></span> <span data-ttu-id="70adb-127">Nesse caso, o instalador informa ao usuário que ele não pode atualizar o sistema e que uma atualização do sistema operacional pode ser necessária para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="70adb-127">In this case, the installer informs the user that it cannot update the system and that an update of the operating system may be required for the application.</span></span>

<span data-ttu-id="70adb-128">O instalador também verifica a WFP ao remover arquivos e nunca tenta remover arquivos protegidos do sistema.</span><span class="sxs-lookup"><span data-stu-id="70adb-128">The installer also checks with WFP when removing files and never attempts to remove protected system files.</span></span>

## <a name="component-key-files-protected-by-wfp"></a><span data-ttu-id="70adb-129">Arquivos de chave de componente protegidos por WFP</span><span class="sxs-lookup"><span data-stu-id="70adb-129">Component Key Files Protected by WFP</span></span>

<span data-ttu-id="70adb-130">Observe que, se um componente de Windows Installer contiver um arquivo WFP, esse arquivo deverá ser especificado como o caminho de chave para o componente.</span><span class="sxs-lookup"><span data-stu-id="70adb-130">Note that if a Windows Installer component contains a WFP file, this file must be specified as the key path for the component.</span></span>

<span data-ttu-id="70adb-131">Quando o instalador tenta instalar um arquivo de chave do componente no Windows Server 2003, Windows XP ou Windows 2000, ele chama a WFP primeiro para determinar se o arquivo de chave está protegido.</span><span class="sxs-lookup"><span data-stu-id="70adb-131">When the installer attempts to install a component's key file on Windows Server 2003, Windows XP or Windows 2000, it first calls WFP to determine if the key file is protected.</span></span> <span data-ttu-id="70adb-132">Quando o arquivo de chave de um componente for protegido pela WFP e esse arquivo de chave já estiver instalado, o instalador atualizará o componente somente se a versão do arquivo de chave no pacote for maior do que a versão instalada.</span><span class="sxs-lookup"><span data-stu-id="70adb-132">When the key file of a component is protected by WFP, and that key file is already installed, the installer updates the component only if the version of the key file in the package is greater than the installed version.</span></span> <span data-ttu-id="70adb-133">Se o pacote de instalação especificar que um componente deve ser instalado e o arquivo de chave do componente não estiver instalado no momento, independentemente de o arquivo de chave estar protegido, o instalador instalará o componente.</span><span class="sxs-lookup"><span data-stu-id="70adb-133">If the installation package specifies that a component be installed, and the key file of the component is not currently installed, then regardless of whether the key file is protected the installer installs the component.</span></span> <span data-ttu-id="70adb-134">Depois que qualquer componente que tenha um arquivo de chave protegido pela WFP estiver instalado, ele será instalado permanentemente e o instalador nunca removerá ou substituirá o componente.</span><span class="sxs-lookup"><span data-stu-id="70adb-134">Once any component having a key file protected by WFP is installed, it is permanently installed, and the installer never removes or replaces the component.</span></span>

## <a name="installation-of-assemblies-by-wfp"></a><span data-ttu-id="70adb-135">Instalação de assemblies por WFP</span><span class="sxs-lookup"><span data-stu-id="70adb-135">Installation of Assemblies by WFP</span></span>

<span data-ttu-id="70adb-136">A WFP para assemblies difere da WFP para arquivos do sistema.</span><span class="sxs-lookup"><span data-stu-id="70adb-136">WFP for assemblies differs from WFP for system files.</span></span>

<span data-ttu-id="70adb-137">A WFP protege os arquivos do sistema Windows Server 2003, Windows XP e Windows 2000 detectando tentativas de substituição de arquivos protegidos do sistema.</span><span class="sxs-lookup"><span data-stu-id="70adb-137">WFP protects Windows Server 2003, Windows XP and Windows 2000 system files by detecting attempts to replace protected system files.</span></span> <span data-ttu-id="70adb-138">Essa proteção é disparada depois que a WFP recebe uma notificação de alteração de diretório para um arquivo em um diretório protegido.</span><span class="sxs-lookup"><span data-stu-id="70adb-138">This protection is triggered after WFP receives a directory change notification for a file in a protected directory.</span></span> <span data-ttu-id="70adb-139">Quando a WFP recebe essa notificação, ela determina qual arquivo foi alterado.</span><span class="sxs-lookup"><span data-stu-id="70adb-139">When WFP receives this notification, it determines which file has changed.</span></span> <span data-ttu-id="70adb-140">Se o arquivo estiver protegido, a WFP pesquisará a assinatura do arquivo em um arquivo de catálogo estático para determinar se o novo arquivo é a versão correta.</span><span class="sxs-lookup"><span data-stu-id="70adb-140">If the file is protected, WFP looks up the file signature in a static catalog file to determine if the new file is the correct version.</span></span> <span data-ttu-id="70adb-141">Se a versão do arquivo não estiver correta, o sistema substituirá o arquivo pela versão correta da mídia de cache ou de distribuição.</span><span class="sxs-lookup"><span data-stu-id="70adb-141">If the file version is not correct, the system replaces the file with the correct version from either the cache or distribution media.</span></span>

<span data-ttu-id="70adb-142">Por outro lado, a WFP de assemblies é dinâmica.</span><span class="sxs-lookup"><span data-stu-id="70adb-142">In contrast, WFP of assemblies is dynamic.</span></span> <span data-ttu-id="70adb-143">A WFP é estendida para arquivos à medida que são adicionados ao cache de assembly compartilhado lado a lado.</span><span class="sxs-lookup"><span data-stu-id="70adb-143">WFP is extended to files as they are added to the shared side-by-side assembly cache.</span></span> <span data-ttu-id="70adb-144">Se um assembly for corrompido, a WFP solicitará que o instalador substitua o arquivo.</span><span class="sxs-lookup"><span data-stu-id="70adb-144">If an assembly becomes corrupted, WFP will request that the installer replace the file.</span></span> <span data-ttu-id="70adb-145">Windows Installer pode ou não ser capaz de substituir o arquivo dependendo se o pacote de origem está acessível.</span><span class="sxs-lookup"><span data-stu-id="70adb-145">Windows Installer may or may not be able to replace the file depending on whether the source package is accessible.</span></span> <span data-ttu-id="70adb-146">Se o pacote de origem estiver inacessível, a WFP criará uma caixa de diálogo informando que não é possível restaurar o arquivo.</span><span class="sxs-lookup"><span data-stu-id="70adb-146">If the source package is inaccessible, WFP will put up a dialog box stating that it is unable to restore the file.</span></span>

<span data-ttu-id="70adb-147">Observe que os assemblies compartilhados lado a lado não gerenciados, instalados em% windir% \\ winsxs, são protegidos pela WFP.</span><span class="sxs-lookup"><span data-stu-id="70adb-147">Note that unmanaged shared side-by-side assemblies, installed in %windir%\\winsxs, are protected by WFP.</span></span> <span data-ttu-id="70adb-148">Os assemblies privados não gerenciados, instalados no diretório do aplicativo, não são protegidos pela WFP.</span><span class="sxs-lookup"><span data-stu-id="70adb-148">Unmanaged private assemblies, installed in the application directory, are not protected by WFP.</span></span> <span data-ttu-id="70adb-149">Os assemblies globais gerenciados instalados no diretório do aplicativo ou no GAC do assembly% windir% \\ \\ não são protegidos pela WFP.</span><span class="sxs-lookup"><span data-stu-id="70adb-149">Managed global assemblies installed in the application directory or %windir%\\assembly\\gac are not protected by WFP.</span></span>

## <a name="related-topics"></a><span data-ttu-id="70adb-150">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="70adb-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="70adb-151">Proteção de Recursos do Windows</span><span class="sxs-lookup"><span data-stu-id="70adb-151">Windows Resource Protection</span></span>](../wfp/windows-resource-protection-portal.md)
</dt> </dl>

 

 
