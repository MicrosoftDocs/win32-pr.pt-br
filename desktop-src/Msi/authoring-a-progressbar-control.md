---
description: Windows Installer contém a funcionalidade para exibir um indicador de progresso em uma caixa de diálogo de exibição de ação.
ms.assetid: cfc2d974-4f2d-4f52-9835-eab1dc091c9b
title: Criando um controle ProgressBar
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b872ed2dd36fb8ed04ee48fd69e4680fce002a18
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103828059"
---
# <a name="authoring-a-progressbar-control"></a><span data-ttu-id="fa1b2-103">Criando um controle ProgressBar</span><span class="sxs-lookup"><span data-stu-id="fa1b2-103">Authoring a ProgressBar Control</span></span>

<span data-ttu-id="fa1b2-104">Windows Installer contém a funcionalidade para exibir um indicador de progresso em uma caixa de diálogo de exibição de ação.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-104">Windows Installer contains functionality to display a progress indicator in an action display dialog.</span></span> <span data-ttu-id="fa1b2-105">O [controle ProgressBar](progressbar-control.md) representa graficamente a instalação de componentes individuais e relata o tempo total decorrido relativo ao tempo restante ou o tempo total aproximado restante até que a instalação seja concluída.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-105">The [ProgressBar control](progressbar-control.md) graphically represents the installation of individual components and reports either the total time elapsed relative to time remaining or the approximate total time remaining until the installation is complete.</span></span>

<span data-ttu-id="fa1b2-106">Para determinar o tempo total previsto para a instalação, o instalador acompanhará o total de tiques de progresso antecipados por cada ação durante a geração do script de execução.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-106">To determine the total time anticipated for the installation, the installer tracks the total progress ticks anticipated by each action during generation of the execution script.</span></span> <span data-ttu-id="fa1b2-107">Quando a geração de script for concluída, o total de tiques de andamento será armazenado e a instalação começará.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-107">When script generation is complete, the progress tick total is stored and the installation begins.</span></span>

<span data-ttu-id="fa1b2-108">Mensagens de progresso detalhando o número decorrido de tiques de progresso são enviadas para o manipulador de mensagens ativas, pois cada ação no script é executada.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-108">Progress messages detailing the elapsed number of progress ticks are sent to the active message handler as each action in the script is executed.</span></span> <span data-ttu-id="fa1b2-109">Em cada mensagem de progresso, o instalador transmite um [ControlEvent, de regressão](setprogress-controlevent.md) para a caixa de diálogo ativa no momento.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-109">On each progress message, the installer broadcasts a [SetProgress ControlEvent](setprogress-controlevent.md) to the currently active dialog box.</span></span> <span data-ttu-id="fa1b2-110">A sequência de interface do usuário deve ser criada para criar a caixa de diálogo de exibição de ação durante a execução do script para receber as mensagens ControlEvent, do instalador.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-110">The UI sequence should be authored to create the action display dialog box during script execution to receive the SetProgress ControlEvent messages from the installer.</span></span>

<span data-ttu-id="fa1b2-111">Quando a caixa de diálogo Exibir ação recebe um ControlEvent, de regressão, ele verifica a [tabela EventMappings](eventmapping-table.md) para todos os controles que se inscreverem no ControlEvent,.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-111">When the action display dialog box receives a SetProgress ControlEvent, it checks the [EventMapping table](eventmapping-table.md) for any controls subscribing to the ControlEvent.</span></span> <span data-ttu-id="fa1b2-112">O controle ProgressBar na caixa de diálogo de exibição de ação é assinado com o atributo de controle de progresso especificado na coluna atributos.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-112">The ProgressBar control on the action display dialog box is subscribed to with the Progress control attribute specified in the Attributes column.</span></span> <span data-ttu-id="fa1b2-113">O atributo de controle Progress especifica que o controle ProgressBar receberá os valores "ticksSoFar" e "totalTicks" junto com o ControlEvent, de setProgress.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-113">The Progress Control attribute specifies that the ProgressBar control will be passed "ticksSoFar" and "totalTicks" values along with the SetProgress ControlEvent.</span></span> <span data-ttu-id="fa1b2-114">O controle de barra de progresso usa essas informações para avançar a barra gráfica da esquerda para a direita para uma instalação e da direita para a esquerda para uma operação de [reversão](rollback-installation.md) .</span><span class="sxs-lookup"><span data-stu-id="fa1b2-114">The progress bar control uses this information to advance the graphical bar from left to right for an installation and from right to left for a [rollback](rollback-installation.md) operation.</span></span>

<span data-ttu-id="fa1b2-115">Além disso, o instalador transmite um [ControlEvent, de permanência](timeremaining-controlevent.md) em cada mensagem de progresso.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-115">In addition, the installer broadcasts a [TimeRemaining ControlEvent](timeremaining-controlevent.md) on each progress message.</span></span> <span data-ttu-id="fa1b2-116">O tempo total restante para a instalação é determinado pela primeira vez que calcula a taxa de execução, que é o número total de tiques decorridos dividido pelo tempo total desde que a instalação começou.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-116">The total time remaining for the installation is determined by first calculating the execution rate, which is the total number of ticks elapsed divided by the total time since the installation began.</span></span> <span data-ttu-id="fa1b2-117">O total de tiques restantes dividido pela taxa de execução fornece o tempo aproximado restante.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-117">The total ticks remaining divided by the execution rate gives the approximate time remaining.</span></span>

<span data-ttu-id="fa1b2-118">Quando a caixa de diálogo Exibir ação recebe o ControlEvent, do timecontinueing, ele examina novamente a tabela EventMappings para todos os controles que forem assinados.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-118">When the action display dialog box receives the TimeRemaining ControlEvent, it again looks in the EventMapping table for any controls that are subscribed.</span></span> <span data-ttu-id="fa1b2-119">Para exibir o tempo restante, um controle de [texto](text-control.md) deve ser assinado para o timecontinueing ControlEvent, com o atributo de [controle timepersisting](timeremaining-control-attribute.md) especificado na coluna atributos.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-119">In order to display the time remaining, a [Text control](text-control.md) must be subscribed to the TimeRemaining ControlEvent with the [TimeRemaining control attribute](timeremaining-control-attribute.md) specified in the Attributes column.</span></span>

<span data-ttu-id="fa1b2-120">O controle de texto assinado consulta a [tabela UIText](uitext-table.md) para uma cadeia de caracteres de modelo com parâmetros chamada "timecontinueing".</span><span class="sxs-lookup"><span data-stu-id="fa1b2-120">The subscribed Text control queries the [UIText table](uitext-table.md) for a parameterized template string named "TimeRemaining".</span></span> <span data-ttu-id="fa1b2-121">Essa cadeia de caracteres tem dois parâmetros, \[ 1 \] para minutos e \[ 2 \] para segundos.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-121">This string has two parameters, \[1\] for minutes, and \[2\] for seconds.</span></span> <span data-ttu-id="fa1b2-122">O controle de texto converte cada valor em minutos e segundos, avalia a cadeia de caracteres do modelo que está permanecendo e atualiza o controle de texto com as novas informações.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-122">The Text control converts each value to minutes and seconds, evaluates the TimeRemaining template string, and updates the text control with the new information.</span></span>

<span data-ttu-id="fa1b2-123">Se o nível de exibição da interface do usuário for definido como básico ou inferior, o instalador exibirá uma caixa de diálogo padrão contendo uma barra de progresso e um campo de texto de permanência.</span><span class="sxs-lookup"><span data-stu-id="fa1b2-123">If the UI display level is set to basic or lower, the installer displays a default dialog box containing a progress bar and TimeRemaining text field.</span></span> <span data-ttu-id="fa1b2-124">Para obter mais informações, consulte [níveis de interface do usuário](user-interface-levels.md).</span><span class="sxs-lookup"><span data-stu-id="fa1b2-124">For more information, see [User Interface Levels](user-interface-levels.md).</span></span>

 

 



