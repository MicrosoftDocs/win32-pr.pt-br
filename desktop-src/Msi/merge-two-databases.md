---
description: O arquivo VBScript WiMerge.vbs é fornecido nos componentes SDK do Windows para os desenvolvedores de Windows Installer. Este script de exemplo mescla um banco de dados Windows Installer em outro banco de dados. Para obter mais informações, consulte mesclagens e transformações.
ms.assetid: 31867082-7c1d-4530-a066-236d8ee5f023
title: Mesclar dois bancos de dados
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0254cbe2bd0785b45d4ced3a16770023e617bc63
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105751435"
---
# <a name="merge-two-databases"></a><span data-ttu-id="4749d-105">Mesclar dois bancos de dados</span><span class="sxs-lookup"><span data-stu-id="4749d-105">Merge Two Databases</span></span>

<span data-ttu-id="4749d-106">O arquivo VBScript WiMerge.vbs é fornecido nos [componentes SDK do Windows para os desenvolvedores de Windows Installer](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="4749d-106">The VBScript file WiMerge.vbs is provided in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span> <span data-ttu-id="4749d-107">Este script de exemplo mescla um banco de dados Windows Installer em outro banco de dados.</span><span class="sxs-lookup"><span data-stu-id="4749d-107">This sample script merges one Windows Installer database into another database.</span></span> <span data-ttu-id="4749d-108">Para obter mais informações, consulte [mesclagens e transformações](merges-and-transforms.md).</span><span class="sxs-lookup"><span data-stu-id="4749d-108">For more information, see [Merges and Transforms](merges-and-transforms.md).</span></span>

<span data-ttu-id="4749d-109">A função [**MsiDatabaseMerge**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea) e o método [**Merge**](database-merge.md) do objeto [**Database**](database-object.md) não podem ser usados para mesclar um módulo incluído no pacote de instalação.</span><span class="sxs-lookup"><span data-stu-id="4749d-109">The [**MsiDatabaseMerge**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea) function and the [**Merge**](database-merge.md) method of the [**Database**](database-object.md) object cannot be used to merge a module included in the installation package.</span></span> <span data-ttu-id="4749d-110">Eles não devem ser usados para mesclar [módulos de mesclagem](merge-modules.md) em um pacote Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="4749d-110">They should not be used to merge [Merge Modules](merge-modules.md) into a Windows Installer package.</span></span> <span data-ttu-id="4749d-111">Para incluir um módulo de mesclagem em um pacote de instalação, os autores de pacotes de instalação devem seguir as diretrizes descritas no tópico [aplicando módulos de mesclagem](applying-merge-modules.md) .</span><span class="sxs-lookup"><span data-stu-id="4749d-111">To include a merge module in an installation package, authors of installation packages should follow the guidelines that are described in [Applying Merge Modules](applying-merge-modules.md) topic.</span></span>

<span data-ttu-id="4749d-112">O exemplo demonstra o uso do seguinte:</span><span class="sxs-lookup"><span data-stu-id="4749d-112">The sample demonstrates the use of the following:</span></span>

-   [<span data-ttu-id="4749d-113">**Método OpenDatabase (objeto instalador)**</span><span class="sxs-lookup"><span data-stu-id="4749d-113">**OpenDatabase method (Installer Object)**</span></span>](installer-opendatabase.md)
-   <span data-ttu-id="4749d-114">[**Método LastErrorRecord**](installer-lasterrorrecord.md) do [ **objeto do instalador**](installer-object.md)</span><span class="sxs-lookup"><span data-stu-id="4749d-114">[**LastErrorRecord method**](installer-lasterrorrecord.md) of the [**Installer object**](installer-object.md)</span></span>
-   [<span data-ttu-id="4749d-115">**Método OpenView**</span><span class="sxs-lookup"><span data-stu-id="4749d-115">**OpenView method**</span></span>](database-openview.md)
-   [<span data-ttu-id="4749d-116">**Método Merge**</span><span class="sxs-lookup"><span data-stu-id="4749d-116">**Merge method**</span></span>](database-merge.md)
-   <span data-ttu-id="4749d-117">[**Método Commit**](database-commit.md) do [ **objeto Database**](database-object.md)</span><span class="sxs-lookup"><span data-stu-id="4749d-117">[**Commit method**](database-commit.md) of the [**Database object**](database-object.md)</span></span>
-   [<span data-ttu-id="4749d-118">**Método Fetch**</span><span class="sxs-lookup"><span data-stu-id="4749d-118">**Fetch method**</span></span>](view-fetch.md)
-   [<span data-ttu-id="4749d-119">**Exibir objeto**</span><span class="sxs-lookup"><span data-stu-id="4749d-119">**View object**</span></span>](view-object.md)
-   <span data-ttu-id="4749d-120">[**Propriedade StringData**](record-stringdata.md) do [ **objeto Record**](record-object.md)</span><span class="sxs-lookup"><span data-stu-id="4749d-120">[**StringData property**](record-stringdata.md) of the [**Record object**](record-object.md)</span></span>

<span data-ttu-id="4749d-121">Você deve ter a versão CScript.exe ou WScript.exe do Windows Script Host para usar este exemplo.</span><span class="sxs-lookup"><span data-stu-id="4749d-121">You must have the CScript.exe or WScript.exe version of Windows Script Host to use this sample.</span></span> <span data-ttu-id="4749d-122">Para usar CScript.exe para executar este exemplo, digite uma linha de comando no prompt de comando usando a sintaxe a seguir.</span><span class="sxs-lookup"><span data-stu-id="4749d-122">To use CScript.exe to run this sample, type a command line at the command prompt using the following syntax.</span></span> <span data-ttu-id="4749d-123">A ajuda será exibida se o primeiro argumento for/?</span><span class="sxs-lookup"><span data-stu-id="4749d-123">Help is displayed if the first argument is /?</span></span> <span data-ttu-id="4749d-124">ou se poucos argumentos forem especificados.</span><span class="sxs-lookup"><span data-stu-id="4749d-124">or if too few arguments are specified.</span></span> <span data-ttu-id="4749d-125">Para redirecionar a saída para um arquivo, termine a linha de comando com VBS > \[ caminho para o arquivo \] .</span><span class="sxs-lookup"><span data-stu-id="4749d-125">To redirect the output to a file, end the command line with VBS > \[path to file\].</span></span> <span data-ttu-id="4749d-126">O exemplo retorna um valor de 0 para êxito, 1 se a ajuda for invocada e 2 se o script falhar.</span><span class="sxs-lookup"><span data-stu-id="4749d-126">The sample returns a value of 0 for success, 1 if help is invoked, and 2 if the script fails.</span></span>

<span data-ttu-id="4749d-127">**cscript WiMerge.vbs \[ caminho para o caminho do banco \] \[ de dados para o nome da tabela de banco de dados \] \[\]**</span><span class="sxs-lookup"><span data-stu-id="4749d-127">**cscript WiMerge.vbs \[path to database\]\[path to imported database\]\[table name\]**</span></span>

<span data-ttu-id="4749d-128">Especifique o caminho para o banco de dados de Windows Installer que está recebendo a mesclagem.</span><span class="sxs-lookup"><span data-stu-id="4749d-128">Specify the path to the Windows Installer database that is receiving the merge.</span></span> <span data-ttu-id="4749d-129">Especifique o caminho para o banco de dados que está sendo importado para o primeiro.</span><span class="sxs-lookup"><span data-stu-id="4749d-129">Specify the path to the database being imported into the first.</span></span> <span data-ttu-id="4749d-130">Você pode especificar um nome opcional para uma tabela para manter os erros de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="4749d-130">You may specify an optional name for a table to hold the merge errors.</span></span> <span data-ttu-id="4749d-131">Se nenhum nome de tabela for especificado, o instalador usará o nome \_ MergeErrors e descartará a tabela depois de exibir o conteúdo.</span><span class="sxs-lookup"><span data-stu-id="4749d-131">If no table name is specified, the installer uses the name \_MergeErrors and drops the table after displaying the contents.</span></span>

<span data-ttu-id="4749d-132">Para obter exemplos de script adicionais, consulte [Windows Installer exemplos de script](windows-installer-scripting-examples.md).</span><span class="sxs-lookup"><span data-stu-id="4749d-132">For additional scripting examples, see [Windows Installer Scripting Examples](windows-installer-scripting-examples.md).</span></span> <span data-ttu-id="4749d-133">Para utilitários de exemplo que não exigem o Windows Script Host, consulte [Windows Installer ferramentas de desenvolvimento](windows-installer-development-tools.md).</span><span class="sxs-lookup"><span data-stu-id="4749d-133">For sample utilities that do not require Windows Script Host, see [Windows Installer Development Tools](windows-installer-development-tools.md).</span></span>

 

 



