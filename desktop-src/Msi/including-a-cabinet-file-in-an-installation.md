---
description: Esta seção descreve como incluir arquivos de gabinete em instalações do. Para obter mais informações, consulte usando gabinetes e fontes compactadas.
ms.assetid: 17ea7f76-90b2-48fb-8187-64dc6d294443
title: Incluindo um arquivo de gabinete em uma instalação
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 098e660de3f7ec7097ab02613d75219ac0a0d624
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105752645"
---
# <a name="including-a-cabinet-file-in-an-installation"></a><span data-ttu-id="316c4-104">Incluindo um arquivo de gabinete em uma instalação</span><span class="sxs-lookup"><span data-stu-id="316c4-104">Including a Cabinet File in an Installation</span></span>

<span data-ttu-id="316c4-105">Esta seção descreve como incluir arquivos de gabinete em instalações do.</span><span class="sxs-lookup"><span data-stu-id="316c4-105">This section describes including cabinet files in installations.</span></span> <span data-ttu-id="316c4-106">Para obter mais informações, consulte [usando gabinetes e fontes compactadas](using-cabinets-and-compressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="316c4-106">For more information, see [Using Cabinets and Compressed Sources](using-cabinets-and-compressed-sources.md).</span></span>

<span data-ttu-id="316c4-107">**Para incluir um arquivo de gabinete em um pacote de instalação**</span><span class="sxs-lookup"><span data-stu-id="316c4-107">**To include a cabinet file in a installation package**</span></span>

1.  <span data-ttu-id="316c4-108">Use uma ferramenta de criação de gabinete para compactar os arquivos de origem em um arquivo de gabinete.</span><span class="sxs-lookup"><span data-stu-id="316c4-108">Use a cabinet creation tool to compress the source files into a cabinet file.</span></span> <span data-ttu-id="316c4-109">Consulte [arquivos de gabinete](cabinet-files.md).</span><span class="sxs-lookup"><span data-stu-id="316c4-109">See [Cabinet Files](cabinet-files.md).</span></span>
2.  <span data-ttu-id="316c4-110">O arquivo de gabinete deve estar localizado em um fluxo de dados dentro do arquivo. msi ou em um arquivo de gabinete separado localizado na raiz da árvore de origem especificada pela [tabela de diretórios](directory-table.md).</span><span class="sxs-lookup"><span data-stu-id="316c4-110">The cabinet file must either be located in a data stream inside the .msi file or in a separate cabinet file located at the root of the source tree specified by the [Directory Table](directory-table.md).</span></span>
3.  <span data-ttu-id="316c4-111">Determine se a origem deve ser um tipo compactado ou misto que tenha arquivos compactados e descompactados.</span><span class="sxs-lookup"><span data-stu-id="316c4-111">Determine whether the source is to be a compressed type or a mixed type that has both uncompressed and compressed files.</span></span> <span data-ttu-id="316c4-112">Consulte [fontes compactadas e descompactadas](compressed-and-uncompressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="316c4-112">See [Compressed and Uncompressed Sources](compressed-and-uncompressed-sources.md).</span></span> <span data-ttu-id="316c4-113">Dependendo do tipo de imagem de origem, defina os bits de sinalizador compactado ou descompactado da propriedade de [**Resumo contagem de palavras**](word-count-summary.md) .</span><span class="sxs-lookup"><span data-stu-id="316c4-113">Depending on the type of source image, set the compressed or uncompressed flag bits of the [**Word Count Summary**](word-count-summary.md) Property.</span></span>
4.  <span data-ttu-id="316c4-114">Adicione um registro à [tabela de arquivos](file-table.md) para cada um dos arquivos no gabinete.</span><span class="sxs-lookup"><span data-stu-id="316c4-114">Add a record to the [File table](file-table.md) for each of the files in the cabinet.</span></span> <span data-ttu-id="316c4-115">Insira uma chave de arquivo na coluna arquivo que corresponda exatamente à chave de arquivo do arquivo no gabinete.</span><span class="sxs-lookup"><span data-stu-id="316c4-115">Enter a file key in the File column that exactly matches the file key of the file in the cabinet.</span></span> <span data-ttu-id="316c4-116">As chaves de arquivo diferenciam maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="316c4-116">The file keys are case-sensitive.</span></span> <span data-ttu-id="316c4-117">A sequência de instalação de arquivo na tabela de arquivos e o gabinete também devem ser iguais.</span><span class="sxs-lookup"><span data-stu-id="316c4-117">The file installation sequence in the File table and the cabinet must also be the same.</span></span> <span data-ttu-id="316c4-118">A sequência de arquivos é especificada pelo número de sequência na coluna sequência.</span><span class="sxs-lookup"><span data-stu-id="316c4-118">The file sequence is specified by the sequence number in the Sequence column.</span></span> <span data-ttu-id="316c4-119">Para chegar ao número de sequência do primeiro arquivo no gabinete, faça o seguinte.</span><span class="sxs-lookup"><span data-stu-id="316c4-119">To arrive at the sequence number for the first file in the cabinet, do the following.</span></span> <span data-ttu-id="316c4-120">Localize o registro existente na [tabela de mídia](media-table.md) que tem o maior valor na coluna DiskId.</span><span class="sxs-lookup"><span data-stu-id="316c4-120">Find the existing record in the [Media table](media-table.md) having the greatest value in the DiskID column.</span></span> <span data-ttu-id="316c4-121">O campo LastSequence desse registro fornece o último número de sequência de arquivo usado na mídia.</span><span class="sxs-lookup"><span data-stu-id="316c4-121">The LastSequence field of this record gives the last file sequence number used on the media.</span></span> <span data-ttu-id="316c4-122">Na tabela de arquivos, atribua o primeiro arquivo do novo gabinete um número de sequência maior que este.</span><span class="sxs-lookup"><span data-stu-id="316c4-122">In the File table, assign the first file of the new cabinet a sequence number that is greater than this.</span></span> <span data-ttu-id="316c4-123">Atribua números de sequência a todos os arquivos restantes na mesma ordem que no arquivo de gabinete.</span><span class="sxs-lookup"><span data-stu-id="316c4-123">Assign sequence numbers to all of the remaining files in the same order as in the cabinet file.</span></span> <span data-ttu-id="316c4-124">Para obter uma descrição dos campos de registro restantes, consulte [tabela de arquivos](file-table.md).</span><span class="sxs-lookup"><span data-stu-id="316c4-124">For a description of the remaining record fields, see [File table](file-table.md).</span></span>
5.  <span data-ttu-id="316c4-125">Adicione um registro à [tabela de mídia](media-table.md) para o gabinete.</span><span class="sxs-lookup"><span data-stu-id="316c4-125">Add a record to the [Media table](media-table.md) for the cabinet.</span></span> <span data-ttu-id="316c4-126">Especifique um valor no campo DiskId desse novo registro que seja maior do que o maior valor de DiskId já existente na tabela.</span><span class="sxs-lookup"><span data-stu-id="316c4-126">Specify a value in the DiskID field of this new record that is greater than the largest DiskID value already existing in the table.</span></span> <span data-ttu-id="316c4-127">Coloque o nome do gabinete no campo de gabinete.</span><span class="sxs-lookup"><span data-stu-id="316c4-127">Put the name of the cabinet into the Cabinet field.</span></span> <span data-ttu-id="316c4-128">Esse nome deve estar na forma de um tipo de dados de [gabinete](cabinet.md) .</span><span class="sxs-lookup"><span data-stu-id="316c4-128">This name must be in the form of a [Cabinet](cabinet.md) data type.</span></span> <span data-ttu-id="316c4-129">Prefixe o nome com um sinal numérico " \# " se o gabinete for um fluxo de dados armazenado no arquivo. msi.</span><span class="sxs-lookup"><span data-stu-id="316c4-129">Prefix the name with a number sign "\#" if the cabinet is a data stream stored in the .msi file.</span></span> <span data-ttu-id="316c4-130">Observe que, se o gabinete for um fluxo de dados, o nome do gabinete diferenciará maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="316c4-130">Note that if the cabinet is a data stream, the name of the cabinet is case-sensitive.</span></span> <span data-ttu-id="316c4-131">Se o gabinete for um arquivo separado, o nome do arquivo não diferenciará maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="316c4-131">If the cabinet is a separate file, the name of the file is not case-sensitive.</span></span>
6.  <span data-ttu-id="316c4-132">Determine o maior número de sequência de arquivo no novo gabinete, verificando a coluna de sequência da tabela de arquivos atualizada.</span><span class="sxs-lookup"><span data-stu-id="316c4-132">Determine the greatest file sequence number in the new cabinet by checking the Sequence column of the updated File table.</span></span> <span data-ttu-id="316c4-133">Insira um valor que seja maior que este no campo LastSequence do novo registro da tabela de mídia.</span><span class="sxs-lookup"><span data-stu-id="316c4-133">Enter a value that is greater than this into the LastSequence field of the new record of the Media table.</span></span> <span data-ttu-id="316c4-134">Para obter uma descrição dos campos de registro restantes, consulte [tabela de mídia](media-table.md).</span><span class="sxs-lookup"><span data-stu-id="316c4-134">For a description of the remaining record fields, see [Media table](media-table.md).</span></span>
7.  <span data-ttu-id="316c4-135">Você pode armazenar o arquivo de gabinete no pacote de instalação usando uma ferramenta como Msidb.exe ou usando as [funções de banco de dados](database-functions.md)do instalador.</span><span class="sxs-lookup"><span data-stu-id="316c4-135">You can store the cabinet file in the installation package either by using a tool such as Msidb.exe or by using the installer's [Database Functions](database-functions.md).</span></span> <span data-ttu-id="316c4-136">As quatro etapas a seguir explicam como adicionar o gabinete de um programa usando as funções de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="316c4-136">The following four steps explain how to add the cabinet from a program by using the database functions.</span></span>
8.  <span data-ttu-id="316c4-137">Para adicionar o gabinete ao pacote de instalação de um programa, abra uma exibição na [ \_ tabela fluxos](-streams-table.md) do banco de dados usando [**MsiDatabaseOpenView**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa).</span><span class="sxs-lookup"><span data-stu-id="316c4-137">To add the cabinet to the installation package from a program open a view on the [\_Streams table](-streams-table.md) of the database using [**MsiDatabaseOpenView**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseopenviewa).</span></span>
9.  <span data-ttu-id="316c4-138">Use [**MsiRecordSetString**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa) para definir a coluna de nome da \_ tabela de fluxos como o nome que aparece na coluna de gabinete da [tabela de mídia](media-table.md).</span><span class="sxs-lookup"><span data-stu-id="316c4-138">Use [**MsiRecordSetString**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstringa) to set the Name column of the \_Streams table to the name appearing in the Cabinet column of the [Media table](media-table.md).</span></span> <span data-ttu-id="316c4-139">Omita o sinal numérico: \# .</span><span class="sxs-lookup"><span data-stu-id="316c4-139">Omit the number sign: \#.</span></span>
10. <span data-ttu-id="316c4-140">Use [**MsiRecordSetStream**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama) para definir a coluna de dados da \_ tabela de fluxos para os dados do gabinete.</span><span class="sxs-lookup"><span data-stu-id="316c4-140">Use [**MsiRecordSetStream**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama) to set the Data column of the \_Streams table to the cabinet's data.</span></span>
11. <span data-ttu-id="316c4-141">Use [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) para atualizar o registro na \_ tabela de fluxos.</span><span class="sxs-lookup"><span data-stu-id="316c4-141">Use [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) to update the record in the \_Streams table.</span></span>
12. <span data-ttu-id="316c4-142">Para usar Msidb.exe para adicionar o arquivo de gabinete Mycab.cab ao pacote de instalação denominado Mydatabase.msi, use a seguinte linha de comando: Msidb.exe-d mydatabase.msi-a mycab.cab.</span><span class="sxs-lookup"><span data-stu-id="316c4-142">To use Msidb.exe to add the cabinet file Mycab.cab to the installation package named Mydatabase.msi, use the following command line: Msidb.exe -d mydatabase.msi -a mycab.cab.</span></span> <span data-ttu-id="316c4-143">Nesse caso, a coluna de gabinete da tabela de mídia deve conter a cadeia de caracteres: \#mycab.cab.</span><span class="sxs-lookup"><span data-stu-id="316c4-143">In this case, the Cabinet column of the Media table should contain the string: \#mycab.cab.</span></span>

 

 



