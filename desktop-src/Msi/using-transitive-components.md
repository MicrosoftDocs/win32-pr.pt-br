---
description: Um uso típico para componentes transitivos é preparar um produto para reinstalar o durante uma atualização do sistema.
ms.assetid: 73677573-945f-4646-89d8-93e28f7856fe
title: Usando componentes transitivos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35982aafd486a62ce8560e507b8b6caf88e32591
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/05/2021
ms.locfileid: "103930252"
---
# <a name="using-transitive-components"></a><span data-ttu-id="8f9df-103">Usando componentes transitivos</span><span class="sxs-lookup"><span data-stu-id="8f9df-103">Using Transitive Components</span></span>

<span data-ttu-id="8f9df-104">Um uso típico para componentes transitivos é preparar um produto para reinstalar o durante uma atualização do sistema.</span><span class="sxs-lookup"><span data-stu-id="8f9df-104">A typical use for transitive components is to prepare a product to reinstall during a system upgrade.</span></span> <span data-ttu-id="8f9df-105">O autor do pacote de instalação especifica os componentes que precisam ser trocados durante uma atualização do sistema como tendo o atributo transitiva.</span><span class="sxs-lookup"><span data-stu-id="8f9df-105">The author of the installation package specifies those components that need to be swapped out during a system upgrade as having the transitive attribute.</span></span> <span data-ttu-id="8f9df-106">Quando o usuário atualizar mais tarde o sistema, o produto deverá ser reinstalado.</span><span class="sxs-lookup"><span data-stu-id="8f9df-106">When the user later upgrades the system, the product must be reinstalled.</span></span> <span data-ttu-id="8f9df-107">Após essa reinstalação, o instalador removerá os componentes anteriores e instalará os componentes mais recentes, sem precisar instalar o produto inteiro.</span><span class="sxs-lookup"><span data-stu-id="8f9df-107">Upon this reinstall, the installer removes the earlier components and installs the later components, without having to install the entire product.</span></span>

<span data-ttu-id="8f9df-108">**Para incluir dois componentes transitivos no pacote de instalação**</span><span class="sxs-lookup"><span data-stu-id="8f9df-108">**To include two transitive components in the installation package**</span></span>

1.  <span data-ttu-id="8f9df-109">Inclua os componentes transitivos no pacote de instalação.</span><span class="sxs-lookup"><span data-stu-id="8f9df-109">Include both transitive components in the installation package.</span></span>
2.  <span data-ttu-id="8f9df-110">Crie componentes transitivos na [tabela](component-table.md) de componentes da mesma forma que os componentes regulares.</span><span class="sxs-lookup"><span data-stu-id="8f9df-110">Author both transitive components into the [Component table](component-table.md) the same as regular components.</span></span> <span data-ttu-id="8f9df-111">Cada componente transitivo deve ter seu próprio GUID exclusivo especificado na coluna ComponentID.</span><span class="sxs-lookup"><span data-stu-id="8f9df-111">Each transitive component must have its own unique GUID specified in the ComponentId column.</span></span>
3.  <span data-ttu-id="8f9df-112">Inclua o bit **msidbComponentAttributesTransitive** na coluna Attributes da tabela Component para cada componente transitiva.</span><span class="sxs-lookup"><span data-stu-id="8f9df-112">Include the **msidbComponentAttributesTransitive** bit in the Attributes column of the Component table for each transitive component.</span></span> <span data-ttu-id="8f9df-113">Se esse bit for definido, o instalador reavaliará o valor da instrução na coluna condição após uma reinstalação.</span><span class="sxs-lookup"><span data-stu-id="8f9df-113">If this bit is set, the installer reevaluates the value of the statement in the Condition column upon a reinstall.</span></span>

    <span data-ttu-id="8f9df-114">Se o valor era falso anteriormente e foi alterado para true, o instalador instalará o componente.</span><span class="sxs-lookup"><span data-stu-id="8f9df-114">If the value was previously False and has changed to True, the installer installs the component.</span></span>

    <span data-ttu-id="8f9df-115">Se o valor era verdadeiro anteriormente e foi alterado para false, o instalador removerá o componente, mesmo que o componente tenha outros produtos como clientes.</span><span class="sxs-lookup"><span data-stu-id="8f9df-115">If the value was previously True and has changed to False the installer removes the component even if the component has other products as clients.</span></span>

    > [!Note]  
    > <span data-ttu-id="8f9df-116">A menos que o bit transitiva seja definido, o componente permanece habilitado uma vez instalado, mesmo que a instrução condicional seja avaliada como falsa em uma instalação de manutenção subsequente do produto.</span><span class="sxs-lookup"><span data-stu-id="8f9df-116">Unless the transitive bit is set, the component remains enabled once installed even if the conditional statement evaluates to False on a subsequent maintenance installation of the product.</span></span> <span data-ttu-id="8f9df-117">As condições devem ser baseadas apenas em Estados de computador.</span><span class="sxs-lookup"><span data-stu-id="8f9df-117">The conditions must be based only on computer states.</span></span> <span data-ttu-id="8f9df-118">Não use com condições baseadas em Estados do usuário ou propriedades definidas na linha de comando, pois isso pode fazer com que o instalador exija uma reinstalação do produto em cada uso por um usuário diferente.</span><span class="sxs-lookup"><span data-stu-id="8f9df-118">Do not use with conditions based on user states or properties set on the command line because this can cause the installer to require a reinstallation of the product on each use by a different user.</span></span>

     

4.  <span data-ttu-id="8f9df-119">Insira expressões condicionais complementares nos campos de condição da tabela de controle, de modo que, quando a condição no primeiro componente transitivo for alterada para false, a condição no segundo componente transitivo será alterada para verdadeiro.</span><span class="sxs-lookup"><span data-stu-id="8f9df-119">Enter complementary conditional expressions into the Condition fields of the Control table such that when the condition on the first transitive component changes to False the condition on the second transitive component changes to True.</span></span> <span data-ttu-id="8f9df-120">Isso resulta na remoção do primeiro componente e na instalação do segundo componente na reinstalação do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8f9df-120">This results in the removal of the first component and installation of the second component upon reinstallation of the application.</span></span>

<span data-ttu-id="8f9df-121">Uma reinstalação do produto é necessária para alternar os componentes transitivos.</span><span class="sxs-lookup"><span data-stu-id="8f9df-121">A reinstallation of the product is necessary to switch the transitive components.</span></span> <span data-ttu-id="8f9df-122">Portanto, os autores de pacote precisam fornecer aos usuários um método para reinstalar o produto e para definir os modos da propriedade [**REinstallmode**](reinstallmode.md) .</span><span class="sxs-lookup"><span data-stu-id="8f9df-122">Package authors therefore need to provide users with a method for reinstalling the product and for setting the modes of the [**REINSTALLMODE**](reinstallmode.md) property.</span></span> <span data-ttu-id="8f9df-123">Há basicamente três maneiras de disparar a reinstalação:</span><span class="sxs-lookup"><span data-stu-id="8f9df-123">There are basically three ways to trigger the reinstallation:</span></span>

-   <span data-ttu-id="8f9df-124">Execute e configure a reinstalação por meio da interface do usuário criando um pacote que usa a [*IU completa*](f-gly.md).</span><span class="sxs-lookup"><span data-stu-id="8f9df-124">Run and configure the reinstallation through the user interface by authoring a package that uses the [*full UI*](f-gly.md).</span></span>
-   <span data-ttu-id="8f9df-125">Execute a reinstalação da linha de comando usando **msiexec/f** e selecione os modos na lista para a [opção de linha de comando](command-line-options.md) **/f** .</span><span class="sxs-lookup"><span data-stu-id="8f9df-125">Run the reinstallation from the command line by using **msiexec /f** and select the modes from the list for the **/f** [command line option](command-line-options.md).</span></span>
-   <span data-ttu-id="8f9df-126">Faça com que o aplicativo chame [**MsiReInstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) ou [**MsiReInstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span><span class="sxs-lookup"><span data-stu-id="8f9df-126">Have the application call [**MsiReInstallProduct**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) or [**MsiReInstallFeature**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).</span></span>

<span data-ttu-id="8f9df-127">O bit só deve ser usado com condições baseadas em Estados de computador.</span><span class="sxs-lookup"><span data-stu-id="8f9df-127">The bit should only be used with conditions based on computer states.</span></span> <span data-ttu-id="8f9df-128">Não use com condições baseadas em Estados do usuário ou propriedades definidas na linha de comando, pois isso pode fazer com que o instalador exija uma reinstalação do produto em cada uso por um usuário diferente.</span><span class="sxs-lookup"><span data-stu-id="8f9df-128">Do not use with conditions based on user states or properties set on the command line because this can cause the installer to require a reinstallation of the product on each use by a different user.</span></span>

> [!Note]
> <span data-ttu-id="8f9df-129">A menos que o bit transitiva na coluna atributos seja definido para um componente, o componente permanecerá habilitado uma vez instalado, mesmo que a instrução condicional na coluna condição seja avaliada como false em uma instalação de manutenção subsequente do produto.</span><span class="sxs-lookup"><span data-stu-id="8f9df-129">Unless the Transitive bit in the Attributes column is set for a component, the component remains enabled once installed even if the conditional statement in the Condition column evaluates to False on a subsequent maintenance installation of the product.</span></span>
> 
> <span data-ttu-id="8f9df-130">Na maioria dos casos, se um aplicativo incluir componentes transitivos, Windows Installer exigirá que a origem do aplicativo repare ou atualize o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="8f9df-130">In most cases, if an application includes transitive components, Windows Installer requires the application's source to repair or upgrade the application.</span></span> <span data-ttu-id="8f9df-131">Nesses casos, o CD-ROM de restauração do sistema enviado por um fabricante de equipamento original não funciona e uma fonte de instalação real para o aplicativo precisa ser fornecida.</span><span class="sxs-lookup"><span data-stu-id="8f9df-131">In these cases, the system restoration CD-ROM shipped by an original equipment manufacturer does not work and an actual installation source for the application needs to be provided.</span></span>

 

 

 



