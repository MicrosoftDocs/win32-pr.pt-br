---
description: Para validar um banco de dados, use uma ferramenta de validação especial para mesclar um arquivo. Cub contendo avaliadores de consistência internos (ICEs) em seu banco de dados, executar a ICEs e relatar os resultados.
ms.assetid: bdf38673-ee3d-47d8-ad6e-562cd5626918
title: Usando avaliadores de consistência internos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 423e6dab453ae495dc6029b54eb039c8acc60f33
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105770169"
---
# <a name="using-internal-consistency-evaluators"></a><span data-ttu-id="f06ea-103">Usando avaliadores de consistência internos</span><span class="sxs-lookup"><span data-stu-id="f06ea-103">Using Internal Consistency Evaluators</span></span>

<span data-ttu-id="f06ea-104">Para validar um banco de dados, use uma ferramenta de validação especial para mesclar um arquivo. Cub contendo [avaliadores de consistência internos](internal-consistency-evaluators-ices.md) (ICES) em seu banco de dados, executar a ICES e relatar os resultados.</span><span class="sxs-lookup"><span data-stu-id="f06ea-104">To validate a database, use a special validation tool to merge a .cub file containing the [Internal Consistency Evaluators](internal-consistency-evaluators-ices.md) (ICEs) into your database, execute the ICEs, and report the results.</span></span> <span data-ttu-id="f06ea-105">Várias ferramentas desse tipo são fornecidas no SDK (Software Development Kit) do Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="f06ea-105">Several such tools are provided in the Microsoft Windows Software Development Kit (SDK).</span></span> <span data-ttu-id="f06ea-106">A criação de ambientes de fornecedores terceirizados também pode incorporar o sistema de validação de gelo ao seu ambiente de criação.</span><span class="sxs-lookup"><span data-stu-id="f06ea-106">Authoring environments from third-party vendors also may incorporate the ICE validation system into their authoring environment.</span></span> <span data-ttu-id="f06ea-107">Também é possível escrever sua própria ferramenta para executar a validação de gelo.</span><span class="sxs-lookup"><span data-stu-id="f06ea-107">It is also possible to write your own tool to perform ICE validation.</span></span> <span data-ttu-id="f06ea-108">A maioria das ferramentas de validação de ICE mescla o arquivo. Cub e o banco de dados em um terceiro banco de dados temporário.</span><span class="sxs-lookup"><span data-stu-id="f06ea-108">Most ICE validation tools merge the .cub file and your database into a third, temporary database.</span></span> <span data-ttu-id="f06ea-109">Windows Installer exibe avisos, erros, informações de depuração e erros de API à medida que ele executa cada ICE no arquivo. cub.</span><span class="sxs-lookup"><span data-stu-id="f06ea-109">Windows Installer displays warnings, errors, debugging information, and API errors as it executes each ICE in the .cub file.</span></span> <span data-ttu-id="f06ea-110">Quando o instalador conclui a execução do ICEs, ele fecha o arquivo. msi, o arquivo. Cub e o banco de dados temporário sem salvar nenhuma alteração.</span><span class="sxs-lookup"><span data-stu-id="f06ea-110">When the installer finishes executing the ICEs it closes the .msi file, .cub file, and temporary database without saving any changes.</span></span> <span data-ttu-id="f06ea-111">O arquivo. msi e o arquivo. Cub permanecem inalterados pelo teste de validação.</span><span class="sxs-lookup"><span data-stu-id="f06ea-111">The .msi file and .cub file remain unchanged by the validation test.</span></span>

<span data-ttu-id="f06ea-112">As ações personalizadas do ICE se comunicam ao usuário chamando [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) e postando uma mensagem de usuário do INSTALLMESSAGE \_ .</span><span class="sxs-lookup"><span data-stu-id="f06ea-112">ICE custom actions communicate to the user by calling [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) and posting an INSTALLMESSAGE\_USER message.</span></span> <span data-ttu-id="f06ea-113">Uma mensagem ICE normalmente retorna informações como as seguintes:</span><span class="sxs-lookup"><span data-stu-id="f06ea-113">An ICE message commonly returns information such as the following:</span></span>

-   <span data-ttu-id="f06ea-114">Nome do ICE que encontrou um erro</span><span class="sxs-lookup"><span data-stu-id="f06ea-114">Name of the ICE that has found an error</span></span>
-   <span data-ttu-id="f06ea-115">Data em que o ICE foi criado</span><span class="sxs-lookup"><span data-stu-id="f06ea-115">Date the ICE was created</span></span>
-   <span data-ttu-id="f06ea-116">Autor da ICE</span><span class="sxs-lookup"><span data-stu-id="f06ea-116">Author of the ICE</span></span>
-   <span data-ttu-id="f06ea-117">Data em que a ICE foi modificada pela última vez.</span><span class="sxs-lookup"><span data-stu-id="f06ea-117">Date the ICE was last modified.</span></span>
-   <span data-ttu-id="f06ea-118">Descrição do erro de API que causa a falha do ICE</span><span class="sxs-lookup"><span data-stu-id="f06ea-118">Description of the API error causing the ICE to fail</span></span>
-   <span data-ttu-id="f06ea-119">Descrição do erro</span><span class="sxs-lookup"><span data-stu-id="f06ea-119">Description of the error</span></span>
-   <span data-ttu-id="f06ea-120">Um aviso para o usuário</span><span class="sxs-lookup"><span data-stu-id="f06ea-120">A warning to the user</span></span>
-   <span data-ttu-id="f06ea-121">Nome da tabela de banco de dados que contém o erro ou aviso</span><span class="sxs-lookup"><span data-stu-id="f06ea-121">Name of the database table containing the error or warning</span></span>
-   <span data-ttu-id="f06ea-122">Nome da coluna da tabela que contém o erro ou aviso</span><span class="sxs-lookup"><span data-stu-id="f06ea-122">Name of the table column containing the error or warning</span></span>
-   <span data-ttu-id="f06ea-123">Chaves primárias da tabela que contém o erro ou aviso</span><span class="sxs-lookup"><span data-stu-id="f06ea-123">Primary keys of the table containing the error or warning</span></span>
-   <span data-ttu-id="f06ea-124">Uma URL para um arquivo HTML fornecendo sugestões de depuração</span><span class="sxs-lookup"><span data-stu-id="f06ea-124">A URL to a HTML file giving debugging suggestions</span></span>
-   <span data-ttu-id="f06ea-125">Uma cadeia de caracteres que pode conter outras informações</span><span class="sxs-lookup"><span data-stu-id="f06ea-125">A string that can contain other information</span></span>

<span data-ttu-id="f06ea-126">Os autores de pacotes de instalação podem escrever ações personalizadas de gelo ou usar o conjunto padrão de ICEs incluído nos arquivos. Cub fornecidos com o SDK.</span><span class="sxs-lookup"><span data-stu-id="f06ea-126">Authors of installation packages can write ICE custom actions or use the standard set of ICEs included in the .cub files provided with the SDK.</span></span> <span data-ttu-id="f06ea-127">Para obter mais informações sobre como escrever um ICE, consulte [criando um Ice](building-an-ice.md).</span><span class="sxs-lookup"><span data-stu-id="f06ea-127">For more information on how to write an ICE, see [Building an ICE](building-an-ice.md).</span></span>

<span data-ttu-id="f06ea-128">Depois de escrever o ICEs apropriado para validação, um desenvolvedor deve coletar as ações personalizadas em um banco de dados. msi, chamado um arquivo. Cub, que contém apenas as mesmas e as tabelas necessárias.</span><span class="sxs-lookup"><span data-stu-id="f06ea-128">After writing the appropriate ICEs for validation, a developer must collect the custom actions together into an .msi database, called a .cub file, that contains only the ICEs and their required tables.</span></span> <span data-ttu-id="f06ea-129">Um arquivo. Cub não pode ser instalado e usado somente para armazenar e fornecer acesso a ações personalizadas do ICE.</span><span class="sxs-lookup"><span data-stu-id="f06ea-129">A .cub file cannot be installed and is used only to store and provide access to ICE custom actions.</span></span> <span data-ttu-id="f06ea-130">Para obter mais informações sobre como criar arquivos. Cub, consulte [criando um banco de dados Ice](building-an-ice-database.md).</span><span class="sxs-lookup"><span data-stu-id="f06ea-130">For more information on making .cub files, see [Building an ICE Database](building-an-ice-database.md).</span></span> <span data-ttu-id="f06ea-131">Como alternativa, os desenvolvedores podem validar seu pacote de instalação usando as ICEs existentes descritas na [referência do Ice](ice-reference.md).</span><span class="sxs-lookup"><span data-stu-id="f06ea-131">Alternatively, developers can validate their installation package using the existing ICEs described in [ICE Reference](ice-reference.md).</span></span> <span data-ttu-id="f06ea-132">Essas ICEs podem ser obtidas a partir de arquivos. Cub padrão fornecidos com o SDK.</span><span class="sxs-lookup"><span data-stu-id="f06ea-132">These ICEs can be obtained from standard .cub files provided with the SDK.</span></span>

<span data-ttu-id="f06ea-133">A instalação do Orca Editor de tabela de banco de dados ou da ferramenta de validação msival2 fornece os arquivos logo. Cub, Darice. Cub e Mergemod. cub.</span><span class="sxs-lookup"><span data-stu-id="f06ea-133">The installation of the database table editor Orca or the validation tool msival2 provides the Logo.cub, Darice.cub, and Mergemod.cub files.</span></span> <span data-ttu-id="f06ea-134">O conjunto de ICEs no arquivo logo. Cub é um subconjunto daqueles no arquivo Darice. cub.</span><span class="sxs-lookup"><span data-stu-id="f06ea-134">The set of ICEs in the Logo.cub file is a subset of those in the Darice.cub file.</span></span> <span data-ttu-id="f06ea-135">Se o pacote passar na validação usando Darice. Cub, ele passará com logo. cub.</span><span class="sxs-lookup"><span data-stu-id="f06ea-135">If your package passes validation using Darice.cub, it will pass with Logo.cub.</span></span> <span data-ttu-id="f06ea-136">Mergemod. Cub contém um conjunto de ICEs usado para validar módulos de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="f06ea-136">Mergemod.cub contains a set of ICEs used to validate merge modules.</span></span> <span data-ttu-id="f06ea-137">Para obter mais informações, consulte [referência de Ice do módulo de mesclagem](merge-module-ice-reference.md).</span><span class="sxs-lookup"><span data-stu-id="f06ea-137">For more information, see [Merge Module ICE Reference](merge-module-ice-reference.md).</span></span>

<span data-ttu-id="f06ea-138">**Para validar um pacote de instalação**</span><span class="sxs-lookup"><span data-stu-id="f06ea-138">**To validate an installation package**</span></span>

1.  <span data-ttu-id="f06ea-139">Obtenha ou crie as ações personalizadas de ICE apropriadas.</span><span class="sxs-lookup"><span data-stu-id="f06ea-139">Obtain or author the appropriate ICE custom actions.</span></span> <span data-ttu-id="f06ea-140">Você poderá usar uma ou mais das ICEs existentes descritas na [referência do Ice](ice-reference.md).</span><span class="sxs-lookup"><span data-stu-id="f06ea-140">You may be able to use one or more of the existing ICEs described in the [ICE Reference](ice-reference.md).</span></span> <span data-ttu-id="f06ea-141">Se sua validação exigir uma ICE ainda não nesta lista, você poderá criar uma nova ICE, conforme descrito em [criando um Ice](building-an-ice.md).</span><span class="sxs-lookup"><span data-stu-id="f06ea-141">If your validation requires an ICE not yet in this list, you can create a new ICE as described in [Building an ICE](building-an-ice.md).</span></span>
2.  <span data-ttu-id="f06ea-142">Prepare um banco de dados ICE contendo todas as ações personalizadas do ICE.</span><span class="sxs-lookup"><span data-stu-id="f06ea-142">Prepare an ICE Database containing all the ICE custom actions.</span></span> <span data-ttu-id="f06ea-143">Consulte a seção [criando um banco de dados Ice](building-an-ice-database.md) para obter informações sobre como preparar um arquivo. cub.</span><span class="sxs-lookup"><span data-stu-id="f06ea-143">See the section [Building An ICE Database](building-an-ice-database.md) for information about preparing a .cub file.</span></span>
3.  <span data-ttu-id="f06ea-144">Forneça o arquivo. Cub e o arquivo. msi para uma ferramenta de validação de pacote, como [Orca.exe](orca-exe.md) ou [Msival2.exe](msival2-exe.md).</span><span class="sxs-lookup"><span data-stu-id="f06ea-144">Provide the .cub file and the .msi file to a package validation tool such as [Orca.exe](orca-exe.md) or [Msival2.exe](msival2-exe.md).</span></span>

<span data-ttu-id="f06ea-145">Observe que os módulos de mesclagem devem ser validados conforme descrito em [Validando módulos de mesclagem](validating-merge-modules.md).</span><span class="sxs-lookup"><span data-stu-id="f06ea-145">Note that merge modules should be validated as described in [Validating Merge Modules](validating-merge-modules.md).</span></span>

 

 



