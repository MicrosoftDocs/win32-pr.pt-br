---
description: Ao criar um pacote de instalação, você pode usar a função MsiViewModify ou o método View. Modify para garantir que os dados inseridos estejam sintaticamente corretos.
ms.assetid: c960e9df-dcd6-44d2-8662-40a1dea81f45
title: Validação interna
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ca3c1a9e6f7b7e35b4d7d91287af64eff7812de6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104089984"
---
# <a name="internal-validation"></a><span data-ttu-id="491c4-103">Validação interna</span><span class="sxs-lookup"><span data-stu-id="491c4-103">Internal Validation</span></span>

<span data-ttu-id="491c4-104">Ao criar um pacote de instalação, você pode usar a função [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) ou o método View. Modify para garantir que os dados inseridos estejam sintaticamente corretos.</span><span class="sxs-lookup"><span data-stu-id="491c4-104">When authoring an installation package, you can use the [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) function or the View.Modify method to ensure that the data you enter is syntactically correct.</span></span> <span data-ttu-id="491c4-105">Para obter mais informações, consulte [**Modificar método**](view-modify.md).</span><span class="sxs-lookup"><span data-stu-id="491c4-105">For more information, see [**Modify method**](view-modify.md).</span></span> <span data-ttu-id="491c4-106">No nível mais baixo, uma coluna de tabela de banco de dados pode armazenar inteiros (curtos ou longos), cadeias de caracteres ou dados binários.</span><span class="sxs-lookup"><span data-stu-id="491c4-106">At the lowest level, a database table's column can store integers (short or long), strings, or binary data.</span></span> <span data-ttu-id="491c4-107">No entanto, um pacote de instalação requer números inteiros ou cadeias de caracteres específicos em determinadas tabelas.</span><span class="sxs-lookup"><span data-stu-id="491c4-107">However, an installation package requires specific integers or strings in certain tables.</span></span> <span data-ttu-id="491c4-108">Essas especificações são mantidas na [ \_ tabela de validação](-validation-table.md).</span><span class="sxs-lookup"><span data-stu-id="491c4-108">These specifications are maintained in the [\_Validation table](-validation-table.md).</span></span> <span data-ttu-id="491c4-109">Por exemplo, a coluna FileName da [tabela File](file-table.md) é uma coluna de cadeia de caracteres, mas armazena especificamente um nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="491c4-109">For example, the FileName column of the [File table](file-table.md) is a string column, but it specifically stores a file name.</span></span> <span data-ttu-id="491c4-110">Portanto, não só se a sua entrada fosse uma cadeia de caracteres, mas também deve seguir os requisitos para nomear arquivos.</span><span class="sxs-lookup"><span data-stu-id="491c4-110">Therefore, not only should your entry be a string, but it should also follow the requirements for naming files.</span></span>

<span data-ttu-id="491c4-111">Os vários valores de enumeração de validação usados com a função [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) permitem a validação imediata em diferentes níveis.</span><span class="sxs-lookup"><span data-stu-id="491c4-111">The various validation enum values used with the [**MsiViewModify**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) function allow for immediate validation at different levels.</span></span> <span data-ttu-id="491c4-112">A \_ enumeração de campo MSIMODIFY Validate \_ pode ser usada para validar campos individuais de um registro.</span><span class="sxs-lookup"><span data-stu-id="491c4-112">The MSIMODIFY\_VALIDATE\_FIELD enum can be used to validate individual fields of a record.</span></span> <span data-ttu-id="491c4-113">Ele não valida chaves estrangeiras.</span><span class="sxs-lookup"><span data-stu-id="491c4-113">It does not validate foreign keys.</span></span> <span data-ttu-id="491c4-114">A \_ Enumeração Validate de MSIMODIFY valida uma linha inteira e inclui a validação de chave estrangeira.</span><span class="sxs-lookup"><span data-stu-id="491c4-114">The MSIMODIFY\_VALIDATE enum validates an entire row and includes foreign key validation.</span></span> <span data-ttu-id="491c4-115">Se você estiver inserindo uma nova linha em uma tabela, use o MSIMODIFY \_ validar \_ nova enumeração para verificar se você está adicionando dados válidos, bem como usando chaves primárias exclusivas.</span><span class="sxs-lookup"><span data-stu-id="491c4-115">If you are inserting a new row into a table, use the MSIMODIFY\_VALIDATE\_NEW enum to verify that you are adding valid data as well as using unique primary keys.</span></span> <span data-ttu-id="491c4-116">Uma inserção falhará se as chaves primárias não forem exclusivas.</span><span class="sxs-lookup"><span data-stu-id="491c4-116">An insert fails if the primary keys are not unique.</span></span> <span data-ttu-id="491c4-117">Se uma chamada para **MsiViewModify** com uma das enumerações de validação retornar um erro, você poderá fazer chamadas repetidas para [**MsiViewGetError**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora) para diagnosticar o problema.</span><span class="sxs-lookup"><span data-stu-id="491c4-117">If a call to **MsiViewModify** with one of the validation enums returns an error, you can make repeated calls to [**MsiViewGetError**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora) for diagnosing the problem.</span></span> <span data-ttu-id="491c4-118">**MsiViewGetError** indica a coluna em que o erro ocorreu, bem como o valor de enumeração para ajudar a corrigir o problema.</span><span class="sxs-lookup"><span data-stu-id="491c4-118">**MsiViewGetError** indicates the column where the error occurred as well as the enum value to help fix the problem.</span></span> <span data-ttu-id="491c4-119">Para obter mais informações, consulte [**GetError Method**](view-geterror.md).</span><span class="sxs-lookup"><span data-stu-id="491c4-119">For more information, see [**GetError method**](view-geterror.md).</span></span>

<span data-ttu-id="491c4-120">Você também pode usar a validação interna para garantir que outros autores insiram dados corretamente em sua tabela personalizada.</span><span class="sxs-lookup"><span data-stu-id="491c4-120">You can also use internal validation to ensure that other authors enter data correctly into your custom table.</span></span> <span data-ttu-id="491c4-121">Adicione cada uma das colunas da tabela personalizada à tabela de \_ validação usando o nome da tabela personalizada e o nome da coluna como a chave primária.</span><span class="sxs-lookup"><span data-stu-id="491c4-121">Add each of the columns of your custom table to the \_Validation table using the custom table name and column name as the primary key.</span></span> <span data-ttu-id="491c4-122">Forneça uma descrição ou finalidade de cada coluna na coluna Descrição da tabela de \_ validação.</span><span class="sxs-lookup"><span data-stu-id="491c4-122">Provide a description or purpose of each column in the Description column of the \_Validation table.</span></span> <span data-ttu-id="491c4-123">Insira os requisitos aplicáveis para cada coluna usando as colunas Nullable, MinValue, MaxValue, keyTable, KeyColumn, Category e Set:</span><span class="sxs-lookup"><span data-stu-id="491c4-123">Enter the applicable requirements for each column using the Nullable, MinValue, MaxValue, KeyTable, KeyColumn, Category, and Set columns:</span></span>

-   <span data-ttu-id="491c4-124">Se a coluna for anulável, insira um ' Y '.</span><span class="sxs-lookup"><span data-stu-id="491c4-124">If the column is Nullable, enter a 'Y'.</span></span> <span data-ttu-id="491c4-125">Caso contrário, insira um ' n'.</span><span class="sxs-lookup"><span data-stu-id="491c4-125">If not, enter a 'N'.</span></span>
-   <span data-ttu-id="491c4-126">Se a coluna for uma coluna de inteiros e puder conter um intervalo de inteiros, insira esse intervalo usando as colunas MinValue e MaxValue.</span><span class="sxs-lookup"><span data-stu-id="491c4-126">If the column is an integer column and can contain a range of integers, enter that range using the MinValue and MaxValue columns.</span></span>
-   <span data-ttu-id="491c4-127">As colunas de chave estrangeira são identificadas usando as colunas keyTable e KeyColumn.</span><span class="sxs-lookup"><span data-stu-id="491c4-127">Foreign key columns are identified using the KeyTable and KeyColumn columns.</span></span>
-   <span data-ttu-id="491c4-128">Para colunas de cadeia de caracteres, especifique uma categoria como nome de arquivo, GUID ou identificador.</span><span class="sxs-lookup"><span data-stu-id="491c4-128">For string columns, specify a Category such as Filename, GUID, or Identifier.</span></span> <span data-ttu-id="491c4-129">Para obter mais informações, consulte [tipos de dados de coluna](column-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="491c4-129">For more information, see [column data types](column-data-types.md).</span></span>
-   <span data-ttu-id="491c4-130">Se os dados só puderem pertencer a um número específico de valores (cadeia de caracteres ou inteiro), use a coluna definir para listar os valores aceitáveis.</span><span class="sxs-lookup"><span data-stu-id="491c4-130">If the data can only pertain to a specific number of values (string or integer), use the Set column to list the acceptable values.</span></span>

<span data-ttu-id="491c4-131">A seguir está uma lista das colunas (além de tabela, coluna e descrição) na \_ tabela de validação que pode ser preenchida se a coluna for do tipo especificado.</span><span class="sxs-lookup"><span data-stu-id="491c4-131">The following is a list of the columns (in addition to Table, Column, and Description) in the \_Validation table that can be filled in if your column is of the specified type.</span></span> <span data-ttu-id="491c4-132">(Observe que você não precisa preencher todas as colunas.)</span><span class="sxs-lookup"><span data-stu-id="491c4-132">(Note that you do not have to fill in all the columns.)</span></span>



| <span data-ttu-id="491c4-133">Type</span><span class="sxs-lookup"><span data-stu-id="491c4-133">Type</span></span>    | <span data-ttu-id="491c4-134">Colunas</span><span class="sxs-lookup"><span data-stu-id="491c4-134">Columns</span></span>                                                          |
|---------|------------------------------------------------------------------|
| <span data-ttu-id="491c4-135">Inteiro</span><span class="sxs-lookup"><span data-stu-id="491c4-135">Integer</span></span> | <span data-ttu-id="491c4-136">Nullable, MinValue, MaxValue, keyTable, KeyColumn, Set</span><span class="sxs-lookup"><span data-stu-id="491c4-136">Nullable, MinValue, MaxValue, KeyTable, KeyColumn, Set</span></span>           |
| <span data-ttu-id="491c4-137">String</span><span class="sxs-lookup"><span data-stu-id="491c4-137">String</span></span>  | <span data-ttu-id="491c4-138">Nullable, keyTable, KeyColumn, Category, set, MinValue, MaxValue</span><span class="sxs-lookup"><span data-stu-id="491c4-138">Nullable, KeyTable, KeyColumn, Category, Set, MinValue, MaxValue</span></span> |
| <span data-ttu-id="491c4-139">Binário</span><span class="sxs-lookup"><span data-stu-id="491c4-139">Binary</span></span>  | <span data-ttu-id="491c4-140">Permite valor nulo, categoria (a categoria deve ser "binary")</span><span class="sxs-lookup"><span data-stu-id="491c4-140">Nullable, Category (Category must be "Binary")</span></span>                   |



 

<span data-ttu-id="491c4-141">Os ambientes de criação podem fazer uso de MSIMODIFY \_ validar \_ Delete.</span><span class="sxs-lookup"><span data-stu-id="491c4-141">Authoring environments may make use of MSIMODIFY\_VALIDATE\_DELETE.</span></span> <span data-ttu-id="491c4-142">Essa enumeração pressupõe que você deseja excluir a linha.</span><span class="sxs-lookup"><span data-stu-id="491c4-142">This enum assumes that you want to delete the row.</span></span> <span data-ttu-id="491c4-143">Nenhuma validação de campo ou de chave estrangeira é executada.</span><span class="sxs-lookup"><span data-stu-id="491c4-143">No field or foreign key validation is performed.</span></span> <span data-ttu-id="491c4-144">Na verdade, essa enumeração executa uma validação de chave estrangeira inversa.</span><span class="sxs-lookup"><span data-stu-id="491c4-144">This enum actually performs a reverse foreign key validation.</span></span> <span data-ttu-id="491c4-145">Ele verifica a \_ tabela de validação em busca de referências nas colunas keyTable e KeyColumn da tabela à qual a linha "Deleted" pertence.</span><span class="sxs-lookup"><span data-stu-id="491c4-145">It checks the \_Validation table for references in the KeyTable and KeyColumn columns for the table to which the "deleted" row belongs.</span></span> <span data-ttu-id="491c4-146">Se houver colunas que listam a tabela que contém a linha "Deleted" como uma possível chave estrangeira, ela percorre essa coluna para ver se algum dos valores referencia valores na linha "Deleted".</span><span class="sxs-lookup"><span data-stu-id="491c4-146">If there are columns that list the table containing the "deleted" row as a potential foreign key, it cycles through that column to see if any of the values reference values in the "deleted" row.</span></span> <span data-ttu-id="491c4-147">Um retorno de erro significa que você quebra a integridade relacional do banco de dados excluindo a linha.</span><span class="sxs-lookup"><span data-stu-id="491c4-147">An error return means that you break the relational integrity of the database by deleting the row.</span></span>

 

 



