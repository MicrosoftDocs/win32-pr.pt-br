---
description: Instmsi.exe é o pacote redistribuível para instalar o Windows Installer&\# 160; 2.0 e versões anteriores do Windows Installer. Consulte Windows Installer redistribuíveis para os pacotes redistribuíveis para Windows Installer&\# 160; 3.0 e versões posteriores.
ms.assetid: 74ea4530-3a73-4169-b0b7-f0272229192d
title: Instmsi.exe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 229d748cda68731627a6af2af992e321755b5ca2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105792499"
---
# <a name="instmsiexe"></a><span data-ttu-id="fdbe6-104">Instmsi.exe</span><span class="sxs-lookup"><span data-stu-id="fdbe6-104">Instmsi.exe</span></span>

<span data-ttu-id="fdbe6-105">Instmsi.exe é o pacote redistribuível para instalar o Windows Installer 2,0 e versões anteriores do Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-105">Instmsi.exe is the redistributable package for installing Windows Installer 2.0, and earlier versions of Windows Installer.</span></span> <span data-ttu-id="fdbe6-106">Consulte [Windows Installer redistribuíveis](windows-installer-redistributables.md) para os pacotes redistribuíveis para Windows Installer 3,0 e versões posteriores.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-106">See [Windows Installer Redistributables](windows-installer-redistributables.md) for the redistributables for Windows Installer 3.0 and later versions.</span></span>

<span data-ttu-id="fdbe6-107">Para obter mais informações sobre qual versão do Windows Installer foi fornecida com seu sistema operacional, consulte [versões lançadas do Windows Installer](released-versions-of-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="fdbe6-107">For more information about which version of the Windows Installer was shipped with your operating system, see [Released Versions of Windows Installer](released-versions-of-windows-installer.md).</span></span>

<span data-ttu-id="fdbe6-108">Alguns redistribuíveis não devem ser executados em determinadas versões do sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-108">Some redistributables should not be run on certain versions of the operating system.</span></span> <span data-ttu-id="fdbe6-109">A tabela a seguir descreve qual Instmsi é compatível em qual sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-109">The following table describes which Instmsi is compatible on which operating system.</span></span>



| <span data-ttu-id="fdbe6-110">Se Instmsi.exe instalar esta versão do Windows Installer</span><span class="sxs-lookup"><span data-stu-id="fdbe6-110">If Instmsi.exe installs this version of the Windows Installer</span></span> | <span data-ttu-id="fdbe6-111">Instmsi.exe pode ser executado nesses sistemas operacionais</span><span class="sxs-lookup"><span data-stu-id="fdbe6-111">Instmsi.exe can be run on these operating systems</span></span>                    | <span data-ttu-id="fdbe6-112">Instmsi.exe não deve ser executado nesses sistemas operacionais</span><span class="sxs-lookup"><span data-stu-id="fdbe6-112">Instmsi.exe must not be run on these operating systems</span></span>                                        |
|---------------------------------------------------------------|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| <span data-ttu-id="fdbe6-113">Windows Installer versão 1,0</span><span class="sxs-lookup"><span data-stu-id="fdbe6-113">Windows Installer version 1.0</span></span>                                 | <span data-ttu-id="fdbe6-114">Windows 95, Windows 98, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="fdbe6-114">Windows 95, Windows 98, Windows NT 4.0+SP3</span></span>                           | <span data-ttu-id="fdbe6-115">Windows me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="fdbe6-115">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span> |
| <span data-ttu-id="fdbe6-116">Windows Installer versão 1,1</span><span class="sxs-lookup"><span data-stu-id="fdbe6-116">Windows Installer version 1.1</span></span>                                 | <span data-ttu-id="fdbe6-117">Windows 95, Windows 98, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="fdbe6-117">Windows 95, Windows 98, Windows NT 4.0+SP3</span></span>                           | <span data-ttu-id="fdbe6-118">Windows me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="fdbe6-118">Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span> |
| <span data-ttu-id="fdbe6-119">Windows Installer versão 1,2</span><span class="sxs-lookup"><span data-stu-id="fdbe6-119">Windows Installer version 1.2</span></span>                                 | <span data-ttu-id="fdbe6-120">Windows 95, Windows 98, Windows me, Windows NT 4.0 + SP3</span><span class="sxs-lookup"><span data-stu-id="fdbe6-120">Windows 95, Windows 98, Windows Me, Windows NT 4.0+SP3</span></span>               | <span data-ttu-id="fdbe6-121">Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="fdbe6-121">Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span>             |
| <span data-ttu-id="fdbe6-122">Windows Installer versão 2,0</span><span class="sxs-lookup"><span data-stu-id="fdbe6-122">Windows Installer version 2.0</span></span>                                 | <span data-ttu-id="fdbe6-123">Windows 95, Windows 98, Windows me, Windows NT 4.0 + SP6, Windows 2000</span><span class="sxs-lookup"><span data-stu-id="fdbe6-123">Windows 95, Windows 98, Windows Me, Windows NT 4.0+SP6, Windows 2000</span></span> | <span data-ttu-id="fdbe6-124">Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span><span class="sxs-lookup"><span data-stu-id="fdbe6-124">Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008</span></span>                           |



 

<span data-ttu-id="fdbe6-125">Por exemplo, um aplicativo que redistribui Windows Installer versão 1,1 deve verificar se o sistema operacional é o Windows NT 4,0 SP3 ou o Windows 98/95 antes de executar o pacote redistribuível.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-125">For example, an application that redistributes Windows Installer version 1.1 should check that the operating system is Windows NT 4.0 SP3 or Windows 98/95 before running the redistributable package.</span></span> <span data-ttu-id="fdbe6-126">Os aplicativos que usam o pacote redistribuível também devem garantir que a versão ANSI do Windows Installer esteja instalada no Windows 98/95 e que a versão Unicode esteja instalada no Windows NT ou no Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-126">Applications using the redistributable package should also ensure that the ANSI version of the Windows Installer is installed on Windows 98/95, and that the Unicode version is installed on Windows NT or Windows 2000.</span></span> <span data-ttu-id="fdbe6-127">Observe que alguns aplicativos renomeam a versão Unicode para InstMsiW.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-127">Note that some applications rename the Unicode version to InstMsiW.</span></span>

## <a name="syntax"></a><span data-ttu-id="fdbe6-128">Syntax</span><span class="sxs-lookup"><span data-stu-id="fdbe6-128">Syntax</span></span>

<span data-ttu-id="fdbe6-129"> *Opções* Instmsi</span><span class="sxs-lookup"><span data-stu-id="fdbe6-129">**instmsi** *options*</span></span>

## <a name="command-line-options"></a><span data-ttu-id="fdbe6-130">Opções de linha de comando</span><span class="sxs-lookup"><span data-stu-id="fdbe6-130">Command Line Options</span></span>

<span data-ttu-id="fdbe6-131">As opções de linha de comando não diferenciam maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-131">The command line options are case-insensitive.</span></span>



| <span data-ttu-id="fdbe6-132">Opção</span><span class="sxs-lookup"><span data-stu-id="fdbe6-132">Option</span></span>                     | <span data-ttu-id="fdbe6-133">Descrição</span><span class="sxs-lookup"><span data-stu-id="fdbe6-133">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="fdbe6-134">/q</span><span class="sxs-lookup"><span data-stu-id="fdbe6-134">/q</span></span>                         | <span data-ttu-id="fdbe6-135">Para uso por aplicativos que redistribuem o Windows Installer como parte de um aplicativo de inicialização.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-135">For use by applications that redistribute the Windows Installer as part of a bootstrapping application.</span></span> <span data-ttu-id="fdbe6-136">Nenhuma IU é apresentada ao usuário.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-136">No UI is presented to the user.</span></span> <span data-ttu-id="fdbe6-137">O aplicativo de inicialização deve verificar o código de retorno para determinar se uma reinicialização é necessária para concluir a instalação do Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-137">The bootstrapping application should check the return code to determine whether a reboot is needed to complete the installation of the Windows Installer.</span></span>                                                                                                                                                                                                                          |
| <span data-ttu-id="fdbe6-138">/t</span><span class="sxs-lookup"><span data-stu-id="fdbe6-138">/t</span></span>                         | <span data-ttu-id="fdbe6-139">Usado somente para fins de depuração.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-139">Used for debugging purposes only.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="fdbe6-140">/c: "msiinst/delayreboot"</span><span class="sxs-lookup"><span data-stu-id="fdbe6-140">/c:"msiinst /delayreboot"</span></span>  | <span data-ttu-id="fdbe6-141">A opção de reinicialização atrasada.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-141">The delayed reboot option.</span></span> <span data-ttu-id="fdbe6-142">Impede que o Instmsi solicite uma reinicialização ao usuário, mesmo que tenha que substituir arquivos que estavam em uso durante a instalação.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-142">Prevents Instmsi from prompting the user for a reboot even if it had to replace files that were in use during the installation.</span></span> <span data-ttu-id="fdbe6-143">Se Instmsi for invocado com essa opção, retornará um erro com \_ êxito \_ reinicialização \_ necessária se tiver que substituir os arquivos que estavam em uso.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-143">If Instmsi is invoked with this option, it returns ERROR\_SUCCESS\_REBOOT\_REQUIRED if it had to replace files that were in use.</span></span> <span data-ttu-id="fdbe6-144">Se não tiver de substituir os arquivos que estavam em uso, ele retornará êxito de erro \_ .</span><span class="sxs-lookup"><span data-stu-id="fdbe6-144">If it did not have to replace files that were in use, it returns ERROR\_SUCCESS.</span></span> <span data-ttu-id="fdbe6-145">Disponível com o Instmsi para Windows Installer 2,0 ou posterior.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-145">Available with Instmsi for Windows Installer  2.0 or later.</span></span> <span data-ttu-id="fdbe6-146">Consulte a seção comentários para obter informações adicionais sobre reinicializações atrasadas.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-146">See the remarks section for additional information on delayed reboots.</span></span><br/> |
| <span data-ttu-id="fdbe6-147">/c: "msiinst/delayrebootq"</span><span class="sxs-lookup"><span data-stu-id="fdbe6-147">/c:"msiinst /delayrebootq"</span></span> | <span data-ttu-id="fdbe6-148">A versão silenciosa da opção de reinicialização atrasada.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-148">The quiet version of the delayed reboot option.</span></span> <span data-ttu-id="fdbe6-149">Ele não apresenta nenhuma interface de usuário para o usuário.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-149">It does not present any UI to the user.</span></span> <span data-ttu-id="fdbe6-150">Caso contrário, o comportamento será idêntico à opção anterior.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-150">Otherwise the behavior is identical to the previous option.</span></span> <span data-ttu-id="fdbe6-151">Disponível com o Instmsi para Windows Installer 2,0 ou posterior.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-151">Available with Instmsi for Windows Installer 2.0 or later.</span></span> <span data-ttu-id="fdbe6-152">Consulte a seção comentários para obter informações adicionais sobre reinicializações atrasadas.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-152">See the remarks section for additional information on delayed reboots.</span></span><br/>                                                                                                                                                                                                                           |
| <span data-ttu-id="fdbe6-153">/?</span><span class="sxs-lookup"><span data-stu-id="fdbe6-153">/?</span></span>                         | <span data-ttu-id="fdbe6-154">Exibe a ajuda.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-154">Displays help.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

## <a name="remarks"></a><span data-ttu-id="fdbe6-155">Comentários</span><span class="sxs-lookup"><span data-stu-id="fdbe6-155">Remarks</span></span>

<span data-ttu-id="fdbe6-156">Os aplicativos de [inicialização](bootstrapping.md) que usam o Instmsi.exe para instalar o Windows Installer com outro aplicativo podem exigir uma reinicialização extra do sistema.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-156">[Bootstrapping](bootstrapping.md) applications that use Instmsi.exe to install the Windows Installer with another application may require an extra system reboot.</span></span> <span data-ttu-id="fdbe6-157">Isso é potencialmente uma reinicialização extra além de quaisquer reinicializações necessárias para instalar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-157">This is potentially an extra reboot in addition to any reboots that are needed to install the application.</span></span>

<span data-ttu-id="fdbe6-158">A opção de reinicialização atrasada só é recomendada para os desenvolvedores de instalação que desejam eliminar uma reinicialização extra causada pelo uso de Instmsi.exe com um aplicativo de instalação que instala arquivos que estão em uso.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-158">The delayed reboot option is only recommended for setup developers who want to eliminate an extra reboot caused by using Instmsi.exe with a setup application that installs files that are in use.</span></span>

<span data-ttu-id="fdbe6-159">Os desenvolvedores devem fazer o seguinte em seu aplicativo de instalação para usar a opção de reinicialização atrasada.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-159">Developers should do the following in their setup application to use the delayed reboot option.</span></span> <span data-ttu-id="fdbe6-160">Essa opção não está disponível com Instmsi.exe versões que instalam versões anteriores à versão 2,0 do Windows Installer:</span><span class="sxs-lookup"><span data-stu-id="fdbe6-160">This option is not available with Instmsi.exe versions that install Window Installer versions earlier than version 2.0:</span></span>

<span data-ttu-id="fdbe6-161">**Para usar a opção de reinicialização atrasada**</span><span class="sxs-lookup"><span data-stu-id="fdbe6-161">**To use the delayed reboot option**</span></span>

1.  <span data-ttu-id="fdbe6-162">Chame Instmsi.exe com uma das opções de linha de comando de reinicialização atrasada.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-162">Call Instmsi.exe with one of the delayed reboot command line options.</span></span>
2.  <span data-ttu-id="fdbe6-163">Trate o retorno de êxito de erro \_ ou \_ êxito na \_ reinicialização de erro \_ necessária, como significado do sucesso.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-163">Treat the return of either ERROR\_SUCCESS or ERROR\_SUCCESS\_REBOOT\_REQUIRED as meaning success.</span></span>
3.  <span data-ttu-id="fdbe6-164">Obtenha o caminho para a pasta que contém os binários de Windows Installer recentemente instalados do valor InstallerLocation em:</span><span class="sxs-lookup"><span data-stu-id="fdbe6-164">Get the path to the folder containing the newly installed Windows Installer binaries from the InstallerLocation value under:</span></span>

    <span data-ttu-id="fdbe6-165">**HKEY \_ \_** Instalador de \\ **software** do computador local \\ **Microsoft** \\ **Windows** \\ **CurrentVersion** \\ </span><span class="sxs-lookup"><span data-stu-id="fdbe6-165">**HKEY\_LOCAL\_MACHINE**\\**Software**\\**Microsoft**\\**Windows**\\**CurrentVersion**\\**Installer**</span></span>

    <span data-ttu-id="fdbe6-166">Esse valor é do tipo **reg \_ sz**.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-166">This value is of type **REG\_SZ**.</span></span>

4.  <span data-ttu-id="fdbe6-167">Defina o diretório atual para o caminho obtido na etapa 3.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-167">Set the current directory to the path obtained in step 3.</span></span>
5.  <span data-ttu-id="fdbe6-168">Invoque o msiexec no pacote do aplicativo e execute outro código de instalação específico para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-168">Invoke Msiexec on the application's package and run other setup code specific to the application.</span></span> <span data-ttu-id="fdbe6-169">Se o aplicativo de instalação usar [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta), o aplicativo deverá carregar MSI.DLL do local obtido na etapa 3.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-169">If the setup application uses [**MsiInstallProduct**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta), then the application must load MSI.DLL from the location obtained in step 3.</span></span>
    > [!Note]  
    > <span data-ttu-id="fdbe6-170">Os aplicativos que chamam **LoadLibrary** no novo MSI.DLL no local obtido na etapa 3 devem garantir que uma versão mais antiga do MSI.DLL ainda não tenha sido carregada dentro do processo.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-170">Applications that call **LoadLibrary** on the new MSI.DLL in the location obtained in step 3 must ensure that an older version of MSI.DLL has not already been loaded within the process.</span></span> <span data-ttu-id="fdbe6-171">Se uma versão mais antiga do MSI.DLL tiver sido carregada no processo, ela deverá ser descarregada do espaço de endereço do processo antes da chamada **LoadLibrary** para o novo MSI.DLL.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-171">If an older version of MSI.DLL was loaded within the process, it must be unloaded from the process address space prior to the **LoadLibrary** call for the new MSI.DLL.</span></span>

     

6.  <span data-ttu-id="fdbe6-172">Se Step (5) não exigir uma reinicialização e se Instmsi.exe tiver retornado erro de \_ \_ reinicialização de êxito \_ necessário na etapa (1), solicite ao usuário uma reinicialização para concluir a configuração dos binários de Windows Installer no sistema.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-172">If step (5) does not require a reboot and if Instmsi.exe had returned ERROR\_SUCCESS\_REBOOT\_REQUIRED in step (1), prompt the user for a reboot to complete the setup of the Windows Installer binaries on the system.</span></span> <span data-ttu-id="fdbe6-173">No entanto, se uma reinicialização ocorrer na etapa (5), nenhuma etapa adicional será necessária.</span><span class="sxs-lookup"><span data-stu-id="fdbe6-173">However, if a reboot occurs in step (5), no additional steps are required.</span></span>

<span data-ttu-id="fdbe6-174">Instmsi.exe está disponível nos [componentes de SDK do Windows para os desenvolvedores de Windows Installer](platform-sdk-components-for-windows-installer-developers.md).</span><span class="sxs-lookup"><span data-stu-id="fdbe6-174">Instmsi.exe is available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="fdbe6-175">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="fdbe6-175">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="fdbe6-176">Inicialização</span><span class="sxs-lookup"><span data-stu-id="fdbe6-176">Bootstrapping</span></span>](bootstrapping.md)
</dt> <dt>

[<span data-ttu-id="fdbe6-177">Inicialização de download da Internet</span><span class="sxs-lookup"><span data-stu-id="fdbe6-177">Internet Download Bootstrapping</span></span>](internet-download-bootstrapping.md)
</dt> <dt>

[<span data-ttu-id="fdbe6-178">Versões, ferramentas e redistribuíveis liberados</span><span class="sxs-lookup"><span data-stu-id="fdbe6-178">Released Versions, Tools, and Redistributables</span></span>](released-versions-tools-and-redistributables.md)
</dt> <dt>

[<span data-ttu-id="fdbe6-179">Ferramentas de desenvolvimento Windows Installer</span><span class="sxs-lookup"><span data-stu-id="fdbe6-179">Windows Installer Development Tools</span></span>](windows-installer-development-tools.md)
</dt> </dl>

 

 




