---
description: 'Esta seção enumera uma lista de dicas, vinculadas à documentação principal do SDK do Windows Installer, para ajudar os desenvolvedores de aplicativos, os autores de instalação, os profissionais de ti e os desenvolvedores de infraestrutura a descobrir as práticas recomendadas para usar o Windows Installer:'
ms.assetid: ff48d995-fe6f-4d1b-898d-67574ed3c5b7
title: Práticas recomendadas de Windows Installer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0ffaf6aae83afbe510f2b1eefc447e34754296ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104011291"
---
# <a name="windows-installer-best-practices"></a><span data-ttu-id="5eca7-103">Práticas recomendadas de Windows Installer</span><span class="sxs-lookup"><span data-stu-id="5eca7-103">Windows Installer Best Practices</span></span>

<span data-ttu-id="5eca7-104">Esta seção enumera uma lista de dicas, vinculadas à documentação principal do SDK do Windows Installer, para ajudar os desenvolvedores de aplicativos, os autores de instalação, os profissionais de ti e os desenvolvedores de infraestrutura a descobrir as práticas recomendadas para usar o Windows Installer:</span><span class="sxs-lookup"><span data-stu-id="5eca7-104">This section enumerates a list of tips, linked to the main Windows Installer SDK documentation, to help Application Developers, Setup Authors, IT Professionals, and Infrastructure Developers discover best practices for using the Windows Installer:</span></span>

-   [<span data-ttu-id="5eca7-105">Atualize a versão do Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-105">Update the Windows Installer version.</span></span>](#update-the-windows-installer-version)
-   [<span data-ttu-id="5eca7-106">Atenda aos requisitos de certificação do logotipo do Windows.</span><span class="sxs-lookup"><span data-stu-id="5eca7-106">Meet the Windows Logo certification requirements.</span></span>](#meet-the-windows-logo-certification-requirements)
-   [<span data-ttu-id="5eca7-107">Prepare o pacote para localização.</span><span class="sxs-lookup"><span data-stu-id="5eca7-107">Prepare the package for localization.</span></span>](#prepare-the-package-for-localization)
-   [<span data-ttu-id="5eca7-108">Atualize suas ferramentas e documentação de desenvolvimento de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-108">Update your Windows Installer development tools and documentation.</span></span>](#update-your-windows-installer-development-tools-and-documentation)
-   [<span data-ttu-id="5eca7-109">Se você decidir reempacotar um aplicativo de instalação herdado, siga as boas práticas de reempacotamento.</span><span class="sxs-lookup"><span data-stu-id="5eca7-109">If you decide to repackage a legacy setup application, follow good repackaging practices.</span></span>](#if-you-decide-to-repackage-a-legacy-setup-application-follow-good-repackaging-practices)
-   [<span data-ttu-id="5eca7-110">Não tente substituir os recursos protegidos.</span><span class="sxs-lookup"><span data-stu-id="5eca7-110">Do not try to replace protected resources.</span></span>](#do-not-try-to-replace-protected-resources)
-   [<span data-ttu-id="5eca7-111">Não dependa de recursos não críticos.</span><span class="sxs-lookup"><span data-stu-id="5eca7-111">Do not depend upon non-critical resources.</span></span>](#do-not-depend-upon-non-critical-resources)
-   [<span data-ttu-id="5eca7-112">Use a API para recuperar Windows Installer informações de configuração.</span><span class="sxs-lookup"><span data-stu-id="5eca7-112">Use the API to retrieve Windows Installer configuration information.</span></span>](#use-the-api-to-retrieve-windows-installer-configuration-information)
-   [<span data-ttu-id="5eca7-113">Organize a instalação do seu aplicativo com base em componentes.</span><span class="sxs-lookup"><span data-stu-id="5eca7-113">Organize the installation of your application around components.</span></span>](#organize-the-installation-of-your-application-around-components)
-   [<span data-ttu-id="5eca7-114">Reduza o tamanho de pacotes de Windows Installer grandes.</span><span class="sxs-lookup"><span data-stu-id="5eca7-114">Reduce the size of large Windows Installer packages.</span></span>](#reduce-the-size-of-large-windows-installer-packages)
-   [<span data-ttu-id="5eca7-115">Se você usar ações personalizadas, siga as boas práticas de ação personalizadas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-115">If you use custom actions, follow good custom action practices.</span></span>](#if-you-use-custom-actions-follow-good-custom-action-practices)
-   [<span data-ttu-id="5eca7-116">Se você usar assemblies, siga as práticas de assembly adequadas</span><span class="sxs-lookup"><span data-stu-id="5eca7-116">If you use assemblies, follow good assembly practices</span></span>](#if-you-use-assemblies-follow-good-assembly-practices)
-   [<span data-ttu-id="5eca7-117">Não envie instalações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-117">Do not ship concurrent installations.</span></span>](#do-not-ship-concurrent-installations)
-   [<span data-ttu-id="5eca7-118">Mantenha os nomes de pacote e os códigos de pacote consistentes.</span><span class="sxs-lookup"><span data-stu-id="5eca7-118">Keep package names and package codes consistent.</span></span>](#keep-package-names-and-package-codes-consistent)
-   [<span data-ttu-id="5eca7-119">Não use as tabelas SelfReg e TypeLib.</span><span class="sxs-lookup"><span data-stu-id="5eca7-119">Do not use the SelfReg and TypeLib tables.</span></span>](#do-not-use-the-selfreg-and-typelib-tables)
-   [<span data-ttu-id="5eca7-120">Forneça a opção para instalar sem uma interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="5eca7-120">Provide the option to install without a user interface.</span></span>](#provide-the-option-to-install-without-a-user-interface)
-   [<span data-ttu-id="5eca7-121">Evite usar a política AlwaysInstallElevated.</span><span class="sxs-lookup"><span data-stu-id="5eca7-121">Avoid using the AlwaysInstallElevated policy.</span></span>](#avoid-using-the-alwaysinstallelevated-policy)
-   [<span data-ttu-id="5eca7-122">Habilite a política DisableMedia para limitar a instalação não autorizada.</span><span class="sxs-lookup"><span data-stu-id="5eca7-122">Enable the DisableMedia policy to limit unauthorized installation.</span></span>](#enable-the-disablemedia-policy-to-limit-unauthorized-installation)
-   [<span data-ttu-id="5eca7-123">Mantenha os arquivos de origem do pacote original seguros e disponíveis para os usuários.</span><span class="sxs-lookup"><span data-stu-id="5eca7-123">Keep the original package source files secure and available to users.</span></span>](#keep-the-original-package-source-files-secure-and-available-to-users)
-   [<span data-ttu-id="5eca7-124">Habilite o log detalhado no computador do usuário ao solucionar problemas de implantação.</span><span class="sxs-lookup"><span data-stu-id="5eca7-124">Enable verbose logging on user's computer when troubleshooting deployment.</span></span>](#enable-verbose-logging-on-users-computer-when-troubleshooting-deployment)
-   [<span data-ttu-id="5eca7-125">A desinstalação deixa o computador do usuário em um estado limpo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-125">Uninstallation leaves the user's computer in a clean state.</span></span>](#uninstallation-leaves-the-users-computer-in-a-clean-state)
-   [<span data-ttu-id="5eca7-126">Pacotes de teste para a implantação de instalação por usuário e por computador.</span><span class="sxs-lookup"><span data-stu-id="5eca7-126">Test packages for both per-user and per-machine installation deployment.</span></span>](#test-packages-for-both-per-user-and-per-machine-installation-deployment)
-   [<span data-ttu-id="5eca7-127">Planeje e teste uma estratégia de serviço antes de enviar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-127">Plan and test a servicing strategy before shipping the application.</span></span>](#plan-and-test-a-servicing-strategy-before-shipping-the-application)
-   [<span data-ttu-id="5eca7-128">Reduza a dependência de atualizações nas fontes originais.</span><span class="sxs-lookup"><span data-stu-id="5eca7-128">Reduce the dependency of updates upon the original sources.</span></span>](#reduce-the-dependency-of-updates-upon-the-original-sources)
-   [<span data-ttu-id="5eca7-129">Não distribua módulos de mesclagem sem serviço.</span><span class="sxs-lookup"><span data-stu-id="5eca7-129">Do not distribute unserviceable merge modules.</span></span>](#do-not-distribute-unserviceable-merge-modules)
-   [<span data-ttu-id="5eca7-130">Evite aplicar patches em instalações administrativas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-130">Avoid patching administrative installations.</span></span>](#avoid-patching-administrative-installations)
-   [<span data-ttu-id="5eca7-131">Registre as atualizações para executar com privilégios elevados.</span><span class="sxs-lookup"><span data-stu-id="5eca7-131">Register updates to run with elevated privilege.</span></span>](#register-updates-to-run-with-elevated-privilege)
-   [<span data-ttu-id="5eca7-132">Use a tabela MsiPatchSequence para sequenciar patches.</span><span class="sxs-lookup"><span data-stu-id="5eca7-132">Use the MsiPatchSequence Table to sequence patches.</span></span>](#use-the-msipatchsequence-table-to-sequence-patches)
-   [<span data-ttu-id="5eca7-133">Teste o pacote de instalação completamente.</span><span class="sxs-lookup"><span data-stu-id="5eca7-133">Test the installation package thoroughly.</span></span>](#test-the-installation-package-thoroughly)
-   [<span data-ttu-id="5eca7-134">Corrija todos os erros de validação antes de implantar um pacote de instalação novo ou revisado.</span><span class="sxs-lookup"><span data-stu-id="5eca7-134">Fix all validation errors before deploying a new or revised installation package.</span></span>](#fix-all-validation-errors-before-deploying-a-new-or-revised-installation-package)
-   [<span data-ttu-id="5eca7-135">Crie uma instalação segura.</span><span class="sxs-lookup"><span data-stu-id="5eca7-135">Author a secure installation.</span></span>](#author-a-secure-installation)
-   [<span data-ttu-id="5eca7-136">Usar PMSIHANDLE em vez de identificador</span><span class="sxs-lookup"><span data-stu-id="5eca7-136">Use PMSIHANDLE instead of HANDLE</span></span>](#use-pmsihandle-instead-of-handle)

## <a name="update-the-windows-installer-version"></a><span data-ttu-id="5eca7-137">Atualize a versão do Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-137">Update the Windows Installer version.</span></span>

-   <span data-ttu-id="5eca7-138">Use Windows Installer 5,0 no Windows Server 2008 R2 e no Windows 7.</span><span class="sxs-lookup"><span data-stu-id="5eca7-138">Use Windows Installer 5.0 on Windows Server 2008 R2 and Windows 7.</span></span> <span data-ttu-id="5eca7-139">Essa é a versão Windows Installer fornecida com o sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="5eca7-139">This is the Windows Installer version provided with the operating system.</span></span>
-   <span data-ttu-id="5eca7-140">Use Windows Installer 4,5 no Windows Server 2008, Windows Server 2003 com Service Pack 1 (SP1), Windows Vista com Service Pack 1 (SP1) ou Windows XP com Service Pack 2 (SP2).</span><span class="sxs-lookup"><span data-stu-id="5eca7-140">Use Windows Installer 4.5 on Windows Server 2008, Windows Server 2003 with Service Pack 1 (SP1), Windows Vista with Service Pack 1 (SP1), or Windows XP with Service Pack 2 (SP2).</span></span> <span data-ttu-id="5eca7-141">Para obter informações sobre como obter a versão mais recente do Windows Installer, consulte [Windows Installer redistribuíveis](windows-installer-redistributables.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-141">For information about obtaining the latest Windows Installer version, see [Windows Installer Redistributables](windows-installer-redistributables.md).</span></span>
-   <span data-ttu-id="5eca7-142">Use Windows Installer 3,1 no Windows 2000 com Service Pack 3 (SP3).</span><span class="sxs-lookup"><span data-stu-id="5eca7-142">Use Windows Installer 3.1 on Windows 2000 with Service Pack 3 (SP3).</span></span> <span data-ttu-id="5eca7-143">Windows Installer versão 3,1 tem recursos que facilitam o melhor serviço de aplicativos e aplicação de [patches](patching.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-143">Windows Installer version 3.1 has features that facilitate better application servicing and [patching](patching.md).</span></span>
-   <span data-ttu-id="5eca7-144">Muitos recursos importantes foram introduzidos com a versão 3,0 e estão listados na seção [sem suporte na versão 2,0 do Windows Installer](not-supported-in-windows-installer-version-2-0.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-144">Many important features were introduced with version 3.0 and are listed in the section [Not Supported in Windows Installer Version 2.0](not-supported-in-windows-installer-version-2-0.md).</span></span> <span data-ttu-id="5eca7-145">Os pacotes de instalação e as atualizações que foram criadas para o Windows Installer 2,0 podem ser instalados usando o Windows Installer 3,0 e posterior.</span><span class="sxs-lookup"><span data-stu-id="5eca7-145">Installation packages and updates that were created for Windows Installer 2.0 can be installed using Windows Installer 3.0 and later.</span></span> <span data-ttu-id="5eca7-146">Os pacotes de patches que contêm as novas tabelas usadas pelo Windows Installer 3,0 ainda podem ser aplicados usando versões anteriores do Windows Installer, mas sem a funcionalidade de patches do Windows Installer 3,0.</span><span class="sxs-lookup"><span data-stu-id="5eca7-146">Patch packages that contain the new tables used by Windows Installer 3.0 can still be applied using earlier versions of Windows Installer but without the Windows Installer 3.0 patching functionality.</span></span> <span data-ttu-id="5eca7-147">Também é possível criar patches que exigem explicitamente o Windows Installer 3,0 que não podem ser aplicados por versões anteriores do Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-147">It is also possible to author patches that explicitly require the Windows Installer 3.0 that cannot be applied by earlier versions of Windows Installer.</span></span> <span data-ttu-id="5eca7-148">Se um usuário não puder atualizar a versão do instalador, verifique se seu aplicativo ou atualização será compatível com uma atualização futura do Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-148">If a user is unable to update the installer version, ensure that your application or update will be compatible with a future update of the Windows Installer.</span></span>
-   <span data-ttu-id="5eca7-149">Para obter uma lista dos recursos de Windows Installer sem suporte nas versões anteriores do Windows Installer, consulte [o que há de novo no Windows Installer](what-s-new-in-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-149">For a list of the Windows Installer features not supported by earlier versions of the Windows installer see [What's New in Windows Installer](what-s-new-in-windows-installer.md).</span></span>

## <a name="meet-the-windows-logo-certification-requirements"></a><span data-ttu-id="5eca7-150">Atenda aos requisitos de certificação do logotipo do Windows.</span><span class="sxs-lookup"><span data-stu-id="5eca7-150">Meet the Windows Logo certification requirements.</span></span>

-   <span data-ttu-id="5eca7-151">Mesmo que você não pretenda enviar seu aplicativo para o programa de logotipo, seguindo as diretrizes de certificação de logotipo pode ajudar a melhorar o pacote de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-151">Even if you do not intend to submit your application to the logo program, following the logo certification guidelines can help make your Windows Installer package better.</span></span> <span data-ttu-id="5eca7-152">Para obter uma visão geral dos requisitos de logotipo e links para programas de certificação de logotipo específicos, consulte [requisitos de Windows Installer e logotipo](windows-installer-and-logo-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-152">For an overview of the logo requirements, and links to specific logo certification programs, see [Windows Installer and Logo Requirements](windows-installer-and-logo-requirements.md).</span></span>

## <a name="prepare-the-package-for-localization"></a><span data-ttu-id="5eca7-153">Prepare o pacote para localização.</span><span class="sxs-lookup"><span data-stu-id="5eca7-153">Prepare the package for localization.</span></span>

-   <span data-ttu-id="5eca7-154">É uma prática recomendada preparar-se para a localização futura ao criar o pacote de instalação original.</span><span class="sxs-lookup"><span data-stu-id="5eca7-154">It is a good practice to prepare for future localization when authoring the original installation package.</span></span> <span data-ttu-id="5eca7-155">Você pode seguir o procedimento de localização de pacote sugerido na [localização de um pacote de Windows Installer](localizing-a-windows-installer-package.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-155">You can follow the suggested package localization procedure in [Localizing a Windows Installer Package](localizing-a-windows-installer-package.md).</span></span>

## <a name="update-your-windows-installer-development-tools-and-documentation"></a><span data-ttu-id="5eca7-156">Atualize suas ferramentas e documentação de desenvolvimento de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-156">Update your Windows Installer development tools and documentation.</span></span>

-   <span data-ttu-id="5eca7-157">As [ferramentas de desenvolvimento Windows Installer](windows-installer-development-tools.md) não são redistribuíveis e você só deve usar as versões dessas ferramentas disponíveis na Microsoft.</span><span class="sxs-lookup"><span data-stu-id="5eca7-157">The [Windows Installer Development Tools](windows-installer-development-tools.md) are not redistributable, and you should only use the versions of these tools available from Microsoft.</span></span> <span data-ttu-id="5eca7-158">Eles estão disponíveis na [SDK do Windows componentes para Windows Installer desenvolvedores](platform-sdk-components-for-windows-installer-developers.md) no SDK (Software Development Kit) do Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="5eca7-158">These are available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md) in the Microsoft Windows Software Development Kit (SDK).</span></span>
-   <span data-ttu-id="5eca7-159">Vários fornecedores independentes de software oferecem ferramentas para criar ou modificar pacotes de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-159">Several independent software vendors offer tools to create or modify Windows Installer packages.</span></span> <span data-ttu-id="5eca7-160">Essas ferramentas podem fornecer um ambiente de criação de pacotes que pode ser mais fácil de usar do que as ferramentas fornecidas no SDK do Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-160">These tools can provide a package authoring environment that may be easier to use than the tools provided in the Windows Installer SDK.</span></span> <span data-ttu-id="5eca7-161">Você pode saber mais sobre essas ferramentas dos recursos de informações discutidos em [outras fontes de Windows Installer informações](other-sources-of-windows-installer-information.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-161">You can learn more about these tools from the information resources discussed in [Other Sources of Windows Installer Information](other-sources-of-windows-installer-information.md).</span></span>
-   <span data-ttu-id="5eca7-162">A capacidade de criar um pacote a partir de arquivos de texto pode ser mais intuitiva para alguns desenvolvedores.</span><span class="sxs-lookup"><span data-stu-id="5eca7-162">The capability to build a package from text files may be more intuitive for some developers.</span></span> <span data-ttu-id="5eca7-163">O conjunto de ferramentas WiX (Windows Installer XML) disponível no [sourceforge.net](https://sourceforge.net/projects/wix) cria pacotes de instalação do Windows do código-fonte XML.</span><span class="sxs-lookup"><span data-stu-id="5eca7-163">The Windows Installer XML (WiX) toolset available on [Sourceforge.net](https://sourceforge.net/projects/wix) builds Windows installation packages from XML source code.</span></span>
-   <span data-ttu-id="5eca7-164">A documentação no [SDK do Windows Installer](./windows-installer-portal.md) lançado na biblioteca MSDN online é atualizada com mais frequência.</span><span class="sxs-lookup"><span data-stu-id="5eca7-164">The documentation in the [Windows Installer SDK](./windows-installer-portal.md) released in the MSDN Online Library is updated the most frequently.</span></span>
-   <span data-ttu-id="5eca7-165">Use a versão recente do [Msizap.exe](msizap-exe.md) (versão 3.1.4000.2726 ou superior) que está disponível na [SDK do Windows componentes para Windows Installer desenvolvedores](platform-sdk-components-for-windows-installer-developers.md) para Windows Vista ou superior.</span><span class="sxs-lookup"><span data-stu-id="5eca7-165">Use the recent version of [Msizap.exe](msizap-exe.md) (version 3.1.4000.2726 or greater) that is available in the [Windows SDK Components for Windows Installer Developers](platform-sdk-components-for-windows-installer-developers.md) for Windows Vista or greater.</span></span> <span data-ttu-id="5eca7-166">Versões menores do Msizap.exe podem remover informações sobre todas as atualizações que foram aplicadas a outros aplicativos no computador do usuário.</span><span class="sxs-lookup"><span data-stu-id="5eca7-166">Lesser versions of Msizap.exe can remove information about all updates that have been applied to other applications on the user's computer.</span></span> <span data-ttu-id="5eca7-167">Se essas informações forem removidas, talvez esses outros aplicativos precisem ser removidos e reinstalados para receber atualizações adicionais.</span><span class="sxs-lookup"><span data-stu-id="5eca7-167">If this information is removed, these other applications may need to be removed and reinstalled to receive additional updates.</span></span>
-   <span data-ttu-id="5eca7-168">O editor de tabela de banco de dados [Orca.exe](orca-exe.md) é um editor de tabela de banco de dados para criar e editar Windows Installer pacotes e Mesclar módulos.</span><span class="sxs-lookup"><span data-stu-id="5eca7-168">The database table editor [Orca.exe](orca-exe.md) is a database table editor for creating and editing Windows Installer packages and merge modules.</span></span> <span data-ttu-id="5eca7-169">Ele tem uma interface de GUI básica, mas dá suporte à edição avançada de bancos de dados do Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-169">It has a basic GUI interface but supports advanced editing of Windows Installer databases.</span></span> <span data-ttu-id="5eca7-170">Mesmo que você use outro aplicativo como sua ferramenta de desenvolvimento principal, talvez você ache que usar Orca.exe é conveniente ao solucionar problemas e testar um pacote.</span><span class="sxs-lookup"><span data-stu-id="5eca7-170">Even if you use another application as your primary development tool, you may find using Orca.exe is convenient when troubleshooting and testing a package.</span></span>
-   <span data-ttu-id="5eca7-171">Consulte [outras fontes de Windows Installer informações](other-sources-of-windows-installer-information.md) para obter informações de Windows Installer atuais disponíveis em Blogs, bate-papos técnicos, grupos de notícias, artigos técnicos e sites.</span><span class="sxs-lookup"><span data-stu-id="5eca7-171">See [Other Sources of Windows Installer Information](other-sources-of-windows-installer-information.md) for current Windows Installer information available in blogs, technical chats, newsgroups, technical articles, and websites.</span></span>

## <a name="if-you-decide-to-repackage-a-legacy-setup-application-follow-good-repackaging-practices"></a><span data-ttu-id="5eca7-172">Se você decidir reempacotar um aplicativo de instalação herdado, siga as boas práticas de reempacotamento.</span><span class="sxs-lookup"><span data-stu-id="5eca7-172">If you decide to repackage a legacy setup application, follow good repackaging practices.</span></span>

<span data-ttu-id="5eca7-173">Muitos fornecedores de aplicativos fornecem pacotes Windows Installer nativos para a instalação ou seus produtos.</span><span class="sxs-lookup"><span data-stu-id="5eca7-173">Many application vendors provide native Windows Installer packages for the installation or their products.</span></span> <span data-ttu-id="5eca7-174">O software que converte um aplicativo de instalação herdado existente em um pacote Windows Installer é conhecido como uma ferramenta de reempacotamento.</span><span class="sxs-lookup"><span data-stu-id="5eca7-174">Software that converts an existing legacy setup application into a Windows Installer package is referred to as a repackaging tool.</span></span> <span data-ttu-id="5eca7-175">O White Paper [guia passo a passo para a criação de pacotes de Windows Installer e o reempacotamento de software para a Windows Installer](https://www.microsoft.com/technet/prodtechnol/windows2000serv/howto/winstall.mspx) descreve uma ferramenta de reempacotamento comercialmente disponível.</span><span class="sxs-lookup"><span data-stu-id="5eca7-175">The whitepaper [Step-by-Step Guide to Creating Windows Installer Packages and Repackaging Software for the Windows Installer](https://www.microsoft.com/technet/prodtechnol/windows2000serv/howto/winstall.mspx) describes a commercially available repackaging tool.</span></span> <span data-ttu-id="5eca7-176">Reempacotar um aplicativo de instalação existente não é a melhor prática de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="5eca7-176">Repackaging an existing setup application is not the best development practice.</span></span> <span data-ttu-id="5eca7-177">Os aplicativos que foram projetados desde o início para aproveitar os recursos de Windows Installer podem ser mais fáceis de instalar e atender aos usuários.</span><span class="sxs-lookup"><span data-stu-id="5eca7-177">Applications that have been designed from the start to take advantage of Windows Installer features can be easier for users to install and service.</span></span> <span data-ttu-id="5eca7-178">Se você decidir usar um software de reempacotamento, as práticas a seguir podem ajudá-lo a produzir um pacote de Windows Installer melhor.</span><span class="sxs-lookup"><span data-stu-id="5eca7-178">If you decide to use a repackaging software the following practices can help you produce a better Windows Installer package.</span></span>

-   <span data-ttu-id="5eca7-179">As ferramentas de reempacotamento convertem instalações herdadas em um pacote Windows Installer tirando uma imagem de um sistema de preparo antes e depois da instalação.</span><span class="sxs-lookup"><span data-stu-id="5eca7-179">Repackaging tools convert legacy installations into a Windows Installer package by taking a picture of a staging system before and after installation.</span></span> <span data-ttu-id="5eca7-180">Qualquer alteração no registro, alteração de arquivo ou configuração do sistema que ocorre durante o processo de captura é incluída na instalação do.</span><span class="sxs-lookup"><span data-stu-id="5eca7-180">Any registry changes, file changes, or system setting that occurs during the capture process is included in the installation.</span></span> <span data-ttu-id="5eca7-181">Configure o hardware e o software do computador usado para reempacotar a instalação o mais próximo possível do sistema do usuário pretendido.</span><span class="sxs-lookup"><span data-stu-id="5eca7-181">Configure the hardware and software of the computer used to repackage the installation as close as possible to the intended user's system.</span></span> <span data-ttu-id="5eca7-182">Crie um pacote separado para cada configuração de hardware diferente.</span><span class="sxs-lookup"><span data-stu-id="5eca7-182">Create a separate package for each different hardware configuration.</span></span> <span data-ttu-id="5eca7-183">Reempacotar usando um computador de preparo limpo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-183">Repackage using a clean staging computer.</span></span> <span data-ttu-id="5eca7-184">Remova todos os aplicativos desnecessários.</span><span class="sxs-lookup"><span data-stu-id="5eca7-184">Remove any unnecessary applications.</span></span> <span data-ttu-id="5eca7-185">Interrompa todos os processos desnecessários.</span><span class="sxs-lookup"><span data-stu-id="5eca7-185">Stop all unnecessary processes.</span></span> <span data-ttu-id="5eca7-186">Feche todos os serviços do sistema não essenciais.</span><span class="sxs-lookup"><span data-stu-id="5eca7-186">Close all non-essential system services.</span></span>
-   <span data-ttu-id="5eca7-187">Sempre faça uma cópia da instalação original antes de começar a trabalhar nela.</span><span class="sxs-lookup"><span data-stu-id="5eca7-187">Always make a copy of the original installation before starting to work on it.</span></span> <span data-ttu-id="5eca7-188">Sempre trabalhe na cópia.</span><span class="sxs-lookup"><span data-stu-id="5eca7-188">Always work on the copy.</span></span> <span data-ttu-id="5eca7-189">Nunca interrompa um reempacotador antes de concluir a compilação do pacote.</span><span class="sxs-lookup"><span data-stu-id="5eca7-189">Never stop a repackager before it finishes building the package.</span></span> <span data-ttu-id="5eca7-190">Se o reempacotador danificar o pacote, você ainda terá o original.</span><span class="sxs-lookup"><span data-stu-id="5eca7-190">If the repackager damages the package you will still have the original.</span></span>
-   <span data-ttu-id="5eca7-191">Não reempacote as atualizações de software da Microsoft em um pacote Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-191">Do not repackage Microsoft software updates into a Windows Installer package.</span></span> <span data-ttu-id="5eca7-192">A Microsoft lança atualizações de software, como Service Packs, como arquivos de extração automática que executam a instalação automaticamente.</span><span class="sxs-lookup"><span data-stu-id="5eca7-192">Microsoft releases software updates, such as service packs, as self-extracting files that automatically runs installation.</span></span> <span data-ttu-id="5eca7-193">Essas atualizações usam instaladores diferentes do Windows Installer para substituir recursos protegidos do Windows e não podem ser convertidas em um pacote Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-193">These updates use different installers than the Windows Installer to replace protected Windows resources and cannot be converted into a Windows Installer package.</span></span> <span data-ttu-id="5eca7-194">Para obter informações sobre como implantar Service Packs do Windows, consulte o guia de implantação do service pack no [Microsoft TechNet](https://technet.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="5eca7-194">For information about how to deploy Windows service packs, see the service pack's deployment guide on [Microsoft TechNet](https://technet.microsoft.com/).</span></span>
-   <span data-ttu-id="5eca7-195">Não use uma ferramenta de reempacotamento para converter um pacote de Windows Installer em um novo pacote.</span><span class="sxs-lookup"><span data-stu-id="5eca7-195">Do not use a repackaging tool to convert a Windows Installer package into a new package.</span></span> <span data-ttu-id="5eca7-196">O Windows Installer adiciona informações de configuração ao sistema, bem como recursos do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-196">The Windows Installer adds configuration information to the system as well as application resources.</span></span> <span data-ttu-id="5eca7-197">Quando uma ferramenta de reempacotamento compara o sistema antes e depois da instalação, o reempacotador interpreta incorretamente as informações de configuração como parte do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-197">When a repackaging tool compares the system before and after the installation, the repackager misinterprets the configuration information as part of the application.</span></span> <span data-ttu-id="5eca7-198">Isso geralmente danifica o aplicativo reempacotado.</span><span class="sxs-lookup"><span data-stu-id="5eca7-198">This usually damages the repackaged application.</span></span> <span data-ttu-id="5eca7-199">Em vez disso, use [transformações de personalização](a-customization-transform-example.md) para modificar um pacote de Windows Installer existente ou criar um novo pacote.</span><span class="sxs-lookup"><span data-stu-id="5eca7-199">Instead use [customization transforms](a-customization-transform-example.md) to modify an existing Windows Installer package, or make an new package.</span></span> <span data-ttu-id="5eca7-200">Você pode criar transformações de personalização usando a ferramenta de [Msitran.exe](msitran-exe.md) .</span><span class="sxs-lookup"><span data-stu-id="5eca7-200">You can create customization transforms using the [Msitran.exe](msitran-exe.md) tool.</span></span>
-   <span data-ttu-id="5eca7-201">Não use uma ferramenta de reempacotamento para consolidar vários pacotes Windows Installer em um único pacote.</span><span class="sxs-lookup"><span data-stu-id="5eca7-201">Do not use a repackaging tool to consolidate several Windows Installer packages into a single package.</span></span> <span data-ttu-id="5eca7-202">Em vez disso, você pode usar a ferramenta [Msistuff.exe](msistuff-exe.md) para configurar o executável de inicialização Setup.exe para instalar os pacotes um após o outro.</span><span class="sxs-lookup"><span data-stu-id="5eca7-202">Instead you can use the [Msistuff.exe](msistuff-exe.md) tool to configure the Setup.exe bootstrap executable to install the packages one after another.</span></span>
-   <span data-ttu-id="5eca7-203">Faça seu pacote de Windows Installer para que ele possa ser facilmente personalizado pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="5eca7-203">Make your Windows Installer package so that it can be easily customized by the customer.</span></span> <span data-ttu-id="5eca7-204">As variáveis globais usadas pelo Windows Installer durante uma instalação podem ser definidas usando [Propriedades](properties.md) públicas ou [transformações de personalização](a-customization-transform-example.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-204">Global variables used by the Windows Installer during an installation can be set using public [properties](properties.md) or [customization transforms](a-customization-transform-example.md).</span></span> <span data-ttu-id="5eca7-205">Forneça a documentação para o uso dessas propriedades e valores padrão práticos para todos os valores personalizáveis.</span><span class="sxs-lookup"><span data-stu-id="5eca7-205">Provide documentation for the use of those properties and practical default values for all customizable values.</span></span> <span data-ttu-id="5eca7-206">Para obter informações sobre como obter e definir propriedades, consulte [usando Propriedades](using-properties.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-206">For information about getting and setting properties see [Using Properties](using-properties.md).</span></span> <span data-ttu-id="5eca7-207">Para obter um exemplo de uma transformação de personalização, consulte [um exemplo de transformação personalização](a-customization-transform-example.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-207">For an example of a customization transform see [A Customization Transform Example](a-customization-transform-example.md).</span></span>

## <a name="do-not-try-to-replace-protected-resources"></a><span data-ttu-id="5eca7-208">Não tente substituir os recursos protegidos.</span><span class="sxs-lookup"><span data-stu-id="5eca7-208">Do not try to replace protected resources.</span></span>

<span data-ttu-id="5eca7-209">Windows Installer pacotes não devem tentar substituir os recursos protegidos durante a instalação ou atualização.</span><span class="sxs-lookup"><span data-stu-id="5eca7-209">Windows Installer packages should not attempt to replace protected resources during installation or update.</span></span> <span data-ttu-id="5eca7-210">O Windows Installer não remove ou substitui esses recursos porque o Windows impede a substituição de arquivos de sistema, pastas e chaves do registro essenciais.</span><span class="sxs-lookup"><span data-stu-id="5eca7-210">The Windows Installer does not remove or replace these resources because Windows prevents the replacement of essential system files, folders, and registry keys.</span></span> <span data-ttu-id="5eca7-211">A proteção desses recursos impede falhas de aplicativos e do sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="5eca7-211">Protecting these resources prevents application and operating system failures.</span></span>

-   <span data-ttu-id="5eca7-212">Quando executado no Windows Server 2008 ou no Windows Vista, o Windows Installer ignora a instalação de qualquer arquivo ou chave do Registro protegido pelo [proteção de recursos do Windows](../wfp/windows-resource-protection-portal.md) (WRP), o instalador insere um aviso no arquivo de log e continua com o restante da instalação sem erro.</span><span class="sxs-lookup"><span data-stu-id="5eca7-212">When running on Windows Server 2008 or Windows Vista, the Windows Installer skips the installation of any file or registry key that is protected by [Windows Resource Protection](../wfp/windows-resource-protection-portal.md) (WRP), the installer enters a warning in the log file, and continues with the remainder of the installation without an error.</span></span> <span data-ttu-id="5eca7-213">Para obter informações, consulte [usando Windows Installer e proteção de recursos do Windows](windows-resource-protection-on-windows-vista.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-213">For information, see [Using Windows Installer and Windows Resource Protection](windows-resource-protection-on-windows-vista.md).</span></span>
-   <span data-ttu-id="5eca7-214">WRP é o novo nome da WFP (proteção de arquivo do Windows).</span><span class="sxs-lookup"><span data-stu-id="5eca7-214">WRP is the new name for Windows File Protection (WFP).</span></span> <span data-ttu-id="5eca7-215">A WRP protege chaves e pastas do registro, bem como arquivos essenciais do sistema.</span><span class="sxs-lookup"><span data-stu-id="5eca7-215">WRP protects registry keys and folders as well as essential system files.</span></span> <span data-ttu-id="5eca7-216">No Windows Server 2003, Windows XP e Windows 2000, quando o Windows Installer encontrou um arquivo protegido por WFP, o instalador solicitaria que a WFP instalasse o arquivo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-216">In Windows Server 2003, Windows XP, and Windows 2000, when the Windows Installer encountered a WFP-protected file, the installer would request that WFP install the file.</span></span> <span data-ttu-id="5eca7-217">Para obter informações, consulte [usando Windows Installer e proteção de recursos do Windows](windows-resource-protection-on-windows-vista.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-217">For information, see [Using Windows Installer and Windows Resource Protection](windows-resource-protection-on-windows-vista.md).</span></span>

## <a name="do-not-depend-upon-non-critical-resources"></a><span data-ttu-id="5eca7-218">Não dependa de recursos não críticos.</span><span class="sxs-lookup"><span data-stu-id="5eca7-218">Do not depend upon non-critical resources.</span></span>

<span data-ttu-id="5eca7-219">Sua instalação ou atualização não deve depender da instalação de recursos não críticos pelos seguintes motivos.</span><span class="sxs-lookup"><span data-stu-id="5eca7-219">Your installation or update should not depend upon the installation of non-critical resources for the following reasons.</span></span>

-   <span data-ttu-id="5eca7-220">Ações personalizadas poderão falhar se dependerem de um componente que pertence a um recurso que o usuário anuncia em vez de instalar.</span><span class="sxs-lookup"><span data-stu-id="5eca7-220">Custom actions can fail if they depend upon a component belonging to a feature that the user advertises rather than installs.</span></span>
-   <span data-ttu-id="5eca7-221">Ações personalizadas sequenciadas antes da ação [InstallFinalize](installfinalize-action.md) podem falhar se dependerem de um componente que contém um assembly que está sendo instalado.</span><span class="sxs-lookup"><span data-stu-id="5eca7-221">Custom actions sequenced before the [InstallFinalize](installfinalize-action.md) action can fail if they depend on a component containing an assembly that is being installed.</span></span> <span data-ttu-id="5eca7-222">O Windows Installer não confirma assemblies para o GAC (cache de assembly global) até que a ação InstallFinalize seja concluída.</span><span class="sxs-lookup"><span data-stu-id="5eca7-222">The Windows Installer does not commit assemblies to the Global Assembly Cache (GAC) until the InstallFinalize action completes.</span></span>

## <a name="use-the-api-to-retrieve-windows-installer-configuration-information"></a><span data-ttu-id="5eca7-223">Use a API para recuperar Windows Installer informações de configuração.</span><span class="sxs-lookup"><span data-stu-id="5eca7-223">Use the API to retrieve Windows Installer configuration information.</span></span>

<span data-ttu-id="5eca7-224">A instalação do seu aplicativo ou atualização não deve depender do acesso direto às informações de configuração do Windows Installer salvas no seu computador.</span><span class="sxs-lookup"><span data-stu-id="5eca7-224">The installation of your application or update should not depend upon direct access to Windows Installer configuration information saved on your computer.</span></span> <span data-ttu-id="5eca7-225">Em vez disso, use a interface de programação de aplicativo Windows Installer para recuperar informações de configuração.</span><span class="sxs-lookup"><span data-stu-id="5eca7-225">Instead use the Windows Installer application programming interface to retrieve configuration information.</span></span> <span data-ttu-id="5eca7-226">O local e o formato das informações de configuração são gerenciados pelo serviço de Windows Installer e podem ser alterados.</span><span class="sxs-lookup"><span data-stu-id="5eca7-226">The location and format of configuration information is managed by the Windows Installer service and can change.</span></span>

-   <span data-ttu-id="5eca7-227">As funções de instalação e configuração da API Windows Installer são descritas na [referência da função do instalador](installer-function-reference.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-227">The Installation and Configuration Functions of the Windows Installer API are described in the [Installer Function Reference](installer-function-reference.md).</span></span>
-   <span data-ttu-id="5eca7-228">As [Propriedades de configuração](property-reference.md) são descritas na referência de propriedade.</span><span class="sxs-lookup"><span data-stu-id="5eca7-228">The [Configuration Properties](property-reference.md) are described in the Property Reference.</span></span>
-   <span data-ttu-id="5eca7-229">Os métodos e as propriedades de automação são descritos na [referência da interface de automação](automation-interface-reference.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-229">The automation methods and properties are described in the [Automation Interface Reference](automation-interface-reference.md).</span></span> <span data-ttu-id="5eca7-230">O script de exemplo WiLstPrd.vbs se conecta a um objeto do instalador e enumera os produtos registrados e as informações do produto.</span><span class="sxs-lookup"><span data-stu-id="5eca7-230">The sample script WiLstPrd.vbs connects to an Installer object and enumerates registered products and product information.</span></span> <span data-ttu-id="5eca7-231">Para obter informações, consulte [listar produtos, propriedades, recursos e componentes](list-products-properties-features-and-components.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-231">For information see [List Products, Properties, Features, and Components](list-products-properties-features-and-components.md).</span></span>

## <a name="organize-the-installation-of-your-application-around-components"></a><span data-ttu-id="5eca7-232">Organize a instalação do seu aplicativo com base em componentes.</span><span class="sxs-lookup"><span data-stu-id="5eca7-232">Organize the installation of your application around components.</span></span>

<span data-ttu-id="5eca7-233">O serviço de Windows Installer instala ou remove coleções de recursos conhecidos como [componentes](windows-installer-components.md)do.</span><span class="sxs-lookup"><span data-stu-id="5eca7-233">The Windows Installer service installs or removes collections of resources referred to as [components](windows-installer-components.md).</span></span> <span data-ttu-id="5eca7-234">Como os componentes são normalmente compartilhados, o autor de um pacote de instalação deve seguir as regras ao especificar os componentes de um recurso ou aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-234">Because components are commonly shared, the author of an installation package must follow rules when specifying the components of a feature or application.</span></span>

-   <span data-ttu-id="5eca7-235">Siga as regras de componente ao [organizar aplicativos em componentes](organizing-applications-into-components.md) para garantir que novos componentes ou novas versões de componentes possam ser instalados e removidos sem danificar outros aplicativos.</span><span class="sxs-lookup"><span data-stu-id="5eca7-235">Adhere to the component rules when [Organizing Applications into Components](organizing-applications-into-components.md) to ensure that new components, or new versions of components, can be installed and removed without damaging other applications.</span></span> <span data-ttu-id="5eca7-236">Você pode seguir o procedimento descrito em [definindo componentes do instalador](defining-installer-components.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-236">You can follow the procedure described in [Defining Installer Components](defining-installer-components.md).</span></span>
-   <span data-ttu-id="5eca7-237">O instalador rastreia todos os componentes pelo respectivo GUID de ID de componente especificado na [tabela de componentes](component-table.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-237">The installer tracks every component by the respective component ID GUID specified in the [Component table](component-table.md).</span></span> <span data-ttu-id="5eca7-238">É essencial para a operação do Windows Installer mecanismo de contagem de referência que o GUID de ID de componente está correto.</span><span class="sxs-lookup"><span data-stu-id="5eca7-238">It is essential for the operation of the Windows Installer reference-counting mechanism that the component ID GUID is correct.</span></span> <span data-ttu-id="5eca7-239">Siga as diretrizes em [alterando o código do componente](changing-the-component-code.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-239">Follow the guidelines in [Changing the Component Code](changing-the-component-code.md).</span></span>
-   <span data-ttu-id="5eca7-240">Se o pacote precisar interromper as regras de componente, lembre-se das possíveis conseqüências e certifique-se de que a instalação nunca instala esses componentes, onde eles podem danificar os componentes no sistema do usuário.</span><span class="sxs-lookup"><span data-stu-id="5eca7-240">If your package must break the component rules, be aware of the possible consequences and ensure that your installation never installs these components where they may damage components on the user's system.</span></span> <span data-ttu-id="5eca7-241">Para obter informações, consulte [o que acontece se as regras de componente forem interrompidas?](what-happens-if-the-component-rules-are-broken.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-241">For information see [What happens if the component rules are broken?](what-happens-if-the-component-rules-are-broken.md).</span></span>
-   <span data-ttu-id="5eca7-242">Lembre-se de como o Windows Installer aplica as [regras de controle de versão do arquivo](file-versioning-rules.md) ao [substituir os arquivos existentes](replacing-existing-files.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-242">Be aware how the Windows Installer applies the [File Versioning Rules](file-versioning-rules.md) when [Replacing Existing Files](replacing-existing-files.md).</span></span> <span data-ttu-id="5eca7-243">O Windows Installer primeiro determina se o arquivo de chave do componente já está instalado antes de tentar instalar qualquer um dos arquivos do componente.</span><span class="sxs-lookup"><span data-stu-id="5eca7-243">The Windows Installer first determines whether the component's key file is already installed before attempting to install any of the files of the component.</span></span> <span data-ttu-id="5eca7-244">Se o instalador encontrar um arquivo com o mesmo nome que o arquivo de chave do componente instalado no local de destino, ele compara a versão, a data e o idioma dos dois arquivos de chave e usa regras de controle de versão de arquivo para determinar se deseja instalar o componente fornecido pelo pacote.</span><span class="sxs-lookup"><span data-stu-id="5eca7-244">If the installer finds a file with the same name as the component's key file installed in the target location, it compares the version, date, and language of the two key files and uses file versioning rules to determine whether to install the component provided by the package.</span></span> <span data-ttu-id="5eca7-245">Se o instalador determinar que precisa substituir a base do componente no arquivo de chave, ele usará as regras de controle de versão de arquivo em cada arquivo instalado para determinar se deseja substituir o arquivo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-245">If the installer determines it needs to replace the component base upon the key file, then it uses the file versioning rules on each installed file to determine whether to replace the file.</span></span>

## <a name="reduce-the-size-of-large-windows-installer-packages"></a><span data-ttu-id="5eca7-246">Reduza o tamanho de pacotes de Windows Installer grandes.</span><span class="sxs-lookup"><span data-stu-id="5eca7-246">Reduce the size of large Windows Installer packages.</span></span>

<span data-ttu-id="5eca7-247">Pacotes muito grandes do Windows pegam recursos do sistema e podem ser difíceis de instalar para os usuários.</span><span class="sxs-lookup"><span data-stu-id="5eca7-247">Very large Windows Packages take system resources and can be difficult for users to install.</span></span> <span data-ttu-id="5eca7-248">É uma boa prática reduzir o tamanho de pacotes de Windows Installer muito grandes pelos métodos a seguir.</span><span class="sxs-lookup"><span data-stu-id="5eca7-248">It is good practice to reduce the size of very large Windows Installer Packages by the following methods.</span></span>

-   <span data-ttu-id="5eca7-249">Compacte os arquivos na instalação e armazene-os em um arquivo de gabinete (. cab).</span><span class="sxs-lookup"><span data-stu-id="5eca7-249">Compress the files in the installation and store them in a cabinet (.cab) file .</span></span> <span data-ttu-id="5eca7-250">O instalador permite que o arquivo. cab seja armazenado como um arquivo externo separado ou como um fluxo de dados no próprio pacote MSI.</span><span class="sxs-lookup"><span data-stu-id="5eca7-250">The Installer allows the .cab file to be stored as a separate external file, or as a data stream in the MSI package itself.</span></span> <span data-ttu-id="5eca7-251">Para obter informações [, consulte usando gabinetes e fontes compactadas](using-cabinets-and-compressed-sources.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-251">For information see [Using Cabinets and Compressed Sources](using-cabinets-and-compressed-sources.md).</span></span>
-   <span data-ttu-id="5eca7-252">Remova o espaço de armazenamento desperdiçado no arquivo. msi usando uma das opções discutidas em [reduzindo o tamanho de um arquivo. msi](reducing-the-size-of-an--msi-file.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-252">Remove wasted storage space in the .msi file using one of the options discussed in [Reducing the Size of an .msi File](reducing-the-size-of-an--msi-file.md).</span></span>
-   <span data-ttu-id="5eca7-253">Se seu pacote de Windows Installer contiver mais de 32767 arquivos, você deverá alterar o esquema do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="5eca7-253">If your Windows Installer package contains more than 32767 files, you must change the schema of the database.</span></span> <span data-ttu-id="5eca7-254">Para obter informações, consulte [criando um pacote grande](authoring-a-large-package.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-254">For information see [Authoring a Large Package](authoring-a-large-package.md).</span></span>

## <a name="if-you-use-custom-actions-follow-good-custom-action-practices"></a><span data-ttu-id="5eca7-255">Se você usar ações personalizadas, siga as boas práticas de ação personalizadas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-255">If you use custom actions, follow good custom action practices.</span></span>

<span data-ttu-id="5eca7-256">O Windows Installer tem muitas [ações padrão](standard-actions-reference.md) internas para a instalação e manutenção de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="5eca7-256">The Windows Installer has many built-in [standard actions](standard-actions-reference.md) for the installation and maintenance of applications.</span></span> <span data-ttu-id="5eca7-257">Os desenvolvedores devem tentar confiar nas ações padrão tanto quanto práticas, em vez de criar suas próprias [ações personalizadas](custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-257">Developers should attempt to rely upon the standard actions as much as practical, rather than create their own [custom actions](custom-actions.md).</span></span> <span data-ttu-id="5eca7-258">No entanto, há situações em que o desenvolvedor de um pacote de instalação descobre que é necessário gravar uma ação personalizada.</span><span class="sxs-lookup"><span data-stu-id="5eca7-258">However, there are situations where the developer of an installation package finds it necessary to write a custom action.</span></span>

-   <span data-ttu-id="5eca7-259">Siga as diretrizes para [usar ações personalizadas](using-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-259">Follow the guidelines for [Using Custom Actions](using-custom-actions.md).</span></span>
-   <span data-ttu-id="5eca7-260">Siga as [diretrizes para proteger as ações personalizadas](guidelines-for-securing-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-260">Follow the [Guidelines for Securing Custom Actions](guidelines-for-securing-custom-actions.md).</span></span> <span data-ttu-id="5eca7-261">As ações personalizadas que usam informações confidenciais não devem gravar essas informações no log.</span><span class="sxs-lookup"><span data-stu-id="5eca7-261">Custom actions that use sensitive information should not write this information into the log.</span></span> <span data-ttu-id="5eca7-262">Para obter informações, consulte [segurança de ação personalizada](custom-action-security.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-262">For information see [Custom Action Security](custom-action-security.md).</span></span>
-   <span data-ttu-id="5eca7-263">As ações personalizadas não devem tentar definir um ponto de entrada de restauração do sistema de dentro de uma ação personalizada.</span><span class="sxs-lookup"><span data-stu-id="5eca7-263">Custom Actions must not attempt to set a System Restore entry point from within a custom action.</span></span> <span data-ttu-id="5eca7-264">Para obter informações, consulte [definindo um ponto de restauração de uma ação personalizada](setting-a-restore-point-from-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-264">For information see [Setting a restore point from a Custom Action](setting-a-restore-point-from-a-custom-action.md).</span></span>
-   <span data-ttu-id="5eca7-265">Retornar mensagens de erro de ações personalizadas e gravá-las no log para facilitar a solução de problemas de ações personalizadas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-265">Return error messages from custom actions and write them to the log to facilitate troubleshooting custom actions.</span></span> <span data-ttu-id="5eca7-266">Para obter informações, consulte [ações de mensagens de erro personalizadas](error-message-custom-actions.md) e [retornando mensagens de erro de ações personalizadas](returning-error-messages-from-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-266">For information see [Error Message Custom Actions](error-message-custom-actions.md) and [Returning Error Messages from Custom Actions](returning-error-messages-from-custom-actions.md).</span></span>
-   <span data-ttu-id="5eca7-267">Não altere o estado do sistema de uma ação personalizada imediata.</span><span class="sxs-lookup"><span data-stu-id="5eca7-267">Do not change the system state from an immediate custom action.</span></span> <span data-ttu-id="5eca7-268">Ações personalizadas que alteram o sistema diretamente ou chamam outro serviço do sistema devem ser adiadas para a hora em que o script de instalação é executado.</span><span class="sxs-lookup"><span data-stu-id="5eca7-268">Custom actions that change the system directly or call another system service must be deferred to the time when the installation script is executed.</span></span> <span data-ttu-id="5eca7-269">Cada [ação personalizada de execução adiada](deferred-execution-custom-actions.md) que altera o estado do sistema deve ser precedida por uma [ação personalizada de reversão](rollback-custom-actions.md) para desfazer a alteração do estado do sistema em uma reversão de instalação.</span><span class="sxs-lookup"><span data-stu-id="5eca7-269">Every [deferred execution custom action](deferred-execution-custom-actions.md) that changes the system state must be preceded by a [rollback custom action](rollback-custom-actions.md) to undo the system state change on an installation rollback.</span></span> <span data-ttu-id="5eca7-270">Para obter informações, consulte [alterando o estado do sistema usando uma ação personalizada](changing-the-system-state-using-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-270">For information see [Changing the System State Using a Custom Action](changing-the-system-state-using-a-custom-action.md).</span></span>
-   <span data-ttu-id="5eca7-271">As ações personalizadas que executam operações complexas de instalação devem ser um [arquivo executável](executable-files.md) ou uma [biblioteca de vínculo dinâmico](dynamic-link-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-271">Custom actions that perform complex installation operations should be an [executable file](executable-files.md) or [dynamic-link library](dynamic-link-libraries.md).</span></span> <span data-ttu-id="5eca7-272">Limite o uso de ações personalizadas com base em [scripts](scripts.md) para operações de instalação simples.</span><span class="sxs-lookup"><span data-stu-id="5eca7-272">Limit the use of custom actions based on [scripts](scripts.md) to simple installation operations.</span></span>
-   <span data-ttu-id="5eca7-273">Faça os detalhes do que sua ação personalizada faz para o sistema facilmente detectável para administradores do sistema.</span><span class="sxs-lookup"><span data-stu-id="5eca7-273">Make the details of what your custom action does to the system easily discoverable to system administrators.</span></span> <span data-ttu-id="5eca7-274">Coloque os detalhes das entradas e dos arquivos de registro usados por sua ação personalizada em uma tabela personalizada e faça com que a ação personalizada seja lida desta tabela.</span><span class="sxs-lookup"><span data-stu-id="5eca7-274">Put the details of registry entries and files used by your custom action into a custom table and have the custom action read from this table.</span></span> <span data-ttu-id="5eca7-275">Isso é demonstrado pelo exemplo no [uso de uma ação personalizada para criar contas de usuário em um computador local](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-275">This is demonstrated by the example in [Using a Custom Action to Create User Accounts on a Local Computer](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span></span> <span data-ttu-id="5eca7-276">Para obter informações sobre como adicionar tabelas personalizadas a um banco de dados, consulte [trabalhando com consultas](working-with-queries.md) e [exemplos de consultas de banco de dados usando o SQL e o script](examples-of-database-queries-using-sql-and-script.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-276">For information on adding custom tables to a database, see [Working with Queries](working-with-queries.md) and [Examples of Database Queries Using SQL and Script](examples-of-database-queries-using-sql-and-script.md).</span></span>
-   <span data-ttu-id="5eca7-277">Uma ação personalizada não deve exibir uma caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-277">A custom actions should not display a dialog box.</span></span> <span data-ttu-id="5eca7-278">As ações personalizadas que exigem uma interface do usuário podem usar a função [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) em vez disso.</span><span class="sxs-lookup"><span data-stu-id="5eca7-278">Custom actions requiring a user interface can use the [**MsiProcessMessage**](/windows/desktop/api/Msiquery/nf-msiquery-msiprocessmessage) function instead.</span></span> <span data-ttu-id="5eca7-279">Consulte [enviando mensagens para Windows Installer usando o MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-279">See [Sending Messages to Windows Installer Using MsiProcessMessage](sending-messages-to-windows-installer-using-msiprocessmessage.md).</span></span>
-   <span data-ttu-id="5eca7-280">As ações personalizadas não devem usar nenhuma das funções listadas na página: [funções não para uso em ações personalizadas](functions-not-for-use-in-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-280">Custom actions must not use any of the functions listed on the page: [Functions Not for Use in Custom Actions](functions-not-for-use-in-custom-actions.md).</span></span>
-   <span data-ttu-id="5eca7-281">Se a instalação for destinada a ser executada em um servidor de terminal, teste se todas as suas ações personalizadas podem ser executadas em um servidor de terminal.</span><span class="sxs-lookup"><span data-stu-id="5eca7-281">If the installation is intended to run on a terminal server, test that all your custom actions are capable of running on a terminal server.</span></span> <span data-ttu-id="5eca7-282">Para obter mais informações, consulte Propriedade [**TerminalServer**](terminalserver.md) .</span><span class="sxs-lookup"><span data-stu-id="5eca7-282">For more information see [**TerminalServer**](terminalserver.md) property.</span></span>
-   <span data-ttu-id="5eca7-283">Para que uma ação personalizada seja executada quando um patch específico é desinstalado, a ação personalizada deve estar presente no aplicativo original ou estar em um patch para o produto que sempre é aplicado.</span><span class="sxs-lookup"><span data-stu-id="5eca7-283">To have a custom action run when a particular patch is uninstalled the custom action must either be present in the original application or be in a patch for the product that is always applied.</span></span> <span data-ttu-id="5eca7-284">Para obter mais informações, consulte [correção de ações personalizadas de desinstalação de patch](patch-uninstall-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-284">For more information see [Patch Uninstall Custom Actions](patch-uninstall-custom-actions.md).</span></span>
-   <span data-ttu-id="5eca7-285">As ações personalizadas não devem usar o nível de interface do usuário como uma condição para enviar mensagens de erro ao instalador, pois isso pode interferir no registro em log e mensagens externas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-285">Custom actions should not use the UI level as a condition for sending error messages to the installer because this can interfere with logging and external messages.</span></span> <span data-ttu-id="5eca7-286">Para obter informações, consulte [determinando o nível da interface do usuário de uma ação personalizada](determining-ui-level-from-a-custom-action.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-286">For information see [Determining UI Level from a Custom Action](determining-ui-level-from-a-custom-action.md).</span></span>
-   <span data-ttu-id="5eca7-287">Use instruções condicionais e [sintaxe de instrução condicional](conditional-statement-syntax.md) para garantir que o pacote execute corretamente as ações personalizadas, não execute ações personalizadas ou execute uma ação personalizada alternativa quando o pacote for desinstalado.</span><span class="sxs-lookup"><span data-stu-id="5eca7-287">Use conditional statements and [Conditional Statement Syntax](conditional-statement-syntax.md) to ensure that your package correctly runs custom actions, does not run a custom actions, or runs alternate custom action when the package is uninstalled.</span></span> <span data-ttu-id="5eca7-288">Teste se o pacote funciona conforme o esperado ao [desinstalar ações personalizadas](uninstalling-custom-actions.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-288">Test that the package works as expected when [uninstalling custom actions](uninstalling-custom-actions.md).</span></span> <span data-ttu-id="5eca7-289">Para obter informações, consulte [ações de condicionamento a serem executadas durante a remoção](conditioning-actions-to-run-during-removal.md)</span><span class="sxs-lookup"><span data-stu-id="5eca7-289">For information see [Conditioning Actions to Run During Removal](conditioning-actions-to-run-during-removal.md)</span></span>
-   <span data-ttu-id="5eca7-290">Se a instalação deve ser capaz de ser executada por usuários que não têm privilégios de administrador, teste para garantir que todas as ações personalizadas possam ser executadas com privilégios de não administrador.</span><span class="sxs-lookup"><span data-stu-id="5eca7-290">If the installation must be capable of being run by users that do not have administrator privileges, test to ensure that all the custom actions can be run with non-administrator privileges.</span></span> <span data-ttu-id="5eca7-291">Ações personalizadas exigem privilégios elevados para modificar partes do sistema que não são específicas do usuário.</span><span class="sxs-lookup"><span data-stu-id="5eca7-291">Custom actions require elevated privileges to modify parts of the system that are not user specific.</span></span> <span data-ttu-id="5eca7-292">O instalador pode executar ações personalizadas com privilégios elevados se um aplicativo gerenciado estiver sendo instalado ou se a política do sistema tiver sido especificada para privilégios elevados.</span><span class="sxs-lookup"><span data-stu-id="5eca7-292">The installer may run custom actions with elevated privileges if a managed application is being installed or if the system policy has been specified for elevated privileges.</span></span> <span data-ttu-id="5eca7-293">Todas as ações personalizadas que exigem privilégios elevados devem incluir a ação personalizada msidbCustomActionTypeInScript e msidbCustomActionTypeNoImpersonate [In-Script opções de execução](custom-action-in-script-execution-options.md) no tipo de ação personalizada.</span><span class="sxs-lookup"><span data-stu-id="5eca7-293">Any custom actions the require elevated privileges must include the msidbCustomActionTypeInScript and msidbCustomActionTypeNoImpersonate [Custom Action In-Script Execution Options](custom-action-in-script-execution-options.md) in the custom action type.</span></span> <span data-ttu-id="5eca7-294">Isso é demonstrado pelo exemplo no [uso de uma ação personalizada para criar contas de usuário em um computador local](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-294">This is demonstrated by the example in [Using a Custom Action to Create User Accounts on a Local Computer](using-a-custom-action-to-create-user-accounts-on-a-local-computer.md).</span></span>

## <a name="if-you-use-assemblies-follow-good-assembly-practices"></a><span data-ttu-id="5eca7-295">Se você usar assemblies, siga as práticas de assembly adequadas</span><span class="sxs-lookup"><span data-stu-id="5eca7-295">If you use assemblies, follow good assembly practices</span></span>

<span data-ttu-id="5eca7-296">Se o pacote usar [assemblies](assemblies.md)de software, siga as diretrizes para [adicionar assemblies a um pacote](adding-assemblies-to-a-package.md), [Atualizar assemblies](updating-assemblies.md)e [instalar e remover assemblies](installing-and-removing-assemblies.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-296">If your package uses software [assemblies](assemblies.md), follow the guidelines for [Adding Assemblies to a Package](adding-assemblies-to-a-package.md), [Updating Assemblies](updating-assemblies.md), and [Installing and Removing Assemblies](installing-and-removing-assemblies.md).</span></span>

## <a name="do-not-ship-concurrent-installations"></a><span data-ttu-id="5eca7-297">Não envie instalações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-297">Do not ship concurrent installations.</span></span>

<span data-ttu-id="5eca7-298">[Instalações simultâneas](concurrent-installations.md), também chamadas de instalações aninhadas, instalam outro pacote de Windows Installer durante uma instalação atualmente em execução.</span><span class="sxs-lookup"><span data-stu-id="5eca7-298">[Concurrent Installations](concurrent-installations.md), also called Nested Installations, install another Windows Installer package during a currently running installation.</span></span> <span data-ttu-id="5eca7-299">O uso de instalações simultâneas não é uma boa prática, pois elas são difíceis de atender aos clientes.</span><span class="sxs-lookup"><span data-stu-id="5eca7-299">The use of concurrent installations is not a good practice because they are difficult for customers to service.</span></span> <span data-ttu-id="5eca7-300">A aplicação de patches e a atualização podem não funcionar com instalações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-300">Patching and upgrading may not work with concurrent installations.</span></span> <span data-ttu-id="5eca7-301">A alternativa recomendada ao uso de instalações simultâneas é usar um aplicativo de instalação e um manipulador de interface de usuário externo para instalar vários pacotes de Windows Installer em sequência.</span><span class="sxs-lookup"><span data-stu-id="5eca7-301">The recommended alternative to using concurrent installations is to instead use a setup application and external UI handler to install several Windows Installer packages sequentially.</span></span>

<span data-ttu-id="5eca7-302">Para obter mais informações sobre como usar um manipulador de interface do usuário externo, consulte [monitorando uma instalação usando o MsiSetExternalUI](monitoring-an-installation-using-msisetexternalui.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-302">For more information about using an external UI handler see [Monitoring an Installation Using MsiSetExternalUI](monitoring-an-installation-using-msisetexternalui.md).</span></span> <span data-ttu-id="5eca7-303">Para obter mais informações sobre como usar um manipulador externo baseado em registro, consulte [monitorando uma instalação usando o MsiSetExternalUIRecord](monitoring-an-installation-using-msisetexternaluirecord.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-303">For more information about using a record-based external handler, see [Monitoring an Installation Using MsiSetExternalUIRecord](monitoring-an-installation-using-msisetexternaluirecord.md).</span></span>

<span data-ttu-id="5eca7-304">As instalações simultâneas, às vezes, são usadas em ambientes corporativos controlados para instalar aplicativos que não são destinados ao público.</span><span class="sxs-lookup"><span data-stu-id="5eca7-304">Concurrent installations are sometimes used in controlled corporate environments to install applications that are not intended for the public.</span></span> <span data-ttu-id="5eca7-305">Siga estas diretrizes se você decidir usar instalações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-305">Follow these guidelines if you decide to use concurrent installations.</span></span>

-   <span data-ttu-id="5eca7-306">Não use instalações simultâneas para instalar ou atualizar um produto de remessa.</span><span class="sxs-lookup"><span data-stu-id="5eca7-306">Do not use concurrent installations to install or update a shipping product.</span></span>
-   <span data-ttu-id="5eca7-307">Instalações simultâneas não devem compartilhar componentes.</span><span class="sxs-lookup"><span data-stu-id="5eca7-307">Concurrent installations should not share components.</span></span>
-   <span data-ttu-id="5eca7-308">Uma instalação administrativa não deve conter uma instalação simultânea.</span><span class="sxs-lookup"><span data-stu-id="5eca7-308">An administrative installation should not contain a concurrent installation.</span></span>
-   <span data-ttu-id="5eca7-309">As ProgressBars integradas não devem ser usadas com instalações simultâneas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-309">Integrated ProgressBars should not be used with concurrent installations.</span></span>
-   <span data-ttu-id="5eca7-310">Os recursos que devem ser anunciados não devem ser instalados por uma instalação simultânea.</span><span class="sxs-lookup"><span data-stu-id="5eca7-310">Resources that are to be advertised should not be installed by a concurrent installation.</span></span>
-   <span data-ttu-id="5eca7-311">Um pacote que executa uma instalação simultânea de um aplicativo também deve desinstalar o aplicativo simultâneo quando o produto pai é desinstalado.</span><span class="sxs-lookup"><span data-stu-id="5eca7-311">A package that performs a concurrent installation of an application should also uninstall the concurrent application when the parent product is uninstalled.</span></span> <span data-ttu-id="5eca7-312">Existe uma instalação aninhada no contexto do produto pai em Adicionar ou remover programas no painel de controle.</span><span class="sxs-lookup"><span data-stu-id="5eca7-312">A nested installation exists under the context of the parent product in the Add/Remove Programs in Control Panel.</span></span>

## <a name="keep-package-names-and-package-codes-consistent"></a><span data-ttu-id="5eca7-313">Mantenha os nomes de pacote e os códigos de pacote consistentes.</span><span class="sxs-lookup"><span data-stu-id="5eca7-313">Keep package names and package codes consistent.</span></span>

<span data-ttu-id="5eca7-314">O arquivo. msi pode receber qualquer nome que ajude os usuários a identificar o pacote, mas o nome não deve ser alterado sem alterar também o código do produto.</span><span class="sxs-lookup"><span data-stu-id="5eca7-314">The .msi file can be given any name that helps users identify the package, but the name should not be changed without also changing the product code.</span></span>

-   <span data-ttu-id="5eca7-315">Dê ao seu arquivo. msi um nome amigável que permita ao usuário identificar o conteúdo do pacote de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-315">Give your .msi file a user-friendly name that enables the user to identify the contents of the Windows Installer package.</span></span>
-   <span data-ttu-id="5eca7-316">O [código do produto](product-codes.md) é a identificação principal de um aplicativo e deve ser alterado sempre que houver uma atualização abrangente para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-316">The [product code](product-codes.md) is the principal identification of an application and must change whenever there is a comprehensive update to the application.</span></span> <span data-ttu-id="5eca7-317">Para obter informações, consulte [**ProductCode**](productcode.md) e [alterando o código do produto](changing-the-product-code.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-317">For information, see [**ProductCode**](productcode.md) and [Changing the Product Code](changing-the-product-code.md).</span></span> <span data-ttu-id="5eca7-318">Alterar o nome do arquivo. msi do aplicativo é considerado uma alteração abrangente e sempre requer uma alteração correspondente do código do produto para manter a consistência.</span><span class="sxs-lookup"><span data-stu-id="5eca7-318">Changing the name of the application's .msi file is considered a comprehensive change and always requires a corresponding change of the product code to maintain consistency.</span></span>
-   <span data-ttu-id="5eca7-319">O [código do pacote](package-codes.md) é o identificador principal usado pelo instalador para pesquisar e validar o pacote correto para uma determinada instalação.</span><span class="sxs-lookup"><span data-stu-id="5eca7-319">The [package code](package-codes.md) is the primary identifier used by the installer to search for and validate the correct package for a given installation.</span></span> <span data-ttu-id="5eca7-320">Dois arquivos. msi não idênticos já devem ter o mesmo código de pacote.</span><span class="sxs-lookup"><span data-stu-id="5eca7-320">No two nonidentical .msi files should ever have the same package code.</span></span> <span data-ttu-id="5eca7-321">Se um pacote for alterado sem alterar o código do pacote, o instalador não poderá usar o pacote mais recente se ambos ainda estiverem acessíveis ao instalador.</span><span class="sxs-lookup"><span data-stu-id="5eca7-321">If a package is changed without changing the package code, the installer may not use the newer package if both are still accessible to the installer.</span></span> <span data-ttu-id="5eca7-322">O código do pacote é armazenado na propriedade [**Resumo do número de revisão**](revision-number-summary.md) do fluxo de informações de [Resumo](summary-information-stream.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-322">The package code is stored in the [**Revision Number Summary**](revision-number-summary.md) Property of the [Summary Information Stream](summary-information-stream.md).</span></span>
-   <span data-ttu-id="5eca7-323">Observe que as letras no código do produto e nos [GUIDs](guid.md) de código do pacote devem ser maiúsculas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-323">Note that letters in product code and package code [GUIDs](guid.md) must all be uppercase.</span></span>

## <a name="do-not-use-the-selfreg-and-typelib-tables"></a><span data-ttu-id="5eca7-324">Não use as tabelas SelfReg e TypeLib.</span><span class="sxs-lookup"><span data-stu-id="5eca7-324">Do not use the SelfReg and TypeLib tables.</span></span>

-   <span data-ttu-id="5eca7-325">Os autores do pacote de instalação são altamente aconselhados em relação ao uso do auto-registro e da tabela [selfreg](selfreg-table.md) .</span><span class="sxs-lookup"><span data-stu-id="5eca7-325">Installation package authors are strongly advised against using self registration and the [SelfReg](selfreg-table.md) table.</span></span> <span data-ttu-id="5eca7-326">Em vez disso, eles devem registrar módulos criando uma ou mais das tabelas no [grupo tabelas do registro](registry-tables-group.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-326">Instead they should register modules by authoring one or more of the tables in the [Registry Tables Group](registry-tables-group.md).</span></span> <span data-ttu-id="5eca7-327">Muitos dos benefícios da Windows Installer são perdidos com o auto-registro porque as rotinas de Autoregistro tendem a ocultar informações de configuração críticas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-327">Many of the benefits of the Windows Installer are lost with self registration because self-registration routines tend to hide critical configuration information.</span></span> <span data-ttu-id="5eca7-328">Para obter uma lista dos motivos para evitar o auto-registro, consulte a [tabela selfreg](selfreg-table.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-328">For a list of the reasons for avoiding self registration see [SelfReg table](selfreg-table.md).</span></span>
-   <span data-ttu-id="5eca7-329">Os autores do pacote de instalação são altamente aconselhados em relação ao uso da tabela [TypeLib](typelib-table.md) .</span><span class="sxs-lookup"><span data-stu-id="5eca7-329">Installation package authors are strongly advised against using the [TypeLib](typelib-table.md) table.</span></span> <span data-ttu-id="5eca7-330">Em vez de usar a tabela TypeLib, registre bibliotecas de tipos usando a tabela [do registro](registry-table.md) .</span><span class="sxs-lookup"><span data-stu-id="5eca7-330">Instead of using the TypeLib table, register type libraries by using [Registry](registry-table.md) table.</span></span> <span data-ttu-id="5eca7-331">Se uma instalação que usa a tabela TypeLib falhar e precisar ser revertida, a reversão poderá não restaurar o computador para o mesmo estado que existia antes da reversão.</span><span class="sxs-lookup"><span data-stu-id="5eca7-331">If an installation using the TypeLib table fails and must be rolled back, the rollback may not restore the computer to the same state that existed prior to the rollback.</span></span>

## <a name="provide-the-option-to-install-without-a-user-interface"></a><span data-ttu-id="5eca7-332">Forneça a opção para instalar sem uma interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="5eca7-332">Provide the option to install without a user interface.</span></span>

<span data-ttu-id="5eca7-333">Os administradores geralmente preferem implantar aplicativos dentro de uma empresa sem exigir interação do usuário.</span><span class="sxs-lookup"><span data-stu-id="5eca7-333">Administrators often prefer to deploy applications within a corporation without requiring user interaction.</span></span> <span data-ttu-id="5eca7-334">É uma boa prática habilitar seu aplicativo para fornecer a opção de ser instalada com o [nível de interface do usuário](user-interface-levels.md) de nenhum.</span><span class="sxs-lookup"><span data-stu-id="5eca7-334">It is good practice to enable your application to provide the option of being installed with the [user interface level](user-interface-levels.md) of None.</span></span>

-   <span data-ttu-id="5eca7-335">Use [Propriedades públicas](public-properties.md) para obter informações de configuração.</span><span class="sxs-lookup"><span data-stu-id="5eca7-335">Use [public properties](public-properties.md) for configuration information.</span></span> <span data-ttu-id="5eca7-336">Os administradores podem fornecer essas informações na linha de comando.</span><span class="sxs-lookup"><span data-stu-id="5eca7-336">Administrators can provide this information on the command-line.</span></span>
-   <span data-ttu-id="5eca7-337">Não exija que a instalação dependa das informações coletadas da interação do usuário com caixas de diálogo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-337">Do not require that the installation depend upon information gathered from user interaction with dialog boxes.</span></span> <span data-ttu-id="5eca7-338">Essas informações não estão disponíveis durante uma instalação silenciosa.</span><span class="sxs-lookup"><span data-stu-id="5eca7-338">This information is not available during a silent installation.</span></span>
-   <span data-ttu-id="5eca7-339">Não reinicie automaticamente o computador do usuário durante uma instalação silenciosa.</span><span class="sxs-lookup"><span data-stu-id="5eca7-339">Do not automatically restart the user's computer during a silent installation.</span></span>
-   <span data-ttu-id="5eca7-340">Os administradores podem definir o [nível de interface do usuário](user-interface-levels.md) ao instalar o usando a opção de linha de [comando](command-line-options.md) "/q".</span><span class="sxs-lookup"><span data-stu-id="5eca7-340">Administrators can set the [user interface level](user-interface-levels.md) when installing by using the [command line option](command-line-options.md) "/q".</span></span> <span data-ttu-id="5eca7-341">O nível da interface do usuário também pode ser definido programaticamente com uma chamada para [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui).</span><span class="sxs-lookup"><span data-stu-id="5eca7-341">The user interface level can also be set programmatically with a call to [**MsiSetInternalUI**](/windows/desktop/api/Msi/nf-msi-msisetinternalui).</span></span>

## <a name="avoid-using-the-alwaysinstallelevated-policy"></a><span data-ttu-id="5eca7-342">Evite usar a política AlwaysInstallElevated.</span><span class="sxs-lookup"><span data-stu-id="5eca7-342">Avoid using the AlwaysInstallElevated policy.</span></span>

<span data-ttu-id="5eca7-343">Se a política [AlwaysInstallElevated](alwaysinstallelevated.md) não estiver definida, os aplicativos não distribuídos pelo administrador serão instalados usando os privilégios do usuário e somente os aplicativos gerenciados terão privilégios elevados.</span><span class="sxs-lookup"><span data-stu-id="5eca7-343">If the [AlwaysInstallElevated](alwaysinstallelevated.md) policy is not set, applications not distributed by the administrator are installed using the user's privileges and only managed applications get elevated privileges.</span></span> <span data-ttu-id="5eca7-344">Definir essa política direciona Windows Installer para usar permissões do sistema ao instalar o aplicativo no sistema.</span><span class="sxs-lookup"><span data-stu-id="5eca7-344">Setting this policy directs Windows Installer to use system permissions when it installs the application on the system.</span></span> <span data-ttu-id="5eca7-345">Esse método pode abrir um computador para um risco de segurança, porque quando essa política é definida, um usuário não administrador pode executar instalações com privilégios [*elevados*](e-gly.md) e acessar locais seguros no computador.</span><span class="sxs-lookup"><span data-stu-id="5eca7-345">This method can open a computer to a security risk, because when this policy is set, a non-administrator user can run installations with [*elevated*](e-gly.md) privileges and access secure locations on the computer.</span></span> <span data-ttu-id="5eca7-346">É uma boa prática usar outro método do que a política de AlwaysInstallElevated ao [instalar um pacote com privilégios elevados para um não administrador](installing-a-package-with-elevated-privileges-for-a-non-admin.md) ou [aplicação de patches Per-User aplicativos gerenciados](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-346">It is a good practice to use another method than the AlwaysInstallElevated policy when [Installing a Package with Elevated Privileges for a Non-Admin](installing-a-package-with-elevated-privileges-for-a-non-admin.md) or [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>

## <a name="enable-the-disablemedia-policy-to-limit-unauthorized-installation"></a><span data-ttu-id="5eca7-347">Habilite a política DisableMedia para limitar a instalação não autorizada.</span><span class="sxs-lookup"><span data-stu-id="5eca7-347">Enable the DisableMedia policy to limit unauthorized installation.</span></span>

<span data-ttu-id="5eca7-348">A política [DisableMedia](disablemedia.md) pode impedir a instalação não autorizada de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="5eca7-348">The [DisableMedia](disablemedia.md) policy can prevent unauthorized installation of applications.</span></span> <span data-ttu-id="5eca7-349">Quando essa política está habilitada, os usuários e administradores que executam uma instalação de manutenção de um produto são impedidos de usar a caixa de diálogo de procura para procurar fontes de mídia, como CD-ROM, para as fontes de outros produtos instaláveis.</span><span class="sxs-lookup"><span data-stu-id="5eca7-349">When this policy is enabled, users and administrators running a maintenance installation of one product are prevented from using the Browse Dialog to browse media sources, such as CD-ROM, for the sources of other installable products.</span></span> <span data-ttu-id="5eca7-350">Procurar outros produtos é impedido, independentemente de a instalação ser feita com privilégios elevados.</span><span class="sxs-lookup"><span data-stu-id="5eca7-350">Browsing for other products is prevented regardless of whether the installation is done with elevated privileges.</span></span> <span data-ttu-id="5eca7-351">Ainda é possível que o usuário reinstale o produto da mídia se o usuário tiver uma origem de mídia rotulada corretamente.</span><span class="sxs-lookup"><span data-stu-id="5eca7-351">It is still possible for the user to reinstall the product from media if the user has a correctly labeled media source.</span></span>

## <a name="keep-the-original-package-source-files-secure-and-available-to-users"></a><span data-ttu-id="5eca7-352">Mantenha os arquivos de origem do pacote original seguros e disponíveis para os usuários.</span><span class="sxs-lookup"><span data-stu-id="5eca7-352">Keep the original package source files secure and available to users.</span></span>

<span data-ttu-id="5eca7-353">Em alguns casos, a origem original do pacote de Windows Installer pode ser necessária para instalar-sob demanda, reparar ou atualizar um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-353">In some cases the original source of the Windows Installer package may be needed to install-on-demand, repair, or update an application.</span></span> <span data-ttu-id="5eca7-354">Se o instalador não conseguir localizar uma fonte disponível, será solicitado que o usuário forneça a mídia ou vá para um local de rede que contenha as fontes necessárias.</span><span class="sxs-lookup"><span data-stu-id="5eca7-354">If the installer is unable to locate an available source, the user is asked to provide media or to go to a network location containing the needed sources.</span></span> <span data-ttu-id="5eca7-355">É uma boa prática garantir que o instalador tenha as fontes necessárias sem precisar solicitar o usuário.</span><span class="sxs-lookup"><span data-stu-id="5eca7-355">It is a good practice to ensure that the installer has the sources it needs without having to prompt the user.</span></span>

-   <span data-ttu-id="5eca7-356">Use [assinaturas digitais e arquivos de gabinete externo](digital-signatures-and-external-cabinet-files.md) para garantir que as origens de origem usadas pelo instalador sejam seguras.</span><span class="sxs-lookup"><span data-stu-id="5eca7-356">Use [Digital Signatures and External Cabinet Files](digital-signatures-and-external-cabinet-files.md) to ensure that the origial sources being used by the installer are secure.</span></span> <span data-ttu-id="5eca7-357">Uma imagem de origem não compactada armazenada em um local público não é segura.</span><span class="sxs-lookup"><span data-stu-id="5eca7-357">An uncompressed source image stored in an public location is not secure.</span></span>
-   <span data-ttu-id="5eca7-358">Inclua uma lista completa de caminhos de origem de rede ou URL para o pacote de instalação do aplicativo na propriedade [**SourceList**](sourcelist.md) .</span><span class="sxs-lookup"><span data-stu-id="5eca7-358">Include a complete list of network or URL source paths to the application's installation package in the [**SOURCELIST**](sourcelist.md) property.</span></span>
-   <span data-ttu-id="5eca7-359">Use um compartilhamento de Sistema de Arquivos Distribuído (DFS) para o caminho de origem.</span><span class="sxs-lookup"><span data-stu-id="5eca7-359">Use a Distributed File System (DFS) share for the source path.</span></span>
-   <span data-ttu-id="5eca7-360">Use a API Windows Installer para recuperar e modificar informações de lista de origem para aplicativos e patches de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-360">Use the Windows Installer API to retrieve and modify source list information for Windows Installer applications and patches.</span></span> <span data-ttu-id="5eca7-361">Para obter informações, consulte [Gerenciando fontes de instalação](managing-installation-sources.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-361">For information see [Managing Installation Sources](managing-installation-sources.md).</span></span>
-   <span data-ttu-id="5eca7-362">Use os métodos e as propriedades do [**objeto do instalador**](installer-object.md), [**objeto de produto**](product-object.md)e [**objeto de patch**](patch-object.md) para recuperar e modificar informações de lista de origem para aplicativos Windows Installer e patches.</span><span class="sxs-lookup"><span data-stu-id="5eca7-362">Use the methods and properties of the [**Installer Object**](installer-object.md), [**Product Object**](product-object.md), and [**Patch Object**](patch-object.md) to retrieve and modify source list information for Windows Installer applications and patches.</span></span>
-   <span data-ttu-id="5eca7-363">Siga os pontos listados em [impedindo que um patch requeira acesso aos pontos de origem de instalação originais](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md) para minimizar a possibilidade de o patch precisar de acesso às fontes originais.</span><span class="sxs-lookup"><span data-stu-id="5eca7-363">Adhere to points listed in [Preventing a Patch from Requiring Access to the Original Installation Source](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md) points to minimize the possibility that your patch will require access to the original sources.</span></span>
-   <span data-ttu-id="5eca7-364">Armazene os arquivos de origem do pacote em um local que não seja a pasta temporária do sistema.</span><span class="sxs-lookup"><span data-stu-id="5eca7-364">Store the package source files in a location that is not the system's temporary folder.</span></span> <span data-ttu-id="5eca7-365">Windows Installer arquivos de origem armazenados na pasta temporária podem ficar indisponíveis para os usuários.</span><span class="sxs-lookup"><span data-stu-id="5eca7-365">Windows Installer source files stored in the temporary folder can become unavailable to users.</span></span>

## <a name="enable-verbose-logging-on-users-computer-when-troubleshooting-deployment"></a><span data-ttu-id="5eca7-366">Habilite o log detalhado no computador do usuário ao solucionar problemas de implantação.</span><span class="sxs-lookup"><span data-stu-id="5eca7-366">Enable verbose logging on user's computer when troubleshooting deployment.</span></span>

<span data-ttu-id="5eca7-367">[Windows Installer log](windows-installer-logging.md) inclui uma opção de log detalhado que pode ser habilitada no computador de um usuário.</span><span class="sxs-lookup"><span data-stu-id="5eca7-367">[Windows Installer Logging](windows-installer-logging.md) includes a verbose logging option that can be enabled on a user's computer.</span></span> <span data-ttu-id="5eca7-368">As informações em um log detalhado podem ser úteis ao tentar solucionar problemas de implantação de pacote Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-368">The information in a verbose log can helpful when trying to troubleshoot Windows Installer package deployment.</span></span>

-   <span data-ttu-id="5eca7-369">Você pode habilitar o log detalhado no computador do usuário usando [Opções de linha de comando](command-line-options.md), a propriedade [**MsiLogging**](msilogging.md) , a política de [registro em log](logging.md), o [**MsiEnableLog**](/windows/desktop/api/Msi/nf-msi-msienableloga)e o método [**EnableLog**](installer-enablelog.md) .</span><span class="sxs-lookup"><span data-stu-id="5eca7-369">You can enable verbose logging on the user's computer by using [Command Line Options](command-line-options.md), the [**MsiLogging**](msilogging.md) property, [Logging policy](logging.md), [**MsiEnableLog**](/windows/desktop/api/Msi/nf-msi-msienableloga), and [**EnableLog**](installer-enablelog.md) method.</span></span>
-   <span data-ttu-id="5eca7-370">Um recurso muito útil para interpretar Windows Installer arquivos de log é [Wilogutl.exe](wilogutl-exe.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-370">A very useful resource for interpreting Windows Installer log files is [Wilogutl.exe](wilogutl-exe.md).</span></span> <span data-ttu-id="5eca7-371">Essa ferramenta ajuda a análise de arquivos de log e exibe soluções sugeridas para erros encontrados em um arquivo de log.</span><span class="sxs-lookup"><span data-stu-id="5eca7-371">This tool assists the analysis of log files and displays suggested solutions to errors that are found in a log file.</span></span>
-   <span data-ttu-id="5eca7-372">Para obter mais informações sobre como interpretar Windows Installer arquivos de log, consulte a white paper disponível no site do TechNet: [Windows Installer: benefícios e implementação para administradores do sistema](https://www.microsoft.com/technet/prodtechnol/windows2000serv/maintain/featusability/winmsi.mspx).</span><span class="sxs-lookup"><span data-stu-id="5eca7-372">For more information about interpreting Windows Installer log files, see the white paper available on the TechNet site: [Windows Installer: Benefits and Implementation for System Administrators](https://www.microsoft.com/technet/prodtechnol/windows2000serv/maintain/featusability/winmsi.mspx).</span></span>
-   <span data-ttu-id="5eca7-373">A opção de log detalhado deve ser usada somente para fins de solução de problemas e não deve ser deixada porque pode ter efeitos adversos no desempenho do sistema e no espaço em disco.</span><span class="sxs-lookup"><span data-stu-id="5eca7-373">The verbose logging option should be used only for troubleshooting purposes and should not be left on because it can have adverse effects on system performance and disk space.</span></span> <span data-ttu-id="5eca7-374">Cada vez que você usa a ferramenta Adicionar/remover programas no painel de controle, um novo arquivo é criado.</span><span class="sxs-lookup"><span data-stu-id="5eca7-374">Each time you use the Add/Remove Programs tool in Control Panel, a new file is created.</span></span>

## <a name="uninstallation-leaves-the-users-computer-in-a-clean-state"></a><span data-ttu-id="5eca7-375">A desinstalação deixa o computador do usuário em um estado limpo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-375">Uninstallation leaves the user's computer in a clean state.</span></span>

<span data-ttu-id="5eca7-376">A remoção do aplicativo é tão importante quanto a instalação.</span><span class="sxs-lookup"><span data-stu-id="5eca7-376">Application removal is as important as installation.</span></span> <span data-ttu-id="5eca7-377">Quando um pacote de Windows Installer é desinstalado, ele não deve deixar nenhuma parte inútil dele atrás no computador do usuário.</span><span class="sxs-lookup"><span data-stu-id="5eca7-377">When a Windows Installer package is uninstalled it should leave no useless parts of itself behind on the user's computer.</span></span>

-   <span data-ttu-id="5eca7-378">Se um arquivo que deveria ter sido removido do computador do usuário permanecer instalado após a execução de uma desinstalação, talvez o instalador não esteja removendo o componente que contém o arquivo por um ou mais dos motivos descritos em [removendo arquivos perdidos](removing-stranded-files.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-378">If a file that should have been removed from the user's computer remains installed after running an uninstall, the installer may not be removing the component containing the file for one or more of the reasons described in [Removing Stranded Files](removing-stranded-files.md).</span></span>
-   <span data-ttu-id="5eca7-379">Se um aplicativo precisar ser registrado, crie o pacote para remover informações do registro quando o aplicativo for desinstalado.</span><span class="sxs-lookup"><span data-stu-id="5eca7-379">If an application must be registered, author the package to remove registry information when the application is uninstalled.</span></span> <span data-ttu-id="5eca7-380">Para obter informações, consulte [adicionando ou removendo chaves do registro na instalação ou remoção de componentes](adding-or-removing-registry-keys-on-the-installation-or-removal-of-components.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-380">For information see [Adding or Removing Registry Keys on the Installation or Removal of Components](adding-or-removing-registry-keys-on-the-installation-or-removal-of-components.md).</span></span> <span data-ttu-id="5eca7-381">Se um aplicativo não estiver registrado, o aplicativo não estará listado no recurso Adicionar ou remover programas no painel de controle e não poderá ser gerenciado usando o Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-381">If an application is not registered, the application is not listed in the Add or Remove Programs feature in Control Panel and cannot be managed by using the Windows Installer.</span></span>
-   <span data-ttu-id="5eca7-382">Para ocultar um aplicativo do recurso Adicionar ou remover programas no painel de controle e ainda poder usar o Windows Installer para gerenciar o aplicativo, siga as diretrizes descritas em [adicionando e removendo um aplicativo e não deixando nenhum rastreamento no registro](adding-and-removing-an-application-and-leaving-no-trace-in-the-registry.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-382">To hide an application from the Add or Remove Programs feature in Control Panel and still be able to use the Windows Installer to manage the application, follow the guidelines described in [Adding and Removing an Application and Leaving No Trace in the Registry](adding-and-removing-an-application-and-leaving-no-trace-in-the-registry.md).</span></span>
-   <span data-ttu-id="5eca7-383">As ações personalizadas devem ser condicionadas para serem executadas ou não, conforme necessário, após a desinstalação.</span><span class="sxs-lookup"><span data-stu-id="5eca7-383">Custom actions should be conditioned to run or not as needed upon uninstallation.</span></span> <span data-ttu-id="5eca7-384">Diferentes ações personalizadas talvez precisem ser executadas na instalação e na desinstalação.</span><span class="sxs-lookup"><span data-stu-id="5eca7-384">Different custom actions may need to run on install and uninstall.</span></span>
-   <span data-ttu-id="5eca7-385">As informações de personalização específicas do usuário podem ser armazenadas em um arquivo de texto no computador.</span><span class="sxs-lookup"><span data-stu-id="5eca7-385">User-specific customization information can be stored in a text file on the computer.</span></span> <span data-ttu-id="5eca7-386">Isso tem a vantagem de que o arquivo pode ser removido quando o aplicativo é desinstalado, mesmo que o usuário dessa personalização não esteja conectado no momento.</span><span class="sxs-lookup"><span data-stu-id="5eca7-386">This has the advantage that the file can be removed when the application is uninstalled, even if the user of this customization is not currently logged on.</span></span>

## <a name="test-packages-for-both-per-user-and-per-machine-installation-deployment"></a><span data-ttu-id="5eca7-387">Pacotes de teste para a implantação de instalação por usuário e por computador.</span><span class="sxs-lookup"><span data-stu-id="5eca7-387">Test packages for both per-user and per-machine installation deployment.</span></span>

<span data-ttu-id="5eca7-388">É uma boa prática permitir que os clientes decidam se deseja implantar um pacote para instalação no [contexto de instalação](installation-context.md)por computador ou por usuário.</span><span class="sxs-lookup"><span data-stu-id="5eca7-388">It is good practice to enable customers to decide whether to deploy a package for installation in either the per-machine or per-user [installation context](installation-context.md).</span></span>

-   <span data-ttu-id="5eca7-389">Considere se o aplicativo deve estar disponível somente para usuários específicos ou para todos os usuários do computador durante o processo de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="5eca7-389">Consider whether the application should be available to only particular users or all users of the computer during the development process.</span></span>
-   <span data-ttu-id="5eca7-390">Teste se o pacote funciona corretamente para a instalação por usuário e contextos de instalação por máquina.</span><span class="sxs-lookup"><span data-stu-id="5eca7-390">Test that the package works correctly for both the per-user installation and per-machine installation contexts.</span></span>
-   <span data-ttu-id="5eca7-391">Torne o pacote facilmente personalizável e permita que os clientes decidam se desejam implantá-los por usuário ou por computador.</span><span class="sxs-lookup"><span data-stu-id="5eca7-391">Make the package easily customizable and let customers decide whether to deploy it per-user or per-machine.</span></span>

## <a name="plan-and-test-a-servicing-strategy-before-shipping-the-application"></a><span data-ttu-id="5eca7-392">Planeje e teste uma estratégia de serviço antes de enviar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-392">Plan and test a servicing strategy before shipping the application.</span></span>

<span data-ttu-id="5eca7-393">Você deve decidir como pretende atender o aplicativo antes de implantar o aplicativo pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="5eca7-393">You should decide how you intend to service the application before deploying the application for the first time.</span></span>

-   <span data-ttu-id="5eca7-394">Considere os tipos de atualizações que você pretende usar para atender seu aplicativo no futuro.</span><span class="sxs-lookup"><span data-stu-id="5eca7-394">Consider the types of updates you expect to use to service your application in the future.</span></span> <span data-ttu-id="5eca7-395">O Windows Installer fornece três tipos de atualizações: [atualização pequena](small-updates.md), [atualização secundária](minor-upgrades.md)e [atualizações principais](major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-395">The Windows Installer provides three types of updates: [Small Update](small-updates.md), [Minor Upgrade](minor-upgrades.md), and [Major Upgrades](major-upgrades.md).</span></span> <span data-ttu-id="5eca7-396">As diferenças entre eles são descritas no tópico [patches e atualizações](patching-and-upgrades.md) .</span><span class="sxs-lookup"><span data-stu-id="5eca7-396">The differences between these are described in [Patching and Upgrades](patching-and-upgrades.md) topic.</span></span>
-   <span data-ttu-id="5eca7-397">Antes de enviar seu aplicativo, teste se ele funciona conforme o esperado após a manutenção com cada tipo de atualização.</span><span class="sxs-lookup"><span data-stu-id="5eca7-397">Before shipping your application, test that it works as expected after servicing with each update type.</span></span>

## <a name="reduce-the-dependency-of-updates-upon-the-original-sources"></a><span data-ttu-id="5eca7-398">Reduza a dependência de atualizações nas fontes originais.</span><span class="sxs-lookup"><span data-stu-id="5eca7-398">Reduce the dependency of updates upon the original sources.</span></span>

<span data-ttu-id="5eca7-399">Se os arquivos de origem originais forem necessários para atualizar seu aplicativo, isso poderá dificultar a manutenção do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-399">If the original source files are required to update your application, this can make servicing the application more difficult.</span></span> <span data-ttu-id="5eca7-400">Os métodos a seguir podem ajudar a reduzir a dependência de atualizações nas fontes originais.</span><span class="sxs-lookup"><span data-stu-id="5eca7-400">The following methods can help reduce the dependence of updates upon the original sources.</span></span>

-   <span data-ttu-id="5eca7-401">Use um [*patch Delta*](d-gly.md) para atualizar as versões de linha de base do seu aplicativo, como a versão RTM e as versões de Service Pack.</span><span class="sxs-lookup"><span data-stu-id="5eca7-401">Use a [*delta patch*](d-gly.md) to update the baseline versions of your application, such as the RTM version and the service pack versions.</span></span> <span data-ttu-id="5eca7-402">Siga as diretrizes para usar os patches Delta descritos no tópico: [reduzindo o tamanho do patch](reducing-patch-size.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-402">Follow the guidelines for using delta patches described in the topic: [Reducing Patch Size](reducing-patch-size.md).</span></span>
-   <span data-ttu-id="5eca7-403">Siga as recomendações listadas no tópico: [impedir que um patch exija acesso à fonte de instalação original](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-403">Follow the recommendations listed in the topic: [Preventing a Patch from Requiring Access to the Original Installation Source](preventing-a-patch-from-requiring-access-to-the-original-installation-source.md).</span></span>

## <a name="do-not-distribute-unserviceable-merge-modules"></a><span data-ttu-id="5eca7-404">Não distribua módulos de mesclagem sem serviço.</span><span class="sxs-lookup"><span data-stu-id="5eca7-404">Do not distribute unserviceable merge modules.</span></span>

<span data-ttu-id="5eca7-405">Os aplicativos não devem depender de [módulos de mesclagem](merge-modules.md) para a instalação do componente se o proprietário do módulo de mesclagem e o proprietário do aplicativo forem diferentes.</span><span class="sxs-lookup"><span data-stu-id="5eca7-405">Applications should not depend on [merge modules](merge-modules.md) for the installation of component if the owner of the merge module and the owner of the application are different.</span></span> <span data-ttu-id="5eca7-406">Isso pode dificultar o serviço do aplicativo porque ambos os proprietários precisam coordenar para atualizar o aplicativo ou o módulo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-406">This can make it difficult to service the application because both owners need to coordinate to update the application or module.</span></span> <span data-ttu-id="5eca7-407">Sem conhecer todos os aplicativos que usaram o módulo de mesclagem, o proprietário do aplicativo não é capaz de atualizar o módulo de mesclagem sem arriscar que a atualização possa ser incompatível com outro aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-407">Without knowing all the applications that have used the merge module, the owner of the application is unable update the merge module without risking that the update might be incompatible with another application.</span></span> <span data-ttu-id="5eca7-408">O proprietário do módulo de mesclagem não tem nenhum método direto para atualizar Windows Installer pacotes que já instalaram o módulo de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="5eca7-408">The owner of the merge module has no direct method for updating Windows Installer packages that have already installed the merge module.</span></span>

-   <span data-ttu-id="5eca7-409">Considere fornecer os componentes necessários aos usuários como outro Windows Installer instalação.</span><span class="sxs-lookup"><span data-stu-id="5eca7-409">Consider providing the needed components to users as another Windows Installer installation.</span></span>

## <a name="avoid-patching-administrative-installations"></a><span data-ttu-id="5eca7-410">Evite aplicar patches em instalações administrativas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-410">Avoid patching administrative installations.</span></span>

<span data-ttu-id="5eca7-411">Forneça em uma rede uma [instalação administrativa](administrative-installation.md) do pacote de Windows Installer original do seu aplicativo para permitir que os membros de um grupo de trabalho instalem o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-411">Provide on a network an [administrative installation](administrative-installation.md) of your application's original Windows Installer package to enable members of a workgroup to install the application.</span></span> <span data-ttu-id="5eca7-412">Os usuários dessa imagem administrativa devem aplicar atualizações à instância local do aplicativo localizado em seu computador.</span><span class="sxs-lookup"><span data-stu-id="5eca7-412">Users of this administrative image should then apply updates to the local instance of the application located on their computer.</span></span> <span data-ttu-id="5eca7-413">Isso mantém os usuários em sincronia com a imagem administrativa.</span><span class="sxs-lookup"><span data-stu-id="5eca7-413">This keeps users in synchronization with the administrative image.</span></span> <span data-ttu-id="5eca7-414">Não é recomendável aplicar atualizações à instalação administrativa pelos seguintes motivos.</span><span class="sxs-lookup"><span data-stu-id="5eca7-414">Applying updates to the administrative installation is not recommended for the following reasons.</span></span>

-   <span data-ttu-id="5eca7-415">O tamanho e a latência do download necessários para que os usuários obtenham uma atualização são aumentados em comparação com o download de um patch.</span><span class="sxs-lookup"><span data-stu-id="5eca7-415">The size and latency of the download required for users to obtain an update is increased compared to downloading a patch.</span></span> <span data-ttu-id="5eca7-416">Todo o pacote de Windows Installer e arquivos de origem atualizados devem ser baixados, rearmazenados em cache e reinstalados.</span><span class="sxs-lookup"><span data-stu-id="5eca7-416">The entire updated Windows Installer package and source files must download, recached, and reinstalled.</span></span>
-   <span data-ttu-id="5eca7-417">Os usuários não podem fazer a [instalação sob demanda](installation-on-demand.md) e reparar aplicativos de uma instalação administrativa atualizada até que eles rearmazenem novamente em cache e reinstalem o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-417">Users are unable to [installation-on-demand](installation-on-demand.md) and repair applications from an updated administrative installation until they recache and reinstall the application.</span></span>
-   <span data-ttu-id="5eca7-418">A aplicação de um patch a uma instalação administrativa remove a assinatura digital do pacote.</span><span class="sxs-lookup"><span data-stu-id="5eca7-418">Applying a patch to an administrative installation removes the digital signature from the package.</span></span> <span data-ttu-id="5eca7-419">Um administrador deve desistir do pacote.</span><span class="sxs-lookup"><span data-stu-id="5eca7-419">An administrator must resign the package.</span></span> <span data-ttu-id="5eca7-420">Para obter mais informações sobre como usar assinaturas digitais, consulte [assinaturas digitais e Windows Installer](digital-signatures-and-windows-installer.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-420">For more information about using digital signatures, see [Digital Signatures and Windows Installer](digital-signatures-and-windows-installer.md).</span></span>
-   <span data-ttu-id="5eca7-421">Muitos patches binários visam a imagem RTM do aplicativo e exigem uma versão de arquivo anterior.</span><span class="sxs-lookup"><span data-stu-id="5eca7-421">Many binary patches target the RTM image of the application and require a previous file version.</span></span> <span data-ttu-id="5eca7-422">A instância local de um aplicativo instalado de uma instalação administrativa atualizada pode não funcionar com outras atualizações.</span><span class="sxs-lookup"><span data-stu-id="5eca7-422">The local instance of an application installed from an updated administrative installation may not work with other updates.</span></span> <span data-ttu-id="5eca7-423">Muitos aplicativos de patch binários podem falhar.</span><span class="sxs-lookup"><span data-stu-id="5eca7-423">Many binary patch applications can fail.</span></span>
-   <span data-ttu-id="5eca7-424">A aplicação de um patch a uma instalação administrativa atualiza os arquivos de origem e o arquivo. msi, mas não carimba a imagem de rede com informações sobre a atualização.</span><span class="sxs-lookup"><span data-stu-id="5eca7-424">Applying a patch to an administrative installation updates the source files and the .msi file but does not stamp the network image with information about the update.</span></span> <span data-ttu-id="5eca7-425">Os usuários não podem determinar quais atualizações foram recebidas da instalação administrativa.</span><span class="sxs-lookup"><span data-stu-id="5eca7-425">Users cannot determine which updates they have received from the administrative installation.</span></span> <span data-ttu-id="5eca7-426">Isso torna impossível sequenciar as atualizações aplicadas no lado do usuário com aquelas já aplicadas no lado da imagem administrativa.</span><span class="sxs-lookup"><span data-stu-id="5eca7-426">This makes it impossible to sequence updates applied on the user side with those already applied on the administrative image side.</span></span>
-   <span data-ttu-id="5eca7-427">Os patches aplicados a uma instalação administrativa não são [patches desinstaláveis](uninstallable-patches.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-427">Patches applied to an administrative installation are not [uninstallable patches](uninstallable-patches.md).</span></span> <span data-ttu-id="5eca7-428">Isso pode impedir que o código do pacote em cache no computador do usuário se torne diferente do código do pacote na instalação administrativa.</span><span class="sxs-lookup"><span data-stu-id="5eca7-428">This can prevent the package code cached on the user's computer from becoming different than the package code on the administrative installation.</span></span> <span data-ttu-id="5eca7-429">Se o código do pacote armazenado em cache no computador do usuário se tornar diferente daquele na instalação administrativa, reinstale o aplicativo da instalação administrativa e, em seguida, corrija o computador cliente.</span><span class="sxs-lookup"><span data-stu-id="5eca7-429">If the package code cached on the user's computer becomes different from that on the administrative installation, reinstall the application from the administrative installation and then patch the client computer.</span></span>
-   <span data-ttu-id="5eca7-430">Se você decidir aplicar pequenas atualizações por meio da aplicação de patch em uma imagem administrativa, siga as diretrizes descritas no tópico: [aplicando pequenas atualizações por meio da aplicação de patch em uma imagem administrativa](applying-small-updates-by-patching-an-administrative-image.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-430">If you decide to apply small updates by patching an administrative image, follow the guidelines described in the topic: [Applying Small Updates by Patching an Administrative Image](applying-small-updates-by-patching-an-administrative-image.md).</span></span>

## <a name="register-updates-to-run-with-elevated-privilege"></a><span data-ttu-id="5eca7-431">Registre as atualizações para executar com privilégios elevados.</span><span class="sxs-lookup"><span data-stu-id="5eca7-431">Register updates to run with elevated privilege.</span></span>

<span data-ttu-id="5eca7-432">A partir do Windows Installer 3,0, é possível aplicar patches a um aplicativo que foi instalado em um contexto gerenciado por usuário, depois que o patch tiver sido registrado como tendo privilégios elevados.</span><span class="sxs-lookup"><span data-stu-id="5eca7-432">Beginning with Windows Installer 3.0, it is possible to apply patches to an application that has been installed in a per-user-managed context, after the patch has been registered as having elevated privileges.</span></span> <span data-ttu-id="5eca7-433">Você não pode aplicar patches a aplicativos que estão instalados em um contexto gerenciado por usuário usando versões do Windows Installer anteriores à versão 3,0.</span><span class="sxs-lookup"><span data-stu-id="5eca7-433">You cannot apply patches to applications that are installed in a per-user managed context using versions of Windows Installer earlier than version 3.0.</span></span>

-   <span data-ttu-id="5eca7-434">Use o método [**SourceListAddSource**](patch-sourcelistaddsource.md) ou a função [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) para registrar um pacote de patch como tendo privilégios elevados.</span><span class="sxs-lookup"><span data-stu-id="5eca7-434">Use the [**SourceListAddSource**](patch-sourcelistaddsource.md) method or [**MsiSourceListAddSourceEx**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) function to register a patch package as having elevated privileges.</span></span> <span data-ttu-id="5eca7-435">Siga as diretrizes e os exemplos fornecidos na [aplicação de patches Per-User aplicativos gerenciados](patching-per-user-managed-applications.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-435">Follow the guidelines and examples provided in [Patching Per-User Managed Applications](patching-per-user-managed-applications.md).</span></span>
-   <span data-ttu-id="5eca7-436">Ao executar Windows Installer versão 4,0 no Windows Vista, você também pode usar a [aplicação de patches de controle de conta de usuário (UAC)](user-account-control--uac--patching.md) para permitir que os autores de instalações de Windows Installer identifiquem patches assinados digitalmente que podem ser aplicados no futuro por usuários não administradores.</span><span class="sxs-lookup"><span data-stu-id="5eca7-436">When running Windows Installer version 4.0 on Windows Vista you can also use [User Account Control (UAC) Patching](user-account-control--uac--patching.md) to enables the authors of Windows Installer installations to identify digitally-signed patches that can be applied in the future by non-administrator users.</span></span> <span data-ttu-id="5eca7-437">Isso só está disponível com a instalação de pacotes no [contexto de instalação](installation-context.md) por máquina (AllUsers = 1).</span><span class="sxs-lookup"><span data-stu-id="5eca7-437">This is only available with the installation of packages in the per-machine [installation context](installation-context.md) (ALLUSERS=1).</span></span>
-   <span data-ttu-id="5eca7-438">Verifique se a aplicação de patches com privilégios mínimos não foi desabilitada definindo a propriedade [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) ou a política [DisableLUAPatching](disableluapatching.md) .</span><span class="sxs-lookup"><span data-stu-id="5eca7-438">Ensure that least-privilege patching has not been disabled by setting the [**MSIDISABLELUAPATCHING**](msidisableluapatching.md) property or the [DisableLUAPatching](disableluapatching.md) policy.</span></span>

## <a name="use-the-msipatchsequence-table-to-sequence-patches"></a><span data-ttu-id="5eca7-439">Use a tabela MsiPatchSequence para sequenciar patches.</span><span class="sxs-lookup"><span data-stu-id="5eca7-439">Use the MsiPatchSequence Table to sequence patches.</span></span>

<span data-ttu-id="5eca7-440">Inclua uma [tabela MsiPatchSequence](msipatchsequence-table.md) em seu pacote e adicione informações de sequenciamento de patch.</span><span class="sxs-lookup"><span data-stu-id="5eca7-440">Include a [MsiPatchSequence Table](msipatchsequence-table.md) in your package and add patch sequencing information.</span></span> <span data-ttu-id="5eca7-441">A partir do Windows Installer versão 3,0, o instalador pode usar a tabela MsiPatchSequence ao [instalar vários patches](installing-multiple-patches.md) para determinar a melhor sequência de aplicativos de patch.</span><span class="sxs-lookup"><span data-stu-id="5eca7-441">Beginning with Windows Installer version 3.0, the installer can use the MsiPatchSequence Table when [installing multiple patches](installing-multiple-patches.md) to determine the best patch application sequence.</span></span> <span data-ttu-id="5eca7-442">Use as diretrizes descritas no [sequenciamento de patches no Windows Installer versão 3,0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3) White Paper para definir as famílias de patches.</span><span class="sxs-lookup"><span data-stu-id="5eca7-442">Use the guidelines described in the [Patch Sequencing in Windows Installer version 3.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3) white paper for defining patch families.</span></span>

-   <span data-ttu-id="5eca7-443">Se for prático, especifique todos os patches como pertencentes a uma única família de patches.</span><span class="sxs-lookup"><span data-stu-id="5eca7-443">If practical, specify all patches as belonging to a single patch family.</span></span> <span data-ttu-id="5eca7-444">Em muitos casos, uma única família de patches fornece flexibilidade suficiente para os patches de sequência.</span><span class="sxs-lookup"><span data-stu-id="5eca7-444">In many cases a single patch family provides enough flexibility to sequence patches.</span></span> <span data-ttu-id="5eca7-445">A complexidade da criação aumenta quando várias famílias de patches são usadas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-445">The complexity of authoring increases when multiple patch families are used.</span></span> <span data-ttu-id="5eca7-446">Atribua um nome significativo à família de patches e atribua valores de sequência na família de patches que aumentam ao longo do tempo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-446">Assign a meaningful name to the patch family and assign sequence values in that patch family that increase over time.</span></span> <span data-ttu-id="5eca7-447">Siga o [exemplo de várias correções](multiple-patching-example.md) para aplicar patches na ordem em que foram emitidos.</span><span class="sxs-lookup"><span data-stu-id="5eca7-447">Follow the [Multiple Patching Example](multiple-patching-example.md) to apply patches in the order in which they have been issued.</span></span>
-   <span data-ttu-id="5eca7-448">Use a [tabela PatchSequence](patchsequence-table--patchwiz-dll-.md) em [Patchwiz.dll](patchwiz-dll.md) para gerar as informações na [tabela MsiPatchSequence](msipatchsequence-table.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-448">Use the [PatchSequence Table](patchsequence-table--patchwiz-dll-.md) in [Patchwiz.dll](patchwiz-dll.md) to generate the information in [MsiPatchSequence Table](msipatchsequence-table.md).</span></span> <span data-ttu-id="5eca7-449">A versão do PATCHWIZ.DLL lançada com Windows Installer 3,0 pode gerar automaticamente informações de sequenciamento de patch.</span><span class="sxs-lookup"><span data-stu-id="5eca7-449">The version of PATCHWIZ.DLL that was released with Windows Installer 3.0 can automatically generate patch sequencing information.</span></span> <span data-ttu-id="5eca7-450">Para obter mais informações sobre como adicionar um novo patch, consulte [gerando informações de sequência de patch](generating-patch-sequence-information---patchwiz-dll-.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-450">For more information on how to add a new patch, see [Generating Patch Sequence Information](generating-patch-sequence-information---patchwiz-dll-.md).</span></span> <span data-ttu-id="5eca7-451">Para obter mais informações sobre cenários de sequenciamento de patch, consulte o White Paper: [sequenciamento de patch no Windows Installer versão 3,0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3).</span><span class="sxs-lookup"><span data-stu-id="5eca7-451">For more information about patch sequencing scenarios, see the whitepaper: [Patch Sequencing in Windows Installer version 3.0](https://www.microsoft.com/downloads/details.aspx?FamilyID=ad7ac91e-2493-4549-ae6f-bf5e007c12a3).</span></span>

## <a name="test-the-installation-package-thoroughly"></a><span data-ttu-id="5eca7-452">Teste o pacote de instalação completamente.</span><span class="sxs-lookup"><span data-stu-id="5eca7-452">Test the installation package thoroughly.</span></span>

<span data-ttu-id="5eca7-453">Teste a instalação, o reparo e a remoção corretas do pacote de Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-453">Test for correct installation, repair, and removal of your Windows Installer package.</span></span> <span data-ttu-id="5eca7-454">Você pode dividir seu processo de teste nas seguintes partes.</span><span class="sxs-lookup"><span data-stu-id="5eca7-454">You can divide your testing process into the following parts.</span></span>

-   <span data-ttu-id="5eca7-455">Teste de instalação – teste a instalação com todas as combinações possíveis de recursos de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="5eca7-455">Installation Testing - Test the installation with all possible combinations of application features.</span></span> <span data-ttu-id="5eca7-456">Testar todos os tipos de instalação, incluindo a [instalação administrativa](administrative-installation.md), a [reversão da instalação](rollback-installation.md)e [a instalação sob demanda](installation-on-demand.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-456">Test all types of installation, including [Administrative Installation](administrative-installation.md), [Rollback Installation](rollback-installation.md), and [Installation-On-Demand](installation-on-demand.md).</span></span> <span data-ttu-id="5eca7-457">Experimente todos os possíveis métodos de instalação, incluindo o clique no arquivo. msi, nas [Opções de linha de comando](command-line-options.md)e na instalação no painel de controle.</span><span class="sxs-lookup"><span data-stu-id="5eca7-457">Try all possible methods of installation, including clicking on the .msi file, [command line options](command-line-options.md), and installing from the control panel.</span></span> <span data-ttu-id="5eca7-458">Teste se o pacote pode ser instalado por usuários em todos os possíveis contextos de privilégio.</span><span class="sxs-lookup"><span data-stu-id="5eca7-458">Test that the package can be installed by users in all possible privilege contexts.</span></span> <span data-ttu-id="5eca7-459">Tente instalar o pacote depois que ele tiver sido implantado por todos os métodos possíveis.</span><span class="sxs-lookup"><span data-stu-id="5eca7-459">Try installing the package after it has been deployed by all possible methods.</span></span> <span data-ttu-id="5eca7-460">Habilite o [log de Windows Installer](windows-installer-logging.md) para cada teste e resolva todos os erros encontrados no log do instalador e no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="5eca7-460">Enable [Windows Installer Logging](windows-installer-logging.md) for each test and resolve all errors found in the installer log and event log.</span></span>
-   <span data-ttu-id="5eca7-461">Teste de interface do usuário-teste o pacote quando instalado com todos os [níveis de interface do usuário](user-interface-levels.md)possíveis.</span><span class="sxs-lookup"><span data-stu-id="5eca7-461">User Interface Testing - Test the package when installed with all possible [user interface levels](user-interface-levels.md).</span></span> <span data-ttu-id="5eca7-462">Teste o pacote instalado sem interface do usuário e com todas as informações fornecidas por meio da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="5eca7-462">Test the package installed with no user interface and with all information provided through the user interface.</span></span> <span data-ttu-id="5eca7-463">Verifique a [acessibilidade](accessibility.md) da interface do usuário e se a interface do usuário funciona como esperado para diferentes resoluções de tela e tamanhos de fonte.</span><span class="sxs-lookup"><span data-stu-id="5eca7-463">Ensure the [Accessibility](accessibility.md) of the user interface and that the user interface functions as expected for different screen resolutions and font sizes.</span></span>
-   <span data-ttu-id="5eca7-464">Manutenção e reparo de teste – teste se o pacote pode lidar com [patches e atualizações](patching-and-upgrades.md) entregues por uma [pequena atualização](small-updates.md), [atualização secundária](minor-upgrades.md)e [atualizações importantes](major-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-464">Servicing and Repair Testing - Test that the package can handle [Patching and Upgrades](patching-and-upgrades.md) delivered by a [Small Update](small-updates.md), [Minor Upgrade](minor-upgrades.md), and [Major Upgrades](major-upgrades.md).</span></span> <span data-ttu-id="5eca7-465">Antes de implantar o pacote, grave uma atualização de avaliação de cada tipo e tente aplicá-lo ao pacote original.</span><span class="sxs-lookup"><span data-stu-id="5eca7-465">Before deploying the package, write a trial update of each type and try applying it to the original package.</span></span>
-   <span data-ttu-id="5eca7-466">Teste de desinstalação – Verifique se quando o pacote é removido ele não deixa nenhuma parte inútil de si mesmo no computador do usuário e se apenas as informações pertencentes ao pacote foram removidas.</span><span class="sxs-lookup"><span data-stu-id="5eca7-466">Uninstall Testing - Verify that when the package is removed it leaves no useless parts of itself behind on the user's computer and that only information belonging to the package has been removed.</span></span> <span data-ttu-id="5eca7-467">Reinicialize o computador de teste após desinstalar o pacote e verificar a integridade das ferramentas de sistema comuns e outros aplicativos padrão.</span><span class="sxs-lookup"><span data-stu-id="5eca7-467">Reboot the test computer after uninstalling the package and verify the integrity of common system tools and other standard applications.</span></span> <span data-ttu-id="5eca7-468">Teste se o pacote pode ser removido por usuários em todos os possíveis contextos de privilégio.</span><span class="sxs-lookup"><span data-stu-id="5eca7-468">Test that the package can be removed by users in all possible privilege contexts.</span></span> <span data-ttu-id="5eca7-469">Teste todos os métodos para remover o pacote, clique no arquivo. msi, tente as [Opções de linha de comando](command-line-options.md)e tente remover o pacote do painel de controle.</span><span class="sxs-lookup"><span data-stu-id="5eca7-469">Test all methods to remove the package, click the .msi file, try the [command line options](command-line-options.md), and try removing the package from the control panel.</span></span> <span data-ttu-id="5eca7-470">Habilite o [log de Windows Installer](windows-installer-logging.md) para cada teste e resolva todos os erros encontrados no log do instalador e no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="5eca7-470">Enable [Windows Installer Logging](windows-installer-logging.md) for each test and resolve all errors found in the installer log and event log.</span></span>
-   <span data-ttu-id="5eca7-471">Teste de funcionalidade do produto – Verifique se o aplicativo funciona conforme o esperado após a instalação, o reparo ou a remoção do pacote.</span><span class="sxs-lookup"><span data-stu-id="5eca7-471">Product Functionality Testing - Ensure that the application functions as expected after the installation, repair, or removal of the package.</span></span>

## <a name="fix-all-validation-errors-before-deploying-a-new-or-revised-installation-package"></a><span data-ttu-id="5eca7-472">Corrija todos os erros de validação antes de implantar um pacote de instalação novo ou revisado.</span><span class="sxs-lookup"><span data-stu-id="5eca7-472">Fix all validation errors before deploying a new or revised installation package.</span></span>

<span data-ttu-id="5eca7-473">Execute a [validação de pacote](package-validation.md) em um pacote de Windows Installer novo ou revisado antes de tentar instalá-lo pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="5eca7-473">Run [package validation](package-validation.md) on a new or revised Windows Installer package before attempting to install it for the first time.</span></span> <span data-ttu-id="5eca7-474">A validação verifica se há erros na criação do banco de dados Windows Installer.</span><span class="sxs-lookup"><span data-stu-id="5eca7-474">Validation checks the Windows Installer database for authoring errors.</span></span> <span data-ttu-id="5eca7-475">A tentativa de instalar um pacote que não passe na validação pode danificar o sistema do usuário.</span><span class="sxs-lookup"><span data-stu-id="5eca7-475">Attempting to install a package that does not pass validation can damage the user's system.</span></span>

-   <span data-ttu-id="5eca7-476">Você pode validar seu pacote usando [Orca.exe](orca-exe.md) ou [Msival2.exe](msival2-exe.md).</span><span class="sxs-lookup"><span data-stu-id="5eca7-476">You can validate your package using [Orca.exe](orca-exe.md) or [Msival2.exe](msival2-exe.md).</span></span> <span data-ttu-id="5eca7-477">Ambas as ferramentas são fornecidas com o SDK do Windows.</span><span class="sxs-lookup"><span data-stu-id="5eca7-477">Both tools are provided with the Windows SDK.</span></span> <span data-ttu-id="5eca7-478">Os fornecedores terceirizados também podem incorporar o sistema de validação ICE ao seu ambiente de criação.</span><span class="sxs-lookup"><span data-stu-id="5eca7-478">Third-party vendors may also incorporate the ICE validation system into their authoring environment.</span></span>
-   <span data-ttu-id="5eca7-479">Você pode usar o conjunto padrão de [avaliadores de consistência internos-ICES](internal-consistency-evaluators-ices.md) incluídos nos arquivos. Cub fornecidos com o SDK ou personalizar a validação [criando um Ice](building-an-ice.md) e adicionando-o ao arquivo. cub.</span><span class="sxs-lookup"><span data-stu-id="5eca7-479">You can use the standard set of [Internal Consistency Evaluators - ICEs](internal-consistency-evaluators-ices.md) included in the .cub files provided with the SDK, or customize validation by [Building an ICE](building-an-ice.md) and adding it to the .cub file.</span></span>
-   <span data-ttu-id="5eca7-480">Você pode usar o Evalcom2.dll para implementar a [automação de validação](validation-automation.md) para pacotes de instalação e módulos de mesclagem.</span><span class="sxs-lookup"><span data-stu-id="5eca7-480">You can use the Evalcom2.dll to implement [Validation Automation](validation-automation.md) for installation packages and merge modules.</span></span>

## <a name="author-a-secure-installation"></a><span data-ttu-id="5eca7-481">Crie uma instalação segura.</span><span class="sxs-lookup"><span data-stu-id="5eca7-481">Author a secure installation.</span></span>

<span data-ttu-id="5eca7-482">Seguindo essas diretrizes ao desenvolver seu pacote para ajudar a manter um ambiente seguro durante a instalação.</span><span class="sxs-lookup"><span data-stu-id="5eca7-482">Following these guidelines when developing your package to help maintain a secure environment during installation.</span></span>

-   [<span data-ttu-id="5eca7-483">Diretrizes para a criação de instalações seguras</span><span class="sxs-lookup"><span data-stu-id="5eca7-483">Guidelines for Authoring Secure Installations</span></span>](guidelines-for-authoring-secure-installations.md)
-   [<span data-ttu-id="5eca7-484">Diretrizes para proteger pacotes em computadores bloqueados</span><span class="sxs-lookup"><span data-stu-id="5eca7-484">Guidelines for Securing Packages on Locked-Down Computers</span></span>](guidelines-for-securing-packages-on-locked-down-computers.md)
-   [<span data-ttu-id="5eca7-485">Diretrizes para proteger ações personalizadas</span><span class="sxs-lookup"><span data-stu-id="5eca7-485">Guidelines for Securing Custom Actions</span></span>](guidelines-for-securing-custom-actions.md)

## <a name="use-pmsihandle-instead-of-handle"></a><span data-ttu-id="5eca7-486">Usar PMSIHANDLE em vez de identificador</span><span class="sxs-lookup"><span data-stu-id="5eca7-486">Use PMSIHANDLE instead of HANDLE</span></span>

<span data-ttu-id="5eca7-487">As variáveis de tipo **PMSIHANDLE** são definidas em MSI. h.</span><span class="sxs-lookup"><span data-stu-id="5eca7-487">The **PMSIHANDLE** type variables is defined in msi.h.</span></span> <span data-ttu-id="5eca7-488">É recomendável que seu aplicativo use o tipo **PMSIHANDLE** porque o instalador fecha os objetos **PMSIHANDLE** à medida que eles saem do escopo, enquanto seu aplicativo deve fechar os objetos **MSIHANDLE** chamando [**MsiCloseHandle**](/windows/desktop/api/Msi/nf-msi-msiclosehandle).</span><span class="sxs-lookup"><span data-stu-id="5eca7-488">It is recommended that your application use the **PMSIHANDLE** type because the installer closes **PMSIHANDLE** objects as they go out of scope, whereas your application must close **MSIHANDLE** objects by calling [**MsiCloseHandle**](/windows/desktop/api/Msi/nf-msi-msiclosehandle).</span></span>

<span data-ttu-id="5eca7-489">Por exemplo, se você usar um código como este:</span><span class="sxs-lookup"><span data-stu-id="5eca7-489">For example, if you use code like this:</span></span>

``` syntax
MSIHANDLE hRec = MsiCreateRecord(3);
```

<span data-ttu-id="5eca7-490">Altere-o para:</span><span class="sxs-lookup"><span data-stu-id="5eca7-490">Change it to:</span></span>

``` syntax
PMSIHANDLE hRec = MsiCreateRecord(3);
```

 

 
