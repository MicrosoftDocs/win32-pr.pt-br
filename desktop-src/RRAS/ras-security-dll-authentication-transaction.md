---
title: Transação de autenticação de DLL de segurança RAS
description: O servidor RAS do Windows NT/Windows 2000 chama a função RasSecurityDialogBegin da DLL de segurança para iniciar uma autenticação de um usuário remoto.
ms.assetid: e6549812-d906-4163-b9c8-86f8f1cb1ad3
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 109f6ad5cd3d7b76e30db099a478ffaf562feb32
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104499129"
---
# <a name="ras-security-dll-authentication-transaction"></a><span data-ttu-id="b92d2-103">Transação de autenticação de DLL de segurança RAS</span><span class="sxs-lookup"><span data-stu-id="b92d2-103">RAS Security DLL Authentication Transaction</span></span>

<span data-ttu-id="b92d2-104">O servidor RAS do Windows NT/Windows 2000 chama a função [**RasSecurityDialogBegin**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogbegin) da DLL de segurança para iniciar uma autenticação de um usuário remoto.</span><span class="sxs-lookup"><span data-stu-id="b92d2-104">Windows NT/Windows 2000 RAS server calls the security DLL's [**RasSecurityDialogBegin**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogbegin) function to begin an authentication of a remote user.</span></span> <span data-ttu-id="b92d2-105">O servidor RAS está bloqueado e não pode aceitar nenhuma outra chamada até que **RasSecurityDialogBegin** seja retornado.</span><span class="sxs-lookup"><span data-stu-id="b92d2-105">The RAS server is blocked and cannot accept any other calls until **RasSecurityDialogBegin** returns.</span></span> <span data-ttu-id="b92d2-106">Por esse motivo, **RasSecurityDialogBegin** deve copiar os parâmetros de entrada, criar um thread para executar a autenticação e retornar o mais rápido possível.</span><span class="sxs-lookup"><span data-stu-id="b92d2-106">For this reason, **RasSecurityDialogBegin** should copy the input parameters, create a thread to perform the authentication, and return as quickly as possible.</span></span>

<span data-ttu-id="b92d2-107">O thread criado pela DLL de segurança usa as funções [**RasSecurityDialogSend**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogsend) e [**RasSecurityDialogReceive**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogreceive) para se comunicar com o computador remoto.</span><span class="sxs-lookup"><span data-stu-id="b92d2-107">The thread created by the security DLL uses the [**RasSecurityDialogSend**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogsend) and [**RasSecurityDialogReceive**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogreceive) functions to communicate with the remote computer.</span></span> <span data-ttu-id="b92d2-108">Essas funções não estão disponíveis para importação estática de qualquer biblioteca.</span><span class="sxs-lookup"><span data-stu-id="b92d2-108">These functions are not available for static import from any library.</span></span> <span data-ttu-id="b92d2-109">Em vez disso, a DLL de segurança deve usar as funções [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) e [**GetProcAddress**](/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress) para vincular dinamicamente a essas funções no RASMAN.DLL.</span><span class="sxs-lookup"><span data-stu-id="b92d2-109">Instead, the security DLL must use the [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) and [**GetProcAddress**](/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress) functions to dynamically link to these functions in RASMAN.DLL.</span></span>

<span data-ttu-id="b92d2-110">Durante uma transação de autenticação, o Gerenciador de conexões RAS no computador remoto exibe uma janela de terminal.</span><span class="sxs-lookup"><span data-stu-id="b92d2-110">During an authentication transaction, the RAS connection manager on the remote computer displays a terminal window.</span></span> <span data-ttu-id="b92d2-111">O thread da DLL de segurança chama [**RasSecurityDialogSend**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogsend) para enviar uma mensagem a ser exibida na janela do terminal.</span><span class="sxs-lookup"><span data-stu-id="b92d2-111">The thread of the security DLL calls [**RasSecurityDialogSend**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogsend) to send a message to display in the terminal window.</span></span> <span data-ttu-id="b92d2-112">Em seguida, o thread chama [**RasSecurityDialogReceive**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogreceive) para receber a entrada que o usuário remoto digita na janela do terminal.</span><span class="sxs-lookup"><span data-stu-id="b92d2-112">The thread then calls [**RasSecurityDialogReceive**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogreceive) to receive the input that the remote user types in the terminal window.</span></span> <span data-ttu-id="b92d2-113">O thread pode fazer qualquer número de chamadas **RasSecurityDialogSend** , com cada chamada seguida de uma chamada **RasSecurityDialogReceive** .</span><span class="sxs-lookup"><span data-stu-id="b92d2-113">The thread can make any number of **RasSecurityDialogSend** calls, with each call followed by a **RasSecurityDialogReceive** call.</span></span> <span data-ttu-id="b92d2-114">Após cada chamada para **RasSecurityDialogReceive**, o thread deve chamar uma das funções Wait, como [**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject), para aguardar a conclusão das operações de envio e recebimento assíncronas.</span><span class="sxs-lookup"><span data-stu-id="b92d2-114">After each call to **RasSecurityDialogReceive**, the thread must call one of the wait functions, such as [**WaitForSingleObject**](/windows/win32/api/synchapi/nf-synchapi-waitforsingleobject), to wait for the asynchronous send and receive operations to be completed.</span></span> <span data-ttu-id="b92d2-115">O servidor RAS sinaliza um objeto de evento quando a operação de recebimento tiver sido concluída ou quando um intervalo de tempo limite opcional tiver decorrido.</span><span class="sxs-lookup"><span data-stu-id="b92d2-115">The RAS server signals an event object when the receive operation has been completed or when an optional time-out interval has elapsed.</span></span>

<span data-ttu-id="b92d2-116">Quando o thread terminar de autenticar o usuário remoto, ele chamará a função [**RasSecurityDialogComplete**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogcomplete) .</span><span class="sxs-lookup"><span data-stu-id="b92d2-116">When the thread has finished authenticating the remote user, it calls the [**RasSecurityDialogComplete**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogcomplete) function.</span></span> <span data-ttu-id="b92d2-117">Essa chamada passa uma estrutura de [**\_ mensagem de segurança**](/windows/desktop/api/Rasshost/ns-rasshost-security_message) que contém os resultados da transação de autenticação para o servidor RAS.</span><span class="sxs-lookup"><span data-stu-id="b92d2-117">This call passes a [**SECURITY\_MESSAGE**](/windows/desktop/api/Rasshost/ns-rasshost-security_message) structure containing the results of the authentication transaction to the RAS server.</span></span> <span data-ttu-id="b92d2-118">Em seguida, o servidor RAS executa uma sequência de limpeza que inclui uma chamada para a função [**RasSecurityDialogEnd**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogend) da dll.</span><span class="sxs-lookup"><span data-stu-id="b92d2-118">The RAS server then performs a cleanup sequence that includes a call to the DLL's [**RasSecurityDialogEnd**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogend) function.</span></span> <span data-ttu-id="b92d2-119">Isso dá à DLL de segurança uma oportunidade de executar qualquer limpeza necessária.</span><span class="sxs-lookup"><span data-stu-id="b92d2-119">This gives the security DLL an opportunity to perform any necessary cleanup.</span></span>

<span data-ttu-id="b92d2-120">A DLL de segurança pode chamar a função [**RasSecurityDialogGetInfo**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialoggetinfo) para recuperar informações sobre a porta associada a uma transação de autenticação.</span><span class="sxs-lookup"><span data-stu-id="b92d2-120">The security DLL can call the [**RasSecurityDialogGetInfo**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialoggetinfo) function to retrieve information about the port associated with an authentication transaction.</span></span> <span data-ttu-id="b92d2-121">**RasSecurityDialogGetInfo** preenche uma estrutura [**de \_ \_ informações de segurança de Ras**](/windows/desktop/api/Rasshost/ns-rasshost-ras_security_info) que indica o estado da última chamada de [**RasSecurityDialogReceive**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogreceive) para a porta.</span><span class="sxs-lookup"><span data-stu-id="b92d2-121">**RasSecurityDialogGetInfo** fills in a [**RAS\_SECURITY\_INFO**](/windows/desktop/api/Rasshost/ns-rasshost-ras_security_info) structure that indicates the state of the last [**RasSecurityDialogReceive**](/windows/desktop/api/Rasshost/nf-rasshost-rassecuritydialogreceive) call for the port.</span></span>

 

 