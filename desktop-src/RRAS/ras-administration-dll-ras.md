---
title: DLL de administração de RAS
description: A DLL exporta as funções que o servidor RAS chama sempre que um usuário tenta se conectar ou se desconectar.
ms.assetid: 014ab85d-8924-4c7a-89ed-f83e75318ca6
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f0908032e0916f0937e964408b1551d3f1515dea
ms.sourcegitcommit: cba7f424a292fd7f3a8518947b9466439b455419
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/23/2019
ms.locfileid: "104293606"
---
# <a name="ras-administration-dll"></a><span data-ttu-id="d4fdc-103">DLL de administração de RAS</span><span class="sxs-lookup"><span data-stu-id="d4fdc-103">RAS administration DLL</span></span>

<span data-ttu-id="d4fdc-104">A DLL exporta as funções que o servidor RAS chama sempre que um usuário tenta se conectar ou se desconectar.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-104">The DLL exports functions that the RAS server calls whenever a user tries to connect or disconnect.</span></span> <span data-ttu-id="d4fdc-105">Você pode usar a DLL para executar as seguintes funções administrativas:</span><span class="sxs-lookup"><span data-stu-id="d4fdc-105">You can use the DLL to perform the following administrative functions:</span></span>

-   <span data-ttu-id="d4fdc-106">Decida se deseja permitir que um usuário se conecte ao servidor.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-106">Decide whether to allow a user to connect to the server.</span></span> <span data-ttu-id="d4fdc-107">Isso pode fornecer uma verificação de segurança além da autenticação de usuário RAS padrão.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-107">This can provide a security check in addition to the standard RAS user authentication.</span></span>
-   <span data-ttu-id="d4fdc-108">Registre a hora em que cada usuário se conecta e se desconecta do servidor.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-108">Record the time that each user connects to and disconnects from the server.</span></span> <span data-ttu-id="d4fdc-109">Isso pode ser útil para fins de cobrança ou auditoria.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-109">This can be useful for billing or auditing purposes.</span></span>
-   <span data-ttu-id="d4fdc-110">Atribua um endereço IP a cada usuário.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-110">Assign an IP address to each user.</span></span> <span data-ttu-id="d4fdc-111">Isso pode ser útil para fins de segurança para mapear a conexão de um usuário para um computador específico.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-111">This can be useful for security purposes to map a user's connection to a specific computer.</span></span>

<span data-ttu-id="d4fdc-112">Implemente as funções a seguir ao desenvolver uma DLL de administração do servidor RAS.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-112">Implement the following functions when developing a RAS server administration DLL.</span></span>

-   [<span data-ttu-id="d4fdc-113">**RasAdminAcceptNewConnection**</span><span class="sxs-lookup"><span data-stu-id="d4fdc-113">**RasAdminAcceptNewConnection**</span></span>](rasadminacceptnewconnection.md)
-   [<span data-ttu-id="d4fdc-114">**RasAdminConnectionHangupNotification**</span><span class="sxs-lookup"><span data-stu-id="d4fdc-114">**RasAdminConnectionHangupNotification**</span></span>](rasadminconnectionhangupnotification.md)
-   [<span data-ttu-id="d4fdc-115">**RasAdminGetIpAddressForUser**</span><span class="sxs-lookup"><span data-stu-id="d4fdc-115">**RasAdminGetIpAddressForUser**</span></span>](rasadmingetipaddressforuser.md)
-   [<span data-ttu-id="d4fdc-116">**RasAdminReleaseIpAddress**</span><span class="sxs-lookup"><span data-stu-id="d4fdc-116">**RasAdminReleaseIpAddress**</span></span>](rasadminreleaseipaddress.md)

<span data-ttu-id="d4fdc-117">Uma DLL de administração de RAS deve implementar e exportar todas as funções acima.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-117">A RAS administration DLL must implement and export all of the above functions.</span></span> <span data-ttu-id="d4fdc-118">Se qualquer uma das funções não for implementada, o serviço de acesso remoto não será iniciado.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-118">If any of the functions are not implemented, the remote access service will fail to start.</span></span>

<span data-ttu-id="d4fdc-119">As funções [**RasAdminAcceptNewConnection**](rasadminacceptnewconnection.md) e [**RasAdminConnectionHangupNotification**](rasadminconnectionhangupnotification.md) permitem que a dll faça auditoria de conexões de usuário com o servidor.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-119">The [**RasAdminAcceptNewConnection**](rasadminacceptnewconnection.md) and [**RasAdminConnectionHangupNotification**](rasadminconnectionhangupnotification.md) functions enable the DLL to audit user connections to the server.</span></span> <span data-ttu-id="d4fdc-120">Um servidor RAS do Windows NT/Windows 2000 chama a função **RasAdminAcceptNewConnection** sempre que um usuário tenta se conectar.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-120">A Windows NT/Windows 2000 RAS server calls the **RasAdminAcceptNewConnection** function whenever a user tries to connect.</span></span> <span data-ttu-id="d4fdc-121">A função pode impedir que o usuário se conecte.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-121">The function can prevent the user from connecting.</span></span> <span data-ttu-id="d4fdc-122">Você também pode usar a função para gerar uma entrada em um log para cobrança ou auditoria.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-122">You can also use the function to generate an entry in a log for billing or auditing.</span></span> <span data-ttu-id="d4fdc-123">Quando o usuário se desconecta, o servidor RAS chama a função **RasAdminConnectionHangupNotification** , que pode registrar a hora em que o usuário se desconectou.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-123">When the user disconnects, the RAS server calls the **RasAdminConnectionHangupNotification** function, which can log the time at which the user disconnected.</span></span>

<span data-ttu-id="d4fdc-124">Depois que o servidor RAS tiver autenticado um chamador, ele chamará a função [**RasAdminGetIpAddressForUser**](rasadmingetipaddressforuser.md) para obter um endereço IP para o cliente remoto.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-124">After the RAS server has authenticated a caller, it calls the [**RasAdminGetIpAddressForUser**](rasadmingetipaddressforuser.md) function to get an IP address for the remote client.</span></span> <span data-ttu-id="d4fdc-125">A DLL pode usar essa função para fornecer um esquema alternativo para o mapeamento de um endereço IP para um usuário de conexão discada.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-125">The DLL can use this function to provide an alternate scheme for mapping an IP address to a dial-in user.</span></span> <span data-ttu-id="d4fdc-126">Se o **RasAdminGetIpAddressForUser** não for implementado, um servidor RAS conectará um usuário remoto a um endereço IP selecionado de um pool estático de endereços IP ou um selecionado por um servidor DHCP (protocolo de configuração dinâmica de hosts).</span><span class="sxs-lookup"><span data-stu-id="d4fdc-126">If **RasAdminGetIpAddressForUser** is not implemented, a RAS server connects a remote user to an IP address selected from a static pool of IP addresses, or one selected by a Dynamic Host Configuration Protocol (DHCP) server.</span></span> <span data-ttu-id="d4fdc-127">A função **RasAdminGetIpAddressForUser** permite que a dll Substitua esse endereço IP padrão e especifique um endereço IP específico para cada usuário.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-127">The **RasAdminGetIpAddressForUser** function allows the DLL to override this default IP address and specify a particular IP address for each user.</span></span> <span data-ttu-id="d4fdc-128">A função **RasAdminGetIpAddressForUser** pode definir um sinalizador que faz com que o RAS chame a função [**RasAdminReleaseIpAddress**](rasadminreleaseipaddress.md) quando o usuário se desconecta.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-128">The **RasAdminGetIpAddressForUser** function can set a flag that causes RAS to call the [**RasAdminReleaseIpAddress**](rasadminreleaseipaddress.md) function when the user disconnects.</span></span> <span data-ttu-id="d4fdc-129">A DLL pode usar [**RasAdminReleaseIpAddress**](rasadminreleaseipaddress.md) para atualizar seu mapa de endereço de usuário para IP.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-129">The DLL can use [**RasAdminReleaseIpAddress**](rasadminreleaseipaddress.md) to update its user-to-IP-address map.</span></span>

<span data-ttu-id="d4fdc-130">O RAS serializa chamadas para a DLL de administração.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-130">RAS serializes calls into the administration DLL.</span></span> <span data-ttu-id="d4fdc-131">Uma chamada em uma das funções da DLL para um determinado cliente RAS nunca será admitida por uma chamada para essa função para um cliente RAS diferente; a chamada inicial é garantida para ser concluída antes que o RAS chame a função para o outro cliente.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-131">A call into one of the DLL's functions for a given RAS client will never be preempted by a call to that function for a different RAS client; the initial call is guaranteed to be complete before RAS calls the function for the other client.</span></span> <span data-ttu-id="d4fdc-132">Além disso, a serialização se estende a determinados grupos de funções.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-132">Furthermore, serialization extends to certain groups of functions.</span></span> <span data-ttu-id="d4fdc-133">As funções de endereço IP são serializadas como um grupo; uma chamada para [**RasAdminGetIpAddressForUser**](rasadmingetipaddressforuser.md) ou [**RasAdminReleaseIpAddress**](rasadminreleaseipaddress.md) bloqueará chamadas em ambos até que a chamada inicial seja concluída.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-133">The IP address functions are serialized as a group; a call into either [**RasAdminGetIpAddressForUser**](rasadmingetipaddressforuser.md) or [**RasAdminReleaseIpAddress**](rasadminreleaseipaddress.md) will block calls into both until the initial call is complete.</span></span> <span data-ttu-id="d4fdc-134">[**RasAdminAcceptNewConnection**](rasadminacceptnewconnection.md) e [**RasAdminConnectionHangupNotification**](rasadminconnectionhangupnotification.md) também são serializados como um grupo.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-134">[**RasAdminAcceptNewConnection**](rasadminacceptnewconnection.md) and [**RasAdminConnectionHangupNotification**](rasadminconnectionhangupnotification.md) are also serialized as a group.</span></span>

<span data-ttu-id="d4fdc-135">O RAS executa as funções para atribuir endereços IP em um processo e executa as funções de notificações de conexão e desconexão em outro processo.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-135">RAS executes the functions for assigning IP addresses in one process and executes the functions for connection and disconnection notifications in another process.</span></span> <span data-ttu-id="d4fdc-136">Consequentemente, a DLL não deve depender de dados compartilhados entre os dois conjuntos de funções.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-136">Consequently, the DLL should not depend on shared data between the two sets of functions.</span></span>

<span data-ttu-id="d4fdc-137">O servidor RAS registra um erro no log de eventos do sistema se ocorrer um erro ao tentar carregar uma DLL de administração de RAS ou ao chamar uma das funções da DLL.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-137">The RAS server logs an error in the system event log if an error occurs when it tries to load a RAS administration DLL or when calling one of the DLL's functions.</span></span> <span data-ttu-id="d4fdc-138">Isso pode acontecer, por exemplo, se a DLL especificou o nome errado para uma função exportada ou se ela não incluía o nome da função no arquivo. def.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-138">This can happen, for example, if the DLL specified the wrong name for an exported function, or if it did not include the function name in the .def file.</span></span> <span data-ttu-id="d4fdc-139">A entrada no log de eventos indica o motivo da falha.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-139">The entry in the event log indicates the reason for the failure.</span></span>

<span data-ttu-id="d4fdc-140">**Windows 2000 Server e posterior:** As DLLs de administração de RAS que implementam essa interface de função não funcionam mais.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-140">**Windows 2000 Server and later:** RAS administration DLLs that implement this function interface no longer work.</span></span> <span data-ttu-id="d4fdc-141">Em vez disso, use a interface de função MprAdmin fornecida com as versões mais recentes do Windows.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-141">Instead, use the MprAdmin function interface provided with the more recent versions of Windows.</span></span> <span data-ttu-id="d4fdc-142">Para obter mais informações, consulte a [referência de administração de Ras](remote-access-service-administration-reference.md) na documentação de roteamento e RAS.</span><span class="sxs-lookup"><span data-stu-id="d4fdc-142">For more information, see the [RAS Administration Reference](remote-access-service-administration-reference.md) in the Routing and RAS documentation.</span></span>

 

 




