---
title: Script personalizado de RAS
description: Os desenvolvedores podem criar uma DLL de script personalizado que resida em um computador cliente RAS. Essa DLL pode se comunicar com o servidor durante o processo de estabelecimento de uma conexão.
ms.assetid: c27b8b02-6018-4441-a355-1fb890b9001c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c625f020d9dafcb352c5f1b382014f9dba189330
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103917412"
---
# <a name="ras-custom-scripting"></a><span data-ttu-id="d3cec-104">Script personalizado de RAS</span><span class="sxs-lookup"><span data-stu-id="d3cec-104">RAS Custom Scripting</span></span>

<span data-ttu-id="d3cec-105">Os desenvolvedores podem criar uma DLL de script personalizado que resida em um computador cliente RAS.</span><span class="sxs-lookup"><span data-stu-id="d3cec-105">Developers can create a custom-scripting DLL that resides on a RAS client computer.</span></span> <span data-ttu-id="d3cec-106">Essa DLL pode se comunicar com o servidor durante o processo de estabelecimento de uma conexão.</span><span class="sxs-lookup"><span data-stu-id="d3cec-106">This DLL can communicate with the server during the process of establishing a connection.</span></span>

<span data-ttu-id="d3cec-107">**Windows NT:** O script personalizado não está disponível.</span><span class="sxs-lookup"><span data-stu-id="d3cec-107">**Windows NT:** Custom scripting is not available.</span></span>

## <a name="setting-up-the-dll"></a><span data-ttu-id="d3cec-108">Configurando a DLL</span><span class="sxs-lookup"><span data-stu-id="d3cec-108">Setting up the DLL</span></span>

<span data-ttu-id="d3cec-109">Para configurar a DLL, crie um valor com o nome **CustomScriptDllPath** na seguinte chave do registro:</span><span class="sxs-lookup"><span data-stu-id="d3cec-109">To set up the DLL, create a value with the name **CustomScriptDllPath** under the following registry key:</span></span>

```
HKEY_LOCAL_MACHINE
   System
      CurrentControlSet
         Services
            Rasman
               Parameters
```

<span data-ttu-id="d3cec-110">Esse valor deve ser do tipo **reg \_ expande \_ sz**.</span><span class="sxs-lookup"><span data-stu-id="d3cec-110">This value should be of type **REG\_EXPAND\_SZ**.</span></span> <span data-ttu-id="d3cec-111">O valor deve conter o caminho para a DLL de script personalizado.</span><span class="sxs-lookup"><span data-stu-id="d3cec-111">The value should contain the path to the custom-scripting DLL.</span></span> <span data-ttu-id="d3cec-112">Somente uma DLL de script personalizado tem suporte para cada computador cliente RAS.</span><span class="sxs-lookup"><span data-stu-id="d3cec-112">Only one custom-scripting DLL is supported for each RAS client computer.</span></span>

## <a name="interaction-between-the-server-ras-and-the-custom-scripting-dll"></a><span data-ttu-id="d3cec-113">Interação entre o servidor, o RAS e o Custom-Scripting DLL</span><span class="sxs-lookup"><span data-stu-id="d3cec-113">Interaction Between the Server, RAS, and the Custom-Scripting DLL</span></span>

<span data-ttu-id="d3cec-114">A DLL de script personalizado deve exportar um único ponto de entrada: [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span><span class="sxs-lookup"><span data-stu-id="d3cec-114">The custom scripting DLL should export a single entry point: [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span></span> <span data-ttu-id="d3cec-115">O RAS chama essa função durante o \_ estado interativo do RASCS do processo de conexão.</span><span class="sxs-lookup"><span data-stu-id="d3cec-115">RAS calls this function during the RASCS\_Interactive state of the connection process.</span></span> <span data-ttu-id="d3cec-116">O \_ estado interativo do RASCS é um estado de pausa, que permite ao usuário interagir com uma interface do usuário apresentada pela DLL de script personalizado.</span><span class="sxs-lookup"><span data-stu-id="d3cec-116">The RASCS\_Interactive state is a paused state, which allows the user to interact with a user interface presented by the custom-scripting DLL.</span></span> <span data-ttu-id="d3cec-117">Consulte [**RASCONNSTATE**](/previous-versions/windows/desktop/legacy/aa376727(v=vs.85)) para obter mais informações sobre Estados de conexão.</span><span class="sxs-lookup"><span data-stu-id="d3cec-117">See [**RASCONNSTATE**](/previous-versions/windows/desktop/legacy/aa376727(v=vs.85)) for more information about connection states.</span></span>

<span data-ttu-id="d3cec-118">O RAS passará como parâmetros para a função [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) :</span><span class="sxs-lookup"><span data-stu-id="d3cec-118">RAS will pass as parameters to the [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) function:</span></span>

-   <span data-ttu-id="d3cec-119">Um identificador para a porta no computador cliente que está sendo usado para a conexão.</span><span class="sxs-lookup"><span data-stu-id="d3cec-119">A handle to the port on the client computer that is being used for the connection.</span></span>
-   <span data-ttu-id="d3cec-120">Cadeias de caracteres que identificam o catálogo telefônico e a entrada para a conexão.</span><span class="sxs-lookup"><span data-stu-id="d3cec-120">Strings that identify the phone book and entry for the connection.</span></span>
-   <span data-ttu-id="d3cec-121">O RAS também passa um identificador para uma janela para permitir que a DLL apresente uma interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="d3cec-121">RAS also passes in a handle to a window to enable the DLL to present a user interface.</span></span>
-   <span data-ttu-id="d3cec-122">Um conjunto de ponteiros de função que a DLL pode usar para se comunicar com o servidor.</span><span class="sxs-lookup"><span data-stu-id="d3cec-122">A set of function pointers that the DLL can use to communicate with the server.</span></span>

<span data-ttu-id="d3cec-123">Consulte [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) para obter mais informações sobre esses parâmetros.</span><span class="sxs-lookup"><span data-stu-id="d3cec-123">See [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) for more information about these parameters.</span></span>

<span data-ttu-id="d3cec-124">O RAS passa um ponteiro para uma estrutura [**RASCUSTOMSCRIPTEXTENSIONS**](/previous-versions/windows/desktop/legacy/aa376738(v=vs.85)) como o último parâmetro para [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span><span class="sxs-lookup"><span data-stu-id="d3cec-124">RAS passes a pointer to a [**RASCUSTOMSCRIPTEXTENSIONS**](/previous-versions/windows/desktop/legacy/aa376738(v=vs.85)) structure as the last parameter to [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn).</span></span> <span data-ttu-id="d3cec-125">Essa estrutura contém um ponteiro para uma função do tipo [**PFNRASSETCOMMSETTINGS**](/windows/desktop/api/Ras/nc-ras-pfnrassetcommsettings).</span><span class="sxs-lookup"><span data-stu-id="d3cec-125">This structure contains a pointer to a function of type [**PFNRASSETCOMMSETTINGS**](/windows/desktop/api/Ras/nc-ras-pfnrassetcommsettings).</span></span> <span data-ttu-id="d3cec-126">A DLL de script personalizado chama essa função para modificar as configurações de comunicação na porta usada pela conexão.</span><span class="sxs-lookup"><span data-stu-id="d3cec-126">The custom-scripting DLL calls this function to modify the communication settings on the port being used by the connection.</span></span>

<span data-ttu-id="d3cec-127">O RAS Media a interação entre o servidor e a DLL de script personalizado.</span><span class="sxs-lookup"><span data-stu-id="d3cec-127">RAS mediates the interaction between the server and the custom-scripting DLL.</span></span> <span data-ttu-id="d3cec-128">Normalmente, o servidor inicia a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="d3cec-128">Typically, the server initiates the dialog.</span></span> <span data-ttu-id="d3cec-129">Por exemplo, o servidor pode solicitar o nome de usuário e a senha do usuário.</span><span class="sxs-lookup"><span data-stu-id="d3cec-129">For example, the server may request the user name and password of the user.</span></span>

<span data-ttu-id="d3cec-130">Ao usar o script personalizado para estabelecer uma conexão, o servidor não precisa estar executando o Windows NT 4,0 ou o Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="d3cec-130">When using custom-scripting to establish a connection, the server need not be running Windows NT 4.0 or Windows 2000.</span></span>

## <a name="custom-scripting-user-interface-must-support-idcancel"></a><span data-ttu-id="d3cec-131">A interface do usuário de script personalizado deve dar suporte a IDCANCEL</span><span class="sxs-lookup"><span data-stu-id="d3cec-131">Custom Scripting User Interface Must Support IDCANCEL</span></span>

<span data-ttu-id="d3cec-132">Se a discagem personalizada exibir uma interface do usuário, a interface do usuário deverá dar suporte a \_ mensagens de comando do WM em que LOWORD (*wParam*) seja igual a IDCANCEL.</span><span class="sxs-lookup"><span data-stu-id="d3cec-132">If the custom dialer displays a user interface, the user interface must support WM\_COMMAND messages where LOWORD(*wParam*) equals IDCANCEL.</span></span>

## <a name="configuring-the-connection"></a><span data-ttu-id="d3cec-133">Configurando a conexão</span><span class="sxs-lookup"><span data-stu-id="d3cec-133">Configuring the Connection</span></span>

<span data-ttu-id="d3cec-134">O ponto de entrada [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) pode ser chamado de [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) ou, no Windows XP, de [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala).</span><span class="sxs-lookup"><span data-stu-id="d3cec-134">The [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) entry point can be invoked from [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) or, on Windows XP, from [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala).</span></span>

<span data-ttu-id="d3cec-135">Para invocar [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) de [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga), defina a \_ opção RASEO CustomScript na entrada do catálogo telefônico para a conexão.</span><span class="sxs-lookup"><span data-stu-id="d3cec-135">To invoke [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) from [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga), set the RASEO\_CustomScript option in the phone-book entry for the connection.</span></span> <span data-ttu-id="d3cec-136">Consulte o membro **dwfOptions** de [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) para obter uma descrição das opções de entrada de catálogo telefônico.</span><span class="sxs-lookup"><span data-stu-id="d3cec-136">See the **dwfOptions** member of [**RASENTRY**](/previous-versions/windows/desktop/legacy/aa377274(v=vs.85)) for a description of phone-book entry options.</span></span> <span data-ttu-id="d3cec-137">Use as funções [**RasGetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetentrypropertiesa) e [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) para definir essa opção programaticamente.</span><span class="sxs-lookup"><span data-stu-id="d3cec-137">Use the [**RasGetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rasgetentrypropertiesa) and [**RasSetEntryProperties**](/windows/desktop/api/Ras/nf-ras-rassetentrypropertiesa) functions to set this option programmatically.</span></span>

<span data-ttu-id="d3cec-138">**Windows XP:** Para invocar [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) de [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala), a chamada para **RasDial** deve especificar uma estrutura [**RASDIALEXTENSIONS**](/previous-versions/windows/desktop/legacy/aa377029(v=vs.85)) , e essa estrutura deve especificar o \_ sinalizador RDEOPT UseCustomScripting.</span><span class="sxs-lookup"><span data-stu-id="d3cec-138">**Windows XP:** To invoke [**RasCustomScriptExecute**](/windows/desktop/api/Ras/nc-ras-rascustomscriptexecutefn) from [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala), the call to **RasDial** must specify a [**RASDIALEXTENSIONS**](/previous-versions/windows/desktop/legacy/aa377029(v=vs.85)) structure, and this structure must specify the RDEOPT\_UseCustomScripting flag.</span></span> <span data-ttu-id="d3cec-139">Além disso, a entrada do catálogo telefônico para a conexão deve especificar a \_ opção RASEO CustomScript, conforme descrito no parágrafo anterior.</span><span class="sxs-lookup"><span data-stu-id="d3cec-139">In addition, the phone-book entry for the connection must specify the RASEO\_CustomScript option as described in the preceding paragraph.</span></span>

## <a name="invoking-the-custom-scripting-dll"></a><span data-ttu-id="d3cec-140">Invocando a DLL de script personalizado</span><span class="sxs-lookup"><span data-stu-id="d3cec-140">Invoking the Custom Scripting DLL</span></span>

<span data-ttu-id="d3cec-141">Se o usuário ativar uma conexão para uma entrada de catálogo telefônico que tenha RASEO \_ CustomScript definido, o RAS invocará a DLL de script personalizado.</span><span class="sxs-lookup"><span data-stu-id="d3cec-141">If the user activates a connection for a phone-book entry that has RASEO\_CustomScript set, RAS invokes the custom-scripting DLL.</span></span> <span data-ttu-id="d3cec-142">Nesse cenário, o RAS invoca a DLL de script personalizado de [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga).</span><span class="sxs-lookup"><span data-stu-id="d3cec-142">In this scenario, RAS invokes the custom-scripting DLL from [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga).</span></span>

<span data-ttu-id="d3cec-143">Para invocar a DLL de script personalizado programaticamente, estabeleça a conexão usando a função [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) .</span><span class="sxs-lookup"><span data-stu-id="d3cec-143">To invoke the custom-scripting DLL programmatically, establish the connection using the [**RasDialDlg**](/windows/desktop/api/Rasdlg/nf-rasdlg-rasdialdlga) function.</span></span> <span data-ttu-id="d3cec-144">No Windows XP, a função [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) também invoca a DLL de script personalizado.</span><span class="sxs-lookup"><span data-stu-id="d3cec-144">On Windows XP, the [**RasDial**](/windows/desktop/api/Ras/nf-ras-rasdiala) function also invokes the custom-scripting DLL.</span></span>

 

 