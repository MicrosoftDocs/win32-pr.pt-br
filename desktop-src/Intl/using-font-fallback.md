---
description: Usando fallback de fonte
ms.assetid: 952f33b6-ca52-40a2-b914-52c1c62ae0e0
title: Usando fallback de fonte
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9afb073a01cc1c5b90d4a4861a973846d3ae9ae1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103663483"
---
# <a name="using-font-fallback"></a><span data-ttu-id="1cd24-103">Usando fallback de fonte</span><span class="sxs-lookup"><span data-stu-id="1cd24-103">Using Font Fallback</span></span>

> [!Note]  
> <span data-ttu-id="1cd24-104">Neste tópico, todos os comentários sobre [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) aplicam-se igualmente a [**ScriptShapeOpenType**](/windows/desktop/api/Usp10/nf-usp10-scriptshapeopentype).</span><span class="sxs-lookup"><span data-stu-id="1cd24-104">In this topic, all remarks about [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) apply equally to [**ScriptShapeOpenType**](/windows/desktop/api/Usp10/nf-usp10-scriptshapeopentype).</span></span>

 

<span data-ttu-id="1cd24-105">Seu aplicativo deve usar o fallback de fonte durante a exibição de texto se alguns caracteres em uma cadeia de caracteres não forem suportados na fonte ou se o aplicativo usar um [script complexo](uniscribe-glossary.md) sem suporte da fonte.</span><span class="sxs-lookup"><span data-stu-id="1cd24-105">Your application must use font fallback during text display if some characters in a string are not supported in the font, or if the application uses a [complex script](uniscribe-glossary.md) not supported by the font.</span></span> <span data-ttu-id="1cd24-106">O requisito para o fallback de fonte é detectado durante o processo de layout para texto, quando o aplicativo chama a função [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) .</span><span class="sxs-lookup"><span data-stu-id="1cd24-106">The requirement for font fallback is detected during the layout process for text, when the application calls the [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) function.</span></span> <span data-ttu-id="1cd24-107">Para obter informações sobre a exibição de texto, consulte [exibindo texto com o Uniscribe](displaying-text-with-uniscribe.md).</span><span class="sxs-lookup"><span data-stu-id="1cd24-107">For information about text display, see [Displaying Text with Uniscribe](displaying-text-with-uniscribe.md).</span></span>

## <a name="determine-the-need-for-font-fallback-for-unsupported-characters"></a><span data-ttu-id="1cd24-108">Determinar a necessidade de fallback de fonte para caracteres sem suporte</span><span class="sxs-lookup"><span data-stu-id="1cd24-108">Determine the Need for Font Fallback for Unsupported Characters</span></span>

<span data-ttu-id="1cd24-109">Se alguns dos caracteres em uma cadeia de caracteres não forem suportados em uma fonte solicitada, uma chamada de aplicativo para [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) terá sucesso.</span><span class="sxs-lookup"><span data-stu-id="1cd24-109">If some of the characters in a string are not supported in a requested font, an application call to [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) succeeds.</span></span> <span data-ttu-id="1cd24-110">No entanto, o aplicativo deve verificar o buffer de saída de glifo para a presença de glifos ausentes.</span><span class="sxs-lookup"><span data-stu-id="1cd24-110">However, the application must scan the glyph output buffer for the presence of missing glyphs.</span></span> <span data-ttu-id="1cd24-111">O índice de glifo do glifo ausente pode ser determinado para uma fonte específica chamando [**ScriptGetFontProperties**](/windows/desktop/api/Usp10/nf-usp10-scriptgetfontproperties).</span><span class="sxs-lookup"><span data-stu-id="1cd24-111">The glyph index of the missing glyph can be determined for a specific font by calling [**ScriptGetFontProperties**](/windows/desktop/api/Usp10/nf-usp10-scriptgetfontproperties).</span></span> <span data-ttu-id="1cd24-112">Se um glifo específico não estiver disponível, o aplicativo deverá retornar a uma fonte diferente para um glifo ou renderizar um símbolo gráfico que indica que nenhum glifo está disponível.</span><span class="sxs-lookup"><span data-stu-id="1cd24-112">If a particular glyph is unavailable, the application must either fall back to a different font for a glyph or render a graphic symbol that indicates that no glyph is available.</span></span>

## <a name="determine-the-need-for-font-fallback-for-unsupported-complex-scripts"></a><span data-ttu-id="1cd24-113">Determinar a necessidade de fallback de fonte para scripts complexos sem suporte</span><span class="sxs-lookup"><span data-stu-id="1cd24-113">Determine the Need for Font Fallback for Unsupported Complex Scripts</span></span>

<span data-ttu-id="1cd24-114">A fonte que um aplicativo prefere para exibição pode não dar suporte a um script complexo exigido pelo texto.</span><span class="sxs-lookup"><span data-stu-id="1cd24-114">The font that an application prefers for display might not support a complex script that is required by the text.</span></span> <span data-ttu-id="1cd24-115">Nesse caso, a chamada de aplicativo para [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) falha com o código de erro E o \_ script que não está \_ \_ na \_ fonte.</span><span class="sxs-lookup"><span data-stu-id="1cd24-115">In this case, the application call to [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) fails with the error code E\_SCRIPT\_NOT\_IN\_FONT.</span></span>

## <a name="assign-a-fallback-font"></a><span data-ttu-id="1cd24-116">Atribuir uma fonte de fallback</span><span class="sxs-lookup"><span data-stu-id="1cd24-116">Assign a Fallback Font</span></span>

<span data-ttu-id="1cd24-117">Depois de determinar que o fallback de fonte é necessário, o aplicativo deve atribuir uma fonte de fallback.</span><span class="sxs-lookup"><span data-stu-id="1cd24-117">Once it has determined that font fallback is required, the application must assign a fallback font.</span></span> <span data-ttu-id="1cd24-118">O aplicativo pode tentar as seguintes técnicas:</span><span class="sxs-lookup"><span data-stu-id="1cd24-118">The application can try the following techniques:</span></span>

-   <span data-ttu-id="1cd24-119">Chame [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) para cada fonte em uma lista de fontes até que uma chamada tenha um retorno aceitável.</span><span class="sxs-lookup"><span data-stu-id="1cd24-119">Call [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) for each font in a font list until one call has an acceptable return.</span></span>
-   <span data-ttu-id="1cd24-120">Chame [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) com cada fonte em uma lista até que seja possível determinar que nenhuma fonte terá sucesso.</span><span class="sxs-lookup"><span data-stu-id="1cd24-120">Call [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) with each font in a list until it can be determined that no font will succeed.</span></span> <span data-ttu-id="1cd24-121">Se o código de erro for sempre E o \_ script \_ não \_ \_ estiver na fonte, não haverá suporte para um script complexo nas fontes.</span><span class="sxs-lookup"><span data-stu-id="1cd24-121">If the error code is always E\_SCRIPT\_NOT\_IN\_FONT, a complex script is not supported by the fonts.</span></span> <span data-ttu-id="1cd24-122">Processe um símbolo gráfico que indica que nenhum glifo está disponível ou especifique o script novamente como indefinido (sem processamento de script) e inicie novamente.</span><span class="sxs-lookup"><span data-stu-id="1cd24-122">Either render a graphic symbol that indicates that no glyph is available, or re-specify the script as undefined (no script processing) and start again.</span></span> <span data-ttu-id="1cd24-123">Para definir o script como indefinido, defina o membro **eScript** da estrutura [**de \_ análise de script**](/windows/win32/api/usp10/ns-usp10-script_analysis) como script \_ undefined.</span><span class="sxs-lookup"><span data-stu-id="1cd24-123">To set the script as undefined, set the **eScript** member of the [**SCRIPT\_ANALYSIS**](/windows/win32/api/usp10/ns-usp10-script_analysis) structure to SCRIPT\_UNDEFINED.</span></span>
-   <span data-ttu-id="1cd24-124">Chame [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) com cada fonte em uma lista até que seja possível determinar que nenhuma fonte terá sucesso.</span><span class="sxs-lookup"><span data-stu-id="1cd24-124">Call [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) with each font in a list until it can be determined that no font will succeed.</span></span> <span data-ttu-id="1cd24-125">Se o código de erro indicar que alguns dos caracteres estão sendo mapeados para glifos ausentes, divida a cadeia de caracteres em intervalos menores.</span><span class="sxs-lookup"><span data-stu-id="1cd24-125">If the error code indicates that some of the characters are mapping to missing glyphs, break up the string into smaller ranges.</span></span> <span data-ttu-id="1cd24-126">Diferentes fontes podem ser atribuídas a subintervalos para que mais caracteres possam ser renderizados.</span><span class="sxs-lookup"><span data-stu-id="1cd24-126">Different fonts can be assigned to subranges so that more of the characters can be rendered.</span></span>

## <a name="generate-glyph-information"></a><span data-ttu-id="1cd24-127">Gerar informações de glifo</span><span class="sxs-lookup"><span data-stu-id="1cd24-127">Generate Glyph Information</span></span>

<span data-ttu-id="1cd24-128">Depois que o aplicativo tiver atribuído uma fonte com sucesso em chamadas para [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape), ele poderá fazer chamadas para [**ScriptPlace**](/windows/desktop/api/Usp10/nf-usp10-scriptplace) para gerar a largura de avanço de glifo e informações de deslocamento bidimensionais da saída de **ScriptShape**.</span><span class="sxs-lookup"><span data-stu-id="1cd24-128">Once the application has assigned a font that succeeds in calls to [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape), it can make calls to [**ScriptPlace**](/windows/desktop/api/Usp10/nf-usp10-scriptplace) to generate glyph advance width and two-dimensional offset information from the output of **ScriptShape**.</span></span> <span data-ttu-id="1cd24-129">A fonte deve ter sucesso nessas chamadas.</span><span class="sxs-lookup"><span data-stu-id="1cd24-129">The font should succeed in these calls.</span></span> <span data-ttu-id="1cd24-130">Uma falha de fonte em uma chamada para **ScriptPlace** após o êxito em uma chamada **ScriptShape** indica uma fonte quebrada.</span><span class="sxs-lookup"><span data-stu-id="1cd24-130">A font failure in a call to **ScriptPlace** after success in a **ScriptShape** call indicates a broken font.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1cd24-131">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="1cd24-131">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1cd24-132">Usando o Uniscribe</span><span class="sxs-lookup"><span data-stu-id="1cd24-132">Using Uniscribe</span></span>](using-uniscribe.md)
</dt> </dl>

 

 



