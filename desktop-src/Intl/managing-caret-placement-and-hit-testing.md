---
description: As linguagens de script complexo são divididas em clusters por ScriptShape. A reordenação de caracteres sempre ocorre dentro dos limites do cluster. Os clusters em si têm garantia de antecedência na direção da ordem de leitura.
ms.assetid: 50b4b643-af96-4a6f-80f9-27a71ce16b0e
title: Gerenciando posicionamento de cursor e teste de clique
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 60396a668c89f7392b28adde0bb123060bf50348
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105757800"
---
# <a name="managing-caret-placement-and-hit-testing"></a><span data-ttu-id="c368c-105">Gerenciando posicionamento de cursor e teste de clique</span><span class="sxs-lookup"><span data-stu-id="c368c-105">Managing Caret Placement and Hit Testing</span></span>

<span data-ttu-id="c368c-106">As linguagens de script complexo são divididas em [clusters](uniscribe-glossary.md) por [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape).</span><span class="sxs-lookup"><span data-stu-id="c368c-106">Complex script languages are broken into [clusters](uniscribe-glossary.md) by [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape).</span></span> <span data-ttu-id="c368c-107">A reordenação de caracteres sempre ocorre dentro dos limites do cluster.</span><span class="sxs-lookup"><span data-stu-id="c368c-107">Character reordering always occurs within cluster boundaries.</span></span> <span data-ttu-id="c368c-108">Os clusters em si têm garantia de antecedência na direção da ordem de leitura.</span><span class="sxs-lookup"><span data-stu-id="c368c-108">The clusters themselves are guaranteed to advance in the direction of the reading order.</span></span>

<span data-ttu-id="c368c-109">As informações de cluster na matriz de cluster lógico são usadas para compartilhar a largura de um cluster de glifos igualmente entre os caracteres lógicos que eles representam.</span><span class="sxs-lookup"><span data-stu-id="c368c-109">Cluster information in the logical cluster array is used to share the width of a cluster of glyphs equally among the logical characters they represent.</span></span> <span data-ttu-id="c368c-110">Por exemplo, o glifo Lam Alef é dividido em quatro áreas:</span><span class="sxs-lookup"><span data-stu-id="c368c-110">For example, the lam alef glyph is divided into four areas:</span></span>

-   <span data-ttu-id="c368c-111">A metade líder do Lam.</span><span class="sxs-lookup"><span data-stu-id="c368c-111">The leading half of the lam.</span></span>
-   <span data-ttu-id="c368c-112">A metade à direita do Lam.</span><span class="sxs-lookup"><span data-stu-id="c368c-112">The trailing half of the lam.</span></span>
-   <span data-ttu-id="c368c-113">A metade líder do Alef.</span><span class="sxs-lookup"><span data-stu-id="c368c-113">The leading half of the alef.</span></span>
-   <span data-ttu-id="c368c-114">A metade à direita do Alef.</span><span class="sxs-lookup"><span data-stu-id="c368c-114">The trailing half of the alef.</span></span>

<span data-ttu-id="c368c-115">As convenções para o posicionamento do cursor nos clusters dependem do script.</span><span class="sxs-lookup"><span data-stu-id="c368c-115">Conventions for caret placement within clusters depend on the script.</span></span> <span data-ttu-id="c368c-116">Para o script em árabe, se a posição do cursor estiver definida entre um caractere base e sua marca de combinação, o cursor será exibido na metade do caractere base.</span><span class="sxs-lookup"><span data-stu-id="c368c-116">For the Arabic script, if the caret position is set between a base character and its combining mark, the caret is displayed halfway through the base character.</span></span> <span data-ttu-id="c368c-117">Para o script tailandês, o cursor não pode ser posicionado em um cluster.</span><span class="sxs-lookup"><span data-stu-id="c368c-117">For the Thai script, the caret cannot be positioned within a cluster.</span></span> <span data-ttu-id="c368c-118">Portanto, quando o usuário avança o cursor, o aplicativo deve avançar todos os glifos que compõem o cluster.</span><span class="sxs-lookup"><span data-stu-id="c368c-118">Thus, when the user advances the caret, the application must advance past all the glyphs that make up the cluster.</span></span>

<span data-ttu-id="c368c-119">As funções [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) e [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) convertem entre posições de cursor (em deslocamentos de ponto de código) e posições x (em pixels).</span><span class="sxs-lookup"><span data-stu-id="c368c-119">The [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) and [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) functions translate between caret positions (in code point offsets) and x positions (in pixels).</span></span> <span data-ttu-id="c368c-120">A função **ScriptXtoCP** tem conhecimento das convenções de posição de cursor de cada script:</span><span class="sxs-lookup"><span data-stu-id="c368c-120">The **ScriptXtoCP** function has knowledge of the caret position conventions of each script:</span></span>

-   <span data-ttu-id="c368c-121">Para Índico e tailandês, as posições do cursor são ajustadas aos limites do cluster.</span><span class="sxs-lookup"><span data-stu-id="c368c-121">For Indian and Thai, caret positions are snapped to cluster boundaries.</span></span>
-   <span data-ttu-id="c368c-122">Para árabe, as posições de cursor são interpoladas com clusters.</span><span class="sxs-lookup"><span data-stu-id="c368c-122">For Arabic, caret positions are interpolated with clusters.</span></span>
-   <span data-ttu-id="c368c-123">Para o Hebraico, em versões anteriores à Usp10.dll, a versão 1,420, as posições de cursor são interpoladas com clusters.</span><span class="sxs-lookup"><span data-stu-id="c368c-123">For Hebrew, in versions prior to Usp10.dll, version 1.420, caret positions are interpolated with clusters.</span></span> <span data-ttu-id="c368c-124">A partir do Usp10.dll, a versão 1,420, as posições do cursor são ajustadas aos limites do cluster.</span><span class="sxs-lookup"><span data-stu-id="c368c-124">Beginning with Usp10.dll, version 1.420, caret positions are snapped to cluster boundaries.</span></span>

<span data-ttu-id="c368c-125">[**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) e [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) funcionam somente em execuções.</span><span class="sxs-lookup"><span data-stu-id="c368c-125">Both [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) and [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) operate only within runs.</span></span> <span data-ttu-id="c368c-126">As funções exigem que determinados parâmetros venham de chamadas anteriores ao Uniscribe, conforme mostrado na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="c368c-126">The functions require that certain parameters come from earlier Uniscribe calls, as shown in the following table.</span></span>



| <span data-ttu-id="c368c-127">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="c368c-127">Parameter</span></span>                                        | <span data-ttu-id="c368c-128">Fonte</span><span class="sxs-lookup"><span data-stu-id="c368c-128">Source</span></span>                                                 |
|--------------------------------------------------|--------------------------------------------------------|
| <span data-ttu-id="c368c-129">*PSA*</span><span class="sxs-lookup"><span data-stu-id="c368c-129">*psa*</span></span>                                            | <span data-ttu-id="c368c-130">Conforme retornado por [**ScriptItemize**](/windows/desktop/api/Usp10/nf-usp10-scriptitemize).</span><span class="sxs-lookup"><span data-stu-id="c368c-130">As returned by [**ScriptItemize**](/windows/desktop/api/Usp10/nf-usp10-scriptitemize).</span></span> |
| <span data-ttu-id="c368c-131">*cGlyphspwLogClust*</span><span class="sxs-lookup"><span data-stu-id="c368c-131">*cGlyphspwLogClust*</span></span><br/> <span data-ttu-id="c368c-132">*psva*</span><span class="sxs-lookup"><span data-stu-id="c368c-132">*psva*</span></span><br/> | <span data-ttu-id="c368c-133">Conforme retornado por [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape).</span><span class="sxs-lookup"><span data-stu-id="c368c-133">As returned by [**ScriptShape**](/windows/desktop/api/Usp10/nf-usp10-scriptshape).</span></span>     |
| <span data-ttu-id="c368c-134">*piAdvance*</span><span class="sxs-lookup"><span data-stu-id="c368c-134">*piAdvance*</span></span>                                      | <span data-ttu-id="c368c-135">Conforme retornado por [**ScriptPlace**](/windows/desktop/api/Usp10/nf-usp10-scriptplace).</span><span class="sxs-lookup"><span data-stu-id="c368c-135">As returned by [**ScriptPlace**](/windows/desktop/api/Usp10/nf-usp10-scriptplace).</span></span>     |



 

<span data-ttu-id="c368c-136">O aplicativo deve estabelecer a execução em que um determinado deslocamento de interpolação ou posição x é antes de passar as informações para [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) ou [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp).</span><span class="sxs-lookup"><span data-stu-id="c368c-136">The application must establish the run in which a given caret offset or x position is before passing the information to [**ScriptCPtoX**](/windows/desktop/api/Usp10/nf-usp10-scriptcptox) or [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp).</span></span> <span data-ttu-id="c368c-137">Se o aplicativo não salvar as informações de largura, ele poderá fazer testes de clique e o posicionamento do cursor depois de exibir cada execução.</span><span class="sxs-lookup"><span data-stu-id="c368c-137">If the application does not save the width information, it can do hit testing and caret placement after displaying each run.</span></span> <span data-ttu-id="c368c-138">Como alternativa, o aplicativo pode armazenar em cache informações suficientes para o teste de clique e o posicionamento do cursor na linha atual, sem a necessidade de reprocessar o parágrafo.</span><span class="sxs-lookup"><span data-stu-id="c368c-138">As an alternative, the application can cache enough information to do hit testing and caret placement on the current line without requiring reprocessing of the paragraph.</span></span>

<span data-ttu-id="c368c-139">[**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) retorna um valor de borda à direita para que o aplicativo saiba o lado do caractere ou cluster no qual o usuário clicou.</span><span class="sxs-lookup"><span data-stu-id="c368c-139">[**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) returns a trailing edge value so that the application knows the side of the character or cluster on which the user has clicked.</span></span> <span data-ttu-id="c368c-140">O valor é 0 ou a largura do caractere ou do cluster em pontos de código.</span><span class="sxs-lookup"><span data-stu-id="c368c-140">The value is either 0 or the width of the character or cluster in code points.</span></span> <span data-ttu-id="c368c-141">A posição do caractere retornado é a posição do caractere em que o usuário clicou.</span><span class="sxs-lookup"><span data-stu-id="c368c-141">The returned character position is the position of the character on which the user clicked.</span></span> <span data-ttu-id="c368c-142">Para obter mais informações, consulte [exibindo o cursor em cadeias bidirecionais](displaying-the-caret-in-bidirectional-strings.md).</span><span class="sxs-lookup"><span data-stu-id="c368c-142">For more information, see [Displaying the Caret in Bidirectional Strings](displaying-the-caret-in-bidirectional-strings.md).</span></span>

<span data-ttu-id="c368c-143">Para idiomas como tailandês, para os quais o usuário não deseja posicionar o cursor em um cluster, [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) define o sinalizador do lado à direita como 0 ou a largura do cluster.</span><span class="sxs-lookup"><span data-stu-id="c368c-143">For languages such as Thai, for which the user conventionally does not want to place the caret into a cluster, [**ScriptXtoCP**](/windows/desktop/api/Usp10/nf-usp10-scriptxtocp) sets the trailing side flag to 0 or to the cluster width.</span></span> <span data-ttu-id="c368c-144">Para idiomas como o árabe, para o qual o usuário espera ser capaz de editar em um cluster, **ScriptXtoCP** define o sinalizador de lado à direita como 0 ou como 1.</span><span class="sxs-lookup"><span data-stu-id="c368c-144">For languages such as Arabic, for which the user expects to be able to edit within a cluster, **ScriptXtoCP** sets the trailing side flag to 0 or to 1.</span></span>

<span data-ttu-id="c368c-145">Para ajudar o aplicativo a estabelecer locais válidos para o cursor ao manipular as teclas de direção, o Uniscribe fornece informações sobre as posições de um cursor válido no membro **fCharStop** nos atributos lógicos retornados por [**ScriptBreak**](/windows/desktop/api/Usp10/nf-usp10-scriptbreak).</span><span class="sxs-lookup"><span data-stu-id="c368c-145">To help the application establish valid locations for the caret when handling the arrow keys, Uniscribe provides information on valid caret positions in the **fCharStop** member in the logical attributes returned by [**ScriptBreak**](/windows/desktop/api/Usp10/nf-usp10-scriptbreak).</span></span> <span data-ttu-id="c368c-146">**True** é retornado para a maioria dos caracteres e **false** para os caracteres entre clusters em scripts como tailandês.</span><span class="sxs-lookup"><span data-stu-id="c368c-146">**TRUE** is returned for most characters and **FALSE** for intercluster characters in scripts such as Thai.</span></span> <span data-ttu-id="c368c-147">O aplicativo deve verificar o valor de **fNeedsCaretInfo** na estrutura de [**\_ Propriedades de script**](/windows/desktop/api/Usp10/ns-usp10-script_properties) de um item para ver se é necessário chamar **ScriptBreak** para verificar se há posições de cursor válidas.</span><span class="sxs-lookup"><span data-stu-id="c368c-147">The application should check the **fNeedsCaretInfo** value in the [**SCRIPT\_PROPERTIES**](/windows/desktop/api/Usp10/ns-usp10-script_properties) structure for an item to see if it is necessary to call **ScriptBreak** to check for valid caret positions.</span></span> <span data-ttu-id="c368c-148">Se o valor de **fNeedsCaretInfo** for **false**, todos os pontos de código serão posições de cursor válidas.</span><span class="sxs-lookup"><span data-stu-id="c368c-148">If the **fNeedsCaretInfo** value is **FALSE**, all code points are valid caret positions.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c368c-149">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="c368c-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="c368c-150">Usando o Uniscribe</span><span class="sxs-lookup"><span data-stu-id="c368c-150">Using Uniscribe</span></span>](using-uniscribe.md)
</dt> </dl>

 

 




