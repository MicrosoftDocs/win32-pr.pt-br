---
description: Este tópico discute as instruções de programação para localizar cadeias de caracteres de registro redirecionadas. Para obter mais informações, consulte usando o redirecionamento de cadeia de caracteres do registro.
ms.assetid: 03d1512f-35a6-4b3a-9a0e-97e17bd9b126
title: Localizando cadeias de caracteres redirecionadas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f11600ad57c04de54d914c2c876b67967dfa1467
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105757832"
---
# <a name="locating-redirected-strings"></a><span data-ttu-id="f8c3a-104">Localizando cadeias de caracteres redirecionadas</span><span class="sxs-lookup"><span data-stu-id="f8c3a-104">Locating Redirected Strings</span></span>

<span data-ttu-id="f8c3a-105">Este tópico discute as instruções de programação para localizar cadeias de caracteres de registro redirecionadas.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-105">This topic discusses programming instructions for locating redirected registry strings.</span></span> <span data-ttu-id="f8c3a-106">Para obter mais informações, consulte [usando o redirecionamento de cadeia de caracteres do registro](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="f8c3a-106">For more information, see [Using Registry String Redirection](using-registry-string-redirection.md).</span></span>

## <a name="load-a-language-neutral-registry-value"></a><span data-ttu-id="f8c3a-107">Carregar um valor de registro de Language-Neutral</span><span class="sxs-lookup"><span data-stu-id="f8c3a-107">Load a Language-Neutral Registry Value</span></span>

<span data-ttu-id="f8c3a-108">No Windows Vista e versões posteriores, o aplicativo MUI usa um valor de registro neutro de idioma para permitir o acesso a cadeias de caracteres específicas de idioma armazenadas em uma tabela de recursos de cadeia.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-108">On Windows Vista and later, the MUI application uses a language-neutral registry value to allow access to language-specific strings stored in a string resource table.</span></span> <span data-ttu-id="f8c3a-109">Para obter mais informações, consulte criar um recurso de Language-Neutral em [usando o redirecionamento de cadeia de caracteres do registro](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="f8c3a-109">For more information, see Create a Language-Neutral Resource in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span>

<span data-ttu-id="f8c3a-110">O código do aplicativo que lê o valor de idioma neutro do registro deve carregar as cadeias de caracteres no idioma correto da interface do usuário chamando [**RegLoadMUIStringW**](/windows/win32/api/winreg/nf-winreg-regloadmuistringa).</span><span class="sxs-lookup"><span data-stu-id="f8c3a-110">Application code that reads the language-neutral value from the registry should load the strings in the correct user interface language by calling [**RegLoadMUIStringW**](/windows/win32/api/winreg/nf-winreg-regloadmuistringa).</span></span> <span data-ttu-id="f8c3a-111">Se você estiver usando essa função, seu aplicativo não precisará lidar explicitamente com o carregamento de recursos.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-111">If using this function, your application does not have to deal explicitly with resource loading.</span></span>

<span data-ttu-id="f8c3a-112">Se você estiver atualizando um aplicativo existente para o uso neutro de idioma do registro, normalmente manterá os valores de cadeia de caracteres existentes, localizados em inglês ou em outro idioma único no registro, como fallbacks e para compatibilidade com versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-112">If you are updating an existing application to the language-neutral use of the registry, you will typically keep the existing string values, localized to English or to some other single language in the registry, as fallbacks and for backward compatibility.</span></span> <span data-ttu-id="f8c3a-113">Manter uma cadeia de caracteres literal no registro permite que o aplicativo volte para a cadeia de caracteres literal se uma chamada para [**RegLoadMUIStringW**](/windows/win32/api/winreg/nf-winreg-regloadmuistringa) falhar.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-113">Keeping a literal string in the registry allows the application to fall back to the literal string if a call to [**RegLoadMUIStringW**](/windows/win32/api/winreg/nf-winreg-regloadmuistringa) fails.</span></span> <span data-ttu-id="f8c3a-114">Você deve decidir como implementar esse tipo de fallback, pois o MUI não oferece suporte para tal implementação.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-114">You must decide how to implement such a fallback, as MUI provides no support for such an implementation.</span></span>

## <a name="use-shell-api-to-set-shortcut-strings-from-the-registry"></a><span data-ttu-id="f8c3a-115">Usar a API do Shell para definir as cadeias de caracteres de atalho do registro</span><span class="sxs-lookup"><span data-stu-id="f8c3a-115">Use Shell API to Set Shortcut Strings from the Registry</span></span>

<span data-ttu-id="f8c3a-116">Seu aplicativo pode usar a API do Shell para criar cadeias de caracteres para atalhos que vinculam arquivos ou pastas no menu **Iniciar** ou na área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-116">Your application can use the shell API to create strings for shortcuts that link files or folders in the **Start** menu or on the desktop.</span></span> <span data-ttu-id="f8c3a-117">Para obter mais informações, consulte criar recursos para cadeias de caracteres de atalho em [usando o redirecionamento de cadeia de caracteres do registro](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="f8c3a-117">For more information, see Create Resources for Shortcut Strings in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span>

<span data-ttu-id="f8c3a-118">O aplicativo pode usar [**SHSetLocalizedName**](/windows/win32/api/shellapi/nf-shellapi-shsetlocalizedname) para carregar o nome de exibição compatível com MUI para um atalho.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-118">The application can use [**SHSetLocalizedName**](/windows/win32/api/shellapi/nf-shellapi-shsetlocalizedname) to load the MUI-compliant display name for a shortcut.</span></span> <span data-ttu-id="f8c3a-119">Ele deve usar [**IShellLink:: SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription) para definir o InfoTip associado.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-119">It should use [**IShellLink::SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription) to set the associated InfoTip.</span></span> <span data-ttu-id="f8c3a-120">As chamadas registram as cadeias de caracteres com o registro.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-120">The calls register the strings with the registry.</span></span> <span data-ttu-id="f8c3a-121">Considere os exemplos a seguir, para os quais "HKCR" representa \_ a \_ chave do registro raiz de classes hKey:</span><span class="sxs-lookup"><span data-stu-id="f8c3a-121">Consider the following examples, for which "HKCR" represents the HKEY\_CLASSES\_ROOT registry key:</span></span>


```C++
HKCR,"CLSID\%CLSID_AntiSpyware%",,,"Windows AntiSpyware"

HKCR,"CLSID\%CLSID_AntiSpyware%","LocalizedString",,"@%ProgramFiles%\Windows AntiSpyware\MSASCui.exe,-104"

HKCR,"CLSID\%CLSID_AntiSpyware%","InfoTip",,"@%ProgramFiles%\Windows AntiSpyware\MSASCui.exe,-208"
```



<span data-ttu-id="f8c3a-122">A primeira linha fornece uma cadeia de caracteres literal não local para compatibilidade de fallback e de versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-122">The first line provides an unlocalized literal string for fallback and backward compatibility.</span></span> <span data-ttu-id="f8c3a-123">A segunda linha mostra a maneira em conformidade com o MUI para registrar o nome de exibição.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-123">The second line shows the MUI-compliant way to register the display name.</span></span> <span data-ttu-id="f8c3a-124">Essa linha indica o identificador de cadeia de caracteres 104 armazenado em Msascui.exe (para o Windows XP) ou em seu arquivo específico de idioma associado (para o Windows Vista).</span><span class="sxs-lookup"><span data-stu-id="f8c3a-124">This line indicates the string identifier 104 stored in Msascui.exe (for Windows XP) or in its associated language-specific file (for Windows Vista).</span></span> <span data-ttu-id="f8c3a-125">Esse identificador de cadeia de caracteres corresponde a "meus locais de rede".</span><span class="sxs-lookup"><span data-stu-id="f8c3a-125">This string identifier corresponds to "My Network Places".</span></span> <span data-ttu-id="f8c3a-126">A terceira linha no exemplo manipula o registro de InfoTip.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-126">The third line in the example handles InfoTip registration.</span></span> <span data-ttu-id="f8c3a-127">% CLSID \_ AntiSpyware% especifica uma variável de ambiente que representa o GUID que corresponde ao identificador de classe deste componente.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-127">%CLSID\_AntiSpyware% specifies an environment variable representing the GUID that matches the class identifier of this component.</span></span>

<span data-ttu-id="f8c3a-128">Para o exemplo mostrado acima, o aplicativo chama [**SHSetLocalizedName**](/windows/win32/api/shellapi/nf-shellapi-shsetlocalizedname) para especificar o caminho do executável para os dois primeiros parâmetros e especifica *idsRes* como "@% ProgramFiles% \\ Windows AntiSpyware \\MSASCui.exe, 104".</span><span class="sxs-lookup"><span data-stu-id="f8c3a-128">For the example shown above, the application calls [**SHSetLocalizedName**](/windows/win32/api/shellapi/nf-shellapi-shsetlocalizedname) to specify the path of the executable for the first two parameters, and specify *idsRes* as "@%ProgramFiles%\\Windows AntiSpyware\\MSASCui.exe,104".</span></span> <span data-ttu-id="f8c3a-129">Uma chamada para [**IShellLink:: SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription), especifica o caminho para o InfoTip como "@% ProgramFiles% \\ Windows antispyware \\MSASCui.exe, 208".</span><span class="sxs-lookup"><span data-stu-id="f8c3a-129">A call to [**IShellLink::SetDescription**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishelllinka-setdescription), specifies the path for the InfoTip as "@%ProgramFiles%\\Windows AntiSpyware\\MSASCui.exe,208".</span></span>

## <a name="query-friendly-document-type-names-in-the-registry"></a><span data-ttu-id="f8c3a-130">Consultar nomes de tipo de documento amigável no registro</span><span class="sxs-lookup"><span data-stu-id="f8c3a-130">Query Friendly Document Type Names in the Registry</span></span>

<span data-ttu-id="f8c3a-131">A criação de recursos para nomes de tipo de documento amigáveis é discutida em criar recursos para nomes de tipo de documento amigáveis [usando o redirecionamento de cadeia de caracteres do registro](using-registry-string-redirection.md)</span><span class="sxs-lookup"><span data-stu-id="f8c3a-131">Resource creation for friendly document type names is discussed in Create Resources for Friendly Document Type Names in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span> <span data-ttu-id="f8c3a-132">Para consultar um nome de documento amigável, o aplicativo deve usar [**IQueryAssociations:: init**](/windows/win32/api/shlwapi/nf-shlwapi-iqueryassociations-init), seguido por uma chamada para [**IQueryAssociations:: GetString**](/windows/win32/api/shlwapi/nf-shlwapi-iqueryassociations-getstring).</span><span class="sxs-lookup"><span data-stu-id="f8c3a-132">To query a friendly document name, the application should use [**IQueryAssociations::Init**](/windows/win32/api/shlwapi/nf-shlwapi-iqueryassociations-init), followed by a call to [**IQueryAssociations::GetString**](/windows/win32/api/shlwapi/nf-shlwapi-iqueryassociations-getstring).</span></span> <span data-ttu-id="f8c3a-133">A chamada para **IQueryAssociations:: init** especifica o tipo de documento, por exemplo, ". txt".</span><span class="sxs-lookup"><span data-stu-id="f8c3a-133">The call to **IQueryAssociations::Init** specifies the document type, for example, ".txt".</span></span> <span data-ttu-id="f8c3a-134">A chamada para **IQueryAssociations:: GetString** deve especificar ASSOCSTR \_ FRIENDLYDOCNAME como o identificador de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-134">The call to **IQueryAssociations::GetString** must specify ASSOCSTR\_FRIENDLYDOCNAME as the string identifier.</span></span>

## <a name="register-microsoft-management-console-snap-in-strings-not-read-from-the-registry"></a><span data-ttu-id="f8c3a-135">Registrar cadeias de caracteres do snap-in do console de gerenciamento Microsoft não lidas no registro</span><span class="sxs-lookup"><span data-stu-id="f8c3a-135">Register Microsoft Management Console Snap-in Strings Not Read from the Registry</span></span>

<span data-ttu-id="f8c3a-136">Seu aplicativo pode usar um snap-in do MMC (console de gerenciamento Microsoft) para hospedar suas tarefas de gerenciamento.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-136">Your application can use a Microsoft Management Console (MMC) snap-in to host its management tasks.</span></span> <span data-ttu-id="f8c3a-137">A maioria das cadeias de caracteres são tratadas como recursos usando as configurações do Registro descritas em criar recursos de cadeia de caracteres para o console de gerenciamento Microsoft Snap-Ins no [uso do redirecionamento de cadeia](using-registry-string-redirection.md)</span><span class="sxs-lookup"><span data-stu-id="f8c3a-137">Most strings are handled as resources using the registry settings described in Create String Resources for Microsoft Management Console Snap-Ins in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span> <span data-ttu-id="f8c3a-138">No entanto, alguns snap-ins registram valores de cadeia de caracteres do registro que o MMC não pode ler do registro.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-138">However, some snap-ins register registry string values that MMC cannot read from the registry.</span></span> <span data-ttu-id="f8c3a-139">Nesse caso, o snap-in deve obter os valores usando a interface [**ISnapinAbout**](/windows/win32/api/mmc/nn-mmc-isnapinabout) , que é compatível com o MUI.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-139">In this case, the snap-in must obtain the values using the [**ISnapinAbout**](/windows/win32/api/mmc/nn-mmc-isnapinabout) interface, which is MUI-compatible.</span></span>

## <a name="set-the-display-name-and-description-for-a-windows-service-from-the-registry"></a><span data-ttu-id="f8c3a-140">Definir o nome de exibição e a descrição de um serviço do Windows a partir do registro</span><span class="sxs-lookup"><span data-stu-id="f8c3a-140">Set the Display Name and Description for a Windows Service from the Registry</span></span>

<span data-ttu-id="f8c3a-141">Se seu aplicativo MUI estiver usando um serviço do Windows, ele deverá exibir o nome de exibição do serviço e a descrição.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-141">If your MUI application is using a Windows service, it must display the service display name and description.</span></span> <span data-ttu-id="f8c3a-142">Os recursos associados são discutidos em "criar recursos de cadeia de caracteres para um serviço do Windows" no [usando o redirecionamento de cadeia de caracteres do registro](using-registry-string-redirection.md).</span><span class="sxs-lookup"><span data-stu-id="f8c3a-142">The associated resources are discussed in "Create String Resources for a Windows Service" in [Using Registry String Redirection](using-registry-string-redirection.md).</span></span>

<span data-ttu-id="f8c3a-143">Para definir o nome de exibição do serviço, o aplicativo MUI chama [**CreateService**](/windows/win32/api/winsvc/nf-winsvc-createservicea) ou [**ChangeServiceConfig**](/windows/win32/api/winsvc/nf-winsvc-changeserviceconfiga).</span><span class="sxs-lookup"><span data-stu-id="f8c3a-143">To set the service display name, the MUI application calls [**CreateService**](/windows/win32/api/winsvc/nf-winsvc-createservicea) or [**ChangeServiceConfig**](/windows/win32/api/winsvc/nf-winsvc-changeserviceconfiga).</span></span> <span data-ttu-id="f8c3a-144">O nome é uma cadeia de caracteres no formato " `@<PE-path>,-<stringID>[;<comment>]` ".</span><span class="sxs-lookup"><span data-stu-id="f8c3a-144">The name is a string of the form "`@<PE-path>,-<stringID>[;<comment>]`".</span></span> <span data-ttu-id="f8c3a-145">Por exemplo, se o serviço for implementado por um arquivo. dll com o caminho% ProgramFiles% \\ % MYPATH% \\MyDll.dll e o identificador da cadeia de caracteres do nome de exibição específico do idioma for 347, o parâmetro será especificado como " `@%ProgramFiles%\\%MyPath%\\MyDll.dll,-347` ".</span><span class="sxs-lookup"><span data-stu-id="f8c3a-145">For example, if your service is implemented by a .dll file with path %ProgramFiles%\\%MyPath%\\MyDll.dll, and the string identifier of the language-specific display name is 347, the parameter is specified as "`@%ProgramFiles%\\%MyPath%\\MyDll.dll,-347`".</span></span> <span data-ttu-id="f8c3a-146">As barras invertidas duplas ( \\ \\ ) são necessárias porque o C/C++ usa a barra invertida como um caractere de escape em cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-146">The double backslashes (\\\\) are necessary because C/C++ uses the backslash as an escape character in strings.</span></span>

<span data-ttu-id="f8c3a-147">Para definir a descrição de serviço específica do idioma, o aplicativo MUI deve fazer com que o membro **lpDescription** de uma estrutura de [**\_ Descrição de serviço**](/windows/win32/api/winsvc/ns-winsvc-service_descriptiona) indique uma cadeia de caracteres de formulário " `@<PE-path>,-<stringID>[;<comment>]` ", referenciando o identificador de cadeia de caracteres apropriado.</span><span class="sxs-lookup"><span data-stu-id="f8c3a-147">To set the language-specific service description, the MUI application should make the **lpDescription** member of a [**SERVICE\_DESCRIPTION**](/windows/win32/api/winsvc/ns-winsvc-service_descriptiona) structure indicate a string of form "`@<PE-path>,-<stringID>[;<comment>]`", referencing the appropriate string identifier.</span></span> <span data-ttu-id="f8c3a-148">Em seguida, o aplicativo chama [**ChangeServiceConfig2**](/windows/win32/api/winsvc/nf-winsvc-changeserviceconfig2a) com o parâmetro *dwInfoLevel* especificado como \_ Descrição da configuração do serviço \_ e o parâmetro *lpInfo* especificado como a estrutura de **\_ Descrição do serviço** .</span><span class="sxs-lookup"><span data-stu-id="f8c3a-148">Then the application calls [**ChangeServiceConfig2**](/windows/win32/api/winsvc/nf-winsvc-changeserviceconfig2a) with parameter *dwInfoLevel* specified as SERVICE\_CONFIG\_DESCRIPTION and parameter *lpInfo* specified as the **SERVICE\_DESCRIPTION** structure.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f8c3a-149">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="f8c3a-149">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f8c3a-150">Localizando recursos do Win32 PE</span><span class="sxs-lookup"><span data-stu-id="f8c3a-150">Locating Win32 PE Resources</span></span>](locating-win32-pe-resources.md)
</dt> <dt>

[<span data-ttu-id="f8c3a-151">Usando o redirecionamento de cadeia de caracteres do registro</span><span class="sxs-lookup"><span data-stu-id="f8c3a-151">Using Registry String Redirection</span></span>](using-registry-string-redirection.md)
</dt> </dl>

 

 
