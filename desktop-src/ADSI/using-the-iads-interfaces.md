---
title: Usando as interfaces IADs
description: ADSI, cada elemento de um serviço de diretório é representado por um objeto ADSI, que é um objeto Component Object Model (COM) que dá suporte à interface padrão COM IUnknown, bem como às interfaces IDispatch e IADs.
ms.assetid: bdbf2012-6863-4611-8173-6a3cd9c4960f
ms.tgt_platform: multiple
keywords:
- IADs ADSI, usando
- ADSI ADSI, usando, usando as interfaces IADs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 878afa9350a45f18238bebb69df1a96eba52715e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104366718"
---
# <a name="using-the-iads-interfaces"></a><span data-ttu-id="ae3e5-105">Usando as interfaces IADs</span><span class="sxs-lookup"><span data-stu-id="ae3e5-105">Using the IADs Interfaces</span></span>

<span data-ttu-id="ae3e5-106">ADSI, cada elemento de um serviço de diretório é representado por um objeto ADSI, que é um objeto Component Object Model (COM) que dá suporte à interface padrão COM [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) , bem como às interfaces [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) e [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) .</span><span class="sxs-lookup"><span data-stu-id="ae3e5-106">ADSI, each element of a directory service is represented by an ADSI object, which is a Component Object Model (COM) object that supports the standard COM [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) interface as well as the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) and [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interfaces.</span></span> <span data-ttu-id="ae3e5-107">**IADs** fornece as funções de manutenção básicas para objetos ADSI.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-107">**IADs** supplies the basic maintenance functions for ADSI objects.</span></span>

<span data-ttu-id="ae3e5-108">Cada objeto ADSI deve dar suporte a essa interface, que serve para:</span><span class="sxs-lookup"><span data-stu-id="ae3e5-108">Each ADSI object must support this interface, which serves to:</span></span>

-   <span data-ttu-id="ae3e5-109">Forneça a identificação de objeto por nome, classe ou ADsPath.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-109">Provide object identification by name, class, or ADsPath.</span></span>
-   <span data-ttu-id="ae3e5-110">Identifique o contêiner de objeto que gerencia a criação e exclusão de objetos.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-110">Identify the object container that manages creating and deleting objects.</span></span>
-   <span data-ttu-id="ae3e5-111">Obtenha a definição do esquema de objeto.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-111">Obtain the object schema definition.</span></span>
-   <span data-ttu-id="ae3e5-112">Carregue os atributos de objeto no cache de propriedades e confirme as alterações no repositório de diretórios persistente.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-112">Load the object attributes to the property cache and commit changes to the persistent directory store.</span></span>
-   <span data-ttu-id="ae3e5-113">Acesse e modifique os valores de atributo de objeto no cache de propriedades.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-113">Access and modify the object attribute values in the property cache.</span></span>

<span data-ttu-id="ae3e5-114">A interface [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) foi projetada para garantir que os objetos ADSI forneçam aos administradores de rede e provedores de serviço de diretório uma representação eficiente e consistente de vários serviços de diretório subjacentes.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-114">The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface is designed to ensure that ADSI objects provide network administrators and directory service providers with an efficient and consistent representation of various underlying directory services.</span></span>

![objeto ADSI que dá suporte à interface IADs](images/ds2iads.png)

<span data-ttu-id="ae3e5-116">A figura anterior mostra um objeto ADSI genérico que dá suporte às interfaces fundamentais [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject)e [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span><span class="sxs-lookup"><span data-stu-id="ae3e5-116">The preceding figure shows a generic ADSI object that support the fundamental interfaces [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject), and [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).</span></span> <span data-ttu-id="ae3e5-117">Um objeto ADSI, como isso, gerencia dados do armazenamento de dados do serviço de diretório subjacente por meio das interfaces que ele suporta.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-117">An ADSI object such as this manages data from the data store of the underlying directory service through the interfaces it supports.</span></span> <span data-ttu-id="ae3e5-118">Esses dados são conhecidos como propriedades do objeto, e as rotinas que obtêm e definem essas propriedades são conhecidas como métodos de propriedade.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-118">This data is known as the properties of the object, and the routines that obtain and set these properties are known as property methods.</span></span> <span data-ttu-id="ae3e5-119">As propriedades somente leitura têm um método de propriedade que obtém o valor da propriedade.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-119">Read-only properties have one property method that obtains the property value.</span></span> <span data-ttu-id="ae3e5-120">As propriedades de leitura/gravação têm dois métodos; um método que define o valor e um que obtém o valor.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-120">Read/write properties have two methods; a method that sets the value and one that obtains the value.</span></span> <span data-ttu-id="ae3e5-121">As propriedades são implementadas em cada objeto ADSI usando um [cache de propriedades](the-adsi-attribute-cache.md).</span><span class="sxs-lookup"><span data-stu-id="ae3e5-121">Properties are implemented on each ADSI object using a [property cache](the-adsi-attribute-cache.md).</span></span> <span data-ttu-id="ae3e5-122">[**IADs:: get \_ ADsPath**](iads-property-methods.md) e **IADs::p UT \_ ADsPath** são exemplos de métodos de propriedade.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-122">[**IADs::get\_ADsPath**](iads-property-methods.md) and **IADs::put\_ADsPath** are examples of property methods.</span></span> <span data-ttu-id="ae3e5-123">Os métodos de propriedade não são aparentes para Visual Basic e outros clientes de automação que habilitam referências diretas à propriedade.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-123">Property methods are not apparent to Visual Basic and other Automation clients that enable direct references to the property.</span></span> <span data-ttu-id="ae3e5-124">Por exemplo, Visual Basic se refere a **IADs:: ADsPath** diretamente usando a sintaxe **Object. ADsPath** .</span><span class="sxs-lookup"><span data-stu-id="ae3e5-124">For example, Visual Basic refers to **IADs::ADsPath** directly using the **Object.ADsPath** syntax.</span></span> <span data-ttu-id="ae3e5-125">Para obter mais informações, consulte [interface Property Methods](interface-property-methods.md).</span><span class="sxs-lookup"><span data-stu-id="ae3e5-125">For more information, see [Interface Property Methods](interface-property-methods.md).</span></span>

<span data-ttu-id="ae3e5-126">Além disso, um objeto ADSI interage com outros objetos ADSI e diretamente com um namespace por meio de métodos.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-126">In addition, an ADSI object interacts with other ADSI objects and directly to a namespace through methods.</span></span> <span data-ttu-id="ae3e5-127">Os métodos são executados imediatamente.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-127">Methods execute immediately.</span></span> <span data-ttu-id="ae3e5-128">Exemplos de métodos incluem [**IADs:: setinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) e [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo).</span><span class="sxs-lookup"><span data-stu-id="ae3e5-128">Examples of methods include [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) and [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo).</span></span>

<span data-ttu-id="ae3e5-129">Propriedades, métodos de propriedade e métodos são todos acessados por meio de interfaces COM padrão.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-129">Properties, property methods, and methods are all accessed through standard COM interfaces.</span></span>

<span data-ttu-id="ae3e5-130">Um objeto ADSI é identificado exclusivamente por seu ADsPath.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-130">An ADSI object is uniquely identified by its ADsPath.</span></span> <span data-ttu-id="ae3e5-131">Por exemplo, um ADsPath para o namespace LDAP é "LDAP://MyServer/DC=Fabrikam,DC=COM".</span><span class="sxs-lookup"><span data-stu-id="ae3e5-131">For example, an ADsPath for the LDAP namespace is "LDAP://MyServer/DC=Fabrikam,DC=COM".</span></span> <span data-ttu-id="ae3e5-132">Para obter mais informações sobre ADsPaths, consulte [vinculação ADSI](binding-to-an-adsi-object.md).</span><span class="sxs-lookup"><span data-stu-id="ae3e5-132">For more information about ADsPaths, see [ADSI Binding](binding-to-an-adsi-object.md).</span></span> <span data-ttu-id="ae3e5-133">Para os programadores familiarizados com monikers COM, isso é conceitualmente semelhante ao nome de exibição do moniker COM.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-133">For programmers familiar with COM monikers, this is conceptually similar to the COM moniker display name.</span></span>

<span data-ttu-id="ae3e5-134">Qualquer objeto ADSI que contenha outros objetos ADSI, chamado de objeto de contêiner ADSI, também dá suporte à interface [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) , que fornece métodos e propriedades que gerenciam a criação, a exclusão e a enumeração de objetos ADSI contidos no objeto.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-134">Any ADSI object that contains other ADSI objects, called an ADSI container object, also supports the [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface, which provides methods and properties that manage the creation, deletion, and enumeration of ADSI objects contained by the object.</span></span> <span data-ttu-id="ae3e5-135">A figura a seguir mostra um objeto de contêiner ADSI.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-135">The following figure shows an ADSI container object.</span></span>

![objeto de contêiner ADSI](images/dsiadsc.png)

<span data-ttu-id="ae3e5-137&quot;>A maioria dos objetos ADSI está contida em outros objetos.</span><span class=&quot;sxs-lookup&quot;><span data-stu-id=&quot;ae3e5-137&quot;>Most ADSI objects are contained by other objects.</span></span> <span data-ttu-id=&quot;ae3e5-138&quot;>O único objeto ADSI sem contêiner pai é o objeto de **namespaces** ADSI de nível superior (&quot;ads:").</span><span class="sxs-lookup"><span data-stu-id="ae3e5-138">The only ADSI object with no parent container is the top-level ADSI **Namespaces** object ("ADS:").</span></span>

<span data-ttu-id="ae3e5-139">O método [**IADs:: setinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) em um objeto de contêiner armazena de forma persistente as propriedades armazenadas em cache do objeto de contêiner ADSI para o armazenamento, além de quaisquer objetos criados com o método [**IADsContainer:: Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) .</span><span class="sxs-lookup"><span data-stu-id="ae3e5-139">The [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) method on a container object persistently stores the cached properties of the ADSI container object to storage in addition to any objects created with the [**IADsContainer::Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) method.</span></span> <span data-ttu-id="ae3e5-140">[**IADsContainer: o:D xcluir**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) não afeta o cache de propriedades, mas exclui o elemento de diretório de namespace subjacente representado por esse objeto.</span><span class="sxs-lookup"><span data-stu-id="ae3e5-140">[**IADsContainer::Delete**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) does not affect the property cache but deletes the underlying namespace directory element represented by this object.</span></span>

 

 