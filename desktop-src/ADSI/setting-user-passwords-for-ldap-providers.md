---
title: Configurando e alterando senhas de usuário com o provedor LDAP
description: Para definir uma senha de usuário, use o método IADsUser. SetPassword.
ms.assetid: da3d9861-dd04-406c-9356-db1e4ff0eebc
ms.tgt_platform: multiple
keywords:
- ADSI do provedor LDAP, objeto de usuário, definindo senhas
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5488146de271ac1108a904cd85163fad9d7dd205
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104294496"
---
# <a name="setting-and-changing-user-passwords-with-the-ldap-provider"></a><span data-ttu-id="fe50a-104">Configurando e alterando senhas de usuário com o provedor LDAP</span><span class="sxs-lookup"><span data-stu-id="fe50a-104">Setting and Changing User Passwords with the LDAP Provider</span></span>

<span data-ttu-id="fe50a-105">Para definir uma senha de usuário, use o método [**IADsUser. SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword) .</span><span class="sxs-lookup"><span data-stu-id="fe50a-105">To a set a user password, use the [**IADsUser.SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword) method.</span></span>

<span data-ttu-id="fe50a-106">O provedor LDAP para Active Directory usa um dos três processos para definir a senha (diretórios LDAP de terceiros, como iPlanet não use esse processo de autenticação de senha).</span><span class="sxs-lookup"><span data-stu-id="fe50a-106">The LDAP provider for Active Directory uses one of three processes to set the password (third-party LDAP directories such as iPlanet do not use this password authentication process).</span></span> <span data-ttu-id="fe50a-107">O método pode variar de acordo com a configuração de rede.</span><span class="sxs-lookup"><span data-stu-id="fe50a-107">The method may vary according to the network configuration.</span></span> <span data-ttu-id="fe50a-108">Os métodos set password ocorrem na seguinte ordem:</span><span class="sxs-lookup"><span data-stu-id="fe50a-108">The set password methods occur in the following order:</span></span>

-   <span data-ttu-id="fe50a-109">Primeiro, o provedor LDAP tenta usar LDAP em uma conexão SSL de 128 bits.</span><span class="sxs-lookup"><span data-stu-id="fe50a-109">First, the LDAP provider attempts to use LDAP over a 128-bit SSL connection.</span></span> <span data-ttu-id="fe50a-110">Para que o LDAP SSL opere com êxito, o servidor LDAP deve ter o certificado de autenticação de servidor apropriado instalado e os clientes que executam o código ADSI devem confiar na autoridade que emitiu esses certificados.</span><span class="sxs-lookup"><span data-stu-id="fe50a-110">For LDAP SSL to operate successfully, the LDAP server must have the appropriate server authentication certificate installed and the clients running the ADSI code must trust the authority that issued those certificates.</span></span> <span data-ttu-id="fe50a-111">Tanto o servidor quanto o cliente devem oferecer suporte à criptografia de 128 bits.</span><span class="sxs-lookup"><span data-stu-id="fe50a-111">Both the server and the client must support 128-bit encryption.</span></span>
-   <span data-ttu-id="fe50a-112">Em segundo lugar, se a conexão SSL não for bem-sucedida, o provedor LDAP tentará usar o Kerberos.</span><span class="sxs-lookup"><span data-stu-id="fe50a-112">Second, if the SSL connection is unsuccessful, the LDAP provider attempts to use Kerberos.</span></span> <span data-ttu-id="fe50a-113">No Windows 2000, o Kerberos pode não dar suporte à autenticação entre florestas.</span><span class="sxs-lookup"><span data-stu-id="fe50a-113">On Windows 2000, Kerberos may not support cross-forest authentication.</span></span> <span data-ttu-id="fe50a-114">Aprimoramentos posteriores ao Kerberos dão suporte à autenticação entre florestas.</span><span class="sxs-lookup"><span data-stu-id="fe50a-114">Later enhancements to Kerberos support cross-forest authentication.</span></span>
-   <span data-ttu-id="fe50a-115">Terceiro, se o Kerberos não for bem-sucedido, o provedor LDAP tentará uma chamada à API [**NetUserSetInfo**](/windows/desktop/api/lmaccess/nf-lmaccess-netusersetinfo) .</span><span class="sxs-lookup"><span data-stu-id="fe50a-115">Third, if Kerberos is unsuccessful, the LDAP provider attempts a [**NetUserSetInfo**](/windows/desktop/api/lmaccess/nf-lmaccess-netusersetinfo) API call.</span></span> <span data-ttu-id="fe50a-116">Em versões anteriores, a ADSI chamou **NetUserSetInfo** no contexto de segurança no qual o thread estava em execução, e não o contexto de segurança especificado na chamada para [**IADsOpenDSObject. OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) ou [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject).</span><span class="sxs-lookup"><span data-stu-id="fe50a-116">In previous releases, ADSI called **NetUserSetInfo** in the security context in which the thread was running, and not the security context specified in the call to [**IADsOpenDSObject.OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) or [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject).</span></span> <span data-ttu-id="fe50a-117">Em versões posteriores, isso foi alterado de forma que o provedor ADSI LDAP representaria o usuário especificado na chamada **OpenDSObject** ao chamar **NetUserSetInfo**.</span><span class="sxs-lookup"><span data-stu-id="fe50a-117">In later releases, this was changed so that the ADSI LDAP provider would impersonate the user specified in the **OpenDSObject** call when it calls **NetUserSetInfo**.</span></span>

<span data-ttu-id="fe50a-118">Para alterar uma senha de usuário, use o método [**IADsUser. ChangePassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-changepassword) .</span><span class="sxs-lookup"><span data-stu-id="fe50a-118">To change a user password, use the [**IADsUser.ChangePassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-changepassword) method.</span></span> <span data-ttu-id="fe50a-119">Como [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), esse método pode usar vários processos para alterar a senha.</span><span class="sxs-lookup"><span data-stu-id="fe50a-119">Like [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), this method can use multiple processes to change the password.</span></span> <span data-ttu-id="fe50a-120">Os métodos de alteração de senha ocorrem na seguinte ordem:</span><span class="sxs-lookup"><span data-stu-id="fe50a-120">The change password methods occur in the following order:</span></span>

-   <span data-ttu-id="fe50a-121">Primeiro, o provedor LDAP tenta usar LDAP em uma conexão SSL de 128 bits.</span><span class="sxs-lookup"><span data-stu-id="fe50a-121">First, the LDAP provider tries to use LDAP over a 128-bit SSL connection.</span></span>
-   <span data-ttu-id="fe50a-122">Em segundo lugar, se a conexão 128-SSL não for bem-sucedida, o provedor LDAP tentará uma chamada à API [**NetUserChangePassword**](/windows/desktop/api/lmaccess/nf-lmaccess-netuserchangepassword) .</span><span class="sxs-lookup"><span data-stu-id="fe50a-122">Second, if the 128-SSL connection is unsuccessful, the LDAP provider tries a [**NetUserChangePassword**](/windows/desktop/api/lmaccess/nf-lmaccess-netuserchangepassword) API call.</span></span> <span data-ttu-id="fe50a-123">Como [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), em versões anteriores, o provedor de LDAP ADSI representa as credenciais de usuário passadas usando o método [**IADsOpenDSObject. OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) ou a função [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject) .</span><span class="sxs-lookup"><span data-stu-id="fe50a-123">Like [**SetPassword**](/windows/desktop/api/Iads/nf-iads-iadsuser-setpassword), in earlier releases, the ADSI LDAP provider impersonates the user credentials passed using the [**IADsOpenDSObject.OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) method or the [**ADsOpenObject**](/windows/desktop/api/Adshlp/nf-adshlp-adsopenobject) function.</span></span>

 

 