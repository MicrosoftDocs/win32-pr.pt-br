---
title: Recuperando conjuntos de resultados grandes
description: Quando há a possibilidade de que o conjunto de resultados que será retornado contenha mais de 1000 itens, você deve usar uma pesquisa paginada.
ms.assetid: 1439d6b8-50dd-4d37-bcc9-dd0f63af865f
ms.tgt_platform: multiple
keywords:
- Recuperando o ADSI de conjuntos de resultados grandes
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 78f8902d25010690953cfae8a03ff9e500b4ebda
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "105755697"
---
# <a name="retrieving-large-results-sets"></a><span data-ttu-id="37271-104">Recuperando conjuntos de resultados grandes</span><span class="sxs-lookup"><span data-stu-id="37271-104">Retrieving Large Results Sets</span></span>

<span data-ttu-id="37271-105">Quando há a possibilidade de que o conjunto de resultados que será retornado contenha mais de 1000 itens, você deve usar uma pesquisa paginada.</span><span class="sxs-lookup"><span data-stu-id="37271-105">When there is the possibility that the result set that will be returned will contain more than 1000 items, you must use a paged search.</span></span> <span data-ttu-id="37271-106">Pesquisas de Active Directory executadas sem paginação são limitadas a retornar um máximo dos primeiros 1000 registros.</span><span class="sxs-lookup"><span data-stu-id="37271-106">Searches of Active Directory performed without paging are limited to returning a maximum of the first 1000 records.</span></span> <span data-ttu-id="37271-107">Com uma pesquisa paginada, o conjunto de resultados é apresentado como páginas individuais, cada um contendo um número predeterminado de entradas de resultados.</span><span class="sxs-lookup"><span data-stu-id="37271-107">With a paged search, the result set is presented as individual pages, each containing a predetermined number of result entries.</span></span> <span data-ttu-id="37271-108">Com esse tipo de pesquisa, novas páginas de entradas de resultado são retornadas até que o final do conjunto de resultados seja atingido.</span><span class="sxs-lookup"><span data-stu-id="37271-108">With this type of search, new pages of result entries are returned until the end of the result set is reached.</span></span>

<span data-ttu-id="37271-109">Por padrão, o servidor que responde a uma solicitação de consulta calcula completamente um conjunto de resultados antes de retornar os dados.</span><span class="sxs-lookup"><span data-stu-id="37271-109">By default, the server that responds to a query request completely calculates a result set before returning data.</span></span> <span data-ttu-id="37271-110">Em um conjunto de resultados grande, isso requer memória de servidor, pois o conjunto de resultados é adquirido e largura de banda de rede quando o resultado grande é retornado.</span><span class="sxs-lookup"><span data-stu-id="37271-110">In a large result set, this requires server memory as the result set is acquired, and network bandwidth when the large result is returned.</span></span> <span data-ttu-id="37271-111">Definir um tamanho de página permite que o servidor envie os dados em páginas à medida que as páginas estão sendo compiladas.</span><span class="sxs-lookup"><span data-stu-id="37271-111">Setting a page size allows the server to send the data in pages as the pages are being built.</span></span> <span data-ttu-id="37271-112">Em seguida, o cliente armazena em cache esses dados e fornece um cursor para o código de nível de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="37271-112">The client then caches this data and provides a cursor to the application level code.</span></span> <span data-ttu-id="37271-113">A paginação é definida definindo quantas linhas o servidor calcula antes que os dados sejam retornados pela rede para o cliente.</span><span class="sxs-lookup"><span data-stu-id="37271-113">Paging is set by defining how many rows the server calculates before the data is returned over the network to the client.</span></span>

<span data-ttu-id="37271-114">A pesquisa paginável oferece benefícios para o cliente e o servidor.</span><span class="sxs-lookup"><span data-stu-id="37271-114">Paged searching offers benefits to both the client and the server.</span></span> <span data-ttu-id="37271-115">Por exemplo, o cliente pode ser mais responsivo na apresentação dos resultados para os usuários finais.</span><span class="sxs-lookup"><span data-stu-id="37271-115">For example, the client can be more responsive in presenting the results to end users.</span></span> <span data-ttu-id="37271-116">Isso é especialmente relevante para ferramentas gráficas de interface do usuário que podem exibir dados enquanto outro thread recebe simultaneamente mais dados do servidor.</span><span class="sxs-lookup"><span data-stu-id="37271-116">This is especially relevant for graphical user interface tools that can display data while another thread concurrently receives more data from the server.</span></span>

<span data-ttu-id="37271-117">Ao configurar sua consulta, se você especificar uma ordem de classificação para o conjunto de resultados, o servidor deverá calcular completamente o conjunto de resultados antes de retornar os dados para o cliente, o que afeta o tempo de resposta para a consulta.</span><span class="sxs-lookup"><span data-stu-id="37271-117">When you set up your query, if you specify a sort order for your result set, then the server must completely calculate the result set before returning the data to the client, which impacts the response time for the query.</span></span>

<span data-ttu-id="37271-118">No lado do servidor, a pesquisa paginável torna a operação escalonável.</span><span class="sxs-lookup"><span data-stu-id="37271-118">On the server side, paged searching makes the operation scalable.</span></span> <span data-ttu-id="37271-119">Por exemplo, se 100 clientes emitirem solicitações de pesquisa simultaneamente e, na média, cada cliente for retornado 200 objetos, se o tamanho da página não for especificado, o servidor deverá ter memória suficiente para manter o conjunto de resultados completo de entradas 20.000.</span><span class="sxs-lookup"><span data-stu-id="37271-119">For example, if one hundred clients issue search requests simultaneously and, on the average, each client is returned two hundred objects, if page size is not specified, the server must have sufficient memory to hold the complete result set of 20,000 entries.</span></span> <span data-ttu-id="37271-120">Como alternativa, se cada cliente especificou um tamanho de página de dez objetos, os requisitos de memória no servidor seriam reduzidos em um fator de 20.</span><span class="sxs-lookup"><span data-stu-id="37271-120">Alternately, if each client specified a page size of ten objects, the memory requirements on the server would be reduced by a factor of 20.</span></span>

> [!Note]  
> <span data-ttu-id="37271-121">Nem todos os serviços de diretório dão suporte a pesquisas paginadas.</span><span class="sxs-lookup"><span data-stu-id="37271-121">Not all directory services support paged searches.</span></span> <span data-ttu-id="37271-122">Active Directory implementa a arquitetura de tamanho de página.</span><span class="sxs-lookup"><span data-stu-id="37271-122">Active Directory implements page size architecture.</span></span>

 

<span data-ttu-id="37271-123">Muitos servidores de diretório especificam um limite administrativo para o número máximo de objetos que eles podem retornar se um cliente não especificar o tamanho da página.</span><span class="sxs-lookup"><span data-stu-id="37271-123">Many directory servers specify an Administrative Limit for the maximum number of objects they can return if a client does not specify the page size.</span></span> <span data-ttu-id="37271-124">Quando o limite administrativo é atingido, a ADSI gera o erro de **\_ limite de administrador de DS \_ \_ \_ excedido** .</span><span class="sxs-lookup"><span data-stu-id="37271-124">When the Administrative Limit is reached, ADSI generates the **ERROR\_DS\_ADMIN\_LIMIT\_EXCEEDED** Win32 error.</span></span>

<span data-ttu-id="37271-125">No lado do cliente, uma pesquisa paginada permite que um cliente pare a operação enquanto ela ainda está em andamento.</span><span class="sxs-lookup"><span data-stu-id="37271-125">On the client side, a paged search allows a client to stop the operation while it is still in progress.</span></span> <span data-ttu-id="37271-126">Por outro lado, em uma pesquisa não paginável, o cliente é bloqueado até que os dados sejam completamente retornados ou ocorre um erro.</span><span class="sxs-lookup"><span data-stu-id="37271-126">By contrast, in a non-paged search, the client is blocked until the data is completely returned, or an error occurs.</span></span> <span data-ttu-id="37271-127">Isso pode afetar o desempenho da rede se o conjunto de resultados for maior e levar mais tempo do que o esperado.</span><span class="sxs-lookup"><span data-stu-id="37271-127">This could impact network performance if the result set turns out to be larger and takes more time than expected.</span></span>

<span data-ttu-id="37271-128">Em nome do cliente, a ADSI manipula o tamanho da página de forma transparente.</span><span class="sxs-lookup"><span data-stu-id="37271-128">On behalf of the client, ADSI handles the page size transparently.</span></span> <span data-ttu-id="37271-129">O cliente não precisa contar o número de objetos em andamento.</span><span class="sxs-lookup"><span data-stu-id="37271-129">The client does not have to count the number of objects in progress.</span></span> <span data-ttu-id="37271-130">A ADSI encapsula a interação do servidor para o cliente.</span><span class="sxs-lookup"><span data-stu-id="37271-130">ADSI encapsulates the server interaction for the client.</span></span> <span data-ttu-id="37271-131">Da perspectiva do cliente, a pesquisa retorna um conjunto de resultados completo.</span><span class="sxs-lookup"><span data-stu-id="37271-131">From the client perspective, the search returns a complete result set.</span></span>

<span data-ttu-id="37271-132">Para obter mais informações sobre como usar a opção tempo limite de pesquisa com uma interface de pesquisa específica, consulte:</span><span class="sxs-lookup"><span data-stu-id="37271-132">For more information about using the search time out option with a specific search interface, see:</span></span>

-   [<span data-ttu-id="37271-133">Paginação com IDirectorySearch</span><span class="sxs-lookup"><span data-stu-id="37271-133">Paging with IDirectorySearch</span></span>](paging-with-idirectorysearch.md)
-   [<span data-ttu-id="37271-134">Pesquisando com ActiveX Data Objects</span><span class="sxs-lookup"><span data-stu-id="37271-134">Searching with ActiveX Data Objects</span></span>](searching-with-activex-data-objects-ado.md)
-   [<span data-ttu-id="37271-135">Pesquisando com OLE DB</span><span class="sxs-lookup"><span data-stu-id="37271-135">Searching with OLE DB</span></span>](searching-with-ole-db.md)

<span data-ttu-id="37271-136">Uma pesquisa paginada é transparente para seu aplicativo porque a ADSI continua automaticamente a recuperar páginas adicionais de resultados até atingir o final do conjunto de resultados ou o fim do limite de tempo definido.</span><span class="sxs-lookup"><span data-stu-id="37271-136">A paged search is transparent to your application because ADSI automatically continues to retrieve additional pages of results until it reaches the end of the result set or the end of the time limit that you set.</span></span> <span data-ttu-id="37271-137">Quando você usa uma pesquisa paginada, o limite de tamanho não substitui o tamanho da página.</span><span class="sxs-lookup"><span data-stu-id="37271-137">When you use a paged search, the size limit does not override page size.</span></span> <span data-ttu-id="37271-138">O limite de tamanho só pode ser usado quando você recupera um conjunto de resultados que contém menos de 1000 entradas.</span><span class="sxs-lookup"><span data-stu-id="37271-138">Size limit can only be used when you retrieve a result set that contains fewer than 1000 entries.</span></span>

 

 




