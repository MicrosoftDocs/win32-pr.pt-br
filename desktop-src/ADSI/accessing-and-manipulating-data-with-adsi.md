---
title: Acessando e manipulando dados com ADSI
description: Todos os objetos têm propriedades.
ms.assetid: 366a1fbc-3089-406a-9819-cf2ba7636c5f
ms.tgt_platform: multiple
keywords:
- ADSI, acessando e manipulando dados
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b3291db7490c79aae6363f619582ed24339fb83d
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "105748341"
---
# <a name="accessing-and-manipulating-data-with-adsi"></a><span data-ttu-id="6a1db-104">Acessando e manipulando dados com ADSI</span><span class="sxs-lookup"><span data-stu-id="6a1db-104">Accessing and Manipulating Data with ADSI</span></span>

<span data-ttu-id="6a1db-105">Todos os objetos têm propriedades.</span><span class="sxs-lookup"><span data-stu-id="6a1db-105">All objects have properties.</span></span> <span data-ttu-id="6a1db-106">Todos os objetos COM da interface de serviço do Active Directory (ADSI) têm uma ou mais interfaces com métodos que recuperam as propriedades do objeto de diretório que o objeto COM representa.</span><span class="sxs-lookup"><span data-stu-id="6a1db-106">All Active Directory Service Interface (ADSI) COM objects have one or more interfaces with methods that retrieve the properties of the directory object that the COM object represents.</span></span> <span data-ttu-id="6a1db-107">Há várias maneiras pelas quais você pode ler as propriedades de um objeto:</span><span class="sxs-lookup"><span data-stu-id="6a1db-107">There are a number of ways you can read properties from an object:</span></span>

-   <span data-ttu-id="6a1db-108">Obter uma propriedade específica por nome: a interface [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) tem dois métodos [**IADs:: Get**](/windows/desktop/api/Iads/nf-iads-iads-get) e [**IADs:: GetEx**](/windows/desktop/api/Iads/nf-iads-iads-getex) para ler uma propriedade específica.</span><span class="sxs-lookup"><span data-stu-id="6a1db-108">Get a specific property by name: The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface has two methods [**IADs::Get**](/windows/desktop/api/Iads/nf-iads-iads-get) and [**IADs::GetEx**](/windows/desktop/api/Iads/nf-iads-iads-getex) to read a specific property.</span></span> <span data-ttu-id="6a1db-109">Todo objeto COM ADSI tem uma interface **IADs** .</span><span class="sxs-lookup"><span data-stu-id="6a1db-109">Every ADSI COM object has an **IADs** interface.</span></span>
-   <span data-ttu-id="6a1db-110">Obter uma lista especificada de propriedades: a interface [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) tem o método [**IDirectoryObject:: getobjectattributes**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-getobjectattributes) que permite especificar uma lista que contém os nomes das propriedades a serem lidas e retorna uma matriz de estruturas que contém os valores de propriedade solicitados.</span><span class="sxs-lookup"><span data-stu-id="6a1db-110">Get a specified list of properties: The [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface has the method [**IDirectoryObject::GetObjectAttributes**](/windows/desktop/api/Iads/nf-iads-idirectoryobject-getobjectattributes) that allows you to specify a list containing the names of the properties to read and returns an array of structures containing the requested property values.</span></span>
-   <span data-ttu-id="6a1db-111">Enumerar todas as propriedades no objeto: a interface [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) permite enumerar todas as propriedades em um objeto.</span><span class="sxs-lookup"><span data-stu-id="6a1db-111">Enumerate all properties on the object: The [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) interface allows you to enumerate all the properties on an object.</span></span>
-   <span data-ttu-id="6a1db-112">Obter propriedades especiais: as interfaces de automação ([**IADs**](/windows/desktop/api/Iads/nn-iads-iads) \* ) têm métodos de propriedade que permitem que você obtenha propriedades especiais que não são armazenadas em um objeto.</span><span class="sxs-lookup"><span data-stu-id="6a1db-112">Get special properties: The Automation interfaces ([**IADs**](/windows/desktop/api/Iads/nn-iads-iads)\*) have property methods that allow you to get special properties that are not stored in an object.</span></span> <span data-ttu-id="6a1db-113">Ou os métodos de propriedade podem permitir que você obtenha uma propriedade de objeto em um formato de dados diferente do tipo de dados real armazenado.</span><span class="sxs-lookup"><span data-stu-id="6a1db-113">Or the property methods may allow you to get an object property in a data format that differs from the actual data type stored.</span></span> <span data-ttu-id="6a1db-114">Por exemplo, a interface **IADs** tem métodos de propriedade como [**IADs:: get \_ Name**](iads-property-methods.md), que recupera o RDN (nome distinto relativo) de um objeto; **IADs:: get \_ Classe**, que recupera a classe de um objeto e **IADs:: get \_ pai**, que recupera o ADsPath para o pai do objeto.</span><span class="sxs-lookup"><span data-stu-id="6a1db-114">For example, the **IADs** interface has property methods such as [**IADs::get\_Name**](iads-property-methods.md), which retrieves an object's relative distinguished name (RDN); **IADs::get\_Class**, which retrieves an object's class, and **IADs::get\_Parent**, which retrieves the ADsPath to the object's parent.</span></span>

<span data-ttu-id="6a1db-115">A ADSI permite que você armazene em cache as propriedades localmente depois que elas foram lidas no servidor de diretório.</span><span class="sxs-lookup"><span data-stu-id="6a1db-115">ADSI allows you to cache properties locally after they have been read from the directory server.</span></span> <span data-ttu-id="6a1db-116">Isso permite que você escolha a leitura das propriedades do cache de propriedades local ou a recuperação das propriedades diretamente do servidor de diretório.</span><span class="sxs-lookup"><span data-stu-id="6a1db-116">This allows you a choice of reading the properties from the local property cache or retrieving the properties directly from the directory server.</span></span> <span data-ttu-id="6a1db-117">A ADSI também tem métodos para atualizar o cache, bem como especificar se todas as propriedades de um objeto são armazenadas em cache ou apenas aquelas que você especificou.</span><span class="sxs-lookup"><span data-stu-id="6a1db-117">ADSI also has methods to update the cache as well as specifying whether all properties for an object are cached or just those you have specified.</span></span>

<span data-ttu-id="6a1db-118">Depois de recuperar uma propriedade, você lê seu valor.</span><span class="sxs-lookup"><span data-stu-id="6a1db-118">After you have retrieved a property, you read its value.</span></span> <span data-ttu-id="6a1db-119">O tipo de dados de uma propriedade depende da definição da propriedade (também conhecida como um atributo) no esquema de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6a1db-119">The data type of a property depends on the definition of the property (also known as an attribute) in the Active Directory schema.</span></span> <span data-ttu-id="6a1db-120">Para cada tipo de propriedade que pode existir em Active Directory, há um objeto **attributeSchema** no esquema de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6a1db-120">For each type of property that can exist in Active Directory, there is an **attributeSchema** object in the Active Directory schema.</span></span> <span data-ttu-id="6a1db-121">Um objeto **attributeSchema** define as características do atributo.</span><span class="sxs-lookup"><span data-stu-id="6a1db-121">An **attributeSchema** object defines the characteristics of the attribute.</span></span> <span data-ttu-id="6a1db-122">Uma dessas características é a sintaxe do atributo, que determina o tipo de dados dos valores do atributo.</span><span class="sxs-lookup"><span data-stu-id="6a1db-122">One of these characteristics is the attribute's syntax, which determines the data type of the attribute's values.</span></span> <span data-ttu-id="6a1db-123">Para obter mais informações, consulte [características de atributos](/windows/desktop/AD/characteristics-of-attributes) e [sintaxes para atributos de Active Directory](/windows/desktop/AD/syntaxes-for-attributes-in-active-directory-domain-services).</span><span class="sxs-lookup"><span data-stu-id="6a1db-123">For more information, see [Characteristics of Attributes](/windows/desktop/AD/characteristics-of-attributes) and [Syntaxes for Active Directory Attributes](/windows/desktop/AD/syntaxes-for-attributes-in-active-directory-domain-services).</span></span>

<span data-ttu-id="6a1db-124">As interfaces de automação ([**IADs**](/windows/desktop/api/Iads/nn-iads-iads) \* ) retornam um valor de propriedade como uma [**variante**](/windows/win32/api/oaidl/ns-oaidl-variant) ou um ponteiro para uma interface de automação em um objeto com que representa a propriedade.</span><span class="sxs-lookup"><span data-stu-id="6a1db-124">The Automation interfaces ([**IADs**](/windows/desktop/api/Iads/nn-iads-iads)\*) return a property value as a [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) or a pointer to an Automation interface on a COM object that represents the property.</span></span> <span data-ttu-id="6a1db-125">As interfaces [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) e [**IDirectorySearch**](/windows/desktop/api/Iads/nn-iads-idirectorysearch) retornam uma propriedade como um ponteiro para uma estrutura que contém um valor de propriedade tipada ou um ponteiro para uma cadeia de caracteres de bytes.</span><span class="sxs-lookup"><span data-stu-id="6a1db-125">The [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) and [**IDirectorySearch**](/windows/desktop/api/Iads/nn-iads-idirectorysearch) interfaces return a property as a pointer to a structure containing a typed property value or a pointer to a string of bytes.</span></span> <span data-ttu-id="6a1db-126">Além disso, **IDirectoryObject** e **IDirectorySearch** recuperam propriedades diretamente do servidor de diretório em vez de usar um cache de propriedades local.</span><span class="sxs-lookup"><span data-stu-id="6a1db-126">In addition, **IDirectoryObject** and **IDirectorySearch** retrieve properties directly from the directory server instead of using a local property cache.</span></span>

<span data-ttu-id="6a1db-127">Esta seção descreve os seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="6a1db-127">This section describes the following topics:</span></span>

-   [<span data-ttu-id="6a1db-128">As interfaces IADs e IDirectoryObject</span><span class="sxs-lookup"><span data-stu-id="6a1db-128">The IADs and IDirectoryObject Interfaces</span></span>](the-iads-and-idirectoryobject-interfaces.md)
-   [<span data-ttu-id="6a1db-129">Acessando atributos com ADSI</span><span class="sxs-lookup"><span data-stu-id="6a1db-129">Accessing Attributes with ADSI</span></span>](accessing-attributes-with-adsi.md)
-   [<span data-ttu-id="6a1db-130">Modificando atributos com ADSI</span><span class="sxs-lookup"><span data-stu-id="6a1db-130">Modifying Attributes with ADSI</span></span>](modifying-attributes-with-adsi.md)
-   [<span data-ttu-id="6a1db-131">Acessando o cache de propriedades diretamente com as interfaces IADsproperty</span><span class="sxs-lookup"><span data-stu-id="6a1db-131">Accessing the Property Cache Directly with the IADsProperty Interfaces</span></span>](accessing-the-property-cache-directly-with-the-iadsproperty-interfaces.md)
-   [<span data-ttu-id="6a1db-132">Sintaxe de atributo ADSI</span><span class="sxs-lookup"><span data-stu-id="6a1db-132">ADSI Attribute Syntax</span></span>](adsi-attribute-syntax.md)

 

 