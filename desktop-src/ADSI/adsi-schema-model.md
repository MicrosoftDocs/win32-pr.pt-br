---
title: Modelo de esquema ADSI
description: Um esquema é semelhante a um dicionário, pois ele contém a definição de cada tipo de objeto conhecido por um serviço de diretório.
ms.assetid: 70561a11-1560-4b1c-a999-e2a7b2002ab0
ms.tgt_platform: multiple
keywords:
- ADSI do modelo de esquema ADSI
- ADSI ADSI, sobre, esquema
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 23eec9264ae2692952106802cc06cbad937a42a9
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "103917672"
---
# <a name="adsi-schema-model"></a><span data-ttu-id="96975-105">Modelo de esquema ADSI</span><span class="sxs-lookup"><span data-stu-id="96975-105">ADSI Schema Model</span></span>

<span data-ttu-id="96975-106">Um esquema é semelhante a um dicionário, pois ele contém a definição de cada tipo de objeto conhecido por um serviço de diretório.</span><span class="sxs-lookup"><span data-stu-id="96975-106">A schema is similar to a dictionary in that it holds the definition of every type of object known to a directory service.</span></span> <span data-ttu-id="96975-107">Os aplicativos cliente ADSI podem navegar por um esquema para descobrir os recursos de qualquer implementação ADSI específica.</span><span class="sxs-lookup"><span data-stu-id="96975-107">ADSI client applications can browse through a schema to discover the features of any given ADSI implementation.</span></span> <span data-ttu-id="96975-108">Além disso, a ADSI fornece interfaces de gerenciamento de esquema que podem ser usadas para se comunicar com o esquema subjacente de um serviço de diretório.</span><span class="sxs-lookup"><span data-stu-id="96975-108">In addition, ADSI supplies schema management interfaces that can be used to communicate with a directory service's underlying schema.</span></span>

<span data-ttu-id="96975-109">Alguns esquemas são provedores extensíveis e ADSI ou fornecedores de terceiros podem optar por publicar novas interfaces ou propriedades adicionais para interfaces existentes lá.</span><span class="sxs-lookup"><span data-stu-id="96975-109">Some schemas are extensible and ADSI providers or third-party suppliers may choose to publish new interfaces or additional properties for existing interfaces there.</span></span> <span data-ttu-id="96975-110">Os clientes ADSI usam esses dados para determinar quais recursos têm suporte para cada serviço de diretório.</span><span class="sxs-lookup"><span data-stu-id="96975-110">ADSI clients use this data to determine what features are supported for each directory service.</span></span>

<span data-ttu-id="96975-111">Há três tipos de objetos de esquema: classes, propriedades e sintaxes, cada um respectivamente dando suporte às interfaces de gerenciamento de esquema [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**iadsproperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty)e [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span><span class="sxs-lookup"><span data-stu-id="96975-111">There are three kinds of schema objects: classes, properties, and syntaxes, each respectively supporting the schema management interfaces [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), and [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span></span>

> [!Note]  
> <span data-ttu-id="96975-112">A classe é um termo sobrecarregado.</span><span class="sxs-lookup"><span data-stu-id="96975-112">Class is an overloaded term.</span></span> <span data-ttu-id="96975-113">Há classes C++, classes Java, classes COM e classes ADSI.</span><span class="sxs-lookup"><span data-stu-id="96975-113">There are C++ classes, Java classes, COM classes, and ADSI classes.</span></span> <span data-ttu-id="96975-114">Neste documento, a palavra classe, a menos que qualificado de outra forma, se refere a uma categoria ou tipo de objeto de esquema.</span><span class="sxs-lookup"><span data-stu-id="96975-114">In this document, the word class, unless otherwise qualified, refers to a category or type of schema object.</span></span>

 

<span data-ttu-id="96975-115">A ADSI abstrai o esquema de cada serviço de diretório e o coloca em cada nó raiz de nível superior no objeto **namespace** .</span><span class="sxs-lookup"><span data-stu-id="96975-115">ADSI abstracts the schema of every directory service and places it in every top-level root node in the **Namespace** object.</span></span> <span data-ttu-id="96975-116">Para identificar as classes que um serviço de diretório dá suporte em um determinado nó raiz, você enumera o objeto de esquema e obtém uma lista de objetos de classe, objetos de propriedade e objetos de sintaxe.</span><span class="sxs-lookup"><span data-stu-id="96975-116">To identify what classes a directory service supports on a given root-node, you enumerate the schema object and get a list of class objects, property objects, and syntax objects.</span></span> <span data-ttu-id="96975-117">Para obter mais informações, consulte [usando o esquema ADSI](using-the-adsi-schema.md).</span><span class="sxs-lookup"><span data-stu-id="96975-117">For more information, see [Using the ADSI Schema](using-the-adsi-schema.md).</span></span>

## <a name="adsi-ldap-provider-schema-cache"></a><span data-ttu-id="96975-118">Cache de esquema do provedor LDAP ADSI</span><span class="sxs-lookup"><span data-stu-id="96975-118">ADSI LDAP Provider Schema Cache</span></span>

<span data-ttu-id="96975-119">O provedor LDAP para ADSI tenta armazenar em cache os dados de esquema no computador local.</span><span class="sxs-lookup"><span data-stu-id="96975-119">The LDAP provider for ADSI attempts to cache schema data to the local computer.</span></span> <span data-ttu-id="96975-120">Um subesquema é identificado por um nome distinto armazenado no atributo [**subSchemaSubEntry**](/windows/desktop/ADSchema/a-subschemasubentry) localizado na raiz do serviço de diretório Enterprise (RootDSE).</span><span class="sxs-lookup"><span data-stu-id="96975-120">A subschema is identified by a distinguished name stored in the [**subSchemaSubEntry**](/windows/desktop/ADSchema/a-subschemasubentry) attribute located in the root of the directory service enterprise (rootDSE).</span></span> <span data-ttu-id="96975-121">Além de fornecer os dados de subesquema, os servidores LDAP v3 devem expor um atributo [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) que é usado para determinar a última vez em que o esquema foi modificado.</span><span class="sxs-lookup"><span data-stu-id="96975-121">In addition to providing the subschema data, LDAP v3 servers should expose a [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute that is used to determine the last time the schema was modified.</span></span>

<span data-ttu-id="96975-122">Quando o ADSI primeiro liga ao servidor LDAP, ele recupera os dados do subesquema usando o atributo [**subSchemaSubEntry**](/windows/desktop/ADSchema/a-subschemasubentry) .</span><span class="sxs-lookup"><span data-stu-id="96975-122">When ADSI first binds to the LDAP server, it retrieves the subschema data using the [**subSchemaSubEntry**](/windows/desktop/ADSchema/a-subschemasubentry) attribute.</span></span> <span data-ttu-id="96975-123">Se o ADSI obtiver sucesso ao localizar o objeto de subesquema, ele armazenará um ponteiro para os dados no registro no computador que está se conectando ao servidor LDAP.</span><span class="sxs-lookup"><span data-stu-id="96975-123">If ADSI succeeds in finding the subschema object, it stores a pointer to the data in the registry on the computer that is connecting to the LDAP server.</span></span> <span data-ttu-id="96975-124">Para obter informações sobre exatamente onde esses valores são armazenados no registro, consulte [ADSI e controle de conta de usuário](adsi-and-uac.md).</span><span class="sxs-lookup"><span data-stu-id="96975-124">For information on exactly where these values are stored in the registry, see [ADSI and User Account Control](adsi-and-uac.md).</span></span>

<span data-ttu-id="96975-125">Em seguida, o ADSI tenta processar os dados do esquema e lê o atributo [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) .</span><span class="sxs-lookup"><span data-stu-id="96975-125">ADSI then attempts to process the schema data and reads the [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute.</span></span> <span data-ttu-id="96975-126">Se o atributo **modifyTimeStamp** existir e a ADSI processar o esquema com êxito, a ADSI gravará o subesquema em disco e criará os dois valores de registro a seguir sob a chave.</span><span class="sxs-lookup"><span data-stu-id="96975-126">If the **modifyTimeStamp** attribute exists and ADSI successfully processes the schema, ADSI writes the subschema to disk and creates the two following registry values under the key.</span></span> <span data-ttu-id="96975-127">Se os dados do subesquema existirem, mas não puderem ser processados, nenhum desses valores de registro será criado:</span><span class="sxs-lookup"><span data-stu-id="96975-127">If the subschema data exists, but cannot be processed, neither of these registry values is created:</span></span>

-   <span data-ttu-id="96975-128">Um valor de **hora** , que contém o atributo [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) .</span><span class="sxs-lookup"><span data-stu-id="96975-128">A **Time** value, which contains the [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute.</span></span> <span data-ttu-id="96975-129">Esse valor é usado para garantir que os dados do esquema sejam atuais e impeçam o recarregamento constante dos dados do esquema.</span><span class="sxs-lookup"><span data-stu-id="96975-129">This value is used to ensure that the schema data is current and prevents the constant reloading of the schema data.</span></span>
-   <span data-ttu-id="96975-130">Um valor de **arquivo** , que contém o caminho para onde a ADSI armazena os dados de esquema no sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="96975-130">A **File** value, which contains the path to where ADSI stores the schema data in the file system.</span></span> <span data-ttu-id="96975-131">Por padrão, a ADSI armazena em cache o subesquema no <systemroot> \\ diretório SchCache com um nome de arquivo correspondente ao nome do servidor LDAP.</span><span class="sxs-lookup"><span data-stu-id="96975-131">By default, ADSI caches the subschema in the <systemroot>\\SchCache directory with a file name corresponding to the name of the LDAP server.</span></span>

<span data-ttu-id="96975-132">Se os dados do subesquema puderem ser processados, mas nenhum atributo [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) for exposto, os dados do esquema serão armazenados em cache na memória, mas não gravados no disco.</span><span class="sxs-lookup"><span data-stu-id="96975-132">If the subschema data can be processed, but no [**modifyTimeStamp**](/windows/desktop/ADSchema/a-modifytimestamp) attribute is exposed, the schema data is cached in memory, but not written to disk.</span></span> <span data-ttu-id="96975-133">Se um servidor LDAP v3 tiver sido contatado por meio de ADSI no computador local e um subesquema em cache não estiver presente, provavelmente haverá um dos seguintes motivos:</span><span class="sxs-lookup"><span data-stu-id="96975-133">If an LDAP v3 server has been contacted through ADSI on the local computer and a cached subschema is not present, it is most likely for one of the following reasons:</span></span>

-   <span data-ttu-id="96975-134">O servidor não expôs as propriedades corretas.</span><span class="sxs-lookup"><span data-stu-id="96975-134">The server did not expose the correct properties.</span></span>
-   <span data-ttu-id="96975-135">A ADSI não pôde processar o esquema.</span><span class="sxs-lookup"><span data-stu-id="96975-135">ADSI was unable to process the schema.</span></span>
-   <span data-ttu-id="96975-136">A ADSI não pôde gravar o arquivo no sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="96975-136">ADSI was unable to write the file to the file system.</span></span>

 

 