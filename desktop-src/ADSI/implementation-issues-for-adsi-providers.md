---
title: Problemas de implementação para provedores ADSI
description: Problemas de implementação para provedores ADSI
ms.assetid: 0be772aa-e7d8-4d34-b55a-162abfb0bfd4
ms.tgt_platform: multiple
keywords:
- Problemas de implementação para ADSI de provedores ADSI
- ADSI de provedores, implementando
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c4c362b04244580e448e7bb7bd78889e66db12fe
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104366720"
---
# <a name="implementation-issues-for-adsi-providers"></a><span data-ttu-id="11090-105">Problemas de implementação para provedores ADSI</span><span class="sxs-lookup"><span data-stu-id="11090-105">Implementation Issues for ADSI Providers</span></span>

<span data-ttu-id="11090-106">Para implementar interfaces ADSI, primeiro implemente a interface COM [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject).</span><span class="sxs-lookup"><span data-stu-id="11090-106">To implement ADSI interfaces, first implement the COM interface [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject).</span></span> <span data-ttu-id="11090-107">Ao fornecer essa interface como uma camada de sobrecarga mínima, você fornece aos aplicativos cliente o controle necessário para acessar objetos de diretório diretamente do diretório, em vez de por meio do cache ADSI, que otimiza o desempenho da rede.</span><span class="sxs-lookup"><span data-stu-id="11090-107">By providing this interface as a minimal overhead layer, you supply client applications the control required to access directory objects directly from the directory rather than through the ADSI cache, which optimizes network performance.</span></span> <span data-ttu-id="11090-108">Usar essa interface também fornecerá sua própria implementação com mais flexibilidade.</span><span class="sxs-lookup"><span data-stu-id="11090-108">Using this interface will also supply your own implementation with the most flexibility.</span></span>

<span data-ttu-id="11090-109">Em segundo lugar, implemente as interfaces do ADSI, [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer), [**iadscollection**](/windows/desktop/api/Iads/nn-iads-iadscollection)e [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) da propriedade cache.</span><span class="sxs-lookup"><span data-stu-id="11090-109">Second, implement the fundamental ADSI interfaces, [**IADs**](/windows/desktop/api/Iads/nn-iads-iads), [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer), [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection), and the [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry), [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist) property cache interfaces.</span></span> <span data-ttu-id="11090-110">[**IADs**](/windows/desktop/api/Iads/nn-iads-iadsgroup) e [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) também são interfaces em demanda frequente pelo software de administração do sistema.</span><span class="sxs-lookup"><span data-stu-id="11090-110">[**IADsGroup**](/windows/desktop/api/Iads/nn-iads-iadsgroup) and [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) are also interfaces in frequent demand by system administration software.</span></span>

<span data-ttu-id="11090-111">Em terceiro lugar, implemente as interfaces de gerenciamento de esquema se o seu serviço de diretório tiver um esquema subjacente: [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**iadsproperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span><span class="sxs-lookup"><span data-stu-id="11090-111">Third, implement the schema management interfaces if your directory service has an underlying schema: [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax).</span></span> <span data-ttu-id="11090-112">Se não houver nenhum esquema subjacente, use essas interfaces para abstrair as classes e as propriedades usadas pelo serviço de diretório.</span><span class="sxs-lookup"><span data-stu-id="11090-112">If there is no underlying schema, use these interfaces to abstract the classes and properties used by the directory service.</span></span> <span data-ttu-id="11090-113">Os esquemas podem ser usados para publicar os recursos do serviço de diretório em clientes ADSI.</span><span class="sxs-lookup"><span data-stu-id="11090-113">Schemas can be used to publish the features of your directory service to ADSI clients.</span></span>

## <a name="collections"></a><span data-ttu-id="11090-114">Coleções</span><span class="sxs-lookup"><span data-stu-id="11090-114">Collections</span></span>

<span data-ttu-id="11090-115">Os componentes do provedor ADSI podem seguir um dos três modelos para armazenar em cache as coleções durante a enumeração.</span><span class="sxs-lookup"><span data-stu-id="11090-115">ADSI provider components can follow one of three models for caching collections during enumeration.</span></span> <span data-ttu-id="11090-116">A escolha de um modelo de cache determina o comportamento de ADSI quando um objeto em uma coleção é excluído do serviço de diretório subjacente externo para ADSI.</span><span class="sxs-lookup"><span data-stu-id="11090-116">The choice of a caching model determines the behavior of ADSI when an object in a collection is deleted from the underlying directory service external to ADSI.</span></span>

<span data-ttu-id="11090-117">Os modelos de cache incluem:</span><span class="sxs-lookup"><span data-stu-id="11090-117">The caching models include:</span></span>

-   <span data-ttu-id="11090-118">Coleções armazenadas em cache antecipadamente.</span><span class="sxs-lookup"><span data-stu-id="11090-118">Collections cached in advance.</span></span> <span data-ttu-id="11090-119">A coleção de instâncias de objeto é recuperada do serviço de diretório subjacente em sua totalidade quando [**iadscollection:: get \_ \_ NewEnum**](/windows/desktop/api/Iads/nf-iads-iadscollection-get__newenum) é chamado para criar um novo objeto enumerador.</span><span class="sxs-lookup"><span data-stu-id="11090-119">The collection of object instances is retrieved from the underlying directory service in its entirety when [**IADsCollection::get\_\_NewEnum**](/windows/desktop/api/Iads/nf-iads-iadscollection-get__newenum) is called to create a new enumerator object.</span></span> <span data-ttu-id="11090-120">Se o objeto de origem de uma instância de objeto de Active Directory na coleção recuperada for excluído do serviço de diretório subjacente, o cliente não reconhecerá a exclusão até que um [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) ou [**IADs:: setinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) tente acessar a coleção.</span><span class="sxs-lookup"><span data-stu-id="11090-120">If the source object for an Active Directory object instance in the retrieved collection is deleted from the underlying directory service, the client does not recognize the deletion until a [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the collection.</span></span>
-   <span data-ttu-id="11090-121">Coleções em cache incrementalmente.</span><span class="sxs-lookup"><span data-stu-id="11090-121">Collections incrementally cached.</span></span> <span data-ttu-id="11090-122">A coleção é recuperada do serviço de diretório subjacente um objeto por vez quando [**IEnumVARIANT:: Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) é chamado.</span><span class="sxs-lookup"><span data-stu-id="11090-122">The collection is retrieved from the underlying directory service one object at a time when [**IEnumVARIANT::Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) is called.</span></span> <span data-ttu-id="11090-123">[**IEnumVARIANT:: Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) retornará ao início da coleção no cache e **IEnumVARIANT:: Next** retornará os objetos armazenados em cache até que o final do cache seja atingido; nesse ponto, novos objetos serão adicionados do armazenamento subjacente.</span><span class="sxs-lookup"><span data-stu-id="11090-123">[**IEnumVARIANT::Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) will return to the beginning of the collection in the cache and **IEnumVARIANT::Next** will return cached objects until the end of the cache is reached, at which point new objects will be added from the underlying store.</span></span> <span data-ttu-id="11090-124">Quando uma instância de objeto de Active Directory estiver no cache, o cliente não ficará ciente de sua exclusão do serviço de diretório subjacente até que um [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) ou [**IADs:: setinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) tente acessar o objeto.</span><span class="sxs-lookup"><span data-stu-id="11090-124">When an Active Directory object instance is in the cache the client will not become aware of its deletion from the underlying directory service until an [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the object.</span></span>
-   <span data-ttu-id="11090-125">Coleções não armazenadas em cache.</span><span class="sxs-lookup"><span data-stu-id="11090-125">Collections not cached.</span></span> <span data-ttu-id="11090-126">A coleção é recuperada do serviço de diretório subjacente um objeto por vez quando [**IEnumVARIANT:: Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) é chamado.</span><span class="sxs-lookup"><span data-stu-id="11090-126">The collection is retrieved from the underlying directory service one object at a time when [**IEnumVARIANT::Next**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-next) is called.</span></span> <span data-ttu-id="11090-127">[**IEnumVARIANT:: Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) retornará ao início da coleção no armazenamento subjacente.</span><span class="sxs-lookup"><span data-stu-id="11090-127">[**IEnumVARIANT::Reset**](/windows/win32/api/oaidl/nf-oaidl-ienumvariant-reset) will return to the beginning of the collection in the underlying store.</span></span> <span data-ttu-id="11090-128">As operações **IEnumVARIANT:: Next** e **IEnumVARIANT:: Reset** não podem recuperar objetos excluídos, pois os objetos são recuperados sob demanda do serviço de diretório subjacente.</span><span class="sxs-lookup"><span data-stu-id="11090-128">**IEnumVARIANT::Next** and **IEnumVARIANT::Reset** operations cannot retrieve deleted objects, because the objects are retrieved on-demand from the underlying directory service.</span></span> <span data-ttu-id="11090-129">Somente o objeto atual é armazenado em cache; Se o objeto atual for excluído, o cliente não ficará ciente de sua exclusão do serviço de diretório subjacente até que um [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) ou [**IADs:: setinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) tente acessar o objeto.</span><span class="sxs-lookup"><span data-stu-id="11090-129">Only the current object is cached; if the current object is deleted, the client will not become aware of its deletion from the underlying directory service until a [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) or [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) attempts to access the object.</span></span>

<span data-ttu-id="11090-130">Independentemente do modelo de cache, lembre-se de que a enumeração ADSI retorna Active Directory interfaces de serviço para o chamador.</span><span class="sxs-lookup"><span data-stu-id="11090-130">Regardless of the caching model, be aware that ADSI enumeration returns Active Directory service interfaces to the caller.</span></span> <span data-ttu-id="11090-131">Para evitar a sobrecarga de obter um novo ponteiro de interface, os aplicativos ADSI devem armazenar em cache os ponteiros de interface retornados para objetos que pretendem manipular.</span><span class="sxs-lookup"><span data-stu-id="11090-131">To avoid the overhead of obtaining a new interface pointer, ADSI applications should cache the returned interface pointers for objects that they intend to manipulate.</span></span> <span data-ttu-id="11090-132">Por exemplo, um aplicativo Visual Basic que enumera um contêiner e popula uma caixa de listagem com nomes pode armazenar em cache os ponteiros de interface associados aos nomes para uso posterior.</span><span class="sxs-lookup"><span data-stu-id="11090-132">For example, a Visual Basic application that enumerates a container and populates a list box with names can cache the interface pointers associated with the names for later use.</span></span> <span data-ttu-id="11090-133">Essa abordagem fornecerá um desempenho maior do que popular a caixa de listagem durante a enumeração e obter um novo ponteiro de interface quando o usuário fizer uma seleção.</span><span class="sxs-lookup"><span data-stu-id="11090-133">This approach will provide greater performance than populating the list box during enumeration and obtaining a new interface pointer when the user makes a selection.</span></span>

## <a name="about-dispatch-ids"></a><span data-ttu-id="11090-134">Sobre as IDs de expedição</span><span class="sxs-lookup"><span data-stu-id="11090-134">About Dispatch IDs</span></span>

<span data-ttu-id="11090-135">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) é uma interface de automação definida pelo com para controladores que não usam interfaces com diretamente.</span><span class="sxs-lookup"><span data-stu-id="11090-135">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) is an Automation interface defined by COM for controllers that do not use COM interfaces directly.</span></span> <span data-ttu-id="11090-136">O acesso a um objeto por meio de **IDispatch** é chamado de acesso associado a nome ou de ligação tardia, pois ocorre em tempo de execução ("tardia") e usa nomes de cadeia de caracteres de propriedades e métodos para resolver referências ("nome").</span><span class="sxs-lookup"><span data-stu-id="11090-136">Accessing an object through **IDispatch** is called name-bound or late-bound access, because it occurs at run time ("late") and uses string names of properties and methods to resolve references ("name").</span></span> <span data-ttu-id="11090-137">Em tempo de execução, os clientes passam o nome da cadeia de caracteres da propriedade ou do método que desejam chamar para o método [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames)().</span><span class="sxs-lookup"><span data-stu-id="11090-137">At run time, clients pass the string name of the property or method they wish to call into the [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames)() method.</span></span> <span data-ttu-id="11090-138">Se a propriedade ou o método existir no objeto, o identificador de expedição (dispID) da função correspondente será recuperado.</span><span class="sxs-lookup"><span data-stu-id="11090-138">If the property or method exists on the object, the dispatch identifier (dispID) of the corresponding function is retrieved.</span></span> <span data-ttu-id="11090-139">Em seguida, o dispID é usado para executar a função por meio de [**IDispatch:: Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke)().</span><span class="sxs-lookup"><span data-stu-id="11090-139">The dispID is then used to execute the function through [**IDispatch::Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke)().</span></span> <span data-ttu-id="11090-140">O uso de **IDispatch**, propriedades e métodos nas interfaces expostas por um único objeto aparece como uma lista simples.</span><span class="sxs-lookup"><span data-stu-id="11090-140">Using **IDispatch**, properties and methods on the interfaces exposed by a single object appear as a flat list.</span></span> <span data-ttu-id="11090-141">Como o acesso associado a nomes requer duas chamadas de função, ele é menos eficiente do que usar uma interface COM diretamente.</span><span class="sxs-lookup"><span data-stu-id="11090-141">Because name-bound access requires two function calls, it is less efficient than using a COM interface directly.</span></span> <span data-ttu-id="11090-142">Os clientes são incentivados a usar as interfaces COM ADSI nos objetos quando o desempenho é uma consideração.</span><span class="sxs-lookup"><span data-stu-id="11090-142">Clients are encouraged to use the ADSI COM interfaces on the objects when performance is a consideration.</span></span> <span data-ttu-id="11090-143">Controladores de automação avançados, como Visual Basic 4,0, podem chamar outras interfaces COM, bem como **IDispatch**, se as interfaces estiverem em conformidade com as restrições de automação para tipos de dados e passagem de parâmetros.</span><span class="sxs-lookup"><span data-stu-id="11090-143">Advanced Automation controllers such as Visual Basic 4.0 can call other COM interfaces as well as **IDispatch**, if the interfaces comply with the Automation constraints for data types and parameter passing.</span></span>

<span data-ttu-id="11090-144">Os provedores ADSI geram dispIDs dinamicamente para cada objeto Active Directory.</span><span class="sxs-lookup"><span data-stu-id="11090-144">ADSI providers generate dispIDs dynamically for each Active Directory object.</span></span> <span data-ttu-id="11090-145">Os dispIDs recuperados por meio de [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) para um determinado objeto são os valores gerados, mas não os valores que estão em IDL para o objeto.</span><span class="sxs-lookup"><span data-stu-id="11090-145">The dispIDs retrieved through [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) for a given object are the generated values, but not the values that are in the IDL for the object.</span></span> <span data-ttu-id="11090-146">Os usuários de [**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) devem chamar **GetIDsOfNames** para obter DISPIDs válidos em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="11090-146">[**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) users must call **GetIDsOfNames** to obtain valid dispIDs at run time.</span></span>

## <a name="type-information-and-type-libraries"></a><span data-ttu-id="11090-147">Informações de tipo e bibliotecas de tipos</span><span class="sxs-lookup"><span data-stu-id="11090-147">Type Information and Type Libraries</span></span>

<span data-ttu-id="11090-148">O SDK do ADSI fornece uma biblioteca de tipos, activeds. tlb, que documenta todas as interfaces padrão com suporte da ADSI.</span><span class="sxs-lookup"><span data-stu-id="11090-148">The ADSI SDK supplies a type library, Activeds.tlb, that documents all the standard interfaces supported by ADSI.</span></span> <span data-ttu-id="11090-149">Um provedor deve fornecer uma biblioteca de tipos semelhante para todas as interfaces encontradas em activeds. tlb, além de quaisquer dados de tipo adicionais para as interfaces implementadas no componente do provedor.</span><span class="sxs-lookup"><span data-stu-id="11090-149">A provider must supply a similar type library for all interfaces found in Activeds.tlb, plus any additional type data for the interfaces implemented within the provider component.</span></span>

<span data-ttu-id="11090-150">Este é um exemplo de código IDL.</span><span class="sxs-lookup"><span data-stu-id="11090-150">The following is an IDL code example.</span></span>

``` syntax
[ object, uuid(IID_IADsXYZ), oleautomation, dual ]
interface IADsXYZ: IDispatch
{
// Read-only properties.
[propget]
HRESULT AReadOnlyProp ([out, retval]BSTR *pbstrAReadOnlyProp);
 
// Read/write properties.
[propget]
HRESULT AReadWriteProp ([out, retval]long *plAReadWriteProp);
[propput]
HRESULT AReadWriteProp ([in]long lAReadWriteProp);
 
// Methods.
HRESULT AMethod ([in]DATE dateInParameter,
[out, retval]BSTR *pbstrReturnValue);
};
```

## <a name="thread-safety"></a><span data-ttu-id="11090-151">Acesso thread-safe</span><span class="sxs-lookup"><span data-stu-id="11090-151">Thread Safety</span></span>

<span data-ttu-id="11090-152">A Component Object Model (COM) descreve os três modelos de Threading a seguir.</span><span class="sxs-lookup"><span data-stu-id="11090-152">The Component Object Model (COM) describes the following three threading models.</span></span> <span data-ttu-id="11090-153">Os aplicativos COM indicam qual modelo está em uso ao inicializar a biblioteca COM usando as funções [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) e [**CoInitializeEx**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializeex) :</span><span class="sxs-lookup"><span data-stu-id="11090-153">COM applications indicate which model is in use when initializing the COM library using the [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) and [**CoInitializeEx**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializeex) functions:</span></span>

-   <span data-ttu-id="11090-154">Thread único.</span><span class="sxs-lookup"><span data-stu-id="11090-154">Single threading.</span></span> <span data-ttu-id="11090-155">O modelo de thread único assume um único thread de execução em um processo, supondo que as estruturas de dados COM em um processo não precisem de serialização de acesso.</span><span class="sxs-lookup"><span data-stu-id="11090-155">The single threaded model assumes a single thread of execution in a process, further assuming that COM data structures in a process need no access serialization.</span></span>
-   <span data-ttu-id="11090-156">Threading de apartamento.</span><span class="sxs-lookup"><span data-stu-id="11090-156">Apartment threading.</span></span> <span data-ttu-id="11090-157">Um objeto COM é associado ao thread que o criou.</span><span class="sxs-lookup"><span data-stu-id="11090-157">A COM object is associated with the thread that created it.</span></span> <span data-ttu-id="11090-158">As chamadas para um objeto em outro thread devem ser executadas pelo thread que criou esse objeto.</span><span class="sxs-lookup"><span data-stu-id="11090-158">Calls to an object on another thread must be executed by the thread that created that object.</span></span> <span data-ttu-id="11090-159">Para fazer isso, o thread de origem invoca um proxy de cliente que organiza a chamada de método e a entrega a uma função de stub de servidor no thread de destino por meio da fila de mensagens do Win32 associada ao thread de destino.</span><span class="sxs-lookup"><span data-stu-id="11090-159">To accomplish this, the source thread invokes a client proxy which arranges the method call and delivers it to a server stub function in the destination thread through the Win32 message queue associated with the destination thread.</span></span>
-   <span data-ttu-id="11090-160">Threading gratuito.</span><span class="sxs-lookup"><span data-stu-id="11090-160">Free threading.</span></span> <span data-ttu-id="11090-161">Os objetos COM são considerados thread-safe.</span><span class="sxs-lookup"><span data-stu-id="11090-161">COM objects are assumed to be thread safe.</span></span> <span data-ttu-id="11090-162">Vários threads têm acesso permitido a qualquer objeto no processo sem nenhuma serialização imposta.</span><span class="sxs-lookup"><span data-stu-id="11090-162">Multiple threads are allowed access to any object in the process with no serialization imposed.</span></span>

<span data-ttu-id="11090-163">A ADSI não assume nenhum modelo de Threading específico.</span><span class="sxs-lookup"><span data-stu-id="11090-163">ADSI does not assume any particular threading model.</span></span> <span data-ttu-id="11090-164">Os escritores de componentes do provedor devem assumir o modelo de Threading gratuito e garantir a consistência de suas estruturas de dados internas, protegendo-as contra threads não seguros, ou seja, sem coordenadas, por meio do uso de objetos de sincronização, como seções ou semáforos críticos.</span><span class="sxs-lookup"><span data-stu-id="11090-164">Writers of provider components should assume the free threading model and guarantee the consistency of their internal data structures by protecting them from thread-unsafe, that is, uncoordinated, updates through the use of synchronization objects such as critical sections or semaphores.</span></span>

## <a name="object-locking"></a><span data-ttu-id="11090-165">Bloqueio de objeto</span><span class="sxs-lookup"><span data-stu-id="11090-165">Object Locking</span></span>

<span data-ttu-id="11090-166">A ADSI não impõe nem define um esquema de bloqueio de objeto.</span><span class="sxs-lookup"><span data-stu-id="11090-166">ADSI does not impose or define an object-locking scheme.</span></span> <span data-ttu-id="11090-167">Provedores para namespaces que dão suporte à serialização de acesso usando bloqueio podem expor o esquema de bloqueio subjacente por meio de extensões específicas do provedor para a ADSI.</span><span class="sxs-lookup"><span data-stu-id="11090-167">Providers for namespaces that support access serialization using locking can expose the underlying locking scheme through provider-specific extensions to ADSI.</span></span>

## <a name="property-names-within-a-schema"></a><span data-ttu-id="11090-168">Nomes de propriedade dentro de um esquema</span><span class="sxs-lookup"><span data-stu-id="11090-168">Property Names Within a Schema</span></span>

<span data-ttu-id="11090-169">ADSI representa propriedades como objetos de propriedade dentro do contêiner de esquema ADSI.</span><span class="sxs-lookup"><span data-stu-id="11090-169">ADSI represents properties as property objects within the ADSI schema container.</span></span> <span data-ttu-id="11090-170">Isso exige que os nomes de propriedade sejam exclusivos em cada contêiner de esquema.</span><span class="sxs-lookup"><span data-stu-id="11090-170">This requires that property names be unique within each schema container.</span></span> <span data-ttu-id="11090-171">O provedor deve garantir que não haja colisões de nome.</span><span class="sxs-lookup"><span data-stu-id="11090-171">The provider must ensure that there are no name collisions.</span></span>

## <a name="primary-interface"></a><span data-ttu-id="11090-172">Interface primária</span><span class="sxs-lookup"><span data-stu-id="11090-172">Primary Interface</span></span>

<span data-ttu-id="11090-173">Quando um provedor não pode identificar qual interface deve ser retornada como a interface primária, **IID \_ IADs** deve ser retornado.</span><span class="sxs-lookup"><span data-stu-id="11090-173">When a provider cannot identify which interface should be returned as the primary interface, **IID\_IADs** should be returned.</span></span> <span data-ttu-id="11090-174">Isso fornece acesso com limite de nome a todas as propriedades de um objeto por meio de [**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) e os métodos [**IADs:: Get**](/windows/desktop/api/Iads/nf-iads-iads-get), [**IADs:: GetEx**](/windows/desktop/api/Iads/nf-iads-iads-getex), [**iads::P UT**](/windows/desktop/api/Iads/nf-iads-iads-put)e [**IADs::P utex**](/windows/desktop/api/Iads/nf-iads-iads-putex) .</span><span class="sxs-lookup"><span data-stu-id="11090-174">This provides name-bound access to all properties of an object through [**IDispatch**](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface) and the [**IADs::Get**](/windows/desktop/api/Iads/nf-iads-iads-get), [**IADs::GetEx**](/windows/desktop/api/Iads/nf-iads-iads-getex), [**IADs::Put**](/windows/desktop/api/Iads/nf-iads-iads-put), and [**IADs::PutEx**](/windows/desktop/api/Iads/nf-iads-iads-putex) methods.</span></span>

 

 