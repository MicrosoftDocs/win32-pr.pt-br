---
title: Resolução de conflitos de nome de função/Propriedade em automação em extensões
description: Neste tópico, \ 0034; objeto \ 0034; indica o objeto, como um todo, como um cliente ADSI o exibe. Ou seja, ADSI e todas as suas extensões.
ms.assetid: 76207326-879e-408b-8004-06d940401a41
ms.tgt_platform: multiple
keywords:
- Resolução de conflitos de função e nome de propriedade em automação em extensões
- ADSI de extensões, resolvendo conflitos de nome de função e Propriedade na automação
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d9a7ac99b99ecdf0ee1b940f066d9e8166a15542
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104366706"
---
# <a name="resolution-of-functionproperty-name-conflicts-in-automation-in-extensions"></a><span data-ttu-id="f6d59-106">Resolução de conflitos de nome de função/Propriedade em automação em extensões</span><span class="sxs-lookup"><span data-stu-id="f6d59-106">Resolution of Function/Property Name Conflicts in Automation in Extensions</span></span>

<span data-ttu-id="f6d59-107">Neste tópico, "Object" indica o objeto, como um todo, como um cliente ADSI o exibe.</span><span class="sxs-lookup"><span data-stu-id="f6d59-107">In this topic, "object" indicates the object, as a whole, as an ADSI client views it.</span></span> <span data-ttu-id="f6d59-108">Ou seja, ADSI e todas as suas extensões.</span><span class="sxs-lookup"><span data-stu-id="f6d59-108">That is, ADSI and all its extensions.</span></span>

## <a name="same-function-name-with-the-same-parameters"></a><span data-ttu-id="f6d59-109">Mesmo nome de função com os mesmos parâmetros</span><span class="sxs-lookup"><span data-stu-id="f6d59-109">Same Function Name With the Same Parameters</span></span>

<span data-ttu-id="f6d59-110">Se duas ou mais interfaces duplas [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) em um objeto oferecerem suporte a uma propriedade ou um método com o mesmo nome, por exemplo, **func1**, a invocação será determinada usando os critérios a seguir.</span><span class="sxs-lookup"><span data-stu-id="f6d59-110">If two or more dual [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interfaces in an object support a property or method of the same name, for example, **Func1**, invocation is determined using the following criteria.</span></span> <span data-ttu-id="f6d59-111">Se o cliente tiver um ponteiro para uma das interfaces duplas que dão suporte a um método chamado **func1** e se o ambiente de automação der suporte ao acesso vtable, **func1** será invocado diretamente por meio do acesso ADSI vtable.</span><span class="sxs-lookup"><span data-stu-id="f6d59-111">If the client has a pointer to one of the dual interfaces that support a method called **Func1** and if the Automation environment supports vtable access, **Func1** is invoked directly through ADSI vtable access.</span></span>

<span data-ttu-id="f6d59-112">Se qualquer uma das condições acima for false, [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) e [**IDispatch:: Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke) serão chamados para invocar **func1**.</span><span class="sxs-lookup"><span data-stu-id="f6d59-112">If either of the conditions above is false, [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) and [**IDispatch::Invoke**](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke) are called to invoke **Func1**.</span></span>

<span data-ttu-id="f6d59-113">Para obter mais informações e uma breve explicação sobre como um cliente pode adicionar um ponteiro a uma interface dupla e uma descrição dos tipos de ambientes que dão suporte ao acesso vtable, consulte [associação tardia versus acesso vtable no modelo de extensão ADSI](late-binding-vs--vtable-access-in-the-adsi-extension-model.md).</span><span class="sxs-lookup"><span data-stu-id="f6d59-113">For more information and a brief explanation about how a client can add a pointer to a dual interface, and a description of the types of environments that support vtable access, see [Late Binding versus Vtable Access in the ADSI Extension Model](late-binding-vs--vtable-access-in-the-adsi-extension-model.md).</span></span>

<span data-ttu-id="f6d59-114">Como todos os objetos de extensão redirecionam as funções [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) de volta para o agregador, o agregador controla qual **func1** é invocado.</span><span class="sxs-lookup"><span data-stu-id="f6d59-114">Because all extension objects redirect the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) functions back to the aggregator, the aggregator controls which **Func1** is invoked.</span></span> <span data-ttu-id="f6d59-115">As regras são:</span><span class="sxs-lookup"><span data-stu-id="f6d59-115">The rules are:</span></span>

-   <span data-ttu-id="f6d59-116">Se qualquer interface, e houver apenas uma, se houver, no agregador (ADSI) oferece suporte a uma função chamada **func1**, o agregador invocará seu próprio **func1**.</span><span class="sxs-lookup"><span data-stu-id="f6d59-116">If any interface, and there will be only one, if any, in the aggregator (ADSI) supports a function called **Func1**, the aggregator invokes its own **Func1**.</span></span>
-   <span data-ttu-id="f6d59-117">Caso contrário, o agregador passará por cada uma de suas extensões, na ordem listada no registro, e encontrará a primeira extensão que implementa uma função chamada **func1**.</span><span class="sxs-lookup"><span data-stu-id="f6d59-117">Otherwise, the aggregator goes through each of its extensions, in the order listed in the registry, and finds the first extension that implements a function called **Func1**.</span></span> <span data-ttu-id="f6d59-118">É possível, mas improvável, que várias interfaces duplas [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) nessa primeira extensão tenham uma função chamada **func1**.</span><span class="sxs-lookup"><span data-stu-id="f6d59-118">It is possible, but unlikely, that multiple dual [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interfaces in this first extension have a function called **Func1**.</span></span> <span data-ttu-id="f6d59-119">A extensão deve determinar qual **func1** deve ser sempre chamado na automação.</span><span class="sxs-lookup"><span data-stu-id="f6d59-119">The extension must determine which **Func1** should always be invoked in Automation.</span></span>

## <a name="same-function-name-with-different-parameters"></a><span data-ttu-id="f6d59-120">Mesmo nome de função com parâmetros diferentes</span><span class="sxs-lookup"><span data-stu-id="f6d59-120">Same Function Name With Different Parameters</span></span>

<span data-ttu-id="f6d59-121">A seção anterior abordou como resolver conflitos de nome de função, ou seja, nomes de função que têm o mesmo nome de função e a mesma lista de parâmetros, como número, tipo e ordem, quando ocorre na automação.</span><span class="sxs-lookup"><span data-stu-id="f6d59-121">The previous section discussed how to resolve function name conflicts, that is, function names that have the same function name and same parameter list, such as number, type and order, when it occurs in Automation.</span></span> <span data-ttu-id="f6d59-122">E se duas funções tiverem o mesmo nome, mas parâmetros diferentes?</span><span class="sxs-lookup"><span data-stu-id="f6d59-122">What if two functions have the same name but different parameters?</span></span> <span data-ttu-id="f6d59-123">Se um cliente ADSI invocar a função usando [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) sem usar vários nomes para especificar os parâmetros, o modelo de extensão ADSI não poderá desambiguar as funções.</span><span class="sxs-lookup"><span data-stu-id="f6d59-123">If an ADSI client invokes the function using [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) without using multiple names to specify the parameters, the ADSI extension model cannot disambiguate the functions.</span></span> <span data-ttu-id="f6d59-124">Com base no esquema de resolução discutido acima, a primeira extensão no registro que dá suporte a essa função por meio de uma de suas interfaces tem sua versão dessa função invocada, e a chamada pode falhar ou gerar resultados incorretos.</span><span class="sxs-lookup"><span data-stu-id="f6d59-124">Based on the resolution scheme discussed in above, the first extension in the registry that supports this function through one of its interfaces has its version of this function invoked, and the call may fail or yield incorrect results.</span></span>

<span data-ttu-id="f6d59-125">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="f6d59-125">For example:</span></span>

-   <span data-ttu-id="f6d59-126">Extn1 (primeiro no registro em classe CA – prioridade mais alta) dá suporte a **IInterface1**.</span><span class="sxs-lookup"><span data-stu-id="f6d59-126">Extn1 (first in the registry under class CA – higher priority) supports **IInterface1**.</span></span>
-   <span data-ttu-id="f6d59-127">Extn2 (terceiro no registro em classe CA – prioridade mais baixa) dá suporte a **IInterface2**.</span><span class="sxs-lookup"><span data-stu-id="f6d59-127">Extn2 (third in the registry under class CA – lower priority) supports **IInterface2**.</span></span>
-   <span data-ttu-id="f6d59-128">**IInterface1** dá suporte a **Method1 (int param1, int param2)**.</span><span class="sxs-lookup"><span data-stu-id="f6d59-128">**IInterface1** supports **Method1(int param1, int param2)**.</span></span>
-   <span data-ttu-id="f6d59-129">**IInterface2** dá suporte a **Method1 (int param1)**.</span><span class="sxs-lookup"><span data-stu-id="f6d59-129">**IInterface2** supports **Method1(int param1)**.</span></span>

<span data-ttu-id="f6d59-130">Um cliente ADSI tem um ponteiro de interface [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) para um objeto da classe ca.</span><span class="sxs-lookup"><span data-stu-id="f6d59-130">An ADSI client has an [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface pointer to an object of class CA.</span></span> <span data-ttu-id="f6d59-131">Ele quer invocar **IInterface2:: Method1**.</span><span class="sxs-lookup"><span data-stu-id="f6d59-131">It wants to invoke **IInterface2::Method1**.</span></span> <span data-ttu-id="f6d59-132">Se o cliente chama "pDispatch->GetIDsOfNames (IID \_ NULL, rgszNames, 1, My \_ LCID, rgDispId)" armazenando apenas o nome da função "method1" *em \[ rgszNames \] 0*, **IInterface1:: Method1** em vez do desired **IInterface2:: Method1** é invocado e a função falha porque o número de parâmetros é diferente.</span><span class="sxs-lookup"><span data-stu-id="f6d59-132">If the client calls "pDispatch->GetIDsOfNames(IID\_NULL, rgszNames, 1, MY\_LCID, rgDispId)" by just storing the function name "Method1" in *rgszNames\[0\]*, then **IInterface1::Method1** instead of the desired **IInterface2::Method1** is invoked, and the function fails because the number of parameters are different.</span></span>

<span data-ttu-id="f6d59-133">Para minimizar esse problema, os desenvolvedores de extensão podem prefixar seus nomes de função com seus próprios identificadores específicos e evitar designs de interface que usam funções de mesmo nome, mas parâmetros diferentes.</span><span class="sxs-lookup"><span data-stu-id="f6d59-133">To minimize this problem, extension developers can prefix their function names with their own specific identifiers and avoid interface designs that use functions of the same name, but different parameters.</span></span>

<span data-ttu-id="f6d59-134">Se ocorrer um conflito de nomes, os clientes ADSI poderão evitar o problema pelo acesso direto vtable se a interface for uma interface dupla.</span><span class="sxs-lookup"><span data-stu-id="f6d59-134">If a name conflict does occur, ADSI clients can avoid the problem by direct vtable access if the interface is a dual interface.</span></span> <span data-ttu-id="f6d59-135">Se o acesso Direct vtable não for possível, os clientes ADSI devem chamar [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) com vários nomes, especificando os nomes de função, bem como os parâmetros na matriz *rgszNames* descrita anteriormente.</span><span class="sxs-lookup"><span data-stu-id="f6d59-135">If direct vtable access is not possible, ADSI clients should call [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) with multiple names, specifying the function names as well as the parameters in the array *rgszNames* described previously.</span></span>

<span data-ttu-id="f6d59-136">Visual Basic 5 não chama a função [**IDispatch:: GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) com vários nomes.</span><span class="sxs-lookup"><span data-stu-id="f6d59-136">Visual Basic 5 does not call the [**IDispatch::GetIDsOfNames**](/windows/win32/api/oaidl/nf-oaidl-idispatch-getidsofnames) function with multiple names.</span></span> <span data-ttu-id="f6d59-137">Ou seja, ele passa apenas o nome da função para **GetIDsOfNames**, mas não para argumentos.</span><span class="sxs-lookup"><span data-stu-id="f6d59-137">That is, it passes only the function name to **GetIDsOfNames**, but not arguments.</span></span> <span data-ttu-id="f6d59-138">No entanto, Visual Basic 5 permite que os usuários invoquem uma função pelo acesso Direct vtable, em vez de invocar a função **IDispatch:: GetIDsOfNames** se a interface for uma interface dupla.</span><span class="sxs-lookup"><span data-stu-id="f6d59-138">However, Visual Basic 5 allows users to invoke a function by direct vtable access, instead of invoking the **IDispatch::GetIDsOfNames** function if the interface is a dual interface.</span></span> <span data-ttu-id="f6d59-139">Os desenvolvedores devem usar o acesso Direct vtable, se possível.</span><span class="sxs-lookup"><span data-stu-id="f6d59-139">Developers should use direct vtable access, if possible.</span></span>

<span data-ttu-id="f6d59-140">Para obter mais informações sobre a resolução de conflitos de nome, consulte o [exemplo para resolver conflitos de nome de função](example-for-resolving-function-name-conflicts.md).</span><span class="sxs-lookup"><span data-stu-id="f6d59-140">For more information about name conflict resolution, see [Example for Resolving Function Name Conflicts](example-for-resolving-function-name-conflicts.md).</span></span>

 

 