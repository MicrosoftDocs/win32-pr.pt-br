---
title: O que faz uma consulta rápida
description: Este tópico lista os métodos de programação preferenciais a serem usados ao consultar um diretório.
ms.assetid: d96f330f-3c57-4edc-9fd2-970f908b54c2
ms.tgt_platform: multiple
keywords:
- O que faz um ADSI de consulta rápida
- consultas ADSI, o que faz uma consulta rápida
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 883db1e9de7b7b7a1179c814d6f66f774685083e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "103823986"
---
# <a name="what-makes-a-fast-query"></a><span data-ttu-id="9f6ca-105">O que faz uma consulta rápida?</span><span class="sxs-lookup"><span data-stu-id="9f6ca-105">What Makes a Fast Query?</span></span>

<span data-ttu-id="9f6ca-106">Considere os seguintes conceitos de aprimoramento de desempenho ao executar uma consulta:</span><span class="sxs-lookup"><span data-stu-id="9f6ca-106">Consider the following performance enhancement concepts when executing a query:</span></span>

-   <span data-ttu-id="9f6ca-107">Se possível, filtre apenas os atributos indexados.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-107">If possible, filter on indexed attributes only.</span></span> <span data-ttu-id="9f6ca-108">Use atributos de índice que você espera gerará o menor número de ocorrências.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-108">Use index attributes that you expect will generate the fewest number of hits.</span></span> <span data-ttu-id="9f6ca-109">Para obter mais informações e uma lista abrangente de atributos indexados para o Windows, consulte [Active Directory esquema](/windows/desktop/ADSchema/active-directory-schema).</span><span class="sxs-lookup"><span data-stu-id="9f6ca-109">For more information and a comprehensive list of indexed attributes for Windows, see [Active Directory Schema](/windows/desktop/ADSchema/active-directory-schema).</span></span>
-   <span data-ttu-id="9f6ca-110">Pesquise por **objectCategory** em vez de **objectClass** porque **objectClass** não é uma propriedade indexada.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-110">Search on **objectCategory** instead of **objectClass** because **objectClass** is not an indexed property.</span></span>
-   <span data-ttu-id="9f6ca-111">Esteja atento às referências.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-111">Be aware of referrals.</span></span> <span data-ttu-id="9f6ca-112">Considere Pesquisar o catálogo global se seus atributos estiverem listados como GC replicado.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-112">Consider searching the global catalog if your attributes are listed as GC replicated.</span></span>
-   <span data-ttu-id="9f6ca-113">Evite Pesquisar texto no meio e no final de uma cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-113">Avoid searching for text in the middle and at the end of a string.</span></span> <span data-ttu-id="9f6ca-114">Por exemplo, "CN = \* Hill \* " ou "CN = \* Larouse".</span><span class="sxs-lookup"><span data-stu-id="9f6ca-114">For example, "cn=\*hille\*" or "cn=\*larouse".</span></span>
-   <span data-ttu-id="9f6ca-115">Suponha que uma pesquisa de subárvore retornará um grande conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-115">Assume that a subtree search will return a large result set.</span></span> <span data-ttu-id="9f6ca-116">Use a paginação ao executar pesquisas de subárvore.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-116">Use paging when performing subtree searches.</span></span> <span data-ttu-id="9f6ca-117">O servidor será capaz de transmitir um conjunto de resultados grande em partes que reduzem os recursos de memória do lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-117">The server will then be able to stream a large result set in chunks reducing the server-side memory resources.</span></span> <span data-ttu-id="9f6ca-118">Isso simplifica efetivamente o uso da rede e reduz a necessidade de enviar partes extremamente grandes de dados pela rede.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-118">This effectively flattens out network usage and reduces the need for sending extremely large chunks of data over the network.</span></span>
-   <span data-ttu-id="9f6ca-119">Delimitar corretamente suas pesquisas para não recuperar mais do que o necessário.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-119">Properly scope your searches so as to not retrieve more than is necessary.</span></span>
-   <span data-ttu-id="9f6ca-120">Execute uma pesquisa complexa em vários atributos, pois isso é menos intensivo de desempenho do que a execução de várias pesquisas.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-120">Perform a complex search on multiple attributes, because it is less performance intensive than performing multiple searches.</span></span> <span data-ttu-id="9f6ca-121">Uma pesquisa por um objeto que lê dois atributos é mais eficiente do que duas pesquisas para o mesmo objeto, cada uma retornando um atributo.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-121">One search for an object that reads two attributes is more efficient than two searches for the same object, each returning one attribute.</span></span>
-   <span data-ttu-id="9f6ca-122">Para ler o atributo com um grande número de valores, use limites de intervalo para minimizar o tamanho da pesquisa para que você possa ler alguns milhares de membros por vez.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-122">For reading attribute with a large number of values, use range limits to minimize the search size so that you can read a few thousand members at a time.</span></span> <span data-ttu-id="9f6ca-123">Para obter mais informações sobre como especificar limites de intervalo de atributos, consulte [recuperação de intervalo de atributos](attribute-range-retrieval.md).</span><span class="sxs-lookup"><span data-stu-id="9f6ca-123">For more information about specifying attribute range limits, see [Attribute Range Retrieval](attribute-range-retrieval.md).</span></span>
-   <span data-ttu-id="9f6ca-124">Associar a um objeto Mantenha o identificador de associação para o restante da sessão.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-124">Bind to an object hold the binding handle for the remainder of your session.</span></span> <span data-ttu-id="9f6ca-125">Não associe e desassocie para cada chamada.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-125">Do not bind and unbind for each call.</span></span> <span data-ttu-id="9f6ca-126">Se você estiver usando o ADO ou o OLE DB, não crie muitos objetos de conexão.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-126">If you are using ADO or OLE DB, do not create many connection objects.</span></span>
-   <span data-ttu-id="9f6ca-127">Leia o rootDSE uma vez e lembre-se do seu conteúdo para o restante da sessão.</span><span class="sxs-lookup"><span data-stu-id="9f6ca-127">Read the rootDSE once and remember its contents for the remainder of your session.</span></span>

 

 