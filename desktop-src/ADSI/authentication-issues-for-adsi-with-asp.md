---
title: Problemas de autenticação para ADSI com ASP
description: Dependendo da configuração da sua intranet, podem ocorrer problemas de autenticação quando o código ADSI é executado em uma página ASP.
ms.assetid: 287e2e19-7da9-497b-bf46-595ff4755261
ms.tgt_platform: multiple
keywords:
- ADSI, páginas ASP, problemas de autenticação
- Problemas de ADSI, autenticação e ASP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 423d1aa39006f89ca366423da9d135e00af45693
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "103641825"
---
# <a name="authentication-issues-for-adsi-with-asp"></a><span data-ttu-id="ff1d4-105">Problemas de autenticação para ADSI com ASP</span><span class="sxs-lookup"><span data-stu-id="ff1d4-105">Authentication Issues for ADSI with ASP</span></span>

<span data-ttu-id="ff1d4-106">Dependendo da configuração da sua intranet, podem ocorrer problemas de autenticação quando o código ADSI é executado em uma página ASP.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-106">Depending on the configuration of your intranet, authentication issues may occur when ADSI code is run from an ASP page.</span></span>

<span data-ttu-id="ff1d4-107">A autenticação para acessar o controlador de domínio pode ser fornecida usando a delegação.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-107">Authentication to access the domain controller can be given using delegation.</span></span> <span data-ttu-id="ff1d4-108">A delegação permite que um serviço atue como o usuário, para que ele possa acessar um recurso de rede usando essas credenciais de usuário.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-108">Delegation permits a service to act as the user, so it can access a network resource using that user credentials.</span></span> <span data-ttu-id="ff1d4-109">Se a sua intranet seguir essa configuração, você deverá configurar o IIS para usar a delegação.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-109">If your intranet follows this configuration, you must set up IIS to use delegation.</span></span> <span data-ttu-id="ff1d4-110">Defina o mecanismo de autenticação do IIS como anônimo ou NTLM.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-110">Set the IIS Authentication mechanism as Anonymous or NTLM.</span></span> <span data-ttu-id="ff1d4-111">Se você escolher anônimo, seu contexto de segurança será mapeado para a \_ conta da máquina IUSR.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-111">If you choose anonymous, your security context will be mapped to IUSR\_MACHINE account.</span></span> <span data-ttu-id="ff1d4-112">Se você selecionar NTLM, o contexto de segurança será alterado, dependendo de qual usuário fizer logon no seu site.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-112">If you select NTLM, the security context will change, depending on which user logs on to your website.</span></span> <span data-ttu-id="ff1d4-113">Para obter mais informações e instruções sobre como configurar o servidor IIS para delegação, consulte [Windows 2000 Resource Kit](https://support.microsoft.com/kb/927229).</span><span class="sxs-lookup"><span data-stu-id="ff1d4-113">For more information and instructions for setting up the IIS server for delegation, see [Windows 2000 Resource Kit](https://support.microsoft.com/kb/927229).</span></span>

<span data-ttu-id="ff1d4-114">Se você estiver usando um servidor IIS que usa o desafio/resposta NT ou um cliente de navegador que não oferece suporte a Kerberos, a autenticação de salto duplo não terá suporte.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-114">If you are using a an IIS server that uses the NT challenge/response, or a browser client that does not support Kerberos, then double-hop authentication is not supported.</span></span> <span data-ttu-id="ff1d4-115">Autenticação de salto duplo significa que as credenciais do usuário são passadas do cliente de navegador para o servidor IIS e, em seguida, o servidor IIS passa as credenciais para o servidor de back-end.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-115">Double-hop authentication means that the user credentials are passed from the browser client to the IIS server, and then the IIS server passes the credentials to the backend server.</span></span> <span data-ttu-id="ff1d4-116">Nessa situação, você pode usar uma das seguintes soluções para permitir o acesso ao diretório na página ASP:</span><span class="sxs-lookup"><span data-stu-id="ff1d4-116">In this situation, you can use one of the following solutions to allow access to the directory from the ASP page:</span></span>

-   <span data-ttu-id="ff1d4-117">Use [**IADsOpenDSObject:: OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) ou [**ADsOpenObject**](binding-with-adsopenobject-and-iadsopendsobject-opendsobject.md) para passar credenciais para Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-117">Use [**IADsOpenDSObject::OpenDSObject**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) or [**ADsOpenObject**](binding-with-adsopenobject-and-iadsopendsobject-opendsobject.md) to pass credentials to Active Directory.</span></span> <span data-ttu-id="ff1d4-118">A página da Web autentica o usuário conectado no servidor IIS.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-118">The webpage authenticates the connected user against the IIS server.</span></span> <span data-ttu-id="ff1d4-119">Quando o usuário foi autenticado, a página da Web pode usar OpenDSObject ou ADsOpenObject para passar um nome de usuário e senha para o serviço de diretório para obter a autenticação para o servidor de back-end.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-119">When the user has been authenticated, the webpage can use OpenDSObject or ADsOpenObject to pass a user name and password to the directory service to obtain authentication to the backend server.</span></span> <span data-ttu-id="ff1d4-120">A página da Web pode então acessar dados do diretório.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-120">The webpage can then access data from the directory.</span></span>
-   <span data-ttu-id="ff1d4-121">Adicione seu código a um objeto COM e coloque esse objeto em um [aplicativo com+](../cossdk/com--application-overview.md) (anteriormente chamado de pacote MTS).</span><span class="sxs-lookup"><span data-stu-id="ff1d4-121">Add your code to a COM object and put this object into a [COM+ application](../cossdk/com--application-overview.md) (previously called an MTS package).</span></span> <span data-ttu-id="ff1d4-122">O aplicativo COM+ pode ser executado como uma [conta de usuário de domínio](/windows/desktop/AD/domain-user-accounts).</span><span class="sxs-lookup"><span data-stu-id="ff1d4-122">The COM+ application can then be run as a [domain user account](/windows/desktop/AD/domain-user-accounts).</span></span>
-   <span data-ttu-id="ff1d4-123">Use várias páginas ASP, em que uma página autentica o cliente e uma outra página passa credenciais para o diretório usando a autenticação anônima em uma conta de usuário de domínio.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-123">Use multiple ASP pages, where one page authenticates the client and another page passes credentials to the directory using anonymous authentication on a domain user account.</span></span>

<span data-ttu-id="ff1d4-124">Esses métodos envolvem a autenticação do cliente Web e a alteração das credenciais ao entrar em contato com o diretório porque a autenticação de salto duplo, com as mesmas credenciais, não é possível.</span><span class="sxs-lookup"><span data-stu-id="ff1d4-124">These methods involve authenticating the web client and then changing the credentials when contacting the directory because double-hop authentication, with the same credentials, is not possible.</span></span>

 

 