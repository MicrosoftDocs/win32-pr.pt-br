---
title: Implementação de núcleo
description: Um provedor ADSI dá suporte aos seguintes recursos
ms.assetid: 39798237-a181-43b4-8441-ac711f923d4d
ms.tgt_platform: multiple
keywords:
- ADSI de implementação principal
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f62068bd77553f89e222422431811da1ef251ccd
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104008367"
---
# <a name="core-implementation"></a><span data-ttu-id="99c2f-104">Implementação de núcleo</span><span class="sxs-lookup"><span data-stu-id="99c2f-104">Core Implementation</span></span>

<span data-ttu-id="99c2f-105">Um provedor ADSI oferece suporte aos seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="99c2f-105">An ADSI provider supports the following features:</span></span>

-   <span data-ttu-id="99c2f-106">Cadeias de caracteres ADsPath no formato COM e URL.</span><span class="sxs-lookup"><span data-stu-id="99c2f-106">ADsPath strings in both COM and URL format.</span></span> <span data-ttu-id="99c2f-107">Por definição, você pode recuperar um objeto Active Directory usando um ADsPath.</span><span class="sxs-lookup"><span data-stu-id="99c2f-107">By definition, you can retrieve an Active Directory object using an ADsPath.</span></span> <span data-ttu-id="99c2f-108">Os provedores dão suporte à sintaxe que seu serviço de diretório requer usando a implementação **ParseDisplayName** .</span><span class="sxs-lookup"><span data-stu-id="99c2f-108">Providers support the syntax that their directory service requires using the **ParseDisplayName** implementation.</span></span>
-   <span data-ttu-id="99c2f-109">Um objeto de namespace de nível superior que dá suporte a [**IParseDisplayName::P arsedisplayname**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) e [**IADsOpenDSObject**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject).</span><span class="sxs-lookup"><span data-stu-id="99c2f-109">A top-level Namespace object that supports [**IParseDisplayName::ParseDisplayName**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) and [**IADsOpenDSObject**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject).</span></span> <span data-ttu-id="99c2f-110">Este objeto contém os nós raiz para este namespace.</span><span class="sxs-lookup"><span data-stu-id="99c2f-110">This object contains the root nodes for this namespace.</span></span> <span data-ttu-id="99c2f-111">Parte da implementação de **ParseDisplayName** deve incluir um analisador que verifica erros de sintaxe para seu próprio namespace.</span><span class="sxs-lookup"><span data-stu-id="99c2f-111">Part of the **ParseDisplayName** implementation must include a parser that checks for syntax errors for its own namespace.</span></span> <span data-ttu-id="99c2f-112">Esse objeto também deve oferecer suporte a [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) e **IADsOpenDSObject**.</span><span class="sxs-lookup"><span data-stu-id="99c2f-112">This object must also support [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) and **IADsOpenDSObject**.</span></span>
-   <span data-ttu-id="99c2f-113">A interface [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) .</span><span class="sxs-lookup"><span data-stu-id="99c2f-113">The [**IADs**](/windows/desktop/api/Iads/nn-iads-iads) interface.</span></span> <span data-ttu-id="99c2f-114">Isso inclui uma implementação de cache de propriedade simples por meio de [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) e [**IADs:: setinfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo).</span><span class="sxs-lookup"><span data-stu-id="99c2f-114">This includes a simple property cache implementation through [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) and [**IADs::SetInfo**](/windows/desktop/api/Iads/nf-iads-iads-setinfo).</span></span> <span data-ttu-id="99c2f-115">As operações que Obtém ou definem propriedades de objeto ocorrem no modo cache.</span><span class="sxs-lookup"><span data-stu-id="99c2f-115">Operations that get or set object properties occur in cached mode.</span></span> <span data-ttu-id="99c2f-116">Os valores de cache são gravados no repositório de diretório subjacente durante **IADs:: setinfo**.</span><span class="sxs-lookup"><span data-stu-id="99c2f-116">Cache values are written to the underlying directory store during **IADs::SetInfo**.</span></span> <span data-ttu-id="99c2f-117">No entanto, um método ADSI não é armazenado em cache, mas é executado imediatamente.</span><span class="sxs-lookup"><span data-stu-id="99c2f-117">An ADSI method, however, is not cached, but executes immediately.</span></span>
-   <span data-ttu-id="99c2f-118">As interfaces [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry) e [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue) para acessar e enumerar diretamente as propriedades no cache de propriedades.</span><span class="sxs-lookup"><span data-stu-id="99c2f-118">The [**IADsPropertyList**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IADsPropertyEntry**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry) and [**IADsPropertyValue**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue) interfaces for directly accessing and enumerating the properties in the property cache.</span></span> <span data-ttu-id="99c2f-119">Para serviços de diretório que não expõem um esquema, essa interface permite que você manipule as propriedades de um objeto.</span><span class="sxs-lookup"><span data-stu-id="99c2f-119">For directory services that do not expose a schema, this interface allows you to manipulate the properties of an object.</span></span>
-   <span data-ttu-id="99c2f-120">A interface [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) para clientes que não são de automação.</span><span class="sxs-lookup"><span data-stu-id="99c2f-120">The [**IDirectoryObject**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) interface for non-Automation clients.</span></span> <span data-ttu-id="99c2f-121">Isso usa o protocolo over-the-fios para obter o desempenho máximo e ignora o cache de propriedades.</span><span class="sxs-lookup"><span data-stu-id="99c2f-121">This uses over-the-wire protocol for maximum performance and bypasses the property cache.</span></span>
-   <span data-ttu-id="99c2f-122">A interface [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) .</span><span class="sxs-lookup"><span data-stu-id="99c2f-122">The [**IADsContainer**](/windows/desktop/api/Iads/nn-iads-iadscontainer) interface.</span></span> <span data-ttu-id="99c2f-123">Cada objeto de Active Directory tem um contêiner pai que controla seu tempo de vida.</span><span class="sxs-lookup"><span data-stu-id="99c2f-123">Every Active Directory object has a parent container that controls its lifetime.</span></span> <span data-ttu-id="99c2f-124">Lembre-se de que, para objetos de contêiner ADs, [**IADs:: GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) afeta apenas as propriedades do contêiner e não seu conteúdo.</span><span class="sxs-lookup"><span data-stu-id="99c2f-124">Be aware that for ADs container objects, [**IADs::GetInfo**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) affects only the container properties and not its contents.</span></span> <span data-ttu-id="99c2f-125">Setinfo nos objetos de contêiner do ADs afeta apenas as propriedades do contêiner e não afeta objetos recém-criados ou objetos que já existem no contêiner.</span><span class="sxs-lookup"><span data-stu-id="99c2f-125">SetInfo on ADs container objects affects only the container properties and does not affect newly created objects or objects that already exist within the container.</span></span>
-   <span data-ttu-id="99c2f-126">A interface [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="99c2f-126">The [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface.</span></span> <span data-ttu-id="99c2f-127">Essa é a interface de automação para linguagens como Visual Basic Scripting Edition, que não usam Associação de tempo de compilação.</span><span class="sxs-lookup"><span data-stu-id="99c2f-127">This is the Automation interface for languages like Visual Basic Scripting Edition, that do not use compile-time binding.</span></span> <span data-ttu-id="99c2f-128">Relacionado a esses são os dados de biblioteca de tipos que um provedor deve fornecer.</span><span class="sxs-lookup"><span data-stu-id="99c2f-128">Related to this is the type library data that a provider must supply.</span></span> <span data-ttu-id="99c2f-129">Para obter mais informações, consulte [problemas de implementação para provedores ADSI](implementation-issues-for-adsi-providers.md).</span><span class="sxs-lookup"><span data-stu-id="99c2f-129">For more information, see [Implementation Issues for ADSI Providers](implementation-issues-for-adsi-providers.md).</span></span>
-   <span data-ttu-id="99c2f-130">Um objeto de contêiner de classe de esquema e a sintaxe apropriada, a propriedade e os objetos de classe de esquema que dão suporte a [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax), [**iadsproperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty)e [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass) , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="99c2f-130">A schema class container object and the appropriate syntax, property, and schema class objects that support [**IADsSyntax**](/windows/desktop/api/Iads/nn-iads-iadssyntax), [**IADsProperty**](/windows/desktop/api/Iads/nn-iads-iadsproperty), and [**IADsClass**](/windows/desktop/api/Iads/nn-iads-iadsclass) respectively.</span></span> <span data-ttu-id="99c2f-131">No mínimo, cada nó raiz deve conter seu próprio objeto contêiner de classe de esquema.</span><span class="sxs-lookup"><span data-stu-id="99c2f-131">At a minimum, each root node must contain its own schema class container object.</span></span>
-   <span data-ttu-id="99c2f-132">A interface [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) , se quaisquer atributos com suporte forem coleções de objetos ADSI, como grupos de segurança.</span><span class="sxs-lookup"><span data-stu-id="99c2f-132">The [**IADsMembers**](/windows/desktop/api/Iads/nn-iads-iadsmembers) interface, if any supported attributes are collections of ADSI objects, such as security groups.</span></span>
-   <span data-ttu-id="99c2f-133">A interface [**iadscollection**](/windows/desktop/api/Iads/nn-iads-iadscollection) , se quaisquer atributos com suporte forem coleções do mesmo tipo de elemento de diretório com o recurso [**iadscollection:: Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add) e [**iadscollection:: Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove) .</span><span class="sxs-lookup"><span data-stu-id="99c2f-133">The [**IADsCollection**](/windows/desktop/api/Iads/nn-iads-iadscollection) interface, if any supported attributes are collections of the same directory element type with [**IADsCollection::Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add) and [**IADsCollection::Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove) capability.</span></span>
-   <span data-ttu-id="99c2f-134">A enumeração **IEnumXXXX** dá suporte a todos os objetos de enumerador específicos.</span><span class="sxs-lookup"><span data-stu-id="99c2f-134">The **IEnumXXXX** enumeration supports all specific enumerator objects.</span></span>
-   <span data-ttu-id="99c2f-135">Rotinas para mapear a sintaxe e converter dados nativos para o tipo de dados [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) .</span><span class="sxs-lookup"><span data-stu-id="99c2f-135">Routines to map syntax and convert native data to the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) data type.</span></span>
-   <span data-ttu-id="99c2f-136">Siga as convenções ADSI para objetos ADSI fornecidos pelo provedor.</span><span class="sxs-lookup"><span data-stu-id="99c2f-136">Follow ADSI conventions for provider-supplied ADSI objects.</span></span> <span data-ttu-id="99c2f-137">Inclua arquivos de ajuda e bibliotecas de tipos documentando as propriedades e métodos da interface.</span><span class="sxs-lookup"><span data-stu-id="99c2f-137">Include help files and type libraries documenting the interface properties and methods.</span></span>

<span data-ttu-id="99c2f-138">Assim como ocorre com qualquer implementação de COM, as chamadas para [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) devem retornar **e \_ nointerface** para interfaces não implementadas, **e \_ NOTIMPL** para métodos não implementados de interfaces que, de outra forma, são implementadas e retornam a **\_ propriedade e ADS \_ \_ sem \_ suporte** para propriedades não implementadas.</span><span class="sxs-lookup"><span data-stu-id="99c2f-138">As with any COM implementation, calls to [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) must return **E\_NOINTERFACE** for unimplemented interfaces, **E\_NOTIMPL** for unimplemented methods of interfaces that are otherwise implemented and return **E\_ADS\_PROPERTY\_NOT\_SUPPORTED** for unimplemented properties.</span></span> <span data-ttu-id="99c2f-139">Para obter mais informações sobre interfaces duplas e como elas afetam a implementação da propriedade, consulte [interfaces duplas](dual-interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="99c2f-139">For more information about dual interfaces and how they affect property implementation, see [Dual Interfaces](dual-interfaces.md).</span></span>

 

 