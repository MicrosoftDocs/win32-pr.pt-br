---
description: Para indexar o conteúdo e as propriedades dos novos formatos de arquivo e armazenamentos de dados, o Microsoft Windows Search deve ser estendido com suplementos.
ms.assetid: 04ddcd97-c358-44d2-9092-a035436c50c9
title: Windows Search como uma plataforma de desenvolvimento
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 19041ac23c90006cc2f1b2f6146cb20a6b972fc2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103646885"
---
# <a name="windows-search-as-a-development-platform"></a><span data-ttu-id="05d32-103">Windows Search como uma plataforma de desenvolvimento</span><span class="sxs-lookup"><span data-stu-id="05d32-103">Windows Search as a Development Platform</span></span>

<span data-ttu-id="05d32-104">Para indexar o conteúdo e as propriedades dos novos formatos de arquivo e armazenamentos de dados, o Microsoft Windows Search deve ser estendido com suplementos.</span><span class="sxs-lookup"><span data-stu-id="05d32-104">To index the contents and properties of new file formats and data stores, Microsoft Windows Search must be extended with add-ins.</span></span>

<span data-ttu-id="05d32-105">Antes que um desenvolvedor de terceiros de novos formatos de arquivo e armazenamentos de dados possa obter esses formatos e lojas para que apareçam nos resultados da consulta no Windows Explorer, o desenvolvedor deve fazer as três coisas a seguir:</span><span class="sxs-lookup"><span data-stu-id="05d32-105">Before a third-party developer of new file formats and data stores can get those formats and stores to appear in query results in Windows Explorer, the developer must do the following three things:</span></span>

-   <span data-ttu-id="05d32-106">Implemente uma fonte de dados do Shell para estender o namespace do Shell.</span><span class="sxs-lookup"><span data-stu-id="05d32-106">Implement a Shell data source to extend the Shell namespace.</span></span>
-   <span data-ttu-id="05d32-107">Expor itens em um repositório de dados (se eles estiverem adicionando um novo armazenamento de dados, porque ele precisaria ser indexado).</span><span class="sxs-lookup"><span data-stu-id="05d32-107">Expose items in a data store (if they are adding a new data store, because it would need to be indexed).</span></span>
-   <span data-ttu-id="05d32-108">Desenvolva um manipulador de protocolo para que o Windows Search possa acessar os dados para indexação.</span><span class="sxs-lookup"><span data-stu-id="05d32-108">Develop a protocol handler so that Windows Search can access the data for indexing.</span></span>

<span data-ttu-id="05d32-109">Este tópico é organizado da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="05d32-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="05d32-110">Introdução</span><span class="sxs-lookup"><span data-stu-id="05d32-110">Getting Started</span></span>](#getting-started)
-   [<span data-ttu-id="05d32-111">Visão geral dos cenários de desenvolvimento de pesquisa</span><span class="sxs-lookup"><span data-stu-id="05d32-111">Overview of Search Development Scenarios</span></span>](#overview-of-search-development-scenarios)
    -   [<span data-ttu-id="05d32-112">Adicionando um novo armazenamento de dados</span><span class="sxs-lookup"><span data-stu-id="05d32-112">Adding a New Data Store</span></span>](#adding-a-new-data-store)
    -   [<span data-ttu-id="05d32-113">Adicionando um novo formato de arquivo</span><span class="sxs-lookup"><span data-stu-id="05d32-113">Adding a New File Format</span></span>](#adding-a-new-file-format)
    -   [<span data-ttu-id="05d32-114">Consumindo resultados da pesquisa do Windows</span><span class="sxs-lookup"><span data-stu-id="05d32-114">Consuming Windows Search Results</span></span>](#consuming-windows-search-results)
-   [<span data-ttu-id="05d32-115">Visão geral dos manipuladores</span><span class="sxs-lookup"><span data-stu-id="05d32-115">Overview of Handlers</span></span>](#overview-of-handlers)
-   [<span data-ttu-id="05d32-116">Diretrizes do instalador do suplemento</span><span class="sxs-lookup"><span data-stu-id="05d32-116">Add-in Installer Guidelines</span></span>](#add-in-installer-guidelines)
-   [<span data-ttu-id="05d32-117">Observação para implementadores</span><span class="sxs-lookup"><span data-stu-id="05d32-117">Note to Implementers</span></span>](#note-to-implementers)
-   [<span data-ttu-id="05d32-118">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="05d32-118">Additional Resources</span></span>](#additional-resources)
-   [<span data-ttu-id="05d32-119">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="05d32-119">Related topics</span></span>](#related-topics)

## <a name="getting-started"></a><span data-ttu-id="05d32-120">Introdução</span><span class="sxs-lookup"><span data-stu-id="05d32-120">Getting Started</span></span>

<span data-ttu-id="05d32-121">Antes de começar a criar um aplicativo de pesquisa do Windows, lembre-se de que a maneira preferida de fazer isso é por meio de uma fonte de dados do Shell.</span><span class="sxs-lookup"><span data-stu-id="05d32-121">Before you start creating a Windows Search application, remember that the preferred way to do it is through a Shell data source.</span></span> <span data-ttu-id="05d32-122">Uma fonte de dados do Shell estende o namespace do Shell e expõe os itens em um armazenamento de dados.</span><span class="sxs-lookup"><span data-stu-id="05d32-122">A Shell data source extends the Shell namespace and exposes the items in a data store.</span></span> <span data-ttu-id="05d32-123">Os itens no armazenamento de dados podem ser indexados pelo sistema de pesquisa do Windows usando um manipulador de protocolo.</span><span class="sxs-lookup"><span data-stu-id="05d32-123">The items in the data store can then be indexed by the Windows Search system by using a protocol handler.</span></span> <span data-ttu-id="05d32-124">Essa abordagem indireta para acessar o Windows Search implementando uma fonte de dados do Shell é preferida porque fornece acesso à funcionalidade completa do Shell.</span><span class="sxs-lookup"><span data-stu-id="05d32-124">This indirect approach for accessing Windows Search by implementing a Shell data source is preferred because it provides access to full Shell functionality.</span></span> <span data-ttu-id="05d32-125">Fazer isso dessa forma garante uma experiência de usuário razoável.</span><span class="sxs-lookup"><span data-stu-id="05d32-125">Doing it this way ensures a reasonable user experience.</span></span>

<span data-ttu-id="05d32-126">Se desejar que os resultados da consulta apareçam no Windows Explorer, você deverá implementar uma fonte de dados do Shell antes de poder criar um manipulador de protocolo para estender o índice.</span><span class="sxs-lookup"><span data-stu-id="05d32-126">If you want the query results to appear in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="05d32-127">No entanto, se todas as consultas forem programáticas (por meio de OLE DB, por exemplo) e interpretadas pelo código do aplicativo em vez do Shell, um namespace de shell ainda será preferível, mas não obrigatório.</span><span class="sxs-lookup"><span data-stu-id="05d32-127">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application's code rather than the Shell, a Shell namespace is still preferred but not required.</span></span>

<span data-ttu-id="05d32-128">Um manipulador de protocolo é necessário para que o Windows obtenha conhecimento do conteúdo do arquivo, como itens em bancos de dados ou tipos de arquivo personalizados.</span><span class="sxs-lookup"><span data-stu-id="05d32-128">A protocol handler is required for Windows to obtain knowledge of file contents, such as items in databases or custom file types.</span></span> <span data-ttu-id="05d32-129">Embora o Windows Search possa indexar o nome e as propriedades do arquivo, o Windows não tem conhecimento do conteúdo do arquivo.</span><span class="sxs-lookup"><span data-stu-id="05d32-129">While Windows Search can index the name and properties of the file, Windows has no knowledge of the content of the file.</span></span> <span data-ttu-id="05d32-130">Como resultado, esses itens não podem ser indexados ou expostos no Shell do Windows.</span><span class="sxs-lookup"><span data-stu-id="05d32-130">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="05d32-131">Ao implementar um manipulador de protocolo personalizado, você pode expor esses itens.</span><span class="sxs-lookup"><span data-stu-id="05d32-131">By implementing a custom protocol handler, you can expose these items.</span></span> <span data-ttu-id="05d32-132">Para obter uma lista de manipuladores identificados pelo cenário do desenvolvedor que você está tentando obter, consulte [visão geral dos manipuladores](#overview-of-handlers).</span><span class="sxs-lookup"><span data-stu-id="05d32-132">For a list of handlers identified by the developer scenario you are trying to achieve, see [Overview of Handlers](#overview-of-handlers).</span></span>

## <a name="overview-of-search-development-scenarios"></a><span data-ttu-id="05d32-133">Visão geral dos cenários de desenvolvimento de pesquisa</span><span class="sxs-lookup"><span data-stu-id="05d32-133">Overview of Search Development Scenarios</span></span>

<span data-ttu-id="05d32-134">Os cenários de desenvolvimento mais comuns no Windows Search são:</span><span class="sxs-lookup"><span data-stu-id="05d32-134">The most common development scenarios in Windows Search are:</span></span>

-   [<span data-ttu-id="05d32-135">Adicionando um novo armazenamento de dados</span><span class="sxs-lookup"><span data-stu-id="05d32-135">Adding a new data store</span></span>](#adding-a-new-data-store)
-   [<span data-ttu-id="05d32-136">Adicionando um novo formato de arquivo</span><span class="sxs-lookup"><span data-stu-id="05d32-136">Adding a new file format</span></span>](#adding-a-new-file-format)
-   [<span data-ttu-id="05d32-137">Consumindo resultados da pesquisa do Windows</span><span class="sxs-lookup"><span data-stu-id="05d32-137">Consuming Windows Search results</span></span>](#consuming-windows-search-results)

### <a name="adding-a-new-data-store"></a><span data-ttu-id="05d32-138">Adicionando um novo armazenamento de dados</span><span class="sxs-lookup"><span data-stu-id="05d32-138">Adding a New Data Store</span></span>

<span data-ttu-id="05d32-139">Você precisará de um armazenamento de dados do Shell para Windows Search somente se estiver adicionando um novo armazenamento de dados a ser indexado.</span><span class="sxs-lookup"><span data-stu-id="05d32-139">You need a Shell data store for Windows Search only if you are adding a new data store to be indexed.</span></span> <span data-ttu-id="05d32-140">Um repositório de dados é um repositório de dados que podem ser expostos ao modelo de programação do shell como um contêiner usando uma fonte de dados do Shell.</span><span class="sxs-lookup"><span data-stu-id="05d32-140">A data store is a repository of data that can be exposed to the Shell programming model as a container by using a Shell data source.</span></span> <span data-ttu-id="05d32-141">Os itens em um armazenamento de dados podem então ser indexados pelo sistema de pesquisa do Windows usando um manipulador de protocolo.</span><span class="sxs-lookup"><span data-stu-id="05d32-141">The items in a data store can then be indexed by the Windows Search system using a protocol handler.</span></span> <span data-ttu-id="05d32-142">O manipulador de protocolo implementa o protocolo para acessar uma fonte de conteúdo em seu formato nativo.</span><span class="sxs-lookup"><span data-stu-id="05d32-142">The protocol handler implements the protocol for accessing a content source in its native format.</span></span> <span data-ttu-id="05d32-143">As interfaces [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol) e [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2) são usadas para implementar um manipulador de protocolo personalizado para expandir as fontes de dados que podem ser indexadas.</span><span class="sxs-lookup"><span data-stu-id="05d32-143">The [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol) and [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2) interfaces are used to implement a custom protocol handler to expand the data sources that can be indexed.</span></span> <span data-ttu-id="05d32-144">Para obter informações sobre como criar uma fonte de dados do Shell, consulte [implementando as interfaces de objeto de pasta básica](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="05d32-144">For information about creating a Shell data source, see [Implementing the Basic Folder Object Interfaces](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span></span>

### <a name="adding-a-new-file-format"></a><span data-ttu-id="05d32-145">Adicionando um novo formato de arquivo</span><span class="sxs-lookup"><span data-stu-id="05d32-145">Adding a New File Format</span></span>

<span data-ttu-id="05d32-146">Se você adicionar um novo formato de arquivo personalizado, será necessário desenvolver um manipulador de filtro ou um manipulador de propriedades, mas não ambos.</span><span class="sxs-lookup"><span data-stu-id="05d32-146">If you add a new custom file format, you need to develop either a filter handler or a property handler, but not both.</span></span> <span data-ttu-id="05d32-147">Um filtro é uma implementação da interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="05d32-147">A filter is an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="05d32-148">Ele abre arquivos de um tipo de arquivo específico e filtra as propriedades e partes do texto do indexador.</span><span class="sxs-lookup"><span data-stu-id="05d32-148">It opens files of a particular file type, and filters properties and chunks of text for the indexer.</span></span> <span data-ttu-id="05d32-149">Os filtros são associados a tipos de arquivo, como indicado pelas extensões de nome de arquivo, tipos de MIME ou identificadores de classe (CLSIDs).</span><span class="sxs-lookup"><span data-stu-id="05d32-149">Filters are associated with file types, as denoted by file name extensions, MIME types, or class identifiers (CLSIDs).</span></span> <span data-ttu-id="05d32-150">Embora um filtro possa lidar com vários tipos de arquivo, cada tipo de arquivo funciona com apenas um filtro.</span><span class="sxs-lookup"><span data-stu-id="05d32-150">Although one filter can handle multiple file types, each file type works with only one filter.</span></span>

<span data-ttu-id="05d32-151">Um manipulador de propriedades traduz os dados armazenados em um arquivo em um esquema estruturado que é reconhecido pelo e pode ser acessado pelo Windows Explorer, pelo Windows Search e por outros aplicativos.</span><span class="sxs-lookup"><span data-stu-id="05d32-151">A property handler translates data stored in a file into a structured schema that is recognized by and can be accessed by Windows Explorer, Windows Search, and other applications.</span></span> <span data-ttu-id="05d32-152">Esses sistemas podem interagir com o manipulador de propriedades para gravar e ler propriedades de e para um arquivo.</span><span class="sxs-lookup"><span data-stu-id="05d32-152">These systems can then interact with the property handler to write and read properties to and from a file.</span></span> <span data-ttu-id="05d32-153">Os dados traduzidos incluem exibição de detalhes, infotips, painel de detalhes, páginas de propriedades e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="05d32-153">The translated data includes details view, infotips, details pane, property pages, and so forth.</span></span> <span data-ttu-id="05d32-154">Cada manipulador de propriedade é associado a um tipo de arquivo específico, identificado pela extensão de nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="05d32-154">Each property handler is associated with a particular file type, identified by the file name extension.</span></span> <span data-ttu-id="05d32-155">Você precisa de um manipulador de propriedades para fazer o seguinte:</span><span class="sxs-lookup"><span data-stu-id="05d32-155">You need a property handler to do the following:</span></span>

-   <span data-ttu-id="05d32-156">Mostrar propriedades de item não indexadas na interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="05d32-156">Show non-indexed item properties in the UI.</span></span>
-   <span data-ttu-id="05d32-157">Suporte à gravação de propriedades.</span><span class="sxs-lookup"><span data-stu-id="05d32-157">Support writing properties.</span></span>

### <a name="consuming-windows-search-results"></a><span data-ttu-id="05d32-158">Consumindo resultados da pesquisa do Windows</span><span class="sxs-lookup"><span data-stu-id="05d32-158">Consuming Windows Search Results</span></span>

<span data-ttu-id="05d32-159">As seções a seguir descrevem várias maneiras de consumir os resultados da pesquisa do Windows:</span><span class="sxs-lookup"><span data-stu-id="05d32-159">The following sections describe several ways of consuming Windows Search results:</span></span>

-   [<span data-ttu-id="05d32-160">Consultando dados</span><span class="sxs-lookup"><span data-stu-id="05d32-160">Querying data</span></span>](#querying-data)
-   [<span data-ttu-id="05d32-161">Consultando armazenamentos de dados remotos (pesquisa federada)</span><span class="sxs-lookup"><span data-stu-id="05d32-161">Querying remote data stores (Federated Search)</span></span>](#querying-remote-data-stores-federated-search)
-   [<span data-ttu-id="05d32-162">Indexando arquivos e itens</span><span class="sxs-lookup"><span data-stu-id="05d32-162">Indexing files and items</span></span>](#indexing-files-and-items)
-   [<span data-ttu-id="05d32-163">Indexando um armazenamento de dados</span><span class="sxs-lookup"><span data-stu-id="05d32-163">Indexing a data store</span></span>](#indexing-a-data-store)
-   [<span data-ttu-id="05d32-164">Gerenciando o processo de indexação</span><span class="sxs-lookup"><span data-stu-id="05d32-164">Managing the indexing process</span></span>](#managing-the-indexing-process)
-   [<span data-ttu-id="05d32-165">Integrando o sistema de propriedades do Windows com aplicativos Windows Search</span><span class="sxs-lookup"><span data-stu-id="05d32-165">Integrating the Windows Property System with Windows Search applications</span></span>](#integrating-the-windows-property-system-with-windows-search-applications)

### <a name="querying-data"></a><span data-ttu-id="05d32-166">Consultar Dados</span><span class="sxs-lookup"><span data-stu-id="05d32-166">Querying Data</span></span>

<span data-ttu-id="05d32-167">Os desenvolvedores que escrevem aplicativos sobre o Windows Search combinado e o sistema de propriedades do Windows podem acessar arquivos e itens, independentemente do aplicativo ou tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="05d32-167">Developers writing applications on top of the combined Windows Search and Windows property system can access files and items regardless of application or file type.</span></span> <span data-ttu-id="05d32-168">Há duas maneiras de os aplicativos acessarem os dados do indexador:</span><span class="sxs-lookup"><span data-stu-id="05d32-168">There are two ways for applications to access the indexer data:</span></span>

-   <span data-ttu-id="05d32-169">Os aplicativos se comunicam diretamente com o OLE DB enviando consultas do Windows Search linguagem SQL (SQL) para o provedor de OLE DB do Windows Search para recuperar os resultados.</span><span class="sxs-lookup"><span data-stu-id="05d32-169">Applications communicate directly with OLE DB by sending Windows Search Structured Query Language (SQL) queries to the Windows Search OLE DB provider to retrieve results.</span></span> <span data-ttu-id="05d32-170">As consultas podem ser construídas manualmente ou usando a interface [**ISearchQueryHelper**](/windows/win32/api/Searchapi/nn-searchapi-isearchqueryhelper) para gerar o SQL a partir de palavras-chave de pesquisa e AQS (sintaxe de consulta avançada).</span><span class="sxs-lookup"><span data-stu-id="05d32-170">Queries can be constructed manually or by using the [**ISearchQueryHelper**](/windows/win32/api/Searchapi/nn-searchapi-isearchqueryhelper) interface to generate the SQL from search keywords, and Advanced Query Syntax (AQS).</span></span>
-   <span data-ttu-id="05d32-171">Os aplicativos funcionam por meio da camada do Shell.</span><span class="sxs-lookup"><span data-stu-id="05d32-171">Applications work through the Shell layer.</span></span> <span data-ttu-id="05d32-172">A vantagem da camada de Shell é que ela também oferece suporte a outras fontes como o grep.</span><span class="sxs-lookup"><span data-stu-id="05d32-172">The advantage of the Shell layer is that it also supports other sources like grep.</span></span> <span data-ttu-id="05d32-173">No entanto, a desvantagem é que nem todos os recursos do indexador estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="05d32-173">However, the disadvantage is that not all indexer features are available.</span></span>

<span data-ttu-id="05d32-174">Outra opção é usar os protocolos Search-MS://e search://, que executam pesquisas baseadas em URL renderizadas por meio do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="05d32-174">Another option is using the search-ms:// and search:// protocols, which execute URL-based searches rendered through Windows Explorer.</span></span> <span data-ttu-id="05d32-175">Essa opção habilita o desenvolvimento de peso mais leve, mas não retorna resultados ou seleções de usuário da exibição de resultados para o aplicativo de chamada.</span><span class="sxs-lookup"><span data-stu-id="05d32-175">This option enables the lightest-weight development but does not return results or user selections from the results view to the calling application.</span></span> <span data-ttu-id="05d32-176">Além disso, como outros protocolos, os aplicativos de pesquisa de terceiros podem assumir os protocolos de pesquisa-MS://e search://se os aplicativos estiverem em conformidade com o conjunto de recursos necessário.</span><span class="sxs-lookup"><span data-stu-id="05d32-176">Also, like other protocols, third-party search applications can take over the search-ms:// and search:// protocols if the applications conform to the required feature set.</span></span> <span data-ttu-id="05d32-177">Para obter mais informações sobre a consulta, consulte [consultar o processo no Windows Search](querying-process--windows-search-.md) e [consultar o índice programaticamente](-search-3x-wds-qryidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="05d32-177">For more information on querying, see [Querying Process in Windows Search](querying-process--windows-search-.md) and [Querying the Index Programmatically](-search-3x-wds-qryidx-overview.md).</span></span>

### <a name="querying-remote-data-stores-federated-search"></a><span data-ttu-id="05d32-178">Consultando armazenamentos de dados remotos (pesquisa federada)</span><span class="sxs-lookup"><span data-stu-id="05d32-178">Querying Remote Data Stores (Federated Search)</span></span>

<span data-ttu-id="05d32-179">No Windows 7 e posterior, a pesquisa federada oferece um novo provedor de pesquisa que consulta armazenamentos de dados remotos por meio de servidores Web, por meio do protocolo [OpenSearch](https://github.com/dewitt/opensearch) , e enumera os resultados como RSS ou Atom feeds XML.</span><span class="sxs-lookup"><span data-stu-id="05d32-179">In Windows 7 and later, federated search offers a new search provider that queries remote data stores through web servers, through the [OpenSearch](https://github.com/dewitt/opensearch) protocol, and enumerates the results as RSS or Atom XML feeds.</span></span> <span data-ttu-id="05d32-180">Os conectores de pesquisa são junções de namespace que simulam o comportamento da pasta usando um provedor de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="05d32-180">Search Connectors are namespace junctions that simulate folder behavior by using a search provider.</span></span> <span data-ttu-id="05d32-181">Para obter mais informações sobre a Federação de pesquisa para armazenamentos de dados remotos no Windows 7, consulte [pesquisa federada no Windows](-search-federated-search-overview.md).</span><span class="sxs-lookup"><span data-stu-id="05d32-181">For more information about search federation to remote data stores in Windows 7, see [Federated Search in Windows](-search-federated-search-overview.md).</span></span>

### <a name="indexing-files-and-items"></a><span data-ttu-id="05d32-182">Indexando arquivos e itens</span><span class="sxs-lookup"><span data-stu-id="05d32-182">Indexing Files and Items</span></span>

<span data-ttu-id="05d32-183">O conteúdo que é indexado baseia-se nos tipos de arquivo e dados com suporte por meio de suplementos incluídos no Windows Search e das regras de inclusão e exclusão padrão para pastas no sistema de arquivos.</span><span class="sxs-lookup"><span data-stu-id="05d32-183">The content that is indexed is based on the file and data types supported through add-ins included with Windows Search and the default inclusion and exclusion rules for folders in the file system.</span></span> <span data-ttu-id="05d32-184">Por exemplo, os filtros incluídos na pesquisa de janela dão suporte a mais de 200 tipos comuns de dados, incluindo Microsoft Office documentos, email do Microsoft Outlook (em conjunto com o manipulador de protocolo MAPI), arquivos de texto sem formatação, HTML e muito mais.</span><span class="sxs-lookup"><span data-stu-id="05d32-184">For example, the filters included in Window Search support over 200 common types of data, including Microsoft Office documents, Microsoft Outlook email (in conjunction with the MAPI protocol handler), plain-text files, HTML, and many more.</span></span> <span data-ttu-id="05d32-185">Para obter uma lista completa de tipos de arquivo com suporte nativo, consulte [o que está incluído no índice](-search-3x-wds-included-in-index.md).</span><span class="sxs-lookup"><span data-stu-id="05d32-185">For a full list of file types natively supported, see [What Is Included in the Index](-search-3x-wds-included-in-index.md).</span></span>

<span data-ttu-id="05d32-186">O índice pode ser estendido com manipuladores de propriedade e filtros para expor o conteúdo e as propriedades dos novos formatos de arquivo para o índice e o Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="05d32-186">The index can be extended with property handlers and filters to expose the content and properties of new file formats to the index and Windows Explorer.</span></span> <span data-ttu-id="05d32-187">Filtros são uma implementação da interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="05d32-187">Filters are an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="05d32-188">Há dois tipos de filtros: um que interage com itens individuais, como arquivos, e um que interage com contêineres como pastas.</span><span class="sxs-lookup"><span data-stu-id="05d32-188">There are two kinds of filters: one that interacts with individual items such as files and one that interacts with containers such as folders.</span></span> <span data-ttu-id="05d32-189">Os filtros são de várias finalidades, pois dão suporte a dados de agrupamento, conteúdo de texto, algumas propriedades e vários idiomas.</span><span class="sxs-lookup"><span data-stu-id="05d32-189">Filters are multi-purpose in that they support chunking data, text content, some properties, and multiple languages.</span></span>

<span data-ttu-id="05d32-190">Por outro lado, os manipuladores de propriedade têm uma finalidade mais específica: para expor as propriedades de tipos de arquivo específicos que são identificadas pelas extensões de nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="05d32-190">In contrast, property handlers have a more specific purpose: to expose the properties of specific file types that are identified by file name extensions.</span></span> <span data-ttu-id="05d32-191">Um manipulador de propriedades para um tipo de arquivo pode habilitar as propriedades Get e set e pode enumerar as propriedades associadas a esse tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="05d32-191">A property handler for a file type can enable get and set properties, and can enumerate the properties associated with that file type.</span></span> <span data-ttu-id="05d32-192">Ao contrário dos filtros, os manipuladores de propriedades não dão suporte a dados de texto ou de conteúdo de textos, e os manipuladores de propriedade não têm como indicar em qual idioma uma propriedade de texto está, a menos que ofereçam suporte a propriedades de gravação.</span><span class="sxs-lookup"><span data-stu-id="05d32-192">Unlike filters, property handlers do not support chucking data or text content, and property handlers have no way of indicating what language a text property is in unless they support writing properties.</span></span>

### <a name="indexing-a-data-store"></a><span data-ttu-id="05d32-193">Indexando um armazenamento de dados</span><span class="sxs-lookup"><span data-stu-id="05d32-193">Indexing a Data Store</span></span>

<span data-ttu-id="05d32-194">O índice pode ser estendido com manipuladores de protocolo para fornecer acesso a armazenamentos de dados proprietários.</span><span class="sxs-lookup"><span data-stu-id="05d32-194">The index can be extended with protocol handlers to provide access to proprietary data stores.</span></span> <span data-ttu-id="05d32-195">Por exemplo, arquivos e itens contidos em armazenamentos de dados do sistema de arquivos que não são de arquivo (como bancos de dados e armazenamentos de email) exigem um manipulador de protocolo para mapear de uma URL para um fluxo.</span><span class="sxs-lookup"><span data-stu-id="05d32-195">For example, files and items contained in non-file-system data stores (such as databases and email stores) require a protocol handler to map from a URL to a stream.</span></span> <span data-ttu-id="05d32-196">Os manipuladores de protocolo também podem determinar opcionalmente os filtros corretos a serem usados para extrair informações de um fluxo.</span><span class="sxs-lookup"><span data-stu-id="05d32-196">Protocol handlers can also optionally determine the correct filters to use for extracting information from a stream.</span></span> <span data-ttu-id="05d32-197">Os filtros enumeram as URLs do repositório de dados.</span><span class="sxs-lookup"><span data-stu-id="05d32-197">Filters enumerate the data store URLs.</span></span> <span data-ttu-id="05d32-198">Os itens são então indexados individualmente usando o filtro apropriado e/ou o manipulador de propriedade.</span><span class="sxs-lookup"><span data-stu-id="05d32-198">The items are then individually indexed using the proper filter and/or property handler.</span></span> <span data-ttu-id="05d32-199">Para obter mais informações, consulte [estendendo o índice](-search-3x-wds-extidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="05d32-199">For more information, see [Extending the Index](-search-3x-wds-extidx-overview.md).</span></span>

### <a name="managing-the-indexing-process"></a><span data-ttu-id="05d32-200">Gerenciando o processo de indexação</span><span class="sxs-lookup"><span data-stu-id="05d32-200">Managing the Indexing Process</span></span>

<span data-ttu-id="05d32-201">Os desenvolvedores de aplicativos podem controlar o escopo e a frequência da indexação do Windows Search usando várias interfaces de gerenciamento.</span><span class="sxs-lookup"><span data-stu-id="05d32-201">Application developers can control the scope and frequency of Windows Search indexing by using various management interfaces.</span></span> <span data-ttu-id="05d32-202">Essas interfaces incluem a funcionalidade para adicionar e remover os diretórios que o indexador verifica em busca de alterações, notificar manualmente o índice das alterações nos dados, verificar o status do indexador e forçar a reindexação de alguns ou de todos os dados.</span><span class="sxs-lookup"><span data-stu-id="05d32-202">These interfaces include functionality to add and remove the directories that the indexer scans for changes, manually notify the index of changes to data, check the status of the indexer, and force re-indexing of some or all data.</span></span> <span data-ttu-id="05d32-203">Para obter mais informações, consulte [Gerenciando o índice](-search-3x-wds-mngidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="05d32-203">For more information, see [Managing the Index](-search-3x-wds-mngidx-overview.md).</span></span>

### <a name="integrating-the-windows-property-system-with-windows-search-applications"></a><span data-ttu-id="05d32-204">Integrando o sistema de propriedades do Windows com aplicativos Windows Search</span><span class="sxs-lookup"><span data-stu-id="05d32-204">Integrating the Windows Property System with Windows Search Applications</span></span>

<span data-ttu-id="05d32-205">O sistema de propriedades do Windows é um sistema de leitura/gravação extensível de definições de dados que fornece uma maneira uniforme de expressar os metadados sobre itens de Shell.</span><span class="sxs-lookup"><span data-stu-id="05d32-205">The Windows Property System is an extensible read/write system of data definitions that provides a uniform way of expressing metadata about Shell items.</span></span> <span data-ttu-id="05d32-206">O sistema de propriedades do Windows no Windows Vista e posterior permite que você armazene e recupere metadados para itens de Shell.</span><span class="sxs-lookup"><span data-stu-id="05d32-206">The Windows Property system in Windows Vista and later enables you to store and retrieve metadata for Shell items.</span></span> <span data-ttu-id="05d32-207">Um item de Shell é qualquer conteúdo único, como um arquivo, uma pasta, um email ou um contato.</span><span class="sxs-lookup"><span data-stu-id="05d32-207">A Shell item is any single piece of content, such as a file, folder, email or contact.</span></span> <span data-ttu-id="05d32-208">Uma propriedade é uma parte individual dos metadados associados a um item de Shell.</span><span class="sxs-lookup"><span data-stu-id="05d32-208">A property is an individual piece of metadata associated with a Shell item.</span></span> <span data-ttu-id="05d32-209">Os valores de propriedade são expressos como uma estrutura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="05d32-209">Property values are expressed as a [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="05d32-210">Uma lista extensa de propriedades comuns está incluída para vários tipos de itens comuns, como fotos, música, documentos, mensagens, contatos e arquivos.</span><span class="sxs-lookup"><span data-stu-id="05d32-210">An extensive list of common properties is included for a number of common item types such as photos, music, documents, messages, contacts, and files.</span></span> <span data-ttu-id="05d32-211">Os desenvolvedores também podem introduzir suas próprias propriedades para a plataforma se nenhuma propriedade existente atender às suas necessidades.</span><span class="sxs-lookup"><span data-stu-id="05d32-211">Developers can also introduce their own properties to the platform if no existing property meets their needs.</span></span> <span data-ttu-id="05d32-212">Para obter mais informações sobre como integrar aplicativos com o sistema de propriedades do Windows, consulte [desenvolvendo manipuladores de propriedade](-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="05d32-212">For more information on integrating applications with the Windows property system, see [Developing Property Handlers](-search-3x-wds-extidx-propertyhandlers.md).</span></span>

## <a name="overview-of-handlers"></a><span data-ttu-id="05d32-213">Visão geral dos manipuladores</span><span class="sxs-lookup"><span data-stu-id="05d32-213">Overview of Handlers</span></span>

<span data-ttu-id="05d32-214">Um manipulador é um objeto COM (Component Object Model) que fornece funcionalidade para um item de Shell.</span><span class="sxs-lookup"><span data-stu-id="05d32-214">A handler is a Component Object Model (COM) object that provides functionality for a Shell item.</span></span> <span data-ttu-id="05d32-215">A maioria das fontes de dados de shell oferece um sistema extensível para ligar manipuladores a itens.</span><span class="sxs-lookup"><span data-stu-id="05d32-215">Most Shell data sources offer an extensible system for binding handlers to items.</span></span> <span data-ttu-id="05d32-216">Por exemplo, a pasta sistema de arquivos usa o sistema de associação para pesquisar os manipuladores de um determinado tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="05d32-216">For example, the file system folder uses the association system to look up the handlers for a particular file type.</span></span> <span data-ttu-id="05d32-217">Um manipulador específico é necessário para cada tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="05d32-217">A specific handler is required for every file type.</span></span> <span data-ttu-id="05d32-218">Um manipulador de filtro é necessário para o tipo de arquivo Adobe Acrobat. pdf, por exemplo, outro manipulador de filtro é necessário para o formato de arquivo. doc e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="05d32-218">One filter handler is required for the Adobe Acrobat .pdf file type, for example, another filter handler is required for the .doc file format, and so forth.</span></span>

<span data-ttu-id="05d32-219">Manipuladores diferentes têm alguma semelhança.</span><span class="sxs-lookup"><span data-stu-id="05d32-219">Different handlers have some commonality.</span></span> <span data-ttu-id="05d32-220">No Windows Vista e posterior, todos os manipuladores devem usar uma das seguintes interfaces para inicializar o manipulador: [**IInitializeWithStream**](/windows/win32/api/propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem)ou [**IItinitializeWithFile**](/windows/win32/api/propsys/nn-propsys-iinitializewithfile).</span><span class="sxs-lookup"><span data-stu-id="05d32-220">In Windows Vista and later, all handlers must use one of the following interfaces to initialize the handler: [**IInitializeWithStream**](/windows/win32/api/propsys/nn-propsys-iinitializewithstream), [**IInitializeWithItem**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem), or [**IItinitializeWithFile**](/windows/win32/api/propsys/nn-propsys-iinitializewithfile).</span></span>

<span data-ttu-id="05d32-221">A tabela a seguir lista as tarefas de desenvolvimento de alto nível, o tipo de manipulador necessário para cada tarefa e fornece um link para informações conceituais sobre como executar cada tarefa.</span><span class="sxs-lookup"><span data-stu-id="05d32-221">The following table lists high-level developer tasks, the type of handler needed for each task, and provides a link to conceptual information about how to perform each task.</span></span>



| <span data-ttu-id="05d32-222">Tarefa</span><span class="sxs-lookup"><span data-stu-id="05d32-222">Task</span></span>                                                                                                                                                            | <span data-ttu-id="05d32-223">Manipulador</span><span class="sxs-lookup"><span data-stu-id="05d32-223">Handler</span></span>                          | <span data-ttu-id="05d32-224">Informações conceituais</span><span class="sxs-lookup"><span data-stu-id="05d32-224">Conceptual information</span></span>                                                                                                                                                                                 |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="05d32-225">Acessando as propriedades de um arquivo para indexação</span><span class="sxs-lookup"><span data-stu-id="05d32-225">Accessing the properties of a file for indexing</span></span>                                                                                                                 | <span data-ttu-id="05d32-226">Manipulador de propriedades</span><span class="sxs-lookup"><span data-stu-id="05d32-226">Property handler</span></span>                 | [<span data-ttu-id="05d32-227">Desenvolvendo manipuladores de propriedade</span><span class="sxs-lookup"><span data-stu-id="05d32-227">Developing Property Handlers</span></span>](-search-3x-wds-extidx-propertyhandlers.md)<br/> [<span data-ttu-id="05d32-228">Propriedades definidas pelo sistema para formatos de arquivo personalizados</span><span class="sxs-lookup"><span data-stu-id="05d32-228">System-Defined Properties for Custom File Formats</span></span>](-shell-systemdefinedpropertiesforfileformats.md)<br/> |
| <span data-ttu-id="05d32-229">Adicionar formatos de área de transferência para o objeto de dados ([**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject)) de um item (objetos de dados são usados em cenários de arrastar e soltar e copiar/colar.)</span><span class="sxs-lookup"><span data-stu-id="05d32-229">Adding clipboard formats for the data object ([**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject)) of an item (Data objects are used in drag-and-drop and copy/paste scenarios.)</span></span> | <span data-ttu-id="05d32-230">Manipulador de objeto de dados</span><span class="sxs-lookup"><span data-stu-id="05d32-230">Data object handler</span></span>              | <span data-ttu-id="05d32-231">[Criando manipuladores de dados](/previous-versions/windows/desktop/legacy/cc144163(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="05d32-231">[Creating Data Handlers](/previous-versions/windows/desktop/legacy/cc144163(v=vs.85))</span></span>                                                                                                                                                          |
| <span data-ttu-id="05d32-232">Adicionando verbos para um item que são normalmente exibidos em um menu de atalho</span><span class="sxs-lookup"><span data-stu-id="05d32-232">Adding verbs for an item that are commonly displayed in a shortcut menu</span></span>                                                                                         | <span data-ttu-id="05d32-233">Manipulador de menu de atalho</span><span class="sxs-lookup"><span data-stu-id="05d32-233">Shortcut menu handler</span></span>            | [<span data-ttu-id="05d32-234">Criando manipuladores de menu de contexto</span><span class="sxs-lookup"><span data-stu-id="05d32-234">Creating Context Menu Handlers</span></span>](../shell/context-menu-handlers.md)<br/> [<span data-ttu-id="05d32-235">Personalizando um menu de atalho usando verbos dinâmicos</span><span class="sxs-lookup"><span data-stu-id="05d32-235">Customizing a Shortcut Menu Using Dynamic Verbs</span></span>](../shell/shortcut-menu-using-dynamic-verbs.md)<br/>                         |
| <span data-ttu-id="05d32-236">Associando um tipo de arquivo a um ícone específico</span><span class="sxs-lookup"><span data-stu-id="05d32-236">Associating a file type with a specific icon</span></span>                                                                                                                    | <span data-ttu-id="05d32-237">Manipulador de ícone</span><span class="sxs-lookup"><span data-stu-id="05d32-237">Icon handler</span></span>                     | [<span data-ttu-id="05d32-238">Criando manipuladores de ícones</span><span class="sxs-lookup"><span data-stu-id="05d32-238">Creating Icon Handlers</span></span>](../shell/how-to-create-icon-handlers.md)                                                                                                                                                          |
| <span data-ttu-id="05d32-239">Criando folhas de propriedades com imagens e controles da interface do usuário que permitem a interação personalizada com um tipo de arquivo</span><span class="sxs-lookup"><span data-stu-id="05d32-239">Creating property sheets with UI pictures and controls that permit custom interaction with a file type</span></span>                                                          | <span data-ttu-id="05d32-240">Manipulador de folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="05d32-240">Property sheet handler</span></span>           | <span data-ttu-id="05d32-241">[Manipuladores de folha de propriedades](/previous-versions/windows/desktop/legacy/cc144106(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="05d32-241">[Property Sheet Handlers](/previous-versions/windows/desktop/legacy/cc144106(v=vs.85))</span></span>                                                                                                                                                    |
| <span data-ttu-id="05d32-242">Habilitando um tipo de item para dar suporte a cenários de arrastar e soltar e copiar/colar</span><span class="sxs-lookup"><span data-stu-id="05d32-242">Enabling an item type to support drag-and-drop and copy/paste scenarios</span></span>                                                                                         | <span data-ttu-id="05d32-243">Descartar manipulador</span><span class="sxs-lookup"><span data-stu-id="05d32-243">Drop handler</span></span>                     | <span data-ttu-id="05d32-244">[Transferindo objetos do shell com o recurso de arrastar e soltar e a área de transferência](/previous-versions/windows/desktop/legacy/bb776905(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="05d32-244">[Transferring Shell Objects with Drag-and-Drop and the Clipboard](/previous-versions/windows/desktop/legacy/bb776905(v=vs.85))</span></span>                                                                                                                      |
| <span data-ttu-id="05d32-245">Extraindo partes de propriedades de texto e de documento para indexação</span><span class="sxs-lookup"><span data-stu-id="05d32-245">Extracting chunks of text and document properties for indexing</span></span>                                                                                                  | <span data-ttu-id="05d32-246">Manipulador de filtro</span><span class="sxs-lookup"><span data-stu-id="05d32-246">Filter handler</span></span>                   | [<span data-ttu-id="05d32-247">Desenvolvendo manipuladores de filtro</span><span class="sxs-lookup"><span data-stu-id="05d32-247">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)                                                                                                                                           |
| <span data-ttu-id="05d32-248">Indexando um novo tipo de arquivo</span><span class="sxs-lookup"><span data-stu-id="05d32-248">Indexing a new file type</span></span>                                                                                                                                        | <span data-ttu-id="05d32-249">Manipulador de filtro, manipulador de propriedades</span><span class="sxs-lookup"><span data-stu-id="05d32-249">Filter handler, property handler</span></span> | [<span data-ttu-id="05d32-250">Desenvolvendo manipuladores de filtro</span><span class="sxs-lookup"><span data-stu-id="05d32-250">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)<br/> [<span data-ttu-id="05d32-251">Desenvolvendo manipuladores de propriedade</span><span class="sxs-lookup"><span data-stu-id="05d32-251">Developing Property Handlers</span></span>](-search-3x-wds-extidx-propertyhandlers.md)<br/>                                          |
| <span data-ttu-id="05d32-252">Indexando o conteúdo de um armazenamento de dados</span><span class="sxs-lookup"><span data-stu-id="05d32-252">Indexing the contents of a data store</span></span>                                                                                                                           | <span data-ttu-id="05d32-253">Manipulador de protocolo</span><span class="sxs-lookup"><span data-stu-id="05d32-253">Protocol handler</span></span>                 | [<span data-ttu-id="05d32-254">Desenvolvendo manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="05d32-254">Developing Protocol Handlers</span></span>](-search-3x-wds-phaddins.md)                                                                                                                                            |
| <span data-ttu-id="05d32-255">Visualizando uma exibição simplificada do item de Shell no painel de visualização do Windows Explorer</span><span class="sxs-lookup"><span data-stu-id="05d32-255">Previewing a simplified view of the Shell item in the Windows Explorer preview pane</span></span>                                                                             | <span data-ttu-id="05d32-256">Gerenciador de visualização</span><span class="sxs-lookup"><span data-stu-id="05d32-256">Preview handler</span></span>                  | [<span data-ttu-id="05d32-257">Gerenciadores de visualização</span><span class="sxs-lookup"><span data-stu-id="05d32-257">Preview Handlers</span></span>](../shell/preview-handlers.md)                                                                                                                                                             |
| <span data-ttu-id="05d32-258">Fornecendo texto pop-up quando um mouse passa sobre um objeto de interface do usuário</span><span class="sxs-lookup"><span data-stu-id="05d32-258">Supplying pop-up text when a mouse hovers over a UI object</span></span>                                                                                                      | <span data-ttu-id="05d32-259">Manipulador de infodicas</span><span class="sxs-lookup"><span data-stu-id="05d32-259">Infotip handler</span></span>                  | <span data-ttu-id="05d32-260">[Criando manipuladores de extensão de shell](../shell/handlers.md) (personalização de infotip)</span><span class="sxs-lookup"><span data-stu-id="05d32-260">[Creating Shell Extension Handlers](../shell/handlers.md) (Infotip Customization)</span></span>                                                                                                                            |
| <span data-ttu-id="05d32-261">Fornecendo uma imagem estática para representar um item de Shell</span><span class="sxs-lookup"><span data-stu-id="05d32-261">Supplying a static image to represent a Shell item</span></span>                                                                                                              | <span data-ttu-id="05d32-262">Manipulador de miniaturas</span><span class="sxs-lookup"><span data-stu-id="05d32-262">Thumbnail handler</span></span>                | <span data-ttu-id="05d32-263">[Manipuladores de miniatura](/previous-versions/windows/desktop/legacy/cc144118(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="05d32-263">[Thumbnail Handlers](/previous-versions/windows/desktop/legacy/cc144118(v=vs.85))</span></span>                                                                                                                                                        |



 

<span data-ttu-id="05d32-264">A tabela a seguir lista os manipuladores e as interfaces para implementar cada tipo de manipulador.</span><span class="sxs-lookup"><span data-stu-id="05d32-264">The following table lists handlers and the interfaces for implementing each type of handler.</span></span>



| <span data-ttu-id="05d32-265">Manipulador</span><span class="sxs-lookup"><span data-stu-id="05d32-265">Handler</span></span>                | <span data-ttu-id="05d32-266">Interfaces</span><span class="sxs-lookup"><span data-stu-id="05d32-266">Interfaces</span></span>                                                                                                                                                                                                                                                                                                                                                                |
|------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="05d32-267">Descartar manipulador</span><span class="sxs-lookup"><span data-stu-id="05d32-267">Drop handler</span></span>           | <span data-ttu-id="05d32-268">[**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget), [**IDropTargetHelper**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-idroptargethelper), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span><span class="sxs-lookup"><span data-stu-id="05d32-268">[**IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget), [**IDropTargetHelper**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-idroptargethelper), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span></span>                                                                                                                                                                                                      |
| <span data-ttu-id="05d32-269">Manipulador de objeto de dados</span><span class="sxs-lookup"><span data-stu-id="05d32-269">Data object handler</span></span>    | <span data-ttu-id="05d32-270">[**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), [ **IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span><span class="sxs-lookup"><span data-stu-id="05d32-270">[**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span></span>                                                                                                                                                                                                                                                                                                  |
| <span data-ttu-id="05d32-271">Manipulador de filtro</span><span class="sxs-lookup"><span data-stu-id="05d32-271">Filter handler</span></span>         | [<span data-ttu-id="05d32-272">**Visio**</span><span class="sxs-lookup"><span data-stu-id="05d32-272">**IFilter**</span></span>](/windows/win32/api/filter/nn-filter-ifilter)<br/>                                                                                                                                                                                                                                                                                                                             |
| <span data-ttu-id="05d32-273">Manipulador de ícone</span><span class="sxs-lookup"><span data-stu-id="05d32-273">Icon handler</span></span>           | [<span data-ttu-id="05d32-274">**IExtractIcon**</span><span class="sxs-lookup"><span data-stu-id="05d32-274">**IExtractIcon**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona)<br/> <span data-ttu-id="05d32-275">Opcional: [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span><span class="sxs-lookup"><span data-stu-id="05d32-275">Optional: [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)</span></span><br/>                                                                                                                                                                                                                                 |
| <span data-ttu-id="05d32-276">Manipulador de infodicas</span><span class="sxs-lookup"><span data-stu-id="05d32-276">Infotip handler</span></span>        | [<span data-ttu-id="05d32-277">**IQueryInfo**</span><span class="sxs-lookup"><span data-stu-id="05d32-277">**IQueryInfo**</span></span>](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="05d32-278">Gerenciador de visualização</span><span class="sxs-lookup"><span data-stu-id="05d32-278">Preview handler</span></span>        | [<span data-ttu-id="05d32-279">**IPreviewHandler**</span><span class="sxs-lookup"><span data-stu-id="05d32-279">**IPreviewHandler**</span></span>](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipreviewhandler)                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="05d32-280">Manipulador de propriedades</span><span class="sxs-lookup"><span data-stu-id="05d32-280">Property handler</span></span>       | [<span data-ttu-id="05d32-281">**IPropertyStore**</span><span class="sxs-lookup"><span data-stu-id="05d32-281">**IPropertyStore**</span></span>](/windows/win32/api/propsys/nn-propsys-ipropertystore)                                                                                                                                                                                                                                                                                                                           |
| <span data-ttu-id="05d32-282">Manipulador de protocolo</span><span class="sxs-lookup"><span data-stu-id="05d32-282">Protocol handler</span></span>       | <span data-ttu-id="05d32-283">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter), [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol), [**IUrlAccessor**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor)</span><span class="sxs-lookup"><span data-stu-id="05d32-283">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter), [**ISearchProtocol**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol), [**IUrlAccessor**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor)</span></span><br/> <span data-ttu-id="05d32-284">Opcional: [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2), [**IUrlAccessor2**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor2), [**IUrlAccessor3**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor3), [**IUrlAccessor4**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor4)</span><span class="sxs-lookup"><span data-stu-id="05d32-284">Optional: [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2), [**IUrlAccessor2**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor2), [**IUrlAccessor3**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor3), [**IUrlAccessor4**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor4)</span></span><br/> |
| <span data-ttu-id="05d32-285">Manipulador de folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="05d32-285">Property sheet handler</span></span> | <span data-ttu-id="05d32-286">[**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit), [ **IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext)</span><span class="sxs-lookup"><span data-stu-id="05d32-286">[**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit), [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext)</span></span>                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="05d32-287">Manipulador de menu de atalho</span><span class="sxs-lookup"><span data-stu-id="05d32-287">Shortcut menu handler</span></span>  | <span data-ttu-id="05d32-288">[**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IExplorerCommand**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexplorercommand), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span><span class="sxs-lookup"><span data-stu-id="05d32-288">[**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**IExplorerCommand**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexplorercommand), [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)</span></span>                                                                                                                                                                                                                                          |
| <span data-ttu-id="05d32-289">Manipulador de miniaturas</span><span class="sxs-lookup"><span data-stu-id="05d32-289">Thumbnail handler</span></span>      | [<span data-ttu-id="05d32-290">**Manipuladordeminiaturai**</span><span class="sxs-lookup"><span data-stu-id="05d32-290">**IThumbnailProvider**</span></span>](/windows/win32/api/thumbcache/nn-thumbcache-ithumbnailprovider)                                                                                                                                                                                                                                                                                                                        |



 

> [!Note]  
> <span data-ttu-id="05d32-291">Um manipulador de propriedades, às vezes, é kown como um manipulador de metadados.</span><span class="sxs-lookup"><span data-stu-id="05d32-291">A property handler is sometimes kown as a metadata handler.</span></span> <span data-ttu-id="05d32-292">Algumas vezes, uma fonte de dados do Shell é conhecida como extensão de namespace do Shell.</span><span class="sxs-lookup"><span data-stu-id="05d32-292">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="05d32-293">Um manipulador de tipo de arquivo é, às vezes, conhecido como um manipulador de extensão de shell ou uma extensão de Shell.</span><span class="sxs-lookup"><span data-stu-id="05d32-293">A file type handler is sometimes known as a Shell extension handler or a Shell extension.</span></span>

 

<span data-ttu-id="05d32-294">Para obter mais informações sobre como criar manipuladores, consulte [criando manipuladores de extensão de shell](../shell/handlers.md).</span><span class="sxs-lookup"><span data-stu-id="05d32-294">For more information about creating handlers, see [Creating Shell Extension Handlers](../shell/handlers.md).</span></span> <span data-ttu-id="05d32-295">Para obter mais informações sobre propriedades, consulte [sistema de propriedades do Windows](../properties/windows-properties-system.md).</span><span class="sxs-lookup"><span data-stu-id="05d32-295">For more information about properties, see [Windows Property System](../properties/windows-properties-system.md).</span></span>

## <a name="add-in-installer-guidelines"></a><span data-ttu-id="05d32-296">Diretrizes do instalador do suplemento</span><span class="sxs-lookup"><span data-stu-id="05d32-296">Add-in Installer Guidelines</span></span>

<span data-ttu-id="05d32-297">Use as seguintes diretrizes ao criar um instalador de suplemento:</span><span class="sxs-lookup"><span data-stu-id="05d32-297">Use the following guidelines when creating an Add-in installer:</span></span>

-   <span data-ttu-id="05d32-298">O instalador deve usar o instalador EXE ou MSI.</span><span class="sxs-lookup"><span data-stu-id="05d32-298">The installer must use either the EXE or MSI installer.</span></span>
-   <span data-ttu-id="05d32-299">As notas de versão devem ser fornecidas.</span><span class="sxs-lookup"><span data-stu-id="05d32-299">Release notes must be provided.</span></span>
-   <span data-ttu-id="05d32-300">Uma entrada **Adicionar/remover programas** deve ser criada para cada suplemento instalado.</span><span class="sxs-lookup"><span data-stu-id="05d32-300">An **Add/Remove Programs** entry must be created for each add-in installed.</span></span>
-   <span data-ttu-id="05d32-301">O instalador deve assumir todas as configurações do registro para o tipo de arquivo específico ou o armazenamento que o suplemento atual compreende.</span><span class="sxs-lookup"><span data-stu-id="05d32-301">The installer must take over all registry settings for the particular file type or store that the current add-in understands.</span></span>
-   <span data-ttu-id="05d32-302">Se um suplemento anterior estiver sendo substituído, o instalador deverá notificar o usuário.</span><span class="sxs-lookup"><span data-stu-id="05d32-302">If a previous add-in is being overwritten, the installer should notify the user.</span></span>
-   <span data-ttu-id="05d32-303">Se um suplemento mais recente tiver substituído um suplemento anterior, o usuário deverá ser capaz de restaurar a funcionalidade do suplemento anterior e torná-lo o suplemento padrão novamente para esse tipo de arquivo ou repositório.</span><span class="sxs-lookup"><span data-stu-id="05d32-303">If a newer add-in has overwritten a previous add-in, the user should be able to restore the previous add-in's functionality and make it the default add-in again for that file type or store.</span></span>

## <a name="note-to-implementers"></a><span data-ttu-id="05d32-304">Observação para implementadores</span><span class="sxs-lookup"><span data-stu-id="05d32-304">Note to Implementers</span></span>

<span data-ttu-id="05d32-305">Antes de criar um filtro ou manipulador de propriedades, os desenvolvedores devem considerar o seguinte:</span><span class="sxs-lookup"><span data-stu-id="05d32-305">Before creating a filter or property handler, developers should consider the following:</span></span>

-   <span data-ttu-id="05d32-306">Esses manipuladores são extensões em processo que são carregadas em processos que você não controla, como o processo de daemon de filtro, o Windows Explorer (pesquisa com grep) e hosts de terceiros como o Windows Mail.</span><span class="sxs-lookup"><span data-stu-id="05d32-306">These handlers are in-process extensions that are loaded into processes that you do not control, such as the filter daemon process, Windows Explorer (grep search), and third-party hosts like Windows Mail).</span></span>
-   <span data-ttu-id="05d32-307">Você deve escrever um código seguro que seja robusto o suficiente para manipular formulários corrompidos arbitrariamente do formato de arquivo que foram criados para atacar o sistema.</span><span class="sxs-lookup"><span data-stu-id="05d32-307">You must write secure code that is robust enough to handle arbitrarily corrupt forms of your file format that were created to attack the system.</span></span>
-   <span data-ttu-id="05d32-308">Seu suplemento não deve vazar recursos que produzirão problemas para os processos de host.</span><span class="sxs-lookup"><span data-stu-id="05d32-308">Your add-in must not leak resources that will produce problems for the host processes.</span></span>
-   <span data-ttu-id="05d32-309">Seu suplemento não deve falhar, pois isso também causará uma falha nos processos de host e tornará o processo de filtragem lento.</span><span class="sxs-lookup"><span data-stu-id="05d32-309">Your add-in must not crash as this will also crash the host processes and slow down the filtering process.</span></span>
-   <span data-ttu-id="05d32-310">Como esses manipuladores são executados em um processo do sistema em segundo plano, eles devem executar rapidamente com um mínimo de CPU e e/s consumidos para atender aos requisitos de desempenho do sistema.</span><span class="sxs-lookup"><span data-stu-id="05d32-310">Because these handlers are run in a background system process, they must perform quickly with a minimum of CPU and I/O consumed in order to meet the performance requirements of the system.</span></span>

<span data-ttu-id="05d32-311">Portanto, esses suplementos devem ser escritos por desenvolvedores com experiência na criação de código de nível de sistema.</span><span class="sxs-lookup"><span data-stu-id="05d32-311">Thus, these add-ins should be written by developers with expertise in creating system-level code.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="05d32-312">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="05d32-312">Additional Resources</span></span>

-   <span data-ttu-id="05d32-313">Para obter informações sobre como criar uma fonte de dados do Shell, consulte [implementando as interfaces de objeto de pasta básica](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="05d32-313">For information about creating a Shell data source, see [Implementing the Basic Folder Object Interfaces](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).</span></span>
-   <span data-ttu-id="05d32-314">Para fontes de dados que precisam usar o objeto de exibição de pasta do sistema padrão do Shell (DefView), consulte [implementando uma exibição de pasta](../lwef/nse-folderview.md), função [**SHCreateShellFolderView**](/windows/win32/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview) e [**SFV \_ criar**](/windows/win32/api/shlobj_core/ns-shlobj_core-sfv_create) estrutura.</span><span class="sxs-lookup"><span data-stu-id="05d32-314">For data sources that need to use the Shell Default System Folder View Object (DefView), see [Implementing a Folder View](../lwef/nse-folderview.md), [**SHCreateShellFolderView**](/windows/win32/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview) function, and [**SFV\_CREATE**](/windows/win32/api/shlobj_core/ns-shlobj_core-sfv_create) structure.</span></span> <span data-ttu-id="05d32-315">As fontes de dados que usam o objeto de exibição de pasta do sistema padrão do Shell (DefView) devem implementar o seguinte conjunto de interfaces: [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), [**IShellFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder2), [**IPersistFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder), [**IPersistFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2)e (opcionalmente) [**IPersistFolder3**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span><span class="sxs-lookup"><span data-stu-id="05d32-315">Data sources that use the Shell Default System Folder View Object (DefView) must implement the following set of interfaces: [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), [**IShellFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder2), [**IPersistFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder), [**IPersistFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2), and (optionally) [**IPersistFolder3**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3).</span></span> <span data-ttu-id="05d32-316">Se a implementação do **IShellFolder** não usar o **SHCreateShellFolderView** para criar o DefView, o objeto de exibição do Shell poderá precisar de [**IFolderView**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifolderview).</span><span class="sxs-lookup"><span data-stu-id="05d32-316">If your **IShellFolder** implementation does not use **SHCreateShellFolderView** to create the DefView, the Shell view object may need [**IFolderView**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifolderview).</span></span>
-   <span data-ttu-id="05d32-317">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) é a interface primária para os consumidores da fonte de dados do Shell conhecida como DBFolder.</span><span class="sxs-lookup"><span data-stu-id="05d32-317">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) is the primary interface for consumers of the Shell data source known as DBFolder.</span></span> <span data-ttu-id="05d32-318">Para obter mais informações sobre DBFolder, consulte a descrição da constante de análise de STR \_ \_ com \_ Propriedades em [**chaves de cadeia de caracteres de contexto de associação**](../shell/str-constants.md).</span><span class="sxs-lookup"><span data-stu-id="05d32-318">For more information about DBFolder, see the description of the STR\_PARSE\_WITH\_PROPERTIES constant in [**Bind Context String Keys**](../shell/str-constants.md).</span></span> <span data-ttu-id="05d32-319">Consulte também [matrizes de associação](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) e [**IPropertySystem:: GetPropertyDescriptionListFromString**](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring).</span><span class="sxs-lookup"><span data-stu-id="05d32-319">See also [Association Arrays](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) and [**IPropertySystem::GetPropertyDescriptionListFromString**](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring).</span></span>
-   <span data-ttu-id="05d32-320">Para obter informações sobre OLE DB, consulte [visão geral da programação de OLE DB](https://msdn.microsoft.com/library/5d8sd9we(VS.71).aspx).</span><span class="sxs-lookup"><span data-stu-id="05d32-320">For information on OLE DB, see [OLE DB Programming Overview](https://msdn.microsoft.com/library/5d8sd9we(VS.71).aspx).</span></span> <span data-ttu-id="05d32-321">Para obter informações sobre o Provedor de Dados de .NET Framework para OLE DB, consulte a documentação do [namespace System. Data. OleDb](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1) .</span><span class="sxs-lookup"><span data-stu-id="05d32-321">For information on the .NET Framework Data Provider for OLE DB, see the [System.Data.OleDb Namespace](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1) documentation.</span></span>
-   <span data-ttu-id="05d32-322">Para placas de mensagens com suporte da Comunidade em tecnologias de pesquisa, consulte [Windows: fóruns de pesquisa](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads) no msdn.</span><span class="sxs-lookup"><span data-stu-id="05d32-322">For community-supported message boards on Search technologies, see [Windows: Search Forums](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads) on MSDN.</span></span>
-   <span data-ttu-id="05d32-323">Para obter exemplos de código relacionados, consulte [exemplos de código do Windows Search](-search-samples-ovw.md).</span><span class="sxs-lookup"><span data-stu-id="05d32-323">For related code samples, see [Windows Search Code Samples](-search-samples-ovw.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="05d32-324">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="05d32-324">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="05d32-325">Visão geral do Windows Search</span><span class="sxs-lookup"><span data-stu-id="05d32-325">Windows Search Overview</span></span>](-search-3x-wds-overview.md)
</dt> <dt>

[<span data-ttu-id="05d32-326">Idiomas com suporte do Windows Search</span><span class="sxs-lookup"><span data-stu-id="05d32-326">Languages Supported by Windows Search</span></span>](-search-3x-wds-language-support.md)
</dt> <dt>

[<span data-ttu-id="05d32-327">Usar código gerenciado com os dados do Shell e do Windows Search</span><span class="sxs-lookup"><span data-stu-id="05d32-327">Using Managed Code with Shell Data and Windows Search</span></span>](-search-3x-wds-managed-code.md)
</dt> <dt>

[<span data-ttu-id="05d32-328">Guia do desenvolvedor do Windows Search</span><span class="sxs-lookup"><span data-stu-id="05d32-328">Windows Search Developer's Guide</span></span>](-search-developers-guide-entry-page.md)
</dt> </dl>

 

 
