---
description: Alguns aplicativos armazenam seus itens em bancos de dados ou tipos de arquivo personalizados.
ms.assetid: 0e2b7b4b-ae87-4092-b924-6191cdf42c9b
title: Noções básicas sobre manipuladores de protocolo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 28c171c5790e47bbf624d9107a5ca5b3dc0b9fd4
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105760597"
---
# <a name="understanding-protocol-handlers"></a><span data-ttu-id="1a05c-103">Noções básicas sobre manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="1a05c-103">Understanding Protocol Handlers</span></span>

<span data-ttu-id="1a05c-104">Alguns aplicativos armazenam seus itens em bancos de dados ou tipos de arquivo personalizados.</span><span class="sxs-lookup"><span data-stu-id="1a05c-104">Some applications store their items in databases or custom file types.</span></span> <span data-ttu-id="1a05c-105">Embora o Windows Search possa indexar o nome e as propriedades do arquivo, o Windows não tem conhecimento do conteúdo do arquivo.</span><span class="sxs-lookup"><span data-stu-id="1a05c-105">While Windows Search can index the name and properties of the file, Windows has no knowledge of the content of the file.</span></span> <span data-ttu-id="1a05c-106">Como resultado, esses itens não podem ser indexados ou expostos no Shell do Windows.</span><span class="sxs-lookup"><span data-stu-id="1a05c-106">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="1a05c-107">Ao criar um manipulador de protocolo, você pode tornar esses itens disponíveis para indexação.</span><span class="sxs-lookup"><span data-stu-id="1a05c-107">By creating a protocol handler you can make these items available for indexing.</span></span> <span data-ttu-id="1a05c-108">Você também pode indexar um formato de arquivo composto, como um arquivo. zip.</span><span class="sxs-lookup"><span data-stu-id="1a05c-108">You can also index a compound file format such as a .zip file.</span></span>

<span data-ttu-id="1a05c-109">Este tópico é organizado da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="1a05c-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="1a05c-110">Indexando armazenamentos de dados com manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="1a05c-110">Indexing Data Stores with Protocol Handlers</span></span>](#indexing-data-stores-with-protocol-handlers)
    -   [<span data-ttu-id="1a05c-111">Armazenamentos de dados do Shell</span><span class="sxs-lookup"><span data-stu-id="1a05c-111">Shell Data Stores</span></span>](#shell-data-stores)
    -   [<span data-ttu-id="1a05c-112">Manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="1a05c-112">Protocol Handlers</span></span>](#protocol-handlers)
    -   [<span data-ttu-id="1a05c-113">Filtros e manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="1a05c-113">Filters and Protocol Handlers</span></span>](#filters-and-protocol-handlers)
-   [<span data-ttu-id="1a05c-114">Indexando um formato de arquivo composto</span><span class="sxs-lookup"><span data-stu-id="1a05c-114">Indexing a Compound File Format</span></span>](#indexing-a-compound-file-format)
-   [<span data-ttu-id="1a05c-115">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="1a05c-115">Related topics</span></span>](#related-topics)

## <a name="indexing-data-stores-with-protocol-handlers"></a><span data-ttu-id="1a05c-116">Indexando armazenamentos de dados com manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="1a05c-116">Indexing Data Stores with Protocol Handlers</span></span>

<span data-ttu-id="1a05c-117">Quando os usuários precisam Pesquisar bancos de dados herdados, armazenamentos de email ou outras estruturas que não têm suporte do Windows Search, primeiro você deve determinar se um manipulador de protocolo já existe para esse armazenamento de dados, talvez para uso com outro aplicativo, como o SharePoint Server.</span><span class="sxs-lookup"><span data-stu-id="1a05c-117">When users need to search legacy databases, email stores or other data structures that are not supported by Windows Search, you should first determine whether a protocol handler already exists for that data store, perhaps for use with another application such as SharePoint Server.</span></span> <span data-ttu-id="1a05c-118">Nesse caso, você pode instalar esse manipulador de protocolo no sistema.</span><span class="sxs-lookup"><span data-stu-id="1a05c-118">If so, you can install that protocol handler on the system.</span></span> <span data-ttu-id="1a05c-119">Os manipuladores de protocolo de pesquisa do Windows usam especificações de design semelhantes ao SharePoint Server e, em geral, podem ser usados de maneira intercambiável.</span><span class="sxs-lookup"><span data-stu-id="1a05c-119">Windows Search protocol handlers use design specifications similar to SharePoint Server, and they can often be used interchangeably.</span></span>

<span data-ttu-id="1a05c-120">Para obter mais informações sobre a implantação do Search Server 2008 com o Office SharePoint Server 2007, consulte [servidor de pesquisa de pesquisa federada \[ 2008 \] ](/previous-versions/office/bb931109(v=office.14)).</span><span class="sxs-lookup"><span data-stu-id="1a05c-120">For more information about Search Server 2008 deployment with Office SharePoint Server 2007, see [Federated Search \[Search Server 2008\]](/previous-versions/office/bb931109(v=office.14)).</span></span>

### <a name="shell-data-stores"></a><span data-ttu-id="1a05c-121">Armazenamentos de dados do Shell</span><span class="sxs-lookup"><span data-stu-id="1a05c-121">Shell Data Stores</span></span>

<span data-ttu-id="1a05c-122">Antes que um desenvolvedor de terceiros de novos formatos de arquivo e armazenamentos de dados possa obter esses formatos e lojas para que apareçam nos resultados da consulta no Windows Explorer, o desenvolvedor deve implementar uma fonte de dados do Shell.</span><span class="sxs-lookup"><span data-stu-id="1a05c-122">Before a third-party developer of new file formats and data stores can get those formats and stores to appear in query results in Windows Explorer, the developer must implement a Shell data source.</span></span> <span data-ttu-id="1a05c-123">Uma fonte de dados do Shell é um componente que é usado para estender o namespace do Shell e expor itens em um armazenamento de dados.</span><span class="sxs-lookup"><span data-stu-id="1a05c-123">A Shell data source is a component that is used to extend the Shell namespace and expose items in a data store.</span></span> <span data-ttu-id="1a05c-124">Um repositório de dados é um repositório de dados.</span><span class="sxs-lookup"><span data-stu-id="1a05c-124">A data store is a repository of data.</span></span> <span data-ttu-id="1a05c-125">Um armazenamento de dados pode ser exposto ao modelo de programação do shell como um contêiner que usa uma fonte de dados do Shell.</span><span class="sxs-lookup"><span data-stu-id="1a05c-125">A data store can be exposed to the Shell programming model as a container that uses a Shell data source.</span></span> <span data-ttu-id="1a05c-126">Os itens em um armazenamento de dados podem ser indexados pelo sistema de pesquisa do Windows usando um manipulador de protocolo.</span><span class="sxs-lookup"><span data-stu-id="1a05c-126">The items in a data store can be indexed by the Windows Search system using a protocol handler.</span></span> <span data-ttu-id="1a05c-127">O manipulador de protocolo implementa o protocolo para acessar uma fonte de conteúdo em seu formato nativo.</span><span class="sxs-lookup"><span data-stu-id="1a05c-127">The protocol handler implements the protocol for accessing a content source in its native format.</span></span> <span data-ttu-id="1a05c-128">As interfaces [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) e [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2) são usadas para implementar um manipulador de protocolo personalizado para expandir as fontes de dados que podem ser indexadas.</span><span class="sxs-lookup"><span data-stu-id="1a05c-128">The [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) and [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2) interfaces are used to implement a custom protocol handler to expand the data sources that can be indexed.</span></span>

<span data-ttu-id="1a05c-129">Se desejar que os resultados da consulta apareçam no Windows Explorer, você deverá implementar uma fonte de dados do Shell antes de poder criar um manipulador de protocolo para estender o índice.</span><span class="sxs-lookup"><span data-stu-id="1a05c-129">If you want the query results to appear in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="1a05c-130">No entanto, se todas as consultas forem programáticas (por meio de OLE DB, por exemplo) e interpretadas pelo código do aplicativo em vez do Shell, um namespace de Shell, embora ainda preferido, não é estritamente necessário.</span><span class="sxs-lookup"><span data-stu-id="1a05c-130">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application's code rather than the Shell, a Shell namespace while still preferred is not strictly required.</span></span>

> [!Note]  
> <span data-ttu-id="1a05c-131">Algumas vezes, uma fonte de dados do Shell é conhecida como extensão de namespace do Shell.</span><span class="sxs-lookup"><span data-stu-id="1a05c-131">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="1a05c-132">Um manipulador é, às vezes, conhecido como uma extensão de shell ou um manipulador de extensão de Shell.</span><span class="sxs-lookup"><span data-stu-id="1a05c-132">A handler is sometimes known as a Shell extension or a Shell extension handler.</span></span>

 

<span data-ttu-id="1a05c-133">Se desejar que os usuários exibam seus resultados de pesquisa no Windows Explorer, você deverá criar um manipulador de protocolo e um ou mais dos seguintes suplementos:</span><span class="sxs-lookup"><span data-stu-id="1a05c-133">If you want users to view their search results from within Windows Explorer, then you must create a protocol handler and one or more of the following add-ins:</span></span>

-   <span data-ttu-id="1a05c-134">Manipulador de menu de atalho</span><span class="sxs-lookup"><span data-stu-id="1a05c-134">Shortcut menu handler</span></span>
-   <span data-ttu-id="1a05c-135">Manipulador de ícone</span><span class="sxs-lookup"><span data-stu-id="1a05c-135">Icon handler</span></span>
-   <span data-ttu-id="1a05c-136">Algum outro tipo de manipulador de arquivo</span><span class="sxs-lookup"><span data-stu-id="1a05c-136">Some other type of file handler</span></span>

<span data-ttu-id="1a05c-137">Para obter uma lista de manipuladores identificados pelo cenário de desenvolvedor que você está tentando obter, consulte "visão geral de manipuladores" no [Windows Search como uma plataforma de desenvolvimento](-search-3x-wds-development-ovr.md).</span><span class="sxs-lookup"><span data-stu-id="1a05c-137">For a list of handlers identified by the developer scenario you are trying to achieve, see "Overview of Handlers" in [Windows Search as a Development Platform](-search-3x-wds-development-ovr.md).</span></span> <span data-ttu-id="1a05c-138">Para obter informações sobre como criar manipuladores, consulte [registrando extensões de shell](../shell/reg-shell-exts.md), [menu de contexto](/previous-versions/windows/desktop/legacy/cc144169(v=vs.85))e [manipuladores de tipo de arquivo](../shell/fa-file-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="1a05c-138">For information on creating handlers, see [Registering Shell Extensions](../shell/reg-shell-exts.md), [Context Menu](/previous-versions/windows/desktop/legacy/cc144169(v=vs.85)), and [File Type Handlers](../shell/fa-file-extensions.md).</span></span>

### <a name="protocol-handlers"></a><span data-ttu-id="1a05c-139">Manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="1a05c-139">Protocol Handlers</span></span>

<span data-ttu-id="1a05c-140">Se o repositório de dados também for um contêiner (como uma pasta do sistema de arquivos), você deverá implementar um filtro para enumerar as URLs no contêiner.</span><span class="sxs-lookup"><span data-stu-id="1a05c-140">If the data store is also a container (such as a file system folder), you must implement a filter to enumerate the URLs in the container.</span></span> <span data-ttu-id="1a05c-141">Se o repositório de dados contiver dados ou tipos de arquivos diferentes de um dos tipos de arquivo 200 com suporte do Windows Search, você deverá implementar um filtro para acessar e indexar o conteúdo dos itens no repositório.</span><span class="sxs-lookup"><span data-stu-id="1a05c-141">If the data store contains data or file types other than one of the 200 file types supported by Windows Search, you must implement a filter to access and index the contents of items in the store.</span></span> <span data-ttu-id="1a05c-142">O Windows Search usa o manipulador de protocolo e a tecnologia [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) semelhante àquela usada pelo SharePoint Server.</span><span class="sxs-lookup"><span data-stu-id="1a05c-142">Windows Search uses protocol handler and [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) technology similar to that used by SharePoint Server.</span></span> <span data-ttu-id="1a05c-143">Se você já tiver filtros para um armazenamento específico e um tipo de arquivo instalado no sistema que está sendo indexado, o Windows Search poderá usar as interfaces existentes para indexar esses dados.</span><span class="sxs-lookup"><span data-stu-id="1a05c-143">If you already have filters for a specific store and file type installed on the system being indexed, Windows Search may be able to use the existing interfaces to index this data.</span></span>

<span data-ttu-id="1a05c-144">Para obter uma visão geral do processo de indexação, consulte [o processo de indexação](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="1a05c-144">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span> <span data-ttu-id="1a05c-145">Para obter informações conceituais sobre manipuladores de filtro, consulte [desenvolvendo manipuladores de filtro](-search-ifilter-conceptual.md).</span><span class="sxs-lookup"><span data-stu-id="1a05c-145">For conceptual information on filter handlers, see [Developing Filter Handlers](-search-ifilter-conceptual.md).</span></span>

### <a name="filters-and-protocol-handlers"></a><span data-ttu-id="1a05c-146">Filtros e manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="1a05c-146">Filters and Protocol Handlers</span></span>

<span data-ttu-id="1a05c-147">Os manipuladores de protocolo fornecem ao indexador de pesquisa do Windows acesso a armazenamentos de dados, permitindo que o indexador rastreie os nós de um armazenamento de dados e extraia informações relevantes para indexá-los.</span><span class="sxs-lookup"><span data-stu-id="1a05c-147">Protocol handlers give the Windows Search indexer access to data stores, enabling the indexer to crawl the nodes of a data store and extract relevant information to index.</span></span> <span data-ttu-id="1a05c-148">O Windows Search, por exemplo, é fornecido com manipuladores de protocolo para armazenamentos do sistema de arquivos e para algumas versões de armazenamentos de dados do Microsoft Outlook.</span><span class="sxs-lookup"><span data-stu-id="1a05c-148">Windows Search, for example, ships with protocol handlers for file system stores and for some versions of both Microsoft Outlook data stores.</span></span> <span data-ttu-id="1a05c-149">Ao indexar email do Outlook, o manipulador de protocolo rastreia todas as mensagens em um conjunto de pastas do Outlook e extrai informações de cada mensagem e anexo.</span><span class="sxs-lookup"><span data-stu-id="1a05c-149">When indexing Outlook email, the protocol handler crawls all messages in a set of Outlook folders and extracts information from each message and attachment.</span></span> <span data-ttu-id="1a05c-150">Essas informações são passadas para o indexador para inclusão no catálogo do Windows Search.</span><span class="sxs-lookup"><span data-stu-id="1a05c-150">This information is passed to the indexer for inclusion in the Windows Search catalog.</span></span>

<span data-ttu-id="1a05c-151">Para obter visões gerais do Gerenciador de catálogos e do Gerenciador de escopo de rastreamento (CSM), consulte [usando o Gerenciador de catálogo](-search-3x-wds-mngidx-catalog-manager.md) e [usando o Gerenciador de escopo de rastreamento](-search-3x-wds-extidx-csm.md).</span><span class="sxs-lookup"><span data-stu-id="1a05c-151">For overviews of the Catalog Manager and Crawl Scope Manager (CSM), see [Using the Catalog Manager](-search-3x-wds-mngidx-catalog-manager.md) and [Using the Crawl Scope Manager](-search-3x-wds-extidx-csm.md).</span></span>

## <a name="indexing-a-compound-file-format"></a><span data-ttu-id="1a05c-152">Indexando um formato de arquivo composto</span><span class="sxs-lookup"><span data-stu-id="1a05c-152">Indexing a Compound File Format</span></span>

<span data-ttu-id="1a05c-153">Um formato de arquivo composto pode ser indexado para que itens individuais no arquivo possam ser retornados como resultados individuais.</span><span class="sxs-lookup"><span data-stu-id="1a05c-153">A compound file format can be indexed so that individual items in the file can can be returned as individual results.</span></span> <span data-ttu-id="1a05c-154">Um formato de arquivo composto, como um arquivo compactado com uma extensão de nome de arquivo. zip, é essencialmente um armazenamento de dados e pode ser tratado como tal para fins de indexação.</span><span class="sxs-lookup"><span data-stu-id="1a05c-154">A compound file format such as a compressed file with a .zip file name extension is essentially a data store and can be treated as such for indexing purposes.</span></span> <span data-ttu-id="1a05c-155">O exemplo a seguir exibe um arquivo. zip no namespace do sistema de arquivos (FILE://c:/test/test.zip) em que há ambas as subpastas e itens individuais.</span><span class="sxs-lookup"><span data-stu-id="1a05c-155">The following example displays a .zip file in the file system namespace (FILE://c:/test/test.zip) in which there are both subfolders and individual items.</span></span>

``` syntax
Test.zip 

    |-folder1 

    |    |-folder2 

    |           |- FileX.txt 

    |- FileY.doc
```

<span data-ttu-id="1a05c-156">O manipulador de protocolo de arquivo descobre quando o FILE://c:/test/test.zip alterações monitorando logs de alteração do sistema de arquivos e invocará um [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) registrado para arquivos. zip nesse arquivo quando o arquivo for alterado, mas não tiver conhecimento da estrutura interna do próprio arquivo. zip.</span><span class="sxs-lookup"><span data-stu-id="1a05c-156">The FILE protocol handler discovers when FILE://c:/test/test.zip changes by monitoring file system change logs, and it will invoke an [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) registered for .zip files on that file when the file changes, but it has no knowledge of the internal structure of the .zip file itself.</span></span>

<span data-ttu-id="1a05c-157">Você deve informar ao indexador que o formato de arquivo composto é um armazenamento de dados.</span><span class="sxs-lookup"><span data-stu-id="1a05c-157">You must inform the indexer that the compound file format is a data store.</span></span> <span data-ttu-id="1a05c-158">É necessário fazer isso para que itens individuais sejam indexados e recuperados como entidades exclusivas.</span><span class="sxs-lookup"><span data-stu-id="1a05c-158">It is necessary to do so for individual items to be indexed and retrieved as unique entities.</span></span> <span data-ttu-id="1a05c-159">Depois de implementar uma fonte de dados do Shell e executar as etapas a seguir, você terá um manipulador de protocolo que pode processar e expor os dados de um formato de arquivo composto (um arquivo. zip) como itens individuais.</span><span class="sxs-lookup"><span data-stu-id="1a05c-159">After you have implemented a Shell data source and performed the following steps, you will have a protocol handler that can process and expose the data from a compound file format (a .zip file) as individual items.</span></span>

<span data-ttu-id="1a05c-160">**Para informar ao indexador que um arquivo composto é um armazenamento de dados:**</span><span class="sxs-lookup"><span data-stu-id="1a05c-160">**To inform the indexer that a compound file is a data store:**</span></span>

1.  <span data-ttu-id="1a05c-161">Crie um manipulador de protocolo (usando [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) ou [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2)) para arquivos. zip que tem a capacidade de associar ao arquivo de origem.</span><span class="sxs-lookup"><span data-stu-id="1a05c-161">Create a protocol handler (using [**ISearchProtocol**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol) or [**ISearchProtocol2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchprotocol2)) for .zip files that has the ability bind to the source file.</span></span> <span data-ttu-id="1a05c-162">Para obter mais informações, consulte [Instalando e Registrando manipuladores de protocolo](-search-3x-wds-ph-install-registration.md).</span><span class="sxs-lookup"><span data-stu-id="1a05c-162">For more information, see [Installing and Registering Protocol Handlers](-search-3x-wds-ph-install-registration.md).</span></span>

    <span data-ttu-id="1a05c-163">Por exemplo, você pode usar um caminho de escape para o arquivo. zip como o nome da pasta raiz e, em seguida, usar uma sintaxe de hierarquia como qualquer outro formato de arquivo.</span><span class="sxs-lookup"><span data-stu-id="1a05c-163">For example, you could use an escaped path to the .zip file as the root folder name and then use a hierarchy syntax like any other file format.</span></span>

    ``` syntax
    .zip:///escapedPathTo.zipFile/.zipfolder/.../.zipfile
    ```

    <span data-ttu-id="1a05c-164">Usando os dados de exemplo acima para c: \\ test \\test.zip, as URLs exclusivas seriam as seguintes.</span><span class="sxs-lookup"><span data-stu-id="1a05c-164">Using the above sample data for c:\\test\\test.zip, the unique URLs would be as follows.</span></span> <span data-ttu-id="1a05c-165">Com essas URLs, o manipulador de protocolo tem as informações necessárias para associar ao arquivo. zip e enumerar as URLs filho, incluindo os arquivos internos, para que eles possam ser vinculados e indexados pelos filtros. doc e. txt.</span><span class="sxs-lookup"><span data-stu-id="1a05c-165">With these URLs the protocol handler has the information necessary to bind to the .zip file and enumerate the child URLs including the inner files so that they can be bound to and indexed by the .doc and .txt filters.</span></span>

    ``` syntax
      

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/ 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/FileY.Doc 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/folder1 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/folder1/folder2 

    .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/folder1/folder2/FileX.txt
    ```

2.  <span data-ttu-id="1a05c-166">Verifique se o manipulador de protocolo atende às duas condições a seguir:</span><span class="sxs-lookup"><span data-stu-id="1a05c-166">Ensure that your protocol handler meets the following two conditions:</span></span>
    -   <span data-ttu-id="1a05c-167">As URLs raiz de um arquivo. zip devem emitir PKEY \_ Search \_ IsClosedDirectory ([System. Search. IsClosedDirectory](../properties/props-system-search-iscloseddirectory.md)) nas URLs que são as URLs de arquivo. zip raiz.</span><span class="sxs-lookup"><span data-stu-id="1a05c-167">The root URLs for a .zip file should emit PKEY\_Search\_IsClosedDirectory ([System.Search.IsClosedDirectory](../properties/props-system-search-iscloseddirectory.md)) on the URLs that are the root .zip file URLs.</span></span> <span data-ttu-id="1a05c-168">Por exemplo,. zip:///FILE:%2f%2f%2fc:%2ftest% 2ftest.zip/deve emitir IsClosedDirectory = **true**.</span><span class="sxs-lookup"><span data-stu-id="1a05c-168">For example, .zip:///FILE:%2f%2f%2fc:%2ftest%2ftest.zip/ should emit IsClosedDirectory = **TRUE**.</span></span> <span data-ttu-id="1a05c-169">Isso informa ao indexador que se a data nessa URL não tiver sido alterada, ela não precisa processar nenhuma das URLs filho.</span><span class="sxs-lookup"><span data-stu-id="1a05c-169">This tells the indexer that if the date on this URL has not changed, it does not need to process any of the child URLs.</span></span>
    -   <span data-ttu-id="1a05c-170">Cada URL filho para essa URL deve emitir PKEY \_ Search \_ IsFullyContained ([System. Search. IsFullyContained](../properties/props-system-search-isfullycontained.md)) nas URLs filho da URL. zip raiz.</span><span class="sxs-lookup"><span data-stu-id="1a05c-170">Every child URL for that URL should emit PKEY\_Search\_IsFullyContained ([System.Search.IsFullyContained](../properties/props-system-search-isfullycontained.md)) on the child URLs of the root .zip URL.</span></span> <span data-ttu-id="1a05c-171">Normalmente, no final de um rastreamento incremental, o indexador trata todas as URLs não visitadas como itens que devem ser excluídos.</span><span class="sxs-lookup"><span data-stu-id="1a05c-171">Normally at the end of an incremental crawl, the indexer treats all unvisited URLs as items that should be deleted.</span></span> <span data-ttu-id="1a05c-172">Mas o arquivo root. zip não deve processar URLs raiz porque nada foi alterado.</span><span class="sxs-lookup"><span data-stu-id="1a05c-172">But the root .zip file should not process root URLs because nothing has changed.</span></span> <span data-ttu-id="1a05c-173">A emissão dessa propriedade como **verdadeira** informa ao indexador que, se essa URL não tiver sido processada no final de um rastreamento incremental, ela não deverá ser excluída.</span><span class="sxs-lookup"><span data-stu-id="1a05c-173">Emitting this property as **TRUE** tells the indexer that if this URL has not been processed at the end of an incremental crawl, it should not be deleted.</span></span> <span data-ttu-id="1a05c-174">Ele só será excluído se o item raiz tiver sido alterado e não for visitado.</span><span class="sxs-lookup"><span data-stu-id="1a05c-174">It will only be deleted if the root item has changed and it is not visited.</span></span>

<span data-ttu-id="1a05c-175">O Windows Search requer uma página inicial para um protocolo a fim de saber quais URLs devem ser rastreadas de forma incremental e quais URLs deverão ser ignoradas quando forem encontradas.</span><span class="sxs-lookup"><span data-stu-id="1a05c-175">Windows Search requires a start page for a protocol in order to know what URLs to crawl incrementally and which URLs should be ignored when they are found.</span></span> <span data-ttu-id="1a05c-176">Mas não podemos começar com uma URL para cada arquivo. zip, porque não sabemos onde cada arquivo. zip é.</span><span class="sxs-lookup"><span data-stu-id="1a05c-176">But we can't start with a URL for each .zip file, because we don't know where each .zip file is.</span></span> <span data-ttu-id="1a05c-177">Portanto, a URL da página inicial do manipulador de protocolo. zip deve ser capaz de enumerar tudo na raiz dos caminhos de escape de todos os arquivos. zip.</span><span class="sxs-lookup"><span data-stu-id="1a05c-177">Hence, the .zip protocol handler's start page URL must be able to enumerate everything at the root of the escaped paths of all of the .zip files.</span></span> <span data-ttu-id="1a05c-178">Esses arquivos. zip não estão necessariamente no namespace FILE: e podem ser uma URL de tipo MAPI que aponta para um arquivo. zip como um anexo, por exemplo.</span><span class="sxs-lookup"><span data-stu-id="1a05c-178">Those .zip files are not necessarily in the FILE: namespace and could be a MAPI type URL that points to a .zip file as an attachment, for example.</span></span>

<span data-ttu-id="1a05c-179">**Para registrar uma raiz como uma página inicial:**</span><span class="sxs-lookup"><span data-stu-id="1a05c-179">**To register a root as a start page:**</span></span>

1.  <span data-ttu-id="1a05c-180">Registre uma raiz como. zip:///como uma página inicial para que todos os arquivos. zip comecem lá, em vigor.</span><span class="sxs-lookup"><span data-stu-id="1a05c-180">Register a root such as .zip:/// as a start page so that all .zip files start there, in effect.</span></span> <span data-ttu-id="1a05c-181">Ao processar o root. zip: URL, seu manipulador de protocolo deve gerar a lista de URLs filho a serem emitidas consultando o Windows Search para todas as URLs com System. FileExtension = ". zip".</span><span class="sxs-lookup"><span data-stu-id="1a05c-181">When processing the root .zip: URL, your protocol handler should generate the list of child URLs to emit by querying Windows Search for all of the URLs with System.FileExtension = ".zip".</span></span>
2.  <span data-ttu-id="1a05c-182">Escape essas URLs para remover as barras e retorná-las como URLs filho.</span><span class="sxs-lookup"><span data-stu-id="1a05c-182">Escape those URLs to remove the slashes and return them as child URLs.</span></span> <span data-ttu-id="1a05c-183">Uma consulta de exemplo para recuperar os tipos que você deseja pode ter a seguinte aparência.</span><span class="sxs-lookup"><span data-stu-id="1a05c-183">An example query to retrieve the types you want might look as follows.</span></span>

    ``` syntax
    SELECT system.itemurl, System.DateModified FROM SystemIndex 
    WHERE System.FileExtension='.zip' OR System.MimeType='mimetypefor.zip'
    ```

3.  <span data-ttu-id="1a05c-184">Quando o Windows Search faz periodicamente um rastreamento incremental em sua URL raiz. zip:///, você deve refletir de volta a lista de URLs que o Windows Search já está mantendo, que são URLs. zip.</span><span class="sxs-lookup"><span data-stu-id="1a05c-184">When Windows Search periodically does an incremental crawl on your .zip:/// root URL, you must reflect back the list of URLs that Windows Search is already maintaining that are .zip URLs.</span></span> <span data-ttu-id="1a05c-185">Se uma exclusão for descoberta no armazenamento nativo em que o arquivo. zip estiver armazenado, ele não aparecerá na sua enumeração e essa ramificação da árvore no. zip será removida.</span><span class="sxs-lookup"><span data-stu-id="1a05c-185">If a deletion is discovered in the native store where the .zip file is stored, it does not appear in your enumeration, and that branch of the tree in the .zip is removed.</span></span>
4.  <span data-ttu-id="1a05c-186">Para associar os dados. zip para outro manipulador de protocolo, você deve, idealmente, percorrer o [IShellFolder](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) dessa URL para associar ao armazenamento do objeto e não pressupor que seja sempre um arquivo.</span><span class="sxs-lookup"><span data-stu-id="1a05c-186">To bind to the .zip data for another protocol handler, you should ideally go through the [IShellFolder](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) for that URL to bind to the storage of the object, and not assume it is always a file.</span></span> <span data-ttu-id="1a05c-187">Isso lhe dá a flexibilidade de trabalhar com anexos em lojas de email, por exemplo.</span><span class="sxs-lookup"><span data-stu-id="1a05c-187">Doing so affords you the flexibility to work with attachments in mail stores, for example.</span></span>
5.  <span data-ttu-id="1a05c-188">Ao emitir URLs filho para cada arquivo. zip, você deve usar o PKEY \_ Search \_ UrlToIndexWithModificationTime ([System. Search. UrlToIndexWithModificationTime](../properties/props-system-search-urltoindexwithmodificationtime.md)) para passar PKEY \_ DateModified ([System. DateModified](../properties/props-system-datemodified.md)) do arquivo. zip real para que o indexador rastreie o arquivo. zip somente se ele tiver sido alterado.</span><span class="sxs-lookup"><span data-stu-id="1a05c-188">When emitting child URLs for each .zip file, you should use PKEY\_Search\_UrlToIndexWithModificationTime ([System.Search.UrlToIndexWithModificationTime](../properties/props-system-search-urltoindexwithmodificationtime.md)) to pass PKEY\_DateModified ([System.DateModified](../properties/props-system-datemodified.md)) of the actual .zip file so that the indexer crawls the .zip file only if it has changed.</span></span>

<span data-ttu-id="1a05c-189">Para que suas URLs. zip sejam indexadas imediatamente depois de serem criadas ou modificadas e não precisem esperar que um rastreamento incremental descubra seu novo estado, você pode monitorar o sistema de arquivos por conta própria para alterar o arquivo. zip.</span><span class="sxs-lookup"><span data-stu-id="1a05c-189">To have your .zip URLs indexed immediately after they are created or modified, and not have to wait for an incremental crawl to discover their new state, you could conceivably monitor the file system yourself for .zip file changes.</span></span> <span data-ttu-id="1a05c-190">No entanto, essa abordagem não funcionaria para outros armazenamentos de dados, como MAPI.</span><span class="sxs-lookup"><span data-stu-id="1a05c-190">However, such an approach would not work for other data stores such as MAPI.</span></span>

<span data-ttu-id="1a05c-191">**Para que suas URLs. zip sejam indexadas quando forem criadas ou modificadas:**</span><span class="sxs-lookup"><span data-stu-id="1a05c-191">**To have your .zip urls indexed when they are created or modified:**</span></span>

1.  <span data-ttu-id="1a05c-192">Crie um filtro (e a implementação da interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ) para o tipo de arquivo. zip.</span><span class="sxs-lookup"><span data-stu-id="1a05c-192">Create a filter (and implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface) for the .zip file type.</span></span> <span data-ttu-id="1a05c-193">Para obter mais informações, consulte [desenvolvendo manipuladores de propriedade para o Windows Search](-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="1a05c-193">For more information, see [Developing Property Handlers for Windows Search](-search-3x-wds-extidx-propertyhandlers.md).</span></span>
2.  <span data-ttu-id="1a05c-194">Sempre que a implementação do [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) é chamada, isso ocorre porque essa URL foi descoberta ou alterada.</span><span class="sxs-lookup"><span data-stu-id="1a05c-194">Whenever your [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) implementation is called, it is because that URL has been discovered or changed.</span></span> <span data-ttu-id="1a05c-195">Em seguida, gere um evento para a URL. zip apropriada para a URL de origem, por meio da interface [**IGatherNotifyInline**](/previous-versions/windows/desktop/legacy/bb231470(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="1a05c-195">Then, generate an event for the .zip URL appropriate for the source URL, through the [**IGatherNotifyInline**](/previous-versions/windows/desktop/legacy/bb231470(v=vs.85)) interface.</span></span> <span data-ttu-id="1a05c-196">Isso lhe dá a capacidade de informar imediatamente ao indexador que há novos dados a serem indexados sem a necessidade de aguardar o rastreamento incremental.</span><span class="sxs-lookup"><span data-stu-id="1a05c-196">Doing so gives you the ability to immediately tell the indexer that there is new data to be indexed without having to wait for the incremental crawl.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1a05c-197">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="1a05c-197">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1a05c-198">Desenvolvendo manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="1a05c-198">Developing Protocol Handlers</span></span>](-search-3x-wds-phaddins.md)
</dt> <dt>

[<span data-ttu-id="1a05c-199">Instalando e Registrando manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="1a05c-199">Installing and Registering Protocol Handlers</span></span>](-search-3x-wds-ph-install-registration.md)
</dt> <dt>

[<span data-ttu-id="1a05c-200">Notificando o índice das alterações</span><span class="sxs-lookup"><span data-stu-id="1a05c-200">Notifying the Index of Changes</span></span>](-search-3x-wds-notifyingofchanges.md)
</dt> <dt>

[<span data-ttu-id="1a05c-201">Adicionando ícones e menus de contexto</span><span class="sxs-lookup"><span data-stu-id="1a05c-201">Adding Icons and Context Menus</span></span>](-search-3x-wds-ph-ui-extensions.md)
</dt> <dt>

[<span data-ttu-id="1a05c-202">Exemplo de código: extensões de Shell para manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="1a05c-202">Code Sample: Shell Extensions for Protocol Handlers</span></span>](-search-3x-wds-ph-ui-samplecode.md)
</dt> <dt>

[<span data-ttu-id="1a05c-203">Instalando e Registrando manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="1a05c-203">Installing and Registering Protocol Handlers</span></span>](-search-3x-wds-ph-install-registration.md)
</dt> <dt>

[<span data-ttu-id="1a05c-204">Criando um conector de pesquisa para um manipulador de protocolo</span><span class="sxs-lookup"><span data-stu-id="1a05c-204">Creating a Search Connector for a Protocol Handler</span></span>](-search-3x-wds-ph-search-connector.md)
</dt> <dt>

[<span data-ttu-id="1a05c-205">Depuração de manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="1a05c-205">Debugging Protocol Handlers</span></span>](-search-ws-protocolhandlertesting.md)
</dt> </dl>

 

 
