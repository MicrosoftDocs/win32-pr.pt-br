---
description: .
ms.assetid: 0e5a633e-1703-4b72-8a04-6da71aec0ae2
title: Processo de consulta no Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d92d868cb843e96b04d6b4bd575284638b6652ee
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103646861"
---
# <a name="querying-process-in-windows-search"></a><span data-ttu-id="7566f-103">Processo de consulta no Windows Search</span><span class="sxs-lookup"><span data-stu-id="7566f-103">Querying Process in Windows Search</span></span>

<span data-ttu-id="7566f-104">Este tópico é organizado da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="7566f-104">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="7566f-105">Sobre a consulta no Windows Search</span><span class="sxs-lookup"><span data-stu-id="7566f-105">About Querying in Windows Search</span></span>](#about-querying-in-windows-search)
    -   [<span data-ttu-id="7566f-106">Consultas locais e remotas</span><span class="sxs-lookup"><span data-stu-id="7566f-106">Local and Remote Queries</span></span>](#local-and-remote-queries)
    -   [<span data-ttu-id="7566f-107">Visão geral da API de consulta estruturada</span><span class="sxs-lookup"><span data-stu-id="7566f-107">Structured Query API Overview</span></span>](#structured-query-api-overview)
-   [<span data-ttu-id="7566f-108">Cenários de consulta</span><span class="sxs-lookup"><span data-stu-id="7566f-108">Querying Scenarios</span></span>](#querying-scenarios)
    -   [<span data-ttu-id="7566f-109">Extração de condição e análise de consulta</span><span class="sxs-lookup"><span data-stu-id="7566f-109">Condition Extraction and Query Parsing</span></span>](#condition-extraction-and-query-parsing)
    -   [<span data-ttu-id="7566f-110">Consultando o índice</span><span class="sxs-lookup"><span data-stu-id="7566f-110">Querying the Index</span></span>](#querying-the-index)
-   [<span data-ttu-id="7566f-111">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="7566f-111">Related topics</span></span>](#related-topics)

## <a name="about-querying-in-windows-search"></a><span data-ttu-id="7566f-112">Sobre a consulta no Windows Search</span><span class="sxs-lookup"><span data-stu-id="7566f-112">About Querying in Windows Search</span></span>

<span data-ttu-id="7566f-113">A consulta no Windows Search baseia-se nas quatro abordagens a seguir:</span><span class="sxs-lookup"><span data-stu-id="7566f-113">Querying in Windows Search is based on the following four approaches:</span></span>

-   <span data-ttu-id="7566f-114">[Sintaxe de consulta avançada](-search-3x-advancedquerysyntax.md) (AQS)</span><span class="sxs-lookup"><span data-stu-id="7566f-114">[Advanced Query Syntax](-search-3x-advancedquerysyntax.md) (AQS)</span></span>
-   <span data-ttu-id="7566f-115">Sintaxe de consulta natural (NQS)</span><span class="sxs-lookup"><span data-stu-id="7566f-115">Natural Query Syntax (NQS)</span></span>
-   <span data-ttu-id="7566f-116">SQL (Structured Query Language)</span><span class="sxs-lookup"><span data-stu-id="7566f-116">Structured Query Language (SQL)</span></span>
-   <span data-ttu-id="7566f-117">Interfaces de consulta estruturadas</span><span class="sxs-lookup"><span data-stu-id="7566f-117">Structured query interfaces</span></span>

<span data-ttu-id="7566f-118">AQS é a sintaxe de consulta padrão usada pelo Windows Search para consultar o índice e refinar e restringir os parâmetros de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="7566f-118">AQS is the default query syntax used by Windows Search to query the index and to refine and narrow search parameters.</span></span> <span data-ttu-id="7566f-119">O AQS é voltado principalmente para o usuário e pode ser usado por usuários para criar consultas AQS, mas também pode ser usado por desenvolvedores para criar consultas programaticamente.</span><span class="sxs-lookup"><span data-stu-id="7566f-119">AQS is primarily user facing, and can be used by users to build AQS queries, but can also be used by developers to build queries programmatically.</span></span> <span data-ttu-id="7566f-120">No Windows 7, o AQS canônico foi introduzido e deve ser usado para gerar consultas AQS programaticamente.</span><span class="sxs-lookup"><span data-stu-id="7566f-120">In Windows 7, canonical AQS was introduced and must be used to programmatically generate AQS queries.</span></span> <span data-ttu-id="7566f-121">No Windows 7 e posterior, uma opção de menu de atalho pode estar disponível com base no fato de uma condição AQS ser atendida.</span><span class="sxs-lookup"><span data-stu-id="7566f-121">In Windows 7 and later, a shortcut menu option can be available based on whether an AQS condition is met.</span></span> <span data-ttu-id="7566f-122">Para obter mais informações, consulte "obtendo comportamento dinâmico para verbos estáticos usando a sintaxe de consulta avançada" em [criando manipuladores de menu de contexto](../shell/context-menu-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="7566f-122">For more information, see "Getting Dynamic Behavior for Static Verbs by Using Advanced Query Syntax" in [Creating Context Menu Handlers](../shell/context-menu-handlers.md).</span></span> <span data-ttu-id="7566f-123">As consultas AQS podem ser limitadas a tipos específicos de arquivos, que são conhecidos como tipos de arquivo.</span><span class="sxs-lookup"><span data-stu-id="7566f-123">AQS queries can be limited to specific types of files, which are known as file kinds.</span></span> <span data-ttu-id="7566f-124">Para obter mais informações, consulte [tipos de arquivo e associações](../shell/fa-intro.md).</span><span class="sxs-lookup"><span data-stu-id="7566f-124">For more information, see [File Types and Associations](../shell/fa-intro.md).</span></span> <span data-ttu-id="7566f-125">Para obter a documentação de referência sobre as propriedades relevantes, consulte [System. Kind](../properties/props-system-kind.md)e [System. KindText](../properties/props-system-kindtext.md).</span><span class="sxs-lookup"><span data-stu-id="7566f-125">For reference documentation on the relevant properties, see [System.Kind](../properties/props-system-kind.md), and [System.KindText](../properties/props-system-kindtext.md).</span></span>

<span data-ttu-id="7566f-126">NQS é uma sintaxe de consulta mais relaxada do que o AQS e é semelhante ao idioma humano.</span><span class="sxs-lookup"><span data-stu-id="7566f-126">NQS is a query syntax that is more relaxed than AQS, and is similar to human language.</span></span> <span data-ttu-id="7566f-127">NQS pode ser usado pelo Windows Search para consultar o índice se NQS for selecionado em vez do padrão, AQS.</span><span class="sxs-lookup"><span data-stu-id="7566f-127">NQS can be used by Windows Search to query the index if NQS is selected instead of the default, AQS.</span></span>

<span data-ttu-id="7566f-128">SQL é uma linguagem de texto que define consultas.</span><span class="sxs-lookup"><span data-stu-id="7566f-128">SQL is a text language that defines queries.</span></span> <span data-ttu-id="7566f-129">O SQL é comum entre muitas tecnologias de banco de dados diferentes.</span><span class="sxs-lookup"><span data-stu-id="7566f-129">SQL is common across many different database technologies.</span></span> <span data-ttu-id="7566f-130">O Windows Search usa o SQL, implementa um subconjunto dele e o estende adicionando elementos ao idioma.</span><span class="sxs-lookup"><span data-stu-id="7566f-130">Windows Search uses SQL, implements a subset of it, and extends it by adding elements to the language.</span></span> <span data-ttu-id="7566f-131">O Windows Search SQL estende a sintaxe de consulta de banco de dados SQL-92 e SQL-99 padrão para aprimorar sua utilidade com pesquisas baseadas em texto.</span><span class="sxs-lookup"><span data-stu-id="7566f-131">Windows Search SQL extends the standard SQL-92 and SQL-99 database query syntax to enhance its usefulness with text-based searches.</span></span> <span data-ttu-id="7566f-132">Todos os recursos do Windows Search SQL são compatíveis com o Windows Search no Windows XP e no Windows Server 2003 e posterior.</span><span class="sxs-lookup"><span data-stu-id="7566f-132">All features of Windows Search SQL are compatible with Windows Search on Windows XP and Windows Server 2003, and later.</span></span> <span data-ttu-id="7566f-133">Para obter mais informações sobre o SQL Search do Windows, consulte [consultando o índice com a sintaxe SQL do Windows Search](-search-sql-windowssearch-entry.md)e [visão geral da sintaxe SQL do Windows Search](-search-sql-ovwofsearchquery.md).</span><span class="sxs-lookup"><span data-stu-id="7566f-133">For more information about Windows Search SQL, see [Querying the Index with Windows Search SQL Syntax](-search-sql-windowssearch-entry.md), and [Overview of Windows Search SQL Syntax](-search-sql-ovwofsearchquery.md).</span></span>

<span data-ttu-id="7566f-134">As APIs de consulta estruturada são descritas posteriormente neste tópico.</span><span class="sxs-lookup"><span data-stu-id="7566f-134">The structured query APIs are described later in this topic.</span></span> <span data-ttu-id="7566f-135">Para obter a documentação de referência sobre as APIs de consulta estruturada, consulte [consultando interfaces](-search-querying-interfaces-entry-page.md).</span><span class="sxs-lookup"><span data-stu-id="7566f-135">For reference documentation on the structured query APIs, see [Querying Interfaces](-search-querying-interfaces-entry-page.md).</span></span> <span data-ttu-id="7566f-136">Interfaces como [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) ajudam a construir cadeias de caracteres SQL de um conjunto de valores de entrada.</span><span class="sxs-lookup"><span data-stu-id="7566f-136">Interfaces such as [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) help construct SQL strings from a set of input values.</span></span> <span data-ttu-id="7566f-137">Essa interface converte as consultas de usuário AQS no SQL Search do Windows e especifica as restrições de consulta que podem ser expressas em SQL, mas não em AQS.</span><span class="sxs-lookup"><span data-stu-id="7566f-137">This interface converts AQS user queries to Windows Search SQL and specifies query restrictions that can be expressed in SQL but not in AQS.</span></span> <span data-ttu-id="7566f-138">O [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) também obtém uma cadeia de conexão OLE DB para se conectar ao banco de dados do Windows Search.</span><span class="sxs-lookup"><span data-stu-id="7566f-138">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) also obtains an OLE DB connection string to connect to the Windows Search database.</span></span>

### <a name="local-and-remote-queries"></a><span data-ttu-id="7566f-139">Consultas locais e remotas</span><span class="sxs-lookup"><span data-stu-id="7566f-139">Local and Remote Queries</span></span>

<span data-ttu-id="7566f-140">Você pode executar suas consultas de forma local ou remota.</span><span class="sxs-lookup"><span data-stu-id="7566f-140">You can execute your queries either locally or remotely.</span></span> <span data-ttu-id="7566f-141">Uma consulta local usando a [cláusula from](-search-sql-from.md) é mostrada no exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="7566f-141">A local query using the [FROM clause](-search-sql-from.md) is shown in the following example.</span></span> <span data-ttu-id="7566f-142">Uma consulta local pesquisa apenas o catálogo SystemIndex local.</span><span class="sxs-lookup"><span data-stu-id="7566f-142">A local query queries the local SystemIndex catalog only.</span></span>


```
FROM SystemIndex
```



<span data-ttu-id="7566f-143">Uma consulta remota usando a [cláusula from](-search-sql-from.md) é mostrada no exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="7566f-143">A remote query using the [FROM clause](-search-sql-from.md) is shown in the following example.</span></span> <span data-ttu-id="7566f-144">Adicionar ComputerName transforma o exemplo anterior em uma consulta remota.</span><span class="sxs-lookup"><span data-stu-id="7566f-144">Adding ComputerName transforms the previous example into a remote query.</span></span>


```
FROM [<ComputerName>.]SystemIndex
```



<span data-ttu-id="7566f-145">Por padrão, o Windows XP e o Windows Server 2003 não têm o Windows Search instalado.</span><span class="sxs-lookup"><span data-stu-id="7566f-145">By default, Windows XP and Windows Server 2003 do not have Windows Search installed.</span></span> <span data-ttu-id="7566f-146">Somente o Windows Search 4 (WS4) fornece suporte de consulta remota.</span><span class="sxs-lookup"><span data-stu-id="7566f-146">Only Windows Search 4 (WS4) provides remote query support.</span></span> <span data-ttu-id="7566f-147">As versões anteriores do Windows Desktop Search (WDS), como 3, 1 e anteriores, não oferecem suporte a consultas remotas.</span><span class="sxs-lookup"><span data-stu-id="7566f-147">Previous versions of Windows Desktop Search (WDS), such as 3.01 and earlier, do not support remote querying.</span></span> <span data-ttu-id="7566f-148">Com o Windows Explorer, você pode consultar o índice local de um computador remoto para itens do sistema de arquivos (itens manipulados pelo protocolo "file:").</span><span class="sxs-lookup"><span data-stu-id="7566f-148">With Windows Explorer you can query the local index of a remote computer for file system items (items handled by the "file:" protocol).</span></span>

<span data-ttu-id="7566f-149">Para recuperar um item pela consulta remota, o item deve atender aos seguintes requisitos:</span><span class="sxs-lookup"><span data-stu-id="7566f-149">To retrieve an item by remote query, the item must meet the following requirements:</span></span>

-   <span data-ttu-id="7566f-150">Ser acessível por meio do caminho UNC (Convenção de nomenclatura universal).</span><span class="sxs-lookup"><span data-stu-id="7566f-150">Be accessible via Universal Naming Convention (UNC) path.</span></span>
-   <span data-ttu-id="7566f-151">Existem no computador remoto ao qual o cliente tem acesso.</span><span class="sxs-lookup"><span data-stu-id="7566f-151">Exist on the remote computer to which the client has access.</span></span>
-   <span data-ttu-id="7566f-152">Tenha sua segurança definida para permitir que o cliente tenha acesso de leitura.</span><span class="sxs-lookup"><span data-stu-id="7566f-152">Have its security set to allow the client to have Read access.</span></span>

<span data-ttu-id="7566f-153">O Windows Explorer tem recursos para compartilhar itens, incluindo um compartilhamento "público" ( \\ \\ público de máquina... \\ \\ ) no **centro de rede e compartilhamento** e um compartilhamento de "usuários" ( \\ \\ usuários do computador \\ \\ ...) para itens compartilhados por meio do assistente de compartilhamento.</span><span class="sxs-lookup"><span data-stu-id="7566f-153">Windows Explorer has features for sharing items, including a "Public" share (\\\\Machine\\Public\\...) in the **Network and Sharing Center**, and a "Users" share (\\\\Machine\\Users\\...) for items shared via the Sharing Wizard.</span></span> <span data-ttu-id="7566f-154">Depois de compartilhar as pastas, você pode consultar o índice local especificando o nome da máquina remota do computador na cláusula FROM e um caminho UNC no computador remoto na cláusula SCOPE.</span><span class="sxs-lookup"><span data-stu-id="7566f-154">After you share the folder(s), you can query the local index by specifying the remote computer's machine name in the FROM clause, and a UNC path on the remote computer in the SCOPE clause.</span></span> <span data-ttu-id="7566f-155">Uma consulta remota usando as cláusulas FROM e SCOPE é mostrada no exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="7566f-155">A remote query using the FROM and SCOPE clauses is shown in the following example.</span></span>


```
SELECT System.ItemName FROM MachineName.SystemIndex WHERE SCOPE='file://MachineName/<path>' 
```



<span data-ttu-id="7566f-156">Os exemplos fornecidos aqui usam SQL.</span><span class="sxs-lookup"><span data-stu-id="7566f-156">The examples provided here use SQL.</span></span>

### <a name="structured-query-api-overview"></a><span data-ttu-id="7566f-157">Visão geral da API de consulta estruturada</span><span class="sxs-lookup"><span data-stu-id="7566f-157">Structured Query API Overview</span></span>

<span data-ttu-id="7566f-158">Uma consulta estruturada fornece a capacidade de pesquisar informações por combinações booleanas de consultas em propriedades individuais.</span><span class="sxs-lookup"><span data-stu-id="7566f-158">A structured query provides the ability to search for information by Boolean combinations of queries over individual properties.</span></span> <span data-ttu-id="7566f-159">Neste tópico, descrevemos a funcionalidade das APIs e métodos de consulta estruturada mais importantes.</span><span class="sxs-lookup"><span data-stu-id="7566f-159">In this topic we outline the functionality of the most important structured query APIs and methods.</span></span> <span data-ttu-id="7566f-160">Para obter a documentação de referência sobre as APIs de consulta estruturada, consulte [consultando interfaces](-search-querying-interfaces-entry-page.md).</span><span class="sxs-lookup"><span data-stu-id="7566f-160">For reference documentation on the structured query APIs, see [Querying Interfaces](-search-querying-interfaces-entry-page.md).</span></span>

### <a name="iqueryparser"></a><span data-ttu-id="7566f-161">IQueryParser</span><span class="sxs-lookup"><span data-stu-id="7566f-161">IQueryParser</span></span>

<span data-ttu-id="7566f-162">O método [**IQueryParser::P grosseira**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) analisa uma cadeia de caracteres de entrada do usuário e produz uma interpretação na forma de um [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution).</span><span class="sxs-lookup"><span data-stu-id="7566f-162">The [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) method parses a user input string, and produces an interpretation in the form of an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution).</span></span> <span data-ttu-id="7566f-163">Se o parâmetro *pCustomProperties* desse método não for nulo, ele será uma enumeração de objetos [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) (um para cada propriedade personalizada reconhecida).</span><span class="sxs-lookup"><span data-stu-id="7566f-163">If the *pCustomProperties* parameter of that method is not null, then it is an enumeration of [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) objects(one for each recognized custom property).</span></span> <span data-ttu-id="7566f-164">Os outros métodos [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) permitem que o aplicativo defina várias opções, como localidade, um esquema, um separador de palavras e manipuladores para vários tipos de entidades nomeadas.</span><span class="sxs-lookup"><span data-stu-id="7566f-164">The other [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) methods permit the application to set several options, such as locale, a schema, a word breaker, and handlers for various types of named entities.</span></span> <span data-ttu-id="7566f-165">[**IQueryParser:: Getschemaprovider**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-getschemaprovider) retorna uma interface [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) para procurar o esquema carregado.</span><span class="sxs-lookup"><span data-stu-id="7566f-165">[**IQueryParser::GetSchemaProvider**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-getschemaprovider) returns an [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) interface for browsing the loaded schema.</span></span>

### <a name="iquerysolution--iconditionfactory"></a><span data-ttu-id="7566f-166">IQuerySolution : IConditionFactory</span><span class="sxs-lookup"><span data-stu-id="7566f-166">IQuerySolution : IConditionFactory</span></span>

<span data-ttu-id="7566f-167">A interface [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) fornece todas as informações sobre o resultado da análise de uma cadeia de caracteres de entrada.</span><span class="sxs-lookup"><span data-stu-id="7566f-167">The [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) interface provides all information about the result of parsing an input string.</span></span> <span data-ttu-id="7566f-168">Como **IQuerySolution** também é uma interface [**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) , nós de árvore de condição adicionais podem ser criados.</span><span class="sxs-lookup"><span data-stu-id="7566f-168">Because **IQuerySolution** is also an [**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) interface, additional condition tree nodes can be created.</span></span> <span data-ttu-id="7566f-169">O método [**IQuerySolution:: GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) produz uma árvore de condição para a interpretação.</span><span class="sxs-lookup"><span data-stu-id="7566f-169">The [**IQuerySolution::GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) method produces a condition tree for the interpretation.</span></span> <span data-ttu-id="7566f-170">**IQuerySolution:: GetQuery** também retorna o tipo semântico.</span><span class="sxs-lookup"><span data-stu-id="7566f-170">**IQuerySolution::GetQuery** also returns the semantic type.</span></span>

### <a name="iconditionfactory"></a><span data-ttu-id="7566f-171">IConditionFactory</span><span class="sxs-lookup"><span data-stu-id="7566f-171">IConditionFactory</span></span>

<span data-ttu-id="7566f-172">[**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) cria nós de árvore de condição.</span><span class="sxs-lookup"><span data-stu-id="7566f-172">[**IConditionFactory**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditionfactory) creates condition tree nodes.</span></span> <span data-ttu-id="7566f-173">Se o parâmetro de *simplificação* de [**IConditionFactory:: MakeNot**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makenot) for **Variant \_ true**, o [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) resultante será simplificado e não precisará ser um nó de negação.</span><span class="sxs-lookup"><span data-stu-id="7566f-173">If the *simplify* parameter of [**IConditionFactory::MakeNot**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makenot) is **VARIANT\_TRUE**, then the resulting [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) is simplified, and need not be a negation node.</span></span> <span data-ttu-id="7566f-174">Se o parâmetro *pSubConditions* de [**IConditionFactory:: MakeAndOr**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeandor) não for nulo, esse parâmetro deverá ser uma enumeração de objetos [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) e se tornará subárvores. [**IConditionFactory:: MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf) constrói um nó folha com um nome de propriedade, uma operação e um valor especificados.</span><span class="sxs-lookup"><span data-stu-id="7566f-174">If the *pSubConditions* parameter of [**IConditionFactory::MakeAndOr**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeandor) is not null, then that parameter should be an enumeration of [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) objects, and become subtrees.[**IConditionFactory::MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf) constructs a leaf node with a specified property name, operation, and value.</span></span> <span data-ttu-id="7566f-175">A cadeia de caracteres *no parâmetro* nametype deve ser o nome de um tipo semântico do esquema.</span><span class="sxs-lookup"><span data-stu-id="7566f-175">The string in the *pValueType* parameter should be the name of a semantic type from the schema.</span></span> <span data-ttu-id="7566f-176">Se o parâmetro *Expand* for **Variant \_ true** e a propriedade for virtual, a árvore de condição resultante normalmente será uma disjunção resultante da expansão da propriedade para seus constituintes definidos.</span><span class="sxs-lookup"><span data-stu-id="7566f-176">If the *expand* parameter is **VARIANT\_TRUE** and the property is virtual, the resulting condition tree is typically a disjunction resulting from expanding the property to its defined constituents.</span></span> <span data-ttu-id="7566f-177">Se não for NULL, os parâmetros *pPropertyNameTerm*, *pOperatorTerm* e *pValueTerm* deverão identificar os termos que indicam a propriedade, a operação e o valor.</span><span class="sxs-lookup"><span data-stu-id="7566f-177">If not null, the *pPropertyNameTerm*, *pOperatorTerm*, and *pValueTerm* parameters should identify terms indicating the property, operation, and value.</span></span>

### <a name="icondition--ipersiststream"></a><span data-ttu-id="7566f-178">ICondition: IPersistStream</span><span class="sxs-lookup"><span data-stu-id="7566f-178">ICondition : IPersistStream</span></span>

<span data-ttu-id="7566f-179">A interface [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) é um único nó em uma árvore de condição.</span><span class="sxs-lookup"><span data-stu-id="7566f-179">The [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) interface is a single node in a condition tree.</span></span> <span data-ttu-id="7566f-180">O nó pode ser um nó de negação, nó, ou nó ou um nó folha.</span><span class="sxs-lookup"><span data-stu-id="7566f-180">The node can be a negation node, AND node, OR node, or a leaf node.</span></span> <span data-ttu-id="7566f-181">Para um nó não folha [**ICondition:: GetSubConditions**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getsubconditions) retorna uma enumeração das subárvores.</span><span class="sxs-lookup"><span data-stu-id="7566f-181">For a non-leaf node [**ICondition::GetSubConditions**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getsubconditions) returns an enumeration of the subtrees.</span></span> <span data-ttu-id="7566f-182">Para um nó folha, os seguintes métodos de [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) retornam os seguintes valores:</span><span class="sxs-lookup"><span data-stu-id="7566f-182">For a leaf node the following methods of [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) return the following values:</span></span>

-   <span data-ttu-id="7566f-183">[**GetComparisonInfo**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getcomparisoninfo) retorna o nome da propriedade, a operação e o valor.</span><span class="sxs-lookup"><span data-stu-id="7566f-183">[**GetComparisonInfo**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getcomparisoninfo) returns the property name, operation, and value.</span></span>
-   <span data-ttu-id="7566f-184">[**Getvaluetype**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluetype) retorna o tipo semântico do valor, que foi specificied no parâmetro *pszValueType* de [**IConditionFactory:: MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf).</span><span class="sxs-lookup"><span data-stu-id="7566f-184">[**GetValueType**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluetype) returns the semantic type of the value, which was specificied in the *pszValueType* parameter of [**IConditionFactory::MakeLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-makeleaf).</span></span>
-   <span data-ttu-id="7566f-185">[**GetValueNormalization**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluenormalization) retorna uma forma de cadeia de caracteres do valor.</span><span class="sxs-lookup"><span data-stu-id="7566f-185">[**GetValueNormalization**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getvaluenormalization) returns a string form of the value.</span></span> <span data-ttu-id="7566f-186">(Se o valor já era uma cadeia de caracteres, esse formulário será normalizado com relação a casos, acentos e assim por diante.)</span><span class="sxs-lookup"><span data-stu-id="7566f-186">(If the value was already a string, this form will be normalized with regard to case, accents, and so forth.)</span></span>
-   <span data-ttu-id="7566f-187">[**GetInputTerms**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getinputterms) retorna informações sobre quais partes da sentença de entrada geraram o nome da propriedade, a operação e o valor.</span><span class="sxs-lookup"><span data-stu-id="7566f-187">[**GetInputTerms**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-getinputterms) returns information about which parts of the input sentence generated the property name, the operation, and the value.</span></span>
-   <span data-ttu-id="7566f-188">[**Clone**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-clone) retorna uma cópia profunda de uma árvore de condição.</span><span class="sxs-lookup"><span data-stu-id="7566f-188">[**Clone**](/windows/desktop/api/structuredquerycondition/nf-structuredquerycondition-icondition-clone) returns a deep copy of a condition tree.</span></span>

### <a name="irichchunk"></a><span data-ttu-id="7566f-189">IRichChunk</span><span class="sxs-lookup"><span data-stu-id="7566f-189">IRichChunk</span></span>

<span data-ttu-id="7566f-190">Cada objeto [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) identifica um token span e uma cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="7566f-190">Each [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) object identifies a token span and a string.</span></span> <span data-ttu-id="7566f-191">**IRichChunk** é uma interface do utilitário que representa informações sobre um Span (normalmente um intervalo de tokens) identificado por uma posição inicial e um comprimento.</span><span class="sxs-lookup"><span data-stu-id="7566f-191">**IRichChunk** is a utility interface that represents information about a span (typically a span of tokens) identified by a starting position and length.</span></span> <span data-ttu-id="7566f-192">Essas informações de span incluem uma cadeia de caracteres e/ou uma **variante**.</span><span class="sxs-lookup"><span data-stu-id="7566f-192">This span information includes a string and/or a **VARIANT**.</span></span>

### <a name="iconditiongenerator"></a><span data-ttu-id="7566f-193">IConditionGenerator</span><span class="sxs-lookup"><span data-stu-id="7566f-193">IConditionGenerator</span></span>

<span data-ttu-id="7566f-194">A interface [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) é fornecida pelo aplicativo para lidar com o reconhecimento e a geração de árvore de condição para um tipo de entidade nomeada.</span><span class="sxs-lookup"><span data-stu-id="7566f-194">The [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) interface is provided by the application to handle recognition and condition tree generation for a named entity type.</span></span> <span data-ttu-id="7566f-195">Um gerador de condição é fornecido a um [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) por meio de [**IQueryParser:: SetMultiOption**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-setmultioption).</span><span class="sxs-lookup"><span data-stu-id="7566f-195">A condition generator is given to an [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) through [**IQueryParser::SetMultiOption**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-setmultioption).</span></span> <span data-ttu-id="7566f-196">[**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) chama [**IConditionGenerator:: Initialize**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-initialize) com um [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) para o esquema atualmente carregado.</span><span class="sxs-lookup"><span data-stu-id="7566f-196">[**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) calls [**IConditionGenerator::Initialize**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-initialize) with an [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) for the currently loaded schema.</span></span> <span data-ttu-id="7566f-197">Isso permite que o [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) Obtenha informações de esquema necessárias.</span><span class="sxs-lookup"><span data-stu-id="7566f-197">Doing so permits [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) to obtain any schema information that is required.</span></span> <span data-ttu-id="7566f-198">Ao analisar uma cadeia de caracteres de entrada, **IQueryParser** chama o método [**IConditionGenerator:: RecognizeNamedEntities**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-recognizenamedentities) de cada [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), para que a ocorrência de entidades nomeadas que ele reconhece na cadeia de caracteres de entrada possa ser relatada.</span><span class="sxs-lookup"><span data-stu-id="7566f-198">When parsing an input string, **IQueryParser** calls the [**IConditionGenerator::RecognizeNamedEntities**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-recognizenamedentities) method of each [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), so that the occurrence of named entities it recognizes in the input string can be reported.</span></span> <span data-ttu-id="7566f-199">O **IQueryParser** pode usar a localidade atual e deve usar a geração de tokens da entrada, pois ela precisa relatar as extensões de token de quaisquer entidades nomeadas.</span><span class="sxs-lookup"><span data-stu-id="7566f-199">**IQueryParser** can make use of the current locale and should make use of the tokenization of the input as it needs to report the token spans of any named entities.</span></span>

<span data-ttu-id="7566f-200">Quando [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) está prestes a emitir um nó folha, e o tipo semântico do valor corresponde ao tipo de entidade nomeada para um [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), **IQueryParser** chama [**IConditionGenerator:: GenerateforLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf) com as informações para o nó a ser gerado.</span><span class="sxs-lookup"><span data-stu-id="7566f-200">When [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) is about to emit a leaf node, and the semantic type of the value matches the named entity type for an [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator), **IQueryParser** calls [**IConditionGenerator::GenerateforLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf) with the information for the node to be generated.</span></span> <span data-ttu-id="7566f-201">Se [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) retornar S \_ OK, ele deverá retornar uma árvore de condição (que não precisa ser um nó folha) e informar **IQueryParser** se deve suprimir a interpretação de cadeia de caracteres alternativa que normalmente geraria como uma precaução.</span><span class="sxs-lookup"><span data-stu-id="7566f-201">If the [**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) returns S\_OK, it should return a condition tree (which does not have to be a leaf node), and inform **IQueryParser** whether to suppress the alternative string interpretation that it would normally generate as a precaution.</span></span>

### <a name="itokencollection"></a><span data-ttu-id="7566f-202">ITokenCollection</span><span class="sxs-lookup"><span data-stu-id="7566f-202">ITokenCollection</span></span>

<span data-ttu-id="7566f-203">O método [**ITokenCollection:: NumberOfTokens**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-numberoftokens) retorna o número de tokens. [**ITokenCollection:: GetToken**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-gettoken) retorna informações sobre o símbolo *i*.</span><span class="sxs-lookup"><span data-stu-id="7566f-203">The [**ITokenCollection::NumberOfTokens**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-numberoftokens) method returns the number of tokens.[**ITokenCollection::GetToken**](/windows/desktop/api/Structuredquery/nf-structuredquery-itokencollection-gettoken) returns information about the *i* th token.</span></span> <span data-ttu-id="7566f-204">O início e o comprimento são posições de caracteres na cadeia de caracteres de entrada.</span><span class="sxs-lookup"><span data-stu-id="7566f-204">The beginning and length are character positions in the input string.</span></span> <span data-ttu-id="7566f-205">O texto retornado será não nulo somente se houver um texto substituindo os caracteres da cadeia de caracteres de entrada.</span><span class="sxs-lookup"><span data-stu-id="7566f-205">The returned text will be non-null only if there is a text overriding the characters from the input string.</span></span> <span data-ttu-id="7566f-206">Isso é usado, por exemplo, para substituir um traço na cadeia de caracteres de entrada e não quando esse traço está em um contexto onde ele deve ser interpretado como uma negação.</span><span class="sxs-lookup"><span data-stu-id="7566f-206">This is used, for example, to override a dash in the input string with NOT when that dash is in a context where it should be interpreted as a negation.</span></span>

### <a name="inamedentitycollector"></a><span data-ttu-id="7566f-207">INamedEntityCollector</span><span class="sxs-lookup"><span data-stu-id="7566f-207">INamedEntityCollector</span></span>

<span data-ttu-id="7566f-208">[**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) chama [**INamedEntityCollector:: Add**](/windows/desktop/api/Structuredquery/nf-structuredquery-inamedentitycollector-add) para cada entidade nomeada reconhecida.</span><span class="sxs-lookup"><span data-stu-id="7566f-208">[**IConditionGenerator**](/windows/desktop/api/Structuredquery/nn-structuredquery-iconditiongenerator) calls [**INamedEntityCollector::Add**](/windows/desktop/api/Structuredquery/nf-structuredquery-inamedentitycollector-add) for each named entity it recognized.</span></span> <span data-ttu-id="7566f-209">As extensões são spans de token.</span><span class="sxs-lookup"><span data-stu-id="7566f-209">The spans are token spans.</span></span> <span data-ttu-id="7566f-210">Ele sempre deve ser o caso que *beginSpan* ?</span><span class="sxs-lookup"><span data-stu-id="7566f-210">It must always be the case that *beginSpan* ?</span></span> <span data-ttu-id="7566f-211">*beginActual*  <  *endreal* ?</span><span class="sxs-lookup"><span data-stu-id="7566f-211">*beginActual* < *endActual* ?</span></span> <span data-ttu-id="7566f-212">*endspan*.</span><span class="sxs-lookup"><span data-stu-id="7566f-212">*endSpan*.</span></span> <span data-ttu-id="7566f-213">*beginSpan* e *endspan* podem ser diferentes de *beginActual* e *endreal* se a entidade nomeada começa e/ou termina com tokens semanticamente insignificantes, como aspas (que são, no entanto, cobertas pela entidade nomeada).</span><span class="sxs-lookup"><span data-stu-id="7566f-213">*beginSpan* and *endSpan* may differ from *beginActual* and *endActual* if the named entity begins and/or ends with semantically insignificant tokens such as quotation marks (that are nevertheless covered by the named entity).</span></span> <span data-ttu-id="7566f-214">O valor deve ser expresso como uma cadeia de caracteres e, subsequentemente, aparecerá em uma chamada para [**IConditionGenerator:: GenerateForLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf).</span><span class="sxs-lookup"><span data-stu-id="7566f-214">The value must be expressed as a string and will subsequently appear in a call to [**IConditionGenerator::GenerateForLeaf**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditiongenerator-generateforleaf).</span></span>

### <a name="ischemaprovider"></a><span data-ttu-id="7566f-215">ISchemaProvider</span><span class="sxs-lookup"><span data-stu-id="7566f-215">ISchemaProvider</span></span>

<span data-ttu-id="7566f-216">A interface [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) pode ser usada para procurar um esquema carregado para entidades (tipos) e relações (Propriedades).</span><span class="sxs-lookup"><span data-stu-id="7566f-216">The [**ISchemaProvider**](/windows/desktop/api/Structuredquery/nn-structuredquery-ischemaprovider) interface can be used to browse a loaded schema for entities (types) and relations (properties).</span></span> <span data-ttu-id="7566f-217">Veja a seguir os métodos individuais:</span><span class="sxs-lookup"><span data-stu-id="7566f-217">Here's what it's individual methods do:</span></span>

-   <span data-ttu-id="7566f-218">As [**entidades**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-entities) retornam uma enumeração de cada entidade ([**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity)) no esquema.</span><span class="sxs-lookup"><span data-stu-id="7566f-218">[**Entities**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-entities) returns an enumeration of every entity ([**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity)) in the schema.</span></span>
-   <span data-ttu-id="7566f-219">[**RootEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-rootentity) retorna a entidade raiz do esquema.</span><span class="sxs-lookup"><span data-stu-id="7566f-219">[**RootEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-rootentity) returns the root entity of the schema.</span></span> <span data-ttu-id="7566f-220">Para um esquema simples, o tipo principal de cada [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) é retornado.</span><span class="sxs-lookup"><span data-stu-id="7566f-220">For a flat schema, the main type of every [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) is returned.</span></span>
-   <span data-ttu-id="7566f-221">[**GetEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-getentity) localiza uma entidade por nome e retorna S \_ false se não houver essa entidade no esquema.</span><span class="sxs-lookup"><span data-stu-id="7566f-221">[**GetEntity**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-getentity) finds an entity by name and returns S\_FALSE if there is no such entity in the schema.</span></span>
-   <span data-ttu-id="7566f-222">[**Metadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-metadata) retorna uma enumeração de interfaces [**IMetadata**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) .</span><span class="sxs-lookup"><span data-stu-id="7566f-222">[**MetaData**](/windows/desktop/api/Structuredquery/nf-structuredquery-ischemaprovider-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces.</span></span>

### <a name="ientity"></a><span data-ttu-id="7566f-223">IEntity</span><span class="sxs-lookup"><span data-stu-id="7566f-223">IEntity</span></span>

<span data-ttu-id="7566f-224">A interface [**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity) é uma entidade de esquema que representa um tipo que tem um nome, tem um número de relações nomeadas para outros tipos (Propriedades) e deriva de uma entidade base.</span><span class="sxs-lookup"><span data-stu-id="7566f-224">The [**IEntity**](/windows/desktop/api/Structuredquery/nn-structuredquery-ientity) interface is a schema entity that represents a type that has a name, has a number of named relationships to other types (properties), and derives from a base entity.</span></span> <span data-ttu-id="7566f-225">Veja o que seus métodos individuais fazem:</span><span class="sxs-lookup"><span data-stu-id="7566f-225">Here's what its individual methods do:</span></span>

-   <span data-ttu-id="7566f-226">[**IEntity:: Relationships**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-relationships) retorna uma enumeração de objetos [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) , um para cada relação de saída desse tipo.</span><span class="sxs-lookup"><span data-stu-id="7566f-226">[**IEntity::Relationships**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-relationships) returns an enumeration of [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) objects, one for each outgoing relation of this type.</span></span> <span data-ttu-id="7566f-227">Cada relação de saída de uma entidade tem um nome.</span><span class="sxs-lookup"><span data-stu-id="7566f-227">Each outgoing relation of an entity has a name.</span></span>
-   <span data-ttu-id="7566f-228">[**IEntity:: GetRelationship**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-getrelationship) localiza uma relação por nome e retorna S \_ false se não houver tal relação para essa entidade.</span><span class="sxs-lookup"><span data-stu-id="7566f-228">[**IEntity::GetRelationship**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-getrelationship) finds a relationship by name, and returns S\_FALSE if there is no such relationship for this entity.</span></span>
-   <span data-ttu-id="7566f-229">[**IEntity:: Metadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-metadata) retorna uma enumeração de interfaces [**IMetadata**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) , uma para cada par de metadados desta entidade.</span><span class="sxs-lookup"><span data-stu-id="7566f-229">[**IEntity::MetaData**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces, one for each metadata pair of this entity.</span></span>
-   <span data-ttu-id="7566f-230">[**IEntity::D efaultphrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-defaultphrase) retorna uma frase padrão para facilitar a geração de uma redefinição de AQS ou nQS de uma árvore de condição.</span><span class="sxs-lookup"><span data-stu-id="7566f-230">[**IEntity::DefaultPhrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-ientity-defaultphrase) returns a default phrase to facilitate generating an AQS or NQS restatement of a condition tree.</span></span>

### <a name="irelationship"></a><span data-ttu-id="7566f-231">IRelationship</span><span class="sxs-lookup"><span data-stu-id="7566f-231">IRelationship</span></span>

<span data-ttu-id="7566f-232">A interface [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) representa uma relação entre duas entidades: uma origem e um destino.</span><span class="sxs-lookup"><span data-stu-id="7566f-232">The [**IRelationship**](/windows/desktop/api/Structuredquery/nn-structuredquery-irelationship) interface represents a relationship between two entities: a source and a destination.</span></span> <span data-ttu-id="7566f-233">Veja a seguir os métodos individuais:</span><span class="sxs-lookup"><span data-stu-id="7566f-233">Here's what it's individual methods do:</span></span>

-   <span data-ttu-id="7566f-234">[**IRelationship:: Isreal**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-isreal) relata se uma relação é real.</span><span class="sxs-lookup"><span data-stu-id="7566f-234">[**IRelationship::IsReal**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-isreal) reports whether a relationship is real.</span></span> <span data-ttu-id="7566f-235">Por exemplo, se A entidade A derivar da entidade B e herdar uma relação chamada R a partir dela, uma pode ainda ter sua própria relação chamada R. No entanto, a relação beween A e R deve ter o mesmo tipo de destino que o de B, e a única razão para ela existir é armazenar os metadados específicos para B. Essa relação de B é mencionada como real.</span><span class="sxs-lookup"><span data-stu-id="7566f-235">For example, if entity A derives from entity B and inherits a relationship named R from it, A may still have its own relationship named R. However, the relationship beween A and R must have the same destination type as that of B, and the only reason for it to exist is to store metadata specific to B. Such a relationship of B is said not to be real.</span></span>
-   <span data-ttu-id="7566f-236">[**IRelationship:: das**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-metadata) retorna uma enumeração de interfaces [**IMetadata**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) , uma para cada par de metadados desta entidade.</span><span class="sxs-lookup"><span data-stu-id="7566f-236">[**IRelationship::Medadata**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-metadata) returns an enumeration of [**IMetaData**](/windows/desktop/api/Structuredquery/nn-structuredquery-imetadata) interfaces, one for each metadata pair of this entity.</span></span>
-   <span data-ttu-id="7566f-237">[**IRelationship::D efaultphrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-defaultphrase) retorna a frase padrão a ser usada para essa relação em reestado.</span><span class="sxs-lookup"><span data-stu-id="7566f-237">[**IRelationship::DefaultPhrase**](/windows/desktop/api/Structuredquery/nf-structuredquery-irelationship-defaultphrase) returns the default phrase to use for this relationship in restatements.</span></span> <span data-ttu-id="7566f-238">Cada relação tem uma frase padrão que a denota para facilitar a geração de uma redefinição de AQS ou NQS de uma árvore de condição.</span><span class="sxs-lookup"><span data-stu-id="7566f-238">Each relationship has a default phrase that denotes it to facilitate generating an AQS or NQS restatement of a condition tree.</span></span>

### <a name="imetadata"></a><span data-ttu-id="7566f-239">IMetaData</span><span class="sxs-lookup"><span data-stu-id="7566f-239">IMetaData</span></span>

<span data-ttu-id="7566f-240">Os metadados são pares chave-valor que são associados a uma entidade, a uma relação ou ao esquema inteiro.</span><span class="sxs-lookup"><span data-stu-id="7566f-240">Metadata are key-value pairs that are each associated with either an entity, a relationship, or the whole schema.</span></span> <span data-ttu-id="7566f-241">Como as chaves não são necessariamente exclusivas, uma coleção de metadados pode ser considerada como um mapa múltiplo.</span><span class="sxs-lookup"><span data-stu-id="7566f-241">Because keys are not necessarily unique, a collection of metadata can be thought of as a multi-map.</span></span> <span data-ttu-id="7566f-242">[**IMetadata:: GetData**](/windows/desktop/api/Structuredquery/nf-structuredquery-imetadata-getdata) é chamado para recuperar a chave e o valor de um par de refletir.</span><span class="sxs-lookup"><span data-stu-id="7566f-242">[**IMetaData::GetData**](/windows/desktop/api/Structuredquery/nf-structuredquery-imetadata-getdata) is called to retrieve the key and value for a metatdata pair.</span></span>

## <a name="querying-scenarios"></a><span data-ttu-id="7566f-243">Cenários de consulta</span><span class="sxs-lookup"><span data-stu-id="7566f-243">Querying Scenarios</span></span>

<span data-ttu-id="7566f-244">Os cenários a seguir descrevem o uso de APIs de consulta estruturada no Windows Search em cenários de consulta comuns, como a criação de uma árvore de condição e a consulta do índice.</span><span class="sxs-lookup"><span data-stu-id="7566f-244">The following scenarios describe the use of structured query APIs in Windows Search in common querying scenarios, such as creating a condition tree and querying the index.</span></span>

### <a name="condition-extraction-and-query-parsing"></a><span data-ttu-id="7566f-245">Extração de condição e análise de consulta</span><span class="sxs-lookup"><span data-stu-id="7566f-245">Condition Extraction and Query Parsing</span></span>

<span data-ttu-id="7566f-246">Quando uma consulta é criada, seu escopo é definido informando ao sistema onde Pesquisar.</span><span class="sxs-lookup"><span data-stu-id="7566f-246">When a query is created, its scope is defined by telling the system where to search.</span></span> <span data-ttu-id="7566f-247">Isso restringe os resultados da pesquisa.</span><span class="sxs-lookup"><span data-stu-id="7566f-247">This restricts the search results.</span></span> <span data-ttu-id="7566f-248">Depois que o escopo é definido, um filtro é aplicado e um conjunto de filtros é retornado.</span><span class="sxs-lookup"><span data-stu-id="7566f-248">After the scope is defined, a filter is applied, and a filter set is returned.</span></span> <span data-ttu-id="7566f-249">Os resultados da pesquisa são restritos pela criação de uma árvore de condição com nós folha, semelhante a um grafo.</span><span class="sxs-lookup"><span data-stu-id="7566f-249">Search results are restricted by building a condition tree with leaf nodes, similar to a graph.</span></span> <span data-ttu-id="7566f-250">Essas condições são extraídas.</span><span class="sxs-lookup"><span data-stu-id="7566f-250">Those conditions are then extracted.</span></span> <span data-ttu-id="7566f-251">Uma árvore de condição é uma combinação booleana (e, ou, não) de condições folha, cada uma das quais relaciona uma propriedade, por meio de uma operação, a um valor.</span><span class="sxs-lookup"><span data-stu-id="7566f-251">A condition tree is a Boolean combination (AND, OR, NOT) of leaf conditions, each of which relates a property, through an operation, to a value.</span></span> <span data-ttu-id="7566f-252">Um nó folha representa uma restrição em uma única propriedade para um valor por meio de algumas operações.</span><span class="sxs-lookup"><span data-stu-id="7566f-252">A leaf node represents a restriction on a single property to a value through some operations.</span></span>

<span data-ttu-id="7566f-253">Uma restrição de filtro requer uma expressão lógica que descreva a restrição.</span><span class="sxs-lookup"><span data-stu-id="7566f-253">A filter restriction requires a logical expression that describes the restriction.</span></span> <span data-ttu-id="7566f-254">Definir essa expressão começa com a interface [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) , que é usada para criar um único nó em uma árvore de condição.</span><span class="sxs-lookup"><span data-stu-id="7566f-254">Defining this expression starts with the [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) interface, which is used to create a single node in a condition tree.</span></span> <span data-ttu-id="7566f-255">Como há apenas uma condição no exemplo a seguir, a árvore não é alterada.</span><span class="sxs-lookup"><span data-stu-id="7566f-255">Because there is only one condition in the following example, the tree does not change.</span></span>


```C++
    
    [
        object,
        uuid(0FC988D4-C935-4b97-A973-46282EA175C8),
        pointer_default(unique)
    ]
    interface ICondition : IPersistStream
    {
        HRESULT GetConditionType([out, retval] CONDITION_TYPE* pNodeType);
        HRESULT GetSubConditions([in] REFIID riid, [out, retval, iid_is(riid)] void** ppv);
        [local] HRESULT GetComparisonInfo([out, annotation("__deref_opt_out")] LPWSTR *ppszPropertyName, [out, annotation("__out_opt")] CONDITION_OPERATION *pOperation, [out, annotation("__out_opt")] PROPVARIANT *pValue);
        HRESULT GetValueType([out, retval] LPWSTR* ppszValueTypeName);
        HRESULT GetValueNormalization([out, retval] LPWSTR* ppszNormalization);
        [local] HRESULT GetInputTerms([out, annotation("__out_opt")] IRichChunk** ppPropertyTerm, [out, annotation("__out_opt")] IRichChunk** ppOperationTerm, [out, annotation("__out_opt")] IRichChunk** ppValueTerm);
        HRESULT Clone([out, retval] ICondition** ppc);
    };


```



<span data-ttu-id="7566f-256">Se houver mais de uma condição de filtro, então e outros operadores boolianos serão usados para obter uma única árvore.</span><span class="sxs-lookup"><span data-stu-id="7566f-256">If there is more than one filter condition, then AND and other Boolean operators are used to achieve a single tree.</span></span> <span data-ttu-id="7566f-257">E-árvores e árvores representam conjunção e disjunções de suas subárvores.</span><span class="sxs-lookup"><span data-stu-id="7566f-257">AND-trees and OR-trees represent conjunctions and disjunctions of their subtrees.</span></span> <span data-ttu-id="7566f-258">Uma árvore NOT representa a negação de sua única subárvore.</span><span class="sxs-lookup"><span data-stu-id="7566f-258">A NOT-tree represents the negation of its single subtree.</span></span> <span data-ttu-id="7566f-259">O AQS fornece uma abordagem de texto para alcançar expressões lógicas com operadores boolianos e é geralmente mais simples.</span><span class="sxs-lookup"><span data-stu-id="7566f-259">AQS provides a text approach to achieving logical expressions with Boolean operators, and is often simpler.</span></span>

<span data-ttu-id="7566f-260">No próximo exemplo, convertemos a árvore de condição ([**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition)) no formato visual.</span><span class="sxs-lookup"><span data-stu-id="7566f-260">In the next example we convert the condition tree ([**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition)) into visual form.</span></span> <span data-ttu-id="7566f-261">O analisador de consulta, usando a interface [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) , converte o [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) em uma cadeia de caracteres de consulta Rich Text formatada (RTF).</span><span class="sxs-lookup"><span data-stu-id="7566f-261">The query parser, using the [**IQueryParser**](/windows/desktop/api/Structuredquery/nn-structuredquery-iqueryparser) interface, converts the [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition) into a rich text formatted (RTF) query string.</span></span> <span data-ttu-id="7566f-262">O método [**IQueryParser:: RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) retorna o texto da consulta, enquanto o método [**IQueryParser::P grosseira**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) produz uma interface [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) .</span><span class="sxs-lookup"><span data-stu-id="7566f-262">The [**IQueryParser::RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) method returns the query text, while the [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) method produces an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution) interface.</span></span> <span data-ttu-id="7566f-263">O exemplo a seguir mostra como fazer tudo isso.</span><span class="sxs-lookup"><span data-stu-id="7566f-263">The following example shows how to do all that.</span></span>


```C++
    [
        object,
        uuid(2EBDEE67-3505-43f8-9946-EA44ABC8E5B0),
        pointer_default(unique)
    ]
    interface IQueryParser : IUnknown
    {
        HRESULT Parse([in] LPCWSTR pszInputString, [in] IEnumUnknown* pCustomProperties, [out, retval] IQuerySolution** ppSolution);
        HRESULT SetOption([in] STRUCTURED_QUERY_SINGLE_OPTION option, [in] PROPVARIANT const* pOptionValue);
        HRESULT GetOption([in] STRUCTURED_QUERY_SINGLE_OPTION option, [out, retval] PROPVARIANT* pOptionValue);
        HRESULT SetMultiOption([in] STRUCTURED_QUERY_MULTIOPTION option, [in] LPCWSTR pszOptionKey, [in] PROPVARIANT const* pOptionValue);
        HRESULT GetSchemaProvider([out, retval] ISchemaProvider** ppSchemaProvider);
        HRESULT RestateToString([in] ICondition* pCondition, [in] BOOL fUseEnglish, [out] LPWSTR* ppszQueryString);
        HRESULT ParsePropertyValue([in] LPCWSTR pszPropertyName, [in] LPCWSTR pszInputString, [out, retval] IQuerySolution** ppSolution);
        HRESULT RestatePropertyValueToString([in] ICondition* pCondition, [in] BOOL fUseEnglish, [out] LPWSTR* ppszPropertyName, [out] LPWSTR* ppszQueryString);
    };

```



<span data-ttu-id="7566f-264">A principal entrada de [**IQueryParser::P grosseira**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) é uma cadeia de caracteres de entrada do usuário a ser analisada, mas o aplicativo também pode informar o analisador de consulta de quaisquer propriedades reconhecidas na entrada (a partir da sintaxe específica do aplicativo).</span><span class="sxs-lookup"><span data-stu-id="7566f-264">The main input of [**IQueryParser::Parse**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-parse) is a user input string to be parsed, but the application can also inform the query parser of any properties it has recognized in the input (from application-specific syntax).</span></span> <span data-ttu-id="7566f-265">A saída de **IQueryParser::P grosseira** é um [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution), que fornece todas as informações referentes a essa invocação de análise.</span><span class="sxs-lookup"><span data-stu-id="7566f-265">The output of **IQueryParser::Parse** is an [**IQuerySolution**](/windows/desktop/api/Structuredquery/nn-structuredquery-iquerysolution), which provides all information pertaining to that parse invocation.</span></span> <span data-ttu-id="7566f-266">Há métodos para obter a cadeia de caracteres de entrada, como a cadeia de caracteres de entrada foi indexada, quaisquer erros de análise e a consulta analisada como árvore de condição, representada por um [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition).</span><span class="sxs-lookup"><span data-stu-id="7566f-266">There are methods for obtaining the input string, how the input string was tokenized, any parse errors, and the parsed query as condition tree, represented by an [**ICondition**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-icondition).</span></span> <span data-ttu-id="7566f-267">O exemplo a seguir mostra...</span><span class="sxs-lookup"><span data-stu-id="7566f-267">The following example shows ...</span></span>


```C++
    [
        object,
        uuid(D6EBC66B-8921-4193-AFDD-A1789FB7FF57),
        pointer_default(unique)
    ]
    interface IQuerySolution : IConditionFactory
    {
        [local] HRESULT GetQuery([out, annotation("__out_opt")] ICondition** ppQueryNode, [out, annotation("__out_opt")] IEntity** ppMainType);
        HRESULT GetErrors([in] REFIID riid, [out, retval, iid_is(riid)] void** ppParseErrors);
        [local] HRESULT GetLexicalData([out, annotation("__deref_opt_out")] LPWSTR* ppszInputString, [out, annotation("__out_opt")] ITokenCollection** ppTokens, [out, annotation("__out_opt")] LCID* pLocale, [out, annotation("__out_opt")] IUnknown** ppWordBreaker);
    }    

    

```



<span data-ttu-id="7566f-268">No exemplo anterior, [**IQuerySolution:: GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) poderia obter qualquer informação sobre a consulta, incluindo o texto original, tokens que compõem o texto ou a árvore de condição.</span><span class="sxs-lookup"><span data-stu-id="7566f-268">In the previous example, [**IQuerySolution::GetQuery**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getquery) could obtain any information about the query including the original text, tokens that comprise the text, or the condition tree.</span></span> <span data-ttu-id="7566f-269">Exemplos de valores de consulta retornados possíveis são listados na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="7566f-269">Examples of possible returned query values are listed in the following table.</span></span>



| <span data-ttu-id="7566f-270">Exemplos de valores de consulta retornados</span><span class="sxs-lookup"><span data-stu-id="7566f-270">Examples of returned query values</span></span>                        | <span data-ttu-id="7566f-271">Descrição</span><span class="sxs-lookup"><span data-stu-id="7566f-271">Description</span></span>                                                                                               |
|----------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|
| `  author:relja OR author:tyler`                         | <span data-ttu-id="7566f-272">O texto da consulta que [**IQueryParser:: RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) retorna</span><span class="sxs-lookup"><span data-stu-id="7566f-272">The query text that [**IQueryParser::RestateToString**](/windows/desktop/api/Structuredquery/nf-structuredquery-iqueryparser-restatetostring) returns</span></span> |
| `?author?, ?:?, ?relja?, ?OR?, ?author?, ?:?, ?tyler?`   | <span data-ttu-id="7566f-273">A quebra de tokens</span><span class="sxs-lookup"><span data-stu-id="7566f-273">The break-down of tokens</span></span>                                                                                  |
| ![uma árvore de condição não resolvida](images/queryvalues1.png) | <span data-ttu-id="7566f-275">Uma árvore de condição não resolvida</span><span class="sxs-lookup"><span data-stu-id="7566f-275">An unresolved condition tree</span></span>                                                                              |



 

<span data-ttu-id="7566f-276">A árvore de condição inicial retornada não é resolvida.</span><span class="sxs-lookup"><span data-stu-id="7566f-276">The initial condition tree that is returned is unresolved.</span></span> <span data-ttu-id="7566f-277">Em uma árvore de condição não resolvida, as referências de data e hora, como `date:yesterday` , não são convertidas em tempo absoluto.</span><span class="sxs-lookup"><span data-stu-id="7566f-277">In an unresolved condition tree, date and time references, such as `date:yesterday`, are not converted to absolute time.</span></span> <span data-ttu-id="7566f-278">Além disso, as propriedades virtuais não são expandidas.</span><span class="sxs-lookup"><span data-stu-id="7566f-278">Also, virtual properties are not expanded.</span></span> <span data-ttu-id="7566f-279">Propriedades virtuais são propriedades que atuam como agregações de várias propriedades.</span><span class="sxs-lookup"><span data-stu-id="7566f-279">Virtual properties are properties that act as aggregates of multiple properties.</span></span>

<span data-ttu-id="7566f-280">Por exemplo, a consulta `kind:email from:reljai` produz as seguintes árvores de condição não resolvidas e resolvidas.</span><span class="sxs-lookup"><span data-stu-id="7566f-280">For example, the query `kind:email from:reljai` produces the following unresolved and resolved condition trees.</span></span> <span data-ttu-id="7566f-281">A árvore de condição não resolvida está à esquerda e a árvore de condição resolvida está à direita.</span><span class="sxs-lookup"><span data-stu-id="7566f-281">The unresolved condition tree is to the left, and the resolved condition tree is to the right.</span></span>

![árvores de condição não resolvidas e resolvidas](images/conditiontree.png)

<span data-ttu-id="7566f-283">A árvore resolvida pode ser obtida chamando [**IConditionFactory:: resolve**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-resolve).</span><span class="sxs-lookup"><span data-stu-id="7566f-283">The resolved tree can be obtained by calling [**IConditionFactory::Resolve**](/windows/desktop/api/Structuredquery/nf-structuredquery-iconditionfactory-resolve).</span></span> <span data-ttu-id="7566f-284">No entanto, passar [**SQRO não \_ \_ resolver \_ DateTime**](/windows/desktop/api/Structuredquery/ne-structuredquery-structured_query_resolve_option) deixa a data e a hora não resolvidas.</span><span class="sxs-lookup"><span data-stu-id="7566f-284">However, passing [**SQRO\_DONT\_RESOLVE\_DATETIME**](/windows/desktop/api/Structuredquery/ne-structuredquery-structured_query_resolve_option) leaves the date and time unresolved.</span></span> <span data-ttu-id="7566f-285">Há vantagens em uma árvore de condição não resolvida, porque uma árvore de condição não resolvida contém informações sobre a consulta.</span><span class="sxs-lookup"><span data-stu-id="7566f-285">There are advantages to an unresolved condition tree, because an unresolved condition tree contains information about the query.</span></span> <span data-ttu-id="7566f-286">Cada nó folha aponta para os tokens retornados por [**IQuerySolution:: GetLexicalData**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getlexicaldata), que correspondem à propriedade, ao operador e ao valor ao usar a interface [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) .</span><span class="sxs-lookup"><span data-stu-id="7566f-286">Each leaf node points to the tokens returned by [**IQuerySolution::GetLexicalData**](/windows/desktop/api/Structuredquery/nf-structuredquery-iquerysolution-getlexicaldata), which correspond to the property, operator, and value when using the [**IRichChunk**](/windows/desktop/api/Structuredquerycondition/nn-structuredquerycondition-irichchunk) interface.</span></span> <span data-ttu-id="7566f-287">O exemplo a seguir mostra...</span><span class="sxs-lookup"><span data-stu-id="7566f-287">The following example shows ...</span></span>


```C++
    interface ITokenCollection : IUnknown
    {
        HRESULT NumberOfTokens(ULONG* pCount);
        HRESULT GetToken([in] ULONG i, [out, annotation("__out_opt")] ULONG* pBegin, [out, annotation("__out_opt")] ULONG* pLength, [out, annotation("__deref_opt_out")] LPWSTR* ppsz);
    };

ICondition:: GetInputTerms([out, annotation("__out_opt")] 
IRichChunk** ppPropertyTerm, [out, annotation("__out_opt")] 
IRichChunk** ppOperationTerm, [out, annotation("__out_opt")] 
IRichChunk** ppValueTerm);

    interface IRichChunk : IUnknown
    {
        HRESULT GetData([out, annotation("__out_opt")] ULONG* pFirstPos, [out, annotation("__out_opt")] ULONG* pLength, [out, annotation("__deref_opt_out")] LPWSTR* ppsz, [out, annotation("__out_opt")] PROPVARIANT* pValue);
    }
```



### <a name="querying-the-index"></a><span data-ttu-id="7566f-288">Consultando o índice</span><span class="sxs-lookup"><span data-stu-id="7566f-288">Querying the Index</span></span>

<span data-ttu-id="7566f-289">Há várias abordagens para consultar o índice.</span><span class="sxs-lookup"><span data-stu-id="7566f-289">There are several approaches to querying the index.</span></span> <span data-ttu-id="7566f-290">Algumas são baseadas no SQL e outras são baseadas em AQS.</span><span class="sxs-lookup"><span data-stu-id="7566f-290">Some are based on the SQL and others are based on AQS.</span></span> <span data-ttu-id="7566f-291">Você também pode consultar o índice do Windows Search programaticamente usando a [consulta de interfaces](./-search-querying-interfaces-entry-page.md).</span><span class="sxs-lookup"><span data-stu-id="7566f-291">You can also query the Windows Search index programmatically by using [querying interfaces](./-search-querying-interfaces-entry-page.md).</span></span> <span data-ttu-id="7566f-292">Há três interfaces que são específicas para consultar o índice: [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper), [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization)e [**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents).</span><span class="sxs-lookup"><span data-stu-id="7566f-292">There are three interfaces that are specific to querying the index: [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper), [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization), and [**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents).</span></span> <span data-ttu-id="7566f-293">Para obter informações conceituais, consulte [consultando o índice programaticamente](-search-3x-wds-qryidx-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7566f-293">For conceptual information, see [Querying the Index Programmatically](-search-3x-wds-qryidx-overview.md).</span></span>

<span data-ttu-id="7566f-294">Você pode desenvolver um componente ou classe auxiliar para consultar o índice usando a interface [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) .</span><span class="sxs-lookup"><span data-stu-id="7566f-294">You can develop a component or helper class to query the index by using the [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) interface.</span></span> <span data-ttu-id="7566f-295">Essa interface é implementada como uma classe auxiliar para [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) (e [**ISearchCatalogManager2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2)) e é obtida chamando [**ISearchCatalogManager:: GetQueryHelper**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getqueryhelper).</span><span class="sxs-lookup"><span data-stu-id="7566f-295">This interface is implemented as a helper class to [**ISearchCatalogManager**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) (and [**ISearchCatalogManager2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2)), and is obtained by calling [**ISearchCatalogManager::GetQueryHelper**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getqueryhelper).</span></span> <span data-ttu-id="7566f-296">Para obter informações conceituais, consulte [consultando o índice com ISearchQueryHelper](-search-3x-wds-qryidx-searchqueryhelper.md).</span><span class="sxs-lookup"><span data-stu-id="7566f-296">For conceptual information, see [Querying the Index with ISearchQueryHelper](-search-3x-wds-qryidx-searchqueryhelper.md).</span></span>

<span data-ttu-id="7566f-297">O [**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) permite que você:</span><span class="sxs-lookup"><span data-stu-id="7566f-297">[**ISearchQueryHelper**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) permits you to:</span></span>

-   <span data-ttu-id="7566f-298">Obtenha uma cadeia de conexão OLE DB para se conectar ao banco de dados de pesquisa do Windows.</span><span class="sxs-lookup"><span data-stu-id="7566f-298">Obtain an OLE DB connection string to connect to the Windows Search database.</span></span>
-   <span data-ttu-id="7566f-299">Converta as consultas de usuário do AQS no SQL do Windows Search.</span><span class="sxs-lookup"><span data-stu-id="7566f-299">Convert AQS user queries to Windows Search SQL.</span></span>
-   <span data-ttu-id="7566f-300">Especifique as restrições de consulta que podem ser expressas em SQL, mas não em AQS.</span><span class="sxs-lookup"><span data-stu-id="7566f-300">Specify query restrictions that can be expressed in SQL but not in AQS.</span></span>

<span data-ttu-id="7566f-301">A priorização de indexação e os eventos de conjunto de linhas têm suporte no Windows 7 e versões posteriores.</span><span class="sxs-lookup"><span data-stu-id="7566f-301">Indexing prioritization and rowset events are supported in Windows 7 and later.</span></span> <span data-ttu-id="7566f-302">Com [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization) , há uma pilha de prioridade que permite que o cliente solicite que os escopos usados em uma determinada consulta sejam maiores que a prioridade normal.</span><span class="sxs-lookup"><span data-stu-id="7566f-302">With [**IRowsetPrioritization**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetprioritization) there is a priority stack that enables the client to request that the scopes used in a particular query be given higher than normal priority.</span></span> <span data-ttu-id="7566f-303">O [**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents) fornece notificação de alterações em itens em conjuntos de linhas, incluindo a adição de novos itens, a exclusão de itens e a modificação de dados do item.</span><span class="sxs-lookup"><span data-stu-id="7566f-303">[**IRowsetEvents**](/windows/desktop/api/Searchapi/nn-searchapi-irowsetevents) provides notification of changes to items in rowsets, including the addition of new items, the deletion of items, and the modification of item data.</span></span> <span data-ttu-id="7566f-304">O uso de notificações de eventos de conjunto de linhas garante que os resultados de consultas existentes sejam os mais atualizados possíveis.</span><span class="sxs-lookup"><span data-stu-id="7566f-304">Using rowset event notifications ensures that the results for existing queries are as up to date as possible.</span></span> <span data-ttu-id="7566f-305">Para obter informações conceituais, consulte [indexando a priorização e eventos de conjunto de linhas no Windows 7](indexing-prioritization-and-rowset-events.md).</span><span class="sxs-lookup"><span data-stu-id="7566f-305">For conceptual information, see [Indexing Prioritization and Rowset Events in Windows 7](indexing-prioritization-and-rowset-events.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="7566f-306">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="7566f-306">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="7566f-307">Indexação, consulta e notificações no Windows Search</span><span class="sxs-lookup"><span data-stu-id="7566f-307">Indexing, Querying and Notifications in Windows Search</span></span>](-search-3x-wds-included-in-index.md)
</dt> <dt>

[<span data-ttu-id="7566f-308">O que está incluído no índice</span><span class="sxs-lookup"><span data-stu-id="7566f-308">What is Included in the Index</span></span>](-search-indexing-process-overview.md)
</dt> <dt>

[<span data-ttu-id="7566f-309">Processo de indexação no Windows Search</span><span class="sxs-lookup"><span data-stu-id="7566f-309">Indexing Process in Windows Search</span></span>](-search-indexing-process-overview.md)
</dt> <dt>

[<span data-ttu-id="7566f-310">Processo de notificações no Windows Search</span><span class="sxs-lookup"><span data-stu-id="7566f-310">Notifications Process in Windows Search</span></span>](-search-3x-wds-support.md)
</dt> <dt>

[<span data-ttu-id="7566f-311">Requisitos de formatação de URL</span><span class="sxs-lookup"><span data-stu-id="7566f-311">URL Formatting Requirements</span></span>](url-formatting-requirements.md)
</dt> </dl>

 

 
