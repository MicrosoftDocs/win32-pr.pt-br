---
description: Os usuários do Windows podem salvar pesquisas como uma pasta de pesquisa que é gerada por um arquivo XML que armazena a consulta em um formulário que pode ser usado pelo subsistema de pesquisa do Windows.
ms.assetid: 1c73e220-a999-4243-879c-ac7310151def
title: Formato de arquivo de pesquisa salvo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d19cf936f78b045814bf7cba31a123c40d61927a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104501470"
---
# <a name="saved-search-file-format"></a><span data-ttu-id="c0768-103">Formato de arquivo de pesquisa salvo</span><span class="sxs-lookup"><span data-stu-id="c0768-103">Saved Search File Format</span></span>

<span data-ttu-id="c0768-104">No Windows Vista e posterior, os usuários podem salvar pesquisas como uma pasta de pesquisa que é gerada por um arquivo XML que armazena a consulta em um formulário que pode ser usado pelo subsistema de pesquisa do Windows.</span><span class="sxs-lookup"><span data-stu-id="c0768-104">In Windows Vista and later, users can save searches as a Search Folder which is generated by an XML file that stores the query in a form that can be used by the Windows search subsystem.</span></span> <span data-ttu-id="c0768-105">Este tópico descreve o formato de arquivo ( \* . Search-MS) e inclui as seguintes seções:</span><span class="sxs-lookup"><span data-stu-id="c0768-105">This topic describes the file format (\*.search-ms) and includes the following sections:</span></span>

- [<span data-ttu-id="c0768-106">Visão geral das pesquisas salvas</span><span class="sxs-lookup"><span data-stu-id="c0768-106">Overview of Saved Searches</span></span>](#overview-of-saved-searches)
- [<span data-ttu-id="c0768-107">\<viewInfo> Elementos</span><span class="sxs-lookup"><span data-stu-id="c0768-107">\<viewInfo> Element</span></span>](/windows)
  - [<span data-ttu-id="c0768-108">\<viewInfo> Atributos</span><span class="sxs-lookup"><span data-stu-id="c0768-108">\<viewInfo> Attributes</span></span>](/windows)
  - [<span data-ttu-id="c0768-109">\<viewInfo> Elementos filho</span><span class="sxs-lookup"><span data-stu-id="c0768-109">\<viewInfo> Child Elements</span></span>](/windows)
- [<span data-ttu-id="c0768-110">\<query> Elementos</span><span class="sxs-lookup"><span data-stu-id="c0768-110">\<query> Element</span></span>](/windows)
  - [<span data-ttu-id="c0768-111">\<query> Elementos filho</span><span class="sxs-lookup"><span data-stu-id="c0768-111">\<query> Child Elements</span></span>](/windows)
- [<span data-ttu-id="c0768-112">\<properties> Elementos</span><span class="sxs-lookup"><span data-stu-id="c0768-112">\<properties> Element</span></span>](/windows)
- [<span data-ttu-id="c0768-113">Especificação completa do formato de arquivo Search-MS</span><span class="sxs-lookup"><span data-stu-id="c0768-113">Full Specification of the search-ms File Format</span></span>](#full-specification-of-the-search-ms-file-format)
- [<span data-ttu-id="c0768-114">Exemplos de pesquisas salvas</span><span class="sxs-lookup"><span data-stu-id="c0768-114">Examples of Saved Searches</span></span>](#examples-of-saved-searches)

## <a name="overview-of-saved-searches"></a><span data-ttu-id="c0768-115">Visão geral das pesquisas salvas</span><span class="sxs-lookup"><span data-stu-id="c0768-115">Overview of Saved Searches</span></span>

<span data-ttu-id="c0768-116">Os usuários podem salvar uma consulta de pesquisa como uma pasta de pesquisa, uma pasta virtual exibida no Windows Explorer na pasta pesquisas.</span><span class="sxs-lookup"><span data-stu-id="c0768-116">Users can save a search query as a Search Folder, a virtual folder displayed in Windows Explorer under the Searches folder.</span></span> <span data-ttu-id="c0768-117">A abertura de uma pasta de pesquisa executa a pesquisa salva e exibe os resultados atualizados.</span><span class="sxs-lookup"><span data-stu-id="c0768-117">Opening a Search Folder runs the saved search and displays up-to-date results.</span></span> <span data-ttu-id="c0768-118">O arquivo de pesquisa salvo armazena a consulta em um formato em que o Windows Search pode agir, especificando o que Pesquisar, onde Pesquisar e como apresentar os resultados.</span><span class="sxs-lookup"><span data-stu-id="c0768-118">The saved search file stores the query in a format Windows Search can act on, specifying what to search for, where to search, and how to present the results.</span></span>

<span data-ttu-id="c0768-119">A pesquisa salva é gerada a partir de um arquivo XML ( \* . Search-MS) na pasta% UserProfile% \\ pesquisas.</span><span class="sxs-lookup"><span data-stu-id="c0768-119">The saved search is generated from an XML file (\*.search-ms) in the %userprofile%\\Searches folder.</span></span> <span data-ttu-id="c0768-120">Os dados são divididos em três elementos principais no arquivo XML:</span><span class="sxs-lookup"><span data-stu-id="c0768-120">The data is divided into three primary elements in the XML file:</span></span>

- <span data-ttu-id="c0768-121">\<viewInfo> Especifica as informações de apresentação</span><span class="sxs-lookup"><span data-stu-id="c0768-121">\<viewInfo> specifies presentation information</span></span>
- <span data-ttu-id="c0768-122">\<query> Especifica (informações de consulta de pesquisa</span><span class="sxs-lookup"><span data-stu-id="c0768-122">\<query> specifies (search query information</span></span>
- <span data-ttu-id="c0768-123">\<properties> Especifica as propriedades do \* arquivo. Search-MS em si</span><span class="sxs-lookup"><span data-stu-id="c0768-123">\<properties> specifies properties of the \*.search-ms file itself</span></span>

<span data-ttu-id="c0768-124">O exemplo a seguir mostra a estrutura de alto nível de um arquivo de pesquisa salvo.</span><span class="sxs-lookup"><span data-stu-id="c0768-124">The following example shows the high-level structure of a saved search file.</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">

    <viewInfo ...>
        ...
    </viewInfo>

    <query>
        ...
    </query>

    <properties>
        ...
    </properties>

</persistedQuery>
```

## <a name="viewinfo-element"></a><span data-ttu-id="c0768-125">Elemento \<viewInfo></span><span class="sxs-lookup"><span data-stu-id="c0768-125">\<viewInfo> Element</span></span>

<span data-ttu-id="c0768-126">O \<viewInfo> elemento especifica como os resultados são apresentados ao usuário final.</span><span class="sxs-lookup"><span data-stu-id="c0768-126">The \<viewInfo> element specifies how the results are presented to the end user.</span></span> <span data-ttu-id="c0768-127">O exemplo a seguir mostra a estrutura do elemento.</span><span class="sxs-lookup"><span data-stu-id="c0768-127">The following example shows the structure of the element.</span></span>

```XML
...
    <viewInfo viewMode=""
              iconSize=""
              stackIconSize=""
              autoListFlags=""
              folderFlags=""
              taskFlags=""
              displayName="">

        <visibleColumns>
            <column viewField=""/>
        </visibleColumns>

        <frequentlyUsedColumns>
            <column viewField= ""/>
        </frequentlyUsedColumns>

        <columnChooserColumns >
            <column viewField=""/>
        </columnChooserColumns >

        <groupBy viewField=""
                 direction=""/>

        <stackList>
            <stack viewField=""/>
        </stackList>

        <sortList>
            <sort viewField=""
                  direction=""/>
        </sortList>
    </viewInfo>
...
```

### <a name="viewinfo-attributes"></a><span data-ttu-id="c0768-128">\<viewInfo> Atributos</span><span class="sxs-lookup"><span data-stu-id="c0768-128">\<viewInfo> Attributes</span></span>

<span data-ttu-id="c0768-129">A tabela a seguir descreve os atributos do elemento \<viewInfo>.</span><span class="sxs-lookup"><span data-stu-id="c0768-129">The following table describes the attributes of the \<viewInfo> element.</span></span>

| <span data-ttu-id="c0768-130">Atributo</span><span class="sxs-lookup"><span data-stu-id="c0768-130">Attribute</span></span>     | <span data-ttu-id="c0768-131">Descrição</span><span class="sxs-lookup"><span data-stu-id="c0768-131">Description</span></span>                                                                     | <span data-ttu-id="c0768-132">Valores</span><span class="sxs-lookup"><span data-stu-id="c0768-132">Values</span></span>                     |
|---------------|---------------------------------------------------------------------------------|----------------------------|
| <span data-ttu-id="c0768-133">viewMode</span><span class="sxs-lookup"><span data-stu-id="c0768-133">viewMode</span></span>      | <span data-ttu-id="c0768-134">Especifica a exibição de pasta.</span><span class="sxs-lookup"><span data-stu-id="c0768-134">Specifies the folder view.</span></span>                                                      | <span data-ttu-id="c0768-135">\|Blocos de ícones de detalhes \|</span><span class="sxs-lookup"><span data-stu-id="c0768-135">Details \| Icons \| Tiles</span></span>  |
| <span data-ttu-id="c0768-136">iconSize</span><span class="sxs-lookup"><span data-stu-id="c0768-136">iconSize</span></span>      | <span data-ttu-id="c0768-137">Controla o tamanho padrão dos ícones e das miniaturas de itens quando não empilhar.</span><span class="sxs-lookup"><span data-stu-id="c0768-137">Controls the default size of the icons and thumbnails for items when not stack.</span></span> | <span data-ttu-id="c0768-138">Inteiro entre 16 e 256</span><span class="sxs-lookup"><span data-stu-id="c0768-138">Integer between 16 and 256</span></span> |
| <span data-ttu-id="c0768-139">stackIconSize</span><span class="sxs-lookup"><span data-stu-id="c0768-139">stackIconSize</span></span> | <span data-ttu-id="c0768-140">Somente para uso interno.</span><span class="sxs-lookup"><span data-stu-id="c0768-140">For internal use only.</span></span> <span data-ttu-id="c0768-141">Não use.</span><span class="sxs-lookup"><span data-stu-id="c0768-141">Do not use.</span></span>                                              | <span data-ttu-id="c0768-142">N/D</span><span class="sxs-lookup"><span data-stu-id="c0768-142">n/a</span></span>                        |
| <span data-ttu-id="c0768-143">displayName</span><span class="sxs-lookup"><span data-stu-id="c0768-143">displayName</span></span>   | <span data-ttu-id="c0768-144">Somente para uso interno.</span><span class="sxs-lookup"><span data-stu-id="c0768-144">For internal use only.</span></span> <span data-ttu-id="c0768-145">Não use.</span><span class="sxs-lookup"><span data-stu-id="c0768-145">Do not use.</span></span>                                              | <span data-ttu-id="c0768-146">N/D</span><span class="sxs-lookup"><span data-stu-id="c0768-146">n/a</span></span>                        |
| <span data-ttu-id="c0768-147">autoListFlags</span><span class="sxs-lookup"><span data-stu-id="c0768-147">autoListFlags</span></span> | <span data-ttu-id="c0768-148">Somente para uso interno.</span><span class="sxs-lookup"><span data-stu-id="c0768-148">For internal use only.</span></span> <span data-ttu-id="c0768-149">Não use.</span><span class="sxs-lookup"><span data-stu-id="c0768-149">Do not use.</span></span>                                              | <span data-ttu-id="c0768-150">N/D</span><span class="sxs-lookup"><span data-stu-id="c0768-150">n/a</span></span>                        |
| <span data-ttu-id="c0768-151">folderFlags</span><span class="sxs-lookup"><span data-stu-id="c0768-151">folderFlags</span></span>   | <span data-ttu-id="c0768-152">Somente para uso interno.</span><span class="sxs-lookup"><span data-stu-id="c0768-152">For internal use only.</span></span> <span data-ttu-id="c0768-153">Não use.</span><span class="sxs-lookup"><span data-stu-id="c0768-153">Do not use.</span></span>                                              | <span data-ttu-id="c0768-154">N/D</span><span class="sxs-lookup"><span data-stu-id="c0768-154">n/a</span></span>                        |
| <span data-ttu-id="c0768-155">taskFlags</span><span class="sxs-lookup"><span data-stu-id="c0768-155">taskFlags</span></span>     | <span data-ttu-id="c0768-156">Somente para uso interno.</span><span class="sxs-lookup"><span data-stu-id="c0768-156">For internal use only.</span></span> <span data-ttu-id="c0768-157">Não use.</span><span class="sxs-lookup"><span data-stu-id="c0768-157">Do not use.</span></span>                                              | <span data-ttu-id="c0768-158">N/D</span><span class="sxs-lookup"><span data-stu-id="c0768-158">n/a</span></span>                        |

### <a name="viewinfo-child-elements"></a><span data-ttu-id="c0768-159">\<viewInfo> Elementos filho</span><span class="sxs-lookup"><span data-stu-id="c0768-159">\<viewInfo> Child Elements</span></span>

<span data-ttu-id="c0768-160">Os elementos filho do \<viewInfo> elemento especificam quais colunas aparecem nos resultados da pesquisa do Windows Explorer e como os resultados são agrupados e classificados.</span><span class="sxs-lookup"><span data-stu-id="c0768-160">The child elements of the \<viewInfo> element specify which columns appear in the Windows Explorer search results and how the results are grouped and sorted.</span></span> <span data-ttu-id="c0768-161">Cada elemento filho contém um conjunto ordenado de colunas, identificado por nomes canônicos das propriedades do sistema (por exemplo, System. DisplayName).</span><span class="sxs-lookup"><span data-stu-id="c0768-161">Each child element contains an ordered set of columns, identified by canonical names of system properties (for example, System.DisplayName).</span></span> <span data-ttu-id="c0768-162">Se não estiver definido no arquivo de pesquisa salvo, os resultados da pesquisa serão apresentados com um conjunto padrão de colunas apropriado para os tipos de arquivo exibidos.</span><span class="sxs-lookup"><span data-stu-id="c0768-162">If not defined in the saved search file, the search results are presented with a default set of columns appropriate for the file types displayed.</span></span>

| <span data-ttu-id="c0768-163">Elemento</span><span class="sxs-lookup"><span data-stu-id="c0768-163">Element</span></span>               | <span data-ttu-id="c0768-164">Descrição</span><span class="sxs-lookup"><span data-stu-id="c0768-164">Description</span></span>                                                                                        | <span data-ttu-id="c0768-165">Valores</span><span class="sxs-lookup"><span data-stu-id="c0768-165">Values</span></span>                                                       |
|-----------------------|----------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
| <span data-ttu-id="c0768-166">visibleColumns</span><span class="sxs-lookup"><span data-stu-id="c0768-166">visibleColumns</span></span>        | <span data-ttu-id="c0768-167">Especifica uma lista ordenada de colunas a serem exibidas na exibição de resultados.</span><span class="sxs-lookup"><span data-stu-id="c0768-167">Specifies an ordered list of columns to appear in the results view.</span></span> <span data-ttu-id="c0768-168">O usuário pode alterar essa lista.</span><span class="sxs-lookup"><span data-stu-id="c0768-168">The user can change this list.</span></span> | <span data-ttu-id="c0768-169">Qualquer Propriedade do sistema.</span><span class="sxs-lookup"><span data-stu-id="c0768-169">Any system property.</span></span>                                         |
| <span data-ttu-id="c0768-170">frequentlyUsedColumns</span><span class="sxs-lookup"><span data-stu-id="c0768-170">frequentlyUsedColumns</span></span> | <span data-ttu-id="c0768-171">Somente para uso interno.</span><span class="sxs-lookup"><span data-stu-id="c0768-171">For internal use only.</span></span> <span data-ttu-id="c0768-172">Não use.</span><span class="sxs-lookup"><span data-stu-id="c0768-172">Do not use.</span></span>                                                                 | <span data-ttu-id="c0768-173">N/D</span><span class="sxs-lookup"><span data-stu-id="c0768-173">n/a</span></span>                                                          |
| <span data-ttu-id="c0768-174">columnChooserColumns</span><span class="sxs-lookup"><span data-stu-id="c0768-174">columnChooserColumns</span></span>  | <span data-ttu-id="c0768-175">Somente para uso interno.</span><span class="sxs-lookup"><span data-stu-id="c0768-175">For internal use only.</span></span> <span data-ttu-id="c0768-176">Não use.</span><span class="sxs-lookup"><span data-stu-id="c0768-176">Do not use.</span></span>                                                                 | <span data-ttu-id="c0768-177">N/D</span><span class="sxs-lookup"><span data-stu-id="c0768-177">n/a</span></span>                                                          |
| <span data-ttu-id="c0768-178">groupBy</span><span class="sxs-lookup"><span data-stu-id="c0768-178">groupBy</span></span>               | <span data-ttu-id="c0768-179">Especifica uma única propriedade do sistema pela qual agrupar os resultados.</span><span class="sxs-lookup"><span data-stu-id="c0768-179">Specifies a single system property by which to group the results.</span></span> <span data-ttu-id="c0768-180">O usuário pode alterar esse valor.</span><span class="sxs-lookup"><span data-stu-id="c0768-180">The user can change this value.</span></span>  | <span data-ttu-id="c0768-181">Qualquer Propriedade do sistema.</span><span class="sxs-lookup"><span data-stu-id="c0768-181">Any system property.</span></span>                                         |
| <span data-ttu-id="c0768-182">modo de classificação</span><span class="sxs-lookup"><span data-stu-id="c0768-182">sortList</span></span>              | <span data-ttu-id="c0768-183">Especifica uma lista ordenada de colunas para classificar os resultados.</span><span class="sxs-lookup"><span data-stu-id="c0768-183">Specifies an ordered list of columns to sort the results by.</span></span>                                       | <span data-ttu-id="c0768-184">Até quatro propriedades do sistema.</span><span class="sxs-lookup"><span data-stu-id="c0768-184">Up to four system properties.</span></span> <span data-ttu-id="c0768-185">O usuário pode alterar essa lista.</span><span class="sxs-lookup"><span data-stu-id="c0768-185">The user can change this list.</span></span> |
| <span data-ttu-id="c0768-186">pilhalist</span><span class="sxs-lookup"><span data-stu-id="c0768-186">stackList</span></span>             | <span data-ttu-id="c0768-187">Somente para uso interno.</span><span class="sxs-lookup"><span data-stu-id="c0768-187">For internal use only.</span></span> <span data-ttu-id="c0768-188">Não use.</span><span class="sxs-lookup"><span data-stu-id="c0768-188">Do not use.</span></span>                                                                 | <span data-ttu-id="c0768-189">N/D</span><span class="sxs-lookup"><span data-stu-id="c0768-189">n/a</span></span>                                                          |

## <a name="query-element"></a><span data-ttu-id="c0768-190">Elemento \<query></span><span class="sxs-lookup"><span data-stu-id="c0768-190">\<query> Element</span></span>

<span data-ttu-id="c0768-191">O \<query> elemento Especifica os atributos que definem como os resultados são consultados.</span><span class="sxs-lookup"><span data-stu-id="c0768-191">The \<query> element specifies the attributes which define how the results are queried.</span></span> <span data-ttu-id="c0768-192">O exemplo a seguir mostra a estrutura do elemento.</span><span class="sxs-lookup"><span data-stu-id="c0768-192">The following example shows the structure of the element.</span></span>

```XML
...
    <query>
        <providers>
            <provider clsid=""/>    <!-- Do not use -->
        </providers>

        <subQueries>
            <subQuery path=""/>           <!-- Do not use -->
            <subQuery knownSearch=""/>    <!-- Do not use -->
        </subQueries>

        <scope>
            <include path=""        nonRecursive=""/>   <!-- [path of location to include] -->
            <include knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
            <exclude path=""        nonRecursive=""/>   <!-- [path of location to exclude] -->
            <exclude knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
        </scope>

        <kindList>
            <kind name=""/>     <!-- Kind value -->
        </kindList>

        <conditions>
            <condition type="" ...>     <!-- andCondition | orCondition | notCondition | leafCondition -->
                <attributes>
                    <attribute attributeID="" .../> <!-- Do not use -->
                </attributes>
            </condition>
        </conditions>
    </query>
...
```

### <a name="query-child-elements"></a><span data-ttu-id="c0768-193">\<query> Elementos filho</span><span class="sxs-lookup"><span data-stu-id="c0768-193">\<query> Child Elements</span></span>

<span data-ttu-id="c0768-194">A tabela a seguir descreve os elementos filho do elemento \<scope>.</span><span class="sxs-lookup"><span data-stu-id="c0768-194">The following table describes the child elements of the \<scope> element.</span></span>

| <span data-ttu-id="c0768-195">Elemento</span><span class="sxs-lookup"><span data-stu-id="c0768-195">Element</span></span>    | <span data-ttu-id="c0768-196">Descrição</span><span class="sxs-lookup"><span data-stu-id="c0768-196">Description</span></span>                                                                                                               | <span data-ttu-id="c0768-197">Valor</span><span class="sxs-lookup"><span data-stu-id="c0768-197">Value</span></span>                                                                                                                                                                                                                                                          |
|------------|---------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="c0768-198">providers</span><span class="sxs-lookup"><span data-stu-id="c0768-198">providers</span></span>  | <span data-ttu-id="c0768-199">Somente para uso interno.</span><span class="sxs-lookup"><span data-stu-id="c0768-199">For internal use only.</span></span> <span data-ttu-id="c0768-200">Não use.</span><span class="sxs-lookup"><span data-stu-id="c0768-200">Do not use.</span></span>                                                                                        | <span data-ttu-id="c0768-201">N/D</span><span class="sxs-lookup"><span data-stu-id="c0768-201">n/a</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="c0768-202">Subconsultas</span><span class="sxs-lookup"><span data-stu-id="c0768-202">subQueries</span></span> | <span data-ttu-id="c0768-203">Somente para uso interno.</span><span class="sxs-lookup"><span data-stu-id="c0768-203">For internal use only.</span></span> <span data-ttu-id="c0768-204">Não use.</span><span class="sxs-lookup"><span data-stu-id="c0768-204">Do not use.</span></span>                                                                                        | <span data-ttu-id="c0768-205">N/D</span><span class="sxs-lookup"><span data-stu-id="c0768-205">n/a</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="c0768-206">Escopo</span><span class="sxs-lookup"><span data-stu-id="c0768-206">Scope</span></span>      | <span data-ttu-id="c0768-207">Identifica os locais a serem incluídos ou excluídos na pesquisa.</span><span class="sxs-lookup"><span data-stu-id="c0768-207">Identifies locations to include or exclude in the search.</span></span>                                                                 | <span data-ttu-id="c0768-208">Um caminho ou uma [ID de pasta conhecida](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid) do local a ser incluído ou excluído.</span><span class="sxs-lookup"><span data-stu-id="c0768-208">Either a path or a [known folder ID](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid) of the location to be included or excluded.</span></span> <span data-ttu-id="c0768-209">Esse elemento também pode especificar se a pesquisa deve incluir/excluir caminhos filho (uma pesquisa superficial ou profunda).</span><span class="sxs-lookup"><span data-stu-id="c0768-209">This element can also specify whether the search should include/exclude child paths (a shallow or deep search).</span></span> |
| <span data-ttu-id="c0768-210">tipo de</span><span class="sxs-lookup"><span data-stu-id="c0768-210">kindList</span></span>   | <span data-ttu-id="c0768-211">Identifica o tipo de arquivo (s) a ser pesquisado.</span><span class="sxs-lookup"><span data-stu-id="c0768-211">Identifies the kind of file(s) to search for.</span></span>                                                                             | <span data-ttu-id="c0768-212">Qualquer valor de System. Kind.</span><span class="sxs-lookup"><span data-stu-id="c0768-212">Any System.Kind value.</span></span>                                                                                                                                                                                                                                         |
| <span data-ttu-id="c0768-213">condições</span><span class="sxs-lookup"><span data-stu-id="c0768-213">conditions</span></span> | <span data-ttu-id="c0768-214">Especifica regras para filtrar resultados.</span><span class="sxs-lookup"><span data-stu-id="c0768-214">Specifies rules for filtering results.</span></span> <span data-ttu-id="c0768-215">Por exemplo, os resultados podem ser limitados a emails enviados por ou a uma pessoa específica.</span><span class="sxs-lookup"><span data-stu-id="c0768-215">For example, results could be limited to emails sent by or to a particular person.</span></span> | <span data-ttu-id="c0768-216">andCondition, orCondition, não Condition, leafCondition.</span><span class="sxs-lookup"><span data-stu-id="c0768-216">andCondition, orCondition, notCondition, leafCondition.</span></span>                                                                                                                                                                                                        |

### <a name="scope-element"></a><span data-ttu-id="c0768-217">Elemento \<scope></span><span class="sxs-lookup"><span data-stu-id="c0768-217">\<scope> Element</span></span>

<span data-ttu-id="c0768-218">O \<scope> elemento identifica os locais a serem incluídos ou excluídos da pesquisa.</span><span class="sxs-lookup"><span data-stu-id="c0768-218">The \<scope> element identifies the locations to include or exclude from the search.</span></span> <span data-ttu-id="c0768-219">O \<scope> elemento deve conter pelo menos um \<include> elemento filho presente e zero ou mais \<exclude> elementos.</span><span class="sxs-lookup"><span data-stu-id="c0768-219">The \<scope> element must contain at least one \<include> child element present and zero or more \<exclude> elements.</span></span> <span data-ttu-id="c0768-220">Os locais podem ser especificados como um caminho (as variáveis de ambiente têm suporte) ou como um [identificador de pasta conhecido](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid).</span><span class="sxs-lookup"><span data-stu-id="c0768-220">The locations can be specified as either a path (environment variables are supported) or as a [known folder identifier](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iknownfolder-getid).</span></span> <span data-ttu-id="c0768-221">Além disso, cada um desses locais pode ser especificado para ser pesquisado em profundidade ou superficial, definindo nonRecursive como "true" ou "false" (o padrão é recursivo).</span><span class="sxs-lookup"><span data-stu-id="c0768-221">Furthermore, each of these locations can be specified to be searched deep or shallow by setting the nonRecursive to "true" or "false" (default is recursive).</span></span> <span data-ttu-id="c0768-222">Partes da lista de locais incluída podem ser excluídas especificando-se elementos de exclusão.</span><span class="sxs-lookup"><span data-stu-id="c0768-222">Parts of the included list of locations can be excluded by specifying exclude elements.</span></span>

<span data-ttu-id="c0768-223">O seguinte mostra um \<scope> elemento que pesquisará a pasta especial documentos, mas não seus filhos, o volume "e:" e seus filhos, mas não o diretório "E: \\ Windows" ou qualquer um de seus filhos:</span><span class="sxs-lookup"><span data-stu-id="c0768-223">The following shows a \<scope> element that will search the documents special folder, but not its children, the "E:" volume and its children, but not "E:\\windows" directory or any of its children:</span></span>

```XML
...
    <query>
        ...
        <scope>
            <include knownFolder="{FDD39AD0-238F-46AF-ADB4-6C85480369C7}" nonRecursive="true"/>
            <include path="E:\"/>
            <exclude path="E:\Windows" nonRecursive="false"/>
        </scope>
        ...
    </query>
...
```

### <a name="kindlist-element"></a><span data-ttu-id="c0768-224">Elemento \<kindList></span><span class="sxs-lookup"><span data-stu-id="c0768-224">\<kindList> Element</span></span>

<span data-ttu-id="c0768-225">Esses elementos definem a União do "tipo" de itens que devem aparecer na biblioteca.</span><span class="sxs-lookup"><span data-stu-id="c0768-225">These elements define the union of the "kind" of items that should appear in the library.</span></span> <span data-ttu-id="c0768-226">Os valores válidos são:</span><span class="sxs-lookup"><span data-stu-id="c0768-226">The valid values are:</span></span>

- <span data-ttu-id="c0768-227">calendário</span><span class="sxs-lookup"><span data-stu-id="c0768-227">calendar</span></span>
- <span data-ttu-id="c0768-228">comunicação</span><span class="sxs-lookup"><span data-stu-id="c0768-228">communication</span></span>
- <span data-ttu-id="c0768-229">contact</span><span class="sxs-lookup"><span data-stu-id="c0768-229">contact</span></span>
- <span data-ttu-id="c0768-230">documento</span><span class="sxs-lookup"><span data-stu-id="c0768-230">document</span></span>
- <span data-ttu-id="c0768-231">email</span><span class="sxs-lookup"><span data-stu-id="c0768-231">email</span></span>
- <span data-ttu-id="c0768-232">feed</span><span class="sxs-lookup"><span data-stu-id="c0768-232">feed</span></span>
- <span data-ttu-id="c0768-233">folder</span><span class="sxs-lookup"><span data-stu-id="c0768-233">folder</span></span>
- <span data-ttu-id="c0768-234">jogo</span><span class="sxs-lookup"><span data-stu-id="c0768-234">game</span></span>
- <span data-ttu-id="c0768-235">instantmessage</span><span class="sxs-lookup"><span data-stu-id="c0768-235">instantmessage</span></span>
- <span data-ttu-id="c0768-236">lança</span><span class="sxs-lookup"><span data-stu-id="c0768-236">journal</span></span>
- <span data-ttu-id="c0768-237">link</span><span class="sxs-lookup"><span data-stu-id="c0768-237">link</span></span>
- <span data-ttu-id="c0768-238">filme</span><span class="sxs-lookup"><span data-stu-id="c0768-238">movie</span></span>
- <span data-ttu-id="c0768-239">music</span><span class="sxs-lookup"><span data-stu-id="c0768-239">music</span></span>
- <span data-ttu-id="c0768-240">observação</span><span class="sxs-lookup"><span data-stu-id="c0768-240">note</span></span>
- <span data-ttu-id="c0768-241">picture</span><span class="sxs-lookup"><span data-stu-id="c0768-241">picture</span></span>
- <span data-ttu-id="c0768-242">programa</span><span class="sxs-lookup"><span data-stu-id="c0768-242">program</span></span>
- <span data-ttu-id="c0768-243">recordedtv</span><span class="sxs-lookup"><span data-stu-id="c0768-243">recordedtv</span></span>
- <span data-ttu-id="c0768-244">searchfolder</span><span class="sxs-lookup"><span data-stu-id="c0768-244">searchfolder</span></span>
- <span data-ttu-id="c0768-245">task</span><span class="sxs-lookup"><span data-stu-id="c0768-245">task</span></span>
- <span data-ttu-id="c0768-246">video</span><span class="sxs-lookup"><span data-stu-id="c0768-246">video</span></span>
- <span data-ttu-id="c0768-247">webhistory</span><span class="sxs-lookup"><span data-stu-id="c0768-247">webhistory</span></span>
- <span data-ttu-id="c0768-248">item</span><span class="sxs-lookup"><span data-stu-id="c0768-248">item</span></span>
- <span data-ttu-id="c0768-249">outros</span><span class="sxs-lookup"><span data-stu-id="c0768-249">other</span></span>

### <a name="conditions-element"></a><span data-ttu-id="c0768-250">Elemento \<conditions></span><span class="sxs-lookup"><span data-stu-id="c0768-250">\<conditions> Element</span></span>

<span data-ttu-id="c0768-251">As condições são filtros nos quais os resultados da pesquisa são comparados.</span><span class="sxs-lookup"><span data-stu-id="c0768-251">Conditions are filters against which search results are compared.</span></span> <span data-ttu-id="c0768-252">Por exemplo, você pode filtrar os resultados que atendem a determinados critérios, como nome do autor ou tamanho do arquivo.</span><span class="sxs-lookup"><span data-stu-id="c0768-252">For example, you can filter results that meet certain criteria, like author name or file size.</span></span> <span data-ttu-id="c0768-253">O conjunto de condições é incorporado em uma árvore de condição única com branches lógicos AND, OR e NOT.</span><span class="sxs-lookup"><span data-stu-id="c0768-253">The set of conditions are built into a single condition tree with logical AND, OR and NOT branches.</span></span>

<span data-ttu-id="c0768-254">O exemplo a seguir mostra a estrutura do \<condition> elemento.</span><span class="sxs-lookup"><span data-stu-id="c0768-254">The following example shows the structure of the \<condition> element.</span></span>

```XML
...
    <query>
        ...
        <conditions>
            <condition type="" ...>
                <attributes>
                    <attribute attributeID="" .../>
                </attributes>
            </condition>
        </conditions>
    </query>
...
```

<span data-ttu-id="c0768-255">O tipo de condição pode ser um dos seguintes:</span><span class="sxs-lookup"><span data-stu-id="c0768-255">The condition type can be one of the following:</span></span>

| <span data-ttu-id="c0768-256">Tipo</span><span class="sxs-lookup"><span data-stu-id="c0768-256">Type</span></span>          | <span data-ttu-id="c0768-257">Descrição</span><span class="sxs-lookup"><span data-stu-id="c0768-257">Description</span></span>                                 | <span data-ttu-id="c0768-258">Atributos disponíveis</span><span class="sxs-lookup"><span data-stu-id="c0768-258">Available Attributes</span></span>                               |
|---------------|---------------------------------------------|----------------------------------------------------|
| <span data-ttu-id="c0768-259">andCondition</span><span class="sxs-lookup"><span data-stu-id="c0768-259">andCondition</span></span>  | <span data-ttu-id="c0768-260">Conjunto de duas ou mais condições filho</span><span class="sxs-lookup"><span data-stu-id="c0768-260">Conjunction of two or more child conditions</span></span> | <span data-ttu-id="c0768-261">N/D</span><span class="sxs-lookup"><span data-stu-id="c0768-261">n/a</span></span>                                                |
| <span data-ttu-id="c0768-262">orCondition</span><span class="sxs-lookup"><span data-stu-id="c0768-262">orCondition</span></span>   | <span data-ttu-id="c0768-263">Disjunção de duas de mais condições filho</span><span class="sxs-lookup"><span data-stu-id="c0768-263">Disjunction of two of more child conditions</span></span> | <span data-ttu-id="c0768-264">N/D</span><span class="sxs-lookup"><span data-stu-id="c0768-264">n/a</span></span>                                                |
| <span data-ttu-id="c0768-265">Não condição</span><span class="sxs-lookup"><span data-stu-id="c0768-265">notCondition</span></span>  | <span data-ttu-id="c0768-266">Negação de uma condição filho</span><span class="sxs-lookup"><span data-stu-id="c0768-266">Negation of a child condition</span></span>               | <span data-ttu-id="c0768-267">N/D</span><span class="sxs-lookup"><span data-stu-id="c0768-267">n/a</span></span>                                                |
| <span data-ttu-id="c0768-268">leafCondition</span><span class="sxs-lookup"><span data-stu-id="c0768-268">leafCondition</span></span> | <span data-ttu-id="c0768-269">Compara uma propriedade com o valor</span><span class="sxs-lookup"><span data-stu-id="c0768-269">Compares a property to value</span></span>                | <span data-ttu-id="c0768-270">Propriedade, propertyType, operador, valor, ValueType</span><span class="sxs-lookup"><span data-stu-id="c0768-270">property, propertyType, operator, value, valuetype</span></span> |

<span data-ttu-id="c0768-271">Os \<leafCondition> atributos do elemento identificam as propriedades e os valores nos quais os resultados são filtrados.</span><span class="sxs-lookup"><span data-stu-id="c0768-271">The \<leafCondition> element's attributes identify the properties and values the results are filtered against.</span></span>

### <a name="example-conditions-element"></a><span data-ttu-id="c0768-272">Exemplo: \<conditions> elemento</span><span class="sxs-lookup"><span data-stu-id="c0768-272">Example: \<conditions> Element</span></span>

<span data-ttu-id="c0768-273">O exemplo a seguir filtra os resultados de todos os itens não lidos criados por João.</span><span class="sxs-lookup"><span data-stu-id="c0768-273">The following example filters results for all unread items authored by John.</span></span> <span data-ttu-id="c0768-274">Ou seja, a propriedade System. IsRead é false e a cadeia de caracteres "John" aparece nas propriedades System. Author ou System. ItemProperty.</span><span class="sxs-lookup"><span data-stu-id="c0768-274">That is, the System.IsRead property is false and the string "john" appears in the System.Author or System.ItemAuthors properties.</span></span>

```XML
...
    <query>
        ...
        <conditions>

            <condition type="andCondition">

                <condition type="leafCondition"
                           property="System.IsRead"
                           operator="eq"
                           value="FALSE"/>

                <condition type="orCondition">

                    <condition type="leafCondition"
                               property="System.Author"
                               propertyType="string"
                               operator="wordmatch"
                               value="John"
                               valueType="System.StructuredQueryType.String"/>

                    <condition type="leafCondition"
                               property="System.ItemAuthors"
                               propertyType="string"
                               operator="wordmatch"
                               value="John"
                               valueType="System.StructuredQueryType.String"/>

                </condition>

            </condition>

        </conditions>

    </query>
...
```

## <a name="properties-element"></a><span data-ttu-id="c0768-275">Elemento \<properties></span><span class="sxs-lookup"><span data-stu-id="c0768-275">\<properties> Element</span></span>

<span data-ttu-id="c0768-276">O \<properties> elemento descreve as propriedades da pesquisa salva em si.</span><span class="sxs-lookup"><span data-stu-id="c0768-276">The \<properties> element describes the properties of the saved search itself.</span></span> <span data-ttu-id="c0768-277">Os arquivos de pesquisa salvos dão suporte a quatro propriedades: \<author> ,, \<kind> \<description> e \<tags> .</span><span class="sxs-lookup"><span data-stu-id="c0768-277">Saved search files support four properties: \<author>, \<kind>, \<description>, and \<tags>.</span></span> <span data-ttu-id="c0768-278">Eles são apenas para uso interno.</span><span class="sxs-lookup"><span data-stu-id="c0768-278">These are for internal use only.</span></span>

## <a name="full-specification-of-the-search-ms-file-format"></a><span data-ttu-id="c0768-279">Especificação completa do formato de arquivo Search-MS</span><span class="sxs-lookup"><span data-stu-id="c0768-279">Full Specification of the search-ms File Format</span></span>

<span data-ttu-id="c0768-280">Veja a seguir um exemplo do XML completo para um arquivo de pesquisa salvo.</span><span class="sxs-lookup"><span data-stu-id="c0768-280">The following is an example of the full XML for a saved search file.</span></span>

```XML
<?xml version="1.0"?>

<persistedQuery version="1.0">

    <!-- The viewInfo section defines how results are displayed to the end user -->
    <viewInfo viewMode=""       <!-- details | icons | tiles -->
              iconSize=""       <!-- Integer -->
              stackIconSize=""  <!-- Do not use -->
              displayName=""    <!-- Do not use -->
              folderFlags=""    <!-- Do not use -->
              taskFlags=""      <!-- Do not use -->
              autoListFlags=""> <!-- Do not use -->

        <visibleColumns>
            <column viewField=""/>  <!-- System.[propertyname] -->
        </visibleColumns>

        <frequentlyUsedColumns>
            <column viewField= ""/> <!-- Do not use -->
        </frequentlyUsedColumns>

        <columnChooserColumns >
            <column viewField=""/>  <!-- Do not use -->
        </columnChooserColumns >

        <groupBy viewField=""       <!-- System.[propertyname] -->
                 direction=""/>     <!-- ascending | descending -->

        <stackList>
            <stack viewField=""/>   <!-- Do not use -->
        </stackList>

        <sortList>
            <sort viewField=""      <!-- System.[propertyname] -->
                  direction=""/>    <!-- ascending | descending -->
        </sortList>
    </viewInfo>

    <!-- The query section defines what gets searched (locations, file kinds) -->
    <query>
        <providers>
            <provider clsid=""/>          <!-- Do not use -->
        </providers>

        <subQueries>
            <subQuery path=""/>           <!-- Do not use -->
            <subQuery knownSearch=""/>    <!-- Do not use -->
        </subQueries>

        <scope>
            <include path=""        nonRecursive=""/>   <!-- [path of location to include] -->
            <include knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
            <exclude path=""        nonRecursive=""/>   <!-- [path of location to exclude] -->
            <exclude knownFolder="" nonRecursive=""/>   <!-- Known folder ID  -->
        </scope>

        <kindList>
            <kind name=""/>     <!-- Kind value -->
        </kindList>

        <conditions>
            <condition type="" ...>     <!-- andCondition | orCondition | notCondition | leafCondition -->
                <attributes>
                    <attribute attributeID="" .../> <!-- Do not use -->
                </attributes>
            </condition>
        </conditions>
    </query>

    <!-- The properties section identifies properties of the saved search file itself. -->
    <properties>
        ...             <!-- Do not use -->
    </properties>

</persistedQuery>
```

## <a name="examples-of-saved-searches"></a><span data-ttu-id="c0768-281">Exemplos de pesquisas salvas</span><span class="sxs-lookup"><span data-stu-id="c0768-281">Examples of Saved Searches</span></span>

<span data-ttu-id="c0768-282">Veja a seguir exemplos de \* arquivos. Search-MS.</span><span class="sxs-lookup"><span data-stu-id="c0768-282">The following are examples of \*.search-ms files.</span></span>

### <a name="recent-documentssearch-ms"></a><span data-ttu-id="c0768-283">Documentos recentes. pesquisa-MS</span><span class="sxs-lookup"><span data-stu-id="c0768-283">Recent Documents.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <sortList>
            <sort viewField="System.DateModified" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="leafCondition" valuetype="System.StructuredQueryType.DateTime" property="System.DateModified" operator="imp" value="R00UUUUUUUUZZXD-30NU" propertyType="wstr" />
        </conditions>
        <kindList>
            <kind name="Document"/>
        </kindList>
        <subQueries>
            <subQuery knownSearch="{4f800859-0bd6-4e63-bbdc-38d3b616ca48}"/>
        </subQueries>
    </query>
</persistedQuery>
```

### <a name="recent-musicsearch-ms"></a><span data-ttu-id="c0768-284">Música recente. pesquisa-MS</span><span class="sxs-lookup"><span data-stu-id="c0768-284">Recent Music.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <sortList>
            <sort viewField="System.DateModified" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="leafCondition" valuetype="System.StructuredQueryType.DateTime" property="System.DateModified" operator="imp" value="R00UUUUUUUUW-1WNNU" propertyType="wstr"/>
        </conditions>
        <kindList>
            <kind name="Music"/>
        </kindList>
        <subQueries>
            <subQuery knownSearch="{4f800859-0bd6-4e63-bbdc-38d3b616ca48}"/>
        </subQueries>
    </query>
</persistedQuery>
```

### <a name="recently-shared-by-mesearch-ms"></a><span data-ttu-id="c0768-285">Compartilhado recentemente por mim. pesquisa-MS</span><span class="sxs-lookup"><span data-stu-id="c0768-285">Recently Shared by Me.search-ms</span></span>

```XML
<?xml version="1.0"?>
<persistedQuery version="1.0">
    <viewInfo viewMode="details" iconSize="16">
        <visibleColumns>
            <column viewField="System.ItemNameDisplay"/>
            <column viewField="System.DateModified"/>
            <column viewField="System.Keywords"/>
            <column viewField="System.SharedWith"/>
            <column viewField="System.ItemFolderPathDisplayNarrow"/>
        </visibleColumns>
        <frequentlyUsedColumns>
            <column viewField="System.Author"/>
            <column viewField="System.Kind"/>
            <column viewField="System.Size"/>
            <column viewField="System.Title"/>
            <column viewField="System.Rating"/>
        </frequentlyUsedColumns>
        <sortList>
            <sort viewField="System.SharedWith" direction="descending"/>
        </sortList>
    </viewInfo>

    <query>
        <conditions>
            <condition type="andCondition">
                <condition type="leafCondition" property="System.IsShared" operator="eq" value="true"/>
                <condition type="leafCondition" property="System.FileOwner" operator="eq" value="[Me]"/>
            </condition>
        </conditions>
        <kindList>
            <kind name="item"/>
        </kindList>
        <scope>
            <include knownFolder="{5E6C858F-0E22-4760-9AFE-EA3317B67173}"/>
            <include knownFolder="{DFDF76A2-C82A-4D63-906A-5644AC457385}"/>
        </scope>
    </query>
</persistedQuery>
```
