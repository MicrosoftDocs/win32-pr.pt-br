---
description: É importante entender a estrutura de DLL necessária de um manipulador de filtro (uma implementação da interface IFilter).
ms.assetid: a2b5a813-573a-44d3-8780-99603e3246c1
title: Implementando manipuladores de filtro no Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bc5f326440b31b62ff5697274962f4d4a2cfe7c1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105791073"
---
# <a name="implementing-filter-handlers-in-windows-search"></a><span data-ttu-id="3f72a-103">Implementando manipuladores de filtro no Windows Search</span><span class="sxs-lookup"><span data-stu-id="3f72a-103">Implementing Filter Handlers in Windows Search</span></span>

<span data-ttu-id="3f72a-104">É importante entender a estrutura de DLL necessária de um manipulador de filtro (uma implementação da interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ).</span><span class="sxs-lookup"><span data-stu-id="3f72a-104">It is important that you understand the required DLL structure of a filter handler (an implementation of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface).</span></span>

<span data-ttu-id="3f72a-105">Este tópico é organizado da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="3f72a-105">This topic is organized as follows:</span></span>

- [<span data-ttu-id="3f72a-106">Implementando e exportando os pontos de entrada da DLL</span><span class="sxs-lookup"><span data-stu-id="3f72a-106">Implementing and Exporting the DLL Entry Points</span></span>](#implementing-and-exporting-the-dll-entry-points)
- [<span data-ttu-id="3f72a-107">Implementando a classe IFilter e a fábrica de classes</span><span class="sxs-lookup"><span data-stu-id="3f72a-107">Implementing the IFilter Class and Class Factory</span></span>](#implementing-the-ifilter-class-and-class-factory)
- [<span data-ttu-id="3f72a-108">Herdando as interfaces COM</span><span class="sxs-lookup"><span data-stu-id="3f72a-108">Inheriting the COM Interfaces</span></span>](#inheriting-the-com-interfaces)
- [<span data-ttu-id="3f72a-109">Implementando os métodos de interface COM</span><span class="sxs-lookup"><span data-stu-id="3f72a-109">Implementing the COM Interface Methods</span></span>](#implementing-the-com-interface-methods)
  - [<span data-ttu-id="3f72a-110">Métodos COM que não são implementados</span><span class="sxs-lookup"><span data-stu-id="3f72a-110">COM Methods that are not Implemented</span></span>](#com-methods-that-are-not-implemented)
- [<span data-ttu-id="3f72a-111">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="3f72a-111">Additional Resources</span></span>](#additional-resources)
- [<span data-ttu-id="3f72a-112">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="3f72a-112">Related topics</span></span>](#related-topics)

## <a name="implementing-and-exporting-the-dll-entry-points"></a><span data-ttu-id="3f72a-113">Implementando e exportando os pontos de entrada da DLL</span><span class="sxs-lookup"><span data-stu-id="3f72a-113">Implementing and Exporting the DLL Entry Points</span></span>

<span data-ttu-id="3f72a-114">Cada DLL do [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) (indicado por Ifilter.dll nesta seção) deve implementar e exportar os seguintes pontos de entrada.</span><span class="sxs-lookup"><span data-stu-id="3f72a-114">Each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL (denoted by Ifilter.dll in this section) must implement and export the following entry points.</span></span> <span data-ttu-id="3f72a-115">Esses pontos de entrada normalmente são exportados usando um arquivo de definição de módulo (. def) para a interface **IFilter** ou usando a palavra-chave **\_ \_ declspec (dllexport)** .</span><span class="sxs-lookup"><span data-stu-id="3f72a-115">These entry points are typically exported using a module-definition (.def) file for the **IFilter** interface or by using the **\_\_declspec(dllexport)** keyword.</span></span> <span data-ttu-id="3f72a-116">O arquivo DLL pode ser registrado para estar em qualquer pasta, mas geralmente reside na pasta% SystemRoot% \\ System32.</span><span class="sxs-lookup"><span data-stu-id="3f72a-116">The DLL file can be registered to be in any folder, but it usually resides in the %SystemRoot%\\system32 folder.</span></span>

<span data-ttu-id="3f72a-117">Os pontos de entrada da DLL são listados e descritos na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="3f72a-117">DLL entry points are listed and described in the following table.</span></span>

| <span data-ttu-id="3f72a-118">Nome da DLL</span><span class="sxs-lookup"><span data-stu-id="3f72a-118">DLL name</span></span>                                                                                     | <span data-ttu-id="3f72a-119">Descrição da DLL</span><span class="sxs-lookup"><span data-stu-id="3f72a-119">DLL description</span></span>                                                                                                                                                                                                                                                                                                                                                                             |
|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="3f72a-120">DllRegisterServer</span><span class="sxs-lookup"><span data-stu-id="3f72a-120">DllRegisterServer</span></span>](/windows/win32/api/olectl/nf-olectl-dllregisterserver)            | <span data-ttu-id="3f72a-121">O ponto de entrada [DllRegisterServer](/windows/win32/api/olectl/nf-olectl-dllregisterserver) registra a dll como um filtro no registro.</span><span class="sxs-lookup"><span data-stu-id="3f72a-121">The [DllRegisterServer](/windows/win32/api/olectl/nf-olectl-dllregisterserver) entry point registers the DLL as a filter in the registry.</span></span> <span data-ttu-id="3f72a-122">Você registra a DLL executando o programa de regsvr32.exe com o nome de arquivo DLL da interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) como um argumento: `regsvr32.exe %SystemRoot%\system32\Ifilter.dll`</span><span class="sxs-lookup"><span data-stu-id="3f72a-122">You register the DLL by running the regsvr32.exe program with the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface DLL file name as an argument: `regsvr32.exe %SystemRoot%\system32\Ifilter.dll`</span></span>                                              |
| [<span data-ttu-id="3f72a-123">Função DllUnregisterServer</span><span class="sxs-lookup"><span data-stu-id="3f72a-123">DllUnregisterServer Function</span></span>](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) | <span data-ttu-id="3f72a-124">O ponto de entrada da [função DllUnregisterServer](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) remove a dll como um manipulador persistente no registro.</span><span class="sxs-lookup"><span data-stu-id="3f72a-124">The [DllUnregisterServer Function](/windows/win32/api/olectl/nf-olectl-dllunregisterserver) entry point removes the DLL as a persistent handler in the registry.</span></span> <span data-ttu-id="3f72a-125">Você cancela o registro da DLL executando o programa regsvr32.exe com o `/u` sinalizador: `regsvr32.exe /u %SystemRoot%\system32\Ifilter.dll`</span><span class="sxs-lookup"><span data-stu-id="3f72a-125">You unregister the DLL by running the regsvr32.exe program with the `/u` flag: `regsvr32.exe /u %SystemRoot%\system32\Ifilter.dll`</span></span>                                                                                    |
| [<span data-ttu-id="3f72a-126">Função DllGetClassObject</span><span class="sxs-lookup"><span data-stu-id="3f72a-126">DllGetClassObject Function</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject)   | <span data-ttu-id="3f72a-127">O cliente de indexação de conteúdo chama o ponto de entrada da [função DllGetClassObject](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) , por meio de Component Object Model (com), para criar um objeto de fábrica de classe para a interface de [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) e obter um ponteiro para a interface de fábrica de classes desse objeto.</span><span class="sxs-lookup"><span data-stu-id="3f72a-127">The content indexing client calls the [DllGetClassObject Function](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) entry point, through Component Object Model (COM), to create a class factory object for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface and to get a pointer to the class factory interface of that object.</span></span>                                               |
| [<span data-ttu-id="3f72a-128">Função DllCanUnloadNow</span><span class="sxs-lookup"><span data-stu-id="3f72a-128">DllCanUnloadNow Function</span></span>](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow)     | <span data-ttu-id="3f72a-129">O cliente de indexação de conteúdo chama o ponto de entrada da [função DllCanUnloadNow](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow) , por meio de com, para determinar se é possível descarregar a DLL do [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)  .</span><span class="sxs-lookup"><span data-stu-id="3f72a-129">The content-indexing client calls the [DllCanUnloadNow Function](/windows/win32/api/combaseapi/nf-combaseapi-dllcanunloadnow) entry point, through COM, to determine whether it is possible to unload the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)  DLL.</span></span> <span data-ttu-id="3f72a-130">A interface **IFilter** é descarregada depois de não ser usada por um intervalo de tempo, conforme especificado pelo valor do registro FilterIdleTimeOut.</span><span class="sxs-lookup"><span data-stu-id="3f72a-130">The **IFilter** interface is unloaded after it is unused for an interval of time, as specified by the FilterIdleTimeOut registry value.</span></span> |

## <a name="implementing-the-ifilter-class-and-class-factory"></a><span data-ttu-id="3f72a-131">Implementando a classe IFilter e a fábrica de classes</span><span class="sxs-lookup"><span data-stu-id="3f72a-131">Implementing the IFilter Class and Class Factory</span></span>

<span data-ttu-id="3f72a-132">Pelo menos duas classes, como CFilter e CFilterCF, normalmente são implementadas por cada DLL do [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="3f72a-132">At least two classes, such as CFilter and CFilterCF, are typically implemented by each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL.</span></span> <span data-ttu-id="3f72a-133">A classe CFilter produz o objeto de interface **IFilter** que implementa a funcionalidade de filtragem de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="3f72a-133">The CFilter class produces the **IFilter** interface object that implements the content-filtering functionality.</span></span> <span data-ttu-id="3f72a-134">Suas funções de membro implementam os métodos de interface da interface **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="3f72a-134">Its member functions implement the interface methods of the **IFilter** interface.</span></span> <span data-ttu-id="3f72a-135">Cada classe **IFilter** requer um identificador de classe exclusivo (CLSID), que o implementador de interface **IFilter** gera.</span><span class="sxs-lookup"><span data-stu-id="3f72a-135">Each **IFilter** class requires a unique class identifier (CLSID), which the **IFilter** interface implementer generates.</span></span>

<span data-ttu-id="3f72a-136">A classe CFilterCF produz o objeto Class-Factory para a interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="3f72a-136">The CFilterCF class produces the class-factory object for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span> <span data-ttu-id="3f72a-137">A fábrica de classes é chamada por meio de sua interface de [interface IClassFactory](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) , pelo ponto de entrada da [função DllGetClassObject](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) da dll.</span><span class="sxs-lookup"><span data-stu-id="3f72a-137">The class factory is called, through its [IClassFactory Interface](/windows/win32/api/unknwn/nn-unknwn-iclassfactory) interface, by the [DllGetClassObject Function](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) entry point of the DLL.</span></span> <span data-ttu-id="3f72a-138">A classe CFilterCF cria o objeto CFilter e retorna um ponteiro para [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="3f72a-138">The CFilterCF class creates the CFilter object and returns a pointer to [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span> <span data-ttu-id="3f72a-139">Em casos mais complexos, um **IFilter** pode implementar uma hierarquia de classe no lugar da única classe CFilter.</span><span class="sxs-lookup"><span data-stu-id="3f72a-139">In more complex cases, an **IFilter** can implement a class hierarchy in place of the single CFilter class.</span></span>

## <a name="inheriting-the-com-interfaces"></a><span data-ttu-id="3f72a-140">Herdando as interfaces COM</span><span class="sxs-lookup"><span data-stu-id="3f72a-140">Inheriting the COM Interfaces</span></span>

<span data-ttu-id="3f72a-141">O Windows Search 3,0 e posterior requer que você use [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) pelos seguintes motivos:</span><span class="sxs-lookup"><span data-stu-id="3f72a-141">Windows Search 3.0 and later require that you use [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) for the following reasons:</span></span>

- <span data-ttu-id="3f72a-142">Para garantir o desempenho e a compatibilidade futura.</span><span class="sxs-lookup"><span data-stu-id="3f72a-142">To ensure performance and future compatibility.</span></span>
- <span data-ttu-id="3f72a-143">Para ajudar a aumentar a segurança.</span><span class="sxs-lookup"><span data-stu-id="3f72a-143">To help increase security.</span></span> <span data-ttu-id="3f72a-144">Os IFilters implementados com [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) são mais seguros porque o contexto no qual a interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) é executada não precisa dos direitos para abrir arquivos no disco ou pela rede.</span><span class="sxs-lookup"><span data-stu-id="3f72a-144">IFilters implemented with [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) are more secure because the context in which the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface runs does not need the rights to open files on the disk or over the network.</span></span>
- <span data-ttu-id="3f72a-145">Embora o Windows Search Use somente [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), a classe de interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) também pode herdar a [interface IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) e/ou implementações de interface de [interface IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) para compatibilidade com versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="3f72a-145">While Windows Search uses only [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface class can also inherit the [IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile) and/or [IPersistStorage Interface](/windows/win32/api/objidl/nn-objidl-ipersiststorage) interface implementations for backward compatibility.</span></span>

<span data-ttu-id="3f72a-146">Essas interfaces são declaradas em arquivos incluídos no \\ diretório Mssdk include e têm IIDs (identificadores de interface predefinidos).</span><span class="sxs-lookup"><span data-stu-id="3f72a-146">These interfaces are declared in files included from the mssdk\\include directory and have pre-defined interface identifiers (IIDs).</span></span> <span data-ttu-id="3f72a-147">O cliente de indexação de conteúdo consulta a interface do [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) por meio de [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) para determinar quais dessas interfaces usar ao filtrar o conteúdo.</span><span class="sxs-lookup"><span data-stu-id="3f72a-147">The content-indexing client queries the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface through [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) to determine which of these interfaces to use when filtering content.</span></span>

## <a name="implementing-the-com-interface-methods"></a><span data-ttu-id="3f72a-148">Implementando os métodos de interface COM</span><span class="sxs-lookup"><span data-stu-id="3f72a-148">Implementing the COM Interface Methods</span></span>

<span data-ttu-id="3f72a-149">A interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) implementa os métodos [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) para a classe de interface **IFilter** e a fábrica de classe de interface **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="3f72a-149">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface implements the [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) methods for both the **IFilter** interface class and the **IFilter** interface-class factory.</span></span> <span data-ttu-id="3f72a-150">A tabela a seguir lista, em ordem vtable, as interfaces específicas da interface do **IFilter** e os métodos que a interface **IFilter** deve implementar.</span><span class="sxs-lookup"><span data-stu-id="3f72a-150">The following table lists, in vtable order, the **IFilter** interface-specific interfaces and methods that the **IFilter** interface should implement.</span></span> <span data-ttu-id="3f72a-151">A interface **IFilter** deve implementar pelo menos [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), mas pode implementar interfaces derivadas de IPersist adicionais.</span><span class="sxs-lookup"><span data-stu-id="3f72a-151">The **IFilter** interface must implement at least [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), but can implement additional IPersist-derived interfaces.</span></span>

| <span data-ttu-id="3f72a-152">Interface COM</span><span class="sxs-lookup"><span data-stu-id="3f72a-152">COM interface</span></span>                                                                             | <span data-ttu-id="3f72a-153">Método</span><span class="sxs-lookup"><span data-stu-id="3f72a-153">Method</span></span>                                                                                                                                                                                                                                                                         |
|-------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="3f72a-154">Interface IClassFactory</span><span class="sxs-lookup"><span data-stu-id="3f72a-154">IClassFactory Interface</span></span>](/windows/win32/api/unknwn/nn-unknwn-iclassfactory)   | <span data-ttu-id="3f72a-155">CreateInstance, LockServer</span><span class="sxs-lookup"><span data-stu-id="3f72a-155">CreateInstance, LockServer</span></span>                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="3f72a-156">Interface IClassFactory2</span><span class="sxs-lookup"><span data-stu-id="3f72a-156">IClassFactory2 Interface</span></span>](/windows/win32/api/ocidl/nn-ocidl-iclassfactory2)  | <span data-ttu-id="3f72a-157">GetLicInfo, RequestLicKey, CreateInstanceLic</span><span class="sxs-lookup"><span data-stu-id="3f72a-157">GetLicInfo, RequestLicKey, CreateInstanceLic</span></span>                                                                                                                                                                                                                                   |
| [<span data-ttu-id="3f72a-158">**Visio**</span><span class="sxs-lookup"><span data-stu-id="3f72a-158">**IFilter**</span></span>](/windows/win32/api/filter/nn-filter-ifilter)                                                        | <span data-ttu-id="3f72a-159">[**IFilter:: init**](/windows/win32/api/filter/nf-filter-ifilter-init), [**IFilter:: GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**IFilter:: gettext**](/windows/win32/api/filter/nf-filter-ifilter-gettext), [**IFilter:: GetValue**](/windows/win32/api/filter/nf-filter-ifilter-getvalue), [**IFilter:: BindRegion**](/windows/win32/api/filter/nf-filter-ifilter-bindregion)</span><span class="sxs-lookup"><span data-stu-id="3f72a-159">[**IFilter::Init**](/windows/win32/api/filter/nf-filter-ifilter-init), [**IFilter::GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**IFilter::GetText**](/windows/win32/api/filter/nf-filter-ifilter-gettext), [**IFilter::GetValue**](/windows/win32/api/filter/nf-filter-ifilter-getvalue), [**IFilter::BindRegion**](/windows/win32/api/filter/nf-filter-ifilter-bindregion)</span></span> |
| [<span data-ttu-id="3f72a-160">Interface IPersist</span><span class="sxs-lookup"><span data-stu-id="3f72a-160">IPersist Interface</span></span>](/windows/desktop/api/objidl/nn-objidl-ipersist)               | <span data-ttu-id="3f72a-161">GetClassID</span><span class="sxs-lookup"><span data-stu-id="3f72a-161">GetClassID</span></span>                                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="3f72a-162">Interface IPersistFile</span><span class="sxs-lookup"><span data-stu-id="3f72a-162">IPersistFile Interface</span></span>](/windows/win32/api/objidl/nn-objidl-ipersistfile)    | <span data-ttu-id="3f72a-163">IsDirty, carregar, salvar, SaveCompleted, GetCurFile</span><span class="sxs-lookup"><span data-stu-id="3f72a-163">IsDirty, Load, Save, SaveCompleted, GetCurFile</span></span>                                                                                                                                                                                                                                 |
| [<span data-ttu-id="3f72a-164">Interface IPersistStorage</span><span class="sxs-lookup"><span data-stu-id="3f72a-164">IPersistStorage Interface</span></span>](/windows/win32/api/objidl/nn-objidl-ipersiststorage) | <span data-ttu-id="3f72a-165">IsDirty, carregar, salvar, GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="3f72a-165">IsDirty, Load, Save, GetSizeMax</span></span>                                                                                                                                                                                                                                                |
| [<span data-ttu-id="3f72a-166">IPersistStream</span><span class="sxs-lookup"><span data-stu-id="3f72a-166">IPersistStream</span></span>](/windows/win32/api/objidl/nn-objidl-ipersiststream)            | <span data-ttu-id="3f72a-167">IsDirty, carregar, salvar, GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="3f72a-167">IsDirty, Load, Save, GetSizeMax</span></span>                                                                                                                                                                                                                                                |

<span data-ttu-id="3f72a-168">A página de referência para cada método especifica os parâmetros e o comportamento funcional para esse método.</span><span class="sxs-lookup"><span data-stu-id="3f72a-168">The reference page for each method specifies the parameters and functional behavior for that method.</span></span> <span data-ttu-id="3f72a-169">Cada página de referência também fornece os códigos de resultado a serem implementados para esse método.</span><span class="sxs-lookup"><span data-stu-id="3f72a-169">Each reference page also gives the result codes to implement for that method.</span></span> <span data-ttu-id="3f72a-170">As páginas de referência para os métodos [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) fornecem os códigos específicos à interface [em recursos do \_ ITF](../com/codes-in-facility-itf.md) de resultados a serem implementados, e o cliente de indexação de conteúdo também pode lidar com qualquer um dos códigos de resultado genéricos, como o recurso de instalação \_ nula e do \_ Win32.</span><span class="sxs-lookup"><span data-stu-id="3f72a-170">The reference pages for the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) methods give the interface-specific [Codes in FACILITY\_ITF](../com/codes-in-facility-itf.md) result codes to be implemented, and the content-indexing client can also handle any of the generic result codes, such as FACILITY\_NULL and FACILITY\_WIN32.</span></span> <span data-ttu-id="3f72a-171">Para obter mais informações, consulte [estrutura de códigos de erro com](../com/structure-of-com-error-codes.md).</span><span class="sxs-lookup"><span data-stu-id="3f72a-171">For more information, see [Structure of COM Error Codes](../com/structure-of-com-error-codes.md).</span></span>

### <a name="com-methods-that-are-not-implemented"></a><span data-ttu-id="3f72a-172">Métodos COM que não são implementados</span><span class="sxs-lookup"><span data-stu-id="3f72a-172">COM Methods that are not Implemented</span></span>

<span data-ttu-id="3f72a-173">A interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) deve implementar pelo menos [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), mas não precisa implementar interfaces derivadas IPersist adicionais.</span><span class="sxs-lookup"><span data-stu-id="3f72a-173">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface must implement at least [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream), but does not need to implement additional IPersist-derived interfaces.</span></span>

<span data-ttu-id="3f72a-174">O Windows Search não precisa implementar os métodos COM listados na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="3f72a-174">Windows Search does not need to implement the COM methods listed in the following table.</span></span>

| <span data-ttu-id="3f72a-175">Método que não é necessário</span><span class="sxs-lookup"><span data-stu-id="3f72a-175">Method that is not required</span></span>                               | <span data-ttu-id="3f72a-176">Description</span><span class="sxs-lookup"><span data-stu-id="3f72a-176">Description</span></span>                       |
|-----------------------------------------------------------|-----------------------------------|
| <span data-ttu-id="3f72a-177">IPersistStream:: IsDirty</span><span class="sxs-lookup"><span data-stu-id="3f72a-177">IPersistStream::IsDirty</span></span>                                   | <span data-ttu-id="3f72a-178">Os filtros devem retornar E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="3f72a-178">Filters should return E\_NOTIMPL.</span></span> |
| <span data-ttu-id="3f72a-179">IPersistStream:: Save</span><span class="sxs-lookup"><span data-stu-id="3f72a-179">IPersistStream::Save</span></span>                                      | <span data-ttu-id="3f72a-180">Os filtros devem retornar E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="3f72a-180">Filters should return E\_NOTIMPL.</span></span> |
| <span data-ttu-id="3f72a-181">IPersistStream:: GetSizeMax</span><span class="sxs-lookup"><span data-stu-id="3f72a-181">IPersistStream::GetSizeMax</span></span>                                | <span data-ttu-id="3f72a-182">Os filtros devem retornar E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="3f72a-182">Filters should return E\_NOTIMPL.</span></span> |
| [<span data-ttu-id="3f72a-183">**IFilter:: BindRegion**</span><span class="sxs-lookup"><span data-stu-id="3f72a-183">**IFilter::BindRegion**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-bindregion) | <span data-ttu-id="3f72a-184">Os filtros devem retornar E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="3f72a-184">Filters should return E\_NOTIMPL.</span></span> |

## <a name="additional-resources"></a><span data-ttu-id="3f72a-185">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="3f72a-185">Additional Resources</span></span>

- <span data-ttu-id="3f72a-186">O exemplo de código [IFilterSample](-search-sample-ifiltersample.md) , disponível no [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), demonstra como criar uma classe base IFilter para implementar a interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="3f72a-186">The [IFilterSample](-search-sample-ifiltersample.md) code sample, available on [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample), demonstrates how to create an IFilter base class for implementing the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span>
- <span data-ttu-id="3f72a-187">Para obter uma visão geral do processo de indexação, consulte [o processo de indexação](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="3f72a-187">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span>
- <span data-ttu-id="3f72a-188">Para obter uma visão geral dos tipos de arquivo, consulte [tipos de arquivo](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="3f72a-188">For an overview of file types, see [File Types](../shell/fa-file-types.md).</span></span>
- <span data-ttu-id="3f72a-189">Para consultar atributos de associação de arquivo para um tipo de arquivo, consulte [PerceivedTypes, SystemFileAssociations e registro de aplicativo](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="3f72a-189">To query file association attributes for a file type, see [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="3f72a-190">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="3f72a-190">Related topics</span></span>

[<span data-ttu-id="3f72a-191">Desenvolvendo manipuladores de filtro</span><span class="sxs-lookup"><span data-stu-id="3f72a-191">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)

[<span data-ttu-id="3f72a-192">Noções básicas sobre manipuladores de filtro no Windows Search</span><span class="sxs-lookup"><span data-stu-id="3f72a-192">Understanding Filter Handlers in Windows Search</span></span>](-search-ifilter-about.md)

[<span data-ttu-id="3f72a-193">Práticas recomendadas para a criação de manipuladores de filtro no Windows Search</span><span class="sxs-lookup"><span data-stu-id="3f72a-193">Best Practices for Creating Filter Handlers in Windows Search</span></span>](-search-3x-wds-extidx-filters.md)

[<span data-ttu-id="3f72a-194">Retornando Propriedades de um manipulador de filtro</span><span class="sxs-lookup"><span data-stu-id="3f72a-194">Returning Properties from a Filter Handler</span></span>](-search-ifilter-property-filtering.md)

[<span data-ttu-id="3f72a-195">Manipuladores de filtro que acompanham o Windows</span><span class="sxs-lookup"><span data-stu-id="3f72a-195">Filter Handlers that Ship with Windows</span></span>](-search-ifilter-implementations.md)

[<span data-ttu-id="3f72a-196">Registrando manipuladores de filtro</span><span class="sxs-lookup"><span data-stu-id="3f72a-196">Registering Filter Handlers</span></span>](-search-ifilter-registering-filters.md)

[<span data-ttu-id="3f72a-197">Testando manipuladores de filtro</span><span class="sxs-lookup"><span data-stu-id="3f72a-197">Testing Filter Handlers</span></span>](-search-ifilter-testing-filters.md)
