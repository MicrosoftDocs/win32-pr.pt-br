---
description: Manipuladores de filtro, que são implementações da interface IFilter, digitalizam documentos para texto e propriedades.
ms.assetid: 2ee9ea19-ae03-4f14-8f06-f8aa670e204e
title: Noções básicas sobre manipuladores de filtro no Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e49cc1d3e479ae03645665618c60a33bdcfe19ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104501478"
---
# <a name="understanding-filter-handlers-in-windows-search"></a><span data-ttu-id="2cccb-103">Noções básicas sobre manipuladores de filtro no Windows Search</span><span class="sxs-lookup"><span data-stu-id="2cccb-103">Understanding Filter Handlers in Windows Search</span></span>

<span data-ttu-id="2cccb-104">Manipuladores de filtro, que são implementações da interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) , digitalizam documentos para texto e propriedades.</span><span class="sxs-lookup"><span data-stu-id="2cccb-104">Filter handlers, which are implementations of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface, scan documents for text and properties.</span></span> <span data-ttu-id="2cccb-105">Os manipuladores de filtro extraem partes de texto desses itens, filtrando a formatação inserida e mantendo as informações sobre a posição do texto.</span><span class="sxs-lookup"><span data-stu-id="2cccb-105">Filter handlers extract chunks of text from these items, filtering out embedded formatting and retaining information about the position of the text.</span></span> <span data-ttu-id="2cccb-106">Eles também extraem partes de valores, que são propriedades do documento.</span><span class="sxs-lookup"><span data-stu-id="2cccb-106">They also extract chunks of values, which are document properties.</span></span> <span data-ttu-id="2cccb-107">O **IFilter** é a base para a criação de aplicativos de nível superior, como indexadores de documentos e visualizadores independentes de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="2cccb-107">**IFilter** is the foundation for building higher-level applications such as document indexers and application-independent viewers.</span></span>

<span data-ttu-id="2cccb-108">Este tópico é organizado da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="2cccb-108">This topic is organized as follows:</span></span>

- [<span data-ttu-id="2cccb-109">Sobre a interface do IFilter</span><span class="sxs-lookup"><span data-stu-id="2cccb-109">About the IFilter Interface</span></span>](#about-the-ifilter-interface)
  - [<span data-ttu-id="2cccb-110">Processo de isolamento</span><span class="sxs-lookup"><span data-stu-id="2cccb-110">Isolation Process</span></span>](#isolation-process)
  - [<span data-ttu-id="2cccb-111">DLLs de IFilter</span><span class="sxs-lookup"><span data-stu-id="2cccb-111">IFilter DLLs</span></span>](#ifilter-dlls)
  - [<span data-ttu-id="2cccb-112">Estrutura do IFilter</span><span class="sxs-lookup"><span data-stu-id="2cccb-112">IFilter Structure</span></span>](#ifilter-structure)
  - [<span data-ttu-id="2cccb-113">Código nativo</span><span class="sxs-lookup"><span data-stu-id="2cccb-113">Native Code</span></span>](#native-code)
- [<span data-ttu-id="2cccb-114">Encontrando o identificador de classe IFilter</span><span class="sxs-lookup"><span data-stu-id="2cccb-114">Finding the IFilter Class Identifier</span></span>](#finding-the-ifilter-class-identifier)
  - [<span data-ttu-id="2cccb-115">Identificadores de código IFilter:: GetChunk e locale</span><span class="sxs-lookup"><span data-stu-id="2cccb-115">IFilter::GetChunk and Locale Code Identifiers</span></span>](#ifiltergetchunk-and-locale-code-identifiers)
- [<span data-ttu-id="2cccb-116">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="2cccb-116">Additional Resources</span></span>](#additional-resources)
- [<span data-ttu-id="2cccb-117">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="2cccb-117">Related topics</span></span>](#related-topics)

## <a name="about-the-ifilter-interface"></a><span data-ttu-id="2cccb-118">Sobre a interface do IFilter</span><span class="sxs-lookup"><span data-stu-id="2cccb-118">About the IFilter Interface</span></span>

<span data-ttu-id="2cccb-119">O Microsoft Windows Search usa filtros para extrair o conteúdo de itens para inclusão em um índice de texto completo.</span><span class="sxs-lookup"><span data-stu-id="2cccb-119">Microsoft Windows Search uses filters to extract the content of items for inclusion in a full-text index.</span></span> <span data-ttu-id="2cccb-120">Você pode estender o Windows Search para indexar tipos de arquivo novos ou proprietários escrevendo filtros para extrair o conteúdo e os manipuladores de propriedade para extrair as propriedades dos arquivos.</span><span class="sxs-lookup"><span data-stu-id="2cccb-120">You can extend Windows Search to index new or proprietary file types by writing filters to extract the content, and property handlers to extract the properties of files.</span></span>

<span data-ttu-id="2cccb-121">A interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) foi projetada para atender às necessidades específicas de mecanismos de pesquisa de texto completo.</span><span class="sxs-lookup"><span data-stu-id="2cccb-121">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface is designed to meet the specific needs of full-text search engines.</span></span> <span data-ttu-id="2cccb-122">Os mecanismos de pesquisa de texto completo, como o Windows Search, chamam os métodos **IFilter** para extrair informações de texto e propriedade e adicioná-las a um índice.</span><span class="sxs-lookup"><span data-stu-id="2cccb-122">Full-text search engines like Windows Search call the **IFilter** methods to extract text and property information and add them to an index.</span></span> <span data-ttu-id="2cccb-123">O Windows Search interrompe os resultados do método [**IFilter:: gettext**](/windows/win32/api/filter/nf-filter-ifilter-gettext) retornado em palavras, normaliza-os e salva-os em um índice.</span><span class="sxs-lookup"><span data-stu-id="2cccb-123">Windows Search breaks the results of the returned [**IFilter::GetText**](/windows/win32/api/filter/nf-filter-ifilter-gettext) method into words, normalizes them, and saves them in an index.</span></span> <span data-ttu-id="2cccb-124">Se estiver disponível, o mecanismo de pesquisa usará o LCID (identificador de código de idioma) de uma parte de texto para executar a quebra e a normalização de palavras específicas ao idioma.</span><span class="sxs-lookup"><span data-stu-id="2cccb-124">If available, the search engine uses the language code identifier (LCID) of a text chunk to perform language-specific word breaking and normalization.</span></span>

<span data-ttu-id="2cccb-125">O Windows Search usa três funções, descritas na tabela a seguir, para acessar manipuladores de filtro registrados (implementações da interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) ).</span><span class="sxs-lookup"><span data-stu-id="2cccb-125">Windows Search uses three functions, described in the following table, to access registered filter handlers (implementations of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface).</span></span> <span data-ttu-id="2cccb-126">Essas funções são especialmente úteis ao carregar e associar ao manipulador de filtro de um objeto incorporado.</span><span class="sxs-lookup"><span data-stu-id="2cccb-126">These functions are especially useful when loading and binding to an embedded object's filter handler.</span></span>

| <span data-ttu-id="2cccb-127">Função</span><span class="sxs-lookup"><span data-stu-id="2cccb-127">Function</span></span>               | <span data-ttu-id="2cccb-128">Descrição</span><span class="sxs-lookup"><span data-stu-id="2cccb-128">Description</span></span>                                                                                                                                                                                               |
|------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="2cccb-129">Loadifilter</span><span class="sxs-lookup"><span data-stu-id="2cccb-129">LoadIFilter</span></span>            | <span data-ttu-id="2cccb-130">Obtém um ponteiro para o [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) que é mais adequado para o tipo de conteúdo especificado.</span><span class="sxs-lookup"><span data-stu-id="2cccb-130">Gets a pointer to the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) that is most suitable for the specified content type.</span></span>                                                                                            |
| <span data-ttu-id="2cccb-131">BindIFilterFromStorage</span><span class="sxs-lookup"><span data-stu-id="2cccb-131">BindIFilterFromStorage</span></span> | <span data-ttu-id="2cccb-132">Obtém um ponteiro para o [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) que é mais adequado para o conteúdo contido em um objeto de [interface IStorage](/windows/win32/api/objidl/nn-objidl-istorage) .</span><span class="sxs-lookup"><span data-stu-id="2cccb-132">Gets a pointer to the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) that is most suitable for the content contained in an [IStorage Interface](/windows/win32/api/objidl/nn-objidl-istorage) object.</span></span> |
| <span data-ttu-id="2cccb-133">BindIFilterFromStream</span><span class="sxs-lookup"><span data-stu-id="2cccb-133">BindIFilterFromStream</span></span>  | <span data-ttu-id="2cccb-134">Obtém um ponteiro para o [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) que é mais adequado para um identificador de classe especificado (CLSID) recuperado de uma variável de fluxo.</span><span class="sxs-lookup"><span data-stu-id="2cccb-134">Gets a pointer to the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) that is most suitable for a specified class identifier (CLSID) retrieved from a stream variable.</span></span>                                                 |

<span data-ttu-id="2cccb-135">A interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) tem cinco métodos, descritos na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="2cccb-135">The [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface has five methods, described in the following table.</span></span>

| <span data-ttu-id="2cccb-136">Método</span><span class="sxs-lookup"><span data-stu-id="2cccb-136">Method</span></span>                                                    | <span data-ttu-id="2cccb-137">Descrição</span><span class="sxs-lookup"><span data-stu-id="2cccb-137">Description</span></span>                                                                                                        |
|-----------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="2cccb-138">**IFilter:: init**</span><span class="sxs-lookup"><span data-stu-id="2cccb-138">**IFilter::Init**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-init)          | <span data-ttu-id="2cccb-139">Inicializa uma sessão de filtragem.</span><span class="sxs-lookup"><span data-stu-id="2cccb-139">Initializes a filtering session.</span></span>                                                                                   |
| [<span data-ttu-id="2cccb-140">**IFilter:: GetChunk**</span><span class="sxs-lookup"><span data-stu-id="2cccb-140">**IFilter::GetChunk**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-getchunk)     | <span data-ttu-id="2cccb-141">Posiciona o [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) no início da primeira ou da próxima parte e retorna um descritor.</span><span class="sxs-lookup"><span data-stu-id="2cccb-141">Positions [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) at the beginning of the first or next chunk and returns a descriptor.</span></span> |
| [<span data-ttu-id="2cccb-142">**IFilter:: gettext**</span><span class="sxs-lookup"><span data-stu-id="2cccb-142">**IFilter::GetText**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-gettext)       | <span data-ttu-id="2cccb-143">Recupera o texto da parte atual.</span><span class="sxs-lookup"><span data-stu-id="2cccb-143">Retrieves text from the current chunk.</span></span>                                                                             |
| [<span data-ttu-id="2cccb-144">**IFilter:: GetValue**</span><span class="sxs-lookup"><span data-stu-id="2cccb-144">**IFilter::GetValue**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-getvalue)     | <span data-ttu-id="2cccb-145">Recupera valores da parte atual.</span><span class="sxs-lookup"><span data-stu-id="2cccb-145">Retrieves values from the current chunk.</span></span>                                                                           |
| [<span data-ttu-id="2cccb-146">**IFilter:: BindRegion**</span><span class="sxs-lookup"><span data-stu-id="2cccb-146">**IFilter::BindRegion**</span></span>](/windows/win32/api/filter/nf-filter-ifilter-bindregion) | <span data-ttu-id="2cccb-147">Recupera uma interface que representa a parte especificada do objeto.</span><span class="sxs-lookup"><span data-stu-id="2cccb-147">Retrieves an interface representing the specified portion of object.</span></span> <span data-ttu-id="2cccb-148">Reservado para uso futuro.</span><span class="sxs-lookup"><span data-stu-id="2cccb-148">Reserved for future use.</span></span>                      |

### <a name="isolation-process"></a><span data-ttu-id="2cccb-149">Processo de isolamento</span><span class="sxs-lookup"><span data-stu-id="2cccb-149">Isolation Process</span></span>

<span data-ttu-id="2cccb-150">O Windows Search executa IFilters no contexto de segurança do sistema local com direitos restritos.</span><span class="sxs-lookup"><span data-stu-id="2cccb-150">Windows Search runs IFilters in the Local System security context with restricted rights.</span></span> <span data-ttu-id="2cccb-151">Nesse processo de isolamento do host do [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) , vários direitos são removidos:</span><span class="sxs-lookup"><span data-stu-id="2cccb-151">In this [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) host isolation process, a number of rights are removed:</span></span>

- <span data-ttu-id="2cccb-152">Código restrito</span><span class="sxs-lookup"><span data-stu-id="2cccb-152">Restricted Code</span></span>
- <span data-ttu-id="2cccb-153">Todos</span><span class="sxs-lookup"><span data-stu-id="2cccb-153">Everyone</span></span>
- <span data-ttu-id="2cccb-154">Local</span><span class="sxs-lookup"><span data-stu-id="2cccb-154">Local</span></span>
- <span data-ttu-id="2cccb-155">Interativo</span><span class="sxs-lookup"><span data-stu-id="2cccb-155">Interactive</span></span>
- <span data-ttu-id="2cccb-156">Usuários Autenticados</span><span class="sxs-lookup"><span data-stu-id="2cccb-156">Authenticated Users</span></span>
- <span data-ttu-id="2cccb-157">Usuários internos</span><span class="sxs-lookup"><span data-stu-id="2cccb-157">Built-in Users</span></span>
- <span data-ttu-id="2cccb-158">SID (identificador de segurança) dos usuários</span><span class="sxs-lookup"><span data-stu-id="2cccb-158">Users' security identifier (SID)</span></span>

<span data-ttu-id="2cccb-159">A remoção desses direitos significa que a interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) não tem acesso ao sistema de disco ou à rede ou a nenhuma interface do usuário ou funções da área de transferência.</span><span class="sxs-lookup"><span data-stu-id="2cccb-159">The removal of these rights means the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface does not have access to the disk system or network or to any user interface or clipboard functions.</span></span> <span data-ttu-id="2cccb-160">Além disso, o processo de isolamento é executado em um objeto de trabalho que impede que processos filho sejam criados e impõe um limite de 100 MB no conjunto de trabalho.</span><span class="sxs-lookup"><span data-stu-id="2cccb-160">Furthermore, the isolation process runs under a job object that prevents child processes from being created and imposes a 100 MB limit on the working set.</span></span> <span data-ttu-id="2cccb-161">o processo de isolamento de host da interface do **IFilter** aumenta a estabilidade da plataforma de indexação, devido à possibilidade de filtros de terceiros implementados incorretamente.</span><span class="sxs-lookup"><span data-stu-id="2cccb-161">the **IFilter** interface host isolation process increases the stability of the indexing platform, due to the possibility of incorrectly implemented third-party filters.</span></span>

> [!NOTE]  
> <span data-ttu-id="2cccb-162">Os manipuladores de filtro devem ser gravados para gerenciar buffers e empilhar corretamente.</span><span class="sxs-lookup"><span data-stu-id="2cccb-162">Filter handlers must be written to manage buffers, and stack correctly.</span></span> <span data-ttu-id="2cccb-163">Todas as cópias de cadeia de caracteres devem ter verificações explícitas para proteção contra estouros de buffer.</span><span class="sxs-lookup"><span data-stu-id="2cccb-163">All string copies must have explicit checks to guard against buffer overruns.</span></span> <span data-ttu-id="2cccb-164">Você sempre deve verificar o tamanho alocado do buffer.</span><span class="sxs-lookup"><span data-stu-id="2cccb-164">You should always verify the allocated size of the buffer.</span></span> <span data-ttu-id="2cccb-165">Você deve sempre testar o tamanho dos dados em relação ao tamanho do buffer.</span><span class="sxs-lookup"><span data-stu-id="2cccb-165">You should always test the size of the data against the size of the buffer.</span></span>

### <a name="ifilter-dlls"></a><span data-ttu-id="2cccb-166">DLLs de IFilter</span><span class="sxs-lookup"><span data-stu-id="2cccb-166">IFilter DLLs</span></span>

<span data-ttu-id="2cccb-167">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) As DLLs implementam a interface **IFilter** para permitir que um cliente extraia informações de valor de texto e propriedade de um tipo de arquivo, classe ou tipo percebido.</span><span class="sxs-lookup"><span data-stu-id="2cccb-167">[**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLLs implement the **IFilter** interface to enable a client to extract text and property value information from a file type, class, or perceived type.</span></span> <span data-ttu-id="2cccb-168">O processo de filtragem da pesquisa do Windows **SearchFilterHost.exe** é associado ao **IFilter** registrado para a classe, o tipo percebido ou a extensão de nome do item.</span><span class="sxs-lookup"><span data-stu-id="2cccb-168">The Windows Search filtering process **SearchFilterHost.exe** binds to the **IFilter** that is registered for the class, perceived type, or name extension of the item.</span></span>

### <a name="ifilter-structure"></a><span data-ttu-id="2cccb-169">Estrutura do IFilter</span><span class="sxs-lookup"><span data-stu-id="2cccb-169">IFilter Structure</span></span>

<span data-ttu-id="2cccb-170">Cada [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) é um arquivo dll que implementa um servidor com (Component Object Model em processo) para fornecer os recursos de filtragem especificados.</span><span class="sxs-lookup"><span data-stu-id="2cccb-170">Each [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) is a DLL file that implements an in-process Component Object Model (COM) server to supply the specified filtering capabilities.</span></span> <span data-ttu-id="2cccb-171">A figura a seguir ilustra o mostra a estrutura geral de uma dll **IFilter** típica.</span><span class="sxs-lookup"><span data-stu-id="2cccb-171">The following figure illustrates shows the overall structure of a typical **IFilter** DLLs.</span></span> <span data-ttu-id="2cccb-172">Um exemplo mais complexo poderia implementar mais de uma classe **IFilter** .</span><span class="sxs-lookup"><span data-stu-id="2cccb-172">A more complex example could implement more than one **IFilter** class.</span></span>

![diagrama da estrutura de uma DLL de IFilter típica](images/ifilter-structure.png)

### <a name="native-code"></a><span data-ttu-id="2cccb-174">Código nativo</span><span class="sxs-lookup"><span data-stu-id="2cccb-174">Native Code</span></span>

<span data-ttu-id="2cccb-175">Os filtros devem ser escritos em código nativo devido a problemas de controle de versão do CLR (Common Language Runtime potencial) com o processo em que vários suplementos são executados.</span><span class="sxs-lookup"><span data-stu-id="2cccb-175">Filters must be written in native code due to potential common language runtime (CLR) versioning issues with the process that multiple add-ins run in.</span></span> <span data-ttu-id="2cccb-176">No Windows 7 e posterior e posterior, os filtros gravados em código gerenciado são explicitamente bloqueados.</span><span class="sxs-lookup"><span data-stu-id="2cccb-176">In Windows 7 and later and later, filters written in managed code are explicitly blocked.</span></span>

## <a name="finding-the-ifilter-class-identifier"></a><span data-ttu-id="2cccb-177">Encontrando o identificador de classe IFilter</span><span class="sxs-lookup"><span data-stu-id="2cccb-177">Finding the IFilter Class Identifier</span></span>

<span data-ttu-id="2cccb-178">A classe da dll do [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) é registrada na chave do registro PersistentHandler.</span><span class="sxs-lookup"><span data-stu-id="2cccb-178">The class of the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL is registered under the PersistentHandler registry key.</span></span> <span data-ttu-id="2cccb-179">O exemplo a seguir, para arquivos HTML, ilustra como encontrar a DLL do **IFilter** para um documento HTML.</span><span class="sxs-lookup"><span data-stu-id="2cccb-179">The following example, for HTML files, illustrates how to find the **IFilter** DLL for an HTML document.</span></span> <span data-ttu-id="2cccb-180">Este exemplo segue a lógica semelhante à usada pelo sistema para localizar o **IFilter** associado a um item.</span><span class="sxs-lookup"><span data-stu-id="2cccb-180">This example follows logic similar to that used by the system to find the **IFilter** associated with an item.</span></span>

1. <span data-ttu-id="2cccb-181">Verifique se a extensão do tipo de arquivos que a DLL filtra tem um PersistentHandler registrado na entrada do registro \\ HKEY \_ local \_ Machine \\ software \\ classes.</span><span class="sxs-lookup"><span data-stu-id="2cccb-181">Check whether the extension for the type of files that the DLL filters has a PersistentHandler registered under the registry entry \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes.</span></span> <span data-ttu-id="2cccb-182">Deixe essa chave ser `Value1` .</span><span class="sxs-lookup"><span data-stu-id="2cccb-182">Let this key be `Value1`.</span></span> <span data-ttu-id="2cccb-183">Se essa entrada já existir, pule para a etapa 4 deste procedimento e use essa `Value1` chave.</span><span class="sxs-lookup"><span data-stu-id="2cccb-183">If that entry already exists, then skip to step 4 of this procedure and use `Value1` in that key.</span></span> <span data-ttu-id="2cccb-184">Os valores são do tipo REG \_ sz.</span><span class="sxs-lookup"><span data-stu-id="2cccb-184">The values are of type REG\_SZ.</span></span>

```
    \HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             .htm
                PersistentHandler
                   {EEC97550-47A9-11CF-B952-00AA0051FE20}
```

2. <span data-ttu-id="2cccb-185">Como alternativa, se não houver um PersistentHandler registrado para a extensão, localize o CLSID associado ao tipo de documento na entrada do registro \\ HKEY \_ local \_ Machine \\ software \\ classes.</span><span class="sxs-lookup"><span data-stu-id="2cccb-185">Alternatively, if there is not a PersistentHandler registered for the extension, find the CLSID associated with the document type under the registry entry \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes.</span></span> <span data-ttu-id="2cccb-186">Deixe essa chave ser `Value2` .</span><span class="sxs-lookup"><span data-stu-id="2cccb-186">Let this key be `Value2`.</span></span>

```
    \HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             htmlfile
                 = Class for WWW HTML files
                CLSID
                   {25336920-03F9-11CF-8FD0-00AA00686F13}
```

3. <span data-ttu-id="2cccb-187">Determine se um PersistentHandler está registrado para o CLSID.</span><span class="sxs-lookup"><span data-stu-id="2cccb-187">Determine whether a PersistentHandler is registered for the CLSID.</span></span> <span data-ttu-id="2cccb-188">Usando `Value2` determinado na etapa 2, localize o PersistentHandler para a \\ entrada do ' hKey \_ local \_ Machine \\ software \\ classes \\ CLSID \\ value2.</span><span class="sxs-lookup"><span data-stu-id="2cccb-188">Using `Value2` determined in step 2, find the PersistentHandler for the \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CLSID\\Value2 entry.</span></span> <span data-ttu-id="2cccb-189">Deixe essa chave ser `Value3` .</span><span class="sxs-lookup"><span data-stu-id="2cccb-189">Let this key be `Value3`.</span></span>

```
    \HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             htmlfile
                 = Class for WWW HTML files
                PersistentHandler
                   {EEC97550-47A9-11CF-B952-00AA0051FE20}
```

4. <span data-ttu-id="2cccb-190">Determine o GUID do manipulador persistente do [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="2cccb-190">Determine the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) persistent handler GUID.</span></span> <span data-ttu-id="2cccb-191">Usando `Value1` e `Value3` , localize o GUID do manipulador persistente do **IFilter** para o tipo de documento.</span><span class="sxs-lookup"><span data-stu-id="2cccb-191">Using `Value1` and `Value3`, find the **IFilter** Persistent Handler GUID for the document type.</span></span> <span data-ttu-id="2cccb-192">O valor na entrada do registro \\ HKEY \_ local \_ Machine \\ software \\ classes \\ CLSID \\ Value1 ou 3 \\ PersistentAddinsRegistered \\ 89BCB740-6119-101A-BCB7-00DD010655AF "/> produz o GUID de PersistentHandler do **IFilter** para esse tipo de documento.</span><span class="sxs-lookup"><span data-stu-id="2cccb-192">The value under the registry entry \\HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CLSID\\Value1 or 3\\PersistentAddinsRegistered\\ 89BCB740-6119-101A-BCB7-00DD010655AF"/> yields the **IFilter** PersistentHandler GUID for this document type.</span></span> <span data-ttu-id="2cccb-193">Deixe essa chave ser `Value4` .</span><span class="sxs-lookup"><span data-stu-id="2cccb-193">Let this key be `Value4`.</span></span> <span data-ttu-id="2cccb-194">Neste exemplo, o GUID da interface do **IFilter** é 89BCB740-6119-101A-BCB7-00DD010655AF.</span><span class="sxs-lookup"><span data-stu-id="2cccb-194">In this example, the **IFilter** interface GUID is 89BCB740-6119-101A-BCB7-00DD010655AF.</span></span>

```
    HKEY_LOCAL_MACHINE
       SOFTWARE
          Classes
             {EEC97550-47A9-11CF-B952-00AA0051FE20}
                 = HTML File Persistent Handler
                    Data type         REG_SZ
                        PersistentAddinsRegistered
                        {89BCB740-6119-101A-BCB7-00DD010655AF}

                    Data type         REG_SZ
                        default = {E0CA5340-4534-11CF-B952-00AA0051FE20}
```

> [!NOTE]  
> <span data-ttu-id="2cccb-195">Neste exemplo, a DLL do [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) para documentos HTML é nlhtml.dll.</span><span class="sxs-lookup"><span data-stu-id="2cccb-195">In this example, the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) DLL for HTML documents is nlhtml.dll.</span></span>

### <a name="ifiltergetchunk-and-locale-code-identifiers"></a><span data-ttu-id="2cccb-196">Identificadores de código IFilter:: GetChunk e locale</span><span class="sxs-lookup"><span data-stu-id="2cccb-196">IFilter::GetChunk and Locale Code Identifiers</span></span>

<span data-ttu-id="2cccb-197">O LCID do texto pode ser alterado em um único arquivo.</span><span class="sxs-lookup"><span data-stu-id="2cccb-197">The LCID of text can change within a single file.</span></span> <span data-ttu-id="2cccb-198">Por exemplo, o texto de um manual de instrução pode alternar entre inglês (en-US) e espanhol (es) ou o texto pode incluir uma única palavra em um idioma diferente do idioma principal.</span><span class="sxs-lookup"><span data-stu-id="2cccb-198">For example, the text of an instruction manual might alternate between English (en-us) and Spanish (es) or the text may include a single word in a language other than the primary language.</span></span> <span data-ttu-id="2cccb-199">Em ambos os casos, o [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) deve iniciar uma nova parte sempre que o LCID for alterado.</span><span class="sxs-lookup"><span data-stu-id="2cccb-199">In either case, your [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) must begin a new chunk each time the LCID changes.</span></span> <span data-ttu-id="2cccb-200">Como o LCID é usado para escolher um separador de palavras apropriado, é muito importante que você o identifique corretamente.</span><span class="sxs-lookup"><span data-stu-id="2cccb-200">Because the LCID is used to choose an appropriate word breaker, it is very important that you correctly identify it.</span></span> <span data-ttu-id="2cccb-201">Se o **IFilter** não puder determinar a localidade do texto, ele deverá retornar um LCID de zero com a parte.</span><span class="sxs-lookup"><span data-stu-id="2cccb-201">If the **IFilter** cannot determine the locale of the text, then it should return an LCID of zero with the chunk.</span></span> <span data-ttu-id="2cccb-202">Retornar um LCID de zero faz com que o Windows Search use a tecnologia de detecção automática de idioma (LAD) para determinar a ID de localidade da parte.</span><span class="sxs-lookup"><span data-stu-id="2cccb-202">Returning an LCID of zero causes Windows Search to use Language Auto-Detection (LAD) technology to determine the locale ID of the chunk.</span></span> <span data-ttu-id="2cccb-203">Se o Windows Search não conseguir encontrar uma correspondência, o padrão será a localidade padrão do sistema (chamando a função de [função GetSystemDefaultLocaleName](/windows/win32/api/winnls/nf-winnls-getsystemdefaultlocalename) ).</span><span class="sxs-lookup"><span data-stu-id="2cccb-203">If Windows Search cannot find a match, it defaults to the system default locale (by calling the [GetSystemDefaultLocaleName Function](/windows/win32/api/winnls/nf-winnls-getsystemdefaultlocalename) function).</span></span> <span data-ttu-id="2cccb-204">Para obter mais informações, consulte [**IFilter:: GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**partes \_ breaktype**](/windows/win32/api/filter/ne-filter-chunk_breaktype), [**chunkstate**](/windows/win32/api/filter/ne-filter-chunkstate)e [**a \_ parte stat**](/windows/win32/api/filter/ns-filter-stat_chunk).</span><span class="sxs-lookup"><span data-stu-id="2cccb-204">For more information, see [**IFilter::GetChunk**](/windows/win32/api/filter/nf-filter-ifilter-getchunk), [**CHUNK\_BREAKTYPE**](/windows/win32/api/filter/ne-filter-chunk_breaktype), [**CHUNKSTATE**](/windows/win32/api/filter/ne-filter-chunkstate), and [**STAT\_CHUNK**](/windows/win32/api/filter/ns-filter-stat_chunk).</span></span>

<span data-ttu-id="2cccb-205">Se você controlar o formato de arquivo e ele não contiver informações de localidade, você deverá adicionar um recurso de usuário para habilitar a identificação de localidade adequada.</span><span class="sxs-lookup"><span data-stu-id="2cccb-205">If you control the file format and it currently does not contain locale information, you should add a user feature to enable proper locale identification.</span></span> <span data-ttu-id="2cccb-206">O uso de um separador de palavras incompatível pode resultar em uma experiência de consulta ruim para o usuário.</span><span class="sxs-lookup"><span data-stu-id="2cccb-206">Using a mismatched word breaker can result in a poor query experience for the user.</span></span> <span data-ttu-id="2cccb-207">Para obter mais informações, consulte [**IWordBreaker**](/windows/desktop/api/Indexsrv/nn-indexsrv-iwordbreaker).</span><span class="sxs-lookup"><span data-stu-id="2cccb-207">For more information, see [**IWordBreaker**](/windows/desktop/api/Indexsrv/nn-indexsrv-iwordbreaker).</span></span>

> [!NOTE]  
> <span data-ttu-id="2cccb-208">Os filtros são associados a tipos de arquivo, como indicado por extensões de nome de arquivo, tipos de MIME ou CLSIDs.</span><span class="sxs-lookup"><span data-stu-id="2cccb-208">Filters are associated with file types, as denoted by file name extensions, MIME types or CLSIDs.</span></span> <span data-ttu-id="2cccb-209">Embora um filtro possa lidar com vários tipos de arquivo, cada tipo funciona com apenas um filtro.</span><span class="sxs-lookup"><span data-stu-id="2cccb-209">While one filter can handle multiple file types, each type works with only one filter.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="2cccb-210">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="2cccb-210">Additional Resources</span></span>

- <span data-ttu-id="2cccb-211">O exemplo de código [IFilterSample](-search-sample-ifiltersample.md) , disponível no [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample7), demonstra como criar uma classe base IFilter para implementar a interface [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) .</span><span class="sxs-lookup"><span data-stu-id="2cccb-211">The [IFilterSample](-search-sample-ifiltersample.md) code sample, available on [GitHub](https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/WindowsSearch/IFilterSample7), demonstrates how to create an IFilter base class for implementing the [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) interface.</span></span>
- <span data-ttu-id="2cccb-212">Para obter uma visão geral do processo de indexação, consulte [o processo de indexação](-search-indexing-process-overview.md).</span><span class="sxs-lookup"><span data-stu-id="2cccb-212">For an overview of the indexing process, see [The Indexing Process](-search-indexing-process-overview.md).</span></span>
- <span data-ttu-id="2cccb-213">Para obter uma visão geral dos tipos de arquivo, consulte [tipos de arquivo](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="2cccb-213">For an overview of file types, see [File Types](../shell/fa-file-types.md).</span></span>
- <span data-ttu-id="2cccb-214">Para consultar atributos de associação de arquivo para um tipo de arquivo, consulte [PerceivedTypes, SystemFileAssociations e registro de aplicativo](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="2cccb-214">To query file association attributes for a file type, see [PerceivedTypes, SystemFileAssociations, and Application Registration](/previous-versions/windows/desktop/legacy/cc144150(v=vs.85)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="2cccb-215">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="2cccb-215">Related topics</span></span>

[<span data-ttu-id="2cccb-216">Desenvolvendo manipuladores de filtro</span><span class="sxs-lookup"><span data-stu-id="2cccb-216">Developing Filter Handlers</span></span>](-search-ifilter-conceptual.md)

[<span data-ttu-id="2cccb-217">Práticas recomendadas para a criação de manipuladores de filtro no Windows Search</span><span class="sxs-lookup"><span data-stu-id="2cccb-217">Best Practices for Creating Filter Handlers in Windows Search</span></span>](-search-3x-wds-extidx-filters.md)

[<span data-ttu-id="2cccb-218">Retornando Propriedades de um manipulador de filtro</span><span class="sxs-lookup"><span data-stu-id="2cccb-218">Returning Properties from a Filter Handler</span></span>](-search-ifilter-property-filtering.md)

[<span data-ttu-id="2cccb-219">Manipuladores de filtro que acompanham o Windows</span><span class="sxs-lookup"><span data-stu-id="2cccb-219">Filter Handlers that Ship with Windows</span></span>](-search-ifilter-implementations.md)

[<span data-ttu-id="2cccb-220">Implementando manipuladores de filtro no Windows Search</span><span class="sxs-lookup"><span data-stu-id="2cccb-220">Implementing Filter Handlers in Windows Search</span></span>](-search-ifilter-constructing-filters.md)

[<span data-ttu-id="2cccb-221">Registrando manipuladores de filtro</span><span class="sxs-lookup"><span data-stu-id="2cccb-221">Registering Filter Handlers</span></span>](-search-ifilter-registering-filters.md)

[<span data-ttu-id="2cccb-222">Testando manipuladores de filtro</span><span class="sxs-lookup"><span data-stu-id="2cccb-222">Testing Filter Handlers</span></span>](-search-ifilter-testing-filters.md)
