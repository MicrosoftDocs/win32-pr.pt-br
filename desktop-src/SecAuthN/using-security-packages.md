---
description: Lista os pacotes de segurança que podem ser usados com SSPI.
ms.assetid: f5999d41-b334-49be-8883-d9b9042d20dc
title: Usando pacotes de segurança
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df24bba0f910ba74a633e8a43f961cee4fb505db
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105762920"
---
# <a name="using-security-packages"></a><span data-ttu-id="e3966-103">Usando pacotes de segurança</span><span class="sxs-lookup"><span data-stu-id="e3966-103">Using Security Packages</span></span>

<span data-ttu-id="e3966-104">A [*interface de provedor de suporte de segurança*](../secgloss/s-gly.md) (SSPI) pode ser usada com os seguintes [*pacotes de segurança*](../secgloss/s-gly.md):</span><span class="sxs-lookup"><span data-stu-id="e3966-104">The [*Security Support Provider Interface*](../secgloss/s-gly.md) (SSPI) can be used with the following [*security packages*](../secgloss/s-gly.md):</span></span>

-   [<span data-ttu-id="e3966-105">Pacote de segurança Kerberos</span><span class="sxs-lookup"><span data-stu-id="e3966-105">Kerberos Security Package</span></span>](#kerberos-security-package)
-   [<span data-ttu-id="e3966-106">Pacote de segurança do NTLM</span><span class="sxs-lookup"><span data-stu-id="e3966-106">NTLM Security Package</span></span>](#ntlm-security-package)

<span data-ttu-id="e3966-107">Os protocolos [*Kerberos*](../secgloss/k-gly.md) e NTLM são implementados como pacotes de segurança do SSP ( [*provedor de suporte de segurança*](../secgloss/s-gly.md) ) Secur32.dll fornecido com o sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="e3966-107">The [*Kerberos*](../secgloss/k-gly.md) and NTLM protocols are implemented as security packages from the Secur32.dll [*security support provider*](../secgloss/s-gly.md) (SSP) supplied with the operating system.</span></span> <span data-ttu-id="e3966-108">Por padrão, o suporte para autenticação Kerberos e NTLM é carregado pela [*autoridade de segurança local*](../secgloss/l-gly.md) (LSA) em um computador quando o sistema é iniciado.</span><span class="sxs-lookup"><span data-stu-id="e3966-108">By default, support for both Kerberos and NTLM authentication are loaded by the [*local security authority*](../secgloss/l-gly.md) (LSA) on a computer when the system starts.</span></span> <span data-ttu-id="e3966-109">No Windows Server ou em domínios do Windows, qualquer pacote pode ser usado para autenticar logons de rede e conexões de cliente/servidor.</span><span class="sxs-lookup"><span data-stu-id="e3966-109">In Windows Server or Windows domains, either package can be used to authenticate network logons and client/server connections.</span></span> <span data-ttu-id="e3966-110">Qual delas é usada depende dos recursos do computador no outro lado da conexão.</span><span class="sxs-lookup"><span data-stu-id="e3966-110">Which one is used depends on the capabilities of the computer on the other side of the connection.</span></span> <span data-ttu-id="e3966-111">O protocolo Kerberos é sempre preferencial, se disponível.</span><span class="sxs-lookup"><span data-stu-id="e3966-111">The Kerberos protocol is always preferred, if available.</span></span>

<span data-ttu-id="e3966-112">Depois que um contexto de segurança para um usuário interativo tiver sido estabelecido, outra instância do pacote Kerberos ou NTLM poderá ser carregada por um processo em execução no contexto de segurança do usuário para dar suporte à troca, à assinatura, à verificação, à criptografia e à descriptografia de mensagens.</span><span class="sxs-lookup"><span data-stu-id="e3966-112">After a security context for an interactive user has been established, another instance of the Kerberos or NTLM package can be loaded by a process running in the security context of the user to support the exchanging, signing, verifying, encrypting, and decrypting of messages.</span></span> <span data-ttu-id="e3966-113">No entanto, nenhum processo diferente da LSA tem permissão para acessar [*chaves de sessão*](../secgloss/s-gly.md) ou tíquetes no cache de credenciais.</span><span class="sxs-lookup"><span data-stu-id="e3966-113">However, no process other than the LSA is ever permitted access to [*session keys*](../secgloss/s-gly.md) or tickets in the credentials cache.</span></span>

<span data-ttu-id="e3966-114">Os serviços do sistema e os aplicativos de nível de transporte acessam um SSP por meio de SSPI, que fornece funções para enumerar os pacotes de segurança disponíveis em um sistema, selecionar um pacote e usar esse pacote para obter uma conexão autenticada.</span><span class="sxs-lookup"><span data-stu-id="e3966-114">System services and transport-level applications access an SSP through SSPI, which provides functions for enumerating the security packages available on a system, selecting a package, and using that package to obtain an authenticated connection.</span></span>

<span data-ttu-id="e3966-115">Os métodos no SSPI são rotinas genéricas que os desenvolvedores podem usar sem saber os detalhes de um determinado [*protocolo de segurança*](../secgloss/s-gly.md).</span><span class="sxs-lookup"><span data-stu-id="e3966-115">The methods in SSPI are generic routines that developers can use without knowing the details of a particular [*security protocol*](../secgloss/s-gly.md).</span></span> <span data-ttu-id="e3966-116">Por exemplo, quando uma conexão de cliente/servidor é autenticada:</span><span class="sxs-lookup"><span data-stu-id="e3966-116">For example, when a client/server connection is authenticated:</span></span>

1.  <span data-ttu-id="e3966-117">O aplicativo no lado do cliente da conexão envia [*credenciais*](../secgloss/c-gly.md) para o servidor usando a função SSPI [**InitializeSecurityContext (geral)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta).</span><span class="sxs-lookup"><span data-stu-id="e3966-117">The application on the client side of the connection sends [*credentials*](../secgloss/c-gly.md) to the server using the SSPI function [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta).</span></span>
2.  <span data-ttu-id="e3966-118">O aplicativo no lado do servidor da conexão responde com a função SSPI [**AcceptSecurityContext (geral)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext).</span><span class="sxs-lookup"><span data-stu-id="e3966-118">The application on the server side of the connection responds with the SSPI function [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext).</span></span>
3.  <span data-ttu-id="e3966-119">Depois que a conexão for autenticada, a LSA no servidor usará as informações do cliente para criar um [*token de acesso*](../secgloss/a-gly.md).</span><span class="sxs-lookup"><span data-stu-id="e3966-119">After the connection has been authenticated, the LSA on the server uses information from the client to build an [*access token*](../secgloss/a-gly.md).</span></span>
4.  <span data-ttu-id="e3966-120">O servidor pode então chamar a função SSPI [**ImpersonateSecurityContext**](/windows/desktop/api/Sspi/nf-sspi-impersonatesecuritycontext) para anexar o token de acesso a um thread de representação para o serviço.</span><span class="sxs-lookup"><span data-stu-id="e3966-120">The server can then call the SSPI function [**ImpersonateSecurityContext**](/windows/desktop/api/Sspi/nf-sspi-impersonatesecuritycontext) to attach the access token to an impersonation thread for the service.</span></span>

## <a name="kerberos-security-package"></a><span data-ttu-id="e3966-121">Pacote de segurança Kerberos</span><span class="sxs-lookup"><span data-stu-id="e3966-121">Kerberos Security Package</span></span>

<span data-ttu-id="e3966-122">O [*pacote de segurança*](../secgloss/s-gly.md) do Kerberos é baseado no [*protocolo de autenticação Kerberos*](../secgloss/k-gly.md).</span><span class="sxs-lookup"><span data-stu-id="e3966-122">The Kerberos [*security package*](../secgloss/s-gly.md) is based on the [*Kerberos authentication protocol*](../secgloss/k-gly.md).</span></span>

<span data-ttu-id="e3966-123">Se o protocolo Kerberos estiver sendo usado para autenticar uma conexão de cliente/servidor, [**InitializeSecurityContext (Kerberos)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) gerará uma mensagem GSSAPI que inclui uma \_ \_ mensagem de req KRB AP do cliente.</span><span class="sxs-lookup"><span data-stu-id="e3966-123">If the Kerberos protocol is being used to authenticate a client/server connection, [**InitializeSecurityContext (Kerberos)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) generates a GSSAPI message that includes a KRB\_AP\_REQ message from the client.</span></span> <span data-ttu-id="e3966-124">[**AcceptSecurityContext (Kerberos)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) , em seguida, gera uma mensagem GSSAPI que inclui uma \_ \_ mensagem de rep KRB AP do servidor.</span><span class="sxs-lookup"><span data-stu-id="e3966-124">[**AcceptSecurityContext (Kerberos)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) then generates a GSSAPI message that includes a KRB\_AP\_REP message from the server.</span></span>

<span data-ttu-id="e3966-125">Para obter informações básicas sobre as etapas que ocorrem em segundo plano na implementação de um protocolo Kerberos, consulte [Microsoft Kerberos](microsoft-kerberos.md).</span><span class="sxs-lookup"><span data-stu-id="e3966-125">For background information on the steps that take place behind the scenes in the implementation of a Kerberos protocol, see [Microsoft Kerberos](microsoft-kerberos.md).</span></span>

<span data-ttu-id="e3966-126">Todos os serviços distribuídos usam SSPI para acessar o protocolo Kerberos.</span><span class="sxs-lookup"><span data-stu-id="e3966-126">All distributed services use SSPI to access the Kerberos protocol.</span></span> <span data-ttu-id="e3966-127">Uma lista parcial das maneiras como o protocolo Kerberos é usado para autenticação inclui:</span><span class="sxs-lookup"><span data-stu-id="e3966-127">A partial list of the ways in which the Kerberos protocol is used for authentication includes:</span></span>

-   <span data-ttu-id="e3966-128">Serviços de spooler de impressão</span><span class="sxs-lookup"><span data-stu-id="e3966-128">Print spooler services</span></span>
-   <span data-ttu-id="e3966-129">Acesso a arquivos remotos CIFS/SMB</span><span class="sxs-lookup"><span data-stu-id="e3966-129">CIFS/SMB remote file access</span></span>
-   <span data-ttu-id="e3966-130">Consultas [*LDAP*](../secgloss/l-gly.md) para o Active Directory</span><span class="sxs-lookup"><span data-stu-id="e3966-130">[*LDAP*](../secgloss/l-gly.md) queries to the Active Directory</span></span>
-   <span data-ttu-id="e3966-131">Gerenciamento e referências do sistema de arquivos distribuído</span><span class="sxs-lookup"><span data-stu-id="e3966-131">Distributed file system management and referrals</span></span>
-   <span data-ttu-id="e3966-132">Autenticação de autoridade de segurança de host para host IPsec</span><span class="sxs-lookup"><span data-stu-id="e3966-132">IPsec host-to-host security authority authentication</span></span>
-   <span data-ttu-id="e3966-133">Solicitações de reserva para a qualidade de serviço da rede</span><span class="sxs-lookup"><span data-stu-id="e3966-133">Reservation requests for network Quality of Service</span></span>
-   <span data-ttu-id="e3966-134">Autenticação de intranet para Serviços de Informações da Internet</span><span class="sxs-lookup"><span data-stu-id="e3966-134">Intranet authentication to Internet Information Services</span></span>
-   <span data-ttu-id="e3966-135">Gerenciamento de servidor remoto ou estação de trabalho usando RPC autenticado</span><span class="sxs-lookup"><span data-stu-id="e3966-135">Remote server or workstation management using authenticated RPC</span></span>
-   <span data-ttu-id="e3966-136">[*Solicitações de certificado*](../secgloss/c-gly.md) para serviços de certificados para usuários e computadores do domínio</span><span class="sxs-lookup"><span data-stu-id="e3966-136">[*Certificate requests*](../secgloss/c-gly.md) to Certificate Services for domain users and computers</span></span>

## <a name="ntlm-security-package"></a><span data-ttu-id="e3966-137">Pacote de segurança do NTLM</span><span class="sxs-lookup"><span data-stu-id="e3966-137">NTLM Security Package</span></span>

<span data-ttu-id="e3966-138">O pacote de segurança NTLM é baseado no protocolo de autenticação NTLM.</span><span class="sxs-lookup"><span data-stu-id="e3966-138">The NTLM security package is based on the NTLM authentication protocol.</span></span>

 

 
