---
description: Depois de receber um desafio do servidor, o cliente cria a resposta de desafio de resumo chamando a função InitializeSecurityContext (Digest).
ms.assetid: b26b5676-a614-4017-a4e5-a5395292a667
title: Gerando a resposta de desafio de resumo
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8b577334348745425db23d3de41431ba4e37b7af
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103829768"
---
# <a name="generating-the-digest-challenge-response"></a><span data-ttu-id="1c683-103">Gerando a resposta de desafio de resumo</span><span class="sxs-lookup"><span data-stu-id="1c683-103">Generating the Digest Challenge Response</span></span>

<span data-ttu-id="1c683-104">Depois de receber um desafio do servidor, o cliente cria a resposta de desafio de resumo chamando a função [**InitializeSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) .</span><span class="sxs-lookup"><span data-stu-id="1c683-104">After receiving a challenge from the server, the client creates the Digest challenge response by calling the [**InitializeSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) function.</span></span> <span data-ttu-id="1c683-105">Essa função gera uma impressão digital de [*hash*](/windows/desktop/SecGloss/h-gly) MD5 usando informações sobre o recurso e os dados solicitados do desafio e gera um token de segurança que representa um [*contexto de segurança*](/windows/desktop/SecGloss/s-gly)parcial.</span><span class="sxs-lookup"><span data-stu-id="1c683-105">This function generates an MD5 [*hash*](/windows/desktop/SecGloss/h-gly) fingerprint by using information about the requested resource and data from the challenge, and outputs a security token that represents a partial [*security context*](/windows/desktop/SecGloss/s-gly).</span></span> <span data-ttu-id="1c683-106">Para concluir a autenticação, o cliente deve retornar o token para o servidor que emitiu o desafio.</span><span class="sxs-lookup"><span data-stu-id="1c683-106">To complete the authentication, the client must return the token to the server that issued the challenge.</span></span>

<span data-ttu-id="1c683-107">A tabela a seguir descreve os parâmetros da [*função*](/windows/desktop/SecGloss/c-gly) [**InitializeSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) e os valores a serem fornecidos ao construir uma resposta de desafio de resumo.</span><span class="sxs-lookup"><span data-stu-id="1c683-107">The following table describes the parameters of the [**InitializeSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) [*function*](/windows/desktop/SecGloss/c-gly), and the values to supply when constructing a Digest challenge response.</span></span>



| <span data-ttu-id="1c683-108">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="1c683-108">Parameter</span></span>                  | <span data-ttu-id="1c683-109">Descrição</span><span class="sxs-lookup"><span data-stu-id="1c683-109">Description</span></span>                                                                                                                                                                                               |
|----------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1c683-110">*fContextReq*</span><span class="sxs-lookup"><span data-stu-id="1c683-110">*fContextReq*</span></span><br/>   | <span data-ttu-id="1c683-111">Os atributos de contexto de segurança solicitados pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="1c683-111">The security context attributes requested by the client.</span></span> <span data-ttu-id="1c683-112">Para obter mais informações, consulte requisitos de contexto de resposta de desafio Digest.</span><span class="sxs-lookup"><span data-stu-id="1c683-112">For more information, see Digest Challenge Response Context Requirements.</span></span><br/>                                                             |
| <span data-ttu-id="1c683-113">*pszTargetName*</span><span class="sxs-lookup"><span data-stu-id="1c683-113">*pszTargetName*</span></span><br/> | <span data-ttu-id="1c683-114">HTTP: cadeia de caracteres terminada em nulo que especifica a URL de destino.</span><span class="sxs-lookup"><span data-stu-id="1c683-114">HTTP: Null-terminated string that specifies the target URL.</span></span><br/> <span data-ttu-id="1c683-115">SASL: cadeia de caracteres terminada em nulo que especifica o destino DNS/SPN.</span><span class="sxs-lookup"><span data-stu-id="1c683-115">SASL: Null-terminated string that specifies the DNS/SPN target.</span></span><br/>                                                         |
| <span data-ttu-id="1c683-116">*pInput*</span><span class="sxs-lookup"><span data-stu-id="1c683-116">*pInput*</span></span><br/>        | <span data-ttu-id="1c683-117">Buffers que contêm informações exigidas pelo SSP de resumo.</span><span class="sxs-lookup"><span data-stu-id="1c683-117">Buffers that contain information required by the Digest SSP.</span></span> <span data-ttu-id="1c683-118">Para obter mais informações, consulte [buffers de entrada para a resposta de desafio de resumo](input-buffers-for-the-digest-challenge-response.md).</span><span class="sxs-lookup"><span data-stu-id="1c683-118">For more information, see [Input Buffers for the Digest Challenge Response](input-buffers-for-the-digest-challenge-response.md).</span></span><br/> |
| <span data-ttu-id="1c683-119">*pfContextAttr*</span><span class="sxs-lookup"><span data-stu-id="1c683-119">*pfContextAttr*</span></span><br/> | <span data-ttu-id="1c683-120">Recebe os atributos com suporte do contexto de segurança retornado.</span><span class="sxs-lookup"><span data-stu-id="1c683-120">Receives the attributes supported by the returned security context.</span></span> <span data-ttu-id="1c683-121">Para obter mais informações, consulte requisitos de contexto de resposta de desafio Digest.</span><span class="sxs-lookup"><span data-stu-id="1c683-121">For more information, see Digest Challenge Response Context Requirements.</span></span><br/>                                                  |
| <span data-ttu-id="1c683-122">*pOutput*</span><span class="sxs-lookup"><span data-stu-id="1c683-122">*pOutput*</span></span><br/>       | <span data-ttu-id="1c683-123">Endereço de um \_ buffer de tipo de token SECBUFFER que recebe um token de segurança para enviar de volta para o servidor.</span><span class="sxs-lookup"><span data-stu-id="1c683-123">Address of a SECBUFFER\_TOKEN type buffer that receives a security token to send back to the server.</span></span><br/>                                                                                           |



 

## <a name="digest-challenge-response-context-requirements"></a><span data-ttu-id="1c683-124">Requisitos de contexto de resposta de desafio Digest</span><span class="sxs-lookup"><span data-stu-id="1c683-124">Digest Challenge Response Context Requirements</span></span>

<span data-ttu-id="1c683-125">Os requisitos de contexto são sinalizadores que determinam:</span><span class="sxs-lookup"><span data-stu-id="1c683-125">Context requirements are flags that determine:</span></span>

-   <span data-ttu-id="1c683-126">Se Microsoft Digest funciona como um mecanismo SASL ou protocolo de autenticação HTTP.</span><span class="sxs-lookup"><span data-stu-id="1c683-126">Whether Microsoft Digest functions as a SASL mechanism or HTTP authentication protocol.</span></span>
-   <span data-ttu-id="1c683-127">A qualidade de proteção com suporte do [*contexto de segurança*](/windows/desktop/SecGloss/s-gly) compartilhado pelo cliente e servidor.</span><span class="sxs-lookup"><span data-stu-id="1c683-127">The quality of protection supported by the [*security context*](/windows/desktop/SecGloss/s-gly) shared by the client and server.</span></span>

<span data-ttu-id="1c683-128">Por padrão, o Microsoft Digest funciona como um mecanismo SASL.</span><span class="sxs-lookup"><span data-stu-id="1c683-128">By default, Microsoft Digest functions as a SASL mechanism.</span></span>

<span data-ttu-id="1c683-129">Os requisitos de contexto são especificados como sinalizadores passados para o parâmetro *fContextReq* da função [**InitializeSecurityContext**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) .</span><span class="sxs-lookup"><span data-stu-id="1c683-129">Context requirements are specified as flags passed to the *fContextReq* parameter of the [**InitializeSecurityContext**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) function.</span></span> <span data-ttu-id="1c683-130">Os sinalizadores afetam a qualidade de proteção do contexto de segurança, controlando a diretiva QoP na resposta de desafio.</span><span class="sxs-lookup"><span data-stu-id="1c683-130">The flags affect the security context's quality of protection by controlling the qop directive in the challenge response.</span></span>

<span data-ttu-id="1c683-131">Por padrão, a diretiva QoP é definida como "auth".</span><span class="sxs-lookup"><span data-stu-id="1c683-131">By default, the qop directive is set to "auth".</span></span> <span data-ttu-id="1c683-132">Para gerar uma resposta de desafio que define QoP como "auth-int", deve ocorrer o seguinte:</span><span class="sxs-lookup"><span data-stu-id="1c683-132">To generate a challenge response that sets qop to "auth-int", the following must occur:</span></span>

1.  <span data-ttu-id="1c683-133">O desafio Digest deve ter uma diretiva QoP definida como "auth-int".</span><span class="sxs-lookup"><span data-stu-id="1c683-133">The Digest challenge must have had a qop directive set to "auth-int".</span></span>
2.  <span data-ttu-id="1c683-134">O cliente deve especificar um ou mais dos seguintes sinalizadores:</span><span class="sxs-lookup"><span data-stu-id="1c683-134">The client must specify one or more of the following flags:</span></span>

    -   <span data-ttu-id="1c683-135">\_integridade do req do ISC \_</span><span class="sxs-lookup"><span data-stu-id="1c683-135">ISC\_REQ\_INTEGRITY</span></span>
    -   <span data-ttu-id="1c683-136">\_detecção de \_ repetição de req do ISC \_</span><span class="sxs-lookup"><span data-stu-id="1c683-136">ISC\_REQ\_REPLAY\_DETECT</span></span>
    -   <span data-ttu-id="1c683-137">\_detecção de \_ sequência de req do ISC \_</span><span class="sxs-lookup"><span data-stu-id="1c683-137">ISC\_REQ\_SEQUENCE\_DETECT</span></span>

<span data-ttu-id="1c683-138">Somente para SASL: gere uma resposta de desafio com a diretiva QoP definida como "auth-conf" especificando o \_ \_ sinalizador confidenciality do ISC.</span><span class="sxs-lookup"><span data-stu-id="1c683-138">For SASL only: Generate a challenge response with the qop directive set to "auth-conf" by specifying the ISC\_REQ\_CONFIDENTIALITY flag.</span></span> <span data-ttu-id="1c683-139">Como esse sinalizador não é válido para autenticação HTTP, ele não pode ser usado com o \_ sinalizador http req do ISC \_ .</span><span class="sxs-lookup"><span data-stu-id="1c683-139">Because this flag is not valid for HTTP authentication, it cannot be used with the ISC\_REQ\_HTTP flag.</span></span>

## <a name="verifying-the-quality-of-protection"></a><span data-ttu-id="1c683-140">Verificando a qualidade da proteção</span><span class="sxs-lookup"><span data-stu-id="1c683-140">Verifying the Quality of Protection</span></span>

<span data-ttu-id="1c683-141">O cliente deve examinar os sinalizadores de atributos de contexto de segurança retornados no parâmetro *pfContextAttr* da função [**InitializeSecurityContext**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) .</span><span class="sxs-lookup"><span data-stu-id="1c683-141">The client must examine the security context attributes flags returned in the [**InitializeSecurityContext**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) function's *pfContextAttr* parameter.</span></span> <span data-ttu-id="1c683-142">O cliente deve enviar a resposta de desafio para o servidor somente se a qualidade de proteção indicada pelos sinalizadores for suficiente para suas finalidades.</span><span class="sxs-lookup"><span data-stu-id="1c683-142">The client should send the challenge response to the server only if the quality of protection indicated by the flags is sufficient for its purposes.</span></span> <span data-ttu-id="1c683-143">Os sinalizadores relevantes podem ser qualquer combinação do seguinte:</span><span class="sxs-lookup"><span data-stu-id="1c683-143">The relevant flags can be any combination of the following:</span></span>

-   <span data-ttu-id="1c683-144">integridade da ISC \_ RET \_</span><span class="sxs-lookup"><span data-stu-id="1c683-144">ISC\_RET\_INTEGRITY</span></span>
-   <span data-ttu-id="1c683-145">detecção de repetição da ISC \_ RET \_ \_</span><span class="sxs-lookup"><span data-stu-id="1c683-145">ISC\_RET\_REPLAY\_DETECT</span></span>
-   <span data-ttu-id="1c683-146">detecção de sequência do ISC \_ RET \_ \_</span><span class="sxs-lookup"><span data-stu-id="1c683-146">ISC\_RET\_SEQUENCE\_DETECT</span></span>
-   <span data-ttu-id="1c683-147">\_ \_ Confidencialidade da ISC (somente contextos SASL)</span><span class="sxs-lookup"><span data-stu-id="1c683-147">ISC\_RET\_CONFIDENTIALITY (SASL contexts only)</span></span>

<span data-ttu-id="1c683-148">Para obter mais informações sobre a diretiva QoP, consulte [qualidade de proteção e codificações](quality-of-protection-and-ciphers.md).</span><span class="sxs-lookup"><span data-stu-id="1c683-148">For more information about the qop directive, see [Quality of Protection and Ciphers](quality-of-protection-and-ciphers.md).</span></span>

<span data-ttu-id="1c683-149">Para obter mais informações sobre diretivas de resposta de desafio, consulte [conteúdo de uma resposta de desafio de resumo](contents-of-a-digest-challenge-response.md).</span><span class="sxs-lookup"><span data-stu-id="1c683-149">For more information about challenge response directives, see [Contents of a Digest Challenge Response](contents-of-a-digest-challenge-response.md).</span></span>

 

