---
description: Como o cliente, o servidor também adquire um identificador de credenciais para estar pronto para responder a uma solicitação de autenticação de entrada do cliente.
ms.assetid: 2a0aeadf-e099-4264-8522-e498f437bf75
title: Inicialização do contexto do servidor
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1362c8fd71e079392f10a8e35f76ad511de3c49f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103662127"
---
# <a name="server-context-initialization"></a><span data-ttu-id="14de4-103">Inicialização do contexto do servidor</span><span class="sxs-lookup"><span data-stu-id="14de4-103">Server Context Initialization</span></span>

<span data-ttu-id="14de4-104">Como o cliente, o servidor também adquire um identificador de [*credenciais*](../secgloss/c-gly.md) para estar pronto para responder a uma solicitação de autenticação de entrada do cliente.</span><span class="sxs-lookup"><span data-stu-id="14de4-104">Like the client, the server also acquires a [*credentials*](../secgloss/c-gly.md) handle to be ready to respond to an incoming authentication request from the client.</span></span> <span data-ttu-id="14de4-105">As credenciais do servidor são usadas para autenticar o servidor no cliente em [*protocolos de segurança*](../secgloss/s-gly.md) que dão suporte à autenticação de servidor ou autenticação mútua.</span><span class="sxs-lookup"><span data-stu-id="14de4-105">Server credentials are used to authenticate the server to the client in [*security protocols*](../secgloss/s-gly.md) that support server authentication or mutual authentication.</span></span> <span data-ttu-id="14de4-106">O servidor Obtém um identificador para suas credenciais definidas pela conta de serviço usada para iniciar o servidor.</span><span class="sxs-lookup"><span data-stu-id="14de4-106">The server obtains a handle to its credentials defined by the service account used to start the server.</span></span> <span data-ttu-id="14de4-107">Ele faz isso chamando [**falha AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea).</span><span class="sxs-lookup"><span data-stu-id="14de4-107">It does so by calling [**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea).</span></span>

<span data-ttu-id="14de4-108">O servidor pode adquirir seu identificador de credenciais e entrar em um estado de escuta, ou pode aguardar um estado de escuta até que uma solicitação de conexão chegue e, em seguida, adquira um identificador de credenciais de entrada.</span><span class="sxs-lookup"><span data-stu-id="14de4-108">The server can acquire its credentials handle and then go into a listen state, or it can wait in a listen state until a connection request arrives and then acquire an inbound credentials handle.</span></span> <span data-ttu-id="14de4-109">Para obter mais informações sobre as funções de credenciais, consulte [Gerenciamento de credenciais](authentication-functions.md).</span><span class="sxs-lookup"><span data-stu-id="14de4-109">For more information on credentials functions, see [Credential Management](authentication-functions.md).</span></span>

<span data-ttu-id="14de4-110">Quando o servidor recebe uma mensagem de solicitação de conexão de um cliente, ele cria um [*contexto de segurança*](../secgloss/s-gly.md) local para o cliente usando [**AcceptSecurityContext (geral)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext).</span><span class="sxs-lookup"><span data-stu-id="14de4-110">When the server receives a connection request message from a client, it creates a local [*security context*](../secgloss/s-gly.md) for the client using [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext).</span></span> <span data-ttu-id="14de4-111">O servidor usa esse contexto de segurança local para realizar solicitações futuras pelo mesmo cliente.</span><span class="sxs-lookup"><span data-stu-id="14de4-111">The server uses this local security context to carry out future requests by the same client.</span></span> <span data-ttu-id="14de4-112">Para obter mais informações sobre funções de contexto, consulte [Gerenciamento de contexto](authentication-functions.md).</span><span class="sxs-lookup"><span data-stu-id="14de4-112">For more information on context functions, see [Context Management](authentication-functions.md).</span></span>

<span data-ttu-id="14de4-113">O servidor verifica o status de retorno e o descritor de buffer de saída para garantir que não haja erros até o momento, e pode rejeitar a solicitação de conexão se houver erros.</span><span class="sxs-lookup"><span data-stu-id="14de4-113">The server checks the return status and output buffer descriptor to ensure there are no errors so far, and can reject the connection request if there are errors.</span></span> <span data-ttu-id="14de4-114">Se houver informações no buffer de saída retornado por [**AcceptSecurityContext (geral)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext), ele agrupará esse buffer em uma mensagem de resposta para o cliente.</span><span class="sxs-lookup"><span data-stu-id="14de4-114">If there is information in the output buffer returned by [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext), it bundles that buffer into a response message to the client.</span></span>

<span data-ttu-id="14de4-115">Qualquer buffer de saída de [**AcceptSecurityContext (geral)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) deve ser enviado de volta ao cliente.</span><span class="sxs-lookup"><span data-stu-id="14de4-115">Any output buffer from [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) must be sent back to the client.</span></span> <span data-ttu-id="14de4-116">Além disso, se o status de retorno exigir que o protocolo Continue (s \_ eu \_ continuar a \_ necessidade ou SEC \_ que \_ conclua \_ e \_ continuar), será necessária outra troca de mensagens com o cliente.</span><span class="sxs-lookup"><span data-stu-id="14de4-116">In addition, if the return status requires the protocol to continue (SEC\_I\_CONTINUE\_NEEDED or SEC\_I\_COMPLETE\_AND\_CONTINUE), another message exchange with the client is required.</span></span>

<span data-ttu-id="14de4-117">Para segmentos adicionais, o servidor aguarda que o cliente responda com outra mensagem.</span><span class="sxs-lookup"><span data-stu-id="14de4-117">For additional legs, the server waits for the client to respond with another message.</span></span> <span data-ttu-id="14de4-118">Essa espera pode ter atingido o tempo limite para evitar um ataque de negação de serviço em que um cliente nunca responde, causando um thread de servidor e, em breve, todos os threads de servidor, para parar de responder.</span><span class="sxs-lookup"><span data-stu-id="14de4-118">This wait can be timed out so as to avoid a denial of service attack where a client purposely never responds, causing a server thread and soon, all server threads, to stop responding.</span></span>

 

 
