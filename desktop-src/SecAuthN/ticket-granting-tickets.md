---
description: Como o protocolo Kerberos foi originalmente projetado, uma chave mestra para um usuário foi derivada de uma senha fornecida pelo usuário.
ms.assetid: b8fcb68d-751e-4495-ab92-8b70c96aaa7a
title: Tíquetes de Ticket-Granting
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 39dff161ba2d905f676fe6b6b5e7e7d5289ee550
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104090453"
---
# <a name="ticket-granting-tickets"></a><span data-ttu-id="99531-103">Tíquetes de Ticket-Granting</span><span class="sxs-lookup"><span data-stu-id="99531-103">Ticket-Granting Tickets</span></span>

<span data-ttu-id="99531-104">Como o [*protocolo Kerberos*](../secgloss/k-gly.md) foi originalmente projetado, uma chave mestra para um usuário foi derivada de uma senha fornecida pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="99531-104">As the [*Kerberos protocol*](../secgloss/k-gly.md) was originally designed, a master key for a user was derived from a password provided by the user.</span></span> <span data-ttu-id="99531-105">Quando um usuário fez logon, o cliente Kerberos na estação de trabalho do usuário aceitou a senha do usuário e a converteu em uma chave de criptografia passando o texto por meio de uma função de [*hash*](../secgloss/h-gly.md) unidirecional.</span><span class="sxs-lookup"><span data-stu-id="99531-105">When a user logged on, the Kerberos client on the user's workstation accepted the password from the user and converted it into an encryption key by passing the text through a one-way [*hash*](../secgloss/h-gly.md) function.</span></span> <span data-ttu-id="99531-106">O hash resultante era a [*chave mestra*](../secgloss/m-gly.md)do usuário.</span><span class="sxs-lookup"><span data-stu-id="99531-106">The resulting hash was the user's [*master key*](../secgloss/m-gly.md).</span></span> <span data-ttu-id="99531-107">O cliente usou essa *chave mestra* para descriptografar [*as chaves de sessão*](../secgloss/s-gly.md) recebidas do KDC.</span><span class="sxs-lookup"><span data-stu-id="99531-107">The client used this *master key* to decrypt [*session keys*](../secgloss/s-gly.md) received from KDC.</span></span>

<span data-ttu-id="99531-108">O problema com o design do Kerberos original é que o cliente precisa da chave mestra do usuário sempre que descriptografa uma chave de sessão do KDC.</span><span class="sxs-lookup"><span data-stu-id="99531-108">The problem with the original Kerberos design is the client needs the user's master key each time it decrypts a session key from the KDC.</span></span> <span data-ttu-id="99531-109">Isso significa que o cliente deve solicitar a senha ao usuário no início de cada troca de cliente/servidor ou o cliente deve armazenar a chave do usuário na estação de trabalho.</span><span class="sxs-lookup"><span data-stu-id="99531-109">That means either the client must ask the user for the password at the beginning of every client/server exchange, or the client must store the user's key on the workstation.</span></span> <span data-ttu-id="99531-110">Interrupções frequentes do usuário são muito invasivas.</span><span class="sxs-lookup"><span data-stu-id="99531-110">Frequent interruptions of the user are too intrusive.</span></span> <span data-ttu-id="99531-111">Armazenar a chave nos riscos da estação de trabalho compromete uma chave derivada da senha do usuário, que é uma chave de longo prazo.</span><span class="sxs-lookup"><span data-stu-id="99531-111">Storing the key on the workstation risks compromising a key derived from the user password which is a long term key.</span></span>

<span data-ttu-id="99531-112">A solução do protocolo Kerberos para esse problema é que o cliente obtenha uma chave temporária do KDC.</span><span class="sxs-lookup"><span data-stu-id="99531-112">The Kerberos protocol's solution to this problem is for the client to get a temporary key from the KDC.</span></span> <span data-ttu-id="99531-113">Essa chave temporária é boa somente para esta [*sessão de logon*](../secgloss/l-gly.md).</span><span class="sxs-lookup"><span data-stu-id="99531-113">This temporary key is good only for this [*logon session*](../secgloss/l-gly.md).</span></span> <span data-ttu-id="99531-114">Quando um usuário faz logon, o cliente solicita um tíquete para o KDC da mesma forma que solicitaria um tíquete para qualquer outro serviço.</span><span class="sxs-lookup"><span data-stu-id="99531-114">When a user logs on, the client requests a ticket for the KDC just as it would request a ticket for any other service.</span></span> <span data-ttu-id="99531-115">O KDC responde criando uma chave de sessão de logon e um tíquete para um servidor especial, o serviço de concessão de tíquete completo do KDC.</span><span class="sxs-lookup"><span data-stu-id="99531-115">The KDC responds by creating a logon session key and a ticket for a special server, the KDC's full ticket-granting service.</span></span> <span data-ttu-id="99531-116">Uma cópia da chave de sessão de logon é inserida no tíquete e o tíquete é criptografado com a chave mestra do KDC.</span><span class="sxs-lookup"><span data-stu-id="99531-116">One copy of the logon session key is embedded in the ticket, and the ticket is encrypted with the KDC's master key.</span></span> <span data-ttu-id="99531-117">Outra cópia da chave de sessão de logon é criptografada com a chave mestra do usuário derivada da senha de logon do usuário.</span><span class="sxs-lookup"><span data-stu-id="99531-117">Another copy of the logon session key is encrypted with the user's master key derived from the user's logon password.</span></span> <span data-ttu-id="99531-118">O tíquete e a chave de sessão criptografada são enviados ao cliente.</span><span class="sxs-lookup"><span data-stu-id="99531-118">Both the ticket and the encrypted session key are sent to the client.</span></span>

<span data-ttu-id="99531-119">Quando o cliente obtém a resposta do KDC, ele descriptografa a chave de sessão de logon com a chave mestra do usuário derivada da senha do usuário.</span><span class="sxs-lookup"><span data-stu-id="99531-119">When the client gets the KDC's reply, it decrypts the logon session key with the user's master key derived from the user's password.</span></span> <span data-ttu-id="99531-120">O cliente não precisa mais da chave derivada da senha do usuário, pois agora o cliente usará a chave de sessão de logon para descriptografar sua cópia de qualquer chave de sessão de servidor obtida do KDC.</span><span class="sxs-lookup"><span data-stu-id="99531-120">The client no longer needs the key derived from the user's password because the client will now use the logon session key to decrypt its copy of any server session key it gets from the KDC.</span></span> <span data-ttu-id="99531-121">O cliente armazena a chave de sessão de logon em seu cache de tíquete junto com seu tíquete para o serviço de concessão de tíquete completo do KDC.</span><span class="sxs-lookup"><span data-stu-id="99531-121">The client stores the logon session key in its ticket cache along with its ticket for the KDC's full ticket-granting service.</span></span>

<span data-ttu-id="99531-122">O tíquete para o serviço de concessão de tíquete completo é chamado de tíquete de concessão de tíquete (TGT).</span><span class="sxs-lookup"><span data-stu-id="99531-122">The ticket for the full ticket-granting service is called a ticket-granting ticket (TGT).</span></span> <span data-ttu-id="99531-123">Quando o cliente solicita ao KDC um tíquete para um servidor, ele apresenta [*credenciais*](../secgloss/c-gly.md) na forma de uma mensagem de autenticador e um tíquete — nesse caso, um TGT — da mesma forma que apresentaria credenciais para qualquer outro serviço.</span><span class="sxs-lookup"><span data-stu-id="99531-123">When the client asks the KDC for a ticket to a server, it presents [*credentials*](../secgloss/c-gly.md) in the form of an authenticator message and a ticket — in this case a TGT — just as it would present credentials to any other service.</span></span> <span data-ttu-id="99531-124">O serviço de concessão de tíquete abre o TGT com sua chave mestra, extrai a chave de sessão de logon para esse cliente e usa a chave de sessão de logon para criptografar a cópia de uma chave de sessão do cliente para o servidor.</span><span class="sxs-lookup"><span data-stu-id="99531-124">The ticket-granting service opens the TGT with its master key, extracts the logon session key for this client, and uses the logon session key to encrypt the client's copy of a session key for the server.</span></span>

 

 
