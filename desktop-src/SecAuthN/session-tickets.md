---
description: Em vez de enviar as chaves de sessão criptografadas para ambas as entidades de segurança, o KDC envia as cópias do cliente e do servidor da chave de sessão para o cliente.
ms.assetid: 6b20ab30-2cd9-4f2e-a26b-316980c4bc78
title: Tíquetes de sessão
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 762223311dd71f8bded5e021372d3a281f711eda
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105811302"
---
# <a name="session-tickets"></a><span data-ttu-id="02925-103">Tíquetes de sessão</span><span class="sxs-lookup"><span data-stu-id="02925-103">Session Tickets</span></span>

<span data-ttu-id="02925-104">Em vez de enviar as chaves de sessão criptografadas para ambas as entidades de segurança, o [KDC](key-distribution-center.md) envia as cópias do cliente e do servidor da [*chave de sessão*](../secgloss/s-gly.md) para o cliente.</span><span class="sxs-lookup"><span data-stu-id="02925-104">Instead of sending the encrypted session keys to both of the principals, the [KDC](key-distribution-center.md) sends both the client's and the server's copies of the [*session key*](../secgloss/s-gly.md) to the client.</span></span> <span data-ttu-id="02925-105">A cópia da chave de sessão do cliente é criptografada com a [*chave mestra*](../secgloss/m-gly.md) do cliente e, portanto, não pode ser descriptografada por nenhuma outra entidade.</span><span class="sxs-lookup"><span data-stu-id="02925-105">The client's copy of the session key is encrypted with the client's [*master key*](../secgloss/m-gly.md) and therefore cannot be decrypted by any other entity.</span></span> <span data-ttu-id="02925-106">A cópia da chave de sessão do servidor é inserida, juntamente com os dados de autorização sobre o cliente, em uma estrutura de dados chamada de tíquete.</span><span class="sxs-lookup"><span data-stu-id="02925-106">The server's copy of the session key is embedded, along with authorization data about the client, in a data structure called a ticket.</span></span> <span data-ttu-id="02925-107">O tíquete é totalmente criptografado com a chave mestra do servidor e, portanto, não pode ser lido ou alterado pelo cliente ou por qualquer outra entidade que não tenha acesso à chave mestra do servidor.</span><span class="sxs-lookup"><span data-stu-id="02925-107">The ticket is entirely encrypted with the server's master key and therefore cannot be read or changed by the client or any other entity that does not have access to the server's master key.</span></span> <span data-ttu-id="02925-108">É responsabilidade do cliente armazenar o tíquete com segurança até entrar em contato com o servidor.</span><span class="sxs-lookup"><span data-stu-id="02925-108">It is the responsibility of the client to store the ticket safely until contact with the server.</span></span>

> [!Note]  
> <span data-ttu-id="02925-109">O KDC fornece apenas um serviço de concessão de tíquetes.</span><span class="sxs-lookup"><span data-stu-id="02925-109">The KDC only provides a ticket-granting service.</span></span> <span data-ttu-id="02925-110">O cliente e o servidor são responsáveis por manter suas respectivas chaves mestras seguras.</span><span class="sxs-lookup"><span data-stu-id="02925-110">The client and server are responsible for keeping their respective master keys secure.</span></span>

 

<span data-ttu-id="02925-111">Quando o cliente recebe a resposta do KDC, ele extrai o tíquete e sua própria cópia da chave de sessão, colocando-os de lado em um cache seguro.</span><span class="sxs-lookup"><span data-stu-id="02925-111">When the client receives the KDC's response, it extracts the ticket and its own copy of the session key, putting both aside in a secure cache.</span></span> <span data-ttu-id="02925-112">Para estabelecer uma sessão segura com o servidor, ele envia ao servidor uma mensagem que consiste no tíquete, ainda criptografado com a chave mestra do servidor e uma [mensagem de autenticador](authenticator-messages.md) criptografada com a chave de sessão.</span><span class="sxs-lookup"><span data-stu-id="02925-112">To establish a secure session with the server, it sends the server a message consisting of the ticket, still encrypted with the server's master key, and an [authenticator message](authenticator-messages.md) encrypted with the session key.</span></span> <span data-ttu-id="02925-113">Juntos, a mensagem de tíquete e autenticador são as [*credenciais*](../secgloss/c-gly.md) do cliente para o servidor.</span><span class="sxs-lookup"><span data-stu-id="02925-113">Together, the ticket and authenticator message are the client's [*credentials*](../secgloss/c-gly.md) to the server.</span></span>

<span data-ttu-id="02925-114">Quando o servidor recebe credenciais de um cliente, ele descriptografa o tíquete com sua [*chave mestra*](../secgloss/m-gly.md), extrai a chave de [*sessão*](../secgloss/s-gly.md)e usa a chave de sessão para descriptografar a mensagem do autenticador do cliente.</span><span class="sxs-lookup"><span data-stu-id="02925-114">When the server receives credentials from a client, it decrypts the ticket with its [*master key*](../secgloss/m-gly.md), extracts the [*session key*](../secgloss/s-gly.md), and uses the session key to decrypt the client's authenticator message.</span></span> <span data-ttu-id="02925-115">Se tudo fizer check-out, o servidor saberá que as credenciais do cliente foram emitidas pelo KDC, uma autoridade confiável.</span><span class="sxs-lookup"><span data-stu-id="02925-115">If everything checks out, the server knows that the client's credentials were issued by the KDC, a trusted authority.</span></span> <span data-ttu-id="02925-116">Para a autenticação mútua, o servidor responde criptografando o carimbo de data/hora da mensagem do autenticador do cliente usando a chave de sessão.</span><span class="sxs-lookup"><span data-stu-id="02925-116">For mutual authentication, the server responds by encrypting the time stamp from the client's authenticator message using the session key.</span></span> <span data-ttu-id="02925-117">Essa mensagem criptografada é enviada ao cliente.</span><span class="sxs-lookup"><span data-stu-id="02925-117">This encrypted message is sent to the client.</span></span> <span data-ttu-id="02925-118">Em seguida, o cliente descriptografa a mensagem.</span><span class="sxs-lookup"><span data-stu-id="02925-118">The client then decrypts the message.</span></span> <span data-ttu-id="02925-119">Se a mensagem retornada for a mesma do carimbo de data/hora na mensagem do autenticador original, o servidor será autenticado.</span><span class="sxs-lookup"><span data-stu-id="02925-119">If the returned message is the same as the time stamp in the original authenticator message, the server is authenticated.</span></span>

<span data-ttu-id="02925-120">Como um benefício adicional, o servidor não precisa armazenar as chaves de sessão que ele usa com seus clientes.</span><span class="sxs-lookup"><span data-stu-id="02925-120">As an added benefit, the server does not need to store the session keys it uses with its clients.</span></span> <span data-ttu-id="02925-121">É responsabilidade de cada cliente gerenciar o tíquete para o servidor em seu cache de tíquetes e apresentar esse tíquete toda vez que ele acessar o servidor.</span><span class="sxs-lookup"><span data-stu-id="02925-121">It is each client's responsibility to manage the ticket for the server in its ticket cache and to present that ticket each time it accesses the server.</span></span> <span data-ttu-id="02925-122">Sempre que o servidor recebe um tíquete de um cliente, ele usa sua chave mestra para descriptografar o tíquete e extrair a chave de sessão.</span><span class="sxs-lookup"><span data-stu-id="02925-122">Whenever the server receives a ticket from a client, it uses its master key to decrypt the ticket and extract the session key.</span></span> <span data-ttu-id="02925-123">Quando o servidor não precisar mais da chave de sessão, a chave será excluída.</span><span class="sxs-lookup"><span data-stu-id="02925-123">When the server no longer needs the session key, the key is deleted.</span></span>

<span data-ttu-id="02925-124">O cliente não precisa acessar o KDC cada vez que desejar acessar esse servidor específico.</span><span class="sxs-lookup"><span data-stu-id="02925-124">The client does not need to access the KDC each time it wants access to this particular server.</span></span> <span data-ttu-id="02925-125">Tíquetes podem ser reutilizados.</span><span class="sxs-lookup"><span data-stu-id="02925-125">Tickets can be reused.</span></span> <span data-ttu-id="02925-126">Como uma precaução contra a possibilidade de roubo de tíquete, os tíquetes têm um tempo de expiração, especificado pelo KDC na estrutura do tíquete.</span><span class="sxs-lookup"><span data-stu-id="02925-126">As a precaution against the possibility of ticket theft, tickets have an expiration time, specified by the KDC in the ticket structure.</span></span> <span data-ttu-id="02925-127">Por quanto tempo um tíquete é válido depende da política Kerberos para o realm.</span><span class="sxs-lookup"><span data-stu-id="02925-127">How long a ticket is valid depends on Kerberos policy for the realm.</span></span> <span data-ttu-id="02925-128">Normalmente, os tíquetes são bons por não mais do que oito horas, sobre o comprimento de uma [*sessão de logon*](../secgloss/l-gly.md)normal.</span><span class="sxs-lookup"><span data-stu-id="02925-128">Typically, tickets are good for no longer than eight hours, about the length of a normal [*logon session*](../secgloss/l-gly.md).</span></span> <span data-ttu-id="02925-129">Quando o usuário em uma estação de trabalho cliente faz logoff, o cache de tíquete do cliente é liberado e todas as permissões e as chaves de sessão do cliente são destruídas.</span><span class="sxs-lookup"><span data-stu-id="02925-129">When the user at a client workstation logs off, the client ticket cache is flushed and all tickets and client session keys are destroyed.</span></span>

 

 
