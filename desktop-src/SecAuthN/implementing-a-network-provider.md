---
description: Um provedor de rede é uma DLL que permite que o sistema operacional Windows dê suporte a um protocolo de rede específico.
ms.assetid: 21dfa941-72fd-4f2c-8bc4-379ed6ca2a4c
title: Implementando um provedor de rede
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 97819b033c57feb25cf882f97051785123e2e382
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104089950"
---
# <a name="implementing-a-network-provider"></a><span data-ttu-id="a5d9c-103">Implementando um provedor de rede</span><span class="sxs-lookup"><span data-stu-id="a5d9c-103">Implementing a Network Provider</span></span>

<span data-ttu-id="a5d9c-104">Um provedor de rede é uma DLL que permite que o sistema operacional Windows dê suporte a um protocolo de rede específico.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-104">A network provider is a DLL that enables the Windows operating system to support a specific network protocol.</span></span> <span data-ttu-id="a5d9c-105">Ele faz isso implementando a API do provedor de rede.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-105">It does this by implementing the Network Provider API.</span></span> <span data-ttu-id="a5d9c-106">Essa API é um conjunto de funções que o [*roteador do provedor múltiplo*](../secgloss/m-gly.md) (MPR) chama para se comunicar com a rede.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-106">This API is a set of functions the [*Multiple Provider Router*](../secgloss/m-gly.md) (MPR) calls to communicate with the network.</span></span> <span data-ttu-id="a5d9c-107">O provedor de rede converte essas chamadas em chamadas à API específicas da rede para executar a ação especificada pelo MPR.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-107">The network provider then translates these calls into network-specific API calls to perform the action specified by the MPR.</span></span> <span data-ttu-id="a5d9c-108">Dessa forma, o sistema operacional Windows pode interagir com novos protocolos de rede sem precisar entender suas APIs específicas de rede.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-108">In this way, the Windows operating system can interact with new network protocols without having to understand their network-specific APIs.</span></span>

<span data-ttu-id="a5d9c-109">Para criar um provedor de rede, grave uma DLL que exporta a função [**NPGetCaps**](/windows/desktop/api/Npapi/nf-npapi-npgetcaps) .</span><span class="sxs-lookup"><span data-stu-id="a5d9c-109">To create a network provider, write a DLL that exports the [**NPGetCaps**](/windows/desktop/api/Npapi/nf-npapi-npgetcaps) function.</span></span>

<span data-ttu-id="a5d9c-110">O suporte das outras funções na API do provedor de rede é opcional.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-110">Support of the other functions in the Network Provider API is optional.</span></span> <span data-ttu-id="a5d9c-111">Se o seu provedor de rede não exigir uma função, sua DLL não precisará implementá-la nem fornecer uma implementação de stub.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-111">If your network provider does not require a function, your DLL does not need to implement it or provide a stub implementation.</span></span> <span data-ttu-id="a5d9c-112">Para obter mais informações, consulte os tópicos de função individuais em [funções de provedor de rede](authentication-functions.md).</span><span class="sxs-lookup"><span data-stu-id="a5d9c-112">For more information, see the individual function topics in [Network Provider Functions](authentication-functions.md).</span></span>

<span data-ttu-id="a5d9c-113">A exceção é que, se você oferecer suporte a uma das seguintes funções de enumeração, deverá oferecer suporte às outras duas funções também: [**NPOpenEnum**](/windows/desktop/api/Npapi/nf-npapi-npopenenum), [**NPEnumResource**](/windows/desktop/api/Npapi/nf-npapi-npenumresource)e [**NPCloseEnum**](/windows/desktop/api/Npapi/nf-npapi-npcloseenum).</span><span class="sxs-lookup"><span data-stu-id="a5d9c-113">The exception is that if you support one of the following enumeration functions, you must support the other two functions as well: [**NPOpenEnum**](/windows/desktop/api/Npapi/nf-npapi-npopenenum), [**NPEnumResource**](/windows/desktop/api/Npapi/nf-npapi-npenumresource), and [**NPCloseEnum**](/windows/desktop/api/Npapi/nf-npapi-npcloseenum).</span></span>

<span data-ttu-id="a5d9c-114">As diretrizes a seguir descrevem como escrever um provedor de rede que interage bem com o MPR e o sistema operacional Windows.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-114">The following guidelines describe how to write a network provider that interacts well with the MPR and the Windows operating system.</span></span> <span data-ttu-id="a5d9c-115">Sempre que possível, seu provedor deve aderir às diretrizes a seguir para velocidade, validação e roteamento.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-115">Whenever possible, your provider should adhere to the following guidelines for speed, validation, and routing.</span></span>

## <a name="speed"></a><span data-ttu-id="a5d9c-116">Velocidade</span><span class="sxs-lookup"><span data-stu-id="a5d9c-116">Speed</span></span>

<span data-ttu-id="a5d9c-117">Um provedor de rede deve determinar rapidamente se um recurso de rede é seu.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-117">A network provider should quickly determine whether a network resource is its own.</span></span> <span data-ttu-id="a5d9c-118">Isso ocorre porque o MPR pode ter que percorrer muitos provedores para localizar o proprietário de um recurso.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-118">This is because the MPR may have to cycle through many providers to find the owner of a resource.</span></span>

<span data-ttu-id="a5d9c-119">Se o provedor de rede não possuir o recurso, ele deverá retornar imediatamente o \_ código de \_ status de NetName do WN inválido.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-119">If the network provider does not own the resource, it should immediately return the WN\_BAD\_NETNAME status code.</span></span>

<span data-ttu-id="a5d9c-120">Também é importante que os provedores que dão suporte ao [**NPGetDirectoryType**](/windows/desktop/api/Npapi/nf-npapi-npgetdirectorytype) retornem os resultados para essa função rapidamente, pois ele é chamado enquanto Winfile está pintando a árvore de diretórios.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-120">It is also important that providers that support [**NPGetDirectoryType**](/windows/desktop/api/Npapi/nf-npapi-npgetdirectorytype) return results for this function quickly because it is called while WinFile is painting the directory tree.</span></span>

## <a name="validation"></a><span data-ttu-id="a5d9c-121">Validação</span><span class="sxs-lookup"><span data-stu-id="a5d9c-121">Validation</span></span>

<span data-ttu-id="a5d9c-122">A ordem de validação é importante.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-122">The order of validation is important.</span></span> <span data-ttu-id="a5d9c-123">Um provedor de rede deve primeiro determinar se sua rede foi iniciada e, em seguida, determinar se a rede e o provedor de rede dão suporte à operação.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-123">A network provider should first determine whether its network is started and then determine whether the network and network provider support the operation.</span></span> <span data-ttu-id="a5d9c-124">Se, após essas verificações, o provedor de rede receber qualquer recurso de rede, ele deverá determinar se ele é proprietário deles.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-124">If, after these checks, the network provider receives any network resources, it should determine whether it owns them.</span></span> <span data-ttu-id="a5d9c-125">Por fim, ele deve validar outros parâmetros.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-125">Finally, it should validate other parameters.</span></span>

## <a name="routing"></a><span data-ttu-id="a5d9c-126">Roteamento</span><span class="sxs-lookup"><span data-stu-id="a5d9c-126">Routing</span></span>

<span data-ttu-id="a5d9c-127">Se o MPR tiver que percorrer os provedores de rede, ele tentará todos os provedores até que um aceite a chamada.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-127">If the MPR has to cycle through network providers, it will try all providers until one accepts the call.</span></span> <span data-ttu-id="a5d9c-128">Em outras palavras, o MPR sempre continua a tentar localizar um provedor de rede.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-128">In other words, the MPR always continues to try to find a network provider.</span></span>

<span data-ttu-id="a5d9c-129">No entanto, ele anota o primeiro erro significativo relatado por um provedor.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-129">It does, however, take note of the first significant error reported by a provider.</span></span> <span data-ttu-id="a5d9c-130">Erros, como um erro de \_ \_ netpath inválido, erro de \_ \_ nome de rede incorreto \_ , \_ \_ parâmetro de erro inválido, \_ nível inválido de erro \_ são considerados insignificantes porque simplesmente significam que o provedor não gerencia o recurso.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-130">Errors such as ERROR\_BAD\_NETPATH, ERROR\_BAD\_NET\_NAME, ERROR\_INVALID\_PARAMETER, ERROR\_INVALID\_LEVEL are considered insignificant because they simply mean that the provider does not manage the resource.</span></span> <span data-ttu-id="a5d9c-131">No entanto, se o provedor falhar com o erro de erro de \_ senha inválida \_ ou algum outro erro significativo, o MPR registrará esse erro e continuará a percorrer os provedores de rede.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-131">However, if the provider fails with the error ERROR\_INVALID\_PASSWORD or some other significant error, MPR records this error and continues cycling through the network providers.</span></span> <span data-ttu-id="a5d9c-132">Em geral, ao rotear, se nenhum provedor aceitar a chamada, o MPR relatará o primeiro erro significativo que encontrará ao percorrer os provedores de rede.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-132">In general, when routing, if no provider accepts the call, the MPR reports the first significant error it encounters while cycling through the network providers.</span></span>

<span data-ttu-id="a5d9c-133">Seu provedor de rede deve assumir esse comportamento do MPR em conta ao decidir qual mensagem de erro deve ser retornada.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-133">Your network provider should take this behavior of the MPR into account when deciding what error message to return.</span></span>

## <a name="implementation-note"></a><span data-ttu-id="a5d9c-134">Observação de implementação</span><span class="sxs-lookup"><span data-stu-id="a5d9c-134">Implementation note</span></span>

<span data-ttu-id="a5d9c-135">Ao implementar DLLs do provedor de rede, o provedor não deve chamar outras [funções de rede do Windows](../wnet/windows-networking-functions.md), [APIs de shell](../shell/samples-usingthumbnailproviders.md)ou outras consultas baseadas em caminho UNC que poderiam causar a reentrada no subsistema MPR.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-135">When implementing Network Provider DLL’s, the provider must not call into other [Windows Networking Functions](../wnet/windows-networking-functions.md), [Shell APIs](../shell/samples-usingthumbnailproviders.md), or other UNC path-based queries that could cause reentry into the MPR subsystem.</span></span> <span data-ttu-id="a5d9c-136">Se você fizer essas chamadas de uma DLL de provedor de rede, o aplicativo ou outros componentes do sistema operacional poderão enfrentar contenção, desempenho insatisfatório ou deadlocks dentro do subsistema de MPR.</span><span class="sxs-lookup"><span data-stu-id="a5d9c-136">If you make such calls from a Network Provider DLL, the application, or other operating system components may experience contention, poor performance, or deadlocks inside the MPR subsystem.</span></span>

 

 
