---
description: Fornece os métodos necessários para construir e gerenciar uma APDU (unidade de dados do protocolo de aplicativo de cartão inteligente).
ms.assetid: fd84bb2e-27da-4670-b8e8-56c7948b78bb
title: Interface ISCardCmd (Scarddat. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- ISCardCmd
- ISCardCmd.Type
- ISCardCmd.get_Type
api_type:
- COM
api_location:
- Scardssp.dll
ms.openlocfilehash: f14291f3777dcdc8b661f96f94d987209100a365
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104010368"
---
# <a name="iscardcmd-interface"></a><span data-ttu-id="7436f-103">Interface ISCardCmd</span><span class="sxs-lookup"><span data-stu-id="7436f-103">ISCardCmd interface</span></span>

<span data-ttu-id="7436f-104">\[A interface **ISCardCmd** está disponível para uso nos sistemas operacionais especificados na seção requisitos.</span><span class="sxs-lookup"><span data-stu-id="7436f-104">\[The **ISCardCmd** interface is available for use in the operating systems specified in the Requirements section.</span></span> <span data-ttu-id="7436f-105">Ele não está disponível para uso no Windows Server 2003 com Service Pack 1 (SP1) e posterior, no Windows Vista, no Windows Server 2008 e em versões subsequentes do sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="7436f-105">It is not available for use in Windows Server 2003 with Service Pack 1 (SP1) and later, Windows Vista, Windows Server 2008, and subsequent versions of the operating system.</span></span> <span data-ttu-id="7436f-106">Os [módulos de cartão inteligente](/previous-versions/windows/desktop/secsmart/smart-card-modules) fornecem funcionalidade semelhante.\]</span><span class="sxs-lookup"><span data-stu-id="7436f-106">The [Smart Card Modules](/previous-versions/windows/desktop/secsmart/smart-card-modules) provide similar functionality.\]</span></span>

<span data-ttu-id="7436f-107">A interface **ISCardCmd** fornece os métodos necessários para construir e gerenciar uma APDU ( [*unidade de dados do protocolo de aplicativo*](../secgloss/a-gly.md) de [*cartão inteligente*](../secgloss/s-gly.md) ).</span><span class="sxs-lookup"><span data-stu-id="7436f-107">The **ISCardCmd** interface provides the methods needed to construct and manage a [*smart card*](../secgloss/s-gly.md) [*application protocol data unit*](../secgloss/a-gly.md) (APDU).</span></span> <span data-ttu-id="7436f-108">Essa interface encapsula dois buffers:</span><span class="sxs-lookup"><span data-stu-id="7436f-108">This interface encapsulates two buffers:</span></span>

-   <span data-ttu-id="7436f-109">O buffer APDU contém a sequência de comandos que será enviada ao cartão.</span><span class="sxs-lookup"><span data-stu-id="7436f-109">The APDU buffer contains the command sequence that will be sent to the card.</span></span>
-   <span data-ttu-id="7436f-110">O buffer APDUReply contém dados retornados do cartão após a execução do comando APDU (esses dados também são chamados de APDU de retorno).</span><span class="sxs-lookup"><span data-stu-id="7436f-110">The APDUReply buffer contains data returned from the card after execution of the APDU command (this data is also referred to as the return APDU).</span></span>

<span data-ttu-id="7436f-111">O exemplo a seguir mostra um uso típico da interface **ISCardCmd** .</span><span class="sxs-lookup"><span data-stu-id="7436f-111">The following example shows a typical use of the **ISCardCmd** interface.</span></span> <span data-ttu-id="7436f-112">A interface **ISCardCmd** é usada para criar um APDU.</span><span class="sxs-lookup"><span data-stu-id="7436f-112">The **ISCardCmd** interface is used to build an APDU.</span></span>

<span data-ttu-id="7436f-113">**Para enviar uma transação para um cartão específico**</span><span class="sxs-lookup"><span data-stu-id="7436f-113">**To submit a transaction to a specific card**</span></span>

1.  <span data-ttu-id="7436f-114">Crie uma interface [**iscard**](iscard.md) e conecte-se a um cartão inteligente.</span><span class="sxs-lookup"><span data-stu-id="7436f-114">Create an [**ISCard**](iscard.md) interface and connect to a smart card.</span></span>
2.  <span data-ttu-id="7436f-115">Crie uma interface **ISCardCmd** .</span><span class="sxs-lookup"><span data-stu-id="7436f-115">Create an **ISCardCmd** interface.</span></span>
3.  <span data-ttu-id="7436f-116">Crie um comando APDU de cartão inteligente usando a interface [**ISCardISO7816**](iscardiso7816.md) ou um dos métodos de Build **ISCardCmd** .</span><span class="sxs-lookup"><span data-stu-id="7436f-116">Build a smart card APDU command by using the [**ISCardISO7816**](iscardiso7816.md) interface or one of **ISCardCmd** build methods.</span></span>
4.  <span data-ttu-id="7436f-117">Execute o comando no cartão inteligente chamando o método de interface [**iscard**](iscard.md) apropriado.</span><span class="sxs-lookup"><span data-stu-id="7436f-117">Execute the command on the smart card by calling the appropriate [**ISCard**](iscard.md) interface method.</span></span>
5.  <span data-ttu-id="7436f-118">Avalie a resposta retornada.</span><span class="sxs-lookup"><span data-stu-id="7436f-118">Evaluate the returned response.</span></span>
6.  <span data-ttu-id="7436f-119">Repita o procedimento conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="7436f-119">Repeat the procedure as needed.</span></span>
7.  <span data-ttu-id="7436f-120">Libere a interface **ISCardCmd** e outras, conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="7436f-120">Release the **ISCardCmd** interface and others as needed.</span></span>

## <a name="members"></a><span data-ttu-id="7436f-121">Membros</span><span class="sxs-lookup"><span data-stu-id="7436f-121">Members</span></span>

<span data-ttu-id="7436f-122">A interface **ISCardCmd** herda da interface [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) .</span><span class="sxs-lookup"><span data-stu-id="7436f-122">The **ISCardCmd** interface inherits from the [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) interface.</span></span> <span data-ttu-id="7436f-123">**ISCardCmd** também tem estes tipos de membros:</span><span class="sxs-lookup"><span data-stu-id="7436f-123">**ISCardCmd** also has these types of members:</span></span>

-   [<span data-ttu-id="7436f-124">Métodos</span><span class="sxs-lookup"><span data-stu-id="7436f-124">Methods</span></span>](#methods)
-   [<span data-ttu-id="7436f-125">Propriedades</span><span class="sxs-lookup"><span data-stu-id="7436f-125">Properties</span></span>](#properties)

### <a name="methods"></a><span data-ttu-id="7436f-126">Métodos</span><span class="sxs-lookup"><span data-stu-id="7436f-126">Methods</span></span>

<span data-ttu-id="7436f-127">A interface **ISCardCmd** tem esses métodos.</span><span class="sxs-lookup"><span data-stu-id="7436f-127">The **ISCardCmd** interface has these methods.</span></span>



| <span data-ttu-id="7436f-128">Método</span><span class="sxs-lookup"><span data-stu-id="7436f-128">Method</span></span>                                       | <span data-ttu-id="7436f-129">Descrição</span><span class="sxs-lookup"><span data-stu-id="7436f-129">Description</span></span>                                                                                                |
|:---------------------------------------------|:-----------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="7436f-130">**BuildCmd**</span><span class="sxs-lookup"><span data-stu-id="7436f-130">**BuildCmd**</span></span>](iscardcmd-buildcmd.md)       | <span data-ttu-id="7436f-131">Constrói um APDU de comando válido para transmissão para um cartão inteligente.</span><span class="sxs-lookup"><span data-stu-id="7436f-131">Constructs a valid command APDU for transmission to a smart card.</span></span><br/>                               |
| [<span data-ttu-id="7436f-132">**Formatação**</span><span class="sxs-lookup"><span data-stu-id="7436f-132">**Clear**</span></span>](iscardcmd-clear.md)             | <span data-ttu-id="7436f-133">Limpa os buffers de mensagens APDU e Reply APDU.</span><span class="sxs-lookup"><span data-stu-id="7436f-133">Clears the APDU and the reply APDU message buffers.</span></span><br/>                                             |
| [<span data-ttu-id="7436f-134">**Encapsular**</span><span class="sxs-lookup"><span data-stu-id="7436f-134">**Encapsulate**</span></span>](iscardcmd-encapsulate.md) | <span data-ttu-id="7436f-135">Encapsula o APDU de comando fornecido em outro APDU de comando para transmissão para um cartão inteligente.</span><span class="sxs-lookup"><span data-stu-id="7436f-135">Encapsulates the given command APDU into another command APDU for transmission to a smart card.</span></span><br/> |



 

### <a name="properties"></a><span data-ttu-id="7436f-136">Propriedades</span><span class="sxs-lookup"><span data-stu-id="7436f-136">Properties</span></span>

<span data-ttu-id="7436f-137">A interface **ISCardCmd** tem essas propriedades.</span><span class="sxs-lookup"><span data-stu-id="7436f-137">The **ISCardCmd** interface has these properties.</span></span>



| <span data-ttu-id="7436f-138">Propriedade</span><span class="sxs-lookup"><span data-stu-id="7436f-138">Property</span></span>                                                              | <span data-ttu-id="7436f-139">Tipo de acesso</span><span class="sxs-lookup"><span data-stu-id="7436f-139">Access type</span></span>           | <span data-ttu-id="7436f-140">Descrição</span><span class="sxs-lookup"><span data-stu-id="7436f-140">Description</span></span>                                                                                                                                                         |
|:----------------------------------------------------------------------|:----------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="7436f-141">**AlternateClassId**</span><span class="sxs-lookup"><span data-stu-id="7436f-141">**AlternateClassId**</span></span>](iscardcmd-get-alternateclassid.md)<br/> | <span data-ttu-id="7436f-142">Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="7436f-142">Read/write</span></span><br/> | <span data-ttu-id="7436f-143">Valor atual da ID de classe alternativa.</span><span class="sxs-lookup"><span data-stu-id="7436f-143">Current alternate class ID value.</span></span><br/>                                                                                                                        |
| [<span data-ttu-id="7436f-144">**APDU**</span><span class="sxs-lookup"><span data-stu-id="7436f-144">**Apdu**</span></span>](iscardcmd-get-apdu.md)<br/>                         | <span data-ttu-id="7436f-145">Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="7436f-145">Read/write</span></span><br/> | <span data-ttu-id="7436f-146">APDU ( [*unidade de dados do protocolo de aplicativo*](../secgloss/a-gly.md) bruto).</span><span class="sxs-lookup"><span data-stu-id="7436f-146">Raw [*application protocol data unit*](../secgloss/a-gly.md) (APDU).</span></span><br/> |
| [<span data-ttu-id="7436f-147">**ApduLength**</span><span class="sxs-lookup"><span data-stu-id="7436f-147">**ApduLength**</span></span>](iscardcmd-get-apdulength.md)<br/>             | <span data-ttu-id="7436f-148">Somente leitura</span><span class="sxs-lookup"><span data-stu-id="7436f-148">Read-only</span></span><br/>  | <span data-ttu-id="7436f-149">Comprimento do APDU.</span><span class="sxs-lookup"><span data-stu-id="7436f-149">Length of the APDU.</span></span><br/>                                                                                                                                      |
| [<span data-ttu-id="7436f-150">**ApduReply**</span><span class="sxs-lookup"><span data-stu-id="7436f-150">**ApduReply**</span></span>](iscardcmd-get-apdureply.md)<br/>               | <span data-ttu-id="7436f-151">Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="7436f-151">Read/write</span></span><br/> | <span data-ttu-id="7436f-152">[*Responder APDU*](../secgloss/r-gly.md).</span><span class="sxs-lookup"><span data-stu-id="7436f-152">[*Reply APDU*](../secgloss/r-gly.md).</span></span><br/>                                                                        |
| [<span data-ttu-id="7436f-153">**ApduReplyLength**</span><span class="sxs-lookup"><span data-stu-id="7436f-153">**ApduReplyLength**</span></span>](iscardcmd-get-apdureplylength.md)<br/>   | <span data-ttu-id="7436f-154">Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="7436f-154">Read/write</span></span><br/> | <span data-ttu-id="7436f-155">Comprimento da APDU de resposta.</span><span class="sxs-lookup"><span data-stu-id="7436f-155">Length of the reply APDU.</span></span><br/>                                                                                                                                |
| [<span data-ttu-id="7436f-156">**ClassId**</span><span class="sxs-lookup"><span data-stu-id="7436f-156">**ClassId**</span></span>](iscardcmd-get-classid.md)<br/>                   | <span data-ttu-id="7436f-157">Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="7436f-157">Read/write</span></span><br/> | <span data-ttu-id="7436f-158">ID de classe do APDU.</span><span class="sxs-lookup"><span data-stu-id="7436f-158">Class ID of the APDU.</span></span><br/>                                                                                                                                    |
| [<span data-ttu-id="7436f-159">**Dados**</span><span class="sxs-lookup"><span data-stu-id="7436f-159">**Data**</span></span>](iscardcmd-get-data.md)<br/>                         | <span data-ttu-id="7436f-160">Somente leitura</span><span class="sxs-lookup"><span data-stu-id="7436f-160">Read-only</span></span><br/>  | <span data-ttu-id="7436f-161">Campo de dados do APDU.</span><span class="sxs-lookup"><span data-stu-id="7436f-161">Data field of the APDU.</span></span><br/>                                                                                                                                  |
| [<span data-ttu-id="7436f-162">**Instrução**</span><span class="sxs-lookup"><span data-stu-id="7436f-162">**InstructionId**</span></span>](iscardcmd-get-instructionid.md)<br/>       | <span data-ttu-id="7436f-163">Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="7436f-163">Read/write</span></span><br/> | <span data-ttu-id="7436f-164">Byte de ID de instrução do APDU.</span><span class="sxs-lookup"><span data-stu-id="7436f-164">Instruction ID byte from the APDU.</span></span><br/>                                                                                                                       |
| [<span data-ttu-id="7436f-165">**LeField**</span><span class="sxs-lookup"><span data-stu-id="7436f-165">**LeField**</span></span>](iscardcmd-get-lefield.md)<br/>                   | <span data-ttu-id="7436f-166">Somente leitura</span><span class="sxs-lookup"><span data-stu-id="7436f-166">Read-only</span></span><br/>  | <span data-ttu-id="7436f-167">Campo Le do APDU.</span><span class="sxs-lookup"><span data-stu-id="7436f-167">Le field of the APDU.</span></span><br/>                                                                                                                                    |
| [<span data-ttu-id="7436f-168">**Nad**</span><span class="sxs-lookup"><span data-stu-id="7436f-168">**Nad**</span></span>](iscardcmd-put-nad.md)<br/>                           | <span data-ttu-id="7436f-169">Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="7436f-169">Read/write</span></span><br/> | <span data-ttu-id="7436f-170">Endereço do nó.</span><span class="sxs-lookup"><span data-stu-id="7436f-170">Node address.</span></span><br/>                                                                                                                                            |
| [<span data-ttu-id="7436f-171">**P1**</span><span class="sxs-lookup"><span data-stu-id="7436f-171">**P1**</span></span>](iscardcmd-get-p1.md)<br/>                             | <span data-ttu-id="7436f-172">Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="7436f-172">Read/write</span></span><br/> | <span data-ttu-id="7436f-173">Primeiro byte de parâmetro do APDU.</span><span class="sxs-lookup"><span data-stu-id="7436f-173">First parameter byte of the APDU.</span></span><br/>                                                                                                                        |
| [<span data-ttu-id="7436f-174">**P2**</span><span class="sxs-lookup"><span data-stu-id="7436f-174">**P2**</span></span>](iscardcmd-get-p2.md)<br/>                             | <span data-ttu-id="7436f-175">Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="7436f-175">Read/write</span></span><br/> | <span data-ttu-id="7436f-176">Segundo parâmetro byte do APDU.</span><span class="sxs-lookup"><span data-stu-id="7436f-176">Second parameter byte of the APDU.</span></span><br/>                                                                                                                       |
| [<span data-ttu-id="7436f-177">**P3**</span><span class="sxs-lookup"><span data-stu-id="7436f-177">**P3**</span></span>](iscardcmd-get-p3.md)<br/>                             | <span data-ttu-id="7436f-178">Somente leitura</span><span class="sxs-lookup"><span data-stu-id="7436f-178">Read-only</span></span><br/>  | <span data-ttu-id="7436f-179">Terceiro byte de parâmetro do APDU.</span><span class="sxs-lookup"><span data-stu-id="7436f-179">Third parameter byte of the APDU.</span></span><br/>                                                                                                                        |
| [<span data-ttu-id="7436f-180">**ReplyNad**</span><span class="sxs-lookup"><span data-stu-id="7436f-180">**ReplyNad**</span></span>](iscardcmd-get-replynad.md)<br/>                 | <span data-ttu-id="7436f-181">Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="7436f-181">Read/write</span></span><br/> | <span data-ttu-id="7436f-182">Endereço do nó usado pelo cartão na mensagem de resposta.</span><span class="sxs-lookup"><span data-stu-id="7436f-182">Node address used by the card in the reply message.</span></span><br/>                                                                                                      |
| [<span data-ttu-id="7436f-183">**ReplyStatus**</span><span class="sxs-lookup"><span data-stu-id="7436f-183">**ReplyStatus**</span></span>](iscardcmd-get-replystatus.md)<br/>           | <span data-ttu-id="7436f-184">Leitura/gravação</span><span class="sxs-lookup"><span data-stu-id="7436f-184">Read/write</span></span><br/> | <span data-ttu-id="7436f-185">[*Responder*](../secgloss/r-gly.md) à palavra de status da mensagem APDU.</span><span class="sxs-lookup"><span data-stu-id="7436f-185">[*Reply APDU*](../secgloss/r-gly.md) message status word.</span></span><br/>                                                    |
| [<span data-ttu-id="7436f-186">**ReplyStatusSW1**</span><span class="sxs-lookup"><span data-stu-id="7436f-186">**ReplyStatusSW1**</span></span>](iscardcmd-get-replystatussw1.md)<br/>     | <span data-ttu-id="7436f-187">Somente leitura</span><span class="sxs-lookup"><span data-stu-id="7436f-187">Read-only</span></span><br/>  | <span data-ttu-id="7436f-188">Byte de status de SW1 de mensagem do APDU de resposta.</span><span class="sxs-lookup"><span data-stu-id="7436f-188">Reply APDU's message SW1 status byte.</span></span><br/>                                                                                                                    |
| [<span data-ttu-id="7436f-189">**ReplyStatusSW2**</span><span class="sxs-lookup"><span data-stu-id="7436f-189">**ReplyStatusSW2**</span></span>](iscardcmd-get-replystatussw2.md)<br/>     | <span data-ttu-id="7436f-190">Somente leitura</span><span class="sxs-lookup"><span data-stu-id="7436f-190">Read-only</span></span><br/>  | <span data-ttu-id="7436f-191">Responder o byte de status do SW2 da mensagem do APDU.</span><span class="sxs-lookup"><span data-stu-id="7436f-191">Reply APDU's message SW2 status byte.</span></span><br/>                                                                                                                    |
| <span data-ttu-id="7436f-192">**Tipo**</span><span class="sxs-lookup"><span data-stu-id="7436f-192">**Type**</span></span><br/>                                                   | <span data-ttu-id="7436f-193">Somente leitura</span><span class="sxs-lookup"><span data-stu-id="7436f-193">Read-only</span></span><br/>  | <span data-ttu-id="7436f-194">Reservado para uso futuro.</span><span class="sxs-lookup"><span data-stu-id="7436f-194">Reserved for future use.</span></span><br/>                                                                                                                                 |



 

## <a name="requirements"></a><span data-ttu-id="7436f-195">Requisitos</span><span class="sxs-lookup"><span data-stu-id="7436f-195">Requirements</span></span>



| <span data-ttu-id="7436f-196">Requisito</span><span class="sxs-lookup"><span data-stu-id="7436f-196">Requirement</span></span> | <span data-ttu-id="7436f-197">Valor</span><span class="sxs-lookup"><span data-stu-id="7436f-197">Value</span></span> |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| <span data-ttu-id="7436f-198">Cliente mínimo com suporte</span><span class="sxs-lookup"><span data-stu-id="7436f-198">Minimum supported client</span></span><br/> | <span data-ttu-id="7436f-199">\[Somente aplicativos da área de trabalho do Windows XP\]</span><span class="sxs-lookup"><span data-stu-id="7436f-199">Windows XP \[desktop apps only\]</span></span><br/>                                             |
| <span data-ttu-id="7436f-200">Servidor mínimo com suporte</span><span class="sxs-lookup"><span data-stu-id="7436f-200">Minimum supported server</span></span><br/> | <span data-ttu-id="7436f-201">\[Somente aplicativos da área de trabalho do Windows Server 2003\]</span><span class="sxs-lookup"><span data-stu-id="7436f-201">Windows Server 2003 \[desktop apps only\]</span></span><br/>                                    |
| <span data-ttu-id="7436f-202">Fim do suporte do cliente</span><span class="sxs-lookup"><span data-stu-id="7436f-202">End of client support</span></span><br/>    | <span data-ttu-id="7436f-203">Windows XP</span><span class="sxs-lookup"><span data-stu-id="7436f-203">Windows XP</span></span><br/>                                                                   |
| <span data-ttu-id="7436f-204">Fim do suporte do servidor</span><span class="sxs-lookup"><span data-stu-id="7436f-204">End of server support</span></span><br/>    | <span data-ttu-id="7436f-205">Windows Server 2003</span><span class="sxs-lookup"><span data-stu-id="7436f-205">Windows Server 2003</span></span><br/>                                                          |
| <span data-ttu-id="7436f-206">parâmetro</span><span class="sxs-lookup"><span data-stu-id="7436f-206">Header</span></span><br/>                   | <dl> <span data-ttu-id="7436f-207"><dt>Scarddat. h</dt></span><span class="sxs-lookup"><span data-stu-id="7436f-207"><dt>Scarddat.h</dt></span></span> </dl>   |
| <span data-ttu-id="7436f-208">Biblioteca de tipos</span><span class="sxs-lookup"><span data-stu-id="7436f-208">Type library</span></span><br/>             | <dl> <span data-ttu-id="7436f-209"><dt>Scarddat. tlb</dt></span><span class="sxs-lookup"><span data-stu-id="7436f-209"><dt>Scarddat.tlb</dt></span></span> </dl> |
| <span data-ttu-id="7436f-210">DLL</span><span class="sxs-lookup"><span data-stu-id="7436f-210">DLL</span></span><br/>                      | <dl> <span data-ttu-id="7436f-211"><dt>Scardssp.dll</dt></span><span class="sxs-lookup"><span data-stu-id="7436f-211"><dt>Scardssp.dll</dt></span></span> </dl> |
| <span data-ttu-id="7436f-212">IID</span><span class="sxs-lookup"><span data-stu-id="7436f-212">IID</span></span><br/>                      | <span data-ttu-id="7436f-213">IID \_ ISCardCmd é definido como D5778AE3-43DE-11D0-9171-00AA00C18068</span><span class="sxs-lookup"><span data-stu-id="7436f-213">IID\_ISCardCmd is defined as D5778AE3-43DE-11D0-9171-00AA00C18068</span></span><br/>            |



 

 
