---
description: Habilita o componente de servidor de um aplicativo de transporte para estabelecer um [*contexto de segurança*](../secgloss/s-gly.md) entre o servidor e um cliente remoto que está usando Schannel.
ms.assetid: 03fd5272-8476-4c93-8590-0d00acf6a130
title: Função AcceptSecurityContext (Schannel) (SSPI. h)
ms.topic: reference
ms.date: 07/25/2019
ms.openlocfilehash: ba353cfbe64d6471230a720680301ebab0da511a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105773923"
---
# <a name="acceptsecuritycontext-schannel-function"></a><span data-ttu-id="516b5-103">Função AcceptSecurityContext (Schannel)</span><span class="sxs-lookup"><span data-stu-id="516b5-103">AcceptSecurityContext (Schannel) function</span></span>

<span data-ttu-id="516b5-104">A função **AcceptSecurityContext (Schannel)** permite que o componente de servidor de um aplicativo de transporte estabeleça um [*contexto de segurança*](../secgloss/s-gly.md) entre o servidor e um cliente remoto.</span><span class="sxs-lookup"><span data-stu-id="516b5-104">The **AcceptSecurityContext (Schannel)** function enables the server component of a transport application to establish a [*security context*](../secgloss/s-gly.md) between the server and a remote client.</span></span> <span data-ttu-id="516b5-105">O cliente remoto usa a função [**InitializeSecurityContext (Schannel)**](initializesecuritycontext--schannel.md) para iniciar o processo de estabelecimento de um [*contexto de segurança*](../secgloss/s-gly.md).</span><span class="sxs-lookup"><span data-stu-id="516b5-105">The remote client uses the [**InitializeSecurityContext (Schannel)**](initializesecuritycontext--schannel.md) function to start the process of establishing a [*security context*](../secgloss/s-gly.md).</span></span> <span data-ttu-id="516b5-106">O servidor pode exigir um ou mais tokens de resposta do cliente remoto para concluir o estabelecimento do [*contexto de segurança*](../secgloss/s-gly.md).</span><span class="sxs-lookup"><span data-stu-id="516b5-106">The server can require one or more reply tokens from the remote client to complete establishing the [*security context*](../secgloss/s-gly.md).</span></span>

## <a name="syntax"></a><span data-ttu-id="516b5-107">Sintaxe</span><span class="sxs-lookup"><span data-stu-id="516b5-107">Syntax</span></span>


```C++
SECURITY_STATUS SEC_Entry AcceptSecurityContext(
  _In_opt_    PCredHandle    phCredential,
  _Inout_opt_ PCtxtHandle    phContext,
  _In_opt_    PSecBufferDesc pInput,
  _In_        ULONG          fContextReq,
  _In_        ULONG          TargetDataRep,
  _Inout_opt_ PCtxtHandle    phNewContext,
  _Inout_opt_ PSecBufferDesc pOutput,
  _Out_       PULONG         pfContextAttr,
  _Out_opt_   PTimeStamp     ptsTimeStamp
);
```



## <a name="parameters"></a><span data-ttu-id="516b5-108">Parâmetros</span><span class="sxs-lookup"><span data-stu-id="516b5-108">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="516b5-109">*phCredential* \[ em, opcional\]</span><span class="sxs-lookup"><span data-stu-id="516b5-109">*phCredential* \[in, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="516b5-110">Um identificador para as credenciais do servidor.</span><span class="sxs-lookup"><span data-stu-id="516b5-110">A handle to the credentials of the server.</span></span> <span data-ttu-id="516b5-111">O servidor chama a função [**falha AcquireCredentialsHandle (Schannel)**](acquirecredentialshandle--schannel.md) com o sinalizador de \_ entrada de credenciais SECPKG \_ ou SECPKG \_ cred \_ Ambos definido para recuperar esse identificador.</span><span class="sxs-lookup"><span data-stu-id="516b5-111">The server calls the [**AcquireCredentialsHandle (Schannel)**](acquirecredentialshandle--schannel.md) function with either the SECPKG\_CRED\_INBOUND or SECPKG\_CRED\_BOTH flag set to retrieve this handle.</span></span>

</dd> <dt>

<span data-ttu-id="516b5-112">*phContext* \[ entrada, saída, opcional\]</span><span class="sxs-lookup"><span data-stu-id="516b5-112">*phContext* \[in, out, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="516b5-113">Um ponteiro para uma estrutura [CtxtHandle](sspi-handles.md) .</span><span class="sxs-lookup"><span data-stu-id="516b5-113">A pointer to a [CtxtHandle](sspi-handles.md) structure.</span></span> <span data-ttu-id="516b5-114">Na primeira chamada para **AcceptSecurityContext (Schannel)**, esse ponteiro é **nulo**.</span><span class="sxs-lookup"><span data-stu-id="516b5-114">On the first call to **AcceptSecurityContext (Schannel)**, this pointer is **NULL**.</span></span> <span data-ttu-id="516b5-115">Nas chamadas subsequentes, *phContext* é o identificador para o contexto parcialmente formado que foi retornado no parâmetro *phNewContext* pela primeira chamada.</span><span class="sxs-lookup"><span data-stu-id="516b5-115">On subsequent calls, *phContext* is the handle to the partially formed context that was returned in the *phNewContext* parameter by the first call.</span></span>

</dd> <dt>

<span data-ttu-id="516b5-116">*pInput* \[ em, opcional\]</span><span class="sxs-lookup"><span data-stu-id="516b5-116">*pInput* \[in, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="516b5-117">Um ponteiro para uma estrutura [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) gerada por uma chamada de cliente para [**InitializeSecurityContext (Schannel)**](initializesecuritycontext--schannel.md) que contém o descritor de buffer de entrada.</span><span class="sxs-lookup"><span data-stu-id="516b5-117">A pointer to a [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) structure generated by a client call to [**InitializeSecurityContext (Schannel)**](initializesecuritycontext--schannel.md) that contains the input buffer descriptor.</span></span>

<span data-ttu-id="516b5-118">Ao usar o SSP ( [*provedor de suporte de segurança*](../secgloss/s-gly.md) Schannel), o primeiro buffer deve ser do tipo token SECBUFFER \_ e conter o token de segurança recebido do cliente.</span><span class="sxs-lookup"><span data-stu-id="516b5-118">When using the Schannel [*security support provider*](../secgloss/s-gly.md) (SSP), the first buffer must be of type SECBUFFER\_TOKEN and contain the security token received from the client.</span></span> <span data-ttu-id="516b5-119">O segundo buffer deve ser do tipo SECBUFFER \_ vazio.</span><span class="sxs-lookup"><span data-stu-id="516b5-119">The second buffer should be of type SECBUFFER\_EMPTY.</span></span>

</dd> <dt>

<span data-ttu-id="516b5-120">*fContextReq* \[ no\]</span><span class="sxs-lookup"><span data-stu-id="516b5-120">*fContextReq* \[in\]</span></span>
</dt> <dd>

<span data-ttu-id="516b5-121">Sinalizadores de bits que especificam os atributos exigidos pelo servidor para estabelecer o contexto.</span><span class="sxs-lookup"><span data-stu-id="516b5-121">Bit flags that specify the attributes required by the server to establish the context.</span></span> <span data-ttu-id="516b5-122">Os sinalizadores de bits podem ser combinados usando operações de bit-a-**ou** .</span><span class="sxs-lookup"><span data-stu-id="516b5-122">Bit flags can be combined by using bitwise-**OR** operations.</span></span> <span data-ttu-id="516b5-123">Esse parâmetro pode ser um ou mais dos valores a seguir.</span><span class="sxs-lookup"><span data-stu-id="516b5-123">This parameter can be one or more of the following values.</span></span>



| <span data-ttu-id="516b5-124">Valor</span><span class="sxs-lookup"><span data-stu-id="516b5-124">Value</span></span>                                                                                                                                                                                         | <span data-ttu-id="516b5-125">Significado</span><span class="sxs-lookup"><span data-stu-id="516b5-125">Meaning</span></span>                                                                                                                                                                                                 |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="ASC_REQ_ALLOCATE_MEMORY"></span><span id="asc_req_allocate_memory"></span><dl> <span data-ttu-id="516b5-126"><dt>**memória de alocação do ASC \_ req \_ \_**</dt></span><span class="sxs-lookup"><span data-stu-id="516b5-126"><dt>**ASC\_REQ\_ALLOCATE\_MEMORY**</dt></span></span> </dl> | <span data-ttu-id="516b5-127">Digest e Schannel alocarão buffers de saída para você.</span><span class="sxs-lookup"><span data-stu-id="516b5-127">Digest and Schannel will allocate output buffers for you.</span></span> <span data-ttu-id="516b5-128">Quando você terminar de usar os buffers de saída, libere-os chamando a função [**FreeContextBuffer**](/windows/win32/api/sspi/nf-sspi-freecontextbuffer) .</span><span class="sxs-lookup"><span data-stu-id="516b5-128">When you have finished using the output buffers, free them by calling the [**FreeContextBuffer**](/windows/win32/api/sspi/nf-sspi-freecontextbuffer) function.</span></span><br/> |
| <span id="ASC_REQ_CONFIDENTIALITY"></span><span id="asc_req_confidentiality"></span><dl> <span data-ttu-id="516b5-129"><dt>**\_confidencialidade de req. asc \_**</dt></span><span class="sxs-lookup"><span data-stu-id="516b5-129"><dt>**ASC\_REQ\_CONFIDENTIALITY**</dt></span></span> </dl>  | <span data-ttu-id="516b5-130">Criptografar e descriptografar mensagens.</span><span class="sxs-lookup"><span data-stu-id="516b5-130">Encrypt and decrypt messages.</span></span><br/> <span data-ttu-id="516b5-131">O SSP de resumo dá suporte a este sinalizador somente para SASL.</span><span class="sxs-lookup"><span data-stu-id="516b5-131">The Digest SSP supports this flag for SASL only.</span></span><br/>                                                                                                    |
| <span id="ASC_REQ_CONNECTION"></span><span id="asc_req_connection"></span><dl> <span data-ttu-id="516b5-132"><dt>**\_conexão de req. asc \_**</dt></span><span class="sxs-lookup"><span data-stu-id="516b5-132"><dt>**ASC\_REQ\_CONNECTION**</dt></span></span> </dl>                 | <span data-ttu-id="516b5-133">O [*contexto de segurança*](../secgloss/s-gly.md) não tratará mensagens de formatação.</span><span class="sxs-lookup"><span data-stu-id="516b5-133">The [*security context*](../secgloss/s-gly.md) will not handle formatting messages.</span></span><br/>                                                                                                                                    |
| <span id="ASC_REQ_EXTENDED_ERROR"></span><span id="asc_req_extended_error"></span><dl> <span data-ttu-id="516b5-134"><dt>**\_ \_ erro estendido de req. asc \_**</dt></span><span class="sxs-lookup"><span data-stu-id="516b5-134"><dt>**ASC\_REQ\_EXTENDED\_ERROR**</dt></span></span> </dl>    | <span data-ttu-id="516b5-135">Quando ocorrerem erros, a parte remota será notificada.</span><span class="sxs-lookup"><span data-stu-id="516b5-135">When errors occur, the remote party will be notified.</span></span><br/>                                                                                                                                        |
| <span id="ASC_REQ_MUTUAL_AUTH"></span><span id="asc_req_mutual_auth"></span><dl> <span data-ttu-id="516b5-136"><dt>**\_ \_ autenticação mútua de req. asc \_**</dt></span><span class="sxs-lookup"><span data-stu-id="516b5-136"><dt>**ASC\_REQ\_MUTUAL\_AUTH**</dt></span></span> </dl>             | <span data-ttu-id="516b5-137">O cliente é necessário para fornecer um certificado a ser usado para autenticação de cliente.</span><span class="sxs-lookup"><span data-stu-id="516b5-137">The client is required to supply a certificate to be used for client authentication.</span></span><br/>                                                                                                         |
| <span id="ASC_REQ_REPLAY_DETECT"></span><span id="asc_req_replay_detect"></span><dl> <span data-ttu-id="516b5-138"><dt>**\_detecção de \_ Replay de req do ASC \_**</dt></span><span class="sxs-lookup"><span data-stu-id="516b5-138"><dt>**ASC\_REQ\_REPLAY\_DETECT**</dt></span></span> </dl>       | <span data-ttu-id="516b5-139">Detectar pacotes reproduzidos.</span><span class="sxs-lookup"><span data-stu-id="516b5-139">Detect replayed packets.</span></span><br/>                                                                                                                                                                     |
| <span id="ASC_REQ_SEQUENCE_DETECT"></span><span id="asc_req_sequence_detect"></span><dl> <span data-ttu-id="516b5-140"><dt>**\_detecção de \_ sequência de req do ASC \_**</dt></span><span class="sxs-lookup"><span data-stu-id="516b5-140"><dt>**ASC\_REQ\_SEQUENCE\_DETECT**</dt></span></span> </dl> | <span data-ttu-id="516b5-141">Detecte mensagens recebidas fora de sequência.</span><span class="sxs-lookup"><span data-stu-id="516b5-141">Detect messages received out of sequence.</span></span><br/>                                                                                                                                                    |
| <span id="ASC_REQ_STREAM"></span><span id="asc_req_stream"></span><dl> <span data-ttu-id="516b5-142"><dt>**\_fluxo de req. asc \_**</dt></span><span class="sxs-lookup"><span data-stu-id="516b5-142"><dt>**ASC\_REQ\_STREAM**</dt></span></span> </dl>                             | <span data-ttu-id="516b5-143">Suporte a uma conexão orientada a fluxo.</span><span class="sxs-lookup"><span data-stu-id="516b5-143">Support a stream-oriented connection.</span></span><br/> <span data-ttu-id="516b5-144">Esse sinalizador tem suporte apenas pelo Schannel.</span><span class="sxs-lookup"><span data-stu-id="516b5-144">This flag is supported only by Schannel.</span></span><br/>                                                                                                    |



 

<span data-ttu-id="516b5-145">Para possíveis sinalizadores de atributo e seus significados, consulte [requisitos de contexto](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="516b5-145">For possible attribute flags and their meanings, see [Context Requirements](context-requirements.md).</span></span> <span data-ttu-id="516b5-146">Os sinalizadores usados para esse parâmetro são prefixados com o ASC \_ req, por exemplo, o \_ delegado de req ASC \_ .</span><span class="sxs-lookup"><span data-stu-id="516b5-146">Flags used for this parameter are prefixed with ASC\_REQ, for example, ASC\_REQ\_DELEGATE.</span></span>

<span data-ttu-id="516b5-147">Os atributos solicitados podem não ter suporte do cliente.</span><span class="sxs-lookup"><span data-stu-id="516b5-147">The requested attributes may not be supported by the client.</span></span> <span data-ttu-id="516b5-148">Para obter mais informações, consulte o parâmetro *pfContextAttr* .</span><span class="sxs-lookup"><span data-stu-id="516b5-148">For more information, see the *pfContextAttr* parameter.</span></span>

</dd> <dt>

<span data-ttu-id="516b5-149">*TargetDataRep* \[ no\]</span><span class="sxs-lookup"><span data-stu-id="516b5-149">*TargetDataRep* \[in\]</span></span>
</dt> <dd>

<span data-ttu-id="516b5-150">Esse parâmetro não é usado com Schannel.</span><span class="sxs-lookup"><span data-stu-id="516b5-150">This parameter is not used with Schannel.</span></span> <span data-ttu-id="516b5-151">Especifique zero para este parâmetro.</span><span class="sxs-lookup"><span data-stu-id="516b5-151">Specify zero for this parameter.</span></span>

</dd> <dt>

<span data-ttu-id="516b5-152">*phNewContext* \[ entrada, saída, opcional\]</span><span class="sxs-lookup"><span data-stu-id="516b5-152">*phNewContext* \[in, out, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="516b5-153">Um ponteiro para uma estrutura [CtxtHandle](sspi-handles.md) .</span><span class="sxs-lookup"><span data-stu-id="516b5-153">A pointer to a [CtxtHandle](sspi-handles.md) structure.</span></span> <span data-ttu-id="516b5-154">Na primeira chamada para **AcceptSecurityContext (Schannel)**, esse ponteiro recebe o novo identificador de contexto.</span><span class="sxs-lookup"><span data-stu-id="516b5-154">On the first call to **AcceptSecurityContext (Schannel)**, this pointer receives the new context handle.</span></span> <span data-ttu-id="516b5-155">Nas chamadas subsequentes, *phNewContext* pode ser o mesmo que o identificador especificado no parâmetro *phContext* .</span><span class="sxs-lookup"><span data-stu-id="516b5-155">On subsequent calls, *phNewContext* can be the same as the handle specified in the *phContext* parameter.</span></span>

</dd> <dt>

<span data-ttu-id="516b5-156">*pOutput* \[ entrada, saída, opcional\]</span><span class="sxs-lookup"><span data-stu-id="516b5-156">*pOutput* \[in, out, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="516b5-157">Um ponteiro para uma estrutura [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) que contém o descritor de buffer de saída.</span><span class="sxs-lookup"><span data-stu-id="516b5-157">A pointer to a [**SecBufferDesc**](/windows/win32/api/sspi/ns-sspi-secbufferdesc) structure that contains the output buffer descriptor.</span></span> <span data-ttu-id="516b5-158">Esse buffer é enviado ao cliente para entrada em chamadas adicionais para [**InitializeSecurityContext (Schannel)**](initializesecuritycontext--schannel.md).</span><span class="sxs-lookup"><span data-stu-id="516b5-158">This buffer is sent to the client for input into additional calls to [**InitializeSecurityContext (Schannel)**](initializesecuritycontext--schannel.md).</span></span> <span data-ttu-id="516b5-159">Um buffer de saída pode ser gerado mesmo que a função retorne s \_ E \_ OK.</span><span class="sxs-lookup"><span data-stu-id="516b5-159">An output buffer may be generated even if the function returns SEC\_E\_OK.</span></span> <span data-ttu-id="516b5-160">Qualquer buffer gerado deve ser enviado de volta para o aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="516b5-160">Any buffer generated must be sent back to the client application.</span></span>

<span data-ttu-id="516b5-161">Na saída, esse buffer recebe um token para o [*contexto de segurança*](../secgloss/s-gly.md).</span><span class="sxs-lookup"><span data-stu-id="516b5-161">On output, this buffer receives a token for the [*security context*](../secgloss/s-gly.md).</span></span> <span data-ttu-id="516b5-162">O token deve ser enviado ao cliente.</span><span class="sxs-lookup"><span data-stu-id="516b5-162">The token must be sent to the client.</span></span> <span data-ttu-id="516b5-163">A função também pode retornar um buffer do tipo SECBUFFER \_ extra.</span><span class="sxs-lookup"><span data-stu-id="516b5-163">The function can also return a buffer of type SECBUFFER\_EXTRA.</span></span> <span data-ttu-id="516b5-164">Além disso, o chamador deve passar um buffer do tipo **\_ alerta de SECBUFFER**.</span><span class="sxs-lookup"><span data-stu-id="516b5-164">In addition, the caller must pass in a buffer of type **SECBUFFER\_ALERT**.</span></span> <span data-ttu-id="516b5-165">Na saída, se um alerta for gerado, esse buffer conterá informações sobre esse alerta e a função falhará.</span><span class="sxs-lookup"><span data-stu-id="516b5-165">On output, if an alert is generated, this buffer contains information about that alert, and the function fails.</span></span>

</dd> <dt>

<span data-ttu-id="516b5-166">*pfContextAttr* \[ fora\]</span><span class="sxs-lookup"><span data-stu-id="516b5-166">*pfContextAttr* \[out\]</span></span>
</dt> <dd>

<span data-ttu-id="516b5-167">Um ponteiro para uma variável que recebe um conjunto de sinalizadores de bits que indicam os atributos do contexto estabelecido.</span><span class="sxs-lookup"><span data-stu-id="516b5-167">A pointer to a variable that receives a set of bit flags that indicate the attributes of the established context.</span></span> <span data-ttu-id="516b5-168">Para obter uma descrição dos vários atributos, consulte [requisitos de contexto](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="516b5-168">For a description of the various attributes, see [Context Requirements](context-requirements.md).</span></span> <span data-ttu-id="516b5-169">Os sinalizadores usados para esse parâmetro são prefixados com ASC \_ RET, por exemplo, o delegado de ASC \_ RET \_ .</span><span class="sxs-lookup"><span data-stu-id="516b5-169">Flags used for this parameter are prefixed with ASC\_RET, for example, ASC\_RET\_DELEGATE.</span></span>

<span data-ttu-id="516b5-170">Não verifique os atributos relacionados à segurança até que a chamada de função final seja retornada com êxito.</span><span class="sxs-lookup"><span data-stu-id="516b5-170">Do not check for security-related attributes until the final function call returns successfully.</span></span> <span data-ttu-id="516b5-171">Os sinalizadores de atributo não relacionados à segurança, como o \_ \_ sinalizador de memória alocada de ASC RET \_ , podem ser verificados antes do retorno final.</span><span class="sxs-lookup"><span data-stu-id="516b5-171">Attribute flags not related to security, such as the ASC\_RET\_ALLOCATED\_MEMORY flag, can be checked before the final return.</span></span>

</dd> <dt>

<span data-ttu-id="516b5-172">*ptsTimeStamp* \[ out, opcional\]</span><span class="sxs-lookup"><span data-stu-id="516b5-172">*ptsTimeStamp* \[out, optional\]</span></span>
</dt> <dd>

<span data-ttu-id="516b5-173">Um ponteiro para uma estrutura de [**carimbo de data/**](timestamp.md) hora que recebe o tempo de expiração do contexto.</span><span class="sxs-lookup"><span data-stu-id="516b5-173">A pointer to a [**TimeStamp**](timestamp.md) structure that receives the expiration time of the context.</span></span> <span data-ttu-id="516b5-174">É recomendável que o [*pacote de segurança*](../secgloss/s-gly.md) sempre retorne esse valor na hora local.</span><span class="sxs-lookup"><span data-stu-id="516b5-174">We recommend that the [*security package*](../secgloss/s-gly.md) always return this value in local time.</span></span>

<span data-ttu-id="516b5-175">Isso é opcional ao usar o SSP do Schannel.</span><span class="sxs-lookup"><span data-stu-id="516b5-175">This is optional when using the Schannel SSP.</span></span> <span data-ttu-id="516b5-176">Quando a parte remota forneceu um certificado a ser usado para autenticação, esse parâmetro recebe o tempo de expiração para esse certificado.</span><span class="sxs-lookup"><span data-stu-id="516b5-176">When the remote party has supplied a certificate to be used for authentication, this parameter receives the expiration time for that certificate.</span></span> <span data-ttu-id="516b5-177">Se nenhum certificado tiver sido fornecido, um valor de tempo máximo será retornado.</span><span class="sxs-lookup"><span data-stu-id="516b5-177">If no certificate was supplied, a maximum time value is returned.</span></span>

> [!Note]  
> <span data-ttu-id="516b5-178">Até a última chamada do processo de autenticação, o tempo de expiração do contexto pode estar incorreto, pois mais informações serão fornecidas durante os estágios posteriores da negociação.</span><span class="sxs-lookup"><span data-stu-id="516b5-178">Until the last call of the authentication process, the expiration time for the context can be incorrect because more information will be provided during later stages of the negotiation.</span></span> <span data-ttu-id="516b5-179">Portanto, *ptsTimeStamp* deve ser **nulo** até a última chamada para a função.</span><span class="sxs-lookup"><span data-stu-id="516b5-179">Therefore, *ptsTimeStamp* must be **NULL** until the last call to the function.</span></span>

 

</dd> </dl>

## <a name="return-value"></a><span data-ttu-id="516b5-180">Retornar valor</span><span class="sxs-lookup"><span data-stu-id="516b5-180">Return value</span></span>

<span data-ttu-id="516b5-181">Essa função retorna um dos valores a seguir.</span><span class="sxs-lookup"><span data-stu-id="516b5-181">This function returns one of the following values.</span></span>



<table><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><thead><tr class="header"><th><span data-ttu-id="516b5-182">Código/valor de retorno</span><span class="sxs-lookup"><span data-stu-id="516b5-182">Return code/value</span></span></th><th><span data-ttu-id="516b5-183">Descrição</span><span class="sxs-lookup"><span data-stu-id="516b5-183">Description</span></span></th></tr></thead><tbody><tr class="odd"><td><dl> <span data-ttu-id="516b5-184"><dt><strong>SEC_E_INCOMPLETE_MESSAGE</strong></dt> <dt>0x80090318L</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-184"><dt><strong>SEC_E_INCOMPLETE_MESSAGE</strong></dt> <dt>0x80090318L</dt> </span></span></dl></td><td><span data-ttu-id="516b5-185">A função foi bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="516b5-185">The function succeeded.</span></span> <span data-ttu-id="516b5-186">Os dados no buffer de entrada estão incompletos.</span><span class="sxs-lookup"><span data-stu-id="516b5-186">The data in the input buffer is incomplete.</span></span> <span data-ttu-id="516b5-187">O aplicativo deve ler dados adicionais do cliente e chamar [<strong>AcceptSecurityContext (Schannel)</strong>] (AcceptSecurityContext--Schannel.MD) novamente.</span><span class="sxs-lookup"><span data-stu-id="516b5-187">The application must read additional data from the client and call [<strong>AcceptSecurityContext (Schannel)</strong>](acceptsecuritycontext--schannel.md) again.</span></span><br/> <span data-ttu-id="516b5-188">Quando esse valor é retornado, o buffer <em>pInput</em> contém uma estrutura [<strong>SecBuffer</strong>] (/Windows/Win32/API/SSPI/NS-SSPI-SecBuffer) com um membro <strong>BufferType</strong> de <strong>SECBUFFER_MISSING</strong>.</span><span class="sxs-lookup"><span data-stu-id="516b5-188">When this value is returned, the <em>pInput</em> buffer contains a [<strong>SecBuffer</strong>](/windows/win32/api/sspi/ns-sspi-secbuffer) structure with a <strong>BufferType</strong> member of <strong>SECBUFFER_MISSING</strong>.</span></span> <span data-ttu-id="516b5-189">O membro <strong>cbBuffer</strong> de <strong>SecBuffer</strong> contém um valor que indica o número de bytes adicionais que a função deve ler do cliente antes que essa função tenha sucesso.</span><span class="sxs-lookup"><span data-stu-id="516b5-189">The <strong>cbBuffer</strong> member of <strong>SecBuffer</strong> contains a value that indicates the number of additional bytes that the function must read from the client before this function succeeds.</span></span> <span data-ttu-id="516b5-190">Embora esse número nem sempre seja preciso, usá-lo pode ajudar o desempenho ao evitar várias chamadas para essa função.</span><span class="sxs-lookup"><span data-stu-id="516b5-190">While this number is not always accurate, using it can help performance by avoiding multiple calls to this function.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="516b5-191"><dt><strong>SEC_E_INSUFFICIENT_MEMORY</strong></dt> <dt>0x80090300L</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-191"><dt><strong>SEC_E_INSUFFICIENT_MEMORY</strong></dt> <dt>0x80090300L</dt> </span></span></dl></td><td><span data-ttu-id="516b5-192">A função falhou.</span><span class="sxs-lookup"><span data-stu-id="516b5-192">The function failed.</span></span> <span data-ttu-id="516b5-193">Não há memória suficiente disponível para concluir a ação solicitada.</span><span class="sxs-lookup"><span data-stu-id="516b5-193">There is not enough memory available to complete the requested action.</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="516b5-194"><dt><strong>SEC_E_INTERNAL_ERROR</strong></dt> <dt>0x80090304L</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-194"><dt><strong>SEC_E_INTERNAL_ERROR</strong></dt> <dt>0x80090304L</dt> </span></span></dl></td><td><span data-ttu-id="516b5-195">A função falhou.</span><span class="sxs-lookup"><span data-stu-id="516b5-195">The function failed.</span></span> <span data-ttu-id="516b5-196">Ocorreu um erro que não foi mapeado para um código de erro SSPI.</span><span class="sxs-lookup"><span data-stu-id="516b5-196">An error occurred that did not map to an SSPI error code.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="516b5-197"><dt><strong>SEC_E_INVALID_HANDLE</strong></dt> <dt>0x80100003L</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-197"><dt><strong>SEC_E_INVALID_HANDLE</strong></dt> <dt>0x80100003L</dt> </span></span></dl></td><td><span data-ttu-id="516b5-198">A função falhou.</span><span class="sxs-lookup"><span data-stu-id="516b5-198">The function failed.</span></span> <span data-ttu-id="516b5-199">O identificador passado para a função não é válido.</span><span class="sxs-lookup"><span data-stu-id="516b5-199">The handle passed to the function is not valid.</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="516b5-200"><dt><strong>SEC_E_INVALID_TOKEN</strong></dt> <dt>0x80090308L</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-200"><dt><strong>SEC_E_INVALID_TOKEN</strong></dt> <dt>0x80090308L</dt> </span></span></dl></td><td><span data-ttu-id="516b5-201">A função falhou.</span><span class="sxs-lookup"><span data-stu-id="516b5-201">The function failed.</span></span> <span data-ttu-id="516b5-202">O token passado para a função não é válido.</span><span class="sxs-lookup"><span data-stu-id="516b5-202">The token passed to the function is not valid.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="516b5-203"><dt><strong>SEC_E_LOGON_DENIED</strong></dt> <dt>0x8009030CL</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-203"><dt><strong>SEC_E_LOGON_DENIED</strong></dt> <dt>0x8009030CL</dt> </span></span></dl></td><td><span data-ttu-id="516b5-204">Falha no logon.</span><span class="sxs-lookup"><span data-stu-id="516b5-204">The logon failed.</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="516b5-205"><dt><strong>SEC_E_NO_AUTHENTICATING_AUTHORITY</strong></dt> <dt>0x80090311L</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-205"><dt><strong>SEC_E_NO_AUTHENTICATING_AUTHORITY</strong></dt> <dt>0x80090311L</dt> </span></span></dl></td><td><span data-ttu-id="516b5-206">A função falhou.</span><span class="sxs-lookup"><span data-stu-id="516b5-206">The function failed.</span></span> <span data-ttu-id="516b5-207">Nenhuma autoridade pode ser contatada para autenticação.</span><span class="sxs-lookup"><span data-stu-id="516b5-207">No authority could be contacted for authentication.</span></span> <span data-ttu-id="516b5-208">Isso pode ser devido às seguintes condições:</span><span class="sxs-lookup"><span data-stu-id="516b5-208">This could be due to the following conditions:</span></span><br/><ul><li><span data-ttu-id="516b5-209">O nome de domínio da parte de autenticação está incorreto.</span><span class="sxs-lookup"><span data-stu-id="516b5-209">The domain name of the authenticating party is incorrect.</span></span></li><li><span data-ttu-id="516b5-210">O domínio não está disponível.</span><span class="sxs-lookup"><span data-stu-id="516b5-210">The domain is unavailable.</span></span></li><li><span data-ttu-id="516b5-211">Falha na relação de confiança.</span><span class="sxs-lookup"><span data-stu-id="516b5-211">The trust relationship has failed.</span></span></li></ul></td></tr><tr class="even"><td><dl> <span data-ttu-id="516b5-212"><dt><strong>SEC_E_NO_CREDENTIALS</strong></dt> <dt>0x8009030EL</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-212"><dt><strong>SEC_E_NO_CREDENTIALS</strong></dt> <dt>0x8009030EL</dt> </span></span></dl></td><td><span data-ttu-id="516b5-213">A função falhou.</span><span class="sxs-lookup"><span data-stu-id="516b5-213">The function failed.</span></span> <span data-ttu-id="516b5-214">O identificador de credenciais especificado no parâmetro <em>phCredential</em> não é válido.</span><span class="sxs-lookup"><span data-stu-id="516b5-214">The credentials handle specified in the <em>phCredential</em> parameter is not valid.</span></span> <span data-ttu-id="516b5-215">Esse valor pode ser retornado ao usar o SSP Digest ou Schannel.</span><span class="sxs-lookup"><span data-stu-id="516b5-215">This value can be returned when using the Digest or Schannel SSP.</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="516b5-216"><dt><strong>SEC_E_OK</strong></dt> <dt>0x00000000l</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-216"><dt><strong>SEC_E_OK</strong></dt> <dt>0x00000000L</dt> </span></span></dl></td><td><span data-ttu-id="516b5-217">A função foi bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="516b5-217">The function succeeded.</span></span> <span data-ttu-id="516b5-218">O [*contexto de segurança*](../secgloss/s-gly.md) recebido do cliente foi aceito.</span><span class="sxs-lookup"><span data-stu-id="516b5-218">The [*security context*](../secgloss/s-gly.md) received from the client was accepted.</span></span> <span data-ttu-id="516b5-219">Se um token de saída foi gerado pela função, ele deve ser enviado para o processo do cliente.</span><span class="sxs-lookup"><span data-stu-id="516b5-219">If an output token was generated by the function, it must be sent to the client process.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="516b5-220"><dt><strong>SEC_E_UNSUPPORTED_FUNCTION</strong></dt> <dt>0x80090302L</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-220"><dt><strong>SEC_E_UNSUPPORTED_FUNCTION</strong></dt> <dt>0x80090302L</dt> </span></span></dl></td><td><span data-ttu-id="516b5-221">A função falhou.</span><span class="sxs-lookup"><span data-stu-id="516b5-221">The function failed.</span></span> <span data-ttu-id="516b5-222">Um sinalizador de atributo de contexto que não é válido (ASC_REQ_DELEGATE ou ASC_REQ_PROMPT_FOR_CREDS) foi especificado no parâmetro <em>fContextReq</em> .</span><span class="sxs-lookup"><span data-stu-id="516b5-222">A context attribute flag that is not valid (ASC_REQ_DELEGATE or ASC_REQ_PROMPT_FOR_CREDS) was specified in the <em>fContextReq</em> parameter.</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="516b5-223"><dt><strong>SEC_E_APPLICATION_PROTOCOL_MISMATCH</strong></dt> <dt>0x80090367L</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-223"><dt><strong>SEC_E_APPLICATION_PROTOCOL_MISMATCH</strong></dt> <dt>0x80090367L</dt> </span></span></dl></td><td><span data-ttu-id="516b5-224">Não existe nenhum protocolo de aplicativo comum entre o cliente e o servidor.</span><span class="sxs-lookup"><span data-stu-id="516b5-224">No common application protocol exists between the client and the server.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="516b5-225"><dt><strong>SEC_I_COMPLETE_AND_CONTINUE</strong></dt> <dt>0x00090314L</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-225"><dt><strong>SEC_I_COMPLETE_AND_CONTINUE</strong></dt> <dt>0x00090314L</dt> </span></span></dl></td><td><span data-ttu-id="516b5-226">A função foi bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="516b5-226">The function succeeded.</span></span> <span data-ttu-id="516b5-227">O servidor deve chamar [<strong>CompleteAuthToken</strong>] (/Windows/Win32/API/SSPI/NF-SSPI-CompleteAuthToken) e passar o token de saída para o cliente.</span><span class="sxs-lookup"><span data-stu-id="516b5-227">The server must call [<strong>CompleteAuthToken</strong>](/windows/win32/api/sspi/nf-sspi-completeauthtoken) and pass the output token to the client.</span></span> <span data-ttu-id="516b5-228">Em seguida, o servidor aguarda um token de retorno do cliente e, em seguida, faz outra chamada para [<strong>AcceptSecurityContext (Schannel)</strong>] (AcceptSecurityContext--Schannel.MD).</span><span class="sxs-lookup"><span data-stu-id="516b5-228">The server then waits for a return token from the client and then makes another call to [<strong>AcceptSecurityContext (Schannel)</strong>](acceptsecuritycontext--schannel.md).</span></span> <br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="516b5-229"><dt><strong>SEC_I_COMPLETE_NEEDED</strong></dt> <dt>0x00090313L</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-229"><dt><strong>SEC_I_COMPLETE_NEEDED</strong></dt> <dt>0x00090313L</dt> </span></span></dl></td><td><span data-ttu-id="516b5-230">A função foi bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="516b5-230">The function succeeded.</span></span> <span data-ttu-id="516b5-231">O servidor deve concluir a compilação da mensagem do cliente e, em seguida, chamar a função [<strong>CompleteAuthToken</strong>] (/Windows/Win32/API/SSPI/NF-SSPI-CompleteAuthToken).</span><span class="sxs-lookup"><span data-stu-id="516b5-231">The server must finish building the message from the client and then call the [<strong>CompleteAuthToken</strong>](/windows/win32/api/sspi/nf-sspi-completeauthtoken) function.</span></span><br/></td></tr><tr class="even"><td><dl> <span data-ttu-id="516b5-232"><dt><strong>SEC_I_CONTINUE_NEEDED</strong></dt> <dt>0x00090312L</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-232"><dt><strong>SEC_I_CONTINUE_NEEDED</strong></dt> <dt>0x00090312L</dt> </span></span></dl></td><td><span data-ttu-id="516b5-233">A função foi bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="516b5-233">The function succeeded.</span></span> <span data-ttu-id="516b5-234">O servidor deve enviar o token de saída para o cliente e aguardar um token retornado.</span><span class="sxs-lookup"><span data-stu-id="516b5-234">The server must send the output token to the client and wait for a returned token.</span></span> <span data-ttu-id="516b5-235">O token retornado deve ser passado em <em>pInput</em> para outra chamada para [<strong>AcceptSecurityContext (Schannel)</strong>] (AcceptSecurityContext--Schannel.MD).</span><span class="sxs-lookup"><span data-stu-id="516b5-235">The returned token should be passed in <em>pInput</em> for another call to [<strong>AcceptSecurityContext (Schannel)</strong>](acceptsecuritycontext--schannel.md).</span></span><br/></td></tr><tr class="odd"><td><dl> <span data-ttu-id="516b5-236"><dt><strong>STATUS_LOGON_FAILURE</strong></dt> <dt>0xC000006DL</dt> </span><span class="sxs-lookup"><span data-stu-id="516b5-236"><dt><strong>STATUS_LOGON_FAILURE</strong></dt> <dt>0xC000006DL</dt> </span></span></dl></td><td><span data-ttu-id="516b5-237">A função falhou.</span><span class="sxs-lookup"><span data-stu-id="516b5-237">The function failed.</span></span> <span data-ttu-id="516b5-238">A função [<strong>AcceptSecurityContext (Schannel)</strong>] (AcceptSecurityContext--Schannel.MD) foi chamada depois que o contexto especificado foi estabelecido.</span><span class="sxs-lookup"><span data-stu-id="516b5-238">The [<strong>AcceptSecurityContext (Schannel)</strong>](acceptsecuritycontext--schannel.md) function was called after the specified context was established.</span></span> <span data-ttu-id="516b5-239">Esse valor pode ser retornado ao usar o SSP de resumo.</span><span class="sxs-lookup"><span data-stu-id="516b5-239">This value can be returned when using the Digest SSP.</span></span><br/></td></tr></tbody></table>



 

## <a name="remarks"></a><span data-ttu-id="516b5-240">Comentários</span><span class="sxs-lookup"><span data-stu-id="516b5-240">Remarks</span></span>

<span data-ttu-id="516b5-241">A função **AcceptSecurityContext (Schannel)** é a contraparte do servidor para a função [**InitializeSecurityContext (Schannel)**](initializesecuritycontext--schannel.md) .</span><span class="sxs-lookup"><span data-stu-id="516b5-241">The **AcceptSecurityContext (Schannel)** function is the server counterpart to the [**InitializeSecurityContext (Schannel)**](initializesecuritycontext--schannel.md) function.</span></span>

<span data-ttu-id="516b5-242">Quando o servidor recebe uma solicitação de um cliente, o servidor usa o parâmetro *fContextReq* para especificar o que é necessário para a sessão.</span><span class="sxs-lookup"><span data-stu-id="516b5-242">When the server receives a request from a client, the server uses the *fContextReq* parameter to specify what it requires of the session.</span></span> <span data-ttu-id="516b5-243">Dessa maneira, um servidor pode especificar que os clientes devem ser capazes de usar uma sessão confidencial ou com verificação de [*integridade*](../secgloss/i-gly.md), e pode rejeitar clientes que não podem atender a essa demanda.</span><span class="sxs-lookup"><span data-stu-id="516b5-243">In this fashion, a server can specify that clients must be capable of using a confidential or [*integrity*](../secgloss/i-gly.md)-checked session, and it can reject clients that cannot meet that demand.</span></span> <span data-ttu-id="516b5-244">Como alternativa, um servidor pode não exigir nada e tudo o que o cliente pode fornecer ou exigir é retornado no parâmetro *pfContextAttr* .</span><span class="sxs-lookup"><span data-stu-id="516b5-244">Alternatively, a server can require nothing, and whatever the client can provide or requires is returned in the *pfContextAttr* parameter.</span></span>

<span data-ttu-id="516b5-245">Para um pacote que dá suporte à autenticação de vários trechos, como a autenticação mútua, a sequência de chamada é a seguinte:</span><span class="sxs-lookup"><span data-stu-id="516b5-245">For a package that supports multiple-leg authentication, such as mutual authentication, the calling sequence is as follows:</span></span>

1.  <span data-ttu-id="516b5-246">O cliente transmite um token para o servidor.</span><span class="sxs-lookup"><span data-stu-id="516b5-246">The client transmits a token to the server.</span></span>
2.  <span data-ttu-id="516b5-247">O servidor chama **AcceptSecurityContext (Schannel)** pela primeira vez, o que gera um token de resposta que é enviado para o cliente.</span><span class="sxs-lookup"><span data-stu-id="516b5-247">The server calls **AcceptSecurityContext (Schannel)** the first time, which generates a reply token that is then sent to the client.</span></span>
3.  <span data-ttu-id="516b5-248">O cliente recebe o token e o passa para [**InitializeSecurityContext (Schannel)**](initializesecuritycontext--schannel.md).</span><span class="sxs-lookup"><span data-stu-id="516b5-248">The client receives the token and passes it to [**InitializeSecurityContext (Schannel)**](initializesecuritycontext--schannel.md).</span></span> <span data-ttu-id="516b5-249">Se **InitializeSecurityContext (Schannel)** retornar s \_ E \_ OK, a autenticação mútua foi concluída e uma sessão segura pode começar.</span><span class="sxs-lookup"><span data-stu-id="516b5-249">If **InitializeSecurityContext (Schannel)** returns SEC\_E\_OK, mutual authentication has been completed and a secure session can begin.</span></span> <span data-ttu-id="516b5-250">Se **InitializeSecurityContext (Schannel)** retornar um código de erro, a negociação de autenticação mútua terminará.</span><span class="sxs-lookup"><span data-stu-id="516b5-250">If **InitializeSecurityContext (Schannel)** returns an error code, the mutual authentication negotiation ends.</span></span> <span data-ttu-id="516b5-251">Caso contrário, o token de segurança retornado por **InitializeSecurityContext (Schannel)** é enviado para o cliente e as etapas 2 e 3 são repetidas.</span><span class="sxs-lookup"><span data-stu-id="516b5-251">Otherwise, the security token returned by **InitializeSecurityContext (Schannel)** is sent to the client, and steps 2 and 3 are repeated.</span></span>

<span data-ttu-id="516b5-252">Os parâmetros *fContextReq* e *pfContextAttr* são bitmasks que representam vários atributos de contexto.</span><span class="sxs-lookup"><span data-stu-id="516b5-252">The *fContextReq* and *pfContextAttr* parameters are bitmasks that represent various context attributes.</span></span> <span data-ttu-id="516b5-253">Para obter uma descrição dos vários atributos, consulte [requisitos de contexto](context-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="516b5-253">For a description of the various attributes, see [Context Requirements](context-requirements.md).</span></span>

> [!Note]  
> <span data-ttu-id="516b5-254">O parâmetro *pfContextAttr* é válido em qualquer retorno bem-sucedido, mas somente no retorno bem-sucedido final, você deve examinar os sinalizadores referentes aos aspectos de segurança do contexto.</span><span class="sxs-lookup"><span data-stu-id="516b5-254">The *pfContextAttr* parameter is valid on any successful return, but only on the final successful return should you examine the flags pertaining to security aspects of the context.</span></span> <span data-ttu-id="516b5-255">Os retornos intermediários podem definir, por exemplo, o \_ \_ sinalizador de memória alocada do ISC RET \_ .</span><span class="sxs-lookup"><span data-stu-id="516b5-255">Intermediate returns can set, for example, the ISC\_RET\_ALLOCATED\_MEMORY flag.</span></span>

 

<span data-ttu-id="516b5-256">O chamador é responsável por determinar se os atributos de contexto final são suficientes.</span><span class="sxs-lookup"><span data-stu-id="516b5-256">The caller is responsible for determining whether the final context attributes are sufficient.</span></span> <span data-ttu-id="516b5-257">Se, por exemplo, a confidencialidade (criptografia) tiver sido solicitada, mas não puder ser estabelecida, alguns aplicativos poderão optar por desligar a conexão imediatamente.</span><span class="sxs-lookup"><span data-stu-id="516b5-257">If, for example, confidentiality (encryption) was requested, but could not be established, some applications may choose to shut down the connection immediately.</span></span> <span data-ttu-id="516b5-258">Se o [*contexto de segurança*](../secgloss/s-gly.md) não puder ser estabelecido, o servidor deverá liberar o contexto parcialmente criado chamando a função [**DeleteSecurityContext**](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext) .</span><span class="sxs-lookup"><span data-stu-id="516b5-258">If the [*security context*](../secgloss/s-gly.md) cannot be established, the server must free the partially created context by calling the [**DeleteSecurityContext**](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext) function.</span></span> <span data-ttu-id="516b5-259">Para obter informações sobre quando chamar a função **DeleteSecurityContext** , consulte **DeleteSecurityContext**.</span><span class="sxs-lookup"><span data-stu-id="516b5-259">For information about when to call the **DeleteSecurityContext** function, see **DeleteSecurityContext**.</span></span>

<span data-ttu-id="516b5-260">Depois que o [*contexto de segurança*](../secgloss/s-gly.md) tiver sido estabelecido, o aplicativo de servidor poderá usar a função [**QuerySecurityContextToken**](/windows/win32/api/sspi/nf-sspi-querysecuritycontexttoken) para recuperar um identificador para a conta de usuário para a qual o certificado de cliente foi mapeado.</span><span class="sxs-lookup"><span data-stu-id="516b5-260">After the [*security context*](../secgloss/s-gly.md) has been established, the server application can use the [**QuerySecurityContextToken**](/windows/win32/api/sspi/nf-sspi-querysecuritycontexttoken) function to retrieve a handle to the user account to which the client certificate was mapped.</span></span> <span data-ttu-id="516b5-261">Além disso, o servidor pode usar a função [**ImpersonateSecurityContext**](/windows/win32/api/sspi/nf-sspi-impersonatesecuritycontext) para representar o usuário.</span><span class="sxs-lookup"><span data-stu-id="516b5-261">Also, the server can use the [**ImpersonateSecurityContext**](/windows/win32/api/sspi/nf-sspi-impersonatesecuritycontext) function to impersonate the user.</span></span>

## <a name="requirements"></a><span data-ttu-id="516b5-262">Requisitos</span><span class="sxs-lookup"><span data-stu-id="516b5-262">Requirements</span></span>



| <span data-ttu-id="516b5-263">Requisito</span><span class="sxs-lookup"><span data-stu-id="516b5-263">Requirement</span></span> | <span data-ttu-id="516b5-264">Valor</span><span class="sxs-lookup"><span data-stu-id="516b5-264">Value</span></span> |
|-------------------------------------|--------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="516b5-265">Cliente mínimo com suporte</span><span class="sxs-lookup"><span data-stu-id="516b5-265">Minimum supported client</span></span><br/> | <span data-ttu-id="516b5-266">Windows 8.1 \[ apenas aplicativos de área de trabalho\]</span><span class="sxs-lookup"><span data-stu-id="516b5-266">Windows 8.1 \[desktop apps only\]</span></span><br/>                                                           |
| <span data-ttu-id="516b5-267">Servidor mínimo com suporte</span><span class="sxs-lookup"><span data-stu-id="516b5-267">Minimum supported server</span></span><br/> | <span data-ttu-id="516b5-268">\[Somente aplicativos da área de trabalho do Windows Server 2012 R2\]</span><span class="sxs-lookup"><span data-stu-id="516b5-268">Windows Server 2012 R2 \[desktop apps only\]</span></span><br/>                                                |
| <span data-ttu-id="516b5-269">parâmetro</span><span class="sxs-lookup"><span data-stu-id="516b5-269">Header</span></span><br/>                   | <dl> <span data-ttu-id="516b5-270"><dt>SSPI. h (incluir Security. h)</dt></span><span class="sxs-lookup"><span data-stu-id="516b5-270"><dt>Sspi.h (include Security.h)</dt></span></span> </dl> |
| <span data-ttu-id="516b5-271">Biblioteca</span><span class="sxs-lookup"><span data-stu-id="516b5-271">Library</span></span><br/>                  | <dl> <span data-ttu-id="516b5-272"><dt>Secur32. lib</dt></span><span class="sxs-lookup"><span data-stu-id="516b5-272"><dt>Secur32.lib</dt></span></span> </dl>                 |
| <span data-ttu-id="516b5-273">DLL</span><span class="sxs-lookup"><span data-stu-id="516b5-273">DLL</span></span><br/>                      | <dl> <span data-ttu-id="516b5-274"><dt>Secur32.dll</dt></span><span class="sxs-lookup"><span data-stu-id="516b5-274"><dt>Secur32.dll</dt></span></span> </dl>                 |



## <a name="see-also"></a><span data-ttu-id="516b5-275">Confira também</span><span class="sxs-lookup"><span data-stu-id="516b5-275">See also</span></span>

<dl> <dt>

[<span data-ttu-id="516b5-276">Funções SSPI</span><span class="sxs-lookup"><span data-stu-id="516b5-276">SSPI Functions</span></span>](authentication-functions.md#sspi-functions)
</dt> <dt>

[<span data-ttu-id="516b5-277">**DeleteSecurityContext**</span><span class="sxs-lookup"><span data-stu-id="516b5-277">**DeleteSecurityContext**</span></span>](/windows/win32/api/sspi/nf-sspi-deletesecuritycontext)
</dt> <dt>

[<span data-ttu-id="516b5-278">**InitializeSecurityContext (Schannel)**</span><span class="sxs-lookup"><span data-stu-id="516b5-278">**InitializeSecurityContext (Schannel)**</span></span>](initializesecuritycontext--schannel.md)
</dt> </dl>

 

 
