---
description: Para reduzir o tráfego do controlador de domínio e melhorar o desempenho, o lado do cliente do Microsoft Digest armazena em cache as informações recebidas após a autenticação bem-sucedida com um servidor.
ms.assetid: cd928266-889a-494c-a94b-4ea7b1dcc241
title: Mantendo o contexto de segurança entre conexões
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aeb450dde789f17f46397cb56fe74b94adcf8ea6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104297078"
---
# <a name="maintaining-the-security-context-between-connections"></a><span data-ttu-id="7703b-103">Mantendo o contexto de segurança entre conexões</span><span class="sxs-lookup"><span data-stu-id="7703b-103">Maintaining the Security Context Between Connections</span></span>

<span data-ttu-id="7703b-104">Para reduzir o tráfego do controlador de domínio e melhorar o desempenho, o lado do cliente do Microsoft Digest armazena em cache as informações recebidas após a autenticação bem-sucedida com um servidor.</span><span class="sxs-lookup"><span data-stu-id="7703b-104">To reduce domain controller traffic and improve performance, the client-side of Microsoft Digest caches information received after successful authentication with a server.</span></span> <span data-ttu-id="7703b-105">Aplicativos cliente precisam apenas armazenar em cache o identificador para o [*contexto de segurança*](../secgloss/s-gly.md) que foi estabelecido.</span><span class="sxs-lookup"><span data-stu-id="7703b-105">Client applications need only cache the handle to the [*security context*](../secgloss/s-gly.md) that has been established.</span></span> <span data-ttu-id="7703b-106">A tabela a seguir descreve as informações armazenadas em cache pelo pacote de segurança.</span><span class="sxs-lookup"><span data-stu-id="7703b-106">The following table describes information cached by the security package.</span></span>



| <span data-ttu-id="7703b-107">Informações</span><span class="sxs-lookup"><span data-stu-id="7703b-107">Information</span></span>                                                       | <span data-ttu-id="7703b-108">Descrição</span><span class="sxs-lookup"><span data-stu-id="7703b-108">Description</span></span>                                                                                                                                         |
|-------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="7703b-109">Nome do servidor</span><span class="sxs-lookup"><span data-stu-id="7703b-109">Server name</span></span>                                                       | <span data-ttu-id="7703b-110">O servidor que criou com êxito um contexto de segurança para o usuário.</span><span class="sxs-lookup"><span data-stu-id="7703b-110">The server that has successfully created a security context for the user.</span></span>                                                                           |
| <span data-ttu-id="7703b-111">Realm/domínio</span><span class="sxs-lookup"><span data-stu-id="7703b-111">Realm/Domain</span></span>                                                      | <span data-ttu-id="7703b-112">O nome de domínio usado na autenticação bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="7703b-112">The domain name used in the successful authentication.</span></span>                                                                                              |
| [<span data-ttu-id="7703b-113">*Momentos*</span><span class="sxs-lookup"><span data-stu-id="7703b-113">*Nonce*</span></span>](../secgloss/n-gly.md) | <span data-ttu-id="7703b-114">Um nonce de servidor que está associado à autenticação bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="7703b-114">A server nonce that is associated with the successful authentication.</span></span>                                                                               |
| <span data-ttu-id="7703b-115">Contagem de nonce</span><span class="sxs-lookup"><span data-stu-id="7703b-115">Nonce count</span></span>                                                       | <span data-ttu-id="7703b-116">O número de vezes que o cliente incluiu o nonce em solicitações para o servidor.</span><span class="sxs-lookup"><span data-stu-id="7703b-116">The number of times the client has included the nonce in requests to the server.</span></span> <span data-ttu-id="7703b-117">Isso é usado para detecção de repetição.</span><span class="sxs-lookup"><span data-stu-id="7703b-117">This is used for replay-detection.</span></span>                                 |
| <span data-ttu-id="7703b-118">Valor opaco</span><span class="sxs-lookup"><span data-stu-id="7703b-118">Opaque value</span></span>                                                      | <span data-ttu-id="7703b-119">O valor retornado para a diretiva opaca após uma autenticação bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="7703b-119">The value returned for the opaque directive after a successful authentication.</span></span> <span data-ttu-id="7703b-120">Esse valor contém uma referência ao contexto de segurança do usuário.</span><span class="sxs-lookup"><span data-stu-id="7703b-120">This value contains a reference to the security context of the user.</span></span> |



 

<span data-ttu-id="7703b-121">Quando um cliente envia uma mensagem a um servidor, o servidor deve determinar se o cliente tem um contexto de segurança existente.</span><span class="sxs-lookup"><span data-stu-id="7703b-121">When a client sends a message to a server, the server must determine whether the client has an existing security context.</span></span> <span data-ttu-id="7703b-122">Para fazer isso, o servidor passa cada solicitação de cliente para a função [**AcceptSecurityContext (geral)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) .</span><span class="sxs-lookup"><span data-stu-id="7703b-122">To do this, the server passes each client request to the [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) function.</span></span> <span data-ttu-id="7703b-123">Essa função extrai o valor da diretiva opaca da solicitação, se presente, e a usa para pesquisar o contexto de segurança do cliente.</span><span class="sxs-lookup"><span data-stu-id="7703b-123">This function extracts the value of the opaque directive from the request, if present, and uses it to look up the client's security context.</span></span> <span data-ttu-id="7703b-124">Se o contexto de segurança for encontrado, o identificador do contexto será retornado ao servidor.</span><span class="sxs-lookup"><span data-stu-id="7703b-124">If the security context is found, the handle of the context is returned to the server.</span></span> <span data-ttu-id="7703b-125">Para obter informações relacionadas, consulte [Autenticando solicitações subsequentes](authenticating-subsequent-requests-using-microsoft-digest.md).</span><span class="sxs-lookup"><span data-stu-id="7703b-125">For related information, see [Authenticating Subsequent Requests](authenticating-subsequent-requests-using-microsoft-digest.md).</span></span>

<span data-ttu-id="7703b-126">Como um meio de detectar ataques de falsificação e reprodução, o cliente chama a função [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) , que usa um contexto de segurança para assinar uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="7703b-126">As a means of detecting spoofing and replay attacks, the client calls the [**MakeSignature**](/windows/desktop/api/Sspi/nf-sspi-makesignature) function which uses a security context to sign a message.</span></span> <span data-ttu-id="7703b-127">Quando as mensagens são protegidas usando a função **MakeSignature** , o servidor usa a função [**VerifySignature**](/windows/desktop/api/Sspi/nf-sspi-verifysignature) com o contexto em cache para verificar a origem e a [*integridade*](../secgloss/i-gly.md)da mensagem.</span><span class="sxs-lookup"><span data-stu-id="7703b-127">When messages are protected using the **MakeSignature** function, the server uses the [**VerifySignature**](/windows/desktop/api/Sspi/nf-sspi-verifysignature) function with the cached context to verify the message's origin and [*integrity*](../secgloss/i-gly.md).</span></span> <span data-ttu-id="7703b-128">Para obter mais informações, consulte [protegendo mensagens](protecting-messages-using-microsoft-digest.md).</span><span class="sxs-lookup"><span data-stu-id="7703b-128">For more information, see [Protecting Messages](protecting-messages-using-microsoft-digest.md).</span></span>

 

 
