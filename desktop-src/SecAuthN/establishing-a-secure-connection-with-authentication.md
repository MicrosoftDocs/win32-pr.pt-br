---
description: Em um protocolo de aplicativo cliente/servidor, um servidor é associado a uma porta de comunicação, como um soquete ou uma interface RPC.
ms.assetid: 176d4ca5-83dd-42ef-b116-227d4badc0dd
title: Estabelecendo uma conexão segura com autenticação
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0a43483893c8dcf56e6db6b3c7d7aa1451bf9540
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105751726"
---
# <a name="establishing-a-secure-connection-with-authentication"></a><span data-ttu-id="fcac9-103">Estabelecendo uma conexão segura com autenticação</span><span class="sxs-lookup"><span data-stu-id="fcac9-103">Establishing a Secure Connection with Authentication</span></span>

<span data-ttu-id="fcac9-104">Em um [*protocolo de aplicativo*](/windows/desktop/SecGloss/a-gly)cliente/servidor, um servidor é associado a uma porta de comunicação, como um soquete ou uma interface RPC.</span><span class="sxs-lookup"><span data-stu-id="fcac9-104">In a client/server [*application protocol*](/windows/desktop/SecGloss/a-gly), a server binds to a communication port such as a socket or an RPC interface.</span></span> <span data-ttu-id="fcac9-105">Em seguida, o servidor aguarda um cliente se conectar e solicitar o serviço.</span><span class="sxs-lookup"><span data-stu-id="fcac9-105">The server then waits for a client to connect and request service.</span></span> <span data-ttu-id="fcac9-106">A função de segurança na instalação da conexão é duas vezes no caso de autenticação mútua:</span><span class="sxs-lookup"><span data-stu-id="fcac9-106">The role of security at connection setup is two-fold in the case of mutual authentication:</span></span>

-   <span data-ttu-id="fcac9-107">Autenticação de cliente pelo servidor.</span><span class="sxs-lookup"><span data-stu-id="fcac9-107">Client authentication by the server.</span></span>
-   <span data-ttu-id="fcac9-108">Autenticação de servidor pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="fcac9-108">Server authentication by the client.</span></span>

<span data-ttu-id="fcac9-109">Os componentes de cliente e servidor de um aplicativo de transporte usam um [*pacote de segurança*](/windows/desktop/SecGloss/s-gly) para estabelecer uma conexão segura para transmissão de mensagens.</span><span class="sxs-lookup"><span data-stu-id="fcac9-109">The client and server components of a transport application use a [*security package*](/windows/desktop/SecGloss/s-gly) to establish a secure connection for transmitting messages.</span></span> <span data-ttu-id="fcac9-110">A primeira etapa ao estabelecer uma conexão segura é criar um [*contexto de segurança*](/windows/desktop/SecGloss/s-gly); ou seja, uma estrutura de dados opaca que contém os dados de segurança relevantes para uma conexão, como uma [*chave de sessão*](/windows/desktop/SecGloss/s-gly) e a duração da sessão.</span><span class="sxs-lookup"><span data-stu-id="fcac9-110">The first step in establishing a secure connection is to create a [*security context*](/windows/desktop/SecGloss/s-gly); that is, an opaque data structure that contains the security data relevant to a connection, such as a [*session key*](/windows/desktop/SecGloss/s-gly) and the duration of the session.</span></span>

<span data-ttu-id="fcac9-111">Um contexto de segurança é, essencialmente, uma mensagem do pacote de segurança associado ao cliente para o pacote de segurança associado ao servidor.</span><span class="sxs-lookup"><span data-stu-id="fcac9-111">A security context is essentially a message from the security package associated with the client to the security package associated with the server.</span></span> <span data-ttu-id="fcac9-112">Consequentemente, a criação de um contexto de segurança geralmente exige que o cliente e o servidor façam chamadas para seus respectivos pacotes de segurança.</span><span class="sxs-lookup"><span data-stu-id="fcac9-112">Consequently, creating a security context typically requires both client and server to make calls to their respective security packages.</span></span> <span data-ttu-id="fcac9-113">Para obter mais informações sobre funções de contexto, consulte [Gerenciamento de contexto](authentication-functions.md).</span><span class="sxs-lookup"><span data-stu-id="fcac9-113">For more information on context functions, see [Context Management](authentication-functions.md).</span></span>

<span data-ttu-id="fcac9-114">O protocolo usado para estabelecer uma conexão segura e autenticada envolve a troca de um ou mais "tokens de segurança" entre o cliente e o servidor.</span><span class="sxs-lookup"><span data-stu-id="fcac9-114">The protocol used to establish a secure, authenticated connection involves the exchange of one or more "security tokens" between the client and the server.</span></span> <span data-ttu-id="fcac9-115">Esses tokens são enviados como mensagens opacas pelos dois lados, juntamente com quaisquer outras informações específicas de [*protocolo de aplicativo*](/windows/desktop/SecGloss/a-gly).</span><span class="sxs-lookup"><span data-stu-id="fcac9-115">These tokens are sent as opaque messages by the two sides along with any other [*application protocol*](/windows/desktop/SecGloss/a-gly)-specific information.</span></span> <span data-ttu-id="fcac9-116">Como uma mensagem opaca, o token é recebido de uma função de pacote de segurança pelo cliente, que não pode interpretar ou alterá-la e encaminhada como uma mensagem para o servidor.</span><span class="sxs-lookup"><span data-stu-id="fcac9-116">As an opaque message, the token is received from a security package function by the client, which cannot interpret or change it, and forwarded as a message to the server.</span></span> <span data-ttu-id="fcac9-117">O token também é opaco para o servidor, que não pode interpretar nem alterar o token.</span><span class="sxs-lookup"><span data-stu-id="fcac9-117">The token is also opaque to the server, which can neither interpret nor change the token.</span></span> <span data-ttu-id="fcac9-118">O servidor encaminha o token opaco para seu pacote de segurança para interpretação.</span><span class="sxs-lookup"><span data-stu-id="fcac9-118">The server forwards the opaque token to its security package for interpretation.</span></span> <span data-ttu-id="fcac9-119">Em seguida, o pacote informa ao servidor a autenticação do cliente ou falha na autenticação.</span><span class="sxs-lookup"><span data-stu-id="fcac9-119">The package then informs the server of the client authentication or failure to authenticate.</span></span>

<span data-ttu-id="fcac9-120">O cliente recebe o token do servidor em uma mensagem, recupera o token da mensagem recebida e usa esse token em uma chamada para seu pacote de segurança.</span><span class="sxs-lookup"><span data-stu-id="fcac9-120">The client receives the server's token in a message, retrieves the token from the received message, and uses that token in a call to its security package.</span></span> <span data-ttu-id="fcac9-121">O cliente então chama o pacote de segurança novamente indicando se uma conexão segura foi estabelecida ou se outras trocas são necessárias antes que uma conexão segura esteja pronta.</span><span class="sxs-lookup"><span data-stu-id="fcac9-121">The client then calls the security package again indicating whether a secure connection has been established or whether further exchanges are needed before a secure connection is ready.</span></span> <span data-ttu-id="fcac9-122">Teoricamente, não há nenhum limite para o número de trocas de tokens de segurança necessários.</span><span class="sxs-lookup"><span data-stu-id="fcac9-122">Theoretically, there is no limit to the number of exchanges of security tokens needed.</span></span> <span data-ttu-id="fcac9-123">Na prática, apenas um número limitado de trocas é necessário.</span><span class="sxs-lookup"><span data-stu-id="fcac9-123">In practice, only a limited number of exchanges is required.</span></span> <span data-ttu-id="fcac9-124">A autenticação NTLM é baseada no esquema de desafio/resposta e usa três segmentos para autenticar um cliente no servidor.</span><span class="sxs-lookup"><span data-stu-id="fcac9-124">NTLM authentication is based on the challenge/response scheme, and uses three legs to authenticate a client to the server.</span></span> <span data-ttu-id="fcac9-125">O protocolo [*Kerberos*](/windows/desktop/SecGloss/k-gly) versão 5,0 pode exigir trocas de mensagens adicionais.</span><span class="sxs-lookup"><span data-stu-id="fcac9-125">The [*Kerberos*](/windows/desktop/SecGloss/k-gly) version 5.0 protocol can require additional message exchanges.</span></span>

## <a name="related-topics"></a><span data-ttu-id="fcac9-126">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="fcac9-126">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="fcac9-127">Inicialização do contexto do cliente</span><span class="sxs-lookup"><span data-stu-id="fcac9-127">Client Context Initialization</span></span>](client-context-initialization.md)
</dt> <dt>

[<span data-ttu-id="fcac9-128">Inicialização do contexto do servidor</span><span class="sxs-lookup"><span data-stu-id="fcac9-128">Server Context Initialization</span></span>](server-context-initialization.md)
</dt> </dl>

 

 
