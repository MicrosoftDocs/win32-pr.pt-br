---
title: Opções de Bluetooth e soquete
description: O Bluetooth para Windows dá suporte às seguintes opções de soquete.
ms.assetid: e2e305c2-e749-4566-8e24-c07a7a29c612
keywords:
- Opções de Bluetooth e soquete Bluetooth
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 84040a98c3dae1fec292e4f0a7086f11d1ee546c
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103917393"
---
# <a name="bluetooth-and-socket-options"></a><span data-ttu-id="d9b26-104">Opções de Bluetooth e soquete</span><span class="sxs-lookup"><span data-stu-id="d9b26-104">Bluetooth and Socket Options</span></span>

<span data-ttu-id="d9b26-105">O Bluetooth para Windows dá suporte às seguintes opções de soquete.</span><span class="sxs-lookup"><span data-stu-id="d9b26-105">Bluetooth for Windows supports the following socket options.</span></span> <span data-ttu-id="d9b26-106">As opções de soquete são definidas e consultadas usando as funções [**setsockopt**](/windows/desktop/api/winsock/nf-winsock-setsockopt) e [**getsockopt**](/windows/desktop/api/winsock/nf-winsock-getsockopt) , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="d9b26-106">Socket options are set and queried using the [**setsockopt**](/windows/desktop/api/winsock/nf-winsock-setsockopt) and [**getsockopt**](/windows/desktop/api/winsock/nf-winsock-getsockopt) functions, respectively.</span></span> <span data-ttu-id="d9b26-107">Todas as opções a seguir podem ser usadas com a função **setsockopt** , mas somente a **opção \_ BTH \_ MTU** está disponível para uso com a função **getsockopt** .</span><span class="sxs-lookup"><span data-stu-id="d9b26-107">All of the following options can be used with the **setsockopt** function, but only the **SO\_BTH\_MTU** option is available for use with the **getsockopt** function.</span></span>

<span data-ttu-id="d9b26-108">As configurações a seguir são necessárias para trabalhar com opções de soquete Bluetooth:</span><span class="sxs-lookup"><span data-stu-id="d9b26-108">The following settings are required for working with Bluetooth socket options:</span></span>

-   <span data-ttu-id="d9b26-109">O parâmetro *s* deve ser um soquete Bluetooth.</span><span class="sxs-lookup"><span data-stu-id="d9b26-109">The *s* parameter must be a Bluetooth socket.</span></span>
-   <span data-ttu-id="d9b26-110">O parâmetro *Level* deve ser **sol \_ RFCOMM**.</span><span class="sxs-lookup"><span data-stu-id="d9b26-110">The *level* parameter must be **SOL\_RFCOMM**.</span></span>

## <a name="so_bth_authenticate"></a><span data-ttu-id="d9b26-111">Portanto, \_ BTH \_ autenticar</span><span class="sxs-lookup"><span data-stu-id="d9b26-111">SO\_BTH\_AUTHENTICATE</span></span>

<span data-ttu-id="d9b26-112">Para os soquetes desconectados, a **\_ BTH \_ autenticar** especifica que a autenticação é necessária para que uma operação de [**conexão**](/windows/desktop/api/winsock2/nf-winsock2-connect) ou [**aceitação**](/windows/desktop/api/winsock2/nf-winsock2-accept) seja concluída com êxito.</span><span class="sxs-lookup"><span data-stu-id="d9b26-112">For disconnected sockets, the **SO\_BTH\_AUTHENTICATE** specifies that authentication is required for a [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) or [**accept**](/windows/desktop/api/winsock2/nf-winsock2-accept) operation to complete successfully.</span></span> <span data-ttu-id="d9b26-113">A definição dessa opção de soquete inicia ativamente a autenticação durante o estabelecimento da conexão, se os dois dispositivos Bluetooth não tiverem sido autenticados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="d9b26-113">Setting this socket option actively initiates authentication during connection establishment, if the two Bluetooth devices were not previously authenticated.</span></span> <span data-ttu-id="d9b26-114">A interface do usuário para troca de chaves de acesso, se necessário, é fornecida pelo sistema operacional fora do contexto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d9b26-114">The user interface for passkey exchange, if necessary, is provided by the operating system outside the application context.</span></span>

<span data-ttu-id="d9b26-115">Para conexões de saída que exigem autenticação, a operação de [**conexão**](/windows/desktop/api/winsock2/nf-winsock2-connect) falha com **WSAEACCES** se a autenticação não for bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="d9b26-115">For outgoing connections that require authentication, the [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) operation fails with **WSAEACCES** if authentication is not successful.</span></span> <span data-ttu-id="d9b26-116">Em resposta, o aplicativo pode solicitar que o usuário autentique os dois dispositivos Bluetooth antes da conexão.</span><span class="sxs-lookup"><span data-stu-id="d9b26-116">In response, the application may prompt the user to authenticate the two Bluetooth devices before connection.</span></span>

<span data-ttu-id="d9b26-117">Para conexões de entrada, a conexão será rejeitada se a autenticação não puder ser estabelecida e retornar um erro **WSAEHOSTDOWN** .</span><span class="sxs-lookup"><span data-stu-id="d9b26-117">For incoming connections, the connection is rejected if authentication cannot be established and returns a **WSAEHOSTDOWN** error.</span></span> <span data-ttu-id="d9b26-118">Para obter mais informações sobre como autenticar dispositivos Bluetooth, consulte [**BluetoothAuthenticateDevice**](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice).</span><span class="sxs-lookup"><span data-stu-id="d9b26-118">For more information about authenticating Bluetooth devices, see [**BluetoothAuthenticateDevice**](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice).</span></span>

<span data-ttu-id="d9b26-119">Para a **opção \_ BTH \_ Authenticate** Socket, *optval* é um ponteiro para o ULONG bAuthenticate e deve ser **true**; *optlen* é equivalente a "sizeof (ULong)".</span><span class="sxs-lookup"><span data-stu-id="d9b26-119">For the **SO\_BTH\_AUTHENTICATE** socket option, *optval* is a pointer to ULONG bAuthenticate and must be **TRUE**; *optlen* is equivalent to "sizeof(ULONG)".</span></span>

<span data-ttu-id="d9b26-120">**Windows XP com SP2: portanto \_ O BTH \_ Authenticate** inicia a autenticação para soquetes conectados e força a autenticação durante a conexão para soquetes não conectados.</span><span class="sxs-lookup"><span data-stu-id="d9b26-120">**Windows XP with SP2:  SO\_BTH\_AUTHENTICATE** starts authentication for connected sockets, and forces authentication upon connection for unconnected sockets.</span></span> <span data-ttu-id="d9b26-121">Para conexões de entrada, a conexão será rejeitada se a autenticação não puder ser executada.</span><span class="sxs-lookup"><span data-stu-id="d9b26-121">For incoming connections, the connection is rejected if authentication cannot be performed.</span></span>

## <a name="so_bth_encrypt"></a><span data-ttu-id="d9b26-122">\_BTH \_ criptografar</span><span class="sxs-lookup"><span data-stu-id="d9b26-122">SO\_BTH\_ENCRYPT</span></span>

<span data-ttu-id="d9b26-123">Em soquetes não conectados, a opção **\_ BTH \_ Encrypt** Socket impõe a criptografia para estabelecer uma conexão.</span><span class="sxs-lookup"><span data-stu-id="d9b26-123">On unconnected sockets, the **SO\_BTH\_ENCRYPT** socket option enforces encryption to establish a connection.</span></span> <span data-ttu-id="d9b26-124">A criptografia só está disponível para conexões autenticadas.</span><span class="sxs-lookup"><span data-stu-id="d9b26-124">Encryption is only available for authenticated connections.</span></span> <span data-ttu-id="d9b26-125">Para conexões de entrada, uma conexão para a qual a criptografia não pode ser estabelecida é rejeitada automaticamente e retorna **WSAEHOSTDOWN** como o erro.</span><span class="sxs-lookup"><span data-stu-id="d9b26-125">For incoming connections, a connection for which encryption cannot be established is automatically rejected and returns **WSAEHOSTDOWN** as the error.</span></span> <span data-ttu-id="d9b26-126">Para conexões de saída, a função [**Connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) falha com **WSAEACCES** se a criptografia não puder ser estabelecida.</span><span class="sxs-lookup"><span data-stu-id="d9b26-126">For outgoing connections, the [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect) function fails with **WSAEACCES** if encryption cannot be established.</span></span> <span data-ttu-id="d9b26-127">Em resposta, o aplicativo pode solicitar que o usuário autentique os dois dispositivos Bluetooth antes da conexão.</span><span class="sxs-lookup"><span data-stu-id="d9b26-127">In response, the application may prompt the user to authenticate the two Bluetooth devices before connection.</span></span> <span data-ttu-id="d9b26-128">Para obter mais informações sobre como autenticar dispositivos Bluetooth, consulte [**BluetoothAuthenticateDevice**](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice).</span><span class="sxs-lookup"><span data-stu-id="d9b26-128">For more information about authenticating Bluetooth devices, see [**BluetoothAuthenticateDevice**](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice).</span></span>

<span data-ttu-id="d9b26-129">Para a \_ opção BTH \_ Encrypt Socket, *optval* é um ponteiro para ULONG **bEncrypt** e deve ser **true**; *optlen* é equivalente a sizeof (ULong).</span><span class="sxs-lookup"><span data-stu-id="d9b26-129">For the SO\_BTH\_ENCRYPT socket option, *optval* is a pointer to ULONG **bEncrypt** and must be **TRUE**; *optlen* is equivalent to sizeof(ULONG).</span></span>

<span data-ttu-id="d9b26-130">**Windows XP com SP2:** Para um soquete que está conectado e autenticado, **portanto, \_ BTH \_ criptografar** inicia a criptografia.</span><span class="sxs-lookup"><span data-stu-id="d9b26-130">**Windows XP with SP2:** For a socket that is connected and authenticated, **SO\_BTH\_ENCRYPT** starts encryption.</span></span>

## <a name="so_bth_mtu"></a><span data-ttu-id="d9b26-131">\_BTH \_ MTU</span><span class="sxs-lookup"><span data-stu-id="d9b26-131">SO\_BTH\_MTU</span></span>

<span data-ttu-id="d9b26-132">A opção de soquete **\_ BTH \_ MTU** é uma opção avançada usada principalmente para validação.</span><span class="sxs-lookup"><span data-stu-id="d9b26-132">The **SO\_BTH\_MTU** socket option is an advanced option used primarily for validation.</span></span> <span data-ttu-id="d9b26-133">A **opção \_ BTH \_ MTU** Obtém ou define a MTU RFCOMM padrão (unidade de transmissão máxima) para negociação de conexão com um valor diferente do valor padrão do protocolo RFCOMM.</span><span class="sxs-lookup"><span data-stu-id="d9b26-133">The **SO\_BTH\_MTU** option obtains or sets default RFCOMM MTU (maximum transmission unit) for connection negotiation to a value different than the RFCOMM protocol-default value.</span></span>

<span data-ttu-id="d9b26-134">Como o RFCOMM MTU é afetado pelo MTU L2CAP subjacente e pelos mínimos e máximos de protocolo e de aplicativo, o valor padrão para o **\_ \_ MTU de BTH** é apenas um ponto de partida para a negociação com o par remoto, e o MTU negociado final provavelmente vai variar do padrão.</span><span class="sxs-lookup"><span data-stu-id="d9b26-134">Because RFCOMM MTU is affected by the underlying L2CAP MTU, and protocol and application minimums and maximums, the default value for **SO\_BTH\_MTU** is only a starting point for negotiation with the remote peer, and the final negotiated MTU is likely to vary from the default.</span></span> <span data-ttu-id="d9b26-135">Definir o valor de **\_ \_ MTU BTH** pode afetar negativamente a taxa de transferência e, dessa forma, qualquer modificação deve ser executada com o conhecimento do protocolo Bluetooth subjacente.</span><span class="sxs-lookup"><span data-stu-id="d9b26-135">Setting the **SO\_BTH\_MTU** value may negatively affect throughput, and as such, any modification should be performed with knowledge of the underlying Bluetooth protocol.</span></span>

<span data-ttu-id="d9b26-136">A opção Soquete de **\_ \_ MTU de BTH** pode ser executada em soquetes conectados, mas não tem efeito se a negociação já tiver sido concluída.</span><span class="sxs-lookup"><span data-stu-id="d9b26-136">The **SO\_BTH\_MTU** socket option can be performed on connected sockets, but has no effect if the negotiation has already completed.</span></span> <span data-ttu-id="d9b26-137">Configurá-lo no soquete de escuta (servidor) não tem nenhum efeito.</span><span class="sxs-lookup"><span data-stu-id="d9b26-137">Setting it on the listening (server) socket has no effect.</span></span>

<span data-ttu-id="d9b26-138">A quantidade de dados que um aplicativo pode enviar ou receber em uma única chamada de soquete não é afetada pelo MTU; O MTU afeta apenas como o provedor de serviço Windows Sockets subjacente segmenta pacotes para transporte.</span><span class="sxs-lookup"><span data-stu-id="d9b26-138">The amount of data that an application can send or receive in a single socket call is not affected by the MTU; MTU only affects how the underlying Windows Sockets service provider segments packets for transport.</span></span> <span data-ttu-id="d9b26-139">O MTU proposto e o MTU, por fim, negociados devem estar entre **RFCOMM \_ min \_ MTU** e **RFCOMM \_ Max \_ MTU**, conforme definido no arquivo de cabeçalho Ws2bth. h.</span><span class="sxs-lookup"><span data-stu-id="d9b26-139">Both the proposed MTU and the MTU ultimately negotiated must be between **RFCOMM\_MIN\_MTU** and **RFCOMM\_MAX\_MTU**, as defined in the Ws2bth.h header file.</span></span>

<span data-ttu-id="d9b26-140">Para a opção de soquete **\_ BTH \_ MTU** , *optval* é um ponteiro para MTU de ULong; *optlen* é equivalente a "sizeof (ULong)".</span><span class="sxs-lookup"><span data-stu-id="d9b26-140">For the **SO\_BTH\_MTU** socket option, *optval* is a pointer to ULONG mtu; *optlen* is equivalent to "sizeof(ULONG)".</span></span>

## <a name="so_bth_mtu_max"></a><span data-ttu-id="d9b26-141">Portanto, \_ BTH \_ MTU \_ Max</span><span class="sxs-lookup"><span data-stu-id="d9b26-141">SO\_BTH\_MTU\_MAX</span></span>

<span data-ttu-id="d9b26-142">A opção de soquete **\_ BTH \_ MTU \_ Max** é uma opção avançada usada principalmente para validação.</span><span class="sxs-lookup"><span data-stu-id="d9b26-142">The **SO\_BTH\_MTU\_MAX** socket option is an advanced option used primarily for validation.</span></span> <span data-ttu-id="d9b26-143">A opção de soquete **\_ BTH \_ MTU \_ Max** define a MTU máxima de RFCOMM (unidade de transmissão máxima) para negociação de conexão.</span><span class="sxs-lookup"><span data-stu-id="d9b26-143">The **SO\_BTH\_MTU\_MAX** socket option sets the maximum RFCOMM MTU (maximum transmission unit) for connection negotiation.</span></span> <span data-ttu-id="d9b26-144">As conexões com um MTU RFCOMM igual ou maior que esse valor falham durante o processo de aceitação de [**conexão**](/windows/desktop/api/winsock2/nf-winsock2-connect) / [](/windows/desktop/api/winsock2/nf-winsock2-accept) .</span><span class="sxs-lookup"><span data-stu-id="d9b26-144">Connections with an RFCOMM MTU equal to or greater than this value fail during the [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect)/[**accept**](/windows/desktop/api/winsock2/nf-winsock2-accept) process.</span></span> <span data-ttu-id="d9b26-145">Embora a definição dessa opção de soquete seja permitida para um Soquete conectado, ela não terá efeito se a negociação tiver sido concluída.</span><span class="sxs-lookup"><span data-stu-id="d9b26-145">While setting this socket option is allowed for a connected socket, it has no effect if the negotiation has completed.</span></span> <span data-ttu-id="d9b26-146">Definir essa opção de soquete em um soquete de escuta propaga o valor para todas as conexões de entrada.</span><span class="sxs-lookup"><span data-stu-id="d9b26-146">Setting this socket option on a listening socket propagates the value for all incoming connections.</span></span> <span data-ttu-id="d9b26-147">O valor de MTU máximo deve estar entre **RFCOMM \_ min \_ MTU** e **RFCOMM \_ Max \_ MTU**, conforme definido no arquivo de cabeçalho Ws2bth. h.</span><span class="sxs-lookup"><span data-stu-id="d9b26-147">The MAX MTU value must be between **RFCOMM\_MIN\_MTU** and **RFCOMM\_MAX\_MTU**, as defined in the Ws2bth.h header file.</span></span>

<span data-ttu-id="d9b26-148">Para a opção de soquete **\_ \_ \_ máximo BTH MTU** , *optval* é um ponteiro para MTU máximo ULONG \_ ; *optlen* é equivalente a "sizeof (ULong)".</span><span class="sxs-lookup"><span data-stu-id="d9b26-148">For the **SO\_BTH\_MTU\_MAX** socket option, *optval* is a pointer to ULONG max\_mtu; *optlen* is equivalent to "sizeof(ULONG)".</span></span>

## <a name="so_bth_mtu_min"></a><span data-ttu-id="d9b26-149">\_BTH \_ MTU \_ mín.</span><span class="sxs-lookup"><span data-stu-id="d9b26-149">SO\_BTH\_MTU\_MIN</span></span>

<span data-ttu-id="d9b26-150">A opção de soquete **\_ BTH \_ MTU \_ min** é uma opção avançada usada principalmente para validação.</span><span class="sxs-lookup"><span data-stu-id="d9b26-150">The **SO\_BTH\_MTU\_MIN** socket option is an advanced option used primarily for validation.</span></span> <span data-ttu-id="d9b26-151">A **opção \_ BTH \_ MTU \_ min** Socket define a MTU de RFCOMM mínima (unidade de transmissão máxima) para negociação de conexão.</span><span class="sxs-lookup"><span data-stu-id="d9b26-151">The **SO\_BTH\_MTU\_MIN** socket option sets the minimum RFCOMM MTU (maximum transmission unit) for connection negotiation.</span></span> <span data-ttu-id="d9b26-152">As conexões com um MTU RFCOMM menor que esse valor falham durante o processo de aceitação de [**conexão**](/windows/desktop/api/winsock2/nf-winsock2-connect) / [](/windows/desktop/api/winsock2/nf-winsock2-accept) .</span><span class="sxs-lookup"><span data-stu-id="d9b26-152">Connections with an RFCOMM MTU smaller than this value fail during the [**connect**](/windows/desktop/api/winsock2/nf-winsock2-connect)/[**accept**](/windows/desktop/api/winsock2/nf-winsock2-accept) process.</span></span> <span data-ttu-id="d9b26-153">Embora a definição dessa opção de soquete seja permitida para um Soquete conectado, ela não terá efeito se a negociação tiver sido concluída.</span><span class="sxs-lookup"><span data-stu-id="d9b26-153">While setting this socket option is allowed for a connected socket, it has no effect if the negotiation has completed.</span></span> <span data-ttu-id="d9b26-154">Definir essa opção de soquete em um soquete de escuta propaga o valor para todas as conexões de entrada.</span><span class="sxs-lookup"><span data-stu-id="d9b26-154">Setting this socket option on a listening socket propagates the value for all incoming connections.</span></span>

<span data-ttu-id="d9b26-155">Somente um soquete de escuta pode revisar o MTU para baixo, portanto, se o valor proposto pelo soquete de conexão for menor que o valor definido para o **\_ BTH \_ MTU \_ min** no soquete de escuta, a conexão será recusada.</span><span class="sxs-lookup"><span data-stu-id="d9b26-155">Only a listening socket can revise the MTU downward, therefore if the value proposed by the connecting socket is less than the value set for **SO\_BTH\_MTU\_MIN** on the listening socket, the connection is refused.</span></span> <span data-ttu-id="d9b26-156">A MTU mínima deve estar entre **RFCOMM \_ min \_ MTU** e **RFCOMM \_ Max \_ MTU**, conforme definido no arquivo de cabeçalho Ws2bth. h.</span><span class="sxs-lookup"><span data-stu-id="d9b26-156">The minimum MTU must be between **RFCOMM\_MIN\_MTU** and **RFCOMM\_MAX\_MTU**, as defined in the Ws2bth.h header file.</span></span>

<span data-ttu-id="d9b26-157">Para a \_ opção de \_ soquete BTH MTU \_ min, *optval* é um ponteiro para MTU mínimo de ULong \_ ; *optlen* é equivalente a "sizeof (ULong)".</span><span class="sxs-lookup"><span data-stu-id="d9b26-157">For the SO\_BTH\_MTU\_MIN socket option, *optval* is a pointer to ULONG min\_mtu; *optlen* is equivalent to "sizeof(ULONG)".</span></span>

## <a name="related-topics"></a><span data-ttu-id="d9b26-158">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="d9b26-158">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d9b26-159">Windows Sockets</span><span class="sxs-lookup"><span data-stu-id="d9b26-159">Windows Sockets</span></span>](/windows/desktop/WinSock/windows-sockets-start-page-2)
</dt> <dt>

[<span data-ttu-id="d9b26-160">**getsockopt**</span><span class="sxs-lookup"><span data-stu-id="d9b26-160">**getsockopt**</span></span>](/windows/desktop/api/winsock/nf-winsock-getsockopt)
</dt> <dt>

[<span data-ttu-id="d9b26-161">**setsockopt**</span><span class="sxs-lookup"><span data-stu-id="d9b26-161">**setsockopt**</span></span>](/windows/desktop/api/winsock/nf-winsock-setsockopt)
</dt> <dt>

[<span data-ttu-id="d9b26-162">**BluetoothAuthenticateDevice**</span><span class="sxs-lookup"><span data-stu-id="d9b26-162">**BluetoothAuthenticateDevice**</span></span>](/windows/desktop/api/BluetoothAPIs/nf-bluetoothapis-bluetoothauthenticatedevice)
</dt> <dt>

[<span data-ttu-id="d9b26-163">**conectar**</span><span class="sxs-lookup"><span data-stu-id="d9b26-163">**connect**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-connect)
</dt> <dt>

[<span data-ttu-id="d9b26-164">**aceitar**</span><span class="sxs-lookup"><span data-stu-id="d9b26-164">**accept**</span></span>](/windows/desktop/api/winsock2/nf-winsock2-accept)
</dt> </dl>

 

 