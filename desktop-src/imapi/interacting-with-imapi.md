---
title: Interagindo com IMAPi
description: As etapas a seguir descrevem uma interação típica entre um aplicativo e o IMAPi.
ms.assetid: e57a86c4-7e27-40cf-a9c1-081b3f20d9d9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3e68bee24cfe0724ed14d439b0789f5023338853
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103916343"
---
# <a name="interacting-with-imapi"></a><span data-ttu-id="d7ae1-103">Interagindo com IMAPi</span><span class="sxs-lookup"><span data-stu-id="d7ae1-103">Interacting with IMAPI</span></span>

<span data-ttu-id="d7ae1-104">As etapas a seguir descrevem uma interação típica entre um aplicativo e o IMAPi.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-104">The following steps describe a typical interaction between an application and IMAPI.</span></span>

1.  <span data-ttu-id="d7ae1-105">Crie uma instância do **MSDiscMasterObj** (usando **CoCreateInstance**, apontadores inteligentes de uma importação e assim por diante) e solicite a interface [**IDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-idiscmaster) .</span><span class="sxs-lookup"><span data-stu-id="d7ae1-105">Create an instance of the **MSDiscMasterObj** (using **CoCreateInstance**, smart pointers from an import, and so on) and request the [**IDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-idiscmaster) interface.</span></span>
2.  <span data-ttu-id="d7ae1-106">Adquira acesso ao IMAPi chamando [**IDiscMaster:: Open**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-open).</span><span class="sxs-lookup"><span data-stu-id="d7ae1-106">Acquire access to IMAPI by calling [**IDiscMaster::Open**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-open).</span></span> <span data-ttu-id="d7ae1-107">Se essa chamada for bem sucedido, o aplicativo terá acesso completo a todas as interfaces e métodos implementados no **MSDiscMasterObj**.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-107">If this call succeeds, the application has full access to all the interfaces and methods implemented in **MSDiscMasterObj**.</span></span>
3.  <span data-ttu-id="d7ae1-108">Recupere o enumerador de formato mestre de disco usando [**EnumDiscMasterFormats**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscmasterformats).</span><span class="sxs-lookup"><span data-stu-id="d7ae1-108">Retrieve the disc master format enumerator using [**EnumDiscMasterFormats**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscmasterformats).</span></span> <span data-ttu-id="d7ae1-109">Enumere o conjunto de formatos que o objeto mestre de disco dá suporte e, em seguida, selecione o formato ativo.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-109">Enumerate the set of formats that the disc master object supports, then select the active format.</span></span> <span data-ttu-id="d7ae1-110">Os formatos retornados do enumerador são o IIDs das interfaces para [**IJolietDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-ijolietdiscmaster) e [**IRedbookDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-iredbookdiscmaster).</span><span class="sxs-lookup"><span data-stu-id="d7ae1-110">The formats returned from the enumerator are the IIDs of the interfaces for [**IJolietDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-ijolietdiscmaster) and [**IRedbookDiscMaster**](/windows/desktop/api/Imapi/nn-imapi-iredbookdiscmaster).</span></span>
4.  <span data-ttu-id="d7ae1-111">Recupere o enumerador do gravador de disco usando [**EnumDiscRecorders**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscrecorders).</span><span class="sxs-lookup"><span data-stu-id="d7ae1-111">Retrieve the disc recorder enumerator using [**EnumDiscRecorders**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-enumdiscrecorders).</span></span> <span data-ttu-id="d7ae1-112">Enumere a lista de gravadores de disco com suporte (específicos ao formato ativo) e, em seguida, selecione o gravador ativo.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-112">Enumerate the list of supported disc recorders (specific to the active format), then select the active recorder.</span></span> <span data-ttu-id="d7ae1-113">A interface [**IDiscRecorder**](/windows/desktop/api/Imapi/nn-imapi-idiscrecorder) representa um dispositivo físico.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-113">The [**IDiscRecorder**](/windows/desktop/api/Imapi/nn-imapi-idiscrecorder) interface represents a physical device.</span></span>
5.  <span data-ttu-id="d7ae1-114">Use [**IDiscMaster::P rogressadvise**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-progressadvise) para se registrar para retornos de chamada de andamento.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-114">Use [**IDiscMaster::ProgressAdvise**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-progressadvise) to register for progress callbacks.</span></span>
6.  <span data-ttu-id="d7ae1-115">Use a interface para o formato selecionado para criar conteúdo.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-115">Use the interface for the selected format to build up content.</span></span> <span data-ttu-id="d7ae1-116">O conteúdo é compilado de forma incremental, de modo que o conteúdo das trilhas ou da pasta pode ser adicionado a uma parte do disco.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-116">Content builds incrementally, so tracks or folder contents can be added to a disc piece by piece.</span></span> <span data-ttu-id="d7ae1-117">A criação desse conteúdo é chamada *de preparo de uma imagem*.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-117">Building up this content is called *staging an image*.</span></span> <span data-ttu-id="d7ae1-118">O conteúdo da imagem preparada não pode ser excluído incrementalmente (não é possível remover uma faixa que foi adicionada), mas é possível limpar o conteúdo de uma imagem preparada para que o preparo possa ser iniciado novamente.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-118">The contents of the staged image cannot be incrementally deleted (you cannot remove a track that has been added), but it is possible to clear the contents of a staged image so that staging can start again.</span></span> <span data-ttu-id="d7ae1-119">Use [**IDiscMaster:: ClearFormatContent**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-clearformatcontent) para reiniciar o preparo.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-119">Use [**IDiscMaster::ClearFormatContent**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-clearformatcontent) to restart staging.</span></span>

<span data-ttu-id="d7ae1-120">**Para áudio:  **</span><span class="sxs-lookup"><span data-stu-id="d7ae1-120">**For Audio:  **</span></span>

1.  <span data-ttu-id="d7ae1-121">Use [**IRedbookDiscMaster:: CreateAudioTrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-createaudiotrack) para indicar que uma nova faixa de áudio está sendo iniciada no disco.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-121">Use [**IRedbookDiscMaster::CreateAudioTrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-createaudiotrack) to indicate a new audio track is being started on the disc.</span></span>
2.  <span data-ttu-id="d7ae1-122">Use [**IRedbookDiscMaster:: AddAudioTrackBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-addaudiotrackblocks) para adicionar dados brutos de áudio a um controle. O aplicativo pode usar [**GetAvailableAudioTrackBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getavailableaudiotrackblocks), [**GetTotalAudioBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-gettotalaudioblocks)e [**GetUsedAudioBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getusedaudioblocks) para recuperar informações estatísticas.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-122">Use [**IRedbookDiscMaster::AddAudioTrackBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-addaudiotrackblocks) to add raw audio data to a track. The application can use [**GetAvailableAudioTrackBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getavailableaudiotrackblocks), [**GetTotalAudioBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-gettotalaudioblocks), and [**GetUsedAudioBlocks**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-getusedaudioblocks) to retrieve statistical information.</span></span>
3.  <span data-ttu-id="d7ae1-123">Use [**IRedbookDiscMaster:: CloseAudioTrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-closeaudiotrack) para fechar uma faixa de áudio.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-123">Use [**IRedbookDiscMaster::CloseAudioTrack**](/windows/desktop/api/Imapi/nf-imapi-iredbookdiscmaster-closeaudiotrack) to close an audio track.</span></span>
4.  <span data-ttu-id="d7ae1-124">Repita as etapas de 1-3 até sem espaço ou todas as faixas de áudio foram gravadas.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-124">Repeat steps 1-3 until out of space or all audio tracks have been written.</span></span>

<span data-ttu-id="d7ae1-125">**Para dados:  **</span><span class="sxs-lookup"><span data-stu-id="d7ae1-125">**For Data:  **</span></span>

1.  <span data-ttu-id="d7ae1-126">Use [**IJolietDiscMaster:: AddData**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-adddata) para adicionar o conteúdo de uma pasta à imagem.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-126">Use [**IJolietDiscMaster::AddData**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-adddata) to add the contents of a folder to the image.</span></span> <span data-ttu-id="d7ae1-127">Os itens dentro de uma pasta são colocados na raiz do arquivo de imagem.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-127">The items within a folder are placed in the root of the image file.</span></span> <span data-ttu-id="d7ae1-128">Use [**GetTotalDataBlocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-gettotaldatablocks) e [**GetUsedDataBlocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-getuseddatablocks) para recuperar informações estatísticas.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-128">Use [**GetTotalDataBlocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-gettotaldatablocks) and [**GetUsedDataBlocks**](/windows/desktop/api/Imapi/nf-imapi-ijolietdiscmaster-getuseddatablocks) to retrieve statistical information.</span></span>
2.  <span data-ttu-id="d7ae1-129">Repita a etapa acima até sem espaço ou todos os dados tiverem sido adicionados.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-129">Repeat the above step until out of space or all data has been added.</span></span>

<span data-ttu-id="d7ae1-130">**Para todos os discos:  **</span><span class="sxs-lookup"><span data-stu-id="d7ae1-130">**For All Discs:  **</span></span>

1.  <span data-ttu-id="d7ae1-131">Use [**IDiscMaster:: RecordDisc**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-recorddisc) para registrar o disco.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-131">Use [**IDiscMaster::RecordDisc**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-recorddisc) to record the disc.</span></span>
2.  <span data-ttu-id="d7ae1-132">Feche a sessão IMAPi usando [**IDiscMaster:: Close**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-close).</span><span class="sxs-lookup"><span data-stu-id="d7ae1-132">Close the IMAPI session using [**IDiscMaster::Close**](/windows/desktop/api/Imapi/nf-imapi-idiscmaster-close).</span></span> <span data-ttu-id="d7ae1-133">Fechar a sessão limpa o conteúdo do disco stash.</span><span class="sxs-lookup"><span data-stu-id="d7ae1-133">Closing the session clears the contents of the disc stash.</span></span>

 

 




