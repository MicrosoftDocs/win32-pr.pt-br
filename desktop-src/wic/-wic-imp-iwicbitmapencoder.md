---
description: Implementando IWICBitmapEncoder
ms.assetid: b671e941-ded6-4bde-bc4d-461f13feade0
title: Implementando IWICBitmapEncoder
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 590dffcf762d22155a89a8143994d9a4d8bcab02
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103829497"
---
# <a name="implementing-iwicbitmapencoder"></a><span data-ttu-id="c39b8-103">Implementando IWICBitmapEncoder</span><span class="sxs-lookup"><span data-stu-id="c39b8-103">Implementing IWICBitmapEncoder</span></span>

-   [<span data-ttu-id="c39b8-104">IWICBitmapEncoder</span><span class="sxs-lookup"><span data-stu-id="c39b8-104">IWICBitmapEncoder</span></span>](#implementing-iwicbitmapencoder)
    -   [<span data-ttu-id="c39b8-105">Inicializar</span><span class="sxs-lookup"><span data-stu-id="c39b8-105">Initialize</span></span>](#initialize)
    -   [<span data-ttu-id="c39b8-106">GetContainerFormat</span><span class="sxs-lookup"><span data-stu-id="c39b8-106">GetContainerFormat</span></span>](#getcontainerformat)
    -   [<span data-ttu-id="c39b8-107">GetEncoderInfo</span><span class="sxs-lookup"><span data-stu-id="c39b8-107">GetEncoderInfo</span></span>](#getencoderinfo)
    -   [<span data-ttu-id="c39b8-108">CreateNewFrame</span><span class="sxs-lookup"><span data-stu-id="c39b8-108">CreateNewFrame</span></span>](#createnewframe)
    -   [<span data-ttu-id="c39b8-109">Confirmar</span><span class="sxs-lookup"><span data-stu-id="c39b8-109">Commit</span></span>](#commit)
    -   [<span data-ttu-id="c39b8-110">SetPreview</span><span class="sxs-lookup"><span data-stu-id="c39b8-110">SetPreview</span></span>](#setpreview)
-   [<span data-ttu-id="c39b8-111">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="c39b8-111">Related topics</span></span>](#related-topics)

## <a name="iwicbitmapencoder"></a><span data-ttu-id="c39b8-112">IWICBitmapEncoder</span><span class="sxs-lookup"><span data-stu-id="c39b8-112">IWICBitmapEncoder</span></span>

-   [<span data-ttu-id="c39b8-113">Inicializar</span><span class="sxs-lookup"><span data-stu-id="c39b8-113">Initialize</span></span>](#initialize)
-   [<span data-ttu-id="c39b8-114">GetContainerFormat</span><span class="sxs-lookup"><span data-stu-id="c39b8-114">GetContainerFormat</span></span>](#getcontainerformat)
-   [<span data-ttu-id="c39b8-115">GetEncoderInfo</span><span class="sxs-lookup"><span data-stu-id="c39b8-115">GetEncoderInfo</span></span>](#getencoderinfo)
-   [<span data-ttu-id="c39b8-116">CreateNewFrame</span><span class="sxs-lookup"><span data-stu-id="c39b8-116">CreateNewFrame</span></span>](#createnewframe)
-   [<span data-ttu-id="c39b8-117">Confirmar</span><span class="sxs-lookup"><span data-stu-id="c39b8-117">Commit</span></span>](#commit)
-   [<span data-ttu-id="c39b8-118">SetPreview</span><span class="sxs-lookup"><span data-stu-id="c39b8-118">SetPreview</span></span>](#setpreview)

<span data-ttu-id="c39b8-119">Essa interface é a contraparte para a interface [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder) e é o ponto de partida para codificar um arquivo de imagem.</span><span class="sxs-lookup"><span data-stu-id="c39b8-119">This interface is the counterpart to the [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder) interface and is the starting point for encoding an image file.</span></span> <span data-ttu-id="c39b8-120">Assim como **IWICBitmapDecoder** é usado para recuperar propriedades de nível de contêiner e quadros individuais do contêiner de imagem, [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) é usado para definir propriedades em nível de contêiner e serializar quadros de imagem individuais no contêiner.</span><span class="sxs-lookup"><span data-stu-id="c39b8-120">Just as **IWICBitmapDecoder** is used for retrieving container-level properties and individual frames from the image container, [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) is used for setting container-level properties and serializing individual image frames into the container.</span></span> <span data-ttu-id="c39b8-121">Você implementa essa interface em sua classe de codificador de nível de contêiner.</span><span class="sxs-lookup"><span data-stu-id="c39b8-121">You implement this interface on your container-level encoder class.</span></span>

``` syntax
interface IWICBitmapEncoder : public IUnknown
{
   // Required methods
   HRESULT Initialize ( IStream *pIStream,
              WICBitmapEncoderCacheOption cacheOption );
   HRESULT GetContainerFormat ( GUID *pguidContainerFormat );
   HRESULT GetEncoderInfo ( IWICBitmapEncoderInfo **pIEncoderInfo );
   HRESULT CreateNewFrame ( IWICBitmapFrameEncode **ppIFrameEncode,
              IPropertyBag2 **ppIEncoderOptions );
   HRESULT Commit ( void );

   // Optional methods
   HRESULT SetPreview ( IWICBitmapSource *pIPreview );
   HRESULT SetThumbnail ( IWICBitmapSource *pIThumbnail );
   HRESULT SetColorContexts ( UINT cCount,
              IWICColorContext **ppIColorContext );
   HRESULT GetMetadataQueryWriter ( IWICMetadataQueryWriter 
              **ppIMetadataQueryWriter );
   HRESULT SetPalette ( IWICPalette *pIPalette);
};
```

<span data-ttu-id="c39b8-122">Conforme discutido na [implementação de IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md), alguns formatos de imagem têm miniaturas globais, contextos de cor ou metadados, enquanto muitos formatos de imagem fornecem esses apenas em uma base por quadro.</span><span class="sxs-lookup"><span data-stu-id="c39b8-122">As discussed in [Implementing IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md), some image formats have global thumbnails, color contexts, or metadata, while many image formats provide these only on a per-frame basis.</span></span> <span data-ttu-id="c39b8-123">Portanto, os métodos para configurá-los são opcionais em [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder), mas são necessários em [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode).</span><span class="sxs-lookup"><span data-stu-id="c39b8-123">Therefore, the methods for setting these are optional on [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder), but are required on [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode).</span></span> <span data-ttu-id="c39b8-124">Discutiremos os métodos que são opcionais em **IWICBitmapEncoder** na seção sobre **IWICBitmapFrameEncode**, onde eles são mais comumente implementados.</span><span class="sxs-lookup"><span data-stu-id="c39b8-124">We’ll discuss the methods that are optional on **IWICBitmapEncoder** in the section on **IWICBitmapFrameEncode**, where they’re most commonly implemented.</span></span>

<span data-ttu-id="c39b8-125">Se você não oferecer suporte a miniaturas globais, retornará WINCODEC \_ Err \_ CODECNOTHUMBNAIL do método SetThumbnail em [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder).</span><span class="sxs-lookup"><span data-stu-id="c39b8-125">If you don’t support global thumbnails, return WINCODEC\_ERR\_CODECNOTHUMBNAIL from the SetThumbnail method on [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder).</span></span> <span data-ttu-id="c39b8-126">Se você não oferecer suporte a uma paleta de nível de contêiner ou se a imagem que você está codificando não tiver um formato indexado, retornará WINCODEC \_ Err \_ PALETTEUNAVAILABLE do método SetPalette.</span><span class="sxs-lookup"><span data-stu-id="c39b8-126">If you don’t support a container-level palette, or if the image you are encoding doesn’t have an indexed format, return WINCODEC\_ERR\_PALETTEUNAVAILABLE from the SetPalette method.</span></span> <span data-ttu-id="c39b8-127">Para qualquer outro método sem suporte, retorne WINCODEC \_ Err \_ UNSUPPORTEDOPERATION.</span><span class="sxs-lookup"><span data-stu-id="c39b8-127">For any other unsupported methods, return WINCODEC\_ERR\_UNSUPPORTEDOPERATION.</span></span>

### <a name="initialize"></a><span data-ttu-id="c39b8-128">Inicializar</span><span class="sxs-lookup"><span data-stu-id="c39b8-128">Initialize</span></span>

<span data-ttu-id="c39b8-129">[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize) é o primeiro método invocado em um [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) depois de ter sido instanciado.</span><span class="sxs-lookup"><span data-stu-id="c39b8-129">[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize) is the first method invoked on an [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) after it has been instantiated.</span></span> <span data-ttu-id="c39b8-130">Um fluxo de imagem é passado para o codificador, e um chamador pode opcionalmente especificar uma opção de cache.</span><span class="sxs-lookup"><span data-stu-id="c39b8-130">An image stream is passed to the encoder, and a caller may optionally specify a cache option.</span></span> <span data-ttu-id="c39b8-131">No caso do decodificador, o fluxo é somente leitura, mas o fluxo passado para um codificador é um fluxo gravável, no qual o codificador serializará todos os dados de imagem e metadados.</span><span class="sxs-lookup"><span data-stu-id="c39b8-131">In the case of the decoder, the stream is read-only, but the stream passed to an encoder is a writeable stream, into which the encoder will serialize all of the image data and metadata.</span></span> <span data-ttu-id="c39b8-132">As opções de cache no codificador também são diferentes.</span><span class="sxs-lookup"><span data-stu-id="c39b8-132">The cache options on the encoder are different as well.</span></span>

``` syntax
enum WICBitmapEncoderCacheOption
{
   WICBitmapEncoderCacheInMemory,
   WICBitmapEncoderCacheTempFile,
   WICBitmapEncoderNoCache
}
```

<span data-ttu-id="c39b8-133">O aplicativo tem a opção de solicitar que o codificador armazene em cache os dados da imagem na memória, armazená-los em cache em um arquivo temporário ou gravá-los diretamente no arquivo de disco sem cache.</span><span class="sxs-lookup"><span data-stu-id="c39b8-133">The application has a choice of requesting the encoder to cache the image data in memory, cache it in a temporary file, or to write it directly into the disk file with no caching.</span></span> <span data-ttu-id="c39b8-134">Quando solicitado a armazenar em cache os dados em um arquivo temporário, o codificador deve criar um arquivo temporário no disco e gravar diretamente nesse arquivo sem armazenar em cache na memória.</span><span class="sxs-lookup"><span data-stu-id="c39b8-134">When asked to cache the data in a temporary file, the encoder should create a temporary file on disk and write directly to that file without caching in memory.</span></span> <span data-ttu-id="c39b8-135">Quando o chamador seleciona a opção sem cache, cada quadro deve ser confirmado na ordem antes que o próximo quadro possa ser criado.</span><span class="sxs-lookup"><span data-stu-id="c39b8-135">When the caller selects the no cache option, each frame must be committed in order before the next frame can be created.</span></span>

### <a name="getcontainerformat"></a><span data-ttu-id="c39b8-136">GetContainerFormat</span><span class="sxs-lookup"><span data-stu-id="c39b8-136">GetContainerFormat</span></span>

<span data-ttu-id="c39b8-137">[**GetContainerFormat**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-getcontainerformat) é implementado da mesma maneira que o método [GetContainerFormat](-wic-imp-iwicbitmapdecoder.md) na [implementação de IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md).</span><span class="sxs-lookup"><span data-stu-id="c39b8-137">[**GetContainerFormat**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-getcontainerformat) is implemented the same way as the [GetContainerFormat](-wic-imp-iwicbitmapdecoder.md) method in [Implementing IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md).</span></span>

### <a name="getencoderinfo"></a><span data-ttu-id="c39b8-138">GetEncoderInfo</span><span class="sxs-lookup"><span data-stu-id="c39b8-138">GetEncoderInfo</span></span>

<span data-ttu-id="c39b8-139">[**GetEncoderInfo**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-getencoderinfo) retorna um objeto [**IWICBitmapEncoderInfo**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapencoderinfo) .</span><span class="sxs-lookup"><span data-stu-id="c39b8-139">[**GetEncoderInfo**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-getencoderinfo) returns an [**IWICBitmapEncoderInfo**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapencoderinfo) object.</span></span> <span data-ttu-id="c39b8-140">Para obter o objeto **IWICBitmapEncoderInfo** , basta passar o GUID do seu codificador para o método [**CreateComponentInfo**](/windows/desktop/api/Wincodec/nf-wincodec-iwicimagingfactory-createcomponentinfo) em [**IWICImagingFactory**](/windows/desktop/api/Wincodec/nn-wincodec-iwicimagingfactory)e, em seguida, solicitar a interface **IWICBitmapEncoderInfo** nele.</span><span class="sxs-lookup"><span data-stu-id="c39b8-140">To get the **IWICBitmapEncoderInfo** object, just pass the GUID of your encoder to the [**CreateComponentInfo**](/windows/desktop/api/Wincodec/nf-wincodec-iwicimagingfactory-createcomponentinfo) method on [**IWICImagingFactory**](/windows/desktop/api/Wincodec/nn-wincodec-iwicimagingfactory), and then request the **IWICBitmapEncoderInfo** interface on it.</span></span>

<span data-ttu-id="c39b8-141">Consulte o exemplo em [implementando IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md) em [GetDecoderInfo](-wic-imp-iwicbitmapdecoder.md).</span><span class="sxs-lookup"><span data-stu-id="c39b8-141">See the example in [Implementing IWICBitmapDecoder](-wic-imp-iwicbitmapdecoder.md) under [GetDecoderInfo](-wic-imp-iwicbitmapdecoder.md).</span></span>

### <a name="createnewframe"></a><span data-ttu-id="c39b8-142">CreateNewFrame</span><span class="sxs-lookup"><span data-stu-id="c39b8-142">CreateNewFrame</span></span>

<span data-ttu-id="c39b8-143">[**CreateNewFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-createnewframe) é o equivalente do codificador de [**GetFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-getframe) em [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder).</span><span class="sxs-lookup"><span data-stu-id="c39b8-143">[**CreateNewFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-createnewframe) is the encoder counterpart of [**GetFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-getframe) on [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder).</span></span> <span data-ttu-id="c39b8-144">Esse método retorna um objeto [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode) , que é o objeto que realmente serializa os dados da imagem para um quadro específico dentro do contêiner.</span><span class="sxs-lookup"><span data-stu-id="c39b8-144">This method returns an [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode) object, which is the object that actually serializes the image data for a specific frame within the container.</span></span>

<span data-ttu-id="c39b8-145">Um dos benefícios do Windows Imaging Component (WIC) é que ele fornece uma camada de abstração para aplicativos que permite que eles trabalhem com todos os formatos de imagem da mesma maneira.</span><span class="sxs-lookup"><span data-stu-id="c39b8-145">One of the benefits of Windows Imaging Component (WIC) is that it provides a layer of abstraction for applications that enables them to work with all image formats in the same way.</span></span> <span data-ttu-id="c39b8-146">No entanto, nem todos os formatos de imagem são exatamente iguais.</span><span class="sxs-lookup"><span data-stu-id="c39b8-146">However, not all image formats are exactly the same.</span></span> <span data-ttu-id="c39b8-147">Alguns formatos de imagem têm recursos que outros não têm.</span><span class="sxs-lookup"><span data-stu-id="c39b8-147">Some image formats have capabilities that others don’t have.</span></span> <span data-ttu-id="c39b8-148">Para que os aplicativos possam aproveitar esses recursos exclusivos, é necessário fornecer uma maneira para que o codec os exponha.</span><span class="sxs-lookup"><span data-stu-id="c39b8-148">For applications to be able to take advantage of those unique capabilities, it’s necessary to provide a way for the codec to expose them.</span></span> <span data-ttu-id="c39b8-149">Essa é a finalidade das opções de codificador.</span><span class="sxs-lookup"><span data-stu-id="c39b8-149">This is the purpose of encoder options.</span></span> <span data-ttu-id="c39b8-150">Se o codec oferecer suporte a qualquer opção de codificador, você deverá criar um objeto [IPropertyBag2](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768192(v=vs.85)) que exponha as opções de codificador para as quais dá suporte e retorná-lo no parâmetro *ppIEncoderOptions* desse método.</span><span class="sxs-lookup"><span data-stu-id="c39b8-150">If your codec supports any encoder options, you should create an [IPropertyBag2](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768192(v=vs.85)) object that exposes the encoder options you support, and return it in the *ppIEncoderOptions* parameter of this method.</span></span> <span data-ttu-id="c39b8-151">O chamador pode usar esse objeto IPropertyBag2 para determinar quais opções de codificador o codec dá suporte.</span><span class="sxs-lookup"><span data-stu-id="c39b8-151">The caller can then use this IPropertyBag2 object to determine what encoder options your codec supports.</span></span> <span data-ttu-id="c39b8-152">Se o chamador quiser especificar valores para qualquer uma das opções de codificador com suporte, ele atribuirá o valor à propriedade relevante no objeto IPropertyBag2 e o passará para o objeto [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode) recém-criado em seu método Initialize.</span><span class="sxs-lookup"><span data-stu-id="c39b8-152">If the caller wants to specify values for any of the supported encoder options, they will assign the value to the relevant property in the IPropertyBag2 object and pass it to the newly created [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode) object in its Initialize method.</span></span>

<span data-ttu-id="c39b8-153">Para instanciar um objeto [IPropertyBag2](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768192(v=vs.85)) , primeiro você precisa criar um struct PROPBAG2 para especificar cada opção de codificador que o codificador suporta e seu tipo de dados para cada propriedade.</span><span class="sxs-lookup"><span data-stu-id="c39b8-153">To instantiate an [IPropertyBag2](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768192(v=vs.85)) object, you first need to create a PROPBAG2 struct to specify each encoder option your encoder supports and its data type for each property.</span></span> <span data-ttu-id="c39b8-154">Em seguida, você deve implementar um objeto IPropertyBag2 que impõe os intervalos de valores para cada propriedade na gravação e reconcilia todos os valores conflitantes ou sobrepostos.</span><span class="sxs-lookup"><span data-stu-id="c39b8-154">Then you must implement an IPropertyBag2 object that enforces the value ranges for each property on write, and reconciles any conflicting or overlapping values.</span></span> <span data-ttu-id="c39b8-155">Para conjuntos simples de opções de codificador não conflitantes, você pode invocar o método [**CreateEncoderPropertyBag**](/windows/desktop/api/Wincodecsdk/nf-wincodecsdk-iwiccomponentfactory-createencoderpropertybag) , que criará um objeto IPropertyBag2 simples usando as propriedades que você especificar em seu struct PROPBAG2.</span><span class="sxs-lookup"><span data-stu-id="c39b8-155">For simple sets of non-conflicting encoder options, you can invoke the [**CreateEncoderPropertyBag**](/windows/desktop/api/Wincodecsdk/nf-wincodecsdk-iwiccomponentfactory-createencoderpropertybag) method, which will create a simple IPropertyBag2 object using the properties you specify in your PROPBAG2 struct.</span></span> <span data-ttu-id="c39b8-156">Você ainda deve impor os intervalos de valores.</span><span class="sxs-lookup"><span data-stu-id="c39b8-156">You must still enforce the value ranges.</span></span> <span data-ttu-id="c39b8-157">Para obter opções de codificador mais avançadas ou se precisar reconciliar valores conflitantes, você deve escrever sua própria implementação de IPropertyBag2.</span><span class="sxs-lookup"><span data-stu-id="c39b8-157">For more advanced encoder options, or if you need to reconcile conflicting values, you should write your own IPropertyBag2 implementation.</span></span>


```C++
UINT cuiPropertyCount = 0;
IPropertyBag2* pPropertyBag = NULL;
PROPBAG2* pPropBagOptions;
HRESULT hr;

// Insert code here to initialize piPropertyBag with the 
// supported options for your encoder, and to initialize 
// cuiPropertyCount to the number of encoder option properties
// you are exposing.
...

hr = pComponentFactory->CreateEncoderPropertyBag( 
   pPropBagOptions, cuiPropertyCount, &pPropertyBag);
```



<span data-ttu-id="c39b8-158">O WIC fornece um pequeno conjunto de opções de codificador canônicos que são usadas por alguns dos formatos de imagem comuns.</span><span class="sxs-lookup"><span data-stu-id="c39b8-158">WIC provides a small set of canonical encoder options that are used by some of the common image formats.</span></span> <span data-ttu-id="c39b8-159">Todas as opções canônicas de codificador são opcionais e os codecs não são necessários para dar suporte a nenhuma delas.</span><span class="sxs-lookup"><span data-stu-id="c39b8-159">All of the canonical encoder options are optional, and codecs are not required to support any of them.</span></span> <span data-ttu-id="c39b8-160">O motivo pelo qual eles são fornecidos como opções canônicas é porque muitos aplicativos expõem a interface do usuário para que os usuários especifiquem essas opções ao salvar um arquivo de imagem em um formato que ofereça suporte a eles.</span><span class="sxs-lookup"><span data-stu-id="c39b8-160">The reason they are provided as canonical options is because many applications expose the user interface for users to specify these options when saving an image file in a format that supports them.</span></span> <span data-ttu-id="c39b8-161">Fornecer uma maneira canônica de especificar essas opções torna mais fácil para os aplicativos se comunicarem com os codificadores de forma consistente.</span><span class="sxs-lookup"><span data-stu-id="c39b8-161">Providing a canonical way to specify these options makes it easy for applications to communicate them to encoders in a consistent way.</span></span> <span data-ttu-id="c39b8-162">As opções canônicas de codificador são listadas na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="c39b8-162">The canonical encoder options are listed in the following table.</span></span>



| <span data-ttu-id="c39b8-163">Opção de codificador</span><span class="sxs-lookup"><span data-stu-id="c39b8-163">Encoder Option</span></span>     | <span data-ttu-id="c39b8-164">VARTYPE</span><span class="sxs-lookup"><span data-stu-id="c39b8-164">VARTYPE</span></span>  | <span data-ttu-id="c39b8-165">Intervalo de valores</span><span class="sxs-lookup"><span data-stu-id="c39b8-165">Value Range</span></span>               |
|--------------------|----------|---------------------------|
| <span data-ttu-id="c39b8-166">Lossless</span><span class="sxs-lookup"><span data-stu-id="c39b8-166">Lossless</span></span>           | <span data-ttu-id="c39b8-167">BOOL do VT \_</span><span class="sxs-lookup"><span data-stu-id="c39b8-167">VT\_BOOL</span></span> | <span data-ttu-id="c39b8-168">Verdadeiro/Falso</span><span class="sxs-lookup"><span data-stu-id="c39b8-168">True/False</span></span>                |
| <span data-ttu-id="c39b8-169">ImageQuality</span><span class="sxs-lookup"><span data-stu-id="c39b8-169">ImageQuality</span></span>       | <span data-ttu-id="c39b8-170">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="c39b8-170">VT\_R4</span></span>   | <span data-ttu-id="c39b8-171">0,0 a 1,0</span><span class="sxs-lookup"><span data-stu-id="c39b8-171">0.0-1.0</span></span>                   |
| <span data-ttu-id="c39b8-172">CompressionQuality</span><span class="sxs-lookup"><span data-stu-id="c39b8-172">CompressionQuality</span></span> | <span data-ttu-id="c39b8-173">VT \_ R4</span><span class="sxs-lookup"><span data-stu-id="c39b8-173">VT\_R4</span></span>   | <span data-ttu-id="c39b8-174">0,0 a 1,0</span><span class="sxs-lookup"><span data-stu-id="c39b8-174">0.0-1.0</span></span>                   |
| <span data-ttu-id="c39b8-175">BitmapTransform</span><span class="sxs-lookup"><span data-stu-id="c39b8-175">BitmapTransform</span></span>    | <span data-ttu-id="c39b8-176">\_UI1 VT</span><span class="sxs-lookup"><span data-stu-id="c39b8-176">VT\_UI1</span></span>  | <span data-ttu-id="c39b8-177">WICBitmapTransformOptions</span><span class="sxs-lookup"><span data-stu-id="c39b8-177">WICBitmapTransformOptions</span></span> |



 

<span data-ttu-id="c39b8-178">Se o codec der suporte à codificação sem perdas, você deverá expor a opção de codificador sem perdas como uma maneira de os aplicativos solicitarem que uma imagem seja codificada sem perdas.</span><span class="sxs-lookup"><span data-stu-id="c39b8-178">If your codec supports lossless encoding, you should expose the Lossless encoder option as a way for applications to request that an image be losslessly encoded.</span></span> <span data-ttu-id="c39b8-179">Se um chamador definir essa propriedade como true, você deverá ignorar a opção ImageQuality e codificar a imagem sem perdas.</span><span class="sxs-lookup"><span data-stu-id="c39b8-179">If a caller sets this property to True, you should ignore the ImageQuality option and encode the image losslessly.</span></span>

<span data-ttu-id="c39b8-180">A opção ImageQuality permite que um aplicativo especifique o grau de fidelidade com o qual codificar a imagem.</span><span class="sxs-lookup"><span data-stu-id="c39b8-180">The ImageQuality option allows an application to specify the degree of fidelity with which to encode the image.</span></span> <span data-ttu-id="c39b8-181">Essa opção permite que um usuário faça uma compensação entre qualidade de imagem versus velocidade e/ou tamanho do arquivo.</span><span class="sxs-lookup"><span data-stu-id="c39b8-181">This option lets a user make a tradeoff between image quality versus speed and/or file size.</span></span> <span data-ttu-id="c39b8-182">JPEG é um exemplo de formato de imagem que dá suporte a essa compensação.</span><span class="sxs-lookup"><span data-stu-id="c39b8-182">JPEG is an example of an image format that supports this tradeoff.</span></span> <span data-ttu-id="c39b8-183">Um valor de 0,0 indica que a fidelidade é de baixa importância e que o codificador deve usar seu algoritmo mais com perda.</span><span class="sxs-lookup"><span data-stu-id="c39b8-183">A value of 0.0 indicates that fidelity is of low importance and the encoder should use its most lossy algorithm.</span></span> <span data-ttu-id="c39b8-184">Um valor de 1,0 indica que a fidelidade é a mais importante e o codificador deve preservar a maior fidelidade possível.</span><span class="sxs-lookup"><span data-stu-id="c39b8-184">A value of 1.0 indicates that fidelity is the most important and the encoder should preserve the highest fidelity possible.</span></span> <span data-ttu-id="c39b8-185">(Dependendo do seu codec, isso pode ser sinônimo da opção sem perdas.</span><span class="sxs-lookup"><span data-stu-id="c39b8-185">(Depending on your codec, this may be synonymous with the Lossless option.</span></span> <span data-ttu-id="c39b8-186">No entanto, se o codec der suporte à codificação sem perdas e se a opção sem perdas for definida como true, a opção ImageQuality deverá ser ignorada.)</span><span class="sxs-lookup"><span data-stu-id="c39b8-186">However, if your codec supports lossless encoding, and if the Lossless option is set to True, the ImageQuality option should be ignored.)</span></span>

<span data-ttu-id="c39b8-187">A opção CompressionQuality permite que um aplicativo especifique a eficiência da compactação a ser usada ao codificar a imagem.</span><span class="sxs-lookup"><span data-stu-id="c39b8-187">The CompressionQuality option allows an application to specify the efficiency of compression to use when encoding the image.</span></span> <span data-ttu-id="c39b8-188">Um algoritmo muito eficiente pode produzir um arquivo de imagem menor com a mesma qualidade que um algoritmo de compactação menos eficiente, mas pode levar mais tempo para codificar.</span><span class="sxs-lookup"><span data-stu-id="c39b8-188">A very efficient algorithm may produce a smaller image file with the same quality as a less efficient compression algorithm, but may take longer to encode.</span></span> <span data-ttu-id="c39b8-189">Essa opção permite que um usuário especifique uma compensação entre o tamanho do arquivo versus a velocidade de codificação, preservando o mesmo nível de qualidade.</span><span class="sxs-lookup"><span data-stu-id="c39b8-189">This option lets a user specify a tradeoff between file size versus speed of encoding, while preserving the same level of quality.</span></span> <span data-ttu-id="c39b8-190">TIFF é um exemplo de formato de imagem que dá suporte a essa compensação.</span><span class="sxs-lookup"><span data-stu-id="c39b8-190">TIFF is an example of an image format that supports this tradeoff.</span></span> <span data-ttu-id="c39b8-191">(Observe que um formato como o JPEG dá suporte a diferentes níveis de compactação, mas uma taxa mais alta de compactação resulta em uma qualidade de imagem inferior.</span><span class="sxs-lookup"><span data-stu-id="c39b8-191">(Note that a format such as JPEG supports different levels of compression, but a higher rate of compression results in lower image quality.</span></span> <span data-ttu-id="c39b8-192">Portanto, um formato de imagem JPEG exporia a opção ImageQuality em vez da opção CompressionQuality.) Um valor de 0,0 para essa opção indica que você deve compactar a imagem o mais rápido possível, sem reduzir a fidelidade, às custas de um tamanho de arquivo maior.</span><span class="sxs-lookup"><span data-stu-id="c39b8-192">Therefore, a JPEG image format would expose the ImageQuality option rather than the CompressionQuality option.) A value of 0.0 for this option indicates that you should compress the image as quickly as possible, without reducing fidelity, at the expense of a larger file size.</span></span> <span data-ttu-id="c39b8-193">Um valor de 1,0 indica que você deve criar o menor tamanho de arquivo possível (no mesmo nível de qualidade), independentemente de quanto tempo pode levar para codificá-lo.</span><span class="sxs-lookup"><span data-stu-id="c39b8-193">A value of 1.0 indicates that you should create the smallest possible file size (at the same level of quality), regardless of how long it may take to encode it.</span></span> <span data-ttu-id="c39b8-194">Um codec pode dar suporte à opção ImageQuality e à opção CompressionQuality, em que a opção ImageQuality especifica o grau aceitável de perda e a opção CompressionQuality oferece uma compensação de tamanho/velocidade no nível de qualidade especificado.</span><span class="sxs-lookup"><span data-stu-id="c39b8-194">A codec can support both the ImageQuality option and the CompressionQuality option, where the ImageQuality option specifies the acceptable degree of lossiness, and the CompressionQuality option offers a size/speed tradeoff at the specified quality level.</span></span>

<span data-ttu-id="c39b8-195">A opção BitmapTransform fornece uma maneira para o chamador especificar um ângulo de rotação ou uma orientação vertical ou horizontal invertida durante a codificação.</span><span class="sxs-lookup"><span data-stu-id="c39b8-195">The BitmapTransform option provides a way for the caller to specify a rotation angle or vertical or horizontal flip orientation when encoding.</span></span> <span data-ttu-id="c39b8-196">A enumeração WICBitmapTransformOptions usada para especificar a transformação solicitada é o mesmo enum usado ao solicitar uma transformação durante a decodificação por meio da interface IWICBitmapSourceTransform.</span><span class="sxs-lookup"><span data-stu-id="c39b8-196">The WICBitmapTransformOptions enum used to specify the requested transform is the same enum used when requesting a transform during decoding through the IWICBitmapSourceTransform interface.</span></span>

<span data-ttu-id="c39b8-197">Observe que os codificadores não estão limitados às opções de codificador canônico.</span><span class="sxs-lookup"><span data-stu-id="c39b8-197">Note that encoders are not limited to the canonical encoder options.</span></span> <span data-ttu-id="c39b8-198">A finalidade das opções de codificador é permitir que os codificadores exponham seus recursos, e não há nenhum limite para os tipos de recursos que você pode expor.</span><span class="sxs-lookup"><span data-stu-id="c39b8-198">The purpose of encoder options is to enable encoders to expose their capabilities, and there is no limit to the types of capabilities you can expose.</span></span> <span data-ttu-id="c39b8-199">Verifique se suas opções de codificador estão bem documentadas.</span><span class="sxs-lookup"><span data-stu-id="c39b8-199">Make sure your encoder options are well-documented.</span></span> <span data-ttu-id="c39b8-200">Embora um aplicativo possa usar o recipiente de propriedades que você retorna desse método para descobrir os nomes, os tipos e os intervalos de valores das opções que você dá suporte, a única maneira para eles descobrirem seus significados ou como expô-los na interface do usuário é de sua documentação.</span><span class="sxs-lookup"><span data-stu-id="c39b8-200">Even though an application can use the property bag you return from this method to discover the names, types, and value ranges for the options you support, the only way for them to find out their meanings, or how to expose them in the user interface, is from your documentation.</span></span>

### <a name="commit"></a><span data-ttu-id="c39b8-201">Commit</span><span class="sxs-lookup"><span data-stu-id="c39b8-201">Commit</span></span>

<span data-ttu-id="c39b8-202">[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit) é o método que você chama depois que todos os dados e metadados da imagem forem serializados no fluxo.</span><span class="sxs-lookup"><span data-stu-id="c39b8-202">[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit) is the method you call after all the image data and metadata have been serialized into the stream.</span></span> <span data-ttu-id="c39b8-203">Você deve usar esse método para serializar os dados da imagem de visualização para o fluxo e quaisquer miniaturas globais, metadados, paletas ou outros itens, se aplicável.</span><span class="sxs-lookup"><span data-stu-id="c39b8-203">You should use this method to serialize the Preview image data into the stream, and any global thumbnails, metadata, palette, or other items, if applicable.</span></span> <span data-ttu-id="c39b8-204">Esse método não deve fechar o fluxo de arquivos, pois o aplicativo que abriu o fluxo é esperado fechá-lo.</span><span class="sxs-lookup"><span data-stu-id="c39b8-204">This method should not close the file stream, because the application that opened the stream is expected to close it.</span></span>

<span data-ttu-id="c39b8-205">A seção sobre o método IWICBitmapFrameEncode: Commit tem detalhes sobre como o IWICBitmapEncoderCacheOptions afeta o comportamento desse método.</span><span class="sxs-lookup"><span data-stu-id="c39b8-205">The section on the IWICBitmapFrameEncode:Commit method has details on how the IWICBitmapEncoderCacheOptions affect the behavior of this method.</span></span>

### <a name="setpreview"></a><span data-ttu-id="c39b8-206">SetPreview</span><span class="sxs-lookup"><span data-stu-id="c39b8-206">SetPreview</span></span>

<span data-ttu-id="c39b8-207">[**SetPreview**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-setpreview) é usado para criar uma visualização da imagem.</span><span class="sxs-lookup"><span data-stu-id="c39b8-207">[**SetPreview**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-setpreview) is used to create a preview of the image.</span></span> <span data-ttu-id="c39b8-208">Embora não seja estritamente necessário que todas as imagens tenham uma visualização, é altamente recomendável.</span><span class="sxs-lookup"><span data-stu-id="c39b8-208">While it is not strictly required that every image have a preview, it is highly recommended.</span></span> <span data-ttu-id="c39b8-209">Câmeras digitais e scanners modernos geram imagens de alta resolução, que tendem a ser muito grandes e, consequentemente, levam um tempo de processamento significativo para decodificação.</span><span class="sxs-lookup"><span data-stu-id="c39b8-209">Modern digital cameras and scanners generate very high resolution images, which tend to be very large and, consequently, take significant processing time to decode.</span></span> <span data-ttu-id="c39b8-210">As imagens da próxima geração de câmeras serão ainda maiores.</span><span class="sxs-lookup"><span data-stu-id="c39b8-210">Images from the next generation of cameras will be even larger.</span></span> <span data-ttu-id="c39b8-211">É uma boa ideia fornecer uma versão menor, de menor resolução, de uma imagem, normalmente no formato JPEG, que possa ser rapidamente decodificada e exibida "instantaneamente" quando um usuário solicitar.</span><span class="sxs-lookup"><span data-stu-id="c39b8-211">It’s a good idea to provide a smaller, lower resolution version of an image, typically in JPEG format, that can be quickly decoded and displayed “instantly” when a user requests it.</span></span> <span data-ttu-id="c39b8-212">Um aplicativo pode solicitar uma visualização antes de solicitar que a imagem real seja decodificada para fornecer uma experiência melhor para os usuários e mostrá-los uma representação de tamanho de tela da imagem enquanto theyare aguardando a decodificação da imagem real.</span><span class="sxs-lookup"><span data-stu-id="c39b8-212">An application may request a preview before requesting the actual image to be decoded to provide a better experience for users, and show them a screen-size representation of the image while theyare waiting to decode the actual image.</span></span> <span data-ttu-id="c39b8-213">Embora os codecs devam fornecer visualizações, os codecs que não dão suporte a [**IWICBitmapSourceTransform**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapsourcetransform) devem definitivamente fazer isso.</span><span class="sxs-lookup"><span data-stu-id="c39b8-213">Although codecs should provide previews, codecs that do not support [**IWICBitmapSourceTransform**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapsourcetransform) should definitely do so.</span></span>

<span data-ttu-id="c39b8-214">Se você fornecer uma visualização JPEG, não precisará escrever um codificador de JPEG para codificá-lo.</span><span class="sxs-lookup"><span data-stu-id="c39b8-214">If you provide a JPEG preview, you don’t have to write a JPEG encoder to encode it.</span></span> <span data-ttu-id="c39b8-215">Você deve delegar para o codificador JPEG que acompanha a plataforma WIC para codificação de visualizações e miniaturas.</span><span class="sxs-lookup"><span data-stu-id="c39b8-215">You should delegate to the JPEG encoder that ships with the WIC platform for encoding both previews and thumbnails.</span></span>

## <a name="related-topics"></a><span data-ttu-id="c39b8-216">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="c39b8-216">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="c39b8-217">**Referência**</span><span class="sxs-lookup"><span data-stu-id="c39b8-217">**Reference**</span></span>
</dt> <dt>

[<span data-ttu-id="c39b8-218">**IWICBitmapEncoder**</span><span class="sxs-lookup"><span data-stu-id="c39b8-218">**IWICBitmapEncoder**</span></span>](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)
</dt> <dt>

[<span data-ttu-id="c39b8-219">**IWICBitmapFrameEncode**</span><span class="sxs-lookup"><span data-stu-id="c39b8-219">**IWICBitmapFrameEncode**</span></span>](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)
</dt> <dt>

<span data-ttu-id="c39b8-220">**Conceitua**</span><span class="sxs-lookup"><span data-stu-id="c39b8-220">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="c39b8-221">Interfaces do codificador</span><span class="sxs-lookup"><span data-stu-id="c39b8-221">Encoder Interfaces</span></span>](-wic-encoderinterfaces.md)
</dt> <dt>

[<span data-ttu-id="c39b8-222">Implementando IWICBitmapCodecProgressNotification (codificador)</span><span class="sxs-lookup"><span data-stu-id="c39b8-222">Implementing IWICBitmapCodecProgressNotification (Encoder)</span></span>](-wic-imp-iwicbitmapcodecprogressnotification-encoder.md)
</dt> <dt>

[<span data-ttu-id="c39b8-223">Como escrever um CODEC de WIC-Enabled</span><span class="sxs-lookup"><span data-stu-id="c39b8-223">How to Write a WIC-Enabled CODEC</span></span>](-wic-howtowriteacodec.md)
</dt> <dt>

[<span data-ttu-id="c39b8-224">Visão geral do Windows Imaging Component</span><span class="sxs-lookup"><span data-stu-id="c39b8-224">Windows Imaging Component Overview</span></span>](-wic-about-windows-imaging-codec.md)
</dt> </dl>

 

 
