---
description: Diretrizes de implementação para a serialização de configurações de IWICDevelopRaw
ms.assetid: 4ecff5cc-24f3-4b89-b681-85c867b053e7
title: Diretrizes de implementação para a serialização de configurações de IWICDevelopRaw
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 48cdc78f68e6d63ee7870b9296ae4cfa4f85547a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103662753"
---
# <a name="implementation-guidelines-for-serializing-iwicdevelopraw-settings"></a><span data-ttu-id="ae426-103">Diretrizes de implementação para a serialização de configurações de IWICDevelopRaw</span><span class="sxs-lookup"><span data-stu-id="ae426-103">Implementation Guidelines for Serializing IWICDevelopRaw Settings</span></span>

<span data-ttu-id="ae426-104">A interface [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) expõe as configurações que o aplicativo pode usar para modificar o processamento da imagem bruta.</span><span class="sxs-lookup"><span data-stu-id="ae426-104">The [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) interface exposes settings that the application can use to modify the processing of the RAW image.</span></span> <span data-ttu-id="ae426-105">As configurações devem poder ser serializadas para que persistam entre as sessões.</span><span class="sxs-lookup"><span data-stu-id="ae426-105">The settings should be able to be serialized so that they persist across sessions.</span></span> <span data-ttu-id="ae426-106">Embora isso possa ser feito de várias maneiras, é recomendável codificar esses dados de uma maneira que seja consistente com outros metadados.</span><span class="sxs-lookup"><span data-stu-id="ae426-106">Although this can be done in several ways, it is recommended to encode this data in a manner that is consistent with other metadata.</span></span>

<span data-ttu-id="ae426-107">A seguir estão algumas diretrizes gerais de implementação:</span><span class="sxs-lookup"><span data-stu-id="ae426-107">The following are some general implementation guidelines:</span></span>

-   <span data-ttu-id="ae426-108">As configurações feitas por meio de [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) (como rotação ou balanço de branco) devem evitar a substituição da configuração da câmera ou dos dados "como capturados", a menos que a marca seja normalmente usada como "configuração atual".</span><span class="sxs-lookup"><span data-stu-id="ae426-108">Any settings made via [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) (such as rotation or white balance) should avoid overwriting camera setting or "as-shot" data unless the tag is commonly used as a "current setting."</span></span> <span data-ttu-id="ae426-109">Por exemplo, as marcas de orientação de EXIF podem ser usadas para persistir a rotação.</span><span class="sxs-lookup"><span data-stu-id="ae426-109">For example, EXIF orientation tags can be used to persist rotation.</span></span>
-   <span data-ttu-id="ae426-110">É preferível não precisar salvar todo o arquivo (incluindo os dados de pixel do mosaico) toda vez que as configurações de [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) são solicitadas para serem serializadas.</span><span class="sxs-lookup"><span data-stu-id="ae426-110">It is preferable not to have to save the entire file (including the mosaic pixel data) each time that the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) settings are asked to be serialized.</span></span>
-   <span data-ttu-id="ae426-111">O processo de serialização de configurações de [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) geralmente seguirá essa ordem de eventos.</span><span class="sxs-lookup"><span data-stu-id="ae426-111">The process of serializing [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) settings will generally follow this order of events.</span></span> <span data-ttu-id="ae426-112">O aplicativo:</span><span class="sxs-lookup"><span data-stu-id="ae426-112">The application:</span></span>

    1.  <span data-ttu-id="ae426-113">Cria uma instância de [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder) em um arquivo bruto.</span><span class="sxs-lookup"><span data-stu-id="ae426-113">Instantiates an [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder) on a RAW file.</span></span>
    2.  <span data-ttu-id="ae426-114">Chama [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder)::[**GetFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-getframe) para obter um [**IWICBitmapFrameDecode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframedecode) para o quadro bruto.</span><span class="sxs-lookup"><span data-stu-id="ae426-114">Calls [**IWICBitmapDecoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapdecoder)::[**GetFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapdecoder-getframe) to get an [**IWICBitmapFrameDecode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframedecode) for the RAW frame.</span></span>
    3.  <span data-ttu-id="ae426-115">Chama QueryInterface na interface IWICBitmapFrameDecode para a interface IWICDevelopRaw.</span><span class="sxs-lookup"><span data-stu-id="ae426-115">Calls QueryInterface on the IWICBitmapFrameDecode interface for the IWICDevelopRaw interface.</span></span>
    4.  <span data-ttu-id="ae426-116">Chama [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**GetCurrentParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-getcurrentparameterset), que retorna uma interface IPropertyBag2 com todas as propriedades atuais armazenadas nela.</span><span class="sxs-lookup"><span data-stu-id="ae426-116">Calls [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**GetCurrentParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-getcurrentparameterset), which returns an IPropertyBag2 interface with all of the current properties stored in it.</span></span>

        <span data-ttu-id="ae426-117">Nesse ponto do processo, o objetivo é serializar as configurações na interface IPropertyBag2 para o arquivo bruto.</span><span class="sxs-lookup"><span data-stu-id="ae426-117">At this point of the process, the goal is to serialize the settings in the IPropertyBag2 interface into the RAW file.</span></span> <span data-ttu-id="ae426-118">Para isso, é necessário girar um codificador e assim por diante, que é detalhado nas etapas a seguir.</span><span class="sxs-lookup"><span data-stu-id="ae426-118">To do so requires spinning up an encoder and so on, which is detailed in the following steps.</span></span>

    5.  <span data-ttu-id="ae426-119">Cria um [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) para o arquivo bruto.</span><span class="sxs-lookup"><span data-stu-id="ae426-119">Creates an [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder) for the RAW file.</span></span>
    6.  <span data-ttu-id="ae426-120">Chama [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize), passando um novo fluxo (em branco) para codificar.</span><span class="sxs-lookup"><span data-stu-id="ae426-120">Calls [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize), passing in a new (blank) stream to encode.</span></span>
    7.  <span data-ttu-id="ae426-121">Chama [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**CreateNewFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-createnewframe) para criar um novo IWICBITMAPFRAMEENCODE para o quadro bruto.</span><span class="sxs-lookup"><span data-stu-id="ae426-121">Calls [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**CreateNewFrame**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-createnewframe) to create a new IWICBitmapFrameEncode for the RAW frame.</span></span>
    8.  <span data-ttu-id="ae426-122">Chama [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize)e passa na interface IPropertyBag2 da etapa 4.</span><span class="sxs-lookup"><span data-stu-id="ae426-122">Calls [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**Initialize**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-initialize), and passes in the IPropertyBag2 interface from step 4.</span></span>
    9.  <span data-ttu-id="ae426-123">Chama [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**WriteName**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapframeencode-writesource) com [**IWICBITMAPSOURCE**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapsource) do quadro da imagem bruta do decodificador.</span><span class="sxs-lookup"><span data-stu-id="ae426-123">Calls [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**WriteSource**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapframeencode-writesource) with [**IWICBitmapSource**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapsource) from decoder's RAW image frame.</span></span>
    10. <span data-ttu-id="ae426-124">Chama [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span><span class="sxs-lookup"><span data-stu-id="ae426-124">Calls [**IWICBitmapFrameEncode**](/windows/desktop/api/Wincodec/nn-wincodec-iwicbitmapframeencode)::[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span></span> <span data-ttu-id="ae426-125">Em seguida, o codec serializa as propriedades no IPropertyBag2 da etapa 8 para o arquivo.</span><span class="sxs-lookup"><span data-stu-id="ae426-125">The codec then serializes the properties in the IPropertyBag2 from step 8 into the file.</span></span> <span data-ttu-id="ae426-126">Presume-se que o método mais comum de serialização das propriedades esteja gravando-as como metadados no arquivo.</span><span class="sxs-lookup"><span data-stu-id="ae426-126">The most common method of serializing the properties is assumed to be by writing them out as metadata in the file.</span></span>
    11. <span data-ttu-id="ae426-127">Chama [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span><span class="sxs-lookup"><span data-stu-id="ae426-127">Calls [**IWICBitmapEncoder**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapencoder)::[**Commit**](/windows/desktop/api/Wincodec/nf-wincodec-iwicbitmapencoder-commit).</span></span>
    12. <span data-ttu-id="ae426-128">Chama IStream:: Commit no fluxo na etapa 6.</span><span class="sxs-lookup"><span data-stu-id="ae426-128">Calls IStream::Commit on the stream in step 6.</span></span>

    <span data-ttu-id="ae426-129">As configurações são serializadas no arquivo.</span><span class="sxs-lookup"><span data-stu-id="ae426-129">The settings are serialized in the file.</span></span>

    <span data-ttu-id="ae426-130">Esse método incorre no custo de regravação de todo o arquivo bruto sempre que as configurações são serializadas.</span><span class="sxs-lookup"><span data-stu-id="ae426-130">This method does incur the cost of rewriting the entire RAW file each time the settings are serialized.</span></span> <span data-ttu-id="ae426-131">Isso pode ser evitado se você implementar [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) ou se o formato de arquivo de imagem der suporte a XMP ou EXIF, pois o WIC fornece [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) para ambos os formatos.</span><span class="sxs-lookup"><span data-stu-id="ae426-131">This can be avoided if you implement [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) or if your image file format supports XMP or EXIF, as WIC provides [**IWICFastMetadataEncoder**](/windows/desktop/api/Wincodec/nn-wincodec-iwicfastmetadataencoder) for both of these formats.</span></span> <span data-ttu-id="ae426-132">Além disso, se o codec gravar alterações no final do arquivo de imagem, você não acabará regravando todo o arquivo de imagem.</span><span class="sxs-lookup"><span data-stu-id="ae426-132">Also, if your codec writes changes to the end of the image file, then you won't end up rewriting the entire image file.</span></span>

-   <span data-ttu-id="ae426-133">Os conjuntos de parâmetros são carregados a partir do estado serializado quando o aplicativo define a enumeração [**WICRawParameterSet. WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) no método [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**parameterset**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-loadparameterset) .</span><span class="sxs-lookup"><span data-stu-id="ae426-133">Parameter sets are loaded from the serialized state when the application sets the [**WICRawParameterSet.WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) enumeration on the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw)::[**LoadParameterSet**](/windows/desktop/api/Wincodec/nf-wincodec-iwicdevelopraw-loadparameterset) method.</span></span> <span data-ttu-id="ae426-134">O sinalizador [**WICRawParameterSet. WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) refere-se ao último conjunto de parâmetros salvo, portanto, uma carga com esse sinalizador deve resultar na restauração de parâmetros para o último estado salvo.</span><span class="sxs-lookup"><span data-stu-id="ae426-134">The [**WICRawParameterSet.WICUserAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) flag refers to the last-saved parameter set, so a load with this flag should result in restoring parameters to the last-saved state.</span></span>
-   <span data-ttu-id="ae426-135">Após o carregamento inicial, o último conjunto de parâmetros salvo deve ser carregado, se disponível.</span><span class="sxs-lookup"><span data-stu-id="ae426-135">Upon initial load, the last-saved parameter set should be loaded, if available.</span></span> <span data-ttu-id="ae426-136">Caso contrário, as configurações "as-shot" devem ser usadas como predefinições nas variáveis de interface [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) .</span><span class="sxs-lookup"><span data-stu-id="ae426-136">If not, then the "as-shot" settings should be used as presets on the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) interface variables.</span></span> <span data-ttu-id="ae426-137">Essas configurações como capturadas também podem ser carregadas usando o sinalizador [**WICRawParameterSet. WICAsShotParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) .</span><span class="sxs-lookup"><span data-stu-id="ae426-137">These as-shot settings can also be loaded by using the [**WICRawParameterSet.WICAsShotParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) flag.</span></span>
-   <span data-ttu-id="ae426-138">O identificador [**WICRawParameterSet. WICAutoAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) destina-se a representar uma configuração "automática".</span><span class="sxs-lookup"><span data-stu-id="ae426-138">The identifier [**WICRawParameterSet.WICAutoAdjustedParameterSet**](/windows/desktop/api/Wincodec/ne-wincodec-wicrawparameterset) is meant to represent an "Auto" setting.</span></span> <span data-ttu-id="ae426-139">O designer de codec pode eleger qualquer uma das seguintes abordagens sobre como definir parâmetros [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) quando essa configuração é feita:</span><span class="sxs-lookup"><span data-stu-id="ae426-139">The codec designer can elect any of the following approaches on how to set [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) parameters when this setting is made:</span></span>

    -   <span data-ttu-id="ae426-140">Execute uma otimização de algoritmos de alguns parâmetros, como exposição ou cor.</span><span class="sxs-lookup"><span data-stu-id="ae426-140">Perform an algorithmic optimization of some parameters, such as exposure or color.</span></span> <span data-ttu-id="ae426-141">É assim que as funções automáticas nos editores de imagem típicos e baseiam-se principalmente na análise de dados de pixel.</span><span class="sxs-lookup"><span data-stu-id="ae426-141">This is how Auto functions in typical image editors and is based primarily on pixel data analysis.</span></span>
    -   <span data-ttu-id="ae426-142">Defina configurações de câmera semelhantes a como uma configuração automática teria se compareceda.</span><span class="sxs-lookup"><span data-stu-id="ae426-142">Set camera settings similar to how an Auto setting would have behaved.</span></span> <span data-ttu-id="ae426-143">Isso é útil se a imagem foi capturada em uma configuração manual e permite que o usuário substitua as configurações manuais.</span><span class="sxs-lookup"><span data-stu-id="ae426-143">This is useful if the image was shot on a Manual setting and allows the user to override manual settings.</span></span>
    -   <span data-ttu-id="ae426-144">Não fazer nada.</span><span class="sxs-lookup"><span data-stu-id="ae426-144">Do nothing.</span></span> <span data-ttu-id="ae426-145">Nem todos os controles precisam ser definidos quando auto é selecionado e OK para deixar as configurações inalteradas.</span><span class="sxs-lookup"><span data-stu-id="ae426-145">Not all controls need to be set when Auto is selected, and it is OK to leave settings unchanged.</span></span>

<span data-ttu-id="ae426-146">A Galeria de fotos do Windows Vista e as ferramentas de edição da Galeria de fotos do Windows Live e outros aplicativos de edição usam o carregamento de parâmetro automático [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) quando o usuário seleciona a correção automática para todos os ajustes de controle de codec normais, como cor e exposição, para obter os melhores resultados.</span><span class="sxs-lookup"><span data-stu-id="ae426-146">The Windows Vista Photo Gallery and Windows Live Photo Gallery editing tools and other editing applications use the [**IWICDevelopRaw**](/windows/desktop/api/Wincodec/nn-wincodec-iwicdevelopraw) Auto parameter load when the user selects Auto Correct for all normal codec control adjustments such as color and exposure to get the best results.</span></span>

## <a name="related-topics"></a><span data-ttu-id="ae426-147">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="ae426-147">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="ae426-148">**Conceitua**</span><span class="sxs-lookup"><span data-stu-id="ae426-148">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="ae426-149">Visão geral do Windows Imaging Component</span><span class="sxs-lookup"><span data-stu-id="ae426-149">Windows Imaging Component Overview</span></span>](-wic-about-windows-imaging-codec.md)
</dt> <dt>

[<span data-ttu-id="ae426-150">Diretrizes do WIC para formatos de imagem bruta de câmera</span><span class="sxs-lookup"><span data-stu-id="ae426-150">WIC Guidelines for Camera RAW Image Formats</span></span>](-wic-rawguidelines.md)
</dt> <dt>

[<span data-ttu-id="ae426-151">Como escrever um CODEC de WIC-Enabled</span><span class="sxs-lookup"><span data-stu-id="ae426-151">How to Write a WIC-Enabled CODEC</span></span>](-wic-howtowriteacodec.md)
</dt> </dl>

 

 



