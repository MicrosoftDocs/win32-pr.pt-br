---
description: O painel de entrada do Microsoft Tablet PC é uma ferramenta poderosa para inserir texto manuscrito com uma caneta e corrigir o texto sem o uso de um teclado.
ms.assetid: c45ac1b5-7713-4bcb-a130-4692cff99aa2
title: Habilitando a correção de texto para coletores de tinta personalizados
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb4dee4c7dfee1489cd002848c496be41f73d953
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104553946"
---
# <a name="enabling-text-correction-for-custom-ink-collectors"></a><span data-ttu-id="4a135-103">Habilitando a correção de texto para coletores de tinta personalizados</span><span class="sxs-lookup"><span data-stu-id="4a135-103">Enabling Text Correction for Custom Ink Collectors</span></span>

<span data-ttu-id="4a135-104">O painel de entrada do Microsoft Tablet PC é uma ferramenta poderosa para inserir texto manuscrito com uma caneta e corrigir o texto sem o uso de um teclado.</span><span class="sxs-lookup"><span data-stu-id="4a135-104">Microsoft Tablet PC Input Panel is a powerful tool for entering handwritten text with a pen and correcting text without the use of a keyboard.</span></span> <span data-ttu-id="4a135-105">Ao usar o painel de entrada, um usuário insere o texto manuscrito nas superfícies de tinta do painel de entrada, o que faz com que o painel de entrada reconheça o manuscrito do usuário como texto.</span><span class="sxs-lookup"><span data-stu-id="4a135-105">When using Input Panel, a user enters text by handwriting onto Input Panel's inking surfaces, which causes Input Panel to recognize the user's handwriting as text.</span></span> <span data-ttu-id="4a135-106">Depois que o texto for reconhecido, o usuário toca em inserir no painel de entrada para inserir o texto em um aplicativo ou documento.</span><span class="sxs-lookup"><span data-stu-id="4a135-106">Once the text has been recognized, the user taps Insert on Input Panel to insert the text into an application or document.</span></span> <span data-ttu-id="4a135-107">Antes de inserir o texto, um usuário tem acesso a um conjunto de ferramentas de correção no painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="4a135-107">Prior to inserting the text, a user has access to a set of correction tools in Input Panel.</span></span> <span data-ttu-id="4a135-108">Isso inclui a seleção de um resultado de reconhecimento alternativo, a capacidade de reescrever um único caractere ou até mesmo para riscar toda a palavra e reescrever.</span><span class="sxs-lookup"><span data-stu-id="4a135-108">These include the selection of an alternative recognition result, the ability to rewrite a single character, or even to scratch-out the entire word and rewrite.</span></span> <span data-ttu-id="4a135-109">Essas ferramentas de correção permitem que um usuário corrija erros de reconhecimento e erros humanos.</span><span class="sxs-lookup"><span data-stu-id="4a135-109">These correction tools enable a user to correct both recognition errors and human errors.</span></span>

<span data-ttu-id="4a135-110">Depois que o texto inserido usando o painel de entrada estiver no documento, os usuários terão acesso à mesma funcionalidade de correção que está disponível antes da inserção nos aplicativos baseados em [estrutura de serviços de texto](/windows/desktop/TSF/text-services-framework)do Windows e habilitados para serviços de texto.</span><span class="sxs-lookup"><span data-stu-id="4a135-110">Once the text entered using Input Panel is in the document, users have access to the same correction functionality that is available prior to insertion in Windows [Text Services Framework](/windows/desktop/TSF/text-services-framework)-based and Text Services-enabled applications.</span></span> <span data-ttu-id="4a135-111">A partir do Microsoft Windows XP Service Pack 2 Tablet PC Edition, todos os aplicativos de edição avançados são habilitados para serviços de texto por padrão e, a partir do Windows Vista, os aplicativos HTML são habilitados para serviços de texto por padrão.</span><span class="sxs-lookup"><span data-stu-id="4a135-111">Starting in Microsoft Windows XP Service Pack 2 Tablet PC Edition all Rich Edit applications are Text Services-enabled by default, and starting in Windows Vista, HTML applications are Text Services-enabled by default.</span></span> <span data-ttu-id="4a135-112">A correção no documento só está disponível em aplicativos baseados em serviço de texto e habilitados; Isso ocorre porque o painel de entrada depende da capacidade do serviço de texto de armazenar propriedades de texto associadas, incluindo objetos de tinta e alternativas de reconhecimento, a fim de fornecer a correção no documento.</span><span class="sxs-lookup"><span data-stu-id="4a135-112">In-document correction is only available in Text Service based and enabled applications; this is because Input Panel is dependent on Text Service's capability to store associated text properties, including ink objects and recognition alternates, in order to provide in-document correction.</span></span>

![painel de entrada do Tablet PC com correção de texto](images/a0dced5e-16de-410b-965f-5d97d297cee5.jpg)

<span data-ttu-id="4a135-114">No entanto, há inúmeros cenários, incluindo correção de reconhecimento de fala ou correção de texto digitado no Go, que não começam com entrada de texto usando o painel de entrada, mas em que a correção no documento pode ser extremamente útil para os usuários do Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="4a135-114">There are, however, numerous scenarios, including correcting speech recognition or correcting typed text on the go, that do not start with text entry using Input Panel but in which in-document correction can be extremely useful for Tablet PC users.</span></span> <span data-ttu-id="4a135-115">Um exemplo primo é em aplicativos que fornecem superfícies de tinta personalizadas para inserir texto usando uma caneta.</span><span class="sxs-lookup"><span data-stu-id="4a135-115">A prime example is in applications that provide custom inking surfaces for entering text using a pen.</span></span> <span data-ttu-id="4a135-116">As superfícies de tinta personalizada são uma ótima maneira de os aplicativos fornecerem funcionalidades exclusivamente personalizadas específicas às tarefas de entrada de texto de cada aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4a135-116">Custom inking surfaces are a great way for applications to provide uniquely tailored functionality specific to the text entry tasks of each application.</span></span> <span data-ttu-id="4a135-117">Além disso, as superfícies de tinta personalizada fornecem uma experiência de usuário do Tablet PC totalmente integrada, o que torna claro que a caneta é um dispositivo de entrada de primeira classe em aplicativos que as contêm.</span><span class="sxs-lookup"><span data-stu-id="4a135-117">Additionally, custom inking surfaces provide a fully integrated Tablet PC user experience, which makes it clear the pen is a first class input device in applications that contain them.</span></span> <span data-ttu-id="4a135-118">No entanto, os aplicativos que fornecem superfícies de tinta personalizada podem não permitir ou não podem fornecer o mesmo nível de suporte de correção que está disponível na correção no documento do painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="4a135-118">However, applications that provide custom inking surfaces may not allow or may not be able to provide the same level of correction support that is available from Input Panel in-document correction.</span></span>

![coletor de tinta personalizado](images/b6797b12-dda6-44c4-87f4-570fe0c23f3a.jpg)

<span data-ttu-id="4a135-120">Aplicativos com base em serviços de texto ou habilitados em que a correção no documento é útil para a correção de texto não inserido usando o painel de entrada é capaz de usar a API [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) do painel de entrada (classe [Microsoft. TextInput. HandwrittenTextInsertion](/previous-versions/ms573516(v=vs.100)) no código gerenciado) para habilitar a correção no documento para o texto inserido por outros meios.</span><span class="sxs-lookup"><span data-stu-id="4a135-120">Text Services based or enabled applications in which in-document correction is useful for correction of text not entered using Input Panel are able to use Input Panel's [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API ([Microsoft.TextInput.HandwrittenTextInsertion](/previous-versions/ms573516(v=vs.100)) class in managed code)to enable in-document correction for text entered by other means.</span></span> <span data-ttu-id="4a135-121">Dessa forma, os aplicativos podem adicionar um suporte avançado à correção para suas superfícies de tinta personalizada ou outros cenários de entrada de texto e arredondar sua história de entrada de texto do Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="4a135-121">In this way, applications can cheaply add powerful correction support to their custom inking surfaces or other text entry scenarios, and round out their Tablet PC text entry story.</span></span> <span data-ttu-id="4a135-122">A API do painel de entrada IHandWrittenTextInsertion é incluída como parte do sistema operacional Windows Vista e como parte do SDK da plataforma Tablet versão 1,9 ou mais recente.</span><span class="sxs-lookup"><span data-stu-id="4a135-122">The Input Panel IHandWrittenTextInsertion API is included as part of the Windows Vista operating system and as part of the Tablet Platform SDK version 1.9 or newer.</span></span> <span data-ttu-id="4a135-123">Uma versão baseada em .NET e COM com base na API está incluída.</span><span class="sxs-lookup"><span data-stu-id="4a135-123">Both a .NET and COM based version of the API are included.</span></span> <span data-ttu-id="4a135-124">Habilitar a correção no documento para texto não inserido usando o painel de entrada tem suporte no Windows Vista e mais recente.</span><span class="sxs-lookup"><span data-stu-id="4a135-124">Enabling in-document correction for text not entered using Input Panel is supported on Windows Vista and newer.</span></span> <span data-ttu-id="4a135-125">A correção no documento só está disponível para idiomas latinos e não pode exibir nenhum caractere fora do conjunto de caracteres latinos.</span><span class="sxs-lookup"><span data-stu-id="4a135-125">In-document correction is only available for Latin languages and is unable to display any character outside the Latin character set.</span></span>

## <a name="how-to-use-the-handwrittentextinsertion-api-in-an-application"></a><span data-ttu-id="4a135-126">Como usar a API HandwrittenTextInsertion em um aplicativo</span><span class="sxs-lookup"><span data-stu-id="4a135-126">How to Use the HandwrittenTextInsertion API in an Application</span></span>

<span data-ttu-id="4a135-127">As alterações necessárias para um aplicativo a fim de integrar a correção no documento no painel de entrada para o texto não inserido usando o painel de entrada e o uso da API [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) são simples.</span><span class="sxs-lookup"><span data-stu-id="4a135-127">The required changes to an application in order to integrate Input Panel in-document correction for text not entered using Input Panel and using the [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API are straightforward.</span></span> <span data-ttu-id="4a135-128">Todo o código de entrada de texto personalizado do aplicativo permanece inalterado, exceto para a última etapa.</span><span class="sxs-lookup"><span data-stu-id="4a135-128">All of the application's custom text entry code remains unchanged except for the last step.</span></span> <span data-ttu-id="4a135-129">No ponto em que o texto inserido usando uma superfície de tinta personalizada, o reconhecimento de fala ou outros meios deve ser exibido em um campo de texto habilitado para serviços de texto, o aplicativo envia o texto para a interface **IHandWrittenTextInsertion** em vez de enviá-lo diretamente para o campo de texto.</span><span class="sxs-lookup"><span data-stu-id="4a135-129">At the point at which text entered using a custom inking surface, speech recognition, or other means is to be displayed in a text services enabled text field, the application sends the text to the **IHandWrittenTextInsertion** interface instead of sending it directly to the text field.</span></span> <span data-ttu-id="4a135-130">O componente de programação do painel de entrada, em seguida, manipula a inserção do texto no campo de texto e no armazenamento de backup de serviços de texto.</span><span class="sxs-lookup"><span data-stu-id="4a135-130">The Input Panel programmability component then handles inserting the text into both the text field and the Text Services backing-store.</span></span> <span data-ttu-id="4a135-131">Ao adicionar o texto ao armazenamento de backup de serviços de texto, o componente de programação do painel de entrada lida com a definição das propriedades de texto exigidas pelo painel de entrada para que a correção no documento seja habilitada para esse texto.</span><span class="sxs-lookup"><span data-stu-id="4a135-131">When adding the text to the Text Services backing-store, the Input Panel programmability component handles setting the text properties that are required by Input Panel for in-document correction to be enabled for that text.</span></span>

<span data-ttu-id="4a135-132">A seção a seguir percorre esse processo em detalhes para um aplicativo C++ usando a versão COM da API do [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) .</span><span class="sxs-lookup"><span data-stu-id="4a135-132">The following section walks through this process in detail for a C++ application using the COM version of the [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) API.</span></span> <span data-ttu-id="4a135-133">Há observações em qualquer lugar em que as etapas para usar a versão .NET Framework da API em C \# sejam diferentes para o uso da versão com em C++.</span><span class="sxs-lookup"><span data-stu-id="4a135-133">There are notes anywhere the steps for using the .NET Framework version of the API in C\# differ for the using COM version in C++.</span></span> <span data-ttu-id="4a135-134">A API **HandwrittenTextInsertion** gerenciada inclui uma única interface com, **IHandwrittenTextInsertion**.</span><span class="sxs-lookup"><span data-stu-id="4a135-134">The managed **HandwrittenTextInsertion** API includes a single COM interface, **IHandwrittenTextInsertion**.</span></span> <span data-ttu-id="4a135-135">A definição dessa interface está localizada em PenInputPanel. h e PenInputPanel \_ i.c.</span><span class="sxs-lookup"><span data-stu-id="4a135-135">The definition for this interface is located in PenInputPanel.h and PenInputPanel\_i.c.</span></span>

<span data-ttu-id="4a135-136">Primeiro, o aplicativo deve usar a função [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) para produzir uma instância de [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) com a ID de classe **CLSID \_ HandwrittenTextInsertion**.</span><span class="sxs-lookup"><span data-stu-id="4a135-136">First, the application should use the [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) function to produce an instance of [**IHandWrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion) with class id **CLSID\_HandwrittenTextInsertion**.</span></span> <span data-ttu-id="4a135-137">Observe que a criação de um objeto **CLSID \_ HandwrittenTextInsertion** terá sucesso somente depois que uma janela for criada e receber o foco, porque até então o armazenamento de backup dos serviços de texto não está ativado.</span><span class="sxs-lookup"><span data-stu-id="4a135-137">Note that the creation of a **CLSID\_HandwrittenTextInsertion** object will succeed only after a window is created and given focus, because until then the Text Services backing-store is not activated.</span></span> <span data-ttu-id="4a135-138">Além disso, se tiptsf.dll não estiver presente no sistema, a função **CoCreateInstance** falhará e retornará **REGDB \_ e \_ CLASSNOTREG**, indicando que não há suporte para a correção no documento do painel de entrada no sistema.</span><span class="sxs-lookup"><span data-stu-id="4a135-138">Additionally, if tiptsf.dll is not present on the system, the **CoCreateInstance** function fails and returns **REGDB\_E\_CLASSNOTREG**, indicating that Input Panel in-document correction is not supported on the system.</span></span> <span data-ttu-id="4a135-139">Neste ponto, o aplicativo deve continuar sem tentar habilitar a correção no documento do painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="4a135-139">At this point the application should proceed without trying to enable Input Panel in-document correction.</span></span> <span data-ttu-id="4a135-140">A instância de **HandwrittenTextInsertion** deve ser acessível a partir do código do aplicativo que manipula a inserção de texto em um campo de texto.</span><span class="sxs-lookup"><span data-stu-id="4a135-140">The instance of **HandwrittenTextInsertion** must be accessible from the application's code that handles inserting text into a text field.</span></span>

> [!Note]  
> <span data-ttu-id="4a135-141">Ao trabalhar com a versão .NET Framework da API, o aplicativo deve adicionar uma instrução using para permitir o acesso ao namespace [Microsoft. Ink. TextInput](/previous-versions/dotnet/netframework-3.5/ms581554(v=vs.90)) e, em seguida, criar o objeto diretamente.</span><span class="sxs-lookup"><span data-stu-id="4a135-141">When working with the .NET Framework version of the API, the application should add a using statement to allow access to the [Microsoft.Ink.TextInput](/previous-versions/dotnet/netframework-3.5/ms581554(v=vs.90)) namespace and then create the object directly.</span></span>

 

<span data-ttu-id="4a135-142">Em segundo lugar, o código do aplicativo que é responsável por inserir texto em um campo de texto deve ser alterado para que ele não insira mais texto em um campo de texto diretamente, mas chama um ou outro dos dois métodos de inserção de [**IHandwrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion).</span><span class="sxs-lookup"><span data-stu-id="4a135-142">Second, the application's code that is responsible for inserting text into a text field must be altered so that it no longer inserts text into a text field directly, but calls one or the other of [**IHandwrittenTextInsertion**](/windows/desktop/api/peninputpanel/nn-peninputpanel-ihandwrittentextinsertion)'s two insertion methods instead.</span></span> <span data-ttu-id="4a135-143">Se os aplicativos devem optar por chamar [**InsertRecognitionResultsArray**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertrecognitionresultsarray) ou [**InsertRecognitionResults**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertinkrecognitionresult) depende se o aplicativo tem as alternativas de reconhecimento para o texto armazenado como uma matriz ou como um objeto [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) .</span><span class="sxs-lookup"><span data-stu-id="4a135-143">Whether the applications should choose to call [**InsertRecognitionResultsArray**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertrecognitionresultsarray) or [**InsertRecognitionResults**](/windows/desktop/api/peninputpanel/nf-peninputpanel-ihandwrittentextinsertion-insertinkrecognitionresult) depends on whether the application has the recognition alternates for the text stored as an array or as an [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) object.</span></span>

> [!Note]  
> <span data-ttu-id="4a135-144">Ao trabalhar em código gerenciado, o objeto de reconhecimento correspondente consumido por InsertRecognitionResultsArray é [RecognitionResult](/previous-versions/ms552537(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="4a135-144">When working in managed code, the corresponding recognition object consumed by InsertRecognitionResultsArray is [RecognitionResult](/previous-versions/ms552537(v=vs.100)).</span></span> <span data-ttu-id="4a135-145">Ambos os métodos consomem os três parâmetros a seguir:</span><span class="sxs-lookup"><span data-stu-id="4a135-145">Both methods consume the following three parameters:</span></span>

 

-   <span data-ttu-id="4a135-146">*alternativas* É uma coleção bidimensional de cadeias de caracteres, armazenada como uma matriz de matrizes ou como um objeto [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) (ou [RecognitionResult](/previous-versions/ms552537(v=vs.100))).</span><span class="sxs-lookup"><span data-stu-id="4a135-146">*alternates* Is a two dimensional collection of strings, stored either as an array of arrays or as an [**IInkRecognitionResult**](/windows/desktop/api/msinkaut/nn-msinkaut-iinkrecognitionresult) (or [RecognitionResult](/previous-versions/ms552537(v=vs.100))) object.</span></span> <span data-ttu-id="4a135-147">Se as alternativas forem armazenadas como uma matriz de matrizes, elas deverão ser passadas como um ponteiro de matriz seguro.</span><span class="sxs-lookup"><span data-stu-id="4a135-147">If the alternates are stored as an array of arrays, then it should be passed as a safe array pointer.</span></span> <span data-ttu-id="4a135-148">Cada entrada na matriz de nível superior é uma lista de alternativas para uma única palavra na inserção.</span><span class="sxs-lookup"><span data-stu-id="4a135-148">Each entry in the top level array is a list of alternates for a single word in the insertion.</span></span> <span data-ttu-id="4a135-149">A entrada na posição zero nas submatrizes de alternativas é o texto inserido no campo de texto.</span><span class="sxs-lookup"><span data-stu-id="4a135-149">The entry at position zero in the sub-arrays of alternates is the text that is inserted into the text field.</span></span> <span data-ttu-id="4a135-150">As alternativas adicionais (índices de 1 a n em cada submatriz) são armazenadas no armazenamento de backup de serviços de texto e oferecidas ao usuário como opções como parte da correção no documento.</span><span class="sxs-lookup"><span data-stu-id="4a135-150">The additional alternates (indices 1 through n in each sub-array) are stored in the Text Services backing-store and offered to the user as choices as part of in-document correction.</span></span> <span data-ttu-id="4a135-151">Se as alternativas não forem incluídas, o usuário verá "nenhuma sugestão" no lugar da lista de alternativas.</span><span class="sxs-lookup"><span data-stu-id="4a135-151">If alternates are not included, then the user sees 'No suggestion' in place of the list of alternates.</span></span> <span data-ttu-id="4a135-152">Se uma inserção contiver várias palavras com espaços entre elas, cada espaço deverá ser incluído como uma entrada na matriz de nível superior.</span><span class="sxs-lookup"><span data-stu-id="4a135-152">If an insertion contains multiple words with spaces between them, then each space must be included as an entry in the top level array.</span></span>
-   <span data-ttu-id="4a135-153">*idioma* do O [LCID](/previous-versions/ms221397(v=vs.71)) do idioma de entrada que corresponde ao texto contido no parâmetro *alternativo* .</span><span class="sxs-lookup"><span data-stu-id="4a135-153">*language* The Input Language [LCID](/previous-versions/ms221397(v=vs.71)) that corresponds to the text contained in the *alternates* parameter.</span></span> <span data-ttu-id="4a135-154">No caso em que o conteúdo das *alternativas* foi gerado por um reconhecedor de manuscrito ou de fala, essa também é a propriedade [**Languages**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_languages) associada ao Recognizer usado.</span><span class="sxs-lookup"><span data-stu-id="4a135-154">In the case in which the contents of *alternates* was generated by a handwriting or speech recognizer, this is also the [**Languages**](/windows/desktop/api/msinkaut/nf-msinkaut-iinkrecognizer-get_languages) property associated with the recognizer used.</span></span>
-   <span data-ttu-id="4a135-155">*fLatticeContainsAutoSpacingInformation* Um sinalizador que indica se o texto contido no parâmetro *Alternate* foi gerado por um reconhecedor com espaçamento automático habilitado.</span><span class="sxs-lookup"><span data-stu-id="4a135-155">*fLatticeContainsAutoSpacingInformation* A flag indicating whether the text contained in the *alternates* parameter was generated by a recognizer with auto-spacing enabled.</span></span> <span data-ttu-id="4a135-156">Se o espaçamento automático tiver sido habilitado, o sinalizador deverá ser definido como **true**.</span><span class="sxs-lookup"><span data-stu-id="4a135-156">If auto-spacing was enabled, then the flag should be set to **TRUE**.</span></span> <span data-ttu-id="4a135-157">Se o espaçamento automático tiver sido desabilitado, o sinalizador deverá ser definido como **false**.</span><span class="sxs-lookup"><span data-stu-id="4a135-157">If auto-spacing was disabled, then the flag should be set to **FALSE**.</span></span> <span data-ttu-id="4a135-158">No caso em que o conteúdo das *alternativas* foi gerado por um reconhecedor que não oferece suporte ao espaçamento automático ou não foi gerado por um reconhecedor, o sinalizador deve ser definido como **false**.</span><span class="sxs-lookup"><span data-stu-id="4a135-158">In the case in which the contents of *alternates* was generated by a recognizer that does not support auto-spacing, or was not generated by a recognizer at all, then the flag should be set to **FALSE**.</span></span>

<span data-ttu-id="4a135-159">O modelo de programação do painel de entrada é capaz de inserir o texto no documento ou aplicativo da posição do cursor do sistema.</span><span class="sxs-lookup"><span data-stu-id="4a135-159">Input Panel's programmability model is able to insert the text in the document or application from the position of the system caret.</span></span>

<span data-ttu-id="4a135-160">Os dois métodos retornarão **S \_ OK** se a inserção for realizada com sucesso.</span><span class="sxs-lookup"><span data-stu-id="4a135-160">Both methods return **S\_OK** if the insertion succeeds.</span></span> <span data-ttu-id="4a135-161">Eles retornam **e \_ nointerface** se o aplicativo não for baseado em serviços de texto ou habilitados, e **e \_ INVALIDARG** se as *alternativas* estiverem formatadas incorretamente ou inacessíveis.</span><span class="sxs-lookup"><span data-stu-id="4a135-161">They return **E\_NOINTERFACE** if the application is not Text Services based or enabled, and **E\_INVALIDARG** if *alternates* is improperly formatted or inaccessible.</span></span> <span data-ttu-id="4a135-162">Eles também podem retornar **E \_ OUTOFMEMORY** se não houver memória suficiente disponível no sistema ou **E \_ falhar** após uma falha catastrófica, como a estrutura de serviços de texto não estar habilitada.</span><span class="sxs-lookup"><span data-stu-id="4a135-162">They may also return **E\_OUTOFMEMORY** if there is not enough memory available on the system, or **E\_FAIL** after a catastrophic failure such as the Text Services Framework not being enabled.</span></span>

### <a name="conclusion"></a><span data-ttu-id="4a135-163">Conclusão</span><span class="sxs-lookup"><span data-stu-id="4a135-163">Conclusion</span></span>

<span data-ttu-id="4a135-164">Habilitar a correção no documento no painel de entrada para texto não inserido usando o painel de entrada é uma maneira barata e fácil de um aplicativo baseado em serviços de texto ou habilitado para complementar um método de entrada ou de tinta personalizado com funcionalidade avançada de correção baseada em caneta.</span><span class="sxs-lookup"><span data-stu-id="4a135-164">Enabling Input Panel in-document correction for text not entered using Input Panel is a cheap and easy way for a Text Services based or enabled application to supplement a custom inking or input method with powerful pen-based correction functionality.</span></span> <span data-ttu-id="4a135-165">No Windows Vista, todos os aplicativos de edição avançada e Trident são habilitados para serviços de texto.</span><span class="sxs-lookup"><span data-stu-id="4a135-165">On Windows Vista, all Rich Edit and Trident applications are Text Services enabled.</span></span> <span data-ttu-id="4a135-166">Embora as superfícies de tinta integradas sejam uma ótima opção para adicionar uma experiência de usuário personalizada do Tablet PC a um aplicativo, elas só dão suporte à metade da entrada de texto se não incluírem recursos de correção.</span><span class="sxs-lookup"><span data-stu-id="4a135-166">While integrated inking surfaces are a great option for adding a custom Tablet PC user experience to an application, they only support half of text entry if they do not include correction capabilities.</span></span> <span data-ttu-id="4a135-167">A correção no documento fornece aos usuários a outra metade da história, adicionando a capacidade de trocar uma seleção por uma alternativa de reconhecimento ou de reescrever parte ou toda a seleção.</span><span class="sxs-lookup"><span data-stu-id="4a135-167">In-document correction provides users with the other half of the story by adding the ability to swap a selection for a recognition alternate, or to rewrite part or all of the selection.</span></span>

## <a name="related-topics"></a><span data-ttu-id="4a135-168">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="4a135-168">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4a135-169">Programando o painel de entrada de texto</span><span class="sxs-lookup"><span data-stu-id="4a135-169">Programming the Text Input Panel</span></span>](programming-the-text-input-panel.md)
</dt> </dl>

 

 
