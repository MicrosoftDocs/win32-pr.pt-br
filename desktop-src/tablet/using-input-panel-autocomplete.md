---
description: No Windows Vista, o painel de entrada do Tablet PC integra novos recursos de preenchimento automático que permitem que a lista de preenchimento automático de um aplicativo seja atualizada em tempo real à medida que a tinta de um usuário é reconhecida no painel de entrada.
ms.assetid: 0f01f546-f76b-4c61-a204-2a06079a374a
title: Usando o preenchimento automático do painel de entrada
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c9e7f108631eb2723b71bf8ed919c17a0eabff5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104090293"
---
# <a name="using-input-panel-autocomplete"></a><span data-ttu-id="b8dd1-103">Usando o preenchimento automático do painel de entrada</span><span class="sxs-lookup"><span data-stu-id="b8dd1-103">Using Input Panel AutoComplete</span></span>

<span data-ttu-id="b8dd1-104">No Windows Vista, o painel de entrada do Tablet PC integra novos recursos de preenchimento automático que permitem que a lista de preenchimento automático de um aplicativo seja atualizada em tempo real à medida que a tinta de um usuário é reconhecida no painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-104">In Windows Vista, Tablet PC Input Panel integrates new Autocomplete capabilities that enable an application's Autocomplete list to update in real time as a user's ink is recognized in Input Panel.</span></span> <span data-ttu-id="b8dd1-105">Além disso, a lista de preenchimento automático do aplicativo é posicionada em um local conveniente para usuários do painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-105">Additionally, the application's Autocomplete list is positioned in a convenient location for users of Input Panel.</span></span> <span data-ttu-id="b8dd1-106">Sem o preenchimento automático do painel de entrada, o uso de recursos de preenchimento automático com o painel de entrada é um processo difícil, exigindo que os usuários insiram um caractere por vez e movam o painel de entrada para acessar sugestões de preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-106">Without Input Panel Autocomplete, using Autocomplete features with Input Panel is a difficult process, requiring users to insert one character at a time and move Input Panel in order to access Autocomplete suggestions.</span></span> <span data-ttu-id="b8dd1-107">Com a integração, o preenchimento automático é uma ferramenta poderosa para usuários de Tablet PC que aceleram e aumentam a facilidade de inserir texto com o painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-107">With integration, Autocomplete is a powerful tool for Tablet PC users that speeds up and increases the ease of entering text with Input Panel.</span></span>

![painel de entrada com a lista de preenchimento automático do IE](images/9e769482-543a-4e29-b274-8f19ae10250d.jpg)

<span data-ttu-id="b8dd1-109">Há três opções de como um aplicativo pode tirar proveito da integração de preenchimento automático do painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-109">There are three options for how an application can take advantage of Input Panel Autocomplete integration.</span></span> <span data-ttu-id="b8dd1-110">Os aplicativos que contêm a funcionalidade Autocompleta criada usando o preenchimento automático do Shell (por meio da interface [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) ) ou .NET Framework preenchimento automático (por meio da enumeração [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) ) recebem a integração de preenchimento automático do painel de entrada sem a necessidade de alterações de código.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-110">Applications that contain Autocomplete functionality built using Shell Autocomplete (through the [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) interface) or .NET Framework Autocomplete (through the [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) Enumeration) receive Input Panel Autocomplete integration without the need for code changes.</span></span> <span data-ttu-id="b8dd1-111">Os aplicativos que incluem campos personalizados de texto de preenchimento automático podem usar a API de preenchimento automático do painel de entrada para obter a mesma funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-111">Applications that include custom Autocomplete text fields can use the Input Panel Autocomplete API to get the same functionality.</span></span>

<span data-ttu-id="b8dd1-112">Em todos os casos, você pode fazer essas modificações na lista de preenchimento automático do aplicativo sem duplicar ou modificar a interface do usuário ou a lógica de previsão usada por um aplicativo para gerar uma lista de preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-112">In all cases, you can make these modifications to the application's Autocomplete list without duplicating or modifying the UI or prediction logic used by an application to generate an Autocomplete list.</span></span> <span data-ttu-id="b8dd1-113">A lista de preenchimento automático continua sendo o proprietário desenhado pelo aplicativo e o conteúdo da lista de preenchimento automático é o mesmo que o texto foi digitado diretamente no campo de edição.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-113">The Autocomplete list continues to be owner drawn by the application and the contents of the Autocomplete list are the same as if the text were typed directly into the edit field.</span></span>

<span data-ttu-id="b8dd1-114">A integração de preenchimento automático do painel de entrada tem suporte no sistema operacional Windows Vista ou versões posteriores.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-114">Input Panel Autocomplete integration is supported on the Windows Vista operating system or later versions.</span></span> <span data-ttu-id="b8dd1-115">A integração de preenchimento automático do painel de entrada é incorporada ao preenchimento automático do Shell, começando com o Windows Vista e em Windows Forms desenvolvimento, começando com .NET Framework versão 3,0.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-115">Input Panel Autocomplete integration is built into Shell Autocomplete starting with Windows Vista and into Windows Forms development starting with .NET Framework version 3.0.</span></span> <span data-ttu-id="b8dd1-116">Embora o [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) e o [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) sejam executados em versões anteriores do Windows, a integração de preenchimento automático do painel de entrada não tem suporte no Microsoft Windows XP Tablet PC Edition ou em sistemas operacionais anteriores.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-116">While [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) and [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) both run on earlier versions of Windows, Input Panel Autocomplete integration is not supported on Microsoft Windows XP Tablet PC Edition or earlier operating systems.</span></span> <span data-ttu-id="b8dd1-117">Se você executar o preenchimento automático do painel de entrada em versões anteriores do Tablet PC, os aplicativos voltarão para o comportamento de pré-atualização.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-117">If you run Input Panel Autocomplete on earlier versions of Tablet PC, applications revert to the pre-integration behavior.</span></span>

## <a name="reasons-to-integrate-application-autocomplete-lists-with-input-panel"></a><span data-ttu-id="b8dd1-118">Motivos para integrar listas de preenchimento automático do aplicativo com o painel de entrada</span><span class="sxs-lookup"><span data-stu-id="b8dd1-118">Reasons to Integrate Application Autocomplete Lists with Input Panel</span></span>

<span data-ttu-id="b8dd1-119">A integração da lista de preenchimento automático de um aplicativo permite o máximo de facilidade e velocidade de entrada para os usuários que estão inserindo texto em um campo de texto que inclui a funcionalidade de preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-119">Integration of an application's Autocomplete list enables the maximum ease and speed of input for users who are entering text into a text field that includes Autocomplete functionality.</span></span> <span data-ttu-id="b8dd1-120">Além disso, um aplicativo que inclui a integração de preenchimento automático do painel de entrada aparece imediatamente como se fosse desenvolvido com o Tablet PC em mente, tornando o aplicativo mais atraente para os usuários do Tablet PC.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-120">Furthermore, an application that includes Input Panel Autocomplete integration immediately appears as if it were developed with the Tablet PC in mind, making the application more appealing to Tablet PC users.</span></span>

### <a name="how-input-panel-and-autocomplete-list-interact-without-integration"></a><span data-ttu-id="b8dd1-121">Como o painel de entrada e a lista de preenchimento automático interagem sem integração</span><span class="sxs-lookup"><span data-stu-id="b8dd1-121">How Input Panel and Autocomplete List Interact without Integration</span></span>

<span data-ttu-id="b8dd1-122">Usando o painel de entrada para inserir texto em um campo de texto que inclui uma lista de preenchimento automático, mas que não está integrado ao painel de entrada:</span><span class="sxs-lookup"><span data-stu-id="b8dd1-122">Using Input Panel to enter text into a text field that includes an Autocomplete list but that is not integrated with Input Panel:</span></span>

1.  <span data-ttu-id="b8dd1-123">O usuário coloca o foco no campo de texto e abre o painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-123">The user places focus in the text field and opens Input Panel.</span></span>
2.  <span data-ttu-id="b8dd1-124">O usuário grava um ou dois caracteres.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-124">The user writes one or two characters.</span></span>
3.  <span data-ttu-id="b8dd1-125">O usuário toca em **Inserir**.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-125">The user taps **Insert**.</span></span> <span data-ttu-id="b8dd1-126">O painel de entrada insere o texto no campo de texto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-126">Input Panel enters the text into the application's text field.</span></span> <span data-ttu-id="b8dd1-127">A lista de preenchimento automático do aplicativo é exibida e provavelmente é parcialmente ou completamente obscurecida pelo painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-127">The application's Autocomplete list appears and is most likely partially or completely obscured by Input Panel.</span></span>
4.  <span data-ttu-id="b8dd1-128">O usuário arrasta o painel de entrada para descobrir a lista de preenchimento automático do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-128">The user drags Input Panel to uncover the application's Autocomplete list.</span></span>
5.  <span data-ttu-id="b8dd1-129">Supondo que a entrada correta esteja incluída na lista de preenchimento automático, o usuário agora pode selecionar essa entrada; caso contrário, o usuário deverá repetir as etapas 2 e 3.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-129">Assuming the correct entry is included in the Autocomplete list, the user can now select that entry; otherwise the user must repeat steps 2 and 3.</span></span>

<span data-ttu-id="b8dd1-130">Isso é claramente um processo complicado.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-130">This is clearly a cumbersome process.</span></span> <span data-ttu-id="b8dd1-131">As expectativas do usuário de como uma lista de preenchimento automático devem funcionar são tracejadas e sua capacidade de executar tarefas é prejudicada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-131">The user's expectations of how an Autocomplete list should work are dashed, and their ability to perform tasks suffers.</span></span>

### <a name="how-input-panel-and-autocomplete-list-interaction-improves-with-integration"></a><span data-ttu-id="b8dd1-132">Como o painel de entrada e a interação de lista de preenchimento automático aprimoram com a integração</span><span class="sxs-lookup"><span data-stu-id="b8dd1-132">How Input Panel and Autocomplete List Interaction Improves with Integration</span></span>

<span data-ttu-id="b8dd1-133">Usando o painel de entrada para inserir texto em um campo de texto que inclui uma lista de preenchimento automático que é integrada com o painel de entrada:</span><span class="sxs-lookup"><span data-stu-id="b8dd1-133">Using Input Panel to enter text into a text field that includes an Autocomplete list that is integrated with Input Panel:</span></span>

1.  <span data-ttu-id="b8dd1-134">O usuário coloca o foco no campo de texto e abre o painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-134">The user places focus in the text field and opens Input Panel.</span></span>
2.  <span data-ttu-id="b8dd1-135">O usuário grava um ou dois caracteres.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-135">The user writes one or two characters.</span></span> <span data-ttu-id="b8dd1-136">A lista de preenchimento automático do aplicativo aparece diretamente acima ou diretamente abaixo do painel de entrada enquanto o usuário grava o texto.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-136">The application's Autocomplete list appears directly above or directly below Input Panel as the user writes text.</span></span>
3.  <span data-ttu-id="b8dd1-137">O usuário seleciona a entrada na lista AutoCompletar; a entrada é inserida diretamente no campo de texto do aplicativo ou o usuário repete a etapa 2 até que a entrada correta seja exibida.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-137">The user selects the entry from the Autocomplete list; the entry is inserted directly into the application's text field, or the user repeats step 2 until the correct entry appears.</span></span>

<span data-ttu-id="b8dd1-138">Devido à integração, a lista de preenchimento automático aparece e é atualizada enquanto o usuário está gravando no painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-138">Due to the integration, the Autocomplete list appears and updates while the user is writing in Input Panel.</span></span> <span data-ttu-id="b8dd1-139">Além disso, a lista é posicionada de forma que seja conveniente para o usuário acessar durante a gravação e não obscurecida pelo painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-139">Additionally, the list is positioned so that it is both convenient for the user to access while writing and not obscured by Input Panel.</span></span> <span data-ttu-id="b8dd1-140">Por fim, quando o usuário seleciona um item de uma lista de preenchimento automático, o item é inserido diretamente no campo de entrada de texto do aplicativo, permitindo assim que o usuário ignore a etapa de inserção de texto do painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-140">Lastly, when the user selects an item from an Autocomplete list the item is inserted directly into the application's text entry field, thus enabling the user to bypass the step of inserting text from Input Panel.</span></span>

![painel de entrada com a lista de preenchimento automático do Outlook Express](images/ba59a513-e538-4092-89a6-6d691424dc3d.jpg)

## <a name="standard-autocomplete-components-that-include-input-panel-autocomplete-integration"></a><span data-ttu-id="b8dd1-142">Componentes de preenchimento automático padrão que incluem integração de preenchimento automático do painel de entrada</span><span class="sxs-lookup"><span data-stu-id="b8dd1-142">Standard Autocomplete Components that include Input Panel Autocomplete Integration</span></span>

<span data-ttu-id="b8dd1-143">[**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) e [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) incluem integração interna do painel de entrada preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-143">Both [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) and [AutoCompleteMode](/dotnet/api/system.windows.forms.autocompletemode?view=netcore-3.1) include built-in integration of Input Panel Autocomplete.</span></span> <span data-ttu-id="b8dd1-144">Os aplicativos que usam qualquer um desses componentes padrão de preenchimento automático podem aproveitar a funcionalidade de preenchimento automático do painel de entrada com pouco ou nenhum trabalho adicional.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-144">Applications using either of these standard Autocomplete components can take advantage of Input Panel Autocomplete functionality with little to no additional work.</span></span> <span data-ttu-id="b8dd1-145">Além disso, embora o preenchimento automático do painel de entrada só tenha suporte no Windows Vista ou em novas versões do sistema operacional Windows, os aplicativos que foram criados usando o **IAutoComplete** antes do lançamento do Windows Vista obtêm a integração de preenchimento automático do painel de entrada automaticamente quando executados no Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-145">Additionally, while Input Panel Autocomplete is only supported on Windows Vista or new versions of the Windows operating system, applications that were built using **IAutoComplete** prior to the release of Windows Vista get Input Panel Autocomplete integration automatically when run on Windows Vista.</span></span> <span data-ttu-id="b8dd1-146">As seções a seguir contêm mais informações sobre os elementos **IAutoComplete** e AutoCompleteMode específicos que incluem a integração de preenchimento automático do painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-146">The following sections contain more information about the specific **IAutoComplete** and AutoCompleteMode elements that include Input Panel Autocomplete integration.</span></span>

### <a name="shell-autocomplete-with-input-panel-autocomplete-integration"></a><span data-ttu-id="b8dd1-147">Preenchimento automático do shell com integração de preenchimento automático do painel de entrada</span><span class="sxs-lookup"><span data-stu-id="b8dd1-147">Shell Autocomplete with Input Panel Autocomplete Integration</span></span>

<span data-ttu-id="b8dd1-148">Os aplicativos que usam o [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) obtêm integração de preenchimento automático do painel de entrada gratuitamente.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-148">Applications that use [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete) get Input Panel Autocomplete integration for free.</span></span> <span data-ttu-id="b8dd1-149">Embora as APIs de preenchimento automático do Shell estejam incluídas no Windows 2000 em diante, a integração de preenchimento automático do painel de entrada só é compatível com o Windows Vista e versões mais recentes.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-149">While the Shell Autocomplete APIs are included in Windows 2000 onward, Input Panel Autocomplete integration is only support on Windows Vista and newer versions.</span></span> <span data-ttu-id="b8dd1-150">No entanto, os aplicativos criados antes do lançamento do Windows Vista que usam o **IAutoComplete** automaticamente obtêm a integração de preenchimento automático do painel de entrada quando executados no Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-150">However, applications built prior to the release of Windows Vista that use **IAutoComplete** automatically get Input Panel Autocomplete integration when run on Windows Vista.</span></span>

<span data-ttu-id="b8dd1-151">Para tirar proveito do preenchimento automático do Tablet dessa forma, você deve usar o objeto de preenchimento automático (**\_ AutoCompletar CLSID**).</span><span class="sxs-lookup"><span data-stu-id="b8dd1-151">In order to take advantage of Tablet Autocomplete in this way, you must use the autocomplete object (**CLSID\_Autocomplete**).</span></span> <span data-ttu-id="b8dd1-152">Se você quiser fornecer a funcionalidade de preenchimento automático para URLs ou nomes de arquivo, use a função [**SHAutoComplete**](/windows/win32/api/shlwapi/nf-shlwapi-shautocomplete) para criar o objeto de preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-152">If you wish to provide autocomplete functionality for URLs or file names, use the [**SHAutoComplete**](/windows/win32/api/shlwapi/nf-shlwapi-shautocomplete) function to create the autocomplete object.</span></span>

<span data-ttu-id="b8dd1-153">Além de [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete), você pode implementar [**IAutoComplete2**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete2) ou [**IAutoCompleteDropDown**](/windows/win32/api/shobjidl/nn-shobjidl-iautocompletedropdown)s diretamente e ainda obter automaticamente a integração de preenchimento automático do painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-153">In addition to [**IAutoComplete**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete), you can implement [**IAutoComplete2**](/windows/win32/api/shldisp/nn-shldisp-iautocomplete2) or [**IAutoCompleteDropDown**](/windows/win32/api/shobjidl/nn-shobjidl-iautocompletedropdown)s directly and still get Input Panel Autocomplete integration automatically.</span></span>

### <a name="input-panel-autocomplete-integration-with-net-framework-applications"></a><span data-ttu-id="b8dd1-154">Integração de preenchimento automático do painel de entrada com aplicativos .NET Framework</span><span class="sxs-lookup"><span data-stu-id="b8dd1-154">Input Panel Autocomplete Integration with .NET Framework Applications</span></span>

<span data-ttu-id="b8dd1-155">A partir do .NET Framework 3,0, Windows Forms TextBoxes incluem AutoCompletar.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-155">Starting in .NET Framework 3.0, Windows Forms textboxes include Autocomplete.</span></span> <span data-ttu-id="b8dd1-156">A Windows Forms AutoCompletar caixa de texto é criada sobre o preenchimento automático do Shell, o que significa que a integração de preenchimento automático do painel de entrada também é interna.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-156">Windows Forms textbox Autocomplete is built on top of Shell Autocomplete, which means Input Panel Autocomplete integration is built in, too.</span></span> <span data-ttu-id="b8dd1-157">.NET Framework 3,0 é compatível com o nível inferior das edições do Windows lançadas antes do Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-157">.NET Framework 3.0 is supported down level on Windows editions released prior to Windows Vista.</span></span> <span data-ttu-id="b8dd1-158">No entanto, como a integração de preenchimento automático do painel de entrada só tem suporte no Windows Vista ou em versões posteriores, a integração de preenchimento automático do painel de entrada funciona apenas em um aplicativo .NET Framework 3,0 quando ele é instalado no Windows Vista ou em versões posteriores.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-158">However, because Input Panel Autocomplete integration is only supported on Windows Vista or later versions, Input Panel Autocomplete integration only works in a .NET Framework 3.0 application when it is installed on Windows Vista or later versions.</span></span>

<span data-ttu-id="b8dd1-159">Os aplicativos que desejam aproveitar a integração de preenchimento automático do painel de entrada no .NET Framework 3,0 devem usar uma [caixa de texto](/dotnet/api/system.windows.forms.textbox?view=netcore-3.1) Windows Forms com a propriedade [AutoCompleteMode](/dotnet/api/system.windows.forms.textbox.autocompletemode?view=netcore-3.1) habilitada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-159">Applications wishing to take advantage of Input Panel Autocomplete integration in .NET Framework 3.0 must use a Windows Forms [TextBox](/dotnet/api/system.windows.forms.textbox?view=netcore-3.1) with the [AutoCompleteMode](/dotnet/api/system.windows.forms.textbox.autocompletemode?view=netcore-3.1) property enabled.</span></span> <span data-ttu-id="b8dd1-160">Você não precisa fazer nenhum trabalho adicional além de obter Windows Forms preenchimento automático para trabalhar para tirar proveito da integração de preenchimento automático do painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-160">You need not do any additional work beyond getting Windows Forms Autocomplete to work to take advantage of Input Panel Autocomplete integration.</span></span>

## <a name="using-input-panel-autocomplete-apis-directly"></a><span data-ttu-id="b8dd1-161">Usando as APIs de preenchimento automático do painel de entrada diretamente</span><span class="sxs-lookup"><span data-stu-id="b8dd1-161">Using Input Panel Autocomplete APIs Directly</span></span>

<span data-ttu-id="b8dd1-162">Os desenvolvedores de caixas de texto de preenchimento automático personalizados precisam trabalhar diretamente com as APIs de preenchimento automático do painel de entrada para obter a experiência de entrada de texto aprimorada que a integração de preenchimento automático do painel de entrada permite em seus aplicativos.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-162">Developers of custom Autocomplete textboxes need to work with the Input Panel Autocomplete APIs directly in order to get the improved text input experience that Input Panel Autocomplete integration enables in their applications.</span></span> <span data-ttu-id="b8dd1-163">As APIs de preenchimento automático do painel de entrada são incluídas como parte do sistema operacional Windows Vista e como parte do SDK da plataforma Tablet versão 1,9 ou posterior.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-163">The Input Panel Autocomplete APIs are included as part of the Windows Vista operating system and as part of the Tablet Platform SDK version 1.9 or later.</span></span> <span data-ttu-id="b8dd1-164">As interfaces de preenchimento automático do painel de entrada são interfaces baseadas em COM.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-164">The Input Panel Autocomplete interfaces are COM-based interfaces.</span></span>

<span data-ttu-id="b8dd1-165">A seção a seguir descreve como trabalhar essas interfaces em detalhes para um aplicativo C++.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-165">The following section describes working these interfaces in detail for a C++ application.</span></span> <span data-ttu-id="b8dd1-166">No entanto, essas interfaces COM podem ser implementadas na maioria das linguagens, incluindo C \# , por meio do uso de interoperabilidade com.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-166">However, these COM interfaces can be implemented in most languages, including C\#, through the use of COM Interop.</span></span>

<span data-ttu-id="b8dd1-167">Para implementar a integração de preenchimento automático do painel de entrada em uma caixa de texto de preenchimento automático personalizado, as duas interfaces necessárias são a [**interface ITipAutocompleteProvider**](itipautocompleteprovider.md) e a [**interface ITipAutocompleteClient**](itipautocompleteclient.md).</span><span class="sxs-lookup"><span data-stu-id="b8dd1-167">In order to implement Input Panel Autocomplete integration in a custom Autocomplete text box, the two required interfaces are the [**ITipAutocompleteProvider Interface**](itipautocompleteprovider.md) and the [**ITipAutocompleteClient Interface**](itipautocompleteclient.md).</span></span> <span data-ttu-id="b8dd1-168">As definições para essas interfaces são encontradas em TipAutoComplete. h e TipAutoComplete \_ i.c.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-168">The definitions for these interfaces are found in TipAutoComplete.h and TipAutoComplete\_i.c.</span></span>

<span data-ttu-id="b8dd1-169">Primeiro, um aplicativo deve definir e criar uma instância de uma classe de provedor de preenchimento automático, que implementa [**ITipAutocompleteProvider**](itipautocompleteprovider.md) para cada campo de entrada de texto que inclui uma lista de preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-169">First, an application must define and instantiate an Autocomplete provider class, which implements [**ITipAutocompleteProvider**](itipautocompleteprovider.md) for each text entry field that includes an Autocomplete list.</span></span> <span data-ttu-id="b8dd1-170">Essa classe gerencia o lado do aplicativo da integração de preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-170">This class manages the application's side of the Autocomplete integration.</span></span> <span data-ttu-id="b8dd1-171">Todas as solicitações de preenchimento automático do painel de entrada são feitas do cliente de preenchimento automático para o aplicativo por meio do provedor de preenchimento automático do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-171">All Autocomplete requests from Input Panel are made from the Autocomplete client to the application via the application's Autocomplete provider.</span></span> <span data-ttu-id="b8dd1-172">O provedor de preenchimento automático do aplicativo deve ter acesso ao HWND para a lista de preenchimento automático do aplicativo e o HWIND para o campo de entrada de texto associado.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-172">The application's Autocomplete provider must have access to both the HWND for the application's Autocomplete list and the HWIND for the associated text entry field.</span></span> <span data-ttu-id="b8dd1-173">Além disso, os seguintes métodos de **ITipAutocompleteProvider** devem ser implementados:</span><span class="sxs-lookup"><span data-stu-id="b8dd1-173">Additionally, the following methods of **ITipAutocompleteProvider** must be implemented:</span></span>

-   <span data-ttu-id="b8dd1-174">[**Método ITipAutocompleteProvider:: UpdatePendingText**](itipautocompleteprovider-updatependingtext.md): esse método é usado pelo cliente de preenchimento automático para notificar o aplicativo sobre o texto que um usuário gravou no painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-174">[**ITipAutocompleteProvider::UpdatePendingText Method**](itipautocompleteprovider-updatependingtext.md): This method is used by the Autocomplete client to notify the application of the text a user has written into Input Panel.</span></span> <span data-ttu-id="b8dd1-175">Após receber essa notificação, o provedor é responsável por gerar uma lista de preenchimento automático como se o texto tivesse sido digitado no campo de entrada de texto do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-175">Upon receiving this notification, the provider is responsible for generating an Autocomplete list as if the text had been typed into the application's text entry field.</span></span> <span data-ttu-id="b8dd1-176">A cadeia de caracteres passa para o provedor de preenchimento automático por meio do **método ITipAutocompleteProvider:: UpdatePendingText** apenas inclui o texto atualmente no painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-176">The string pass to the Autocomplete provider by means of **ITipAutocompleteProvider::UpdatePendingText Method** only includes the text currently in Input Panel.</span></span> <span data-ttu-id="b8dd1-177">Portanto, se houver texto adicional no campo de entrada de texto, é responsabilidade do provedor acrescentá-lo corretamente ao texto enviado pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-177">Therefore, if there is additional text in the text entry field, it is the responsibility of the provider to properly append it to the text sent by the client.</span></span> <span data-ttu-id="b8dd1-178">A cadeia de caracteres passada pelo **método ITipAutocompleteProvider:: UpdatePendingText** deve ser tratada como uma substituição para a seleção atual no campo.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-178">The string pass by **ITipAutocompleteProvider::UpdatePendingText Method** should be treated as a replacement for the current selection in the field.</span></span> <span data-ttu-id="b8dd1-179">Se não houver nenhuma seleção atual, ela deverá ser colocada na posição do ponto de inserção atual.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-179">If there is no current selection, it should be placed at the position of the current insertion point.</span></span> <span data-ttu-id="b8dd1-180">Quando a lista de preenchimento automático é gerada, o provedor deve chamar o [**método ITipAutocompleteProvider:: show**](itipautocompleteprovider-show.md) transmitindo **true** para exibir a lista de preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-180">Once the Autocomplete list is generated, the provider should call the [**ITipAutocompleteProvider::Show Method**](itipautocompleteprovider-show.md) passing in **TRUE** to display the Autocomplete list.</span></span> <span data-ttu-id="b8dd1-181">O aplicativo não deve armazenar em cache chamadas para **UpdatePendingText** , mas tratar cada chamada adicional para **UpdatePendingText** como cancelamento da chamada anterior para evitar a intermitência de uma interface do usuário de lista de preenchimento automático desatualizada. O código de exemplo a seguir ilustra essas práticas.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-181">The application should not cache calls to **UpdatePendingText** but rather treat each additional call to **UpdatePendingText** as a cancellation of the previous call to avoid flashing an out-of-date Autocomplete list UI.The following example code illustrates these practices.</span></span>

    ```C++
    HRESULT SampleProvider::UpdatePendingText(BSTR bstrPendingText)
    {
       //Discard previously cached pending text from Input Panel
       m_bstrPending.Empty();
        //Store the new pending text from Input Panel as m_bstrPending
    m_bstrPending = bstrPendingText;

        //Get the text from the field in two chunks. The characters to
    //the left of the selection and the characters to the right.
    CComBSTR bstrLeftContext = //Text to the left of the selection
            CComBSTR bstrRightContext = //Text to the right of the selection

    //Discard previously cached complete text
        m_bstrCompleteText.Empty();
        //Append to the field text from the left of the selection
        //the text from Input Panel and then append to that
        //the field text to the right of the selection
        m_bstrCompleteText.Append(bstrLeftContext);
        m_bstrCompleteText.Append(m_bstrPending);
        m_bstrCompleteText.Append(bstrRigtContext);

        //Update the app's AC list based on m_bstrCompleteText
        //...

        //Show the updated AC list by calling the provider's Show method
       Show(true);
       return S_OK;
    }
    ```

    

-   <span data-ttu-id="b8dd1-182">[**Método ITipAutocompleteProvider:: show**](itipautocompleteprovider-show.md): esse método é chamado de [**UpdatePendingText**](itipautocompleteprovider-updatependingtext.md), mas também pode ser chamado pelo cliente de preenchimento automático a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-182">[**ITipAutocompleteProvider::Show Method**](itipautocompleteprovider-show.md): This method is called from [**UpdatePendingText**](itipautocompleteprovider-updatependingtext.md), but also can be called by the Autocomplete client at anytime.</span></span> <span data-ttu-id="b8dd1-183">Após receber essa chamada, o provedor de preenchimento automático deve ocultar ou mostrar o provedor de preenchimento automático, conforme indicado pelo parâmetro.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-183">Upon receiving this call, the Autocomplete provider must hide or show the Autocomplete provider as indicated by the parameter.</span></span> <span data-ttu-id="b8dd1-184">Antes de mostrar a lista de preenchimento automático, o provedor de preenchimento automático deve consultar o cliente de preenchimento automático sobre onde posicionar a lista de preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-184">Prior to showing the Autocomplete list the Autocomplete provider is expected to consult the Autocomplete client about where to position the Autocomplete list.</span></span> <span data-ttu-id="b8dd1-185">Mais informações sobre como posicionar a lista de preenchimento automático aparecem mais adiante neste artigo.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-185">More information about positioning the Autocomplete list appears later in this article.</span></span>

<span data-ttu-id="b8dd1-186">Em seguida, o aplicativo deve usar a função [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) de Active Template Library (ATL) para produzir uma instância da [**interface ITipAutocompleteClient**](itipautocompleteclient.md) com a ID de classe **CLSID \_ TipAutoCompleteClient** como um servidor em processo e, em seguida, registrar o provedor com o cliente.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-186">Next, the application should use the Active Template Library (ATL) [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) function to produce an instance of the [**ITipAutocompleteClient Interface**](itipautocompleteclient.md) with class id **CLSID\_TipAutoCompleteClient** as an in-process server, and then register the provider with the client.</span></span> <span data-ttu-id="b8dd1-187">O [**método ITipAutocompleteClient:: aconselheprovider**](itipautocompleteclient-adviseprovider.md) do cliente de preenchimento automático registra o provedor com o cliente para permitir que o cliente chame o objeto de provedor de preenchimento automático do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-187">The Autocomplete client [**ITipAutocompleteClient::AdviseProvider Method**](itipautocompleteclient-adviseprovider.md) registers the provider with the client to enable the client to call the application's Autocomplete provider object.</span></span> <span data-ttu-id="b8dd1-188">Se tiptsf.dll não estiver presente no sistema, a função **CoCreateInstance** falhará e retornará **REGDB \_ e \_ CLASSNOTREG**.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-188">If tiptsf.dll is not present on the system, the **CoCreateInstance** function fails and returns **REGDB\_E\_CLASSNOTREG**.</span></span> <span data-ttu-id="b8dd1-189">Neste ponto, o aplicativo pode descartar seu objeto [**ITipAutocompleteProvider**](itipautocompleteprovider.md) e prosseguir como se o painel de entrada não existir, pois ele não é um sistema desse tipo.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-189">At this point the application can discard its [**ITipAutocompleteProvider**](itipautocompleteprovider.md) object and proceed as if Input Panel does not exist, because it does not on such a system.</span></span>

<span data-ttu-id="b8dd1-190">O aplicativo pode optar por criar uma instância de [**ITipAutocompleteClient**](itipautocompleteclient.md) ou uma instância por campo de texto.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-190">The application can choose to create one instance of [**ITipAutocompleteClient**](itipautocompleteclient.md) or one instance per text field.</span></span> <span data-ttu-id="b8dd1-191">A primeira opção exige que o provedor tenha o registro cancelado e registrado toda vez que o foco for alterado.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-191">The first option requires the provider to be unregistered and registered each time the focus is changed.</span></span> <span data-ttu-id="b8dd1-192">Mais informações sobre o cancelamento do registro do provedor de preenchimento automático aparecem mais adiante neste tópico.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-192">More information about unregistering the Autocomplete provider appears later in this topic.</span></span>

<span data-ttu-id="b8dd1-193">Há várias etapas envolvidas no posicionamento da lista de preenchimento automático que deve ser coordenada entre o provedor de preenchimento automático (aplicativo) e o cliente de preenchimento automático (painel de entrada).</span><span class="sxs-lookup"><span data-stu-id="b8dd1-193">There are several steps involved in positioning the Autocomplete list that must be coordinated between the Autocomplete provider (application) and the Autocomplete client (Input Panel).</span></span> <span data-ttu-id="b8dd1-194">Antes de a lista de preenchimento automático ser mostrada, como resultado de uma chamada para o método [**show**](itipautocompleteprovider-show.md) do provedor de preenchimento automático ou devido ao usuário que está inserindo o texto usando o teclado, o provedor é solicitado a consultar o cliente sobre onde posicionar a lista de preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-194">Before the Autocomplete list is shown, either as a result of a call to the Autocomplete provider's [**Show**](itipautocompleteprovider-show.md) method or due to the user entering text using the keyboard, the provider is required to consult the client about where to position the Autocomplete list.</span></span> <span data-ttu-id="b8dd1-195">O provedor deve executar as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="b8dd1-195">The provider should take the following steps:</span></span>

-   <span data-ttu-id="b8dd1-196">Use o [**método ITipAutocompleteClient:: RequestShowUI**](itipautocompleteclient-requestshowui.md) do cliente de preenchimento automático para determinar se o painel de entrada está pronto para que a lista de preenchimento automático seja mostrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-196">Use the Autocomplete client's [**ITipAutocompleteClient::RequestShowUI Method**](itipautocompleteclient-requestshowui.md) to determine whether Input Panel is ready to have the Autocomplete list shown.</span></span> <span data-ttu-id="b8dd1-197">**RequestShowUI** usa o parâmetro *HWND* que é o HWND para a janela de lista de preenchimento automático e o método retorna **true** ou **false** para indicar se é o estado no qual a lista de preenchimento automático pode ser mostrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-197">**RequestShowUI** takes the *HWND* parameter that is the HWND for the Autocomplete list window, and the method returns **TRUE** or **FALSE** to indicate if it is the state in which the Autocomplete list can be shown.</span></span> <span data-ttu-id="b8dd1-198">Se o cliente retornar **false**, o provedor não deverá tentar mostrar a lista de preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-198">If the client returns **FALSE**, the provider should not attempt to show the Autocomplete list.</span></span>
-   <span data-ttu-id="b8dd1-199">Chame [**RequestShowUI**](itipautocompleteclient-requestshowui.md) para definir o identificador da janela de lista de AutoCompletar pop-up antes de chamar o [**método ITipAutocompleteClient::P referredrects**](itipautocompleteclient-preferredrects.md).</span><span class="sxs-lookup"><span data-stu-id="b8dd1-199">Call [**RequestShowUI**](itipautocompleteclient-requestshowui.md) to set the popup Autocomplete list window handle before you call the [**ITipAutocompleteClient::PreferredRects Method**](itipautocompleteclient-preferredrects.md).</span></span> <span data-ttu-id="b8dd1-200">A falha em fazer isso causará um erro **E \_ INVALIDARG** ao chamar **PreferredRects**.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-200">Failure to do so will cause an **E\_INVALIDARG** error when calling **PreferredRects**.</span></span>
-   <span data-ttu-id="b8dd1-201">Se [**RequestShowUI**](itipautocompleteclient-requestshowui.md) retornar **true**, o provedor deverá calcular o retângulo de coordenadas de tela padrão da lista de preenchimento automático com base no local do campo de entrada de texto e, em seguida, chamar o [**método ITipAutocompleteClient::P referredrects**](itipautocompleteclient-preferredrects.md)do cliente de preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-201">If [**RequestShowUI**](itipautocompleteclient-requestshowui.md) returns **TRUE**, the provider should calculate the default screen coordinate rectangle of the Autocomplete list based on the location of the text entry field, and then call the Autocomplete client's [**ITipAutocompleteClient::PreferredRects Method**](itipautocompleteclient-preferredrects.md).</span></span> <span data-ttu-id="b8dd1-202">Isso permite que o cliente de preenchimento automático ajuste o retângulo para evitar que a lista de preenchimento automático se sobreponha com o painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-202">This allows the Autocomplete client to adjust the rectangle to avoid the Autocomplete list overlapping with Input Panel.</span></span> <span data-ttu-id="b8dd1-203">O método **PreferredRects** usa quatro parâmetros:</span><span class="sxs-lookup"><span data-stu-id="b8dd1-203">The **PreferredRects** method takes four parameters:</span></span>

    -   <span data-ttu-id="b8dd1-204">RECT *rcACList*: o retângulo de coordenadas de tela padrão da lista de preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-204">RECT *rcACList*: The default screen coordinate rectangle of the Autocomplete list.</span></span>
    -   <span data-ttu-id="b8dd1-205">RECT *rcField*: o retângulo de coordenadas de tela do campo de entrada de texto correspondente.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-205">RECT *rcField*: The screen coordinate rectangle of the corresponding text entry field.</span></span>
    -   <span data-ttu-id="b8dd1-206">RECT *\* prcModifiedACList*: o retângulo de coordenadas de tela ajustado para o preenchimento automático</span><span class="sxs-lookup"><span data-stu-id="b8dd1-206">RECT *\*prcModifiedACList*: The adjusted screen coordinate rectangle for the Autocomplete</span></span>
    -   <span data-ttu-id="b8dd1-207">BOOL *\* pfShowAbove*: esse parâmetro indica ao provedor se o retângulo *prcModifiedACList* posiciona a lista de preenchimento automático acima ou abaixo do painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-207">BOOL *\*pfShowAbove*: This parameter indicates to the provider whether the *prcModifiedACList* rectangle positions the Autocomplete list above or below Input Panel.</span></span> <span data-ttu-id="b8dd1-208">O aplicativo pode usar essas informações para desenhar corretamente elementos da interface do usuário, como alças de redimensionamento e barras de rolagem.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-208">The application can use this information to correctly draw UI elements such as resize handles and scroll bars.</span></span> <span data-ttu-id="b8dd1-209">O provedor deve inicialmente passar na direção em que a lista de preenchimento automático seria posicionada em relação ao campo de entrada de texto por *rcACList*.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-209">The provider should initially pass in the direction that the Autocomplete list would be positioned relative to the text entry field by *rcACList*.</span></span> <span data-ttu-id="b8dd1-210">O cliente não alterará *pfShowAbove* se definir *PrcModifiedACList* igual a *rcACList*.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-210">The client does not change *pfShowAbove* if it sets *prcModifiedACList* equal to *rcACList*.</span></span>

    <span data-ttu-id="b8dd1-211">Use os valores de retorno dos argumentos *prcModifiedACList* e *pfShowAbove* out para posicionar e mostrar a janela de lista de preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-211">Use the return values of the *prcModifiedACList* and *pfShowAbove* out arguments to position and show the Autocomplete list window.</span></span> <span data-ttu-id="b8dd1-212">Se o painel de entrada não estiver em uso, [**RequestShowUI**](itipautocompleteclient-requestshowui.md) sempre retornará **true** e *prcModifiedACList* será sempre o mesmo que *rcACList*.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-212">If Input Panel is not in use, [**RequestShowUI**](itipautocompleteclient-requestshowui.md) always returns **TRUE** and *prcModifiedACList* is always the same as *rcACList*.</span></span> <span data-ttu-id="b8dd1-213">*pfShowAbove* também é inalterado, o resultado é que as chamadas não afetam o comportamento do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-213">*pfShowAbove* is also unchanged, the result being that the calls have no affect on the application behavior.</span></span> <span data-ttu-id="b8dd1-214">O código de exemplo a seguir ilustra essas práticas.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-214">The following example code illustrates these practices.</span></span>


```C++
HRESULT SampleProvider::Show(BOOL fShow)
{
    //Ask the AC client if it is OK to show the Autocomplete list.
    BOOL fAllowShowing = FALSE;
    m_spACClient->RequestShowUI(m_hWndList, &fAllowShowing);

    if (fShow && fAllowingShowing)
        {
            // Create the parameters required to call PreferredRects
            RECT rcField = //Rectangle for app's text field
            RECT rcACList = //Default rectangle for app's AC list
            RECT rcModifiedACList = {0, 0, 0, 0};
            BOOL fShowAbove = TRUE;

//Ask the AC client to modify the position of the AC list
m_spACClient->PreferredRects(&rcACList, &rcField,
&rcModifiedACList, &fShowAbove);

            //Show the Autocomplete UI at the modified preferred rectangle
            //from rcModifiedACList and the directional info provide by
//fShowAbove
            //...
        }
    else
        {
        //Hide the Autocomplete list and clean up
        //...
        }
    return S_OK;
}
```



<span data-ttu-id="b8dd1-215">Quando o usuário seleciona um item na lista de preenchimento automático, o provedor precisa chamar o [**método ITipAutocompleteClient:: Userselecionar**](itipautocompleteclient-userselection.md) do cliente, além de inserir o texto do item selecionado no campo de entrada de texto.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-215">When the user selects an item in the Autocomplete list, the provider needs to call the client's [**ITipAutocompleteClient::UserSelection Method**](itipautocompleteclient-userselection.md) in addition to inserting the selected item text into the text entry field.</span></span> <span data-ttu-id="b8dd1-216">O painel de entrada usa essa notificação para descartar todo o texto restante que ainda não foi inserido no painel de entrada.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-216">Input Panel uses this notification to discard all remaining text that has not yet been inserted from Input Panel.</span></span>

<span data-ttu-id="b8dd1-217">Por fim, quando o provedor não for mais necessário, o provedor deverá ser desvinculado do cliente de preenchimento automático chamando o [**método ITipAutocompleteClient:: unaconselheprovider**](itipautocompleteclient-unadviseprovider.md) do cliente de preenchimento automático para cancelar o registro do provedor.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-217">Finally, when the provider is no longer necessary, the provider should be unlinked from the Autocomplete client by calling the Autocomplete client's [**ITipAutocompleteClient::UnadviseProvider Method**](itipautocompleteclient-unadviseprovider.md) to unregister the provider.</span></span> <span data-ttu-id="b8dd1-218">Talvez seja necessário cancelar o registro do provedor por um destes dois motivos: como o campo de entrada de texto ao qual o provedor está associado foi destruído, ou porque o aplicativo escolhe criar apenas um cliente de preenchimento automático, em vez de um campo de entrada por texto.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-218">The provider may need to be unregistered for one of two reasons: because the text entry field the provider is associated with has been destroyed, or because the application chooses to create only one Autocomplete client, instead of one per text entry field.</span></span> <span data-ttu-id="b8dd1-219">Nessa instância, o provedor deve ter o registro cancelado toda vez que o foco for desativado do campo de texto.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-219">In this instance the provider must be unregistered every time that focus is switched away from the text field.</span></span>

## <a name="conclusion"></a><span data-ttu-id="b8dd1-220">Conclusão</span><span class="sxs-lookup"><span data-stu-id="b8dd1-220">Conclusion</span></span>

<span data-ttu-id="b8dd1-221">A integração de preenchimento automático do painel de entrada é uma ferramenta poderosa para melhorar a experiência do usuário em aplicativos do Windows que incluem listas de preenchimento automático em Tablet PCs.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-221">Input Panel Autocomplete integration is a powerful tool for improving the user experience in Windows applications that include Autocomplete lists on Tablet PCs.</span></span> <span data-ttu-id="b8dd1-222">Sem integração, os usuários do painel de entrada precisam passar por um processo entediante de inserir texto um caractere por vez e reposicionar o painel de entrada para usar o preenchimento automático.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-222">Without integration, Input Panel users are required to go through a tedious process of inserting text one character at a time and repositioning Input Panel in order to use Autocomplete.</span></span> <span data-ttu-id="b8dd1-223">Com a integração, as listas de preenchimento automático aparecem em um local conveniente como tinta dos usuários no painel de entrada, aumentando a velocidade e a facilidade de entrada de texto.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-223">With integration, Autocomplete lists appear in a convenient location as users ink in Input Panel, increasing both the speed and the ease of text entry.</span></span> <span data-ttu-id="b8dd1-224">Em aplicativos que incluem a funcionalidade de preenchimento automático criada com base no preenchimento automático do Shell ou .NET Framework 3,0 AutoCompletar, a integração de preenchimento automático do painel de entrada é um recurso gratuito e atraente.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-224">In applications that include Autocomplete functionality built on top of Shell Autocomplete or .NET Framework 3.0 Autocomplete, Input Panel Autocomplete integration is a free and compelling feature.</span></span> <span data-ttu-id="b8dd1-225">Além disso, um conjunto simples de interfaces baseadas em COM é fornecido para habilitar a mesma experiência integrada para aplicativos que optam por usar controles de preenchimento automático personalizados.</span><span class="sxs-lookup"><span data-stu-id="b8dd1-225">Furthermore, a simple set of COM-based interfaces are provided to enable the same integrated experience for applications that choose to use custom Autocomplete controls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b8dd1-226">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="b8dd1-226">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b8dd1-227">Referência do painel de entrada de texto</span><span class="sxs-lookup"><span data-stu-id="b8dd1-227">Text Input Panel Reference</span></span>](text-input-panel-reference.md)
</dt> </dl>

 

 
