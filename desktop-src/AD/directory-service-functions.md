---
title: Funções de serviço de diretório (AD DS)
description: As funções de serviço de diretório fornecem um utilitário para localizar um controlador de domínio (DC) em um domínio do Windows NT ou do Windows 2000.
ms.assetid: 7b519c81-5a6c-470a-a525-1894efd53305
ms.tgt_platform: multiple
keywords:
- Funções de serviço de diretório
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 75b071128806926e07cf61d62e53b823d8e7e1ac
ms.sourcegitcommit: 8ea1a82717bd3dbb3457be0697329aa37fb13f08
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/11/2019
ms.locfileid: "104007003"
---
# <a name="directory-service-functions-ad-ds"></a><span data-ttu-id="756d7-104">Funções de serviço de diretório (AD DS)</span><span class="sxs-lookup"><span data-stu-id="756d7-104">Directory Service Functions (AD DS)</span></span>

<span data-ttu-id="756d7-105">As funções de serviço de diretório fornecem um utilitário para localizar um controlador de domínio (DC) em um domínio do Windows NT ou do Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="756d7-105">The directory service functions provide a utility for locating a domain controller (DC) in a Windows NT or Windows 2000 domain.</span></span> <span data-ttu-id="756d7-106">A arquitetura interage com clientes, bem como com servidores em todas as versões do Windows NT e do Windows 2000.</span><span class="sxs-lookup"><span data-stu-id="756d7-106">The architecture interacts with clients as well as servers in all versions of Windows NT and Windows 2000.</span></span> <span data-ttu-id="756d7-107">As funções a seguir permitem que os desenvolvedores trabalhem com o controlador de domínio e a associação de domínio no serviço de diretório:</span><span class="sxs-lookup"><span data-stu-id="756d7-107">The following functions enable developers to work with the domain controller and domain membership in the directory service:</span></span>

-   [<span data-ttu-id="756d7-108">**DsAddressToSiteNames**</span><span class="sxs-lookup"><span data-stu-id="756d7-108">**DsAddressToSiteNames**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsaddresstositenamesa)
-   [<span data-ttu-id="756d7-109">**DsAddressToSiteNamesEx**</span><span class="sxs-lookup"><span data-stu-id="756d7-109">**DsAddressToSiteNamesEx**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsaddresstositenamesexa)
-   [<span data-ttu-id="756d7-110">**DsDeregisterDnsHostRecords**</span><span class="sxs-lookup"><span data-stu-id="756d7-110">**DsDeregisterDnsHostRecords**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsderegisterdnshostrecordsa)
-   [<span data-ttu-id="756d7-111">**DsEnumerateDomainTrusts**</span><span class="sxs-lookup"><span data-stu-id="756d7-111">**DsEnumerateDomainTrusts**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsenumeratedomaintrustsa)
-   [<span data-ttu-id="756d7-112">**DsGetDcClose**</span><span class="sxs-lookup"><span data-stu-id="756d7-112">**DsGetDcClose**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetdcclosew)
-   [<span data-ttu-id="756d7-113">**DsGetDcName**</span><span class="sxs-lookup"><span data-stu-id="756d7-113">**DsGetDcName**</span></span>](/windows/desktop/api/DsGetDC/nf-dsgetdc-dsgetdcnamea)
-   [<span data-ttu-id="756d7-114">**DsGetDcNext**</span><span class="sxs-lookup"><span data-stu-id="756d7-114">**DsGetDcNext**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetdcnexta)
-   [<span data-ttu-id="756d7-115">**DsGetDcOpen**</span><span class="sxs-lookup"><span data-stu-id="756d7-115">**DsGetDcOpen**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetdcopena)
-   [<span data-ttu-id="756d7-116">**DsGetDcSiteCoverage**</span><span class="sxs-lookup"><span data-stu-id="756d7-116">**DsGetDcSiteCoverage**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetdcsitecoveragea)
-   [<span data-ttu-id="756d7-117">**DsGetForestTrustInformationW**</span><span class="sxs-lookup"><span data-stu-id="756d7-117">**DsGetForestTrustInformationW**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetforesttrustinformationw)
-   [<span data-ttu-id="756d7-118">**DsGetSiteName**</span><span class="sxs-lookup"><span data-stu-id="756d7-118">**DsGetSiteName**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetsitenamea)
-   [<span data-ttu-id="756d7-119">**DsMergeForestTrustInformationW**</span><span class="sxs-lookup"><span data-stu-id="756d7-119">**DsMergeForestTrustInformationW**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsmergeforesttrustinformationw)
-   [<span data-ttu-id="756d7-120">**DsRoleFreeMemory**</span><span class="sxs-lookup"><span data-stu-id="756d7-120">**DsRoleFreeMemory**</span></span>](/windows/desktop/api/Dsrole/nf-dsrole-dsrolefreememory)
-   [<span data-ttu-id="756d7-121">**DsRoleGetPrimaryDomainInformation**</span><span class="sxs-lookup"><span data-stu-id="756d7-121">**DsRoleGetPrimaryDomainInformation**</span></span>](/windows/desktop/api/Dsrole/nf-dsrole-dsrolegetprimarydomaininformation)
-   [<span data-ttu-id="756d7-122">**DsValidateSubnetName**</span><span class="sxs-lookup"><span data-stu-id="756d7-122">**DsValidateSubnetName**</span></span>](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsvalidatesubnetnamea)

<span data-ttu-id="756d7-123">O localizador de DC, [**DsGetDcName**](/windows/desktop/api/DsGetDC/nf-dsgetdc-dsgetdcnamea), é implementado pelo serviço Netlogon.</span><span class="sxs-lookup"><span data-stu-id="756d7-123">The DC locator, [**DsGetDcName**](/windows/desktop/api/DsGetDC/nf-dsgetdc-dsgetdcnamea), is implemented by the Netlogon service.</span></span> <span data-ttu-id="756d7-124">Cada DC registra seu nome DNS no servidor DNS e seu nome NetBIOS usando um mecanismo específico de transporte, por exemplo, no WINS.</span><span class="sxs-lookup"><span data-stu-id="756d7-124">Each DC registers its DNS name on the DNS server and its NetBIOS name using a transport-specific mechanism, for example, in WINS.</span></span> <span data-ttu-id="756d7-125">O localizador de DC pesquisa o nome e, em seguida, envia um datagrama para, ou pings, o DC que registrou o nome.</span><span class="sxs-lookup"><span data-stu-id="756d7-125">The DC locator looks up the name, then sends a datagram to, or pings, the DC that registered the name.</span></span> <span data-ttu-id="756d7-126">Para nomes de domínio NetBIOS, o datagrama é uma mensagem do processador de mensagens.</span><span class="sxs-lookup"><span data-stu-id="756d7-126">For NetBIOS domain names, the datagram is a mailslot message.</span></span> <span data-ttu-id="756d7-127">Para nomes de domínio DNS, o datagrama é uma pesquisa LDAP UDP.</span><span class="sxs-lookup"><span data-stu-id="756d7-127">For DNS domain names, the datagram is an LDAP UDP search.</span></span> <span data-ttu-id="756d7-128">Cada DC responde indicando que ele está operacional no momento.</span><span class="sxs-lookup"><span data-stu-id="756d7-128">Each such DC responds indicating that it is currently operational.</span></span> <span data-ttu-id="756d7-129">O primeiro DC a responder é retornado ao chamador.</span><span class="sxs-lookup"><span data-stu-id="756d7-129">The first DC to respond is returned to the caller.</span></span>

<span data-ttu-id="756d7-130">O DC retornado é armazenado em cache, para que os chamadores subsequentes não precisem repetir o algoritmo anterior e para encorajar todos os chamadores a usarem o mesmo DC.</span><span class="sxs-lookup"><span data-stu-id="756d7-130">The returned DC is cached, so that subsequent callers need not repeat the preceding algorithm, and to encourage all callers to use that same DC.</span></span> <span data-ttu-id="756d7-131">Isso garante que um único cliente tenha uma exibição consistente do conteúdo do controlador de domínio.</span><span class="sxs-lookup"><span data-stu-id="756d7-131">This ensures that a single client has a consistent view of the contents of the DC.</span></span>

<span data-ttu-id="756d7-132">Ao procurar um DC pelo nome de domínio DNS, o localizador de DC tenta encontrar um DC no site "mais próximo".</span><span class="sxs-lookup"><span data-stu-id="756d7-132">When searching for a DC by DNS domain name, the DC locator attempts to find a DC in the "closest" site.</span></span> <span data-ttu-id="756d7-133">Cada DC registra registros DNS adicionais que indicam em qual site o controlador de domínio está e quais sites o DC inclui.</span><span class="sxs-lookup"><span data-stu-id="756d7-133">Each DC registers additional DNS records indicating what site that the DC is in and what sites the DC includes.</span></span> <span data-ttu-id="756d7-134">O localizador de DC procura primeiro esse registro DNS específico do site antes de Pesquisar o registro DNS que não seja específico do site, preferindo assim um controlador de domínio nesse site.</span><span class="sxs-lookup"><span data-stu-id="756d7-134">The DC locator first searches for this site-specific DNS record before searching for the DNS record that is not site-specific, thus preferring a DC in that site.</span></span> <span data-ttu-id="756d7-135">Quando o localizador de DC envia um datagrama para o DC, o DC procura o endereço IP do cliente no contêiner de configuração/sites/sub-rede do DS para localizar um objeto de sub-rede.</span><span class="sxs-lookup"><span data-stu-id="756d7-135">When the DC locator sends a datagram to the DC, the DC looks up the IP address of the client in the Configuration/Sites/Subnet container of the DS to find a subnet object.</span></span> <span data-ttu-id="756d7-136">A propriedade **siteobject** do objeto subnet define o nome do site que contém o cliente.</span><span class="sxs-lookup"><span data-stu-id="756d7-136">The **siteObject** property of the subnet object defines the name of the site that contains the client.</span></span> <span data-ttu-id="756d7-137">O DC responde ao ping com o nome do site que contém o cliente, juntamente com um indicador de se esse controlador de domínio cobre esse site.</span><span class="sxs-lookup"><span data-stu-id="756d7-137">The DC responds to the ping with the name of the site that contains the client, along with an indicator of whether this DC covers that site.</span></span> <span data-ttu-id="756d7-138">Se o controlador de domínio não incluir esse site e o localizador de DC ainda não tiver tentado localizar um controlador de domínio nesse site, o localizador de DC tentará novamente localizar um controlador de domínio no site.</span><span class="sxs-lookup"><span data-stu-id="756d7-138">If the DC does not include that site and the DC locator has not yet attempted to find a DC in that site, the DC locator tries again to find a DC in the site.</span></span>

<span data-ttu-id="756d7-139">Para localizar o nome do site que contém o cliente, use a função [**DsGetSiteName**](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetsitenamea) .</span><span class="sxs-lookup"><span data-stu-id="756d7-139">To find the name of the site containing the client, use the [**DsGetSiteName**](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsgetsitenamea) function.</span></span> <span data-ttu-id="756d7-140">Os nomes dos objetos no contêiner de configuração/sites/sub-rede devem ser nomes de sub-rede válidos.</span><span class="sxs-lookup"><span data-stu-id="756d7-140">The names of the objects in the Configuration/Sites/Subnet container must be valid subnet names.</span></span> <span data-ttu-id="756d7-141">A função [**DsValidateSubnetName**](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsvalidatesubnetnamea) indica se um nome de sub-rede especificado é válido.</span><span class="sxs-lookup"><span data-stu-id="756d7-141">The [**DsValidateSubnetName**](/windows/desktop/api/Dsgetdc/nf-dsgetdc-dsvalidatesubnetnamea) function indicates whether a specified subnet name is valid.</span></span>

 

 




