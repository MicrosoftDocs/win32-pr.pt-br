---
title: Sondando alterações usando o controle DirSync
description: Active Directory controle de sincronização de diretório (DirSync) é uma extensão de servidor LDAP que permite que um aplicativo pesquise uma partição de diretório para objetos que foram alterados desde um estado anterior.
ms.assetid: f77caeb3-bfc9-4ae6-8d1d-73f4ee554336
ms.tgt_platform: multiple
keywords:
- Sondando alterações usando o AD do controle DirSync
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8c3d105757d39bc25bd10df21ab68c4d1d1202be
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "103640392"
---
# <a name="polling-for-changes-using-the-dirsync-control"></a><span data-ttu-id="71adb-104">Sondando alterações usando o controle DirSync</span><span class="sxs-lookup"><span data-stu-id="71adb-104">Polling for Changes Using the DirSync Control</span></span>

<span data-ttu-id="71adb-105">Active Directory controle de sincronização de diretório (DirSync) é uma extensão de servidor LDAP que permite que um aplicativo pesquise uma partição de diretório para objetos que foram alterados desde um estado anterior.</span><span class="sxs-lookup"><span data-stu-id="71adb-105">Active Directory directory synchronization (DirSync) control is an LDAP server extension that enables an application to search an directory partition for objects that have changed since a previous state.</span></span>

<span data-ttu-id="71adb-106">Use o controle DirSync por meio da ADSI especificando a preferência de pesquisa **\_ \_ DirSync do ADS SEARCHPREF** ao usar o [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch).</span><span class="sxs-lookup"><span data-stu-id="71adb-106">Use the DirSync control through ADSI by specifying the **ADS\_SEARCHPREF\_DIRSYNC** search preference when using [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch).</span></span> <span data-ttu-id="71adb-107">Para obter mais informações e um exemplo de código, consulte [código de exemplo usando o ADS \_ SEARCHPREF \_ DirSync](example-code-using-ads-searchpref-dirsync.md).</span><span class="sxs-lookup"><span data-stu-id="71adb-107">For more information and a code example, see [Example Code Using ADS\_SEARCHPREF\_DIRSYNC](example-code-using-ads-searchpref-dirsync.md).</span></span> <span data-ttu-id="71adb-108">Você também pode executar uma pesquisa DirSync usando a API LDAP.</span><span class="sxs-lookup"><span data-stu-id="71adb-108">You can also perform a DirSync search using the LDAP API.</span></span> <span data-ttu-id="71adb-109">A seguir, a descrição da implementação de ADSI, a maioria das quais também se aplica ao uso do LDAP diretamente, exceto como discutido no final deste tópico.</span><span class="sxs-lookup"><span data-stu-id="71adb-109">The following describes the ADSI implementation, most of which also applies to using LDAP directly, except as discussed at the end of this topic.</span></span>

<span data-ttu-id="71adb-110">Ao executar uma pesquisa do DirSync, você passa um elemento de dados específico do provedor (cookie) que identifica o estado do diretório no momento da pesquisa do DirSync anterior.</span><span class="sxs-lookup"><span data-stu-id="71adb-110">When you perform a DirSync search, you pass in a provider-specific data element (cookie) that identifies the directory state at the time of the previous DirSync search.</span></span> <span data-ttu-id="71adb-111">Para a primeira pesquisa, você passa um cookie nulo e a pesquisa retorna todos os objetos que correspondem ao filtro.</span><span class="sxs-lookup"><span data-stu-id="71adb-111">For the first search, you pass in a null cookie, and the search returns all objects that match the filter.</span></span> <span data-ttu-id="71adb-112">A pesquisa também retorna um cookie válido.</span><span class="sxs-lookup"><span data-stu-id="71adb-112">The search also returns a valid cookie.</span></span> <span data-ttu-id="71adb-113">Armazene o cookie no mesmo armazenamento que você está sincronizando com o servidor de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="71adb-113">Store the cookie in the same storage that you are synchronizing with the Active Directory server.</span></span> <span data-ttu-id="71adb-114">Em pesquisas subsequentes, obtenha o cookie do armazenamento e passe-o com a solicitação de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="71adb-114">On subsequent searches, get the cookie from storage and pass it with the search request.</span></span> <span data-ttu-id="71adb-115">Os resultados da pesquisa agora incluem apenas os objetos e atributos que foram alterados desde o estado anterior identificado pelo cookie.</span><span class="sxs-lookup"><span data-stu-id="71adb-115">The search results now include only the objects and attributes that have changed since the previous state identified by the cookie.</span></span> <span data-ttu-id="71adb-116">A pesquisa também retorna um novo cookie a ser armazenado para a próxima pesquisa.</span><span class="sxs-lookup"><span data-stu-id="71adb-116">The search also returns a new cookie to store for the next search.</span></span>

<span data-ttu-id="71adb-117">A tabela a seguir lista os parâmetros de pesquisa que a solicitação de pesquisa do cliente pode especificar.</span><span class="sxs-lookup"><span data-stu-id="71adb-117">The following table lists search parameters that the client search request can specify.</span></span>



| <span data-ttu-id="71adb-118">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="71adb-118">Parameter</span></span>          | <span data-ttu-id="71adb-119">Descrição</span><span class="sxs-lookup"><span data-stu-id="71adb-119">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|--------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="71adb-120">Base da pesquisa</span><span class="sxs-lookup"><span data-stu-id="71adb-120">Base of the search</span></span> | <span data-ttu-id="71adb-121">A base de uma pesquisa DirSync deve ser a raiz de uma partição de diretório, que pode ser uma partição de domínio, a partição de configuração ou a partição de esquema.</span><span class="sxs-lookup"><span data-stu-id="71adb-121">The base of a DirSync search must be the root of a directory partition, which can be a domain partition, the configuration partition, or the schema partition.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="71adb-122">Escopo</span><span class="sxs-lookup"><span data-stu-id="71adb-122">Scope</span></span>              | <span data-ttu-id="71adb-123">O escopo de uma pesquisa DirSync deve ser **a \_ \_ subárvore de escopo ADS**, ou seja, toda a subárvore da partição.</span><span class="sxs-lookup"><span data-stu-id="71adb-123">The scope of a DirSync search must be **ADS\_SCOPE\_SUBTREE**, that is, the entire subtree of the partition.</span></span> <span data-ttu-id="71adb-124">Lembre-se de que, para uma pesquisa de uma partição de domínio, a subárvore inclui os cabeçalhos, mas não o conteúdo, da configuração e das partições de esquema.</span><span class="sxs-lookup"><span data-stu-id="71adb-124">Be aware that for a search of a domain partition, the subtree includes the heads, but not the contents, of the configuration and schema partitions.</span></span> <span data-ttu-id="71adb-125">Para pesquisar alterações em um escopo menor, use a técnica **USNChanged** em vez de DirSync.</span><span class="sxs-lookup"><span data-stu-id="71adb-125">To poll for changes in a smaller scope, use the **USNChanged** technique instead of DirSync.</span></span>                                                                                                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="71adb-126">Filtrar</span><span class="sxs-lookup"><span data-stu-id="71adb-126">Filter</span></span>             | <span data-ttu-id="71adb-127">Você pode especificar qualquer filtro de pesquisa válido.</span><span class="sxs-lookup"><span data-stu-id="71adb-127">You can specify any valid search filter.</span></span> <span data-ttu-id="71adb-128">Para uma pesquisa inicial com um cookie nulo, os resultados incluem todos os objetos que correspondem ao filtro.</span><span class="sxs-lookup"><span data-stu-id="71adb-128">For an initial search with a null cookie, the results include all objects that match the filter.</span></span> <span data-ttu-id="71adb-129">Para pesquisas subsequentes com um cookie válido, os resultados da pesquisa incluem dados somente para objetos que correspondam ao filtro e foram alterados desde o estado indicado pelo cookie.</span><span class="sxs-lookup"><span data-stu-id="71adb-129">For subsequent searches with a valid cookie, the search results include data only for objects that match the filter and have changed since the state indicated by the cookie.</span></span> <span data-ttu-id="71adb-130">Para obter mais informações sobre filtros de pesquisa, consulte [criando um filtro de consulta](creating-a-query-filter.md).</span><span class="sxs-lookup"><span data-stu-id="71adb-130">For more information about search filters, see [Creating a Query Filter](creating-a-query-filter.md).</span></span>                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="71adb-131">Atributos</span><span class="sxs-lookup"><span data-stu-id="71adb-131">Attributes</span></span>         | <span data-ttu-id="71adb-132">Você pode especificar uma lista de atributos a serem retornados quando ocorrer uma alteração.</span><span class="sxs-lookup"><span data-stu-id="71adb-132">You can specify a list of attributes to be returned when a change occurs.</span></span> <span data-ttu-id="71adb-133">Para cada objeto, os resultados iniciais incluem todos os atributos solicitados definidos no objeto.</span><span class="sxs-lookup"><span data-stu-id="71adb-133">For each object, the initial results include all the requested attributes set on the object.</span></span> <span data-ttu-id="71adb-134">Os resultados da pesquisa subsequentes incluem apenas os atributos especificados que foram alterados.</span><span class="sxs-lookup"><span data-stu-id="71adb-134">Subsequent search results include only the specified attributes that have changed.</span></span> <span data-ttu-id="71adb-135">Os atributos inalterados não são incluídos nos resultados da pesquisa.</span><span class="sxs-lookup"><span data-stu-id="71adb-135">Unchanged attributes are not included in the search results.</span></span> <span data-ttu-id="71adb-136">Na implementação do ADSI, os resultados da pesquisa sempre incluem o **objectGUID** e o **InstanceType** de cada objeto.</span><span class="sxs-lookup"><span data-stu-id="71adb-136">In the ADSI implementation, the search results always include the **objectGUID** and **instanceType** of each object.</span></span> <span data-ttu-id="71adb-137">Além disso, a lista de atributos especificada atua como um filtro adicional: os resultados da pesquisa inicial incluem apenas objetos que tenham pelo menos um dos atributos especificados definidos; as pesquisas subsequentes incluem apenas objetos dos quais um ou mais atributos foram alterados (valores adicionados ou excluídos).</span><span class="sxs-lookup"><span data-stu-id="71adb-137">Also, the specified attribute list acts as an additional filter: the initial search results include only objects that have at least one of the specified attributes set; subsequent searches include only objects on which one or more of the attributes have changed (values added or deleted).</span></span> |



 

<span data-ttu-id="71adb-138">Além disso, lembre-se de que:</span><span class="sxs-lookup"><span data-stu-id="71adb-138">Also, be aware that:</span></span>

-   <span data-ttu-id="71adb-139">Para pesquisas incrementais, a prática recomendada é associar-se ao mesmo controlador de domínio (DC) usado na pesquisa anterior, ou seja, o DC que gerou o cookie.</span><span class="sxs-lookup"><span data-stu-id="71adb-139">For incremental searches, the best practice is to bind to the same domain controller (DC) used in the previous search, that is, the DC that generated the cookie.</span></span> <span data-ttu-id="71adb-140">Se o mesmo DC não estiver disponível, aguarde até que ele seja ou associe a um novo DC e execute uma sincronização completa.</span><span class="sxs-lookup"><span data-stu-id="71adb-140">If the same DC is unavailable, either wait until it is, or bind to a new DC and perform a full synchronization.</span></span> <span data-ttu-id="71adb-141">Armazene o nome DNS do controlador de domínio no armazenamento secundário com o cookie.</span><span class="sxs-lookup"><span data-stu-id="71adb-141">Store the DNS name of the DC in the secondary storage with the cookie.</span></span>

    <span data-ttu-id="71adb-142">Você pode passar um cookie gerado por um DC para um controlador de domínio diferente que hospeda uma réplica da mesma partição de diretório.</span><span class="sxs-lookup"><span data-stu-id="71adb-142">You can pass a cookie generated by one DC to a different DC hosting a replica of the same directory partition.</span></span> <span data-ttu-id="71adb-143">Não há nenhuma chance de um cliente perder as alterações usando um cookie de um DC em outro DC.</span><span class="sxs-lookup"><span data-stu-id="71adb-143">There is no chance that a client will miss changes by using a cookie from one DC on another DC.</span></span> <span data-ttu-id="71adb-144">No entanto, é possível que os resultados da pesquisa do novo DC possam incluir alterações relatadas pelo controlador de domínio antigo; em alguns casos, o novo DC pode retornar todos os objetos e atributos, assim como ocorre com uma sincronização completa.</span><span class="sxs-lookup"><span data-stu-id="71adb-144">However, it is possible that the search results from the new DC may include reported changes by the old DC; in some cases, the new DC may return all objects and attributes, as with a full synchronization.</span></span> <span data-ttu-id="71adb-145">O cliente deve apenas tornar seu banco de dados consistente com os resultados de pesquisa relatados para qualquer chamada DirSync fornecida, ou seja, tratar todos os resultados incrementais como se fossem o estado mais recente.</span><span class="sxs-lookup"><span data-stu-id="71adb-145">The client should just make its database consistent with reported search results for any given DirSync call, that is, handle all incremental results as if they were the latest state.</span></span> <span data-ttu-id="71adb-146">Não importa se você viu a alteração antes ou se está até voltando para um estado anterior porque as sincronizações incrementais repetidas convergirão na consistência.</span><span class="sxs-lookup"><span data-stu-id="71adb-146">It does not matter whether you have seen the change before or are even going back to a previous state because repeated incremental synchronizations will converge on consistency.</span></span>

-   <span data-ttu-id="71adb-147">Quando um objeto é renomeado ou movido, seus objetos filho, se houver, não são incluídos nos resultados da pesquisa, embora os nomes distintos dos objetos filho tenham mudado.</span><span class="sxs-lookup"><span data-stu-id="71adb-147">When an object is renamed or moved, its child objects, if any, are not included in the search results, even though the distinguished names of the child objects have changed.</span></span> <span data-ttu-id="71adb-148">Da mesma forma, quando uma ACE herdável é modificada em um descritor de segurança de objeto, os objetos filho do objeto não são incluídos nos resultados da pesquisa, mesmo que os descritores de segurança dos objetos filho tenham mudado.</span><span class="sxs-lookup"><span data-stu-id="71adb-148">Similarly, when an inheritable ACE is modified in an object security-descriptor, the child objects of the object are not included in the search results, even though the security-descriptors of the child objects have changed.</span></span>
-   <span data-ttu-id="71adb-149">Use o atributo **objectGUID** para identificar os objetos rastreados.</span><span class="sxs-lookup"><span data-stu-id="71adb-149">Use the **objectGUID** attribute to identify the tracked objects.</span></span> <span data-ttu-id="71adb-150">O **objectGUID** de cada objeto permanece inalterado, independentemente de onde o objeto é movido dentro da floresta.</span><span class="sxs-lookup"><span data-stu-id="71adb-150">The **objectGUID** of each object remains unchanged regardless of where the object is moved within the forest.</span></span>
-   <span data-ttu-id="71adb-151">Lembre-se de que os resultados da pesquisa de uma pesquisa do DirSync indicam o estado dos objetos em uma réplica da partição de diretório no momento da pesquisa.</span><span class="sxs-lookup"><span data-stu-id="71adb-151">Be aware that the search results of a DirSync search indicate the state of the objects on a replica of the directory partition at the time of the search.</span></span> <span data-ttu-id="71adb-152">Isso significa que as alterações feitas em outros DCs não serão incluídas se não tiverem sido replicadas no controlador de domínio de destino.</span><span class="sxs-lookup"><span data-stu-id="71adb-152">This means that changes made on other DCs will not be included if they have not been replicated to the target DC.</span></span> <span data-ttu-id="71adb-153">Isso também significa que os atributos de um objeto podem ter mudado várias vezes desde a pesquisa do DirSync anterior, mas a pesquisa mostrará apenas o estado final, não a sequência de alterações.</span><span class="sxs-lookup"><span data-stu-id="71adb-153">It also means that an object's attributes may have changed several times since the previous DirSync search, but the search will show only the final state, not the sequence of changes.</span></span>
-   <span data-ttu-id="71adb-154">Na implementação do ADSI, o aplicativo deve tratar o cookie como opaco e não fazer suposições sobre sua organização ou valor interno.</span><span class="sxs-lookup"><span data-stu-id="71adb-154">In the ADSI implementation, the application must handle the cookie as opaque and not make any assumptions about its internal organization or value.</span></span>
-   <span data-ttu-id="71adb-155">Lembre-se de que o cliente armazena o cookie, o comprimento do cookie e o nome DNS do controlador de domínio no mesmo armazenamento que contém os dados do objeto sincronizado.</span><span class="sxs-lookup"><span data-stu-id="71adb-155">Be aware that the client stores the cookie, cookie length, and DNS name of the DC in the same storage that contains the synchronized object data.</span></span> <span data-ttu-id="71adb-156">Isso garante que o cookie e outros parâmetros permaneçam sincronizados com os dados do objeto se o armazenamento for restaurado de um backup.</span><span class="sxs-lookup"><span data-stu-id="71adb-156">This ensures that the cookie and other parameters remain in sync with the object data if the storage is ever restored from a backup.</span></span>
-   <span data-ttu-id="71adb-157">Para recuperar o atributo [**parentGUID**](/windows/desktop/ADSchema/a-parentguid) , que é construído para o controle DirSync, também é necessário solicitar o atributo [**Name**](/windows/desktop/ADSchema/a-name) .</span><span class="sxs-lookup"><span data-stu-id="71adb-157">To retrieve the [**parentGUID**](/windows/desktop/ADSchema/a-parentguid) attribute, which is constructed for the DirSync control, it is also necessary to request the [**name**](/windows/desktop/ADSchema/a-name) attribute.</span></span>

<span data-ttu-id="71adb-158">Para usar o controle DirSync, o chamador deve ter o direito "diretório obter alterações" atribuído na raiz da partição que está sendo monitorada.</span><span class="sxs-lookup"><span data-stu-id="71adb-158">To use the DirSync control, caller must have the "directory get changes" right assigned on the root of the partition being monitored.</span></span> <span data-ttu-id="71adb-159">Por padrão, esse direito é atribuído às contas de administrador e LocalSystem em controladores de domínio.</span><span class="sxs-lookup"><span data-stu-id="71adb-159">By default, this right is assigned to the Administrator and LocalSystem accounts on domain controllers.</span></span> <span data-ttu-id="71adb-160">O chamador também deve ter o direito de acesso de controle estendido [**DS-Replication-Get-Changes**](/windows/desktop/ADSchema/r-ds-replication-get-changes) .</span><span class="sxs-lookup"><span data-stu-id="71adb-160">The caller must also have the [**DS-Replication-Get-Changes**](/windows/desktop/ADSchema/r-ds-replication-get-changes) extended control access right.</span></span> <span data-ttu-id="71adb-161">Para obter mais informações sobre como implementar um mecanismo de controle de alterações para aplicativos que devem ser executados em uma conta que não tem esse direito, consulte [sondando alterações usando USNChanged](polling-for-changes-using-usnchanged.md).</span><span class="sxs-lookup"><span data-stu-id="71adb-161">For more information about implementing a change-tracking mechanism for applications that must run under an account that does not have this right, see [Polling for Changes Using USNChanged](polling-for-changes-using-usnchanged.md).</span></span> <span data-ttu-id="71adb-162">Para obter mais informações sobre privilégios, consulte [privilégios](/windows/desktop/SecAuthZ/privileges).</span><span class="sxs-lookup"><span data-stu-id="71adb-162">For more information about privileges, see [Privileges](/windows/desktop/SecAuthZ/privileges).</span></span>

## <a name="retrieving-deleted-objects-with-a-dirsync-search"></a><span data-ttu-id="71adb-163">Recuperando objetos excluídos com uma pesquisa DirSync</span><span class="sxs-lookup"><span data-stu-id="71adb-163">Retrieving Deleted Objects With a DirSync Search</span></span>

<span data-ttu-id="71adb-164">Os resultados da pesquisa do **\_ SEARCHPREF \_ DirSync de anúncios** incluem automaticamente os objetos excluídos (marcas para exclusão) que correspondem ao filtro de pesquisa especificado.</span><span class="sxs-lookup"><span data-stu-id="71adb-164">The **ADS\_SEARCHPREF\_DIRSYNC** search results automatically include deleted objects (tombstones) that match the specified search filter.</span></span> <span data-ttu-id="71adb-165">No entanto, um filtro de pesquisa que corresponderá a um objeto quando ele estiver ativo pode não corresponder ao objeto depois que ele for excluído.</span><span class="sxs-lookup"><span data-stu-id="71adb-165">However, a search filter that will match an object when it is live may not match the object after it is deleted.</span></span> <span data-ttu-id="71adb-166">Isso ocorre porque as marcas para exclusão retêm apenas um subconjunto dos atributos presentes no objeto original.</span><span class="sxs-lookup"><span data-stu-id="71adb-166">This is because tombstones retain only a subset of the attributes present on the original object.</span></span> <span data-ttu-id="71adb-167">Por exemplo, normalmente você usaria o filtro a seguir para objetos de usuário.</span><span class="sxs-lookup"><span data-stu-id="71adb-167">For example, you would typically use the following filter for user objects.</span></span>


```C++
(&(objectClass=user)(objectCategory=person))
```



<span data-ttu-id="71adb-168">O atributo **objectCategory** é removido quando um objeto é excluído, portanto, o filtro acima não corresponderia a quaisquer objetos de marca para exclusão.</span><span class="sxs-lookup"><span data-stu-id="71adb-168">The **objectCategory** attribute is removed when an object is deleted, so the filter above would not match any tombstone objects.</span></span> <span data-ttu-id="71adb-169">Por outro lado, o atributo **objectClass** é retido em objetos de marca para exclusão, de modo que um filtro de "(objectClass = user)" corresponderá a objetos de usuário excluídos.</span><span class="sxs-lookup"><span data-stu-id="71adb-169">Conversely, the **objectClass** attribute is retained on tombstone objects, so a filter of "(objectClass=user)" would match deleted user objects.</span></span>

<span data-ttu-id="71adb-170">A lista de atributos que você especifica com uma pesquisa DirSync também atua como um filtro; os resultados da pesquisa incluem apenas objetos nos quais um ou mais dos atributos especificados foram alterados desde a pesquisa do DirSync anterior.</span><span class="sxs-lookup"><span data-stu-id="71adb-170">The attribute list that you specify with a DirSync search also acts as a filter; search results include only objects on which one or more of the specified attributes have changed since the previous DirSync search.</span></span> <span data-ttu-id="71adb-171">Se a lista de atributos não incluir atributos que são retidos em marcas de exclusão, os resultados da pesquisa não incluirão marcas de exclusão.</span><span class="sxs-lookup"><span data-stu-id="71adb-171">If the attribute list does not include any attributes that are retained on tombstones, the search results will not include tombstones.</span></span> <span data-ttu-id="71adb-172">Para lidar com isso, solicite todos os atributos especificando uma lista de atributos nulos; ou você pode solicitar o atributo **IsDeleted** , definido como **true** em todas as marcas para exclusão.</span><span class="sxs-lookup"><span data-stu-id="71adb-172">To handle this, request all attributes by specifying a null attribute list; or you can request the **isDeleted** attribute, set to **TRUE** on all tombstones.</span></span> <span data-ttu-id="71adb-173">Os atributos de marca para exclusão têm o bit 0x8 definido no atributo **searchFlags** da definição **attributeSchema** .</span><span class="sxs-lookup"><span data-stu-id="71adb-173">Tombstone attributes have the 0x8 bit set in the **searchFlags** attribute of the **attributeSchema** definition.</span></span>

<span data-ttu-id="71adb-174">Para obter mais informações, consulte [recuperando objetos excluídos](retrieving-deleted-objects.md).</span><span class="sxs-lookup"><span data-stu-id="71adb-174">For more information, see [Retrieving Deleted Objects](retrieving-deleted-objects.md).</span></span>

## <a name="ldap-implementation-of-the-dirsync-control"></a><span data-ttu-id="71adb-175">Implementação de LDAP do controle DirSync</span><span class="sxs-lookup"><span data-stu-id="71adb-175">LDAP Implementation of the DirSync Control</span></span>

<span data-ttu-id="71adb-176">Você também pode executar uma pesquisa DirSync usando a API LDAP com o controle [ \_ \_ \_ OID do servidor LDAP](/previous-versions/windows/desktop/ldap/ldap-server-dirsync-oid) .</span><span class="sxs-lookup"><span data-stu-id="71adb-176">You can also perform a DirSync search by using the LDAP API with the [LDAP\_SERVER\_DIRSYNC\_OID](/previous-versions/windows/desktop/ldap/ldap-server-dirsync-oid) control.</span></span> <span data-ttu-id="71adb-177">Se você usar a API LDAP, especifique também o [ \_ \_ \_ \_ OID DN estendido do servidor LDAP](/previous-versions/windows/desktop/ldap/ldap-server-extended-dn-oid) e o [ \_ servidor LDAP mostrar controles \_ \_ \_ OID excluídos](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) .</span><span class="sxs-lookup"><span data-stu-id="71adb-177">If you use the LDAP API, also specify the [LDAP\_SERVER\_EXTENDED\_DN\_OID](/previous-versions/windows/desktop/ldap/ldap-server-extended-dn-oid) and [LDAP\_SERVER\_SHOW\_DELETED\_OID](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) controls.</span></span> <span data-ttu-id="71adb-178">O \_ \_ controle OID do DN estendido do servidor LDAP \_ \_ faz com que uma pesquisa LDAP retorne uma forma estendida do nome distinto que inclui o **objectGUID** e o **objectSid** para objetos de entidade de segurança, como usuários, grupos e computadores.</span><span class="sxs-lookup"><span data-stu-id="71adb-178">The LDAP\_SERVER\_EXTENDED\_DN\_OID control causes an LDAP search to return an extended form of the distinguished name that includes the **objectGUID** and **objectSID** for security principal objects such as users, groups, and computers.</span></span> <span data-ttu-id="71adb-179">O \_ servidor LDAP \_ Mostrar \_ \_ controle de OID excluído faz com que os resultados da pesquisa incluam dados para objetos excluídos.</span><span class="sxs-lookup"><span data-stu-id="71adb-179">The LDAP\_SERVER\_SHOW\_DELETED\_OID control causes the search results to include data for deleted objects.</span></span> <span data-ttu-id="71adb-180">Lembre-se de que esses controles são incluídos automaticamente na implementação do ADSI.</span><span class="sxs-lookup"><span data-stu-id="71adb-180">Be aware that these controls are automatically included in the ADSI implementation.</span></span>

 

 