---
title: Sobre contas de logon de serviço
description: Quando um serviço baseado em Win32 é iniciado, ele faz logon no computador local.
ms.assetid: 637ad0c0-118f-43e8-9d21-a93f6886f546
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 328b33d5dab36ccc5a803eb7c43ca3112e96ecf8
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "104084425"
---
# <a name="about-service-logon-accounts"></a><span data-ttu-id="66c8b-103">Sobre contas de logon de serviço</span><span class="sxs-lookup"><span data-stu-id="66c8b-103">About Service Logon Accounts</span></span>

<span data-ttu-id="66c8b-104">Quando um serviço baseado em Win32 é iniciado, ele faz logon no computador local.</span><span class="sxs-lookup"><span data-stu-id="66c8b-104">When a Win32-based service starts, it logs on to the local computer.</span></span> <span data-ttu-id="66c8b-105">Ele pode fazer logon como:</span><span class="sxs-lookup"><span data-stu-id="66c8b-105">It can log on as:</span></span>

-   <span data-ttu-id="66c8b-106">Uma conta de usuário local ou de domínio.</span><span class="sxs-lookup"><span data-stu-id="66c8b-106">A local or domain user account.</span></span>
-   <span data-ttu-id="66c8b-107">A conta LocalSystem.</span><span class="sxs-lookup"><span data-stu-id="66c8b-107">The LocalSystem account.</span></span>

<span data-ttu-id="66c8b-108">A conta de logon determina a identidade de segurança do serviço em tempo de execução, ou seja, o contexto de segurança principal do serviço.</span><span class="sxs-lookup"><span data-stu-id="66c8b-108">The logon account determines the security identity of the service at run time, that is, the service's primary security context.</span></span> <span data-ttu-id="66c8b-109">O contexto de segurança determina a capacidade do serviço de acessar recursos locais e de rede.</span><span class="sxs-lookup"><span data-stu-id="66c8b-109">The security context determines the service's ability to access local and network resources.</span></span> <span data-ttu-id="66c8b-110">Por exemplo, um serviço em execução no contexto de segurança de uma conta de usuário local não pode acessar recursos de rede.</span><span class="sxs-lookup"><span data-stu-id="66c8b-110">For example, a service running in the security context of a local user account cannot access network resources.</span></span> <span data-ttu-id="66c8b-111">Por outro lado, um serviço em execução no contexto de segurança da conta LocalSystem em um controlador de domínio (DC) do Windows 2000 teria acesso irrestrito ao DC.</span><span class="sxs-lookup"><span data-stu-id="66c8b-111">Conversely, a service running in the security context of the LocalSystem account on a Windows 2000 domain controller (DC), would have unrestricted access to the DC.</span></span> <span data-ttu-id="66c8b-112">Para obter mais informações e uma discussão sobre os benefícios e as limitações entre contas de usuário e LocalSystem, consulte [contextos de segurança e Active Directory Domain Services](security-contexts-and-active-directory-domain-services.md).</span><span class="sxs-lookup"><span data-stu-id="66c8b-112">For more information, and a discussion of the benefits and limitations between user accounts and LocalSystem, see [Security Contexts and Active Directory Domain Services](security-contexts-and-active-directory-domain-services.md).</span></span>

<span data-ttu-id="66c8b-113">Por fim, os administradores no sistema em que o serviço está instalado têm controle sobre a conta de logon do serviço.</span><span class="sxs-lookup"><span data-stu-id="66c8b-113">Ultimately, administrators on the system where the service is installed have control over the service's logon account.</span></span> <span data-ttu-id="66c8b-114">Por motivos de segurança, alguns administradores podem não permitir que você instale seu serviço na conta LocalSystem.</span><span class="sxs-lookup"><span data-stu-id="66c8b-114">For security reasons, some administrators may not allow you to install your service under the LocalSystem account.</span></span> <span data-ttu-id="66c8b-115">Seu serviço deve ser capaz de ser executado em uma conta de usuário de domínio.</span><span class="sxs-lookup"><span data-stu-id="66c8b-115">Your service must be able to run under a domain user account.</span></span> <span data-ttu-id="66c8b-116">Como programador, você pode exercer algum controle sobre a conta de logon de seu serviço.</span><span class="sxs-lookup"><span data-stu-id="66c8b-116">As a programmer, you can exercise some control over your service's logon account.</span></span> <span data-ttu-id="66c8b-117">O instalador do serviço especifica a conta de logon do serviço ao chamar a função [**CreateService**](/windows/desktop/api/winsvc/nf-winsvc-createservicea) para instalar o serviço em um computador host.</span><span class="sxs-lookup"><span data-stu-id="66c8b-117">Your service installer specifies the service's logon account when it calls the [**CreateService**](/windows/desktop/api/winsvc/nf-winsvc-createservicea) function to install the service on a host computer.</span></span> <span data-ttu-id="66c8b-118">O instalador pode sugerir uma conta de logon padrão, mas deve permitir que um administrador especifique a conta real.</span><span class="sxs-lookup"><span data-stu-id="66c8b-118">Your installer can suggest a default logon account, but it should allow an administrator to specify the actual account.</span></span>

<span data-ttu-id="66c8b-119">O instalador também pode executar as seguintes tarefas relacionadas à conta de logon do seu serviço:</span><span class="sxs-lookup"><span data-stu-id="66c8b-119">Your installer can also perform the following tasks relating to your service's logon account:</span></span>

-   <span data-ttu-id="66c8b-120">Instalação.</span><span class="sxs-lookup"><span data-stu-id="66c8b-120">Installation.</span></span> <span data-ttu-id="66c8b-121">Se você estiver instalando seu serviço para ser executado em uma conta de usuário, a conta deverá existir antes de você chamar [**CreateService**](/windows/desktop/api/winsvc/nf-winsvc-createservicea).</span><span class="sxs-lookup"><span data-stu-id="66c8b-121">If installing your service to run under a user account, the account must exist before you call [**CreateService**](/windows/desktop/api/winsvc/nf-winsvc-createservicea).</span></span> <span data-ttu-id="66c8b-122">Você pode usar uma conta existente ou criar uma como parte do computador host installrt.</span><span class="sxs-lookup"><span data-stu-id="66c8b-122">You can use an existing account or create one as part of the host-computer installrt.</span></span> <span data-ttu-id="66c8b-123">Para obter mais informações, consulte [Configurando a conta de usuário de um serviço](setting-up-a-serviceampaposs-user-account.md).</span><span class="sxs-lookup"><span data-stu-id="66c8b-123">For more information, see [Setting up a Service's User Account](setting-up-a-serviceampaposs-user-account.md).</span></span>
-   <span data-ttu-id="66c8b-124">Autenticação.</span><span class="sxs-lookup"><span data-stu-id="66c8b-124">Authentication.</span></span> <span data-ttu-id="66c8b-125">Se você quiser que os clientes usem a autenticação mútua Kerberos, registre os SPNs na conta de logon do serviço.</span><span class="sxs-lookup"><span data-stu-id="66c8b-125">If you want clients to use Kerberos mutual authentication, register the SPNs on the service's logon account.</span></span> <span data-ttu-id="66c8b-126">Se o serviço for executado na conta LocalSystem, a conta de logon do serviço será a conta de computador do computador host.</span><span class="sxs-lookup"><span data-stu-id="66c8b-126">If the service runs under the LocalSystem account, the service's logon account is the computer account of the host computer.</span></span> <span data-ttu-id="66c8b-127">Para saber mais, confira [Service Principal Names](service-principal-names.md) (Nomes da entidade de serviço).</span><span class="sxs-lookup"><span data-stu-id="66c8b-127">For more information, see [Service Principal Names](service-principal-names.md).</span></span>
-   <span data-ttu-id="66c8b-128">Conceder acesso.</span><span class="sxs-lookup"><span data-stu-id="66c8b-128">Grant Access.</span></span> <span data-ttu-id="66c8b-129">Verifique se o serviço em tempo de execução tem os direitos de acesso e os privilégios necessários para executar suas tarefas.</span><span class="sxs-lookup"><span data-stu-id="66c8b-129">Ensure that the service at run time has the access rights and privileges that it requires to perform its tasks.</span></span> <span data-ttu-id="66c8b-130">Isso pode exigir a definição de ACEs (entradas de controle de acesso) nos descritores de segurança de vários recursos, que são objetos de diretório, compartilhamentos de arquivos e assim por diante, para permitir os direitos de acesso necessários à conta de usuário ou de computador.</span><span class="sxs-lookup"><span data-stu-id="66c8b-130">This can require setting access-control entries (ACEs) in the security descriptors of various resources, that is directory objects, file shares, and so on, to allow the necessary access rights to the user or computer account.</span></span> <span data-ttu-id="66c8b-131">Para obter mais informações, consulte [concedendo direitos de acesso à conta de logon do serviço](granting-access-rights-to-the-service-logon-account.md).</span><span class="sxs-lookup"><span data-stu-id="66c8b-131">For more information, see [Granting Access Rights to the Service Logon Account](granting-access-rights-to-the-service-logon-account.md).</span></span>
-   <span data-ttu-id="66c8b-132">Definir privilégios.</span><span class="sxs-lookup"><span data-stu-id="66c8b-132">Set Privileges.</span></span> <span data-ttu-id="66c8b-133">Atribua privilégios à conta de logon especificada, como o direito de fazer logon como um serviço no computador host.</span><span class="sxs-lookup"><span data-stu-id="66c8b-133">Assign privileges to the specified logon account, such as the right to logon as a service to the host computer.</span></span> <span data-ttu-id="66c8b-134">Para obter mais informações, consulte [concedendo logon como serviço diretamente no computador host](granting-logon-as-service-right-on-the-host-computer.md).</span><span class="sxs-lookup"><span data-stu-id="66c8b-134">For more information, see [Granting Logon as Service Right on the Host Computer](granting-logon-as-service-right-on-the-host-computer.md).</span></span>

<span data-ttu-id="66c8b-135">Depois que um serviço é instalado, há tarefas de manutenção relacionadas à sua conta de logon de serviço.</span><span class="sxs-lookup"><span data-stu-id="66c8b-135">After a service is installed, there are maintenance tasks that relate to your service logon account.</span></span> <span data-ttu-id="66c8b-136">Para obter mais informações, consulte [tarefas de manutenção de conta de logon](logon-account-maintenance-tasks.md).</span><span class="sxs-lookup"><span data-stu-id="66c8b-136">For more information, see [Logon Account Maintenance Tasks](logon-account-maintenance-tasks.md).</span></span>

-   <span data-ttu-id="66c8b-137">Manutenção de senha.</span><span class="sxs-lookup"><span data-stu-id="66c8b-137">Password maintenance.</span></span> <span data-ttu-id="66c8b-138">Para um serviço que é executado em uma conta de usuário, você deve alterar periodicamente a senha e manter a senha em sincronia com a senha usada por um ou mais gerenciadores de controle de serviço local para iniciar o serviço.</span><span class="sxs-lookup"><span data-stu-id="66c8b-138">For a service that runs under a user account, you must periodically change the password and keep the password in sync with the password used by one or more local service control managers to start the service.</span></span>
-   <span data-ttu-id="66c8b-139">Manutenção de SPN.</span><span class="sxs-lookup"><span data-stu-id="66c8b-139">SPN maintenance.</span></span> <span data-ttu-id="66c8b-140">Se uma conta de logon de serviço for alterada, remova os SPNs registrados na conta antiga e registre-os na nova conta.</span><span class="sxs-lookup"><span data-stu-id="66c8b-140">If a service logon account changes, remove the SPNs registered on the old account and register them on the new account.</span></span> <span data-ttu-id="66c8b-141">Lembre-se de que, quando um serviço é instalado, um administrador de domínio pode alterar a conta sob a qual seu serviço é executado; Use o Win32 Functions ou a interface do usuário da ferramenta administrativa de gerenciamento do computador.</span><span class="sxs-lookup"><span data-stu-id="66c8b-141">Be aware that when a service is installed, a domain administrator can change the account under which your service runs; use Win32 functions or the user interface of the Computer Management administrative tool.</span></span>
-   <span data-ttu-id="66c8b-142">Manutenção da ACE.</span><span class="sxs-lookup"><span data-stu-id="66c8b-142">ACE maintenance.</span></span> <span data-ttu-id="66c8b-143">Se uma conta de logon de serviço for alterada, você precisará atualizar ACEs e associações de grupo para garantir que o serviço ainda possa acessar os recursos necessários.</span><span class="sxs-lookup"><span data-stu-id="66c8b-143">If a service logon account changes, you need to update ACEs and group memberships to ensure that the service can still access the necessary resources.</span></span>

 

 