---
title: Manipuladores de notificação administrativa
description: O snap-in MMC usuários e computadores do Microsoft Active Directory fornece um mecanismo para permitir que os componentes recebam notificações quando o usuário exclui, renomeia, move ou altera as propriedades de um objeto usando o snap-in.
ms.assetid: 49dbb995-c760-4fac-a72f-d5d94afb63c7
ms.tgt_platform: multiple
keywords:
- AD de manipuladores de notificação administrativa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: baa6f48f8b56ab8e4a1d64d0fe15543bfee6c09e
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "103823669"
---
# <a name="administrative-notification-handlers"></a><span data-ttu-id="0bd47-104">Manipuladores de notificação administrativa</span><span class="sxs-lookup"><span data-stu-id="0bd47-104">Administrative Notification Handlers</span></span>

<span data-ttu-id="0bd47-105">O snap-in MMC usuários e computadores do Microsoft Active Directory fornece um mecanismo para permitir que os componentes recebam notificações quando o usuário exclui, renomeia, move ou altera as propriedades de um objeto usando o snap-in.</span><span class="sxs-lookup"><span data-stu-id="0bd47-105">The Microsoft Active Directory Users and Computers MMC snap-in provides a mechanism to enable components to receive notifications when the user deletes, renames, moves, or changes the properties of an object using the snap-in.</span></span> <span data-ttu-id="0bd47-106">O componente que recebe as notificações é conhecido como "manipulador de notificação".</span><span class="sxs-lookup"><span data-stu-id="0bd47-106">The component that receives the notifications is known as a "notification handler".</span></span>

<span data-ttu-id="0bd47-107">Isso é útil quando vários objetos são vinculados e devem existir dentro do mesmo contêiner.</span><span class="sxs-lookup"><span data-stu-id="0bd47-107">This is useful when multiple objects are linked together and must exist within the same container.</span></span> <span data-ttu-id="0bd47-108">Se um dos objetos vinculados for movido, uma notificação será fornecida ao manipulador de notificação e o manipulador de notificação poderá mover os outros objetos vinculados para a mesma pasta.</span><span class="sxs-lookup"><span data-stu-id="0bd47-108">If one of the linked objects is moved, a notification is supplied to the notification handler and the notification handler can move the other linked objects to the same folder.</span></span>

<span data-ttu-id="0bd47-109">Quando uma das operações for executada e um ou mais manipuladores de notificação estiverem instalados, o snap-in usuários e computadores exibirá uma caixa de diálogo de confirmação que lista os manipuladores de notificação e uma caixa de seleção para cada manipulador.</span><span class="sxs-lookup"><span data-stu-id="0bd47-109">When one of the operations is performed and one or more notification handlers is installed, the Users and Computers snap-in will display a confirmation dialog box that lists the notification handlers and a check box for each handler.</span></span> <span data-ttu-id="0bd47-110">Se a caixa de seleção de um manipulador for selecionada, o manipulador será notificado.</span><span class="sxs-lookup"><span data-stu-id="0bd47-110">If the check box for a handler is selected, the handler is notified.</span></span> <span data-ttu-id="0bd47-111">Se a caixa de seleção não estiver marcada, o manipulador não será notificado.</span><span class="sxs-lookup"><span data-stu-id="0bd47-111">If the check box is not selected, the handler is not notified.</span></span>

## <a name="implementing-a-notification-handler"></a><span data-ttu-id="0bd47-112">Implementando um manipulador de notificação</span><span class="sxs-lookup"><span data-stu-id="0bd47-112">Implementing a Notification Handler</span></span>

<span data-ttu-id="0bd47-113">Um manipulador de notificação é um objeto COM implementado como um servidor em processo.</span><span class="sxs-lookup"><span data-stu-id="0bd47-113">A notification handler is a COM object implemented as an in-proc server.</span></span> <span data-ttu-id="0bd47-114">O manipulador de notificação deve implementar a interface [**IDsAdminNotifyHandler**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnotifyhandler) .</span><span class="sxs-lookup"><span data-stu-id="0bd47-114">The notification handler must implement the [**IDsAdminNotifyHandler**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnotifyhandler) interface.</span></span>

<span data-ttu-id="0bd47-115">Quando ocorrer um evento que causará uma notificação, o snap-in usuários e computadores enumerará os manipuladores de notificação registrados e criará cada um usando o CLSID para o manipulador.</span><span class="sxs-lookup"><span data-stu-id="0bd47-115">When an event occurs that will cause a notification, the Users and Computers snap-in enumerates the registered notification handlers and creates each one using the CLSID for the handler.</span></span> <span data-ttu-id="0bd47-116">Depois que o manipulador é criado, o snap-in chama o método [**IDsAdminNotifyHandler:: Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-initialize) .</span><span class="sxs-lookup"><span data-stu-id="0bd47-116">After the handler is created, the snap-in calls the [**IDsAdminNotifyHandler::Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-initialize) method.</span></span> <span data-ttu-id="0bd47-117">O método **Initialize** fornece o snap-in com os eventos que o manipulador deve receber.</span><span class="sxs-lookup"><span data-stu-id="0bd47-117">The **Initialize** method supplies the snap-in with the events the handler should receive.</span></span>

<span data-ttu-id="0bd47-118">Se o evento for um que deve ser enviado para o manipulador de notificação, o snap-in chamará o método [**IDsAdminNotifyHandler:: Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) .</span><span class="sxs-lookup"><span data-stu-id="0bd47-118">If the event is one that should be sent to the notification handler, the snap-in calls the [**IDsAdminNotifyHandler::Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) method.</span></span> <span data-ttu-id="0bd47-119">O método **begin** fornece o manipulador com o evento que ocorre, dados sobre o objeto em que o evento está ocorrendo e, dependendo do evento, dados sobre o que o objeto se tornará.</span><span class="sxs-lookup"><span data-stu-id="0bd47-119">The **Begin** method provides the handler with the event occurring, data about the object that the event is occurring on and, depending on the event, data about what the object will become.</span></span> <span data-ttu-id="0bd47-120">O método **begin** também fornece o snap-in com o texto que deve ser exibido para o manipulador na caixa de diálogo de confirmação.</span><span class="sxs-lookup"><span data-stu-id="0bd47-120">The **Begin** method also provides the snap-in with the text that should be displayed for the handler in the confirmation dialog box.</span></span>

<span data-ttu-id="0bd47-121">Quando o método [**begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) de cada manipulador for chamado, o snap-in exibirá a caixa de diálogo de confirmação.</span><span class="sxs-lookup"><span data-stu-id="0bd47-121">When the [**Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) method for each handler has been called, the snap-in displays the confirmation dialog box.</span></span> <span data-ttu-id="0bd47-122">A caixa de diálogo de confirmação solicita que o usuário Selecione quais manipuladores receberão a notificação.</span><span class="sxs-lookup"><span data-stu-id="0bd47-122">The confirmation dialog box prompts the user to select which handlers will receive the notification.</span></span> <span data-ttu-id="0bd47-123">Se o usuário pressionar o botão **sem** push na caixa de diálogo de confirmação, nenhum dos manipuladores será notificado.</span><span class="sxs-lookup"><span data-stu-id="0bd47-123">If the user presses the **No** push button in the confirmation dialog, none of the handlers are notified.</span></span> <span data-ttu-id="0bd47-124">Se o usuário pressionar o botão de ação **Sim** , cada um dos manipuladores selecionados na caixa de diálogo de confirmação receberá a notificação.</span><span class="sxs-lookup"><span data-stu-id="0bd47-124">If the user presses the **Yes** push button, each of the handlers selected in the confirmation dialog box receive the notification.</span></span> <span data-ttu-id="0bd47-125">O snap-in envia a notificação para o manipulador chamando o método [**IDsAdminNotifyHandler:: Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) .</span><span class="sxs-lookup"><span data-stu-id="0bd47-125">The snap-in sends the notification to the handler by calling the [**IDsAdminNotifyHandler::Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) method.</span></span>

<span data-ttu-id="0bd47-126">Depois que todos os manipuladores tiverem sido notificados, o snap-in chamará o método [**IDsAdminNotifyHandler:: End**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-end) .</span><span class="sxs-lookup"><span data-stu-id="0bd47-126">After all of the handlers have been notified, the snap-in calls the [**IDsAdminNotifyHandler::End**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-end) method.</span></span> <span data-ttu-id="0bd47-127">O método **end** é sempre chamado, mesmo que o método [**Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) não seja chamado.</span><span class="sxs-lookup"><span data-stu-id="0bd47-127">The **End** method is always called, even if the [**Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) method is not called.</span></span>

## <a name="registering-a-notification-handler-in-the-windows-registry"></a><span data-ttu-id="0bd47-128">Registrando um manipulador de notificação no registro do Windows</span><span class="sxs-lookup"><span data-stu-id="0bd47-128">Registering a Notification Handler in the Windows Registry</span></span>

<span data-ttu-id="0bd47-129">Como todos os servidores COM, um manipulador de notificação deve ser registrado no registro do Windows.</span><span class="sxs-lookup"><span data-stu-id="0bd47-129">Like all COM servers, a notification handler must be registered in the Windows registry.</span></span> <span data-ttu-id="0bd47-130">O manipulador é registrado sob a seguinte chave:</span><span class="sxs-lookup"><span data-stu-id="0bd47-130">The handler is registered under the following key:</span></span>


```C++
HKEY_CLASSES_ROOT - CLSID - <CLSID>
```



<span data-ttu-id="0bd47-131">**<CLSID>** é a representação de cadeia de caracteres do CLSID, conforme produzido pela função [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="0bd47-131">**<CLSID>** is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span> <span data-ttu-id="0bd47-132">Sob a **<CLSID>** chave, há uma chave **InprocServer32** que identifica o objeto como um servidor no processo de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="0bd47-132">Under the **<CLSID>** key, there is an **InProcServer32** key that identifies the object as a 32-bit in-proc server.</span></span> <span data-ttu-id="0bd47-133">Na chave **InprocServer32** , o local da dll é especificado no valor padrão e o modelo de threading é especificado no valor de **ThreadingModel** .</span><span class="sxs-lookup"><span data-stu-id="0bd47-133">Under the **InProcServer32** key, the location of the DLL is specified in the default value and the threading model is specified in the **ThreadingModel** value.</span></span> <span data-ttu-id="0bd47-134">Todos os manipuladores de notificação devem usar o modelo de Threading **Apartment** .</span><span class="sxs-lookup"><span data-stu-id="0bd47-134">All notification handlers must use the **Apartment** threading model.</span></span>

## <a name="registering-a-notification-handler-with-an-active-directory-server"></a><span data-ttu-id="0bd47-135">Registrando um manipulador de notificação com um servidor Active Directory</span><span class="sxs-lookup"><span data-stu-id="0bd47-135">Registering a Notification Handler with an Active Directory Server</span></span>

<span data-ttu-id="0bd47-136">No Active Directory Domain Services, o registro do manipulador de notificação é específico para uma localidade.</span><span class="sxs-lookup"><span data-stu-id="0bd47-136">Within Active Directory Domain Services, notification handler registration is specific to one locale.</span></span> <span data-ttu-id="0bd47-137">Se o manipulador de notificação se aplica a todas as localidades, ele deve ser registrado no objeto **displaySpecifier** em todos os subcontêineres de localidade no contêiner DisplaySpecifiers.</span><span class="sxs-lookup"><span data-stu-id="0bd47-137">If the notification handler applies to all locales, it must be registered in the **displaySpecifier** object in all of the locale subcontainers in the DisplaySpecifiers container.</span></span> <span data-ttu-id="0bd47-138">Se o manipulador de notificação for localizado para uma determinada localidade, ele será registrado no objeto **displaySpecifier** no subcontêiner dessa localidade.</span><span class="sxs-lookup"><span data-stu-id="0bd47-138">If the notification handler is localized for a certain locale, it is registered in the **displaySpecifier** object in that locale's subcontainer.</span></span> <span data-ttu-id="0bd47-139">Para obter mais informações sobre o contêiner DisplaySpecifiers e as localidades, consulte [Exibir especificadores](display-specifiers.md) e [contêiner DisplaySpecifiers](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="0bd47-139">For more information about the DisplaySpecifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="0bd47-140">Os manipuladores de notificação são registrados no atributo **dsUIAdminNotification** no contêiner **DS-UI-default-Settings** .</span><span class="sxs-lookup"><span data-stu-id="0bd47-140">Notification handlers are registered under the **dsUIAdminNotification** attribute in the **DS-UI-Default-Settings** container.</span></span> <span data-ttu-id="0bd47-141">Esse valor de cadeia de caracteres Unicode com vários valores, em que cada valor requer o seguinte formato:</span><span class="sxs-lookup"><span data-stu-id="0bd47-141">This a multi-valued Unicode string value where each value requires the following format:</span></span>


```C++
<order number>,<CLSID>
```



<span data-ttu-id="0bd47-142">O " &lt; número do pedido &gt; " é um número sem sinal que representa a posição do manipulador na caixa de diálogo de confirmação.</span><span class="sxs-lookup"><span data-stu-id="0bd47-142">The "&lt;order number&gt;" is an unsigned number that represents the position of the handler in the confirmation dialog.</span></span> <span data-ttu-id="0bd47-143">Quando a caixa de diálogo de confirmação é exibida, os valores são classificados usando uma comparação do " &lt; número de ordem" de cada valor &gt; .</span><span class="sxs-lookup"><span data-stu-id="0bd47-143">When the confirmation dialog is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="0bd47-144">Se mais de um valor tiver o mesmo " &lt; número do pedido &gt; ", esses manipuladores serão exibidos na ordem em que são lidos do servidor de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="0bd47-144">If more than one value has the same "&lt;order number&gt;", those handlers are displayed in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="0bd47-145">Um não existente, ou seja, um não usado por outros valores na propriedade " &lt; número do pedido &gt; " deve ser usado, se possível.</span><span class="sxs-lookup"><span data-stu-id="0bd47-145">A non-existing, that is, one not used by other values in the property, "&lt;order number&gt;" should be used if possible.</span></span> <span data-ttu-id="0bd47-146">Não há uma posição de início prescrita e as lacunas podem aparecer na &lt; sequência "número do pedido &gt; ".</span><span class="sxs-lookup"><span data-stu-id="0bd47-146">There is no prescribed starting position, and gaps can appear in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="0bd47-147">O " &lt; CLSID &gt; " é a representação de cadeia de caracteres do CLSID, conforme produzido pela função [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="0bd47-147">The "&lt;CLSID&gt;" is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>

 

 