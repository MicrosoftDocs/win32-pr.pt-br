---
title: Enumerando grupos em um domínio
description: Os grupos podem ser colocados em qualquer contêiner ou unidade organizacional (UO) em um domínio, bem como a raiz do domínio.
ms.assetid: 7f9d3c90-b6f4-4bfa-960f-58f380aa487c
ms.tgt_platform: multiple
keywords:
- Enumerando grupos em um AD de domínio
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3586b8c6d261c769cabe56def2aa9396a58fa3a5
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "103640415"
---
# <a name="enumerating-groups-in-a-domain"></a><span data-ttu-id="7cf21-104">Enumerando grupos em um domínio</span><span class="sxs-lookup"><span data-stu-id="7cf21-104">Enumerating Groups in a Domain</span></span>

<span data-ttu-id="7cf21-105">Os grupos podem ser colocados em qualquer contêiner ou unidade organizacional (UO) em um domínio, bem como a raiz do domínio.</span><span class="sxs-lookup"><span data-stu-id="7cf21-105">Groups can be placed in any container or organizational unit (OU) in a domain as well as the root of the domain.</span></span> <span data-ttu-id="7cf21-106">Isso significa que os grupos podem estar em vários locais na hierarquia de diretórios.</span><span class="sxs-lookup"><span data-stu-id="7cf21-106">This means that groups can be in numerous locations in the directory hierarchy.</span></span> <span data-ttu-id="7cf21-107">Portanto, você tem duas opções para enumerar grupos:</span><span class="sxs-lookup"><span data-stu-id="7cf21-107">Therefore, you have two choices for enumerating groups:</span></span>

1.  <span data-ttu-id="7cf21-108">Enumere os grupos diretamente contidos em um contêiner, ou ou na raiz do domínio.</span><span class="sxs-lookup"><span data-stu-id="7cf21-108">Enumerate the groups directly contained in a container, OU, or at the root of the domain.</span></span>

    <span data-ttu-id="7cf21-109">Associe explicitamente ao objeto de contêiner que contém os grupos a serem enumerados, defina um filtro que contenha "grupos" como a classe usando a propriedade [**IADsContainer. Filter**](/windows/desktop/api/iads/nn-iads-iadscontainer) e use o método [**IADsContainer:: get \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) para enumerar os objetos de grupo.</span><span class="sxs-lookup"><span data-stu-id="7cf21-109">Explicitly bind to the container object that contains the groups to enumerate, set a filter that contains "groups" as the class using the [**IADsContainer.Filter**](/windows/desktop/api/iads/nn-iads-iadscontainer) property, and use the [**IADsContainer::get\_\_NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) method to enumerate the group objects.</span></span>

    <span data-ttu-id="7cf21-110">Essa técnica enumera grupos contidos diretamente em um contêiner ou objeto de unidade organizacional.</span><span class="sxs-lookup"><span data-stu-id="7cf21-110">This technique enumerates groups contained directly in a container or OU object.</span></span> <span data-ttu-id="7cf21-111">Se o contêiner contiver outros contêineres que potencialmente podem conter outros grupos, você deverá associar a esses contêineres e enumerar recursivamente os grupos nesses contêineres.</span><span class="sxs-lookup"><span data-stu-id="7cf21-111">If the container contains other containers that can potentially contain other groups, you must bind to those containers and recursively enumerate the groups on those containers.</span></span> <span data-ttu-id="7cf21-112">Para manipular os objetos de grupo e somente as propriedades específicas de leitura, use a pesquisa profunda descrita na opção 2.</span><span class="sxs-lookup"><span data-stu-id="7cf21-112">To manipulate the group objects and read only specific properties, use the deep search described in Option 2.</span></span>

    <span data-ttu-id="7cf21-113">Como a enumeração retorna ponteiros para objetos COM ADSI que representam cada objeto de grupo, você pode chamar [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) para obter os ponteiros de interface [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADs**](/windows/desktop/api/iads/nn-iads-iadsgroup)e [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) para o objeto Group; ou seja, você pode obter ponteiros de interface para cada objeto de grupo enumerado em um contêiner sem ter que associar explicitamente a cada objeto de grupo.</span><span class="sxs-lookup"><span data-stu-id="7cf21-113">Because enumeration returns pointers to ADSI COM objects representing each group object, you can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to get [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup), and [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) interface pointers to the group object; that is, you can get interface pointers to each enumerated group object in a container without having to explicitly bind to each group object.</span></span> <span data-ttu-id="7cf21-114">Para executar operações em todos os grupos diretamente dentro de um contêiner, a enumeração não requer associação a cada grupo para chamar os métodos **IADs** ou **IADs** .</span><span class="sxs-lookup"><span data-stu-id="7cf21-114">To perform operations on all the groups directly within a container, enumeration does not require binding to each group in order to call **IADs** or **IADsGroup** methods.</span></span> <span data-ttu-id="7cf21-115">Para recuperar propriedades específicas de grupos, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) conforme descrito na segunda opção.</span><span class="sxs-lookup"><span data-stu-id="7cf21-115">To retrieve specific properties from groups, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) as described in the second option.</span></span>

    <span data-ttu-id="7cf21-116">Uma exceção a isso ocorre quando você tenta enumerar um grupo que contém membros que são entidades de segurança wellKnown, como todos, usuários autenticados, lote e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="7cf21-116">An exception to this occurs when you attempt to enumerate a group that contains members that are wellKnown security principals, such as Everyone, Authenticated users, BATCH, and so on.</span></span> <span data-ttu-id="7cf21-117">Como não é possível associar a esses tipos de objetos, eles não são listados quando você enumera grupos no escopo do WinNT, embora ele possa parecer associar, pois certos métodos IADs, como Class, ADsPath e Name, retornam resultados corretos quando invocados em Membros enumerados.</span><span class="sxs-lookup"><span data-stu-id="7cf21-117">Because you cannot bind to these types of objects, they are not listed when you enumerate groups in the WinNT scope, even though it may appear to bind, because certain IADs methods such as Class, ADsPath, and Name return correct results when invoked on enumerated members.</span></span>

2.  <span data-ttu-id="7cf21-118">Execute uma pesquisa profunda para "objectCategory = Group" para localizar todos os grupos em uma árvore.</span><span class="sxs-lookup"><span data-stu-id="7cf21-118">Perform a deep search for "objectCategory=group" to find all groups in a tree.</span></span>

    <span data-ttu-id="7cf21-119">Primeiro, associe-se ao objeto de contêiner onde iniciar a pesquisa.</span><span class="sxs-lookup"><span data-stu-id="7cf21-119">First, bind to the container object where to begin the search.</span></span> <span data-ttu-id="7cf21-120">Por exemplo, para localizar todos os grupos em um domínio, associe-se à raiz do domínio; para localizar todos os grupos na floresta, associe-se ao catálogo global e pesquise na raiz do GC.</span><span class="sxs-lookup"><span data-stu-id="7cf21-120">For example, to find all groups in a domain, bind to root of the domain; to find all groups in the forest, bind to global catalog and search from the root of the GC.</span></span>

    <span data-ttu-id="7cf21-121">Em seguida, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) para consultar usando um filtro de pesquisa que contém (objectCategory = Group) e a preferência de pesquisa da **\_ \_ subárvore de escopo ADS**.</span><span class="sxs-lookup"><span data-stu-id="7cf21-121">Then use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) to query using a search filter that contains (objectCategory=group) and search preference of **ADS\_SCOPE\_SUBTREE**.</span></span>

    > [!Note]  
    > <span data-ttu-id="7cf21-122">Você pode executar uma pesquisa com uma preferência de pesquisa **de \_ escopo \_ dos ADS** para limitar a pesquisa ao conteúdo direto do objeto de contêiner ao qual você está vinculado.</span><span class="sxs-lookup"><span data-stu-id="7cf21-122">You can perform a search with a search preference of **ADS\_SCOPE\_ONELEVEL** to limit the search to the direct contents of the container object that you bound to.</span></span>

     

    <span data-ttu-id="7cf21-123">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) recupera apenas os valores de propriedades específicas de grupos.</span><span class="sxs-lookup"><span data-stu-id="7cf21-123">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) retrieves only the values of specific properties from groups.</span></span> <span data-ttu-id="7cf21-124">Para recuperar valores, use **IDirectorySearch**.</span><span class="sxs-lookup"><span data-stu-id="7cf21-124">To retrieve values, use **IDirectorySearch**.</span></span> <span data-ttu-id="7cf21-125">Para manipular os objetos de grupo retornados de uma pesquisa, ou seja, para usar os métodos [**IADs**](/windows/desktop/api/iads/nn-iads-iads) ou [**IADs**](/windows/desktop/api/iads/nn-iads-iadsgroup) , associe-se explicitamente a eles.</span><span class="sxs-lookup"><span data-stu-id="7cf21-125">To manipulate the group objects returned from a search, that is, to use [**IADs**](/windows/desktop/api/iads/nn-iads-iads) or [**IADsGroup**](/windows/desktop/api/iads/nn-iads-iadsgroup) methods, explicitly bind to them.</span></span> <span data-ttu-id="7cf21-126">Para fazer isso, especifique **distinguishedName** como uma das propriedades a serem retornadas da pesquisa e use os nomes distintos retornados para associar a cada grupo retornado na pesquisa.</span><span class="sxs-lookup"><span data-stu-id="7cf21-126">To do this, specify **distinguishedName** as one of the properties to return from the search and use the returned distinguished names to bind to each group returned in the search.</span></span>

    <span data-ttu-id="7cf21-127">Somente propriedades específicas são recuperadas.</span><span class="sxs-lookup"><span data-stu-id="7cf21-127">Only specific properties are retrieved.</span></span> <span data-ttu-id="7cf21-128">Não é possível recuperar todos os atributos sem especificar explicitamente todos os atributos possíveis da classe Group.</span><span class="sxs-lookup"><span data-stu-id="7cf21-128">You cannot retrieve all attributes without explicitly specifying every possible attribute of the group class.</span></span>

 

 