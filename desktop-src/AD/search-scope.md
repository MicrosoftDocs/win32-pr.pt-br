---
title: Especificando o escopo da pesquisa
description: Você pode especificar o escopo de uma pesquisa como uma pesquisa de base, de um nível ou de subárvore.
ms.assetid: b02354c2-7b95-4911-8ae3-4a261d3ca2d3
ms.tgt_platform: multiple
keywords:
- Especificando o AD do escopo de pesquisa
- Active Directory, pesquisando, especificando o escopo da pesquisa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c7ff076e0410088c69eace25f204241c1c51c6fb
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "103640383"
---
# <a name="specifying-the-search-scope"></a><span data-ttu-id="8de53-105">Especificando o escopo da pesquisa</span><span class="sxs-lookup"><span data-stu-id="8de53-105">Specifying the Search Scope</span></span>

<span data-ttu-id="8de53-106">Você pode especificar o escopo de uma pesquisa como uma pesquisa de base, de um nível ou de subárvore.</span><span class="sxs-lookup"><span data-stu-id="8de53-106">You can specify the scope of a search as either a base, one-level, or subtree search.</span></span> <span data-ttu-id="8de53-107">Use o sinalizador de **\_ escopo de \_ pesquisa \_ do ADS SEARCHPREF** com os valores da enumeração [**ADS \_ SCOPEENUM**](/windows/win32/api/iads/ne-iads-ads_scopeenum) para especificar o escopo da pesquisa.</span><span class="sxs-lookup"><span data-stu-id="8de53-107">Use the **ADS\_SEARCHPREF\_SEARCH\_SCOPE** flag with the values of the [**ADS\_SCOPEENUM**](/windows/win32/api/iads/ne-iads-ads_scopeenum) enumeration to specify the search scope.</span></span> <span data-ttu-id="8de53-108">A lista a seguir inclui descrições dos tipos de pesquisa:</span><span class="sxs-lookup"><span data-stu-id="8de53-108">The following list includes descriptions of the search types:</span></span>

-   <span data-ttu-id="8de53-109">**Base**.</span><span class="sxs-lookup"><span data-stu-id="8de53-109">**Base**.</span></span> <span data-ttu-id="8de53-110">Uma pesquisa de base limita a pesquisa ao objeto base.</span><span class="sxs-lookup"><span data-stu-id="8de53-110">A base search limits the search to the base object.</span></span> <span data-ttu-id="8de53-111">O número máximo de objetos retornados é sempre um.</span><span class="sxs-lookup"><span data-stu-id="8de53-111">The maximum number of objects returned is always one.</span></span> <span data-ttu-id="8de53-112">Essa pesquisa é útil para verificar a existência de um objeto para recuperar a associação de grupo.</span><span class="sxs-lookup"><span data-stu-id="8de53-112">This search is useful to verify the existence of an object for retrieving group membership.</span></span> <span data-ttu-id="8de53-113">Por exemplo, se você tiver um nome diferenciado de objeto e precisar verificar a existência do objeto com base no caminho, você poderá usar uma pesquisa de nível único.</span><span class="sxs-lookup"><span data-stu-id="8de53-113">For example, if you have an object distinguished name, and you must verify the object's existence based on the path, you can use a one-level search.</span></span> <span data-ttu-id="8de53-114">Se a pesquisa falhar, você poderá pressupor que o objeto pode ter sido renomeado ou movido para um local diferente, ou que você tenha recebido as informações erradas sobre o objeto.</span><span class="sxs-lookup"><span data-stu-id="8de53-114">If the search fails, you can assume that the object may have been renamed or moved to a different location, or you were given the wrong information about the object.</span></span> <span data-ttu-id="8de53-115">Lembre-se de que você deve armazenar o GUID (identificador global exclusivo) do objeto em vez do nome distinto, se desejar revisitar um objeto.</span><span class="sxs-lookup"><span data-stu-id="8de53-115">Be aware that you should store the globally unique identifier (GUID) of the object instead of the distinguished name, if you wish to revisit an object.</span></span> <span data-ttu-id="8de53-116">O GUID sempre fará referência ao mesmo objeto, independentemente de onde o objeto está localizado dentro da hierarquia de diretório.</span><span class="sxs-lookup"><span data-stu-id="8de53-116">The GUID will always reference the same object, regardless of where the object is located within the directory hierarchy.</span></span>
-   <span data-ttu-id="8de53-117">**Um nível**.</span><span class="sxs-lookup"><span data-stu-id="8de53-117">**One-level**.</span></span> <span data-ttu-id="8de53-118">Uma pesquisa de nível único é restrita aos filhos imediatos de um objeto base, mas exclui o objeto base em si.</span><span class="sxs-lookup"><span data-stu-id="8de53-118">A one-level search is restricted to the immediate children of a base object, but excludes the base object itself.</span></span> <span data-ttu-id="8de53-119">Essa configuração pode executar uma pesquisa direcionada para objetos filho imediatos de um objeto pai.</span><span class="sxs-lookup"><span data-stu-id="8de53-119">This setting can perform a targeted search for immediate child objects of a parent object.</span></span> <span data-ttu-id="8de53-120">Por exemplo, considere um objeto pai P1 e seus filhos imediatos: C1, C2 e C3.</span><span class="sxs-lookup"><span data-stu-id="8de53-120">For example, consider a parent object P1 and its immediate children: C1, C2, and C3.</span></span> <span data-ttu-id="8de53-121">Uma pesquisa de nível único avalia C1, C2 e C3 em relação aos critérios de pesquisa, mas não avalia P1.</span><span class="sxs-lookup"><span data-stu-id="8de53-121">A one-level search evaluates C1, C2, and C3 against the search criteria, but does not evaluate P1.</span></span> <span data-ttu-id="8de53-122">Use uma pesquisa de nível único para enumerar todos os filhos de um objeto.</span><span class="sxs-lookup"><span data-stu-id="8de53-122">Use a one-level search to enumerate all children of an object.</span></span> <span data-ttu-id="8de53-123">Uma enumeração [**IADsContainer**](/windows/desktop/api/iads/nn-iads-iadscontainer) se traduz em uma pesquisa de um nível.</span><span class="sxs-lookup"><span data-stu-id="8de53-123">An [**IADsContainer**](/windows/desktop/api/iads/nn-iads-iadscontainer) enumeration translates to a one-level search.</span></span>
-   <span data-ttu-id="8de53-124">**Subárvore**.</span><span class="sxs-lookup"><span data-stu-id="8de53-124">**Subtree**.</span></span> <span data-ttu-id="8de53-125">Uma pesquisa de subárvore (ou uma pesquisa profunda) inclui todos os objetos filho, bem como o objeto base.</span><span class="sxs-lookup"><span data-stu-id="8de53-125">A subtree search (or a deep search) includes all child objects as well as the base object.</span></span> <span data-ttu-id="8de53-126">Você pode solicitar ao provedor LDAP para perseguir referências a outros serviços de diretório LDAP, incluindo outros domínios de diretório ou florestas.</span><span class="sxs-lookup"><span data-stu-id="8de53-126">You can request the LDAP provider to chase referrals to other LDAP directory services, including other directory domains or forests.</span></span>

 

 