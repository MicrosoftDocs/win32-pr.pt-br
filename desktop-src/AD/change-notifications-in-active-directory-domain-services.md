---
title: Notificações de alteração no Active Directory Domain Services
description: Active Directory Domain Services fornecer um mecanismo para que um aplicativo cliente se registre em um controlador de domínio para receber notificações de alteração.
ms.assetid: 27f6c7c1-b32e-457a-9be5-47836d097ab1
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee564727cfbcb2bfdb367f822fdc137bca7c4e37
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "104007358"
---
# <a name="change-notifications-in-active-directory-domain-services"></a><span data-ttu-id="1e179-103">Notificações de alteração no Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="1e179-103">Change Notifications in Active Directory Domain Services</span></span>

<span data-ttu-id="1e179-104">Active Directory Domain Services fornecer um mecanismo para que um aplicativo cliente se registre em um controlador de domínio para receber notificações de alteração.</span><span class="sxs-lookup"><span data-stu-id="1e179-104">Active Directory Domain Services provide a mechanism for a client application to register with a domain controller to receive change notifications.</span></span> <span data-ttu-id="1e179-105">Para fazer isso, o cliente especifica o controle de notificação de alteração de LDAP em uma operação de pesquisa LDAP assíncrona.</span><span class="sxs-lookup"><span data-stu-id="1e179-105">To do this, the client specifies the LDAP change notification control in an asynchronous LDAP search operation.</span></span> <span data-ttu-id="1e179-106">O cliente também especifica os seguintes parâmetros de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="1e179-106">The client also specifies the following search parameters.</span></span>



| <span data-ttu-id="1e179-107">Parâmetro</span><span class="sxs-lookup"><span data-stu-id="1e179-107">Parameter</span></span>             | <span data-ttu-id="1e179-108">Descrição</span><span class="sxs-lookup"><span data-stu-id="1e179-108">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|-----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="1e179-109">Escopo</span><span class="sxs-lookup"><span data-stu-id="1e179-109">Scope</span></span><br/>      | <span data-ttu-id="1e179-110">Especifique a **\_ \_ base do escopo LDAP** para monitorar apenas o objeto ou **o \_ escopo \_ do LDAP** num para monitorar os filhos imediatos do objeto, não incluindo o próprio objeto.</span><span class="sxs-lookup"><span data-stu-id="1e179-110">Specify either **LDAP\_SCOPE\_BASE** to monitor just the object, or **LDAP\_SCOPE\_ONELEVEL** to monitor the immediate children of the object, not including the object itself.</span></span> <span data-ttu-id="1e179-111">Não especifique a **\_ \_ subárvore do escopo LDAP**.</span><span class="sxs-lookup"><span data-stu-id="1e179-111">Do not specify **LDAP\_SCOPE\_SUBTREE**.</span></span> <span data-ttu-id="1e179-112">Embora o escopo da subárvore tenha suporte se o objeto base for a raiz de um contexto de nomenclatura, seu uso poderá afetar seriamente o desempenho do servidor, pois ele gera uma mensagem de resultado de pesquisa LDAP toda vez que um objeto no contexto de nomenclatura é modificado.</span><span class="sxs-lookup"><span data-stu-id="1e179-112">Although the subtree scope is supported if the base object is the root of a naming context, its use can severely impact server performance, because it generates an LDAP search result message every time an object in the naming context is modified.</span></span> <span data-ttu-id="1e179-113">Não é possível especificar a **\_ \_ subárvore de escopo LDAP** para uma subárvore arbitrária.</span><span class="sxs-lookup"><span data-stu-id="1e179-113">You cannot specify **LDAP\_SCOPE\_SUBTREE** for an arbitrary subtree.</span></span><br/> |
| <span data-ttu-id="1e179-114">Filtrar</span><span class="sxs-lookup"><span data-stu-id="1e179-114">Filter</span></span><br/>     | <span data-ttu-id="1e179-115">Especifique um filtro de pesquisa de "(objectClass = \* )", que significa que você receberá notificações para alterações em qualquer objeto no escopo especificado.</span><span class="sxs-lookup"><span data-stu-id="1e179-115">Specify a search filter of "(objectclass=\*)", which means you receive notifications for changes to any object in the specified scope.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                |
| <span data-ttu-id="1e179-116">Atributos</span><span class="sxs-lookup"><span data-stu-id="1e179-116">Attributes</span></span><br/> | <span data-ttu-id="1e179-117">Especifique uma lista de atributos para retornar quando ocorrer uma alteração.</span><span class="sxs-lookup"><span data-stu-id="1e179-117">Specify a list of attributes to return when a change occurs.</span></span> <span data-ttu-id="1e179-118">Lembre-se de receber notificações quando qualquer atributo for modificado, não apenas os atributos especificados.</span><span class="sxs-lookup"><span data-stu-id="1e179-118">Be aware that you receive notifications when any attribute is modified, not just the specified attributes.</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                               |



 

<span data-ttu-id="1e179-119">Você pode registrar até cinco solicitações de notificação em uma única conexão LDAP.</span><span class="sxs-lookup"><span data-stu-id="1e179-119">You can register up to five notification requests on a single LDAP connection.</span></span> <span data-ttu-id="1e179-120">Você deve ter um thread dedicado que aguarda as notificações e processa-as rapidamente.</span><span class="sxs-lookup"><span data-stu-id="1e179-120">You must have a dedicated thread that waits for the notifications and processes them quickly.</span></span> <span data-ttu-id="1e179-121">Quando você chama a \_ função ext de pesquisa LDAP \_ para registrar uma solicitação de notificação, a função retorna um identificador de mensagem que identifica essa solicitação.</span><span class="sxs-lookup"><span data-stu-id="1e179-121">When you call the ldap\_search\_ext function to register a notification request, the function returns a message identifier that identifies that request.</span></span> <span data-ttu-id="1e179-122">Em seguida, você usa a função de [**\_ resultado LDAP**](/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_result) para aguardar as notificações de alteração.</span><span class="sxs-lookup"><span data-stu-id="1e179-122">You then use the [**ldap\_result**](/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_result) function to wait for change notifications.</span></span> <span data-ttu-id="1e179-123">Quando ocorre uma alteração, o servidor envia uma mensagem LDAP que contém o identificador da mensagem para a solicitação de notificação que gerou a notificação.</span><span class="sxs-lookup"><span data-stu-id="1e179-123">When a change occurs, the server sends you an LDAP message that contains the message identifier for the notification request that generated the notification.</span></span> <span data-ttu-id="1e179-124">Isso faz com que a função de **\_ resultado LDAP** seja retornada com os resultados da pesquisa que identificam o objeto que foi alterado.</span><span class="sxs-lookup"><span data-stu-id="1e179-124">This causes the **ldap\_result** function to return with search results that identify the object that changed.</span></span>

<span data-ttu-id="1e179-125">O aplicativo cliente deve determinar o estado inicial do objeto monitorado.</span><span class="sxs-lookup"><span data-stu-id="1e179-125">The client application must determine the initial state of the object monitored.</span></span> <span data-ttu-id="1e179-126">Para fazer isso, primeiro você deve registrar a solicitação de notificação e, em seguida, ler o estado atual.</span><span class="sxs-lookup"><span data-stu-id="1e179-126">To do this, you must first register the notification request and then read the current state.</span></span>

<span data-ttu-id="1e179-127">O aplicativo cliente também deve determinar a causa da alteração.</span><span class="sxs-lookup"><span data-stu-id="1e179-127">The client application must also determine the cause of the change.</span></span> <span data-ttu-id="1e179-128">Para uma pesquisa de nível de base, uma notificação ocorre quando qualquer atributo é alterado ou quando o objeto é excluído ou movido.</span><span class="sxs-lookup"><span data-stu-id="1e179-128">For a base level search, a notification occurs when any attribute changes, or when the object is deleted or moved.</span></span> <span data-ttu-id="1e179-129">Para uma pesquisa de um nível, uma notificação ocorre quando um objeto filho é criado, excluído, movido ou modificado.</span><span class="sxs-lookup"><span data-stu-id="1e179-129">For a one-level search, a notification occurs when a child object is created, deleted, moved, or modified.</span></span> <span data-ttu-id="1e179-130">Lembre-se de que mover ou renomear um objeto na hierarquia acima de um objeto de destino não gera uma notificação, embora o nome distinto do destino seja alterado como resultado.</span><span class="sxs-lookup"><span data-stu-id="1e179-130">Be aware that moving or renaming an object in the hierarchy above a target object does not generate a notification even though the distinguished name of the target changed as a result.</span></span> <span data-ttu-id="1e179-131">Por exemplo, se o monitoramento mudar para os objetos filho em um contêiner, você não receberá notificações se o próprio contêiner for movido ou renomeado.</span><span class="sxs-lookup"><span data-stu-id="1e179-131">For example, if monitoring changes to the child objects in a container, you will not receive notifications if the container itself is moved or renamed.</span></span>

<span data-ttu-id="1e179-132">Quando o cliente processa os resultados da pesquisa, ele pode usar a \_ função LDAP get \_ DN para obter o nome distinto do objeto que foi alterado.</span><span class="sxs-lookup"><span data-stu-id="1e179-132">When the client processes the search results, it can use the ldap\_get\_dn function to get the distinguished name of the object that changed.</span></span> <span data-ttu-id="1e179-133">Não confie em nomes distintos para identificar os objetos rastreados, pois nomes distintos podem ser alterados.</span><span class="sxs-lookup"><span data-stu-id="1e179-133">Do not rely on distinguished names to identify the objects tracked, because distinguished names can change.</span></span> <span data-ttu-id="1e179-134">Em vez disso, inclua o atributo **objectGUID** na lista de atributos a serem recuperados.</span><span class="sxs-lookup"><span data-stu-id="1e179-134">Instead, include the **objectGUID** attribute in the list of attributes to retrieve.</span></span> <span data-ttu-id="1e179-135">O **objectGUID** de cada objeto permanece inalterado, independentemente de onde o objeto é movido dentro da floresta da empresa.</span><span class="sxs-lookup"><span data-stu-id="1e179-135">Each object's **objectGUID** remains unchanged regardless of where the object is moved within the enterprise forest.</span></span>

<span data-ttu-id="1e179-136">Se um objeto dentro do escopo de pesquisa for excluído, o cliente receberá uma notificação de alteração e o atributo **IsDeleted** do objeto será definido como **true**.</span><span class="sxs-lookup"><span data-stu-id="1e179-136">If an object within the search scope is deleted, the client receives a change notification and the **isDeleted** attribute of the object is set to **TRUE**.</span></span> <span data-ttu-id="1e179-137">Nesse caso, os resultados da pesquisa relatam o novo nome distinto do objeto no contêiner objetos excluídos de sua partição.</span><span class="sxs-lookup"><span data-stu-id="1e179-137">In this case, the search results report the new distinguished name of the object in the Deleted Objects container of its partition.</span></span> <span data-ttu-id="1e179-138">Não é necessário especificar o controle de marca de exclusão ([ \_ servidor LDAP \_ Mostrar \_ \_ OID excluído](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid)) para obter notificações de exclusões de objetos.</span><span class="sxs-lookup"><span data-stu-id="1e179-138">It is not necessary to specify the tombstone control ([LDAP\_SERVER\_SHOW\_DELETED\_OID](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid)) to get notifications of object deletions.</span></span> <span data-ttu-id="1e179-139">Para obter mais informações, consulte [recuperando objetos excluídos](retrieving-deleted-objects.md).</span><span class="sxs-lookup"><span data-stu-id="1e179-139">For more information, see [Retrieving Deleted Objects](retrieving-deleted-objects.md).</span></span>

<span data-ttu-id="1e179-140">Quando um cliente registra uma solicitação de notificação, o cliente continua a receber notificações até que a conexão seja interrompida ou o cliente abandone a pesquisa chamando a \_ função de Abandon LDAP.</span><span class="sxs-lookup"><span data-stu-id="1e179-140">When a client has registered a notification request, the client continues to receive notifications until the connection is broken or the client abandons the search by calling the ldap\_abandon function.</span></span> <span data-ttu-id="1e179-141">Se o cliente ou servidor se desconectar, por exemplo, se o servidor falhar, a solicitação de notificação será encerrada.</span><span class="sxs-lookup"><span data-stu-id="1e179-141">If the client or server disconnects, for example, if the server fails, the notification request is terminated.</span></span> <span data-ttu-id="1e179-142">Quando o cliente se reconecta, ele deve se registrar para notificações novamente e, em seguida, ler o estado atual dos objetos de interesse caso haja alterações enquanto o cliente estava desconectado.</span><span class="sxs-lookup"><span data-stu-id="1e179-142">When the client reconnects, it must register for notifications again, and then read the current state of the objects of interest in case there were changes while the client was disconnected.</span></span>

<span data-ttu-id="1e179-143">O cliente pode usar o valor do atributo **uSNChanged** de um objeto para determinar se o estado atual do objeto no servidor reflete as alterações mais recentes que o cliente recebeu.</span><span class="sxs-lookup"><span data-stu-id="1e179-143">The client can use the value of an object's **uSNChanged** attribute to determine whether the current state of the object on the server reflects the latest changes that the client has received.</span></span> <span data-ttu-id="1e179-144">O sistema aumenta o atributo **uSNChanged** de um objeto quando o objeto é movido ou modificado.</span><span class="sxs-lookup"><span data-stu-id="1e179-144">The system increases an object's **uSNChanged** attribute when the object is moved or modified.</span></span> <span data-ttu-id="1e179-145">Por exemplo, se o servidor falhar e a partição de diretório for restaurada de um backup, a réplica do servidor de um objeto poderá não refletir as alterações relatadas anteriormente para o cliente; nesse caso, o valor de **uSNChanged** no servidor será menor do que o valor armazenado pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="1e179-145">For example, if the server fails and the directory partition is restored from a backup, the server's replica of an object may not reflect changes previously reported to the client, in which case the **uSNChanged** value on the server will be lower than the value stored by the client.</span></span>

<span data-ttu-id="1e179-146">Para obter mais informações e um exemplo de código que usa o controle de notificação de alteração LDAP em uma operação de pesquisa LDAP assíncrona, consulte o [código de exemplo para receber notificações de alteração](example-code-for-receiving-change-notifications.md).</span><span class="sxs-lookup"><span data-stu-id="1e179-146">For more information and a code example that uses the LDAP change notification control in an asynchronous LDAP search operation, see [Example Code for Receiving Change Notifications](example-code-for-receiving-change-notifications.md).</span></span>

<span data-ttu-id="1e179-147">Para obter mais informações sobre quando usar o controle de notificação de alteração de LDAP, consulte [visão geral das técnicas de controle de alterações](overview-of-change-tracking-techniques.md).</span><span class="sxs-lookup"><span data-stu-id="1e179-147">For more information about when to use the LDAP change notification control, see [Overview of Change Tracking Techniques](overview-of-change-tracking-techniques.md).</span></span>

 

