---
title: Criando e excluindo objetos no Active Directory Domain Services
description: O procedimento usado para criar e excluir objetos programaticamente no Active Directory Domain Services depende da tecnologia de programação usada.
ms.assetid: 13f83aea-ad39-4737-af3c-24316a31046d
ms.tgt_platform: multiple
keywords:
- Criando e excluindo objetos de Active Directory Active Directory
- Active Directory Domain Services Active Directory, usando a criação e exclusão de objetos
- objetos Active Directory, criando e excluindo objetos Active Directory Domain Services
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 11d3e85ef3c356978faeab059e3969bb657185bd
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "104453940"
---
# <a name="creating-and-deleting-objects-in-active-directory-domain-services"></a><span data-ttu-id="122a9-106">Criando e excluindo objetos no Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="122a9-106">Creating and Deleting Objects in Active Directory Domain Services</span></span>

<span data-ttu-id="122a9-107">O procedimento usado para criar e excluir objetos programaticamente no Active Directory Domain Services depende da tecnologia de programação usada.</span><span class="sxs-lookup"><span data-stu-id="122a9-107">The procedure used to programmatically create and delete objects in Active Directory Domain Services is dependent upon the programming technology used.</span></span> <span data-ttu-id="122a9-108">Para obter mais informações sobre como criar e excluir objetos no Active Directory Domain Services com uma tecnologia de programação específica, consulte os tópicos listados na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="122a9-108">For more information about creating and deleting objects in Active Directory Domain Services with a specific programming technology, see the topics listed in the following table.</span></span>



| <span data-ttu-id="122a9-109">Tecnologia de programação</span><span class="sxs-lookup"><span data-stu-id="122a9-109">Programming technology</span></span>                                                                       | <span data-ttu-id="122a9-110">Para obter mais informações</span><span class="sxs-lookup"><span data-stu-id="122a9-110">For more information</span></span>                                                            |
|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------|
| [<span data-ttu-id="122a9-111">Active Directory Service Interfaces</span><span class="sxs-lookup"><span data-stu-id="122a9-111">Active Directory Service Interfaces</span></span>](/windows/desktop/ADSI/active-directory-service-interfaces-adsi)         | [<span data-ttu-id="122a9-112">Criando e excluindo objetos</span><span class="sxs-lookup"><span data-stu-id="122a9-112">Creating and Deleting Objects</span></span>](/windows/desktop/ADSI/creating-and-deleting-objects)             |
| [<span data-ttu-id="122a9-113">Protocolo Lightweight Directory Access</span><span class="sxs-lookup"><span data-stu-id="122a9-113">Lightweight Directory Access Protocol</span></span>](/previous-versions/windows/desktop/ldap/lightweight-directory-access-protocol-ldap-api) | [<span data-ttu-id="122a9-114">Modificando uma entrada de diretório</span><span class="sxs-lookup"><span data-stu-id="122a9-114">Modifying a Directory Entry</span></span>](/previous-versions/windows/desktop/ldap/modifying-a-directory-entry)                 |
| [<span data-ttu-id="122a9-115">System.DirectoryServices</span><span class="sxs-lookup"><span data-stu-id="122a9-115">System.DirectoryServices</span></span>](/dotnet/api/system.directoryservices) | <span data-ttu-id="122a9-116">[Criar, excluir, renomear e mover objetos](https://msdn.microsoft.com/library/ms180850(v=VS.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="122a9-116">[Create, Delete, Rename and Move Objects](https://msdn.microsoft.com/library/ms180850(v=VS.80).aspx)</span></span> |



 

## <a name="creating-an-object"></a><span data-ttu-id="122a9-117">Criando um objeto</span><span class="sxs-lookup"><span data-stu-id="122a9-117">Creating an Object</span></span>

<span data-ttu-id="122a9-118">Em geral, os únicos atributos necessários para um objeto a ser criado são os atributos **CN** e **objectClass** .</span><span class="sxs-lookup"><span data-stu-id="122a9-118">In general, the only attributes required for an object to be created are the **cn** and **objectClass** attributes.</span></span> <span data-ttu-id="122a9-119">No entanto, apenas criar um objeto não o torna necessariamente um objeto funcional.</span><span class="sxs-lookup"><span data-stu-id="122a9-119">Just creating an object does not necessarily make it a functional object however.</span></span> <span data-ttu-id="122a9-120">Determinados tipos de objetos, como usuários e grupos, têm atributos adicionais necessários para torná-los funcionais.</span><span class="sxs-lookup"><span data-stu-id="122a9-120">Certain types of objects, such as users and groups, have additional required attributes to make them functional.</span></span> <span data-ttu-id="122a9-121">Para obter mais informações sobre como criar tipos específicos de objetos, consulte [criando um usuário](creating-a-user.md) e [criando grupos em um domínio](creating-groups-in-a-domain.md).</span><span class="sxs-lookup"><span data-stu-id="122a9-121">For more information about creating specific types of objects, see [Creating a User](creating-a-user.md) and [Creating Groups in a Domain](creating-groups-in-a-domain.md).</span></span>

<span data-ttu-id="122a9-122">**Windows Server 2003:** Quando um objeto do [**usuário**](/windows/desktop/ADSchema/c-user), [**grupo**](/windows/desktop/ADSchema/c-group)ou classe de [**computador**](/windows/desktop/ADSchema/c-computer) é criado em um controlador de domínio que está sendo executado no comparação Server 2003 ou posterior, o controlador de domínio define automaticamente o atributo [**sAMAccountName**](/windows/desktop/ADSchema/a-samaccountname) para o objeto como uma cadeia de caracteres exclusiva, se um não for especificado.</span><span class="sxs-lookup"><span data-stu-id="122a9-122">**Windows Server 2003:** When an object of the [**user**](/windows/desktop/ADSchema/c-user), [**group**](/windows/desktop/ADSchema/c-group), or [**computer**](/windows/desktop/ADSchema/c-computer) class is created on a domain controller that is running on WWindows Server 2003 or later, the domain controller automatically sets the [**sAMAccountName**](/windows/desktop/ADSchema/a-samaccountname) attribute for the object to a unique string, if one is not specified.</span></span>

## <a name="deleting-an-object"></a><span data-ttu-id="122a9-123">Excluindo um objeto</span><span class="sxs-lookup"><span data-stu-id="122a9-123">Deleting an Object</span></span>

<span data-ttu-id="122a9-124">O servidor de Active Directory executa as seguintes ações quando um objeto é excluído:</span><span class="sxs-lookup"><span data-stu-id="122a9-124">The Active Directory server performs the following actions when an object is deleted:</span></span>

-   <span data-ttu-id="122a9-125">O atributo **IsDeleted** do objeto excluído é definido como **true**.</span><span class="sxs-lookup"><span data-stu-id="122a9-125">The **isDeleted** attribute of the deleted object is set to **TRUE**.</span></span> <span data-ttu-id="122a9-126">Objetos com um valor de atributo **IsDeleted** definido como **true** são chamados de [*marcas para exclusão*](/previous-versions/windows/desktop/legacy/ms681941(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="122a9-126">Objects with an **isDeleted** attribute value set to **TRUE** are called [*tombstones*](/previous-versions/windows/desktop/legacy/ms681941(v=vs.85)).</span></span>
-   <span data-ttu-id="122a9-127">O objeto excluído é movido para o contêiner objetos excluídos para seu contexto de nomenclatura.</span><span class="sxs-lookup"><span data-stu-id="122a9-127">The deleted object is moved to the Deleted Objects container for its naming context.</span></span> <span data-ttu-id="122a9-128">Se a propriedade **systemFlags** do objeto contiver o sinalizador 0x02000000, o objeto não será movido para o contêiner objetos excluídos.</span><span class="sxs-lookup"><span data-stu-id="122a9-128">If the object **systemFlags** property contains the 0x02000000 flag, the object is not moved to the Deleted Objects container.</span></span> <span data-ttu-id="122a9-129">Para obter mais informações sobre como associar e enumerar o conteúdo do contêiner de objetos excluídos, consulte [recuperando objetos excluídos](retrieving-deleted-objects.md).</span><span class="sxs-lookup"><span data-stu-id="122a9-129">For more information about binding to and enumerating the contents of the Deleted Objects container, see [Retrieving Deleted Objects](retrieving-deleted-objects.md).</span></span>
-   <span data-ttu-id="122a9-130">O contêiner objetos excluídos é simples, de modo que todos os objetos residem no mesmo nível dentro do contêiner objetos excluídos.</span><span class="sxs-lookup"><span data-stu-id="122a9-130">The Deleted Objects container is flat, so all objects reside at the same level within the Deleted Objects container.</span></span> <span data-ttu-id="122a9-131">Assim, o nome distinto relativo do objeto excluído é alterado para garantir que o nome seja exclusivo dentro do contêiner objetos excluídos.</span><span class="sxs-lookup"><span data-stu-id="122a9-131">Thus, the relative distinguished name of the deleted object is changed to ensure that the name is unique within the Deleted Objects container.</span></span> <span data-ttu-id="122a9-132">Se o nome original tiver mais de 75 caracteres, ele será truncado para 75 caracteres.</span><span class="sxs-lookup"><span data-stu-id="122a9-132">If the original name is longer than 75 characters, it is truncated to 75 characters.</span></span> <span data-ttu-id="122a9-133">Em seguida, os itens a seguir são anexados ao novo nome:</span><span class="sxs-lookup"><span data-stu-id="122a9-133">The following are then appended to the new name:</span></span>
    1.  <span data-ttu-id="122a9-134">Um caractere 0x0A</span><span class="sxs-lookup"><span data-stu-id="122a9-134">A 0x0A character</span></span>
    2.  <span data-ttu-id="122a9-135">A cadeia de caracteres "DEL:"</span><span class="sxs-lookup"><span data-stu-id="122a9-135">The string "DEL:"</span></span>
    3.  <span data-ttu-id="122a9-136">A forma de cadeia de caracteres de um GUID exclusivo, como "947e3228-70c9-4311-8b7a-e5c9b5bd4432"</span><span class="sxs-lookup"><span data-stu-id="122a9-136">The string form of a unique GUID, such as "947e3228-70c9-4311-8b7a-e5c9b5bd4432"</span></span>

    <span data-ttu-id="122a9-137">Um exemplo de um nome de objeto excluído é:</span><span class="sxs-lookup"><span data-stu-id="122a9-137">An example of a deleted object name is:</span></span>
    ```C++
    Jeff Smith\0ADEL:947e3228-70c9-4311-8b7a-e5c9b5bd4432
    ```

    

-   <span data-ttu-id="122a9-138">A maioria dos valores de atributo para o objeto excluído é removida.</span><span class="sxs-lookup"><span data-stu-id="122a9-138">Most attribute values for the deleted object are removed.</span></span> <span data-ttu-id="122a9-139">Os seguintes atributos são retidos automaticamente:</span><span class="sxs-lookup"><span data-stu-id="122a9-139">The following attributes are automatically retained:</span></span>

    -   <span data-ttu-id="122a9-140">**attributeID**</span><span class="sxs-lookup"><span data-stu-id="122a9-140">**attributeID**</span></span>
    -   <span data-ttu-id="122a9-141">**attributeSyntax**</span><span class="sxs-lookup"><span data-stu-id="122a9-141">**attributeSyntax**</span></span>
    -   <span data-ttu-id="122a9-142">**distinguishedName**</span><span class="sxs-lookup"><span data-stu-id="122a9-142">**distinguishedName**</span></span>
    -   <span data-ttu-id="122a9-143">**dNReferenceUpdate**</span><span class="sxs-lookup"><span data-stu-id="122a9-143">**dNReferenceUpdate**</span></span>
    -   <span data-ttu-id="122a9-144">**flatname**</span><span class="sxs-lookup"><span data-stu-id="122a9-144">**flatName**</span></span>
    -   <span data-ttu-id="122a9-145">**governsID**</span><span class="sxs-lookup"><span data-stu-id="122a9-145">**governsID**</span></span>
    -   <span data-ttu-id="122a9-146">**groupType**</span><span class="sxs-lookup"><span data-stu-id="122a9-146">**groupType**</span></span>
    -   <span data-ttu-id="122a9-147">**instanceType**</span><span class="sxs-lookup"><span data-stu-id="122a9-147">**instanceType**</span></span>
    -   <span data-ttu-id="122a9-148">**lDAPDisplayName**</span><span class="sxs-lookup"><span data-stu-id="122a9-148">**lDAPDisplayName**</span></span>
    -   <span data-ttu-id="122a9-149">**legacyExchangeDN**</span><span class="sxs-lookup"><span data-stu-id="122a9-149">**legacyExchangeDN**</span></span>
    -   <span data-ttu-id="122a9-150">**mS-DS-CreatorSID**</span><span class="sxs-lookup"><span data-stu-id="122a9-150">**mS-DS-CreatorSID**</span></span>
    -   <span data-ttu-id="122a9-151">**mSMQOwnerID**</span><span class="sxs-lookup"><span data-stu-id="122a9-151">**mSMQOwnerID**</span></span>
    -   <span data-ttu-id="122a9-152">**name**</span><span class="sxs-lookup"><span data-stu-id="122a9-152">**name**</span></span>
    -   <span data-ttu-id="122a9-153">**nCName**</span><span class="sxs-lookup"><span data-stu-id="122a9-153">**nCName**</span></span>
    -   <span data-ttu-id="122a9-154">**objectClass**</span><span class="sxs-lookup"><span data-stu-id="122a9-154">**objectClass**</span></span>
    -   <span data-ttu-id="122a9-155">**objectGUID**</span><span class="sxs-lookup"><span data-stu-id="122a9-155">**objectGUID**</span></span>
    -   <span data-ttu-id="122a9-156">**objectSid**</span><span class="sxs-lookup"><span data-stu-id="122a9-156">**objectSid**</span></span>
    -   <span data-ttu-id="122a9-157">**oMSyntax**</span><span class="sxs-lookup"><span data-stu-id="122a9-157">**oMSyntax**</span></span>
    -   <span data-ttu-id="122a9-158">**proxiedObjectName**</span><span class="sxs-lookup"><span data-stu-id="122a9-158">**proxiedObjectName**</span></span>
    -   <span data-ttu-id="122a9-159">**replPropertyMetaData**</span><span class="sxs-lookup"><span data-stu-id="122a9-159">**replPropertyMetaData**</span></span>
    -   <span data-ttu-id="122a9-160">**sAMAccountName**</span><span class="sxs-lookup"><span data-stu-id="122a9-160">**sAMAccountName**</span></span>
    -   <span data-ttu-id="122a9-161">**securityIdentifier**</span><span class="sxs-lookup"><span data-stu-id="122a9-161">**securityIdentifier**</span></span>
    -   <span data-ttu-id="122a9-162">**subClassOf**</span><span class="sxs-lookup"><span data-stu-id="122a9-162">**subClassOf**</span></span>
    -   <span data-ttu-id="122a9-163">**systemFlags**</span><span class="sxs-lookup"><span data-stu-id="122a9-163">**systemFlags**</span></span>
    -   <span data-ttu-id="122a9-164">**trustattributes**</span><span class="sxs-lookup"><span data-stu-id="122a9-164">**trustAttributes**</span></span>
    -   <span data-ttu-id="122a9-165">**trustDirection**</span><span class="sxs-lookup"><span data-stu-id="122a9-165">**trustDirection**</span></span>
    -   <span data-ttu-id="122a9-166">**trustPartner**</span><span class="sxs-lookup"><span data-stu-id="122a9-166">**trustPartner**</span></span>
    -   <span data-ttu-id="122a9-167">**TrustType**</span><span class="sxs-lookup"><span data-stu-id="122a9-167">**trustType**</span></span>
    -   <span data-ttu-id="122a9-168">**userAccountControl**</span><span class="sxs-lookup"><span data-stu-id="122a9-168">**userAccountControl**</span></span>
    -   <span data-ttu-id="122a9-169">**uSNChanged**</span><span class="sxs-lookup"><span data-stu-id="122a9-169">**uSNChanged**</span></span>
    -   <span data-ttu-id="122a9-170">**uSNCreated**</span><span class="sxs-lookup"><span data-stu-id="122a9-170">**uSNCreated**</span></span>
    -   <span data-ttu-id="122a9-171">**whenCreated**</span><span class="sxs-lookup"><span data-stu-id="122a9-171">**whenCreated**</span></span>

    <span data-ttu-id="122a9-172">Outros atributos que têm um valor de atributo **searchFlags** que contém 0x00000008 também são retidos.</span><span class="sxs-lookup"><span data-stu-id="122a9-172">Other attributes that have a **searchFlags** attribute value that contains 0x00000008 are also retained.</span></span>

    <span data-ttu-id="122a9-173">Os seguintes valores de atributo são sempre removidos de um objeto excluído:</span><span class="sxs-lookup"><span data-stu-id="122a9-173">The following attribute values are always removed from a deleted object:</span></span>

    -   <span data-ttu-id="122a9-174">**objectCategory**</span><span class="sxs-lookup"><span data-stu-id="122a9-174">**objectCategory**</span></span>
    -   <span data-ttu-id="122a9-175">**samAccountType**</span><span class="sxs-lookup"><span data-stu-id="122a9-175">**samAccountType**</span></span>

-   <span data-ttu-id="122a9-176">O descritor de segurança do objeto excluído é retido e as entradas de controle de acesso herdáveis não são propagadas.</span><span class="sxs-lookup"><span data-stu-id="122a9-176">The security descriptor of the deleted object is retained and inheritable access control entries are not propagated.</span></span> <span data-ttu-id="122a9-177">O descritor de segurança é mantido como está no momento em que o objeto é excluído.</span><span class="sxs-lookup"><span data-stu-id="122a9-177">The security descriptor is retained as-is at the time the object is deleted.</span></span>
-   <span data-ttu-id="122a9-178">Os links para e do objeto excluído são apagados.</span><span class="sxs-lookup"><span data-stu-id="122a9-178">Links to and from the deleted object are cleared.</span></span> <span data-ttu-id="122a9-179">Isso é executado em segundo plano depois que o objeto é excluído.</span><span class="sxs-lookup"><span data-stu-id="122a9-179">This is performed in the background after the object is deleted.</span></span> <span data-ttu-id="122a9-180">Se o objeto excluído for restaurado antes que todos os links sejam limpos, um erro será recebido.</span><span class="sxs-lookup"><span data-stu-id="122a9-180">If the deleted object is restored before all of the links are cleared, an error will be received.</span></span>
-   <span data-ttu-id="122a9-181">Se o objeto for excluído em um controlador de domínio do Windows Server 2003, o atributo **lastKnownParent** do objeto excluído será definido como o nome distinto do contêiner em que o objeto foi contido quando ele foi excluído.</span><span class="sxs-lookup"><span data-stu-id="122a9-181">If the object is deleted on a Windows Server 2003 domain controller, the **lastKnownParent** attribute of the deleted object is set to the distinguished name of the container where the object was contained when it was deleted.</span></span>

<span data-ttu-id="122a9-182">O objeto excluído permanece no contêiner objetos excluídos por um período de tempo conhecido como a *vida útil da marca de exclusão*.</span><span class="sxs-lookup"><span data-stu-id="122a9-182">The deleted object remains in the Deleted Objects container for a period of time known as the *tombstone lifetime*.</span></span> <span data-ttu-id="122a9-183">Por padrão, o tempo de vida da marca para exclusão é de 60 dias, mas esse valor pode ser alterado pelo administrador do sistema.</span><span class="sxs-lookup"><span data-stu-id="122a9-183">By default, the tombstone lifetime is 60 days, but this value can be changed by the system administrator.</span></span> <span data-ttu-id="122a9-184">Depois que o tempo de vida da marca de exclusão expirar, o objeto será removido permanentemente do serviço de diretório.</span><span class="sxs-lookup"><span data-stu-id="122a9-184">After the tombstone lifetime expires, the object is permanently removed from the Directory Service.</span></span> <span data-ttu-id="122a9-185">Para evitar a falta de uma operação de exclusão, um aplicativo deve executar sincronizações incrementais com mais frequência do que o tempo de vida da marca de exclusão.</span><span class="sxs-lookup"><span data-stu-id="122a9-185">To avoid missing a delete operation, an application must perform incremental synchronizations more frequently than the tombstone lifetime.</span></span>

<span data-ttu-id="122a9-186">O Windows Server 2003 adiciona a capacidade de restaurar objetos excluídos.</span><span class="sxs-lookup"><span data-stu-id="122a9-186">Windows Server 2003 adds the ability to restore deleted objects.</span></span> <span data-ttu-id="122a9-187">Para obter mais informações sobre a restauração de objetos excluídos, consulte [restaurando objetos excluídos](restoring-deleted-objects.md).</span><span class="sxs-lookup"><span data-stu-id="122a9-187">For more information about deleted object restoration, see [Restoring Deleted Objects](restoring-deleted-objects.md).</span></span>

<span data-ttu-id="122a9-188">Quando um item é excluído, nenhum dos atributos do objeto pode ser modificado.</span><span class="sxs-lookup"><span data-stu-id="122a9-188">When an item is deleted, none of the attributes of the object can be modified.</span></span> <span data-ttu-id="122a9-189">No Windows Server 2003, é possível modificar o descritor de segurança (o atributo **ntSecurityDescriptor** ) em um objeto excluído.</span><span class="sxs-lookup"><span data-stu-id="122a9-189">In Windows Server 2003, it is possible to modify the security descriptor (the **ntSecurityDescriptor** attribute) on a deleted object.</span></span> <span data-ttu-id="122a9-190">Isso é para permitir a restauração de objetos quando a pessoa que está restaurando o objeto não tem permissões de gravação para atributos obrigatórios.</span><span class="sxs-lookup"><span data-stu-id="122a9-190">This is to allow restoration of objects when the person restoring the object does not have write permissions to mandatory attributes.</span></span> <span data-ttu-id="122a9-191">Para atualizar o descritor de segurança em um objeto excluído, o chamador deve ter o direito de acesso de controle "reanimar a marca de exclusão" no contexto de nomenclatura, além do **\_ DAC de gravação** regular e do acesso de **\_ proprietário de gravação** .</span><span class="sxs-lookup"><span data-stu-id="122a9-191">To update the security descriptor on a deleted object, the caller must have the "Reanimate Tombstone" control access right on the naming context, in addition to regular **WRITE\_DAC** and **WRITE\_OWNER** access.</span></span> <span data-ttu-id="122a9-192">Mesmo que o descritor de segurança seja restritivo, o administrador pode primeiro assumir a propriedade do objeto, supondo que o administrador tenha o privilégio se você tem o **\_ \_ \_ nome de propriedade** e, em seguida, modifique o descritor de segurança.</span><span class="sxs-lookup"><span data-stu-id="122a9-192">Even if the security descriptor is restrictive, the administrator can first take ownership of the object, assuming the administrator has the **SE\_TAKE\_OWNERSHIP\_NAME** privilege, and then modify the security descriptor.</span></span> <span data-ttu-id="122a9-193">Para fazer isso, use a [**função \_ LDAP \_ Modify \_ ext**](/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_modify_ext_s) com o [**servidor LDAP \_ Mostrar controle de \_ \_ \_ OID excluído**](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) .</span><span class="sxs-lookup"><span data-stu-id="122a9-193">To do this, use the [**ldap\_modify\_ext\_s**](/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_modify_ext_s) function with the [**LDAP\_SERVER\_SHOW\_DELETED\_OID**](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) control.</span></span> <span data-ttu-id="122a9-194">A lista de modificação deve conter uma única substituição de atributo para o atributo **ntSecurityDescriptor** .</span><span class="sxs-lookup"><span data-stu-id="122a9-194">The modification list must contain a single attribute replacement for the **ntSecurityDescriptor** attribute.</span></span>

 

 