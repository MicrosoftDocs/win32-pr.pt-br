---
title: Active Directory folhas de propriedades de usuários e computadores
description: O snap-in Active Directory usuários e computadores do MMC foi projetado para exibir uma folha de propriedades para vários objetos em um servidor Active Directory.
ms.assetid: 38032d89-9549-475c-90aa-dac5cfe11084
ms.tgt_platform: multiple
keywords:
- Active Directory folhas de propriedades de usuários e computadores AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 30ea24f34e86f21af178e975852accb667bb69e4
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "103640441"
---
# <a name="active-directory-users-and-computers-property-sheets"></a><span data-ttu-id="1d757-104">Active Directory folhas de propriedades de usuários e computadores</span><span class="sxs-lookup"><span data-stu-id="1d757-104">Active Directory Users and Computers Property Sheets</span></span>

<span data-ttu-id="1d757-105">O snap-in Active Directory usuários e computadores do MMC foi projetado para exibir uma folha de propriedades para vários objetos em um servidor Active Directory.</span><span class="sxs-lookup"><span data-stu-id="1d757-105">The Active Directory Users and Computers MMC snap-in is designed to display a property sheet for various objects in an Active Directory server.</span></span> <span data-ttu-id="1d757-106">A folha de propriedades contém uma ou mais páginas que são usadas para exibir e modificar dados de objeto.</span><span class="sxs-lookup"><span data-stu-id="1d757-106">The property sheet contains one or more pages that are used to view and modify object data.</span></span> <span data-ttu-id="1d757-107">Diferentes tipos de objeto têm conjuntos diferentes de páginas exibidas para eles.</span><span class="sxs-lookup"><span data-stu-id="1d757-107">Different object types have different sets of pages displayed for them.</span></span> <span data-ttu-id="1d757-108">O snap-in Active Directory usuários e computadores do MMC também permite que fornecedores de terceiros adicionem páginas personalizadas à folha de propriedades para um tipo específico de objeto.</span><span class="sxs-lookup"><span data-stu-id="1d757-108">The Active Directory Users and Computers MMC snap-in also enables third party vendors to add custom pages to the property sheet for a specific type of object.</span></span> <span data-ttu-id="1d757-109">Para obter mais informações, consulte [páginas de propriedades para uso com especificadores de exibição](property-pages-for-use-with-display-specifiers.md).</span><span class="sxs-lookup"><span data-stu-id="1d757-109">For more information, see [Property Pages for Use with Display Specifiers](property-pages-for-use-with-display-specifiers.md).</span></span>

<span data-ttu-id="1d757-110">Alguns aplicativos, além do snap-in Active Directory usuários e computadores do MMC, devem fornecer ao usuário o modo de exibição de capacidade e editar os atributos de um objeto em um servidor Active Directory.</span><span class="sxs-lookup"><span data-stu-id="1d757-110">Some applications, other than the Active Directory Users and Computers MMC snap-in, must provide the user with the ability view and edit attributes for an object in an Active Directory server.</span></span> <span data-ttu-id="1d757-111">O aplicativo poderia implementar suas próprias folhas de propriedades, mas é melhor oferecer uma interface de usuário consistente para reduzir a confusão e o tempo de aprendizagem.</span><span class="sxs-lookup"><span data-stu-id="1d757-111">The application could implement its own property sheets, but it is better to offer a consistent user interface to reduce confusion and learning time.</span></span> <span data-ttu-id="1d757-112">Felizmente, o snap-in do MMC Active Directory usuários e computadores permite que qualquer aplicativo COM OLE exiba uma folha de propriedades para um objeto que seja idêntico à folha de propriedades que seria exibida pelo snap-in do MMC Active Directory usuários e computadores para o mesmo objeto.</span><span class="sxs-lookup"><span data-stu-id="1d757-112">Fortunately, the Active Directory Users and Computers MMC snap-in allows any OLE COM application to display a property sheet for an object that is identical to the property sheet that would be displayed by the Active Directory Users and Computers MMC snap-in for the same object.</span></span>

<span data-ttu-id="1d757-113">Para obter mais informações e um exemplo de código que hospeda uma folha de propriedades usuários e computadores Active Directory, consulte o exemplo PropSheetHost no SDK (Software Development Kit) da plataforma.</span><span class="sxs-lookup"><span data-stu-id="1d757-113">For more information and a code example that hosts an Active Directory Users and Computers property sheet, see the PropSheetHost sample in the Platform Software Development Kit (SDK).</span></span>

## <a name="developer-audience"></a><span data-ttu-id="1d757-114">Público do desenvolvedor</span><span class="sxs-lookup"><span data-stu-id="1d757-114">Developer Audience</span></span>

<span data-ttu-id="1d757-115">Esta documentação pressupõe que o leitor esteja familiarizado com a operação COM e o desenvolvimento de componentes usando o C++.</span><span class="sxs-lookup"><span data-stu-id="1d757-115">This documentation assumes that the reader is familiar with COM operation and component development using C++.</span></span> <span data-ttu-id="1d757-116">Atualmente, não é possível criar uma extensão de folha de propriedades Active Directory usando Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="1d757-116">Currently, it is not possible to create an Active Directory property sheet extension using Visual Basic.</span></span>

## <a name="hosting-an-active-directory-users-and-computers-property-sheet"></a><span data-ttu-id="1d757-117">Como hospedar uma folha de propriedades de usuários e computadores Active Directory</span><span class="sxs-lookup"><span data-stu-id="1d757-117">Hosting an Active Directory Users and Computers Property Sheet</span></span>

<span data-ttu-id="1d757-118">**Para exibir uma folha de propriedades para um objeto em um servidor de Active Directory**</span><span class="sxs-lookup"><span data-stu-id="1d757-118">**To display a property sheet for an object in an Active Directory server**</span></span>

1.  <span data-ttu-id="1d757-119">Crie uma janela que possa ser usada para processar mensagens.</span><span class="sxs-lookup"><span data-stu-id="1d757-119">Create a window that can be used to process messages.</span></span> <span data-ttu-id="1d757-120">Isso pode ser uma janela existente ou uma janela de finalidade especial.</span><span class="sxs-lookup"><span data-stu-id="1d757-120">This can be an existing window or a special purpose window.</span></span> <span data-ttu-id="1d757-121">Isso é conhecido como a *janela oculta*.</span><span class="sxs-lookup"><span data-stu-id="1d757-121">This is known as the *hidden window*.</span></span>
2.  <span data-ttu-id="1d757-122">Crie um objeto OLE COM derivado de [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject).</span><span class="sxs-lookup"><span data-stu-id="1d757-122">Create an OLE COM object that is derived from [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject).</span></span> <span data-ttu-id="1d757-123">Este objeto de dados deve dar suporte aos seguintes formatos de dados:</span><span class="sxs-lookup"><span data-stu-id="1d757-123">This data object must support the following data formats:</span></span>

    -   <span data-ttu-id="1d757-124">[**CFSTR \_ DSOBJECTNAMES**](cfstr-dsobjectnames.md) esse formato de dados contém um [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) que identifica o objeto ao qual a folha de propriedades se aplica.</span><span class="sxs-lookup"><span data-stu-id="1d757-124">[**CFSTR\_DSOBJECTNAMES**](cfstr-dsobjectnames.md) This data format contains a [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) that identifies the object that the property sheet applies to.</span></span> <span data-ttu-id="1d757-125">Ao hospedar uma folha de propriedades, os membros mais significativos da estrutura **DSOBJECTNAMES** são mostrados na lista a seguir.</span><span class="sxs-lookup"><span data-stu-id="1d757-125">When hosting a property sheet, the more significant members of the **DSOBJECTNAMES** structure are shown in the following list.</span></span>

        <span data-ttu-id="1d757-126">**clsidNamespace** Reservado.</span><span class="sxs-lookup"><span data-stu-id="1d757-126">**clsidNamespace** Reserved.</span></span> <span data-ttu-id="1d757-127">Defina isso para um GUID para seu aplicativo aqui caso ele seja usado no futuro.</span><span class="sxs-lookup"><span data-stu-id="1d757-127">Set this to a GUID for your application here in case that it is used in the future.</span></span>
        
        <span data-ttu-id="1d757-128">**aObjects** Contém uma matriz de estruturas [**DSBOJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) .</span><span class="sxs-lookup"><span data-stu-id="1d757-128">**aObjects** Contains an array of [**DSBOJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) structures.</span></span> <span data-ttu-id="1d757-129">Cada estrutura **DSBOJECT** representa um único objeto de diretório.</span><span class="sxs-lookup"><span data-stu-id="1d757-129">Each **DSBOJECT** structure represents a single directory object.</span></span> <span data-ttu-id="1d757-130">O membro **cItems** contém o número de elementos na matriz.</span><span class="sxs-lookup"><span data-stu-id="1d757-130">The **cItems** member contains the number of elements in the array.</span></span> <span data-ttu-id="1d757-131">Somente o primeiro objeto nessa matriz é usado.</span><span class="sxs-lookup"><span data-stu-id="1d757-131">Only the first object in this array is used.</span></span> <span data-ttu-id="1d757-132">Outros objetos são ignorados.</span><span class="sxs-lookup"><span data-stu-id="1d757-132">Other objects are ignored.</span></span>

    -   <span data-ttu-id="1d757-133">[**CFSTR \_ DSDISPLAYSPECOPTIONS**](cfstr-ds-display-spec-options.md) esse formato de dados contém uma estrutura [**DSDISPLAYSPECOPTIONS**](/windows/desktop/api/Dsclient/ns-dsclient-dsdisplayspecoptions) que contém dados que serão usados pelas páginas de propriedades, como para onde carregar as páginas de propriedades, o servidor e as credenciais a serem usadas e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="1d757-133">[**CFSTR\_DSDISPLAYSPECOPTIONS**](cfstr-ds-display-spec-options.md) This data format contains a [**DSDISPLAYSPECOPTIONS**](/windows/desktop/api/Dsclient/ns-dsclient-dsdisplayspecoptions) structure that contains data that will be used by the property pages, such as where to load the property pages from, the server and credentials to use, and so on.</span></span> <span data-ttu-id="1d757-134">Os membros mais significativos do **DSDISPLAYSPECOPTIONS** são mostrados na lista a seguir.</span><span class="sxs-lookup"><span data-stu-id="1d757-134">The more significant members of the **DSDISPLAYSPECOPTIONS** are shown in the following list.</span></span>

        <span data-ttu-id="1d757-135">**offsetAttribPrefix** A cadeia de caracteres de prefixo de atributo determina onde a lista de páginas de propriedades é obtida.</span><span class="sxs-lookup"><span data-stu-id="1d757-135">**offsetAttribPrefix** The attribute prefix string determines where the list of property pages is obtained.</span></span> <span data-ttu-id="1d757-136">Isso deve conter uma das cadeias de caracteres a seguir.</span><span class="sxs-lookup"><span data-stu-id="1d757-136">This must contain one of the following strings.</span></span>

        

        | <span data-ttu-id="1d757-137">Cadeia de prefixo de atributo</span><span class="sxs-lookup"><span data-stu-id="1d757-137">Attribute prefix string</span></span> | <span data-ttu-id="1d757-138">Descrição</span><span class="sxs-lookup"><span data-stu-id="1d757-138">Description</span></span>                                              |
        |-------------------------|----------------------------------------------------------------------------------------------------------------------|
        | <span data-ttu-id="1d757-139">ADM</span><span class="sxs-lookup"><span data-stu-id="1d757-139">"admin"</span></span><br/>      | <span data-ttu-id="1d757-140">As páginas de propriedades são carregadas do atributo [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) .</span><span class="sxs-lookup"><span data-stu-id="1d757-140">The property pages are loaded from the [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) attribute.</span></span><br/> |
        | <span data-ttu-id="1d757-141">Shell</span><span class="sxs-lookup"><span data-stu-id="1d757-141">"shell"</span></span><br/>      | <span data-ttu-id="1d757-142">As páginas de propriedades são carregadas do atributo [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) .</span><span class="sxs-lookup"><span data-stu-id="1d757-142">The property pages are loaded from the [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) attribute.</span></span><br/> |

        


    -   <span data-ttu-id="1d757-143">[**CFSTR \_ DS \_ PROPSHEETCONFIG**](cfstr-ds-propsheetconfig.md) este formato de dados contém uma estrutura [**PROPSHEETCFG**](propsheetcfg.md) que contém dados de host da folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="1d757-143">[**CFSTR\_DS\_PROPSHEETCONFIG**](cfstr-ds-propsheetconfig.md) This data format contains a [**PROPSHEETCFG**](propsheetcfg.md) structure that contains property sheet host data.</span></span> <span data-ttu-id="1d757-144">Ao hospedar uma folha de propriedades, os membros mais significativos da estrutura **PROPSHEETCFG** contêm os dados mostrados na lista a seguir.</span><span class="sxs-lookup"><span data-stu-id="1d757-144">When hosting a property sheet, the more significant members of the **PROPSHEETCFG** structure contain the data shown in the following list.</span></span>

        <span data-ttu-id="1d757-145">**lNotifyHandle** Deve ser zero.</span><span class="sxs-lookup"><span data-stu-id="1d757-145">**lNotifyHandle** Must be zero.</span></span>
        <span data-ttu-id="1d757-146">**hwndParentSheet**  Contém o identificador da janela para receber mensagens [**de \_ \_ \_ alteração de notificação do WM ADSPROP**](wm-adsprop-notify-change.md) quando algo em uma das páginas é alterado e é aplicado.</span><span class="sxs-lookup"><span data-stu-id="1d757-146">**hwndParentSheet**  Contains the handle of the window to receive [**WM\_ADSPROP\_NOTIFY\_CHANGE**](wm-adsprop-notify-change.md) messages when something in one of the pages changes and is applied.</span></span> <span data-ttu-id="1d757-147">Pode ser **NULL** se esta mensagem não for desejada.</span><span class="sxs-lookup"><span data-stu-id="1d757-147">Can be **NULL** if this message is not desired.</span></span>

        <span data-ttu-id="1d757-148">**hwndHidden** Contém o identificador da janela para receber o [**WM \_ DSA \_ folha \_ criar \_ notificação**](wm-dsa-sheet-create-notify.md) e o [**WM \_ DSA \_ folha \_ fechar \_ notificar**](wm-dsa-sheet-close-notify.md) mensagens.</span><span class="sxs-lookup"><span data-stu-id="1d757-148">**hwndHidden** Contains the handle of the window to receive [**WM\_DSA\_SHEET\_CREATE\_NOTIFY**](wm-dsa-sheet-create-notify.md) and [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) messages.</span></span> <span data-ttu-id="1d757-149">Defina isso para o identificador da janela oculta.</span><span class="sxs-lookup"><span data-stu-id="1d757-149">Set this to the handle of your hidden window.</span></span>

        <span data-ttu-id="1d757-150">**wParamSheetClose** Contém um identificador definido pelo aplicativo que é retornado no *wParam* na [**\_ folha DSA do WM \_ \_ fechar \_**](wm-dsa-sheet-close-notify.md) mensagem de notificação.</span><span class="sxs-lookup"><span data-stu-id="1d757-150">**wParamSheetClose** Contains an application-defined identifier that is returned in the *wParam* in the [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) message.</span></span> <span data-ttu-id="1d757-151">Se esse membro for zero, a mensagem de **\_ notificação de \_ \_ fechamento \_ da folha DSA do WM** não será postada na janela oculta.</span><span class="sxs-lookup"><span data-stu-id="1d757-151">If this member is zero, the **WM\_DSA\_SHEET\_CLOSE\_NOTIFY** message will not be posted to the hidden window.</span></span>


3.  <span data-ttu-id="1d757-152">Crie uma instância do objeto [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) e obtenha a interface [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) para o objeto.</span><span class="sxs-lookup"><span data-stu-id="1d757-152">Create an instance of the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object and obtain the [**IShellExtInit**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) interface for the object.</span></span> <span data-ttu-id="1d757-153">Também é possível duplicar o comportamento do objeto **CLSID \_ DsPropertyPages** .</span><span class="sxs-lookup"><span data-stu-id="1d757-153">It is also possible to duplicate the behavior of the **CLSID\_DsPropertyPages** object.</span></span> <span data-ttu-id="1d757-154">Para obter mais informações, consulte duplicando o comportamento do \_ objeto CLSID DsPropertyPages.</span><span class="sxs-lookup"><span data-stu-id="1d757-154">For more information, see Duplicating the Behavior of the CLSID\_DsPropertyPages Object.</span></span>
4.  <span data-ttu-id="1d757-155">Inicialize o objeto [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) chamando o método [**IShellExtInit:: Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) .</span><span class="sxs-lookup"><span data-stu-id="1d757-155">Initialize the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object by calling the [**IShellExtInit::Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) method.</span></span> <span data-ttu-id="1d757-156">Os parâmetros *pidlFolder* e *hkeyProgID* não são usados neste método.</span><span class="sxs-lookup"><span data-stu-id="1d757-156">The *pidlFolder* and *hkeyProgID* parameters are not used in this method.</span></span> <span data-ttu-id="1d757-157">O parâmetro *pdtobj* é o ponteiro para o objeto de dados criado na etapa 2.</span><span class="sxs-lookup"><span data-stu-id="1d757-157">The *pdtobj* parameter is the pointer to the data object created in Step 2.</span></span> <span data-ttu-id="1d757-158">Quando o método **IShellExtInit:: Initialize** for chamado, o objeto **CLSID \_ DsPropertyPages** salvará uma referência ao objeto de dados.</span><span class="sxs-lookup"><span data-stu-id="1d757-158">When the **IShellExtInit::Initialize** method is called, the **CLSID\_DsPropertyPages** object will save a reference to the data object.</span></span>
5.  <span data-ttu-id="1d757-159">Obtenha a interface [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) para o objeto [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) e chame o método [**IShellPropSheetExt:: AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) .</span><span class="sxs-lookup"><span data-stu-id="1d757-159">Obtain the [**IShellPropSheetExt**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) interface for the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object and call the [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) method.</span></span> <span data-ttu-id="1d757-160">O parâmetro *lpfnAddPage* é o endereço de uma função de retorno de chamada que você deve implementar.</span><span class="sxs-lookup"><span data-stu-id="1d757-160">The *lpfnAddPage* parameter is the address of a callback function that you must implement.</span></span> <span data-ttu-id="1d757-161">O formato dessa função é mostrado abaixo.</span><span class="sxs-lookup"><span data-stu-id="1d757-161">The format of this function is shown below.</span></span> <span data-ttu-id="1d757-162">Se a função de retorno de chamada for declarada como um membro de uma classe C++, a função de retorno de chamada deverá ser declarada como **estática**.</span><span class="sxs-lookup"><span data-stu-id="1d757-162">If the callback function is declared as a member of a C++ class, the callback function must be declared as **static**.</span></span> <span data-ttu-id="1d757-163">O parâmetro *lParam* é um valor definido pelo aplicativo que pode ser usado para identificar o objeto que implementa a função de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="1d757-163">The *lParam* parameter is an application-defined value that can be used to identify the object that implements the callback function.</span></span> <span data-ttu-id="1d757-164">Quando o método **IShellPropSheetExt:: AddPages** for chamado, o objeto **CLSID \_ DsPropertyPages** obterá os dados do objeto de dados e enumerará as páginas de propriedades registradas para os especificadores de exibição de objeto.</span><span class="sxs-lookup"><span data-stu-id="1d757-164">When the **IShellPropSheetExt::AddPages** method is called, the **CLSID\_DsPropertyPages** object will obtain the data from the data object and enumerate the property pages registered for the object display specifiers.</span></span> <span data-ttu-id="1d757-165">O objeto **CLSID \_ DsPropertyPages** enumerará os objetos da página de propriedades, chamando o método **IShellPropSheetExt:: AddPages** de cada objeto.</span><span class="sxs-lookup"><span data-stu-id="1d757-165">The **CLSID\_DsPropertyPages** object will then enumerate the property page objects, calling each object's **IShellPropSheetExt::AddPages** method.</span></span>

    ```C++
    BOOL CALLBACK AddPagesCallback(HPROPSHEETPAGE, LPARAM)
    ```

    

6.  <span data-ttu-id="1d757-166">Cada página adicionada pelos objetos da página de propriedades resultará na chamada da sua função de retorno com o identificador para a página de propriedades e o valor definido pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="1d757-166">Each page added by the property page objects will result in your callback function being called with the handle to the property page and the application-defined value.</span></span> <span data-ttu-id="1d757-167">Sua função de retorno de chamada deve armazenar cada identificador de página de propriedade que é passado.</span><span class="sxs-lookup"><span data-stu-id="1d757-167">Your callback function must store each property page handle that is passed.</span></span> <span data-ttu-id="1d757-168">Quando o método [**IShellPropSheetExt:: AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) do objeto [**\_ DsPropertyPages do CLSID**](guids-of-user-interface-elements.md) for retornado, todas as páginas terão sido adicionadas por meio de sua função de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="1d757-168">When the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object's [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) method returns, all pages will have been added via your callback function.</span></span>
7.  <span data-ttu-id="1d757-169">Preencha uma estrutura [**PROPSHEETHEADER**](/windows/win32/api/prsht/ns-prsht-propsheetheadera_v2) para exibir a folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="1d757-169">Fill in a [**PROPSHEETHEADER**](/windows/win32/api/prsht/ns-prsht-propsheetheadera_v2) structure to display the property sheet.</span></span> <span data-ttu-id="1d757-170">O membro **phpage** recebe um ponteiro para uma matriz de identificadores de página que foram coletados pela função de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="1d757-170">The **phpage** member receives a pointer to an array of page handles that were collected by your callback function.</span></span> <span data-ttu-id="1d757-171">O membro **nPages** recebe o número de páginas na matriz de identificadores de página.</span><span class="sxs-lookup"><span data-stu-id="1d757-171">The **nPages** member receives the number of pages in the page handle array.</span></span>
8.  <span data-ttu-id="1d757-172">Exiba a folha de propriedades chamando a função [**folha**](/windows/win32/api/prsht/nf-prsht-propertysheeta) .</span><span class="sxs-lookup"><span data-stu-id="1d757-172">Display the property sheet by calling the [**PropertySheet**](/windows/win32/api/prsht/nf-prsht-propertysheeta) function.</span></span>

<span data-ttu-id="1d757-173">Se os dados em qualquer página forem alterados e os botões **OK** ou **aplicar** forem clicados, a janela identificada pelo membro **hwndParentSheet** da estrutura [**PROPSHEETCFG**](propsheetcfg.md) receberá uma mensagem de [**\_ \_ \_ alteração de notificação do WM ADSPROP**](wm-adsprop-notify-change.md) .</span><span class="sxs-lookup"><span data-stu-id="1d757-173">If the data in any page is changed and the **OK** or **Apply** buttons are clicked, the window identified by the **hwndParentSheet** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure will receive a [**WM\_ADSPROP\_NOTIFY\_CHANGE**](wm-adsprop-notify-change.md) message.</span></span> <span data-ttu-id="1d757-174">Essa mensagem é estritamente uma notificação e não requer nenhuma ação específica.</span><span class="sxs-lookup"><span data-stu-id="1d757-174">This message is strictly a notification and requires no specific action.</span></span>

<span data-ttu-id="1d757-175">Quando a página for fechada, a janela identificada pelo membro **hwndHidden** da estrutura [**PROPSHEETCFG**](propsheetcfg.md) receberá uma mensagem [**de \_ \_ notificação de \_ fechamento \_ da folha DSA do WM**](wm-dsa-sheet-close-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="1d757-175">When the page is closed, the window identified by the **hwndHidden** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure will receive a [**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**](wm-dsa-sheet-close-notify.md) message.</span></span> <span data-ttu-id="1d757-176">Essa mensagem é estritamente uma notificação e não requer nenhuma ação específica a ser executada.</span><span class="sxs-lookup"><span data-stu-id="1d757-176">This message is strictly a notification and requires no specific action to be performed.</span></span>

<span data-ttu-id="1d757-177">Em alguns casos, as folhas de propriedades existentes precisarão exibir uma folha de propriedades secundária.</span><span class="sxs-lookup"><span data-stu-id="1d757-177">In some cases, the existing property sheets will need to display a secondary property sheet.</span></span> <span data-ttu-id="1d757-178">Por exemplo, se você exibir a folha de propriedades de um objeto de usuário e selecionar o **membro da** página, uma lista de grupos dos quais o usuário é membro será exibida.</span><span class="sxs-lookup"><span data-stu-id="1d757-178">For example, if you display the property sheet for a user object and select the **Member Of** page, a list of groups that the user is a member of will be displayed.</span></span> <span data-ttu-id="1d757-179">Se você clicar duas vezes em um desses grupos na lista, a folha de propriedades desse grupo será exibida.</span><span class="sxs-lookup"><span data-stu-id="1d757-179">If you double-click one of these groups in the list, the property sheet for that group will be displayed.</span></span> <span data-ttu-id="1d757-180">A folha de propriedades primária não exibe a planilha secundária por si só.</span><span class="sxs-lookup"><span data-stu-id="1d757-180">The primary property sheet does not display the secondary sheet by itself.</span></span> <span data-ttu-id="1d757-181">Ele solicita que o host exiba a planilha secundária enviando uma folha de dados do [**WM \_ DSA \_ \_ criar \_ notificação**](wm-dsa-sheet-create-notify.md) para a janela identificada pelo membro **hwndHidden** da estrutura [**PROPSHEETCFG**](propsheetcfg.md) .</span><span class="sxs-lookup"><span data-stu-id="1d757-181">It requests that the host display the secondary sheet by sending a [**WM\_DSA\_SHEET\_CREATE\_NOTIFY**](wm-dsa-sheet-create-notify.md) message to the window identified by the **hwndHidden** member of the [**PROPSHEETCFG**](propsheetcfg.md) structure.</span></span> <span data-ttu-id="1d757-182">O *wParam* da **folha do DSA do WM \_ \_ \_ criar \_ notificação** é um ponteiro para uma estrutura de [**\_ \_ \_ informações da página DSA s**](dsa-sec-page-info.md) que contém informações sobre a folha de propriedades secundária e o objeto que ela representa.</span><span class="sxs-lookup"><span data-stu-id="1d757-182">The *wParam* of the **WM\_DSA\_SHEET\_CREATE\_NOTIFY** message is a pointer to a [**DSA\_SEC\_PAGE\_INFO**](dsa-sec-page-info.md) structure that contains information about the secondary property sheet and the object that it represents.</span></span> <span data-ttu-id="1d757-183">Em resposta a essa mensagem, o host da folha de propriedades deve exibir a folha de propriedades secundária da mesma maneira que mostrado acima.</span><span class="sxs-lookup"><span data-stu-id="1d757-183">In response to this message, the property sheet host must display the secondary property sheet in the same manner as shown above.</span></span> <span data-ttu-id="1d757-184">Depois de processar a mensagem de **notificação de \_ \_ \_ criação \_ da folha DSA do WM** , o receptor da mensagem deve liberar a estrutura de **\_ \_ \_ informações da página DSA s** , passando o valor *wParam* para a função [**LocalFree**](/windows/desktop/api/winbase/nf-winbase-localfree) .</span><span class="sxs-lookup"><span data-stu-id="1d757-184">After processing the **WM\_DSA\_SHEET\_CREATE\_NOTIFY** message, the message receiver must free the **DSA\_SEC\_PAGE\_INFO** structure by passing the *wParam* value to the [**LocalFree**](/windows/desktop/api/winbase/nf-winbase-localfree) function.</span></span>

## <a name="duplicating-the-behavior-of-the-clsid_dspropertypages-object"></a><span data-ttu-id="1d757-185">Duplicando o comportamento do objeto CLSID \_ DsPropertyPages</span><span class="sxs-lookup"><span data-stu-id="1d757-185">Duplicating the Behavior of the CLSID\_DsPropertyPages Object</span></span>

<span data-ttu-id="1d757-186">**Para duplicar o comportamento do \_ objeto CLSID DsPropertyPages**</span><span class="sxs-lookup"><span data-stu-id="1d757-186">**To duplicate the behavior of the CLSID\_DsPropertyPages object**</span></span>

1.  <span data-ttu-id="1d757-187">Enumere os valores no atributo [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) ou [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) para o especificador de exibição para a classe de objeto.</span><span class="sxs-lookup"><span data-stu-id="1d757-187">Enumerate the values in the [**adminPropertyPages**](/windows/desktop/ADSchema/a-adminpropertypages) or [**shellPropertyPages**](/windows/desktop/ADSchema/a-shellpropertypages) attribute for the display specifier for the object class.</span></span> <span data-ttu-id="1d757-188">Cada valor é uma cadeia de caracteres que contém um número, seguido por uma vírgula, seguida pela representação da cadeia de caracteres do identificador de classe da extensão da página de propriedades.</span><span class="sxs-lookup"><span data-stu-id="1d757-188">Each value is a string that contains a number, followed by a comma, followed by the string representation of the class identifier of the property page extension.</span></span> <span data-ttu-id="1d757-189">Para obter mais informações sobre o formato das páginas de propriedades exibir valores de especificador, consulte [registrando o objeto com da página de propriedades em um especificador de exibição](registering-the-property-page-com-object-in-a-display-specifier.md).</span><span class="sxs-lookup"><span data-stu-id="1d757-189">For more information about the format of the property pages display specifier values, see [Registering the Property Page COM Object in a Display Specifier](registering-the-property-page-com-object-in-a-display-specifier.md).</span></span>
2.  <span data-ttu-id="1d757-190">Converta cada cadeia de caracteres de identificador de classe em um **CLSID** usando a função [**CLSIDFromString**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="1d757-190">Convert each class identifier string into a **CLSID** using the [**CLSIDFromString**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>
3.  <span data-ttu-id="1d757-191">Classifique os identificadores de classe de extensão pelo número que precede cada cadeia de caracteres de identificador de classe no valor do atributo.</span><span class="sxs-lookup"><span data-stu-id="1d757-191">Sort the extension class identifiers by the number that precedes each class identifier string in the attribute value.</span></span> <span data-ttu-id="1d757-192">Se dois números forem idênticos, classifique os identificadores de classe na ordem em que os valores de atributo são obtidos do servidor de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="1d757-192">If two numbers are identical, sort the class identifiers in the order that the attribute values are obtained from the Active Directory server.</span></span>
4.  <span data-ttu-id="1d757-193">Enumere os identificadores de classe de extensão, criando uma instância de cada extensão.</span><span class="sxs-lookup"><span data-stu-id="1d757-193">Enumerate the extension class identifiers, creating an instance of each extension.</span></span>
5.  <span data-ttu-id="1d757-194">Para cada extensão, na ordem classificada acima, chame o [**IShellExtInit:: Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) da extensão com as mesmas informações descritas na etapa 4 do procedimento de folha de propriedades usuários e computadores de Active Directory hospedagem.</span><span class="sxs-lookup"><span data-stu-id="1d757-194">For each extension, in the order sorted above, call the extension's [**IShellExtInit::Initialize**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) with the same information described in Step 4 of the Hosting an Active Directory Users and Computers Property Sheet procedure.</span></span>
6.  <span data-ttu-id="1d757-195">Para cada extensão, na ordem classificada acima, chame as [**paginações IShellPropSheetExt::**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) addda extensão com as mesmas informações descritas na etapa 5 do procedimento de folha de propriedades usuários e computadores Active Directory de hospedagem.</span><span class="sxs-lookup"><span data-stu-id="1d757-195">For each extension, in the order sorted above, call the extension's [**IShellPropSheetExt::AddPages**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) with the same information described in Step 5 of the Hosting an Active Directory Users and Computers Property Sheet procedure.</span></span>

<span data-ttu-id="1d757-196">Se possível, use o objeto [**CLSID \_ DsPropertyPages**](guids-of-user-interface-elements.md) para criar as páginas em vez de fazer isso manualmente.</span><span class="sxs-lookup"><span data-stu-id="1d757-196">If possible, use the [**CLSID\_DsPropertyPages**](guids-of-user-interface-elements.md) object to create the pages rather than do this manually.</span></span> <span data-ttu-id="1d757-197">O **CLSID \_ DsPropertyPages** foi otimizado e manipulará corretamente os casos de falha, como quando nenhum especificador de exibição está disponível para a localidade atual.</span><span class="sxs-lookup"><span data-stu-id="1d757-197">The **CLSID\_DsPropertyPages** has been optimized and will correctly handle failure cases, such as when no display specifier is available for the current locale.</span></span> <span data-ttu-id="1d757-198">Além disso, o objeto **CLSID \_ DsPropertyPages** pode mudar no futuro, o que significa que suas folhas de propriedades podem não corresponder exatamente às exibidas pelo snap-in do MMC Active Directory usuários e computadores.</span><span class="sxs-lookup"><span data-stu-id="1d757-198">Also, the **CLSID\_DsPropertyPages** object may change in the future, which means your property sheets may not exactly match those displayed by the Active Directory Users and Computers MMC snap-in.</span></span>

## <a name="special-programming-elements"></a><span data-ttu-id="1d757-199">Elementos de programação especiais</span><span class="sxs-lookup"><span data-stu-id="1d757-199">Special Programming Elements</span></span>

<span data-ttu-id="1d757-200">Atualmente, os seguintes elementos de programação não estão definidos em um arquivo de cabeçalho publicado.</span><span class="sxs-lookup"><span data-stu-id="1d757-200">Currently, the following programming elements are not defined in a published header file.</span></span> <span data-ttu-id="1d757-201">Para usar esses elementos, você mesmo deve defini-los no formato exato mostrado na página de referência específica.</span><span class="sxs-lookup"><span data-stu-id="1d757-201">To use these elements, you must define them yourself in the exact format shown in the particular reference page.</span></span>

-   [<span data-ttu-id="1d757-202">**CFSTR \_ DS \_ PROPSHEETCONFIG**</span><span class="sxs-lookup"><span data-stu-id="1d757-202">**CFSTR\_DS\_PROPSHEETCONFIG**</span></span>](cfstr-ds-propsheetconfig.md)
-   [<span data-ttu-id="1d757-203">**PROPSHEETCFG**</span><span class="sxs-lookup"><span data-stu-id="1d757-203">**PROPSHEETCFG**</span></span>](propsheetcfg.md)
-   [<span data-ttu-id="1d757-204">**\_notificação de \_ fechamento da folha DSA \_ do WM \_**</span><span class="sxs-lookup"><span data-stu-id="1d757-204">**WM\_DSA\_SHEET\_CLOSE\_NOTIFY**</span></span>](wm-dsa-sheet-close-notify.md)
-   [<span data-ttu-id="1d757-205">**\_notificação de \_ criação da folha DSA \_ do WM \_**</span><span class="sxs-lookup"><span data-stu-id="1d757-205">**WM\_DSA\_SHEET\_CREATE\_NOTIFY**</span></span>](wm-dsa-sheet-create-notify.md)
-   [<span data-ttu-id="1d757-206">**\_ \_ informações da página DSA SEC \_**</span><span class="sxs-lookup"><span data-stu-id="1d757-206">**DSA\_SEC\_PAGE\_INFO**</span></span>](dsa-sec-page-info.md)

## <a name="example-code"></a><span data-ttu-id="1d757-207">Código de exemplo</span><span class="sxs-lookup"><span data-stu-id="1d757-207">Example Code</span></span>

<span data-ttu-id="1d757-208">O exemplo de código C++ a seguir mostra uma maneira segura de definir esses elementos que continuarão a funcionar mesmo que esses elementos sejam definidos em um arquivo de cabeçalho publicado no futuro.</span><span class="sxs-lookup"><span data-stu-id="1d757-208">The following C++ code example shows a safe way to define these elements that will continue to work even if these elements are defined in a published header file in the future.</span></span>


```C++
#ifndef CFSTR_DS_PROPSHEETCONFIG
    #define CFSTR_DS_PROPSHEETCONFIG_W L"DsPropSheetCfgClipFormat"
    #define CFSTR_DS_PROPSHEETCONFIG_A "DsPropSheetCfgClipFormat"

    #ifdef UNICODE
        #define CFSTR_DS_PROPSHEETCONFIG CFSTR_DS_PROPSHEETCONFIG_W
    #else
        #define CFSTR_DS_PROPSHEETCONFIG CFSTR_DS_PROPSHEETCONFIG_A
    #endif //UNICODE
#endif //CFSTR_DS_PROPSHEETCONFIG


#ifndef WM_ADSPROP_SHEET_CREATE
    #define WM_ADSPROP_SHEET_CREATE (WM_USER + 1108)
#endif


#ifndef WM_DSA_SHEET_CREATE_NOTIFY
    #define WM_DSA_SHEET_CREATE_NOTIFY (WM_USER + 6)
#endif


#ifndef WM_DSA_SHEET_CLOSE_NOTIFY
    #define WM_DSA_SHEET_CLOSE_NOTIFY (WM_USER + 5) 
#endif


#ifndef DSA_SEC_PAGE_INFO
    typedef struct _DSA_SEC_PAGE_INFO
    {
        HWND    hwndParentSheet;
        DWORD   offsetTitle;
        DSOBJECTNAMES dsObjectNames;
    } DSA_SEC_PAGE_INFO, *PDSA_SEC_PAGE_INFO;
#endif //DSA_SEC_PAGE_INFO

#ifndef PROPSHEETCFG
    typedef struct _PROPSHEETCFG
    {  
        LONG_PTR lNotifyHandle;  
        HWND hwndParentSheet;  
        HWND hwndHidden;  
        WPARAM wParamSheetClose;
    } PROPSHEETCFG, *PPROPSHEETCFG;
#endif //PROPSHEETCFG
```



 

