---
title: Depurando uma extensão de Active Directory
description: As extensões da folha de propriedades do serviço de diretório do Microsoft Active Directory, do menu de contexto e do assistente de criação de objetos documentadas neste tópico são implementadas como servidores em processamento COM.
ms.assetid: 8c280084-fd2f-4d34-a119-d4e925a68a5c
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fc8d9646f4ccc2e8c740a81ddb48422881744f5
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "104007334"
---
# <a name="debugging-an-active-directory-extension"></a><span data-ttu-id="43f5c-103">Depurando uma extensão de Active Directory</span><span class="sxs-lookup"><span data-stu-id="43f5c-103">Debugging an Active Directory Extension</span></span>

<span data-ttu-id="43f5c-104">As extensões da folha de propriedades do serviço de diretório do Microsoft Active Directory, do menu de contexto e do assistente de criação de objetos documentadas neste tópico são implementadas como servidores em processamento COM.</span><span class="sxs-lookup"><span data-stu-id="43f5c-104">The Microsoft Active Directory directory service property sheet, context menu, and object creation wizard extensions documented in this topic are implemented as COM in-proc servers.</span></span> <span data-ttu-id="43f5c-105">Ou seja, cada extensão é uma DLL que é executada no contexto do processo do host.</span><span class="sxs-lookup"><span data-stu-id="43f5c-105">That is, each extension is a DLL that runs in the context of the host process.</span></span> <span data-ttu-id="43f5c-106">Para depurar a extensão, é necessário associar a extensão a um aplicativo e executar o aplicativo em um depurador.</span><span class="sxs-lookup"><span data-stu-id="43f5c-106">To debug the extension, it is necessary to associate the extension with an application and run the application in a debugger.</span></span>

## <a name="debugging-active-directory-extensions-displayed-in-the-windows-shell"></a><span data-ttu-id="43f5c-107">Depuração de extensões de Active Directory exibidas no Shell do Windows</span><span class="sxs-lookup"><span data-stu-id="43f5c-107">Debugging Active Directory Extensions Displayed in the Windows Shell</span></span>

<span data-ttu-id="43f5c-108">As extensões de Active Directory exibidas no Shell do Windows são carregadas no contexto do processo de Explorer.exe.</span><span class="sxs-lookup"><span data-stu-id="43f5c-108">Active Directory extensions displayed in the Windows shell are loaded in the context of the Explorer.exe process.</span></span> <span data-ttu-id="43f5c-109">Essas extensões podem ser depuradas como uma extensão de shell padrão.</span><span class="sxs-lookup"><span data-stu-id="43f5c-109">These extensions can be debugged like a standard shell extension.</span></span> <span data-ttu-id="43f5c-110">Para obter mais informações sobre depuração de extensões do Shell, consulte [Depurando com o Shell](/previous-versions/windows/desktop/legacy/cc144064(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="43f5c-110">For more information about debugging shell extensions, see [Debugging with the Shell](/previous-versions/windows/desktop/legacy/cc144064(v=vs.85)).</span></span>

## <a name="debugging-active-directory-extensions-displayed-in-the-active-directory-mmc-snap-ins"></a><span data-ttu-id="43f5c-111">Extensões de Active Directory de depuração exibidas no Active Directory MMC Snap-Ins</span><span class="sxs-lookup"><span data-stu-id="43f5c-111">Debugging Active Directory Extensions Displayed in the Active Directory MMC Snap-Ins</span></span>

<span data-ttu-id="43f5c-112">As extensões de Active Directory exibidas nos snap-ins administrativos do MMC do Active Directory são carregadas no contexto do console de gerenciamento Microsoft.</span><span class="sxs-lookup"><span data-stu-id="43f5c-112">Active Directory extensions displayed in the Active Directory administrative MMC snap-ins are loaded in the context of the Microsoft Management Console.</span></span> <span data-ttu-id="43f5c-113">Para depurar uma extensão, localize Mmc.exe no sistema local e defina o depurador para usá-lo como o aplicativo para depuração.</span><span class="sxs-lookup"><span data-stu-id="43f5c-113">To debug an extension, locate Mmc.exe on the local system and set the debugger to use this as the application for debugging.</span></span> <span data-ttu-id="43f5c-114">Na maioria dos sistemas, Mmc.exe está localizado no diretório de sistema do Windows, por exemplo, C: \\ WinNT \\ System32.</span><span class="sxs-lookup"><span data-stu-id="43f5c-114">On most systems, Mmc.exe is located in the Windows system directory, for example, C:\\WINNT\\System32.</span></span> <span data-ttu-id="43f5c-115">Dependendo do depurador, você pode ou não precisar definir a DLL de extensão como também sendo carregada pelo depurador.</span><span class="sxs-lookup"><span data-stu-id="43f5c-115">Depending on the debugger, you may or may not have to set the extension DLL to also be loaded by the debugger.</span></span> <span data-ttu-id="43f5c-116">Muitos depuradores também permitem anexar o depurador a um processo do MMC em execução.</span><span class="sxs-lookup"><span data-stu-id="43f5c-116">Many debuggers also allow you to attach the debugger to a running MMC process.</span></span> <span data-ttu-id="43f5c-117">Para obter mais informações, consulte o guia do usuário do depurador.</span><span class="sxs-lookup"><span data-stu-id="43f5c-117">For more information, see your debugger User's Guide.</span></span>

<span data-ttu-id="43f5c-118">Pode ser conveniente fazer com que o MMC carregue automaticamente um snap-in específico.</span><span class="sxs-lookup"><span data-stu-id="43f5c-118">It can be convenient to have MMC automatically load a specific snap-in.</span></span> <span data-ttu-id="43f5c-119">Para fazer isso, defina os argumentos do aplicativo como o caminho e o nome de arquivo de um arquivo MSC.</span><span class="sxs-lookup"><span data-stu-id="43f5c-119">To do this, set the application arguments to the path and file name of an MSC file.</span></span> <span data-ttu-id="43f5c-120">Pode ser um arquivo MSC instalado pelo sistema ou um que você criar.</span><span class="sxs-lookup"><span data-stu-id="43f5c-120">This can either be a system-installed MSC file or one you create.</span></span> <span data-ttu-id="43f5c-121">Um arquivo MSC pode ser criado seguindo estas etapas.</span><span class="sxs-lookup"><span data-stu-id="43f5c-121">An MSC file can be created by following these steps.</span></span>

1.  <span data-ttu-id="43f5c-122">Execute Mmc.exe.</span><span class="sxs-lookup"><span data-stu-id="43f5c-122">Run Mmc.exe.</span></span>
2.  <span data-ttu-id="43f5c-123">Carregue o snap-in desejado selecionando **arquivo**  -  **Adicionar/remover snap-in...** no menu do MMC e selecione o snap-in desejado.</span><span class="sxs-lookup"><span data-stu-id="43f5c-123">Load the desired snap-in by selecting **File** - **Add/Remove Snap-in...** in the MMC menu and select the desired snap-in.</span></span>
3.  <span data-ttu-id="43f5c-124">Salve o arquivo MSC selecionando **arquivo**  -  **salvar como...** no menu MMC.</span><span class="sxs-lookup"><span data-stu-id="43f5c-124">Save the MSC file by selecting **File** - **Save As...** in the MMC menu.</span></span>

<span data-ttu-id="43f5c-125">Se você não definir um arquivo MSC de inicialização, deverá carregar manualmente o snap-in desejado ao executar o aplicativo no depurador.</span><span class="sxs-lookup"><span data-stu-id="43f5c-125">If you do not set a start-up MSC file, you must manually load the desired snap-in when you run the application in the debugger.</span></span>

<span data-ttu-id="43f5c-126">Quando o aplicativo host é executado no depurador, o depurador pode exibir uma mensagem de aviso informando que o aplicativo que está sendo executado não contém nenhum símbolo de depuração.</span><span class="sxs-lookup"><span data-stu-id="43f5c-126">When the host application is run in the debugger, the debugger may display a warning message stating that the application being run does not contain any debug symbols.</span></span> <span data-ttu-id="43f5c-127">Isso é esperado e pode ser ignorado com segurança porque você está, na verdade, Depurando a DLL, não o aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="43f5c-127">This is expected and can safely be ignored because you are actually debugging the DLL, not the host application.</span></span>

<span data-ttu-id="43f5c-128">Na maioria dos casos, a extensão não será chamada até que o usuário execute alguma ação que faça com que a extensão seja carregada e inicializada.</span><span class="sxs-lookup"><span data-stu-id="43f5c-128">In most cases, the extension will not be called until the user performs some action that causes the extension to be loaded and initialized.</span></span> <span data-ttu-id="43f5c-129">Por exemplo, se você estiver Depurando uma extensão de menu de contexto exibida para objetos de usuário, a extensão não será carregada até a primeira vez em que o menu de contexto de um objeto de usuário for exibido.</span><span class="sxs-lookup"><span data-stu-id="43f5c-129">For example, if you are debugging a context menu extension displayed for user objects, the extension will not load until the first time the context menu for a user object is displayed.</span></span>

<span data-ttu-id="43f5c-130">Agora você deve ser capaz de definir pontos de interrupção e exibir a saída de depuração.</span><span class="sxs-lookup"><span data-stu-id="43f5c-130">You should now be able to set breakpoints and view debug output.</span></span> <span data-ttu-id="43f5c-131">Se a extensão não parecer carregar, defina um ponto de interrupção na função [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) da extensão.</span><span class="sxs-lookup"><span data-stu-id="43f5c-131">If the extension does not appear to load, set a breakpoint in the extension's [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) function.</span></span> <span data-ttu-id="43f5c-132">Se **DllGetClassObject** não for chamado, provavelmente a extensão não está registrada corretamente.</span><span class="sxs-lookup"><span data-stu-id="43f5c-132">If **DllGetClassObject** is not called, the extension is probably not registered correctly.</span></span>

<span data-ttu-id="43f5c-133">Quando a depuração estiver concluída, saia do MMC e o depurador deverá ser descarregado normalmente.</span><span class="sxs-lookup"><span data-stu-id="43f5c-133">When the debug is complete, exit MMC and the debugger should unload normally.</span></span>

 

 