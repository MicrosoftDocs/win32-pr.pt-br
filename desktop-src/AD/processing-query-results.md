---
title: Processando os resultados da pesquisa
description: Após a primeira chamada para IDirectorySearch GetFirstRow ou IDirectorySearch GetNextRow, S \_ OK, s \_ anúncios \_ mais \_ linhas ou um resultado de erro é retornado.
ms.assetid: 3a84f394-a256-4815-901c-eaaae3d54b75
ms.tgt_platform: multiple
keywords:
- Processando resultados da pesquisa AD
- Active Directory, pesquisando, processando resultados da pesquisa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 732128438162f5ee8f6fe75bb4d2ce53e0d43070
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "105748297"
---
# <a name="processing-the-search-results"></a><span data-ttu-id="28bb1-105">Processando os resultados da pesquisa</span><span class="sxs-lookup"><span data-stu-id="28bb1-105">Processing the Search Results</span></span>

<span data-ttu-id="28bb1-106">Após a primeira chamada para [**IDirectorySearch:: GetFirstRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getfirstrow) ou [**IDirectorySearch:: GetNextRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextrow), **s \_ OK**, **s anúncios mais \_ \_ \_ linhas** ou um resultado de erro é retornado.</span><span class="sxs-lookup"><span data-stu-id="28bb1-106">After the first call to [**IDirectorySearch::GetFirstRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getfirstrow) or [**IDirectorySearch::GetNextRow**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextrow), either **S\_OK**, **S\_ADS\_NOMORE\_ROWS**, or an error result is returned.</span></span>

<span data-ttu-id="28bb1-107">Se o valor de retorno for **S \_ anúncios, \_ mais \_ linhas**, não serão encontrados mais objetos correspondentes ao filtro.</span><span class="sxs-lookup"><span data-stu-id="28bb1-107">If the return value is **S\_ADS\_NOMORE\_ROWS**, no more objects matching the filter were found.</span></span> <span data-ttu-id="28bb1-108">Se um resultado de erro for retornado, a consulta falhou.</span><span class="sxs-lookup"><span data-stu-id="28bb1-108">If an error result is returned, the query failed.</span></span> <span data-ttu-id="28bb1-109">Em ambos os casos, não é necessário processar as linhas no resultado porque nada foi retornado.</span><span class="sxs-lookup"><span data-stu-id="28bb1-109">In both cases, you are not required to process the rows in the result because nothing was returned.</span></span>

<span data-ttu-id="28bb1-110">Se **S \_ OK** for retornado, uma linha será recuperada.</span><span class="sxs-lookup"><span data-stu-id="28bb1-110">If **S\_OK** is returned, a row has been retrieved.</span></span> <span data-ttu-id="28bb1-111">Você pode analisar as colunas por nome usando [**IDirectorySearch:: GetColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn).</span><span class="sxs-lookup"><span data-stu-id="28bb1-111">You can parse the columns by name using [**IDirectorySearch::GetColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn).</span></span> <span data-ttu-id="28bb1-112">O nome é o **lDAPDisplayName** do atributo na coluna.</span><span class="sxs-lookup"><span data-stu-id="28bb1-112">The name is the **lDAPDisplayName** of the attribute in the column.</span></span> <span data-ttu-id="28bb1-113">O conjunto de todas as colunas foi definido pelo parâmetro pAttributeNames do método [**IDirectorySearch:: ExecuteSearch**](/windows/desktop/api/iads/nf-iads-idirectorysearch-executesearch) .</span><span class="sxs-lookup"><span data-stu-id="28bb1-113">The set of all columns was defined by the pAttributeNames parameter of the [**IDirectorySearch::ExecuteSearch**](/windows/desktop/api/iads/nf-iads-idirectorysearch-executesearch) method.</span></span> <span data-ttu-id="28bb1-114">Se **NULL** tiver sido especificado, o conjunto de todas as colunas será a União de todas as propriedades encontradas para todos os objetos retornados.</span><span class="sxs-lookup"><span data-stu-id="28bb1-114">If **NULL** was specified, the set of all columns is the union of all properties found for all the objects returned.</span></span> <span data-ttu-id="28bb1-115">Para ler todo o conjunto de colunas retornado para um objeto, use o [**IDirectorySearch:: GetNextColumnName**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextcolumnname) para iterar cada coluna e use o nome da coluna retornado para chamar **IDirectorySearch:: GetColumn**.</span><span class="sxs-lookup"><span data-stu-id="28bb1-115">To read the entire set of columns returned for an object, use the [**IDirectorySearch::GetNextColumnName**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getnextcolumnname) to iterate each column, and use the column name returned to call **IDirectorySearch::GetColumn**.</span></span>

<span data-ttu-id="28bb1-116">O método [**IDirectorySearch:: GetColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn) retorna uma estrutura de [**coluna de \_ pesquisa \_ do ADS**](/windows/desktop/api/iads/ns-iads-ads_search_column) que contém o nome do atributo, o tipo do atributo, a contagem de valores e um ponteiro para uma matriz de estruturas [**ADSVALUE**](/windows/desktop/api/iads/ns-iads-adsvalue) que contêm os valores.</span><span class="sxs-lookup"><span data-stu-id="28bb1-116">The [**IDirectorySearch::GetColumn**](/windows/desktop/api/iads/nf-iads-idirectorysearch-getcolumn) method returns an [**ADS\_SEARCH\_COLUMN**](/windows/desktop/api/iads/ns-iads-ads_search_column) structure that contains the attribute name, the type of the attribute, count of values, and a pointer to an array of [**ADSVALUE**](/windows/desktop/api/iads/ns-iads-adsvalue) structures that contain the values.</span></span> <span data-ttu-id="28bb1-117">Você pode executar um loop pelas estruturas **ADSVALUE** para ler os valores da propriedade retornada pela coluna.</span><span class="sxs-lookup"><span data-stu-id="28bb1-117">You can loop through the **ADSVALUE** structures to read the values for the property returned by the column.</span></span> <span data-ttu-id="28bb1-118">Você deve ler o membro apropriado da estrutura **ADSVALUE** com base no [**ADSTYPE**](/windows/win32/api/iads/ne-iads-adstypeenum) especificado pelo membro **dwADsType** da estrutura de **\_ \_ coluna de pesquisa do ADS** (ou o membro **dwType** da estrutura **ADSVALUE** ).</span><span class="sxs-lookup"><span data-stu-id="28bb1-118">You must read the appropriate member of the **ADSVALUE** structure based on the [**ADSTYPE**](/windows/win32/api/iads/ne-iads-adstypeenum) specified by the **dwADsType** member of the **ADS\_SEARCH\_COLUMN** structure (or the **dwType** member of the **ADSVALUE** structure).</span></span> <span data-ttu-id="28bb1-119">Por exemplo, se **dwADsType** fosse **ADSTYPE \_ inteiro**, você lerá o membro **inteiro** de cada estrutura **ADSVALUE** .</span><span class="sxs-lookup"><span data-stu-id="28bb1-119">For example, if **dwADsType** was **ADSTYPE\_INTEGER**, you would read the **Integer** member of each **ADSVALUE** structure.</span></span>

<span data-ttu-id="28bb1-120">Para obter mais informações e um exemplo de código, consulte [código de exemplo para pesquisa de usuários](example-code-for-searching-for-users.md).</span><span class="sxs-lookup"><span data-stu-id="28bb1-120">For more information and a code example, see [Example Code for Searching for Users](example-code-for-searching-for-users.md).</span></span>

 

 