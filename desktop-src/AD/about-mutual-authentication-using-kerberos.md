---
title: Sobre a autenticação mútua usando o Kerberos
description: Na autenticação mútua, o cliente e o serviço devem verificar suas respectivas identidades entre si antes de executar funções de aplicativo.
ms.assetid: 5ce923d6-bede-4acb-b297-e93f2f506ea9
ms.tgt_platform: multiple
keywords:
- Sobre a autenticação mútua usando o AD do Kerberos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9685dad0bd20f233b8dcb0ecf12af338f318646f
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104004823"
---
# <a name="about-mutual-authentication-using-kerberos"></a><span data-ttu-id="6b8ec-104">Sobre a autenticação mútua usando o Kerberos</span><span class="sxs-lookup"><span data-stu-id="6b8ec-104">About Mutual Authentication Using Kerberos</span></span>

<span data-ttu-id="6b8ec-105">Na autenticação mútua, o cliente e o serviço devem verificar suas respectivas identidades entre si antes de executar funções de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-105">In mutual authentication, the client and service must verify their respective identities to each other before performing application functions.</span></span> <span data-ttu-id="6b8ec-106">Nenhuma das partes pode executar operações com a outra até que a identidade tenha sido verificada; ou seja, o serviço deve ser capaz de verificar o cliente sem consultar o cliente e o cliente deve ser capaz de verificar o serviço sem consultar o serviço.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-106">Neither party can perform operations with the other until identity has been verified; that is, the service must be able to verify the client without querying the client and the client must be able to verify the service without querying the service.</span></span>

<span data-ttu-id="6b8ec-107">O valor de um serviço que pode autenticar um cliente é bem conhecido.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-107">The value of a service that can authenticate a client is well-known.</span></span> <span data-ttu-id="6b8ec-108">Por exemplo, um serviço de arquivo representa um cliente para determinar quais arquivos o cliente pode acessar.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-108">For example, a file service impersonates a client to determine which files the client can access.</span></span>

<span data-ttu-id="6b8ec-109">O valor de um cliente que pode autenticar um serviço é menos compreendido.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-109">The value of a client that can authenticate a service is less understood.</span></span> <span data-ttu-id="6b8ec-110">A autenticação de um serviço permite que o cliente confie nos dados que obtém do serviço e que seja seguro no envio de dados confidenciais para o serviço.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-110">Authenticating a service enables the client to trust the data that it gets from the service and to be secure in sending sensitive data to the service.</span></span> <span data-ttu-id="6b8ec-111">A capacidade de um cliente de autenticar um serviço é particularmente importante em aplicativos cliente/serviço que dão suporte à delegação do contexto de segurança do cliente; ou seja, o cliente autoriza o serviço a atuar como seu representante no acesso a serviços adicionais ou recursos de rede.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-111">The ability of a client to authenticate a service is particularly important in client/service applications that support delegation of the client's security context; that is, the client authorizes the service to act as its delegate in accessing additional services or network resources.</span></span>

<span data-ttu-id="6b8ec-112">Um serviço autentica um cliente da seguinte maneira: o cliente estabelece um contexto de segurança local executando em um contexto estabelecido anteriormente, por exemplo, na sessão de um usuário conectado ou apresentando explicitamente as credenciais para o provedor de segurança subjacente.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-112">A service authenticates a client as follows: The client establishes a local security context either by executing in a previously established context, for example, in the session of a logged-in user, or by explicitly presenting credentials to the underlying security provider.</span></span> <span data-ttu-id="6b8ec-113">O serviço não pode aceitar conexões de nenhum cliente não autenticado.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-113">The service cannot accept connections from any unauthenticated client.</span></span>

<span data-ttu-id="6b8ec-114">O mecanismo Kerberos pelo qual um cliente autentica um serviço funciona da seguinte maneira: quando um serviço é instalado, um instalador de serviço, executando com privilégios de administrador, registra um ou mais SPNs exclusivos para cada instância de serviço.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-114">The Kerberos mechanism by which a client authenticates a service works as follows: When a service is installed, a service installer, running with administrator privileges, registers one or more unique SPNs for each service instance.</span></span> <span data-ttu-id="6b8ec-115">Os nomes são registrados no controlador de Domínio do Active Directory (DC) no objeto de conta de usuário ou computador que a instância de serviço usará para fazer logon.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-115">The names are registered in the Active Directory Domain Controller (DC) on the user or computer account object that the service instance will use to log on.</span></span> <span data-ttu-id="6b8ec-116">Quando um cliente solicita uma conexão a um serviço, ele compõe um SPN para uma instância de serviço, usando dados conhecidos ou dados fornecidos pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-116">When a client requests a connection to a service, it composes an SPN for a service instance, using known data or data provided by the user.</span></span> <span data-ttu-id="6b8ec-117">Em seguida, o cliente usa o pacote de negociação SSPI para apresentar o SPN ao centro de distribuição de chaves (KDC) para a conta de domínio do cliente.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-117">The client then uses the SSPI negotiate package to present the SPN to the Key Distribution Center (KDC) for the client domain account.</span></span> <span data-ttu-id="6b8ec-118">O KDC pesquisa a floresta em busca de uma conta de usuário ou computador na qual o SPN está registrado.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-118">The KDC searches the forest for a user or computer account on which that SPN is registered.</span></span> <span data-ttu-id="6b8ec-119">Se o SPN estiver registrado em mais de uma conta, a autenticação falhará.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-119">If the SPN is registered on more than one account, the authentication fails.</span></span> <span data-ttu-id="6b8ec-120">Caso contrário, o KDC criptografa uma mensagem usando a senha da conta na qual o SPN foi registrado.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-120">Otherwise, the KDC encrypts a message using the password of the account on which the SPN was registered.</span></span> <span data-ttu-id="6b8ec-121">O KDC passa essa mensagem criptografada para o cliente, que, por sua vez, a passa para a instância do serviço.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-121">The KDC passes this encrypted message to the client, which in turn passes it to the service instance.</span></span> <span data-ttu-id="6b8ec-122">O serviço usa o pacote de negociação SSPI para descriptografar a mensagem, que passa de volta para o cliente e para o KDC do cliente.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-122">The service uses the SSPI negotiate package to decrypt the message, which it passes back to the client and on to the client's KDC.</span></span> <span data-ttu-id="6b8ec-123">O KDC autenticará o serviço se a mensagem descriptografada corresponder à sua mensagem original.</span><span class="sxs-lookup"><span data-stu-id="6b8ec-123">The KDC authenticates the service if the decrypted message matches its original message.</span></span>

-   <span data-ttu-id="6b8ec-124">Para obter mais informações sobre como compor e registrar SPNs, consulte. [Nomes da entidade de serviço](service-principal-names.md)</span><span class="sxs-lookup"><span data-stu-id="6b8ec-124">For more information about composing and registering SPNs, see .[Service Principal Names](service-principal-names.md)</span></span>
-   <span data-ttu-id="6b8ec-125">Para obter mais informações e um exemplo de código que compõe um SPN para um serviço do Windows Sockets que se publica com um ponto de conexão de serviço, consulte [compondo os SPNs de um serviço com um SCP](composing-the-spns-for-a-service-with-an-scp.md).</span><span class="sxs-lookup"><span data-stu-id="6b8ec-125">For more information and a code example that composes an SPN for a Windows Sockets service that publishes itself with a service connection point, see [Composing the SPNs for a Service with an SCP](composing-the-spns-for-a-service-with-an-scp.md).</span></span>
-   <span data-ttu-id="6b8ec-126">Para obter mais informações e um exemplo de código que compõe um SPN para um serviço RPC, consulte [compoting SPNs para um serviço RpcNs](composing-spns-for-an-rpcns-service.md).</span><span class="sxs-lookup"><span data-stu-id="6b8ec-126">For more information and a code example that composes an SPN for an RPC service, see [Composing SPNs for an RpcNs Service](composing-spns-for-an-rpcns-service.md).</span></span>

 

 




