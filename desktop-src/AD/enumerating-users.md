---
title: Enumerando usuários
description: Ao contrário dos domínios do Windows NT 4,0, os usuários do Windows 2000 podem ser colocados em qualquer contêiner ou unidade organizacional (UO) em um domínio, bem como a raiz do domínio.
ms.assetid: 4a35af7a-f43b-4cf9-a030-77f6c2518ae7
ms.tgt_platform: multiple
keywords:
- Enumerando usuários do AD
- o AD dos usuários, enumerando um usuário
- Active Directory, usando, usuários, enumerando um usuário
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e922d92f4313ed0238ff068f7ae1c0fbf693d497
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "105811201"
---
# <a name="enumerating-users"></a><span data-ttu-id="1299a-106">Enumerando usuários</span><span class="sxs-lookup"><span data-stu-id="1299a-106">Enumerating Users</span></span>

<span data-ttu-id="1299a-107">Ao contrário dos domínios do Windows NT 4,0, os usuários do Windows 2000 podem ser colocados em qualquer contêiner ou unidade organizacional (UO) em um domínio, bem como a raiz do domínio.</span><span class="sxs-lookup"><span data-stu-id="1299a-107">Unlike Windows NT 4.0 domains, Windows 2000 users can be placed in any container or organizational unit (OU) in a domain as well as the root of the domain.</span></span> <span data-ttu-id="1299a-108">Isso significa que os usuários podem estar em vários locais na hierarquia de diretórios.</span><span class="sxs-lookup"><span data-stu-id="1299a-108">This means that users can be in numerous locations in the directory hierarchy.</span></span> <span data-ttu-id="1299a-109">Portanto, você tem duas opções para enumerar usuários:</span><span class="sxs-lookup"><span data-stu-id="1299a-109">Therefore, you have two choices for enumerating users:</span></span>

-   <span data-ttu-id="1299a-110">Enumere os usuários diretamente contidos em um contêiner, ou ou na raiz do domínio:</span><span class="sxs-lookup"><span data-stu-id="1299a-110">Enumerate the users directly contained in a container, OU, or at the root of the domain:</span></span>

    <span data-ttu-id="1299a-111">Associe explicitamente ao objeto de contêiner que contém os usuários que você está interessado em enumerar, defina um filtro que contenha "user" como a classe usando a propriedade [**IADsContainer. Filter**](/windows/desktop/ADSI/iadscontainer-property-methods) e use o método [**IADsContainer:: get \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) para enumerar os objetos de usuário.</span><span class="sxs-lookup"><span data-stu-id="1299a-111">Explicitly bind to the container object that contains the users you are interested in enumerating, set a filter containing "user" as the class using the [**IADsContainer.Filter**](/windows/desktop/ADSI/iadscontainer-property-methods) property, and use the [**IADsContainer::get\_\_NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) method to enumerate the user objects.</span></span>

    <span data-ttu-id="1299a-112">Essa técnica pode ser usada para enumerar usuários que estão diretamente contidos em um contêiner ou objeto de UO.</span><span class="sxs-lookup"><span data-stu-id="1299a-112">This technique can be used to enumerate users that are directly contained in a container or OU object.</span></span> <span data-ttu-id="1299a-113">Se o contêiner contiver outros contêineres que potencialmente podem conter outros usuários, você deverá associar a esses contêineres e enumerar recursivamente os usuários nesses contêineres.</span><span class="sxs-lookup"><span data-stu-id="1299a-113">If the container contains other containers that can potentially contain other users, you must bind to those containers and recursively enumerate the users on those containers.</span></span> <span data-ttu-id="1299a-114">Se não for necessário que você manipule os objetos de usuário e só precise ler propriedades específicas, use a pesquisa profunda descrita na opção 2.</span><span class="sxs-lookup"><span data-stu-id="1299a-114">If it is not required that you manipulate the user objects, and only need to read specific properties, use the deep search described in Option 2.</span></span>

    <span data-ttu-id="1299a-115">Como a enumeração retorna ponteiros para objetos COM ADSI que representam cada objeto de usuário, você pode chamar [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) para obter os ponteiros de interface [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser)e [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) para o objeto de usuário.</span><span class="sxs-lookup"><span data-stu-id="1299a-115">Because enumeration returns pointers to ADSI COM objects representing each user object, you can call [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to get [**IADs**](/windows/desktop/api/iads/nn-iads-iads), [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser), and [**IADsPropertyList**](/windows/desktop/api/iads/nn-iads-iadspropertylist) interface pointers to the user object.</span></span> <span data-ttu-id="1299a-116">Isso significa que você pode obter ponteiros de interface para cada objeto de usuário enumerado em um contêiner sem ter que associar explicitamente a cada objeto de usuário.</span><span class="sxs-lookup"><span data-stu-id="1299a-116">This means you can get interface pointers to each enumerated user object in a container without having to explicitly bind to each user object.</span></span> <span data-ttu-id="1299a-117">Para executar operações em todos os usuários diretamente dentro de um contêiner, a enumeração evita que você precise se associar a cada usuário para chamar os métodos **IADs** ou **IADsUser** .</span><span class="sxs-lookup"><span data-stu-id="1299a-117">To perform operations on all the users directly within a container, enumeration avoids having to bind to each user in order to call **IADs** or **IADsUser** methods.</span></span> <span data-ttu-id="1299a-118">Para recuperar propriedades específicas de usuários, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) conforme descrito na opção 2.</span><span class="sxs-lookup"><span data-stu-id="1299a-118">To retrieve specific properties from users, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) as described in option 2.</span></span>

-   <span data-ttu-id="1299a-119">Execute uma pesquisa profunda para (& (objectClass = user) (objectCategory = Person)) para localizar todos os usuários em uma árvore:</span><span class="sxs-lookup"><span data-stu-id="1299a-119">Perform a deep search for (&(objectClass=user)(objectCategory=person)) to find all users in a tree:</span></span>

    <span data-ttu-id="1299a-120">Primeiro, associe-se ao objeto de contêiner onde iniciar a pesquisa.</span><span class="sxs-lookup"><span data-stu-id="1299a-120">First, bind to the container object where to begin the search.</span></span> <span data-ttu-id="1299a-121">Por exemplo, para localizar todos os usuários em um domínio, associe-se à raiz do domínio; para localizar todos os usuários na floresta, associe-se ao catálogo global e pesquise na raiz do GC.</span><span class="sxs-lookup"><span data-stu-id="1299a-121">For example, to find all users in a domain, bind to root of the domain; to find all users in the forest, bind to the global catalog and search from the root of the GC.</span></span>

    <span data-ttu-id="1299a-122">Em seguida, use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) para consultar usando um filtro de pesquisa contendo (& (objectClass = user) (objectCategory = Person)) e a preferência de pesquisa da \_ subárvore de escopo ADS \_ .</span><span class="sxs-lookup"><span data-stu-id="1299a-122">Then use [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) to query using a search filter containing (&(objectClass=user)(objectCategory=person)) and search preference of ADS\_SCOPE\_SUBTREE.</span></span>

    <span data-ttu-id="1299a-123">Você pode executar uma pesquisa com uma preferência de pesquisa de \_ escopo dos ADS \_ para limitar a pesquisa ao conteúdo direto do objeto de contêiner ao qual você está vinculado.</span><span class="sxs-lookup"><span data-stu-id="1299a-123">You can perform a search with a search preference of ADS\_SCOPE\_ONELEVEL to limit the search to the direct contents of the container object that you bound to.</span></span>

    <span data-ttu-id="1299a-124">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) recupera apenas os valores de propriedades específicas dos usuários.</span><span class="sxs-lookup"><span data-stu-id="1299a-124">[**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) retrieves only the values of specific properties from users.</span></span> <span data-ttu-id="1299a-125">Para recuperar valores, use **IDirectorySearch**.</span><span class="sxs-lookup"><span data-stu-id="1299a-125">To retrieve values, use **IDirectorySearch**.</span></span> <span data-ttu-id="1299a-126">Para manipular os objetos de usuário retornados de uma pesquisa, ou seja, você deseja usar os métodos [**IADs**](/windows/desktop/api/iads/nn-iads-iads) ou [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser) , você deve associá-los explicitamente a eles.</span><span class="sxs-lookup"><span data-stu-id="1299a-126">To manipulate the user objects returned from a search, that is, you want to use [**IADs**](/windows/desktop/api/iads/nn-iads-iads) or [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser) methods, you must explicitly bind to them.</span></span> <span data-ttu-id="1299a-127">Para fazer isso, especifique **distinguishedName** como uma das propriedades a serem retornadas da pesquisa e use os nomes distintos retornados para associar a cada usuário retornado na pesquisa.</span><span class="sxs-lookup"><span data-stu-id="1299a-127">To do this, specify **distinguishedName** as one of the properties to return from the search and use the returned distinguished names to bind to each user returned in the search.</span></span>

    <span data-ttu-id="1299a-128">Somente propriedades específicas são recuperadas.</span><span class="sxs-lookup"><span data-stu-id="1299a-128">Only specific properties are retrieved.</span></span> <span data-ttu-id="1299a-129">Não é possível recuperar todos os atributos sem especificar explicitamente todos os atributos possíveis da classe User.</span><span class="sxs-lookup"><span data-stu-id="1299a-129">You cannot retrieve all attributes without explicitly specifying every possible attribute of the user class.</span></span>

 

 