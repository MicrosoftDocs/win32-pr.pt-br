---
title: Seletor de objetos de diretório
description: A caixa de diálogo Seletor de objetos de diretório permite que um usuário selecione um ou mais objetos do catálogo global, um domínio ou computador ou um grupo de trabalho.
ms.assetid: 5b3e5d71-afd2-49db-b3a2-f9a49f0b2b3a
ms.tgt_platform: multiple
keywords:
- AD do seletor de objetos de diretório
- AD do seletor de objetos
- AD de objetos, seletor de objetos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 24f6ba7fd053aa8ab3245bf72c693f0a887aa983
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "104007325"
---
# <a name="directory-object-picker"></a><span data-ttu-id="ff528-106">Seletor de objetos de diretório</span><span class="sxs-lookup"><span data-stu-id="ff528-106">Directory Object Picker</span></span>

<span data-ttu-id="ff528-107">A caixa de diálogo Seletor de objetos de diretório permite que um usuário selecione um ou mais objetos do catálogo global, um domínio ou computador ou um grupo de trabalho.</span><span class="sxs-lookup"><span data-stu-id="ff528-107">The directory object picker dialog box enables a user to select one or more objects from either the global catalog, a domain or computer, or a workgroup.</span></span> <span data-ttu-id="ff528-108">Os tipos de objeto dos quais um usuário pode selecionar incluem objetos de usuário, contato, grupo e computador.</span><span class="sxs-lookup"><span data-stu-id="ff528-108">The object types from which a user can select include user, contact, group, and computer objects.</span></span> <span data-ttu-id="ff528-109">Para obter mais informações sobre Active Directory Domain Services, consulte [Active Directory Domain Services](active-directory-domain-services.md).</span><span class="sxs-lookup"><span data-stu-id="ff528-109">For more information about Active Directory Domain Services, see [Active Directory Domain Services](active-directory-domain-services.md).</span></span>

<span data-ttu-id="ff528-110">Para exibir uma caixa de diálogo Seletor de objetos:</span><span class="sxs-lookup"><span data-stu-id="ff528-110">To display an object picker dialog box:</span></span>

1.  <span data-ttu-id="ff528-111">Chame a função [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) ou [**CoCreateInstanceEx**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) para criar uma instância da interface [**IDsObjectPicker**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) .</span><span class="sxs-lookup"><span data-stu-id="ff528-111">Call the [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) or [**CoCreateInstanceEx**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) function to create an instance of the [**IDsObjectPicker**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) interface.</span></span>
2.  <span data-ttu-id="ff528-112">Chame o método [**IDsObjectPicker:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) para inicializar a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="ff528-112">Call the [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method to initialize the dialog box.</span></span>
3.  <span data-ttu-id="ff528-113">Chame o método [**IDsObjectPicker:: InvokeDialog**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) para exibir a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="ff528-113">Call the [**IDsObjectPicker::InvokeDialog**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) method to display the dialog box.</span></span>
4.  <span data-ttu-id="ff528-114">Chame o método [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) da instância [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) retornada pela caixa de diálogo Seletor de objetos para recuperar os dados da [**lista de seleção do CFSTR \_ DSOP \_ DS \_ \_**](cfstr-dsop-ds-selection-list.md) .</span><span class="sxs-lookup"><span data-stu-id="ff528-114">Call the [**IDataObject::GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) method of the [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) instance returned by the object picker dialog box to retrieve the [**CFSTR\_DSOP\_DS\_SELECTION\_LIST**](cfstr-dsop-ds-selection-list.md) data.</span></span> <span data-ttu-id="ff528-115">O formato da área de transferência da **lista de seleção do CFSTR \_ DSOP \_ \_ \_ DS** fornece um **HGLOBAL** que contém uma estrutura de [**\_ \_ lista de seleção do DS**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list) .</span><span class="sxs-lookup"><span data-stu-id="ff528-115">The **CFSTR\_DSOP\_DS\_SELECTION\_LIST** clipboard format provides an **HGLOBAL** that contains a [**DS\_SELECTION\_LIST**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list) structure.</span></span> <span data-ttu-id="ff528-116">A estrutura da **\_ \_ lista de seleção do DS** contém dados sobre os itens selecionados na caixa de diálogo Seletor de objetos.</span><span class="sxs-lookup"><span data-stu-id="ff528-116">The **DS\_SELECTION\_LIST** structure contains data about the items selected in the object picker dialog box.</span></span>

<span data-ttu-id="ff528-117">Se o SID (identificador de segurança) for necessário para um objeto, isso deverá ser solicitado diretamente do seletor de objetos, adicionando o atributo **objectSid** à lista de atributos a serem recuperados para o objeto selecionado.</span><span class="sxs-lookup"><span data-stu-id="ff528-117">If the Security Identifier (SID) is required for an object, this should be requested directly from the object picker by adding the **objectSID** attribute to the list of attributes to retrieve for the selected object.</span></span> <span data-ttu-id="ff528-118">Não é recomendável passar o nome do objeto retornado para a função [**LsaLookupNames**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) ou [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) porque a pesquisa de nome será redundante e poderá falhar em alguns casos.</span><span class="sxs-lookup"><span data-stu-id="ff528-118">Passing the returned object name to the [**LsaLookupNames**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) or [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) function is not recommended because the name lookup will be redundant and may fail in some cases.</span></span>

<span data-ttu-id="ff528-119">Se uma referência a todos os objetos selecionados for salva, o nome distinto não deverá ser salvo porque o objeto pode ser movido, ser renomeado ou pode ser alterado devido a diferenças de localidade.</span><span class="sxs-lookup"><span data-stu-id="ff528-119">If a reference to any selected objects will be saved, the distinguished name should not be saved because the object may move, get renamed, or may change due to locale differences.</span></span> <span data-ttu-id="ff528-120">Para entidades de segurança, a **objectSid** deve ser solicitada para o objeto e salva com segurança.</span><span class="sxs-lookup"><span data-stu-id="ff528-120">For security principals, the **objectSID** should be requested for the object and securely saved.</span></span> <span data-ttu-id="ff528-121">Se o nome da entidade de segurança for necessário posteriormente, ele poderá ser recuperado com a função [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) .</span><span class="sxs-lookup"><span data-stu-id="ff528-121">If the name of the security principal is needed later, it can be retrieved with the [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) function.</span></span> <span data-ttu-id="ff528-122">Para todos os outros objetos, o **objectGUID** deve ser solicitado e salvo.</span><span class="sxs-lookup"><span data-stu-id="ff528-122">For all other objects, the **objectGUID** should be requested and saved.</span></span>

## <a name="initialization"></a><span data-ttu-id="ff528-123">Inicialização</span><span class="sxs-lookup"><span data-stu-id="ff528-123">Initialization</span></span>

<span data-ttu-id="ff528-124">Quando a caixa de diálogo Seletor de objetos é inicializada, um conjunto de tipos e filtros de escopo é especificado.</span><span class="sxs-lookup"><span data-stu-id="ff528-124">When the object picker dialog box is initialized, a set of scope types and filters is specified.</span></span> <span data-ttu-id="ff528-125">Os tipos de escopo especificados determinam os locais, domínios ou computadores, por exemplo, do qual um usuário pode selecionar objetos.</span><span class="sxs-lookup"><span data-stu-id="ff528-125">The specified scope types determine the locations, domains or computers for example, from which a user can select objects.</span></span> <span data-ttu-id="ff528-126">Os filtros determinam os tipos de objetos que um usuário pode selecionar de um determinado tipo de escopo.</span><span class="sxs-lookup"><span data-stu-id="ff528-126">The filters determine the types of objects that a user can select from a given scope type.</span></span> <span data-ttu-id="ff528-127">Para obter mais informações, consulte a seção escopos e filtros abaixo.</span><span class="sxs-lookup"><span data-stu-id="ff528-127">For more information, see the Scopes and Filters section below.</span></span>

<span data-ttu-id="ff528-128">Por padrão, um usuário pode selecionar um único objeto na caixa de diálogo Seletor de objetos de diretório.</span><span class="sxs-lookup"><span data-stu-id="ff528-128">By default, a user can select a single object in the directory object picker dialog box.</span></span> <span data-ttu-id="ff528-129">Para habilitar várias seleções, defina o sinalizador **DSOP \_ sinalizar \_ seleção** múltipla no membro **flOptions** da estrutura de [**\_ \_ informações de inicialização do DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) quando a caixa de diálogo for inicializada.</span><span class="sxs-lookup"><span data-stu-id="ff528-129">To enable multiple selections, set the **DSOP\_FLAG\_MULTISELECT** flag in the **flOptions** member of the [**DSOP\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) structure when the dialog box initialized.</span></span>

## <a name="scopes-and-filters"></a><span data-ttu-id="ff528-130">Escopos e filtros</span><span class="sxs-lookup"><span data-stu-id="ff528-130">Scopes and Filters</span></span>

<span data-ttu-id="ff528-131">A lista suspensa **examinar** contém os escopos dos quais um usuário pode selecionar objetos.</span><span class="sxs-lookup"><span data-stu-id="ff528-131">The **Look in** drop-down list contains the scopes from which a user can select objects.</span></span> <span data-ttu-id="ff528-132">Um escopo é um domínio, computador, grupo de trabalho ou catálogo global que armazena dados sobre o e fornece acesso a um conjunto de objetos disponíveis.</span><span class="sxs-lookup"><span data-stu-id="ff528-132">A scope is a domain, computer, workgroup, or global catalog that stores data about, and provides access to, a set of available objects.</span></span> <span data-ttu-id="ff528-133">As entradas na lista escopo dependem dos tipos de escopo e do computador de destino especificado quando o método [**IDsObjectPicker:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) foi chamado pela última vez para inicializar a caixa de diálogo Seletor de objetos.</span><span class="sxs-lookup"><span data-stu-id="ff528-133">The entries in the scope list depend on the scope types and the target computer specified when the [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method was last called to initialize the object picker dialog box.</span></span>

<span data-ttu-id="ff528-134">Um tipo de escopo é uma categoria genérica de escopos, como todos os domínios da empresa aos quais o computador de destino pertence ou o catálogo global para a empresa do computador de destino ou o próprio computador de destino.</span><span class="sxs-lookup"><span data-stu-id="ff528-134">A scope type is a generic category of scopes, such as all domains in the enterprise to which the target computer belongs, or the global catalog for the target computer's enterprise, or the target computer itself.</span></span> <span data-ttu-id="ff528-135">Para cada tipo de escopo especificado, a caixa de diálogo usa o contexto do computador de destino para determinar as entradas da lista de escopo.</span><span class="sxs-lookup"><span data-stu-id="ff528-135">For each specified scope type, the dialog box uses the context of the target computer to determine the scope list entries.</span></span>

<span data-ttu-id="ff528-136">O método [**IDsObjectPicker:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) usa um ponteiro para uma estrutura de [**informações de \_ inicialização \_ do DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) que contém uma matriz de estruturas de [**informações de \_ \_ inicialização \_ de escopo DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) .</span><span class="sxs-lookup"><span data-stu-id="ff528-136">The [**IDsObjectPicker::Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) method takes a pointer to a [**DSOP\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) structure that contains an array of [**DSOP\_SCOPE\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) structures.</span></span> <span data-ttu-id="ff528-137">Cada entrada na matriz **de \_ \_ \_ informações de inicialização de escopo DSOP** especifica um ou mais tipos de escopo, bem como os filtros aplicáveis e outros atributos.</span><span class="sxs-lookup"><span data-stu-id="ff528-137">Each entry in the **DSOP\_SCOPE\_INIT\_INFO** array specifies one or more scope types as well as applicable filters and other attributes.</span></span> <span data-ttu-id="ff528-138">Os filtros determinam os tipos de objetos, como usuários, grupos, contatos e computadores, que o usuário pode selecionar em um determinado tipo de escopo.</span><span class="sxs-lookup"><span data-stu-id="ff528-138">The filters determine the types of objects, such as users, groups, contacts, and computers, that the user can select from a given scope type.</span></span> <span data-ttu-id="ff528-139">Quando o usuário seleciona um escopo na lista, a caixa de diálogo aplica os filtros para esse tipo de escopo para exibir uma lista de objetos dos quais o usuário pode selecionar.</span><span class="sxs-lookup"><span data-stu-id="ff528-139">When the user selects a scope from the list, the dialog box applies the filters for that scope type to display a list of objects from which the user can select.</span></span>

<span data-ttu-id="ff528-140">Cada estrutura de [**\_ informações de \_ inicialização \_ de escopo DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) contém uma estrutura de [**\_ \_ sinalizadores de filtro DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) que especifica os filtros para esse tipo de escopo.</span><span class="sxs-lookup"><span data-stu-id="ff528-140">Each [**DSOP\_SCOPE\_INIT\_INFO**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) structure contains a [**DSOP\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) structure that specifies the filters for that scope type.</span></span> <span data-ttu-id="ff528-141">A estrutura de **\_ \_ sinalizadores de filtro DSOP** distingue entre os escopos de nível superior e inferior:</span><span class="sxs-lookup"><span data-stu-id="ff528-141">The **DSOP\_FILTER\_FLAGS** structure distinguishes between up-level and down-level scopes:</span></span>

-   <span data-ttu-id="ff528-142">Um escopo de nível superior é um catálogo global ou um domínio que dá suporte ao [provedor LDAP](/windows/desktop/ADSI/adsi-ldap-provider)ADSI.</span><span class="sxs-lookup"><span data-stu-id="ff528-142">An up-level scope is a global catalog or a domain that supports the ADSI [LDAP provider](/windows/desktop/ADSI/adsi-ldap-provider).</span></span>
-   <span data-ttu-id="ff528-143">Um escopo de nível inferior inclui grupos de os e computadores individuais.</span><span class="sxs-lookup"><span data-stu-id="ff528-143">A down-level scope includes workgroups and all individual computers.</span></span> <span data-ttu-id="ff528-144">A caixa de diálogo usa o provedor ADSI WinNT para acessar um escopo de nível inferior.</span><span class="sxs-lookup"><span data-stu-id="ff528-144">The dialog box uses the ADSI WinNT provider to access a down-level scope.</span></span>

<span data-ttu-id="ff528-145">Há dois conjuntos de sinalizadores de filtro definidos para uso na estrutura [**de \_ \_ sinalizadores de filtro DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) : um para escopos de nível superior e outro para escopos de nível inferior.</span><span class="sxs-lookup"><span data-stu-id="ff528-145">There are two sets of filter flags defined for use in the [**DSOP\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) structure: one for up-level scopes and one for down-level scopes.</span></span> <span data-ttu-id="ff528-146">O membro **uplevel** da estrutura de **\_ \_ sinalizadores de filtro DSOP** é uma estrutura de [**\_ \_ \_ sinalizadores de filtro de uplevement DSOP**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags) que especifica os filtros para escopos de nível superior.</span><span class="sxs-lookup"><span data-stu-id="ff528-146">The **Uplevel** member of the **DSOP\_FILTER\_FLAGS** structure is a [**DSOP\_UPLEVEL\_FILTER\_FLAGS**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags) structure that specifies the filters for up-level scopes.</span></span> <span data-ttu-id="ff528-147">O membro **flDownlevel** da estrutura **de \_ \_ sinalizadores de filtro DSOP** é um conjunto de sinalizadores que especificam os filtros para escopos de nível inferior.</span><span class="sxs-lookup"><span data-stu-id="ff528-147">The **flDownlevel** member of the **DSOP\_FILTER\_FLAGS** structure is a set of flags that specify the filters for down-level scopes.</span></span>

 

 