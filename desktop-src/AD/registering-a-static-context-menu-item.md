---
title: Registrando um item de menu de contexto estático
description: Este tópico descreve o registro de um item de menu de contexto estático exibido para objetos Active Directory.
ms.assetid: ed945812-3adb-4058-bdb6-8d9d34468265
ms.tgt_platform: multiple
keywords:
- Registrando um item de menu de contexto estático AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 89e3ee5336061ca296e2c94f8907ebd385610494
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "105753873"
---
# <a name="registering-a-static-context-menu-item"></a><span data-ttu-id="607c3-104">Registrando um item de menu de contexto estático</span><span class="sxs-lookup"><span data-stu-id="607c3-104">Registering a Static Context Menu Item</span></span>

<span data-ttu-id="607c3-105">Os snap-ins administrativos do MMC do Active Directory Domain Services e do shell do Windows fornecem um mecanismo para adicionar um item ao menu de contexto exibido para objetos no Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="607c3-105">The administrative MMC snap-ins of Active Directory Domain Services and the Windows shell provide a mechanism to add an item to the context menu displayed for objects in Active Directory Domain Services.</span></span> <span data-ttu-id="607c3-106">O menu de contexto pode invocar qualquer arquivo que possa ser iniciado com a API [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) , como uma URL do aplicativo ou da página da Web.</span><span class="sxs-lookup"><span data-stu-id="607c3-106">The context menu can invoke any file that can be started with the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) API, such as an application or webpage URL.</span></span>

## <a name="registering-with-active-directory-domain-services"></a><span data-ttu-id="607c3-107">Registrando com Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="607c3-107">Registering with Active Directory Domain Services</span></span>

<span data-ttu-id="607c3-108">O registro de extensão do menu de contexto é específico para uma localidade.</span><span class="sxs-lookup"><span data-stu-id="607c3-108">Context menu extension registration is specific to one locale.</span></span> <span data-ttu-id="607c3-109">Se a extensão do menu de contexto se aplicar a todas as localidades, ela deverá ser registrada no objeto [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) da classe Object em todos os subcontêineres de localidade no contêiner exibir especificadores.</span><span class="sxs-lookup"><span data-stu-id="607c3-109">If the context menu extension applies to all locales, it must be registered in the object class [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) object in all of the locale subcontainers in the Display Specifiers container.</span></span> <span data-ttu-id="607c3-110">Se a extensão do menu de contexto for localizada para uma determinada localidade, ela deverá ser registrada no objeto **displaySpecifier** nesse subcontêiner de localidade.</span><span class="sxs-lookup"><span data-stu-id="607c3-110">If the context menu extension is localized for a certain locale, it must be registered in the **displaySpecifier** object in that locale subcontainer.</span></span> <span data-ttu-id="607c3-111">Para obter mais informações sobre o contêiner e as localidades dos especificadores de exibição, consulte [Exibir especificadores de exibição](display-specifiers.md) e [contêiner DisplaySpecifiers](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="607c3-111">For more information about the Display Specifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="607c3-112">Há dois atributos de especificador de exibição em que um item de menu de contexto estático pode ser registrado, [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) e [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span><span class="sxs-lookup"><span data-stu-id="607c3-112">There are two display specifier attributes that a static context menu item can be registered under, [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span></span>

<span data-ttu-id="607c3-113">O atributo [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) identifica os menus de contexto administrativos a serem exibidos nos snap-ins administrativos de Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="607c3-113">The [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) attribute identifies administrative context menus to display in the administrative snap-ins of Active Directory Domain Services.</span></span> <span data-ttu-id="607c3-114">O menu de contexto é exibido quando o usuário exibe o menu de contexto para objetos da classe apropriada em um dos snap-ins administrativos do MMC.</span><span class="sxs-lookup"><span data-stu-id="607c3-114">The context menu appears when the user displays the context menu for objects of the appropriate class in one of the administrative MMC snap-ins.</span></span>

<span data-ttu-id="607c3-115">O atributo [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) identifica os menus de contexto do usuário final a serem exibidos no Shell do Windows.</span><span class="sxs-lookup"><span data-stu-id="607c3-115">The [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attribute identifies end-user context menus to display in the Windows shell.</span></span> <span data-ttu-id="607c3-116">O menu de contexto é exibido quando o usuário exibe o menu de contexto para objetos da classe apropriada no Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="607c3-116">The context menu appears when the user views the context menu for objects of the appropriate class in the Windows Explorer.</span></span> <span data-ttu-id="607c3-117">A partir do Windows Server 2003, o Shell do Windows não exibe mais objetos do Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="607c3-117">Beginning with Windows Server 2003, the Windows shell no longer displays objects that are from Active Directory Domain Services.</span></span>

<span data-ttu-id="607c3-118">Todos esses atributos têm valores múltiplos.</span><span class="sxs-lookup"><span data-stu-id="607c3-118">All of these attributes are multi-valued.</span></span>

<span data-ttu-id="607c3-119">Ao registrar um item de menu de contexto estático, os valores para os atributos [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) e [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) exigem o formato a seguir.</span><span class="sxs-lookup"><span data-stu-id="607c3-119">When registering a static context menu item, the values for the [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attributes require the following format.</span></span>


```C++
<order number>,<menu text>,<command>
```



<span data-ttu-id="607c3-120">O " &lt; número do pedido &gt; " é um número sem sinal que representa a posição do item no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="607c3-120">The "&lt;order number&gt;" is an unsigned number that represents the item's position in the context menu.</span></span> <span data-ttu-id="607c3-121">Quando um menu de contexto é exibido, os valores são classificados usando uma comparação de "número de &lt; ordem" de cada valor &gt; .</span><span class="sxs-lookup"><span data-stu-id="607c3-121">When a context menu is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="607c3-122">Se mais de um valor tiver o mesmo " &lt; número do pedido &gt; ", essas extensões de menu de contexto serão carregadas na ordem em que são lidas do servidor de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="607c3-122">If more than one value has the same "&lt;order number&gt;", those context menu extensions are loaded in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="607c3-123">Se possível, use um " &lt; número de pedido" não existente &gt; , ou seja, um que não tenha sido usado por outros valores na propriedade.</span><span class="sxs-lookup"><span data-stu-id="607c3-123">If possible, use a non-existing "&lt;order number&gt;", that is, one that has not been used by other values in the property.</span></span> <span data-ttu-id="607c3-124">Não há uma posição de início prescrita e as lacunas são permitidas na &lt; sequência "número do pedido &gt; ".</span><span class="sxs-lookup"><span data-stu-id="607c3-124">There is no prescribed starting position, and gaps are allowed in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="607c3-125">O " &lt; texto do menu &gt; " é a cadeia de caracteres exibida no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="607c3-125">The "&lt;menu text&gt;" is the string displayed in the context menu.</span></span> <span data-ttu-id="607c3-126">O " &lt; texto do menu &gt; " pode incluir um caractere "&" que precede o caractere de atalho do teclado para o item de menu.</span><span class="sxs-lookup"><span data-stu-id="607c3-126">The "&lt;menu text&gt;" can include one "&" character that precedes the keyboard shortcut character for the menu item.</span></span> <span data-ttu-id="607c3-127">Isso fará com que o caractere precedido seja sublinhado.</span><span class="sxs-lookup"><span data-stu-id="607c3-127">This will cause the preceded character to be underlined.</span></span> <span data-ttu-id="607c3-128">Por exemplo, se o " &lt; texto do menu &gt; " for "&arquivo", o texto do menu será exibido como "arquivo", o "f" será sublinhado e "f" será o atalho do teclado para o item de menu.</span><span class="sxs-lookup"><span data-stu-id="607c3-128">For example, if the "&lt;menu text&gt;" is "&File", the menu text will be displayed as "File", the "F" will be underlined and "F" will be the keyboard shortcut for the menu item.</span></span>

<span data-ttu-id="607c3-129">O " &lt; comando &gt; " é o programa ou arquivo executado pelo snap-in do.</span><span class="sxs-lookup"><span data-stu-id="607c3-129">The "&lt;command&gt;" is the program or file executed by the snap-in.</span></span> <span data-ttu-id="607c3-130">O caminho completo deve ser especificado ou o arquivo deve existir na variável de ambiente Path do computador.</span><span class="sxs-lookup"><span data-stu-id="607c3-130">Either the full path must be specified or the file must exist in the computer path environment variable.</span></span> <span data-ttu-id="607c3-131">O arquivo é invocado usando a função [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) .</span><span class="sxs-lookup"><span data-stu-id="607c3-131">The file is invoked using the [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) function.</span></span> <span data-ttu-id="607c3-132">O " &lt; comando &gt; " não pode conter parâmetros adicionais, por exemplo, Notepad.exe Myfile.txt.</span><span class="sxs-lookup"><span data-stu-id="607c3-132">The "&lt;command&gt;" cannot contain additional parameters, for example, Notepad.exe Myfile.txt.</span></span> <span data-ttu-id="607c3-133">Como **ShellExecute** é usado, qualquer arquivo ou endereço que possa ser passado para **ShellExecute** pode ser usado para " &lt; Command &gt; ".</span><span class="sxs-lookup"><span data-stu-id="607c3-133">Because **ShellExecute** is used, any file or address that can be passed to **ShellExecute** can be used for "&lt;command&gt;".</span></span> <span data-ttu-id="607c3-134">Por exemplo, se " &lt; Command &gt; " contiver "d: \\file.txt", d: \\file.txt será aberto com o aplicativo associado à extensão. txt.</span><span class="sxs-lookup"><span data-stu-id="607c3-134">For example, if "&lt;command&gt;" contains "d:\\file.txt", d:\\file.txt will be opened with the application associated with the .txt extension.</span></span> <span data-ttu-id="607c3-135">Da mesma forma, se " &lt; Command &gt; " contiver " https://www.fabrikam.com ", o navegador da Web padrão será aberto e exibirá a página a seguir especificada.</span><span class="sxs-lookup"><span data-stu-id="607c3-135">Likewise, if "&lt;command&gt;" contains "https://www.fabrikam.com", the default web browser is opened and will display the specified webpage.</span></span> <span data-ttu-id="607c3-136">Caminhos e nomes de aplicativos com espaços são permitidos.</span><span class="sxs-lookup"><span data-stu-id="607c3-136">Paths and application names with spaces are allowed.</span></span> <span data-ttu-id="607c3-137">Se " &lt; Command &gt; " for um aplicativo, o ADsPath e a classe do objeto selecionado serão passados como argumentos de linha de comando, separados por um espaço.</span><span class="sxs-lookup"><span data-stu-id="607c3-137">If "&lt;command&gt;" is an application, the selected object's ADsPath and class are passed as command line arguments, separated by a space.</span></span>

<span data-ttu-id="607c3-138">No Shell do Windows, há suporte para itens de menu de contexto de seleção múltipla.</span><span class="sxs-lookup"><span data-stu-id="607c3-138">In the Windows shell, multiple-selection context menu items are supported.</span></span> <span data-ttu-id="607c3-139">Nesse caso, o " &lt; comando &gt; " é invocado para cada objeto selecionado.</span><span class="sxs-lookup"><span data-stu-id="607c3-139">In this case, the "&lt;command&gt;" is invoked for each selected object.</span></span> <span data-ttu-id="607c3-140">Em Active Directory Domain Services ' snap-ins administrativos, não há suporte para itens de menu de contexto estático de seleção múltipla.</span><span class="sxs-lookup"><span data-stu-id="607c3-140">In Active Directory Domain Services' administrative snap-ins, multiple-selection static context menu items are not supported.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="607c3-141">Para o Shell do Windows, os dados do especificador de exibição são recuperados no logon do usuário e armazenados em cache para a sessão do usuário.</span><span class="sxs-lookup"><span data-stu-id="607c3-141">For the Windows shell, display specifier data is retrieved at user logon and cached for the user's session.</span></span> <span data-ttu-id="607c3-142">Para os snap-ins administrativos, os dados do especificador de exibição são recuperados quando o snap-in é carregado e armazenado em cache durante a duração do processo.</span><span class="sxs-lookup"><span data-stu-id="607c3-142">For the administrative snap-ins, the display specifier data is retrieved when the snap-in is loaded and is cached for the duration of the process.</span></span> <span data-ttu-id="607c3-143">Para o Shell do Windows, isso significa que as alterações para os especificadores de exibição entram em vigor após o usuário fazer logoff e logon novamente.</span><span class="sxs-lookup"><span data-stu-id="607c3-143">For the Windows shell, this means changes to display specifiers take effect after a user logs off and back on again.</span></span> <span data-ttu-id="607c3-144">Para os snap-ins administrativos, as alterações entram em vigor quando o snap-in ou o arquivo de console é recarregado; ou seja, se você iniciar uma nova instância do arquivo de console ou nova instância de Mmc.exe e adicionar o snap-in, os dados do especificador de exibição mais recentes serão recuperados.</span><span class="sxs-lookup"><span data-stu-id="607c3-144">For the administrative snap-ins, changes take effect when the snap-in or console file is reloaded; that is, if you start a new instance of the console file or new Mmc.exe instance and add the snap-in, the latest display specifier data is retrieved.</span></span>

 

<span data-ttu-id="607c3-145">Para obter mais informações e um exemplo de código, consulte [código de exemplo para instalar um item de menu de contexto estático](example-code-for-installing-a-static-context-menu-item.md).</span><span class="sxs-lookup"><span data-stu-id="607c3-145">For more information, and a code example, see [Example Code for Installing a Static Context Menu Item](example-code-for-installing-a-static-context-menu-item.md).</span></span>

 

 