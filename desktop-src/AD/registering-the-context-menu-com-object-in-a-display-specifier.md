---
title: Registrando o objeto COM do menu de contexto em um especificador de exibição
description: Este tópico mostra as chaves do registro que precisam ser modificadas para registrar um objeto COM do menu de contexto.
ms.assetid: 389bc249-4849-4763-9d1b-b35598a51050
ms.tgt_platform: multiple
keywords:
- Registrando o objeto COM do menu de contexto em um especificador de exibição
- menu de contexto do objeto COM AD, registrando
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 62ae30c1a60a1a0bc5a8ec388a3578ab13829c95
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "104007295"
---
# <a name="registering-the-context-menu-com-object-in-a-display-specifier"></a><span data-ttu-id="14983-105">Registrando o objeto COM do menu de contexto em um especificador de exibição</span><span class="sxs-lookup"><span data-stu-id="14983-105">Registering the Context Menu COM Object in a Display Specifier</span></span>

<span data-ttu-id="14983-106">Quando você usa COM para criar uma DLL de extensão de menu de contexto para um serviço de diretório Active Directory, a extensão deve ser registrada com o registro do Windows e Active Directory Domain Services para notificar os snap-ins administrativos do MMC do Active Directory e o Shell do Windows da extensão.</span><span class="sxs-lookup"><span data-stu-id="14983-106">When you use COM to create a context menu extension DLL for an Active Directory directory service, the extension must be registered with the Windows registry and Active Directory Domain Services to notify the Active Directory administrative MMC snap-ins and the Windows shell of the extension.</span></span>

## <a name="registering-in-the-windows-registry"></a><span data-ttu-id="14983-107">Registrando no registro do Windows</span><span class="sxs-lookup"><span data-stu-id="14983-107">Registering in the Windows Registry</span></span>

<span data-ttu-id="14983-108">Como todos os servidores COM, uma extensão de menu de contexto deve ser registrada no registro.</span><span class="sxs-lookup"><span data-stu-id="14983-108">Like all COM servers, a context menu extension must be registered in the registry.</span></span> <span data-ttu-id="14983-109">A extensão é registrada sob a chave a seguir.</span><span class="sxs-lookup"><span data-stu-id="14983-109">The extension is registered under the following key.</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      <clsid>
```

<span data-ttu-id="14983-110">*<clsid>* é a representação de cadeia de caracteres do CLSID, conforme produzido pela função [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="14983-110">*<clsid>* is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span> <span data-ttu-id="14983-111">Sob a *<clsid>* chave, há uma chave **InprocServer32** que identifica o objeto como um servidor no processo de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="14983-111">Under the *<clsid>* key, there is an **InProcServer32** key that identifies the object as a 32-bit in-proc server.</span></span> <span data-ttu-id="14983-112">Na chave **InprocServer32** , o local da dll é especificado no valor padrão e o modelo de threading é especificado no valor de **ThreadingModel** .</span><span class="sxs-lookup"><span data-stu-id="14983-112">Under the **InProcServer32** key, the location of the DLL is specified in the default value and the threading model is specified in the **ThreadingModel** value.</span></span> <span data-ttu-id="14983-113">Toda extensão de menu de contexto deve usar o modelo de Threading "Apartment".</span><span class="sxs-lookup"><span data-stu-id="14983-113">All context menu extension must use the "Apartment" threading model.</span></span>

## <a name="registering-with-active-directory-domain-services"></a><span data-ttu-id="14983-114">Registrando com Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="14983-114">Registering with Active Directory Domain Services</span></span>

<span data-ttu-id="14983-115">O registro de extensão do menu de contexto é específico para uma localidade.</span><span class="sxs-lookup"><span data-stu-id="14983-115">Context menu extension registration is specific to one locale.</span></span> <span data-ttu-id="14983-116">Se a extensão do menu de contexto se aplicar a todas as localidades, ela deverá ser registrada no objeto [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) da classe Object em todos os subcontêineres de localidade no contêiner exibir especificadores.</span><span class="sxs-lookup"><span data-stu-id="14983-116">If the context menu extension applies to all locales, it must be registered in the object class [**displaySpecifier**](/windows/desktop/ADSchema/c-displayspecifier) object in all of the locale subcontainers in the Display Specifiers container.</span></span> <span data-ttu-id="14983-117">Se a extensão do menu de contexto for localizada para uma determinada localidade, ela deverá ser registrada no objeto **displaySpecifier** no subcontêiner dessa localidade.</span><span class="sxs-lookup"><span data-stu-id="14983-117">If the context menu extension is localized for a certain locale, it must be registered in the **displaySpecifier** object in that locale's subcontainer.</span></span> <span data-ttu-id="14983-118">Para obter mais informações sobre o contêiner e as localidades dos especificadores de exibição, consulte [Exibir especificadores de exibição](display-specifiers.md) e [contêiner DisplaySpecifiers](displayspecifiers-container.md).</span><span class="sxs-lookup"><span data-stu-id="14983-118">For more information about the Display Specifiers container and locales, see [Display Specifiers](display-specifiers.md) and [DisplaySpecifiers Container](displayspecifiers-container.md).</span></span>

<span data-ttu-id="14983-119">Há dois atributos de especificador de exibição para os quais um item de extensão de menu de contexto pode ser registrado.</span><span class="sxs-lookup"><span data-stu-id="14983-119">There are two display specifier attributes that a context menu extension item can be registered under.</span></span> <span data-ttu-id="14983-120">Esses são [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) e [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span><span class="sxs-lookup"><span data-stu-id="14983-120">These are [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu).</span></span>

<span data-ttu-id="14983-121">O atributo [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) identifica os menus de contexto administrativos a serem exibidos em Active Directory snap-ins administrativos. O menu de contexto é exibido quando o usuário exibe o menu de contexto para objetos da classe apropriada em um dos snap-ins administrativos do MMC Active Directory.</span><span class="sxs-lookup"><span data-stu-id="14983-121">The [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) attribute identifies administrative context menus to display in Active Directory administrative snap-ins. The context menu appears when the user displays the context menu for objects of the appropriate class in one of the Active Directory administrative MMC snap-ins.</span></span>

<span data-ttu-id="14983-122">O atributo [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) identifica os menus de contexto do usuário final a serem exibidos no Shell do Windows.</span><span class="sxs-lookup"><span data-stu-id="14983-122">The [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attribute identifies end-user context menus to display in the Windows shell.</span></span> <span data-ttu-id="14983-123">O menu de contexto é exibido quando o usuário exibe o menu de contexto para objetos da classe apropriada no Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="14983-123">The context menu appears when the user views the context menu for objects of the appropriate class in the Windows Explorer.</span></span> <span data-ttu-id="14983-124">A partir do Windows Server 2003, o Shell do Windows não exibe mais objetos de Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="14983-124">Beginning with Windows Server 2003, the Windows shell no longer displays objects of Active Directory Domain Services.</span></span>

<span data-ttu-id="14983-125">Todos esses atributos têm valores múltiplos.</span><span class="sxs-lookup"><span data-stu-id="14983-125">All of these attributes are multi-valued.</span></span>

<span data-ttu-id="14983-126">Ao registrar uma extensão de menu de contexto, os valores para os atributos [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) e [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) exigem o formato a seguir.</span><span class="sxs-lookup"><span data-stu-id="14983-126">When registering a context menu extension, the values for the [**adminContextMenu**](/windows/desktop/ADSchema/a-admincontextmenu) and [**shellContextMenu**](/windows/desktop/ADSchema/a-shellcontextmenu) attributes require the following format.</span></span>


```C++
<order number>,<clsid>
```



<span data-ttu-id="14983-127">O " &lt; número do pedido &gt; " é um número sem sinal que representa a posição do item no menu de contexto.</span><span class="sxs-lookup"><span data-stu-id="14983-127">The "&lt;order number&gt;" is an unsigned number that represents the item position in the context menu.</span></span> <span data-ttu-id="14983-128">Quando um menu de contexto é exibido, os valores são classificados usando uma comparação de "número de &lt; ordem" de cada valor &gt; .</span><span class="sxs-lookup"><span data-stu-id="14983-128">When a context menu is displayed, the values are sorted using a comparison of each value's "&lt;order number&gt;".</span></span> <span data-ttu-id="14983-129">Se mais de um valor tiver o mesmo " &lt; número do pedido &gt; ", essas extensões de menu de contexto serão carregadas na ordem em que são lidas do servidor de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="14983-129">If more than one value has the same "&lt;order number&gt;", those context menu extensions are loaded in the order they are read from the Active Directory server.</span></span> <span data-ttu-id="14983-130">Se possível, use um " &lt; número de pedido" não existente &gt; , ou seja, um que não tenha sido usado por outros valores na propriedade.</span><span class="sxs-lookup"><span data-stu-id="14983-130">If possible, use a non-existing "&lt;order number&gt;", that is, one that has not been used by other values in the property.</span></span> <span data-ttu-id="14983-131">Não há posição e lacunas de início indicadas na sequência " &lt; número do pedido &gt; ".</span><span class="sxs-lookup"><span data-stu-id="14983-131">There is no prescribed starting position and gaps are allowed in the "&lt;order number&gt;" sequence.</span></span>

<span data-ttu-id="14983-132">O " &lt; CLSID &gt; " é a representação de cadeia de caracteres do CLSID, conforme produzido pela função [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .</span><span class="sxs-lookup"><span data-stu-id="14983-132">The "&lt;clsid&gt;" is the string representation of the CLSID as produced by the [**StringFromCLSID**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) function.</span></span>

<span data-ttu-id="14983-133">No Shell do Windows, há suporte para itens de menu de contexto de seleção múltipla.</span><span class="sxs-lookup"><span data-stu-id="14983-133">In the Windows shell, multiple-selection context menu items are supported.</span></span> <span data-ttu-id="14983-134">Nesse caso, a extensão do menu de contexto é invocada para cada objeto selecionado.</span><span class="sxs-lookup"><span data-stu-id="14983-134">In this case, the context menu extension is invoked for each selected object.</span></span> <span data-ttu-id="14983-135">Em Active Directory snap-ins administrativos, também há suporte para itens de extensão de menu de contexto de seleção múltipla.</span><span class="sxs-lookup"><span data-stu-id="14983-135">In Active Directory administrative snap-ins, multiple-selection context menu extension items are also supported.</span></span> <span data-ttu-id="14983-136">Nesse caso, a estrutura [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) conterá uma estrutura [**DSOBJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) para cada objeto de diretório selecionado.</span><span class="sxs-lookup"><span data-stu-id="14983-136">In this case, the [**DSOBJECTNAMES**](/windows/desktop/api/Dsclient/ns-dsclient-dsobjectnames) structure will contain a [**DSOBJECT**](/windows/desktop/api/Dsclient/ns-dsclient-dsobject) structure for each directory object selected.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="14983-137">Para o Shell do Windows, as informações do especificador de exibição são recuperadas no logon do usuário e armazenadas em cache para a sessão do usuário.</span><span class="sxs-lookup"><span data-stu-id="14983-137">For the Windows shell, display specifier information is retrieved at user logon and cached for the user's session.</span></span> <span data-ttu-id="14983-138">Para os snap-ins administrativos, os dados do especificador de exibição são recuperados quando o snap-in é carregado e armazenado em cache durante a duração do processo.</span><span class="sxs-lookup"><span data-stu-id="14983-138">For the administrative snap-ins, the display specifier data is retrieved when the snap-in is loaded and is cached for the duration of the process.</span></span> <span data-ttu-id="14983-139">Para o Shell do Windows, isso significa que as alterações para os especificadores de exibição entram em vigor após o usuário fazer logoff e logon novamente.</span><span class="sxs-lookup"><span data-stu-id="14983-139">For the Windows shell, this means changes to display specifiers take effect after a user logs off and back on again.</span></span> <span data-ttu-id="14983-140">Para os snap-ins administrativos, as alterações entram em vigor quando o snap-in ou o arquivo de console é recarregado, ou seja, se você iniciar uma nova instância do arquivo de console ou nova instância de Mmc.exe e adicionar o snap-in, os dados do especificador de exibição mais recentes serão recuperados.</span><span class="sxs-lookup"><span data-stu-id="14983-140">For the administrative snap-ins, changes take effect when the snap-in or console file is reloaded, that is, if you start a new instance of the console file or new Mmc.exe instance and add the snap-in, the latest display specifier data is retrieved.</span></span>

 

<span data-ttu-id="14983-141">Para obter mais informações e um exemplo de código de como implementar uma extensão de menu de contexto, consulte [exemplo de código para implementação do objeto com do menu de contexto](example-code-for-implementation-of-the-context-menu-com-object.md).</span><span class="sxs-lookup"><span data-stu-id="14983-141">For more information, and a code example of how to implement a context menu extension, see [Example Code for Implementation of the Context Menu COM Object](example-code-for-implementation-of-the-context-menu-com-object.md).</span></span>

 

 