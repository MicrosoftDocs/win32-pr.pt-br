---
title: Criando um direito de acesso de controle
description: Para adicionar um direito de acesso de controle a um servidor de Active Directory, crie um objeto controlAccessRight no contêiner de Extended-Rights da partição de configuração.
ms.assetid: dacd42c6-17d9-4dfe-8f51-e4a470766494
ms.tgt_platform: multiple
keywords:
- Criando um AD direto de acesso de controle
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 11bdc764b09f0fe5bd165e87e23a89db7d368bfe
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "103640423"
---
# <a name="creating-a-control-access-right"></a>Criando um direito de acesso de controle

Para adicionar um direito de acesso de controle a um servidor de Active Directory, crie um objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) no contêiner de Extended-Rights da partição de configuração. Para obter mais informações e um exemplo de código, consulte [código de exemplo para criar um direito de acesso de controle](example-code-for-creating-a-control-access-right.md). Para usar o direito de acesso de controle, você deve concluir mais algumas etapas, dependendo se o direito de acesso de controle é para uma operação especial ou um conjunto de propriedades.

Se você definir um direito de acesso de controle para um conjunto de propriedades, use o **rightsGUID** do objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) para identificar as propriedades no conjunto. Cada propriedade é definida por um objeto [**attributeSchema**](/windows/desktop/ADSchema/c-attributeschema) no esquema de Active Directory. A propriedade [**attributeSecurityGUID**](/windows/desktop/ADSchema/a-attributesecurityguid) de um objeto **attributeSchema** identifica o conjunto de propriedades, se houver, ao qual a propriedade pertence. Lembre-se de que a propriedade **attributeSecurityGUID** é de valor único e armazena o GUID em formato binário (sintaxe de cadeia de caracteres de octeto).

Se você definir um direito de acesso de controle para posicionar as restrições de acesso a uma operação específica, seu aplicativo deverá executar a verificação de acesso quando um usuário tentar a operação.

**Para configurar a verificação de acesso**

1.  Crie um direito de acesso de controle que defina o tipo de acesso ao aplicativo ou serviço. Para obter mais informações, consulte o exemplo de código a seguir.
2.  Crie um objeto Active Directory Domain Services que represente o aplicativo, o serviço ou o recurso que você está protegendo.
3.  Adicione ACEs de objeto à DACL no descritor de segurança do objeto para conceder ou negar aos usuários ou grupos o direito de acesso de controle no objeto. Para obter mais informações, consulte [definindo um ACE de acesso de controle na ACL de um objeto](setting-a-control-access-right-ace-in-an-objectampaposs-acl.md).
4.  Quando um usuário tenta executar a operação, verifique os direitos de usuário passando o descritor de segurança do objeto e o token de acesso do usuário para a função [**AccessCheckByTypeResultList**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist) . Para obter mais informações, consulte [verificando um direito de acesso de controle na ACL de um objeto](checking-a-control-access-right-in-an-objectampaposs-acl.md).

Com base no resultado da verificação de acesso no objeto, o aplicativo ou serviço pode permitir ou negar o acesso do usuário ao aplicativo ou serviço.

Ao criar um objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) , defina os atributos, listados na tabela a seguir, para tornar o objeto um direito de acesso de controle legal que é reconhecido pelo Active Directory Domain Services e pelos sistemas de segurança do Windows.



| Atributo                                     | Descrição                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**cn**](/windows/desktop/ADSchema/a-cn)                       | Uma propriedade de valor único que é o RDN (nome distinto relativo) do objeto no contêiner de Extended-Rights. O **CN** é o nome do direito de controle de acesso em Active Directory Domain Services.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**appliesTo**](/windows/desktop/ADSchema/a-appliesto)         | Uma propriedade com valores múltiplos que lista as classes de objeto às quais o direito de controle de acesso se aplica. Por exemplo, o direito de controle de acesso [**Send-**](/windows/desktop/ADSchema/r-send-as) as lista as classes de objeto [**User**](/windows/desktop/ADSchema/c-user) e [**Computer**](/windows/desktop/ADSchema/c-computer) em sua propriedade **AppliesTo** . Na lista, cada classe de objeto é identificada pelo [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) de seu objeto [**classSchema**](/windows/desktop/ADSchema/c-classschema) . Os GUIDs são armazenados como cadeias de caracteres do formulário produzido pela função [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) na biblioteca com, mas sem as chaves de início e término ({}). Por exemplo, o GUID a seguir é o **schemaIDGUID** para a classe de [**computador**](/windows/desktop/ADSchema/c-computer) : bf967a86-0de6-11D0-a285-00aa003049e2.<br/> Lembre-se de que a propriedade [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) de um objeto [**classSchema**](/windows/desktop/ADSchema/c-classschema) é armazenada como um GUID binário usando a sintaxe de cadeia de caracteres de octeto. Para converter esse formato de cadeia de caracteres de octeto no formato de cadeia de caracteres usado na propriedade [**AppliesTo**](/windows/desktop/ADSchema/a-appliesto) , use a função [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) e remova as chaves da cadeia de caracteres retornada.<br/> Para obter mais informações sobre a propriedade [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) de uma das classes de objeto predefinidas, como [**usuário**](/windows/desktop/ADSchema/c-user) ou [**computador**](/windows/desktop/ADSchema/c-computer), consulte a página referência de classe na referência de esquema de Active Directory na [referência de Active Directory Domain Services](active-directory-domain-services-reference.md). Para obter mais informações e um exemplo de código que recupera um **schemaIDGUID** de um objeto classSchema, consulte [lendo objetos attributeSchema e classSchema](reading-attributeschema-and-classschema-objects.md).<br/> |
| [**displayName**](/windows/desktop/ADSchema/a-displayname)     | A cadeia de caracteres usada para exibir o direito de controle de acesso em interfaces do usuário, como a página de propriedades **segurança** e outros locais no snap-in Active Directory usuários e computadores do MMC.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [**rightsGuid**](/windows/desktop/ADSchema/a-rightsguid)       | Um GUID que identifica o direito de acesso de controle em uma ACE. O GUID é armazenado como uma cadeia de caracteres do formulário produzido pela função [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) , mas sem as chaves de início e de encerramento. Use Uuidgen.exe para algum outro utilitário para gerar um GUID para o direito de acesso de controle. Se você definir um novo conjunto de propriedades, use o [**rightsGuid**](/windows/desktop/ADSchema/a-rightsguid) do objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) para identificar as propriedades no conjunto. Para cada propriedade no conjunto de propriedades, defina o valor de [**attributeSecurityGUID**](/windows/desktop/ADSchema/a-attributesecurityguid) da propriedade como o valor da **rightsGUID** do conjunto de propriedades. O valor de **attributeSecurityGUID** de uma propriedade é armazenado na definição de [**attributeSchema**](/windows/desktop/ADSchema/c-attributeschema) da propriedade no esquema de Active Directory. A propriedade **attributeSecurityGUID** é de valor único e armazena o GUID em formato binário (sintaxe de cadeia de caracteres de octeto).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**objectClass**](/windows/desktop/ADSchema/a-objectclass)     | Esse atributo especifica [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) como a classe de objeto.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [**validAccesses**](/windows/desktop/ADSchema/a-validaccesses) | Para conjuntos de propriedades, defina esse atributo como 0x30 (**ADS \_ Rights \_ DS \_ Read \_ prop** \| **ADS \_ Right \_ DS \_ Write \_ prop**). Para direitos de acesso de controle, defina esse atributo como 0x100 (**anúncios \_ direito \_ DS \_ Control \_ Access**). A página de propriedades de segurança reconhece controlar direitos de acesso somente se o atributo [**validAccesses**](/windows/desktop/ADSchema/a-validaccesses) estiver definido como o valor apropriado. Se zero, o direito de acesso de controle é ignorado ou não é exibido pela página de propriedades de segurança.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |



 

Lembre-se de que as classes de esquema predefinidas usam o atributo **localizationDisplayId** de um objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) para especificar um identificador de mensagem usado para recuperar um nome de exibição localizado de Dssec.dll. Não defina o atributo **localizationDisplayId** se você definir um novo objeto **controlAccessRight** .

 

