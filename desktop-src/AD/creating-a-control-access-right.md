---
title: Criando um direito de acesso de controle
description: Para adicionar um direito de acesso de controle a um servidor de Active Directory, crie um objeto controlAccessRight no contêiner de Extended-Rights da partição de configuração.
ms.assetid: dacd42c6-17d9-4dfe-8f51-e4a470766494
ms.tgt_platform: multiple
keywords:
- Criando um AD direto de acesso de controle
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 11bdc764b09f0fe5bd165e87e23a89db7d368bfe
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/17/2020
ms.locfileid: "103640423"
---
# <a name="creating-a-control-access-right"></a><span data-ttu-id="4434a-104">Criando um direito de acesso de controle</span><span class="sxs-lookup"><span data-stu-id="4434a-104">Creating a Control Access Right</span></span>

<span data-ttu-id="4434a-105">Para adicionar um direito de acesso de controle a um servidor de Active Directory, crie um objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) no contêiner de Extended-Rights da partição de configuração.</span><span class="sxs-lookup"><span data-stu-id="4434a-105">To add a control access right to an Active Directory server, create a [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) object in the Extended-Rights container of the Configuration partition.</span></span> <span data-ttu-id="4434a-106">Para obter mais informações e um exemplo de código, consulte [código de exemplo para criar um direito de acesso de controle](example-code-for-creating-a-control-access-right.md).</span><span class="sxs-lookup"><span data-stu-id="4434a-106">For more information and a code example, see [Example Code for Creating a Control Access Right](example-code-for-creating-a-control-access-right.md).</span></span> <span data-ttu-id="4434a-107">Para usar o direito de acesso de controle, você deve concluir mais algumas etapas, dependendo se o direito de acesso de controle é para uma operação especial ou um conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="4434a-107">To use the control access right, you must complete a few more steps, depending on whether the control access right is for a special operation or a property set.</span></span>

<span data-ttu-id="4434a-108">Se você definir um direito de acesso de controle para um conjunto de propriedades, use o **rightsGUID** do objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) para identificar as propriedades no conjunto.</span><span class="sxs-lookup"><span data-stu-id="4434a-108">If you define a control access right for a property set, use the **rightsGUID** of the [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) object to identify the properties in the set.</span></span> <span data-ttu-id="4434a-109">Cada propriedade é definida por um objeto [**attributeSchema**](/windows/desktop/ADSchema/c-attributeschema) no esquema de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4434a-109">Every property is defined by an [**attributeSchema**](/windows/desktop/ADSchema/c-attributeschema) object in the Active Directory schema.</span></span> <span data-ttu-id="4434a-110">A propriedade [**attributeSecurityGUID**](/windows/desktop/ADSchema/a-attributesecurityguid) de um objeto **attributeSchema** identifica o conjunto de propriedades, se houver, ao qual a propriedade pertence.</span><span class="sxs-lookup"><span data-stu-id="4434a-110">The [**attributeSecurityGUID**](/windows/desktop/ADSchema/a-attributesecurityguid) property of an **attributeSchema** object identifies the property set, if any, that the property belongs to.</span></span> <span data-ttu-id="4434a-111">Lembre-se de que a propriedade **attributeSecurityGUID** é de valor único e armazena o GUID em formato binário (sintaxe de cadeia de caracteres de octeto).</span><span class="sxs-lookup"><span data-stu-id="4434a-111">Be aware that the **attributeSecurityGUID** property is single-valued and stores the GUID in binary format (octet string syntax).</span></span>

<span data-ttu-id="4434a-112">Se você definir um direito de acesso de controle para posicionar as restrições de acesso a uma operação específica, seu aplicativo deverá executar a verificação de acesso quando um usuário tentar a operação.</span><span class="sxs-lookup"><span data-stu-id="4434a-112">If you define a control access right to place restrictions on access to a particular operation, your application must perform the access check when a user attempts the operation.</span></span>

<span data-ttu-id="4434a-113">**Para configurar a verificação de acesso**</span><span class="sxs-lookup"><span data-stu-id="4434a-113">**To set up access check**</span></span>

1.  <span data-ttu-id="4434a-114">Crie um direito de acesso de controle que defina o tipo de acesso ao aplicativo ou serviço.</span><span class="sxs-lookup"><span data-stu-id="4434a-114">Create a control access right that defines the type of access to the application or service.</span></span> <span data-ttu-id="4434a-115">Para obter mais informações, consulte o exemplo de código a seguir.</span><span class="sxs-lookup"><span data-stu-id="4434a-115">For more information, see the following code example.</span></span>
2.  <span data-ttu-id="4434a-116">Crie um objeto Active Directory Domain Services que represente o aplicativo, o serviço ou o recurso que você está protegendo.</span><span class="sxs-lookup"><span data-stu-id="4434a-116">Create an Active Directory Domain Services object that represents the application, service, or resource that you are protecting.</span></span>
3.  <span data-ttu-id="4434a-117">Adicione ACEs de objeto à DACL no descritor de segurança do objeto para conceder ou negar aos usuários ou grupos o direito de acesso de controle no objeto.</span><span class="sxs-lookup"><span data-stu-id="4434a-117">Add object ACEs to the DACL in the object security descriptor to grant or deny users or groups the control access right on that object.</span></span> <span data-ttu-id="4434a-118">Para obter mais informações, consulte [definindo um ACE de acesso de controle na ACL de um objeto](setting-a-control-access-right-ace-in-an-objectampaposs-acl.md).</span><span class="sxs-lookup"><span data-stu-id="4434a-118">For more information, see [Setting a Control Access Right ACE in an Object's ACL](setting-a-control-access-right-ace-in-an-objectampaposs-acl.md).</span></span>
4.  <span data-ttu-id="4434a-119">Quando um usuário tenta executar a operação, verifique os direitos de usuário passando o descritor de segurança do objeto e o token de acesso do usuário para a função [**AccessCheckByTypeResultList**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist) .</span><span class="sxs-lookup"><span data-stu-id="4434a-119">When a user attempts to perform the operation, verify the user rights by passing the object security descriptor and the user access token to the [**AccessCheckByTypeResultList**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist) function.</span></span> <span data-ttu-id="4434a-120">Para obter mais informações, consulte [verificando um direito de acesso de controle na ACL de um objeto](checking-a-control-access-right-in-an-objectampaposs-acl.md).</span><span class="sxs-lookup"><span data-stu-id="4434a-120">For more information, see [Checking a Control Access Right in an Object's ACL](checking-a-control-access-right-in-an-objectampaposs-acl.md).</span></span>

<span data-ttu-id="4434a-121">Com base no resultado da verificação de acesso no objeto, o aplicativo ou serviço pode permitir ou negar o acesso do usuário ao aplicativo ou serviço.</span><span class="sxs-lookup"><span data-stu-id="4434a-121">Based on the result of the access check on the object, the application or service can allow or deny the user access to the application or service.</span></span>

<span data-ttu-id="4434a-122">Ao criar um objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) , defina os atributos, listados na tabela a seguir, para tornar o objeto um direito de acesso de controle legal que é reconhecido pelo Active Directory Domain Services e pelos sistemas de segurança do Windows.</span><span class="sxs-lookup"><span data-stu-id="4434a-122">When you create a [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) object, set the attributes, listed in the following table, to make the object a legal control access right that is recognized by Active Directory Domain Services and the Windows security systems.</span></span>



| <span data-ttu-id="4434a-123">Atributo</span><span class="sxs-lookup"><span data-stu-id="4434a-123">Attribute</span></span>                                     | <span data-ttu-id="4434a-124">Descrição</span><span class="sxs-lookup"><span data-stu-id="4434a-124">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="4434a-125">**cn**</span><span class="sxs-lookup"><span data-stu-id="4434a-125">**cn**</span></span>](/windows/desktop/ADSchema/a-cn)                       | <span data-ttu-id="4434a-126">Uma propriedade de valor único que é o RDN (nome distinto relativo) do objeto no contêiner de Extended-Rights.</span><span class="sxs-lookup"><span data-stu-id="4434a-126">A single-valued property that is the object's relative distinguished name (RDN) in the Extended-Rights container.</span></span> <span data-ttu-id="4434a-127">O **CN** é o nome do direito de controle de acesso em Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="4434a-127">The **cn** is the name of the access control right in Active Directory Domain Services.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [<span data-ttu-id="4434a-128">**appliesTo**</span><span class="sxs-lookup"><span data-stu-id="4434a-128">**appliesTo**</span></span>](/windows/desktop/ADSchema/a-appliesto)         | <span data-ttu-id="4434a-129">Uma propriedade com valores múltiplos que lista as classes de objeto às quais o direito de controle de acesso se aplica.</span><span class="sxs-lookup"><span data-stu-id="4434a-129">A multi-valued property that lists the object classes that the access control right applies to.</span></span> <span data-ttu-id="4434a-130">Por exemplo, o direito de controle de acesso [**Send-**](/windows/desktop/ADSchema/r-send-as) as lista as classes de objeto [**User**](/windows/desktop/ADSchema/c-user) e [**Computer**](/windows/desktop/ADSchema/c-computer) em sua propriedade **AppliesTo** .</span><span class="sxs-lookup"><span data-stu-id="4434a-130">For example, the [**Send-As**](/windows/desktop/ADSchema/r-send-as) access control right lists the [**user**](/windows/desktop/ADSchema/c-user) and [**computer**](/windows/desktop/ADSchema/c-computer) object classes in its **appliesTo** property.</span></span> <span data-ttu-id="4434a-131">Na lista, cada classe de objeto é identificada pelo [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) de seu objeto [**classSchema**](/windows/desktop/ADSchema/c-classschema) .</span><span class="sxs-lookup"><span data-stu-id="4434a-131">In the list, each object class is identified by the [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) of its [**classSchema**](/windows/desktop/ADSchema/c-classschema) object.</span></span> <span data-ttu-id="4434a-132">Os GUIDs são armazenados como cadeias de caracteres do formulário produzido pela função [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) na biblioteca com, mas sem as chaves de início e término ({}).</span><span class="sxs-lookup"><span data-stu-id="4434a-132">The GUIDs are stored as strings of the form produced by the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function in the COM library but without the starting and terminating braces ({ }).</span></span> <span data-ttu-id="4434a-133">Por exemplo, o GUID a seguir é o **schemaIDGUID** para a classe de [**computador**](/windows/desktop/ADSchema/c-computer) : bf967a86-0de6-11D0-a285-00aa003049e2.</span><span class="sxs-lookup"><span data-stu-id="4434a-133">For example, the following GUID is the **schemaIDGUID** for the [**computer**](/windows/desktop/ADSchema/c-computer) class: bf967a86-0de6-11d0-a285-00aa003049e2.</span></span><br/> <span data-ttu-id="4434a-134">Lembre-se de que a propriedade [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) de um objeto [**classSchema**](/windows/desktop/ADSchema/c-classschema) é armazenada como um GUID binário usando a sintaxe de cadeia de caracteres de octeto.</span><span class="sxs-lookup"><span data-stu-id="4434a-134">Be aware that the [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) property of a [**classSchema**](/windows/desktop/ADSchema/c-classschema) object is stored as a binary GUID using the octet string syntax.</span></span> <span data-ttu-id="4434a-135">Para converter esse formato de cadeia de caracteres de octeto no formato de cadeia de caracteres usado na propriedade [**AppliesTo**](/windows/desktop/ADSchema/a-appliesto) , use a função [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) e remova as chaves da cadeia de caracteres retornada.</span><span class="sxs-lookup"><span data-stu-id="4434a-135">To convert this octet string format to the string format used in the [**appliesTo**](/windows/desktop/ADSchema/a-appliesto) property, use the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function and remove the braces from the returned string.</span></span><br/> <span data-ttu-id="4434a-136">Para obter mais informações sobre a propriedade [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) de uma das classes de objeto predefinidas, como [**usuário**](/windows/desktop/ADSchema/c-user) ou [**computador**](/windows/desktop/ADSchema/c-computer), consulte a página referência de classe na referência de esquema de Active Directory na [referência de Active Directory Domain Services](active-directory-domain-services-reference.md).</span><span class="sxs-lookup"><span data-stu-id="4434a-136">For more information about the [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) property of one of the predefined object classes, such as [**user**](/windows/desktop/ADSchema/c-user) or [**computer**](/windows/desktop/ADSchema/c-computer), see the class reference page in the Active Directory Schema Reference in the [Active Directory Domain Services Reference](active-directory-domain-services-reference.md).</span></span> <span data-ttu-id="4434a-137">Para obter mais informações e um exemplo de código que recupera um **schemaIDGUID** de um objeto classSchema, consulte [lendo objetos attributeSchema e classSchema](reading-attributeschema-and-classschema-objects.md).</span><span class="sxs-lookup"><span data-stu-id="4434a-137">For more information and a code example that retrieves a **schemaIDGUID** from a classSchema object, see [Reading attributeSchema and classSchema Objects](reading-attributeschema-and-classschema-objects.md).</span></span><br/> |
| [<span data-ttu-id="4434a-138">**displayName**</span><span class="sxs-lookup"><span data-stu-id="4434a-138">**displayName**</span></span>](/windows/desktop/ADSchema/a-displayname)     | <span data-ttu-id="4434a-139">A cadeia de caracteres usada para exibir o direito de controle de acesso em interfaces do usuário, como a página de propriedades **segurança** e outros locais no snap-in Active Directory usuários e computadores do MMC.</span><span class="sxs-lookup"><span data-stu-id="4434a-139">The string used to display the access control right in user interfaces such as the **Security** property page and other places in the Active Directory Users and Computers MMC snap-in.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [<span data-ttu-id="4434a-140">**rightsGuid**</span><span class="sxs-lookup"><span data-stu-id="4434a-140">**rightsGuid**</span></span>](/windows/desktop/ADSchema/a-rightsguid)       | <span data-ttu-id="4434a-141">Um GUID que identifica o direito de acesso de controle em uma ACE.</span><span class="sxs-lookup"><span data-stu-id="4434a-141">A GUID that identifies the control access right in an ACE.</span></span> <span data-ttu-id="4434a-142">O GUID é armazenado como uma cadeia de caracteres do formulário produzido pela função [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) , mas sem as chaves de início e de encerramento.</span><span class="sxs-lookup"><span data-stu-id="4434a-142">The GUID is stored as a string of the form produced by the [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) function, but without the starting and terminating braces.</span></span> <span data-ttu-id="4434a-143">Use Uuidgen.exe para algum outro utilitário para gerar um GUID para o direito de acesso de controle. Se você definir um novo conjunto de propriedades, use o [**rightsGuid**](/windows/desktop/ADSchema/a-rightsguid) do objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) para identificar as propriedades no conjunto.</span><span class="sxs-lookup"><span data-stu-id="4434a-143">Use Uuidgen.exe for some other utility to generate a GUID for the control access right.If you define a new property set, you use the [**rightsGuid**](/windows/desktop/ADSchema/a-rightsguid) of the [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) object to identify the properties in the set.</span></span> <span data-ttu-id="4434a-144">Para cada propriedade no conjunto de propriedades, defina o valor de [**attributeSecurityGUID**](/windows/desktop/ADSchema/a-attributesecurityguid) da propriedade como o valor da **rightsGUID** do conjunto de propriedades.</span><span class="sxs-lookup"><span data-stu-id="4434a-144">For each property in the property set, set the property's [**attributeSecurityGUID**](/windows/desktop/ADSchema/a-attributesecurityguid) value to the value of the property set's **rightsGUID**.</span></span> <span data-ttu-id="4434a-145">O valor de **attributeSecurityGUID** de uma propriedade é armazenado na definição de [**attributeSchema**](/windows/desktop/ADSchema/c-attributeschema) da propriedade no esquema de Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4434a-145">A property's **attributeSecurityGUID** value is stored in the property's [**attributeSchema**](/windows/desktop/ADSchema/c-attributeschema) definition in the Active Directory schema.</span></span> <span data-ttu-id="4434a-146">A propriedade **attributeSecurityGUID** é de valor único e armazena o GUID em formato binário (sintaxe de cadeia de caracteres de octeto).</span><span class="sxs-lookup"><span data-stu-id="4434a-146">The **attributeSecurityGUID** property is single-valued and stores the GUID in binary format (octet string syntax).</span></span><br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [<span data-ttu-id="4434a-147">**objectClass**</span><span class="sxs-lookup"><span data-stu-id="4434a-147">**objectClass**</span></span>](/windows/desktop/ADSchema/a-objectclass)     | <span data-ttu-id="4434a-148">Esse atributo especifica [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) como a classe de objeto.</span><span class="sxs-lookup"><span data-stu-id="4434a-148">This attribute specifies [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) as the object class.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [<span data-ttu-id="4434a-149">**validAccesses**</span><span class="sxs-lookup"><span data-stu-id="4434a-149">**validAccesses**</span></span>](/windows/desktop/ADSchema/a-validaccesses) | <span data-ttu-id="4434a-150">Para conjuntos de propriedades, defina esse atributo como 0x30 (**ADS \_ Rights \_ DS \_ Read \_ prop** \| **ADS \_ Right \_ DS \_ Write \_ prop**).</span><span class="sxs-lookup"><span data-stu-id="4434a-150">For property sets, set this attribute to 0x30 (**ADS\_RIGHT\_DS\_READ\_PROP** \| **ADS\_RIGHT\_DS\_WRITE\_PROP**).</span></span> <span data-ttu-id="4434a-151">Para direitos de acesso de controle, defina esse atributo como 0x100 (**anúncios \_ direito \_ DS \_ Control \_ Access**).</span><span class="sxs-lookup"><span data-stu-id="4434a-151">For control access rights, set this attribute to 0x100 (**ADS\_RIGHT\_DS\_CONTROL\_ACCESS**).</span></span> <span data-ttu-id="4434a-152">A página de propriedades de segurança reconhece controlar direitos de acesso somente se o atributo [**validAccesses**](/windows/desktop/ADSchema/a-validaccesses) estiver definido como o valor apropriado.</span><span class="sxs-lookup"><span data-stu-id="4434a-152">The security property page recognizes control access rights only if the [**validAccesses**](/windows/desktop/ADSchema/a-validaccesses) attribute is set to the appropriate value.</span></span> <span data-ttu-id="4434a-153">Se zero, o direito de acesso de controle é ignorado ou não é exibido pela página de propriedades de segurança.</span><span class="sxs-lookup"><span data-stu-id="4434a-153">If zero, the control access right is ignored or not displayed by the security property page.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |



 

<span data-ttu-id="4434a-154">Lembre-se de que as classes de esquema predefinidas usam o atributo **localizationDisplayId** de um objeto [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) para especificar um identificador de mensagem usado para recuperar um nome de exibição localizado de Dssec.dll.</span><span class="sxs-lookup"><span data-stu-id="4434a-154">Be aware that the predefined schema classes use the **localizationDisplayId** attribute of a [**controlAccessRight**](/windows/desktop/ADSchema/c-controlaccessright) object to specify a message identifier used to retrieve a localized display name from Dssec.dll.</span></span> <span data-ttu-id="4434a-155">Não defina o atributo **localizationDisplayId** se você definir um novo objeto **controlAccessRight** .</span><span class="sxs-lookup"><span data-stu-id="4434a-155">Do not set the **localizationDisplayId** attribute if you define a new **controlAccessRight** object.</span></span>

 

