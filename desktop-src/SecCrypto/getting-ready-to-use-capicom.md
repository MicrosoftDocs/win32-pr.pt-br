---
description: Os aplicativos que usam objetos CAPICOM devem ser criados usando CAPICOM.dll. CAPICOM.dll também deve estar presente e registrado em tempo de execução para usar objetos CAPICOM.
ms.assetid: 69de5232-e2f9-4aed-935d-5fbcd7998cc9
title: Preparando-se para usar o CAPICOM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f6fc1ad0dbfe3d4f8c4dae3286eb3ffa5e1ae03d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105769284"
---
# <a name="getting-ready-to-use-capicom"></a><span data-ttu-id="08dc6-104">Preparando-se para usar o CAPICOM</span><span class="sxs-lookup"><span data-stu-id="08dc6-104">Getting Ready to Use CAPICOM</span></span>

<span data-ttu-id="08dc6-105">\[O CAPICOM é um componente somente de 32 bits que está disponível para uso nos seguintes sistemas operacionais: Windows Server 2008, Windows Vista e Windows XP.</span><span class="sxs-lookup"><span data-stu-id="08dc6-105">\[CAPICOM is a 32-bit only component that is available for use in the following operating systems: Windows Server 2008, Windows Vista, and Windows XP.</span></span> <span data-ttu-id="08dc6-106">Em vez disso, use o .NET Framework para implementar recursos de segurança.</span><span class="sxs-lookup"><span data-stu-id="08dc6-106">Instead, use the .NET Framework to implement security features.</span></span> <span data-ttu-id="08dc6-107">Para obter mais informações, consulte [alternativas ao uso do CApicom](alternatives-to-using-capicom.md).\]</span><span class="sxs-lookup"><span data-stu-id="08dc6-107">For more information, see [Alternatives to Using CAPICOM](alternatives-to-using-capicom.md).\]</span></span>

<span data-ttu-id="08dc6-108">Os aplicativos que usam objetos CAPICOM devem ser criados usando CAPICOM.dll.</span><span class="sxs-lookup"><span data-stu-id="08dc6-108">Applications that use CAPICOM objects must be created by using CAPICOM.dll.</span></span> <span data-ttu-id="08dc6-109">CAPICOM.dll também deve estar presente e registrado em tempo de execução para usar objetos CAPICOM.</span><span class="sxs-lookup"><span data-stu-id="08dc6-109">CAPICOM.dll must also be present and registered at run time to use CAPICOM objects.</span></span> <span data-ttu-id="08dc6-110">CAPICOM.dll deve ser adicionado a Visual Basic referências de projetos para usar objetos CAPICOM.</span><span class="sxs-lookup"><span data-stu-id="08dc6-110">CAPICOM.dll should be added to Visual Basic projects references to use CAPICOM objects.</span></span>

<span data-ttu-id="08dc6-111">O CAPICOM está disponível como um arquivo redistribuível que pode ser baixado de [Platform SDK Redistributable: CApicom](https://www.microsoft.com/download/details.aspx?id=25281).</span><span class="sxs-lookup"><span data-stu-id="08dc6-111">CAPICOM is available as a redistributable file that can be downloaded from [Platform SDK Redistributable: CAPICOM](https://www.microsoft.com/download/details.aspx?id=25281).</span></span> <span data-ttu-id="08dc6-112">Para obter informações sobre versões capicor, consulte [versões de capico](capicom-versions.md).</span><span class="sxs-lookup"><span data-stu-id="08dc6-112">For information about CAPICOM versions, see [CAPICOM Versions](capicom-versions.md).</span></span>

<span data-ttu-id="08dc6-113">**Para registrar CAPICOM.dll**</span><span class="sxs-lookup"><span data-stu-id="08dc6-113">**To register CAPICOM.dll**</span></span>

-   <span data-ttu-id="08dc6-114">Em um prompt de comando, altere o diretório para o diretório onde CAPICOM.dll está armazenado e, em seguida, digite o seguinte comando:</span><span class="sxs-lookup"><span data-stu-id="08dc6-114">At a command prompt, change the directory to the directory where CAPICOM.dll is stored, and then enter the following command:</span></span>

    <span data-ttu-id="08dc6-115">**CAPICOM.dllregsvr32**</span><span class="sxs-lookup"><span data-stu-id="08dc6-115">**regsvr32 CAPICOM.dll**</span></span>

## <a name="example-code-limitations"></a><span data-ttu-id="08dc6-116">Limitações de código de exemplo</span><span class="sxs-lookup"><span data-stu-id="08dc6-116">Example Code Limitations</span></span>

<span data-ttu-id="08dc6-117">Para fornecer um código mais conciso e legível, os princípios de boa prática de programação nem sempre são seguidos nesses exemplos.</span><span class="sxs-lookup"><span data-stu-id="08dc6-117">To provide more concise, more readable code, principles of good programming practice are not always followed in these examples.</span></span> <span data-ttu-id="08dc6-118">Em particular, apenas respostas de erro limitadas são mostradas.</span><span class="sxs-lookup"><span data-stu-id="08dc6-118">In particular, only limited error responses are shown.</span></span> <span data-ttu-id="08dc6-119">Os aplicativos de trabalho sempre devem verificar os códigos de erro retornados e executar as ações apropriadas quando um erro for encontrado.</span><span class="sxs-lookup"><span data-stu-id="08dc6-119">Working applications should always check returned error codes and perform appropriate actions when an error is encountered.</span></span>

## <a name="necessary-key-containers-keys-and-certificates-in-capicom"></a><span data-ttu-id="08dc6-120">Contêineres de chave, chaves e certificados necessários no CAPICOM</span><span class="sxs-lookup"><span data-stu-id="08dc6-120">Necessary Key Containers, Keys, and Certificates in CAPICOM</span></span>

<span data-ttu-id="08dc6-121">Enquanto algumas operações com objetos CAPICOM podem ser feitas em qualquer computador por qualquer usuário, a criação de [*assinaturas digitais*](../secgloss/d-gly.md) e a recuperação do conteúdo de texto não criptografado de uma mensagem envelopada usando objetos CAPICOM são operações baseadas em certificado.</span><span class="sxs-lookup"><span data-stu-id="08dc6-121">While some operations with CAPICOM objects can be done on any computer by any user, creating [*digital signatures*](../secgloss/d-gly.md) and retrieving the plaintext content of an enveloped message using CAPICOM objects are certificate-based operations.</span></span> <span data-ttu-id="08dc6-122">O usuário que cria uma assinatura digital e o usuário que recupera o conteúdo criptografado de uma mensagem envelopada deve ter um certificado digital com uma chave privada associada disponível.</span><span class="sxs-lookup"><span data-stu-id="08dc6-122">The user who creates a digital signature and the user who retrieves the encrypted contents of an enveloped message must have a digital certificate with an available associated private key.</span></span> <span data-ttu-id="08dc6-123">Se um certificado com uma chave privada associada não estiver presente, a operação de criptografia falhará.</span><span class="sxs-lookup"><span data-stu-id="08dc6-123">If a certificate with an associated private key is not present, the cryptographic operation will fail.</span></span> <span data-ttu-id="08dc6-124">Os usuários de aplicativos CAPICOM devem garantir que eles tenham o certificado apropriado e a chave privada disponível quando os aplicativos estiverem em execução.</span><span class="sxs-lookup"><span data-stu-id="08dc6-124">Users of CAPICOM applications must ensure that they have the appropriate certificate and available private key when the applications are running.</span></span>

<span data-ttu-id="08dc6-125">Alguns exemplos nas seções a seguir executam operações que exigem um [*par de chaves pública/privada*](../secgloss/p-gly.md) disponível para criptografar e descriptografar arquivos, mensagens e assinaturas.</span><span class="sxs-lookup"><span data-stu-id="08dc6-125">Some examples in the following sections perform operations that require an available [*public/private key pair*](../secgloss/p-gly.md) for encrypting and decrypting files, messages, and signatures.</span></span> <span data-ttu-id="08dc6-126">Muitos desses programas serão compilados e executados, mas falharão em tempo de execução sem a existência de [*contêineres de chave*](../secgloss/k-gly.md), chaves, repositórios de certificados e [*certificados*](../secgloss/c-gly.md) apropriados nessas lojas.</span><span class="sxs-lookup"><span data-stu-id="08dc6-126">Many of these programs will compile and run but fail at run time without the existence of proper [*key containers*](../secgloss/k-gly.md), keys, certificate stores, and [*certificates*](../secgloss/c-gly.md) in those stores.</span></span>

<span data-ttu-id="08dc6-127">**Para criar um certificado autoassinado**</span><span class="sxs-lookup"><span data-stu-id="08dc6-127">**To create a self-signed certificate**</span></span>

1.  <span data-ttu-id="08dc6-128">Instale as ferramentas de assinatura.</span><span class="sxs-lookup"><span data-stu-id="08dc6-128">Install the signing tools.</span></span> <span data-ttu-id="08dc6-129">Elas são instaladas como parte do SDK (Software Development Kit) do Microsoft Windows, do SDK (Kit de desenvolvimento de software) da plataforma ou do SDK do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="08dc6-129">These are installed as part of the Microsoft Windows Software Development Kit (SDK), the Platform Software Development Kit (SDK), or the .NET Framework SDK.</span></span>
2.  <span data-ttu-id="08dc6-130">Depois que Makecert.exe for baixado, execute o seguinte comando em um prompt de comando, substituindo um nome de usuário para *username*, um nome de organização para *OrganizationName* e um nome de empresa para *CompanyName*:</span><span class="sxs-lookup"><span data-stu-id="08dc6-130">After Makecert.exe is downloaded, run the following command at a command prompt, substituting a user name for *UserName*, an organization name for *OrganizationName*, and a company name for *CompanyName*:</span></span>

    <span data-ttu-id="08dc6-131">**MakeCert-r-n "CN =**_username_*_, ou =_*_OrganizationName_*_, o =_*_CompanyName_*_" – SS My_*</span><span class="sxs-lookup"><span data-stu-id="08dc6-131">**makecert -r -n "cn=**_UserName_*_, ou=_*_OrganizationName_*_, o=_*_CompanyName_*_" -ss my_*</span></span>

3.  <span data-ttu-id="08dc6-132">O certificado pode ser colocado no meu repositório do usuário atual.</span><span class="sxs-lookup"><span data-stu-id="08dc6-132">The certificate can be placed in the My store of the current user.</span></span> <span data-ttu-id="08dc6-133">Importe o certificado criado no armazenamento raiz para que ele seja confiável.</span><span class="sxs-lookup"><span data-stu-id="08dc6-133">Import the certificate created into the root store so that it is trusted.</span></span>

 

 
