---
description: Os serviços de certificados oferecem suporte à renovação de uma autoridade de certificação (CA).
ms.assetid: b6c76642-9a23-471e-af08-58e91d778f09
title: Renovação da autoridade de certificação
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: de57cd16ae6fc4c90bfeea411a06efcb14d028b7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103921191"
---
# <a name="certification-authority-renewal"></a><span data-ttu-id="083ab-103">Renovação da autoridade de certificação</span><span class="sxs-lookup"><span data-stu-id="083ab-103">Certification Authority Renewal</span></span>

<span data-ttu-id="083ab-104">Os [*serviços de certificados*](../secgloss/c-gly.md) oferecem suporte à renovação de uma autoridade de [*certificação*](../secgloss/c-gly.md) (CA).</span><span class="sxs-lookup"><span data-stu-id="083ab-104">[*Certificate Services*](../secgloss/c-gly.md) supports the renewal of a [*certification authority*](../secgloss/c-gly.md) (CA).</span></span> <span data-ttu-id="083ab-105">A renovação é a emissão de um novo certificado para a AC estender a vida da autoridade de certificação além da data de término de seu certificado original.</span><span class="sxs-lookup"><span data-stu-id="083ab-105">Renewal is the issuing of a new certificate for the CA to extend the CA's life beyond the end date of its original certificate.</span></span> <span data-ttu-id="083ab-106">Você pode renovar uma AC como uma tarefa dentro do snap-in do MMC da autoridade de certificação ou usando a ferramenta de Certutil.exe (com o comando **-renewCert** ).</span><span class="sxs-lookup"><span data-stu-id="083ab-106">You can renew a CA as a task within the Certificate Authority MMC snap-in or by using the Certutil.exe tool (with the **-renewCert** command).</span></span>

<span data-ttu-id="083ab-107">Cada renovação resulta em um novo certificado de autoridade de certificação; no entanto, o administrador pode gerar um novo par de chaves públicas/privadas ou reutilizar o par de chaves pública/privada existente para o certificado de autoridade de certificação.</span><span class="sxs-lookup"><span data-stu-id="083ab-107">Each renewal results in a new CA certificate; however, the administrator can either generate a new public/private key pair or reuse the existing public/private key pair for the CA certificate.</span></span> <span data-ttu-id="083ab-108">Para consistência e integridade, os certificados de CA e as listas de certificados [*revogados*](../secgloss/c-gly.md) (CRL) emitidos pela CA antes de sua renovação estarão disponíveis depois que a AC for renovada.</span><span class="sxs-lookup"><span data-stu-id="083ab-108">For consistency and integrity, CA certificates and [*certificate revocation lists*](../secgloss/c-gly.md) (CRL) issued by the CA before its renewal will be available after the CA has been renewed.</span></span> <span data-ttu-id="083ab-109">Para torná-los disponíveis, os serviços de certificados mantêm um índice de certificados de autoridade de certificação, CRLs e chaves.</span><span class="sxs-lookup"><span data-stu-id="083ab-109">To make these available, Certificate Services maintains an index of CA certificates, CRLs, and keys.</span></span>

<span data-ttu-id="083ab-110">Os índices e os nomes de sufixo de certificados de autoridade de certificação e CRLs durante várias operações de renovação de CA são os seguintes.</span><span class="sxs-lookup"><span data-stu-id="083ab-110">The indexes and suffix names of CA certificates and CRLs during various CA renewal operations are as follows.</span></span>



| <span data-ttu-id="083ab-111">Operação</span><span class="sxs-lookup"><span data-stu-id="083ab-111">Operation</span></span>                | <span data-ttu-id="083ab-112">Índice de certificado de autoridade de certificação</span><span class="sxs-lookup"><span data-stu-id="083ab-112">CA certificate index</span></span> | <span data-ttu-id="083ab-113">Sufixo de nome de arquivo do certificado de autoridade de certificação</span><span class="sxs-lookup"><span data-stu-id="083ab-113">CA certificate file name suffix</span></span> | <span data-ttu-id="083ab-114">CRL e índice de chave</span><span class="sxs-lookup"><span data-stu-id="083ab-114">CRL and key index</span></span> | <span data-ttu-id="083ab-115">Sufixo de nome de contêiner de chave e CRL</span><span class="sxs-lookup"><span data-stu-id="083ab-115">CRL and key container name suffix</span></span> |
|--------------------------|----------------------|---------------------------------|-------------------|-----------------------------------|
| <span data-ttu-id="083ab-116">Instalação original da autoridade de certificação</span><span class="sxs-lookup"><span data-stu-id="083ab-116">Original CA installation</span></span> | <span data-ttu-id="083ab-117">0</span><span class="sxs-lookup"><span data-stu-id="083ab-117">0</span></span>                    | <span data-ttu-id="083ab-118">""</span><span class="sxs-lookup"><span data-stu-id="083ab-118">""</span></span>                              | <span data-ttu-id="083ab-119">0</span><span class="sxs-lookup"><span data-stu-id="083ab-119">0</span></span>                 | <span data-ttu-id="083ab-120">""</span><span class="sxs-lookup"><span data-stu-id="083ab-120">""</span></span>                                |
| <span data-ttu-id="083ab-121">Renovação com nova chave</span><span class="sxs-lookup"><span data-stu-id="083ab-121">Renewal with new key</span></span>     | <span data-ttu-id="083ab-122">1</span><span class="sxs-lookup"><span data-stu-id="083ab-122">1</span></span>                    | <span data-ttu-id="083ab-123">"(1)"</span><span class="sxs-lookup"><span data-stu-id="083ab-123">"(1)"</span></span>                           | <span data-ttu-id="083ab-124">1</span><span class="sxs-lookup"><span data-stu-id="083ab-124">1</span></span>                 | <span data-ttu-id="083ab-125">"(1)"</span><span class="sxs-lookup"><span data-stu-id="083ab-125">"(1)"</span></span>                             |
| <span data-ttu-id="083ab-126">Renovação de reutilização de chave</span><span class="sxs-lookup"><span data-stu-id="083ab-126">Renewal reusing key</span></span>      | <span data-ttu-id="083ab-127">2</span><span class="sxs-lookup"><span data-stu-id="083ab-127">2</span></span>                    | <span data-ttu-id="083ab-128">"(2)"</span><span class="sxs-lookup"><span data-stu-id="083ab-128">"(2)"</span></span>                           | <span data-ttu-id="083ab-129">1</span><span class="sxs-lookup"><span data-stu-id="083ab-129">1</span></span>                 | <span data-ttu-id="083ab-130">"(1)"</span><span class="sxs-lookup"><span data-stu-id="083ab-130">"(1)"</span></span>                             |
| <span data-ttu-id="083ab-131">Renovação de reutilização de chave</span><span class="sxs-lookup"><span data-stu-id="083ab-131">Renewal reusing key</span></span>      | <span data-ttu-id="083ab-132">3</span><span class="sxs-lookup"><span data-stu-id="083ab-132">3</span></span>                    | <span data-ttu-id="083ab-133">"(3)"</span><span class="sxs-lookup"><span data-stu-id="083ab-133">"(3)"</span></span>                           | <span data-ttu-id="083ab-134">1</span><span class="sxs-lookup"><span data-stu-id="083ab-134">1</span></span>                 | <span data-ttu-id="083ab-135">"(1)"</span><span class="sxs-lookup"><span data-stu-id="083ab-135">"(1)"</span></span>                             |
| <span data-ttu-id="083ab-136">Renovação com nova chave</span><span class="sxs-lookup"><span data-stu-id="083ab-136">Renewal with new key</span></span>     | <span data-ttu-id="083ab-137">4</span><span class="sxs-lookup"><span data-stu-id="083ab-137">4</span></span>                    | <span data-ttu-id="083ab-138">"(4)"</span><span class="sxs-lookup"><span data-stu-id="083ab-138">"(4)"</span></span>                           | <span data-ttu-id="083ab-139">4</span><span class="sxs-lookup"><span data-stu-id="083ab-139">4</span></span>                 | <span data-ttu-id="083ab-140">"(4)"</span><span class="sxs-lookup"><span data-stu-id="083ab-140">"(4)"</span></span>                             |
| <span data-ttu-id="083ab-141">Renovação de reutilização de chave</span><span class="sxs-lookup"><span data-stu-id="083ab-141">Renewal reusing key</span></span>      | <span data-ttu-id="083ab-142">5</span><span class="sxs-lookup"><span data-stu-id="083ab-142">5</span></span>                    | <span data-ttu-id="083ab-143">"(5)"</span><span class="sxs-lookup"><span data-stu-id="083ab-143">"(5)"</span></span>                           | <span data-ttu-id="083ab-144">4</span><span class="sxs-lookup"><span data-stu-id="083ab-144">4</span></span>                 | <span data-ttu-id="083ab-145">"(4)"</span><span class="sxs-lookup"><span data-stu-id="083ab-145">"(4)"</span></span>                             |
| <span data-ttu-id="083ab-146">Renovação com nova chave</span><span class="sxs-lookup"><span data-stu-id="083ab-146">Renewal with new key</span></span>     | <span data-ttu-id="083ab-147">6</span><span class="sxs-lookup"><span data-stu-id="083ab-147">6</span></span>                    | <span data-ttu-id="083ab-148">"(6)"</span><span class="sxs-lookup"><span data-stu-id="083ab-148">"(6)"</span></span>                           | <span data-ttu-id="083ab-149">6</span><span class="sxs-lookup"><span data-stu-id="083ab-149">6</span></span>                 | <span data-ttu-id="083ab-150">"(6)"</span><span class="sxs-lookup"><span data-stu-id="083ab-150">"(6)"</span></span>                             |
| <span data-ttu-id="083ab-151">Renovação de reutilização de chave</span><span class="sxs-lookup"><span data-stu-id="083ab-151">Renewal reusing key</span></span>      | <span data-ttu-id="083ab-152">7</span><span class="sxs-lookup"><span data-stu-id="083ab-152">7</span></span>                    | <span data-ttu-id="083ab-153">"(7)"</span><span class="sxs-lookup"><span data-stu-id="083ab-153">"(7)"</span></span>                           | <span data-ttu-id="083ab-154">6</span><span class="sxs-lookup"><span data-stu-id="083ab-154">6</span></span>                 | <span data-ttu-id="083ab-155">"(6)"</span><span class="sxs-lookup"><span data-stu-id="083ab-155">"(6)"</span></span>                             |



 

<span data-ttu-id="083ab-156">Quando uma AC é instalada, o índice de certificado é zero e o sufixo do certificado é "" (uma cadeia de caracteres vazia).</span><span class="sxs-lookup"><span data-stu-id="083ab-156">When a CA is installed, the certificate index is zero and the certificate suffix is "" (an empty string).</span></span> <span data-ttu-id="083ab-157">Cada vez que o certificado é renovado (quer as chaves sejam reutilizadas ou não), o índice de certificado é incrementado em um, e o sufixo do nome de arquivo do certificado se torna uma cadeia de caracteres no formato "(*n*)", em que *n* representa o número de vezes que o certificado de autoridade de certificação foi renovado.</span><span class="sxs-lookup"><span data-stu-id="083ab-157">Each time the certificate is renewed (whether or not keys are reused), the certificate index is incremented by one, and the certificate file name suffix becomes a string of the form "(*n*)", where *n* represents the number of times the CA certificate has been renewed.</span></span> <span data-ttu-id="083ab-158">Após a primeira renovação, o índice de certificado é 1 e o sufixo de nome de arquivo de certificado é "(1)".</span><span class="sxs-lookup"><span data-stu-id="083ab-158">After the first renewal, the certificate index is 1 and the certificate file name suffix is "(1)".</span></span> <span data-ttu-id="083ab-159">Após a segunda renovação, o índice de certificado é 2 e o sufixo de nome de arquivo de certificado é "(2)" e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="083ab-159">After the second renewal, the certificate index is 2 and the certificate file name suffix is "(2)", and so on.</span></span>

<span data-ttu-id="083ab-160">Embora o índice de certificado de autoridade de certificação e o sufixo sejam incrementados por um sempre que a AC for renovada, os índices de CRL e de chave e os sufixos de nome de arquivo serão definidos para o índice de certificado de autoridade de certificação somente se o processo de renovação incluir um novo par de chaves pública/privada.</span><span class="sxs-lookup"><span data-stu-id="083ab-160">Although the CA certificate index and suffix are incremented by one each time the CA is renewed, the CRL and key indexes and the file name suffixes are set to the CA certificate index only if the renewal process includes a new public/private key pair.</span></span> <span data-ttu-id="083ab-161">Se não tiver, os valores desses índices e sufixos permanecerão iguais aos do último índice.</span><span class="sxs-lookup"><span data-stu-id="083ab-161">If it does not, the values of these indexes and suffixes remain the same as they were for the last index.</span></span> <span data-ttu-id="083ab-162">Durante a renovação, um administrador especifica se um novo par de chaves é gerado ou se o par de chaves existente é usado.</span><span class="sxs-lookup"><span data-stu-id="083ab-162">During renewal, an administrator specifies whether a new key pair is generated or the existing key pair is used.</span></span> <span data-ttu-id="083ab-163">(No snap-in do MMC da autoridade de certificação, uma opção na interface do usuário especifica um par de chaves novo ou existente; na ferramenta de Certutil.exe, o comando **certutil-renewCert** renova a AC com um novo par de chaves, enquanto o comando **certutil-renewCert REUSEKEYS** renova a AC com o par de chaves existente.)</span><span class="sxs-lookup"><span data-stu-id="083ab-163">(In the Certificate Authority MMC snap-in, an option in the user interface specifies a new or an existing key pair; in the Certutil.exe tool, the command **certutil -renewCert** renews the CA with a new key pair, while the command **certutil -renewCert ReuseKeys** renews the CA with the existing key pair.)</span></span>

<span data-ttu-id="083ab-164">O índice de CRL está diretamente vinculado ao índice de chave, que é definido para o índice de certificado de autoridade de certificação somente quando um novo par de chaves é usado para a renovação.</span><span class="sxs-lookup"><span data-stu-id="083ab-164">The CRL index is directly tied to the key index, which is set to the CA certificate index only when a new key pair is used for the renewal.</span></span> <span data-ttu-id="083ab-165">Após a primeira renovação (que usou um novo par de chaves), o índice da CRL e da chave é definido como 1, e o sufixo do nome da CRL e do contêiner de chave é "(1)".</span><span class="sxs-lookup"><span data-stu-id="083ab-165">After the first renewal (which used a new key pair), the index of the CRL and key is set to 1, and the CRL and key container name suffix is "(1)".</span></span> <span data-ttu-id="083ab-166">No entanto, após a segunda renovação, o índice da CRL e da chave permanece 1, e o sufixo de nome de contêiner de chave e CRL também permanece "(1)"; Isso ocorre porque a segunda renovação usou o par de chaves existente e apenas uma CRL é emitida para cada par de chaves da autoridade de certificação.</span><span class="sxs-lookup"><span data-stu-id="083ab-166">After the second renewal, however, the index of the CRL and key remains 1, and the CRL and key container name suffix also remains "(1)"; this is because the second renewal used the existing key pair and only one CRL is issued for each CA key pair.</span></span>

<span data-ttu-id="083ab-167">Você pode recuperar os certificados de AC indexados e as CRLs chamando o método **Getcertificaproperty** (nas interfaces [**ICertServerExit**](/windows/desktop/api/Certif/nn-certif-icertserverexit) e [**ICertServerPolicy**](/windows/desktop/api/Certif/nn-certif-icertserverpolicy) ).</span><span class="sxs-lookup"><span data-stu-id="083ab-167">You can retrieve the indexed CA certificates and CRLs by calling the **GetCertificateProperty** method (in both the [**ICertServerExit**](/windows/desktop/api/Certif/nn-certif-icertserverexit) and [**ICertServerPolicy**](/windows/desktop/api/Certif/nn-certif-icertserverpolicy) interfaces).</span></span> <span data-ttu-id="083ab-168">Ao recuperar determinadas propriedades relacionadas ao certificado de autoridade de certificação ou CRL, você pode acrescentar o índice de base zero do certificado de autoridade de certificação aos nomes de propriedade.</span><span class="sxs-lookup"><span data-stu-id="083ab-168">When you retrieve certain properties related to the CA certificate or CRL, you can append the CA certificate's zero-based index to the property names.</span></span> <span data-ttu-id="083ab-169">Por exemplo, para recuperar o índice de CRL que corresponde ao terceiro certificado da autoridade de certificação, passe a propriedade "CRLIndex. 2" para [**ICertServerPolicy:: Getcertificaproperty**](/windows/desktop/api/Certif/nf-certif-icertserverpolicy-getcertificateproperty); para a tabela, o valor da propriedade "CRLIndex. 2" recuperado seria 1.</span><span class="sxs-lookup"><span data-stu-id="083ab-169">For example, to retrieve the CRL index that corresponds to the CA's third certificate, pass the property "CRLIndex.2" to [**ICertServerPolicy::GetCertificateProperty**](/windows/desktop/api/Certif/nf-certif-icertserverpolicy-getcertificateproperty); for the table, the retrieved "CRLIndex.2" property value would be 1.</span></span> <span data-ttu-id="083ab-170">Uma propriedade chamada "CertCount" pode ser usada para determinar o número de vezes que a autoridade de certificação emitiu um certificado de autoridade de certificação.</span><span class="sxs-lookup"><span data-stu-id="083ab-170">A property called "CertCount" can be used to determine the number of times the CA has been issued a CA certificate.</span></span>

<span data-ttu-id="083ab-171">Os certificados de CA e as CRLs contêm uma extensão que fornece informações sobre o certificado e o índice de chave.</span><span class="sxs-lookup"><span data-stu-id="083ab-171">CA certificates and CRLs contain an extension that provides information about the certificate and key index.</span></span> <span data-ttu-id="083ab-172">A extensão é definida em Wincrypt. h como \_ \_ a versão da AC do szOID CERTSRV \_ com um valor de "1.3.6.1.4.1.311.21.1".</span><span class="sxs-lookup"><span data-stu-id="083ab-172">The extension is defined in Wincrypt.h as szOID\_CERTSRV\_CA\_VERSION with a value of "1.3.6.1.4.1.311.21.1".</span></span> <span data-ttu-id="083ab-173">Os dados de extensão são um valor **DWORD** (codificado como um \_ inteiro X509 na extensão); os 16 bits baixos são o índice de certificado e os 16 bits altos são o índice de chave.</span><span class="sxs-lookup"><span data-stu-id="083ab-173">The extension data is a **DWORD** value (encoded as X509\_INTEGER in the extension); the low 16 bits are the certificate index, and the high 16 bits are the key index.</span></span>

<span data-ttu-id="083ab-174">A instalação inicial de uma autoridade de certificação produz um índice de certificado zero e um índice de chave igual a zero.</span><span class="sxs-lookup"><span data-stu-id="083ab-174">The initial installation of a CA produces a certificate index of zero and a key index of zero.</span></span> <span data-ttu-id="083ab-175">A renovação de um certificado de autoridade de certificação fará com que o índice de certificado seja incrementado.</span><span class="sxs-lookup"><span data-stu-id="083ab-175">Renewal of a CA certificate will cause the certificate index to be incremented.</span></span> <span data-ttu-id="083ab-176">Se a chave for reutilizada na renovação, o índice de chave será o mesmo que o índice de chave anterior.</span><span class="sxs-lookup"><span data-stu-id="083ab-176">If the key is reused in the renewal, the key index will be the same as the previous key index.</span></span> <span data-ttu-id="083ab-177">Se a chave não for reutilizada, o índice de chave corresponderá ao novo índice de certificado.</span><span class="sxs-lookup"><span data-stu-id="083ab-177">If the key is not reused, the key index will match the new certificate index.</span></span>

## <a name="related-topics"></a><span data-ttu-id="083ab-178">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="083ab-178">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="083ab-179">**ICertServerPolicy:: getcertificaproperty**</span><span class="sxs-lookup"><span data-stu-id="083ab-179">**ICertServerPolicy::GetCertificateProperty**</span></span>](/windows/desktop/api/Certif/nf-certif-icertserverpolicy-getcertificateproperty)
</dt> <dt>

[<span data-ttu-id="083ab-180">**ICertServerExit:: getcertificaproperty**</span><span class="sxs-lookup"><span data-stu-id="083ab-180">**ICertServerExit::GetCertificateProperty**</span></span>](/windows/desktop/api/Certif/nf-certif-icertserverexit-getcertificateproperty)
</dt> </dl>

 

 
