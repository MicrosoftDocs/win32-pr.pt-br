---
description: A partir do formato de certificado X. 509 versão 3, um certificado pode conter extensões de certificado.
ms.assetid: fb106cab-8a61-4a83-8fb4-7c045d905575
title: Manipuladores de extensão
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cfcf1b47fcc97b87f5956f4584aee07acce04222
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105770453"
---
# <a name="extension-handlers"></a><span data-ttu-id="bacf9-103">Manipuladores de extensão</span><span class="sxs-lookup"><span data-stu-id="bacf9-103">Extension Handlers</span></span>

<span data-ttu-id="bacf9-104">A partir do formato de certificado [*X. 509*](../secgloss/x-gly.md) versão 3, um certificado pode conter extensões de certificado.</span><span class="sxs-lookup"><span data-stu-id="bacf9-104">Beginning with [*X.509*](../secgloss/x-gly.md) Certificate format Version 3, a certificate may contain certificate extensions.</span></span> <span data-ttu-id="bacf9-105">(Para o conteúdo de um certificado X. 509, consulte [Propriedades do certificado](certificate-properties.md).) Essas extensões indicam informações adicionais.</span><span class="sxs-lookup"><span data-stu-id="bacf9-105">(For the contents of an X.509 Certificate, see [Certificate Properties](certificate-properties.md).) These extensions indicate additional information.</span></span> <span data-ttu-id="bacf9-106">Por exemplo, uma extensão pode indicar informações adicionais de identificação da entidade ou pode indicar informações de uso da chave, que especificam as tarefas (como assinatura ou criptografia) para as quais uma chave pode ser usada.</span><span class="sxs-lookup"><span data-stu-id="bacf9-106">For example, an extension can indicate additional subject identification information, or it can indicate key usage information, which specifies the tasks (such as signature or encryption) for which a key can be used.</span></span> <span data-ttu-id="bacf9-107">Um conjunto de extensões padrão é definido para uso do aplicativo, e as extensões também podem ser personalizadas.</span><span class="sxs-lookup"><span data-stu-id="bacf9-107">A set of standard extensions is defined for application use, and extensions may also be customized.</span></span>

<span data-ttu-id="bacf9-108">Cada extensão tem uma cadeia de caracteres de identificador de objeto associada que identifica o tipo de informações adicionais e uma estrutura de dados que contém essas informações.</span><span class="sxs-lookup"><span data-stu-id="bacf9-108">Each extension has an associated object identifier string that identifies the type of additional information and a data structure that contains this information.</span></span> <span data-ttu-id="bacf9-109">Por exemplo, o identificador de objeto de uso de chave é "2.5.29.15", que indica informações de uso de chave.</span><span class="sxs-lookup"><span data-stu-id="bacf9-109">For example, the key usage object identifier is "2.5.29.15", which indicates key usage information.</span></span> <span data-ttu-id="bacf9-110">Sua estrutura de dados associada é um campo de [**\_ \_ blob de bit cript (bits**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_bit_blob) ) que especifica como a chave pode ser usada.</span><span class="sxs-lookup"><span data-stu-id="bacf9-110">Its associated data structure is a [**CRYPT\_BIT\_BLOB**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_bit_blob) (bitfield) specifying how the key can be used.</span></span>

<span data-ttu-id="bacf9-111">Uma extensão pode ser adicionada a um certificado antes de ser emitida.</span><span class="sxs-lookup"><span data-stu-id="bacf9-111">An extension can be added to a certificate before it is issued.</span></span> <span data-ttu-id="bacf9-112">Quando o certificado é emitido, todas as extensões habilitadas fazem parte do certificado.</span><span class="sxs-lookup"><span data-stu-id="bacf9-112">When the certificate is issued, any enabled extensions are part of the certificate.</span></span> <span data-ttu-id="bacf9-113">Se uma extensão estiver marcada como crítica, seu uso deverá ser conhecido pelo aplicativo usando, e o aplicativo deverá aderir à intenção ou ao valor da extensão.</span><span class="sxs-lookup"><span data-stu-id="bacf9-113">If an extension is marked critical, its use must be known by the using application, and the application must adhere to the intent or value of the extension.</span></span> <span data-ttu-id="bacf9-114">Os serviços de certificados permitem que as extensões sejam definidas em um certificado não emitido por meio de métodos fornecidos por [**ICertAdmin**](/windows/desktop/api/Certadm/nn-certadm-icertadmin) e [**ICertServerPolicy**](/windows/desktop/api/Certif/nn-certif-icertserverpolicy).</span><span class="sxs-lookup"><span data-stu-id="bacf9-114">Certificate Services allows extensions to be set on a non-issued certificate through methods provided by [**ICertAdmin**](/windows/desktop/api/Certadm/nn-certadm-icertadmin) and [**ICertServerPolicy**](/windows/desktop/api/Certif/nn-certif-icertserverpolicy).</span></span> <span data-ttu-id="bacf9-115">Para obter detalhes sobre as extensões de certificado, consulte [**\_ extensão CERT**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_extension) na documentação do CryptoAPI.</span><span class="sxs-lookup"><span data-stu-id="bacf9-115">For details about certificate extensions, see [**CERT\_EXTENSION**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_extension) in the CryptoAPI documentation.</span></span> <span data-ttu-id="bacf9-116">Para obter informações sobre estruturas de dados de extensão de certificado comuns, consulte [estruturas de extensão de certificado X. 509](cryptography-structures.md).</span><span class="sxs-lookup"><span data-stu-id="bacf9-116">For information about common certificate extension data structures, see [X.509 Certificate Extension Structures](cryptography-structures.md).</span></span>

<span data-ttu-id="bacf9-117">O manipulador de extensão é um objeto COM que fornece rotinas para codificar as extensões mais complexas, mas geralmente usadas e os tipos de dados, como IA5String ou imenablestring.</span><span class="sxs-lookup"><span data-stu-id="bacf9-117">The extension handler is a COM object that provides routines for encoding the more complex, but commonly used extensions and data types, such as IA5String or PrintableString.</span></span>

<span data-ttu-id="bacf9-118">As extensões que têm os tipos de dados **Date**, **Long** e **BSTR** não exigem um manipulador de extensão.</span><span class="sxs-lookup"><span data-stu-id="bacf9-118">Extensions that have the data types **DATE**, **LONG**, and **BSTR** do not require an extension handler.</span></span> <span data-ttu-id="bacf9-119">O módulo de política simplesmente chama [**ICertServerPolicy:: SetCertificateExtension**](/windows/desktop/api/Certif/nf-certif-icertserverpolicy-setcertificateextension) com o parâmetro de *tipo* definido como um valor que representa o tipo de dados de extensão: PROPtype \_ Date, propproperty \_ Long ou a cadeia de proptype \_ .</span><span class="sxs-lookup"><span data-stu-id="bacf9-119">The policy module simply calls [**ICertServerPolicy::SetCertificateExtension**](/windows/desktop/api/Certif/nf-certif-icertserverpolicy-setcertificateextension) with the *Type* parameter set to a value representing the extension data type: PROPTYPE\_DATE, PROPTYPE\_LONG, or PROPTYPE\_STRING.</span></span> <span data-ttu-id="bacf9-120">Em seguida, ele passa a extensão para o mecanismo do servidor.</span><span class="sxs-lookup"><span data-stu-id="bacf9-120">It then passes the extension to the server engine.</span></span> <span data-ttu-id="bacf9-121">O mecanismo de servidor, por sua vez, executa a codificação de uma (ASN. 1) de [*sintaxe abstrata*](../secgloss/a-gly.md) antes de armazenar a extensão no certificado.</span><span class="sxs-lookup"><span data-stu-id="bacf9-121">The server engine, in turn, performs the [*Abstract Syntax Notation One*](../secgloss/a-gly.md) (ASN.1) encoding before storing the extension in the certificate.</span></span>

<span data-ttu-id="bacf9-122">No entanto, as extensões que têm tipos de dados diferentes desses tipos padrão devem ser ASN. 1 codificada por um manipulador de extensão antes que o módulo de política as passe para o mecanismo do servidor.</span><span class="sxs-lookup"><span data-stu-id="bacf9-122">However, extensions that have data types other than these default types must be ASN.1 encoded by an extension handler before the policy module passes them to the server engine.</span></span> <span data-ttu-id="bacf9-123">Quando o módulo de política chama [**ICertServerPolicy:: SetCertificateExtension**](/windows/desktop/api/Certif/nf-certif-icertserverpolicy-setcertificateextension) para passar uma extensão ASN. 1 codificada para o mecanismo do servidor, ele deve definir o parâmetro de *tipo* como proptype \_ binário.</span><span class="sxs-lookup"><span data-stu-id="bacf9-123">When the policy module calls [**ICertServerPolicy::SetCertificateExtension**](/windows/desktop/api/Certif/nf-certif-icertserverpolicy-setcertificateextension) to pass an ASN.1-encoded extension to the server engine, it must set the *Type* parameter to PROPTYPE\_BINARY.</span></span> <span data-ttu-id="bacf9-124">O mecanismo de servidor simplesmente armazena essa extensão codificada no certificado.</span><span class="sxs-lookup"><span data-stu-id="bacf9-124">The server engine then simply stores this encoded extension in the certificate.</span></span>

<span data-ttu-id="bacf9-125">O manipulador de extensão padrão, Certenc.dll, exporta várias interfaces **ICertEncodeXXX** e pode ser chamado pelo módulo de política.</span><span class="sxs-lookup"><span data-stu-id="bacf9-125">The default extension handler, Certenc.dll, exports a number of **ICertEncodeXXX** interfaces and can be called by the policy module.</span></span> <span data-ttu-id="bacf9-126">As informações de tipo necessárias também estão contidas no Certencl.dll que é fornecido no SDK (Software Development Kit) da plataforma.</span><span class="sxs-lookup"><span data-stu-id="bacf9-126">The necessary type information is also contained in Certencl.dll which is supplied in the Platform Software Development Kit (SDK).</span></span> <span data-ttu-id="bacf9-127">Cada interface fornece um método de **codificação** que retorna uma extensão de certificado com codificação ASN. 1 para o módulo de política em um formato binário.</span><span class="sxs-lookup"><span data-stu-id="bacf9-127">Each interface provides an **Encode** method that returns an ASN.1-encoded certificate extension to the policy module in a binary format.</span></span> <span data-ttu-id="bacf9-128">O módulo de política pode então definir a extensão em um certificado chamando o método [**ICertServerPolicy:: SetCertificateExtension**](/windows/desktop/api/Certif/nf-certif-icertserverpolicy-setcertificateextension) .</span><span class="sxs-lookup"><span data-stu-id="bacf9-128">The policy module can then set the extension in a certificate by calling the [**ICertServerPolicy::SetCertificateExtension**](/windows/desktop/api/Certif/nf-certif-icertserverpolicy-setcertificateextension) method.</span></span>

<span data-ttu-id="bacf9-129">Para obter mais informações, consulte [escrevendo manipuladores de extensão personalizados](writing-custom-extension-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="bacf9-129">For more information, see [Writing Custom Extension Handlers](writing-custom-extension-handlers.md).</span></span>

 

 
