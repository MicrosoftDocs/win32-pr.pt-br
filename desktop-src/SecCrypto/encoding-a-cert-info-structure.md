---
description: O processo de codificação é o inverso do processo de decodificação descrito na decodificação de uma estrutura de informações de certificado \_ .
ms.assetid: 5d3311e5-a2fb-46f7-aa76-f232b39b34fd
title: Codificando uma estrutura de CERT_INFO
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 645a1d3054546a7b11c57d4f515dc7d3e26b5fe0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105753406"
---
# <a name="encoding-a-cert_info-structure"></a><span data-ttu-id="4afb1-103">Codificando uma \_ estrutura de informações de certificado</span><span class="sxs-lookup"><span data-stu-id="4afb1-103">Encoding a CERT\_INFO Structure</span></span>

<span data-ttu-id="4afb1-104">O processo de codificação é o inverso do processo de decodificação descrito na [decodificação de uma \_ estrutura de informações de certificado](decoding-a-cert-info-structure.md).</span><span class="sxs-lookup"><span data-stu-id="4afb1-104">The encoding process is the reverse of the decoding process described in [Decoding a CERT\_INFO Structure](decoding-a-cert-info-structure.md).</span></span> <span data-ttu-id="4afb1-105">Por exemplo, o procedimento a seguir adicionaria um **emissor** codificado a uma estrutura de [**\_ informações de certificado**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) .</span><span class="sxs-lookup"><span data-stu-id="4afb1-105">For example, the following procedure would add an encoded **Issuer** to a [**CERT\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) structure.</span></span> <span data-ttu-id="4afb1-106">Consulte também a ilustração que segue o procedimento.</span><span class="sxs-lookup"><span data-stu-id="4afb1-106">Also see the illustration that follows the procedure.</span></span>

<span data-ttu-id="4afb1-107">**Para adicionar um emissor codificado a uma estrutura de \_ informações de certificado**</span><span class="sxs-lookup"><span data-stu-id="4afb1-107">**To add an encoded Issuer to a CERT\_INFO structure**</span></span>

1.  <span data-ttu-id="4afb1-108">Crie uma cadeia de caracteres contendo o nome do emissor a ser usado.</span><span class="sxs-lookup"><span data-stu-id="4afb1-108">Create a string containing the issuer name to be used.</span></span>
2.  <span data-ttu-id="4afb1-109">Crie uma matriz de [**estruturas \_ \_ attr de certificado**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn_attr) , que será inicializada para conter as informações apropriadas sobre a cadeia de caracteres de nome do emissor recém-criada.</span><span class="sxs-lookup"><span data-stu-id="4afb1-109">Create an array of [**CERT\_RDN\_ATTR**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn_attr) structures, which will be initialized to contain the proper information about the issuer name string just created.</span></span>
3.  <span data-ttu-id="4afb1-110">Crie uma matriz de [**estruturas \_ RDN de certificado**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn) , uma das quais tem as informações sobre a matriz de estruturas [**\_ \_ attr de certificado**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn_attr) que acabou de ser inicializada.</span><span class="sxs-lookup"><span data-stu-id="4afb1-110">Create an array of [**CERT\_RDN**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn) structures, one of which has the information about the array of [**CERT\_RDN\_ATTR**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn_attr) structures just initialized.</span></span>
4.  <span data-ttu-id="4afb1-111">Crie uma estrutura de [**\_ \_ informações de nome de certificado**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_name_info) que tenha um ponteiro para a matriz de estruturas [**\_ RDN de certificado**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn) que acabou de criar.</span><span class="sxs-lookup"><span data-stu-id="4afb1-111">Create a [**CERT\_NAME\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_name_info) structure that has a pointer to the array of [**CERT\_RDN**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_rdn) structures that just created.</span></span>
5.  <span data-ttu-id="4afb1-112">Chame [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject) para obter o tamanho do blob codificado de saída, passando-o para o endereço da estrutura de [**\_ \_ informações do nome de certificado**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_name_info) que você acabou de criar.</span><span class="sxs-lookup"><span data-stu-id="4afb1-112">Call [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject) to get the size of the output encoded BLOB, passing it the address of the [**CERT\_NAME\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_name_info) structure that you just created.</span></span>
6.  <span data-ttu-id="4afb1-113">Aloque memória para o BLOB codificado de saída.</span><span class="sxs-lookup"><span data-stu-id="4afb1-113">Allocate memory for the output encoded BLOB.</span></span>
7.  <span data-ttu-id="4afb1-114">Chame [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject) novamente, passando as mesmas informações, mas agora passando o endereço da memória que acabou de ser alocada.</span><span class="sxs-lookup"><span data-stu-id="4afb1-114">Call [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject) again, passing it the same information, but now passing it the address of the memory just allocated.</span></span>
8.  <span data-ttu-id="4afb1-115">Defina o membro **emissor. cbData** da estrutura [**\_ informações de certificado**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) para o tamanho retornado na etapa 5 e o membro **emissor. pbData** para o endereço obtido na etapa 6.</span><span class="sxs-lookup"><span data-stu-id="4afb1-115">Set the **Issuer.cbData** member of the [**CERT\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) structure to the size returned in step 5, and the **Issuer.pbData** member to the address obtained in step 6.</span></span> <span data-ttu-id="4afb1-116">O blob do **emissor** codificado agora reside lá.</span><span class="sxs-lookup"><span data-stu-id="4afb1-116">The encoded **Issuer** BLOB now resides there.</span></span>

![adicionando um emissor codificado a uma estrutura de \- informações de certificado](images/encflow.png)

<span data-ttu-id="4afb1-118">Para inicializar e codificar algumas informações de extensão de certificado, use o procedimento a seguir.</span><span class="sxs-lookup"><span data-stu-id="4afb1-118">To initialize and encode some certificate extension information, use the following procedure.</span></span> <span data-ttu-id="4afb1-119">Consulte também a ilustração que segue o procedimento.</span><span class="sxs-lookup"><span data-stu-id="4afb1-119">Also see the illustration that follows the procedure.</span></span>

<span data-ttu-id="4afb1-120">**Para adicionar informações de extensão codificadas a uma estrutura de informações de certificado \_**</span><span class="sxs-lookup"><span data-stu-id="4afb1-120">**To add encoded extension information to a CERT\_INFO structure**</span></span>

1.  <span data-ttu-id="4afb1-121">Criar e inicializar uma estrutura de informações de extensão — neste exemplo, é uma estrutura de informações de [**\_ \_ restrições \_ básicas de certificado**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_basic_constraints_info) .</span><span class="sxs-lookup"><span data-stu-id="4afb1-121">Create and initialize an extension information structure—for this example, it is a [**CERT\_BASIC\_CONSTRAINTS\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_basic_constraints_info) structure.</span></span>
2.  <span data-ttu-id="4afb1-122">Chame [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject), passando o endereço da estrutura que acabou de criar para obter o tamanho do blob codificado de saída.</span><span class="sxs-lookup"><span data-stu-id="4afb1-122">Call [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject), passing it the address of the structure just created, to get the size of the output encoded BLOB.</span></span>
3.  <span data-ttu-id="4afb1-123">Aloque memória para o BLOB codificado de saída.</span><span class="sxs-lookup"><span data-stu-id="4afb1-123">Allocate memory for the output encoded BLOB.</span></span>
4.  <span data-ttu-id="4afb1-124">Chame [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject) novamente, passando as mesmas informações, exceto que agora passe o endereço da memória alocada.</span><span class="sxs-lookup"><span data-stu-id="4afb1-124">Call [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject) again, passing the same information, except now pass in the address of the allocated memory.</span></span>
5.  <span data-ttu-id="4afb1-125">Crie uma matriz de estruturas de [**\_ extensão de certificado**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_extension) .</span><span class="sxs-lookup"><span data-stu-id="4afb1-125">Create an array of [**CERT\_EXTENSION**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_extension) structures.</span></span>
6.  <span data-ttu-id="4afb1-126">Inicialize uma das estruturas [**de \_ extensão de certificado**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_extension) para que **pszObjId** seja a cadeia de caracteres apropriada para os dados contidos em **valor** e esse **valor** contenha o blob de dados criptografados que foi impresso da chamada para [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject).</span><span class="sxs-lookup"><span data-stu-id="4afb1-126">Initialize one of the [**CERT\_EXTENSION**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_extension) structures so that the **pszObjId** is the proper string for the data contained in **Value**, and that **Value** contains the encrypted data BLOB that was output from the call to [**CryptEncodeObject**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptencodeobject).</span></span>
7.  <span data-ttu-id="4afb1-127">Inicialize o membro **rgExtension** da estrutura [**de \_ informações de certificado**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) para apontar para a matriz de estruturas de [**\_ extensão de certificado**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_extension) .</span><span class="sxs-lookup"><span data-stu-id="4afb1-127">Initialize the **rgExtension** member of the [**CERT\_INFO**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_info) structure to point to the array of [**CERT\_EXTENSION**](/windows/desktop/api/Wincrypt/ns-wincrypt-cert_extension) structures.</span></span>

![adicionando informações de extensão codificadas a uma estrutura de informações de certificado \-](images/xtenflow.png)

 

 



