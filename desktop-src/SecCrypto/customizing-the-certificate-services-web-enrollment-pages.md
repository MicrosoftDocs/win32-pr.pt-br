---
description: Os serviços de certificados fornecem páginas de registro da Web que podem ser usadas para solicitar certificados.
ms.assetid: 1e198bc8-c712-4d0f-9e3a-35a295445acf
title: Personalizando páginas de registro na Web de serviços de certificados
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4eb2fbf421eceb1ebf0b15379aca5d0788a992ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103837094"
---
# <a name="customizing-certificate-services-web-enrollment-pages"></a><span data-ttu-id="649b2-103">Personalizando páginas de registro na Web de serviços de certificados</span><span class="sxs-lookup"><span data-stu-id="649b2-103">Customizing Certificate Services Web Enrollment Pages</span></span>

<span data-ttu-id="649b2-104">Os [*serviços de certificados*](../secgloss/c-gly.md) fornecem páginas de registro da Web que podem ser usadas para solicitar certificados.</span><span class="sxs-lookup"><span data-stu-id="649b2-104">[*Certificate Services*](../secgloss/c-gly.md) provides web enrollment pages that can be used to request certificates.</span></span> <span data-ttu-id="649b2-105">Um administrador pode personalizar alguns dos itens que podem ser exibidos nas páginas de registro da Web; no entanto, você deve estar familiarizado com as páginas de registro da Web e o script da Web antes de fazer qualquer alteração.</span><span class="sxs-lookup"><span data-stu-id="649b2-105">An administrator can customize some of the items that can be viewed in the web enrollment pages; however, you should be familiar with the web enrollment pages and web scripting before making any changes.</span></span> <span data-ttu-id="649b2-106">Para obter mais informações sobre scripts da Web, consulte [scripts](/previous-versions/ms950396(v=msdn.10)).</span><span class="sxs-lookup"><span data-stu-id="649b2-106">For more information about web scripting, see [Scripting](/previous-versions/ms950396(v=msdn.10)).</span></span>

<span data-ttu-id="649b2-107">Os valores padrão para os campos de nome distinto para organização, unidade organizacional, localidade, estado e país/região são os valores especificados para a [*autoridade de certificação*](../secgloss/c-gly.md) (CA) quando os serviços de certificados são instalados.</span><span class="sxs-lookup"><span data-stu-id="649b2-107">The default values for the Distinguished Name fields for Organization, Organizational Unit, Locality, State, and Country/Region are the values specified for the [*certification authority*](../secgloss/c-gly.md) (CA) when Certificate Services is installed.</span></span> <span data-ttu-id="649b2-108">Esses valores padrão aparecem nas páginas da Web e podem ser alterados pelo usuário durante o processo de registro de certificado.</span><span class="sxs-lookup"><span data-stu-id="649b2-108">These default values appear in the webpages and can be changed by the user during the certificate enrollment process.</span></span> <span data-ttu-id="649b2-109">No entanto, se você quiser que outros valores padrão apareçam nas páginas da Web, poderá editar o arquivo Certdat. Inc (no caminho \\ *WindowsDirectory* \\ System32 \\ certsrv \\ ); especificamente, você pode atribuir valores personalizados às seguintes variáveis fornecidas para personalização.</span><span class="sxs-lookup"><span data-stu-id="649b2-109">However, if you want other default values to appear in the webpages, you can edit the Certdat.inc file (in the path \\*WindowsDirectory*\\System32\\Certsrv\\); specifically, you can assign custom values to the following variables provided for customization.</span></span>



| <span data-ttu-id="649b2-110">Variável</span><span class="sxs-lookup"><span data-stu-id="649b2-110">Variable</span></span>            | <span data-ttu-id="649b2-111">Descrição</span><span class="sxs-lookup"><span data-stu-id="649b2-111">Description</span></span>                                                                                                                                                                                                                               |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="649b2-112">sDefaultCompany</span><span class="sxs-lookup"><span data-stu-id="649b2-112">sDefaultCompany</span></span>     | <span data-ttu-id="649b2-113">Empresa padrão (aparece na [*solicitação de certificado*](../secgloss/c-gly.md) como o campo de organização [*X. 509*](../secgloss/x-gly.md) ).</span><span class="sxs-lookup"><span data-stu-id="649b2-113">Default company (appears in the [*certificate request*](../secgloss/c-gly.md) as the [*X.509*](../secgloss/x-gly.md) Organization field).</span></span> |
| <span data-ttu-id="649b2-114">sDefaultOrgUnit</span><span class="sxs-lookup"><span data-stu-id="649b2-114">sDefaultOrgUnit</span></span>     | <span data-ttu-id="649b2-115">Departamento padrão (aparece na solicitação de certificado como o campo de unidade organizacional X. 509).</span><span class="sxs-lookup"><span data-stu-id="649b2-115">Default department (appears in the certificate request as the X.509 Organizational Unit field).</span></span>                                                                                                                                           |
| <span data-ttu-id="649b2-116">sDefaultLocality</span><span class="sxs-lookup"><span data-stu-id="649b2-116">sDefaultLocality</span></span>    | <span data-ttu-id="649b2-117">Cidade padrão (aparece na solicitação de certificado como o campo de local X. 509).</span><span class="sxs-lookup"><span data-stu-id="649b2-117">Default city (appears in the certificate request as the X.509 Location field).</span></span>                                                                                                                                                            |
| <span data-ttu-id="649b2-118">sDefaultState</span><span class="sxs-lookup"><span data-stu-id="649b2-118">sDefaultState</span></span>       | <span data-ttu-id="649b2-119">Estado/província padrão (aparece na solicitação de certificado como o campo de estado X. 509).</span><span class="sxs-lookup"><span data-stu-id="649b2-119">Default state/province (appears in the certificate request as the X.509 State field).</span></span>                                                                                                                                                     |
| <span data-ttu-id="649b2-120">sDefaultCountry</span><span class="sxs-lookup"><span data-stu-id="649b2-120">sDefaultCountry</span></span>     | <span data-ttu-id="649b2-121">País/região padrão (aparece na solicitação de certificado como o campo país/região X. 509).</span><span class="sxs-lookup"><span data-stu-id="649b2-121">Default country/region (appears in the certificate request as the X.509 Country/Region field).</span></span>                                                                                                                                            |
| <span data-ttu-id="649b2-122">nPendingTimeoutDays</span><span class="sxs-lookup"><span data-stu-id="649b2-122">nPendingTimeoutDays</span></span> | <span data-ttu-id="649b2-123">Número de dias em que o usuário pode recuperar um certificado pendente depois que ele é solicitado.</span><span class="sxs-lookup"><span data-stu-id="649b2-123">Number of days in which the user can retrieve a pending certificate after it has been requested.</span></span>                                                                                                                                          |



 

<span data-ttu-id="649b2-124">Nenhuma outra variável deve ser alterada no arquivo Certdat. Inc.</span><span class="sxs-lookup"><span data-stu-id="649b2-124">No other variables should be changed in the Certdat.inc file.</span></span>

<span data-ttu-id="649b2-125">O exemplo a seguir define a unidade organizacional padrão como "marketing".</span><span class="sxs-lookup"><span data-stu-id="649b2-125">The following example sets the default Organizational Unit to "Marketing".</span></span>


```VB
sDefaultOrgUnit="Marketing"
```



<span data-ttu-id="649b2-126">Além disso, você pode editar o arquivo Certrqtp. Inc para adicionar, alterar ou remover [*modelos de certificado*](../secgloss/c-gly.md) ou tipos disponíveis para o usuário.</span><span class="sxs-lookup"><span data-stu-id="649b2-126">Additionally, you can edit the Certrqtp.inc file to add, change, or remove [*certificate templates*](../secgloss/c-gly.md) or types available to the user.</span></span> <span data-ttu-id="649b2-127">Esses modelos e tipos, bem como informações relacionadas, estão contidos em uma matriz dimensionada chamada rgAvailReqTypes (*m*, 5).</span><span class="sxs-lookup"><span data-stu-id="649b2-127">These templates and types, as well as related information, are contained in a dimensioned array called rgAvailReqTypes(*m*,5).</span></span>

<span data-ttu-id="649b2-128">Essa matriz, como todas as matrizes de Visual Basic Scripting Edition, é baseada em zero e, como resultado, a primeira dimensão da matriz, *m*, aloca memória para *m*+ 1 item.</span><span class="sxs-lookup"><span data-stu-id="649b2-128">This array, like all Visual Basic Scripting Edition arrays, is zero based, and as a result, the array's first dimension, *m*, allocates memory for *m*+1 items.</span></span> <span data-ttu-id="649b2-129">Portanto, se, ao personalizar as páginas da Web, você precisar modificar o número de itens na matriz rgAvailReqTypes, defina a dimensão *m* para uma menor do que o número total de itens necessários.</span><span class="sxs-lookup"><span data-stu-id="649b2-129">Therefore, if in customizing the webpages, you need to modify the number of items in the rgAvailReqTypes array, set the *m* dimension to one less than the total number of items you need.</span></span> <span data-ttu-id="649b2-130">Por exemplo, se você tiver sete modelos de certificado, altere a declaração de rgAvailReqTypes, conforme mostrado no exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="649b2-130">For example, if you will have seven certificate templates, change the declaration of rgAvailReqTypes as shown in the following example.</span></span>


```VB
Dim rgAvailReqTypes(6,5)
```



<span data-ttu-id="649b2-131">A segunda dimensão da matriz, que sempre tem o valor cinco, aloca os seis campos que compõem cada item.</span><span class="sxs-lookup"><span data-stu-id="649b2-131">The array's second dimension, which always has the value five, allocates the six fields that compose each item.</span></span> <span data-ttu-id="649b2-132">Esses seis campos representam o modelo ou tipo de certificado, o nome de exibição associado a este modelo ou tipo, e se o modelo requer S/MIME ( [*extensões de email da Internet) seguras/multipropósitos*](../secgloss/s-gly.md) .</span><span class="sxs-lookup"><span data-stu-id="649b2-132">These six fields represent the certificate template or type, the display name associated with this template or type, and whether the template requires [*Secure/Multipurpose Internet Mail Extensions*](../secgloss/s-gly.md) (S/MIME).</span></span>

<span data-ttu-id="649b2-133">Para facilitar a compreensão de quais desses campos está sendo acessado, a Certrqtp. Inc também fornece as seguintes constantes que você pode usar ao definir valores de campo.</span><span class="sxs-lookup"><span data-stu-id="649b2-133">To make it easier to understand which of these fields is being accessed, Certrqtp.inc also provides the following constants you can use when setting field values.</span></span>



| <span data-ttu-id="649b2-134">Constante</span><span class="sxs-lookup"><span data-stu-id="649b2-134">Constant</span></span>                              | <span data-ttu-id="649b2-135">Descrição</span><span class="sxs-lookup"><span data-stu-id="649b2-135">Description</span></span>                                                                                                                                                                                                                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="649b2-136">**OID do campo \_**</span><span class="sxs-lookup"><span data-stu-id="649b2-136">**FIELD\_OID**</span></span>                        | <span data-ttu-id="649b2-137">(Aplica-se a CAs autônomas) Indexar para o primeiro campo do item; representa um OID ( [*identificador de objeto*](../secgloss/o-gly.md) ) para um tipo de certificado.</span><span class="sxs-lookup"><span data-stu-id="649b2-137">(Applies to stand-alone CAs) Index to the item's first field; represents an [*object identifier*](../secgloss/o-gly.md) (OID) for a certificate type.</span></span><br/>                                                                                                           |
| <span data-ttu-id="649b2-138">**modelo de campo \_**</span><span class="sxs-lookup"><span data-stu-id="649b2-138">**FIELD\_TEMPLATE**</span></span>                   | <span data-ttu-id="649b2-139">(Aplica-se a CAs corporativas) Indexar para o primeiro campo do item; representa um modelo de certificado.</span><span class="sxs-lookup"><span data-stu-id="649b2-139">(Applies to enterprise CAs) Index to the item's first field; represents a certificate template.</span></span><br/>                                                                                                                                                                                                                           |
| <span data-ttu-id="649b2-140">**\_FriendlyName do campo**</span><span class="sxs-lookup"><span data-stu-id="649b2-140">**FIELD\_FRIENDLYNAME**</span></span>               | <span data-ttu-id="649b2-141">Índice para o segundo campo do item; representa o nome de exibição (que o usuário verá ao registrar) do item no primeiro campo.</span><span class="sxs-lookup"><span data-stu-id="649b2-141">Index to the item's second field; represents the display name (which the user will see when enrolling) of the item in the first field.</span></span>                                                                                                                                                                                               |
| <span data-ttu-id="649b2-142">**CSPLIST de campo \_**</span><span class="sxs-lookup"><span data-stu-id="649b2-142">**FIELD\_CSPLIST**</span></span>                    | <span data-ttu-id="649b2-143">Índice para o terceiro campo do item.</span><span class="sxs-lookup"><span data-stu-id="649b2-143">Index to the item's third field.</span></span> <span data-ttu-id="649b2-144">Uma lista de nomes de [*provedores de serviços de criptografia*](../secgloss/c-gly.md) permitidos pelo modelo.</span><span class="sxs-lookup"><span data-stu-id="649b2-144">A list of [*Cryptographic Service Provider*](../secgloss/c-gly.md) names allowed by the template.</span></span> <span data-ttu-id="649b2-145">Cada nome na lista é separado por um ponto de interrogação (?).</span><span class="sxs-lookup"><span data-stu-id="649b2-145">Each name in the list is separated by a question mark (?).</span></span>                                                    |
| <span data-ttu-id="649b2-146">**CSPLIST2 de campo \_**</span><span class="sxs-lookup"><span data-stu-id="649b2-146">**FIELD\_CSPLIST2**</span></span>                   | <span data-ttu-id="649b2-147">Índice para o quarto campo do item.</span><span class="sxs-lookup"><span data-stu-id="649b2-147">Index to the item's fourth field.</span></span> <span data-ttu-id="649b2-148">Uma lista secundária de nomes de [*provedores de serviços de criptografia*](../secgloss/c-gly.md) permitidos pelo modelo.</span><span class="sxs-lookup"><span data-stu-id="649b2-148">A secondary list of [*Cryptographic Service Provider*](../secgloss/c-gly.md) names allowed by the template.</span></span> <span data-ttu-id="649b2-149">Cada nome na lista é separado por um ponto de interrogação (?).</span><span class="sxs-lookup"><span data-stu-id="649b2-149">Each name in the list is separated by a question mark (?).</span></span> <span data-ttu-id="649b2-150">Essa lista fornece um padrão diferente.</span><span class="sxs-lookup"><span data-stu-id="649b2-150">This list provides a different default.</span></span> |
| <span data-ttu-id="649b2-151">**CAMPO \_ EXportável**</span><span class="sxs-lookup"><span data-stu-id="649b2-151">**FIELD\_EXPORTABLE**</span></span>                 | <span data-ttu-id="649b2-152">Índice para o quinto campo do item.</span><span class="sxs-lookup"><span data-stu-id="649b2-152">Index to the item's fifth field.</span></span> <span data-ttu-id="649b2-153">Indica se o modelo especifica que a chave deve ser exportável.</span><span class="sxs-lookup"><span data-stu-id="649b2-153">Indicates whether the template specifies that the key should be exportable.</span></span> <span data-ttu-id="649b2-154">Se esse campo contiver "true", a chave será exportável.</span><span class="sxs-lookup"><span data-stu-id="649b2-154">If this field contains "True", the key is exportable.</span></span> <span data-ttu-id="649b2-155">Se esse campo contiver "false", a chave não será exportável.</span><span class="sxs-lookup"><span data-stu-id="649b2-155">If this field contains "False", the key is not exportable.</span></span>                                                                                                        |
| <span data-ttu-id="649b2-156">**o campo \_ precisa de \_ \_ recursos SMIME**</span><span class="sxs-lookup"><span data-stu-id="649b2-156">**FIELD\_NEEDS\_SMIME\_CAPABILITIES**</span></span> | <span data-ttu-id="649b2-157">Não há suporte para essa constante.</span><span class="sxs-lookup"><span data-stu-id="649b2-157">This constant is not supported.</span></span>                                                                                                                                                                                                                                                                                                      |



 

<span data-ttu-id="649b2-158">Por exemplo, as expressões a seguir atribuem o OID de 1.3.6.1.5.5.7.3.2 ao primeiro campo do primeiro item e atribuimos "certificado do navegador da Web" ao segundo campo do primeiro item (o valor de matriz de zero indexa o primeiro item).</span><span class="sxs-lookup"><span data-stu-id="649b2-158">For example, the following expressions assign the OID of 1.3.6.1.5.5.7.3.2 to the first item's first field and assign "Web Browser Certificate" to the first item's second field (the array value of zero indexes the first item).</span></span>


```VB
rgAvailReqTypes(0, FIELD_OID) = "1.3.6.1.5.5.7.3.2"
rgAvailReqTypes(0, FIELD_FRIENDLYNAME) = "Web Browser Certificate"
```



<span data-ttu-id="649b2-159">O resultado dessas atribuições é que o usuário verá o texto **certificado do navegador da Web** ao registrar e, se o usuário selecionar o **certificado do navegador da Web**, a [*solicitação de certificado*](../secgloss/c-gly.md) conterá o OID 1.3.6.1.5.5.7.3.2.</span><span class="sxs-lookup"><span data-stu-id="649b2-159">The result of these assignments is that the user will see the text **Web Browser Certificate** when enrolling, and if the user selects **Web Browser Certificate**, the [*certificate request*](../secgloss/c-gly.md) will contain the OID 1.3.6.1.5.5.7.3.2.</span></span>

<span data-ttu-id="649b2-160">O arquivo Certrqtp. Inc também contém constantes que são usadas para os nomes de exibição dos modelos de certificado ou tipos.</span><span class="sxs-lookup"><span data-stu-id="649b2-160">The Certrqtp.inc file also contains constants that are used for the display names of the certificate templates or types.</span></span> <span data-ttu-id="649b2-161">O exemplo a seguir mostra o formato.</span><span class="sxs-lookup"><span data-stu-id="649b2-161">The following example shows the format.</span></span>


```VB
' Strings for localization.
Const L_WebBrowserCert_Text="Web Browser Certificate"
Const L_EmailProtectionCert_Text="E-Mail Protection Certificate"
Const L_UserTemplateCert_Text="User Certificate"
```



<span data-ttu-id="649b2-162">Essas constantes são definidas em um bloco no arquivo Certrqtp. Inc, e esse agrupamento torna mais fácil atribuir a cada um valor personalizado.</span><span class="sxs-lookup"><span data-stu-id="649b2-162">These constants are defined in a block in the Certrqtp.inc file, and this grouping makes it easier to assign each of them a custom value.</span></span> <span data-ttu-id="649b2-163">Isso é particularmente útil quando você localiza os nomes de exibição para versões internacionais das páginas da Web.</span><span class="sxs-lookup"><span data-stu-id="649b2-163">This is particularly helpful when you localize the display names for international versions of the webpages.</span></span>

<span data-ttu-id="649b2-164">Por fim, o arquivo Certrqtp. Inc contém uma variável que representa o número de modelos de certificado ou tipos na matriz rgAvailReqTypes.</span><span class="sxs-lookup"><span data-stu-id="649b2-164">Finally, the Certrqtp.inc file contains a variable that represents the number of certificate templates or types in the rgAvailReqTypes array.</span></span> <span data-ttu-id="649b2-165">Ao contrário da dimensão *m* da matriz, defina o valor da variável nAvailReqTypes como o número real de modelos de certificado ou tipos que sua instalação usará; Esse valor não deve ser maior que *m*+ 1.</span><span class="sxs-lookup"><span data-stu-id="649b2-165">In contrast to the *m* dimension of the array, set the value of the nAvailReqTypes variable to the actual number of certificate templates or types that your installation will use; this value must be no larger than *m*+1.</span></span> <span data-ttu-id="649b2-166">Embora declarado próximo à parte superior do arquivo Certrqtp. Inc, o nAvailReqTypes recebe um valor depois que a matriz rgAvailReqTypes é populada, facilitando a visualização de quantos elementos são realmente usados pela matriz.</span><span class="sxs-lookup"><span data-stu-id="649b2-166">Although declared near the top of the Certrqtp.inc file, nAvailReqTypes is assigned a value after the rgAvailReqTypes array is populated, making it easier to see how many elements are actually used by the array.</span></span> <span data-ttu-id="649b2-167">O valor nAvailReqTypes é usado em uma iteração em outro lugar nas páginas de registro da Web, portanto, é importante que essa variável reflita com precisão o número de modelos de certificado ou tipos que você deseja que sejam visíveis para o usuário.</span><span class="sxs-lookup"><span data-stu-id="649b2-167">The nAvailReqTypes value is used in an iteration elsewhere in the web enrollment pages, so it is important that this variable accurately reflect the number of certificate templates or types that you want to be viewable to the user.</span></span>

<span data-ttu-id="649b2-168">Observe que meramente adicionar [*modelos de certificado*](../secgloss/c-gly.md) e tipos ao arquivo Certrqtp. Inc não garante que o usuário poderá obter um certificado com essas características; a AC deve estar autorizada a emitir um certificado para o modelo ou tipo de certificado especificado.</span><span class="sxs-lookup"><span data-stu-id="649b2-168">Note that merely adding [*certificate templates*](../secgloss/c-gly.md) and types to the Certrqtp.inc file does not guarantee that the user will be able to get a certificate with those traits; the CA must be authorized to issue a certificate for the specified certificate template or type.</span></span>

<span data-ttu-id="649b2-169">As instalações podem criar seus próprios aplicativos ou páginas da Web para solicitar e receber um certificado.</span><span class="sxs-lookup"><span data-stu-id="649b2-169">Installations can create their own applications or webpages to request and receive a certificate.</span></span> <span data-ttu-id="649b2-170">Os objetos [**ICEnroll4**](/windows/desktop/api/Xenroll/nn-xenroll-icenroll4) e [**ICertRequest2**](/windows/desktop/api/Certcli/nn-certcli-icertrequest2) permitem que programadores ou criadores de scripts criem aplicativos de [*solicitação de certificado*](../secgloss/c-gly.md) .</span><span class="sxs-lookup"><span data-stu-id="649b2-170">The [**ICEnroll4**](/windows/desktop/api/Xenroll/nn-xenroll-icenroll4) and [**ICertRequest2**](/windows/desktop/api/Certcli/nn-certcli-icertrequest2) objects allow programmers or scripters to build [*certificate request*](../secgloss/c-gly.md) applications.</span></span>

<span data-ttu-id="649b2-171">Para solicitar um certificado a ser emitido em um [*cartão inteligente*](../secgloss/s-gly.md), você pode usar o controle de registro de cartão inteligente.</span><span class="sxs-lookup"><span data-stu-id="649b2-171">To request a certificate to be issued on a [*smart card*](../secgloss/s-gly.md), you can use the Smart Card Enrollment Control.</span></span> <span data-ttu-id="649b2-172">Para obter detalhes e código de exemplo, consulte [**ISCrdEnr**](iscrdenr.md).</span><span class="sxs-lookup"><span data-stu-id="649b2-172">For details and example code, see [**ISCrdEnr**](iscrdenr.md).</span></span>

 

 
