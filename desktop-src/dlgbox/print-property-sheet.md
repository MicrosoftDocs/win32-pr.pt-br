---
title: Imprimir folha de propriedades
description: A folha de propriedades Imprimir é uma interface de usuário padrão que permite ao usuário especificar as propriedades de um trabalho de impressão específico.
ms.assetid: b52b71cc-a583-4a21-8a53-501ab442e6f8
keywords:
- Interface do usuário do Windows, entrada do usuário
- Interface do usuário do Windows, biblioteca de caixa de diálogo comum
- entrada do usuário, biblioteca de caixa de diálogo comum
- capturando entrada do usuário, biblioteca de caixa de diálogo comum
- Biblioteca de caixa de diálogo comum
- caixas de diálogo comuns
- Caixa de diálogo Imprimir folha de propriedades
- Personalizando a caixa de diálogo Imprimir folha de propriedades
- caixas de diálogo predefinidas
- caixas de diálogo, imprimir folha de propriedades
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 20905f76af290b3978bec828a382604147297998
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104008334"
---
# <a name="print-property-sheet"></a><span data-ttu-id="055ca-113">Imprimir folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="055ca-113">Print Property Sheet</span></span>

<span data-ttu-id="055ca-114">A folha de propriedades **Imprimir** é uma interface de usuário padrão que permite ao usuário especificar as propriedades de um trabalho de impressão específico.</span><span class="sxs-lookup"><span data-stu-id="055ca-114">The **Print** property sheet is a standard user interface that enables the user to specify the properties of a particular print job.</span></span> <span data-ttu-id="055ca-115">A folha de propriedades é composta por um conjunto de páginas de propriedades que varia de acordo com a impressora ou o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="055ca-115">The property sheet is composed of a set of property pages that varies by printer or application.</span></span> <span data-ttu-id="055ca-116">Para um subconjunto de páginas de propriedades padrão do Windows, algumas impressoras podem adicionar páginas de propriedades específicas do driver e alguns aplicativos podem adicionar páginas de propriedades específicas do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="055ca-116">To a subset of standard Windows property pages, some printers might add driver-specific property pages and some applications might add application-specific property pages.</span></span>

<span data-ttu-id="055ca-117">Para criar e exibir uma folha de propriedades de **impressão** , inicialize uma estrutura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) e passe a estrutura para a função [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="055ca-117">To create and display a **Print** property sheet, initialize a [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure and pass the structure to the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function.</span></span>

<span data-ttu-id="055ca-118">A ilustração a seguir mostra uma folha de propriedades de **impressão** típica.</span><span class="sxs-lookup"><span data-stu-id="055ca-118">The following illustration shows a typical **Print** property sheet.</span></span>

![folha de propriedades da impressora](images/printerpropertypagexp.png)

<span data-ttu-id="055ca-120">A maioria dos membros da estrutura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) é idêntica àquelas da estrutura [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) .</span><span class="sxs-lookup"><span data-stu-id="055ca-120">Most members of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure are identical to those of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span> <span data-ttu-id="055ca-121">Para obter descrições de como usar os membros da estrutura comum para interagir com os controles da caixa de diálogo, consulte a [caixa de diálogo Imprimir](print-dialog-box.md).</span><span class="sxs-lookup"><span data-stu-id="055ca-121">For descriptions of how to use the common structure members to interact with the dialog box controls, see [Print Dialog Box](print-dialog-box.md).</span></span> <span data-ttu-id="055ca-122">O restante deste tópico descreve os recursos de folha de propriedades de **impressão** que diferem da caixa de diálogo **Imprimir** .</span><span class="sxs-lookup"><span data-stu-id="055ca-122">The remainder of this topic describes the **Print** property sheet features that differ from the **Print** dialog box.</span></span>

<span data-ttu-id="055ca-123">Você pode personalizar uma folha de propriedades de **impressão** especificando um modelo de caixa de diálogo personalizada para a parte inferior da página **geral** e especificando páginas de propriedades adicionais para seguir a página **geral** .</span><span class="sxs-lookup"><span data-stu-id="055ca-123">You can customize a **Print** property sheet by specifying a custom dialog box template for the lower portion of the **General** page and by specifying additional property pages to follow the **General** page.</span></span> <span data-ttu-id="055ca-124">Para obter mais informações, consulte [Personalizando a folha de propriedades Imprimir](#customizing-the-print-property-sheet).</span><span class="sxs-lookup"><span data-stu-id="055ca-124">For more information, see [Customizing the Print Property Sheet](#customizing-the-print-property-sheet).</span></span>

<span data-ttu-id="055ca-125">Você pode implementar um objeto de retorno de chamada para receber notificações e mensagens da função [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) enquanto a folha de propriedades é exibida.</span><span class="sxs-lookup"><span data-stu-id="055ca-125">You can implement a callback object to receive notifications and messages from the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function while the property sheet is displayed.</span></span> <span data-ttu-id="055ca-126">Os aplicativos que fornecem modelos personalizados ou páginas adicionais usam o objeto de retorno de chamada para se comunicar com a folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="055ca-126">Applications that provide custom templates or additional pages use the callback object to communicate with the property sheet.</span></span> <span data-ttu-id="055ca-127">Para obter mais informações, consulte [retorno de chamada do objeto para a folha de propriedades Imprimir](#callback-object-for-the-print-property-sheet).</span><span class="sxs-lookup"><span data-stu-id="055ca-127">For more information, see [Callback Object for the Print Property Sheet](#callback-object-for-the-print-property-sheet).</span></span>

<span data-ttu-id="055ca-128">A folha de propriedades **Imprimir** fornece suporte para especificar vários intervalos de páginas não contíguas a serem impressos.</span><span class="sxs-lookup"><span data-stu-id="055ca-128">The **Print** property sheet provides support for specifying multiple, noncontiguous page ranges to print.</span></span> <span data-ttu-id="055ca-129">O membro **lpPageRanges** da estrutura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) especifica uma matriz de estruturas [**PRINTPAGERANGE**](/windows/win32/api/commdlg/ns-commdlg-printpagerange) nas quais cada estrutura especifica um intervalo de páginas.</span><span class="sxs-lookup"><span data-stu-id="055ca-129">The **lpPageRanges** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure specifies an array of [**PRINTPAGERANGE**](/windows/win32/api/commdlg/ns-commdlg-printpagerange) structures in which each structure specifies a page range.</span></span>

<span data-ttu-id="055ca-130">A folha de propriedades **Imprimir** exibe um botão de opção **página atual** como parte do grupo de **intervalos de página** de botões de opção.</span><span class="sxs-lookup"><span data-stu-id="055ca-130">The **Print** property sheet displays a **Current Page** radio button as part of the **Page Range** group of radio buttons.</span></span> <span data-ttu-id="055ca-131">Para controlar o botão de opção **página atual** , use os sinalizadores **PD \_ CURRENTPAGE** e **PD \_ NOCURRENTPAGE** no membro **flags** da estrutura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) .</span><span class="sxs-lookup"><span data-stu-id="055ca-131">To control the **Current Page** radio button, use the **PD\_CURRENTPAGE** and **PD\_NOCURRENTPAGE** flags in the **Flags** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure.</span></span>

<span data-ttu-id="055ca-132">Esta seção aborda os tópicos a seguir.</span><span class="sxs-lookup"><span data-stu-id="055ca-132">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="055ca-133">Personalizando a folha de propriedades de impressão</span><span class="sxs-lookup"><span data-stu-id="055ca-133">Customizing the Print Property Sheet</span></span>](#customizing-the-print-property-sheet)
-   [<span data-ttu-id="055ca-134">Objeto de retorno de chamada para a folha de propriedades de impressão</span><span class="sxs-lookup"><span data-stu-id="055ca-134">Callback Object for the Print Property Sheet</span></span>](#callback-object-for-the-print-property-sheet)

## <a name="customizing-the-print-property-sheet"></a><span data-ttu-id="055ca-135">Personalizando a folha de propriedades de impressão</span><span class="sxs-lookup"><span data-stu-id="055ca-135">Customizing the Print Property Sheet</span></span>

<span data-ttu-id="055ca-136">Você pode personalizar a folha de propriedades de **impressão** das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="055ca-136">You can customize the **Print** property sheet in the following ways:</span></span>

-   <span data-ttu-id="055ca-137">Forneça um modelo personalizado para a parte inferior da página **geral** .</span><span class="sxs-lookup"><span data-stu-id="055ca-137">Provide a custom template for the lower portion of the **General** page.</span></span> <span data-ttu-id="055ca-138">Isso permite que você inclua controles adicionais que são exclusivos para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="055ca-138">This allows you to include additional controls that are unique to your application.</span></span> <span data-ttu-id="055ca-139">A função [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) usa o modelo personalizado no lugar do modelo padrão.</span><span class="sxs-lookup"><span data-stu-id="055ca-139">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function uses your custom template in place of the default template.</span></span>
-   <span data-ttu-id="055ca-140">Forneça páginas de propriedades adicionais para seguir a página **geral** .</span><span class="sxs-lookup"><span data-stu-id="055ca-140">Provide additional property pages to follow the **General** page.</span></span>
-   <span data-ttu-id="055ca-141">Forneça um objeto de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="055ca-141">Provide a callback object.</span></span> <span data-ttu-id="055ca-142">Para obter mais informações, consulte [retorno de chamada do objeto para a folha de propriedades Imprimir](#callback-object-for-the-print-property-sheet).</span><span class="sxs-lookup"><span data-stu-id="055ca-142">For more information, see [Callback Object for the Print Property Sheet](#callback-object-for-the-print-property-sheet).</span></span>

<span data-ttu-id="055ca-143">Não é possível alterar a parte superior da página **geral** .</span><span class="sxs-lookup"><span data-stu-id="055ca-143">You cannot change the upper portion of the **General** page.</span></span> <span data-ttu-id="055ca-144">Você não pode alterar as páginas de propriedades fornecidas pelo driver de impressora.</span><span class="sxs-lookup"><span data-stu-id="055ca-144">You cannot change property pages provided by the printer driver.</span></span>

<span data-ttu-id="055ca-145">Para fornecer um modelo personalizado para a página Geral:</span><span class="sxs-lookup"><span data-stu-id="055ca-145">To provide a custom template for the General page:</span></span>

1.  <span data-ttu-id="055ca-146">Crie um modelo personalizado para a parte inferior da página **geral** modificando o modelo PRINTDLGEXORD especificado no arquivo Prnsetup. Dlg.</span><span class="sxs-lookup"><span data-stu-id="055ca-146">Create a custom template for the lower portion of the **General** page by modifying the PRINTDLGEXORD template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="055ca-147">Normalmente, o modelo personalizado deve ter o mesmo tamanho do modelo padrão.</span><span class="sxs-lookup"><span data-stu-id="055ca-147">Typically, the custom template must be the same size as the default template.</span></span> <span data-ttu-id="055ca-148">No entanto, você pode aumentar o modelo personalizado se especificar o sinalizador **PD \_ USELARGETEMPLATE** para criar uma página **geral** maior.</span><span class="sxs-lookup"><span data-stu-id="055ca-148">However, you can enlarge the custom template if you specify the **PD\_USELARGETEMPLATE** flag to create a larger **General** page.</span></span> <span data-ttu-id="055ca-149">Os identificadores de controle usados no modelo de caixa de diálogo de **impressão** padrão são definidos no arquivo Dlgs. h.</span><span class="sxs-lookup"><span data-stu-id="055ca-149">The control identifiers used in the default **Print** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="055ca-150">Use a estrutura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) para habilitar o modelo da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="055ca-150">Use the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure to enable the template as follows:</span></span>
    -   <span data-ttu-id="055ca-151">Se o modelo personalizado for um recurso em um aplicativo ou em uma biblioteca de vínculo dinâmico, defina o sinalizador **PD \_ ENABLEPRINTTEMPLATE** no membro **flags** .</span><span class="sxs-lookup"><span data-stu-id="055ca-151">If your custom template is a resource in an application or dynamic-link library, set the **PD\_ENABLEPRINTTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="055ca-152">Use os membros **HINSTANCE** e **lpPrintTemplateName** da estrutura para identificar o módulo e o nome do recurso.</span><span class="sxs-lookup"><span data-stu-id="055ca-152">Use the **hInstance** and **lpPrintTemplateName** members of the structure to identify the module and resource name.</span></span>

        <span data-ttu-id="055ca-153">-Ou-</span><span class="sxs-lookup"><span data-stu-id="055ca-153">-Or-</span></span>

    -   <span data-ttu-id="055ca-154">Se o modelo personalizado já estiver na memória, defina o sinalizador **PD \_ ENABLEPRINTTEMPLATEHANDLE** .</span><span class="sxs-lookup"><span data-stu-id="055ca-154">If your custom template is already in memory, set the **PD\_ENABLEPRINTTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="055ca-155">Use o membro **HINSTANCE** para identificar o objeto de memória que contém o modelo.</span><span class="sxs-lookup"><span data-stu-id="055ca-155">Use the **hInstance** member to identify the memory object that contains the template.</span></span>

3.  <span data-ttu-id="055ca-156">Se você usar um modelo personalizado para definir controles adicionais, deverá fornecer um objeto de retorno de chamada para processar a entrada para seus controles.</span><span class="sxs-lookup"><span data-stu-id="055ca-156">If you use a custom template to define additional controls, you must provide a callback object to process input for your controls.</span></span> <span data-ttu-id="055ca-157">O objeto de retorno de chamada implementa um método [**IPrintDialogCallback:: HandleMessage**](/windows/win32/api/commdlg/nf-commdlg-iprintdialogcallback-handlemessage) que recebe as mensagens enviadas para a caixa de diálogo personalizada.</span><span class="sxs-lookup"><span data-stu-id="055ca-157">The callback object implements a [**IPrintDialogCallback::HandleMessage**](/windows/win32/api/commdlg/nf-commdlg-iprintdialogcallback-handlemessage) method which receives messages sent to the custom dialog box.</span></span>

<span data-ttu-id="055ca-158">Para fornecer páginas de propriedades adicionais</span><span class="sxs-lookup"><span data-stu-id="055ca-158">To provide additional property pages</span></span>

1.  <span data-ttu-id="055ca-159">Use a função para criar as páginas adicionais.</span><span class="sxs-lookup"><span data-stu-id="055ca-159">Use the function to create the additional pages.</span></span>
2.  <span data-ttu-id="055ca-160">Use o membro **lphPropertyPages** da estrutura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) para especificar uma matriz de identificadores para as páginas adicionais.</span><span class="sxs-lookup"><span data-stu-id="055ca-160">Use the **lphPropertyPages** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure to specify an array of handles to the additional pages.</span></span>

    <span data-ttu-id="055ca-161">Os procedimentos da caixa de diálogo especificados quando você criou cada página processa as mensagens enviadas para as páginas.</span><span class="sxs-lookup"><span data-stu-id="055ca-161">The dialog box procedures specified when you created each page process messages sent to the pages.</span></span>

3.  <span data-ttu-id="055ca-162">Talvez você queira fornecer um objeto de retorno de chamada que implementa a interface.</span><span class="sxs-lookup"><span data-stu-id="055ca-162">You might want to provide a callback object that implements the interface.</span></span> <span data-ttu-id="055ca-163">A função [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) usa essa interface para passar para o aplicativo um ponteiro para uma interface [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) .</span><span class="sxs-lookup"><span data-stu-id="055ca-163">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function uses this interface to pass to the application a pointer to an [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) interface.</span></span> <span data-ttu-id="055ca-164">Os procedimentos da caixa de diálogo para as páginas de propriedades adicionais podem usar essa interface para recuperar informações sobre a impressora selecionada no momento.</span><span class="sxs-lookup"><span data-stu-id="055ca-164">The dialog box procedures for the additional property pages can use this interface to retrieve information about the currently selected printer.</span></span>

## <a name="callback-object-for-the-print-property-sheet"></a><span data-ttu-id="055ca-165">Objeto de retorno de chamada para a folha de propriedades de impressão</span><span class="sxs-lookup"><span data-stu-id="055ca-165">Callback Object for the Print Property Sheet</span></span>

<span data-ttu-id="055ca-166">Um aplicativo que exibe uma folha de propriedades de **impressão** pode implementar um objeto de retorno de chamada para receber notificações e mensagens da função [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) enquanto a folha de propriedades é exibida.</span><span class="sxs-lookup"><span data-stu-id="055ca-166">An application that displays a **Print** property sheet can implement a callback object to receive notifications and messages from the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function while the property sheet is displayed.</span></span> <span data-ttu-id="055ca-167">Para fornecer um objeto de retorno de chamada, especifique um ponteiro para o objeto no membro **lpCallback** da estrutura [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) .</span><span class="sxs-lookup"><span data-stu-id="055ca-167">To provide a callback object, specify a pointer to the object in the **lpCallback** member of the [**PRINTDLGEX**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) structure.</span></span>

<span data-ttu-id="055ca-168">O objeto de retorno de chamada deve implementar a interface [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) .</span><span class="sxs-lookup"><span data-stu-id="055ca-168">The callback object must implement the [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) interface.</span></span> <span data-ttu-id="055ca-169">A função [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) chama os métodos **IPrintDialogCallback** nas seguintes situações:</span><span class="sxs-lookup"><span data-stu-id="055ca-169">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function calls **IPrintDialogCallback** methods in the following situations:</span></span>

-   <span data-ttu-id="055ca-170">Quando a caixa de diálogo foi inicializada</span><span class="sxs-lookup"><span data-stu-id="055ca-170">When the dialog box has been initialized</span></span>
-   <span data-ttu-id="055ca-171">Quando o usuário seleciona uma impressora diferente da lista de impressoras instaladas exibida pela folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="055ca-171">When the user selects a different printer from the list of installed printers displayed by the property sheet</span></span>
-   <span data-ttu-id="055ca-172">Quando ele recebe mensagens para a caixa de diálogo filho na parte inferior da página **geral** da folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="055ca-172">When it receives messages for the child dialog box in the lower portion of the property sheet's **General** page</span></span>

<span data-ttu-id="055ca-173">O objeto de retorno de chamada também deve implementar a interface [**IObjectWithSite**](/windows/win32/api/ocidl/nn-ocidl-iobjectwithsite) .</span><span class="sxs-lookup"><span data-stu-id="055ca-173">The callback object should also implement the [**IObjectWithSite**](/windows/win32/api/ocidl/nn-ocidl-iobjectwithsite) interface.</span></span> <span data-ttu-id="055ca-174">A função [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) chama o método para passar um ponteiro para uma interface [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) para um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="055ca-174">The [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function calls the method to pass a pointer to an [**IPrintDialogServices**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) interface to an application.</span></span> <span data-ttu-id="055ca-175">Os métodos [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) podem usar a interface **IPrintDialogServices** para recuperar informações sobre a impressora selecionada no momento.</span><span class="sxs-lookup"><span data-stu-id="055ca-175">The [**IPrintDialogCallback**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) methods can use the **IPrintDialogServices** interface to retrieve information about the currently selected printer.</span></span> <span data-ttu-id="055ca-176">A interface **IPrintDialogServices** também é útil para aplicativos que criam páginas adicionais para seguir a página **geral** da folha de propriedades **Imprimir** .</span><span class="sxs-lookup"><span data-stu-id="055ca-176">The **IPrintDialogServices** interface is also useful for applications that create additional pages to follow the **General** page of the **Print** property sheet.</span></span> <span data-ttu-id="055ca-177">Os procedimentos da caixa de diálogo para as páginas adicionais podem chamar os métodos **IPrintDialogServices** .</span><span class="sxs-lookup"><span data-stu-id="055ca-177">The dialog box procedures for the additional pages can call **IPrintDialogServices** methods.</span></span>

 

 