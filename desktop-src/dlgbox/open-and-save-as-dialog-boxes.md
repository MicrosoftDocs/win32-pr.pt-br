---
title: Caixas de diálogo abrir e salvar como
description: A caixa de diálogo abrir permite que o usuário especifique a unidade, o diretório e o nome de um arquivo ou conjunto de arquivos a ser aberto.
ms.assetid: 5676ca9d-daca-40bf-8881-def2ff841c58
keywords:
- Biblioteca de caixa de diálogo comum
- caixas de diálogo comuns
- Abrir caixa de diálogo
- caixa de diálogo Salvar Como
- Personalizando a caixa de diálogo aberta
- Personalizando a caixa de diálogo Salvar como
- caixas de diálogo, abra
- caixas de diálogo, salvar como
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim
ms.openlocfilehash: be957276f0d5a6370bb53aca4b1af5052b422011
ms.sourcegitcommit: f848119a8faa29b27585f4df53f6e50ee9666684
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/27/2021
ms.locfileid: "110548881"
---
# <a name="open-and-save-as-dialog-boxes"></a><span data-ttu-id="318a5-111">Caixas de diálogo abrir e salvar como</span><span class="sxs-lookup"><span data-stu-id="318a5-111">Open and Save As Dialog Boxes</span></span>

> [!NOTE]
> <span data-ttu-id="318a5-112">A função [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) é demonstrada no [exemplo o arquivo está em uso](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse).</span><span class="sxs-lookup"><span data-stu-id="318a5-112">The [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) function is demonstrated in the [File is in use sample](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse).</span></span>

<span data-ttu-id="318a5-113">\[A partir do Windows Vista, as caixas de diálogo **abrir** e **salvar como** comuns foram substituídas pela [caixa de diálogo de item comum](../shell/common-file-dialog.md).</span><span class="sxs-lookup"><span data-stu-id="318a5-113">\[Starting with Windows Vista, the **Open** and **Save As** common dialog boxes have been superseded by the [Common Item Dialog](../shell/common-file-dialog.md).</span></span> <span data-ttu-id="318a5-114">Recomendamos que você use a API de caixa de diálogo de item comum em vez dessas caixas de diálogo da biblioteca de caixas de diálogo comuns.\]</span><span class="sxs-lookup"><span data-stu-id="318a5-114">We recommended that you use the Common Item Dialog API instead of these dialog boxes from the Common Dialog Box Library.\]</span></span>

<span data-ttu-id="318a5-115">A caixa de diálogo **abrir** permite que o usuário especifique a unidade, o diretório e o nome de um arquivo ou conjunto de arquivos a ser aberto.</span><span class="sxs-lookup"><span data-stu-id="318a5-115">The **Open** dialog box lets the user specify the drive, directory, and the name of a file or set of files to open.</span></span> <span data-ttu-id="318a5-116">Você cria e exibe uma caixa de diálogo **aberta** inicializando uma estrutura [**da OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) e passando a estrutura para a função [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) .</span><span class="sxs-lookup"><span data-stu-id="318a5-116">You create and display an **Open** dialog box by initializing an [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure and passing the structure to the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) function.</span></span>

<span data-ttu-id="318a5-117">A caixa de diálogo **salvar como** permite que o usuário especifique a unidade, o diretório e o nome de um arquivo a ser salvo.</span><span class="sxs-lookup"><span data-stu-id="318a5-117">The **Save As** dialog box lets the user specify the drive, directory, and name of a file to save.</span></span> <span data-ttu-id="318a5-118">Você cria e exibe uma caixa de diálogo **salvar como** inicializando uma estrutura [**da OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) e passando a estrutura para a função [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) .</span><span class="sxs-lookup"><span data-stu-id="318a5-118">You create and display a **Save As** dialog box by initializing an [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure and passing the structure to the [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) function.</span></span>

<span data-ttu-id="318a5-119">As caixas de diálogo **abrir** e **salvar** no estilo do Gerenciador fornecem recursos de interface do usuário que são semelhantes ao Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="318a5-119">Explorer-style **Open** and **Save As** dialog boxes provide user-interface features that are similar to the Windows Explorer.</span></span> <span data-ttu-id="318a5-120">No entanto, o sistema continua a oferecer suporte a caixas de diálogo **abrir** e **salvar como** de estilo antigo para aplicativos que devem ser consistentes com a interface do usuário de estilo antigo.</span><span class="sxs-lookup"><span data-stu-id="318a5-120">However, the system continues to support old-style **Open** and **Save As** dialog boxes for applications that must be consistent with the old-style user interface.</span></span>

<span data-ttu-id="318a5-121">Além da diferença na aparência, as caixas de diálogo estilo do Gerenciador e estilo antigo diferem no uso dos modelos personalizados e dos procedimentos de conexão para personalizar as caixas de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-121">In addition to the difference in appearance, the Explorer-style and old-style dialog boxes differ in their use of custom templates and hook procedures for customizing the dialog boxes.</span></span> <span data-ttu-id="318a5-122">No entanto, as caixas de diálogo estilo Explorer e de estilo antigo têm o mesmo comportamento para a maioria das operações básicas, como especificar um filtro de nome de arquivo, validar a entrada do usuário e obter o nome de arquivo especificado pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="318a5-122">However, the Explorer-style and old-style dialog boxes have the same behavior for most basic operations, such as specifying a file name filter, validating the user's input, and getting the file name specified by the user.</span></span> <span data-ttu-id="318a5-123">Para obter mais informações sobre as caixas de diálogo estilo Explorer e de estilo antigo, consulte [Abrir e salvar como personalização](#open-and-save-as-dialog-box-customization)da caixa de diálogo .</span><span class="sxs-lookup"><span data-stu-id="318a5-123">For more information about the Explorer-style and old-style dialog boxes, see [Open and Save As Dialog Box Customization](#open-and-save-as-dialog-box-customization).</span></span>

<span data-ttu-id="318a5-124">A ilustração a seguir mostra uma caixa de diálogo **Abrir** típica no estilo Explorer.</span><span class="sxs-lookup"><span data-stu-id="318a5-124">The following illustration shows a typical Explorer-style **Open** dialog box.</span></span>

![caixa de diálogo abrir arquivo](images/opendialogboxxp.png)

<span data-ttu-id="318a5-126">A ilustração a seguir mostra uma caixa de diálogo Típica **Salvar como** no estilo Explorer.</span><span class="sxs-lookup"><span data-stu-id="318a5-126">The following illustration shows a typical Explorer-style **Save As** dialog box.</span></span>

![caixa de diálogo salvar arquivo](images/saveasdialogboxxp.png)

<span data-ttu-id="318a5-128">Se o usuário especificar um nome de arquivo e clicar **no botão OK,** [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) ou [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) **retornará TRUE.**</span><span class="sxs-lookup"><span data-stu-id="318a5-128">If the user specifies a file name and clicks the **OK** button, [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) or [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) returns **TRUE**.</span></span> <span data-ttu-id="318a5-129">O buffer apontado pelo membro **lpstrFile** da estrutura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) contém o caminho completo e o nome do arquivo especificados pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="318a5-129">The buffer pointed to by the **lpstrFile** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure contains the full path and file name specified by the user.</span></span>

<span data-ttu-id="318a5-130">Se o usuário cancelar a **caixa de diálogo Abrir** ou Salvar **como** ou ocorrer um erro, a função retornará **FALSE.**</span><span class="sxs-lookup"><span data-stu-id="318a5-130">If the user cancels the **Open** or **Save As** dialog box or an error occurs, the function returns **FALSE**.</span></span> <span data-ttu-id="318a5-131">Para determinar a causa do erro, chame a [**função CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) para recuperar o valor de erro estendido.</span><span class="sxs-lookup"><span data-stu-id="318a5-131">To determine the cause of the error, call the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span> <span data-ttu-id="318a5-132">Se o buffer **lpstrFile** for muito pequeno para receber o nome completo, **CommDlgExtendedError** retornará **FNERR \_ BUFFERTOOSMALL** e os dois primeiros bytes do buffer apontados pelo membro **lpstrFile** serão definidos como um valor inteiro especificando o tamanho necessário para receber o nome completo.</span><span class="sxs-lookup"><span data-stu-id="318a5-132">If the **lpstrFile** buffer is too small to receive the full name, **CommDlgExtendedError** returns **FNERR\_BUFFERTOOSMALL** and the first 2 bytes of the buffer pointed to by the **lpstrFile** member are set to an integer value specifying the size required to receive the full name.</span></span>

<span data-ttu-id="318a5-133">Os tópicos a seguir são discutidos nesta seção.</span><span class="sxs-lookup"><span data-stu-id="318a5-133">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="318a5-134">Nomes e diretórios de arquivos</span><span class="sxs-lookup"><span data-stu-id="318a5-134">File Names and Directories</span></span>](#file-names-and-directories)
-   [<span data-ttu-id="318a5-135">Filtros</span><span class="sxs-lookup"><span data-stu-id="318a5-135">Filters</span></span>](#filters)
-   [<span data-ttu-id="318a5-136">Validação de arquivo e diretório</span><span class="sxs-lookup"><span data-stu-id="318a5-136">File and Directory Validation</span></span>](#file-and-directory-validation)
-   [<span data-ttu-id="318a5-137">Personalização da caixa de diálogo Abrir e Salvar como</span><span class="sxs-lookup"><span data-stu-id="318a5-137">Open and Save As Dialog Box Customization</span></span>](#open-and-save-as-dialog-box-customization)
-   [<span data-ttu-id="318a5-138">Procedimentos de gancho no estilo explorer</span><span class="sxs-lookup"><span data-stu-id="318a5-138">Explorer-Style Hook Procedures</span></span>](#explorer-style-hook-procedures)
-   [<span data-ttu-id="318a5-139">Modelos personalizados no estilo explorer</span><span class="sxs-lookup"><span data-stu-id="318a5-139">Explorer-Style Custom Templates</span></span>](#explorer-style-custom-templates)
-   [<span data-ttu-id="318a5-140">Identificadores de controle de estilo explorer</span><span class="sxs-lookup"><span data-stu-id="318a5-140">Explorer-Style Control Identifiers</span></span>](#explorer-style-control-identifiers)
-   [<span data-ttu-id="318a5-141">Personalização de Old-Style caixas de diálogo</span><span class="sxs-lookup"><span data-stu-id="318a5-141">Customizing Old-Style Dialog Boxes</span></span>](#customizing-old-style-dialog-boxes)

## <a name="file-names-and-directories"></a><span data-ttu-id="318a5-142">Nomes e diretórios de arquivos</span><span class="sxs-lookup"><span data-stu-id="318a5-142">File Names and Directories</span></span>

<span data-ttu-id="318a5-143">As informações contidas nesta seção aplicam-se às caixas de diálogo do estilo do Explorer e do estilo antigo **abrir** e **salvar como** .</span><span class="sxs-lookup"><span data-stu-id="318a5-143">The information in this section applies to both Explorer-style and old-style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="318a5-144">Antes de chamar as funções [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) ou [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) , o membro **lpstrFile** da estrutura [**da OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) deve apontar para o buffer para receber o nome do arquivo.</span><span class="sxs-lookup"><span data-stu-id="318a5-144">Before calling the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) or [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) functions, the **lpstrFile** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure must point to the buffer to receive the file name.</span></span> <span data-ttu-id="318a5-145">O membro **nMaxFile** deve especificar o tamanho, em caracteres, do buffer **lpstrFile** .</span><span class="sxs-lookup"><span data-stu-id="318a5-145">The **nMaxFile** member must specify the size, in characters, of the **lpstrFile** buffer.</span></span> <span data-ttu-id="318a5-146">Para uma função ANSI, esse é o número de bytes, mas para uma função Unicode, esse é o número de caracteres.</span><span class="sxs-lookup"><span data-stu-id="318a5-146">For an ANSI function this is the number of bytes, but for a Unicode function this is the number of characters.</span></span>

<span data-ttu-id="318a5-147">Se o usuário especificar um nome de arquivo e clicar no botão **OK** , a caixa de diálogo copiará a unidade, o diretório e o nome de arquivo selecionados para o buffer **lpstrFile** .</span><span class="sxs-lookup"><span data-stu-id="318a5-147">If the user specifies a file name and clicks the **OK** button, the dialog box copies the selected drive, directory, and file name to the **lpstrFile** buffer.</span></span> <span data-ttu-id="318a5-148">A função também define os membros **nFileOffset** e **nFileExtension** com os deslocamentos, em caracteres, desde o início do buffer até o nome do arquivo e para a extensão de nome de arquivo, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="318a5-148">The function also sets the **nFileOffset** and **nFileExtension** members to the offsets, in characters, from the start of the buffer to the file name and to the file name extension, respectively.</span></span>

<span data-ttu-id="318a5-149">Para recuperar apenas o nome do arquivo e a extensão, defina o membro **lpstrFileTitle** para apontar para um buffer e defina o membro **nMaxFileTitle** como o tamanho, em caracteres, do buffer.</span><span class="sxs-lookup"><span data-stu-id="318a5-149">To retrieve just the file name and extension, set the **lpstrFileTitle** member to point to a buffer and set the **nMaxFileTitle** member to the size, in characters, of the buffer.</span></span> <span data-ttu-id="318a5-150">Como alternativa, você pode passar o buffer **lpstrFile** em uma chamada para a função [**GetFileTitle**](/windows/desktop/api/Commdlg/nf-commdlg-getfiletitlea) para obter o nome de exibição do arquivo selecionado.</span><span class="sxs-lookup"><span data-stu-id="318a5-150">Alternatively, you can pass the **lpstrFile** buffer in a call to the [**GetFileTitle**](/windows/desktop/api/Commdlg/nf-commdlg-getfiletitlea) function to get the display name of the selected file.</span></span> <span data-ttu-id="318a5-151">No entanto, observe que o nome do arquivo que **GetFileTitle** retornará inclui uma extensão somente se essa for a preferência do usuário para exibir nomes de arquivo.</span><span class="sxs-lookup"><span data-stu-id="318a5-151">Note, however, that the file name that **GetFileTitle** returns includes an extension only if that is the user's preference for displaying file names.</span></span>

<span data-ttu-id="318a5-152">A caixa de diálogo usa o diretório atual para o processo de chamada como o diretório inicial do qual exibir arquivos e diretórios.</span><span class="sxs-lookup"><span data-stu-id="318a5-152">The dialog box uses the current directory for the calling process as the initial directory from which to display files and directories.</span></span> <span data-ttu-id="318a5-153">Use as funções [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) e [**SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) para obter e alterar o diretório atual de um processo.</span><span class="sxs-lookup"><span data-stu-id="318a5-153">Use the [**GetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-getcurrentdirectory) and [**SetCurrentDirectory**](/windows/desktop/api/winbase/nf-winbase-setcurrentdirectory) functions to get and change the current directory of a process.</span></span> <span data-ttu-id="318a5-154">Para especificar um diretório inicial diferente sem alterar o diretório atual, use o membro **lpstrInitialDir** para especificar o nome de um diretório.</span><span class="sxs-lookup"><span data-stu-id="318a5-154">To specify a different initial directory without changing your current directory, use the **lpstrInitialDir** member to specify the name of a directory.</span></span> <span data-ttu-id="318a5-155">A caixa de diálogo altera automaticamente o diretório atual quando o usuário seleciona uma unidade ou diretório diferente.</span><span class="sxs-lookup"><span data-stu-id="318a5-155">The dialog box automatically changes your current directory when the user selects a different drive or directory.</span></span> <span data-ttu-id="318a5-156">Para impedir que a caixa de diálogo altere o diretório atual, de definir **o sinalizador OFN \_ NOCHANGEDIR.**</span><span class="sxs-lookup"><span data-stu-id="318a5-156">To prevent the dialog box from changing your current directory, set the **OFN\_NOCHANGEDIR** flag.</span></span> <span data-ttu-id="318a5-157">Esse sinalizador não impede que o usuário mude de diretório para encontrar um arquivo.</span><span class="sxs-lookup"><span data-stu-id="318a5-157">This flag does not prevent the user from changing directories to find a file.</span></span>

<span data-ttu-id="318a5-158">Para especificar uma extensão de nome de arquivo padrão, use **o membro lpstrDefExt.**</span><span class="sxs-lookup"><span data-stu-id="318a5-158">To specify a default file name extension, use the **lpstrDefExt** member.</span></span> <span data-ttu-id="318a5-159">Se o usuário especificar um nome de arquivo que não tem uma extensão, a caixa de diálogo adiciona sua extensão padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-159">If the user specifies a file name that does not have an extension, the dialog box adds your default extension.</span></span> <span data-ttu-id="318a5-160">Se você especificar uma extensão padrão e o usuário especificar um nome de arquivo com uma extensão diferente, a caixa de diálogo definirá o **sinalizador OFN \_ EXTENSIONDIFFERENT.**</span><span class="sxs-lookup"><span data-stu-id="318a5-160">If you specify a default extension and the user specifies a file name with a different extension, the dialog box sets the **OFN\_EXTENSIONDIFFERENT** flag.</span></span>

<span data-ttu-id="318a5-161">Para permitir que o usuário selecione mais de um arquivo de um diretório, de definir o **sinalizador OFN \_ ALLOWMULTISELECT.**</span><span class="sxs-lookup"><span data-stu-id="318a5-161">To let the user select more than one file from a directory, set the **OFN\_ALLOWMULTISELECT** flag.</span></span> <span data-ttu-id="318a5-162">Para compatibilidade com aplicativos mais antigos, a caixa de diálogo de seleção múltipla padrão usa a interface do usuário de estilo antigo.</span><span class="sxs-lookup"><span data-stu-id="318a5-162">For compatibility with older applications, the default multiple selection dialog box uses the old-style user interface.</span></span> <span data-ttu-id="318a5-163">Para exibir uma caixa de diálogo seleção múltipla no estilo Explorer, você também deve definir o **sinalizador OFN \_ EXPLORER.**</span><span class="sxs-lookup"><span data-stu-id="318a5-163">To display an Explorer-style multiple selection dialog box, you must also set the **OFN\_EXPLORER** flag.</span></span>

<span data-ttu-id="318a5-164">Se o usuário selecionar mais de um arquivo, o buffer apontado pelo membro **lpstrFile** retornará o caminho para o diretório atual seguido pelos nomes de arquivo dos arquivos selecionados.</span><span class="sxs-lookup"><span data-stu-id="318a5-164">If the user selects more than one file, the buffer pointed to by the **lpstrFile** member returns the path to the current directory followed by the file names of the selected files.</span></span> <span data-ttu-id="318a5-165">O **membro nFileOffset** é o deslocamento para o primeiro nome de arquivo e o **membro nFileExtension** não é usado.</span><span class="sxs-lookup"><span data-stu-id="318a5-165">The **nFileOffset** member is the offset to the first file name, and the **nFileExtension** member is not used.</span></span> <span data-ttu-id="318a5-166">A tabela a seguir descreve a diferença entre as caixas de diálogo estilo Explorer e de estilo antigo ao retornar vários nomes de arquivo.</span><span class="sxs-lookup"><span data-stu-id="318a5-166">The following table describes the difference between Explorer-style and old-style dialog boxes in returning multiple file names.</span></span>



| <span data-ttu-id="318a5-167">Estilo da caixa de diálogo</span><span class="sxs-lookup"><span data-stu-id="318a5-167">Dialog box style</span></span>            | <span data-ttu-id="318a5-168">Description</span><span class="sxs-lookup"><span data-stu-id="318a5-168">Description</span></span>                                                                                                                                                                                                               |
|-----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="318a5-169">Caixas de diálogo no estilo explorer</span><span class="sxs-lookup"><span data-stu-id="318a5-169">Explorer-style dialog boxes</span></span> | <span data-ttu-id="318a5-170">As cadeias de caracteres de nome de arquivo e diretório são separadas por **NULL,** com um caractere **NULL** extra após o último nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="318a5-170">The directory and file name strings are **NULL** separated, with an extra **NULL** character after the last file name.</span></span> <span data-ttu-id="318a5-171">Esse formato permite que as caixas de diálogo no estilo Explorer retornem nomes de arquivo longos que incluem espaços.</span><span class="sxs-lookup"><span data-stu-id="318a5-171">This format enables the Explorer-style dialog boxes to return long file names that include spaces.</span></span> |
| <span data-ttu-id="318a5-172">Caixas de diálogo de estilo antigo</span><span class="sxs-lookup"><span data-stu-id="318a5-172">Old-style dialog boxes</span></span>      | <span data-ttu-id="318a5-173">As cadeias de caracteres de nome de arquivo e diretório são separadas por espaços.</span><span class="sxs-lookup"><span data-stu-id="318a5-173">The directory and file name strings are separated by spaces.</span></span> <span data-ttu-id="318a5-174">Para nomes de arquivo com espaços, a função usa nomes de arquivo curtos.</span><span class="sxs-lookup"><span data-stu-id="318a5-174">For file names with spaces, the function uses short file names.</span></span>                                                                                              |



 

<span data-ttu-id="318a5-175">Você pode usar a [**função FindFirstFile**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea) para converter entre nomes de arquivo longos e curtos.</span><span class="sxs-lookup"><span data-stu-id="318a5-175">You can use the [**FindFirstFile**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea) function to convert between long and short file names.</span></span>

<span data-ttu-id="318a5-176">Se você especificar **OFN \_ ALLOWMULTISELECT** e o usuário selecionar apenas um arquivo, a cadeia de caracteres **lpstrFile** não terá um separador entre o caminho e o nome do arquivo.</span><span class="sxs-lookup"><span data-stu-id="318a5-176">If you specify **OFN\_ALLOWMULTISELECT** and the user selects only one file, the **lpstrFile** string does not have a separator between the path and file name.</span></span>

## <a name="filters"></a><span data-ttu-id="318a5-177">Filtros</span><span class="sxs-lookup"><span data-stu-id="318a5-177">Filters</span></span>

<span data-ttu-id="318a5-178">As informações contidas nesta seção aplicam-se às caixas de diálogo **abrir** e **salvar** no estilo do Explorer e estilo antigo.</span><span class="sxs-lookup"><span data-stu-id="318a5-178">The information in this section applies to both Explorer-style and old style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="318a5-179">Você pode fornecer filtros de nome de arquivo para ajudar o usuário a limitar os nomes de arquivo exibidos pela caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-179">You can provide file name filters to assist the user in limiting the file names that the dialog box displays.</span></span> <span data-ttu-id="318a5-180">Um filtro de nome de arquivo consiste em um par de cadeias de caracteres terminadas em nulo, uma descrição e um padrão, um concatenado ao outro.</span><span class="sxs-lookup"><span data-stu-id="318a5-180">A file name filter consists of a pair of null-terminated strings, a description and a pattern, one concatenated to the other.</span></span> <span data-ttu-id="318a5-181">A caixa de diálogo exibe a descrição para permitir que o usuário escolha qual filtro usar; e ele usa o padrão para selecionar os arquivos a serem exibidos.</span><span class="sxs-lookup"><span data-stu-id="318a5-181">The dialog box displays the description to let the user pick which filter to use; and it uses the pattern to select the files to display.</span></span>

<span data-ttu-id="318a5-182">Para especificar os filtros, defina o membro **lpstrFilter** da estrutura [**da OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) para apontar para um buffer que contém uma matriz de pares de cadeia de caracteres de filtro.</span><span class="sxs-lookup"><span data-stu-id="318a5-182">To specify the filters, set the **lpstrFilter** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to point to a buffer that contains an array of filter string pairs.</span></span> <span data-ttu-id="318a5-183">A última cadeia de caracteres na matriz deve ser seguida por um caractere nulo extra.</span><span class="sxs-lookup"><span data-stu-id="318a5-183">The last string in the array must be followed by an extra null character.</span></span>

<span data-ttu-id="318a5-184">Uma cadeia de caracteres de padrão pode ser uma combinação de caracteres de nome de arquivo válidos e o asterisco ( \* ).</span><span class="sxs-lookup"><span data-stu-id="318a5-184">A pattern string can be a combination of valid file name characters and the asterisk (\*).</span></span> <span data-ttu-id="318a5-185">O asterisco é um caractere curinga que representa qualquer combinação de caracteres de nome de arquivo válidos.</span><span class="sxs-lookup"><span data-stu-id="318a5-185">The asterisk is a wildcard that represents any combination of valid file name characters.</span></span> <span data-ttu-id="318a5-186">A caixa de diálogo exibe somente os arquivos que correspondem ao padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-186">The dialog box displays only those files that match the pattern.</span></span> <span data-ttu-id="318a5-187">Para especificar vários padrões para a mesma descrição, você deve usar um ponto-e-vírgula (;) para separar os padrões.</span><span class="sxs-lookup"><span data-stu-id="318a5-187">To specify multiple patterns for the same description, you must use a semicolon (;) to separate the patterns.</span></span> <span data-ttu-id="318a5-188">Observe que os caracteres de espaço na cadeia de caracteres de padrão podem produzir resultados inesperados.</span><span class="sxs-lookup"><span data-stu-id="318a5-188">Note that space characters in the pattern string can produce unexpected results.</span></span>

<span data-ttu-id="318a5-189">O fragmento de código a seguir especifica dois filtros.</span><span class="sxs-lookup"><span data-stu-id="318a5-189">The following code fragment specifies two filters.</span></span> <span data-ttu-id="318a5-190">O filtro com a descrição "Source" tem dois padrões.</span><span class="sxs-lookup"><span data-stu-id="318a5-190">The filter with the "Source" description has two patterns.</span></span> <span data-ttu-id="318a5-191">Se o usuário selecionar esse filtro, a caixa de diálogo exibirá somente os arquivos que têm o. C e. Extensões do CXX.</span><span class="sxs-lookup"><span data-stu-id="318a5-191">If the user selects this filter, the dialog box displays only files that have the .C and .CXX extensions.</span></span> <span data-ttu-id="318a5-192">Observe que, na linguagem de programação C, uma cadeia de caracteres entre aspas duplas é terminada em nulo.</span><span class="sxs-lookup"><span data-stu-id="318a5-192">Note, in the C programming language, a string enclosed in double quotes is null-terminated.</span></span>


```
OPENFILENAME ofn;       // common dialog box structure

ofn.lpstrFilter = "Source\0*.C;*.CXX\0All\0*.*\0"
ofn.nFilterIndex = 1;
```



<span data-ttu-id="318a5-193">O membro **nFilterIndex** da estrutura [**da OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) especifica um índice que indica qual filtro a caixa de diálogo usa inicialmente.</span><span class="sxs-lookup"><span data-stu-id="318a5-193">The **nFilterIndex** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure specifies an index that indicates which filter the dialog box initially uses.</span></span> <span data-ttu-id="318a5-194">O primeiro filtro no buffer tem o índice 1, o segundo 2 e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="318a5-194">The first filter in the buffer has index 1, the second 2, and so on.</span></span> <span data-ttu-id="318a5-195">Se o usuário altera o filtro ao usar a caixa de diálogo, o **membro nFilterIndex** é definido como o índice do filtro selecionado no retorno.</span><span class="sxs-lookup"><span data-stu-id="318a5-195">If the user changes the filter while using the dialog box, the **nFilterIndex** member is set to the index of the selected filter on return.</span></span>

<span data-ttu-id="318a5-196">Você pode criar um filtro personalizado definindo o membro **lpstrCustomFilter** como o endereço de um buffer que contém um único filtro e definindo o membro **nMaxCustFilter** para o tamanho do buffer, em caracteres ou bytes.</span><span class="sxs-lookup"><span data-stu-id="318a5-196">You can create a custom filter by setting the **lpstrCustomFilter** member to the address of a buffer that contains a single filter, and by setting the **nMaxCustFilter** member to the size of the buffer, in characters or bytes.</span></span> <span data-ttu-id="318a5-197">A caixa de diálogo sempre coloca o filtro personalizado no início da lista de filtros e, no retorno, sempre atualiza a parte padrão do filtro com o padrão do filtro selecionado pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="318a5-197">The dialog box always places the custom filter at the beginning of the list of filters and, on return, always updates the pattern part of the filter with the pattern from the filter selected by the user.</span></span>

<span data-ttu-id="318a5-198">Para caixas de diálogo no estilo Explorer, a extensão padrão poderá ser alteração se o usuário selecionar um filtro diferente.</span><span class="sxs-lookup"><span data-stu-id="318a5-198">For Explorer-style dialog boxes, the default extension may change if the user selects a different filter.</span></span> <span data-ttu-id="318a5-199">Se o usuário selecionar um filtro cujo primeiro padrão é do formato \* .*xxx* (ou seja, a extensão não inclui um caractere curinga), a caixa de diálogo usa *xxx* como a extensão padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-199">If the user selects a filter whose first pattern is of the form \*.*xxx* (that is, the extension does not include a wildcard character), the dialog box uses *xxx* as the default extension.</span></span> <span data-ttu-id="318a5-200">Isso ocorrerá somente se você tiver especificado uma extensão padrão no membro **lpstrDefExt** da [**estrutura OPENFILENAME.**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea)</span><span class="sxs-lookup"><span data-stu-id="318a5-200">This occurs only if you specified a default extension in the **lpstrDefExt** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span> <span data-ttu-id="318a5-201">Por exemplo, se o usuário selecionar a "Origem \\ 0 \* . C; \* . Filtro CXX \\ 0", a extensão padrão muda para "C".</span><span class="sxs-lookup"><span data-stu-id="318a5-201">For example, if the user selects the "Source\\0\*.C;\*.CXX\\0" filter, the default extension changes to "C".</span></span> <span data-ttu-id="318a5-202">No entanto, se você tiver definido o filtro como "Origem \\ 0 \* . C \* \\ 0", a extensão padrão não muda porque a extensão inclui um curinga.</span><span class="sxs-lookup"><span data-stu-id="318a5-202">However, if you had defined the filter as "Source\\0\*.C\*\\0", the default extension would not change because the extension includes a wildcard.</span></span>

<span data-ttu-id="318a5-203">A [**mensagem de \_ notificação CDN INCLUDEITEM**](cdn-includeitem.md) fornece outra maneira de filtrar os nomes que a caixa de diálogo exibe.</span><span class="sxs-lookup"><span data-stu-id="318a5-203">The [**CDN\_INCLUDEITEM**](cdn-includeitem.md) notification message provides another way to filter the names that the dialog box displays.</span></span> <span data-ttu-id="318a5-204">Para usar essa mensagem, forneça um procedimento de gancho [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) e especifique o sinalizador **OFN \_ ENABLEINCLUDENOTIFY** na estrutura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) ao criar a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-204">To use this message, provide an [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) hook procedure and specify the **OFN\_ENABLEINCLUDENOTIFY** flag in the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="318a5-205">Sempre que o usuário abre uma pasta, a caixa de diálogo envia uma **notificação CDN \_ INCLUDEITEM** para o procedimento de gancho para cada item na pasta recém-aberta.</span><span class="sxs-lookup"><span data-stu-id="318a5-205">Each time the user opens a folder, the dialog box sends a **CDN\_INCLUDEITEM** notification to your hook procedure for each item in the newly opened folder.</span></span> <span data-ttu-id="318a5-206">O valor de retorno do procedimento de gancho indica se a caixa de diálogo deve exibir o item na lista de itens da pasta.</span><span class="sxs-lookup"><span data-stu-id="318a5-206">The return value of the hook procedure indicates whether the dialog box should display the item in the folder's item list.</span></span>

## <a name="file-and-directory-validation"></a><span data-ttu-id="318a5-207">Validação de arquivo e diretório</span><span class="sxs-lookup"><span data-stu-id="318a5-207">File and Directory Validation</span></span>

<span data-ttu-id="318a5-208">Exceto conforme observado, as informações nesta seção se aplicam às caixas de diálogo do estilo do Explorer e do estilo antigo **abrir** e **salvar como** .</span><span class="sxs-lookup"><span data-stu-id="318a5-208">Except as noted, the information in this section applies to both Explorer-style and old-style **Open** and **Save As** dialog boxes.</span></span>

<span data-ttu-id="318a5-209">A caixa de diálogo valida automaticamente os nomes de arquivo digitados pelo usuário para garantir que os nomes contenham apenas caracteres válidos.</span><span class="sxs-lookup"><span data-stu-id="318a5-209">The dialog box automatically validates file names typed by the user to ensure that the names contain only valid characters.</span></span> <span data-ttu-id="318a5-210">Para substituir a validação de caractere de nome de arquivo, defina o sinalizador **\_ novalidate OFN** .</span><span class="sxs-lookup"><span data-stu-id="318a5-210">To override the file name character validation, set the **OFN\_NOVALIDATE** flag.</span></span>

<span data-ttu-id="318a5-211">Para forçar a caixa de diálogo a verificar se o usuário especificou o nome de um arquivo existente, defina o sinalizador **OFN \_ FILEMUSTEXIST** .</span><span class="sxs-lookup"><span data-stu-id="318a5-211">To force the dialog box to verify that the user specified the name of an existing file, set the **OFN\_FILEMUSTEXIST** flag.</span></span> <span data-ttu-id="318a5-212">Para forçar a verificação de que o caminho especificado existe, defina o sinalizador **OFN \_ PATHMUSTEXIST** .</span><span class="sxs-lookup"><span data-stu-id="318a5-212">To force verification that the specified path exists, set the **OFN\_PATHMUSTEXIST** flag.</span></span> <span data-ttu-id="318a5-213">Se você definir o **sinalizador \_ CreatePrompt do OFN** , a caixa de diálogo solicitará ao usuário permissão para criar um arquivo inexistente.</span><span class="sxs-lookup"><span data-stu-id="318a5-213">If you set the **OFN\_CREATEPROMPT** flag, the dialog box prompts the user for permission to create a nonexistent file.</span></span> <span data-ttu-id="318a5-214">Se esse sinalizador for definido e o usuário optar por criar um novo arquivo, a caixa de diálogo será fechada e a função retornará o nome especificado.</span><span class="sxs-lookup"><span data-stu-id="318a5-214">If this flag is set and the user chooses to create a new file, the dialog box closes, and the function returns the specified name.</span></span> <span data-ttu-id="318a5-215">Caso contrário, a caixa de diálogo permanecerá aberta.</span><span class="sxs-lookup"><span data-stu-id="318a5-215">Otherwise, the dialog box remains open.</span></span>

<span data-ttu-id="318a5-216">Ao usar a caixa de diálogo **salvar como** , você pode direcionar a caixa de diálogo para solicitar ao usuário permissão para substituir um arquivo existente, definindo o sinalizador **OFN \_ OVERWRITEPROMPT** .</span><span class="sxs-lookup"><span data-stu-id="318a5-216">When using the **Save As** dialog box, you can direct the dialog box to prompt the user for permission to overwrite an existing file by setting the **OFN\_OVERWRITEPROMPT** flag.</span></span>

<span data-ttu-id="318a5-217">Por padrão, a caixa de diálogo cria um arquivo de teste de comprimento zero para determinar se um novo arquivo pode ser criado no diretório selecionado.</span><span class="sxs-lookup"><span data-stu-id="318a5-217">By default, the dialog box creates a zero-length test file to determine whether a new file can be created in the selected directory.</span></span> <span data-ttu-id="318a5-218">Para evitar a criação desse arquivo de teste, defina o sinalizador **OFN \_ NOTESTFILECREATE** .</span><span class="sxs-lookup"><span data-stu-id="318a5-218">To prevent the creation of this test file, set the **OFN\_NOTESTFILECREATE** flag.</span></span>

<span data-ttu-id="318a5-219">Se você habilitar um procedimento de gancho, a caixa de diálogo notificará seu procedimento de gancho quando ocorrer uma violação de compartilhamento de rede para o nome de arquivo especificado pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="318a5-219">If you enable a hook procedure, the dialog box notifies your hook procedure when a network sharing violation occurs for the file name specified by the user.</span></span> <span data-ttu-id="318a5-220">Se você definir o sinalizador **OFN \_ Explorer** , a caixa de diálogo enviará a mensagem [**\_ SHAREVIOLATION da CDN**](cdn-shareviolation.md) para o procedimento de gancho.</span><span class="sxs-lookup"><span data-stu-id="318a5-220">If you set the **OFN\_EXPLORER** flag, the dialog box sends the [**CDN\_SHAREVIOLATION**](cdn-shareviolation.md) message to the hook procedure.</span></span> <span data-ttu-id="318a5-221">Se você não definir o **OFN \_ Explorer**, a caixa de diálogo enviará a mensagem registrada [**SHAREVISTRING**](sharevistring.md) para o procedimento de gancho.</span><span class="sxs-lookup"><span data-stu-id="318a5-221">If you do not set **OFN\_EXPLORER**, the dialog box sends the [**SHAREVISTRING**](sharevistring.md) registered message to the hook procedure.</span></span> <span data-ttu-id="318a5-222">Para impedir que a caixa de diálogo envie notificações para compartilhamento de violações, defina o sinalizador **OFN \_ SHAREAWARE** .</span><span class="sxs-lookup"><span data-stu-id="318a5-222">To prevent the dialog box from sending any notifications for sharing violations, set the **OFN\_SHAREAWARE** flag.</span></span>

<span data-ttu-id="318a5-223">Se o usuário marcar a caixa de seleção somente leitura, a caixa de diálogo definirá o sinalizador **OFN \_ ReadOnly** no retorno.</span><span class="sxs-lookup"><span data-stu-id="318a5-223">If the user selects the read-only check box, the dialog box sets the **OFN\_READONLY** flag on return.</span></span> <span data-ttu-id="318a5-224">Para ocultar a **caixa de seleção Abrir como Somente** Leitura, de definido o sinalizador **OFN \_ HIDEREADONLY.**</span><span class="sxs-lookup"><span data-stu-id="318a5-224">To hide the **Open As Read Only** check box, set the **OFN\_HIDEREADONLY** flag.</span></span> <span data-ttu-id="318a5-225">Para impedir que a caixa de diálogo retorne nomes de arquivos existentes que têm o atributo somente leitura, de definir o sinalizador **OFN \_ NOREADONLYRETURN.**</span><span class="sxs-lookup"><span data-stu-id="318a5-225">To prevent the dialog box from returning names of existing files that have the read-only attribute, set the **OFN\_NOREADONLYRETURN** flag.</span></span>

<span data-ttu-id="318a5-226">Para impedir que a caixa de diálogo desreferencie arquivos de link, defina o **valor OFN \_ NODEREFERENCELINKS.**</span><span class="sxs-lookup"><span data-stu-id="318a5-226">To prevent the dialog box from dereferencing link files, set the **OFN\_NODEREFERENCELINKS** value.</span></span> <span data-ttu-id="318a5-227">Nesse caso, a caixa de diálogo retorna o nome do arquivo de link em vez do nome do arquivo referenciado pelo arquivo de link.</span><span class="sxs-lookup"><span data-stu-id="318a5-227">In this case, the dialog box returns the name of the link file rather than the name of the file referenced by the link file.</span></span>

## <a name="open-and-save-as-dialog-box-customization"></a><span data-ttu-id="318a5-228">Personalização da caixa de diálogo Abrir e Salvar como</span><span class="sxs-lookup"><span data-stu-id="318a5-228">Open and Save As Dialog Box Customization</span></span>

<span data-ttu-id="318a5-229">Você pode personalizar uma **caixa de** diálogo Abrir ou Salvar **como** fornecendo um procedimento de gancho, um modelo personalizado ou ambos.</span><span class="sxs-lookup"><span data-stu-id="318a5-229">You can customize an **Open** or **Save As** dialog box by providing a hook procedure, a custom template, or both.</span></span> <span data-ttu-id="318a5-230">No entanto, as versões de estilo explorer e de estilo antigo das caixas de diálogo diferem no uso de modelos personalizados e procedimentos de gancho.</span><span class="sxs-lookup"><span data-stu-id="318a5-230">However, the Explorer-style and old-style versions of the dialog boxes differ in their use of custom templates and hook procedures.</span></span>

<span data-ttu-id="318a5-231">Para obter informações sobre como personalizar uma caixa de diálogo no estilo Explorer, consulte Procedimentos de gancho no estilo [Explorer,](#explorer-style-hook-procedures)Modelos [Personalizados](#explorer-style-custom-templates)no Estilo Explorer e Identificadores de Controle de Estilo [Explorer](#explorer-style-control-identifiers).</span><span class="sxs-lookup"><span data-stu-id="318a5-231">For information about customizing an Explorer-style dialog box, see [Explorer-Style Hook Procedures](#explorer-style-hook-procedures), [Explorer-Style Custom Templates](#explorer-style-custom-templates), and [Explorer-Style Control Identifiers](#explorer-style-control-identifiers).</span></span> <span data-ttu-id="318a5-232">Para obter informações sobre como personalizar uma caixa de diálogo de estilo antigo, consulte [Personalização Old-Style caixas de diálogo](#customizing-old-style-dialog-boxes).</span><span class="sxs-lookup"><span data-stu-id="318a5-232">For information about customizing an old-style dialog box, see [Customizing Old-Style Dialog Boxes](#customizing-old-style-dialog-boxes).</span></span>

<span data-ttu-id="318a5-233">A tabela a seguir resume as diferenças entre os dois estilos.</span><span class="sxs-lookup"><span data-stu-id="318a5-233">The following table summarizes the differences between the two styles.</span></span>



| <span data-ttu-id="318a5-234">Personalização</span><span class="sxs-lookup"><span data-stu-id="318a5-234">Customization</span></span>                  | <span data-ttu-id="318a5-235">Description</span><span class="sxs-lookup"><span data-stu-id="318a5-235">Description</span></span>                                                                                                                                                                                                                                                                          |
|--------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="318a5-236">Procedimento de gancho no estilo explorer</span><span class="sxs-lookup"><span data-stu-id="318a5-236">Explorer-style Hook procedure</span></span>  | <span data-ttu-id="318a5-237">O procedimento de gancho recebe mensagens de notificação enviadas da caixa de diálogo comum e mensagens para quaisquer controles adicionais que você definiu especificando um modelo de caixa de diálogo filho.</span><span class="sxs-lookup"><span data-stu-id="318a5-237">The hook procedure receives notification messages sent from the common dialog box and messages for any additional controls that you defined by specifying a child dialog template.</span></span> <span data-ttu-id="318a5-238">O procedimento de gancho não recebe mensagens para os controles padrão da caixa de diálogo padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-238">The hook procedure does not receive messages for the standard controls of the default dialog box.</span></span> |
| <span data-ttu-id="318a5-239">Modelo personalizado no estilo explorer</span><span class="sxs-lookup"><span data-stu-id="318a5-239">Explorer-style Custom template</span></span> | <span data-ttu-id="318a5-240">O sistema usa o modelo personalizado para criar uma caixa de diálogo filho.</span><span class="sxs-lookup"><span data-stu-id="318a5-240">The system uses the custom template to create a child dialog box.</span></span> <span data-ttu-id="318a5-241">O modelo pode definir controles adicionais e pode especificar o local do cluster de controles padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-241">The template can define additional controls, and can specify the location of the cluster of standard controls.</span></span> <span data-ttu-id="318a5-242">O modelo personalizado não substitui o modelo padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-242">The custom template does not replace the default template.</span></span>                                          |
| <span data-ttu-id="318a5-243">Procedimento de gancho de estilo antigo</span><span class="sxs-lookup"><span data-stu-id="318a5-243">Old-style Hook procedure</span></span>       | <span data-ttu-id="318a5-244">O procedimento de gancho recebe todas as mensagens enviadas para a caixa de diálogo, incluindo mensagens para os controles padrão e todos os controles personalizados.</span><span class="sxs-lookup"><span data-stu-id="318a5-244">The hook procedure receives all messages sent to the dialog box, including messages for the standard controls and any custom controls.</span></span> <span data-ttu-id="318a5-245">O procedimento de gancho também recebe mensagens registradas enviadas da caixa de diálogo comum.</span><span class="sxs-lookup"><span data-stu-id="318a5-245">The hook procedure also receives registered messages sent from the common dialog box.</span></span>                                                         |
| <span data-ttu-id="318a5-246">Modelo personalizado de estilo antigo</span><span class="sxs-lookup"><span data-stu-id="318a5-246">Old-style Custom template</span></span>      | <span data-ttu-id="318a5-247">O modelo personalizado substitui o modelo padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-247">The custom template replaces the default template.</span></span> <span data-ttu-id="318a5-248">Crie o modelo personalizado modificando o modelo padrão especificado no arquivo FileOpen. Dlg.</span><span class="sxs-lookup"><span data-stu-id="318a5-248">Create the custom template by modifying the default template specified in the Fileopen.dlg file.</span></span>                                                                                                                                  |



 

<span data-ttu-id="318a5-249">O título padrão para as caixas de diálogo estilo do Explorer e estilo antigo é "**abrir**" ou "**salvar como**".</span><span class="sxs-lookup"><span data-stu-id="318a5-249">The default title for both Explorer-style and old-style dialog boxes is either "**Open**" or "**Save As**."</span></span> <span data-ttu-id="318a5-250">Para alterar o título, especifique o novo título no membro **lpstrTitle** da estrutura [**da OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) .</span><span class="sxs-lookup"><span data-stu-id="318a5-250">To change the title, specify the new title in the **lpstrTitle** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span>

<span data-ttu-id="318a5-251">O hive do registro do **\_ \_ usuário do HKEY Current** do usuário pode conter valores que personalizam o conteúdo das caixas de diálogo **abrir** e **salvar como** do Gerenciador de navegador.</span><span class="sxs-lookup"><span data-stu-id="318a5-251">A user's **HKEY\_CURRENT\_USER** registry hive can contain values that customize the contents of the Explorer-style **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="318a5-252">Essas entradas de registro afetam apenas as caixas de diálogo exibidas para o usuário associado ao hive do registro.</span><span class="sxs-lookup"><span data-stu-id="318a5-252">These registry entries affect only the dialog boxes displayed for the user associated with the registry hive.</span></span>

<span data-ttu-id="318a5-253">Para ocultar os recursos das caixas de diálogo **abrir** e **salvar como** do estilo do Explorer, um administrador pode definir os valores na tabela a seguir nesta subchave:</span><span class="sxs-lookup"><span data-stu-id="318a5-253">To hide features of Explorer-style **Open** and **Save As** dialog boxes, an administrator can set the values in the following table under this subkey:</span></span>

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Policies
                  Comdlg32
```



| <span data-ttu-id="318a5-254">Nome do valor</span><span class="sxs-lookup"><span data-stu-id="318a5-254">Value name</span></span>       | <span data-ttu-id="318a5-255">Valor</span><span class="sxs-lookup"><span data-stu-id="318a5-255">Value</span></span> | <span data-ttu-id="318a5-256">Significado</span><span class="sxs-lookup"><span data-stu-id="318a5-256">Meaning</span></span>                                  |
|------------------|-------|------------------------------------------|
| <span data-ttu-id="318a5-257">**NoPlacesBar**</span><span class="sxs-lookup"><span data-stu-id="318a5-257">**NoPlacesBar**</span></span>  | <span data-ttu-id="318a5-258">1</span><span class="sxs-lookup"><span data-stu-id="318a5-258">1</span></span>     | <span data-ttu-id="318a5-259">Oculta a barra de locais.</span><span class="sxs-lookup"><span data-stu-id="318a5-259">Hides the places bar.</span></span>                    |
| <span data-ttu-id="318a5-260">**NoFileMRU**</span><span class="sxs-lookup"><span data-stu-id="318a5-260">**NoFileMRU**</span></span>    | <span data-ttu-id="318a5-261">1</span><span class="sxs-lookup"><span data-stu-id="318a5-261">1</span></span>     | <span data-ttu-id="318a5-262">Oculta a lista de MRU (usada mais recentemente).</span><span class="sxs-lookup"><span data-stu-id="318a5-262">Hides the Most Recently Used (MRU) list.</span></span> |
| <span data-ttu-id="318a5-263">**NoBackButton**</span><span class="sxs-lookup"><span data-stu-id="318a5-263">**NoBackButton**</span></span> | <span data-ttu-id="318a5-264">1</span><span class="sxs-lookup"><span data-stu-id="318a5-264">1</span></span>     | <span data-ttu-id="318a5-265">Oculta o botão **voltar** .</span><span class="sxs-lookup"><span data-stu-id="318a5-265">Hides the **Back** button.</span></span>               |



 

<span data-ttu-id="318a5-266">O conteúdo da barra de **locais** é determinado pelo conteúdo da seguinte subchave:</span><span class="sxs-lookup"><span data-stu-id="318a5-266">The contents of the **Places** bar are determined by the contents of the following subkey:</span></span>

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Policies
                  Comdlg32
                     Placesbar
```

<span data-ttu-id="318a5-267">No momento, só pode haver cinco entradas sob essa chave, e o índice de valor/nome é baseado em zero.</span><span class="sxs-lookup"><span data-stu-id="318a5-267">Currently, there can only be five entries under this key, and the value/name index is zero-based.</span></span> <span data-ttu-id="318a5-268">Os nomes das entradas devem ser Place0, Place1, Place2, Place3 e Place4.</span><span class="sxs-lookup"><span data-stu-id="318a5-268">The names for the entries should be Place0, Place1, Place2,Place3, and Place4.</span></span> <span data-ttu-id="318a5-269">Os valores das entradas podem ser valores **reg \_ DWORD**, **reg \_ sz** ou **reg \_ expande \_ sz** que identificam os locais a serem incluídos na barra de locais.</span><span class="sxs-lookup"><span data-stu-id="318a5-269">The values of the entries can be **REG\_DWORD**, **REG\_SZ**, or **REG\_EXPAND\_SZ** values that identify locations to include in the places bar.</span></span>



| <span data-ttu-id="318a5-270">Tipo de valor</span><span class="sxs-lookup"><span data-stu-id="318a5-270">Value type</span></span>                         | <span data-ttu-id="318a5-271">Significado</span><span class="sxs-lookup"><span data-stu-id="318a5-271">Meaning</span></span>                                                                                                   |
|------------------------------------|-----------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="318a5-272">**REG \_ DWORD**</span><span class="sxs-lookup"><span data-stu-id="318a5-272">**REG\_DWORD**</span></span>                     | <span data-ttu-id="318a5-273">Um valor de CSIDl que identifica uma pasta.</span><span class="sxs-lookup"><span data-stu-id="318a5-273">A CSIDL value that identifies a folder.</span></span> <span data-ttu-id="318a5-274">Para ver uma lista de valores CSIDL, confira [**Valores CSIDL**](../shell/csidl.md).</span><span class="sxs-lookup"><span data-stu-id="318a5-274">For a list of CSIDL values, see [**CSIDL values**](../shell/csidl.md).</span></span> |
| <span data-ttu-id="318a5-275">**REG \_ SZ** ou **REG \_ EXPAND \_ SZ**</span><span class="sxs-lookup"><span data-stu-id="318a5-275">**REG\_SZ** or **REG\_EXPAND\_SZ**</span></span> | <span data-ttu-id="318a5-276">Uma cadeia de caracteres terminada em nulo que especifica um caminho válido.</span><span class="sxs-lookup"><span data-stu-id="318a5-276">A null-terminated string that specifies a valid path.</span></span>                                                     |



 

## <a name="explorer-style-hook-procedures"></a><span data-ttu-id="318a5-277">Explorer-Style de gancho</span><span class="sxs-lookup"><span data-stu-id="318a5-277">Explorer-Style Hook Procedures</span></span>

<span data-ttu-id="318a5-278">Você pode personalizar uma caixa de diálogo **Abrir** ou Salvar **como** no estilo Explorer fornecendo um procedimento de gancho, um modelo personalizado ou ambos.</span><span class="sxs-lookup"><span data-stu-id="318a5-278">You can customize an Explorer-style **Open** or **Save As** dialog box by providing a hook procedure, a custom template, or both.</span></span> <span data-ttu-id="318a5-279">Se você fornecer um procedimento de gancho para uma caixa de diálogo no estilo Explorer, o sistema criará uma caixa de diálogo que é um filho da caixa de diálogo padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-279">If you provide a hook procedure for an Explorer-style dialog box, the system creates a dialog box that is a child of the default dialog box.</span></span> <span data-ttu-id="318a5-280">O procedimento de gancho atua como o procedimento de diálogo para a caixa de diálogo filho.</span><span class="sxs-lookup"><span data-stu-id="318a5-280">The hook procedure acts as the dialog procedure for the child dialog box.</span></span> <span data-ttu-id="318a5-281">Essa caixa de diálogo filho é baseada no modelo personalizado ou em um modelo padrão, se nenhum for fornecido.</span><span class="sxs-lookup"><span data-stu-id="318a5-281">This child dialog box is based on the custom template, or on a default template if none is provided.</span></span> <span data-ttu-id="318a5-282">Para obter mais informações, consulte [Modelos personalizados no estilo explorer.](#explorer-style-custom-templates)</span><span class="sxs-lookup"><span data-stu-id="318a5-282">For more information, see [Explorer-Style Custom Templates](#explorer-style-custom-templates).</span></span>

<span data-ttu-id="318a5-283">Para habilitar um procedimento  de gancho para uma caixa de diálogo Abrir ou Salvar **como** no estilo Explorer, use a estrutura [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) ao criar a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-283">To enable a hook procedure for an Explorer-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="318a5-284">De definir os sinalizadores **OFN \_ ENABLEHOOK** e **OFN \_ EXPLORER** no membro **Flags** e especifique o endereço de um procedimento de gancho [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) no membro **lpfnHook.**</span><span class="sxs-lookup"><span data-stu-id="318a5-284">Set the **OFN\_ENABLEHOOK** and **OFN\_EXPLORER** flags in the **Flags** member and specify the address of an [**OFNHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpofnhookproc) hook procedure in the **lpfnHook** member.</span></span> <span data-ttu-id="318a5-285">Se você fornecer um procedimento de gancho e omitir o sinalizador **OFN \_ EXPLORER,** deverá usar um procedimento de gancho [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) e obter a interface do usuário de estilo antigo.</span><span class="sxs-lookup"><span data-stu-id="318a5-285">If you provide a hook procedure and omit the **OFN\_EXPLORER** flag, you must use an [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure and you will get the old-style user-interface.</span></span> <span data-ttu-id="318a5-286">Para obter mais informações, consulte [Personalização Old-Style caixas de diálogo](#customizing-old-style-dialog-boxes).</span><span class="sxs-lookup"><span data-stu-id="318a5-286">For more information, see [Customizing Old-Style Dialog Boxes](#customizing-old-style-dialog-boxes).</span></span>

<span data-ttu-id="318a5-287">Um procedimento de gancho no estilo Explorer recebe uma variedade de mensagens enquanto a caixa de diálogo está aberta.</span><span class="sxs-lookup"><span data-stu-id="318a5-287">An Explorer-style hook procedure receives a variety of messages while the dialog box is open.</span></span> <span data-ttu-id="318a5-288">Entre elas estão as seguintes:</span><span class="sxs-lookup"><span data-stu-id="318a5-288">These include the following:</span></span>

-   <span data-ttu-id="318a5-289">A [**mensagem WM \_ INITDIALOG**](wm-initdialog.md) e outras mensagens da caixa de diálogo padrão, como a mensagem de cor do controle [**WM \_ CTLCOLORDLG.**](wm-ctlcolordlg.md)</span><span class="sxs-lookup"><span data-stu-id="318a5-289">The [**WM\_INITDIALOG**](wm-initdialog.md) message and other standard dialog box messages such as the [**WM\_CTLCOLORDLG**](wm-ctlcolordlg.md) control color message.</span></span>
-   <span data-ttu-id="318a5-290">Um conjunto de [**mensagens de \_ notificação WM NOTIFY**](../controls/wm-notify.md) indicando ações realizadas pelo usuário ou outros eventos de caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-290">A set of [**WM\_NOTIFY**](../controls/wm-notify.md) notification messages indicating actions taken by the user or other dialog box events.</span></span>
-   <span data-ttu-id="318a5-291">Mensagens para quaisquer controles adicionais que você definiu especificando um modelo de caixa de diálogo filho.</span><span class="sxs-lookup"><span data-stu-id="318a5-291">Messages for any additional controls that you defined by specifying a child dialog template.</span></span>

<span data-ttu-id="318a5-292">Além disso, há um conjunto de mensagens que você pode enviar para uma caixa de diálogo no estilo Explorer para obter informações ou para controlar o comportamento e a aparência da caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-292">In addition, there is a set of messages that you can send to an Explorer-style dialog box to get information or to control the behavior and appearance of the dialog box.</span></span>

<span data-ttu-id="318a5-293">Se você fornecer um procedimento de gancho para uma caixa de diálogo estilo de Gerenciador, o procedimento de caixa de diálogo padrão criará uma caixa de diálogo filho quando o procedimento de diálogo padrão estiver processando sua mensagem [**\_ INITDIALOG do WM**](wm-initdialog.md) .</span><span class="sxs-lookup"><span data-stu-id="318a5-293">If you provide a hook procedure for an Explorer-style dialog box, the default dialog box procedure creates a child dialog box when the default dialog procedure is processing its [**WM\_INITDIALOG**](wm-initdialog.md) message.</span></span> <span data-ttu-id="318a5-294">O procedimento de gancho atua como o procedimento de diálogo para a caixa de diálogo filho.</span><span class="sxs-lookup"><span data-stu-id="318a5-294">The hook procedure acts as the dialog procedure for the child dialog box.</span></span> <span data-ttu-id="318a5-295">Neste momento, o procedimento de gancho recebe sua própria **mensagem \_ INITDIALOG do WM** com o parâmetro *lParam* definido como o endereço da estrutura [**da OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) usada para inicializar a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-295">At this time, the hook procedure receives its own **WM\_INITDIALOG** message with the *lParam* parameter set to the address of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure used to initialize the dialog box.</span></span> <span data-ttu-id="318a5-296">Depois que a caixa de diálogo filho terminar de processar sua própria mensagem do **WM \_ INITDIALOG** , o procedimento de diálogo padrão moverá os controles padrão, se necessário, para liberar espaço para qualquer controle adicional da caixa de diálogo filho.</span><span class="sxs-lookup"><span data-stu-id="318a5-296">After the child dialog finishes processing its own **WM\_INITDIALOG** message, the default dialog procedure moves the standard controls, if necessary, to make room for any additional controls of the child dialog box.</span></span> <span data-ttu-id="318a5-297">Em seguida, o procedimento de caixa de diálogo padrão envia a mensagem de notificação [**\_ INITDONE da CDN**](cdn-initdone.md) para o procedimento de gancho.</span><span class="sxs-lookup"><span data-stu-id="318a5-297">The default dialog procedure then sends the [**CDN\_INITDONE**](cdn-initdone.md) notification message to the hook procedure.</span></span>

<span data-ttu-id="318a5-298">O procedimento de gancho recebe mensagens de notificação do [**WM \_ notificar**](../controls/wm-notify.md) que indicam ações executadas pelo usuário na caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-298">The hook procedure receives [**WM\_NOTIFY**](../controls/wm-notify.md) notification messages indicating actions taken by the user in the dialog box.</span></span> <span data-ttu-id="318a5-299">Você pode usar algumas dessas mensagens para controlar o comportamento da caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-299">You can use some of these messages to control the behavior of the dialog box.</span></span> <span data-ttu-id="318a5-300">Por exemplo, o procedimento de gancho recebe a mensagem [**\_ FILEOK da CDN**](cdn-fileok.md) quando o usuário escolhe um nome de arquivo e clica no botão **OK** .</span><span class="sxs-lookup"><span data-stu-id="318a5-300">For example, the hook procedure receives the [**CDN\_FILEOK**](cdn-fileok.md) message when the user chooses a file name and clicks the **OK** button.</span></span> <span data-ttu-id="318a5-301">Em resposta a essa mensagem, o procedimento de gancho pode usar a função [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) para rejeitar o nome selecionado e forçar a caixa de diálogo a permanecer aberta.</span><span class="sxs-lookup"><span data-stu-id="318a5-301">In response to this message, the hook procedure can use the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function to reject the selected name and force the dialog box to remain open.</span></span>

<span data-ttu-id="318a5-302">O parâmetro *lParam* para cada mensagem de [**\_ notificação do WM**](../controls/wm-notify.md) é um ponteiro para uma estrutura [**OFNOTIFY**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifya) ou [**OFNOTIFYEX**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifyexa) que define a ação.</span><span class="sxs-lookup"><span data-stu-id="318a5-302">The *lParam* parameter for each [**WM\_NOTIFY**](../controls/wm-notify.md) message is a pointer to an [**OFNOTIFY**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifya) or [**OFNOTIFYEX**](/windows/desktop/api/Commdlg/ns-commdlg-ofnotifyexa) structure that defines the action.</span></span> <span data-ttu-id="318a5-303">O membro do **código** no cabeçalho dessa estrutura contém uma das seguintes mensagens de notificação.</span><span class="sxs-lookup"><span data-stu-id="318a5-303">The **code** member in the header of this structure contains one of the following notification messages.</span></span>



| <span data-ttu-id="318a5-304">Mensagem</span><span class="sxs-lookup"><span data-stu-id="318a5-304">Message</span></span>                                           | <span data-ttu-id="318a5-305">Significado</span><span class="sxs-lookup"><span data-stu-id="318a5-305">Meaning</span></span>                                                                                                                                                                                                                                                                                        |
|---------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="318a5-306">**\_FILEOK CDN**</span><span class="sxs-lookup"><span data-stu-id="318a5-306">**CDN\_FILEOK**</span></span>](cdn-fileok.md)                 | <span data-ttu-id="318a5-307">O usuário clicou no botão **OK** ; a caixa de diálogo está prestes a fechar.</span><span class="sxs-lookup"><span data-stu-id="318a5-307">The user clicked the **OK** button; the dialog box is about to close.</span></span>                                                                                                                                                                                                                          |
| [<span data-ttu-id="318a5-308">**\_FOLDERCHANGE CDN**</span><span class="sxs-lookup"><span data-stu-id="318a5-308">**CDN\_FOLDERCHANGE**</span></span>](cdn-folderchange.md)     | <span data-ttu-id="318a5-309">O usuário abriu uma nova pasta ou diretório.</span><span class="sxs-lookup"><span data-stu-id="318a5-309">The user opened a new folder or directory.</span></span>                                                                                                                                                                                                                                                     |
| [<span data-ttu-id="318a5-310">**ajuda da CDN \_**</span><span class="sxs-lookup"><span data-stu-id="318a5-310">**CDN\_HELP**</span></span>](cdn-help.md)                     | <span data-ttu-id="318a5-311">O usuário clicou no botão **ajuda** .</span><span class="sxs-lookup"><span data-stu-id="318a5-311">The user clicked the **Help** button.</span></span>                                                                                                                                                                                                                                                          |
| [<span data-ttu-id="318a5-312">**CDN \_ INCLUDEITEM**</span><span class="sxs-lookup"><span data-stu-id="318a5-312">**CDN\_INCLUDEITEM**</span></span>](cdn-includeitem.md)       | <span data-ttu-id="318a5-313">Determina se um item deve ser exibido.</span><span class="sxs-lookup"><span data-stu-id="318a5-313">Determines whether an item should be displayed.</span></span> <span data-ttu-id="318a5-314">Quando o usuário abre uma nova pasta ou diretório, o sistema envia essa notificação para cada item na pasta ou diretório.</span><span class="sxs-lookup"><span data-stu-id="318a5-314">When the user opens a new folder or directory, the system sends this notification for each item in the folder or directory.</span></span> <span data-ttu-id="318a5-315">O sistema enviará essa notificação somente se **o sinalizador OFN \_ ENABLEINCLUDENOTIFY** tiver sido definido.</span><span class="sxs-lookup"><span data-stu-id="318a5-315">The system sends this notification only if the **OFN\_ENABLEINCLUDENOTIFY** flag was set.</span></span>                          |
| [<span data-ttu-id="318a5-316">**CDN \_ INITDONE**</span><span class="sxs-lookup"><span data-stu-id="318a5-316">**CDN\_INITDONE**</span></span>](cdn-initdone.md)             | <span data-ttu-id="318a5-317">O sistema concluiu a inicialização da caixa de diálogo e a caixa de diálogo concluiu o processamento da mensagem [**WM \_ INITDIALOG.**](wm-initdialog.md)</span><span class="sxs-lookup"><span data-stu-id="318a5-317">The system has finished initializing the dialog box, and the dialog box has finished processing the [**WM\_INITDIALOG**](wm-initdialog.md) message.</span></span> <span data-ttu-id="318a5-318">Além disso, o sistema concluiu a organização de controles na caixa de diálogo comum para dar espaço aos controles da caixa de diálogo filho (se algum).</span><span class="sxs-lookup"><span data-stu-id="318a5-318">Also, the system has finished arranging controls in the common dialog box to make room for the controls of the child dialog box (if any).</span></span> |
| [<span data-ttu-id="318a5-319">**CDN \_ SELCHANGE**</span><span class="sxs-lookup"><span data-stu-id="318a5-319">**CDN\_SELCHANGE**</span></span>](cdn-selchange.md)           | <span data-ttu-id="318a5-320">O usuário selecionou um novo arquivo ou pasta na lista de arquivos.</span><span class="sxs-lookup"><span data-stu-id="318a5-320">The user selected a new file or folder from the file list.</span></span>                                                                                                                                                                                                                                     |
| [<span data-ttu-id="318a5-321">**COMPARTILHAMENTO \_ DE CDNVIOLATION**</span><span class="sxs-lookup"><span data-stu-id="318a5-321">**CDN\_SHAREVIOLATION**</span></span>](cdn-shareviolation.md) | <span data-ttu-id="318a5-322">A caixa de diálogo comum encontrou uma violação de compartilhamento no arquivo prestes a ser retornado.</span><span class="sxs-lookup"><span data-stu-id="318a5-322">The common dialog box encountered a sharing violation on the file about to be returned.</span></span>                                                                                                                                                                                                        |
| [<span data-ttu-id="318a5-323">**TYPECHANGE DA CDN \_**</span><span class="sxs-lookup"><span data-stu-id="318a5-323">**CDN\_TYPECHANGE**</span></span>](cdn-typechange.md)         | <span data-ttu-id="318a5-324">O usuário selecionou um novo tipo de arquivo na lista de tipos de arquivo.</span><span class="sxs-lookup"><span data-stu-id="318a5-324">The user selected a new file type from the list of file types.</span></span>                                                                                                                                                                                                                                 |



 

<span data-ttu-id="318a5-325">Essas [**mensagens WM \_ NOTIFY**](../controls/wm-notify.md) superam as mensagens registradas [**FILEOKSTRING**](fileokstring.md), [**LBSELCHSTRING,**](lbselchstring.md) [**SHAREVISTRING**](sharevistring.md)e [**HELPMSGSTRING**](helpmsgstring.md) usadas por versões anteriores das caixas de diálogo Abrir e Salvar **como.** </span><span class="sxs-lookup"><span data-stu-id="318a5-325">These [**WM\_NOTIFY**](../controls/wm-notify.md) messages supersede the [**FILEOKSTRING**](fileokstring.md), [**LBSELCHSTRING**](lbselchstring.md), [**SHAREVISTRING**](sharevistring.md), and [**HELPMSGSTRING**](helpmsgstring.md) registered messages used by previous versions of the **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="318a5-326">No entanto, o procedimento de gancho também receberá a mensagem sobressalo após a mensagem **WM \_ NOTIFY** se o processamento **WM \_ NOTIFY** não usar [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) para definir um valor **\_ MSGRESULT** de DWL não zero.</span><span class="sxs-lookup"><span data-stu-id="318a5-326">However, the hook procedure also receives the superseded message after the **WM\_NOTIFY** message if the **WM\_NOTIFY** processing does not use [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) to set a nonzero **DWL\_MSGRESULT** value.</span></span>

<span data-ttu-id="318a5-327">Para recuperar informações sobre o status da caixa de diálogo ou para controlar o comportamento e a aparência da caixa de diálogo, o procedimento de gancho pode enviar as mensagens a seguir para a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-327">To retrieve information about the status of the dialog box or to control the behavior and appearance of the dialog box, the hook procedure can send the following messages to the dialog box.</span></span>



| <span data-ttu-id="318a5-328">Mensagem</span><span class="sxs-lookup"><span data-stu-id="318a5-328">Message</span></span>                                             | <span data-ttu-id="318a5-329">Significado</span><span class="sxs-lookup"><span data-stu-id="318a5-329">Meaning</span></span>                                                                                                                                                                                                                  |
|-----------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="318a5-330">**CDM \_ GETFILEPATH**</span><span class="sxs-lookup"><span data-stu-id="318a5-330">**CDM\_GETFILEPATH**</span></span>](cdm-getfilepath.md)         | <span data-ttu-id="318a5-331">Recupera o caminho e o nome do arquivo selecionado.</span><span class="sxs-lookup"><span data-stu-id="318a5-331">Retrieves the path and file name of the selected file.</span></span>                                                                                                                                                                   |
| [<span data-ttu-id="318a5-332">**CDM \_ GETFOLDERIDLIST**</span><span class="sxs-lookup"><span data-stu-id="318a5-332">**CDM\_GETFOLDERIDLIST**</span></span>](cdm-getfolderidlist.md) | <span data-ttu-id="318a5-333">Recupera a lista de identificadores de item correspondente à pasta atual que a caixa de diálogo tem aberta.</span><span class="sxs-lookup"><span data-stu-id="318a5-333">Retrieves the item identifier list corresponding to the current folder that the dialog box has open.</span></span> <span data-ttu-id="318a5-334">Para obter mais informações sobre listas de identificadores de itens, consulte [Introduction to the Shell namespace](/windows/desktop/shell/namespace-intro).</span><span class="sxs-lookup"><span data-stu-id="318a5-334">For more information about item identifier lists, see [Introduction to the Shell Namespace](/windows/desktop/shell/namespace-intro).</span></span> |
| [<span data-ttu-id="318a5-335">**CDM \_ GETfolderpath**</span><span class="sxs-lookup"><span data-stu-id="318a5-335">**CDM\_GETFOLDERPATH**</span></span>](cdm-getfolderpath.md)     | <span data-ttu-id="318a5-336">Recupera o caminho da pasta ou diretório atual para a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-336">Retrieves the path of the current folder or directory for the dialog box.</span></span>                                                                                                                                                |
| [<span data-ttu-id="318a5-337">**CDM \_ GETspec**</span><span class="sxs-lookup"><span data-stu-id="318a5-337">**CDM\_GETSPEC**</span></span>](cdm-getspec.md)                 | <span data-ttu-id="318a5-338">Recupera o nome do arquivo (não incluindo o caminho) do arquivo selecionado no momento na caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-338">Retrieves the file name (not including the path) of the file currently selected in the dialog box.</span></span>                                                                                                                       |
| [<span data-ttu-id="318a5-339">**CDM \_ HIDECONTROL**</span><span class="sxs-lookup"><span data-stu-id="318a5-339">**CDM\_HIDECONTROL**</span></span>](cdm-hidecontrol.md)         | <span data-ttu-id="318a5-340">Oculta o controle especificado.</span><span class="sxs-lookup"><span data-stu-id="318a5-340">Hides the specified control.</span></span>                                                                                                                                                                                             |
| [<span data-ttu-id="318a5-341">**CDM \_ SETCONTROLTEXT**</span><span class="sxs-lookup"><span data-stu-id="318a5-341">**CDM\_SETCONTROLTEXT**</span></span>](cdm-setcontroltext.md)   | <span data-ttu-id="318a5-342">Define o texto no controle especificado.</span><span class="sxs-lookup"><span data-stu-id="318a5-342">Sets the text in the specified control.</span></span>                                                                                                                                                                                  |
| [<span data-ttu-id="318a5-343">**CDM \_ SETDEFEXT**</span><span class="sxs-lookup"><span data-stu-id="318a5-343">**CDM\_SETDEFEXT**</span></span>](cdm-setdefext.md)             | <span data-ttu-id="318a5-344">Define a extensão de nome de arquivo padrão para a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-344">Sets the default file name extension for the dialog box.</span></span>                                                                                                                                                                 |



 

## <a name="explorer-style-custom-templates"></a><span data-ttu-id="318a5-345">Explorer-Style modelos personalizados</span><span class="sxs-lookup"><span data-stu-id="318a5-345">Explorer-Style Custom Templates</span></span>

<span data-ttu-id="318a5-346">Para definir controles adicionais para uma caixa de diálogo **abrir** ou **salvar como** do estilo do Explorer, use a estrutura [**da OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) para especificar um modelo para uma caixa de diálogo filho que contenha os controles adicionais.</span><span class="sxs-lookup"><span data-stu-id="318a5-346">To define additional controls for an Explorer-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to specify a template for a child dialog box that contains the additional controls.</span></span> <span data-ttu-id="318a5-347">Se o seu modelo de caixa de diálogo filho for um recurso em um aplicativo ou em uma biblioteca de vínculo dinâmico, defina o sinalizador **OFN \_ ENABLETEMPLATE** no membro **flags** e use os membros **HINSTANCE** e **lpTemplateName** da estrutura para identificar o módulo e o nome do recurso.</span><span class="sxs-lookup"><span data-stu-id="318a5-347">If your child dialog template is a resource in an application or dynamic-link library, set the **OFN\_ENABLETEMPLATE** flag in the **Flags** member and use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span> <span data-ttu-id="318a5-348">Se o modelo já estiver na memória, defina o sinalizador **OFN \_ ENABLETEMPLATEHANDLE** e use o membro **HINSTANCE** para identificar o objeto de memória que contém o modelo.</span><span class="sxs-lookup"><span data-stu-id="318a5-348">If the template is already in memory, set the **OFN\_ENABLETEMPLATEHANDLE** flag and use the **hInstance** member to identify the memory object that contains the template.</span></span> <span data-ttu-id="318a5-349">Ao fornecer um modelo de diálogo filho para uma caixa de diálogo estilo de Gerenciador, você também deve definir o sinalizador **OFN \_ Explorer** ; caso contrário, o sistema pressupõe que você está fornecendo um modelo de substituição para uma caixa de diálogo estilo antigo.</span><span class="sxs-lookup"><span data-stu-id="318a5-349">When providing a child dialog template for an Explorer-style dialog box, you must also set the **OFN\_EXPLORER** flag; otherwise, the system assumes you are providing a replacement template for an old-style dialog box.</span></span> <span data-ttu-id="318a5-350">Normalmente, se você fornecer controles adicionais, também deverá fornecer um [procedimento de gancho de estilo de Explorer](#explorer-style-hook-procedures) para processar mensagens para os novos controles.</span><span class="sxs-lookup"><span data-stu-id="318a5-350">Typically, if you provide additional controls, you must also provide an [Explorer-style hook procedure](#explorer-style-hook-procedures) to process messages for the new controls.</span></span>

<span data-ttu-id="318a5-351">Você pode criar seu modelo de caixa de diálogo filho como qualquer outro modelo, exceto que você deve especificar os **estilos \_ WS Child** e **WS \_ CLIPSIBLINGS** e deve especificar os estilos de **\_ controle** **DS \_ 3DLOOK** e DS.</span><span class="sxs-lookup"><span data-stu-id="318a5-351">You can create your child dialog box template as you do any other template, except that you must specify the **WS\_CHILD** and **WS\_CLIPSIBLINGS** styles and should specify the **DS\_3DLOOK** and **DS\_CONTROL** styles.</span></span> <span data-ttu-id="318a5-352">O sistema requer o **estilo FILHO \_ do WS** porque seu modelo define uma caixa de diálogo filho da caixa de diálogo Padrão **Abrir** ou Salvar **como.**</span><span class="sxs-lookup"><span data-stu-id="318a5-352">The system requires the **WS\_CHILD** style because your template defines a child dialog of the default **Open** or **Save As** dialog box.</span></span> <span data-ttu-id="318a5-353">O **estilo WS \_ CLIPSIBLINGS** garante que a caixa de diálogo filho não pinta em nenhum dos controles na caixa de diálogo padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-353">The **WS\_CLIPSIBLINGS** style ensures that the child dialog box does not paint over any of the controls in the default dialog box.</span></span> <span data-ttu-id="318a5-354">O **estilo DS \_ 3DLOOK** garante que a aparência dos controles na caixa de diálogo filho seja consistente com os controles na caixa de diálogo padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-354">The **DS\_3DLOOK** style makes sure that the appearance of the controls in the child dialog box is consistent with the controls in the default dialog box.</span></span> <span data-ttu-id="318a5-355">O **estilo DS \_ CONTROL** garante que o usuário possa usar a TAB e outras chaves de navegação para se mover entre todos os controles, padrão ou personalizado, na caixa de diálogo personalizada.</span><span class="sxs-lookup"><span data-stu-id="318a5-355">The **DS\_CONTROL** style makes sure that the user can use the TAB and other navigation keys to move between all controls, default or custom, in the customized dialog box.</span></span>

<span data-ttu-id="318a5-356">Para dar espaço aos novos controles, o sistema expande a caixa de diálogo padrão pela largura e altura da caixa de diálogo personalizada.</span><span class="sxs-lookup"><span data-stu-id="318a5-356">To make room for the new controls, the system expands the default dialog box by the width and height of the custom dialog box.</span></span> <span data-ttu-id="318a5-357">Por padrão, todos os controles da caixa de diálogo personalizada são posicionados abaixo dos controles na caixa de diálogo padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-357">By default, all controls from the custom dialog box are positioned below the controls in the default dialog box.</span></span> <span data-ttu-id="318a5-358">No entanto, você pode substituir esse posicionamento padrão incluindo um controle de texto estático em seu modelo de caixa de diálogo personalizado e atribuindo a ele o valor do identificador de controle **stc32**.</span><span class="sxs-lookup"><span data-stu-id="318a5-358">However, you can override this default positioning by including a static text control in your custom dialog box template and assigning it the control identifier value of **stc32**.</span></span> <span data-ttu-id="318a5-359">(Esse valor é definido no arquivo de header Dlgs.h.) Nesse caso, o sistema usa o controle como ponto de referência para determinar onde posicionar os novos controles.</span><span class="sxs-lookup"><span data-stu-id="318a5-359">(This value is defined in the Dlgs.h header file.) In this case, the system uses the control as the point of reference for determining where to position the new controls.</span></span> <span data-ttu-id="318a5-360">Todos os novos controles acima e à esquerda do controle **stc32** são posicionados na mesma quantidade acima e à esquerda dos controles na caixa de diálogo padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-360">All new controls above and to the left of the **stc32** control are positioned the same amount above and to the left of the controls in the default dialog box.</span></span> <span data-ttu-id="318a5-361">Novos controles abaixo e à direita do **controle stc32** são posicionados abaixo e à direita dos controles padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-361">New controls below and to the right of the **stc32** control are positioned below and to the right of the default controls.</span></span> <span data-ttu-id="318a5-362">Em geral, cada novo controle é posicionado para que ele tenha a mesma posição em relação aos controles padrão que tinha com o **controle stc32.**</span><span class="sxs-lookup"><span data-stu-id="318a5-362">In general, each new control is positioned so that it has the same position relative to the default controls as it had to the **stc32** control.</span></span> <span data-ttu-id="318a5-363">Para dar espaço a esses novos controles, o sistema adiciona espaço à esquerda, à direita, à parte inferior e à parte superior da caixa de diálogo padrão, conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="318a5-363">To make room for these new controls, the system adds space to the left, right, bottom, and top of the default dialog box as needed.</span></span>

<span data-ttu-id="318a5-364">O sistema requer o procedimento de gancho para processar todas as mensagens destinadas à caixa de diálogo personalizada e, portanto, envia as mesmas mensagens de janela para o procedimento de gancho como qualquer outro procedimento de caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-364">The system requires the hook procedure to process all messages intended for the custom dialog box and therefore sends the same window messages to the hook procedure as to any other dialog box procedure.</span></span> <span data-ttu-id="318a5-365">Por exemplo, o procedimento de gancho recebe mensagens de [**\_ comando do WM**](/windows/desktop/menurc/wm-command) quando o usuário clica nos controles de botão na caixa de diálogo personalizada.</span><span class="sxs-lookup"><span data-stu-id="318a5-365">For example, the hook procedure receives [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) messages when the user clicks on button controls in the custom dialog box.</span></span> <span data-ttu-id="318a5-366">O procedimento de gancho é responsável por inicializar esses controles e recuperar valores dos controles quando a caixa de diálogo é fechada.</span><span class="sxs-lookup"><span data-stu-id="318a5-366">The hook procedure is responsible for initializing these controls and retrieving values from the controls when the dialog box is closed.</span></span> <span data-ttu-id="318a5-367">Observe que quando o procedimento de gancho recebe a mensagem [**\_ INITDIALOG do WM**](wm-initdialog.md) , o sistema ainda não moveu os controles para suas posições finais.</span><span class="sxs-lookup"><span data-stu-id="318a5-367">Note that when the hook procedure receives the [**WM\_INITDIALOG**](wm-initdialog.md) message, the system has not yet moved the controls to their final positions.</span></span>

<span data-ttu-id="318a5-368">O procedimento de caixa de diálogo padrão manipula mensagens para todos os controles na caixa de diálogo padrão, mas o procedimento de gancho recebe as mensagens de notificação para ações do usuário nesses controles, conforme descrito em [procedimentos de gancho no estilo do Explorer](#explorer-style-hook-procedures).</span><span class="sxs-lookup"><span data-stu-id="318a5-368">The default dialog box procedure handles messages for all the controls in the default dialog box, but the hook procedure receives the notification messages for user actions on these controls as described in [Explorer-Style Hook Procedures](#explorer-style-hook-procedures).</span></span>

## <a name="explorer-style-control-identifiers"></a><span data-ttu-id="318a5-369">Identificadores de controle de Explorer-Style</span><span class="sxs-lookup"><span data-stu-id="318a5-369">Explorer-Style Control Identifiers</span></span>

<span data-ttu-id="318a5-370">O SDK (Software Development Kit) do Windows fornece o modelo de caixa de diálogo padrão para as caixas de diálogo de estilo antigo, mas não inclui o modelo padrão para as caixas de diálogo de estilo de navegador.</span><span class="sxs-lookup"><span data-stu-id="318a5-370">The Windows Software Development Kit (SDK) provides the default dialog box template for the old-style dialog boxes, but does not include the default template for the Explorer-style dialog boxes.</span></span> <span data-ttu-id="318a5-371">Isso ocorre porque as caixas de diálogo do estilo Explorer permitem que você adicione seus próprios controles, mas não oferece suporte à modificação do modelo para os controles padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-371">This is because the Explorer-style dialog boxes allow you to add your own controls but do not support modifying the template for the standard controls.</span></span> <span data-ttu-id="318a5-372">No entanto, em alguns casos, talvez seja necessário saber os identificadores de controle usados nos modelos padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-372">However, in some cases, you may need to know the control identifiers used in the default templates.</span></span> <span data-ttu-id="318a5-373">Por exemplo, as mensagens [**CDM \_ HIDECONTROL**](cdm-hidecontrol.md) e [**CDM \_ SETCONTROLTEXT**](cdm-setcontroltext.md) exigem um identificador de controle.</span><span class="sxs-lookup"><span data-stu-id="318a5-373">For example, the [**CDM\_HIDECONTROL**](cdm-hidecontrol.md) and [**CDM\_SETCONTROLTEXT**](cdm-setcontroltext.md) messages require a control identifier.</span></span>

<span data-ttu-id="318a5-374">A tabela a seguir mostra os identificadores dos controles padrão nas caixas de diálogo **abrir** no estilo do Gerenciador e **salvar como** .</span><span class="sxs-lookup"><span data-stu-id="318a5-374">The following table shows the identifiers of the standard controls in the Explorer-style **Open** and **Save As** dialog boxes.</span></span> <span data-ttu-id="318a5-375">Os identificadores são constantes definidas em Dlgs. h e WinUser. h.</span><span class="sxs-lookup"><span data-stu-id="318a5-375">The identifiers are constants defined in Dlgs.h and Winuser.h.</span></span>



| <span data-ttu-id="318a5-376">Identificador de controle</span><span class="sxs-lookup"><span data-stu-id="318a5-376">Control identifier</span></span> | <span data-ttu-id="318a5-377">Descrição do controle</span><span class="sxs-lookup"><span data-stu-id="318a5-377">Control description</span></span>                                                                                                                                                                                                                                                                        |
|--------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="318a5-378">**chx1**</span><span class="sxs-lookup"><span data-stu-id="318a5-378">**chx1**</span></span>           | <span data-ttu-id="318a5-379">A caixa de seleção somente leitura</span><span class="sxs-lookup"><span data-stu-id="318a5-379">The read-only check box</span></span>                                                                                                                                                                                                                                                                    |
| <span data-ttu-id="318a5-380">**cmb1**</span><span class="sxs-lookup"><span data-stu-id="318a5-380">**cmb1**</span></span>           | <span data-ttu-id="318a5-381">Caixa de combinação suspensa que exibe a lista de filtros de tipo de arquivo</span><span class="sxs-lookup"><span data-stu-id="318a5-381">Drop-down combo box that displays the list of file type filters</span></span>                                                                                                                                                                                                                            |
| <span data-ttu-id="318a5-382">**stc2**</span><span class="sxs-lookup"><span data-stu-id="318a5-382">**stc2**</span></span>           | <span data-ttu-id="318a5-383">Rótulo da caixa de combinação **cmb1**</span><span class="sxs-lookup"><span data-stu-id="318a5-383">Label for the **cmb1** combo box</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="318a5-384">**cmb2**</span><span class="sxs-lookup"><span data-stu-id="318a5-384">**cmb2**</span></span>           | <span data-ttu-id="318a5-385">Caixa de combinação listada que exibe a unidade ou pasta atual e que permite que o usuário selecione uma unidade ou pasta para abrir</span><span class="sxs-lookup"><span data-stu-id="318a5-385">Drop-down combo box that displays the current drive or folder, and that allows the user to select a drive or folder to open</span></span>                                                                                                                                                                |
| <span data-ttu-id="318a5-386">**stc4**</span><span class="sxs-lookup"><span data-stu-id="318a5-386">**stc4**</span></span>           | <span data-ttu-id="318a5-387">Rótulo para a **caixa de combinação cmb2**</span><span class="sxs-lookup"><span data-stu-id="318a5-387">Label for the **cmb2** combo box</span></span>                                                                                                                                                                                                                                                           |
| <span data-ttu-id="318a5-388">**cmb13**</span><span class="sxs-lookup"><span data-stu-id="318a5-388">**cmb13**</span></span>          | <span data-ttu-id="318a5-389">Caixa de combinação listada que exibe o nome do arquivo atual, permite que o usuário digite o nome de um arquivo a ser aberto e selecione um arquivo que foi aberto ou salvo recentemente.</span><span class="sxs-lookup"><span data-stu-id="318a5-389">Drop-down combo box that displays the name of the current file, allows the user to type the name of a file to open, and select a file that has been opened or saved recently.</span></span> <span data-ttu-id="318a5-390">Isso é para aplicativos anteriores compatíveis com o Explorer sem gancho ou modelo de caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-390">This is for earlier Explorer-compatible applications without hook or dialog template.</span></span> <span data-ttu-id="318a5-391">Compare com **edt1.**</span><span class="sxs-lookup"><span data-stu-id="318a5-391">Compare with **edt1**.</span></span> |
| <span data-ttu-id="318a5-392">**edt1**</span><span class="sxs-lookup"><span data-stu-id="318a5-392">**edt1**</span></span>           | <span data-ttu-id="318a5-393">Controle de edição que exibe o nome do arquivo atual ou permite que o usuário digite o nome do arquivo a ser aberto.</span><span class="sxs-lookup"><span data-stu-id="318a5-393">Edit control that displays the name of the current file, or allows the user to type the name of the file to open.</span></span> <span data-ttu-id="318a5-394">Compare com **cmb13**.</span><span class="sxs-lookup"><span data-stu-id="318a5-394">Compare with **cmb13**.</span></span>                                                                                                                                                  |
| <span data-ttu-id="318a5-395">**stc3**</span><span class="sxs-lookup"><span data-stu-id="318a5-395">**stc3**</span></span>           | <span data-ttu-id="318a5-396">Rótulo para a **caixa de combinação cmb13** e o controle de edição edt1</span><span class="sxs-lookup"><span data-stu-id="318a5-396">Label for the **cmb13** combo box and the edt1 edit control</span></span>                                                                                                                                                                                                                                |
| <span data-ttu-id="318a5-397">**lst1**</span><span class="sxs-lookup"><span data-stu-id="318a5-397">**lst1**</span></span>           | <span data-ttu-id="318a5-398">Caixa de listagem que exibe o conteúdo da unidade ou pasta atual</span><span class="sxs-lookup"><span data-stu-id="318a5-398">List box that displays the contents of the current drive or folder</span></span>                                                                                                                                                                                                                         |
| <span data-ttu-id="318a5-399">**stc1**</span><span class="sxs-lookup"><span data-stu-id="318a5-399">**stc1**</span></span>           | <span data-ttu-id="318a5-400">Rótulo da caixa **de listagem lst1**</span><span class="sxs-lookup"><span data-stu-id="318a5-400">Label for the **lst1** list box</span></span>                                                                                                                                                                                                                                                            |
| <span data-ttu-id="318a5-401">**Idok**</span><span class="sxs-lookup"><span data-stu-id="318a5-401">**IDOK**</span></span>           | <span data-ttu-id="318a5-402">O **botão de** comando OK (botão de push)</span><span class="sxs-lookup"><span data-stu-id="318a5-402">The **OK** command button (push button)</span></span>                                                                                                                                                                                                                                                    |
| <span data-ttu-id="318a5-403">**Idcancel**</span><span class="sxs-lookup"><span data-stu-id="318a5-403">**IDCANCEL**</span></span>       | <span data-ttu-id="318a5-404">O botão de comando **Cancelar** (botão de ação)</span><span class="sxs-lookup"><span data-stu-id="318a5-404">The **Cancel** command button (push button)</span></span>                                                                                                                                                                                                                                                |
| <span data-ttu-id="318a5-405">**pshHelp**</span><span class="sxs-lookup"><span data-stu-id="318a5-405">**pshHelp**</span></span>        | <span data-ttu-id="318a5-406">O botão de comando **ajuda** (botão de ação)</span><span class="sxs-lookup"><span data-stu-id="318a5-406">The **Help** command button (push button)</span></span>                                                                                                                                                                                                                                                  |



 

## <a name="customizing-old-style-dialog-boxes"></a><span data-ttu-id="318a5-407">Personalizando caixas de diálogo de Old-Style</span><span class="sxs-lookup"><span data-stu-id="318a5-407">Customizing Old-Style Dialog Boxes</span></span>

<span data-ttu-id="318a5-408">Você pode personalizar uma caixa de diálogo **abrir** ou **salvar como** de estilo antigo, fornecendo um procedimento de gancho [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) que recebe mensagens ou notificações destinadas ao procedimento de caixa de diálogo padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-408">You can customize an old-style **Open** or **Save As** dialog box by providing an [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure that receives messages or notifications intended for the default dialog box procedure.</span></span> <span data-ttu-id="318a5-409">Você também pode fornecer um modelo personalizado para usar no lugar do modelo padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-409">You can also provide a custom template to use in place of the default template.</span></span> <span data-ttu-id="318a5-410">Os procedimentos de gancho e os modelos usados com as caixas de diálogo de estilo antigo são semelhantes aos usados com as outras caixas de diálogo comuns.</span><span class="sxs-lookup"><span data-stu-id="318a5-410">The hook procedures and templates used with the old-style dialog boxes are similar to those used with the other common dialog boxes.</span></span> <span data-ttu-id="318a5-411">Para obter mais informações, consulte [procedimentos de conexão para caixas de diálogo comuns](customizing-common-dialog-boxes.md) e [modelos personalizados](customizing-common-dialog-boxes.md).</span><span class="sxs-lookup"><span data-stu-id="318a5-411">For more information, see [Hook Procedures for Common Dialog Boxes](customizing-common-dialog-boxes.md) and [Custom Templates](customizing-common-dialog-boxes.md).</span></span>

<span data-ttu-id="318a5-412">Para habilitar um procedimento de gancho para uma caixa de diálogo **abrir** ou **salvar como** de estilo antigo, use a estrutura [**da OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) ao criar a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-412">To enable a hook procedure for an old-style **Open** or **Save As** dialog box, use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure when you create the dialog box.</span></span> <span data-ttu-id="318a5-413">Defina o **sinalizador OFN \_ ENABLEHOOK** no membro **flags** e especifique o endereço de um procedimento de gancho [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) no membro **lpfnHook** .</span><span class="sxs-lookup"><span data-stu-id="318a5-413">Set the **OFN\_ENABLEHOOK** flag in the **Flags** member and specify the address of an [*OFNHookProcOldStyle*](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure in the **lpfnHook** member.</span></span> <span data-ttu-id="318a5-414">O procedimento da caixa de diálogo envia uma mensagem do [**WM \_ INITDIALOG**](wm-initdialog.md) para o procedimento de gancho com o parâmetro *param* definido como o endereço da estrutura **da OPENFILENAME** usada para inicializar a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="318a5-414">The dialog box procedure sends a [**WM\_INITDIALOG**](wm-initdialog.md) message to the hook procedure with the *Param* parameter set to the address of the **OPENFILENAME** structure used to initialize the dialog box.</span></span>

<span data-ttu-id="318a5-415">Você pode usar a estrutura [**da OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) para especificar um modelo personalizado para a caixa de diálogo **abrir** ou **salvar como** a ser usada no lugar do modelo padrão.</span><span class="sxs-lookup"><span data-stu-id="318a5-415">You can use the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure to specify a custom template for the **Open** or **Save As** dialog box to use in place of the default template.</span></span> <span data-ttu-id="318a5-416">Se seu modelo personalizado for um recurso em um aplicativo ou em uma biblioteca de vínculo dinâmico, defina o sinalizador **OFN \_ ENABLETEMPLATE** no membro **flags** e use os membros **HINSTANCE** e **lpTemplateName** da estrutura para identificar o módulo e o nome do recurso.</span><span class="sxs-lookup"><span data-stu-id="318a5-416">If your custom template is a resource in an application or dynamic-link library, set the **OFN\_ENABLETEMPLATE** flag in the **Flags** member and use the **hInstance** and **lpTemplateName** members of the structure to identify the module and resource name.</span></span> <span data-ttu-id="318a5-417">Se o modelo personalizado já estiver na memória, defina o sinalizador **OFN \_ ENABLETEMPLATEHANDLE** e use o membro **HINSTANCE** para identificar o objeto de memória que contém o modelo.</span><span class="sxs-lookup"><span data-stu-id="318a5-417">If your custom template is already in memory, set the **OFN\_ENABLETEMPLATEHANDLE** flag and use the **hInstance** member to identify the memory object that contains the template.</span></span> <span data-ttu-id="318a5-418">Crie o modelo personalizado modificando o modelo padrão especificado no arquivo Fileopen.dlg.</span><span class="sxs-lookup"><span data-stu-id="318a5-418">Create the custom template by modifying the default template specified in the Fileopen.dlg file.</span></span> <span data-ttu-id="318a5-419">Os identificadores de controle usados nos modelos de caixa de diálogo Padrão De encontrar e substituir são definidos no arquivo Dlgs.h.</span><span class="sxs-lookup"><span data-stu-id="318a5-419">The control identifiers used in the default Find and Replace dialog templates are defined in the Dlgs.h file.</span></span>

<span data-ttu-id="318a5-420">Por padrão, as [**funções GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) e [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) exibem as caixas de diálogo no estilo Explorer.</span><span class="sxs-lookup"><span data-stu-id="318a5-420">By default, the [**GetOpenFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getopenfilenamea) and [**GetSaveFileName**](/windows/desktop/api/Commdlg/nf-commdlg-getsavefilenamea) functions display the Explorer-style dialog boxes.</span></span> <span data-ttu-id="318a5-421">Se você quiser exibir uma caixa de diálogo de estilo antigo, deverá fornecer um procedimento de gancho [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) e garantir que o sinalizador **OFN \_ EXPLORER** não está definido no membro **Flags** da estrutura [**OPENFILENAME.**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea)</span><span class="sxs-lookup"><span data-stu-id="318a5-421">If you want to display an old-style dialog box, you must provide an [**OFNHookProcOldStyle**](/previous-versions/windows/desktop/legacy/ms646932(v=vs.85)) hook procedure and ensure that the **OFN\_EXPLORER** flag is not set in the **Flags** member of the [**OPENFILENAME**](/windows/win32/api/commdlg/ns-commdlg-openfilenamea) structure.</span></span>

<span data-ttu-id="318a5-422">Se você definir o **sinalizador OFN \_ EXPLORER,** o sistema tratará um procedimento de gancho ou um modelo personalizado como uma personalização no estilo Explorer.</span><span class="sxs-lookup"><span data-stu-id="318a5-422">If you set the **OFN\_EXPLORER** flag, the system treats a hook procedure or custom template as an Explorer-style customization.</span></span> <span data-ttu-id="318a5-423">Para obter informações sobre como personalizar uma caixa de diálogo no estilo Explorer, consulte [Modelos personalizados no estilo explorer.](#explorer-style-custom-templates)</span><span class="sxs-lookup"><span data-stu-id="318a5-423">For information about customizing an Explorer-style dialog box, see [Explorer-Style Custom Templates](#explorer-style-custom-templates).</span></span>

## <a name="see-also"></a><span data-ttu-id="318a5-424">Confira também</span><span class="sxs-lookup"><span data-stu-id="318a5-424">See also</span></span>

* [<span data-ttu-id="318a5-425">O arquivo está em uso de exemplo</span><span class="sxs-lookup"><span data-stu-id="318a5-425">File is in use sample</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/appplatform/fileisinuse)