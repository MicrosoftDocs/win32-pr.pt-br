---
title: Caixa de diálogo Imprimir
description: A caixa de diálogo Imprimir permite que o usuário selecione opções para um trabalho de impressão específico.
ms.assetid: 34f69b25-8a89-4322-af4c-a80b85a4a973
keywords:
- Interface do usuário do Windows, entrada do usuário
- Interface do usuário do Windows, biblioteca de caixa de diálogo comum
- entrada do usuário, biblioteca de caixa de diálogo comum
- capturando entrada do usuário, biblioteca de caixa de diálogo comum
- Biblioteca de caixa de diálogo comum
- caixas de diálogo comuns
- caixa de diálogo Imprimir
- Caixa de diálogo Configurar impressão
- Personalizando a caixa de diálogo de impressão
- caixas de diálogo predefinidas
- caixas de diálogo, imprimir
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fae1dd244391ea16478a0cb4f10803cf622dc64
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104084872"
---
# <a name="print-dialog-box"></a><span data-ttu-id="dd569-114">Caixa de diálogo Imprimir</span><span class="sxs-lookup"><span data-stu-id="dd569-114">Print Dialog Box</span></span>

<span data-ttu-id="dd569-115">A caixa de diálogo **Imprimir** permite que o usuário selecione opções para um trabalho de impressão específico.</span><span class="sxs-lookup"><span data-stu-id="dd569-115">The **Print** dialog box lets the user select options for a particular print job.</span></span> <span data-ttu-id="dd569-116">Por exemplo, o usuário pode especificar a impressora a ser usada, o intervalo de páginas a ser impresso e o número de cópias.</span><span class="sxs-lookup"><span data-stu-id="dd569-116">For example, the user can specify the printer to use, the range of pages to print, and the number of copies.</span></span>

<span data-ttu-id="dd569-117">Você pode usar a função [**PRINTDLGEX**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) para exibir uma [folha de propriedades de impressão](print-property-sheet.md), que tem uma página **geral** contendo controles semelhantes à caixa de diálogo **Imprimir** .</span><span class="sxs-lookup"><span data-stu-id="dd569-117">You can use the [**PrintDlgEx**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) function to display a [Print Property Sheet](print-property-sheet.md), which has a **General** page containing controls similar to the **Print** dialog box.</span></span> <span data-ttu-id="dd569-118">A folha de propriedades também pode ter páginas de propriedades adicionais específicas do aplicativo e do driver, seguindo a página **geral** .</span><span class="sxs-lookup"><span data-stu-id="dd569-118">The property sheet can also have additional application-specific and driver-specific property pages following the **General** page.</span></span>

<span data-ttu-id="dd569-119">Você cria e exibe uma caixa de diálogo de **impressão** inicializando uma estrutura [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) e passando a estrutura para a função [**PRINTDLG**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="dd569-119">You create and display a **Print** dialog box by initializing a [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure and passing the structure to the [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function.</span></span>

<span data-ttu-id="dd569-120">A ilustração a seguir mostra uma caixa de diálogo de **impressão** típica.</span><span class="sxs-lookup"><span data-stu-id="dd569-120">The following illustration shows a typical **Print** dialog box.</span></span>

![caixa de diálogo Imprimir](images/printdialogboxxp.png)

<span data-ttu-id="dd569-122">Se o usuário clicar no botão **OK** , [**PRINTDLG**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) retornará **true** e usará a estrutura [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) para retornar informações sobre as seleções do usuário.</span><span class="sxs-lookup"><span data-stu-id="dd569-122">If the user clicks the **OK** button, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns **TRUE** and uses the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure to return information about the user's selections.</span></span> <span data-ttu-id="dd569-123">Por exemplo, os membros **hDevMode** e **hDevNames** normalmente retornam identificadores de memória global para estruturas e [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) .</span><span class="sxs-lookup"><span data-stu-id="dd569-123">For example, the **hDevMode** and **hDevNames** members typically return global memory handles for and [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structures.</span></span> <span data-ttu-id="dd569-124">Você pode usar as informações nessas estruturas para criar um contexto de dispositivo ou um contexto de informações para a impressora selecionada.</span><span class="sxs-lookup"><span data-stu-id="dd569-124">You can use the information in these structures to create a device context or an information context for the selected printer.</span></span>

<span data-ttu-id="dd569-125">Se o usuário cancelar a caixa de diálogo de **impressão** ou ocorrer um erro, [**PRINTDLG**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) retornará **false**.</span><span class="sxs-lookup"><span data-stu-id="dd569-125">If the user cancels the **Print** dialog box or an error occurs, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns **FALSE**.</span></span> <span data-ttu-id="dd569-126">Você pode determinar a causa de um erro usando a função [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) para recuperar o valor de erro estendido.</span><span class="sxs-lookup"><span data-stu-id="dd569-126">You can determine the cause of an error by using the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span>

<span data-ttu-id="dd569-127">A caixa de diálogo **Imprimir** inclui um grupo de **intervalos de impressão** de botões de opção que indicam se o usuário deseja imprimir todas as páginas, um intervalo de páginas ou apenas o texto selecionado.</span><span class="sxs-lookup"><span data-stu-id="dd569-127">The **Print** dialog box includes a **Print Range** group of radio buttons that indicate whether the user wants to print all pages, a range of pages, or only the selected text.</span></span> <span data-ttu-id="dd569-128">Antes de chamar [**PRINTDLG**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)), você pode definir um dos sinalizadores **PD \_**, seleção de **PD \_** ou **PD \_ PAGENUMS** para indicar qual botão está inicialmente selecionado.</span><span class="sxs-lookup"><span data-stu-id="dd569-128">Before calling [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)), you can set one of the **PD\_ALLPAGES**, **PD\_SELECTION**, or **PD\_PAGENUMS** flags to indicate which button is initially selected.</span></span> <span data-ttu-id="dd569-129">Quando **PRINTDLG** retorna **true**, a função define um desses sinalizadores para indicar as seleções do usuário.</span><span class="sxs-lookup"><span data-stu-id="dd569-129">When **PrintDlg** returns **TRUE**, the function sets one of these flags to indicate the user's selections.</span></span> <span data-ttu-id="dd569-130">Se **PD \_ PAGENUMS** for definido, os membros **nFromPage** e **nToPage** da estrutura [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) conterão as páginas inicial e final especificadas pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="dd569-130">If **PD\_PAGENUMS** is set, the **nFromPage** and **nToPage** members of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure contain the starting and ending pages specified by the user.</span></span> <span data-ttu-id="dd569-131">Para desabilitar o botão de opção **páginas** e seu associado **de** e **para** editar controles, defina o sinalizador **PD \_ NOPAGENUMS** .</span><span class="sxs-lookup"><span data-stu-id="dd569-131">To disable the **Pages** radio button and its associated **From** and **To** edit controls, set the **PD\_NOPAGENUMS** flag.</span></span> <span data-ttu-id="dd569-132">Para desabilitar o botão de opção **seleção** , defina o sinalizador **PD \_ noseleções** .</span><span class="sxs-lookup"><span data-stu-id="dd569-132">To disable the **Selection** radio button, set the **PD\_NOSELECTION** flag.</span></span>

<span data-ttu-id="dd569-133">A caixa de diálogo inclui um controle de edição no qual o usuário pode digitar o número de cópias a serem impressas.</span><span class="sxs-lookup"><span data-stu-id="dd569-133">The dialog box includes an edit control in which the user can type the number of copies to print.</span></span> <span data-ttu-id="dd569-134">Se o membro **hDevMode** da estrutura [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) for não **nulo**, o membro **dmCopies** da estrutura especificará o valor inicial para esse controle de edição.</span><span class="sxs-lookup"><span data-stu-id="dd569-134">If the **hDevMode** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure is non-**NULL**, the **dmCopies** member of the structure specifies the initial value for this edit control.</span></span> <span data-ttu-id="dd569-135">Se **hDevMode** for **NULL**, o membro **nCopies** da estrutura **PRINTDLG** especificará o valor inicial.</span><span class="sxs-lookup"><span data-stu-id="dd569-135">If **hDevMode** is **NULL**, the **nCopies** member of the **PRINTDLG** structure specifies the initial value.</span></span> <span data-ttu-id="dd569-136">Quando [**PRINTDLG**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) retorna, **nCopies** normalmente indica o número de cópias especificado pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="dd569-136">When [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns, **nCopies** typically indicates the number of copies specified by the user.</span></span> <span data-ttu-id="dd569-137">No entanto, se você definir o sinalizador **PD \_ USEDEVMODECOPIESANDCOLLATE** ao criar a caixa de diálogo, **nCopies** será sempre definido como 1 no retorno e o membro **dmCopies** de [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) indicará o número de cópias a serem impressas.</span><span class="sxs-lookup"><span data-stu-id="dd569-137">However, if you set the **PD\_USEDEVMODECOPIESANDCOLLATE** flag when you create the dialog box, **nCopies** is always set to 1 on return and the **dmCopies** member of [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) indicates the number of copies to print.</span></span>

<span data-ttu-id="dd569-138">A caixa de seleção **Agrupar** indica se o usuário deseja agrupar as páginas se várias cópias estiverem sendo impressas.</span><span class="sxs-lookup"><span data-stu-id="dd569-138">The **Collate** check box indicates whether the user wants to collate the pages if multiple copies are being printed.</span></span> <span data-ttu-id="dd569-139">O sinalizador de **\_ agrupamento PD** será definido se a caixa de seleção **Agrupar** estiver marcada.</span><span class="sxs-lookup"><span data-stu-id="dd569-139">The **PD\_COLLATE** flag is set if the **Collate** check box is selected.</span></span> <span data-ttu-id="dd569-140">Se seu aplicativo não oferecer suporte a várias cópias ou agrupamento simulado, defina o sinalizador **PD \_ USEDEVMODECOPIESANDCOLLATE** no membro **flags** da estrutura [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) .</span><span class="sxs-lookup"><span data-stu-id="dd569-140">If your application does not support multiple copies or simulated collation, set the **PD\_USEDEVMODECOPIESANDCOLLATE** flag in the **Flags** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span> <span data-ttu-id="dd569-141">Isso desabilita a caixa de seleção **Agrupar** e o **número de cópias** Editar controle, a menos que o driver de impressora dê suporte a várias cópias e agrupamento.</span><span class="sxs-lookup"><span data-stu-id="dd569-141">This disables the **Collate** check box and the **Number of Copies** edit control unless the printer driver supports multiple copies and collation.</span></span>

<span data-ttu-id="dd569-142">A caixa de seleção **Imprimir em arquivo** indica se o usuário deseja enviar a saída para um arquivo em vez de para uma impressora.</span><span class="sxs-lookup"><span data-stu-id="dd569-142">The **Print To File** check box indicates whether the user wants to send output to a file rather than to a printer.</span></span> <span data-ttu-id="dd569-143">Você pode definir o sinalizador **PD \_ PRINTTOFILE** para que a caixa de seleção seja selecionada inicialmente.</span><span class="sxs-lookup"><span data-stu-id="dd569-143">You can set the **PD\_PRINTTOFILE** flag so the check box is initially selected.</span></span> <span data-ttu-id="dd569-144">Para ocultar a caixa de seleção, defina o sinalizador **PD \_ HIDEPRINTTOFILE** .</span><span class="sxs-lookup"><span data-stu-id="dd569-144">To hide the check box, set the **PD\_HIDEPRINTTOFILE** flag.</span></span> <span data-ttu-id="dd569-145">Para desabilitá-lo, defina o sinalizador **PD \_ DISABLEPRINTTOFILE** .</span><span class="sxs-lookup"><span data-stu-id="dd569-145">To disable it, set the **PD\_DISABLEPRINTTOFILE** flag.</span></span> <span data-ttu-id="dd569-146">Se o usuário selecionar a opção **Imprimir em arquivo** , [**PRINTDLG**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) definirá o sinalizador **PD \_ PRINTTOFILE** e retornará "file:" no deslocamento indicado pelo membro **wOutputOffset** da estrutura [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) .</span><span class="sxs-lookup"><span data-stu-id="dd569-146">If the user selects the **Print To File** option, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) sets the **PD\_PRINTTOFILE** flag and returns "FILE:" at the offset indicated by the **wOutputOffset** member of the [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure.</span></span> <span data-ttu-id="dd569-147">Quando você chamar a função para iniciar a operação de impressão, especifique essa cadeia de caracteres "FILE:" no membro **lpszOutput** da estrutura.</span><span class="sxs-lookup"><span data-stu-id="dd569-147">When you call the function to start the printing operation, specify this "FILE:" string in the **lpszOutput** member of the structure.</span></span> <span data-ttu-id="dd569-148">A especificação dessa cadeia de caracteres faz com que o subsistema de impressão consulte o usuário para obter o nome do arquivo de saída.</span><span class="sxs-lookup"><span data-stu-id="dd569-148">Specifying this string causes the print subsystem to query the user for the name of the output file.</span></span>

<span data-ttu-id="dd569-149">Por padrão, a caixa de diálogo **Imprimir** inicialmente exibe informações sobre a impressora padrão atual.</span><span class="sxs-lookup"><span data-stu-id="dd569-149">By default, the **Print** dialog box initially displays information about the current default printer.</span></span> <span data-ttu-id="dd569-150">Para exibir informações de outra impressora instalada, inicialize a e uma estrutura [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) e atribua o identificador de memória global à estrutura para os membros **hDevMode** e **hDevNames** .</span><span class="sxs-lookup"><span data-stu-id="dd569-150">To display information for another installed printer, initialize a and a [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure and assign the global memory handle to the structure to the **hDevMode** and **hDevNames** members.</span></span> <span data-ttu-id="dd569-151">O nome do dispositivo que você especifica no membro **dmDeviceName** da estrutura [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) e no membro **wDriverOffset** da estrutura **DEVNAMES** deve identificar um dispositivo de impressora que também esteja listado na \[ \] seção dispositivos do arquivo Win.ini.</span><span class="sxs-lookup"><span data-stu-id="dd569-151">The device name you specify in the **dmDeviceName** member of the [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) structure and in the **wDriverOffset** member of the **DEVNAMES** structure must identify a printer device that is also listed in the \[Devices\] section of the Win.ini file.</span></span> <span data-ttu-id="dd569-152">Se o dispositivo não estiver listado, [**PRINTDLG**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) retornará um erro.</span><span class="sxs-lookup"><span data-stu-id="dd569-152">If the device is not listed, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns an error.</span></span>

<span data-ttu-id="dd569-153">Você pode direcionar o [**PRINTDLG**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) para criar um contexto de dispositivo ou um contexto de informações para a impressora, definindo o sinalizador de **\_ retorno** de **PD \_ RETURNDC** ou PD no membro **flags** da estrutura [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) .</span><span class="sxs-lookup"><span data-stu-id="dd569-153">You can direct [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) to create a device context or information context for the printer by setting the **PD\_RETURNDC** or **PD\_RETURNIC** flag in the **Flags** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span> <span data-ttu-id="dd569-154">A função retorna um identificador para o contexto do dispositivo ou o contexto de informações no membro **HDC** .</span><span class="sxs-lookup"><span data-stu-id="dd569-154">The function returns a handle to the device context or information context in the **hDC** member.</span></span> <span data-ttu-id="dd569-155">Se você usar o sinalizador **PD \_ RETURNDC** , poderá usar o contexto do dispositivo para gerar a saída para a impressora.</span><span class="sxs-lookup"><span data-stu-id="dd569-155">If you use the **PD\_RETURNDC** flag, you can use the device context to generate output for the printer.</span></span>

<span data-ttu-id="dd569-156">Para recuperar informações sobre a impressora padrão sem exibir a caixa de diálogo **Imprimir** , defina o sinalizador **PD \_ RETURNDEFAULT** .</span><span class="sxs-lookup"><span data-stu-id="dd569-156">To retrieve information about the default printer without displaying the **Print** dialog box, set the **PD\_RETURNDEFAULT** flag.</span></span> <span data-ttu-id="dd569-157">Nesse caso, [**PRINTDLG**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) retorna imediatamente após a definição dos membros **hDevMode** e **hDevNames** como identificadores para estruturas que contêm as informações.</span><span class="sxs-lookup"><span data-stu-id="dd569-157">In this case, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) returns immediately after setting the **hDevMode** and **hDevNames** members to handles for structures containing the information.</span></span>

<span data-ttu-id="dd569-158">Por padrão, o [**PRINTDLG**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) exibe caixas de mensagens quando ocorrem erros.</span><span class="sxs-lookup"><span data-stu-id="dd569-158">By default, [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) displays message boxes when errors occur.</span></span> <span data-ttu-id="dd569-159">Por exemplo, a função exibirá uma mensagem de erro se nenhuma impressora estiver instalada.</span><span class="sxs-lookup"><span data-stu-id="dd569-159">For example, the function displays an error message if no printers are installed.</span></span> <span data-ttu-id="dd569-160">Para impedir que a função exiba essas mensagens de aviso, defina o sinalizador **PD \_ nowarning** .</span><span class="sxs-lookup"><span data-stu-id="dd569-160">To prevent the function from displaying these warning messages, set the **PD\_NOWARNING** flag.</span></span>

<span data-ttu-id="dd569-161">Os tópicos a seguir são discutidos nesta seção.</span><span class="sxs-lookup"><span data-stu-id="dd569-161">The following topics are discussed in this section.</span></span>

-   [<span data-ttu-id="dd569-162">Personalizando a caixa de diálogo Imprimir</span><span class="sxs-lookup"><span data-stu-id="dd569-162">Customizing the Print Dialog Box</span></span>](#customizing-the-print-dialog-box)
-   [<span data-ttu-id="dd569-163">Caixa de diálogo Configurar impressão</span><span class="sxs-lookup"><span data-stu-id="dd569-163">Print Setup Dialog Box</span></span>](#print-setup-dialog-box)

## <a name="customizing-the-print-dialog-box"></a><span data-ttu-id="dd569-164">Personalizando a caixa de diálogo Imprimir</span><span class="sxs-lookup"><span data-stu-id="dd569-164">Customizing the Print Dialog Box</span></span>

<span data-ttu-id="dd569-165">Você pode fornecer um modelo personalizado para a caixa de diálogo **Imprimir** , por exemplo, se desejar incluir controles adicionais que sejam exclusivos para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="dd569-165">You can provide a custom template for the **Print** dialog box, for example, if you want to include additional controls that are unique to your application.</span></span> <span data-ttu-id="dd569-166">A função [**PRINTDLG**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) usa o modelo personalizado no lugar do modelo padrão.</span><span class="sxs-lookup"><span data-stu-id="dd569-166">The [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function uses your custom template in place of the default template.</span></span>

<span data-ttu-id="dd569-167">Para fornecer um modelo personalizado para a caixa de diálogo **Imprimir** :</span><span class="sxs-lookup"><span data-stu-id="dd569-167">To provide a custom template for the **Print** dialog box:</span></span>

1.  <span data-ttu-id="dd569-168">Crie o modelo personalizado modificando o modelo padrão especificado no arquivo Prnsetup. Dlg.</span><span class="sxs-lookup"><span data-stu-id="dd569-168">Create the custom template by modifying the default template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="dd569-169">Os identificadores de controle usados no modelo de caixa de diálogo de **impressão** padrão são definidos no arquivo Dlgs. h.</span><span class="sxs-lookup"><span data-stu-id="dd569-169">The control identifiers used in the default **Print** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="dd569-170">Use a estrutura [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) para habilitar o modelo da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="dd569-170">Use the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure to enable the template as follows:</span></span>
    -   <span data-ttu-id="dd569-171">Se o modelo personalizado for um recurso em um aplicativo ou em uma biblioteca de vínculo dinâmico, defina o sinalizador **PD \_ ENABLEPRINTTEMPLATE** no membro **flags** .</span><span class="sxs-lookup"><span data-stu-id="dd569-171">If your custom template is a resource in an application or dynamic-link library, set the **PD\_ENABLEPRINTTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="dd569-172">Use os membros **HINSTANCE** e **lpPrintTemplateName** da estrutura para identificar o módulo e o nome do recurso.</span><span class="sxs-lookup"><span data-stu-id="dd569-172">Use the **hInstance** and **lpPrintTemplateName** members of the structure to identify the module and resource name.</span></span>

        <span data-ttu-id="dd569-173">-Ou-</span><span class="sxs-lookup"><span data-stu-id="dd569-173">-Or-</span></span>

    -   <span data-ttu-id="dd569-174">Se o modelo personalizado já estiver na memória, defina o sinalizador **PD \_ ENABLEPRINTTEMPLATEHANDLE** .</span><span class="sxs-lookup"><span data-stu-id="dd569-174">If your custom template is already in memory, set the **PD\_ENABLEPRINTTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="dd569-175">Use o membro **hPrintTemplate** para identificar o objeto de memória que contém o modelo.</span><span class="sxs-lookup"><span data-stu-id="dd569-175">Use the **hPrintTemplate** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="dd569-176">Você pode fornecer um procedimento de gancho [**PrintHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpprinthookproc) para a caixa de diálogo **Imprimir** .</span><span class="sxs-lookup"><span data-stu-id="dd569-176">You can provide a [**PrintHookProc**](/windows/win32/api/commdlg/nc-commdlg-lpprinthookproc) hook procedure for the **Print** dialog box.</span></span> <span data-ttu-id="dd569-177">O procedimento de gancho pode processar mensagens enviadas para a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="dd569-177">The hook procedure can process messages sent to the dialog box.</span></span> <span data-ttu-id="dd569-178">Ele também pode enviar mensagens para a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="dd569-178">It can also send messages to the dialog box.</span></span> <span data-ttu-id="dd569-179">Se você usar um modelo personalizado para definir controles adicionais, deverá fornecer um procedimento de gancho para processar a entrada para seus controles.</span><span class="sxs-lookup"><span data-stu-id="dd569-179">If you use a custom template to define additional controls, you must provide a hook procedure to process input for your controls.</span></span>

<span data-ttu-id="dd569-180">Para habilitar um procedimento de gancho para a caixa de diálogo **Imprimir** :</span><span class="sxs-lookup"><span data-stu-id="dd569-180">To enable a hook procedure for the **Print** dialog box:</span></span>

1.  <span data-ttu-id="dd569-181">Defina o sinalizador **PD \_ ENABLEPRINTHOOK** no membro **flags** da estrutura [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) .</span><span class="sxs-lookup"><span data-stu-id="dd569-181">Set the **PD\_ENABLEPRINTHOOK** flag in the **Flags** member of the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure.</span></span>
2.  <span data-ttu-id="dd569-182">Especifique o endereço do procedimento de gancho no membro **lpfnPrintHook** .</span><span class="sxs-lookup"><span data-stu-id="dd569-182">Specify the address of the hook procedure in the **lpfnPrintHook** member.</span></span>

<span data-ttu-id="dd569-183">Depois de processar sua mensagem do [**WM \_ INITDIALOG**](wm-initdialog.md) , o procedimento da caixa de diálogo envia uma mensagem do **WM \_ INITDIALOG** para o procedimento de gancho.</span><span class="sxs-lookup"><span data-stu-id="dd569-183">After processing its [**WM\_INITDIALOG**](wm-initdialog.md) message, the dialog box procedure sends a **WM\_INITDIALOG** message to the hook procedure.</span></span> <span data-ttu-id="dd569-184">O parâmetro *lParam* dessa mensagem é um ponteiro para a estrutura [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) usada para inicializar a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="dd569-184">The *lParam* parameter of this message is a pointer to the [**PRINTDLG**](/windows/win32/api/commdlg/ns-commdlg-printdlga) structure used to initialize the dialog box.</span></span>

## <a name="print-setup-dialog-box"></a><span data-ttu-id="dd569-185">Caixa de diálogo Configurar impressão</span><span class="sxs-lookup"><span data-stu-id="dd569-185">Print Setup Dialog Box</span></span>

<span data-ttu-id="dd569-186">Você pode criar e exibir uma caixa de diálogo de **configuração de impressão** definindo o sinalizador de **\_ metaconfiguração de PD** em uma chamada para a função [**PRINTDLG**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="dd569-186">You can create and display a **Print Setup** dialog box by setting the **PD\_PRINTSETUP** flag in a call to the [**PrintDlg**](/previous-versions/windows/desktop/legacy/ms646940(v=vs.85)) function.</span></span> <span data-ttu-id="dd569-187">No entanto, a caixa de diálogo **configuração de impressão** foi substituída pela caixa de diálogo **Configurar página** e não deve ser usada em novos aplicativos.</span><span class="sxs-lookup"><span data-stu-id="dd569-187">However, the **Print Setup** dialog box has been superseded by the **Page Setup** dialog box and should not be used in new applications.</span></span>

<span data-ttu-id="dd569-188">Os sinalizadores a seguir se aplicam somente à caixa de diálogo **configuração de impressão** :</span><span class="sxs-lookup"><span data-stu-id="dd569-188">The following flags apply only to the **Print Setup** dialog box:</span></span>

-   <span data-ttu-id="dd569-189">**\_ENABLESETUPHOOK PD**</span><span class="sxs-lookup"><span data-stu-id="dd569-189">**PD\_ENABLESETUPHOOK**</span></span>
-   <span data-ttu-id="dd569-190">**\_ENABLESETUPTEMPLATE PD**</span><span class="sxs-lookup"><span data-stu-id="dd569-190">**PD\_ENABLESETUPTEMPLATE**</span></span>
-   <span data-ttu-id="dd569-191">**\_ENABLESETUPTEMPLATEHANDLE PD**</span><span class="sxs-lookup"><span data-stu-id="dd569-191">**PD\_ENABLESETUPTEMPLATEHANDLE**</span></span>

 

 