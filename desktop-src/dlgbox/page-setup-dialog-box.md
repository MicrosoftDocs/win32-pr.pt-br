---
title: Caixa de diálogo Configurar Página
description: Exibe uma caixa de diálogo modal que permite ao usuário escolher as configurações que incluem o tipo de papel, a origem do papel, a orientação da página e a largura das margens da página.
ms.assetid: debde0a0-07d4-46ed-a936-e517eab1852d
keywords:
- Interface do usuário do Windows, entrada do usuário
- Interface do usuário do Windows, biblioteca de caixa de diálogo comum
- entrada do usuário, biblioteca de caixa de diálogo comum
- capturando entrada do usuário, biblioteca de caixa de diálogo comum
- Biblioteca de caixa de diálogo comum
- caixas de diálogo comuns
- caixa de diálogo Configurar Página
- Personalizando a caixa de diálogo configuração de página
- ganchos, caixa de diálogo configuração de página
- caixas de diálogo predefinidas
- caixas de diálogo, configuração de página
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a4b9a8f7f30a8313017dc3a124cdccb7d00c872b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104084873"
---
# <a name="page-setup-dialog-box"></a><span data-ttu-id="848ec-114">Caixa de diálogo Configurar Página</span><span class="sxs-lookup"><span data-stu-id="848ec-114">Page Setup Dialog Box</span></span>

<span data-ttu-id="848ec-115">Exibe uma caixa de diálogo modal que permite ao usuário definir os seguintes atributos da página impressa:</span><span class="sxs-lookup"><span data-stu-id="848ec-115">Displays a modal dialog box that allows the user to set the following attributes of the printed page:</span></span>

-   <span data-ttu-id="848ec-116">O tipo de papel (envelope, ofício, carta e assim por diante)</span><span class="sxs-lookup"><span data-stu-id="848ec-116">The paper type (envelope, legal, letter, and so on)</span></span>
-   <span data-ttu-id="848ec-117">A fonte de papel (alimentação manual, feed de tratores, alimentador de planilha e assim por diante)</span><span class="sxs-lookup"><span data-stu-id="848ec-117">The paper source (manual feed, tractor feed, sheet feeder, and so on)</span></span>
-   <span data-ttu-id="848ec-118">A orientação da página (retrato ou paisagem)</span><span class="sxs-lookup"><span data-stu-id="848ec-118">The page orientation (portrait or landscape)</span></span>
-   <span data-ttu-id="848ec-119">A largura das margens da página</span><span class="sxs-lookup"><span data-stu-id="848ec-119">The width of the page margins</span></span>

<span data-ttu-id="848ec-120">Você cria e exibe uma caixa de diálogo de **configuração de página** inicializando uma estrutura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) e passando a estrutura para a função [**PAGESETUPDLG**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="848ec-120">You create and display a **Page Setup** dialog box by initializing a [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure and passing the structure to the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function.</span></span> <span data-ttu-id="848ec-121">No entanto, os atributos apresentados na caixa de diálogo variam de acordo com os recursos da impressora.</span><span class="sxs-lookup"><span data-stu-id="848ec-121">However, the attributes presented in the dialog box vary, depending on the capabilities of the printer.</span></span> <span data-ttu-id="848ec-122">A ilustração a seguir mostra uma caixa de diálogo de **configuração de página** típica.</span><span class="sxs-lookup"><span data-stu-id="848ec-122">The following illustration shows a typical **Page Setup** dialog box.</span></span>

![caixa de diálogo Configurar página](images/pagesetupdialogboxxp.png)

<span data-ttu-id="848ec-124">Se o usuário clicar no botão **OK** , [**PAGESETUPDLG**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) retornará **true** depois de definir vários membros na estrutura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) para especificar as seleções do usuário.</span><span class="sxs-lookup"><span data-stu-id="848ec-124">If the user clicks the **OK** button, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) returns **TRUE** after setting various members in the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure to specify the user's selections.</span></span> <span data-ttu-id="848ec-125">Os membros **ptPaperSize** e **rtMargin** contêm os valores especificados pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="848ec-125">The **ptPaperSize** and **rtMargin** members contain the values specified by the user.</span></span> <span data-ttu-id="848ec-126">Os membros **hDevMode** e **hDevNames** contêm identificadores de memória global para as estruturas [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) e [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) .</span><span class="sxs-lookup"><span data-stu-id="848ec-126">The **hDevMode** and **hDevNames** members contain global memory handles for the [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) and [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structures.</span></span> <span data-ttu-id="848ec-127">Essas estruturas contêm informações de página adicionais, bem como informações sobre a impressora.</span><span class="sxs-lookup"><span data-stu-id="848ec-127">These structures contain additional page information as well as information about the printer.</span></span> <span data-ttu-id="848ec-128">Você pode usar essas informações para preparar a saída a ser enviada para a impressora selecionada.</span><span class="sxs-lookup"><span data-stu-id="848ec-128">You can use this information to prepare the output to be sent to the selected printer.</span></span>

<span data-ttu-id="848ec-129">Se o usuário cancelar a caixa de diálogo de **configuração de página** ou ocorrer um erro, [**PAGESETUPDLG**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) retornará **false**.</span><span class="sxs-lookup"><span data-stu-id="848ec-129">If the user cancels the **Page Setup** dialog box or an error occurs, [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) returns **FALSE**.</span></span> <span data-ttu-id="848ec-130">Para determinar a causa do erro, chame a função [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) para recuperar o valor de erro estendido.</span><span class="sxs-lookup"><span data-stu-id="848ec-130">To determine the cause of the error, call the [**CommDlgExtendedError**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) function to retrieve the extended error value.</span></span>

<span data-ttu-id="848ec-131">Esta seção aborda os tópicos a seguir.</span><span class="sxs-lookup"><span data-stu-id="848ec-131">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="848ec-132">Inicializando a caixa de diálogo Configurar página</span><span class="sxs-lookup"><span data-stu-id="848ec-132">Initializing the Page Setup Dialog Box</span></span>](#initializing-the-page-setup-dialog-box)
-   [<span data-ttu-id="848ec-133">Personalizando a caixa de diálogo Configurar página</span><span class="sxs-lookup"><span data-stu-id="848ec-133">Customizing the Page Setup Dialog Box</span></span>](#customizing-the-page-setup-dialog-box)
-   [<span data-ttu-id="848ec-134">Personalizando a página de exemplo</span><span class="sxs-lookup"><span data-stu-id="848ec-134">Customizing the Sample Page</span></span>](#customizing-the-sample-page)

## <a name="initializing-the-page-setup-dialog-box"></a><span data-ttu-id="848ec-135">Inicializando a caixa de diálogo Configurar página</span><span class="sxs-lookup"><span data-stu-id="848ec-135">Initializing the Page Setup Dialog Box</span></span>

<span data-ttu-id="848ec-136">Por padrão, a caixa de diálogo **Configurar página** exibe informações sobre a impressora padrão atual.</span><span class="sxs-lookup"><span data-stu-id="848ec-136">By default, the **Page Setup** dialog box displays information about the current default printer.</span></span> <span data-ttu-id="848ec-137">Para direcionar a caixa de diálogo para exibir informações sobre uma impressora específica, defina os membros de uma estrutura [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) ou [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) e atribua os identificadores de memória global dessas estruturas ao membro correspondente no [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga).</span><span class="sxs-lookup"><span data-stu-id="848ec-137">To direct the dialog box to display information about a specific printer, set the members of a [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) or [**DEVNAMES**](/windows/win32/api/commdlg/ns-commdlg-devnames) structure and assign the global memory handles of these structures to the corresponding member in [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga).</span></span> <span data-ttu-id="848ec-138">Se você especificar o nome de uma impressora que não está instalada atualmente, a caixa de diálogo exibirá uma mensagem de erro.</span><span class="sxs-lookup"><span data-stu-id="848ec-138">If you specify the name of a printer that is not currently installed, the dialog box displays an error message.</span></span> <span data-ttu-id="848ec-139">Para impedir que a caixa de diálogo exiba mensagens de erro, use o valor de **\_ nowarning do PSD** .</span><span class="sxs-lookup"><span data-stu-id="848ec-139">To prevent the dialog box from displaying error messages, use the **PSD\_NOWARNING** value.</span></span> <span data-ttu-id="848ec-140">Para recuperar informações sobre a impressora padrão sem exibir a caixa de diálogo **Configurar página** , use o valor **\_ RETURNDEFAULT do PSD** .</span><span class="sxs-lookup"><span data-stu-id="848ec-140">To retrieve information about the default printer without displaying the **Page Setup** dialog box, use the **PSD\_RETURNDEFAULT** value.</span></span>

<span data-ttu-id="848ec-141">Se o sistema de medidas padrão for polegadas, a caixa de diálogo usará milésimos de polegadas como a unidade de medida padrão.</span><span class="sxs-lookup"><span data-stu-id="848ec-141">If the default measurement system is inches, the dialog box uses thousandths of inches as the default unit of measurement.</span></span> <span data-ttu-id="848ec-142">Se o sistema de medidas padrão for a métrica, a caixa de diálogo usará centésimos de milímetros como a unidade de medida padrão.</span><span class="sxs-lookup"><span data-stu-id="848ec-142">If the default measurement system is metric, the dialog box uses hundredths of millimeters as the default unit of measurement.</span></span> <span data-ttu-id="848ec-143">Para substituir a unidade de medida padrão, defina o **sinalizador \_ PSD INHUNDREDTHSOFMILLIMETERS** ou **\_ INTHOUSANDTHSOFINCHES PSD** no membro **flags** da estrutura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="848ec-143">To override the default unit of measurement, set the **PSD\_INHUNDREDTHSOFMILLIMETERS** or **PSD\_INTHOUSANDTHSOFINCHES** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>

<span data-ttu-id="848ec-144">Por padrão, os valores iniciais das margens são uma polegada.</span><span class="sxs-lookup"><span data-stu-id="848ec-144">The initial values for the margins are one inch, by default.</span></span> <span data-ttu-id="848ec-145">Se você definir o sinalizador de **\_ margens do PSD** , a caixa de diálogo exibirá os valores de margem inicial especificados no membro **rtMargin** .</span><span class="sxs-lookup"><span data-stu-id="848ec-145">If you set the **PSD\_MARGINS** flag, the dialog box displays the initial margin values specified in the **rtMargin** member.</span></span> <span data-ttu-id="848ec-146">Os valores mínimos padrão que o usuário pode especificar para as margens são as margens mínimas permitidas pela impressora.</span><span class="sxs-lookup"><span data-stu-id="848ec-146">The default minimum values that the user can specify for the margins are the minimum margins allowed by the printer.</span></span> <span data-ttu-id="848ec-147">Se você definir o **sinalizador \_ MINMARGINS do PSD** , a caixa de diálogo aplicará as margens mínimas especificadas no membro **rtMinMargin** .</span><span class="sxs-lookup"><span data-stu-id="848ec-147">If you set the **PSD\_MINMARGINS** flag, the dialog box enforces the minimum margins specified in the **rtMinMargin** member.</span></span>

<span data-ttu-id="848ec-148">Para impedir que os usuários selecionem determinadas opções, defina qualquer combinação dos sinalizadores a seguir para desabilitar os controles correspondentes.</span><span class="sxs-lookup"><span data-stu-id="848ec-148">To prevent users from selecting certain options, set any combination of the following flags to disable the corresponding controls.</span></span>



| <span data-ttu-id="848ec-149">Sinalizador</span><span class="sxs-lookup"><span data-stu-id="848ec-149">Flag</span></span>                        | <span data-ttu-id="848ec-150">Significado</span><span class="sxs-lookup"><span data-stu-id="848ec-150">Meaning</span></span>                                                                  |
|-----------------------------|--------------------------------------------------------------------------|
| <span data-ttu-id="848ec-151">**\_DISABLEMARGINS PSD**</span><span class="sxs-lookup"><span data-stu-id="848ec-151">**PSD\_DISABLEMARGINS**</span></span>     | <span data-ttu-id="848ec-152">Desabilita os controles de edição nos quais o usuário insere as configurações de margem.</span><span class="sxs-lookup"><span data-stu-id="848ec-152">Disables the edit controls in which the user enters the margin settings.</span></span> |
| <span data-ttu-id="848ec-153">**\_DISABLEORIENTATION PSD**</span><span class="sxs-lookup"><span data-stu-id="848ec-153">**PSD\_DISABLEORIENTATION**</span></span> | <span data-ttu-id="848ec-154">Desabilita os botões de opção **retrato** e **paisagem** .</span><span class="sxs-lookup"><span data-stu-id="848ec-154">Disables the **Portrait** and **Landscape** radio buttons.</span></span>               |
| <span data-ttu-id="848ec-155">**\_DISABLEPAPER PSD**</span><span class="sxs-lookup"><span data-stu-id="848ec-155">**PSD\_DISABLEPAPER**</span></span>       | <span data-ttu-id="848ec-156">Desabilita os controles para selecionar o tamanho do papel e a origem do papel.</span><span class="sxs-lookup"><span data-stu-id="848ec-156">Disables the controls for selecting the paper size and paper source.</span></span>     |
| <span data-ttu-id="848ec-157">**\_DISABLEPRINTER PSD**</span><span class="sxs-lookup"><span data-stu-id="848ec-157">**PSD\_DISABLEPRINTER**</span></span>     | <span data-ttu-id="848ec-158">Desabilita o botão da **impressora** .</span><span class="sxs-lookup"><span data-stu-id="848ec-158">Disables the **Printer** button.</span></span>                                         |



 

## <a name="customizing-the-page-setup-dialog-box"></a><span data-ttu-id="848ec-159">Personalizando a caixa de diálogo Configurar página</span><span class="sxs-lookup"><span data-stu-id="848ec-159">Customizing the Page Setup Dialog Box</span></span>

<span data-ttu-id="848ec-160">Você pode fornecer um modelo personalizado para a caixa de diálogo **Configurar página** , por exemplo, se você quiser incluir controles adicionais que são exclusivos do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="848ec-160">You can provide a custom template for the **Page Setup** dialog box, for example, if you want to include additional controls that are unique to your application.</span></span> <span data-ttu-id="848ec-161">A função [**PAGESETUPDLG**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) usa o modelo personalizado no lugar do modelo padrão.</span><span class="sxs-lookup"><span data-stu-id="848ec-161">The [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function uses your custom template in place of the default template.</span></span>

<span data-ttu-id="848ec-162">**Para fornecer um modelo personalizado para a caixa de diálogo Configurar página**</span><span class="sxs-lookup"><span data-stu-id="848ec-162">**To provide a custom template for the Page Setup dialog box**</span></span>

1.  <span data-ttu-id="848ec-163">Crie o modelo personalizado modificando o modelo padrão especificado no arquivo Prnsetup. Dlg.</span><span class="sxs-lookup"><span data-stu-id="848ec-163">Create the custom template by modifying the default template specified in the Prnsetup.dlg file.</span></span> <span data-ttu-id="848ec-164">Os identificadores de controle usados no modelo de caixa de diálogo de **configuração de página** padrão são definidos no arquivo Dlgs. h.</span><span class="sxs-lookup"><span data-stu-id="848ec-164">The control identifiers used in the default **Page Setup** dialog template are defined in the Dlgs.h file.</span></span>
2.  <span data-ttu-id="848ec-165">Use a estrutura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) para habilitar o modelo da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="848ec-165">Use the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure to enable the template as follows:</span></span>
    -   -   <span data-ttu-id="848ec-166">Se o modelo personalizado for um recurso em um aplicativo ou em uma biblioteca de vínculo dinâmico, defina o sinalizador **\_ ENABLEPAGESETUPTEMPLATE do PSD** no membro **flags** .</span><span class="sxs-lookup"><span data-stu-id="848ec-166">If your custom template is a resource in an application or dynamic-link library, set the **PSD\_ENABLEPAGESETUPTEMPLATE** flag in the **Flags** member.</span></span> <span data-ttu-id="848ec-167">Use os membros **HINSTANCE** e **lpPageSetupTemplateName** da estrutura para identificar o módulo e o nome do recurso.</span><span class="sxs-lookup"><span data-stu-id="848ec-167">Use the **hInstance** and **lpPageSetupTemplateName** members of the structure to identify the module and resource name.</span></span>

            <span data-ttu-id="848ec-168">-Ou-</span><span class="sxs-lookup"><span data-stu-id="848ec-168">-Or-</span></span>

        -   <span data-ttu-id="848ec-169">Se o modelo personalizado já estiver na memória, defina o **sinalizador \_ ENABLEPAGESETUPTEMPLATEHANDLE do PSD** .</span><span class="sxs-lookup"><span data-stu-id="848ec-169">If your custom template is already in memory, set the **PSD\_ENABLEPAGESETUPTEMPLATEHANDLE** flag.</span></span> <span data-ttu-id="848ec-170">Use o membro **hPageSetupTemplate** para identificar o objeto de memória que contém o modelo.</span><span class="sxs-lookup"><span data-stu-id="848ec-170">Use the **hPageSetupTemplate** member to identify the memory object that contains the template.</span></span>

<span data-ttu-id="848ec-171">Para filtrar as mensagens enviadas para o procedimento da caixa de diálogo, você pode fornecer um procedimento de gancho [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) .</span><span class="sxs-lookup"><span data-stu-id="848ec-171">To filter messages sent to the dialog box procedure, you can provide a [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) hook procedure.</span></span> <span data-ttu-id="848ec-172">Se você usar um modelo personalizado para definir controles adicionais, deverá fornecer um procedimento de gancho **PageSetupHook** para processar a entrada para seus controles.</span><span class="sxs-lookup"><span data-stu-id="848ec-172">If you use a custom template to define additional controls, you must provide a **PageSetupHook** hook procedure to process input for your controls.</span></span> <span data-ttu-id="848ec-173">Além disso, você pode fornecer um procedimento de gancho [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) para personalizar o conteúdo da página de exemplo exibida pela caixa de diálogo **Configurar página** .</span><span class="sxs-lookup"><span data-stu-id="848ec-173">In addition, you can provide a [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure to customize the contents of the sample page displayed by the **Page Setup** dialog box.</span></span> <span data-ttu-id="848ec-174">Para obter mais informações sobre o procedimento de gancho **PagePaintHook** , consulte [Personalizando a página de exemplo](#customizing-the-sample-page).</span><span class="sxs-lookup"><span data-stu-id="848ec-174">For more information about the **PagePaintHook** hook procedure, see [Customizing the Sample Page](#customizing-the-sample-page).</span></span>

<span data-ttu-id="848ec-175">**Para habilitar um procedimento de gancho PageSetupHook**</span><span class="sxs-lookup"><span data-stu-id="848ec-175">**To enable a PageSetupHook hook procedure**</span></span>

1.  <span data-ttu-id="848ec-176">Defina o **sinalizador \_ ENABLEPAGESETUPHOOK do PSD** no membro **flags** da estrutura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="848ec-176">Set the **PSD\_ENABLEPAGESETUPHOOK** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>
2.  <span data-ttu-id="848ec-177">Especifique o endereço do procedimento de gancho no membro **lpfnPageSetupHook** .</span><span class="sxs-lookup"><span data-stu-id="848ec-177">Specify the address of the hook procedure in the **lpfnPageSetupHook** member.</span></span>

<span data-ttu-id="848ec-178">Depois de processar sua mensagem [**\_ INITDIALOG do WM**](wm-initdialog.md) , o procedimento da caixa de diálogo envia uma mensagem do **WM \_ INITDIALOG** para o procedimento de gancho [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) .</span><span class="sxs-lookup"><span data-stu-id="848ec-178">After processing its [**WM\_INITDIALOG**](wm-initdialog.md) message, the dialog box procedure sends a **WM\_INITDIALOG** message to the [**PageSetupHook**](/windows/win32/api/commdlg/nc-commdlg-lppagesetuphook) hook procedure.</span></span> <span data-ttu-id="848ec-179">O parâmetro *lParam* dessa mensagem é um ponteiro para a estrutura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) usada para inicializar a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="848ec-179">The *lParam* parameter of this message is a pointer to the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure used to initialize the dialog box.</span></span>

## <a name="customizing-the-sample-page"></a><span data-ttu-id="848ec-180">Personalizando a página de exemplo</span><span class="sxs-lookup"><span data-stu-id="848ec-180">Customizing the Sample Page</span></span>

<span data-ttu-id="848ec-181">A caixa de diálogo **Configurar página** inclui uma imagem de uma página de exemplo que mostra como as seleções do usuário afetam a aparência da saída impressa.</span><span class="sxs-lookup"><span data-stu-id="848ec-181">The **Page Setup** dialog box includes an image of a sample page that shows how the user's selections affect the appearance of the printed output.</span></span> <span data-ttu-id="848ec-182">A imagem consiste em um retângulo que representa o papel selecionado ou o tipo de envelope, com um retângulo de linha pontilhada representando as margens atuais e caracteres parciais (texto grego) para mostrar a aparência do texto na página impressa.</span><span class="sxs-lookup"><span data-stu-id="848ec-182">The image consists of a rectangle that represents the selected paper or envelope type, with a dotted-line rectangle representing the current margins, and partial (Greek text) characters to show how text looks on the printed page.</span></span>

<span data-ttu-id="848ec-183">Ao chamar a função [**PAGESETUPDLG**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) , você pode fornecer um procedimento de gancho de [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) para personalizar a aparência da página de exemplo.</span><span class="sxs-lookup"><span data-stu-id="848ec-183">When you call the [**PageSetupDlg**](/previous-versions/windows/desktop/legacy/ms646937(v=vs.85)) function, you can provide a [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure to customize the appearance of the sample page.</span></span>

<span data-ttu-id="848ec-184">**Para habilitar um procedimento de gancho PagePaintHook**</span><span class="sxs-lookup"><span data-stu-id="848ec-184">**To enable a PagePaintHook hook procedure**</span></span>

1.  <span data-ttu-id="848ec-185">Defina o **sinalizador \_ ENABLEPAGEPAINTHOOK do PSD** no membro **flags** da estrutura [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) .</span><span class="sxs-lookup"><span data-stu-id="848ec-185">Set the **PSD\_ENABLEPAGEPAINTHOOK** flag in the **Flags** member of the [**PAGESETUPDLG**](/windows/win32/api/commdlg/ns-commdlg-pagesetupdlga) structure.</span></span>
2.  <span data-ttu-id="848ec-186">Especifique o endereço do procedimento de gancho no membro **lpfnPagePaintHook** .</span><span class="sxs-lookup"><span data-stu-id="848ec-186">Specify the address of the hook procedure in the **lpfnPagePaintHook** member.</span></span>

<span data-ttu-id="848ec-187">Sempre que a caixa de diálogo estiver prestes a desenhar o conteúdo da página de exemplo, o procedimento de gancho receberá as seguintes mensagens na ordem em que elas estão listadas.</span><span class="sxs-lookup"><span data-stu-id="848ec-187">Whenever the dialog box is about to draw the contents of the sample page, the hook procedure receives the following messages in the order in which they are listed.</span></span>



| <span data-ttu-id="848ec-188">Mensagem</span><span class="sxs-lookup"><span data-stu-id="848ec-188">Message</span></span>                                                  | <span data-ttu-id="848ec-189">Significado</span><span class="sxs-lookup"><span data-stu-id="848ec-189">Meaning</span></span>                                                                                                                                          |
|----------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="848ec-190">**\_PAGESETUPDLG de PSD do WM \_**</span><span class="sxs-lookup"><span data-stu-id="848ec-190">**WM\_PSD\_PAGESETUPDLG**</span></span>](wm-psd-pagesetupdlg.md)     | <span data-ttu-id="848ec-191">A caixa de diálogo está prestes a desenhar a página de exemplo.</span><span class="sxs-lookup"><span data-stu-id="848ec-191">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="848ec-192">O procedimento de gancho pode usar essa mensagem para se preparar para desenhar o conteúdo da página de exemplo.</span><span class="sxs-lookup"><span data-stu-id="848ec-192">The hook procedure can use this message to prepare to draw the contents of the sample page.</span></span>     |
| [<span data-ttu-id="848ec-193">**\_FULLPAGERECT de PSD do WM \_**</span><span class="sxs-lookup"><span data-stu-id="848ec-193">**WM\_PSD\_FULLPAGERECT**</span></span>](wm-psd-fullpagerect.md)     | <span data-ttu-id="848ec-194">A caixa de diálogo está prestes a desenhar a página de exemplo.</span><span class="sxs-lookup"><span data-stu-id="848ec-194">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="848ec-195">Esta mensagem Especifica o retângulo delimitador da página de exemplo.</span><span class="sxs-lookup"><span data-stu-id="848ec-195">This message specifies the bounding rectangle of the sample page.</span></span>                               |
| [<span data-ttu-id="848ec-196">**\_MINMARGINRECT de PSD do WM \_**</span><span class="sxs-lookup"><span data-stu-id="848ec-196">**WM\_PSD\_MINMARGINRECT**</span></span>](wm-psd-minmarginrect.md)   | <span data-ttu-id="848ec-197">A caixa de diálogo está prestes a desenhar a página de exemplo.</span><span class="sxs-lookup"><span data-stu-id="848ec-197">The dialog box is about to draw the sample page.</span></span> <span data-ttu-id="848ec-198">Esta mensagem Especifica o retângulo da margem.</span><span class="sxs-lookup"><span data-stu-id="848ec-198">This message specifies the margin rectangle.</span></span>                                                    |
| [<span data-ttu-id="848ec-199">**\_MARGINRECT de PSD do WM \_**</span><span class="sxs-lookup"><span data-stu-id="848ec-199">**WM\_PSD\_MARGINRECT**</span></span>](wm-psd-marginrect.md)         | <span data-ttu-id="848ec-200">A caixa de diálogo está prestes a desenhar o retângulo de margem.</span><span class="sxs-lookup"><span data-stu-id="848ec-200">The dialog box is about to draw the margin rectangle.</span></span>                                                                                            |
| [<span data-ttu-id="848ec-201">**\_GREEKTEXTRECT de PSD do WM \_**</span><span class="sxs-lookup"><span data-stu-id="848ec-201">**WM\_PSD\_GREEKTEXTRECT**</span></span>](wm-psd-greektextrect.md)   | <span data-ttu-id="848ec-202">A caixa de diálogo está prestes a desenhar o texto grego dentro do retângulo de margem.</span><span class="sxs-lookup"><span data-stu-id="848ec-202">The dialog box is about to draw the Greek text inside the margin rectangle.</span></span>                                                                      |
| [<span data-ttu-id="848ec-203">**\_ENVSTAMPRECT de PSD do WM \_**</span><span class="sxs-lookup"><span data-stu-id="848ec-203">**WM\_PSD\_ENVSTAMPRECT**</span></span>](wm-psd-envstamprect.md)     | <span data-ttu-id="848ec-204">A caixa de diálogo está prestes a desenhar no retângulo do carimbo de envelope de uma página de exemplo de envelope.</span><span class="sxs-lookup"><span data-stu-id="848ec-204">The dialog box is about to draw in the envelope-stamp rectangle of an envelope sample page.</span></span> <span data-ttu-id="848ec-205">Esta mensagem é enviada somente para envelopes.</span><span class="sxs-lookup"><span data-stu-id="848ec-205">This message is sent for envelopes only.</span></span>             |
| [<span data-ttu-id="848ec-206">**\_YAFULLPAGERECT de PSD do WM \_**</span><span class="sxs-lookup"><span data-stu-id="848ec-206">**WM\_PSD\_YAFULLPAGERECT**</span></span>](wm-psd-yafullpagerect.md) | <span data-ttu-id="848ec-207">A caixa de diálogo está prestes a desenhar a parte de endereço de retorno de uma página de exemplo de envelope.</span><span class="sxs-lookup"><span data-stu-id="848ec-207">The dialog box is about to draw the return address portion of an envelope sample page.</span></span> <span data-ttu-id="848ec-208">Essa mensagem é enviada para envelopes e outros tamanhos de papel.</span><span class="sxs-lookup"><span data-stu-id="848ec-208">This message is sent for envelopes and other paper sizes.</span></span> |



 

<span data-ttu-id="848ec-209">Se o procedimento de gancho retornar **true** para qualquer uma das três primeiras mensagens de uma sequência de desenho ([**WM \_ PSD \_ PAGESETUPDLG**](wm-psd-pagesetupdlg.md), [**WM \_ PSD \_ FULLPAGERECT**](wm-psd-fullpagerect.md)ou [**WM \_ PSD \_ MINMARGINRECT**](wm-psd-minmarginrect.md)), a caixa de diálogo não enviará mais mensagens e não desenhará na página de exemplo até a próxima vez que o sistema precisar redesenhar a página de exemplo.</span><span class="sxs-lookup"><span data-stu-id="848ec-209">If the hook procedure returns **TRUE** for any of the first three messages of a drawing sequence ([**WM\_PSD\_PAGESETUPDLG**](wm-psd-pagesetupdlg.md), [**WM\_PSD\_FULLPAGERECT**](wm-psd-fullpagerect.md), or [**WM\_PSD\_MINMARGINRECT**](wm-psd-minmarginrect.md)) the dialog box sends no more messages and does not draw in the sample page until the next time the system needs to redraw the sample page.</span></span> <span data-ttu-id="848ec-210">Se o procedimento de gancho retornar **false** para todas as três mensagens, a caixa de diálogo enviará as mensagens restantes da sequência de desenho.</span><span class="sxs-lookup"><span data-stu-id="848ec-210">If the hook procedure returns **FALSE** for all three messages, the dialog box sends the remaining messages of the drawing sequence.</span></span>

<span data-ttu-id="848ec-211">Se o procedimento de gancho retornar **true** para qualquer uma das mensagens restantes em uma sequência de desenho, a caixa de diálogo não desenhará a parte correspondente da página de exemplo.</span><span class="sxs-lookup"><span data-stu-id="848ec-211">If the hook procedure returns **TRUE** for any of the remaining messages in a drawing sequence, the dialog box does not draw the corresponding portion of the sample page.</span></span> <span data-ttu-id="848ec-212">Se o procedimento de gancho retornar **false** para qualquer uma dessas mensagens, a caixa de diálogo desenhará essa parte da página de exemplo.</span><span class="sxs-lookup"><span data-stu-id="848ec-212">If the hook procedure returns **FALSE** for any of these messages, the dialog box draws that portion of the sample page.</span></span>

<span data-ttu-id="848ec-213">Para impedir que a caixa de diálogo desenhasse o conteúdo da página de exemplo, você pode definir o sinalizador **\_ DISABLEPAGEPAINTING do PSD** .</span><span class="sxs-lookup"><span data-stu-id="848ec-213">To prevent the dialog box from drawing the contents of the sample page, you can set the **PSD\_DISABLEPAGEPAINTING** flag.</span></span> <span data-ttu-id="848ec-214">Esse sinalizador não afeta o procedimento de gancho do [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) , que ainda recebe todas as mensagens do **WM \_ PSD \_ \*** e pode desenhar o conteúdo da página de exemplo.</span><span class="sxs-lookup"><span data-stu-id="848ec-214">This flag does not affect your [**PagePaintHook**](/windows/win32/api/commdlg/nc-commdlg-lppagepainthook) hook procedure, which still receives all the **WM\_PSD\_\*** messages and can draw the sample page contents.</span></span>

 

 