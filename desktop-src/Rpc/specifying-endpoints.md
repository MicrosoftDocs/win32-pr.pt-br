---
title: Especificando pontos de extremidade
description: Especificando pontos de extremidade bem conhecidos e dinâmicos na RPC (chamada de procedimento remoto).
ms.assetid: fc39b527-11e6-45a7-b3b5-8bcf469633d8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 373fb2818dd14670f5a939aa524c81fcdb05e20b
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "105748747"
---
# <a name="specifying-endpoints"></a><span data-ttu-id="39fd5-103">Especificando pontos de extremidade</span><span class="sxs-lookup"><span data-stu-id="39fd5-103">Specifying Endpoints</span></span>

<span data-ttu-id="39fd5-104">Um ponto de extremidade é um endereço específico da rede de um processo do servidor para chamadas de procedimento remoto.</span><span class="sxs-lookup"><span data-stu-id="39fd5-104">An endpoint is a network-specific address of a server process for remote procedure calls.</span></span> <span data-ttu-id="39fd5-105">O nome real do ponto de extremidade depende da sequência de protocolo usada.</span><span class="sxs-lookup"><span data-stu-id="39fd5-105">The actual name of the endpoint depends on the protocol sequence used.</span></span> <span data-ttu-id="39fd5-106">Por exemplo, TCP, UDP e HTTP usam portas.</span><span class="sxs-lookup"><span data-stu-id="39fd5-106">For example, TCP, UDP, and HTTP use ports.</span></span> <span data-ttu-id="39fd5-107">Pipes nomeados usam um nome de pipe nomeado.</span><span class="sxs-lookup"><span data-stu-id="39fd5-107">Named pipes uses a named pipe name.</span></span> <span data-ttu-id="39fd5-108">Aplicativos cliente/servidor podem usar um ponto de extremidade conhecido ou um ponto de extremidade dinâmico.</span><span class="sxs-lookup"><span data-stu-id="39fd5-108">Client/server applications can use a well-known endpoint or a dynamic endpoint.</span></span> <span data-ttu-id="39fd5-109">Esta seção apresenta as técnicas que os programas de servidor usam para especificar pontos de extremidade bem conhecidos e dinâmicos.</span><span class="sxs-lookup"><span data-stu-id="39fd5-109">This section presents the techniques that server programs use to specify well-known and dynamic endpoints.</span></span> <span data-ttu-id="39fd5-110">As informações são discutidas nos seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="39fd5-110">The information is discussed in the following topics:</span></span>

-   [<span data-ttu-id="39fd5-111">Especificando pontos de extremidade conhecidos</span><span class="sxs-lookup"><span data-stu-id="39fd5-111">Specifying Well-known Endpoints</span></span>](#specifying-well-known-endpoints)
-   [<span data-ttu-id="39fd5-112">Especificando pontos de extremidade dinâmicos</span><span class="sxs-lookup"><span data-stu-id="39fd5-112">Specifying Dynamic Endpoints</span></span>](#specifying-dynamic-endpoints)

## <a name="specifying-well-known-endpoints"></a><span data-ttu-id="39fd5-113">Especificando pontos de extremidade conhecidos</span><span class="sxs-lookup"><span data-stu-id="39fd5-113">Specifying Well-known Endpoints</span></span>

<span data-ttu-id="39fd5-114">Quando o servidor usa um ponto de extremidade conhecido, ele pode incluir os dados do ponto de extremidade como parte de sua entrada de banco de dado de serviço de nome.</span><span class="sxs-lookup"><span data-stu-id="39fd5-114">When your server uses a well-known endpoint, it can include the endpoint data as part of its name service database entry.</span></span> <span data-ttu-id="39fd5-115">Se tiver, o identificador de associação do cliente conterá um endereço de servidor completo que inclui o ponto de extremidade conhecido quando o cliente importar o identificador de associação da entrada do servidor.</span><span class="sxs-lookup"><span data-stu-id="39fd5-115">If it does, the client's binding handle contains a complete server address that includes the well-known endpoint when the client imports the binding handle from the server entry.</span></span>

<span data-ttu-id="39fd5-116">O programa de servidor também pode especificar pontos de extremidade bem conhecidos ao mesmo tempo em que especifica seqüências de protocolo.</span><span class="sxs-lookup"><span data-stu-id="39fd5-116">Your server program can also specify well-known endpoints at the same time it specifies protocol sequences.</span></span> <span data-ttu-id="39fd5-117">Invoque a função [**RpcServerUseProtseqEp**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqep) ou [**RpcServerUseProtseqEpEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex) .</span><span class="sxs-lookup"><span data-stu-id="39fd5-117">Invoke either the [**RpcServerUseProtseqEp**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqep) or [**RpcServerUseProtseqEpEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqepex) function.</span></span> <span data-ttu-id="39fd5-118">A diferença entre os dois é que a última função tem um parâmetro extra que seu servidor pode usar para controlar a alocação de porta dinâmica.</span><span class="sxs-lookup"><span data-stu-id="39fd5-118">The difference between the two is that the latter function has an extra parameter your server can use to control dynamic port allocation.</span></span>

<span data-ttu-id="39fd5-119">Se o seu programa de servidor especificar suas informações de ponto de extremidade dessa forma, ele também deverá chamar a função [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) para registrar o ponto de extremidade no mapa do ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="39fd5-119">If your server program specifies its endpoint information in this way, it should also call the [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) function to register the endpoint in the endpoint map.</span></span> <span data-ttu-id="39fd5-120">Embora o ponto de extremidade seja sempre o mesmo, o cliente pode usar o mapa do ponto de extremidade para localizar o servidor.</span><span class="sxs-lookup"><span data-stu-id="39fd5-120">Even though the endpoint is always the same, the client may use the endpoint map to find the server.</span></span>

<span data-ttu-id="39fd5-121">Como as sequências de protocolo, um aplicativo pode especificar informações de ponto de extremidade em seu arquivo IDL.</span><span class="sxs-lookup"><span data-stu-id="39fd5-121">Like protocol sequences, an application can specify endpoint information in its IDL file.</span></span> <span data-ttu-id="39fd5-122">Quando ele faz isso, ele deve registrar as sequências de protocolo e os pontos de extremidade ao mesmo tempo invocando a função [**RpcServerUseAllProtseqsIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsif) ou [**RpcServerUseAllProtseqsIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsifex) .</span><span class="sxs-lookup"><span data-stu-id="39fd5-122">When it does, it should register both the protocol sequences and endpoints at the same time by invoking the [**RpcServerUseAllProtseqsIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsif) or [**RpcServerUseAllProtseqsIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsifex) function.</span></span> <span data-ttu-id="39fd5-123">Nesse caso, o cliente tem acesso às informações do ponto de extremidade por meio da especificação da interface no arquivo IDL.</span><span class="sxs-lookup"><span data-stu-id="39fd5-123">In this case, the client has access to the endpoint information through the interface specification in the IDL file.</span></span> <span data-ttu-id="39fd5-124">Portanto, não é necessário chamar a função [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) .</span><span class="sxs-lookup"><span data-stu-id="39fd5-124">Therefore, it is not necessary to call the [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) function.</span></span>

## <a name="specifying-dynamic-endpoints"></a><span data-ttu-id="39fd5-125">Especificando pontos de extremidade dinâmicos</span><span class="sxs-lookup"><span data-stu-id="39fd5-125">Specifying Dynamic Endpoints</span></span>

<span data-ttu-id="39fd5-126">Um ponto de extremidade dinâmico é um ponto de extremidade que o computador host do servidor atribui quando o servidor começa a execução.</span><span class="sxs-lookup"><span data-stu-id="39fd5-126">A dynamic endpoint is an endpoint that the server host computer assigns when the server begins execution.</span></span> <span data-ttu-id="39fd5-127">A maioria dos aplicativos de servidor usa pontos de extremidade dinâmicos para evitar conflitos com outros programas em relação ao número limitado de portas que estão disponíveis no sistema de computador host do servidor.</span><span class="sxs-lookup"><span data-stu-id="39fd5-127">Most server applications use dynamic endpoints to avoid conflict with other programs over the limited number of ports that are available on the server host computer system.</span></span> <span data-ttu-id="39fd5-128">No entanto, os programas que usam pipes nomeados ou a sequência de protocolo [**Ncalrpc**](/windows/desktop/Midl/ncalrpc) têm um espaço de nome de ponto de extremidade muito grande.</span><span class="sxs-lookup"><span data-stu-id="39fd5-128">However, programs using named pipes or the [**ncalrpc**](/windows/desktop/Midl/ncalrpc) protocol sequence have a very large endpoint name space.</span></span> <span data-ttu-id="39fd5-129">Eles se beneficiam menos de pontos de extremidade dinâmicos do que programas usando outros transportes.</span><span class="sxs-lookup"><span data-stu-id="39fd5-129">They benefit less from dynamic endpoints than programs using other transports.</span></span>

<span data-ttu-id="39fd5-130">Os programas de servidor registram pontos de extremidade dinâmicos em um banco de dados de mapa de ponto de</span><span class="sxs-lookup"><span data-stu-id="39fd5-130">Server programs register dynamic endpoints in an endpoint map database.</span></span> <span data-ttu-id="39fd5-131">Se você quiser que o servidor use qualquer ponto de extremidade disponível, chame [**RpcServerUseAllProtSeqs**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqs), [**RpcServerUseAllProtseqsEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsex), [**RpcServerUseProtseq**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseq) ou [**RpcServerUseProtseqEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqex).</span><span class="sxs-lookup"><span data-stu-id="39fd5-131">If you want the server to use any available endpoint, call [**RpcServerUseAllProtSeqs**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqs), [**RpcServerUseAllProtseqsEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsex), [**RpcServerUseProtseq**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseq) or [**RpcServerUseProtseqEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqex).</span></span> <span data-ttu-id="39fd5-132">Isso define a biblioteca de tempo de execução RPC para usar todas ou uma sequência de protocolo válida com pontos de extremidade dinâmicos.</span><span class="sxs-lookup"><span data-stu-id="39fd5-132">This sets the RPC run-time library to use all or one valid protocol sequence(s) with dynamic endpoints.</span></span> <span data-ttu-id="39fd5-133">O servidor deve então chamar [**RpcServerInqBindings**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverinqbindings) para obter um conjunto de identificadores de associação válidos.</span><span class="sxs-lookup"><span data-stu-id="39fd5-133">The server should then call [**RpcServerInqBindings**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserverinqbindings) to obtain a set of valid binding handles.</span></span> <span data-ttu-id="39fd5-134">O servidor passa o conjunto de identificadores de associação, ou o vetor de associação, para a função [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) para registrar todos os pontos de extremidade adequados no mapa de Endpoint.</span><span class="sxs-lookup"><span data-stu-id="39fd5-134">The server passes the set of binding handles, or binding vector, to the function [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) to register all suitable endpoints in the endpoint map.</span></span> <span data-ttu-id="39fd5-135">Para cada chamada que o servidor faz para **RpcEpRegister**, deve haver uma chamada correspondente para [**RpcBindingVectorFree**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingvectorfree) para liberar a memória que o vetor de associação usa.</span><span class="sxs-lookup"><span data-stu-id="39fd5-135">For each call your server makes to **RpcEpRegister**, there should be a corresponding call to [**RpcBindingVectorFree**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingvectorfree) to release the memory that the binding vector uses.</span></span>

<span data-ttu-id="39fd5-136">Observe que os programas de servidor podem usar a função [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) em vez de [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister).</span><span class="sxs-lookup"><span data-stu-id="39fd5-136">Note that server programs can use the [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) function rather than [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister).</span></span> <span data-ttu-id="39fd5-137">Os programas normalmente usam **RpcEpRegisterNoReplace** quando várias cópias de um programa de servidor devem ser executadas em um sistema host de servidor.</span><span class="sxs-lookup"><span data-stu-id="39fd5-137">Programs typically use **RpcEpRegisterNoReplace** when multiple copies of a server program must run on a server host system.</span></span>

<span data-ttu-id="39fd5-138">As funções [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) e [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) adicionam as interfaces do servidor e os identificadores de associação ao banco de dados do mapeador de ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="39fd5-138">Both the [**RpcEpRegister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregister) and [**RpcEpRegisterNoReplace**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepregisternoreplace) functions add the server's interfaces and binding handles to the endpoint mapper database.</span></span> <span data-ttu-id="39fd5-139">Quando o cliente faz uma chamada de procedimento remoto usando um identificador parcialmente associado, a biblioteca de tempo de execução do cliente solicita ao mapeador de ponto de extremidade do computador do servidor o ponto de extremidade de uma instância de servidor compatível.</span><span class="sxs-lookup"><span data-stu-id="39fd5-139">When the client makes a remote procedure call using a partially bound handle, the client's run-time library asks the server computer's endpoint mapper for the endpoint of a compatible server instance.</span></span> <span data-ttu-id="39fd5-140">A biblioteca de cliente fornece o UUID de interface, a sequência de protocolo e, se presente, o UUID de objeto no identificador de associação de cliente.</span><span class="sxs-lookup"><span data-stu-id="39fd5-140">The client library supplies the interface UUID, protocol sequence, and, if present, the object UUID in the client binding handle.</span></span> <span data-ttu-id="39fd5-141">O mapeador de ponto de extremidade procura uma entrada de banco de dados que corresponda às informações do cliente.</span><span class="sxs-lookup"><span data-stu-id="39fd5-141">The endpoint mapper looks for a database entry that matches the client's information.</span></span> <span data-ttu-id="39fd5-142">O UUID da interface de cliente/servidor, a versão principal da interface e a sequência de protocolo devem corresponder exatamente.</span><span class="sxs-lookup"><span data-stu-id="39fd5-142">The client/server interface UUID, the interface major version, and protocol sequence must all match exactly.</span></span> <span data-ttu-id="39fd5-143">Além disso, a versão secundária da interface do servidor deve ser maior ou igual à versão secundária do cliente.</span><span class="sxs-lookup"><span data-stu-id="39fd5-143">In addition, the server's interface minor version must be greater than or equal to the client's minor version.</span></span>

<span data-ttu-id="39fd5-144">Se todos os testes forem bem-sucedidos, o mapeador de ponto de extremidade retornará o ponto de extremidade válido e a biblioteca de tempo de execução do cliente atualizará o ponto de extremidade no identificador de associação.</span><span class="sxs-lookup"><span data-stu-id="39fd5-144">If all tests are successful, the endpoint mapper returns the valid endpoint and the client run-time library updates the endpoint in the binding handle.</span></span>

<span data-ttu-id="39fd5-145">Os pontos de extremidade dinâmicos são limpos automaticamente do banco de dados mapeador de pontos de extremidades quando o processo do servidor para de ser executado.</span><span class="sxs-lookup"><span data-stu-id="39fd5-145">Dynamic endpoints are automatically purged from the endpoint mapper database when the server process stops running.</span></span> <span data-ttu-id="39fd5-146">Você pode remover o ponto de extremidade do banco de dados do mapeador de ponto de extremidade antes de o programa de servidor sair usando a função [**RpcEpUnregister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepunregister) ou pode permitir que a limpeza automática gerencie a remoção do ponto de extremidade.</span><span class="sxs-lookup"><span data-stu-id="39fd5-146">You can either remove the endpoint from the endpoint mapper database before the server program exits using the [**RpcEpUnregister**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcepunregister) function, or you can allow automatic cleanup to manage removal of the endpoint.</span></span>

 

 