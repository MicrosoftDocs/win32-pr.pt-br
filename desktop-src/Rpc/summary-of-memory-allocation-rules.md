---
title: Resumo das regras de alocação de memória
description: A tabela a seguir resume as principais regras relacionadas à alocação de memória.
ms.assetid: 0c1f8398-75e6-45ec-a9f9-9dcdbe21c24d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6f9403bb5057b2004d966c0634bc101a3282fe92
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104084727"
---
# <a name="summary-of-memory-allocation-rules"></a><span data-ttu-id="0c77b-103">Resumo das regras de alocação de memória</span><span class="sxs-lookup"><span data-stu-id="0c77b-103">Summary of Memory Allocation Rules</span></span>

<span data-ttu-id="0c77b-104">A tabela a seguir resume as principais regras relacionadas à alocação de memória.</span><span class="sxs-lookup"><span data-stu-id="0c77b-104">The following table summarizes key rules regarding memory allocation.</span></span>



| <span data-ttu-id="0c77b-105">Elemento MIDL</span><span class="sxs-lookup"><span data-stu-id="0c77b-105">MIDL element</span></span>                                                                                                                                           | <span data-ttu-id="0c77b-106">Descrição</span><span class="sxs-lookup"><span data-stu-id="0c77b-106">Description</span></span>                                                                                                                                                           |
|--------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0c77b-107">Ponteiros de \[ [referência](/windows/desktop/Midl/ref) de nível superior \]</span><span class="sxs-lookup"><span data-stu-id="0c77b-107">Top-level \[ [ref](/windows/desktop/Midl/ref)\] pointers</span></span>                                                                                                                | <span data-ttu-id="0c77b-108">Deve ser ponteiros não nulos.</span><span class="sxs-lookup"><span data-stu-id="0c77b-108">Must be non-null pointers.</span></span>                                                                                                                                            |
| <span data-ttu-id="0c77b-109">Valor de retorno da função</span><span class="sxs-lookup"><span data-stu-id="0c77b-109">Function return value</span></span>                                                                                                                                  | <span data-ttu-id="0c77b-110">Uma nova memória sempre é alocada para valores de retorno de ponteiro.</span><span class="sxs-lookup"><span data-stu-id="0c77b-110">New memory is always allocated for pointer return values.</span></span>                                                                                                             |
| <span data-ttu-id="0c77b-111">\[[ponteiro exclusivo](/windows/desktop/Midl/unique), [horizontal](/windows/desktop/Midl/out-idl) \] ou \[ [PTR](/windows/desktop/Midl/ptr), out \]</span><span class="sxs-lookup"><span data-stu-id="0c77b-111">\[ [unique](/windows/desktop/Midl/unique), [out](/windows/desktop/Midl/out-idl)\] or \[ [ptr](/windows/desktop/Midl/ptr), out\] pointer</span></span>                                                                   | <span data-ttu-id="0c77b-112">Não permitido pelo MIDL.</span><span class="sxs-lookup"><span data-stu-id="0c77b-112">Not allowed by MIDL.</span></span>                                                                                                                                                  |
| <span data-ttu-id="0c77b-113">Ponteiro de nível não \[ [exclusivo](/windows/desktop/Midl/unique), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl) \] ou \[ [PTR](/windows/desktop/Midl/ptr), in e out \] que muda de NULL para não NULL</span><span class="sxs-lookup"><span data-stu-id="0c77b-113">Non-top-level \[[unique](/windows/desktop/Midl/unique), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl)\] or \[[ptr](/windows/desktop/Midl/ptr), in, out\] pointer that changes from null to non-null</span></span> | <span data-ttu-id="0c77b-114">Stubs de cliente alocam nova memória no cliente no retorno.</span><span class="sxs-lookup"><span data-stu-id="0c77b-114">Client stubs allocate new memory on client on return.</span></span>                                                                                                                 |
| <span data-ttu-id="0c77b-115">Ponteiro de saída exclusivo de nível não superior \[ [](/windows/desktop/Midl/unique), para [fora](/windows/desktop/Midl/out-idl) , [](/windows/desktop/Midl/in) \] que muda de não nulo para nulo</span><span class="sxs-lookup"><span data-stu-id="0c77b-115">Non-top-level \[[unique](/windows/desktop/Midl/unique), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl)\] pointer that changes from non-null to null</span></span>                                 | <span data-ttu-id="0c77b-116">A memória está órfã no cliente; o aplicativo cliente é responsável por liberar memória e evitar vazamentos.</span><span class="sxs-lookup"><span data-stu-id="0c77b-116">Memory is orphaned on client; client application is responsible for freeing memory and preventing leaks.</span></span>                                                              |
| <span data-ttu-id="0c77b-117">Ponteiro de nível não-alto \[ [](/windows/desktop/Midl/ptr), [entrada](/windows/desktop/Midl/in)e [saída](/windows/desktop/Midl/out-idl) \] que muda de não nulo para nulo</span><span class="sxs-lookup"><span data-stu-id="0c77b-117">Non-top-level \[[ptr](/windows/desktop/Midl/ptr), [in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl)\] pointer that changes from non-null to null</span></span>                                       | <span data-ttu-id="0c77b-118">A memória ficará órfã no cliente se não tiver um alias; o aplicativo cliente é responsável por liberar e impedir vazamentos de memória nesse caso.</span><span class="sxs-lookup"><span data-stu-id="0c77b-118">Memory will be orphaned on client if not aliased; client application is responsible for freeing and preventing memory leaks in this case.</span></span>                             |
| <span data-ttu-id="0c77b-119">\[[ref](/windows/desktop/Midl/ref) \] Ponteiro</span><span class="sxs-lookup"><span data-stu-id="0c77b-119">\[[ref](/windows/desktop/Midl/ref)\] pointers</span></span>                                                                                                                           | <span data-ttu-id="0c77b-120">A camada de aplicativo do cliente geralmente aloca.</span><span class="sxs-lookup"><span data-stu-id="0c77b-120">Client-application layer usually allocates.</span></span>                                                                                                                           |
| <span data-ttu-id="0c77b-121">\[Ponteiro para [saída](/windows/desktop/Midl/out-idl) [não nulo](/windows/desktop/Midl/in) \]</span><span class="sxs-lookup"><span data-stu-id="0c77b-121">Non-null \[[in](/windows/desktop/Midl/in), [out](/windows/desktop/Midl/out-idl)\] pointer</span></span>                                                                                                | <span data-ttu-id="0c77b-122">Os stubs tentam gravar no armazenamento existente no cliente.</span><span class="sxs-lookup"><span data-stu-id="0c77b-122">Stubs attempt to write into existing storage on client.</span></span> <span data-ttu-id="0c77b-123">Se a **\[ cadeia de caracteres \]** e o tamanho aumentarem além do tamanho alocado no cliente, isso causará um GP-Fault no retorno.</span><span class="sxs-lookup"><span data-stu-id="0c77b-123">If **\[string\]** and size increases beyond size allocated on the client, it will cause a GP-fault on return.</span></span> |



 

<span data-ttu-id="0c77b-124">A tabela a seguir resume os efeitos dos principais atributos IDL e ACF no gerenciamento de memória.</span><span class="sxs-lookup"><span data-stu-id="0c77b-124">The following table summarizes the effects of key IDL and ACF attributes on memory management.</span></span>



| <span data-ttu-id="0c77b-125">Recurso MIDL</span><span class="sxs-lookup"><span data-stu-id="0c77b-125">MIDL feature</span></span>                                                                   | <span data-ttu-id="0c77b-126">Problemas com o cliente</span><span class="sxs-lookup"><span data-stu-id="0c77b-126">Client issues</span></span>                                                                                                                                  | <span data-ttu-id="0c77b-127">Problemas do servidor</span><span class="sxs-lookup"><span data-stu-id="0c77b-127">Server issues</span></span>                                                                                                                 |
|--------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="0c77b-128">\[[alocar](/windows/desktop/Midl/allocate)( \_ nó único) \] , \[ alocar (todos os \_ nós)\]</span><span class="sxs-lookup"><span data-stu-id="0c77b-128">\[ [allocate](/windows/desktop/Midl/allocate)(single\_node)\], \[allocate(all\_nodes)\]</span></span>         | <span data-ttu-id="0c77b-129">Determina se uma ou várias chamadas são feitas nas funções de memória.</span><span class="sxs-lookup"><span data-stu-id="0c77b-129">Determines whether one or many calls are made to the memory functions.</span></span>                                                                         | <span data-ttu-id="0c77b-130">Igual ao cliente, exceto que a memória privada geralmente pode ser usada para alocar ( \_ nó único) \[ no \] e \[ nos dados de saída \] .</span><span class="sxs-lookup"><span data-stu-id="0c77b-130">Same as client, except private memory can often be used for allocate (single\_node) \[in\] and \[in,out\] data.</span></span>               |
| <span data-ttu-id="0c77b-131">\[alocar (gratuito) \] ou \[ alocar (não \_ livre)\]</span><span class="sxs-lookup"><span data-stu-id="0c77b-131">\[allocate(free)\] or \[allocate(dont\_free)\]</span></span>                                 | <span data-ttu-id="0c77b-132">(Nenhum; afeta o servidor.)</span><span class="sxs-lookup"><span data-stu-id="0c77b-132">(None; affects server.)</span></span>                                                                                                                        | <span data-ttu-id="0c77b-133">Determina se a memória no servidor é liberada após cada chamada de procedimento remoto.</span><span class="sxs-lookup"><span data-stu-id="0c77b-133">Determines whether memory on the server is freed after each remote procedure call.</span></span>                                            |
| <span data-ttu-id="0c77b-134">os atributos \[ de matriz [Max \_ são](/windows/desktop/Midl/max-is) \] e o \[ [tamanho \_ é](/windows/desktop/Midl/size-is)\]</span><span class="sxs-lookup"><span data-stu-id="0c77b-134">array attributes \[ [max\_is](/windows/desktop/Midl/max-is)\] and \[ [size\_is](/windows/desktop/Midl/size-is)\]</span></span> | <span data-ttu-id="0c77b-135">(Nenhum; afeta o servidor.)</span><span class="sxs-lookup"><span data-stu-id="0c77b-135">(None; affects server.)</span></span>                                                                                                                        | <span data-ttu-id="0c77b-136">Determina o tamanho da memória a ser alocada.</span><span class="sxs-lookup"><span data-stu-id="0c77b-136">Determines size of memory to be allocated.</span></span>                                                                                    |
| <span data-ttu-id="0c77b-137">\[[ \_ contagem de bytes](/windows/desktop/Midl/byte-count)\]</span><span class="sxs-lookup"><span data-stu-id="0c77b-137">\[ [byte\_count](/windows/desktop/Midl/byte-count)\]</span></span>                                            | <span data-ttu-id="0c77b-138">O cliente deve alocar o buffer; não alocado ou liberado por stubs de cliente.</span><span class="sxs-lookup"><span data-stu-id="0c77b-138">Client must allocate buffer; not allocated or freed by client stubs.</span></span>                                                                           | <span data-ttu-id="0c77b-139">O atributo de parâmetro de ACF determina o tamanho do buffer alocado no servidor.</span><span class="sxs-lookup"><span data-stu-id="0c77b-139">ACF parameter attribute determines size of buffer allocated on server.</span></span>                                                        |
| <span data-ttu-id="0c77b-140">\[[habilitar \_ alocação](/windows/desktop/Midl/enable-allocate)\]</span><span class="sxs-lookup"><span data-stu-id="0c77b-140">\[ [enable\_allocate](/windows/desktop/Midl/enable-allocate)\]</span></span>                                  | <span data-ttu-id="0c77b-141">Normalmente, nenhum.</span><span class="sxs-lookup"><span data-stu-id="0c77b-141">Usually, none.</span></span> <span data-ttu-id="0c77b-142">No entanto, o cliente pode estar usando um ambiente de gerenciamento de memória diferente.</span><span class="sxs-lookup"><span data-stu-id="0c77b-142">However, the client may be using a different memory management environment.</span></span>                                                     | <span data-ttu-id="0c77b-143">O servidor usa um ambiente de gerenciamento de memória diferente.</span><span class="sxs-lookup"><span data-stu-id="0c77b-143">Server uses a different memory management environment.</span></span> <span data-ttu-id="0c77b-144">[**RpcSmAllocate**](/windows/desktop/api/Rpcndr/nf-rpcndr-rpcsmallocate) deve ser usado para alocações.</span><span class="sxs-lookup"><span data-stu-id="0c77b-144">[**RpcSmAllocate**](/windows/desktop/api/Rpcndr/nf-rpcndr-rpcsmallocate) should be used for allocations.</span></span> |
| <span data-ttu-id="0c77b-145">\[[em](/windows/desktop/Midl/in) \] Attribute</span><span class="sxs-lookup"><span data-stu-id="0c77b-145">\[ [in](/windows/desktop/Midl/in)\]attribute</span></span>                                                    | <span data-ttu-id="0c77b-146">Aplicativo cliente responsável por alocar memória para dados.</span><span class="sxs-lookup"><span data-stu-id="0c77b-146">Client application responsible for allocating memory for data.</span></span>                                                                                 | <span data-ttu-id="0c77b-147">Alocado no servidor por stubs.</span><span class="sxs-lookup"><span data-stu-id="0c77b-147">Allocated on server by stubs.</span></span>                                                                                                 |
| <span data-ttu-id="0c77b-148">\[[out](/windows/desktop/Midl/out-idl) \] Attribute</span><span class="sxs-lookup"><span data-stu-id="0c77b-148">\[ [out](/windows/desktop/Midl/out-idl)\] attribute</span></span>                                             | <span data-ttu-id="0c77b-149">Alocado no cliente por stubs.</span><span class="sxs-lookup"><span data-stu-id="0c77b-149">Allocated on client by stubs.</span></span>                                                                                                                  | <span data-ttu-id="0c77b-150">\[[out](/windows/desktop/Midl/out-idl) \] o ponteiro somente deve ser um ponteiro de \[ [referência](/windows/desktop/Midl/ref) \] ; alocado no servidor por stubs.</span><span class="sxs-lookup"><span data-stu-id="0c77b-150">\[[out](/windows/desktop/Midl/out-idl)\]-only pointer must be \[[ref](/windows/desktop/Midl/ref)\] pointer; allocated on server by stubs.</span></span>                       |
| <span data-ttu-id="0c77b-151">\[[ref](/windows/desktop/Midl/ref) \] Attribute</span><span class="sxs-lookup"><span data-stu-id="0c77b-151">\[ [ref](/windows/desktop/Midl/ref)\] attribute</span></span>                                                 | <span data-ttu-id="0c77b-152">A memória referenciada pelo ponteiro deve ser alocada pelo aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="0c77b-152">Memory referenced by pointer must be allocated by client application.</span></span>                                                                          | <span data-ttu-id="0c77b-153">Ponteiros de referência de nível superior e de primeiro nível gerenciados por stubs.</span><span class="sxs-lookup"><span data-stu-id="0c77b-153">Top-level and first-level reference pointers managed by stubs.</span></span>                                                                |
| <span data-ttu-id="0c77b-154">\[[exclusivo](/windows/desktop/Midl/unique) \] Attribute</span><span class="sxs-lookup"><span data-stu-id="0c77b-154">\[ [unique](/windows/desktop/Midl/unique)\] attribute</span></span>                                           | <span data-ttu-id="0c77b-155">Não nulo para NULL pode resultar em memória órfãa; NULL para non-null faz com que o stub do cliente chame a [ \_ \_ alocação do usuário MIDL](/windows/desktop/Midl/midl-user-allocate-1).</span><span class="sxs-lookup"><span data-stu-id="0c77b-155">Non-null to null can result in orphaned memory; null to non-null causes client stub to call [midl\_user\_allocate](/windows/desktop/Midl/midl-user-allocate-1).</span></span> | <span data-ttu-id="0c77b-156">(Afeta o cliente.)</span><span class="sxs-lookup"><span data-stu-id="0c77b-156">(Affects client.)</span></span>                                                                                                             |
| <span data-ttu-id="0c77b-157">\[[PTR](/windows/desktop/Midl/ptr) \] Attribute</span><span class="sxs-lookup"><span data-stu-id="0c77b-157">\[ [ptr](/windows/desktop/Midl/ptr)\] attribute</span></span>                                                 | <span data-ttu-id="0c77b-158">(Consulte \[ [exclusivo](/windows/desktop/Midl/unique) \] .)</span><span class="sxs-lookup"><span data-stu-id="0c77b-158">(See \[ [unique](/windows/desktop/Midl/unique)\].)</span></span>                                                                                                              | <span data-ttu-id="0c77b-159">(Consulte \[ [exclusivo](/windows/desktop/Midl/unique) \] .)</span><span class="sxs-lookup"><span data-stu-id="0c77b-159">(See \[ [unique](/windows/desktop/Midl/unique)\].)</span></span>                                                                                             |



 

 

 