---
title: Qualidade de serviço (RPC)
description: Os programas cliente podem usar a função RpcBindingSetAuthInfoEx em vez da função RpcBindingSetAuthInfo para criar uma associação autenticada.
ms.assetid: bc3d47ba-3c1b-4aba-8fe3-b4501a621931
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee93b1aa376c9d6f4e2b3eedab73c91471d42498
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/10/2020
ms.locfileid: "103824105"
---
# <a name="quality-of-service-rpc"></a><span data-ttu-id="65c71-103">Qualidade de serviço (RPC)</span><span class="sxs-lookup"><span data-stu-id="65c71-103">Quality of Service (RPC)</span></span>

<span data-ttu-id="65c71-104">Os programas cliente podem usar a função [**RpcBindingSetAuthInfoEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfoexa) em vez da função [**RpcBindingSetAuthInfo**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfo) para criar uma associação autenticada.</span><span class="sxs-lookup"><span data-stu-id="65c71-104">Client programs can use the [**RpcBindingSetAuthInfoEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfoexa) function rather than the [**RpcBindingSetAuthInfo**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfo) function to create an authenticated binding.</span></span> <span data-ttu-id="65c71-105">Se isso for feito, eles passarão um ponteiro para uma estrutura de [**\_ \_ QoS de segurança RPC**](/windows/desktop/api/Rpcdce/ns-rpcdce-rpc_security_qos) como o parâmetro final de **RpcBindingSetAuthInfoEx**.</span><span class="sxs-lookup"><span data-stu-id="65c71-105">If they do, they pass a pointer to an [**RPC\_SECURITY\_QOS**](/windows/desktop/api/Rpcdce/ns-rpcdce-rpc_security_qos) structure as the final parameter of **RpcBindingSetAuthInfoEx**.</span></span> <span data-ttu-id="65c71-106">Essa estrutura contém informações sobre a qualidade do serviço.</span><span class="sxs-lookup"><span data-stu-id="65c71-106">This structure contains information about the quality of service.</span></span> <span data-ttu-id="65c71-107">Os programas cliente também podem especificar o controle de identidade e selecionar o tipo de representação.</span><span class="sxs-lookup"><span data-stu-id="65c71-107">Client programs can also specify the identity tracking and select the impersonation type.</span></span>

<span data-ttu-id="65c71-108">Use o membro **Capabilities** da estrutura [**de \_ \_ QoS de segurança RPC**](/windows/desktop/api/Rpcdce/ns-rpcdce-rpc_security_qos) para definir quais partes do aplicativo cliente/servidor são autenticadas.</span><span class="sxs-lookup"><span data-stu-id="65c71-108">Use the **Capabilities** member of the [**RPC\_SECURITY\_QOS**](/windows/desktop/api/Rpcdce/ns-rpcdce-rpc_security_qos) structure to set which portions of the client/server application are authenticated.</span></span> <span data-ttu-id="65c71-109">Se \_ \_ \_ \_ o padrão de recursos de QoS RPC C for selecionado, a biblioteca de tempo de execução RPC autenticará o cliente ou o servidor de acordo com o padrão para o SSP.</span><span class="sxs-lookup"><span data-stu-id="65c71-109">If RPC\_C\_QOS\_CAPABILITIES\_DEFAULT is selected, the RPC run-time library authenticates the client or server according to the default for the SSP.</span></span> <span data-ttu-id="65c71-110">Por padrão, o SSP do protocolo Kerberos autentica o cliente e o servidor.</span><span class="sxs-lookup"><span data-stu-id="65c71-110">By default, the Kerberos protocol SSP authenticates both the client and the server.</span></span> <span data-ttu-id="65c71-111">O padrão para todos os outros SSPs que a Microsoft fornece é autenticar o cliente para o servidor, mas não para autenticar o servidor para o cliente.</span><span class="sxs-lookup"><span data-stu-id="65c71-111">The default for all other SSPs that Microsoft provides is to authenticate the client to the server, but not to authenticate the server to the client.</span></span>

<span data-ttu-id="65c71-112">Se o cliente e o servidor sempre devem se autenticar entre si, defina o membro de **recursos** da estrutura de [**\_ \_ QoS de segurança RPC**](/windows/desktop/api/Rpcdce/ns-rpcdce-rpc_security_qos) para \_ \_ \_ autenticação mútua de recursos de QoS RPC C \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="65c71-112">If the client and the server should always authenticate to each other, set the **Capabilities** member of the [**RPC\_SECURITY\_QOS**](/windows/desktop/api/Rpcdce/ns-rpcdce-rpc_security_qos) structure to RPC\_C\_QOS\_CAPABILITIES\_MUTUAL\_AUTH.</span></span> <span data-ttu-id="65c71-113">Alguns provedores de segurança podem não dar suporte à autenticação mútua.</span><span class="sxs-lookup"><span data-stu-id="65c71-113">Some security providers may not support mutual authentication.</span></span> <span data-ttu-id="65c71-114">Se \_ \_ \_ a autenticação mútua dos recursos de QoS RPC C \_ \_ for especificada para esses provedores de segurança, um erro será retornado quando uma chamada de procedimento remoto for feita.</span><span class="sxs-lookup"><span data-stu-id="65c71-114">If RPC\_C\_QOS\_CAPABILITIES\_MUTUAL\_AUTH is specified for such security providers, an error is returned when a remote procedure call is made.</span></span> <span data-ttu-id="65c71-115">Ao usar o SSP do SCHANNEL, também é possível definir o membro de **recursos** para \_ os recursos de QoS RPC C \_ \_ \_ qualquer \_ autoridade.</span><span class="sxs-lookup"><span data-stu-id="65c71-115">When using the SCHANNEL SSP, it is possible to also set the **Capabilities** member to RPC\_C\_QOS\_CAPABILITIES\_ANY\_AUTHORITY.</span></span> <span data-ttu-id="65c71-116">Essa constante especifica que o SSP deve validar a chamada de procedimento remoto mesmo se a autoridade de certificação que emitiu o certificado de autenticação do cliente não estiver no repositório de certificados raiz do SSP.</span><span class="sxs-lookup"><span data-stu-id="65c71-116">This constant specifies that the SSP shall validate the remote procedure call even if the certificate authority that issued the client's authentication certificate is not in the SSP's root certificate store.</span></span> <span data-ttu-id="65c71-117">O padrão é rejeitar o certificado se o SSP não reconhecer a autoridade de certificação.</span><span class="sxs-lookup"><span data-stu-id="65c71-117">The default is to reject the certificate if the SSP does not recognize the certificate authority.</span></span> <span data-ttu-id="65c71-118">A autoridade de certificação é uma empresa ou organização independente, como a VeriSign, que emite certificados de autenticação.</span><span class="sxs-lookup"><span data-stu-id="65c71-118">The certificate authority is an independent company or organization, such as VeriSign, that issues authentication certificates.</span></span>

<span data-ttu-id="65c71-119">Os aplicativos também podem definir o controle de identidade que a biblioteca de tempo de execução RPC usa.</span><span class="sxs-lookup"><span data-stu-id="65c71-119">Applications can also set the identity tracking that the RPC run-time library uses.</span></span> <span data-ttu-id="65c71-120">Os programas geralmente usam o [*rastreamento de identidade estático*](s-glos.md).</span><span class="sxs-lookup"><span data-stu-id="65c71-120">Programs generally use [*static identity tracking*](s-glos.md).</span></span> <span data-ttu-id="65c71-121">Com o rastreamento estático, as credenciais do cliente são definidas quando ele chama a função [**RpcBindingSetAuthInfo**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfo) .</span><span class="sxs-lookup"><span data-stu-id="65c71-121">With static tracking, the client's credentials are set when it calls the [**RpcBindingSetAuthInfo**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingsetauthinfo) function.</span></span> <span data-ttu-id="65c71-122">Em seguida, a biblioteca de tempo de execução RPC usa essas credenciais para todas as chamadas RPC na associação, independentemente das alterações na identidade do thread de chamada ou do processo de chamada.</span><span class="sxs-lookup"><span data-stu-id="65c71-122">The RPC run-time library then uses those credentials for all RPC calls on the binding, regardless of changes in the identity of the calling thread or the calling process.</span></span> <span data-ttu-id="65c71-123">Os aplicativos também podem selecionar o [*controle de identidade dinâmico*](d-glos.md).</span><span class="sxs-lookup"><span data-stu-id="65c71-123">Applications can also select [*dynamic identity tracking*](d-glos.md).</span></span> <span data-ttu-id="65c71-124">O controle de identidade dinâmico instrui a biblioteca de tempo de execução RPC a usar as credenciais do thread de chamada no momento de cada chamada, em vez do identificador de ligação.</span><span class="sxs-lookup"><span data-stu-id="65c71-124">Dynamic identity tracking instructs the RPC run-time library to use the credentials of the calling thread at the time of each call, rather than the binding handle.</span></span> <span data-ttu-id="65c71-125">O controle de identidade padrão é estático.</span><span class="sxs-lookup"><span data-stu-id="65c71-125">The default identity tracking is static.</span></span>

<span data-ttu-id="65c71-126">Se a identidade do cliente não for alterada, o rastreamento de identidade estático poderá ter melhores características de desempenho e poderá salvar o tempo de execução de RPC a partir da verificação sempre que a identidade no thread de chamada for igual à identidade fornecida ao sistema de segurança.</span><span class="sxs-lookup"><span data-stu-id="65c71-126">If the identity of the client is not going to change, static identity tracking can have better performance characteristics, and can save the RPC run time from checking each time whether the identity on the calling thread is the same as the identity given to the security system.</span></span> <span data-ttu-id="65c71-127">Se a identidade do thread de chamada puder mudar entre as chamadas e o servidor precisar reconhecer essas alterações, é melhor especificar o controle de identidade dinâmico — o tempo de execução de RPC de forma silenciosa e eficiente controla a identidade para você e, se a identidade for alterada, o gerenciará essa alteração em seu nome.</span><span class="sxs-lookup"><span data-stu-id="65c71-127">If the identity of the calling thread may change between calls, and the server needs to recognize those changes, it is best to specify dynamic identity tracking—the RPC run time quietly and efficiently tracks the identity for you, and if the identity changes, manages that change on your behalf.</span></span>

> [!Note]  
> <span data-ttu-id="65c71-128">Para chamadas **Ncalrpc** , o controle de identidade estático e dinâmico tem características de desempenho diferentes e, dependendo das circunstâncias, pode ser mais rápido.</span><span class="sxs-lookup"><span data-stu-id="65c71-128">For **ncalrpc** calls, static and dynamic identity tracking have different performance characteristics, and depending on the circumstances, either may be faster.</span></span>

 

<span data-ttu-id="65c71-129">Como parte da especificação de QOS, o programa cliente também pode definir o tipo de representação que um programa de servidor pode executar em seu nome.</span><span class="sxs-lookup"><span data-stu-id="65c71-129">As part of the QOS specification, the client program can also set the type of impersonation that a server program can perform on its behalf.</span></span> <span data-ttu-id="65c71-130">Para obter mais informações, consulte [representação do cliente](client-impersonation.md).</span><span class="sxs-lookup"><span data-stu-id="65c71-130">For more information, see [Client Impersonation](client-impersonation.md).</span></span>

<span data-ttu-id="65c71-131">O campo número de versão da [**estrutura \_ \_ QoS de segurança RPC**](/windows/desktop/api/Rpcdce/ns-rpcdce-rpc_security_qos) deve ser sempre definido como a \_ versão de QoS de segurança RPC C \_ \_ \_ .</span><span class="sxs-lookup"><span data-stu-id="65c71-131">The version number field of the [**RPC\_SECURITY\_QOS**](/windows/desktop/api/Rpcdce/ns-rpcdce-rpc_security_qos) structure should always be set to RPC\_C\_SECURITY\_QOS\_VERSION.</span></span>

 

 




