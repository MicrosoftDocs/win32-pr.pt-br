---
title: Cadeias de caracteres de formato NDR de RPC
description: Cadeias de caracteres de formato NDR RPC (chamada de procedimento remoto).
ms.assetid: 9c83a039-49d3-491d-8110-29d1548730de
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cf0569a913d6c5a4b19b342cc288d6a8682dfc4a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103823952"
---
# <a name="rpc-ndr-format-strings"></a><span data-ttu-id="bb962-103">Cadeias de caracteres de formato NDR de RPC</span><span class="sxs-lookup"><span data-stu-id="bb962-103">RPC NDR Format Strings</span></span>

## <a name="ndr-engine-32-bit-interpreter"></a><span data-ttu-id="bb962-104">Mecanismo de NDR: intérprete de 32 bits</span><span class="sxs-lookup"><span data-stu-id="bb962-104">NDR Engine: 32-bit Interpreter</span></span>

<span data-ttu-id="bb962-105">Este documento descreve os descritores de cadeia de caracteres de formato, às vezes chamados de MOPs, para o mecanismo NDR de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="bb962-105">This document describes the format string descriptors, sometimes referred to as MOPs, for the 32-bit NDR engine.</span></span> <span data-ttu-id="bb962-106">Esta seção descreve as alterações associadas à evolução do intérprete [**– Oi**](/windows/desktop/Midl/-oi) para a camada de intérprete **– OIF** , bem como adições relacionadas a pipes e suporte assíncrono.</span><span class="sxs-lookup"><span data-stu-id="bb962-106">This section describes changes associated with the evolution from the [**–Oi**](/windows/desktop/Midl/-oi) interpreter to the **–Oif** interpreter layer, as well as additions related to pipes and asynchronous support.</span></span>

<span data-ttu-id="bb962-107">Este documento descreve a tecnologia de linguagem IDL da Microsoft (MIDL) atual da perspectiva do mecanismo e o mecanismo de NDR atual.</span><span class="sxs-lookup"><span data-stu-id="bb962-107">This document describes current Microsoft Interface Definition Language (MIDL) technology from the engine perspective, and the current NDR engine.</span></span>

## <a name="overview"></a><span data-ttu-id="bb962-108">Visão geral</span><span class="sxs-lookup"><span data-stu-id="bb962-108">Overview</span></span>

<span data-ttu-id="bb962-109">O mecanismo NDR é o mecanismo de marshaling dos componentes RPC (chamada de procedimento remoto) e DCOM.</span><span class="sxs-lookup"><span data-stu-id="bb962-109">The NDR engine is the marshaling engine of the Remote Procedure Call (RPC) and DCOM components.</span></span> <span data-ttu-id="bb962-110">Ele lida com todos os problemas relacionados a stub de uma chamada remota.</span><span class="sxs-lookup"><span data-stu-id="bb962-110">It handles all stub-related issues of a remote call.</span></span> <span data-ttu-id="bb962-111">Como um processo, o marshaling de NDR é controlado pelo código C de stubs gerados por MIDL, um gerador de tipo JIT de MIDL ou por stubs gerados por outras ferramentas ou gravados manualmente.</span><span class="sxs-lookup"><span data-stu-id="bb962-111">As a process, NDR marshaling is driven by the C code from MIDL-generated stubs, a MIDL JIT-type generator, or by stubs generated by other tools or written manually.</span></span> <span data-ttu-id="bb962-112">Por sua vez, o mecanismo de NDR orienta o tempo de execução subjacente (DCOM ou RPC) que se comunica com transportes específicos.</span><span class="sxs-lookup"><span data-stu-id="bb962-112">In turn, the NDR engine drives the underlying run time (DCOM or RPC) that communicates with specific transports.</span></span>

<span data-ttu-id="bb962-113">O objetivo original do design era fornecer uma ferramenta para o marshaling eficaz de dados arbitrários, com base nas informações fornecidas pelo compilador MIDL.</span><span class="sxs-lookup"><span data-stu-id="bb962-113">The original goal of the design had been to provide a tool for effective marshaling for arbitrary data, based on information provided by the MIDL compiler.</span></span> <span data-ttu-id="bb962-114">As cadeias de caracteres de formato descritas neste documento — e, de fato, todas as informações geradas pelo compilador para consumo do mecanismo de NDR — sempre foram consideradas uma interface interna entre o compilador e o mecanismo.</span><span class="sxs-lookup"><span data-stu-id="bb962-114">The format strings described in this document—and indeed all information generated by the compiler for NDR engine consumption—have always been considered an internal interface between the compiler and the engine.</span></span> <span data-ttu-id="bb962-115">Da mesma forma, as interfaces disponíveis para o mecanismo para lidar com os problemas de tempo de execução também são internas (algumas exceções existem no lado do tempo de execução RPC e algumas interfaces DCOM usadas pelo mecanismo são externas).</span><span class="sxs-lookup"><span data-stu-id="bb962-115">Similarly, interfaces available to the engine to handle run-time issues are also mostly internal (some exceptions exist on the RPC run-time side, and some DCOM interfaces used by the engine are external).</span></span>

<span data-ttu-id="bb962-116">Duas abordagens típicas ao marshaling sempre foram embutidas e a tecnologia controlada por dados (interpretada).</span><span class="sxs-lookup"><span data-stu-id="bb962-116">Two typical approaches to marshaling have always been inline and data-driven (interpreted) technology.</span></span> <span data-ttu-id="bb962-117">O MIDL dá suporte a ambos por meio de suas opções [**– os**](/windows/desktop/Midl/-os) e [**– Oi \***](/windows/desktop/Midl/-oi) em seus stubs gerados por C.</span><span class="sxs-lookup"><span data-stu-id="bb962-117">MIDL supports both through its [**–Os**](/windows/desktop/Midl/-os) and [**–Oi\***](/windows/desktop/Midl/-oi) switches in its C-generated stubs.</span></span> <span data-ttu-id="bb962-118">Além disso, o MIDL pode gerar as bibliotecas de TLB usadas pelo pacote oleautomation.</span><span class="sxs-lookup"><span data-stu-id="bb962-118">In addition, MIDL can generate the TLB libraries used by the oleautomation package.</span></span> <span data-ttu-id="bb962-119">Da mesma forma, uma perspectiva dos internos do mecanismo é que ele consiste em duas partes.</span><span class="sxs-lookup"><span data-stu-id="bb962-119">Accordingly, one perspective of the engine's internals is that it consists of two parts.</span></span>

<span data-ttu-id="bb962-120">O primeiro é um conjunto de rotinas que manipulam o dimensionamento, o marshaling e assim por diante, correspondendo a objetos de tipo de dados típicos, como uma estrutura ou uma matriz.</span><span class="sxs-lookup"><span data-stu-id="bb962-120">The first is a set of routines that handle sizing, marshaling, and so on, corresponding to typical data type objects like a structure or an array.</span></span> <span data-ttu-id="bb962-121">Essas rotinas são ajustadas para o desempenho; por exemplo, eles normalmente tentam bloquear a cópia de dados sempre que possível.</span><span class="sxs-lookup"><span data-stu-id="bb962-121">These routines are fine-tuned for performance; for example, they typically attempt to block-copy data wherever possible.</span></span> <span data-ttu-id="bb962-122">Essa parte é geralmente conhecida como o mecanismo de NDR principal.</span><span class="sxs-lookup"><span data-stu-id="bb962-122">This part is often referred to as the core NDR engine.</span></span>

<span data-ttu-id="bb962-123">A segunda parte consiste em um intérprete e suas partes relacionadas.</span><span class="sxs-lookup"><span data-stu-id="bb962-123">The second part consists of an interpreter and its related pieces.</span></span> <span data-ttu-id="bb962-124">O intérprete usa rotinas do mecanismo NDR principal, como se fosse de uma biblioteca interna, a fim de executar uma chamada remota com todos os seus argumentos com marshaling e sem marshaling, conforme apropriado.</span><span class="sxs-lookup"><span data-stu-id="bb962-124">The interpreter uses routines from the core NDR engine, as if from an internal library, in order to execute a remote call with all its arguments marshaled and unmarshaled, as appropriate.</span></span>

<span data-ttu-id="bb962-125">O mecanismo NDR principal é usado de forma semelhante, seja usado de stubs embutidos ou do intérprete.</span><span class="sxs-lookup"><span data-stu-id="bb962-125">The core NDR engine is used in a similar manner whether used from inline stubs or from the interpreter.</span></span> <span data-ttu-id="bb962-126">Todas as rotinas do mecanismo principal dependem do estado passado por uma estrutura de mensagem de stub.</span><span class="sxs-lookup"><span data-stu-id="bb962-126">All core engine routines depend on the state passed in by a stub message structure.</span></span> <span data-ttu-id="bb962-127">A estrutura é configurada adequadamente pelo stub embutido ou pelo intérprete.</span><span class="sxs-lookup"><span data-stu-id="bb962-127">The structure is set up appropriately by the inline stub or by the interpreter.</span></span> <span data-ttu-id="bb962-128">Ao longo dos anos, o mecanismo principal tinha sido usado em um contexto diferente; Atualmente, o intérprete é, na verdade, um conjunto de vários loops distintos do interpretador.</span><span class="sxs-lookup"><span data-stu-id="bb962-128">Over the years the core engine had been used in a different context; currently the interpreter is actually a set of several distinct interpreter loops.</span></span> <span data-ttu-id="bb962-129">Eles estão relacionados aos interpretadores antigos e novos ([**– Oi**](/windows/desktop/Midl/-oi) versus **– OIF**), bem como a loops relacionados à serialização de dados (seleção), ao suporte assíncrono de RPC e ao suporte assíncrono de DCOM (RPC e DCOM têm modelos de programação assíncrona diferentes).</span><span class="sxs-lookup"><span data-stu-id="bb962-129">These are related to the old and new ([**–Oi**](/windows/desktop/Midl/-oi) versus **–Oif**) interpreters, as well as to loops related to data serialization (pickling), RPC async support and DCOM async support (RPC and DCOM have different asynchronous programming models).</span></span>

<span data-ttu-id="bb962-130">Além da adição de novos recursos, um aspecto importante da evolução do mecanismo de NDR é uma mudança geral na abordagem para os interpretadores.</span><span class="sxs-lookup"><span data-stu-id="bb962-130">Beyond the addition of new features, an important aspect of the NDR engine evolution is a general shift in the approach to interpreters.</span></span> <span data-ttu-id="bb962-131">O NDR versão 1.1 começou como parte de uma nova abordagem MIDL 2,0 para realizar o marshaling, com os stubs embutidos sendo preferidos para considerações de desempenho.</span><span class="sxs-lookup"><span data-stu-id="bb962-131">NDR version1.1 began as part of a new MIDL 2.0 approach to marshaling, with the inline stubs being preferred for performance considerations.</span></span> <span data-ttu-id="bb962-132">Com a versão mais recente do NDR, [**– OIF**](/windows/desktop/Midl/-oi) tornou-se o modo mais amplamente usado do compilador, quase a exclusão de stubs embutidos.</span><span class="sxs-lookup"><span data-stu-id="bb962-132">With the most recent version of NDR, [**–Oif**](/windows/desktop/Midl/-oi) has become the most widely used mode of the compiler, almost to the exclusion of inline stubs.</span></span>

<span data-ttu-id="bb962-133">Os descritores de cadeia de caracteres de formato do mecanismo NDR RPC são descritos mais detalhadamente nos seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="bb962-133">RPC NDR Engine format string descriptors are described in more detail in the following topics:</span></span>

-   [<span data-ttu-id="bb962-134">Cadeias de caracteres de formato</span><span class="sxs-lookup"><span data-stu-id="bb962-134">Format Strings</span></span>](format-strings.md)
-   [<span data-ttu-id="bb962-135">Cadeias de caracteres de formato de procedimento</span><span class="sxs-lookup"><span data-stu-id="bb962-135">Procedure Format Strings</span></span>](procedure-format-strings.md)
-   [<span data-ttu-id="bb962-136">Descritor de cabeçalho de procedimento</span><span class="sxs-lookup"><span data-stu-id="bb962-136">Procedure Header Descriptor</span></span>](procedure-header-descriptor.md)
-   [<span data-ttu-id="bb962-137">Alças</span><span class="sxs-lookup"><span data-stu-id="bb962-137">Handles</span></span>](handles.md)
-   [<span data-ttu-id="bb962-138">O cabeçalho</span><span class="sxs-lookup"><span data-stu-id="bb962-138">The Header</span></span>](the-header.md)
-   [<span data-ttu-id="bb962-139">Descritores de parâmetro</span><span class="sxs-lookup"><span data-stu-id="bb962-139">Parameter Descriptors</span></span>](parameter-descriptors.md)
-   [<span data-ttu-id="bb962-140">Cadeias de formato de tipo</span><span class="sxs-lookup"><span data-stu-id="bb962-140">Type Format Strings</span></span>](type-format-strings.md)

 

 