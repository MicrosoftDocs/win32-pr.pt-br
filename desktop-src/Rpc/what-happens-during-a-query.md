---
title: O que acontece durante uma consulta
description: Esta seção descreve como a rede lida com a consulta quando um cliente de 32 bits procura um nome em seu próprio domínio.
ms.assetid: a8a88743-a245-4258-af05-9261c214ab50
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d6e26fb9aaef0aac2ff66260d51f756725566dee
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104159870"
---
# <a name="what-happens-during-a-query"></a><span data-ttu-id="3bfc8-103">O que acontece durante uma consulta</span><span class="sxs-lookup"><span data-stu-id="3bfc8-103">What Happens During a Query</span></span>

<span data-ttu-id="3bfc8-104">Esta seção descreve como a rede lida com a consulta quando um cliente de 32 bits procura um nome em seu próprio domínio.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-104">This section describes how the network handles the query when a 32-bit client searches for a name in its own domain.</span></span>

<span data-ttu-id="3bfc8-105">Quando o aplicativo cliente chama [**RpcNsBindingImportBegin**](/windows/desktop/api/Rpcnsi/nf-rpcnsi-rpcnsbindingimportbegina), o localizador que reside no computador cliente tentará atender a essa solicitação.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-105">When your client application calls [**RpcNsBindingImportBegin**](/windows/desktop/api/Rpcnsi/nf-rpcnsi-rpcnsbindingimportbegina), the locator residing on your client computer will try to satisfy this request.</span></span> <span data-ttu-id="3bfc8-106">Se não houver nada no cache, ele encaminhará a solicitação por RPC para um localizador mestre.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-106">If there is nothing in the cache, it will forward the request by RPC to a master locator.</span></span> <span data-ttu-id="3bfc8-107">Se o localizador mestre não encontrar nada em seu cache, ele enviará a solicitação para todos os computadores no domínio usando uma difusão de slot de email.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-107">If the master locator finds nothing in its cache, it sends the request to all the computers in the domain using a mail-slot broadcast.</span></span> <span data-ttu-id="3bfc8-108">Se houver uma correspondência, o localizador em cada computador responderá por um slot de email direcionado.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-108">If there is a match, the locator on each computer will respond by a directed mail slot.</span></span> <span data-ttu-id="3bfc8-109">(Por exemplo, se um processo nesse computador tiver exportado a interface.) As respostas são agrupadas e o RPC é concluído do localizador de processo do cliente, que responderá ao próprio processo do cliente.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-109">(For example, if a process on that computer has exported the interface.) The responses are collated and the RPC is completed from the client's process locator, which will reply to the client process itself.</span></span>

<span data-ttu-id="3bfc8-110">Em um domínio, o localizador de cliente procura um localizador mestre nos seguintes locais:</span><span class="sxs-lookup"><span data-stu-id="3bfc8-110">In a domain, the client locator searches for a master locator in the following places:</span></span>

-   <span data-ttu-id="3bfc8-111">No controlador de domínio primário</span><span class="sxs-lookup"><span data-stu-id="3bfc8-111">On the primary domain controller</span></span>
-   <span data-ttu-id="3bfc8-112">Em cada controlador de domínio de backup</span><span class="sxs-lookup"><span data-stu-id="3bfc8-112">On each backup domain controller</span></span>

<span data-ttu-id="3bfc8-113">Se uma correspondência não for encontrada, o localizador do cliente se declarará para ser o localizador mestre.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-113">If a match is not found, the client locator declares itself to be the master locator.</span></span> <span data-ttu-id="3bfc8-114">Como tal, ele transmitirá consultas se elas não puderem ser atendidas localmente.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-114">As such, it will broadcast queries if they cannot be satisfied locally.</span></span>

<span data-ttu-id="3bfc8-115">Em um grupo de trabalho, o localizador de cliente mantém um cache dos computadores cujos localizadores têm difusão.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-115">In a workgroup, the client locator maintains a cache of the computers whose locators have broadcast.</span></span> <span data-ttu-id="3bfc8-116">Ele usa aquele que está executando o mais longo que o localizador mestre.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-116">It uses the one that has been running the longest as the master locator.</span></span> <span data-ttu-id="3bfc8-117">Se esse computador não estiver disponível, o próximo computador de difusão mais longa será usado e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-117">If that computer is unavailable, the next, longest-broadcasting computer is used, and so on.</span></span> <span data-ttu-id="3bfc8-118">Se o cliente precisar de um localizador mestre e o cache estiver vazio, ele reabastecerá o cache enviando uma difusão especial de slot de email que solicita aos localizadores mestres a resposta.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-118">If the client needs a master locator and the cache is empty, it replenishes the cache by sending a special mail-slot broadcast that requests master locators to respond.</span></span> <span data-ttu-id="3bfc8-119">Se não houver respostas, o localizador do cliente se declarará para ser o localizador mestre e transmitirá as consultas se elas não puderem ser satisfeitas localmente.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-119">If there are no responses, the client locator declares itself to be the master locator and will broadcast queries if they cannot be satisfied locally.</span></span>

<span data-ttu-id="3bfc8-120">Isso mudará se o aplicativo cliente for um programa baseado em 16 bits ou em MS-dos.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-120">This changes if your client application is a 16-bit or MS-DOS-based program.</span></span> <span data-ttu-id="3bfc8-121">Nesse caso, não há nenhum localizador em execução no computador cliente e Rpcns1.dll ou Rpcnslm. RPC contém o código para localizar um localizador mestre.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-121">In this case, there is no locator running on the client computer, and Rpcns1.dll or Rpcnslm.rpc contains the code to find a master locator.</span></span> <span data-ttu-id="3bfc8-122">Todas as solicitações são encaminhadas diretamente para o localizador mestre.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-122">All requests are forwarded directly to the master locator.</span></span>

<span data-ttu-id="3bfc8-123">Essas diretrizes são válidas para nomes no domínio do cliente, como nomes de "/.:/ entryname ".</span><span class="sxs-lookup"><span data-stu-id="3bfc8-123">These guidelines are valid for names in the client's domain, such as names for "/.:/entryname".</span></span> <span data-ttu-id="3bfc8-124">Se o cliente solicitar um nome de outro domínio por meio do uso de "/.../DOMAIN/entryname;", o localizador de cliente encaminhará a solicitação para o domínio especificado, que a transmitirá se não tiver a resposta.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-124">If the client requests a name from another domain through the use of "/.../DOMAIN/entryname;" the client locator forwards the request to the specified domain which will broadcast it if it does not have the answer.</span></span> <span data-ttu-id="3bfc8-125">Se o domínio estiver inoperante ou for realmente um grupo de trabalho, a solicitação falhará.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-125">If the domain is down or is actually a workgroup, the request will fail.</span></span>

> [!Note]  
> <span data-ttu-id="3bfc8-126">Lembre-se do seguinte ao trabalhar com entradas no serviço de nome:</span><span class="sxs-lookup"><span data-stu-id="3bfc8-126">Remember the following when working with entries in the name service:</span></span>

 

-   <span data-ttu-id="3bfc8-127">Um cliente não pode usar a sintaxe "/.../DOMAIN/entryname" para localizar uma entrada em seu próprio domínio.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-127">A client cannot use the "/.../DOMAIN/entryname" syntax to find an entry in its own domain.</span></span> <span data-ttu-id="3bfc8-128">Use a sintaxe "/.:/ entryname ".</span><span class="sxs-lookup"><span data-stu-id="3bfc8-128">Use the syntax "/.:/entryname".</span></span> <span data-ttu-id="3bfc8-129">No entanto, você pode usar "/.../DOMAIN/entryname" para localizar uma entrada em outro domínio.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-129">However, you can use "/.../DOMAIN/entryname" to find an entry in another domain.</span></span>
-   <span data-ttu-id="3bfc8-130">O nome de domínio em "/.../DOMAIN/entryname" deve estar em letras maiúsculas.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-130">The domain name in "/.../DOMAIN/entryname" must be uppercase.</span></span> <span data-ttu-id="3bfc8-131">Ao procurar uma correspondência, o localizador diferencia maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-131">When looking for a match, the locator is case-sensitive.</span></span>
-   <span data-ttu-id="3bfc8-132">Os nomes de entrada do localizador também diferenciam maiúsculas de minúsculas, mas não precisam ser maiúsculos.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-132">Locator entry names are also case-sensitive, but need not be uppercase.</span></span>
-   <span data-ttu-id="3bfc8-133">Quando o cliente usa o "/.:/ entryname ", o localizador não pesquisará entradas em outros domínios, mesmo que tenham uma relação de confiança com o domínio de logon.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-133">When the client uses the "/.:/entryname" syntax, the locator will not search for entries in other domains, even if they have a trust relationship with the logon domain.</span></span>
-   <span data-ttu-id="3bfc8-134">Difusões não cruzam segmentos de LAN (por exemplo, sub-redes).</span><span class="sxs-lookup"><span data-stu-id="3bfc8-134">Broadcasts do not cross LAN segments (for example, subnets).</span></span> <span data-ttu-id="3bfc8-135">Portanto, a utilidade do localizador é limitada em uma organização com várias sub-redes.</span><span class="sxs-lookup"><span data-stu-id="3bfc8-135">Thus, the usefulness of the locator is limited in an organization with multiple subnets.</span></span>

 

 




