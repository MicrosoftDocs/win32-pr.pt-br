---
title: A teoria do controle de versão para RPC e COM
description: Teoria de controle de versão para RPC (chamada de procedimento remoto) e COM.
ms.assetid: c4df0a7b-e1be-481d-9149-317ffc9179b9
keywords:
- RPC de chamada de procedimento remoto, práticas recomendadas, controle de versão
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7e03b23c91bf69fbc3c4f72366b80812fd54330d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104084782"
---
# <a name="the-versioning-theory-for-rpc-and-com"></a><span data-ttu-id="31470-104">A teoria do controle de versão para RPC e COM</span><span class="sxs-lookup"><span data-stu-id="31470-104">The Versioning Theory for RPC and COM</span></span>

<span data-ttu-id="31470-105">Somente dois métodos totalmente infalívels dão suporte à nova funcionalidade sem risco de problemas de compatibilidade de conexão:</span><span class="sxs-lookup"><span data-stu-id="31470-105">Only two completely foolproof methods support new functionality without risk of wire compatibility problems:</span></span>

-   <span data-ttu-id="31470-106">Alterar a versão da interface de acordo com as regras; Isso impede que novos clientes se comuniquem com um servidor antigo e pode ou não impeçam que um cliente antigo se comunique com o novo servidor.</span><span class="sxs-lookup"><span data-stu-id="31470-106">Change the interface version according to the rules; this prevents new clients from communicating with an old server, and may or may not prevent an old client from communicating with the new server.</span></span> <span data-ttu-id="31470-107">Isso é esclarecido mais adiante nesta seção.</span><span class="sxs-lookup"><span data-stu-id="31470-107">This is clarified later in this section.</span></span>
-   <span data-ttu-id="31470-108">Introduza uma interface diferente lidando com a nova funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="31470-108">Introduce a different interface dealing with the new functionality.</span></span>

<span data-ttu-id="31470-109">Uma interface RPC padrão é identificada por uma combinação de GUID e número de versão; uma interface COM é identificada por seu GUID.</span><span class="sxs-lookup"><span data-stu-id="31470-109">A standard RPC interface is identified by a GUID and version number combination; a COM interface is identified by its GUID.</span></span> <span data-ttu-id="31470-110">A versão consiste em partes principais e secundárias.</span><span class="sxs-lookup"><span data-stu-id="31470-110">The version consists of major and minor parts.</span></span> <span data-ttu-id="31470-111">Para interfaces padrão com o mesmo GUID e números de versão diferentes, uma conexão só é possível quando a versão principal é a mesma, e o cliente não é maior que a versão secundária do servidor.</span><span class="sxs-lookup"><span data-stu-id="31470-111">For standard interfaces with the same GUID and different version numbers, a connection is possible only when the major version is the same, and the client is not higher than the minor version of the server.</span></span>

<span data-ttu-id="31470-112">Uma consequência é que a alteração da GUID da interface RPC interrompe a compatibilidade de conexão, ao passo que a alteração do nome da interface não.</span><span class="sxs-lookup"><span data-stu-id="31470-112">A consequence is that changing the RPC interface GUID breaks wire compatibility, while changing the interface name does not.</span></span>

<span data-ttu-id="31470-113">No RPC padrão, um caminho para atualizações e extensões é bem definido e basicamente requer que novos métodos sejam adicionados ao final da interface e os novos tipos sejam usados apenas nos novos métodos.</span><span class="sxs-lookup"><span data-stu-id="31470-113">In standard RPC, a path for upgrades and extensions is well defined, and basically requires that new methods only be added at the end of the interface, and new types be used only in the new methods.</span></span> <span data-ttu-id="31470-114">Se essas adições forem necessárias, a versão secundária deverá ser aumentada.</span><span class="sxs-lookup"><span data-stu-id="31470-114">If such additions are needed, the minor version must be increased.</span></span> <span data-ttu-id="31470-115">Qualquer outra alteração requer uma alteração na versão principal, pois o software do cliente e do servidor seria incompatível na conexão.</span><span class="sxs-lookup"><span data-stu-id="31470-115">Any other change requires a change in the major version, because the client and server software would be incompatible on the wire.</span></span> <span data-ttu-id="31470-116">Obedecer a essas regras garante que sempre que houver uma conexão entre um novo cliente e um servidor antigo, ou vice-versa, ambos os lados sejam totalmente compatíveis.</span><span class="sxs-lookup"><span data-stu-id="31470-116">Adhering to these rules assures whenever there is a connection between a new client and old server, or vice-versa, both sides are fully compatible.</span></span>

<span data-ttu-id="31470-117">Para uma interface COM, o atributo Version não pode ser usado.</span><span class="sxs-lookup"><span data-stu-id="31470-117">For a COM interface, the version attribute cannot be used.</span></span> <span data-ttu-id="31470-118">A criação de novas interfaces e a herança das interfaces antigas é equivalente à manipulação da versão no RPC.</span><span class="sxs-lookup"><span data-stu-id="31470-118">Creating new interfaces and inheriting from the old interfaces is an equivalent of manipulating the version in RPC.</span></span> <span data-ttu-id="31470-119">Normalmente, a melhor abordagem em COM é criar uma nova interface para a funcionalidade expandida.</span><span class="sxs-lookup"><span data-stu-id="31470-119">Typically, the best approach in COM is to create a new interface for the expanded functionality.</span></span> <span data-ttu-id="31470-120">Um equivalente da versão secundária é a nova interface herdada da antiga.</span><span class="sxs-lookup"><span data-stu-id="31470-120">An equivalent of the minor version is the new interface inheriting from the old one.</span></span> <span data-ttu-id="31470-121">A alteração de métodos antigos ou de tipos de dados antigos requer uma interface COM totalmente nova – uma interface que não herda da antiga.</span><span class="sxs-lookup"><span data-stu-id="31470-121">Changing old methods or old data types requires an entirely new COM interface—an interface that does not inherit from the old one.</span></span>

<span data-ttu-id="31470-122">Para COM, a função [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) é um método estabelecido para verificar se um servidor dá suporte a uma interface; Portanto, as situações em que um cliente pode se comunicar com uma versão antiga ou nova de uma interface podem ser facilmente resolvidas.</span><span class="sxs-lookup"><span data-stu-id="31470-122">For COM, the [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) function is an established method of checking whether a server supports an interface; hence, the situations where a client can talk to an old or a new version of an interface can be easily resolved.</span></span>

 

 