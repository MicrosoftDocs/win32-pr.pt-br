---
title: Desenvolvendo o servidor
description: Ao criar um programa de servidor para um aplicativo distribuído, você deve usar o arquivo de cabeçalho e o stub de servidor que o compilador de MIDL gera.
ms.assetid: 2b7b14f5-5692-41b8-bb98-7edd36309d21
keywords:
- Chamada de procedimento remoto RPC, tarefas, desenvolvendo o servidor
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0fc3405c52c48f531572ab159ad083bad93f95e0
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104294373"
---
# <a name="developing-the-server"></a><span data-ttu-id="b9c0c-104">Desenvolvendo o servidor</span><span class="sxs-lookup"><span data-stu-id="b9c0c-104">Developing the Server</span></span>

<span data-ttu-id="b9c0c-105">Ao criar um programa de servidor para um aplicativo distribuído, você deve usar o arquivo de cabeçalho e o stub de servidor que o compilador de MIDL gera.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-105">When you create a server program for a distributed application, you must use the header file and server stub that the MIDL compiler generates.</span></span> <span data-ttu-id="b9c0c-106">Para obter detalhes, consulte [desenvolvendo a interface](developing-the-interface.md).</span><span class="sxs-lookup"><span data-stu-id="b9c0c-106">For details, see [Developing the Interface](developing-the-interface.md).</span></span> <span data-ttu-id="b9c0c-107">Inclua o arquivo de cabeçalho no arquivo de programa do servidor C.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-107">Include the header file in your server C program file.</span></span> <span data-ttu-id="b9c0c-108">Compile o stub do servidor com os arquivos de origem C que compõem seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-108">Compile the server stub with the C source files that compose your application.</span></span> <span data-ttu-id="b9c0c-109">Vincule os arquivos de objeto resultantes com a biblioteca de importação.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-109">Link the resulting object files together with the import library.</span></span> <span data-ttu-id="b9c0c-110">Esse processo é ilustrado no diagrama a seguir.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-110">This process is illustrated in the following diagram.</span></span>

![processo de criação de um programa de servidor para um aplicativo distribuído](images/srvrdev.png)

<span data-ttu-id="b9c0c-112">Como você pode ver no exemplo na ilustração, um arquivo MIDL chamado MyApp. idl foi usado para definir a interface.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-112">As you can see from the example in the illustration, a MIDL file called MyApp.idl was used to define the interface.</span></span> <span data-ttu-id="b9c0c-113">O compilador MIDL usou MyApp. idl para produzir MyApp \_ s. c e MyApp. h.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-113">The MIDL compiler used MyApp.idl to produce MyApp\_s.c and MyApp.h.</span></span> <span data-ttu-id="b9c0c-114">Ele também produz um arquivo de origem C para o stub do cliente, mas isso não é relevante para essa discussão específica.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-114">It also produces a C source file for the client stub, but that is not relevant to this particular discussion.</span></span> <span data-ttu-id="b9c0c-115">O arquivo de origem C para o programa de servidor (nesse caso, Mysrvr. C) deve incluir o arquivo MyApp. h.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-115">The C source file for the server program (in this case, Mysrvr.c) must include the file Myapp.h.</span></span> <span data-ttu-id="b9c0c-116">Também será necessário incluir os arquivos RPC. h e Rpcndr. h.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-116">It will also need to include the files Rpc.h and Rpcndr.h.</span></span>

<span data-ttu-id="b9c0c-117">O aplicativo de servidor foi desenvolvido em dois arquivos, Mysrvr. c e Rprocs. c.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-117">The server application was developed in two files, Mysrvr.c and Rprocs.c.</span></span> <span data-ttu-id="b9c0c-118">O arquivo Mysrvr. c contém as funções necessárias para colocar o programa do servidor em funcionamento.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-118">The file Mysrvr.c contains the functions necessary for getting the server program up and running.</span></span> <span data-ttu-id="b9c0c-119">Os procedimentos remotos que o programa do servidor oferece estão contidos no arquivo Rprocs. c.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-119">The remote procedures that the server program offers are contained in the file Rprocs.c.</span></span>

<span data-ttu-id="b9c0c-120">Os arquivos Mysrvr. c e Rprocs. c foram compilados junto com MyApp \_ s. c para produzir arquivos de objeto.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-120">The files Mysrvr.c and Rprocs.c were compiled together with Myapp\_s.c to produce object files.</span></span> <span data-ttu-id="b9c0c-121">Os arquivos de objeto foram então vinculados com a biblioteca de tempo de execução RPC e quaisquer outras bibliotecas que possam precisar.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-121">The object files were then linked with the RPC run-time library, and any other libraries that they might need.</span></span> <span data-ttu-id="b9c0c-122">O resultado é um programa de servidor executável chamado Mysrvr.exe.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-122">The result is an executable server program named Mysrvr.exe.</span></span>

<span data-ttu-id="b9c0c-123">Se você não compilar seu arquivo IDL no modo de compatibilidade do uso (Open Software Foundation) ([**/OSF**](/windows/desktop/Midl/-osf)), o programa do servidor deverá fornecer uma função para alocar memória e uma função para desalocá-lo.</span><span class="sxs-lookup"><span data-stu-id="b9c0c-123">If you do not compile your IDL file in Open Software Foundation (OSF) compatibility mode ([**/osf**](/windows/desktop/Midl/-osf)), your server program must provide a function for allocating memory and a function for deallocating it.</span></span> <span data-ttu-id="b9c0c-124">Para o Windows 2000 e versões posteriores do Windows, o modo recomendado é [**/Oicf**](/windows/desktop/Midl/-oi).</span><span class="sxs-lookup"><span data-stu-id="b9c0c-124">For Windows 2000 and later versions of Windows, the recommended mode is [**/Oicf**](/windows/desktop/Midl/-oi).</span></span> <span data-ttu-id="b9c0c-125">Para obter detalhes, consulte [como a memória é alocada e desalocada](how-memory-is-allocated-and-deallocated.md), e [ponteiros e alocação de memória](pointers-and-memory-allocation.md).</span><span class="sxs-lookup"><span data-stu-id="b9c0c-125">For details, see [How Memory Is Allocated and Deallocated](how-memory-is-allocated-and-deallocated.md), and [Pointers and Memory Allocation](pointers-and-memory-allocation.md).</span></span>

 

 