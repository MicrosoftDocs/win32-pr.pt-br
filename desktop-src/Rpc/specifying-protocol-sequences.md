---
title: Especificando sequências de protocolo
description: Os aplicativos de servidor devem selecionar uma ou mais sequências de protocolo para usar ao se comunicar com o cliente pela rede. A escolha das sequências de protocolo é dependente da rede. Consulte interpretando informações de associação e selecionando uma sequência de protocolo.
ms.assetid: bde26a86-dc4f-4d18-ba51-c6536c62bb75
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a700299e3d2bd98fa5fb0aaebea25e907d85afb0
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104294312"
---
# <a name="specifying-protocol-sequences"></a><span data-ttu-id="9b67d-105">Especificando sequências de protocolo</span><span class="sxs-lookup"><span data-stu-id="9b67d-105">Specifying Protocol Sequences</span></span>

<span data-ttu-id="9b67d-106">Os aplicativos de servidor devem selecionar uma ou mais sequências de protocolo para usar ao se comunicar com o cliente pela rede.</span><span class="sxs-lookup"><span data-stu-id="9b67d-106">Server applications must select one or more protocol sequences to use when communicating with the client over the network.</span></span> <span data-ttu-id="9b67d-107">A escolha das sequências de protocolo é dependente da rede.</span><span class="sxs-lookup"><span data-stu-id="9b67d-107">The choice of protocol sequences is network-dependent.</span></span> <span data-ttu-id="9b67d-108">Consulte [interpretando informações de associação](interpreting-binding-information.md) e [selecionando uma sequência de protocolo](selecting-a-protocol-sequence.md).</span><span class="sxs-lookup"><span data-stu-id="9b67d-108">See [Interpreting Binding Information](interpreting-binding-information.md) and [Selecting a Protocol Sequence](selecting-a-protocol-sequence.md).</span></span>

<span data-ttu-id="9b67d-109">O programa do servidor pode permitir que os clientes se conectem usando qualquer sequência de protocolo compatível com a rede.</span><span class="sxs-lookup"><span data-stu-id="9b67d-109">Your server program may allow clients to connect using any protocol sequence that the network supports.</span></span> <span data-ttu-id="9b67d-110">Para fazer isso, invoque [**RpcServerUseAllProtseqs**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqs) e passe \_ C \_ PROTSEQ \_ Max \_ requisitos \_ Default como o primeiro parâmetro.</span><span class="sxs-lookup"><span data-stu-id="9b67d-110">To do this, invoke [**RpcServerUseAllProtseqs**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqs) and pass RPC\_C\_PROTSEQ\_MAX\_REQS\_DEFAULT as the first parameter.</span></span> <span data-ttu-id="9b67d-111">No entanto, essa não é a abordagem recomendada.</span><span class="sxs-lookup"><span data-stu-id="9b67d-111">However, that is not the recommended approach.</span></span> <span data-ttu-id="9b67d-112">Em vez disso, usar **Ncalrpc** para chamadas locais e **ncacn \_ IP \_ TCP** ou **ncacn \_ http** para chamadas remotas geralmente é suficiente.</span><span class="sxs-lookup"><span data-stu-id="9b67d-112">Rather, using **ncalrpc** for local calls and **ncacn\_ip\_tcp** or **ncacn\_http** for remote calls is usually sufficient.</span></span> <span data-ttu-id="9b67d-113">Redes heterogêneas são incomuns e praticamente todas as redes dão suporte a TCP/IP.</span><span class="sxs-lookup"><span data-stu-id="9b67d-113">Heterogenous networks are uncommon, and virtually all networks support TCP/IP.</span></span>

<span data-ttu-id="9b67d-114">Se você quiser que o cliente restrinja a alocação de porta para pontos de extremidade dinâmicos para um intervalo de porta específico, chame [**RpcServerUseAllProtseqsEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsex) em vez disso.</span><span class="sxs-lookup"><span data-stu-id="9b67d-114">If you want your client to restrict port allocation for dynamic endpoints to a specific port range, call [**RpcServerUseAllProtseqsEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsex) instead.</span></span> <span data-ttu-id="9b67d-115">Essa função é específica para o Microsoft RPC e é extremamente útil para chamadas de procedimento remoto que passam por um firewall.</span><span class="sxs-lookup"><span data-stu-id="9b67d-115">This function is specific to Microsoft RPC, and is extremely useful for remote procedure calls that pass through a firewall.</span></span> <span data-ttu-id="9b67d-116">Ele usa um parâmetro extra para passar sinalizadores de controle de alocação de porta para a função.</span><span class="sxs-lookup"><span data-stu-id="9b67d-116">It uses an extra parameter to pass port allocation control flags to the function.</span></span> <span data-ttu-id="9b67d-117">Consulte [Configurando o registro para alocações de porta e Associação seletiva](configuring-the-windows-xp-2000-nt-registry-for-port-allocations-and-selective-binding.md).</span><span class="sxs-lookup"><span data-stu-id="9b67d-117">See [Configuring the Registry for Port Allocations and Selective Binding](configuring-the-windows-xp-2000-nt-registry-for-port-allocations-and-selective-binding.md).</span></span>

<span data-ttu-id="9b67d-118">Você pode especificar sequências de protocolo e informações de ponto de extremidade no arquivo MIDL ao desenvolver as interfaces do servidor.</span><span class="sxs-lookup"><span data-stu-id="9b67d-118">You can specify protocol sequences and endpoint information in your MIDL file when you develop the server's interfaces.</span></span> <span data-ttu-id="9b67d-119">Se você fizer isso, o servidor deverá usar [**RpcServerUseAllProtseqsIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsif) para registrar todas as sequências de protocolo e as informações de ponto de extremidade associadas fornecidas no arquivo IDL.</span><span class="sxs-lookup"><span data-stu-id="9b67d-119">If you do, your server should use [**RpcServerUseAllProtseqsIf**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsif) to register all the protocol sequences and associated endpoint information provided in the IDL file.</span></span> <span data-ttu-id="9b67d-120">Além disso, há uma função [**RpcServerUseAllProtseqsIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsifex) correspondente que também permite que o servidor passe a alocação de porta – sinalizadores de controle.</span><span class="sxs-lookup"><span data-stu-id="9b67d-120">In addition, there is a corresponding [**RpcServerUseAllProtseqsIfEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseallprotseqsifex) function that also allows the server to pass port allocation–control flags.</span></span>

<span data-ttu-id="9b67d-121">Se você quiser configurar seus programas de cliente e servidor para se comunicar com uma sequência de protocolo especificada, o aplicativo de servidor deverá chamar [**RpcServerUseProtseq**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseq).</span><span class="sxs-lookup"><span data-stu-id="9b67d-121">If you want to configure your client and server programs to communicate with a specified protocol sequence, the server application should call [**RpcServerUseProtseq**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseq).</span></span> <span data-ttu-id="9b67d-122">Para obter uma lista completa de sequências de protocolo RPC da Microsoft, consulte [constantes de sequência de protocolo](protocol-sequence-constants.md).</span><span class="sxs-lookup"><span data-stu-id="9b67d-122">For a complete list of Microsoft RPC protocol sequences, see [Protocol Sequence Constants](protocol-sequence-constants.md).</span></span>

<span data-ttu-id="9b67d-123">O Microsoft RPC também fornece [**RpcServerUseProtseqEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqex) para permitir que os aplicativos selecionem sequências de protocolo específicas e controle a alocação de porta dinâmica.</span><span class="sxs-lookup"><span data-stu-id="9b67d-123">Microsoft RPC also provides [**RpcServerUseProtseqEx**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcserveruseprotseqex) to enable applications to select specific protocol sequences and control dynamic port allocation.</span></span>

<span data-ttu-id="9b67d-124">Além dos protocolos orientados a conexão, o Microsoft RPC também dá suporte a protocolos de datagrama (sem conexão).</span><span class="sxs-lookup"><span data-stu-id="9b67d-124">In addition to connection-oriented protocols, Microsoft RPC supports datagram (connectionless) protocols as well.</span></span> <span data-ttu-id="9b67d-125">Protocolos orientados a conexão são recomendados; os protocolos de datagrama têm conjuntos de recursos diferentes dos protocolos orientados a conexão e só devem ser usados se um desenvolvedor de sistema distribuído exigir um recurso disponível somente em protocolos de datagrama.</span><span class="sxs-lookup"><span data-stu-id="9b67d-125">Connection-oriented protocols are recommended; datagram protocols have different feature sets than connection-oriented protocols, and should only be used if a distributed system developer requires a feature available only in datagram protocols.</span></span> <span data-ttu-id="9b67d-126">Alguns dos recursos disponíveis ao usar os protocolos de datagrama são:</span><span class="sxs-lookup"><span data-stu-id="9b67d-126">Some of the features available when using datagram protocols are:</span></span>

-   <span data-ttu-id="9b67d-127">Os datagrams dão suporte aos protocolos de transporte sem conexão UDP e IPX.</span><span class="sxs-lookup"><span data-stu-id="9b67d-127">Datagrams support the UDP and IPX connectionless transport protocols.</span></span>
-   <span data-ttu-id="9b67d-128">Como não é necessário estabelecer e manter uma conexão, o Protocolo RPC de datagrama requer menos sobrecarga de recursos.</span><span class="sxs-lookup"><span data-stu-id="9b67d-128">Because it is not necessary to establish and maintain a connection, the datagram RPC protocol requires less resource overhead.</span></span>
-   <span data-ttu-id="9b67d-129">Os datagrams habilitam a vinculação mais rápida.</span><span class="sxs-lookup"><span data-stu-id="9b67d-129">Datagrams enable faster binding.</span></span>
-   <span data-ttu-id="9b67d-130">Assim como acontece com o RPC orientado a conexão, as chamadas RPC de datagrama são por padrão *nonidempotent*.</span><span class="sxs-lookup"><span data-stu-id="9b67d-130">As with connection-oriented RPC, datagram RPC calls are by default *nonidempotent*.</span></span> <span data-ttu-id="9b67d-131">Isso significa que a chamada tem a garantia de não ser executada mais de uma vez.</span><span class="sxs-lookup"><span data-stu-id="9b67d-131">This means the call is guaranteed not to be executed more than once.</span></span> <span data-ttu-id="9b67d-132">No entanto, uma função pode ser marcada como idempotente no arquivo IDL informando ao RPC que é inofensiva executar a função mais de uma vez em resposta a uma única solicitação de cliente.</span><span class="sxs-lookup"><span data-stu-id="9b67d-132">However, a function can be marked as idempotent in the IDL file telling RPC that it is harmless to execute the function more than once in response to a single, client request.</span></span> <span data-ttu-id="9b67d-133">Isso permite que o tempo de execução mantenha menos o estado no servidor.</span><span class="sxs-lookup"><span data-stu-id="9b67d-133">This allows the run time to maintain less state on the server.</span></span> <span data-ttu-id="9b67d-134">Observe que uma chamada idempotente seria executada novamente em raras circunstâncias em uma rede instável.</span><span class="sxs-lookup"><span data-stu-id="9b67d-134">Note that an idempotent call would be re-executed only in rare circumstances on an unstable network.</span></span>
-   <span data-ttu-id="9b67d-135">O datagrama RPC dá suporte ao atributo IDL de [difusão](/windows/desktop/Midl/broadcast) .</span><span class="sxs-lookup"><span data-stu-id="9b67d-135">Datagram RPC supports the [broadcast](/windows/desktop/Midl/broadcast) IDL attribute.</span></span> <span data-ttu-id="9b67d-136">A difusão permite que um cliente emita mensagens para vários servidores ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="9b67d-136">Broadcast enables a client to issue messages to multiple servers at the same time.</span></span> <span data-ttu-id="9b67d-137">Isso permite que o cliente Localize um dos vários servidores disponíveis na rede ou controle vários servidores simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="9b67d-137">This lets the client locate one of several available servers on the network, or control multiple servers simultaneously.</span></span> <span data-ttu-id="9b67d-138">Observe que a difusão de datagrama é válida somente dentro do link local e geralmente não cruza roteadores.</span><span class="sxs-lookup"><span data-stu-id="9b67d-138">Note that the datagram broadcast is valid only within the local link, and usually does not cross routers.</span></span> <span data-ttu-id="9b67d-139">As chamadas de difusão são implicitamente idempotentes.</span><span class="sxs-lookup"><span data-stu-id="9b67d-139">Broadcast calls are implicitly idempotent.</span></span> <span data-ttu-id="9b67d-140">Se a chamada contiver parâmetros de \[ **saída** \] , somente a primeira resposta do servidor será retornada.</span><span class="sxs-lookup"><span data-stu-id="9b67d-140">If the call contains \[**out**\] parameters, only the first server response is returned.</span></span> <span data-ttu-id="9b67d-141">Quando um servidor responde, todas as futuras RPCs sobre esse identificador de ligação serão enviadas somente para esse servidor, incluindo chamadas com o atributo de difusão.</span><span class="sxs-lookup"><span data-stu-id="9b67d-141">Once a server responds, all future RPCs over that binding handle will be sent to that server only, including calls with the broadcast attribute.</span></span> <span data-ttu-id="9b67d-142">Para enviar outra difusão, crie um novo identificador de associação ou chame [**RpcBindingReset**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingreset) no identificador existente.</span><span class="sxs-lookup"><span data-stu-id="9b67d-142">To send another broadcast, create a new binding handle or call [**RpcBindingReset**](/windows/desktop/api/Rpcdce/nf-rpcdce-rpcbindingreset) on the existing handle.</span></span>
-   <span data-ttu-id="9b67d-143">O datagrama RPC dá suporte ao atributo [talvez](/windows/desktop/Midl/maybe) IDL.</span><span class="sxs-lookup"><span data-stu-id="9b67d-143">Datagram RPC supports the [maybe](/windows/desktop/Midl/maybe) IDL attribute.</span></span> <span data-ttu-id="9b67d-144">Isso permite que o cliente envie uma chamada para o servidor sem aguardar uma resposta ou confirmação.</span><span class="sxs-lookup"><span data-stu-id="9b67d-144">This lets the client send a call to the server without waiting for a response or confirmation.</span></span> <span data-ttu-id="9b67d-145">A chamada não pode conter parâmetros de \[ **saída** \] .</span><span class="sxs-lookup"><span data-stu-id="9b67d-145">The call cannot contain \[**out**\] parameters.</span></span> <span data-ttu-id="9b67d-146">Chamadas que usam **\[ as \]** chamadas If podem ser implicitamente idempotentes.</span><span class="sxs-lookup"><span data-stu-id="9b67d-146">Calls using the **\[maybe\]** calls are implicitly idempotent.</span></span>

 

 