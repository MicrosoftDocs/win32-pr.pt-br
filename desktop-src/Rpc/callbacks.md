---
title: Retornos de chamada (RPC)
description: Geralmente, o modelo de programação exige um retorno de chamada de servidor para um cliente por meio de uma RPC (chamada de procedimento remoto) ou chamadas de cliente para um servidor não confiável. Isso introduz muitas armadilhas potenciais.
ms.assetid: a4f3ea26-ac4b-41e5-abde-96b4baedf2ae
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6260e2cff2cbaff86f210764e89d55859c4d33af
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/10/2020
ms.locfileid: "104008773"
---
# <a name="callbacks-rpc"></a><span data-ttu-id="02a3f-104">Retornos de chamada (RPC)</span><span class="sxs-lookup"><span data-stu-id="02a3f-104">Callbacks (RPC)</span></span>

<span data-ttu-id="02a3f-105">Geralmente, o modelo de programação exige um retorno de chamada de servidor para um cliente por meio de uma RPC (chamada de procedimento remoto) ou chamadas de cliente para um servidor não confiável.</span><span class="sxs-lookup"><span data-stu-id="02a3f-105">Often the programming model necessitates a server callback to a client through a remote procedure call (RPC), or client calls into an untrusted server.</span></span> <span data-ttu-id="02a3f-106">Isso introduz muitas armadilhas potenciais.</span><span class="sxs-lookup"><span data-stu-id="02a3f-106">This introduces many potential pitfalls.</span></span>

<span data-ttu-id="02a3f-107">Primeiro, o retorno de chamada para o cliente deve ser feito com um nível de representação suficientemente baixo.</span><span class="sxs-lookup"><span data-stu-id="02a3f-107">First, callback to the client must be made with a sufficiently low impersonation level.</span></span> <span data-ttu-id="02a3f-108">Se o servidor for um serviço de sistema altamente privilegiado, chamar novamente um cliente local com um nível de representação de IMPERSONATE ou superior pode fornecer ao cliente privilégios suficientes para assumir o sistema.</span><span class="sxs-lookup"><span data-stu-id="02a3f-108">If the server is a highly privileged system service, calling back a local client with an impersonation level of impersonate or higher can provide the client with privileges sufficient to take over the system.</span></span> <span data-ttu-id="02a3f-109">Chamar novamente um cliente remoto com um nível de representação mais alto do que o necessário também pode levar a consequências indesejáveis.</span><span class="sxs-lookup"><span data-stu-id="02a3f-109">Calling back a remote client with higher impersonation level than necessary can also lead to undesirable consequences.</span></span>

<span data-ttu-id="02a3f-110">Em segundo lugar, se um invasor induzir seu serviço a executar um retorno de chamada, ele poderá iniciar o que é chamado de *buraco negro*— ataque de negação de serviço.</span><span class="sxs-lookup"><span data-stu-id="02a3f-110">Second, if an attacker induces your service to perform a callback, it can launch what is called a *black hole*—denial of service attack.</span></span> <span data-ttu-id="02a3f-111">Tais ataques não são específicos do RPC; nesses ataques, um computador o induzi a enviar tráfego para ele, mas não responde às suas solicitações.</span><span class="sxs-lookup"><span data-stu-id="02a3f-111">Such attacks are not specific to RPC; in these attacks, a machine induces you to send traffic to it, but it does not respond to your requests.</span></span> <span data-ttu-id="02a3f-112">Você coleta cada vez mais recursos para chamar o buraco negro, mas eles nunca retornam.</span><span class="sxs-lookup"><span data-stu-id="02a3f-112">You sink more and more resources into calling the black hole, but they never come back.</span></span> <span data-ttu-id="02a3f-113">Um exemplo genérico desse tipo de ataque é um ataque de nível de TCP chamado ataque de inundação SYN TCP/IP.</span><span class="sxs-lookup"><span data-stu-id="02a3f-113">One generic example of such an attack is a TCP-level attack called a TCP/IP SYN flood attack.</span></span>

<span data-ttu-id="02a3f-114">No nível de RPC, um ataque de buraco negro simples ocorre quando um invasor chama uma interface e solicita que o servidor chame a interface de volta.</span><span class="sxs-lookup"><span data-stu-id="02a3f-114">On the RPC level, a simple black-hole attack occurs when an attacker calls an interface, and requests the server to call the interface back.</span></span> <span data-ttu-id="02a3f-115">A interface está em conformidade, mas o invasor nunca retorna a chamada: um thread no servidor está ligado.</span><span class="sxs-lookup"><span data-stu-id="02a3f-115">The interface complies, but the attacker never returns the call: one thread on the server is tied up.</span></span> <span data-ttu-id="02a3f-116">O invasor faz isso 100 vezes, vinculando 100 threads no servidor.</span><span class="sxs-lookup"><span data-stu-id="02a3f-116">The attacker does this 100 times, tying 100 threads on the server.</span></span> <span data-ttu-id="02a3f-117">Eventualmente, o servidor fica sem memória.</span><span class="sxs-lookup"><span data-stu-id="02a3f-117">Eventually the server runs out of memory.</span></span> <span data-ttu-id="02a3f-118">A depuração do servidor pode potencialmente revelar a identidade do chamador de buraco negro, mas, muitas vezes, o servidor será reiniciado sem suspeitar de fracasso Play, ou pode não haver conhecimento suficiente disponível para determinar o invasor.</span><span class="sxs-lookup"><span data-stu-id="02a3f-118">Debugging the server can potentially reveal the identity of the black-hole caller, but often the server will be restarted without suspecting foul play, or there may not be enough expertise available to determine the attacker.</span></span>

<span data-ttu-id="02a3f-119">A terceira armadilha está no cliente.</span><span class="sxs-lookup"><span data-stu-id="02a3f-119">The third pitfall is on the client.</span></span> <span data-ttu-id="02a3f-120">Geralmente, um cliente faz uma chamada para o servidor informando ao servidor como chamá-lo de volta (geralmente uma associação de cadeia de caracteres) e aguarda uma chamada do servidor para chegar, aceitando indistinta qualquer chamada nesse ponto de extremidade que alega ser proveniente do servidor.</span><span class="sxs-lookup"><span data-stu-id="02a3f-120">Often a client makes a call to the server informing the server how to call it back (usually a string binding), and then waits for a call from the server to arrive, blindly accepting any call on that endpoint that claims to come from the server.</span></span> <span data-ttu-id="02a3f-121">O protocolo de retorno de chamada do servidor para o cliente deve incluir algum mecanismo de verificação para garantir que quando o retorno de chamada chega ao cliente, ele realmente se originou no servidor.</span><span class="sxs-lookup"><span data-stu-id="02a3f-121">The callback protocol from the server to the client should include some verification mechanism to ensure that when the callback comes to the client, it actually originated on the server.</span></span>

 

 




