---
title: Serialização de tipo
description: O compilador MIDL gera até três funções para cada tipo ao qual o atributo \ codifique \ ou \ decodificar \ é aplicado.
ms.assetid: 948f1dd7-c8b0-4fa0-88d8-9d122de52ba1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4674617bc98c92dbc684a29d1a3c91ac6a7429e1
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104084695"
---
# <a name="type-serialization"></a><span data-ttu-id="e5f37-103">Serialização de tipo</span><span class="sxs-lookup"><span data-stu-id="e5f37-103">Type Serialization</span></span>

<span data-ttu-id="e5f37-104">O compilador MIDL gera até três funções para cada tipo ao qual o atributo de \[ [codificação](/windows/desktop/Midl/encode) \] ou \[ [decodificação](/windows/desktop/Midl/decode) \] é aplicado.</span><span class="sxs-lookup"><span data-stu-id="e5f37-104">The MIDL compiler generates up to three functions for each type to which the \[ [encode](/windows/desktop/Midl/encode)\] or \[ [decode](/windows/desktop/Midl/decode)\] attribute is applied.</span></span> <span data-ttu-id="e5f37-105">Por exemplo, para um tipo definido pelo usuário chamado *com MyType*, o compilador gera código para as \_ funções com MyType Encode, com MyType \_ decodificar e com MyType \_ AlignSize.</span><span class="sxs-lookup"><span data-stu-id="e5f37-105">For example, for a user-defined type named *MyType*, the compiler generates code for the MyType\_Encode, MyType\_Decode, and MyType\_AlignSize functions.</span></span> <span data-ttu-id="e5f37-106">Para essas funções, o compilador grava protótipos em stub. h e código-fonte para stub \_ c.c.</span><span class="sxs-lookup"><span data-stu-id="e5f37-106">For these functions, the compiler writes prototypes to Stub.h and source code to Stub\_c.c.</span></span> <span data-ttu-id="e5f37-107">Geralmente, você pode codificar um objeto *com MyType* com com MyType \_ codificar e decodificar um objeto do buffer usando \_ decodificação com MyType.</span><span class="sxs-lookup"><span data-stu-id="e5f37-107">Generally, you can encode a *MyType* object with MyType\_Encode and decode an object from the buffer using MyType\_Decode.</span></span> <span data-ttu-id="e5f37-108">Com MyType \_ AlignSize será usado se você precisar saber o tamanho do buffer de marshaling antes de alocá-lo.</span><span class="sxs-lookup"><span data-stu-id="e5f37-108">MyType\_AlignSize is used if you need to know the size of the marshaling buffer before allocating it.</span></span>

<span data-ttu-id="e5f37-109">A função de codificação a seguir é gerada pelo compilador MIDL.</span><span class="sxs-lookup"><span data-stu-id="e5f37-109">The following encoding function is generated by the MIDL compiler.</span></span> <span data-ttu-id="e5f37-110">Essa função serializa os dados para o objeto apontado por pObject, e o buffer é obtido de acordo com o método especificado no identificador.</span><span class="sxs-lookup"><span data-stu-id="e5f37-110">This function serializes the data for the object pointed to by pObject, and the buffer is obtained according to the method specified in the handle.</span></span> <span data-ttu-id="e5f37-111">Depois de gravar os dados serializados no buffer, você controla o buffer.</span><span class="sxs-lookup"><span data-stu-id="e5f37-111">After writing the serialized data to the buffer, you control the buffer.</span></span> <span data-ttu-id="e5f37-112">Observe que o identificador herda o status das chamadas anteriores e os buffers devem ser alinhados a 8.</span><span class="sxs-lookup"><span data-stu-id="e5f37-112">Note that the handle inherits the status from the previous calls, and the buffers must be aligned at 8.</span></span>

<span data-ttu-id="e5f37-113">Para um identificador implícito:</span><span class="sxs-lookup"><span data-stu-id="e5f37-113">For an implicit handle:</span></span>

``` syntax
void MyType_Encode (MyType __RPC_FAR * pObject);
```

<span data-ttu-id="e5f37-114">Para um identificador explícito:</span><span class="sxs-lookup"><span data-stu-id="e5f37-114">For an explicit handle:</span></span>

``` syntax
void MyType_Encode (handle_t Handle, MyType __RPC_FAR * pObject);
```

<span data-ttu-id="e5f37-115">A função a seguir desserializa os dados do armazenamento do aplicativo no objeto apontado por pObject.</span><span class="sxs-lookup"><span data-stu-id="e5f37-115">The following function deserializes the data from the application's storage into the object pointed to by pObject.</span></span> <span data-ttu-id="e5f37-116">Você fornece um buffer de marshaling de acordo com o método especificado na alça.</span><span class="sxs-lookup"><span data-stu-id="e5f37-116">You supply a marshaled buffer according to the method specified in the handle.</span></span> <span data-ttu-id="e5f37-117">Observe que o identificador pode herdar o status das chamadas anteriores e os buffers devem estar alinhados a 8.</span><span class="sxs-lookup"><span data-stu-id="e5f37-117">Note that the handle can inherit the status from the previous calls and the buffers must be aligned at 8.</span></span>

<span data-ttu-id="e5f37-118">Para um identificador implícito:</span><span class="sxs-lookup"><span data-stu-id="e5f37-118">For an implicit handle:</span></span>

``` syntax
void MyType_Decode (MyType __RPC_FAR * pObject);
```

<span data-ttu-id="e5f37-119">Para um identificador explícito:</span><span class="sxs-lookup"><span data-stu-id="e5f37-119">For an explicit handle:</span></span>

``` syntax
void MyType_Decode (handle_t Handle, MyType __RPC_FAR * pObject);
```

<span data-ttu-id="e5f37-120">A função a seguir retorna um tamanho, em bytes, que inclui a instância de tipo, além de quaisquer bytes de preenchimento necessários para alinhar os dados.</span><span class="sxs-lookup"><span data-stu-id="e5f37-120">The following function returns a size, in bytes, that includes the type instance plus any padding bytes needed to align the data.</span></span> <span data-ttu-id="e5f37-121">Isso permite a serialização de um conjunto de instâncias do mesmo tipo ou de tipos diferentes em um buffer, garantindo que os dados de cada objeto estejam alinhados adequadamente.</span><span class="sxs-lookup"><span data-stu-id="e5f37-121">This enables serializing a set of instances of the same or different types into a buffer while ensuring that the data for each object is appropriately aligned.</span></span> <span data-ttu-id="e5f37-122">Com MyType \_ AlignSize pressupõe que a instância apontada pelo pObject será empacotada em um buffer que começa no deslocamento alinhado a 8.</span><span class="sxs-lookup"><span data-stu-id="e5f37-122">MyType\_AlignSize assumes that the instance pointed to by pObject will be marshaled into a buffer beginning at the offset aligned at 8.</span></span>

<span data-ttu-id="e5f37-123">Para um identificador implícito:</span><span class="sxs-lookup"><span data-stu-id="e5f37-123">For an implicit handle:</span></span>

``` syntax
size_t MyType_AlignSize (MyType __RPC_FAR * pObject);
```

<span data-ttu-id="e5f37-124">Para um identificador explícito:</span><span class="sxs-lookup"><span data-stu-id="e5f37-124">For an explicit handle:</span></span>

``` syntax
size_t MyType_AlignSize (handle_t Handle, MyType __RPC_FAR * pObject);
```

<span data-ttu-id="e5f37-125">Observe que os procedimentos remotos com identificadores de ligação implícita e tipos serializados com identificadores de serialização implícitas usam a mesma variável de identificador global.</span><span class="sxs-lookup"><span data-stu-id="e5f37-125">Note that both remote procedures with implicit binding handles and serialized types with implicit serialization handles use the same global handle variable.</span></span> <span data-ttu-id="e5f37-126">Portanto, é aconselhável não misturar serialização de tipo e procedimentos remotos em uma interface com identificadores implícitos.</span><span class="sxs-lookup"><span data-stu-id="e5f37-126">Therefore, it is advisable not to mix type serialization and remote procedures in an interface with implicit handles.</span></span> <span data-ttu-id="e5f37-127">Para obter detalhes, consulte [identificadores implícitos versus explícitos](implicit-versus-explicit-handles.md).</span><span class="sxs-lookup"><span data-stu-id="e5f37-127">For details, see [Implicit Versus Explicit Handles](implicit-versus-explicit-handles.md).</span></span>

 

 