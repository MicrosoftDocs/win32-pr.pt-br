---
description: Um aplicativo de servidor protegido deve verificar os direitos de acesso de clientes antes de permitir que o cliente acesse um objeto particular protegido.
ms.assetid: dce4dd10-1d5f-40a3-8a7e-ec708d3123c7
title: Verificando o acesso a objetos privados
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c6b7b3d8b2cd933b00be0be9f1f2b077f5c7a2d2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103920991"
---
# <a name="checking-access-to-private-objects"></a><span data-ttu-id="844ce-103">Verificando o acesso a objetos privados</span><span class="sxs-lookup"><span data-stu-id="844ce-103">Checking Access to Private Objects</span></span>

<span data-ttu-id="844ce-104">Um aplicativo de servidor protegido deve verificar os direitos de acesso de um cliente antes de permitir que o cliente acesse um objeto particular protegido.</span><span class="sxs-lookup"><span data-stu-id="844ce-104">A protected server application must check a client's access rights before allowing the client to access a protected private object.</span></span> <span data-ttu-id="844ce-105">Para fazer isso, o servidor passa um [*token de representação*](/windows/desktop/SecGloss/i-gly), um descritor de segurança e um conjunto de direitos de acesso solicitados para [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck).</span><span class="sxs-lookup"><span data-stu-id="844ce-105">To do this, the server passes an [*impersonation token*](/windows/desktop/SecGloss/i-gly), a security descriptor, and a set of requested access rights to [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck).</span></span> <span data-ttu-id="844ce-106">As ACEs ( [*entradas de controle de acesso*](/windows/desktop/SecGloss/a-gly) ) na DACL [*do descritor de segurança*](/windows/desktop/SecGloss/s-gly) especificam os direitos de acesso permitidos ou negados a vários itens confiáveis.</span><span class="sxs-lookup"><span data-stu-id="844ce-106">The [*access control entries*](/windows/desktop/SecGloss/a-gly) (ACEs) in the [*security descriptor's*](/windows/desktop/SecGloss/s-gly) DACL specify the access rights allowed or denied to various trustees.</span></span> <span data-ttu-id="844ce-107">A função **AccessCheck** compara o confiável em cada ACE com os confiáveis identificados no token de representação.</span><span class="sxs-lookup"><span data-stu-id="844ce-107">The **AccessCheck** function compares the trustee in each ACE to the trustees identified in the impersonation token.</span></span> <span data-ttu-id="844ce-108">Para obter uma descrição do algoritmo usado para conceder ou negar acesso, consulte [como as DACLs controlam o acesso a um objeto](how-dacls-control-access-to-an-object.md).</span><span class="sxs-lookup"><span data-stu-id="844ce-108">For a description of the algorithm used to grant or deny access, see [How DACLs Control Access to an Object](how-dacls-control-access-to-an-object.md).</span></span>

<span data-ttu-id="844ce-109">A função [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) executa uma verificação de acesso semelhante.</span><span class="sxs-lookup"><span data-stu-id="844ce-109">The [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) function performs a similar access check.</span></span> <span data-ttu-id="844ce-110">Além disso, ele gera registros de auditoria no log de eventos de segurança, dependendo da SACL no descritor de segurança.</span><span class="sxs-lookup"><span data-stu-id="844ce-110">In addition, it generates audit records in the security event log depending on the SACL in the security descriptor.</span></span>

<span data-ttu-id="844ce-111">As funções [**AccessCheckByType**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheckbytype) e [**AccessCheckByTypeAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckbytypeandauditalarma) são semelhantes a [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) e [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) , exceto que permitem que você verifique o acesso aos subobjetos de um objeto, como conjuntos de propriedades ou propriedades.</span><span class="sxs-lookup"><span data-stu-id="844ce-111">The [**AccessCheckByType**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheckbytype) and [**AccessCheckByTypeAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckbytypeandauditalarma) functions are similar to [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) and [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) except that they allow you to check access to the subobjects of an object, such as property sets or properties.</span></span> <span data-ttu-id="844ce-112">As funções [**AccessCheckByTypeResultList**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist) e [**AccessCheckByTypeResultListAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckbytyperesultlistandauditalarma) também são semelhantes a **AccessCheck** , exceto que fornecem os resultados da verificação de acesso para cada subobjeto em uma hierarquia das propriedades e dos conjuntos de propriedades do objeto.</span><span class="sxs-lookup"><span data-stu-id="844ce-112">The [**AccessCheckByTypeResultList**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist) and [**AccessCheckByTypeResultListAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckbytyperesultlistandauditalarma) functions are also similar to **AccessCheck** except that they provide the access check results for each subobject in a hierarchy of the object's properties and property sets.</span></span> <span data-ttu-id="844ce-113">Essas funções usam a estrutura da [**\_ \_ lista de tipos de objetos**](/windows/desktop/api/Winnt/ns-winnt-object_type_list) para descrever a hierarquia de objetos para os quais o acesso está marcado.</span><span class="sxs-lookup"><span data-stu-id="844ce-113">These functions use the [**OBJECT\_TYPE\_LIST**](/windows/desktop/api/Winnt/ns-winnt-object_type_list) structure to describe the hierarchy of objects for which access is checked.</span></span> <span data-ttu-id="844ce-114">As funções que geram uma mensagem de auditoria usam o tipo de enumeração de [**\_ \_ tipo de evento Audit**](/windows/desktop/api/Winnt/ne-winnt-audit_event_type) para indicar se o objeto que está sendo verificado é um objeto de serviço de diretório.</span><span class="sxs-lookup"><span data-stu-id="844ce-114">The functions that generate an audit message use the [**AUDIT\_EVENT\_TYPE**](/windows/desktop/api/Winnt/ne-winnt-audit_event_type) enumeration type to indicate whether the object being checked is a directory service object.</span></span> <span data-ttu-id="844ce-115">Para obter mais informações sobre a hierarquia de um objeto e seus subobjetos, consulte [ACEs para controlar o acesso às propriedades de um objeto](aces-to-control-access-to-an-object-s-properties.md).</span><span class="sxs-lookup"><span data-stu-id="844ce-115">For more information about the hierarchy of an object and its subobjects, see [ACEs to Control Access to an Object's Properties](aces-to-control-access-to-an-object-s-properties.md).</span></span>

<span data-ttu-id="844ce-116">Os direitos de acesso solicitados passados para as funções [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) e [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) não devem incluir nenhum [direito de acesso genérico](generic-access-rights.md).</span><span class="sxs-lookup"><span data-stu-id="844ce-116">The requested access rights passed to the [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) and [**AccessCheckAndAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-accesscheckandauditalarma) functions must not include any [generic access rights](generic-access-rights.md).</span></span> <span data-ttu-id="844ce-117">O servidor pode usar a função [**MapGenericMask**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-mapgenericmask) para converter qualquer direito de acesso genérico aos direitos específicos e padrão correspondentes, de acordo com o mapeamento especificado na estrutura de [**\_ mapeamento genérico**](/windows/desktop/api/Winnt/ns-winnt-generic_mapping) .</span><span class="sxs-lookup"><span data-stu-id="844ce-117">The server can use the [**MapGenericMask**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-mapgenericmask) function to convert any generic access rights to the corresponding specific and standard rights according to the mapping specified in the [**GENERIC\_MAPPING**](/windows/desktop/api/Winnt/ns-winnt-generic_mapping) structure.</span></span>

<span data-ttu-id="844ce-118">As funções [**AreAllAccessesGranted**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-areallaccessesgranted) e [**AreAnyAccessesGranted**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-areanyaccessesgranted) comparam uma [*máscara de acesso*](/windows/desktop/SecGloss/a-gly) solicitada com uma máscara de acesso concedida.</span><span class="sxs-lookup"><span data-stu-id="844ce-118">The [**AreAllAccessesGranted**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-areallaccessesgranted) and [**AreAnyAccessesGranted**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-areanyaccessesgranted) functions compare a requested [*access mask*](/windows/desktop/SecGloss/a-gly) with a granted access mask.</span></span>

<span data-ttu-id="844ce-119">Para obter o código de exemplo que usa a função [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) , consulte [verificando o acesso do cliente com ACLs em C++](verifying-client-access-with-acls-in-c--.md).</span><span class="sxs-lookup"><span data-stu-id="844ce-119">For sample code that uses the [**AccessCheck**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-accesscheck) function, see [Verifying Client Access with ACLs in C++](verifying-client-access-with-acls-in-c--.md).</span></span>

<span data-ttu-id="844ce-120">A função [**ConvertToAutoInheritPrivateObjectSecurity**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-converttoautoinheritprivateobjectsecurity) cria e retorna um descritor de segurança em um formato que permite a propagação automática de ACEs herdáveis.</span><span class="sxs-lookup"><span data-stu-id="844ce-120">The [**ConvertToAutoInheritPrivateObjectSecurity**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-converttoautoinheritprivateobjectsecurity) function creates and returns a security descriptor in a format that allows the automatic propagation of inheritable ACEs.</span></span> <span data-ttu-id="844ce-121">Este descritor de segurança contém todas as ACEs, herdadas e não herdadas, no descritor de segurança atual e está em formato [*auto-relativo*](/windows/desktop/SecGloss/s-gly) .</span><span class="sxs-lookup"><span data-stu-id="844ce-121">This security descriptor contains all of the ACEs, inherited and noninherited, in the current security descriptor and is in [*self-relative*](/windows/desktop/SecGloss/s-gly) format.</span></span> <span data-ttu-id="844ce-122">A função **ConvertToAutoInheritPrivateObjectSecurity** determina se as ACEs são herdadas ou não herdadas, comparando todas as ACEs no descritor de segurança atual com todas as ACEs em seu descritor de segurança pai.</span><span class="sxs-lookup"><span data-stu-id="844ce-122">The **ConvertToAutoInheritPrivateObjectSecurity** function determines whether the ACEs are inherited or noninherited by comparing all of the ACEs in the current security descriptor with all of the ACEs in its parent security descriptor.</span></span> <span data-ttu-id="844ce-123">Pode não haver uma correspondência um-para-um entre os dois grupos de ACEs.</span><span class="sxs-lookup"><span data-stu-id="844ce-123">There may not be a one-to-one correspondence between the two groups of ACEs.</span></span> <span data-ttu-id="844ce-124">Por exemplo, uma ACE que permite permissão de leitura/gravação pode ser equivalente a duas ACEs: uma ACE que permite a permissão de leitura e uma ACE que permite a permissão de gravação.</span><span class="sxs-lookup"><span data-stu-id="844ce-124">For instance, an ACE that allows read/write permission can be equivalent to two ACEs: an ACE that allows read permission and an ACE that allows write permission.</span></span> <span data-ttu-id="844ce-125">Um descritor de segurança pai não pode ser fornecido quando o descritor de segurança atual é o pai.</span><span class="sxs-lookup"><span data-stu-id="844ce-125">A parent security descriptor may not be supplied when the current security descriptor is the parent.</span></span>

 

 
