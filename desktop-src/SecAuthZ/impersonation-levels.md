---
description: A enumeração de nível de representação de segurança \_ \_ define quatro níveis de representação que determinam as operações que um servidor pode executar no contexto de clientes.
ms.assetid: ae152dbf-44f0-417f-a85e-09bf60dcfcb0
title: Níveis de representação (autorização)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b91654f42a86e5c47069197bed084df56f5445dd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105769194"
---
# <a name="impersonation-levels-authorization"></a><span data-ttu-id="d5483-103">Níveis de representação (autorização)</span><span class="sxs-lookup"><span data-stu-id="d5483-103">Impersonation Levels (Authorization)</span></span>

<span data-ttu-id="d5483-104">A enumeração de [**\_ \_ nível de representação de segurança**](/windows/desktop/api/Winnt/ne-winnt-security_impersonation_level) define quatro níveis de representação que determinam as operações que um servidor pode executar no contexto do cliente.</span><span class="sxs-lookup"><span data-stu-id="d5483-104">The [**SECURITY\_IMPERSONATION\_LEVEL**](/windows/desktop/api/Winnt/ne-winnt-security_impersonation_level) enumeration defines four impersonation levels that determine the operations a server can perform in the client's context.</span></span>



| <span data-ttu-id="d5483-105">Nível de representação</span><span class="sxs-lookup"><span data-stu-id="d5483-105">Impersonation level</span></span>    | <span data-ttu-id="d5483-106">Descrição</span><span class="sxs-lookup"><span data-stu-id="d5483-106">Description</span></span>                                                                                      |
|------------------------|--------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d5483-107">SecurityAnonymous</span><span class="sxs-lookup"><span data-stu-id="d5483-107">SecurityAnonymous</span></span>      | <span data-ttu-id="d5483-108">O servidor não pode representar ou identificar o cliente.</span><span class="sxs-lookup"><span data-stu-id="d5483-108">The server cannot impersonate or identify the client.</span></span>                                            |
| <span data-ttu-id="d5483-109">SecurityIdentification</span><span class="sxs-lookup"><span data-stu-id="d5483-109">SecurityIdentification</span></span> | <span data-ttu-id="d5483-110">O servidor pode obter a identidade e os privilégios do cliente, mas não pode representar o cliente.</span><span class="sxs-lookup"><span data-stu-id="d5483-110">The server can get the identity and privileges of the client, but cannot impersonate the client.</span></span> |
| <span data-ttu-id="d5483-111">SecurityImpersonation</span><span class="sxs-lookup"><span data-stu-id="d5483-111">SecurityImpersonation</span></span>  | <span data-ttu-id="d5483-112">O servidor pode representar o contexto de segurança do cliente no sistema local.</span><span class="sxs-lookup"><span data-stu-id="d5483-112">The server can impersonate the client's security context on the local system.</span></span>                    |
| <span data-ttu-id="d5483-113">SecurityDelegation</span><span class="sxs-lookup"><span data-stu-id="d5483-113">SecurityDelegation</span></span>     | <span data-ttu-id="d5483-114">O servidor pode representar o contexto de segurança do cliente em sistemas remotos.</span><span class="sxs-lookup"><span data-stu-id="d5483-114">The server can impersonate the client's security context on remote systems.</span></span>                      |



 

<span data-ttu-id="d5483-115">O cliente de um pipe nomeado, RPC ou conexão DDE pode controlar o nível de representação.</span><span class="sxs-lookup"><span data-stu-id="d5483-115">The client of a named pipe, RPC, or DDE connection can control the impersonation level.</span></span> <span data-ttu-id="d5483-116">Por exemplo, um cliente de pipe nomeado pode chamar a função [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) para abrir um identificador para um pipe nomeado e especificar o nível de representação do servidor.</span><span class="sxs-lookup"><span data-stu-id="d5483-116">For example, a named pipe client can call the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function to open a handle to a named pipe and specify the server's impersonation level.</span></span>

<span data-ttu-id="d5483-117">Quando o pipe nomeado, RPC ou conexão DDE é remoto, os sinalizadores passados para [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) para definir o nível de representação são ignorados.</span><span class="sxs-lookup"><span data-stu-id="d5483-117">When the named pipe, RPC, or DDE connection is remote, the flags passed to [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) to set the impersonation level are ignored.</span></span> <span data-ttu-id="d5483-118">Nesse caso, o nível de representação do cliente é determinado pelos níveis de representação habilitados pelo servidor, que é definido por um sinalizador na conta do servidor no serviço de diretório.</span><span class="sxs-lookup"><span data-stu-id="d5483-118">In this case, the impersonation level of the client is determined by the impersonation levels enabled by the server, which is set by a flag on the server's account in the directory service.</span></span> <span data-ttu-id="d5483-119">Por exemplo, se o servidor estiver habilitado para delegação, o nível de representação do cliente também será definido como delegação, mesmo que os sinalizadores passados para **CreateFile** especifiquem o nível de representação de identificação.</span><span class="sxs-lookup"><span data-stu-id="d5483-119">For example, if the server is enabled for delegation, the client's impersonation level will also be set to delegation even if the flags passed to **CreateFile** specify the identification impersonation level.</span></span>

<span data-ttu-id="d5483-120">Os clientes DDE usam a função [**DdeSetQualityOfService**](/windows/win32/api/dde/nf-dde-ddesetqualityofservice) com a estrutura [**\_ \_ de qualidade de \_ serviço de segurança**](/windows/desktop/api/Winnt/ns-winnt-security_quality_of_service) para especificar o nível de representação.</span><span class="sxs-lookup"><span data-stu-id="d5483-120">DDE clients use the [**DdeSetQualityOfService**](/windows/win32/api/dde/nf-dde-ddesetqualityofservice) function with the [**SECURITY\_QUALITY\_OF\_SERVICE**](/windows/desktop/api/Winnt/ns-winnt-security_quality_of_service) structure to specify the impersonation level.</span></span> <span data-ttu-id="d5483-121">O nível de SecurityImpersonation é o padrão para servidores de pipe nomeado, RPC e DDE.</span><span class="sxs-lookup"><span data-stu-id="d5483-121">The SecurityImpersonation level is the default for named pipe, RPC, and DDE servers.</span></span> <span data-ttu-id="d5483-122">As funções [**ImpersonateSelf**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateself), [**DuplicateToken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetoken)e [**DuplicateTokenEx**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex) permitem que o chamador especifique um nível de representação.</span><span class="sxs-lookup"><span data-stu-id="d5483-122">The [**ImpersonateSelf**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateself), [**DuplicateToken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetoken), and [**DuplicateTokenEx**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex) functions allow the caller to specify an impersonation level.</span></span> <span data-ttu-id="d5483-123">Use a função [**GetTokenInformation**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation) para recuperar o nível de representação de um [*token de acesso*](/windows/desktop/SecGloss/a-gly).</span><span class="sxs-lookup"><span data-stu-id="d5483-123">Use the [**GetTokenInformation**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation) function to retrieve the impersonation level of an [*access token*](/windows/desktop/SecGloss/a-gly).</span></span>

<span data-ttu-id="d5483-124">No nível de SecurityImpersonation, a maioria das ações do thread ocorre no contexto de segurança do [*token de representação*](/windows/desktop/SecGloss/i-gly) do thread, em vez de no [*token primário*](/windows/desktop/SecGloss/p-gly) do [*processo*](/windows/desktop/SecGloss/p-gly) que possui o thread.</span><span class="sxs-lookup"><span data-stu-id="d5483-124">At the SecurityImpersonation level, most of the thread's actions occur in the security context of the thread's [*impersonation token*](/windows/desktop/SecGloss/i-gly) rather than in the [*primary token*](/windows/desktop/SecGloss/p-gly) of the [*process*](/windows/desktop/SecGloss/p-gly) that owns the thread.</span></span> <span data-ttu-id="d5483-125">Por exemplo, se um thread de representação abrir um [objeto protegível](securable-objects.md), o sistema usará o token de representação para verificar o acesso do thread.</span><span class="sxs-lookup"><span data-stu-id="d5483-125">For example, if an impersonating thread opens a [securable object](securable-objects.md), the system uses the impersonation token to check the thread's access.</span></span> <span data-ttu-id="d5483-126">Da mesma forma, se um thread de representação criar um novo objeto, por exemplo, chamando a função [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) , o proprietário do novo objeto será o proprietário padrão do [*token de acesso*](/windows/desktop/SecGloss/a-gly)do cliente.</span><span class="sxs-lookup"><span data-stu-id="d5483-126">Similarly, if an impersonating thread creates a new object, for example by calling the [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) function, the owner of the new object is the default owner from the client's [*access token*](/windows/desktop/SecGloss/a-gly).</span></span>

<span data-ttu-id="d5483-127">No entanto, o sistema usa o token primário do processo em vez do token de representação do thread de chamada nas seguintes situações:</span><span class="sxs-lookup"><span data-stu-id="d5483-127">However, the system uses the primary token of the process rather than the impersonation token of the calling thread in the following situations:</span></span>

-   <span data-ttu-id="d5483-128">Se um thread de representação chamar a função [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) , o novo processo sempre herdará o token primário do processo.</span><span class="sxs-lookup"><span data-stu-id="d5483-128">If an impersonating thread calls the [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) function, the new process always inherits the primary token of the process.</span></span>
-   <span data-ttu-id="d5483-129">Para funções que exigem o \_ privilégio de \_ nome TCB se, como a função [**LogonUser**](/windows/desktop/api/winbase/nf-winbase-logonusera) , o sistema sempre verifica o privilégio no token primário do processo.</span><span class="sxs-lookup"><span data-stu-id="d5483-129">For functions that require the SE\_TCB\_NAME privilege, such as the [**LogonUser**](/windows/desktop/api/winbase/nf-winbase-logonusera) function, the system always checks for the privilege in the primary token of the process.</span></span>
-   <span data-ttu-id="d5483-130">Para funções que exigem o \_ privilégio de nome de auditoria se \_ , como a função [**ObjectOpenAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-objectopenauditalarma) , o sistema sempre verifica o privilégio no token primário do processo.</span><span class="sxs-lookup"><span data-stu-id="d5483-130">For functions that require the SE\_AUDIT\_NAME privilege, such as the [**ObjectOpenAuditAlarm**](/windows/desktop/api/Winbase/nf-winbase-objectopenauditalarma) function, the system always checks for the privilege in the primary token of the process.</span></span>
-   <span data-ttu-id="d5483-131">Em uma chamada para a função [**OpenThreadToken**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) , um thread pode especificar se a função usa o token de representação ou o token primário para determinar se deve conceder o acesso solicitado.</span><span class="sxs-lookup"><span data-stu-id="d5483-131">In a call to the [**OpenThreadToken**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) function, a thread can specify whether the function uses the impersonation token or the primary token to determine whether to grant the requested access.</span></span>

 

 
