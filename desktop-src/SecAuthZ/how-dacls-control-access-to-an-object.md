---
description: Quando um thread tenta acessar um objeto protegível, o sistema concede ou nega acesso.
ms.assetid: dc98b23e-ce42-4d4a-a285-c0b7b5e2a478
title: Como a AccessCheck funciona
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 730cc8f63e7d69bf4cb38344f5eda60861d08a9f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "104558850"
---
# <a name="how-accesscheck-works"></a><span data-ttu-id="3a1b3-103">Como a AccessCheck funciona</span><span class="sxs-lookup"><span data-stu-id="3a1b3-103">How AccessCheck Works</span></span>

<span data-ttu-id="3a1b3-104">Quando um thread tenta acessar um objeto protegível, o sistema concede ou nega acesso.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-104">When a thread tries to access a securable object, the system either grants or denies access.</span></span> <span data-ttu-id="3a1b3-105">Se o objeto não tiver uma DACL ( [*lista de controle de acesso discricionário*](/windows/desktop/SecGloss/d-gly) ), o sistema concederá acesso; caso contrário, o sistema procura por ACEs ( [entradas de controle de acesso](access-control-entries.md) ) no DACL do objeto que se aplicam ao thread.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-105">If the object does not have a [*discretionary access control list*](/windows/desktop/SecGloss/d-gly) (DACL), the system grants access; otherwise, the system looks for [Access Control Entries](access-control-entries.md) (ACEs) in the object's DACL that apply to the thread.</span></span> <span data-ttu-id="3a1b3-106">Cada ACE na DACL do objeto especifica os direitos de acesso permitidos ou negados para um objeto de [confiança](trustees.md), que pode ser uma conta de usuário, uma conta de grupo ou uma [*sessão de logon*](/windows/desktop/SecGloss/l-gly).</span><span class="sxs-lookup"><span data-stu-id="3a1b3-106">Each ACE in the object's DACL specifies the access rights allowed or denied for a [trustee](trustees.md), which can be a user account, a group account, or a [*logon session*](/windows/desktop/SecGloss/l-gly).</span></span>

## <a name="dacls"></a><span data-ttu-id="3a1b3-107">DACLs</span><span class="sxs-lookup"><span data-stu-id="3a1b3-107">DACLs</span></span>

<span data-ttu-id="3a1b3-108">O sistema compara o confiável em cada ACE com os confiáveis identificados no [token de acesso](access-tokens.md)do thread.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-108">The system compares the trustee in each ACE to the trustees identified in the thread's [access token](access-tokens.md).</span></span> <span data-ttu-id="3a1b3-109">Um token de acesso contém SIDs ( [*identificadores de segurança*](/windows/desktop/SecGloss/s-gly) ) que identificam o usuário e as contas de grupo às quais o usuário pertence.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-109">An access token contains [*security identifiers*](/windows/desktop/SecGloss/s-gly) (SIDs) that identify the user and the group accounts to which the user belongs.</span></span> <span data-ttu-id="3a1b3-110">Um token também contém um [*Sid de logon*](/windows/desktop/SecGloss/l-gly) que identifica a sessão de logon atual.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-110">A token also contains a [*logon SID*](/windows/desktop/SecGloss/l-gly) that identifies the current logon session.</span></span> <span data-ttu-id="3a1b3-111">Durante uma verificação de acesso, o sistema ignora os SIDs de grupo que não estão habilitados.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-111">During an access check, the system ignores group SIDs that are not enabled.</span></span> <span data-ttu-id="3a1b3-112">Para obter mais informações sobre SIDs habilitados, desabilitados e somente negados, consulte [atributos de Sid em um token de acesso](sid-attributes-in-an-access-token.md).</span><span class="sxs-lookup"><span data-stu-id="3a1b3-112">For more information on enabled, disabled, and deny-only SIDs, see [SID Attributes in an Access Token](sid-attributes-in-an-access-token.md).</span></span>

<span data-ttu-id="3a1b3-113">Normalmente, o sistema usa o [*token de acesso primário*](/windows/desktop/SecGloss/p-gly) do thread que está solicitando o acesso.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-113">Typically, the system uses the [*primary access token*](/windows/desktop/SecGloss/p-gly) of the thread that is requesting access.</span></span> <span data-ttu-id="3a1b3-114">No entanto, se o thread estiver representando outro usuário, o sistema usará o [*token de representação*](/windows/desktop/SecGloss/i-gly)do thread.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-114">However, if the thread is impersonating another user, the system uses the thread's [*impersonation token*](/windows/desktop/SecGloss/i-gly).</span></span>

<span data-ttu-id="3a1b3-115">O sistema examina cada ACE em sequência até que ocorra um dos seguintes eventos:</span><span class="sxs-lookup"><span data-stu-id="3a1b3-115">The system examines each ACE in sequence until one of the following events occurs:</span></span>

-   <span data-ttu-id="3a1b3-116">Uma ACE com acesso negado nega explicitamente qualquer um dos [direitos de acesso](access-rights-and-access-masks.md) solicitados a um dos os confiáveis listados no token de acesso do thread.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-116">An access-denied ACE explicitly denies any of the requested [access rights](access-rights-and-access-masks.md) to one of the trustees listed in the thread's access token.</span></span>
-   <span data-ttu-id="3a1b3-117">Uma ou mais ACEs permitidas pelo Access para os confiáveis listados no token de acesso do thread concedem explicitamente todos os direitos de acesso solicitados.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-117">One or more access-allowed ACEs for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>
-   <span data-ttu-id="3a1b3-118">Todas as ACEs foram verificadas e ainda há pelo menos um direito de acesso solicitado que não tenha sido explicitamente permitido; nesse caso, o acesso é negado implicitamente.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-118">All ACEs have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>

<span data-ttu-id="3a1b3-119">A ilustração a seguir mostra como a DACL de um objeto pode permitir o acesso a um thread negando acesso a outro.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-119">The following illustration shows how an object's DACL can allow access to one thread while denying access to another.</span></span>

![DACL que concede direitos de acesso diferentes a threads diferentes](images/accctrl1.png)

<span data-ttu-id="3a1b3-121">Para o thread A, o sistema lê a ACE 1 e imediatamente nega o acesso porque a ACE de acesso negado se aplica ao usuário no token de acesso do thread.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-121">For Thread A, the system reads ACE 1 and immediately denies access because the access-denied ACE applies to the user in the thread's access token.</span></span> <span data-ttu-id="3a1b3-122">Nesse caso, o sistema não verifica as ACEs 2 e 3.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-122">In this case, the system does not check ACEs 2 and 3.</span></span> <span data-ttu-id="3a1b3-123">Para o thread B, o ACE 1 não se aplica, portanto, o sistema prossegue para o ás 2, que permite acesso de gravação e ACE 3, que permite acesso de leitura e execução.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-123">For Thread B, ACE 1 does not apply, so the system proceeds to ACE 2, which allows write access, and ACE 3 which allows read and execute access.</span></span>

<span data-ttu-id="3a1b3-124">Como o sistema para de verificar as ACEs quando o acesso solicitado é explicitamente concedido ou negado, a ordem das ACEs em uma DACL é importante.</span><span class="sxs-lookup"><span data-stu-id="3a1b3-124">Because the system stops checking ACEs when the requested access is explicitly granted or denied, the order of ACEs in a DACL is important.</span></span> <span data-ttu-id="3a1b3-125">Observe que, se a ordem de ACE fosse diferente no exemplo, o sistema pode ter concedido acesso ao thread A. Para objetos do sistema, o sistema operacional define uma [ordem preferida de ACEs em uma DACL](order-of-aces-in-a-dacl.md).</span><span class="sxs-lookup"><span data-stu-id="3a1b3-125">Note that if the ACE order were different in the example, the system might have granted access to Thread A. For system objects, the operating system defines a preferred [order of ACEs in a DACL](order-of-aces-in-a-dacl.md).</span></span>

 

 
