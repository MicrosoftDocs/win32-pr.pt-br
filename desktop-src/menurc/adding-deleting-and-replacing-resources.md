---
title: Adicionando, excluindo e substituindo recursos
description: Este tópico discute como adicionar, excluir ou substituir recursos.
ms.assetid: 15b1086e-e3a2-460a-828b-17db5105309f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 941c12a1531e422efe44cbd0b3deca9f89838698
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "105748363"
---
# <a name="adding-deleting-and-replacing-resources"></a><span data-ttu-id="89eff-103">Adicionando, excluindo e substituindo recursos</span><span class="sxs-lookup"><span data-stu-id="89eff-103">Adding, Deleting, and Replacing Resources</span></span>

<span data-ttu-id="89eff-104">Os aplicativos sempre devem adicionar, excluir ou substituir recursos em arquivos executáveis.</span><span class="sxs-lookup"><span data-stu-id="89eff-104">Applications must frequently add, delete, or replace resources in executable files.</span></span> <span data-ttu-id="89eff-105">Dois métodos podem ser usados para realizar essas tarefas.</span><span class="sxs-lookup"><span data-stu-id="89eff-105">Two methods can be used to accomplish these tasks.</span></span> <span data-ttu-id="89eff-106">A primeira é editar o arquivo de definição de recurso, recompilar os recursos e adicionar os recursos recompilados ao arquivo executável do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="89eff-106">The first is to edit the resource-definition file, recompile the resources, and add the recompiled resources to the application's executable file.</span></span> <span data-ttu-id="89eff-107">O segundo método é copiar os dados do recurso diretamente no arquivo executável do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="89eff-107">The second method is to copy the resource data directly into the application's executable file.</span></span>

<span data-ttu-id="89eff-108">Por exemplo, para localizar um aplicativo em inglês para uso na Noruega, pode ser necessário substituir a caixa de diálogo em inglês por uma usando norueguês.</span><span class="sxs-lookup"><span data-stu-id="89eff-108">For example, to localize an English-language application for use in Norway, it may be necessary to replace the English dialog box with one using Norwegian.</span></span> <span data-ttu-id="89eff-109">Um desenvolvedor cria uma caixa de diálogo apropriada usando um editor de caixa de diálogo ou escrevendo um modelo no arquivo de definição de recurso.</span><span class="sxs-lookup"><span data-stu-id="89eff-109">A developer creates an appropriate dialog box by using a dialog box editor or by writing a template in the resource-definition file.</span></span> <span data-ttu-id="89eff-110">Em seguida, o desenvolvedor recompila os recursos e adiciona os novos recursos ao arquivo executável do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="89eff-110">The developer then recompiles the resources and adds the new resources to the application's executable file.</span></span>

<span data-ttu-id="89eff-111">No entanto, se houver uma caixa de diálogo apropriada em formato binário, o desenvolvedor poderá copiar os dados diretamente para o arquivo executável que está sendo localizado usando as funções a seguir.</span><span class="sxs-lookup"><span data-stu-id="89eff-111">If an appropriate dialog box exists in binary form, however, the developer can copy the data directly to the executable file being localized by using the following functions.</span></span> <span data-ttu-id="89eff-112">A função [**BeginUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-beginupdateresourcea) cria um identificador de atualização para o arquivo executável cujos recursos devem ser alterados.</span><span class="sxs-lookup"><span data-stu-id="89eff-112">The [**BeginUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-beginupdateresourcea) function creates an update handle to the executable file whose resources are to be changed.</span></span> <span data-ttu-id="89eff-113">A função [**UpdateResource**](/windows/desktop/api/Winbase/nf-winbase-updateresourcea) usa esse identificador para adicionar, excluir ou substituir um recurso no arquivo executável.</span><span class="sxs-lookup"><span data-stu-id="89eff-113">The [**UpdateResource**](/windows/desktop/api/Winbase/nf-winbase-updateresourcea) function uses this handle to add, delete, or replace a resource in the executable file.</span></span> <span data-ttu-id="89eff-114">A função [**EndUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-endupdateresourcea) fecha o identificador.</span><span class="sxs-lookup"><span data-stu-id="89eff-114">The [**EndUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-endupdateresourcea) function closes the handle.</span></span>

<span data-ttu-id="89eff-115">Depois que um identificador de atualização para um arquivo executável é criado pelo [**BeginUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-beginupdateresourcea), um aplicativo pode usar o [**UpdateResource**](/windows/desktop/api/Winbase/nf-winbase-updateresourcea) repetidamente para fazer alterações nos dados do recurso.</span><span class="sxs-lookup"><span data-stu-id="89eff-115">After an update handle to an executable file is created by [**BeginUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-beginupdateresourcea), an application can use [**UpdateResource**](/windows/desktop/api/Winbase/nf-winbase-updateresourcea) repeatedly to make changes to the resource data.</span></span> <span data-ttu-id="89eff-116">Cada chamada para **UpdateResource** contribui para uma lista interna de adições, exclusões e substituições, mas na verdade não grava os dados no arquivo executável.</span><span class="sxs-lookup"><span data-stu-id="89eff-116">Each call to **UpdateResource** contributes to an internal list of additions, deletions, and replacements but does not actually write the data to the executable file.</span></span> <span data-ttu-id="89eff-117">Imediatamente antes de fechar o identificador de atualização, o [**EndUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-endupdateresourcea) grava as alterações acumuladas no arquivo executável.</span><span class="sxs-lookup"><span data-stu-id="89eff-117">Immediately before closing the update handle, [**EndUpdateResource**](/windows/desktop/api/Winbase/nf-winbase-endupdateresourcea) writes the accumulated changes to the executable file.</span></span>

<span data-ttu-id="89eff-118">Às vezes, um aplicativo deve copiar recursos de outro arquivo.</span><span class="sxs-lookup"><span data-stu-id="89eff-118">Sometimes, an application must copy resources from another file.</span></span> <span data-ttu-id="89eff-119">A [atualização de recursos](using-resources.md) mostra um exemplo de como obter os dados do recurso e seu tamanho de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="89eff-119">[Updating Resources](using-resources.md) shows an example of obtaining the resource data and its size from a file.</span></span>

 

 




