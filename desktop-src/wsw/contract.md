---
title: Contrato
description: Um contrato de serviço transporta metadados que definem como um serviço trata as mensagens do canal.
ms.assetid: 670530bf-344b-4480-8357-8984d80c0c68
keywords:
- Contratar serviços Web para Windows
- WWSAPI
- WWS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7120346dac4d11c21955cd2430ed0a7dc277e88c
ms.sourcegitcommit: 5b98bf8c68922f8f03c14f793fbe17504900559c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/12/2021
ms.locfileid: "104558340"
---
# <a name="contract"></a><span data-ttu-id="a2d5e-106">Contrato</span><span class="sxs-lookup"><span data-stu-id="a2d5e-106">Contract</span></span>

<span data-ttu-id="a2d5e-107">Um contrato de serviço transporta metadados que definem como um serviço trata as mensagens do canal.</span><span class="sxs-lookup"><span data-stu-id="a2d5e-107">A service contract carries metadata that defines how a service to handles channel messages.</span></span>


<span data-ttu-id="a2d5e-108">Um [**\_ \_ contrato de serviço do WS**](/windows/desktop/api/WebServices/ns-webservices-ws_service_contract) transporta metadados para um serviço para manipular uma [ \_ mensagem WS](ws-message.md).</span><span class="sxs-lookup"><span data-stu-id="a2d5e-108">A [**WS\_SERVICE\_CONTRACT**](/windows/desktop/api/WebServices/ns-webservices-ws_service_contract) carries metadata for a service to handle a [WS\_MESSAGE](ws-message.md).</span></span>

![Diagrama mostrando WS_SERVICE_CONTRACT metadados em uma mensagem para um ponto de extremidade de serviço.](images/servicecontractintro.png)

<span data-ttu-id="a2d5e-110">Ele tem uma [**\_ \_ Descrição de contrato WS**](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description) e uma tabela de funções.</span><span class="sxs-lookup"><span data-stu-id="a2d5e-110">It has a [**WS\_CONTRACT\_DESCRIPTION**](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description) and a function table.</span></span> <span data-ttu-id="a2d5e-111">Um aplicativo pode opcionalmente especificar [**o \_ \_ retorno de \_ \_ chamada de recebimento de mensagem de serviço WS**](/windows/desktop/api/WebServices/nc-webservices-ws_service_message_receive_callback).</span><span class="sxs-lookup"><span data-stu-id="a2d5e-111">An application can optionally specify [**WS\_SERVICE\_MESSAGE\_RECEIVE\_CALLBACK**](/windows/desktop/api/WebServices/nc-webservices-ws_service_message_receive_callback).</span></span>

<span data-ttu-id="a2d5e-112">Se uma [**\_ \_ Descrição de contrato WS**](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description) e uma tabela de função não forem fornecidas, o aplicativo será necessário para especificar o [**retorno de \_ \_ \_ \_ chamada de recebimento de mensagem de serviço WS**](/windows/desktop/api/WebServices/nc-webservices-ws_service_message_receive_callback).</span><span class="sxs-lookup"><span data-stu-id="a2d5e-112">If a [**WS\_CONTRACT\_DESCRIPTION**](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description) and a function table are not given, the application is required to specify [**WS\_SERVICE\_MESSAGE\_RECEIVE\_CALLBACK**](/windows/desktop/api/WebServices/nc-webservices-ws_service_message_receive_callback).</span></span>

![Diagrama mostrando as operações de serviço adicionar e subtrair no contrato de serviço ICalculator.](images/servicecontract.png)


``` syntax
static WS_SERVICE_CONTRACT calculatorContract = 
{
    &calculatorContractDescription, 
    NULL, 
    &calculatorFunctions, 
};
```

<span data-ttu-id="a2d5e-114">Consulte o exemplo de [calculadora](httpcalculatorserviceexample.md) para obter detalhes.</span><span class="sxs-lookup"><span data-stu-id="a2d5e-114">See the [calculator](httpcalculatorserviceexample.md) example for details.</span></span>

<span data-ttu-id="a2d5e-115">Descrição do contrato</span><span class="sxs-lookup"><span data-stu-id="a2d5e-115">Contract Description</span></span>

<span data-ttu-id="a2d5e-116">[**WS \_ \_Descrição do contrato**](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description) é metadados que definem o tipo de contrato do serviço.</span><span class="sxs-lookup"><span data-stu-id="a2d5e-116">[**WS\_CONTRACT\_DESCRIPTION**](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description) is metadata defining the type-contract of the service.</span></span> <span data-ttu-id="a2d5e-117">Gerado por [wsutil.exe](web-service-compiler-tool.md).</span><span class="sxs-lookup"><span data-stu-id="a2d5e-117">Generated by [wsutil.exe](web-service-compiler-tool.md).</span></span>

<span data-ttu-id="a2d5e-118">Em termos de WSDL, uma [**\_ \_ Descrição do contrato WS**](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description) é mapeada para um WSDL: portType.</span><span class="sxs-lookup"><span data-stu-id="a2d5e-118">In terms of WSDL, a [**WS\_CONTRACT\_DESCRIPTION**](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description) maps to a wsdl:portType.</span></span> <span data-ttu-id="a2d5e-119">Para cada WSDL: portType no documento WSDL, uma **Descrição de \_ contrato \_ WS** diferente será gerada.</span><span class="sxs-lookup"><span data-stu-id="a2d5e-119">For each wsdl:portType in the WSDL document a separate **WS\_CONTRACT\_DESCRIPTION** will be generated.</span></span>

<span data-ttu-id="a2d5e-120">Uma descrição de contrato é composta de em ou mais [operações de serviço](service-operation.md).</span><span class="sxs-lookup"><span data-stu-id="a2d5e-120">A contract description is made up of on or more [service operations](service-operation.md).</span></span> <span data-ttu-id="a2d5e-121">Essas operações são fornecidas como uma matriz de [**\_ \_ Descrição da operação do WS**](/windows/desktop/api/WebServices/ns-webservices-ws_operation_description).</span><span class="sxs-lookup"><span data-stu-id="a2d5e-121">These operations are given as an array of [**WS\_OPERATION\_DESCRIPTION**](/windows/desktop/api/WebServices/ns-webservices-ws_operation_description).</span></span>

![Diagrama mostrando um WS_CONTRACT_DESCRIPTION como uma matriz de WS_OPERATION_DESCRIPTIONs.](images/porttypetocontract.png)

``` syntax
<wsdl:definitions xmlns:soap="https://schemas.xmlsoap.org/wsdl/soap/" 
xmlns:wsu="https://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" 
xmlns:soapenc="https://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="https://Example.org" 
xmlns:wsa="https://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:wsp="https://schemas.xmlsoap.org/ws/2004/09/policy" 
xmlns:wsap="https://schemas.xmlsoap.org/ws/2004/08/addressing/policy" xmlns:xsd="https://www.w3.org/2001/XMLSchema" 
xmlns:msc="http://schemas.microsoft.com/ws/2005/12/wsdl/contract" xmlns:wsaw="https://www.w3.org/2006/05/addressing/wsdl" 
xmlns:soap12="https://schemas.xmlsoap.org/wsdl/soap12/" xmlns:wsa10="https://www.w3.org/2005/08/addressing" 
xmlns:wsx="https://schemas.xmlsoap.org/ws/2004/09/mex" targetNamespace="https://Example.org" 
xmlns:wsdl="https://schemas.xmlsoap.org/wsdl/">
 <wsdl:portType name="ICalculator">
  <wsdl:operation name="Add">
   <wsdl:input wsaw:Action="https://Example.org/ICalculator/Add" 
   message="tns:ICalculator_Add_InputMessage" />
   <wsdl:output wsaw:Action="https://Example.org/ICalculator/AddResponse" 
   message="tns:ICalculator_Add_OutputMessage" />
  </wsdl:operation>
 </wsdl:portType>
</wsdl:definitions>
```

<span data-ttu-id="a2d5e-123">Para obter detalhes da conversão WSDL: portType na [**\_ \_ Descrição do contrato WS**](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description) , consulte a [seção saída WSDL](wsdl-support.md).</span><span class="sxs-lookup"><span data-stu-id="a2d5e-123">For details of wsdl:portType to [**WS\_CONTRACT\_DESCRIPTION**](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description) conversion, see the [WSDL output section](wsdl-support.md).</span></span>

<span data-ttu-id="a2d5e-124">Exemplo: [ **\_ \_ Descrição do contrato WS**](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description)</span><span class="sxs-lookup"><span data-stu-id="a2d5e-124">Example: [**WS\_CONTRACT\_DESCRIPTION**](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description)</span></span>

``` syntax
static WS_CONTRACT_DESCRIPTION contractDescriptionICalculator =
{
    WsCountOf(serviceOperationsICalculator),
    serviceOperationsICalculator
};
```

<span data-ttu-id="a2d5e-125">Tabela de funções</span><span class="sxs-lookup"><span data-stu-id="a2d5e-125">Function Table</span></span>

<span data-ttu-id="a2d5e-126">A tabela de funções é uma estrutura de ponteiros de função que representa cada uma das [operações de serviço](service-operation.md) no contrato de serviço.</span><span class="sxs-lookup"><span data-stu-id="a2d5e-126">Function Table is an struct of function pointers representing each of the [service operations](service-operation.md) in the service contract.</span></span> <span data-ttu-id="a2d5e-127">A definição da tabela de funções também é gerada pelo [wsutil.exe](web-service-compiler-tool.md).</span><span class="sxs-lookup"><span data-stu-id="a2d5e-127">The function table definition is also generated by [wsutil.exe](web-service-compiler-tool.md).</span></span>

<span data-ttu-id="a2d5e-128">Exemplo: tabela de funções</span><span class="sxs-lookup"><span data-stu-id="a2d5e-128">Example: Function Table</span></span>

``` syntax
 // Function Table
struct CalculatorServiceFunctionTable
{
      AddOperation Add;
      SubtractOperation Subtract;
};

// Populate the Function Table
static const CalculatorServiceFunctionTable calculatorFunctions = {Add, Subtract};
```

<span data-ttu-id="a2d5e-129">Usando o [ **\_ retorno de \_ \_ \_ chamada de recebimento de mensagem do serviço WS**](/windows/desktop/api/WebServices/nc-webservices-ws_service_message_receive_callback)</span><span class="sxs-lookup"><span data-stu-id="a2d5e-129">Using the [**WS\_SERVICE\_MESSAGE\_RECEIVE\_CALLBACK**](/windows/desktop/api/WebServices/nc-webservices-ws_service_message_receive_callback)</span></span>

<span data-ttu-id="a2d5e-130">[**WS \_ O \_ \_ retorno de \_ chamada de recebimento de mensagem de serviço**](/windows/desktop/api/WebServices/nc-webservices-ws_service_message_receive_callback) tem uma função mutuamente exclusiva.</span><span class="sxs-lookup"><span data-stu-id="a2d5e-130">[**WS\_SERVICE\_MESSAGE\_RECEIVE\_CALLBACK**](/windows/desktop/api/WebServices/nc-webservices-ws_service_message_receive_callback) has a dual mutually exclusive role.</span></span>

<span data-ttu-id="a2d5e-131">Se uma [**\_ \_ Descrição do contrato WS**](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description) for especificada no [**\_ \_ contrato do serviço WS**](/windows/desktop/api/WebServices/ns-webservices-ws_service_contract), isso se tornará o manipulador de mensagens padrão para todas as ações que não têm suporte na **\_ \_ Descrição do contrato WS** especificado.</span><span class="sxs-lookup"><span data-stu-id="a2d5e-131">If a [**WS\_CONTRACT\_DESCRIPTION**](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description) is specified on the [**WS\_SERVICE\_CONTRACT**](/windows/desktop/api/WebServices/ns-webservices-ws_service_contract), this becomes the default message handler for all the actions which are not supported by the specified **WS\_CONTRACT\_DESCRIPTION**.</span></span> <span data-ttu-id="a2d5e-132">Caso contrário, se a **\_ \_ Descrição do contrato WS** não for especificada no **\_ \_ contrato do serviço WS**, e o retorno de chamada de [**\_ recebimento de mensagem do serviço \_ \_ \_ WS**](/windows/desktop/api/WebServices/nc-webservices-ws_service_message_receive_callback) for especificado no **\_ \_ contrato de serviço WS** , todas as [mensagens](ws-message.md) recebidas serão passadas para esse retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="a2d5e-132">Otherwise, if **WS\_CONTRACT\_DESCRIPTION** is not specified on the **WS\_SERVICE\_CONTRACT**, and the [**WS\_SERVICE\_MESSAGE\_RECEIVE\_CALLBACK**](/windows/desktop/api/WebServices/nc-webservices-ws_service_message_receive_callback) is specified on the **WS\_SERVICE\_CONTRACT** all in coming [messages](ws-message.md) are passed to this callback.</span></span>

<span data-ttu-id="a2d5e-133">Para obter mais exemplos, consulte</span><span class="sxs-lookup"><span data-stu-id="a2d5e-133">For more examples, please see</span></span>

-   [<span data-ttu-id="a2d5e-134">Exemplo de serviço não tipado</span><span class="sxs-lookup"><span data-stu-id="a2d5e-134">Untyped service example</span></span>](untypedserviceexample.md)
-   [<span data-ttu-id="a2d5e-135">Exemplo de serviço de calculadora</span><span class="sxs-lookup"><span data-stu-id="a2d5e-135">Calculator service example</span></span>](httpcalculatorserviceexample.md)
-   [<span data-ttu-id="a2d5e-136">Operações de serviço</span><span class="sxs-lookup"><span data-stu-id="a2d5e-136">Service operations</span></span>](service-operation.md)

<span data-ttu-id="a2d5e-137">As seguintes chamadas de retorno fazem parte do contrato:</span><span class="sxs-lookup"><span data-stu-id="a2d5e-137">The following callbacks are part of the contract:</span></span>

-   [<span data-ttu-id="a2d5e-138">**\_retorno de \_ chamada de recebimento de mensagem de serviço WS \_ \_**</span><span class="sxs-lookup"><span data-stu-id="a2d5e-138">**WS\_SERVICE\_MESSAGE\_RECEIVE\_CALLBACK**</span></span>](/windows/desktop/api/WebServices/nc-webservices-ws_service_message_receive_callback)
-   [<span data-ttu-id="a2d5e-139">**\_retorno de \_ chamada de stub de serviço WS \_**</span><span class="sxs-lookup"><span data-stu-id="a2d5e-139">**WS\_SERVICE\_STUB\_CALLBACK**</span></span>](/windows/desktop/api/WebServices/nc-webservices-ws_service_stub_callback)

<span data-ttu-id="a2d5e-140">As seguintes estruturas fazem parte do contrato:</span><span class="sxs-lookup"><span data-stu-id="a2d5e-140">The following structures are part of the contract:</span></span>

-   [<span data-ttu-id="a2d5e-141">**\_Descrição do contrato WS \_**</span><span class="sxs-lookup"><span data-stu-id="a2d5e-141">**WS\_CONTRACT\_DESCRIPTION**</span></span>](/windows/desktop/api/WebServices/ns-webservices-ws_contract_description)
-   [<span data-ttu-id="a2d5e-142">**\_contrato de serviço WS \_**</span><span class="sxs-lookup"><span data-stu-id="a2d5e-142">**WS\_SERVICE\_CONTRACT**</span></span>](/windows/desktop/api/WebServices/ns-webservices-ws_service_contract)

 

 




