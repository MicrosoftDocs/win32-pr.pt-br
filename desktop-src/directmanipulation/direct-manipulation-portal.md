---
description: As APIs de manipulação direta permitem que você crie grandes experiências de usuário panorâmica, zoom e arrastar. Para fazer isso, ele processa a entrada por toque em uma região ou um objeto, gera transformações de saída e aplica as transformações aos elementos da interface do usuário.
ms.assetid: 26358bc5-71e9-40f0-9243-9bddd961a0e5
title: Manipulação direta
ms.topic: article
ms.date: 02/03/2020
ms.openlocfilehash: 6db2a50893914dfb25050768f88cb289a1ecf3ea
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104087538"
---
# <a name="direct-manipulation"></a><span data-ttu-id="2d541-104">Manipulação direta</span><span class="sxs-lookup"><span data-stu-id="2d541-104">Direct Manipulation</span></span>

<span data-ttu-id="2d541-105">As APIs de manipulação direta permitem que você crie grandes experiências de usuário panorâmica, zoom e arrastar.</span><span class="sxs-lookup"><span data-stu-id="2d541-105">The Direct Manipulation APIs let you create great pan, zoom, and drag user experiences.</span></span> <span data-ttu-id="2d541-106">Para fazer isso, ele processa a entrada por toque em uma região ou um objeto, gera transformações de saída e aplica as transformações aos elementos da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="2d541-106">To do this, it processes touch input on a region or object, generates output transforms, and applies the transforms to UI elements.</span></span> <span data-ttu-id="2d541-107">Você pode usar a manipulação direta para otimizar a capacidade de resposta e reduzir a latência por meio do processamento de entrada fora do thread, testes de clique de entrada fora do thread opcional e previsão de entrada/saída.</span><span class="sxs-lookup"><span data-stu-id="2d541-107">You can use Direct Manipulation to optimize responsiveness and reduce latency through off-thread input processing, optional off-thread input hit testing, and input/output prediction.</span></span>

<span data-ttu-id="2d541-108">Qualquer aplicativo que usa a manipulação direta para processar interações de toque exibe as animações do fluido do Windows 8 e os comportamentos de comentários de interação que estão em conformidade com as [diretrizes para interações comuns do usuário](/windows/uwp/design/input/).</span><span class="sxs-lookup"><span data-stu-id="2d541-108">Any application that uses Direct Manipulation to process touch interactions displays the fluid Windows 8 animations and interaction feedback behaviors that conform to the [Guidelines for common user interactions](/windows/uwp/design/input/).</span></span>

## <a name="developer-audience"></a><span data-ttu-id="2d541-109">Público do desenvolvedor</span><span class="sxs-lookup"><span data-stu-id="2d541-109">Developer Audience</span></span>

<span data-ttu-id="2d541-110">A API de manipulação direta é para desenvolvedores experientes que conhecem o C/C++, têm uma compreensão sólida do [com (Component Object Model)](../com/component-object-model--com--portal.md)e estão familiarizados com os conceitos de programação do Windows.</span><span class="sxs-lookup"><span data-stu-id="2d541-110">The Direct Manipulation API is for experienced developers who know C/C++, have a solid understanding of the [Component Object Model (COM)](../com/component-object-model--com--portal.md), and are familiar with Windows programming concepts.</span></span>

## <a name="run-time-requirements"></a><span data-ttu-id="2d541-111">Requisitos de tempo de execução</span><span class="sxs-lookup"><span data-stu-id="2d541-111">Run-time requirements</span></span>

<span data-ttu-id="2d541-112">A manipulação direta foi introduzida no Windows 8.</span><span class="sxs-lookup"><span data-stu-id="2d541-112">Direct Manipulation was introduced in Windows 8.</span></span> <span data-ttu-id="2d541-113">Ele está incluído nas versões de 32 bits e 64 bits.</span><span class="sxs-lookup"><span data-stu-id="2d541-113">It is included in both 32-bit and 64-bit versions.</span></span>

## <a name="why-use-directmanipulation"></a><span data-ttu-id="2d541-114">Por que usar DirectManipulation</span><span class="sxs-lookup"><span data-stu-id="2d541-114">Why use DirectManipulation</span></span>

### <a name="handles-interactions-in-a-straightforward-and-consistent-manner"></a><span data-ttu-id="2d541-115">Manipula as interações de maneira direta e consistente</span><span class="sxs-lookup"><span data-stu-id="2d541-115">Handles interactions in a straightforward and consistent manner</span></span>

<span data-ttu-id="2d541-116">A manipulação direta funciona pré-declarando os comportamentos e as interações para uma região ou objeto.</span><span class="sxs-lookup"><span data-stu-id="2d541-116">Direct Manipulation works by pre-declaring the behaviors and interactions for a region or object.</span></span> <span data-ttu-id="2d541-117">Por exemplo, uma página da Web geralmente é configurada para panorâmica e zoom.</span><span class="sxs-lookup"><span data-stu-id="2d541-117">For example, a web page is often configured for pan and zoom.</span></span> <span data-ttu-id="2d541-118">Em tempo de execução, a entrada é então associada a essa região/objeto por meio de uma chamada de API simples.</span><span class="sxs-lookup"><span data-stu-id="2d541-118">At runtime, input is then associated with this region/object through a simple API call.</span></span> <span data-ttu-id="2d541-119">Desse ponto, a manipulação direta faz todo o trabalho pesado de processar a entrada, aplicar restrições e personalidade e gerar as transformações de saída.</span><span class="sxs-lookup"><span data-stu-id="2d541-119">From this point forward Direct Manipulation does all the heavy lifting of processing the input, applying constraints and personality, and generating the output transforms.</span></span>

### <a name="build-responsive-touch-applications"></a><span data-ttu-id="2d541-120">Crie aplicativos responsivos de toque</span><span class="sxs-lookup"><span data-stu-id="2d541-120">Build responsive touch applications</span></span>

<span data-ttu-id="2d541-121">Para otimizar a capacidade de resposta e minimizar a latência, o processamento de manipulação direta ocorre em um thread separado e independente do thread da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="2d541-121">To optimize responsiveness and minimize latency, Direct Manipulation processing occurs on a separate, independent thread from the UI thread.</span></span> <span data-ttu-id="2d541-122">Como resultado, as transformações de saída podem ser executadas em paralelo à atividade no thread da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="2d541-122">As a result, output transforms can run in parallel to activity on the UI thread.</span></span> <span data-ttu-id="2d541-123">A atividade thread de interface do usuário pode incluir lógica do aplicativo, renderização, layout e qualquer outra coisa que consuma ciclos no processador.</span><span class="sxs-lookup"><span data-stu-id="2d541-123">The UI thread activity may include application logic, rendering, layout, and anything else that consumes cycles on the processor.</span></span>

### <a name="implementation-flexibility"></a><span data-ttu-id="2d541-124">Flexibilidade de implementação</span><span class="sxs-lookup"><span data-stu-id="2d541-124">Implementation flexibility</span></span>

<span data-ttu-id="2d541-125">As interfaces incluídas com a manipulação direta fornecem suporte abrangente para tratamento de entrada, reconhecimento de interação, notificações de comentários e atualizações de interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="2d541-125">The interfaces included with Direct Manipulation provide comprehensive support for input handling, interaction recognition, feedback notifications, and UI updates.</span></span> <span data-ttu-id="2d541-126">As interfaces também incorporam serviços do sistema, como [DirectComposition](../directcomp/directcomposition-portal.md).</span><span class="sxs-lookup"><span data-stu-id="2d541-126">The interfaces also incorporate system services such as [DirectComposition](../directcomp/directcomposition-portal.md).</span></span>

## <a name="basic-concepts"></a><span data-ttu-id="2d541-127">Conceitos básicos</span><span class="sxs-lookup"><span data-stu-id="2d541-127">Basic concepts</span></span>

<span data-ttu-id="2d541-128">A implementação de manipulação direta mais básica consiste em um *visor*, *conteúdo* e *interações*.</span><span class="sxs-lookup"><span data-stu-id="2d541-128">The most basic Direct Manipulation implementation consists of a *viewport*, *content*, and *interactions*.</span></span> <span data-ttu-id="2d541-129">O *visor* é uma região que é capaz de receber e processar a entrada de interações do usuário.</span><span class="sxs-lookup"><span data-stu-id="2d541-129">The *viewport* is a region that is able to receive and process input from user interactions.</span></span> <span data-ttu-id="2d541-130">Também é a região do conteúdo que é visível para o usuário final.</span><span class="sxs-lookup"><span data-stu-id="2d541-130">It is also the region of the content that is visible to the end-user.</span></span> <span data-ttu-id="2d541-131">O *conteúdo* é o objeto real que os usuários finais podem ver e é o que move ou dimensiona em resposta a uma interação do usuário.</span><span class="sxs-lookup"><span data-stu-id="2d541-131">The *content* is the actual object that end-users can see and is what moves or scales in response to a user interaction.</span></span> <span data-ttu-id="2d541-132">As *interações* do usuário primário (também conhecidas como *manipulações*) com suporte para a manipulação direta são a panorâmica e o zoom.</span><span class="sxs-lookup"><span data-stu-id="2d541-132">The primary user *interactions* (also known as *manipulations*) supported by Direct Manipulation are panning and zooming.</span></span> <span data-ttu-id="2d541-133">Essas interações aplicam uma transformação de conversão ou de escala ao conteúdo dentro do visor, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="2d541-133">These interactions apply a translate or scale transform to the content within the viewport, respectively.</span></span> <span data-ttu-id="2d541-134">Vários visores (cada um com seu próprio conteúdo) podem ser configurados em uma única janela para criar uma experiência de interface do usuário rica.</span><span class="sxs-lookup"><span data-stu-id="2d541-134">Multiple viewports (each with their own content) can be configured in a single window to create a rich UI experience.</span></span>

<span data-ttu-id="2d541-135">Esta figura mostra uma implementação básica de manipulação direta antes e depois do movimento panorâmico.</span><span class="sxs-lookup"><span data-stu-id="2d541-135">This figure shows a basic Direct Manipulation implementation before and after panning.</span></span>

![implementação básica de manipulação direta antes e depois do movimento panorâmico.](images/dm-art-1.png)

<span data-ttu-id="2d541-137">Durante a inicialização da manipulação direta, um objeto **DCompDirectManipulationCompositor** é instanciado e está associado à manipulação direta.</span><span class="sxs-lookup"><span data-stu-id="2d541-137">During initialization of Direct Manipulation a **DCompDirectManipulationCompositor** object is instantiated and is associated with Direct Manipulation.</span></span> <span data-ttu-id="2d541-138">Esse objeto é um wrapper em volta de [DirectComposition](../directcomp/directcomposition-portal.md), que é o compositor do sistema.</span><span class="sxs-lookup"><span data-stu-id="2d541-138">This object is a wrapper around [DirectComposition](../directcomp/directcomposition-portal.md), which is the system compositor.</span></span> <span data-ttu-id="2d541-139">O objeto é responsável por aplicar as transformações de saída e orientar as atualizações visuais.</span><span class="sxs-lookup"><span data-stu-id="2d541-139">The object is responsible for applying the output transforms and driving visual updates.</span></span>

<span data-ttu-id="2d541-140">Um contato representa um ponto de toque identificado pelo **ponteiroid** fornecido na mensagem do [WM/_POINTERDOWN](../inputmsg/wm-pointerdown.md) .</span><span class="sxs-lookup"><span data-stu-id="2d541-140">A contact represents a touch point identified by the **pointerId** provided in the [WM/_POINTERDOWN](../inputmsg/wm-pointerdown.md) message.</span></span> <span data-ttu-id="2d541-141">Quando uma mensagem do **WM \_ POINTERDOWN** é recebida, o aplicativo chama [**setcontact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact).</span><span class="sxs-lookup"><span data-stu-id="2d541-141">When a **WM\_POINTERDOWN** message is received, the application calls [**SetContact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact).</span></span> <span data-ttu-id="2d541-142">O aplicativo notifica Manipulationabout diretos os contatos que devem ser manipulados e as visores que devem reagir a esses contatos.</span><span class="sxs-lookup"><span data-stu-id="2d541-142">The application notifies Direct Manipulationabout the contacts that should be handled and the viewport(s) that should react to those contacts.</span></span> <span data-ttu-id="2d541-143">A entrada de teclado e de mouse têm valores de **ponteiroid** especiais para que possam ser manipuladas adequadamente pela manipulação direta.</span><span class="sxs-lookup"><span data-stu-id="2d541-143">Keyboard and mouse input have special **pointerId** values so they can be handled appropriately by Direct Manipulation.</span></span>

<span data-ttu-id="2d541-144">Em nosso caso básico acima, quando [**setcontact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact) é chamado de algumas coisas acontecem:</span><span class="sxs-lookup"><span data-stu-id="2d541-144">In our basic case above, when [**SetContact**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationviewport-setcontact) is called a few things happen:</span></span>

- <span data-ttu-id="2d541-145">Quando o usuário executa uma panorâmica, uma mensagem do [WM/_POINTERCAPTURECHANGED](../inputmsg/wm-pointercapturechanged.md) é enviada ao aplicativo para notificar que o contato foi consumido pela manipulação direta.</span><span class="sxs-lookup"><span data-stu-id="2d541-145">When the user performs a pan, a [WM/_POINTERCAPTURECHANGED](../inputmsg/wm-pointercapturechanged.md) message is sent to the application to notify that the contact has been consumed by Direct Manipulation.</span></span>
- <span data-ttu-id="2d541-146">Quando o usuário move as movimentações, o visor aciona eventos de atualização que são usados pelo wrapper [DirectComposition](../directcomp/directcomposition-portal.md) para direcionar as atualizações visuais para a tela.</span><span class="sxs-lookup"><span data-stu-id="2d541-146">When the user moves the moves, the viewport fires update events which are used by the [DirectComposition](../directcomp/directcomposition-portal.md) wrapper to drive visual updates to the screen.</span></span> <span data-ttu-id="2d541-147">Para um panorama de um usuário em um visor, o conteúdo parecerá ser movido suavemente sob o contato.</span><span class="sxs-lookup"><span data-stu-id="2d541-147">To a user panning in a viewport, the content will appear to move smoothly under the contact.</span></span>
- <span data-ttu-id="2d541-148">Quando o usuário levanta o contato, o usuário vê que o conteúdo continua a ser movido à medida que faz a transição para uma animação inércia, gradualmente decelerating até atingir seu local de repouso final.</span><span class="sxs-lookup"><span data-stu-id="2d541-148">When the user lifts the contact, the user sees the content continue to move as it transitions into an inertia animation, gradually decelerating until it reaches its final resting place.</span></span>

## <a name="processing-keyboard-and-mouse-input"></a><span data-ttu-id="2d541-149">Processando entrada de teclado e mouse</span><span class="sxs-lookup"><span data-stu-id="2d541-149">Processing keyboard and mouse input</span></span>

<span data-ttu-id="2d541-150">A manipulação direta permite que as mensagens de teclado e mouse sejam encaminhadas manualmente do thread de interface do usuário do aplicativo por meio da API [**ProcessInput**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-processinput) de forma que elas possam ser manipuladas adequadamente pela manipulação direta.</span><span class="sxs-lookup"><span data-stu-id="2d541-150">Direct Manipulation allows keyboard and mouse messages to be forwarded manually from the application UI thread via the [**ProcessInput**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-processinput) API such that they can be handled appropriately by Direct Manipulation.</span></span>

## <a name="directmanipulation-and-the-hwnd"></a><span data-ttu-id="2d541-151">DirectManipulation e HWND</span><span class="sxs-lookup"><span data-stu-id="2d541-151">DirectManipulation and the HWND</span></span>

<span data-ttu-id="2d541-152">A manipulação direta está associada a um HWND Win32 para receber e processar mensagens de entrada de ponteiro para essa janela.</span><span class="sxs-lookup"><span data-stu-id="2d541-152">Direct Manipulation is associated with a Win32 HWND in order to receive and process pointer input messages for that window.</span></span> <span data-ttu-id="2d541-153">Como a manipulação direta computa valores de saída, ele faz retornos de chamada assíncronos para os objetos [com (Component Object Model](../com/component-object-model--com--portal.md) de manipulação direta) que são implementados no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2d541-153">As Direct Manipulation computes output values, it makes asynchronous callbacks to the Direct Manipulation [Component Object Model (COM)](../com/component-object-model--com--portal.md) objects that are implemented in the application.</span></span> <span data-ttu-id="2d541-154">Esses retornos de chamada informam o aplicativo sobre a transformação que foi aplicada aos objetos.</span><span class="sxs-lookup"><span data-stu-id="2d541-154">These callbacks inform the application about the transform that was applied to the objects.</span></span> <span data-ttu-id="2d541-155">A manipulação direta é ativada no HWND especificado chamando [**Activate**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-activate).</span><span class="sxs-lookup"><span data-stu-id="2d541-155">Direct Manipulation is activated on the specified HWND by calling [**Activate**](/windows/win32/api/DirectManipulation/nf-directmanipulation-idirectmanipulationmanager-activate).</span></span>

## <a name="supporting-documentation"></a><span data-ttu-id="2d541-156">Documentação de suporte</span><span class="sxs-lookup"><span data-stu-id="2d541-156">Supporting documentation</span></span>

- [<span data-ttu-id="2d541-157">Visores e conteúdo</span><span class="sxs-lookup"><span data-stu-id="2d541-157">Viewports and content</span></span>](directmanipulation-viewports-and-content.md)
- [<span data-ttu-id="2d541-158">Usando vários viewports no DirectManipulation</span><span class="sxs-lookup"><span data-stu-id="2d541-158">Using multiple viewports in DirectManipulation</span></span>](directmanipulation-multiple-vieports.md)
- [<span data-ttu-id="2d541-159">Processando a entrada com DirectManipulation</span><span class="sxs-lookup"><span data-stu-id="2d541-159">Processing input with DirectManipulation</span></span>](directmanipulation-processing-input-with-directmanipulation.md)
- [<span data-ttu-id="2d541-160">Mecanismo de composição</span><span class="sxs-lookup"><span data-stu-id="2d541-160">Composition engine</span></span>](directmanipulation-composition-engine.md)
- [<span data-ttu-id="2d541-161">Referência de manipulação direta</span><span class="sxs-lookup"><span data-stu-id="2d541-161">Direct Manipulation Reference</span></span>](direct-manipulation-reference.md)

- [<span data-ttu-id="2d541-162">BUILD 2013: WCL-022: torne seu aplicativo de área de trabalho ótimo com toque, mouse e caneta</span><span class="sxs-lookup"><span data-stu-id="2d541-162">BUILD 2013: WCL-022: Make your desktop app great with touch, mouse, and pen</span></span>](https://channel9.msdn.com/Events/Build/2013/4-022)
- [<span data-ttu-id="2d541-163">Exemplo de processamento de entrada de toque com manipulação direta</span><span class="sxs-lookup"><span data-stu-id="2d541-163">Process touch input with Direct Manipulation sample</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/1d363ff4bd17d8e20415b92e2ee989d615cc0d91/Samples/TouchInputDirectManipulation)
