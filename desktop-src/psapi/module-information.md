---
title: Informações do módulo
description: Um módulo é um arquivo executável ou DLL.
ms.assetid: e15b5e15-ca06-4733-bd0a-705058ba2db8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1625877832b7e57e68ec6baff79f0c34b4478176
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104366121"
---
# <a name="module-information"></a><span data-ttu-id="a0475-103">Informações do módulo</span><span class="sxs-lookup"><span data-stu-id="a0475-103">Module Information</span></span>

<span data-ttu-id="a0475-104">Um *módulo* é um arquivo executável ou dll.</span><span class="sxs-lookup"><span data-stu-id="a0475-104">A *module* is an executable file or DLL.</span></span> <span data-ttu-id="a0475-105">Cada processo consiste em um ou mais módulos.</span><span class="sxs-lookup"><span data-stu-id="a0475-105">Each process consists of one or more modules.</span></span> <span data-ttu-id="a0475-106">Você pode recuperar a lista de identificadores de módulo para um processo chamando a função [**EnumProcessModules**](/windows/desktop/api/Psapi/nf-psapi-enumprocessmodules) .</span><span class="sxs-lookup"><span data-stu-id="a0475-106">You can retrieve the list of module handles for a process by calling the [**EnumProcessModules**](/windows/desktop/api/Psapi/nf-psapi-enumprocessmodules) function.</span></span> <span data-ttu-id="a0475-107">Essa função preenche uma matriz de valores **HMODULE** com as alças do módulo para o processo especificado.</span><span class="sxs-lookup"><span data-stu-id="a0475-107">This function fills an array of **HMODULE** values with the module handles for the specified process.</span></span> <span data-ttu-id="a0475-108">O primeiro módulo é o arquivo executável.</span><span class="sxs-lookup"><span data-stu-id="a0475-108">The first module is the executable file.</span></span> <span data-ttu-id="a0475-109">Lembre-se de que esses identificadores de módulo são mais prováveis de algum outro processo, portanto, você não pode usá-los com funções como [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea).</span><span class="sxs-lookup"><span data-stu-id="a0475-109">Remember that these module handles are most likely from some other process, so you cannot use them with functions such as [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea).</span></span> <span data-ttu-id="a0475-110">No entanto, você pode usar as [funções psapi](psapi-functions.md) para obter informações sobre um módulo de outro processo.</span><span class="sxs-lookup"><span data-stu-id="a0475-110">However, you can use [PSAPI functions](psapi-functions.md) to obtain information about a module from another process.</span></span>

<span data-ttu-id="a0475-111">O procedimento a seguir descreve como obter informações de módulo de outro processo.</span><span class="sxs-lookup"><span data-stu-id="a0475-111">The following procedure describes how to obtain module information from another process.</span></span>

<span data-ttu-id="a0475-112">**Para obter informações de módulo de outro processo**</span><span class="sxs-lookup"><span data-stu-id="a0475-112">**To obtain module information from another process**</span></span>

1.  <span data-ttu-id="a0475-113">Chame a função [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) .</span><span class="sxs-lookup"><span data-stu-id="a0475-113">Call the [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) function.</span></span> <span data-ttu-id="a0475-114">Essa função usa um identificador de processo e um identificador de módulo como entrada e preenche um buffer com o nome base de um módulo (por exemplo, Kernel32.dll).</span><span class="sxs-lookup"><span data-stu-id="a0475-114">This function takes a process handle and a module handle as input and fills in a buffer with the base name of a module (for example, Kernel32.dll).</span></span> <span data-ttu-id="a0475-115">Uma função relacionada, [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa), usa os mesmos parâmetros como entrada, mas retorna o caminho completo para o módulo (por exemplo, C: \\ Windows \\ System32 \\Kernel32.dll).</span><span class="sxs-lookup"><span data-stu-id="a0475-115">A related function, [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa), takes the same parameters as input but returns the full path to the module (for example, C:\\Windows\\System32\\Kernel32.dll).</span></span>
2.  <span data-ttu-id="a0475-116">Chame a função [**GetModuleInformation**](/windows/desktop/api/Psapi/nf-psapi-getmoduleinformation) .</span><span class="sxs-lookup"><span data-stu-id="a0475-116">Call the [**GetModuleInformation**](/windows/desktop/api/Psapi/nf-psapi-getmoduleinformation) function.</span></span> <span data-ttu-id="a0475-117">Essa função usa um identificador de processo e um identificador de módulo e preenche uma estrutura [**ModuleInfo**](/windows/desktop/api/Psapi/ns-psapi-moduleinfo) com o endereço de carregamento do módulo, o tamanho do espaço de endereço linear que ele ocupa e um ponteiro para seu ponto de entrada.</span><span class="sxs-lookup"><span data-stu-id="a0475-117">This function takes a process handle and a module handle and fills a [**MODULEINFO**](/windows/desktop/api/Psapi/ns-psapi-moduleinfo) structure with the load address of the module, the size of the linear address space it occupies, and a pointer to its entry point.</span></span>

<span data-ttu-id="a0475-118">Se um aplicativo exigir informações de módulo para o processo atual, ele deverá usar a função [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea) em vez das funções de módulo psapi.</span><span class="sxs-lookup"><span data-stu-id="a0475-118">If an application requires module information for the current process, it should use the [**GetModuleFileName**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulefilenamea) function instead of the PSAPI module functions.</span></span> <span data-ttu-id="a0475-119">Isso ajuda o desempenho do aplicativo de duas maneiras: a função **GetModuleFileName** é mais eficiente do que as funções do módulo psapi, e um aplicativo pode evitar o carregamento de psapi.dll se não usar nenhuma função psapi.</span><span class="sxs-lookup"><span data-stu-id="a0475-119">This helps application performance in two ways: The **GetModuleFileName** function is more efficient than the PSAPI module functions, and an application can avoid loading psapi.dll if it does not use any PSAPI functions.</span></span>

<span data-ttu-id="a0475-120">As funções [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) e [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa) são projetadas principalmente para uso por depuradores e aplicativos semelhantes que devem extrair informações de módulo de outro processo.</span><span class="sxs-lookup"><span data-stu-id="a0475-120">The [**GetModuleBaseName**](/windows/desktop/api/Psapi/nf-psapi-getmodulebasenamea) and [**GetModuleFileNameEx**](/windows/desktop/api/Psapi/nf-psapi-getmodulefilenameexa) functions are primarily designed for use by debuggers and similar applications that must extract module information from another process.</span></span> <span data-ttu-id="a0475-121">Se a lista de módulos no processo de destino estiver corrompida ou ainda não tiver sido inicializada, ou se a lista de módulos for alterada durante a chamada de função como resultado de DLLs sendo carregadas ou descarregadas, essas funções poderão falhar ou retornar informações incorretas.</span><span class="sxs-lookup"><span data-stu-id="a0475-121">If the module list in the target process is corrupted or is not yet initialized, or if the module list changes during the function call as a result of DLLs being loaded or unloaded, these functions may fail or return incorrect information.</span></span>

 

 