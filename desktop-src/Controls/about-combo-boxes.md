---
title: Sobre caixas de combinação
description: Esta seção aborda os diferentes tipos de caixas de combinação.
ms.assetid: 76410a87-aa0e-4da9-9e78-c80ac485e3cd
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 344596a3c0aa772568956344aaddcc053b534993
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "104570266"
---
# <a name="about-combo-boxes"></a><span data-ttu-id="715e0-103">Sobre caixas de combinação</span><span class="sxs-lookup"><span data-stu-id="715e0-103">About Combo Boxes</span></span>

<span data-ttu-id="715e0-104">Uma caixa de combinação combina uma caixa de edição ou texto estático e uma lista.</span><span class="sxs-lookup"><span data-stu-id="715e0-104">A combo box combines an edit box or static text and a list.</span></span>

<span data-ttu-id="715e0-105">Este tópico inclui as seções a seguir.</span><span class="sxs-lookup"><span data-stu-id="715e0-105">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="715e0-106">Tipos e estilos de caixa de combinação</span><span class="sxs-lookup"><span data-stu-id="715e0-106">Combo Box Types and Styles</span></span>](#combo-box-types-and-styles)
-   [<span data-ttu-id="715e0-107">Lista de caixas de combinação</span><span class="sxs-lookup"><span data-stu-id="715e0-107">Combo Box List</span></span>](#combo-box-list)
    -   [<span data-ttu-id="715e0-108">Seleção atual</span><span class="sxs-lookup"><span data-stu-id="715e0-108">Current Selection</span></span>](#current-selection)
    -   [<span data-ttu-id="715e0-109">Listas suspensas</span><span class="sxs-lookup"><span data-stu-id="715e0-109">Drop-down Lists</span></span>](#drop-down-lists)
    -   [<span data-ttu-id="715e0-110">Listar Conteúdo</span><span class="sxs-lookup"><span data-stu-id="715e0-110">List Contents</span></span>](#list-contents)
-   [<span data-ttu-id="715e0-111">Editar campos de seleção de controle</span><span class="sxs-lookup"><span data-stu-id="715e0-111">Edit Control Selection Fields</span></span>](#edit-control-selection-fields)
-   [<span data-ttu-id="715e0-112">Caixas de combinação desenhadas pelo proprietário</span><span class="sxs-lookup"><span data-stu-id="715e0-112">Owner-Drawn Combo Boxes</span></span>](#owner-drawn-combo-boxes)
-   [<span data-ttu-id="715e0-113">Caixas de combinação de subclasse</span><span class="sxs-lookup"><span data-stu-id="715e0-113">Subclassed Combo Boxes</span></span>](#subclassed-combo-boxes)

## <a name="combo-box-types-and-styles"></a><span data-ttu-id="715e0-114">Tipos e estilos de caixa de combinação</span><span class="sxs-lookup"><span data-stu-id="715e0-114">Combo Box Types and Styles</span></span>

<span data-ttu-id="715e0-115">Uma caixa de combinação consiste em uma lista e um campo de seleção.</span><span class="sxs-lookup"><span data-stu-id="715e0-115">A combo box consists of a list and a selection field.</span></span> <span data-ttu-id="715e0-116">A lista apresenta as opções que um usuário pode selecionar e o campo seleção exibe a seleção atual.</span><span class="sxs-lookup"><span data-stu-id="715e0-116">The list presents the options that a user can select, and the selection field displays the current selection.</span></span> <span data-ttu-id="715e0-117">Se o campo de seleção for um controle de edição, o usuário poderá inserir informações não disponíveis na lista; caso contrário, o usuário só poderá selecionar itens na lista.</span><span class="sxs-lookup"><span data-stu-id="715e0-117">If the selection field is an edit control, the user can enter information not available in the list; otherwise, the user can only select items in the list.</span></span>

<span data-ttu-id="715e0-118">A biblioteca de controles comuns inclui três estilos principais de caixa de combinação, conforme mostrado na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="715e0-118">The common controls library includes three main styles of combo box, as shown in the following table.</span></span>



| <span data-ttu-id="715e0-119">Tipo de caixa de combinação</span><span class="sxs-lookup"><span data-stu-id="715e0-119">Combo box type</span></span>             | <span data-ttu-id="715e0-120">Constante de estilo</span><span class="sxs-lookup"><span data-stu-id="715e0-120">Style constant</span></span>                                                 | <span data-ttu-id="715e0-121">Descrição</span><span class="sxs-lookup"><span data-stu-id="715e0-121">Description</span></span>                                                                                  |
|----------------------------|----------------------------------------------------------------|----------------------------------------------------------------------------------------------|
| <span data-ttu-id="715e0-122">Simples</span><span class="sxs-lookup"><span data-stu-id="715e0-122">Simple</span></span>                     | [<span data-ttu-id="715e0-123">**CBS \_ simples**</span><span class="sxs-lookup"><span data-stu-id="715e0-123">**CBS\_SIMPLE**</span></span>](combo-box-styles.md)             | <span data-ttu-id="715e0-124">Exibe a lista em todos os momentos e mostra o item selecionado em um controle de edição.</span><span class="sxs-lookup"><span data-stu-id="715e0-124">Displays the list at all times, and shows the selected item in an edit control.</span></span>              |
| <span data-ttu-id="715e0-125">Lista suspensa</span><span class="sxs-lookup"><span data-stu-id="715e0-125">Drop-down</span></span>                  | [<span data-ttu-id="715e0-126">**\_lista suspensa CBS**</span><span class="sxs-lookup"><span data-stu-id="715e0-126">**CBS\_DROPDOWN**</span></span>](combo-box-styles.md)         | <span data-ttu-id="715e0-127">Exibe a lista quando o ícone é clicado e mostra o item selecionado em um controle de edição.</span><span class="sxs-lookup"><span data-stu-id="715e0-127">Displays the list when the icon is clicked, and shows the selected item in an edit control.</span></span>  |
| <span data-ttu-id="715e0-128">Lista suspensa (lista suspensa)</span><span class="sxs-lookup"><span data-stu-id="715e0-128">Drop-down list (drop list)</span></span> | [<span data-ttu-id="715e0-129">**DROPDOWNLIST do CBS \_**</span><span class="sxs-lookup"><span data-stu-id="715e0-129">**CBS\_DROPDOWNLIST**</span></span>](combo-box-styles.md) | <span data-ttu-id="715e0-130">Exibe a lista quando o ícone é clicado e mostra o item selecionado em um controle estático.</span><span class="sxs-lookup"><span data-stu-id="715e0-130">Displays the list when the icon is clicked, and shows the selected item in a static control.</span></span> |



 

<span data-ttu-id="715e0-131">As capturas de tela a seguir mostram os três tipos de caixa de combinação que podem aparecer no Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="715e0-131">The following screen shots each show the three kinds of combo box as they might appear in Windows Vista.</span></span> <span data-ttu-id="715e0-132">Na primeira captura de tela, o usuário selecionou um item na caixa de combinação simples.</span><span class="sxs-lookup"><span data-stu-id="715e0-132">In the first screen shot, the user has selected an item in the simple combo box.</span></span> <span data-ttu-id="715e0-133">O usuário também pode digitar um novo valor na caixa de edição deste controle.</span><span class="sxs-lookup"><span data-stu-id="715e0-133">The user can also type a new value in the edit box of this control.</span></span> <span data-ttu-id="715e0-134">A lista foi dimensionada no editor de recursos Microsoft Visual Studio e só é grande o suficiente para acomodar dois itens.</span><span class="sxs-lookup"><span data-stu-id="715e0-134">The list has been sized in the Microsoft Visual Studio resource editor and is only large enough to accommodate two items.</span></span>

![captura de tela mostrando um item selecionado em uma caixa de combinação simples](images/simplecombo.png)

<span data-ttu-id="715e0-136">Na segunda captura de tela, o usuário digitou um novo texto no controle de edição da caixa de combinação suspensa.</span><span class="sxs-lookup"><span data-stu-id="715e0-136">In the second screen shot, the user has typed new text in the edit control of the drop-down combo box.</span></span> <span data-ttu-id="715e0-137">O usuário também pode ter selecionado um item existente.</span><span class="sxs-lookup"><span data-stu-id="715e0-137">The user could also have selected an existing item.</span></span> <span data-ttu-id="715e0-138">A caixa de listagem se expande para acomodar o máximo de itens possível.</span><span class="sxs-lookup"><span data-stu-id="715e0-138">The list box expands to accommodate as many items as possible.</span></span>

![captura de tela mostrando texto digitado em uma caixa de combinação suspensa](images/dropdown.png)

<span data-ttu-id="715e0-140">Na terceira captura de tela, o usuário abriu a caixa de combinação lista suspensa.</span><span class="sxs-lookup"><span data-stu-id="715e0-140">In the third screen shot, the user has opened the drop-down list combo box.</span></span> <span data-ttu-id="715e0-141">A caixa de listagem se expande para acomodar o máximo de itens possível.</span><span class="sxs-lookup"><span data-stu-id="715e0-141">The list box expands to accommodate as many items as possible.</span></span> <span data-ttu-id="715e0-142">O usuário não pode inserir um novo texto.</span><span class="sxs-lookup"><span data-stu-id="715e0-142">The user cannot enter new text.</span></span>

![captura de tela mostrando um item selecionado em uma caixa de combinação da lista suspensa](images/droplist.png)

<span data-ttu-id="715e0-144">Também há vários estilos de caixa de combinação que definem propriedades específicas.</span><span class="sxs-lookup"><span data-stu-id="715e0-144">There are also a number of combo box styles that define specific properties.</span></span> <span data-ttu-id="715e0-145">Os estilos de caixa de combinação definem propriedades específicas de uma caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="715e0-145">Combo box styles define specific properties of a combo box.</span></span> <span data-ttu-id="715e0-146">Você pode combinar estilos; no entanto, alguns estilos se aplicam apenas a determinados tipos de caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="715e0-146">You can combine styles; however, some styles apply only to certain combo box types.</span></span> <span data-ttu-id="715e0-147">Para uma tabela de estilos de caixa de combinação, consulte [estilos de caixa de combinação](combo-box-styles.md).</span><span class="sxs-lookup"><span data-stu-id="715e0-147">For a table of combo box styles, see [Combo Box Styles](combo-box-styles.md).</span></span>

> [!Note]  
> <span data-ttu-id="715e0-148">Para usar estilos visuais com caixas de combinação, um aplicativo deve incluir um manifesto e deve chamar [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) no início do programa.</span><span class="sxs-lookup"><span data-stu-id="715e0-148">To use visual styles with combo boxes, an application must include a manifest and must call [**InitCommonControls**](/windows/desktop/api/Commctrl/nf-commctrl-initcommoncontrols) at the beginning of the program.</span></span> <span data-ttu-id="715e0-149">Para obter informações sobre estilos visuais, consulte [estilos visuais](themes-overview.md).</span><span class="sxs-lookup"><span data-stu-id="715e0-149">For information on visual styles, see [Visual Styles](themes-overview.md).</span></span> <span data-ttu-id="715e0-150">Para obter informações sobre manifestos, consulte [habilitando estilos visuais](cookbook-overview.md).</span><span class="sxs-lookup"><span data-stu-id="715e0-150">For information on manifests, see [Enabling Visual Styles](cookbook-overview.md).</span></span>

 

## <a name="combo-box-list"></a><span data-ttu-id="715e0-151">Lista de caixas de combinação</span><span class="sxs-lookup"><span data-stu-id="715e0-151">Combo Box List</span></span>

<span data-ttu-id="715e0-152">A lista é a parte de uma caixa de combinação que exibe os itens que um usuário pode selecionar.</span><span class="sxs-lookup"><span data-stu-id="715e0-152">The list is the portion of a combo box that displays the items a user can select.</span></span> <span data-ttu-id="715e0-153">Normalmente, um aplicativo Inicializa o conteúdo da lista quando ele cria uma caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="715e0-153">Typically, an application initializes the contents of the list when it creates a combo box.</span></span> <span data-ttu-id="715e0-154">Qualquer item de lista selecionado pelo usuário é a *seleção atual*.</span><span class="sxs-lookup"><span data-stu-id="715e0-154">Any list item selected by the user is the *current selection*.</span></span> <span data-ttu-id="715e0-155">Não é possível selecionar vários itens.</span><span class="sxs-lookup"><span data-stu-id="715e0-155">Multiple items cannot be selected.</span></span> <span data-ttu-id="715e0-156">Nas caixas de combinação simples e suspensas, o usuário pode digitar o campo de seleção em vez de selecionar um item de lista.</span><span class="sxs-lookup"><span data-stu-id="715e0-156">In simple and drop-down combo boxes, the user can type in the selection field instead of selecting a list item.</span></span> <span data-ttu-id="715e0-157">Nesses casos, não há nenhuma seleção atual, e é responsabilidade do aplicativo Adicionar o item à lista e torná-lo a seleção atual, se for apropriado para isso.</span><span class="sxs-lookup"><span data-stu-id="715e0-157">In these cases, there is no current selection, and it is the application's responsibility to add the item to the list and make it the current selection, if it is appropriate to do so.</span></span>

<span data-ttu-id="715e0-158">Esta seção aborda os seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="715e0-158">This section discusses following topics:</span></span>

-   [<span data-ttu-id="715e0-159">Seleção atual</span><span class="sxs-lookup"><span data-stu-id="715e0-159">Current Selection</span></span>](#current-selection)
-   [<span data-ttu-id="715e0-160">Listas suspensas</span><span class="sxs-lookup"><span data-stu-id="715e0-160">Drop-down Lists</span></span>](#drop-down-lists)
-   [<span data-ttu-id="715e0-161">Listar Conteúdo</span><span class="sxs-lookup"><span data-stu-id="715e0-161">List Contents</span></span>](#list-contents)

### <a name="current-selection"></a><span data-ttu-id="715e0-162">Seleção atual</span><span class="sxs-lookup"><span data-stu-id="715e0-162">Current Selection</span></span>

<span data-ttu-id="715e0-163">A seleção atual é um item de lista que o usuário selecionou; o texto selecionado é exibido no campo seleção da caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="715e0-163">The current selection is a list item that the user has selected; the selected text appears in the selection field of the combo box.</span></span> <span data-ttu-id="715e0-164">No entanto, no caso de uma caixa de combinação simples ou de uma caixa de combinação suspensa, a seleção atual é apenas uma forma de entrada de usuário possível em uma caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="715e0-164">However, in the case of a simple combo box or a drop-down combo box, the current selection is only one form of possible user input in a combo box.</span></span> <span data-ttu-id="715e0-165">O usuário também pode digitar texto no campo de seleção.</span><span class="sxs-lookup"><span data-stu-id="715e0-165">The user can also type text in the selection field.</span></span>

<span data-ttu-id="715e0-166">A seleção atual é identificada pelo índice de base zero do item de lista selecionado.</span><span class="sxs-lookup"><span data-stu-id="715e0-166">The current selection is identified by the zero-based index of the selected list item.</span></span> <span data-ttu-id="715e0-167">Um aplicativo pode definir e recuperá-lo a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="715e0-167">An application can set and retrieve it at any time.</span></span> <span data-ttu-id="715e0-168">O procedimento da janela pai ou da caixa de diálogo recebe uma notificação quando o usuário altera a seleção atual para uma caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="715e0-168">The parent window or dialog box procedure receives notification when the user changes the current selection for a combo box.</span></span> <span data-ttu-id="715e0-169">A janela pai ou a caixa de diálogo não é notificada quando o aplicativo altera a seleção.</span><span class="sxs-lookup"><span data-stu-id="715e0-169">The parent window or dialog box is not notified when the application changes the selection.</span></span>

<span data-ttu-id="715e0-170">Quando uma caixa de combinação é criada, não há nenhuma seleção atual.</span><span class="sxs-lookup"><span data-stu-id="715e0-170">When a combo box is created, there is no current selection.</span></span> <span data-ttu-id="715e0-171">Isso também é verdadeiro para uma caixa de combinação simples ou suspensa, se o usuário tiver editado o conteúdo do campo de seleção.</span><span class="sxs-lookup"><span data-stu-id="715e0-171">This is also true for a simple or drop-down combo box, if the user has edited the contents of the selection field.</span></span> <span data-ttu-id="715e0-172">Para definir a seleção atual, um aplicativo envia a mensagem do [**CB \_ setcurse**](cb-setcursel.md) para a caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="715e0-172">To set the current selection, an application sends the [**CB\_SETCURSEL**](cb-setcursel.md) message to the combo box.</span></span> <span data-ttu-id="715e0-173">Um aplicativo também pode usar a [**mensagem \_ SelectString de CB**](cb-selectstring.md) para definir a seleção atual como um item de lista cuja cadeia de caracteres começa com uma cadeia de caracteres especificada.</span><span class="sxs-lookup"><span data-stu-id="715e0-173">An application can also use the [**CB\_SELECTSTRING**](cb-selectstring.md) message to set the current selection to a list item whose string begins with a specified string.</span></span> <span data-ttu-id="715e0-174">Para determinar a seleção atual, um aplicativo envia a mensagem de [**\_ iscursão CB**](cb-getcursel.md) para a caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="715e0-174">To determine the current selection, an application sends the [**CB\_GETCURSEL**](cb-getcursel.md) message to the combo box.</span></span> <span data-ttu-id="715e0-175">Se não houver nenhuma seleção atual, essa mensagem retornará um \_ erro CB.</span><span class="sxs-lookup"><span data-stu-id="715e0-175">If there is no current selection, this message returns CB\_ERR.</span></span>

<span data-ttu-id="715e0-176">Quando o usuário altera a seleção atual em uma caixa de combinação, a janela pai ou o procedimento de caixa de diálogo recebe uma mensagem de [**\_ comando do WM**](/windows/desktop/menurc/wm-command) com o código de notificação [CBN \_ SELCHANGE](cbn-selchange.md) na palavra de ordem superior do parâmetro *wParam* .</span><span class="sxs-lookup"><span data-stu-id="715e0-176">When the user changes the current selection in a combo box, the parent window or dialog-box procedure receives a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message with the [CBN\_SELCHANGE](cbn-selchange.md) notification code in the high-order word of the *wParam* parameter.</span></span> <span data-ttu-id="715e0-177">Esse código de notificação não é enviado quando a seleção atual é definida usando a mensagem [**\_ setcurseaction**](cb-setcursel.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-177">This notification code is not sent when the current selection is set using the [**CB\_SETCURSEL**](cb-setcursel.md) message.</span></span>

<span data-ttu-id="715e0-178">Uma caixa de combinação suspensa ou uma caixa de listagem suspensa envia o código de notificação [CBN \_ closeup](cbn-closeup.md) para a janela pai ou o procedimento da caixa de diálogo quando a lista suspensa é fechada.</span><span class="sxs-lookup"><span data-stu-id="715e0-178">A drop-down combo box or drop-down list box sends the [CBN\_CLOSEUP](cbn-closeup.md) notification code to the parent window or dialog-box procedure when the drop-down list closes.</span></span> <span data-ttu-id="715e0-179">Se o usuário alterou a seleção atual, a caixa de combinação também envia o código de notificação [CBN \_ SELCHANGE](cbn-selchange.md) quando a lista suspensa é fechada.</span><span class="sxs-lookup"><span data-stu-id="715e0-179">If the user changed the current selection, the combo box also sends the [CBN\_SELCHANGE](cbn-selchange.md) notification code when the drop-down list closes.</span></span> <span data-ttu-id="715e0-180">Para executar um processo específico cada vez que o usuário seleciona um item de lista, você pode manipular o \_ código de notificação CBN SELCHANGE ou CBN \_ closeup.</span><span class="sxs-lookup"><span data-stu-id="715e0-180">To execute a specific process each time the user selects a list item, you can handle either the CBN\_SELCHANGE or CBN\_CLOSEUP notification code.</span></span> <span data-ttu-id="715e0-181">Normalmente, você esperaria pelo código de \_ notificação CBN closeup antes de processar uma alteração na seleção atual.</span><span class="sxs-lookup"><span data-stu-id="715e0-181">Typically, you would wait for the CBN\_CLOSEUP notification code before processing a change in the current selection.</span></span> <span data-ttu-id="715e0-182">Isso pode ser particularmente importante se uma quantidade significativa de processamento for necessária.</span><span class="sxs-lookup"><span data-stu-id="715e0-182">This can be particularly important if a significant amount of processing is required.</span></span>

<span data-ttu-id="715e0-183">Um aplicativo também pode processar os códigos de notificação [CBN \_ SELENDOK](cbn-selendok.md) e [CBN \_ SELENDCANCEL](cbn-selendcancel.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-183">An application could also process the [CBN\_SELENDOK](cbn-selendok.md) and [CBN\_SELENDCANCEL](cbn-selendcancel.md) notification codes.</span></span> <span data-ttu-id="715e0-184">O sistema envia CBN \_ SELENDOK quando o usuário seleciona um item de lista ou seleciona um item e fecha a lista.</span><span class="sxs-lookup"><span data-stu-id="715e0-184">The system sends CBN\_SELENDOK when the user selects a list item, or selects an item and then closes the list.</span></span> <span data-ttu-id="715e0-185">Isso indica que o usuário foi concluído e que a seleção deve ser processada.</span><span class="sxs-lookup"><span data-stu-id="715e0-185">This indicates that the user has finished, and that the selection should be processed.</span></span> <span data-ttu-id="715e0-186">CBN \_ SELENDCANCEL é enviado quando o usuário seleciona um item, mas seleciona outro controle, pressiona ESC enquanto a lista suspensa está aberta ou fecha a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="715e0-186">CBN\_SELENDCANCEL is sent when the user selects an item, but then selects another control, presses ESC while the drop-down list is open, or closes the dialog box.</span></span> <span data-ttu-id="715e0-187">Isso indica que a seleção do usuário deve ser ignorada.</span><span class="sxs-lookup"><span data-stu-id="715e0-187">This indicates that the user's selection should be ignored.</span></span> <span data-ttu-id="715e0-188">CBN \_ SELENDOK é enviado antes de cada mensagem [CBN \_ SELCHANGE](cbn-selchange.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-188">CBN\_SELENDOK is sent before every [CBN\_SELCHANGE](cbn-selchange.md) message.</span></span>

<span data-ttu-id="715e0-189">Em uma caixa de combinação simples, o sistema envia o código de notificação [CBN \_ DBLCLK](cbn-dblclk.md) quando o usuário clica duas vezes em um item de lista.</span><span class="sxs-lookup"><span data-stu-id="715e0-189">In a simple combo box, the system sends the [CBN\_DBLCLK](cbn-dblclk.md) notification code when the user double-clicks a list item.</span></span> <span data-ttu-id="715e0-190">Em uma caixa de combinação suspensa ou lista suspensa, um único clique oculta a lista, portanto, não é possível clicar duas vezes em um item.</span><span class="sxs-lookup"><span data-stu-id="715e0-190">In a drop-down combo box or drop-down list, a single click hides the list, so it is not possible to double-click an item.</span></span>

### <a name="drop-down-lists"></a><span data-ttu-id="715e0-191">Listas suspensas</span><span class="sxs-lookup"><span data-stu-id="715e0-191">Drop-down Lists</span></span>

<span data-ttu-id="715e0-192">Determinadas notificações e mensagens se aplicam somente a caixas de combinação que contêm listas suspensas.</span><span class="sxs-lookup"><span data-stu-id="715e0-192">Certain notifications and messages apply only to combo boxes containing drop-down lists.</span></span> <span data-ttu-id="715e0-193">Quando uma lista suspensa é aberta ou fechada, a janela pai de uma caixa de combinação recebe uma notificação na forma de uma mensagem de [**\_ comando do WM**](/windows/desktop/menurc/wm-command) .</span><span class="sxs-lookup"><span data-stu-id="715e0-193">When a drop-down list is open or closed, the parent window of a combo box receives a notification in the form of a [**WM\_COMMAND**](/windows/desktop/menurc/wm-command) message.</span></span> <span data-ttu-id="715e0-194">Se a lista estiver sendo aberta, a palavra de ordem superior de *wParam* será [CBN \_ DROPDOWN](cbn-dropdown.md).</span><span class="sxs-lookup"><span data-stu-id="715e0-194">If the list is being opened, the high-order word of *wParam* is [CBN\_DROPDOWN](cbn-dropdown.md).</span></span> <span data-ttu-id="715e0-195">Se a lista estiver sendo fechada, ela será [CBN \_ closeup](cbn-closeup.md).</span><span class="sxs-lookup"><span data-stu-id="715e0-195">If the list is being closed, it is [CBN\_CLOSEUP](cbn-closeup.md).</span></span>

<span data-ttu-id="715e0-196">Um aplicativo pode abrir a lista de uma caixa de combinação suspensa ou caixa de listagem suspensa usando a mensagem de lista [**suspensa \_ CB**](cb-showdropdown.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-196">An application can open the list of a drop-down combo box or drop-down list box by using the [**CB\_SHOWDROPDOWN**](cb-showdropdown.md) message.</span></span> <span data-ttu-id="715e0-197">Ele pode determinar se a lista está aberta usando a mensagem [**CB \_ getremovestate**](cb-getdroppedstate.md) e pode determinar as coordenadas de uma lista suspensa usando a mensagem [**CB \_ GETDROPPEDCONTROLRECT**](cb-getdroppedcontrolrect.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-197">It can determine whether the list is open by using the [**CB\_GETDROPPEDSTATE**](cb-getdroppedstate.md) message and can determine the coordinates of a drop-down list by using the [**CB\_GETDROPPEDCONTROLRECT**](cb-getdroppedcontrolrect.md) message.</span></span> <span data-ttu-id="715e0-198">Um aplicativo também pode aumentar a largura de uma lista suspensa usando a mensagem [**CB \_ SETDROPPEDWIDTH**](cb-setdroppedwidth.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-198">An application can also increase the width of a drop-down list by using the [**CB\_SETDROPPEDWIDTH**](cb-setdroppedwidth.md) message.</span></span>

### <a name="list-contents"></a><span data-ttu-id="715e0-199">Listar Conteúdo</span><span class="sxs-lookup"><span data-stu-id="715e0-199">List Contents</span></span>

<span data-ttu-id="715e0-200">Quando um aplicativo cria uma caixa de combinação, ele normalmente Inicializa a caixa de combinação adicionando um ou mais itens à lista.</span><span class="sxs-lookup"><span data-stu-id="715e0-200">When an application creates a combo box, it typically initializes the combo box by adding one or more items to the list.</span></span> <span data-ttu-id="715e0-201">Posteriormente, um aplicativo pode adicionar ou excluir itens de lista, reinicializar a lista ou recuperar informações de item dela.</span><span class="sxs-lookup"><span data-stu-id="715e0-201">Later, an application may add or delete list items, reinitialize the list, or retrieve item information from it.</span></span>

<span data-ttu-id="715e0-202">Um aplicativo adiciona itens de lista a uma caixa de combinação enviando a mensagem de [**\_ AddString CB**](cb-addstring.md) para ele.</span><span class="sxs-lookup"><span data-stu-id="715e0-202">An application adds list items to a combo box by sending the [**CB\_ADDSTRING**](cb-addstring.md) message to it.</span></span> <span data-ttu-id="715e0-203">O item especificado é adicionado ao final da lista ou, em uma caixa de combinação classificada, em sua posição classificada correta com base na cadeia de caracteres do item.</span><span class="sxs-lookup"><span data-stu-id="715e0-203">The specified item is added to the end of the list or, in a sorted combo box, in its correct sorted position based on the item's string.</span></span> <span data-ttu-id="715e0-204">Em uma caixa de combinação não classificada, um aplicativo pode usar a mensagem de [**\_ inserção de CB**](cb-insertstring.md) para inserir um item em uma posição específica.</span><span class="sxs-lookup"><span data-stu-id="715e0-204">In an unsorted combo box, an application can use the [**CB\_INSERTSTRING**](cb-insertstring.md) message to insert an item at a specific position.</span></span> <span data-ttu-id="715e0-205">Depois de adicionado, um item de lista é identificado pela sua posição.</span><span class="sxs-lookup"><span data-stu-id="715e0-205">Once added, a list item is identified by its position.</span></span>

<span data-ttu-id="715e0-206">Usando a mensagem de [**\_ FINDSTRINGEXACT**](cb-findstringexact.md) [**\_ FindString**](cb-findstring.md) ou CB, um aplicativo pode determinar a posição de um item de lista.</span><span class="sxs-lookup"><span data-stu-id="715e0-206">By using the [**CB\_FINDSTRING**](cb-findstring.md) or [**CB\_FINDSTRINGEXACT**](cb-findstringexact.md) message, an application can determine the position of a list item.</span></span> <span data-ttu-id="715e0-207">**CB \_ FINDstring** localiza um item cuja cadeia de caracteres começa com a cadeia de caracteres especificada.</span><span class="sxs-lookup"><span data-stu-id="715e0-207">**CB\_FINDSTRING** finds an item whose string begins with the specified string.</span></span> <span data-ttu-id="715e0-208">**CB \_ FINDSTRINGEXACT** localiza um item cuja cadeia de caracteres corresponde exatamente à cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="715e0-208">**CB\_FINDSTRINGEXACT** finds an item whose string matches the string exactly.</span></span> <span data-ttu-id="715e0-209">Nenhuma mensagem diferencia maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="715e0-209">Neither message is case sensitive.</span></span>

<span data-ttu-id="715e0-210">Um aplicativo pode remover um item de lista usando a [**mensagem \_ excluída CB**](cb-deletestring.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-210">An application can remove a list item by using the [**CB\_DELETESTRING**](cb-deletestring.md) message.</span></span> <span data-ttu-id="715e0-211">Se um aplicativo precisar reinicializar a lista da caixa de combinação, ele poderá primeiro limpar seu conteúdo inteiro usando a mensagem [**CB \_ RESETCONTENT**](cb-resetcontent.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-211">If an application needs to reinitialize the combo box list, it can first clear its entire contents by using the [**CB\_RESETCONTENT**](cb-resetcontent.md) message.</span></span> <span data-ttu-id="715e0-212">Ao adicionar vários itens à lista depois que uma caixa de combinação já tiver sido mostrada, um aplicativo poderá limpar o sinalizador de redesenho para impedir que a caixa de combinação seja repintada após a adição de cada item.</span><span class="sxs-lookup"><span data-stu-id="715e0-212">When adding multiple items to the list after a combo box has already been shown, an application can clear the redraw flag to prevent the combo box from being repainted after each item is added.</span></span> <span data-ttu-id="715e0-213">Para obter mais informações sobre como redesenhar, consulte a descrição da mensagem de [**\_ reemissão do WM**](/windows/desktop/gdi/wm-setredraw) .</span><span class="sxs-lookup"><span data-stu-id="715e0-213">For more information about redrawing, see the description of the [**WM\_SETREDRAW**](/windows/desktop/gdi/wm-setredraw) message.</span></span>

<span data-ttu-id="715e0-214">Para recuperar a cadeia de caracteres associada a um item de lista, um aplicativo pode usar a mensagem [**CB \_ GETLBTEXT**](cb-getlbtext.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-214">To retrieve the string associated with a list item, an application can use the [**CB\_GETLBTEXT**](cb-getlbtext.md) message.</span></span> <span data-ttu-id="715e0-215">A cadeia de caracteres do item é copiada para o buffer especificado pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="715e0-215">The item's string is copied to the buffer specified by the application.</span></span> <span data-ttu-id="715e0-216">Para garantir que o buffer seja grande o suficiente para receber a cadeia de caracteres, o aplicativo pode primeiro usar a mensagem [**\_ GETLBTEXTLEN CB**](cb-getlbtextlen.md) para determinar o comprimento da cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="715e0-216">To ensure that the buffer is large enough to receive the string, the application can first use the [**CB\_GETLBTEXTLEN**](cb-getlbtextlen.md) message to determine the length of the string.</span></span> <span data-ttu-id="715e0-217">Para obter o número de itens de lista em uma caixa de combinação, um aplicativo pode usar a mensagem de [**\_ iscount CB**](cb-getcount.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-217">To get the number of list items in a combo box, an application can use the [**CB\_GETCOUNT**](cb-getcount.md) message.</span></span>

## <a name="edit-control-selection-fields"></a><span data-ttu-id="715e0-218">Editar campos de seleção de controle</span><span class="sxs-lookup"><span data-stu-id="715e0-218">Edit Control Selection Fields</span></span>

<span data-ttu-id="715e0-219">Um aplicativo pode recuperar ou definir o conteúdo do campo de seleção e pode determinar ou definir a seleção de edição.</span><span class="sxs-lookup"><span data-stu-id="715e0-219">An application can retrieve or set the contents of the selection field and can determine or set the edit selection.</span></span> <span data-ttu-id="715e0-220">O aplicativo também pode limitar a quantidade de texto que um usuário pode digitar no campo de seleção.</span><span class="sxs-lookup"><span data-stu-id="715e0-220">The application can also limit the amount of text a user can type in the selection field.</span></span> <span data-ttu-id="715e0-221">Quando o conteúdo do campo de seleção é alterado, o sistema envia mensagens de notificação para o procedimento de janela ou caixa de diálogo pai.</span><span class="sxs-lookup"><span data-stu-id="715e0-221">When the contents of the selection field change, the system sends notification messages to the parent window or dialog box procedure.</span></span>

<span data-ttu-id="715e0-222">Para recuperar o conteúdo do campo de seleção, um aplicativo pode enviar a mensagem de [**\_ gettext do WM**](/windows/desktop/winmsg/wm-gettext) para a caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="715e0-222">To retrieve the content of the selection field, an application can send the [**WM\_GETTEXT**](/windows/desktop/winmsg/wm-gettext) message to the combo box.</span></span> <span data-ttu-id="715e0-223">Para definir o conteúdo do campo de seleção de uma caixa de combinação simples ou suspensa, um aplicativo pode enviar a mensagem do [**WM \_ SetText**](/windows/desktop/winmsg/wm-settext) para a caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="715e0-223">To set the contents of the selection field of a simple or drop-down combo box, an application can send the [**WM\_SETTEXT**](/windows/desktop/winmsg/wm-settext) message to the combo box.</span></span>

<span data-ttu-id="715e0-224">A seleção de editar é o intervalo do texto selecionado, se houver, no campo de seleção de uma caixa de combinação simples ou suspensa.</span><span class="sxs-lookup"><span data-stu-id="715e0-224">The edit selection is the range of selected text, if any, in the selection field of a simple or drop-down combo box.</span></span> <span data-ttu-id="715e0-225">Um aplicativo pode determinar as posições de caractere inicial e final da seleção atual usando a mensagem [**CB \_ GETEDITSEL**](cb-geteditsel.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-225">An application can determine the starting and ending character positions of the current selection by using the [**CB\_GETEDITSEL**](cb-geteditsel.md) message.</span></span> <span data-ttu-id="715e0-226">Ele também pode selecionar os caracteres na seleção de edição usando a mensagem [**CB \_ SETEDITSEL**](cb-seteditsel.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-226">It can also select characters in the edit selection by using the [**CB\_SETEDITSEL**](cb-seteditsel.md) message.</span></span>

<span data-ttu-id="715e0-227">Inicialmente, a quantidade de texto que o usuário pode digitar no campo de seleção é limitada pelo tamanho do campo de seleção.</span><span class="sxs-lookup"><span data-stu-id="715e0-227">Initially, the amount of text that the user can type into the selection field is limited by the size of the selection field.</span></span> <span data-ttu-id="715e0-228">No entanto, se a caixa de combinação tiver o estilo [**\_ AUTOHSCROLL do CBS**](combo-box-styles.md) , o texto poderá continuar além do tamanho do campo de seleção.</span><span class="sxs-lookup"><span data-stu-id="715e0-228">However, if the combo box has the [**CBS\_AUTOHSCROLL**](combo-box-styles.md) style, the text can continue beyond the size of the selection field.</span></span> <span data-ttu-id="715e0-229">Um aplicativo pode usar a [**mensagem \_ LIMITTEXT CB**](cb-limittext.md) para limitar a quantidade de texto que um usuário pode digitar no campo de seleção, independentemente de o controle ter o **estilo \_ AUTOHSCROLL CBS** .</span><span class="sxs-lookup"><span data-stu-id="715e0-229">An application can use the [**CB\_LIMITTEXT**](cb-limittext.md) message to limit the amount of text a user can type into the selection field, regardless of whether the control has the **CBS\_AUTOHSCROLL** style.</span></span>

<span data-ttu-id="715e0-230">Quando o usuário edita o conteúdo do campo de seleção, a janela pai ou o procedimento de caixa de diálogo recebe mensagens de notificação.</span><span class="sxs-lookup"><span data-stu-id="715e0-230">When the user edits the content of the selection field, the parent window or dialog box procedure receives notification messages.</span></span> <span data-ttu-id="715e0-231">O código de notificação [CBN \_ EDITUPDATE](cbn-editupdate.md) é enviado primeiro, indicando que o texto no campo de seleção foi editado.</span><span class="sxs-lookup"><span data-stu-id="715e0-231">The [CBN\_EDITUPDATE](cbn-editupdate.md) notification code is sent first, indicating that the text in the selection field has been edited.</span></span> <span data-ttu-id="715e0-232">Depois que o texto alterado é exibido, o sistema envia [CBN \_ EDITCHANGE](cbn-editchange.md).</span><span class="sxs-lookup"><span data-stu-id="715e0-232">After the altered text is displayed, the system sends [CBN\_EDITCHANGE](cbn-editchange.md).</span></span> <span data-ttu-id="715e0-233">Quando o conteúdo do campo de seleção é alterado como resultado de um item de lista que está sendo selecionado, essas mensagens não são enviadas.</span><span class="sxs-lookup"><span data-stu-id="715e0-233">When the selection field content changes as the result of a list item being selected, these messages are not sent.</span></span>

## <a name="owner-drawn-combo-boxes"></a><span data-ttu-id="715e0-234">Owner-Drawn caixas de combinação</span><span class="sxs-lookup"><span data-stu-id="715e0-234">Owner-Drawn Combo Boxes</span></span>

<span data-ttu-id="715e0-235">Um aplicativo pode criar uma caixa de combinação desenhada pelo proprietário para assumir a responsabilidade por itens de lista de pintura.</span><span class="sxs-lookup"><span data-stu-id="715e0-235">An application can create an owner-drawn combo box to take responsibility for painting list items.</span></span> <span data-ttu-id="715e0-236">A janela pai de uma caixa de combinação desenhada pelo proprietário (seu proprietário) recebe mensagens do [**WM \_ DRAWITEM**](wm-drawitem.md) quando uma parte da caixa de combinação precisa ser pintada.</span><span class="sxs-lookup"><span data-stu-id="715e0-236">The parent window of an owner-drawn combo box (its owner) receives [**WM\_DRAWITEM**](wm-drawitem.md) messages when a portion of the combo box needs to be painted.</span></span> <span data-ttu-id="715e0-237">Uma caixa de combinação desenhada pelo proprietário pode listar informações diferentes de, ou além de, cadeias de caracteres de texto.</span><span class="sxs-lookup"><span data-stu-id="715e0-237">An owner-drawn combo box can list information other than, or in addition to, text strings.</span></span> <span data-ttu-id="715e0-238">As caixas de combinação desenhadas pelo proprietário podem ser de qualquer tipo.</span><span class="sxs-lookup"><span data-stu-id="715e0-238">Owner-drawn combo boxes can be of any type.</span></span> <span data-ttu-id="715e0-239">No entanto, o controle de edição em uma caixa de combinação simples ou suspensa só pode exibir texto, enquanto o proprietário pinta o campo de seleção em uma caixa de listagem suspensa.</span><span class="sxs-lookup"><span data-stu-id="715e0-239">However, the edit control in a simple or drop-down combo box can only display text, while the owner paints the selection field in a drop-down list box.</span></span>

<span data-ttu-id="715e0-240">O proprietário de uma caixa de combinação desenhada pelo proprietário deve processar a mensagem do [**WM \_ DRAWITEM**](wm-drawitem.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-240">The owner of an owner-drawn combo box must process the [**WM\_DRAWITEM**](wm-drawitem.md) message.</span></span> <span data-ttu-id="715e0-241">Essa mensagem é enviada sempre que uma parte da caixa de combinação deve ser redesenhada.</span><span class="sxs-lookup"><span data-stu-id="715e0-241">This message is sent whenever a portion of the combo box must be redrawn.</span></span> <span data-ttu-id="715e0-242">O proprietário pode precisar processar outras mensagens, dependendo dos estilos especificados para a caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="715e0-242">The owner may need to process other messages, depending on the styles specified for the combo box.</span></span>

<span data-ttu-id="715e0-243">Um aplicativo pode criar uma caixa de combinação desenhada pelo proprietário especificando o estilo [**CBS \_ OwnerDrawFixed**](combo-box-styles.md) ou [**CBS \_ OwnerDrawVariable**](combo-box-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-243">An application can create an owner-drawn combo box by specifying the [**CBS\_OWNERDRAWFIXED**](combo-box-styles.md) or [**CBS\_OWNERDRAWVARIABLE**](combo-box-styles.md) style.</span></span> <span data-ttu-id="715e0-244">Se todos os itens da lista na caixa de combinação tiverem a mesma altura, como cadeias de caracteres ou ícones, um aplicativo poderá usar o estilo **\_ OwnerDrawFixed do CBS** .</span><span class="sxs-lookup"><span data-stu-id="715e0-244">If all list items in the combo box are the same height, such as strings or icons, an application can use the **CBS\_OWNERDRAWFIXED** style.</span></span> <span data-ttu-id="715e0-245">Se os itens de lista forem de altura variável, como bitmaps de tamanho diferente, um aplicativo poderá usar o estilo **\_ OwnerDrawVariable do CBS** .</span><span class="sxs-lookup"><span data-stu-id="715e0-245">If list items are of varying height, like bitmaps of different size, an application can use the **CBS\_OWNERDRAWVARIABLE** style.</span></span>

<span data-ttu-id="715e0-246">O proprietário de uma caixa de combinação desenhada pelo proprietário pode processar uma mensagem do [**WM \_ MEASUREITEM**](wm-measureitem.md) para especificar as dimensões de itens de lista na caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="715e0-246">The owner of an owner-drawn combo box can process a [**WM\_MEASUREITEM**](wm-measureitem.md) message to specify the dimensions of list items in the combo box.</span></span> <span data-ttu-id="715e0-247">Se o aplicativo criar a caixa de combinação usando o [**estilo \_ OwnerDrawFixed do CBS**](combo-box-styles.md) , o sistema enviará a mensagem do **WM \_ MEASUREITEM** apenas uma vez.</span><span class="sxs-lookup"><span data-stu-id="715e0-247">If the application creates the combo box by using the [**CBS\_OWNERDRAWFIXED**](combo-box-styles.md) style, the system sends the **WM\_MEASUREITEM** message only once.</span></span> <span data-ttu-id="715e0-248">As dimensões especificadas pelo proprietário são usadas para todos os itens de lista.</span><span class="sxs-lookup"><span data-stu-id="715e0-248">The dimensions specified by the owner are used for all list items.</span></span> <span data-ttu-id="715e0-249">Se o estilo [**CBS \_ OwnerDrawVariable**](combo-box-styles.md) for usado, o sistema enviará uma mensagem do **WM \_ MEASUREITEM** para cada item de lista adicionado à caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="715e0-249">If the [**CBS\_OWNERDRAWVARIABLE**](combo-box-styles.md) style is used, the system sends a **WM\_MEASUREITEM** message for each list item added to the combo box.</span></span> <span data-ttu-id="715e0-250">O proprietário pode determinar ou definir a altura de um item de lista a qualquer momento usando as mensagens [**CB \_ GETITEMHEIGHT**](cb-getitemheight.md) e [**CB \_ SETITEMHEIGHT**](cb-setitemheight.md) , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="715e0-250">The owner can determine or set the height of a list item at any time by using the [**CB\_GETITEMHEIGHT**](cb-getitemheight.md) and [**CB\_SETITEMHEIGHT**](cb-setitemheight.md) messages, respectively.</span></span>

<span data-ttu-id="715e0-251">Se as informações exibidas em uma caixa de combinação desenhada pelo proprietário incluírem texto, um aplicativo poderá controlar o texto de cada item de lista especificando o estilo [**CBS \_ HASSTRINGS**](combo-box-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-251">If the information displayed in an owner-drawn combo box includes text, an application can keep track of the text for each list item by specifying the [**CBS\_HASSTRINGS**](combo-box-styles.md) style.</span></span> <span data-ttu-id="715e0-252">As caixas de combinação com o estilo de [**\_ classificação CBS**](combo-box-styles.md) são classificadas com base neste texto.</span><span class="sxs-lookup"><span data-stu-id="715e0-252">Combo boxes with the [**CBS\_SORT**](combo-box-styles.md) style are sorted based on this text.</span></span> <span data-ttu-id="715e0-253">Se uma caixa de combinação for classificada e não do estilo **\_ HASSTRINGS do CBS** , o proprietário deverá processar a mensagem do [**WM \_ COMPAREITEM**](wm-compareitem.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-253">If a combo box is sorted and not of the **CBS\_HASSTRINGS** style, the owner must process the [**WM\_COMPAREITEM**](wm-compareitem.md) message.</span></span>

<span data-ttu-id="715e0-254">Em uma caixa de combinação desenhada pelo proprietário, o proprietário deve manter o controle dos itens de lista contendo informações que não sejam ou além do texto.</span><span class="sxs-lookup"><span data-stu-id="715e0-254">In an owner-drawn combo box, the owner must keep track of list items containing information other than or in addition to text.</span></span> <span data-ttu-id="715e0-255">Uma maneira conveniente de fazer isso é salvar o identificador nas informações como dados do item.</span><span class="sxs-lookup"><span data-stu-id="715e0-255">One convenient way to do this is to save the handle to the information as item data.</span></span> <span data-ttu-id="715e0-256">Para liberar objetos de dados associados a itens em uma caixa de combinação, o proprietário pode processar a mensagem [**\_ DELETEITEM do WM**](wm-deleteitem.md) .</span><span class="sxs-lookup"><span data-stu-id="715e0-256">To free data objects associated with items in a combo box, the owner can process the [**WM\_DELETEITEM**](wm-deleteitem.md) message.</span></span>

## <a name="subclassed-combo-boxes"></a><span data-ttu-id="715e0-257">Caixas de combinação de subclasse</span><span class="sxs-lookup"><span data-stu-id="715e0-257">Subclassed Combo Boxes</span></span>

<span data-ttu-id="715e0-258">A subclasse é um procedimento que permite que um aplicativo intercepte e processe mensagens enviadas ou postadas em uma janela.</span><span class="sxs-lookup"><span data-stu-id="715e0-258">Subclassing is a procedure that allows an application to intercept and process messages sent or posted to a window.</span></span> <span data-ttu-id="715e0-259">Usando a subclasse, um aplicativo pode substituir seu próprio processamento para determinadas mensagens, deixando a maioria do processamento de mensagens para o procedimento de janela definido pela classe.</span><span class="sxs-lookup"><span data-stu-id="715e0-259">By using subclassing, an application can substitute its own processing for certain messages, while leaving most message processing to the class-defined window procedure.</span></span>

<span data-ttu-id="715e0-260">Quando o sistema operacional cria uma janela, ele salva informações sobre ela em uma estrutura de dados interna que inclui um ponteiro para o procedimento de janela.</span><span class="sxs-lookup"><span data-stu-id="715e0-260">When the operating system creates a window, it saves information about it in an internal data structure that includes a pointer to the window procedure.</span></span> <span data-ttu-id="715e0-261">Para subclasse de uma janela, um aplicativo chama a função [**SetClassLong**](/windows/desktop/api/winuser/nf-winuser-setclasslonga) para substituir o ponteiro para esse procedimento por um ponteiro para um procedimento de subclasse definido pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="715e0-261">To subclass a window, an application calls the [**SetClassLong**](/windows/desktop/api/winuser/nf-winuser-setclasslonga) function to replace the pointer to that procedure with a pointer to an application-defined subclass procedure.</span></span> <span data-ttu-id="715e0-262">Depois disso, todas as mensagens para a janela são enviadas para o procedimento de subclasse.</span><span class="sxs-lookup"><span data-stu-id="715e0-262">Thereafter, all messages to the window are sent to the subclass procedure.</span></span> <span data-ttu-id="715e0-263">Esse procedimento usa a função [**CallWindowProc**](/windows/desktop/api/winuser/nf-winuser-callwindowproca) para passar mensagens não processadas para o procedimento de janela original.</span><span class="sxs-lookup"><span data-stu-id="715e0-263">This procedure then uses the [**CallWindowProc**](/windows/desktop/api/winuser/nf-winuser-callwindowproca) function to pass unprocessed messages to the original window procedure.</span></span> <span data-ttu-id="715e0-264">Para obter uma descrição do processamento de mensagens executado pelo procedimento da janela da classe COMBOBOX, consulte [comportamento padrão da caixa de combinação](combo-box-features.md).</span><span class="sxs-lookup"><span data-stu-id="715e0-264">For a description of the message processing performed by the COMBOBOX class window procedure, see [Default Combo Box Behavior](combo-box-features.md).</span></span>

<span data-ttu-id="715e0-265">Quando a caixa de combinação está fora de uma caixa de diálogo, um aplicativo não pode processar a guia, inserir e teclas ESC, a menos que use um procedimento de subclasse.</span><span class="sxs-lookup"><span data-stu-id="715e0-265">When the combo box is outside a dialog box, an application cannot process the TAB, ENTER, and ESC keys unless it uses a subclass procedure.</span></span> <span data-ttu-id="715e0-266">Quando uma caixa de combinação simples ou suspensa recebe o foco de entrada, ela imediatamente define o foco para seu controle de edição filho.</span><span class="sxs-lookup"><span data-stu-id="715e0-266">When a simple or drop-down combo box receives the input focus, it immediately sets the focus to its child edit control.</span></span> <span data-ttu-id="715e0-267">Portanto, um aplicativo deve subclasse do controle de edição para interceptar a entrada do teclado para uma caixa de combinação simples ou suspensa.</span><span class="sxs-lookup"><span data-stu-id="715e0-267">Therefore, an application must subclass the edit control to intercept keyboard input for a simple or drop-down combo box.</span></span> <span data-ttu-id="715e0-268">Para obter um exemplo disso, consulte [subclasse de uma caixa de combinação](using-combo-boxes.md).</span><span class="sxs-lookup"><span data-stu-id="715e0-268">For an example of this, see [Subclassing a Combo Box](using-combo-boxes.md).</span></span>

<span data-ttu-id="715e0-269">Se um procedimento de subclasse processar a mensagem do [**WM \_ Paint**](/windows/desktop/gdi/wm-paint) , ele deverá usar a função [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) para se preparar para a pintura.</span><span class="sxs-lookup"><span data-stu-id="715e0-269">If a subclass procedure processes the [**WM\_PAINT**](/windows/desktop/gdi/wm-paint) message, it must use the [**BeginPaint**](/windows/desktop/api/winuser/nf-winuser-beginpaint) function to prepare for painting.</span></span> <span data-ttu-id="715e0-270">Antes de chamar a função [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) , ela passa o identificador do controlador de domínio (DC) como o parâmetro *wParam* para o procedimento de janela.</span><span class="sxs-lookup"><span data-stu-id="715e0-270">Before calling the [**EndPaint**](/windows/desktop/api/winuser/nf-winuser-endpaint) function, it passes the device context (DC) handle as the *wParam* parameter for the window procedure.</span></span> <span data-ttu-id="715e0-271">Se **EndPaint** for chamado primeiro, o procedimento da janela de classe não pintará porque **endpaintt** valida a janela inteira.</span><span class="sxs-lookup"><span data-stu-id="715e0-271">If **EndPaint** is called first, the class window procedure does no painting because **EndPaint** validates the entire window.</span></span>

<span data-ttu-id="715e0-272">Uma técnica relacionada à subclasse é a superclasse.</span><span class="sxs-lookup"><span data-stu-id="715e0-272">A technique related to subclassing is superclassing.</span></span> <span data-ttu-id="715e0-273">Uma superclasse é semelhante a qualquer outra classe, exceto que seu procedimento de janela não chama [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) para lidar com mensagens não processadas.</span><span class="sxs-lookup"><span data-stu-id="715e0-273">A superclass resembles any other class except that its window procedure does not call [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) to handle unprocessed messages.</span></span> <span data-ttu-id="715e0-274">Em vez disso, ele passa mensagens não processadas para o procedimento de janela para a classe de janela pai.</span><span class="sxs-lookup"><span data-stu-id="715e0-274">Instead, it passes unprocessed messages to the window procedure for the parent window class.</span></span> <span data-ttu-id="715e0-275">Siga as diretrizes em [procedimentos de janela](/windows/desktop/winmsg/window-procedures) para evitar problemas que podem ocorrer com a subclasse e a superclasse.</span><span class="sxs-lookup"><span data-stu-id="715e0-275">Follow the guidelines in [Window Procedures](/windows/desktop/winmsg/window-procedures) to avoid problems that can occur with subclassing and superclassing.</span></span>

 

 