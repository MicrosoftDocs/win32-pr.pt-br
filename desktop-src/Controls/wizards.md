---
title: Como criar assistentes
description: Um assistente é um tipo de folha de propriedades que fornece uma maneira simples e poderosa de orientar os usuários por meio de um procedimento.
ms.assetid: f8def159-0a68-4d7f-9840-c7b6b906ed08
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fedd35bd0454e0d78ddbe74d832543e58d0a8fc7
ms.sourcegitcommit: 11f52354f570aacaf1ba2a266b2e507abd73352a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/19/2021
ms.locfileid: "105762742"
---
# <a name="how-to-create-wizards"></a><span data-ttu-id="a6af8-103">Como criar assistentes</span><span class="sxs-lookup"><span data-stu-id="a6af8-103">How to Create Wizards</span></span>

<span data-ttu-id="a6af8-104">Um assistente é um tipo de folha de propriedades que fornece uma maneira simples e poderosa de orientar os usuários por meio de um procedimento.</span><span class="sxs-lookup"><span data-stu-id="a6af8-104">A wizard is a type of property sheet that provides a simple and powerful way to guide users through a procedure.</span></span>

<span data-ttu-id="a6af8-105">Os assistentes são uma das chaves para simplificar a experiência do usuário.</span><span class="sxs-lookup"><span data-stu-id="a6af8-105">Wizards are one of the keys to simplifying the user experience.</span></span> <span data-ttu-id="a6af8-106">Eles permitem que você execute uma operação complexa, como a configuração de um aplicativo, e divida-o em uma série de etapas simples.</span><span class="sxs-lookup"><span data-stu-id="a6af8-106">They allow you to take a complex operation, such as configuration of an application, and break it into a series of simple steps.</span></span> <span data-ttu-id="a6af8-107">Em cada ponto do processo, você pode fornecer uma explicação do que é necessário e exibir controles que permitem ao usuário fazer seleções e inserir texto.</span><span class="sxs-lookup"><span data-stu-id="a6af8-107">At each point in the process, you can provide an explanation of what is needed, and display controls that allow the user to make selections and enter text.</span></span>

<span data-ttu-id="a6af8-108">Um assistente é, na verdade, um tipo de folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="a6af8-108">A wizard is actually a type of property sheet.</span></span> <span data-ttu-id="a6af8-109">Uma folha de propriedades é essencialmente um contêiner para uma coleção de *páginas*, em que cada página é uma caixa de diálogo separada.</span><span class="sxs-lookup"><span data-stu-id="a6af8-109">A property sheet is essentially a container for a collection of *pages*, where each page is a separate dialog box.</span></span> <span data-ttu-id="a6af8-110">Enquanto as folhas de propriedades regulares permitem que o usuário acesse qualquer página a qualquer momento, os assistentes apresentam páginas em sequência.</span><span class="sxs-lookup"><span data-stu-id="a6af8-110">Whereas regular property sheets allow the user to access any page at any time, wizards present pages in sequence.</span></span> <span data-ttu-id="a6af8-111">Em vez de guias, os botões são usados para navegar para frente e para trás.</span><span class="sxs-lookup"><span data-stu-id="a6af8-111">Instead of tabs, buttons are used to navigate forward and backward.</span></span> <span data-ttu-id="a6af8-112">A ordem na qual as páginas são exibidas é controlada pelo aplicativo e pode ser modificada com base na entrada do usuário.</span><span class="sxs-lookup"><span data-stu-id="a6af8-112">The order in which pages are displayed is controlled by the application and can be modified based on user input.</span></span>

<span data-ttu-id="a6af8-113">Há dois estilos principais de assistente: o estilo de Wizard97 mais antigo e o estilo Aero introduzido no Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="a6af8-113">There are two main styles of wizard: the older Wizard97 style, and the Aero style introduced in Windows Vista.</span></span> <span data-ttu-id="a6af8-114">Para ilustrações, consulte [sobre folhas de propriedades](property-sheets.md).</span><span class="sxs-lookup"><span data-stu-id="a6af8-114">For illustrations, see [About Property Sheets](property-sheets.md).</span></span> <span data-ttu-id="a6af8-115">(Um terceiro estilo, usando apenas o PSH \_ Do assistente ou \_ \_ sinalizador Lite do assistente de PSH, apresenta uma sequência simples de folhas de propriedades sem cabeçalhos ou marcas-d ' água.)</span><span class="sxs-lookup"><span data-stu-id="a6af8-115">(A third style, using just the PSH\_WIZARD or PSH\_WIZARD\_LITE flag, presents a simple sequence of property sheets with no headers or watermarks.)</span></span>

> [!Note]  
> <span data-ttu-id="a6af8-116">Uma "marca d' água" no contexto de assistentes é um bitmap que aparece na margem esquerda de algumas páginas.</span><span class="sxs-lookup"><span data-stu-id="a6af8-116">A "watermark" in the context of wizards is a bitmap that appears in the left margin of some pages.</span></span>

 

<span data-ttu-id="a6af8-117">A discussão na maior parte deste documento pressupõe que você está implementando um assistente para um sistema com a [versão 5,80](common-control-versions.md) ou posterior dos controles comuns.</span><span class="sxs-lookup"><span data-stu-id="a6af8-117">The discussion in most of this document assumes that you are implementing a wizard for a system with [version 5.80](common-control-versions.md) or later of the common controls.</span></span> <span data-ttu-id="a6af8-118">Se você tentar usar o estilo Wizard97 com versões anteriores dos controles comuns, seu aplicativo poderá ser compilado, mas não será exibido corretamente.</span><span class="sxs-lookup"><span data-stu-id="a6af8-118">If you attempt to use the Wizard97 style with earlier versions of the common controls, your application may compile but it will not display properly.</span></span> <span data-ttu-id="a6af8-119">Para obter uma discussão sobre como criar um assistente compatível com Wizard97 em sistemas anteriores, consulte assistentes de compatibilidade retroativa mais adiante neste tópico.</span><span class="sxs-lookup"><span data-stu-id="a6af8-119">For a discussion about how to create a Wizard97-compatible wizard on earlier systems, see Backward Compatible Wizards later in this topic.</span></span>

## <a name="what-you-need-to-know"></a><span data-ttu-id="a6af8-120">O que você precisa saber</span><span class="sxs-lookup"><span data-stu-id="a6af8-120">What you need to know</span></span>

### <a name="technologies"></a><span data-ttu-id="a6af8-121">Tecnologias</span><span class="sxs-lookup"><span data-stu-id="a6af8-121">Technologies</span></span>

-   [<span data-ttu-id="a6af8-122">Controles do Windows</span><span class="sxs-lookup"><span data-stu-id="a6af8-122">Windows Controls</span></span>](window-controls.md)

### <a name="prerequisites"></a><span data-ttu-id="a6af8-123">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="a6af8-123">Prerequisites</span></span>

-   <span data-ttu-id="a6af8-124">C/C++</span><span class="sxs-lookup"><span data-stu-id="a6af8-124">C/C++</span></span>
-   <span data-ttu-id="a6af8-125">Programação da interface do usuário do Windows</span><span class="sxs-lookup"><span data-stu-id="a6af8-125">Windows User Interface Programming</span></span>

## <a name="instructions"></a><span data-ttu-id="a6af8-126">Instruções</span><span class="sxs-lookup"><span data-stu-id="a6af8-126">Instructions</span></span>

### <a name="wizard-implementation"></a><span data-ttu-id="a6af8-127">Implementação do assistente</span><span class="sxs-lookup"><span data-stu-id="a6af8-127">Wizard Implementation</span></span>

<span data-ttu-id="a6af8-128">A implementação de um assistente é semelhante à implementação de uma folha de propriedades regular.</span><span class="sxs-lookup"><span data-stu-id="a6af8-128">Implementing a wizard is similar to implementing a regular property sheet.</span></span> <span data-ttu-id="a6af8-129">No nível mais básico, é uma questão de definir um dos seguintes sinalizadores ou combinações de sinalizadores na estrutura [**PROPSHEETHEADER**](pss-propsheetheader.md) que define a folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="a6af8-129">At the most basic level, it is a matter of setting one of the following flags or combinations of flags in the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure that defines the property sheet.</span></span>



| <span data-ttu-id="a6af8-130">Sinalizador</span><span class="sxs-lookup"><span data-stu-id="a6af8-130">Flag</span></span>                           | <span data-ttu-id="a6af8-131">Estilo</span><span class="sxs-lookup"><span data-stu-id="a6af8-131">Style</span></span>                                                                                                                                                 |
|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a6af8-132">Assistente de PSH \_</span><span class="sxs-lookup"><span data-stu-id="a6af8-132">PSH\_WIZARD</span></span>                    | <span data-ttu-id="a6af8-133">Um assistente simples sem cabeçalhos ou bitmaps.</span><span class="sxs-lookup"><span data-stu-id="a6af8-133">A simple wizard with no headers or bitmaps.</span></span>                                                                                                           |
| <span data-ttu-id="a6af8-134">Assistente de PSH \_ \_ Lite</span><span class="sxs-lookup"><span data-stu-id="a6af8-134">PSH\_WIZARD\_LITE</span></span>              | <span data-ttu-id="a6af8-135">Semelhante ao assistente de PSH \_ , com algumas pequenas diferenças na aparência; por exemplo, o divisor acima dos botões é definido com a largura total da janela.</span><span class="sxs-lookup"><span data-stu-id="a6af8-135">Similar to PSH\_WIZARD, with some minor differences in appearance; for example, the divider above the buttons is set to the full width of the window.</span></span> |
| <span data-ttu-id="a6af8-136">PSH \_ WIZARD97</span><span class="sxs-lookup"><span data-stu-id="a6af8-136">PSH\_WIZARD97</span></span>                  | <span data-ttu-id="a6af8-137">Um assistente de Wizard97 com cabeçalhos (opcional), bitmaps de cabeçalho e marcas-d ' água.</span><span class="sxs-lookup"><span data-stu-id="a6af8-137">A Wizard97 wizard with (optional) headers, header bitmaps, and watermarks.</span></span>                                                                            |
| <span data-ttu-id="a6af8-138">PSH \_ assistente \| PSH \_ AEROWIZARD</span><span class="sxs-lookup"><span data-stu-id="a6af8-138">PSH\_WIZARD \| PSH\_AEROWIZARD</span></span> | <span data-ttu-id="a6af8-139">Um assistente de Aero.</span><span class="sxs-lookup"><span data-stu-id="a6af8-139">An Aero Wizard.</span></span> <span data-ttu-id="a6af8-140">Os assistentes do Aero não usam marcas d' água ou bitmaps de cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="a6af8-140">Aero Wizards do not use watermarks or header bitmaps.</span></span> <span data-ttu-id="a6af8-141">Eles exigem o modelo STA (single-threaded apartment).</span><span class="sxs-lookup"><span data-stu-id="a6af8-141">They require the single-threaded apartment (STA) model.</span></span>                         |



 

<span data-ttu-id="a6af8-142">O procedimento básico para implementar um assistente é o seguinte:</span><span class="sxs-lookup"><span data-stu-id="a6af8-142">The basic procedure for implementing a wizard is as follows:</span></span>

1.  <span data-ttu-id="a6af8-143">Crie um modelo de caixa de diálogo para cada página.</span><span class="sxs-lookup"><span data-stu-id="a6af8-143">Create a dialog box template for each page.</span></span>
2.  <span data-ttu-id="a6af8-144">Defina as páginas criando uma estrutura [**PROPSHEETPAGE**](pss-propsheetpage.md) para cada página.</span><span class="sxs-lookup"><span data-stu-id="a6af8-144">Define the pages by creating a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure for each page.</span></span> <span data-ttu-id="a6af8-145">Essa estrutura define a página e contém ponteiros para o modelo de caixa de diálogo e quaisquer bitmaps ou outros recursos.</span><span class="sxs-lookup"><span data-stu-id="a6af8-145">This structure defines the page, and contains pointers to the dialog box template and any bitmaps or other resources.</span></span>
3.  <span data-ttu-id="a6af8-146">Passe a estrutura [**PROPSHEETPAGE**](pss-propsheetpage.md) que foi criada na etapa anterior para a função [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) para criar o identificador HPROPSHEETPAGE da página.</span><span class="sxs-lookup"><span data-stu-id="a6af8-146">Pass the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure that was created in the previous step to the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function to create the page's HPROPSHEETPAGE handle.</span></span>
4.  <span data-ttu-id="a6af8-147">Defina o assistente criando uma estrutura [**PROPSHEETHEADER**](pss-propsheetheader.md) para ele.</span><span class="sxs-lookup"><span data-stu-id="a6af8-147">Define the wizard by creating a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure for it.</span></span>
5.  <span data-ttu-id="a6af8-148">Passe a estrutura [**PROPSHEETHEADER**](pss-propsheetheader.md) para a função [**folha**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) para exibir o assistente.</span><span class="sxs-lookup"><span data-stu-id="a6af8-148">Pass the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure to the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function to display the wizard.</span></span>
6.  <span data-ttu-id="a6af8-149">Implemente procedimentos de caixa de diálogo para cada página para lidar com mensagens de notificação dos controles da página e dos botões do assistente e para processar outras mensagens do Windows.</span><span class="sxs-lookup"><span data-stu-id="a6af8-149">Implement dialog box procedures for each page to handle notification messages from the page's controls and the wizard's buttons and to process other Windows messaging.</span></span>

### <a name="create-the-dialog-box-templates"></a><span data-ttu-id="a6af8-150">Criar os modelos de caixa de diálogo</span><span class="sxs-lookup"><span data-stu-id="a6af8-150">Create the Dialog Box Templates</span></span>

<span data-ttu-id="a6af8-151">Há dois tipos básicos de página de assistente: exterior e interior.</span><span class="sxs-lookup"><span data-stu-id="a6af8-151">There are two basic types of wizard page: exterior and interior.</span></span> <span data-ttu-id="a6af8-152">As páginas exteriores são as páginas de introdução (bem-vindo) e conclusão.</span><span class="sxs-lookup"><span data-stu-id="a6af8-152">Exterior pages are the introduction (welcome) and completion pages.</span></span> <span data-ttu-id="a6af8-153">Todos os outros são páginas interiores.</span><span class="sxs-lookup"><span data-stu-id="a6af8-153">All others are interior pages.</span></span>

<span data-ttu-id="a6af8-154">**Modelos da caixa de diálogo da página exterior**</span><span class="sxs-lookup"><span data-stu-id="a6af8-154">**Exterior Page Dialog Box Templates**</span></span>

<span data-ttu-id="a6af8-155">O layout básico das páginas introdução e conclusão é idêntico.</span><span class="sxs-lookup"><span data-stu-id="a6af8-155">The basic layout of the introduction and completion pages is identical.</span></span> <span data-ttu-id="a6af8-156">A ilustração a seguir mostra uma página de introdução Wizard97 de exemplo, com uma marca d' água de espaço reservado.</span><span class="sxs-lookup"><span data-stu-id="a6af8-156">The following illustration shows a sample Wizard97 introduction page, with a placeholder watermark.</span></span>

![captura de tela mostrando uma página de assistente com um gráfico à esquerda, título e corpo do texto à direita, os botões voltar, avançar e cancelar na parte inferior](images/wiz97exterior.png)

<span data-ttu-id="a6af8-158">Para páginas exteriores Wizard97, o modelo de caixa de diálogo é as unidades de diálogo 317x193.</span><span class="sxs-lookup"><span data-stu-id="a6af8-158">For Wizard97 exterior pages, the dialog box template is 317x193 dialog units.</span></span> <span data-ttu-id="a6af8-159">Ele preenche todo o assistente, exceto a legenda e a faixa na parte inferior que contém os botões **voltar**, **Avançar** e **Cancelar** .</span><span class="sxs-lookup"><span data-stu-id="a6af8-159">It fills all of the wizard, except for the caption and the band at the bottom that contains the **Back**, **Next**, and **Cancel** buttons.</span></span> <span data-ttu-id="a6af8-160">O lado esquerdo do modelo, que é reservado para um bitmap de "marca d' água", não deve conter nenhum controle.</span><span class="sxs-lookup"><span data-stu-id="a6af8-160">The left side of the template, which is reserved for a "watermark" bitmap, should not contain any controls.</span></span> <span data-ttu-id="a6af8-161">A marca d' água é especificada na estrutura [**PROPSHEETHEADER**](pss-propsheetheader.md) do assistente e é adicionada à página automaticamente.</span><span class="sxs-lookup"><span data-stu-id="a6af8-161">The watermark is specified in the wizard's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure and is added to the page automatically.</span></span> <span data-ttu-id="a6af8-162">Você deve permitir espaço para ele ao criar o modelo de recurso.</span><span class="sxs-lookup"><span data-stu-id="a6af8-162">You must allow space for it when designing the resource template.</span></span>

<span data-ttu-id="a6af8-163">Ao criar o bitmap de marca d' água, lembre-se de que a caixa de diálogo pode aumentar em tamanho se, por exemplo, o usuário escolher uma grande fonte do sistema.</span><span class="sxs-lookup"><span data-stu-id="a6af8-163">When you create the watermark bitmap, keep in mind that the dialog box may increase in size if, for example, the user chooses a large system font.</span></span> <span data-ttu-id="a6af8-164">Diferentes idiomas também tendem a ter diferentes métricas de fonte.</span><span class="sxs-lookup"><span data-stu-id="a6af8-164">Different languages also tend to have different font metrics.</span></span> <span data-ttu-id="a6af8-165">Quando a página cresce, a área reservada para a marca d' água fica proporcionalmente maior.</span><span class="sxs-lookup"><span data-stu-id="a6af8-165">When the page grows, the area reserved for the watermark gets proportionately larger.</span></span> <span data-ttu-id="a6af8-166">No entanto, você não pode alterar o bitmap de marca d' água, nem o bitmap é ampliado para preencher a área maior.</span><span class="sxs-lookup"><span data-stu-id="a6af8-166">However, you cannot change the watermark bitmap, nor is the bitmap stretched to fill the larger area.</span></span> <span data-ttu-id="a6af8-167">Em vez disso, o bitmap é deixado em seu tamanho original na parte superior esquerda da área reservada.</span><span class="sxs-lookup"><span data-stu-id="a6af8-167">Instead, the bitmap is left in its original size in the upper-left portion of the reserved area.</span></span> <span data-ttu-id="a6af8-168">A parte da área reservada maior que não é coberta pela marca d' água é preenchida automaticamente com a cor do pixel superior esquerdo do bitmap.</span><span class="sxs-lookup"><span data-stu-id="a6af8-168">The part of the larger reserved area that is not covered by the watermark is automatically filled with the color of the bitmap's upper-left pixel.</span></span>

<span data-ttu-id="a6af8-169">Se você precisar ter bitmaps de marca d' água de tamanho diferente para métricas de fonte diferentes, duas soluções possíveis são:</span><span class="sxs-lookup"><span data-stu-id="a6af8-169">If you need to have different-sized watermark bitmaps for different font metrics, two possible solutions are:</span></span>

-   <span data-ttu-id="a6af8-170">Obtenha as métricas de fonte antes de criar o assistente e especifique um bitmap de marca d' água de tamanho adequado.</span><span class="sxs-lookup"><span data-stu-id="a6af8-170">Get the font metrics before creating the wizard, and specify an appropriately sized watermark bitmap.</span></span>
-   <span data-ttu-id="a6af8-171">Não especifique um bitmap de marca d' água ao criar o assistente.</span><span class="sxs-lookup"><span data-stu-id="a6af8-171">Do not specify a watermark bitmap when you create the wizard.</span></span> <span data-ttu-id="a6af8-172">Wizard97 deixará a área da marca d' água em branco.</span><span class="sxs-lookup"><span data-stu-id="a6af8-172">Wizard97 will leave the watermark area blank.</span></span> <span data-ttu-id="a6af8-173">Em seguida, desenhe um bitmap de tamanho apropriado na área reservada para a marca d' água.</span><span class="sxs-lookup"><span data-stu-id="a6af8-173">Then draw an appropriately sized bitmap on the area reserved for the watermark.</span></span>

<span data-ttu-id="a6af8-174">Você pode colocar os controles na área à direita da marca-d ' água como faria em uma caixa de diálogo comum.</span><span class="sxs-lookup"><span data-stu-id="a6af8-174">You can place controls in the area to the right of the watermark as you would for a regular dialog box.</span></span> <span data-ttu-id="a6af8-175">A cor do plano de fundo dessa área é determinada pelo sistema e não requer nenhuma ação de sua parte.</span><span class="sxs-lookup"><span data-stu-id="a6af8-175">The background color of this area is determined by the system, and requires no action on your part.</span></span> <span data-ttu-id="a6af8-176">Normalmente, você coloca dois controles estáticos nessa área.</span><span class="sxs-lookup"><span data-stu-id="a6af8-176">You typically put two static controls in this area.</span></span> <span data-ttu-id="a6af8-177">A parte superior contém o título e usa uma fonte grande em negrito (12 pontos Verdana negrito para Wizard97).</span><span class="sxs-lookup"><span data-stu-id="a6af8-177">The upper one holds the title and uses a large bold font (12 point Verdana Bold for Wizard97).</span></span> <span data-ttu-id="a6af8-178">O outro, que é para um texto explicativo, usa a fonte da caixa de diálogo padrão.</span><span class="sxs-lookup"><span data-stu-id="a6af8-178">The other one, which is for explanatory text, uses the standard dialog box font.</span></span>

<span data-ttu-id="a6af8-179">A principal diferença entre as páginas de introdução e conclusão são os botões do assistente e o texto nos controles estáticos.</span><span class="sxs-lookup"><span data-stu-id="a6af8-179">The main difference between the introduction and completion pages is the wizard buttons and the text in the static controls.</span></span> <span data-ttu-id="a6af8-180">As páginas de introdução normalmente têm um botão **Avançar** e **voltar** , com apenas o botão **Avançar** habilitado.</span><span class="sxs-lookup"><span data-stu-id="a6af8-180">Introduction pages normally have a **Next** and a **Back** button, with only the **Next** button enabled.</span></span> <span data-ttu-id="a6af8-181">As páginas de conclusão têm o botão **voltar** habilitado e o botão **Avançar** é substituído por um botão **concluir** .</span><span class="sxs-lookup"><span data-stu-id="a6af8-181">Completion pages have the **Back** button enabled, and the **Next** button is replaced by a **Finish** button.</span></span>

> [!Note]  
> <span data-ttu-id="a6af8-182">Nos assistentes do Aero, o botão **voltar** é substituído por um botão de seta na barra de legenda.</span><span class="sxs-lookup"><span data-stu-id="a6af8-182">In Aero Wizards, the **Back** button is replaced by an arrow button in the caption bar.</span></span>

 

<span data-ttu-id="a6af8-183">Você pode modificar o texto no botão **concluir** enviando ao assistente uma mensagem de [**PSM \_ SETFINISHTEXT**](psm-setfinishtext.md) .</span><span class="sxs-lookup"><span data-stu-id="a6af8-183">You can modify the text on the **Finish** button by sending the wizard a [**PSM\_SETFINISHTEXT**](psm-setfinishtext.md) message.</span></span> <span data-ttu-id="a6af8-184">Por padrão, o botão **concluir** não inclui um acelerador de teclado.</span><span class="sxs-lookup"><span data-stu-id="a6af8-184">By default, the **Finish** button does not include a keyboard accelerator.</span></span> <span data-ttu-id="a6af8-185">Para definir um acelerador de teclado, inclua um e comercial na cadeia de texto que você passa para o PSM \_ SETFINISHTEXT.</span><span class="sxs-lookup"><span data-stu-id="a6af8-185">To define a keyboard accelerator, include an ampersand in the text string that you pass to PSM\_SETFINISHTEXT.</span></span> <span data-ttu-id="a6af8-186">Por exemplo, "&concluir" define ' F ' como o acelerador de teclado.</span><span class="sxs-lookup"><span data-stu-id="a6af8-186">For instance, "&Finish" defines 'F' as the keyboard accelerator.</span></span>

<span data-ttu-id="a6af8-187">**Modelos de caixa de diálogo de página interior**</span><span class="sxs-lookup"><span data-stu-id="a6af8-187">**Interior Page Dialog Box Templates**</span></span>

<span data-ttu-id="a6af8-188">As páginas interiores têm uma aparência um pouco diferente das páginas exteriores.</span><span class="sxs-lookup"><span data-stu-id="a6af8-188">Interior pages have a somewhat different appearance than exterior pages.</span></span> <span data-ttu-id="a6af8-189">A ilustração a seguir mostra um exemplo de página interior Wizard97, com um bitmap de cabeçalho de espaço reservado.</span><span class="sxs-lookup"><span data-stu-id="a6af8-189">The following illustration shows a sample Wizard97 interior page, with a placeholder header bitmap.</span></span>

![captura de tela de uma página de assistente com o título e o texto do subtítulo e um gráfico na parte superior, o texto no meio e os botões na parte inferior](images/wiz97interior.png)

<span data-ttu-id="a6af8-191">A área de cabeçalho na parte superior da página é manipulada pela folha de propriedades, portanto, não está incluída no modelo.</span><span class="sxs-lookup"><span data-stu-id="a6af8-191">The header area at the top of the page is handled by the property sheet, so it is not included in the template.</span></span> <span data-ttu-id="a6af8-192">O conteúdo do cabeçalho é especificado na estrutura [**PROPSHEETPAGE**](pss-propsheetpage.md) da página e na estrutura [**PROPSHEETHEADER**](pss-propsheetheader.md) do assistente.</span><span class="sxs-lookup"><span data-stu-id="a6af8-192">The contents of the header are specified in the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure and the wizard's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span> <span data-ttu-id="a6af8-193">Como a página interior precisa se ajustar entre o cabeçalho e os botões, o modelo de caixa de diálogo Wizard97 é 317x143 unidades de diálogo, um pouco menor do que o modelo para páginas exteriores.</span><span class="sxs-lookup"><span data-stu-id="a6af8-193">Because the interior page needs to fit between the header and the buttons, the Wizard97 dialog box template is 317x143 dialog units, somewhat smaller than the template for exterior pages.</span></span>

<span data-ttu-id="a6af8-194">A ilustração a seguir mostra um assistente Aero criado com base no mesmo modelo.</span><span class="sxs-lookup"><span data-stu-id="a6af8-194">The following illustration shows an Aero Wizard that was created from the same template.</span></span>

![captura de tela que difere da anterior, tendo uma área de título na parte superior e apenas os botões Avançar e cancelar na parte inferior](images/wizardaerointerior.png)

### <a name="define-the-wizard-pages"></a><span data-ttu-id="a6af8-196">Definir as páginas do assistente</span><span class="sxs-lookup"><span data-stu-id="a6af8-196">Define the Wizard Pages</span></span>

<span data-ttu-id="a6af8-197">Depois de criar os modelos de caixa de diálogo e os recursos relacionados, como bitmaps e tabelas de cadeia de caracteres, você pode criar as páginas da folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="a6af8-197">After you have created the dialog box templates and related resources such as bitmaps and string tables, you can create the property sheet pages.</span></span> <span data-ttu-id="a6af8-198">O procedimento é semelhante ao das folhas de propriedades padrão.</span><span class="sxs-lookup"><span data-stu-id="a6af8-198">The procedure is similar to that for standard property sheets.</span></span> <span data-ttu-id="a6af8-199">Primeiro, preencha os membros apropriados de uma estrutura [**PROPSHEETPAGE**](pss-propsheetpage.md) .</span><span class="sxs-lookup"><span data-stu-id="a6af8-199">First, fill in the appropriate members of a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span> <span data-ttu-id="a6af8-200">(Alguns membros são específicos para os assistentes.) Em seguida, chame a função [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) para criar o identificador HPROPSHEETPAGE da página.</span><span class="sxs-lookup"><span data-stu-id="a6af8-200">(Some members are specific to wizards.) Then call the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function to create the page's HPROPSHEETPAGE handle.</span></span>

<span data-ttu-id="a6af8-201">Os sinalizadores relacionados ao assistente a seguir podem ser definidos no membro **dwFlags** da estrutura [**PROPSHEETPAGE**](pss-propsheetpage.md) .</span><span class="sxs-lookup"><span data-stu-id="a6af8-201">The following wizard-related flags can be set in the **dwFlags** member of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span>



| <span data-ttu-id="a6af8-202">Sinalizador</span><span class="sxs-lookup"><span data-stu-id="a6af8-202">Flag</span></span>                   | <span data-ttu-id="a6af8-203">Descrição</span><span class="sxs-lookup"><span data-stu-id="a6af8-203">Description</span></span>                                                                                                                         |
|------------------------|-------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="a6af8-204">PSP \_ HIDEHEADER</span><span class="sxs-lookup"><span data-stu-id="a6af8-204">PSP\_HIDEHEADER</span></span>        | <span data-ttu-id="a6af8-205">Defina esse sinalizador para páginas exteriores em Wizard97.</span><span class="sxs-lookup"><span data-stu-id="a6af8-205">Set this flag for exterior pages in Wizard97.</span></span> <span data-ttu-id="a6af8-206">O cabeçalho não é mostrado e uma marca d' água pode ser mostrada.</span><span class="sxs-lookup"><span data-stu-id="a6af8-206">The header is not shown, and a watermark can be shown.</span></span>                                |
| <span data-ttu-id="a6af8-207">PSP \_ USEHEADERTITLE</span><span class="sxs-lookup"><span data-stu-id="a6af8-207">PSP\_USEHEADERTITLE</span></span>    | <span data-ttu-id="a6af8-208">Defina esse sinalizador para páginas interiores para colocar um título na área de cabeçalho em Wizard97 ou na parte superior da área cliente em um assistente Aero.</span><span class="sxs-lookup"><span data-stu-id="a6af8-208">Set this flag for interior pages to put a title in the header area in Wizard97, or at the top of the client area in an Aero Wizard.</span></span> |
| <span data-ttu-id="a6af8-209">PSP \_ USEHEADERSUBTITLE</span><span class="sxs-lookup"><span data-stu-id="a6af8-209">PSP\_USEHEADERSUBTITLE</span></span> | <span data-ttu-id="a6af8-210">Defina esse sinalizador para páginas interiores para colocar um subtítulo na área de cabeçalho em Wizard97.</span><span class="sxs-lookup"><span data-stu-id="a6af8-210">Set this flag for interior pages to put a subtitle in the header area in Wizard97.</span></span>                                                  |



 

<span data-ttu-id="a6af8-211">Se você tiver definido PSP \_ USEHEADERTITLE ou PSP \_ USEHEADERSUBTITLE, atribua o título e o texto do subtítulo aos membros **pszHeaderTitle** e **pszHeaderSubtitle** , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="a6af8-211">If you have set PSP\_USEHEADERTITLE or PSP\_USEHEADERSUBTITLE, assign the title and subtitle text to the **pszHeaderTitle** and **pszHeaderSubtitle** members, respectively.</span></span> <span data-ttu-id="a6af8-212">Ao atribuir cadeias de texto a membros das estruturas [**PROPSHEETPAGE**](pss-propsheetpage.md) e [**PROPSHEETHEADER**](pss-propsheetheader.md) , você pode atribuir um ponteiro de cadeia de caracteres ou usar a macro **MAKEINTRESOURCE** para atribuir um valor de um recurso de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="a6af8-212">When you assign text strings to members of the [**PROPSHEETPAGE**](pss-propsheetpage.md) and [**PROPSHEETHEADER**](pss-propsheetheader.md) structures, you can either assign a string pointer or use the **MAKEINTRESOURCE** macro to assign a value from a string resource.</span></span> <span data-ttu-id="a6af8-213">O recurso de cadeia de caracteres é carregado a partir do módulo especificado no membro **HINSTANCE** da estrutura **PROPSHEETHEADER** do assistente.</span><span class="sxs-lookup"><span data-stu-id="a6af8-213">The string resource is loaded from the module specified in the **hInstance** member of the wizard's **PROPSHEETHEADER** structure.</span></span>

<span data-ttu-id="a6af8-214">Quando você chama [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) para criar uma página, atribua o resultado a um elemento de uma matriz de identificadores HPROPSHEETPAGE.</span><span class="sxs-lookup"><span data-stu-id="a6af8-214">When you call [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) to create a page, assign the result to an element of an array of HPROPSHEETPAGE handles.</span></span> <span data-ttu-id="a6af8-215">Essa matriz é usada ao criar a folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="a6af8-215">This array is used when creating the property sheet.</span></span> <span data-ttu-id="a6af8-216">O índice de matriz do identificador de uma página determina a ordem padrão na qual ela é exibida.</span><span class="sxs-lookup"><span data-stu-id="a6af8-216">The array index of a page's handle determines the default order in which it is displayed.</span></span> <span data-ttu-id="a6af8-217">Depois de criar o identificador HPROPSHEETPAGE de uma página, você pode reutilizar a mesma estrutura [**PROPSHEETPAGE**](pss-propsheetpage.md) para criar a próxima página atribuindo novos valores aos membros relevantes.</span><span class="sxs-lookup"><span data-stu-id="a6af8-217">After you have created a page's HPROPSHEETPAGE handle, you can reuse the same [**PROPSHEETPAGE**](pss-propsheetpage.md) structure to create the next page by assigning new values to the relevant members.</span></span>

<span data-ttu-id="a6af8-218">Uma maneira alternativa de criar páginas é usar estruturas [**PROPSHEETPAGE**](pss-propsheetpage.md) separadas para cada página e criar uma matriz de estruturas.</span><span class="sxs-lookup"><span data-stu-id="a6af8-218">An alternative way to create pages is to use separate [**PROPSHEETPAGE**](pss-propsheetpage.md) structures for each page, and create an array of structures.</span></span> <span data-ttu-id="a6af8-219">Essa matriz é usada em vez de uma matriz de identificadores HPROPSHEETPAGE ao criar a folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="a6af8-219">This array is used instead of an array of HPROPSHEETPAGE handles when creating the property sheet.</span></span> <span data-ttu-id="a6af8-220">O uso de estruturas **PROPSHEETPAGE** separadas elimina a necessidade de chamar [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) , mas usa mais memória.</span><span class="sxs-lookup"><span data-stu-id="a6af8-220">Using separate **PROPSHEETPAGE** structures eliminates the need to call [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) but uses more memory.</span></span> <span data-ttu-id="a6af8-221">Caso contrário, não há nenhuma diferença significativa entre as duas abordagens.</span><span class="sxs-lookup"><span data-stu-id="a6af8-221">Otherwise, there is no significant difference between the two approaches.</span></span>

<span data-ttu-id="a6af8-222">O exemplo a seguir define uma página Wizard97 interior atribuindo valores a uma estrutura [**PROPSHEETPAGE**](pss-propsheetpage.md) .</span><span class="sxs-lookup"><span data-stu-id="a6af8-222">The following example defines an interior Wizard97 page by assigning values to a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span> <span data-ttu-id="a6af8-223">Neste exemplo, o título da página, o subtítulo e o modelo da caixa de diálogo são todos identificados por suas IDs de recurso.</span><span class="sxs-lookup"><span data-stu-id="a6af8-223">In this example, the page's title, subtitle, and dialog box template are all identified by their resource IDs.</span></span> <span data-ttu-id="a6af8-224">Em seguida, a função [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) é chamada para criar o identificador HPROPSHEETPAGE da página.</span><span class="sxs-lookup"><span data-stu-id="a6af8-224">The [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function is then called to create the page's HPROPSHEETPAGE handle.</span></span> <span data-ttu-id="a6af8-225">Como será a segunda página a ser exibida, o identificador é atribuído à matriz de identificadores, *ahpsp*, com um índice de 1.</span><span class="sxs-lookup"><span data-stu-id="a6af8-225">Because it will be the second page to appear, the handle is assigned to the array of handles, *ahpsp*, with an index of 1.</span></span>


```C++
// g_hInstance is the global HINSTANCE of the application.
// IntPage1DlgProc is the dialog procedure for this page.
// ahpsp is an array of HPROPSHEETPAGE handles.

PROPSHEETPAGE psp = { sizeof(psp) };

psp.hInstance         = g_hInstance;
psp.dwFlags           = PSP_USEHEADERTITLE | PSP_USEHEADERSUBTITLE;
psp.lParam            = (LPARAM) &wizdata;
psp.pszHeaderTitle    = MAKEINTRESOURCE(IDS_TITLE1);
psp.pszHeaderSubTitle = MAKEINTRESOURCE(IDS_SUBTITLE1);
psp.pszTemplate       = MAKEINTRESOURCE(IDD_INTERIOR1);
psp.pfnDlgProc        = IntPage1DlgProc;

ahpsp[1] = CreatePropertySheetPage(&psp);
```



### <a name="custom-page-data"></a><span data-ttu-id="a6af8-226">Dados da página personalizada</span><span class="sxs-lookup"><span data-stu-id="a6af8-226">Custom Page Data</span></span>

<span data-ttu-id="a6af8-227">Ao criar uma página, você pode atribuir dados personalizados a ela usando o membro **lParam** da estrutura [**PROPSHEETPAGE**](pss-propsheetpage.md) , normalmente atribuindo-lhe um ponteiro a uma estrutura definida pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="a6af8-227">When you create a page, you can assign custom data to it by using the **lParam** member of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure, typically by assigning it a pointer to a user-defined structure.</span></span>

<span data-ttu-id="a6af8-228">Quando a página é selecionada pela primeira vez, o procedimento da caixa de diálogo recebe uma mensagem do [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="a6af8-228">When the page is first selected, its dialog box procedure receives a [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="a6af8-229">O valor de *lParam* da mensagem aponta para uma cópia da estrutura [**PROPSHEETPAGE**](pss-propsheetpage.md) da página, na qual você pode recuperar os dados personalizados.</span><span class="sxs-lookup"><span data-stu-id="a6af8-229">The message's *lParam* value points to a copy of of the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure, from which you can retrieve the custom data.</span></span> <span data-ttu-id="a6af8-230">Você pode armazenar esses dados para uso em mensagens subsequentes usando [**SetWindowLongPtr**](/windows/desktop/api/winuser/nf-winuser-setwindowlongptra) com GWL \_ UserData como o parâmetro de índice.</span><span class="sxs-lookup"><span data-stu-id="a6af8-230">You can then store this data for use in subsequent messages by using [**SetWindowLongPtr**](/windows/desktop/api/winuser/nf-winuser-setwindowlongptra) with GWL\_USERDATA as the index parameter.</span></span> <span data-ttu-id="a6af8-231">Várias páginas podem ter um ponteiro para os mesmos dados e qualquer alteração nos dados feitas por uma página está disponível para as outras páginas em seus procedimentos de caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="a6af8-231">Multiple pages can have a pointer to the same data, and any change to the data made by one page is available to the other pages in their dialog procedures.</span></span>

### <a name="define-the-wizard-property-sheet"></a><span data-ttu-id="a6af8-232">Definir a folha de propriedades do assistente</span><span class="sxs-lookup"><span data-stu-id="a6af8-232">Define the Wizard Property Sheet</span></span>

<span data-ttu-id="a6af8-233">Assim como nas folhas de propriedades comuns, você define a folha de propriedades do assistente preenchendo os membros de uma estrutura [**PROPSHEETHEADER**](pss-propsheetheader.md) .</span><span class="sxs-lookup"><span data-stu-id="a6af8-233">As with ordinary property sheets, you define the wizard's property sheet by filling in members of a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span> <span data-ttu-id="a6af8-234">Essa estrutura permite que você especifique as páginas que compõem o assistente e a ordem padrão na qual eles são exibidos, juntamente com vários parâmetros relacionados.</span><span class="sxs-lookup"><span data-stu-id="a6af8-234">This structure allows you to specify the pages that make up the wizard and the default order in which they are displayed, along with several related parameters.</span></span> <span data-ttu-id="a6af8-235">Em seguida, inicie o assistente chamando a função [**folha**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) .</span><span class="sxs-lookup"><span data-stu-id="a6af8-235">You then launch the wizard by calling the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function.</span></span>

<span data-ttu-id="a6af8-236">No estilo Wizard97, o membro **pszCaption** da estrutura [**PROPSHEETHEADER**](pss-propsheetheader.md) é ignorado.</span><span class="sxs-lookup"><span data-stu-id="a6af8-236">In the Wizard97 style, the **pszCaption** member of the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure is ignored.</span></span> <span data-ttu-id="a6af8-237">Em vez disso, o assistente exibe a legenda especificada no modelo da caixa de diálogo da página atual.</span><span class="sxs-lookup"><span data-stu-id="a6af8-237">Instead, the wizard displays the caption that is specified in the current page's dialog box template.</span></span> <span data-ttu-id="a6af8-238">Se o modelo não tem uma legenda, a legenda da página anterior é exibida.</span><span class="sxs-lookup"><span data-stu-id="a6af8-238">If the template lacks a caption, the caption from the previous page is displayed.</span></span> <span data-ttu-id="a6af8-239">Portanto, para exibir a mesma legenda em todas as páginas, especifique a legenda no modelo para a página introdutória.</span><span class="sxs-lookup"><span data-stu-id="a6af8-239">Thus, to display the same caption on all pages, specify the caption in the template for the introductory page.</span></span>

<span data-ttu-id="a6af8-240">No estilo de assistente Aero, a legenda da caixa de diálogo é extraída de **pszCaption**.</span><span class="sxs-lookup"><span data-stu-id="a6af8-240">In the Aero Wizard style, the dialog box caption is taken from **pszCaption**.</span></span>

<span data-ttu-id="a6af8-241">Se você tiver criado uma matriz de identificadores HPROPSHEETPAGE para suas páginas, atribua a matriz ao membro **phpage** .</span><span class="sxs-lookup"><span data-stu-id="a6af8-241">If you have created an array of HPROPSHEETPAGE handles for your pages, assign the array to the **phpage** member.</span></span> <span data-ttu-id="a6af8-242">Se, em vez disso, você tiver criado uma matriz de estruturas [**PROPSHEETPAGE**](pss-propsheetpage.md) , atribua a matriz ao membro **PPSP** e defina o \_ sinalizador PSH PROPSHEETPAGE no membro **dwFlags** .</span><span class="sxs-lookup"><span data-stu-id="a6af8-242">If you have instead created an array of [**PROPSHEETPAGE**](pss-propsheetpage.md) structures, assign the array to the **ppsp** member and set the PSH\_PROPSHEETPAGE flag in the **dwFlags** member.</span></span>

<span data-ttu-id="a6af8-243">O exemplo a seguir atribui valores a *PSH*, uma estrutura [**PROPSHEETHEADER**](pss-propsheetheader.md) e chama a função [**folha**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) para iniciar o assistente.</span><span class="sxs-lookup"><span data-stu-id="a6af8-243">The following example assigns values to *psh*, a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure, and calls the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function to launch the wizard.</span></span> <span data-ttu-id="a6af8-244">O assistente de estilo Wizard97 tem gráficos de marca d' água e de cabeçalho, especificados por suas IDs de recurso.</span><span class="sxs-lookup"><span data-stu-id="a6af8-244">The Wizard97-style wizard has both watermark and header graphics, specified by their resource IDs.</span></span> <span data-ttu-id="a6af8-245">A matriz *ahpsp* contém todos os identificadores de HPROPSHEETPAGE e define a ordem padrão na qual eles são exibidos.</span><span class="sxs-lookup"><span data-stu-id="a6af8-245">The *ahpsp* array contains all the HPROPSHEETPAGE handles and defines the default order in which they are displayed.</span></span>


```C++
// g_hInstance is the global HINSTANCE of the application.
// ahpsp is an array of HPROPSHEETPAGE handles.

PROPSHEETHEADER psh = { sizeof(psh) };

psh.hInstance      = g_hInstance;
psh.hwndParent     = NULL;
psh.phpage         = ahpsp;
psh.dwFlags        = PSH_WIZARD97 | PSH_WATERMARK | PSH_HEADER;
psh.pszbmWatermark = MAKEINTRESOURCE(IDB_WATERMARK);
psh.pszbmHeader    = MAKEINTRESOURCE(IDB_BANNER);
psh.nStartPage     = 0;
psh.nPages         = 4;

PropertySheet(&psh);
```



### <a name="the-dialog-box-procedure"></a><span data-ttu-id="a6af8-246">O procedimento da caixa de diálogo</span><span class="sxs-lookup"><span data-stu-id="a6af8-246">The Dialog Box Procedure</span></span>

<span data-ttu-id="a6af8-247">Cada página do assistente precisa de um procedimento de caixa de diálogo para processar mensagens do Windows, especialmente notificações de seus controles e do assistente.</span><span class="sxs-lookup"><span data-stu-id="a6af8-247">Each page of the wizard needs a dialog box procedure to process Windows messages, particularly notifications from its controls and the wizard.</span></span> <span data-ttu-id="a6af8-248">As três mensagens que quase todos os assistentes devem ser capazes de lidar são o [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog), o [**WM \_ Destroy**](/windows/desktop/winmsg/wm-destroy)e o [**WM \_ Notify**](wm-notify.md).</span><span class="sxs-lookup"><span data-stu-id="a6af8-248">The three messages that almost all wizards must be able to handle are [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog), [**WM\_DESTROY**](/windows/desktop/winmsg/wm-destroy), and [**WM\_NOTIFY**](wm-notify.md).</span></span>

<span data-ttu-id="a6af8-249">A mensagem de [**\_ notificação do WM**](wm-notify.md) é recebida antes de a página ser exibida e quando um dos botões do assistente é clicado.</span><span class="sxs-lookup"><span data-stu-id="a6af8-249">The [**WM\_NOTIFY**](wm-notify.md) message is received before the page is displayed and when any of the wizard's buttons are clicked.</span></span> <span data-ttu-id="a6af8-250">O parâmetro *lParam* da mensagem é um ponteiro para uma estrutura de cabeçalho [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) .</span><span class="sxs-lookup"><span data-stu-id="a6af8-250">The *lParam* parameter of the message is a pointer to a [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) header structure.</span></span> <span data-ttu-id="a6af8-251">A ID da notificação está contida no membro do **código** da estrutura.</span><span class="sxs-lookup"><span data-stu-id="a6af8-251">The notification's ID is contained in the structure's **code** member.</span></span> <span data-ttu-id="a6af8-252">As quatro notificações que a maioria dos assistentes precisam manipular são as seguintes.</span><span class="sxs-lookup"><span data-stu-id="a6af8-252">The four notifications that most wizards need to handle are the following.</span></span>



| <span data-ttu-id="a6af8-253">Código</span><span class="sxs-lookup"><span data-stu-id="a6af8-253">Code</span></span>                                | <span data-ttu-id="a6af8-254">Descrição</span><span class="sxs-lookup"><span data-stu-id="a6af8-254">Description</span></span>                                 |
|-------------------------------------|---------------------------------------------|
| [<span data-ttu-id="a6af8-255">PSN \_ SETactive</span><span class="sxs-lookup"><span data-stu-id="a6af8-255">PSN\_SETACTIVE</span></span>](psn-setactive.md) | <span data-ttu-id="a6af8-256">Enviado antes da exibição da página.</span><span class="sxs-lookup"><span data-stu-id="a6af8-256">Sent before the page is displayed.</span></span>          |
| [<span data-ttu-id="a6af8-257">PSN \_ WIZBACK</span><span class="sxs-lookup"><span data-stu-id="a6af8-257">PSN\_WIZBACK</span></span>](psn-wizback.md)     | <span data-ttu-id="a6af8-258">Enviado quando o botão **voltar** é clicado.</span><span class="sxs-lookup"><span data-stu-id="a6af8-258">Sent when the **Back** button is clicked.</span></span>   |
| [<span data-ttu-id="a6af8-259">PSN \_ WIZNEXT</span><span class="sxs-lookup"><span data-stu-id="a6af8-259">PSN\_WIZNEXT</span></span>](psn-wiznext.md)     | <span data-ttu-id="a6af8-260">Enviado quando o botão **Avançar** é clicado.</span><span class="sxs-lookup"><span data-stu-id="a6af8-260">Sent when the **Next** button is clicked.</span></span>   |
| [<span data-ttu-id="a6af8-261">PSN \_ WIZFINISH</span><span class="sxs-lookup"><span data-stu-id="a6af8-261">PSN\_WIZFINISH</span></span>](psn-wizfinish.md) | <span data-ttu-id="a6af8-262">Enviado quando o botão **concluir** é clicado.</span><span class="sxs-lookup"><span data-stu-id="a6af8-262">Sent when the **Finish** button is clicked.</span></span> |



 

### <a name="handle-wm_initdialog-and-wm_destroy"></a><span data-ttu-id="a6af8-263">Manipule o WM \_ INITDIALOG e o WM \_ Destroy</span><span class="sxs-lookup"><span data-stu-id="a6af8-263">Handle WM\_INITDIALOG and WM\_DESTROY</span></span>

<span data-ttu-id="a6af8-264">Quando uma página está prestes a ser exibida pela primeira vez, seu procedimento de caixa de diálogo recebe uma mensagem do [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="a6af8-264">When a page is about to be displayed for the first time, its dialog box procedure receives a [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="a6af8-265">A manipulação dessa mensagem permite que o assistente faça todas as tarefas de inicialização necessárias, como armazenar dados personalizados ou definir fontes.</span><span class="sxs-lookup"><span data-stu-id="a6af8-265">Handling this message allows the wizard to do any needed initialization tasks, such as storing custom data or setting fonts.</span></span>

<span data-ttu-id="a6af8-266">Quando a folha de Propriedades for destruída, você receberá uma mensagem do [**WM \_ Destroy**](/windows/desktop/winmsg/wm-destroy) .</span><span class="sxs-lookup"><span data-stu-id="a6af8-266">When the property sheet is destroyed, you receive a [**WM\_DESTROY**](/windows/desktop/winmsg/wm-destroy) message.</span></span> <span data-ttu-id="a6af8-267">O assistente é destruído automaticamente pelo sistema, mas a manipulação dessa mensagem permite que você faça qualquer limpeza necessária.</span><span class="sxs-lookup"><span data-stu-id="a6af8-267">The wizard is automatically destroyed by the system, but handling this message allows you to do any needed cleanup.</span></span>

### <a name="handle-psn_setactive"></a><span data-ttu-id="a6af8-268">Manipular PSN \_ SETactive</span><span class="sxs-lookup"><span data-stu-id="a6af8-268">Handle PSN\_SETACTIVE</span></span>

<span data-ttu-id="a6af8-269">O código de notificação [PSN \_ SetActive](psn-setactive.md) é enviado cada vez que uma página está prestes a ficar visível.</span><span class="sxs-lookup"><span data-stu-id="a6af8-269">The [PSN\_SETACTIVE](psn-setactive.md) notification code is sent each time a page is about to be made visible.</span></span> <span data-ttu-id="a6af8-270">Na primeira vez que uma página é visitada, PSN \_ SetActive segue a mensagem [**\_ INITDIALOG do WM**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="a6af8-270">The first time a page is visited, PSN\_SETACTIVE follows the [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="a6af8-271">Se a página for subsequentemente revisitada, ela receberá apenas uma \_ notificação SETACTIVE PSN.</span><span class="sxs-lookup"><span data-stu-id="a6af8-271">If the page is subsequently revisited, it receives only a PSN\_SETACTIVE notification.</span></span> <span data-ttu-id="a6af8-272">Normalmente, essa notificação é tratada para inicializar dados da página e habilitar os botões apropriados.</span><span class="sxs-lookup"><span data-stu-id="a6af8-272">This notification is usually handled to initialize data for the page and enable the appropriate buttons.</span></span>

<span data-ttu-id="a6af8-273">Por padrão, o assistente exibe os botões **voltar**, **Avançar** e **Cancelar** , com todos os botões habilitados.</span><span class="sxs-lookup"><span data-stu-id="a6af8-273">By default, the wizard displays **Back**, **Next**, and **Cancel** buttons, with all buttons enabled.</span></span> <span data-ttu-id="a6af8-274">Para desabilitar um botão ou exibir **concluir** em vez de **Avançar**, você deve enviar uma mensagem de [**PSM \_ SETWIZBUTTONS**](psm-setwizbuttons.md) .</span><span class="sxs-lookup"><span data-stu-id="a6af8-274">To disable a button or display **Finish** instead of **Next**, you must send a [**PSM\_SETWIZBUTTONS**](psm-setwizbuttons.md) message.</span></span> <span data-ttu-id="a6af8-275">Depois que essa mensagem tiver sido enviada, o estado dos botões será preservado até ser modificado por outra mensagem de **PSM \_ SETWIZBUTTONS** , mesmo que uma nova página seja selecionada.</span><span class="sxs-lookup"><span data-stu-id="a6af8-275">After this message has been sent, the state of the buttons is preserved until it is modified by another **PSM\_SETWIZBUTTONS** message, even if a new page is selected.</span></span> <span data-ttu-id="a6af8-276">Normalmente, todos os manipuladores [ \_ SetActive PSN](psn-setactive.md) enviam essa mensagem para garantir que cada página tenha o estado de botão correto.</span><span class="sxs-lookup"><span data-stu-id="a6af8-276">Typically, all [PSN\_SETACTIVE](psn-setactive.md) handlers send this message to ensure that each page has the correct button state.</span></span>

<span data-ttu-id="a6af8-277">Você pode alterar o estado do botão com esta mensagem a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="a6af8-277">You can change the button state with this message at any time.</span></span> <span data-ttu-id="a6af8-278">Por exemplo, talvez você queira que o botão **Avançar** esteja desabilitado inicialmente.</span><span class="sxs-lookup"><span data-stu-id="a6af8-278">For example, you may want the **Next** button to be initially disabled.</span></span> <span data-ttu-id="a6af8-279">Depois que um usuário inserir todas as informações necessárias, você poderá enviar outra mensagem de [**PSM \_ SETWIZBUTTONS**](psm-setwizbuttons.md) para habilitar o botão **Avançar** e permitir que o usuário prossiga para a próxima página.</span><span class="sxs-lookup"><span data-stu-id="a6af8-279">After a user has entered all the necessary information, you can send another [**PSM\_SETWIZBUTTONS**](psm-setwizbuttons.md) message to enable the **Next** button and let the user proceed to the next page.</span></span>

<span data-ttu-id="a6af8-280">O fragmento de código a seguir usa a macro [**PropSheet \_ SetWizButtons**](/windows/desktop/api/Prsht/nf-prsht-propsheet_setwizbuttons) para habilitar os botões **voltar** e **Avançar** em uma página interior antes de ser exibido.</span><span class="sxs-lookup"><span data-stu-id="a6af8-280">The following code fragment uses the [**PropSheet\_SetWizButtons**](/windows/desktop/api/Prsht/nf-prsht-propsheet_setwizbuttons) macro to enable the **Back** and **Next** buttons on an interior page before it is displayed.</span></span>


```C++
case WM_NOTIFY :
    {
        LPNMHDR pnmh = (LPNMHDR)lParam;
        
        switch(pnmh->code)
        {
        
        ...
        
        case PSN_SETACTIVE :
        
            ...
            
            // This is an interior page.
            PropSheet_SetWizButtons(hwnd, PSWIZB_NEXT | PSWIZB_BACK);
            
            ...
        }
    ...
    
    }
```



### <a name="handle-psn_wiznext-psnwizback-and-psn_wizfinish"></a><span data-ttu-id="a6af8-281">Tratar PSN \_ WIZNEXT, PSNWIZBACK e PSN \_ WIZFINISH</span><span class="sxs-lookup"><span data-stu-id="a6af8-281">Handle PSN\_WIZNEXT, PSNWIZBACK, and PSN\_WIZFINISH</span></span>

<span data-ttu-id="a6af8-282">Quando um botão **Avançar** ou **voltar** for clicado, você receberá um código de notificação [PSN \_ WIZNEXT](psn-wiznext.md) ou [PSN \_ WIZBACK](psn-wizback.md) .</span><span class="sxs-lookup"><span data-stu-id="a6af8-282">When a **Next** or **Back** button is clicked, you receive a [PSN\_WIZNEXT](psn-wiznext.md) or [PSN\_WIZBACK](psn-wizback.md) notification code.</span></span> <span data-ttu-id="a6af8-283">Por padrão, o assistente vai automaticamente para a página seguinte ou anterior na ordem que é definida quando a folha de propriedades é criada.</span><span class="sxs-lookup"><span data-stu-id="a6af8-283">By default, the wizard automatically goes to either the next or previous page in the order that is defined when the property sheet is created.</span></span> <span data-ttu-id="a6af8-284">Um motivo comum para lidar com essas notificações é impedir que o usuário alterne as páginas ou substitua a ordem de página padrão.</span><span class="sxs-lookup"><span data-stu-id="a6af8-284">A common reason to handle these notifications is to prevent the user from switching pages, or to override the default page order.</span></span>

<span data-ttu-id="a6af8-285">Para impedir que o usuário alterne as páginas, manipule a notificação do botão, chame a função [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) com o \_ valor DWL MSGRESULT definido como – 1 e retorne **true**.</span><span class="sxs-lookup"><span data-stu-id="a6af8-285">To prevent the user from switching pages, handle the button notification, call the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function with the DWL\_MSGRESULT value set to –1, and return **TRUE**.</span></span> <span data-ttu-id="a6af8-286">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="a6af8-286">For example:</span></span>


```C++
case PSN_WIZNEXT :

        ...
        
        // Do not go to the next page yet.
        SetWindowLong(hwnd, DWL_MSGRESULT, -1);
        
        return TRUE;
        
        ...
```



<span data-ttu-id="a6af8-287">Para substituir a ordem padrão e ir para uma página específica, chame [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) com o \_ valor DWL MSGRESULT definido como a ID de recurso da caixa de diálogo da página e retorne **true**.</span><span class="sxs-lookup"><span data-stu-id="a6af8-287">To override the standard order and go to a particular page, call [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) with the DWL\_MSGRESULT value set to the page's dialog box resource ID, and return **TRUE**.</span></span> <span data-ttu-id="a6af8-288">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="a6af8-288">For example:</span></span>


```C++
case PSN_WIZNEXT :

        ...
        
        // Go straight to the completion page.
        SetWindowLong(hwnd, DWL_MSGRESULT, IDD_FINISH);
        
        return TRUE;
        
        ...
```



<span data-ttu-id="a6af8-289">Quando o botão **concluir** ou **Cancelar** for clicado, você receberá um código de notificação de [ \_ redefinição](psn-reset.md) de [PSN \_ WIZFINISH](psn-wizfinish.md) ou PSN, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="a6af8-289">When the **Finish** or **Cancel** button is clicked, you receive a [PSN\_WIZFINISH](psn-wizfinish.md) or [PSN\_RESET](psn-reset.md) notification code, respectively.</span></span> <span data-ttu-id="a6af8-290">Quando um desses botões é clicado, o assistente é automaticamente destruído pelo sistema.</span><span class="sxs-lookup"><span data-stu-id="a6af8-290">When either of these buttons is clicked, the wizard is automatically destroyed by the system.</span></span> <span data-ttu-id="a6af8-291">No entanto, você pode lidar com essas notificações se precisar executar tarefas de limpeza antes que o assistente seja destruído.</span><span class="sxs-lookup"><span data-stu-id="a6af8-291">However, you can handle these notifications if you need to perform cleanup tasks before the wizard is destroyed.</span></span> <span data-ttu-id="a6af8-292">Para impedir que o assistente seja destruído quando você recebe uma \_ notificação PSN WIZFINISH, chame [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) com o \_ valor DWL MSGRESULT definido como **true** e retorne **true**.</span><span class="sxs-lookup"><span data-stu-id="a6af8-292">To prevent the wizard from being destroyed when you receive a PSN\_WIZFINISH notification, call [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) with the DWL\_MSGRESULT value set to **TRUE**, and return **TRUE**.</span></span> <span data-ttu-id="a6af8-293">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="a6af8-293">For example:</span></span>


```C++
case PSN_WIZFINISH :

        ...
        
        // Not finished yet.
        SetWindowLong(hwnd, DWL_MSGRESULT, TRUE);
        
        return TRUE;
        
        ...
```



### <a name="backward-compatible-wizards"></a><span data-ttu-id="a6af8-294">Assistentes compatíveis com versões anteriores</span><span class="sxs-lookup"><span data-stu-id="a6af8-294">Backward Compatible Wizards</span></span>

<span data-ttu-id="a6af8-295">A seção anterior pressupõe que você está implementando um assistente para um sistema com a [versão 5](common-control-versions.md) ou posterior dos controles comuns.</span><span class="sxs-lookup"><span data-stu-id="a6af8-295">The preceding section assumes that you are implementing a wizard for a system with [version 5](common-control-versions.md) or later of the common controls.</span></span>

<span data-ttu-id="a6af8-296">Se você estiver escrevendo um assistente para sistemas com versões anteriores dos controles comuns, muitos dos recursos discutidos na seção anterior não estarão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="a6af8-296">If you are writing a wizard for systems with earlier versions of the common controls, many of the features discussed in the preceding section will not be available.</span></span> <span data-ttu-id="a6af8-297">Um número de membros das estruturas [**PROPSHEETHEADER**](pss-propsheetheader.md) e [**PROPSHEETPAGE**](pss-propsheetpage.md) usadas pelo estilo Wizard97 tem suporte apenas em controles comuns versão 5 e posteriores.</span><span class="sxs-lookup"><span data-stu-id="a6af8-297">A number of the members of the [**PROPSHEETHEADER**](pss-propsheetheader.md) and [**PROPSHEETPAGE**](pss-propsheetpage.md) structures that are used by the Wizard97 style are supported only by common controls version 5 and later.</span></span> <span data-ttu-id="a6af8-298">No entanto, ainda é possível implementar um assistente *compatível com versões anteriores* com uma aparência semelhante à do estilo Wizard97.</span><span class="sxs-lookup"><span data-stu-id="a6af8-298">However, it is still possible to implement a *backward compatible* wizard with an appearance similar to that of the Wizard97 style.</span></span> <span data-ttu-id="a6af8-299">Para fazer isso, você deve implementar explicitamente o seguinte:</span><span class="sxs-lookup"><span data-stu-id="a6af8-299">To do so, you must explicitly implement the following:</span></span>

-   <span data-ttu-id="a6af8-300">Adicione o gráfico de marca d' água ao modelo da caixa de diálogo para suas páginas de introdução e conclusão.</span><span class="sxs-lookup"><span data-stu-id="a6af8-300">Add the watermark graphic to the dialog box template for your introduction and completion pages.</span></span>
-   <span data-ttu-id="a6af8-301">Faça com que todos os seus modelos tenham o mesmo tamanho.</span><span class="sxs-lookup"><span data-stu-id="a6af8-301">Make all your templates the same size.</span></span> <span data-ttu-id="a6af8-302">Não há nenhuma área de cabeçalho definida pelo sistema separada para páginas interiores.</span><span class="sxs-lookup"><span data-stu-id="a6af8-302">There is no separate system-defined header area for interior pages.</span></span>
-   <span data-ttu-id="a6af8-303">Crie a área de cabeçalho da página interior explicitamente em seus modelos.</span><span class="sxs-lookup"><span data-stu-id="a6af8-303">Create the interior page's header area explicitly on your templates.</span></span>
-   <span data-ttu-id="a6af8-304">Não use um gráfico de cabeçalho porque ele pode entrar em conflito com o título ou subtítulo se o assistente alterar o tamanho.</span><span class="sxs-lookup"><span data-stu-id="a6af8-304">Do not use a header graphic because it may conflict with the title or subtitle if the wizard changes size.</span></span>

<span data-ttu-id="a6af8-305">Para obter mais informações sobre os assistentes compatíveis com versões anteriores, consulte [Assistente compatível com versões anteriores 97](/previous-versions//ms737910(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="a6af8-305">For further discussion of backward-compatible wizards, see [Backward Compatible Wizard 97](/previous-versions//ms737910(v=vs.85)).</span></span>

## <a name="remarks"></a><span data-ttu-id="a6af8-306">Comentários</span><span class="sxs-lookup"><span data-stu-id="a6af8-306">Remarks</span></span>

<span data-ttu-id="a6af8-307">Para obter uma discussão completa sobre problemas de design para Wizard97, consulte a [especificação Wizard97](/previous-versions//ms738248(v=vs.85)), em outro lugar na SDK do Windows.</span><span class="sxs-lookup"><span data-stu-id="a6af8-307">For a complete discussion of design issues for Wizard97, see the [Wizard97 Specification](/previous-versions//ms738248(v=vs.85)), elsewhere in the Windows SDK.</span></span> <span data-ttu-id="a6af8-308">Este documento tem diretrizes para coisas como as dimensões das caixas de diálogo, dimensões e cores de bitmap e o posicionamento de controles.</span><span class="sxs-lookup"><span data-stu-id="a6af8-308">This document has guidelines for such things as the dimensions for the dialog boxes, bitmap dimensions and colors, and the placement of controls.</span></span>

## <a name="related-topics"></a><span data-ttu-id="a6af8-309">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="a6af8-309">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a6af8-310">Usando folhas de propriedades</span><span class="sxs-lookup"><span data-stu-id="a6af8-310">Using Property Sheets</span></span>](using-property-sheets.md)
</dt> <dt>

<span data-ttu-id="a6af8-311">[Demonstração de controles comuns do Windows (CppWindowsCommonControls)](https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/OneCodeTeam/Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/%5BC++%5D-Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/C++/CppWindowsCommonControls)</span><span class="sxs-lookup"><span data-stu-id="a6af8-311">[Windows common controls demo (CppWindowsCommonControls)](https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/OneCodeTeam/Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/%5BC++%5D-Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/C++/CppWindowsCommonControls)</span></span>
</dt> </dl>

 

 