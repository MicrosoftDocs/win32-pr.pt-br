---
title: Como criar uma barra de menus do Internet Explorer-Style
description: À primeira vista, a barra de menus no Microsoft Internet Explorer 5 e posterior é semelhante a um menu padrão. No entanto, ele é bastante diferente quando você começa a usá-lo.
ms.assetid: e0fe25f2-3d49-4c5a-a3f9-2f468f2cfef2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b262bc55407d263c97d4bd7e3938a9794d3a58f5
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/21/2020
ms.locfileid: "103824007"
---
# <a name="how-to-create-an-internet-explorer-style-menu-bar"></a><span data-ttu-id="28dcb-104">Como criar uma barra de menus do Internet Explorer-Style</span><span class="sxs-lookup"><span data-stu-id="28dcb-104">How to Create an Internet Explorer-Style Menu Bar</span></span>

<span data-ttu-id="28dcb-105">À primeira vista, a barra de menus no Microsoft Internet Explorer 5 e posterior é semelhante a um menu padrão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-105">At first glance, the menu bar in Microsoft Internet Explorer 5 and later looks similar to a standard menu.</span></span> <span data-ttu-id="28dcb-106">No entanto, ele é bastante diferente quando você começa a usá-lo.</span><span class="sxs-lookup"><span data-stu-id="28dcb-106">However, it looks quite different when you begin using it.</span></span>

<span data-ttu-id="28dcb-107">A captura de tela a seguir mostra a barra de menus do Windows Internet Explorer com o menu ferramentas selecionado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-107">The following screen shot shows the Windows Internet Explorer menu bar with the Tools menu selected.</span></span>

![captura de tela que mostra a barra de menus do Windows Internet Explorer, com o menu ferramentas selecionado](images/howto8.jpg)

<span data-ttu-id="28dcb-109">A barra de menus é, na verdade, um controle da barra de ferramentas que se parece com um menu padrão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-109">The menu bar is actually a toolbar control that looks like a standard menu.</span></span> <span data-ttu-id="28dcb-110">Em vez de itens de menu de nível superior, uma barra de menus tem uma série de botões somente texto que exibem um menu suspenso quando clicados.</span><span class="sxs-lookup"><span data-stu-id="28dcb-110">Instead of top-level menu items, a menu bar has a series of text-only buttons that display a drop-down menu when clicked.</span></span> <span data-ttu-id="28dcb-111">No entanto, como um tipo especializado de barra de ferramentas, uma barra de menus tem alguns recursos que os menus padrão não têm:</span><span class="sxs-lookup"><span data-stu-id="28dcb-111">However, as a specialized type of toolbar, a menu bar has some capabilities that standard menus lack:</span></span>

-   <span data-ttu-id="28dcb-112">Ele pode ser personalizado usando técnicas de barra de ferramentas padrão, permitindo que o usuário mova, exclua ou adicione itens.</span><span class="sxs-lookup"><span data-stu-id="28dcb-112">It can be customized using standard toolbar techniques, allowing the user to move, delete, or add items.</span></span>
-   <span data-ttu-id="28dcb-113">Ele pode ter acompanhamento dinâmico, para que os usuários saibam quando estão em um item de nível superior sem precisar clicar em primeiro.</span><span class="sxs-lookup"><span data-stu-id="28dcb-113">It can have hot-tracking, so that users will know when they are over a top-level item without having to click it first.</span></span>

<span data-ttu-id="28dcb-114">Uma barra de menus pode ser incorporada a um controle rebar, dando a ele os seguintes recursos:</span><span class="sxs-lookup"><span data-stu-id="28dcb-114">A menu bar can be incorporated into a rebar control, giving it the following features:</span></span>

-   <span data-ttu-id="28dcb-115">Ele pode ter uma garra, que permite ao usuário mover ou redimensionar a banda.</span><span class="sxs-lookup"><span data-stu-id="28dcb-115">It can have a gripper, which allows the user to move or resize the band.</span></span>
-   <span data-ttu-id="28dcb-116">Ele pode compartilhar uma faixa no controle rebar com outras faixas, como a barra de ferramentas padrão na ilustração anterior.</span><span class="sxs-lookup"><span data-stu-id="28dcb-116">It can share a strip in the rebar control with other bands, such as the standard toolbar in the preceding illustration.</span></span>
-   <span data-ttu-id="28dcb-117">Ele pode exibir uma divisa quando ela é coberta por uma faixa adjacente, dando ao usuário acesso aos itens ocultos.</span><span class="sxs-lookup"><span data-stu-id="28dcb-117">It can display a chevron when it is covered by an adjacent band, giving the user access to the hidden items.</span></span>
-   <span data-ttu-id="28dcb-118">Ele pode ter um bitmap em segundo plano definido pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="28dcb-118">It can have an application-defined background bitmap.</span></span>

<span data-ttu-id="28dcb-119">Este tópico discute como implementar uma barra de menus.</span><span class="sxs-lookup"><span data-stu-id="28dcb-119">This topic discusses how to implement a menu bar.</span></span> <span data-ttu-id="28dcb-120">Como uma barra de menus é uma implementação especializada de um controle da barra de ferramentas, o foco estará em tópicos específicos das barras de menus.</span><span class="sxs-lookup"><span data-stu-id="28dcb-120">Since a menu bar is a specialized implementation of a toolbar control, the focus will be on topics that are specific to menu bars.</span></span> <span data-ttu-id="28dcb-121">Para obter uma discussão sobre como incorporar uma barra de ferramentas em um controle rebar, consulte [como criar uma barra de ferramentas Explorer-Style da Internet](cc-faq-ietoolbar.md) e [sobre controles Rebar](rebar-controls.md).</span><span class="sxs-lookup"><span data-stu-id="28dcb-121">For a discussion of how to incorporate a toolbar into a rebar control, see [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md) and [About Rebar Controls](rebar-controls.md).</span></span>

-   [<span data-ttu-id="28dcb-122">Criando uma barra de ferramentas em uma barra de menus</span><span class="sxs-lookup"><span data-stu-id="28dcb-122">Making a Toolbar into a Menu Bar</span></span>](#making-a-toolbar-into-a-menu-bar)
-   [<span data-ttu-id="28dcb-123">Manipulando a navegação com o menu Hot-Tracking desabilitado</span><span class="sxs-lookup"><span data-stu-id="28dcb-123">Handling Navigation with Menu Hot-Tracking Disabled</span></span>](#handling-navigation-with-menu-hot-tracking-disabled)
    -   [<span data-ttu-id="28dcb-124">Navegação do mouse</span><span class="sxs-lookup"><span data-stu-id="28dcb-124">Mouse Navigation</span></span>](#mouse-navigation)
    -   [<span data-ttu-id="28dcb-125">Navegação por teclado</span><span class="sxs-lookup"><span data-stu-id="28dcb-125">Keyboard Navigation</span></span>](#keyboard-navigation)
    -   [<span data-ttu-id="28dcb-126">Navegação mista</span><span class="sxs-lookup"><span data-stu-id="28dcb-126">Mixed Navigation</span></span>](#mixed-navigation)
-   [<span data-ttu-id="28dcb-127">Manipulando a navegação com o menu Hot-Tracking habilitado</span><span class="sxs-lookup"><span data-stu-id="28dcb-127">Handling Navigation with Menu Hot-Tracking Enabled</span></span>](#handling-navigation-with-menu-hot-tracking-enabled)
    -   [<span data-ttu-id="28dcb-128">Processamento de mensagens para rastreamento dinâmico de menu</span><span class="sxs-lookup"><span data-stu-id="28dcb-128">Message Processing for Menu Hot-Tracking</span></span>](#message-processing-for-menu-hot-tracking)
    -   [<span data-ttu-id="28dcb-129">Navegação do mouse</span><span class="sxs-lookup"><span data-stu-id="28dcb-129">Mouse Navigation</span></span>](#mouse-navigation)
    -   [<span data-ttu-id="28dcb-130">Navegação por teclado</span><span class="sxs-lookup"><span data-stu-id="28dcb-130">Keyboard Navigation</span></span>](#keyboard-navigation)

## <a name="making-a-toolbar-into-a-menu-bar"></a><span data-ttu-id="28dcb-131">Criando uma barra de ferramentas em uma barra de menus</span><span class="sxs-lookup"><span data-stu-id="28dcb-131">Making a Toolbar into a Menu Bar</span></span>

<span data-ttu-id="28dcb-132">Para criar uma barra de ferramentas em uma barra de menus:</span><span class="sxs-lookup"><span data-stu-id="28dcb-132">To make a toolbar into a menu bar:</span></span>

-   <span data-ttu-id="28dcb-133">Crie uma barra de ferramentas simples incluindo [**TBSTYLE \_ plana**](toolbar-control-and-button-styles.md) com os outros sinalizadores de estilo de janela.</span><span class="sxs-lookup"><span data-stu-id="28dcb-133">Create a flat toolbar by including [**TBSTYLE\_FLAT**](toolbar-control-and-button-styles.md) with the other window style flags.</span></span> <span data-ttu-id="28dcb-134">O **estilo \_ simples TBSTYLE** também permite o controle de acesso.</span><span class="sxs-lookup"><span data-stu-id="28dcb-134">The **TBSTYLE\_FLAT** style also enables hot-tracking.</span></span> <span data-ttu-id="28dcb-135">Com esse estilo, a barra de menus é muito parecida com um menu padrão até que o usuário ative um botão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-135">With this style, the menu bar looks much like a standard menu until the user activates a button.</span></span> <span data-ttu-id="28dcb-136">Em seguida, o botão aparece para destacar a barra de ferramentas e solte quando clicado, exatamente como um botão padrão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-136">Then, the button appears to stand out from the toolbar and depress when it is clicked, just like a standard button.</span></span> <span data-ttu-id="28dcb-137">Como o acompanhamento de quente está habilitado, tudo o que é necessário para ativar um botão é para o cursor passar sobre ele.</span><span class="sxs-lookup"><span data-stu-id="28dcb-137">Because hot-tracking is enabled, all that is needed to activate a button is for the cursor to hover over it.</span></span> <span data-ttu-id="28dcb-138">Se o cursor mudar para outro botão, ele será ativado e o botão antigo é desativado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-138">If the cursor moves to another button, it will be activated and the old button deactivated.</span></span>
-   <span data-ttu-id="28dcb-139">Crie botões de estilo de lista incluindo [**TBSTYLE \_ lista**](toolbar-control-and-button-styles.md) com os outros sinalizadores de estilo de janela.</span><span class="sxs-lookup"><span data-stu-id="28dcb-139">Create list-style buttons by including [**TBSTYLE\_LIST**](toolbar-control-and-button-styles.md) with the other window style flags.</span></span> <span data-ttu-id="28dcb-140">Esse estilo cria um botão mais fino que é mais parecido com um item de menu de nível superior padrão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-140">This style creates a thinner button that looks more like a standard top-level menu item.</span></span>
-   <span data-ttu-id="28dcb-141">Torne os botões somente texto definindo o membro **iBitmap** da estrutura [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) do botão como I \_ IMAGENONE e o membro **isastring** para o texto do botão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-141">Make the buttons text-only by setting the **iBitmap** member of the button's [**TBBUTTON**](/windows/desktop/api/Commctrl/ns-commctrl-tbbutton) structure to I\_IMAGENONE and the **iString** member to the button text.</span></span>
-   <span data-ttu-id="28dcb-142">Dê a cada botão o estilo [**\_ suspenso BTNS**](toolbar-control-and-button-styles.md) .</span><span class="sxs-lookup"><span data-stu-id="28dcb-142">Give each button the [**BTNS\_DROPDOWN**](toolbar-control-and-button-styles.md) style.</span></span> <span data-ttu-id="28dcb-143">Quando o botão é clicado, o controle Toolbar envia ao seu aplicativo uma notificação de [ \_ lista suspensa tbn](tbn-dropdown.md) para solicitar que ele exiba o menu do botão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-143">When the button is clicked, the toolbar control sends your application a [TBN\_DROPDOWN](tbn-dropdown.md) notification to prompt it to display the button's menu.</span></span>
-   <span data-ttu-id="28dcb-144">Incorpore a barra de menus em uma faixa Rebar.</span><span class="sxs-lookup"><span data-stu-id="28dcb-144">Incorporate the menu bar into a rebar band.</span></span> <span data-ttu-id="28dcb-145">Habilite as duas garras e divisas, conforme discutido em [como criar uma barra de ferramentas de Explorer-Style da Internet](cc-faq-ietoolbar.md).</span><span class="sxs-lookup"><span data-stu-id="28dcb-145">Enable both grippers and chevrons, as discussed in [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md).</span></span>
-   <span data-ttu-id="28dcb-146">Implemente um manipulador de [ \_ lista suspensa tbn](tbn-dropdown.md) para exibir o *menu* suspenso do botão quando ele for clicado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-146">Implement a [TBN\_DROPDOWN](tbn-dropdown.md) handler to display the button's *drop-down menu* when it is clicked.</span></span> <span data-ttu-id="28dcb-147">O menu suspenso é um tipo de menu pop-up.</span><span class="sxs-lookup"><span data-stu-id="28dcb-147">The drop-down menu is a type of pop-up menu.</span></span> <span data-ttu-id="28dcb-148">Ele é criado usando a função [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) , com seu canto superior esquerdo alinhado ao canto inferior esquerdo do botão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-148">It is created by using the [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) function, with its upper-left corner aligned with the lower-left corner of the button.</span></span>
-   <span data-ttu-id="28dcb-149">Implemente a navegação do teclado para que a barra de menus esteja totalmente acessível sem um mouse.</span><span class="sxs-lookup"><span data-stu-id="28dcb-149">Implement keyboard navigation, so that the menu bar is fully accessible without a mouse.</span></span>
-   <span data-ttu-id="28dcb-150">Implemente o controle de acesso de menus.</span><span class="sxs-lookup"><span data-stu-id="28dcb-150">Implement menu hot-tracking.</span></span> <span data-ttu-id="28dcb-151">Com menus padrão, uma vez que o menu de um item de menu de nível superior foi exibido, mover o cursor sobre outro item de nível superior exibe automaticamente seu menu e recolhe o menu do item anterior.</span><span class="sxs-lookup"><span data-stu-id="28dcb-151">With standard menus, once a top level menu item's menu has been displayed, moving the cursor over another top-level item automatically displays its menu and collapses the menu of the previous item.</span></span> <span data-ttu-id="28dcb-152">O controle da barra de ferramentas irá acompanhar o cursor e alterar a imagem do botão, mas exibirá automaticamente o novo menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-152">The toolbar control will hot-track the cursor and change the button image, but it does automatically display the new menu.</span></span> <span data-ttu-id="28dcb-153">Seu aplicativo deve fazer isso explicitamente.</span><span class="sxs-lookup"><span data-stu-id="28dcb-153">Your application must do so explicitly.</span></span>

<span data-ttu-id="28dcb-154">A maioria desses itens é simples de implementar e é discutida em outro lugar.</span><span class="sxs-lookup"><span data-stu-id="28dcb-154">Most of these items are straightforward to implement and are discussed elsewhere.</span></span> <span data-ttu-id="28dcb-155">Veja [como criar uma barra de ferramentas Explorer-Style da Internet](cc-faq-ietoolbar.md), [sobre controles da barra de ferramentas](toolbar-controls-overview.md)ou [sobre controles Rebar](rebar-controls.md) para obter uma discussão geral sobre como usar barras de ferramentas e controles Rebar.</span><span class="sxs-lookup"><span data-stu-id="28dcb-155">See [How to Create an Internet Explorer-Style Toolbar](cc-faq-ietoolbar.md), [About Toolbar Controls](toolbar-controls-overview.md), or [About Rebar Controls](rebar-controls.md) for a general discussion of how to use toolbars and rebar controls.</span></span> <span data-ttu-id="28dcb-156">Consulte os [menus](/windows/desktop/menurc/menus) para obter uma discussão de como lidar com menus pop-up.</span><span class="sxs-lookup"><span data-stu-id="28dcb-156">See [Menus](/windows/desktop/menurc/menus) for a discussion of how to handle pop-up menus.</span></span> <span data-ttu-id="28dcb-157">Os dois últimos itens, navegação por teclado e controle de acesso de menus, são discutidos no restante deste tópico.</span><span class="sxs-lookup"><span data-stu-id="28dcb-157">The final two items, keyboard navigation and menu hot-tracking, are discussed in the remainder of this topic.</span></span>

## <a name="handling-navigation-with-menu-hot-tracking-disabled"></a><span data-ttu-id="28dcb-158">Manipulando a navegação com o menu Hot-Tracking desabilitado</span><span class="sxs-lookup"><span data-stu-id="28dcb-158">Handling Navigation with Menu Hot-Tracking Disabled</span></span>

<span data-ttu-id="28dcb-159">Os usuários podem optar por navegar na barra de menus com o mouse, o teclado ou uma mistura de ambos.</span><span class="sxs-lookup"><span data-stu-id="28dcb-159">Users can choose to navigate the menu bar with the mouse, the keyboard, or a mixture of both.</span></span> <span data-ttu-id="28dcb-160">Para implementar a navegação de barra de menus, seu aplicativo deve manipular notificações da barra de ferramentas e monitorar o mouse e o teclado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-160">To implement menu bar navigation, your application must handle toolbar notifications and monitor the mouse and keyboard.</span></span> <span data-ttu-id="28dcb-161">Essa tarefa pode ser dividida em duas partes distintas: com e sem controle de acesso ao menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-161">This task can be broken into two distinct parts: with and without menu hot-tracking.</span></span> <span data-ttu-id="28dcb-162">Esta seção discute como tratar a navegação quando nenhum menu é exibido e o controle de acesso de menus não está habilitado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-162">This section discusses how to handle navigation when no menus are displayed and menu hot-tracking is not enabled.</span></span>

### <a name="mouse-navigation"></a><span data-ttu-id="28dcb-163">Navegação do mouse</span><span class="sxs-lookup"><span data-stu-id="28dcb-163">Mouse Navigation</span></span>

<span data-ttu-id="28dcb-164">Se o controle de acesso ao menu estiver desabilitado, você poderá tratar uma barra de menus como uma barra de ferramentas normal.</span><span class="sxs-lookup"><span data-stu-id="28dcb-164">If menu hot-tracking is disabled, you can treat a menu bar as a normal toolbar.</span></span> <span data-ttu-id="28dcb-165">Se o usuário estiver navegando com um mouse, todo o aplicativo precisará lidar com a [notificação \_ suspensa tbn](tbn-dropdown.md) .</span><span class="sxs-lookup"><span data-stu-id="28dcb-165">If the user is navigating with a mouse, all your application needs to do is handle the [TBN\_DROPDOWN](tbn-dropdown.md) notification.</span></span> <span data-ttu-id="28dcb-166">Quando essa notificação for recebida, exiba o menu suspenso apropriado e habilite o controle de acesso ao menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-166">When this notification is received, display the appropriate drop-down menu, and enable menu hot-tracking.</span></span> <span data-ttu-id="28dcb-167">A partir de então, você está no menu regime de rastreamento de quente discutido na [manipulação de navegação com o menu Hot-Tracking habilitado](#handling-navigation-with-menu-hot-tracking-enabled).</span><span class="sxs-lookup"><span data-stu-id="28dcb-167">From then on, you are in the menu hot-tracking regime discussed in [Handling Navigation with Menu Hot-Tracking Enabled](#handling-navigation-with-menu-hot-tracking-enabled).</span></span>

<span data-ttu-id="28dcb-168">Conforme discutido em [navegação mista](#mixed-navigation), você também precisa manipular a notificação [de \_ HOTITEMCHANGE do tbn](tbn-hotitemchange.md) para controlar o botão ativo.</span><span class="sxs-lookup"><span data-stu-id="28dcb-168">As discussed in [Mixed Navigation](#mixed-navigation), you also need to handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to keep track of the active button.</span></span> <span data-ttu-id="28dcb-169">Essa notificação é irrelevante se o usuário está apenas navegando com o mouse, mas é necessário quando a navegação do mouse e do teclado são misturadas.</span><span class="sxs-lookup"><span data-stu-id="28dcb-169">This notification is irrelevant if the user is only navigating with the mouse, but it is necessary when mouse and keyboard navigation are mixed.</span></span>

### <a name="keyboard-navigation"></a><span data-ttu-id="28dcb-170">Navegação por teclado</span><span class="sxs-lookup"><span data-stu-id="28dcb-170">Keyboard Navigation</span></span>

<span data-ttu-id="28dcb-171">Conforme observado na seção anterior, o usuário pode fazer várias operações de navegação com o teclado quando o controle de acesso ao menu estiver desabilitado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-171">As noted in the previous section, the user can do a number of navigation operations with the keyboard when menu hot-tracking is disabled.</span></span> <span data-ttu-id="28dcb-172">Os controles da barra de ferramentas dão suporte à navegação por teclado apenas se tiverem foco.</span><span class="sxs-lookup"><span data-stu-id="28dcb-172">Toolbar controls support keyboard navigation only if they have focus.</span></span> <span data-ttu-id="28dcb-173">Eles também não manipulam todos os pressionamentos de tecla que são necessários para barras de menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-173">They also do not handle all the key presses that are needed for menu bars.</span></span> <span data-ttu-id="28dcb-174">A solução mais simples para lidar com a navegação de teclado é processar explicitamente os eventos de pressionamento de tecla relevantes.</span><span class="sxs-lookup"><span data-stu-id="28dcb-174">The simplest solution to handling keyboard navigation is to process the relevant key press events explicitly.</span></span>

<span data-ttu-id="28dcb-175">Se o controle de acesso ao menu estiver desabilitado, seu aplicativo deverá lidar com esses eventos de pressionamento de tecla da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="28dcb-175">If menu hot-tracking is disabled, your application must handle these key press events in the following way:</span></span>

-   <span data-ttu-id="28dcb-176">A tecla F10.</span><span class="sxs-lookup"><span data-stu-id="28dcb-176">The F10 key.</span></span> <span data-ttu-id="28dcb-177">Ative o primeiro botão com [**TB de \_ SETHOTITEM**](tb-sethotitem.md).</span><span class="sxs-lookup"><span data-stu-id="28dcb-177">Activate the first button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span>
-   <span data-ttu-id="28dcb-178">As teclas seta para a esquerda e seta para a direita.</span><span class="sxs-lookup"><span data-stu-id="28dcb-178">The LEFT ARROW and RIGHT ARROW keys.</span></span> <span data-ttu-id="28dcb-179">Ative o botão adjacente com [**TB \_ SETHOTITEM**](tb-sethotitem.md).</span><span class="sxs-lookup"><span data-stu-id="28dcb-179">Activate the adjacent button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="28dcb-180">Se o usuário tentar navegar para fora da extremidade da barra de menus, ative o primeiro botão na extremidade oposta.</span><span class="sxs-lookup"><span data-stu-id="28dcb-180">If the user attempts to navigate off either end of the menu bar, activate the first button at the opposite end.</span></span>
-   <span data-ttu-id="28dcb-181">A tecla ESCAPE.</span><span class="sxs-lookup"><span data-stu-id="28dcb-181">The ESCAPE key.</span></span> <span data-ttu-id="28dcb-182">Desative o botão ativo com [**TB de \_ SETHOTITEM**](tb-sethotitem.md).</span><span class="sxs-lookup"><span data-stu-id="28dcb-182">Deactivate the active button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="28dcb-183">A barra de menus deve ser retornada ao estado que tinha antes de ativar o primeiro botão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-183">The menu bar should be returned to the state it had prior to activating the first button.</span></span>
-   <span data-ttu-id="28dcb-184">Uma tecla ALT-*Key* Accelerator.</span><span class="sxs-lookup"><span data-stu-id="28dcb-184">An ALT-*Key* accelerator key.</span></span> <span data-ttu-id="28dcb-185">Use a mensagem [**TB \_ MAPACCELERATOR**](tb-mapaccelerator.md) para determinar a qual botão o caractere de *chave* corresponde.</span><span class="sxs-lookup"><span data-stu-id="28dcb-185">Use the [**TB\_MAPACCELERATOR**](tb-mapaccelerator.md) message to determine which button the *Key* character corresponds to.</span></span> <span data-ttu-id="28dcb-186">Exiba o menu suspenso do botão e habilite o controle de acesso ao menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-186">Display the button's drop-down menu and enable menu hot-tracking.</span></span>
-   <span data-ttu-id="28dcb-187">A tecla SETA PARA BAIXO.</span><span class="sxs-lookup"><span data-stu-id="28dcb-187">The DOWN ARROW key.</span></span> <span data-ttu-id="28dcb-188">Se um botão estiver ativo, mas nenhum menu tiver sido exibido, exiba o menu do botão e habilite o controle de acesso ao menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-188">If a button is active but no menu has been displayed, display the button's menu and enable menu hot-tracking.</span></span>
-   <span data-ttu-id="28dcb-189">A tecla ENTER.</span><span class="sxs-lookup"><span data-stu-id="28dcb-189">The ENTER key.</span></span> <span data-ttu-id="28dcb-190">Desative o botão ativo com [**TB de \_ SETHOTITEM**](tb-sethotitem.md).</span><span class="sxs-lookup"><span data-stu-id="28dcb-190">Deactivate the active button with [**TB\_SETHOTITEM**](tb-sethotitem.md).</span></span> <span data-ttu-id="28dcb-191">A barra de menus deve ser retornada ao estado que tinha antes de ativar o primeiro botão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-191">The menu bar should be returned to the state it had prior to activating the first button.</span></span>

### <a name="mixed-navigation"></a><span data-ttu-id="28dcb-192">Navegação mista</span><span class="sxs-lookup"><span data-stu-id="28dcb-192">Mixed Navigation</span></span>

<span data-ttu-id="28dcb-193">Os manipuladores de navegação do teclado descritos na seção anterior basicamente fazem duas tarefas: manter o controle do botão ativo e exibir o menu apropriado quando um botão é selecionado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-193">The keyboard navigation handlers outlined in the preceding section basically do two tasks: keep track of the active button and display the appropriate menu when a button is selected.</span></span> <span data-ttu-id="28dcb-194">Esses manipuladores são suficientes, desde que o usuário navegue apenas com o teclado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-194">These handlers are sufficient as long as the user navigates only with the keyboard.</span></span> <span data-ttu-id="28dcb-195">No entanto, os usuários geralmente misturam a navegação por teclado e mouse.</span><span class="sxs-lookup"><span data-stu-id="28dcb-195">However, users often mix keyboard and mouse navigation.</span></span> <span data-ttu-id="28dcb-196">Por exemplo, eles podem ativar o primeiro botão com a tecla F10, usar o mouse para ativar um botão diferente e, em seguida, abrir o menu com a tecla de seta para baixo.</span><span class="sxs-lookup"><span data-stu-id="28dcb-196">For example, they might activate the first button with the F10 key, use the mouse to activate a different button, and then open its menu with the DOWN ARROW key.</span></span> <span data-ttu-id="28dcb-197">Se você estiver monitorando apenas os pressionamentos de tecla para controlar a chave ativa, você exibirá o menu errado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-197">If you are only monitoring key presses to keep track of the active key, you will display the wrong menu.</span></span> <span data-ttu-id="28dcb-198">Você também deve lidar com a notificação [tbn \_ HOTITEMCHANGE](tbn-hotitemchange.md) para manter o controle do botão ativo com precisão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-198">You must also handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to accurately keep track of the active button.</span></span>

## <a name="handling-navigation-with-menu-hot-tracking-enabled"></a><span data-ttu-id="28dcb-199">Manipulando a navegação com o menu Hot-Tracking habilitado</span><span class="sxs-lookup"><span data-stu-id="28dcb-199">Handling Navigation with Menu Hot-Tracking Enabled</span></span>

<span data-ttu-id="28dcb-200">Quando o controle de acesso ao menu estiver habilitado, seu aplicativo deverá alterar a maneira como ele responde à navegação do usuário.</span><span class="sxs-lookup"><span data-stu-id="28dcb-200">When menu hot-tracking is enabled, your application must change the way it responds to user navigation.</span></span> <span data-ttu-id="28dcb-201">Para replicar o comportamento dos menus padrão, você deve implementar os recursos a seguir explicitamente.</span><span class="sxs-lookup"><span data-stu-id="28dcb-201">To replicate the behavior of standard menus, you must implement the following features explicitly.</span></span>

<span data-ttu-id="28dcb-202">Com a navegação do mouse:</span><span class="sxs-lookup"><span data-stu-id="28dcb-202">With mouse navigation:</span></span>

-   <span data-ttu-id="28dcb-203">Se o usuário move o cursor sobre outro botão, esse menu aparece imediatamente e o menu anterior desaparece.</span><span class="sxs-lookup"><span data-stu-id="28dcb-203">If the user moves the cursor over another button, that menu immediately appears and the previous menu disappears.</span></span>
-   <span data-ttu-id="28dcb-204">O rastreamento dinâmico de menu permanece ativo até que o usuário selecione um comando ou clique em um ponto que não seja parte da região do menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-204">Menu hot-tracking stays active until the user selects a command or clicks a point that is not part of the menu region.</span></span> <span data-ttu-id="28dcb-205">Qualquer ação desativa o controle de acesso ao menu até que outro botão seja clicado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-205">Either action deactivates menu hot-tracking until another button is clicked.</span></span>
-   <span data-ttu-id="28dcb-206">Se o cursor sair do menu, o menu suspenso atual permanecerá até que o cursor volte para, ou o usuário clicar em um ponto fora, a área coberta pelo menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-206">If the cursor moves off the menu, the current drop-down menu remains until the cursor moves back onto, or the user clicks a point outside, the area covered by the menu.</span></span> <span data-ttu-id="28dcb-207">Se o cursor retornar a um botão diferente daquele que está sendo exibido no momento, o menu antigo será recolhido e o novo menu será exibido.</span><span class="sxs-lookup"><span data-stu-id="28dcb-207">If the cursor returns to a different button than the one currently being displayed, the old menu is collapsed and the new menu is displayed.</span></span>

<span data-ttu-id="28dcb-208">Com navegação por teclado:</span><span class="sxs-lookup"><span data-stu-id="28dcb-208">With keyboard navigation:</span></span>

-   <span data-ttu-id="28dcb-209">A tecla de seta para a direita move o foco para a direita.</span><span class="sxs-lookup"><span data-stu-id="28dcb-209">The RIGHT ARROW key moves the focus to the right.</span></span> <span data-ttu-id="28dcb-210">Se o item tiver um submenu, exiba o submenu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-210">If the item has a submenu, display the submenu.</span></span> <span data-ttu-id="28dcb-211">Se o item não tiver um submenu, recolha o menu e qualquer submenu, ative o botão Avançar com [**TB \_ SETHOTITEM**](tb-sethotitem.md)e exiba o menu do botão adjacente.</span><span class="sxs-lookup"><span data-stu-id="28dcb-211">If the item does not have a submenu, collapse the menu and any submenus, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for the adjacent button.</span></span> <span data-ttu-id="28dcb-212">Se o último botão estiver ativo quando essa mensagem for recebida, exiba o menu do primeiro botão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-212">If the last button is active when this message is received, display the menu for the first button.</span></span>
-   <span data-ttu-id="28dcb-213">A tecla de seta para a esquerda move o foco para a esquerda.</span><span class="sxs-lookup"><span data-stu-id="28dcb-213">The LEFT ARROW key moves the focus to the left.</span></span> <span data-ttu-id="28dcb-214">Se o item for um submenu, recolha-o e mude o foco para seu menu pai.</span><span class="sxs-lookup"><span data-stu-id="28dcb-214">If the item is a submenu, collapse it and shift focus to its parent menu.</span></span> <span data-ttu-id="28dcb-215">Se o item não for um submenu, recolha o menu, ative o botão Avançar com [**TB \_ SETHOTITEM**](tb-sethotitem.md)e exiba o menu desse botão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-215">If the item is not a submenu, collapse the menu, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for that button.</span></span>

<!-- -->

-   <span data-ttu-id="28dcb-216">A tecla ESCAPE faz backup da exibição uma etapa.</span><span class="sxs-lookup"><span data-stu-id="28dcb-216">The ESCAPE key backs the display up one step.</span></span>
    -   <span data-ttu-id="28dcb-217">Se um submenu for exibido, ele será recolhido e o foco mudará para o menu pai.</span><span class="sxs-lookup"><span data-stu-id="28dcb-217">If a submenu is displayed, it is collapsed and focus shifts to the parent menu.</span></span>
    -   <span data-ttu-id="28dcb-218">Se o menu de um botão for exibido, ele será recolhido e o controle de acesso ao menu estará desabilitado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-218">If a button's menu is displayed, it is collapsed and menu hot-tracking is disabled.</span></span> <span data-ttu-id="28dcb-219">O botão do item permanece ativo.</span><span class="sxs-lookup"><span data-stu-id="28dcb-219">The item's button remains active.</span></span>
    -   <span data-ttu-id="28dcb-220">Se nenhum menu for exibido, mas um botão estiver ativo, o botão será desativado e o controle de acesso ao menu estará desabilitado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-220">If no menus are displayed but a button is active, the button is deactivated and menu hot-tracking is disabled.</span></span>
-   <span data-ttu-id="28dcb-221">As teclas de seta para cima e seta para baixo são usadas apenas para navegar em um menu específico.</span><span class="sxs-lookup"><span data-stu-id="28dcb-221">The UP ARROW and DOWN ARROW keys are used only to navigate within a particular menu.</span></span>
-   <span data-ttu-id="28dcb-222">A tecla ENTER inicia o comando associado a um item de menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-222">The ENTER key launches the command associated with a menu item.</span></span> <span data-ttu-id="28dcb-223">Se o item de menu tiver um submenu, a tecla ENTER o exibirá.</span><span class="sxs-lookup"><span data-stu-id="28dcb-223">If the menu item has a submenu, the ENTER key displays it.</span></span>

<span data-ttu-id="28dcb-224">Assim como acontece com o caso desabilitado de acompanhamento dinâmico de menus, seu aplicativo deve ser capaz de manipular o mouse, o teclado e a navegação mista.</span><span class="sxs-lookup"><span data-stu-id="28dcb-224">As with the menu hot-tracking disabled case, your application must be able to handle mouse, keyboard, and mixed navigation.</span></span> <span data-ttu-id="28dcb-225">No entanto, o fato de que um menu é exibido significa que as mensagens terão que ser tratadas de forma um pouco diferente.</span><span class="sxs-lookup"><span data-stu-id="28dcb-225">However, the fact that a menu is displayed means that messaging will have to be handled somewhat differently.</span></span>

### <a name="message-processing-for-menu-hot-tracking"></a><span data-ttu-id="28dcb-226">Processamento de mensagens para o menu Hot-Tracking</span><span class="sxs-lookup"><span data-stu-id="28dcb-226">Message Processing for Menu Hot-Tracking</span></span>

<span data-ttu-id="28dcb-227">O controle de acesso de menus requer que um menu seja exibido em todos os momentos, além do breve intervalo necessário para alternar para um novo menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-227">Menu hot-tracking requires that a menu be displayed at all times, apart from the brief interval required to switch to a new menu.</span></span> <span data-ttu-id="28dcb-228">No entanto, o menu suspenso exibido por [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) é modal.</span><span class="sxs-lookup"><span data-stu-id="28dcb-228">However, the drop-down menu that is displayed by [**TrackPopupMenu**](/windows/desktop/api/winuser/nf-winuser-trackpopupmenu) is modal.</span></span> <span data-ttu-id="28dcb-229">Seu aplicativo continuará a receber algumas mensagens diretamente, incluindo [**o \_ comando do WM**](/windows/desktop/menurc/wm-command), [tbn \_ HOTITEMCHANGE](tbn-hotitemchange.md)e mensagens normais relacionadas ao menu, como o [**WM \_ MENUSELECT**](/windows/desktop/menurc/wm-menuselect).</span><span class="sxs-lookup"><span data-stu-id="28dcb-229">Your application will continue to receive some messages directly, including [**WM\_COMMAND**](/windows/desktop/menurc/wm-command), [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md), and normal menu-related messages such as [**WM\_MENUSELECT**](/windows/desktop/menurc/wm-menuselect).</span></span> <span data-ttu-id="28dcb-230">No entanto, ele não receberá mensagens de teclado ou mouse de baixo nível diretamente.</span><span class="sxs-lookup"><span data-stu-id="28dcb-230">However, it will not receive low-level keyboard or mouse messages directly.</span></span> <span data-ttu-id="28dcb-231">Para lidar com mensagens como o [**WM \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove), você deve definir um gancho de mensagem para interceptar mensagens que são direcionadas para o menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-231">To handle messages such as [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove), you must set a message hook to intercept messages that are directed to the menu.</span></span>

<span data-ttu-id="28dcb-232">Quando um menu suspenso for exibido, defina o gancho da mensagem chamando a função [**SetWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) com o parâmetro *IDHOOK* definido como qu \_ MSGFILTER.</span><span class="sxs-lookup"><span data-stu-id="28dcb-232">When a drop-down menu is displayed, set the message hook by calling the [**SetWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) function with the *idHook* parameter set to WH\_MSGFILTER.</span></span> <span data-ttu-id="28dcb-233">Todas as mensagens destinadas ao menu serão passadas para o seu [procedimento de gancho](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="28dcb-233">All messages intended for the menu will be passed to your [hook procedure](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85)).</span></span> <span data-ttu-id="28dcb-234">Por exemplo, o fragmento de código a seguir define um gancho de mensagem que irá interceptar mensagens que vão para um menu suspenso.</span><span class="sxs-lookup"><span data-stu-id="28dcb-234">For example, the following code fragment sets a message hook that will trap messages that are going to a drop-down menu.</span></span> <span data-ttu-id="28dcb-235">`MsgHook` é o nome do procedimento de gancho e `hhookMsg` é o identificador para o procedimento.</span><span class="sxs-lookup"><span data-stu-id="28dcb-235">`MsgHook` is the name of the hook procedure, and `hhookMsg` is the handle to the procedure.</span></span>


```
hhookMsg = SetWindowsHookEx(WH_MSGFILTER, MsgHook, HINST_THISDLL, 0);
```



<span data-ttu-id="28dcb-236">As mensagens de menu são identificadas definindo o parâmetro *nCode* do procedimento de gancho para o \_ menu MSGF.</span><span class="sxs-lookup"><span data-stu-id="28dcb-236">Menu messages are identified by setting the hook procedure's *nCode* parameter to MSGF\_MENU.</span></span> <span data-ttu-id="28dcb-237">O parâmetro *lParam* apontará para uma estrutura [**msg**](/windows/win32/api/winuser/ns-winuser-msg) com a mensagem.</span><span class="sxs-lookup"><span data-stu-id="28dcb-237">The *lParam* parameter will point to a [**MSG**](/windows/win32/api/winuser/ns-winuser-msg) structure with the message.</span></span> <span data-ttu-id="28dcb-238">Os detalhes de quais mensagens precisam ser tratadas e como são discutidos no restante deste tópico.</span><span class="sxs-lookup"><span data-stu-id="28dcb-238">The details of which messages need to be handled, and how, are discussed in the remainder of this topic.</span></span>

<span data-ttu-id="28dcb-239">Seu aplicativo deve passar todas as mensagens para o próximo gancho de mensagem chamando a função [**CallNextHookEx**](/windows/desktop/api/winuser/nf-winuser-callnexthookex) .</span><span class="sxs-lookup"><span data-stu-id="28dcb-239">Your application must pass all messages on to the next message hook by calling the [**CallNextHookEx**](/windows/desktop/api/winuser/nf-winuser-callnexthookex) function.</span></span> <span data-ttu-id="28dcb-240">Você também deve enviar mensagens do mouse diretamente para o controle da barra de ferramentas, convertendo quaisquer coordenadas de ponto no espaço de coordenadas do cliente da barra de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="28dcb-240">You must also send mouse messages directly to the toolbar control, making sure to convert any point coordinates to the toolbar client coordinate space.</span></span> <span data-ttu-id="28dcb-241">O envio de mensagens diretamente garante que o controle Toolbar receba as mensagens de mouse apropriadas.</span><span class="sxs-lookup"><span data-stu-id="28dcb-241">Sending the messages directly ensures that the toolbar control receives the appropriate mouse messages.</span></span> <span data-ttu-id="28dcb-242">Por exemplo, a barra de ferramentas precisa receber mensagens do [**WM \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) para rastrear seus botões.</span><span class="sxs-lookup"><span data-stu-id="28dcb-242">For instance, the toolbar needs to receive [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) messages in order to hot-track its buttons.</span></span>

<span data-ttu-id="28dcb-243">Quando um novo botão é ativado, seu aplicativo deve recolher o antigo menu suspenso com uma mensagem do [**WM \_ cancelable**](/windows/desktop/winmsg/wm-cancelmode) e exibir um novo menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-243">When a new button is activated, your application must collapse the old drop-down menu with a [**WM\_CANCELMODE**](/windows/desktop/winmsg/wm-cancelmode) message, and display a new menu.</span></span> <span data-ttu-id="28dcb-244">Ele também deve recolher o menu suspenso quando o foco é tirado da barra de menus com navegação de teclado ou clicando fora da área de menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-244">It must also collapse the drop-down menu when focus is taken from the menu bar with keyboard navigation or by clicking outside the menu area.</span></span> <span data-ttu-id="28dcb-245">Sempre que você recolhe um menu, deve liberar seu gancho de mensagem usando a função [**UnhookWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-unhookwindowshookex) .</span><span class="sxs-lookup"><span data-stu-id="28dcb-245">Whenever you collapse a menu, you should free its message hook by using the [**UnhookWindowsHookEx**](/windows/desktop/api/winuser/nf-winuser-unhookwindowshookex) function.</span></span> <span data-ttu-id="28dcb-246">Se você precisar exibir outro menu suspenso, crie um novo gancho de mensagem.</span><span class="sxs-lookup"><span data-stu-id="28dcb-246">If you need to display another drop-down menu, create a new message hook.</span></span> <span data-ttu-id="28dcb-247">Quando um comando é iniciado, o menu será recolhido automaticamente, mas você deverá liberar explicitamente o gancho da mensagem.</span><span class="sxs-lookup"><span data-stu-id="28dcb-247">When a command is launched, the menu will be collapsed automatically but you must explicitly free the message hook.</span></span>

<span data-ttu-id="28dcb-248">O exemplo de código a seguir libera o gancho de mensagem que foi definido no exemplo anterior.</span><span class="sxs-lookup"><span data-stu-id="28dcb-248">The following code example frees the message hook that was set in the previous example.</span></span>


```
UnhookWindowsHookEx(hhookMsg);
```



### <a name="mouse-navigation"></a><span data-ttu-id="28dcb-249">Navegação do mouse</span><span class="sxs-lookup"><span data-stu-id="28dcb-249">Mouse Navigation</span></span>

<span data-ttu-id="28dcb-250">Quando um controle de barra de ferramentas normal controla os botões de rastreio, ele realça o botão ativo e envia ao aplicativo uma notificação [tbn \_ HOTITEMCHANGE](tbn-hotitemchange.md) sempre que um novo botão é ativado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-250">When a normal toolbar control hot-tracks buttons, it highlights the active button and sends the application a [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification each time a new button is activated.</span></span> <span data-ttu-id="28dcb-251">Seu aplicativo é responsável por exibir o menu suspenso apropriado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-251">Your application is responsible for displaying the appropriate drop-down menu.</span></span> <span data-ttu-id="28dcb-252">Ela deverá:</span><span class="sxs-lookup"><span data-stu-id="28dcb-252">It must:</span></span>

-   <span data-ttu-id="28dcb-253">Manipule a notificação [tbn \_ HOTITEMCHANGE](tbn-hotitemchange.md) para acompanhar o botão ativo.</span><span class="sxs-lookup"><span data-stu-id="28dcb-253">Handle the [TBN\_HOTITEMCHANGE](tbn-hotitemchange.md) notification to keep track of the active button.</span></span> <span data-ttu-id="28dcb-254">Quando o botão ativo for alterado, recolha o menu antigo e crie um novo.</span><span class="sxs-lookup"><span data-stu-id="28dcb-254">When the active button changes, collapse the old menu and create a new one.</span></span>
-   <span data-ttu-id="28dcb-255">Manipule a [notificação \_ suspensa tbn](tbn-dropdown.md) que é enviada quando um botão é clicado.</span><span class="sxs-lookup"><span data-stu-id="28dcb-255">Handle the [TBN\_DROPDOWN](tbn-dropdown.md) notification that is sent when a button is clicked.</span></span> <span data-ttu-id="28dcb-256">Em seguida, ele deve recolher o menu e desabilitar o controle de acesso de menus.</span><span class="sxs-lookup"><span data-stu-id="28dcb-256">It should then collapse the menu and disable menu hot-tracking.</span></span> <span data-ttu-id="28dcb-257">O botão permanece ativo.</span><span class="sxs-lookup"><span data-stu-id="28dcb-257">The button remains active.</span></span>
-   <span data-ttu-id="28dcb-258">Manipule as mensagens do [**WM \_ LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown), do [**WM \_ RBUTTONDOWN**](/windows/desktop/inputdev/wm-rbuttondown)e do [**WM \_ MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) em seu procedimento de gancho de mensagem para controlar a posição do mouse.</span><span class="sxs-lookup"><span data-stu-id="28dcb-258">Handle the [**WM\_LBUTTONDOWN**](/windows/desktop/inputdev/wm-lbuttondown), [**WM\_RBUTTONDOWN**](/windows/desktop/inputdev/wm-rbuttondown), and [**WM\_MOUSEMOVE**](/windows/desktop/inputdev/wm-mousemove) messages in your message hook procedure, to keep track of the mouse position.</span></span> <span data-ttu-id="28dcb-259">Se o mouse for clicado fora da área de menu, recolha o menu suspenso atual, desative o controle de acesso ao menu e retorne a barra de menus para seu estado de preativação.</span><span class="sxs-lookup"><span data-stu-id="28dcb-259">If the mouse is clicked outside the menu area, collapse the current drop-down menu, deactivate menu hot-tracking, and return the menu bar to its preactivation state.</span></span>
-   <span data-ttu-id="28dcb-260">Quando um comando de menu é iniciado, desabilite o controle de acesso ao menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-260">When a menu command is launched, disable menu hot-tracking.</span></span> <span data-ttu-id="28dcb-261">O menu será recolhido automaticamente, mas você deverá liberar explicitamente o gancho da mensagem.</span><span class="sxs-lookup"><span data-stu-id="28dcb-261">The menu will be collapsed automatically but you must explicitly free the message hook.</span></span>

<span data-ttu-id="28dcb-262">Você também deve manipular mensagens relacionadas ao menu, como a mensagem do [**WM \_ INITMENUPOPUP**](/windows/desktop/menurc/wm-initmenupopup) , que é enviada quando um item de menu precisa exibir um submenu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-262">You must also handle menu-related messaging, such as the [**WM\_INITMENUPOPUP**](/windows/desktop/menurc/wm-initmenupopup) message that is sent when a menu item needs to display a submenu.</span></span> <span data-ttu-id="28dcb-263">Para obter uma discussão sobre como lidar com essas mensagens, consulte [menus](/windows/desktop/menurc/menus).</span><span class="sxs-lookup"><span data-stu-id="28dcb-263">For a discussion of how to handle such messages, see [Menus](/windows/desktop/menurc/menus).</span></span>

### <a name="keyboard-navigation"></a><span data-ttu-id="28dcb-264">Navegação por teclado</span><span class="sxs-lookup"><span data-stu-id="28dcb-264">Keyboard Navigation</span></span>

<span data-ttu-id="28dcb-265">Seu aplicativo deve processar mensagens de teclado no procedimento de gancho de mensagem e agir sobre aquelas que afetam o controle de acesso de menus.</span><span class="sxs-lookup"><span data-stu-id="28dcb-265">Your application must process keyboard messages in the message hook procedure and act on those that affect menu hot-tracking.</span></span> <span data-ttu-id="28dcb-266">Os seguintes pressionamentos de tecla devem ser tratados:</span><span class="sxs-lookup"><span data-stu-id="28dcb-266">The following key presses must be handled:</span></span>

-   <span data-ttu-id="28dcb-267">A tecla ESCAPE.</span><span class="sxs-lookup"><span data-stu-id="28dcb-267">The ESCAPE key.</span></span> <span data-ttu-id="28dcb-268">A tecla ESCAPE faz backup da exibição um nível acima.</span><span class="sxs-lookup"><span data-stu-id="28dcb-268">The ESCAPE key backs the display up one level.</span></span> <span data-ttu-id="28dcb-269">Se um submenu estiver sendo exibido, ele deverá ser recolhido.</span><span class="sxs-lookup"><span data-stu-id="28dcb-269">If a submenu is being displayed, it must be collapsed.</span></span> <span data-ttu-id="28dcb-270">Se o menu principal de um botão for exibido, recolha-o e desabilite o controle de acesso ao menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-270">If a button's primary menu is displayed, collapse it and disable menu hot-tracking.</span></span> <span data-ttu-id="28dcb-271">O botão permanece ativo.</span><span class="sxs-lookup"><span data-stu-id="28dcb-271">The button remains active.</span></span>
-   <span data-ttu-id="28dcb-272">A tecla SETA PARA A DIREITA.</span><span class="sxs-lookup"><span data-stu-id="28dcb-272">The RIGHT ARROW key.</span></span> <span data-ttu-id="28dcb-273">Se o item tiver um submenu, exiba-o.</span><span class="sxs-lookup"><span data-stu-id="28dcb-273">If the item has a submenu, display it.</span></span> <span data-ttu-id="28dcb-274">Se o item não tiver um submenu, recolha o menu e qualquer submenu, ative o botão Avançar com [**TB \_ SETHOTITEM**](tb-sethotitem.md)e exiba seu menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-274">If the item does not have a submenu, collapse the menu and any submenus, activate the next button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display its menu.</span></span> <span data-ttu-id="28dcb-275">Se o último botão estava ativo quando essa notificação foi recebida, exiba o menu do primeiro botão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-275">If the last button was active when this notification was received, display the menu for the first button.</span></span>
-   <span data-ttu-id="28dcb-276">A tecla SETA PARA A ESQUERDA.</span><span class="sxs-lookup"><span data-stu-id="28dcb-276">The LEFT ARROW key.</span></span> <span data-ttu-id="28dcb-277">Se o item estiver em um submenu, recolha-o e mude o foco para seu menu pai.</span><span class="sxs-lookup"><span data-stu-id="28dcb-277">If the item is in a submenu, collapse it and shift focus to its parent menu.</span></span> <span data-ttu-id="28dcb-278">Se o item não for um submenu, recolha o menu, ative o botão adjacente com [**TB \_ SETHOTITEM**](tb-sethotitem.md)e exiba seu menu.</span><span class="sxs-lookup"><span data-stu-id="28dcb-278">If the item is not a submenu, collapse the menu, activate the adjacent button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display its menu.</span></span> <span data-ttu-id="28dcb-279">Se o primeiro botão estava ativo quando essa notificação foi recebida, exiba o menu do último botão.</span><span class="sxs-lookup"><span data-stu-id="28dcb-279">If the first button was active when this notification was received, display the menu for the last button.</span></span>
-   <span data-ttu-id="28dcb-280">As teclas seta para cima e seta para baixo.</span><span class="sxs-lookup"><span data-stu-id="28dcb-280">The UP ARROW and DOWN ARROW keys.</span></span> <span data-ttu-id="28dcb-281">Essas chaves são usadas para navegar em um menu, mas não afetam diretamente o controle de acesso de menus.</span><span class="sxs-lookup"><span data-stu-id="28dcb-281">These keys are used to navigate within a menu but do not directly affect menu hot-tracking.</span></span>
-   <span data-ttu-id="28dcb-282">Uma tecla ALT-*Key* Accelerator.</span><span class="sxs-lookup"><span data-stu-id="28dcb-282">An ALT-*Key* accelerator key.</span></span> <span data-ttu-id="28dcb-283">Use a mensagem [**TB \_ MAPACCELERATOR**](tb-mapaccelerator.md) para determinar a qual botão o caractere de *chave* corresponde.</span><span class="sxs-lookup"><span data-stu-id="28dcb-283">Use the [**TB\_MAPACCELERATOR**](tb-mapaccelerator.md) message to determine which button the *Key* character corresponds to.</span></span> <span data-ttu-id="28dcb-284">Se ele corresponder a um botão diferente do atualmente ativo, recolha o menu suspenso atual, ative o botão novo com [**TB \_ SETHOTITEM**](tb-sethotitem.md)e exiba o menu do botão adjacente.</span><span class="sxs-lookup"><span data-stu-id="28dcb-284">If it corresponds to a different button than the currently active one, collapse the current drop-down menu, activate the new button with [**TB\_SETHOTITEM**](tb-sethotitem.md), and display the menu for the adjacent button.</span></span> <span data-ttu-id="28dcb-285">Se o *caractere de chave* corresponder ao botão atualmente exibido, recolha o menu suspenso e desabilite o controle de acesso de menus.</span><span class="sxs-lookup"><span data-stu-id="28dcb-285">If the *Key character* corresponds to the currently displayed button, collapse the drop-down menu and disable menu hot-tracking.</span></span> <span data-ttu-id="28dcb-286">O botão deve permanecer ativo.</span><span class="sxs-lookup"><span data-stu-id="28dcb-286">The button should remain active.</span></span>

 

 