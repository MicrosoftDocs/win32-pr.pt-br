---
title: Sobre folhas de propriedades
description: Uma folha de propriedades é uma janela que permite ao usuário exibir e editar as propriedades de um item.
ms.assetid: 93676a64-7980-48cd-8615-23b14a118e1c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3256959b588e2109740033692c0c528889fc939f
ms.sourcegitcommit: 11f52354f570aacaf1ba2a266b2e507abd73352a
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/19/2021
ms.locfileid: "105748715"
---
# <a name="about-property-sheets"></a><span data-ttu-id="469a8-103">Sobre folhas de propriedades</span><span class="sxs-lookup"><span data-stu-id="469a8-103">About Property Sheets</span></span>

<span data-ttu-id="469a8-104">Uma *folha de propriedades* é uma janela que permite ao usuário exibir e editar as propriedades de um item.</span><span class="sxs-lookup"><span data-stu-id="469a8-104">A *property sheet* is a window that allows the user to view and edit the properties of an item.</span></span> <span data-ttu-id="469a8-105">Por exemplo, um aplicativo de planilha pode usar uma folha de propriedades para permitir que o usuário defina as propriedades de fonte e borda de uma célula ou exiba e defina as propriedades de um dispositivo, como uma unidade de disco, impressora ou mouse.</span><span class="sxs-lookup"><span data-stu-id="469a8-105">For example, a spreadsheet application can use a property sheet to allow the user to set the font and border properties of a cell or to view and set the properties of a device, such as a disk drive, printer, or mouse.</span></span>

<span data-ttu-id="469a8-106">Esta seção aborda os tópicos a seguir.</span><span class="sxs-lookup"><span data-stu-id="469a8-106">This section discusses the following topics.</span></span>

-   [<span data-ttu-id="469a8-107">Noções básicas da folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="469a8-107">Property Sheet Basics</span></span>](#property-sheet-basics)
-   [<span data-ttu-id="469a8-108">Caixas de diálogo da folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="469a8-108">Property Sheet Dialog Boxes</span></span>](#property-sheet-dialog-boxes)
-   [<span data-ttu-id="469a8-109">Páginas</span><span class="sxs-lookup"><span data-stu-id="469a8-109">Pages</span></span>](#pages)
-   [<span data-ttu-id="469a8-110">Criação da folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="469a8-110">Property Sheet Creation</span></span>](#property-sheet-creation)
-   [<span data-ttu-id="469a8-111">Adicionando e removendo páginas</span><span class="sxs-lookup"><span data-stu-id="469a8-111">Adding and Removing Pages</span></span>](#adding-and-removing-pages)
-   [<span data-ttu-id="469a8-112">Título da folha de propriedades e rótulos de página</span><span class="sxs-lookup"><span data-stu-id="469a8-112">Property Sheet Title and Page Labels</span></span>](#property-sheet-title-and-page-labels)
-   [<span data-ttu-id="469a8-113">Ativação de página</span><span class="sxs-lookup"><span data-stu-id="469a8-113">Page Activation</span></span>](#page-activation)
-   [<span data-ttu-id="469a8-114">Botão ajuda</span><span class="sxs-lookup"><span data-stu-id="469a8-114">Help Button</span></span>](#help-button)
    -   [<span data-ttu-id="469a8-115">Removendo o botão de ajuda da barra de legenda</span><span class="sxs-lookup"><span data-stu-id="469a8-115">Removing the Caption Bar Help Button</span></span>](#removing-the-caption-bar-help-button)
-   [<span data-ttu-id="469a8-116">Botões OK, cancelar e aplicar</span><span class="sxs-lookup"><span data-stu-id="469a8-116">OK, Cancel, and Apply Buttons</span></span>](#ok-cancel-and-apply-buttons)
-   [<span data-ttu-id="469a8-117">Assistentes</span><span class="sxs-lookup"><span data-stu-id="469a8-117">Wizards</span></span>](#wizards)

## <a name="property-sheet-basics"></a><span data-ttu-id="469a8-118">Noções básicas da folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="469a8-118">Property Sheet Basics</span></span>

<span data-ttu-id="469a8-119">Para implementar folhas de propriedades em seu aplicativo, inclua o arquivo de cabeçalho Prsht. h em seu projeto.</span><span class="sxs-lookup"><span data-stu-id="469a8-119">To implement property sheets in your application, include the Prsht.h header file in your project.</span></span> <span data-ttu-id="469a8-120">Prsht. h contém todos os identificadores usados com folhas de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-120">Prsht.h contains all of the identifiers used with property sheets.</span></span>

<span data-ttu-id="469a8-121">Uma folha de propriedades contém uma ou mais janelas filho sobrepostas chamadas páginas, cada uma contendo janelas de controle para definir um grupo de propriedades relacionadas.</span><span class="sxs-lookup"><span data-stu-id="469a8-121">A property sheet contains one or more overlapping child windows called pages, each containing control windows for setting a group of related properties.</span></span> <span data-ttu-id="469a8-122">Por exemplo, uma página pode conter os controles para definir as propriedades de fonte de um item, incluindo o estilo de tipo, o tamanho do ponto, a cor e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="469a8-122">For example, a page can contain the controls for setting the font properties of an item, including the type style, point size, color, and so on.</span></span> <span data-ttu-id="469a8-123">Cada página tem uma guia que o usuário pode selecionar para trazer a página para o primeiro plano da folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-123">Each page has a tab that the user can select to bring the page to the foreground of the property sheet.</span></span> <span data-ttu-id="469a8-124">Por exemplo, o aplicativo do painel de controle Date-Time exibe a folha de propriedades a seguir.</span><span class="sxs-lookup"><span data-stu-id="469a8-124">For example, the Date-Time control panel application displays the following property sheet.</span></span>

![captura de tela de uma folha de propriedades com duas guias, uma das quais mostra um relógio e um controle de calendário mensal](images/propsheet1.png)

<span data-ttu-id="469a8-126">Uma folha de propriedades padrão com várias páginas com guias permite que o usuário tenha acesso aleatório a todas as propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-126">A standard property sheet with multiple, tabbed pages allows the user random access to all properties.</span></span> <span data-ttu-id="469a8-127">Se for mais apropriado ter propriedades definidas em sequência, você poderá usar um [Assistente](#wizards).</span><span class="sxs-lookup"><span data-stu-id="469a8-127">If it is more appropriate to have properties set in sequence, you can use a [wizard](#wizards).</span></span>

## <a name="property-sheet-dialog-boxes"></a><span data-ttu-id="469a8-128">Caixas de diálogo da folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="469a8-128">Property Sheet Dialog Boxes</span></span>

<span data-ttu-id="469a8-129">Uma folha de propriedades e as páginas contidas nela são caixas de diálogo na verdade.</span><span class="sxs-lookup"><span data-stu-id="469a8-129">A property sheet and the pages it contains are actually dialog boxes.</span></span> <span data-ttu-id="469a8-130">A folha de propriedades é uma caixa de diálogo definida pelo sistema que gerencia as páginas e fornece um contêiner comum para elas.</span><span class="sxs-lookup"><span data-stu-id="469a8-130">The property sheet is a system-defined dialog box that manages the pages and provides a common container for them.</span></span> <span data-ttu-id="469a8-131">Uma caixa de diálogo de folha de propriedades pode ser modal ou sem janela restrita.</span><span class="sxs-lookup"><span data-stu-id="469a8-131">A property sheet dialog box can be modal or modeless.</span></span> <span data-ttu-id="469a8-132">Ele inclui um quadro, uma barra de título e quatro botões: **OK**, **Cancelar**, **aplicar** e (opcionalmente) **ajuda**.</span><span class="sxs-lookup"><span data-stu-id="469a8-132">It includes a frame, a title bar, and four buttons: **OK**, **Cancel**, **Apply**, and (optionally) **Help**.</span></span> <span data-ttu-id="469a8-133">Os procedimentos da caixa de diálogo para as páginas recebem códigos de notificação na forma de [**\_ notificar**](wm-notify.md) mensagens do WM quando o usuário clica nos botões.</span><span class="sxs-lookup"><span data-stu-id="469a8-133">The dialog box procedures for the pages receive notification codes in the form of [**WM\_NOTIFY**](wm-notify.md) messages when the user clicks the buttons.</span></span>

> [!NOTE]  
> <span data-ttu-id="469a8-134">Nem todas as informações nesta seção se aplicam a assistentes, que têm uma aparência e um comportamento um pouco diferentes.</span><span class="sxs-lookup"><span data-stu-id="469a8-134">Not all the information in this section applies to wizards, which have a somewhat different appearance and behavior.</span></span> <span data-ttu-id="469a8-135">Por exemplo, os assistentes têm um conjunto diferente de botões e nenhuma guia.</span><span class="sxs-lookup"><span data-stu-id="469a8-135">For example, wizards have a different set of buttons and no tabs.</span></span> <span data-ttu-id="469a8-136">Para obter mais informações, consulte [Criando assistentes](wizards.md).</span><span class="sxs-lookup"><span data-stu-id="469a8-136">For more information, see [Creating Wizards](wizards.md).</span></span>

<span data-ttu-id="469a8-137">Cada página em uma folha de propriedades é uma caixa de diálogo sem janela restrita de aplicativo que gerencia as janelas de controle usadas para exibir e editar as propriedades de um item.</span><span class="sxs-lookup"><span data-stu-id="469a8-137">Each page in a property sheet is an application-defined modeless dialog box that manages the control windows used to view and edit the properties of an item.</span></span> <span data-ttu-id="469a8-138">Você fornece o modelo de caixa de diálogo usado para criar cada página, bem como o procedimento de caixa de diálogo que gerencia os controles e define as propriedades do item correspondente.</span><span class="sxs-lookup"><span data-stu-id="469a8-138">You provide the dialog box template used to create each page as well as the dialog box procedure that manages the controls and sets the properties of the corresponding item.</span></span>

<span data-ttu-id="469a8-139">Uma folha de propriedades envia códigos de notificação para o procedimento da caixa de diálogo para uma página quando a página está ganhando ou perdendo a ativação e quando o usuário clica no botão **OK**, **Cancelar**, **aplicar** ou **ajuda** .</span><span class="sxs-lookup"><span data-stu-id="469a8-139">A property sheet sends notification codes to the dialog box procedure for a page when the page is gaining or losing the activation and when the user clicks the **OK**, **Cancel**, **Apply**, or **Help** button.</span></span> <span data-ttu-id="469a8-140">As notificações são enviadas na forma de mensagens [**de \_ notificação do WM**](wm-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="469a8-140">The notifications are sent in the form of [**WM\_NOTIFY**](wm-notify.md) messages.</span></span> <span data-ttu-id="469a8-141">O parâmetro *lParam* é o endereço de uma estrutura [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) que inclui o identificador de janela para a caixa de diálogo folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-141">The *lParam* parameter is the address of an [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) structure that includes the window handle to the property sheet dialog box.</span></span>

<span data-ttu-id="469a8-142">Alguns códigos de notificação exigem uma página para retornar **true** ou **false** em resposta à mensagem [**de \_ notificação do WM**](wm-notify.md) .</span><span class="sxs-lookup"><span data-stu-id="469a8-142">Some notification codes require a page to return either **TRUE** or **FALSE** in response to the [**WM\_NOTIFY**](wm-notify.md) message.</span></span> <span data-ttu-id="469a8-143">Para fazer isso, a página deve usar a função [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) para definir o valor **DWL \_ MSGRESULT** para a caixa de diálogo Page como **true** ou **false**.</span><span class="sxs-lookup"><span data-stu-id="469a8-143">To do this, the page must use the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function to set the **DWL\_MSGRESULT** value for the page dialog box to either **TRUE** or **FALSE**.</span></span>

## <a name="pages"></a><span data-ttu-id="469a8-144">Pages (Páginas)</span><span class="sxs-lookup"><span data-stu-id="469a8-144">Pages</span></span>

<span data-ttu-id="469a8-145">Uma folha de propriedades deve conter pelo menos uma página, mas não pode conter mais do que o valor de **MAXPROPPAGES** , conforme definido nos arquivos de cabeçalho do Windows.</span><span class="sxs-lookup"><span data-stu-id="469a8-145">A property sheet must contain at least one page, but it cannot contain more than the value of **MAXPROPPAGES** as defined in the Windows header files.</span></span> <span data-ttu-id="469a8-146">Cada página tem um índice de base zero que a folha de propriedades atribui de acordo com a ordem na qual a página é adicionada à folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-146">Each page has a zero-based index that the property sheet assigns according to the order in which the page is added to the property sheet.</span></span> <span data-ttu-id="469a8-147">Os índices são usados em mensagens que você envia para a folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-147">The indexes are used in messages that you send to the property sheet.</span></span>

<span data-ttu-id="469a8-148">Uma página de propriedades pode conter uma caixa de diálogo aninhada.</span><span class="sxs-lookup"><span data-stu-id="469a8-148">A property page can contain a nested dialog box.</span></span> <span data-ttu-id="469a8-149">Se tiver, você deverá incluir o estilo [**WS \_ ex \_ CONTROLPARENT**](/windows/desktop/winmsg/extended-window-styles) para a caixa de diálogo de nível superior e chamar a função [**IsDialogMessage**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) com o identificador para a caixa de diálogo pai.</span><span class="sxs-lookup"><span data-stu-id="469a8-149">If it does, you must include the [**WS\_EX\_CONTROLPARENT**](/windows/desktop/winmsg/extended-window-styles) style for the top-level dialog box and call the [**IsDialogMessage**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) function with the handle to the parent dialog box.</span></span> <span data-ttu-id="469a8-150">Isso garante que o usuário possa usar mnemônicos e as teclas de navegação da caixa de diálogo para mover o foco para controles na caixa de diálogo aninhada.</span><span class="sxs-lookup"><span data-stu-id="469a8-150">This ensures that the user can use mnemonics and the dialog box navigation keys to move the focus to controls in the nested dialog box.</span></span>

<span data-ttu-id="469a8-151">Cada página tem um ícone e rótulo correspondente.</span><span class="sxs-lookup"><span data-stu-id="469a8-151">Each page has a corresponding icon and label.</span></span> <span data-ttu-id="469a8-152">A folha de Propriedades cria uma guia para cada página e exibe o ícone e o rótulo na guia. Espera-se que todas as páginas da folha de propriedades usem uma fonte que não seja negrito.</span><span class="sxs-lookup"><span data-stu-id="469a8-152">The property sheet creates a tab for each page and displays the icon and label in the tab. All property sheet pages are expected to use a nonbold font.</span></span> <span data-ttu-id="469a8-153">Para garantir que a fonte não esteja em negrito, especifique o estilo **DS \_ 3DLOOK** no modelo da caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="469a8-153">To ensure that the font is not bold, specify the **DS\_3DLOOK** style in the dialog box template.</span></span>

<span data-ttu-id="469a8-154">O procedimento da caixa de diálogo para uma página não deve chamar a função [**EndDialog**](/windows/desktop/api/winuser/nf-winuser-enddialog) .</span><span class="sxs-lookup"><span data-stu-id="469a8-154">The dialog box procedure for a page must not call the [**EndDialog**](/windows/desktop/api/winuser/nf-winuser-enddialog) function.</span></span> <span data-ttu-id="469a8-155">Isso irá destruir toda a folha de propriedades, não apenas a página.</span><span class="sxs-lookup"><span data-stu-id="469a8-155">Doing so will destroy the entire property sheet, not just the page.</span></span>

<span data-ttu-id="469a8-156">O tamanho mínimo de uma página de folha de propriedades é de 212 unidades de caixa de diálogo horizontais e 114 de caixas de diálogo verticalmente.</span><span class="sxs-lookup"><span data-stu-id="469a8-156">The minimum size for a property sheet page is 212 dialog units horizontally and 114 dialog units vertically.</span></span> <span data-ttu-id="469a8-157">Se uma caixa de diálogo de página for menor do que isso, a página será ampliada até atender ao tamanho mínimo.</span><span class="sxs-lookup"><span data-stu-id="469a8-157">If a page dialog is smaller than this, the page will be enlarged until it meets the minimum size.</span></span> <span data-ttu-id="469a8-158">O arquivo de cabeçalho Prsht. h contém três conjuntos de tamanhos recomendados para páginas de folha de propriedades, conforme mostrado na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="469a8-158">The Prsht.h header file contains three sets of recommended sizes for property sheet pages, as shown in the following table.</span></span>

|  <span data-ttu-id="469a8-159">Tamanho</span><span class="sxs-lookup"><span data-stu-id="469a8-159">Size</span></span>                |   <span data-ttu-id="469a8-160">Descrição</span><span class="sxs-lookup"><span data-stu-id="469a8-160">Description</span></span>                                                   |
|----------------------|-----------------------------------------------------------------|
| <span data-ttu-id="469a8-161">**PROP \_ SM \_ CXDLG**</span><span class="sxs-lookup"><span data-stu-id="469a8-161">**PROP\_SM\_CXDLG**</span></span>  | <span data-ttu-id="469a8-162">Largura, em unidades de diálogo, de uma página de folha de propriedades pequena.</span><span class="sxs-lookup"><span data-stu-id="469a8-162">Width, in dialog units, of a small property sheet page.</span></span>         |
| <span data-ttu-id="469a8-163">**PROP \_ SM \_ CYDLG**</span><span class="sxs-lookup"><span data-stu-id="469a8-163">**PROP\_SM\_CYDLG**</span></span>  | <span data-ttu-id="469a8-164">Altura, em unidades de diálogo, de uma página de folha de propriedades pequena.</span><span class="sxs-lookup"><span data-stu-id="469a8-164">Height, in dialog units, of a small property sheet page.</span></span>        |
| <span data-ttu-id="469a8-165">**\_CXDLG do MED de prop \_**</span><span class="sxs-lookup"><span data-stu-id="469a8-165">**PROP\_MED\_CXDLG**</span></span> | <span data-ttu-id="469a8-166">Largura, em unidades de diálogo, de uma página de folha de propriedades de tamanho médio.</span><span class="sxs-lookup"><span data-stu-id="469a8-166">Width, in dialog units, of a medium-sized property sheet page.</span></span>  |
| <span data-ttu-id="469a8-167">**\_CYDLG do MED de prop \_**</span><span class="sxs-lookup"><span data-stu-id="469a8-167">**PROP\_MED\_CYDLG**</span></span> | <span data-ttu-id="469a8-168">Altura, em unidades de diálogo, de uma página de folha de propriedades de tamanho médio.</span><span class="sxs-lookup"><span data-stu-id="469a8-168">Height, in dialog units, of a medium-sized property sheet page.</span></span> |
| <span data-ttu-id="469a8-169">**PROP \_ LG \_ CXDLG**</span><span class="sxs-lookup"><span data-stu-id="469a8-169">**PROP\_LG\_CXDLG**</span></span>  | <span data-ttu-id="469a8-170">Largura, em unidades de diálogo, de uma página de folha de propriedades grande.</span><span class="sxs-lookup"><span data-stu-id="469a8-170">Width, in dialog units, of a large property sheet page.</span></span>         |
| <span data-ttu-id="469a8-171">**PROP \_ LG \_ CYDLG**</span><span class="sxs-lookup"><span data-stu-id="469a8-171">**PROP\_LG\_CYDLG**</span></span>  | <span data-ttu-id="469a8-172">Altura, em unidades de diálogo, de uma página de folha de propriedades grande.</span><span class="sxs-lookup"><span data-stu-id="469a8-172">Height, in dialog units, of a large property sheet page.</span></span>        |

<span data-ttu-id="469a8-173">Usar esses tamanhos recomendados ajudará a garantir a consistência visual entre seu aplicativo e outros aplicativos do Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="469a8-173">Using these recommended sizes will help ensure visual consistency between your application and other Microsoft Windows applications.</span></span>

<span data-ttu-id="469a8-174">No editor de recursos Microsoft Visual Studio, você pode criar uma página do tamanho apropriado na caixa de diálogo **Adicionar recurso** .</span><span class="sxs-lookup"><span data-stu-id="469a8-174">In the Microsoft Visual Studio resource editor, you can create a page of the appropriate size in the **Add Resource** dialog box.</span></span> <span data-ttu-id="469a8-175">Expanda o nó da caixa de diálogo e selecione **IDD \_ PROPPAGE \_ grande**, **IDD \_ PROPPAGE \_ médio** ou **IDD \_ PROPPAGE \_ Small**.</span><span class="sxs-lookup"><span data-stu-id="469a8-175">Expand the Dialog node and select **IDD\_PROPPAGE\_LARGE**, **IDD\_PROPPAGE\_MEDIUM**, or **IDD\_PROPPAGE\_SMALL**.</span></span>

<span data-ttu-id="469a8-176">A folha de propriedades é dimensionada automaticamente para acomodar a maior página.</span><span class="sxs-lookup"><span data-stu-id="469a8-176">The property sheet is automatically sized to accommodate the largest page.</span></span>

## <a name="property-sheet-creation"></a><span data-ttu-id="469a8-177">Criação da folha de propriedades</span><span class="sxs-lookup"><span data-stu-id="469a8-177">Property Sheet Creation</span></span>

<span data-ttu-id="469a8-178">Antes de criar uma folha de propriedades, você deve definir uma ou mais páginas.</span><span class="sxs-lookup"><span data-stu-id="469a8-178">Before creating a property sheet, you must define one or more pages.</span></span> <span data-ttu-id="469a8-179">Isso envolve preencher uma estrutura [**PROPSHEETPAGE**](pss-propsheetpage.md) com informações sobre a página – seu ícone, rótulo, modelo de caixa de diálogo, procedimento de caixa de diálogo e assim por diante — e, em seguida, especificar o endereço da estrutura em uma chamada para a função [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) .</span><span class="sxs-lookup"><span data-stu-id="469a8-179">This involves filling a [**PROPSHEETPAGE**](pss-propsheetpage.md) structure with information about the page—its icon, label, dialog box template, dialog box procedure, and so on—and then specifying the address of the structure in a call to the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function.</span></span> <span data-ttu-id="469a8-180">A função retorna um identificador para o tipo HPROPSHEETPAGE que identifica exclusivamente a página.</span><span class="sxs-lookup"><span data-stu-id="469a8-180">The function returns a handle to the HPROPSHEETPAGE type that uniquely identifies the page.</span></span>

<span data-ttu-id="469a8-181">Para criar uma folha de propriedades, você especifica o endereço de uma estrutura [**PROPSHEETHEADER**](pss-propsheetheader.md) em uma chamada para a função [**folha**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) .</span><span class="sxs-lookup"><span data-stu-id="469a8-181">To create a property sheet, you specify the address of a [**PROPSHEETHEADER**](pss-propsheetheader.md) structure in a call to the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function.</span></span> <span data-ttu-id="469a8-182">A estrutura define o ícone e o título da folha de propriedades e também inclui o endereço de uma matriz de identificadores HPROPSHEETPAGE que você obtém usando [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea).</span><span class="sxs-lookup"><span data-stu-id="469a8-182">The structure defines the icon and title for the property sheet and also includes the address of an array of HPROPSHEETPAGE handles that you obtain by using [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea).</span></span> <span data-ttu-id="469a8-183">Quando o **folha** cria a folha de propriedades, ele inclui as páginas identificadas na matriz.</span><span class="sxs-lookup"><span data-stu-id="469a8-183">When **PropertySheet** creates the property sheet, it includes the pages identified in the array.</span></span> <span data-ttu-id="469a8-184">As páginas aparecem na folha de propriedades na mesma ordem em que estão contidas na matriz.</span><span class="sxs-lookup"><span data-stu-id="469a8-184">The pages appear in the property sheet in the same order that they are contained in the array.</span></span>

<span data-ttu-id="469a8-185">Outra maneira de atribuir páginas a uma folha de propriedades é especificar uma matriz de estruturas [**PROPSHEETPAGE**](pss-propsheetpage.md) em vez de uma matriz de identificadores **HPROPSHEETPAGE** .</span><span class="sxs-lookup"><span data-stu-id="469a8-185">Another way to assign pages to a property sheet is to specify an array of [**PROPSHEETPAGE**](pss-propsheetpage.md) structures instead of an array of **HPROPSHEETPAGE** handles.</span></span> <span data-ttu-id="469a8-186">Nesse caso, o [**folha**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) cria identificadores para as páginas antes de adicioná-las à folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-186">In this case, [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) creates handles for the pages before adding them to the property sheet.</span></span>

<span data-ttu-id="469a8-187">Quando uma página é criada, seu procedimento de caixa de diálogo recebe uma mensagem do [**WM \_ INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) .</span><span class="sxs-lookup"><span data-stu-id="469a8-187">When a page is created, its dialog box procedure receives a [**WM\_INITDIALOG**](/windows/desktop/dlgbox/wm-initdialog) message.</span></span> <span data-ttu-id="469a8-188">O parâmetro *lParam* da mensagem é um ponteiro para uma cópia da estrutura [**PROPSHEETPAGE**](pss-propsheetpage.md) que é definida quando a página é criada.</span><span class="sxs-lookup"><span data-stu-id="469a8-188">The message's *lParam* parameter is a pointer to a copy of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure that is defined when the page is created.</span></span> <span data-ttu-id="469a8-189">Em particular, quando uma página é criada, o membro **lParam** da estrutura pode ser usado para passar informações definidas pelo aplicativo para o procedimento da caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="469a8-189">In particular, when a page is created, the structure's **lParam** member can be used to pass application-defined information to the dialog box procedure.</span></span> <span data-ttu-id="469a8-190">Com exceção do membro **lParam** , essa estrutura deve ser tratada como somente leitura.</span><span class="sxs-lookup"><span data-stu-id="469a8-190">With the exception of the **lParam** member, this structure must be treated as read-only.</span></span> <span data-ttu-id="469a8-191">Modificar algo diferente de **lParam** terá consequências imprevisíveis.</span><span class="sxs-lookup"><span data-stu-id="469a8-191">Modifying anything other than **lParam** will have unpredictable consequences.</span></span>

<span data-ttu-id="469a8-192">Quando o sistema passa subsequentemente uma cópia da estrutura [**PROPSHEETPAGE**](pss-propsheetpage.md) da página para seu aplicativo, ele usa o mesmo ponteiro.</span><span class="sxs-lookup"><span data-stu-id="469a8-192">When the system subsequently passes a copy of the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure to your application, it uses the same pointer.</span></span> <span data-ttu-id="469a8-193">Todas as alterações na estrutura serão passadas.</span><span class="sxs-lookup"><span data-stu-id="469a8-193">Any changes to the structure will be passed along.</span></span> <span data-ttu-id="469a8-194">Como o membro **lParam** é ignorado pelo sistema, ele pode ser modificado para enviar informações para outras partes do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="469a8-194">Because the **lParam** member is ignored by the system, it can be modified to send information to other parts of your application.</span></span> <span data-ttu-id="469a8-195">Você pode, por exemplo, usar **lParam** para passar informações para a função de retorno de chamada [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) da página.</span><span class="sxs-lookup"><span data-stu-id="469a8-195">You can, for instance, use **lParam** to pass information to the page's [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) callback function.</span></span>

<span data-ttu-id="469a8-196">[**Folha**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) define automaticamente o tamanho e a posição inicial de uma folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-196">[**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) automatically sets the size and initial position of a property sheet.</span></span> <span data-ttu-id="469a8-197">A posição é baseada na posição da janela do proprietário e o tamanho é baseado na maior página especificada na matriz de páginas quando a folha de propriedades foi criada.</span><span class="sxs-lookup"><span data-stu-id="469a8-197">The position is based on the position of the owner window, and the size is based on the largest page specified in the array of pages when the property sheet was created.</span></span> <span data-ttu-id="469a8-198">Se você quiser que as páginas correspondam à largura dos quatro botões na parte inferior da folha de propriedades, defina a largura da página mais larga para as unidades de diálogo 190.</span><span class="sxs-lookup"><span data-stu-id="469a8-198">If you want the pages to match the width of the four buttons at the bottom of the property sheet, set the width of the widest page to 190 dialog units.</span></span>

<span data-ttu-id="469a8-199">O tamanho de uma folha de propriedades é computado das propriedades *Width* e *Height* do modelo de caixa de diálogo no arquivo de recursos.</span><span class="sxs-lookup"><span data-stu-id="469a8-199">The size of a property sheet is computed from the *width* and *height* properties of the dialog template in the resource file.</span></span> <span data-ttu-id="469a8-200">Consulte [**recurso de caixa de diálogo**](/windows/desktop/menurc/dialog-resource) ou [**recurso DIALOGEX**](/windows/desktop/menurc/dialogex-resource) para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="469a8-200">See [**DIALOG Resource**](/windows/desktop/menurc/dialog-resource) or [**DIALOGEX Resource**](/windows/desktop/menurc/dialogex-resource) for further details.</span></span> <span data-ttu-id="469a8-201">No entanto, observe que, por motivos de compatibilidade, as dimensões são computadas em relação à fonte MS Shell Dlg, em vez da fonte usada pela página.</span><span class="sxs-lookup"><span data-stu-id="469a8-201">Note, however, that for compatibility reasons, the dimensions are computed relative to the MS Shell Dlg font rather than the font used by the page.</span></span> <span data-ttu-id="469a8-202">Se você criar uma página que usa outra fonte, uma das sugestões a seguir poderá ser usada.</span><span class="sxs-lookup"><span data-stu-id="469a8-202">If you design a page that uses another font, one of the following suggestions can be used.</span></span>

-   <span data-ttu-id="469a8-203">Ajuste as dimensões do modelo de caixa de diálogo para compensar a diferença de tamanho entre a fonte MS Shell Dlg e a fonte que a página realmente usa.</span><span class="sxs-lookup"><span data-stu-id="469a8-203">Adjust the dimensions of the dialog template to compensate for the difference in size between the MS Shell Dlg font and the font the page actually uses.</span></span> <span data-ttu-id="469a8-204">Por exemplo, se você escolher uma fonte que seja duas vezes maior que o MS Shell Dlg, defina a propriedade Width do modelo de caixa de diálogo como duas vezes o uso normal.</span><span class="sxs-lookup"><span data-stu-id="469a8-204">For example, if you choose a font that is twice as wide as MS Shell Dlg, then set the dialog template's width property to twice the normal use.</span></span>
-   <span data-ttu-id="469a8-205">Use um modelo [**DIALOGEX**](/windows/desktop/menurc/dialogex-resource) e defina o estilo de caixa de diálogo **\_ SHELLFONT do DS** .</span><span class="sxs-lookup"><span data-stu-id="469a8-205">Use a [**DIALOGEX**](/windows/desktop/menurc/dialogex-resource) template and set the **DS\_SHELLFONT** dialog style.</span></span> <span data-ttu-id="469a8-206">Nesse caso, o Gerenciador de folhas de propriedades interpreta as dimensões do modelo de caixa de diálogo em relação à fonte usada pelo modelo de caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="469a8-206">In that case, the property sheet manager interprets the dialog template dimensions relative to the font used by the dialog template.</span></span>

## <a name="adding-and-removing-pages"></a><span data-ttu-id="469a8-207">Adicionando e removendo páginas</span><span class="sxs-lookup"><span data-stu-id="469a8-207">Adding and Removing Pages</span></span>

<span data-ttu-id="469a8-208">Depois de criar uma folha de propriedades, um aplicativo pode adicionar uma página ao final do conjunto de páginas existente enviando uma mensagem de [**PSM \_ ADDPAGE**](psm-addpage.md) .</span><span class="sxs-lookup"><span data-stu-id="469a8-208">After creating a property sheet, an application can add a page to the end of the existing set of pages by sending a [**PSM\_ADDPAGE**](psm-addpage.md) message.</span></span> <span data-ttu-id="469a8-209">Para inserir uma página entre páginas existentes, envie uma mensagem [**PropSheet \_ InsertPage**](/windows/desktop/api/Prsht/nf-prsht-propsheet_insertpage) .</span><span class="sxs-lookup"><span data-stu-id="469a8-209">To insert a page between existing pages, send a [**PropSheet\_InsertPage**](/windows/desktop/api/Prsht/nf-prsht-propsheet_insertpage) message.</span></span> <span data-ttu-id="469a8-210">Observe que o tamanho da folha de propriedades não pode ser alterado após ter sido criado.</span><span class="sxs-lookup"><span data-stu-id="469a8-210">Note that the size of the property sheet cannot change after it has been created.</span></span> <span data-ttu-id="469a8-211">As páginas adicionadas ou inseridas não devem ser maiores do que a maior página atualmente na folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-211">Any added or inserted pages must be no larger than the largest page currently in the property sheet.</span></span> <span data-ttu-id="469a8-212">Para remover uma página, envie uma mensagem de [**PSM \_ REMOVEPAGE**](psm-removepage.md) .</span><span class="sxs-lookup"><span data-stu-id="469a8-212">To remove a page, send a [**PSM\_REMOVEPAGE**](psm-removepage.md) message.</span></span>

<span data-ttu-id="469a8-213">Ao definir uma página, você pode especificar o endereço de uma função de retorno de chamada [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) que a folha de propriedades chama quando está criando ou removendo a página.</span><span class="sxs-lookup"><span data-stu-id="469a8-213">When you define a page, you can specify the address of a [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) callback function that the property sheet calls when it is creating or removing the page.</span></span> <span data-ttu-id="469a8-214">Usar o *PropSheetPageProc* oferece a oportunidade de executar operações de inicialização e limpeza para páginas individuais.</span><span class="sxs-lookup"><span data-stu-id="469a8-214">Using *PropSheetPageProc* gives you an opportunity to perform initialization and cleanup operations for individual pages.</span></span>

> [!NOTE]  
> <span data-ttu-id="469a8-215">Várias mensagens e uma chamada de função ocorrem enquanto a folha de propriedades está manipulando a lista de páginas.</span><span class="sxs-lookup"><span data-stu-id="469a8-215">A number of messages and one function call occur while the property sheet is manipulating the list of pages.</span></span> <span data-ttu-id="469a8-216">Enquanto essa ação está ocorrendo, a tentativa de modificar a lista de páginas terá resultados imprevisíveis.</span><span class="sxs-lookup"><span data-stu-id="469a8-216">While this action is taking place, attempting to modify the list of pages will have unpredictable results.</span></span> <span data-ttu-id="469a8-217">Não adicione, insira ou remova páginas em sua implementação do [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka), ou ao lidar com as notificações e mensagens do Windows a seguir.</span><span class="sxs-lookup"><span data-stu-id="469a8-217">Do not add, insert, or remove pages in your implementation of [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka), or while handling the following notifications and Windows messages.</span></span>
>
> -   [<span data-ttu-id="469a8-218">PSN \_ aplicar</span><span class="sxs-lookup"><span data-stu-id="469a8-218">PSN\_APPLY</span></span>](psn-apply.md)
> -   [<span data-ttu-id="469a8-219">PSN \_ KILLACTIVE</span><span class="sxs-lookup"><span data-stu-id="469a8-219">PSN\_KILLACTIVE</span></span>](psn-killactive.md)
> -   [<span data-ttu-id="469a8-220">redefinição de PSN \_</span><span class="sxs-lookup"><span data-stu-id="469a8-220">PSN\_RESET</span></span>](psn-reset.md)
> -   [<span data-ttu-id="469a8-221">PSN \_ SETactive</span><span class="sxs-lookup"><span data-stu-id="469a8-221">PSN\_SETACTIVE</span></span>](psn-setactive.md)
> -   [<span data-ttu-id="469a8-222">PSN \_ WIZBACK</span><span class="sxs-lookup"><span data-stu-id="469a8-222">PSN\_WIZBACK</span></span>](psn-wizback.md)
> -   [<span data-ttu-id="469a8-223">PSN \_ WIZNEXT</span><span class="sxs-lookup"><span data-stu-id="469a8-223">PSN\_WIZNEXT</span></span>](psn-wiznext.md)
> -   [<span data-ttu-id="469a8-224">**INITDIALOG do WM \_**</span><span class="sxs-lookup"><span data-stu-id="469a8-224">**WM\_INITDIALOG**</span></span>](/windows/desktop/dlgbox/wm-initdialog)
> -   [<span data-ttu-id="469a8-225">**destruição do WM \_**</span><span class="sxs-lookup"><span data-stu-id="469a8-225">**WM\_DESTROY**</span></span>](/windows/desktop/winmsg/wm-destroy)

<span data-ttu-id="469a8-226">Se houver necessidade de modificar uma página de folha de propriedades enquanto você estiver manipulando uma dessas mensagens ou enquanto [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) estiver em operação, poste uma mensagem privada do Windows.</span><span class="sxs-lookup"><span data-stu-id="469a8-226">If the need arises to modify a property sheet page while you are handling one of these messages or while [*PropSheetPageProc*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) is in operation, post a private Windows message.</span></span> <span data-ttu-id="469a8-227">Seu aplicativo não receberá essa mensagem até que o Gerenciador de folhas de propriedades tenha concluído suas tarefas. nesse ponto, será seguro modificar a lista de páginas.</span><span class="sxs-lookup"><span data-stu-id="469a8-227">Your application will not receive that message until after the property sheet manager has finished its tasks, at which point it will be safe to modify the list of pages.</span></span>

<span data-ttu-id="469a8-228">Quando uma folha de propriedades é destruída, ela destrói automaticamente todas as páginas que foram adicionadas a ela.</span><span class="sxs-lookup"><span data-stu-id="469a8-228">When a property sheet is destroyed, it automatically destroys all of the pages that have been added to it.</span></span> <span data-ttu-id="469a8-229">As páginas são destruídas na ordem inversa da especificada na matriz usada para criar as páginas.</span><span class="sxs-lookup"><span data-stu-id="469a8-229">The pages are destroyed in reverse order from that specified in the array used to create the pages.</span></span> <span data-ttu-id="469a8-230">Para destruir uma página que foi criada pela função [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) , mas não foi adicionada à folha de propriedades, use a função [**DestroyPropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-destroypropertysheetpage) .</span><span class="sxs-lookup"><span data-stu-id="469a8-230">To destroy a page that was created by the [**CreatePropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) function but was not added to the property sheet, use the [**DestroyPropertySheetPage**](/windows/desktop/api/Prsht/nf-prsht-destroypropertysheetpage) function.</span></span>

## <a name="property-sheet-title-and-page-labels"></a><span data-ttu-id="469a8-231">Título da folha de propriedades e rótulos de página</span><span class="sxs-lookup"><span data-stu-id="469a8-231">Property Sheet Title and Page Labels</span></span>

<span data-ttu-id="469a8-232">Você especifica o título de uma folha de propriedades na estrutura [**PROPSHEETHEADER**](pss-propsheetheader.md) usada para criar a folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-232">You specify the title of a property sheet in the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure used to create the property sheet.</span></span> <span data-ttu-id="469a8-233">Se o membro **dwFlags** incluir o valor **PSH \_ PROPTITLE** , a folha de propriedades adicionará o sufixo "Properties" ou o prefixo "Properties for", dependendo da versão.</span><span class="sxs-lookup"><span data-stu-id="469a8-233">If the **dwFlags** member includes the **PSH\_PROPTITLE** value, the property sheet adds the suffix "Properties" or the prefix "Properties for", depending on the version.</span></span> <span data-ttu-id="469a8-234">Você pode alterar o título depois que uma folha de propriedades é criada usando a mensagem de [**PSM \_ SetTitle**](psm-settitle.md) .</span><span class="sxs-lookup"><span data-stu-id="469a8-234">You can change the title after a property sheet is created by using the [**PSM\_SETTITLE**](psm-settitle.md) message.</span></span> <span data-ttu-id="469a8-235">Em um assistente Aero, essa mensagem pode ser usada para alterar o título de uma página interior dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="469a8-235">In an Aero Wizard, this message can be used to change the title of an interior page dynamically.</span></span>

<span data-ttu-id="469a8-236">Por padrão, uma folha de propriedades usa a cadeia de caracteres de nome especificada no modelo da caixa de diálogo como o rótulo de uma página.</span><span class="sxs-lookup"><span data-stu-id="469a8-236">By default, a property sheet uses the name string specified in the dialog box template as the label for a page.</span></span> <span data-ttu-id="469a8-237">Você pode substituir a cadeia de caracteres de nome, incluindo o valor de **PSP \_ USETITLE** no membro **dwFlags** da estrutura [**PROPSHEETPAGE**](pss-propsheetpage.md) que define a página.</span><span class="sxs-lookup"><span data-stu-id="469a8-237">You can override the name string by including the **PSP\_USETITLE** value in the **dwFlags** member of the [**PROPSHEETPAGE**](pss-propsheetpage.md) structure that defines the page.</span></span> <span data-ttu-id="469a8-238">Quando **PSP \_ USETITLE** é especificado, o membro **pszTitle** deve conter o endereço da cadeia de caracteres do rótulo para a página.</span><span class="sxs-lookup"><span data-stu-id="469a8-238">When **PSP\_USETITLE** is specified, the **pszTitle** member must contain the address of the label string for the page.</span></span>

## <a name="page-activation"></a><span data-ttu-id="469a8-239">Ativação de página</span><span class="sxs-lookup"><span data-stu-id="469a8-239">Page Activation</span></span>

<span data-ttu-id="469a8-240">Uma folha de propriedades pode ter apenas uma página ativa por vez.</span><span class="sxs-lookup"><span data-stu-id="469a8-240">A property sheet can have only one active page at a time.</span></span> <span data-ttu-id="469a8-241">A página que tem a ativação está no primeiro plano da pilha sobreposta de páginas.</span><span class="sxs-lookup"><span data-stu-id="469a8-241">The page that has the activation is at the foreground of the overlapping stack of pages.</span></span> <span data-ttu-id="469a8-242">O usuário ativa uma página selecionando sua guia; um aplicativo ativa uma página usando a mensagem de [**PSM \_ setcurse**](psm-setcursel.md) .</span><span class="sxs-lookup"><span data-stu-id="469a8-242">The user activates a page by selecting its tab; an application activates a page by using the [**PSM\_SETCURSEL**](psm-setcursel.md) message.</span></span>

<span data-ttu-id="469a8-243">A folha de propriedades envia o código de notificação [PSN \_ KILLACTIVE](psn-killactive.md) para a página que está prestes a perder a ativação.</span><span class="sxs-lookup"><span data-stu-id="469a8-243">The property sheet sends the [PSN\_KILLACTIVE](psn-killactive.md) notification code to the page that is about to lose the activation.</span></span> <span data-ttu-id="469a8-244">Em resposta, a página deve validar as alterações que o usuário fez na página.</span><span class="sxs-lookup"><span data-stu-id="469a8-244">In response, the page must validate any changes that the user has made to the page.</span></span> <span data-ttu-id="469a8-245">Se a página exigir entrada de usuário adicional antes de perder a ativação, use a função [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) para definir o valor de **\_ MSGRESULT de DWL** da página como **true**.</span><span class="sxs-lookup"><span data-stu-id="469a8-245">If the page requires additional user input before losing the activation, use the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function to set the **DWL\_MSGRESULT** value of the page to **TRUE**.</span></span> <span data-ttu-id="469a8-246">Além disso, a página deve exibir uma caixa de mensagem que descreve o problema e fornece a ação recomendada.</span><span class="sxs-lookup"><span data-stu-id="469a8-246">Also, the page must display a message box that describes the problem and provides the recommended action.</span></span> <span data-ttu-id="469a8-247">Defina **DWL \_ MSGRESULT** como **false** quando houver problema para perder a ativação.</span><span class="sxs-lookup"><span data-stu-id="469a8-247">Set **DWL\_MSGRESULT** to **FALSE** when it is okay to lose the activation.</span></span>

<span data-ttu-id="469a8-248">Antes que a página que está recebendo a ativação esteja visível, a folha de propriedades envia o código de notificação [PSN \_ SetActive](psn-setactive.md) para a página.</span><span class="sxs-lookup"><span data-stu-id="469a8-248">Before the page that is gaining the activation is visible, the property sheet sends the [PSN\_SETACTIVE](psn-setactive.md) notification code to the page.</span></span> <span data-ttu-id="469a8-249">A página deve responder inicializando suas janelas de controle.</span><span class="sxs-lookup"><span data-stu-id="469a8-249">The page must respond by initializing its control windows.</span></span>

## <a name="help-button"></a><span data-ttu-id="469a8-250">Botão ajuda</span><span class="sxs-lookup"><span data-stu-id="469a8-250">Help Button</span></span>

<span data-ttu-id="469a8-251">As folhas de propriedades podem exibir dois botões de ajuda: um botão de ajuda da folha de propriedades que é exibido na parte inferior do quadro, ao lado do botão **OK** / **Cancelar** / **aplicar** botões e de barra de legenda padrão que fornece ajuda contextual.</span><span class="sxs-lookup"><span data-stu-id="469a8-251">Property sheets can display two Help buttons: a property sheet Help button that is displayed at the bottom of the frame, next to the **OK**/**Cancel**/**Apply** buttons, and a standard caption bar button that provides context-sensitive Help.</span></span>

<span data-ttu-id="469a8-252">O botão de ajuda da folha de propriedades é opcional e pode ser habilitado em uma página por página.</span><span class="sxs-lookup"><span data-stu-id="469a8-252">The property sheet Help button is optional, and can be enabled on a page by page basis.</span></span> <span data-ttu-id="469a8-253">Para exibir o botão de ajuda da folha de propriedades de uma ou mais páginas:</span><span class="sxs-lookup"><span data-stu-id="469a8-253">To display the property sheet Help button for one or more pages:</span></span>

-   <span data-ttu-id="469a8-254">Defina o sinalizador **PSH \_ HasHelp** no membro **dwFlags** da estrutura [**PROPSHEETHEADER**](pss-propsheetheader.md) da folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-254">Set the **PSH\_HASHELP** flag in the **dwFlags** member of the property sheet's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span>
-   <span data-ttu-id="469a8-255">Para cada página que exibirá um botão ajuda, defina o sinalizador **PSP \_ HasHelp** no membro **dwFlags** da estrutura [**PROPSHEETPAGE**](pss-propsheetpage.md) da página.</span><span class="sxs-lookup"><span data-stu-id="469a8-255">For each page that will display a Help button, set the **PSP\_HASHELP** flag in the **dwFlags** member of the page's [**PROPSHEETPAGE**](pss-propsheetpage.md) structure.</span></span>

<span data-ttu-id="469a8-256">Quando o usuário clica no botão ajuda, a página ativa recebe um código de notificação de [ \_ ajuda PSN](psn-help.md) .</span><span class="sxs-lookup"><span data-stu-id="469a8-256">When the user clicks the Help button, the active page receives a [PSN\_HELP](psn-help.md) notification code.</span></span> <span data-ttu-id="469a8-257">A página deve responder exibindo informações de ajuda, normalmente chamando a função [**WinHelp**](/windows/desktop/api/winuser/nf-winuser-winhelpa) .</span><span class="sxs-lookup"><span data-stu-id="469a8-257">The page must respond by displaying Help information, typically by calling the [**WinHelp**](/windows/desktop/api/winuser/nf-winuser-winhelpa) function.</span></span>

### <a name="removing-the-caption-bar-help-button"></a><span data-ttu-id="469a8-258">Removendo o botão de ajuda da barra de legenda</span><span class="sxs-lookup"><span data-stu-id="469a8-258">Removing the Caption Bar Help Button</span></span>

<span data-ttu-id="469a8-259">O botão de ajuda da barra de legenda é exibido por padrão, de forma que a ajuda contextual sempre esteja disponível para os botões OK/cancelar/aplicar.</span><span class="sxs-lookup"><span data-stu-id="469a8-259">The caption bar Help button is displayed by default, so that context-sensitive Help is always available for the OK/Cancel/Apply buttons.</span></span> <span data-ttu-id="469a8-260">No entanto, esse botão pode ser removido, se necessário.</span><span class="sxs-lookup"><span data-stu-id="469a8-260">However, this button can be removed, if necessary.</span></span> <span data-ttu-id="469a8-261">Para remover o botão de ajuda da barra de legenda de uma folha de propriedades:</span><span class="sxs-lookup"><span data-stu-id="469a8-261">To remove a property sheet's caption bar Help button:</span></span>

-   <span data-ttu-id="469a8-262">Para versões dos controles comuns anteriores à [versão 5,80](common-control-versions.md), você deve implementar uma [**função de retorno de chamada de folha de propriedades**](/windows/desktop/api/Prsht/nc-prsht-pfnpropsheetcallback).</span><span class="sxs-lookup"><span data-stu-id="469a8-262">For versions of the common controls prior to [version 5.80](common-control-versions.md), you must implement a [**property sheet callback function**](/windows/desktop/api/Prsht/nc-prsht-pfnpropsheetcallback).</span></span>
-   <span data-ttu-id="469a8-263">Para a [versão 5,80](common-control-versions.md) e posterior dos controles comuns, você pode simplesmente definir o \_ sinalizador PSH NOCONTEXTHELP no membro **dwFlags** da estrutura [**PROPSHEETHEADER**](pss-propsheetheader.md) da folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-263">For [version 5.80](common-control-versions.md) and later of the common controls, you can simply set the PSH\_NOCONTEXTHELP flag in the **dwFlags** member of the property sheet's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span> <span data-ttu-id="469a8-264">No entanto, se precisar de compatibilidade com versões anteriores de controle comum, você deve implementar a função de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="469a8-264">However, if you need backward compatibility with earlier common control versions, you must implement the callback function.</span></span>

<span data-ttu-id="469a8-265">Para implementar uma função de retorno de chamada de folha de propriedades que remove o botão de ajuda da barra de legenda:</span><span class="sxs-lookup"><span data-stu-id="469a8-265">To implement a property sheet callback function that removes the caption bar Help button:</span></span>

-   <span data-ttu-id="469a8-266">Defina o sinalizador **PSH \_ USECALLBACK** no membro **dwFlags** da estrutura [**PROPSHEETHEADER**](pss-propsheetheader.md) da folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-266">Set the **PSH\_USECALLBACK** flag in the **dwFlags** member of the property sheet's [**PROPSHEETHEADER**](pss-propsheetheader.md) structure.</span></span>
-   <span data-ttu-id="469a8-267">Defina o membro **pfnCallBack** da estrutura [**PROPSHEETHEADER**](pss-propsheetheader.md) para apontar para a função de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="469a8-267">Set the **pfnCallBack** member of the [**PROPSHEETHEADER**](pss-propsheetheader.md) structure to point to the callback function.</span></span>
-   <span data-ttu-id="469a8-268">Implemente a função de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="469a8-268">Implement the callback function.</span></span> <span data-ttu-id="469a8-269">Quando essa função recebe a mensagem de **\_ precreate do PSCB** , ela também receberá um ponteiro para o modelo da caixa de diálogo da folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-269">When this function receives the **PSCB\_PRECREATE** message, it will also receive a pointer to the property sheet's dialog box template.</span></span> <span data-ttu-id="469a8-270">Remova o estilo **DS \_ CONTEXTHELP** deste modelo.</span><span class="sxs-lookup"><span data-stu-id="469a8-270">Remove the **DS\_CONTEXTHELP** style from this template.</span></span>

<span data-ttu-id="469a8-271">O exemplo a seguir ilustra como implementar essa função de retorno de chamada:</span><span class="sxs-lookup"><span data-stu-id="469a8-271">The following sample illustrates how to implement such a callback function:</span></span>

```cpp
int CALLBACK RemoveContextHelpProc(HWND hwnd, UINT message, LPARAM lParam)
{
    switch (message) 
    {
    case PSCB_PRECREATE:
        // Remove the DS_CONTEXTHELP style from the
        // dialog box template
        if (((LPDLGTEMPLATEEX)lParam)->signature ==    
           0xFFFF)
           {
            ((LPDLGTEMPLATEEX)lParam)->style 
            &= ~DS_CONTEXTHELP;
        }
        else {
            ((LPDLGTEMPLATE)lParam)->style 
            &= ~DS_CONTEXTHELP;
        }
        return TRUE;
    }
    return TRUE;
}
```

<span data-ttu-id="469a8-272">Se a estrutura [**DLGTEMPLATEEX**](/windows/desktop/dlgbox/dlgtemplateex) não estiver definida, inclua a seguinte declaração:</span><span class="sxs-lookup"><span data-stu-id="469a8-272">If the [**DLGTEMPLATEEX**](/windows/desktop/dlgbox/dlgtemplateex) structure is not defined, include the following declaration:</span></span>

```cpp
#include <pshpack1.h>

typedef struct DLGTEMPLATEEX
{
    WORD dlgVer;
    WORD signature;
    DWORD helpID;
    DWORD exStyle;
    DWORD style;
    WORD cDlgItems;
    short x;
    short y;
    short cx;
    short cy;
} DLGTEMPLATEEX, *LPDLGTEMPLATEEX;

#include <poppack.h>
```

## <a name="ok-cancel-and-apply-buttons"></a><span data-ttu-id="469a8-273">Botões OK, cancelar e aplicar</span><span class="sxs-lookup"><span data-stu-id="469a8-273">OK, Cancel, and Apply Buttons</span></span>

<span data-ttu-id="469a8-274">Os botões **OK** e **aplicar** são semelhantes; ambas direcionam as páginas de uma folha de propriedades para validar e aplicar as alterações de propriedade feitas pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="469a8-274">The **OK** and **Apply** buttons are similar; both direct a property sheet's pages to validate and apply the property changes that the user has made.</span></span> <span data-ttu-id="469a8-275">A única diferença é que clicar no botão **OK** faz com que a folha de propriedades seja destruída após a aplicação das alterações.</span><span class="sxs-lookup"><span data-stu-id="469a8-275">The only difference is that clicking the **OK** button causes the property sheet to be destroyed after the changes are applied.</span></span>

<span data-ttu-id="469a8-276">Quando o usuário clica no botão **OK** ou **aplicar** , a folha de propriedades envia uma notificação [PSN \_ KILLACTIVE](psn-killactive.md) para a página ativa, dando a ela uma oportunidade de validar as alterações do usuário.</span><span class="sxs-lookup"><span data-stu-id="469a8-276">When the user clicks the **OK** or **Apply** button, the property sheet sends a [PSN\_KILLACTIVE](psn-killactive.md) notification to the active page, giving it an opportunity to validate the user's changes.</span></span> <span data-ttu-id="469a8-277">Se as alterações forem válidas, a página deverá chamar a função [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) com o valor **DWL \_ MSGRESULT** definido como **false**.</span><span class="sxs-lookup"><span data-stu-id="469a8-277">If the changes are valid, the page must call the [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) function with the **DWL\_MSGRESULT** value set to **FALSE**.</span></span> <span data-ttu-id="469a8-278">Se as alterações do usuário não forem válidas, a página deverá definir **DWL \_ MSGRESULT** como **true** e exibir uma caixa de diálogo informando o usuário do problema.</span><span class="sxs-lookup"><span data-stu-id="469a8-278">If the user's changes are not valid, the page must set **DWL\_MSGRESULT** to **TRUE** and display a dialog box informing the user of the problem.</span></span> <span data-ttu-id="469a8-279">A página permanece ativa até que ela defina **DWL \_ MSGRESULT** como **false** em resposta a uma \_ mensagem PSN KILLACTIVE.</span><span class="sxs-lookup"><span data-stu-id="469a8-279">The page remains active until it sets **DWL\_MSGRESULT** to **FALSE** in response to a PSN\_KILLACTIVE message.</span></span>

<span data-ttu-id="469a8-280">Depois que uma página responde a uma notificação [PSN \_ KILLACTIVE](psn-killactive.md) definindo **DWL \_ MSGRESULT** como **false**, a folha de propriedades enviará uma notificação de [PSN \_](psn-apply.md) para cada página.</span><span class="sxs-lookup"><span data-stu-id="469a8-280">After a page responds to a [PSN\_KILLACTIVE](psn-killactive.md) notification by setting **DWL\_MSGRESULT** to **FALSE**, the property sheet will send a [PSN\_APPLY](psn-apply.md) notification to each page.</span></span> <span data-ttu-id="469a8-281">Quando uma página recebe essa notificação, ela deve aplicar as novas propriedades ao item correspondente.</span><span class="sxs-lookup"><span data-stu-id="469a8-281">When a page receives this notification, it must apply the new properties to the corresponding item.</span></span> <span data-ttu-id="469a8-282">Para indicar à folha de propriedades que as alterações são válidas para a página, chame [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) com **DWL \_ MSGRESULT** definido como **PSNRET \_ NOERROR**.</span><span class="sxs-lookup"><span data-stu-id="469a8-282">To indicate to the property sheet that the changes are valid for the page, call [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) with **DWL\_MSGRESULT** set to **PSNRET\_NOERROR**.</span></span> <span data-ttu-id="469a8-283">Se as alterações forem inválidas para a página, retorne um erro.</span><span class="sxs-lookup"><span data-stu-id="469a8-283">If the changes are invalid for the page, return an error.</span></span> <span data-ttu-id="469a8-284">Isso impede que a folha de propriedades seja destruída e retorne o foco para a página que recebeu a \_ notificação de aplicação de PSN ou a página que tinha o foco quando o botão **aplicar** foi pressionado.</span><span class="sxs-lookup"><span data-stu-id="469a8-284">Doing so prevents the property sheet from being destroyed and returns focus to either the page that received the PSN\_APPLY notification or the page that had focus when the **Apply** button was pressed.</span></span> <span data-ttu-id="469a8-285">Para retornar um erro e indicar qual página receberá o foco, defina **DWL \_ MSGRESULT** como um dos valores a seguir.</span><span class="sxs-lookup"><span data-stu-id="469a8-285">To return an error, and indicate which page will receive focus, set **DWL\_MSGRESULT** to one of the following values.</span></span>

-   <span data-ttu-id="469a8-286">**PSNRET \_ INVÁLIDO**.</span><span class="sxs-lookup"><span data-stu-id="469a8-286">**PSNRET\_INVALID**.</span></span> <span data-ttu-id="469a8-287">A folha de propriedades não será destruída e o foco será retornado para esta página.</span><span class="sxs-lookup"><span data-stu-id="469a8-287">The property sheet will not be destroyed, and focus will be returned to this page.</span></span>
-   <span data-ttu-id="469a8-288">**PSNRET \_ \_NOCHANGEPAGE inválido**.</span><span class="sxs-lookup"><span data-stu-id="469a8-288">**PSNRET\_INVALID\_NOCHANGEPAGE**.</span></span> <span data-ttu-id="469a8-289">A folha de propriedades não será destruída e o foco será retornado para a página que tinha o foco quando o botão foi pressionado.</span><span class="sxs-lookup"><span data-stu-id="469a8-289">The property sheet will not be destroyed, and focus will be returned to the page that had focus when the button was pressed.</span></span>

<span data-ttu-id="469a8-290">Um aplicativo pode usar a mensagem de [**\_ aplicação de PSM**](psm-apply.md) para simular a seleção do botão **aplicar** .</span><span class="sxs-lookup"><span data-stu-id="469a8-290">An application can use the [**PSM\_APPLY**](psm-apply.md) message to simulate the selection of the **Apply** button.</span></span>

<span data-ttu-id="469a8-291">O botão **aplicar** inicialmente é desabilitado quando uma página se torna ativa, indicando que ainda não há nenhuma alteração de propriedade a ser aplicada.</span><span class="sxs-lookup"><span data-stu-id="469a8-291">The **Apply** button is initially disabled when a page becomes active, indicating that there are not yet any property changes to apply.</span></span> <span data-ttu-id="469a8-292">Quando a página recebe a entrada por meio de um de seus controles, indicando que o usuário editou uma propriedade, a página deve enviar a mensagem [**\_ alteração de PSM**](psm-changed.md) para a folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-292">When the page receives input through one of its controls indicating that the user has edited a property, the page must send the [**PSM\_CHANGED**](psm-changed.md) message to the property sheet.</span></span> <span data-ttu-id="469a8-293">A mensagem faz com que a folha de propriedades habilite o botão **aplicar** .</span><span class="sxs-lookup"><span data-stu-id="469a8-293">The message causes the property sheet to enable the **Apply** button.</span></span> <span data-ttu-id="469a8-294">Se o usuário clicar em seguida no botão **aplicar** ou **Cancelar** , a página deverá reinicializar seus controles e, em seguida, enviar a mensagem de [**PSM \_ inalterada**](psm-unchanged.md) para desabilitar novamente o botão **aplicar** .</span><span class="sxs-lookup"><span data-stu-id="469a8-294">If the user subsequently clicks the **Apply** or **Cancel** button, the page must reinitialize its controls and then send the [**PSM\_UNCHANGED**](psm-unchanged.md) message to again disable the **Apply** button.</span></span>

<span data-ttu-id="469a8-295">Às vezes, o botão **aplicar** faz com que uma página faça uma alteração em uma folha de propriedades, e a alteração não pode ser desfeita.</span><span class="sxs-lookup"><span data-stu-id="469a8-295">Sometimes the **Apply** button causes a page to make a change to a property sheet, and the change cannot be undone.</span></span> <span data-ttu-id="469a8-296">Quando isso acontece, a página deve enviar a mensagem de [**PSM \_ CANCELTOCLOSE**](psm-canceltoclose.md) para a folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-296">When this happens, the page must send the [**PSM\_CANCELTOCLOSE**](psm-canceltoclose.md) message to the property sheet.</span></span> <span data-ttu-id="469a8-297">A mensagem faz com que a folha de propriedades altere o texto do botão **OK** para "fechar", indicando que as alterações aplicadas não podem ser canceladas.</span><span class="sxs-lookup"><span data-stu-id="469a8-297">The message causes the property sheet to change the text of the **OK** button to "Close," indicating that the applied changes cannot be canceled.</span></span>

<span data-ttu-id="469a8-298">Às vezes, uma página faz uma alteração na configuração do sistema que requer que o Windows seja reiniciado ou o sistema seja reinicializado antes que a alteração entre em vigor.</span><span class="sxs-lookup"><span data-stu-id="469a8-298">Sometimes a page makes a change to the system configuration that requires Windows to be restarted or the system rebooted before the change can take effect.</span></span> <span data-ttu-id="469a8-299">Depois de fazer essa alteração, uma página deve enviar a mensagem [**PSM \_ RESTARTWINDOWS**](psm-restartwindows.md) ou [**PSM \_ REBOOTSYSTEM**](psm-rebootsystem.md) para a folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-299">After making such a change, a page must send either the [**PSM\_RESTARTWINDOWS**](psm-restartwindows.md) or [**PSM\_REBOOTSYSTEM**](psm-rebootsystem.md) message to the property sheet.</span></span> <span data-ttu-id="469a8-300">Essas mensagens fazem com que a função [**folha**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) retorne o valor da **ID \_ PSRESTARTWINDOWS** ou **ID \_ PSREBOOTSYSTEM** após a destruição da folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-300">These messages cause the [**PropertySheet**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) function to return the **ID\_PSRESTARTWINDOWS** or **ID\_PSREBOOTSYSTEM** value after the property sheet is destroyed.</span></span>

<span data-ttu-id="469a8-301">Quando um usuário clica no botão **Cancelar** , a folha de propriedades envia o código de notificação de [ \_ redefinição de PSN](psn-reset.md) para todas as páginas, indicando que a folha de propriedades está prestes a ser destruída.</span><span class="sxs-lookup"><span data-stu-id="469a8-301">When a user clicks the **Cancel** button, the property sheet sends the [PSN\_RESET](psn-reset.md) notification code to all pages, indicating that the property sheet is about to be destroyed.</span></span> <span data-ttu-id="469a8-302">Uma página deve usar a notificação para executar operações de limpeza.</span><span class="sxs-lookup"><span data-stu-id="469a8-302">A page must use the notification to perform cleanup operations.</span></span>

## <a name="wizards"></a><span data-ttu-id="469a8-303">Assistentes</span><span class="sxs-lookup"><span data-stu-id="469a8-303">Wizards</span></span>

<span data-ttu-id="469a8-304">Um assistente é um tipo especial de folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="469a8-304">A wizard is a special type of property sheet.</span></span> <span data-ttu-id="469a8-305">Os assistentes são projetados para apresentar as páginas uma de cada vez em uma sequência que é controlada pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="469a8-305">Wizards are designed to present pages one at a time in a sequence that is controlled by the application.</span></span> <span data-ttu-id="469a8-306">Em vez de selecionar um grupo de páginas clicando em uma guia, os usuários navegam para frente e para trás na sequência, uma página por vez clicando em botões.</span><span class="sxs-lookup"><span data-stu-id="469a8-306">Instead of selecting from a group of pages by clicking a tab, users navigate forward and backward through the sequence, one page at a time, by clicking buttons.</span></span> <span data-ttu-id="469a8-307">Por exemplo, a captura de tela a seguir mostra a página de boas-vindas do assistente para adicionar hardware:</span><span class="sxs-lookup"><span data-stu-id="469a8-307">For example, the following screen shot shows the welcome page from the Add Hardware wizard:</span></span>

![captura de tela da página inicial de um assistente](images/wizard97.png)

<span data-ttu-id="469a8-309">A captura de tela a seguir mostra a primeira página de um assistente Aero, o novo estilo introduzido no Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="469a8-309">The following screen shot shows the first page of an Aero Wizard, the new style introduced in Windows Vista.</span></span>

![captura de tela da primeira página de um assistente Aero](images/wizardaero.png)

<span data-ttu-id="469a8-311">Consulte [Criando assistentes](wizards.md) para uma discussão completa dos assistentes.</span><span class="sxs-lookup"><span data-stu-id="469a8-311">See [Creating Wizards](wizards.md) for a complete discussion of wizards.</span></span>
