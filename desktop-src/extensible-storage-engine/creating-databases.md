---
description: 'Saiba mais sobre: Criando bancos de dados'
title: Criando bancos de dados
TOCTitle: Creating Databases
ms:assetid: d221144d-f777-4f8a-80ca-2ebdb77108dc
ms:mtpsurl: https://msdn.microsoft.com/library/Gg294100(v=EXCHG.10)
ms:contentKeyID: 32765715
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: eac708b64837fc79fa8a5060df7deb93ec552e49
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105791437"
---
# <a name="creating-databases"></a><span data-ttu-id="38931-103">Criando bancos de dados</span><span class="sxs-lookup"><span data-stu-id="38931-103">Creating Databases</span></span>


<span data-ttu-id="38931-104">_**Aplica-se a:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="38931-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="creating-databases"></a><span data-ttu-id="38931-105">Criando bancos de dados</span><span class="sxs-lookup"><span data-stu-id="38931-105">Creating Databases</span></span>

<span data-ttu-id="38931-106">O banco de dados do ESE consiste em uma ou mais tabelas que organizam os dados por colunas e linhas.</span><span class="sxs-lookup"><span data-stu-id="38931-106">The ESE database comprises one or more tables that organize data by columns and rows.</span></span> <span data-ttu-id="38931-107">O banco de dados ESE é identificado por nome e ID do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="38931-107">The ESE database is identified by name and database ID.</span></span> <span data-ttu-id="38931-108">Um banco de dados ESE é semelhante a um único arquivo para o sistema operacional Microsoft Windows; no entanto, internamente, o banco de dados é armazenado como uma coleção de páginas.</span><span class="sxs-lookup"><span data-stu-id="38931-108">An ESE database looks like a single file to the Microsoft Windows operating system; however, internally the database is stored as a collection of pages.</span></span> <span data-ttu-id="38931-109">Essas páginas contêm metadados que descrevem os dados no banco de dados, os mesmos e um ou mais índices que armazenam diferentes ordens dos dados.</span><span class="sxs-lookup"><span data-stu-id="38931-109">These pages contain metadata that describe the data in the database, the data itself, and one or more indices that store different orders of the data.</span></span> <span data-ttu-id="38931-110">O banco de dados pode conter até 2 ^ 31 páginas ou 16 terabytes de dados para um banco de dado com 8 KB de páginas.</span><span class="sxs-lookup"><span data-stu-id="38931-110">The database may contain up to 2^31 pages, or 16 Terabytes of data for a database with 8 KB pages.</span></span>

<span data-ttu-id="38931-111">O aplicativo cria uma instância do mecanismo de banco de dados e, em seguida, cria um banco de dados e anexa-o à instância.</span><span class="sxs-lookup"><span data-stu-id="38931-111">The application creates an instance of the database engine, then creates a database and attaches it to the instance.</span></span> <span data-ttu-id="38931-112">Até 6 bancos de dados podem ser anexados simultaneamente a uma instância com [JetCreateDatabase](./jetcreatedatabase-function.md) ou [JetAttachDatabase](./jetattachdatabase-function.md).</span><span class="sxs-lookup"><span data-stu-id="38931-112">Up to 6 databases can be simultaneously attached to an instance with [JetCreateDatabase](./jetcreatedatabase-function.md) or [JetAttachDatabase](./jetattachdatabase-function.md).</span></span> <span data-ttu-id="38931-113">Uma ou mais sessões devem ser iniciadas no banco de dados, pois todas as operações do ESE subsequentes são executadas no contexto de uma sessão.</span><span class="sxs-lookup"><span data-stu-id="38931-113">One or more sessions should be started within the database, because all subsequent ESE operations are performed in the context of a session.</span></span> <span data-ttu-id="38931-114">Uma sessão separada deve ser aberta para cada thread usando o ESE.</span><span class="sxs-lookup"><span data-stu-id="38931-114">A separate session should be opened for each thread using ESE.</span></span>

<span data-ttu-id="38931-115">Este procedimento inicializará o ESE e criará um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="38931-115">This procedure will initialize ESE and create a database.</span></span>

### <a name="to-initialize-ese-and-create-a-database"></a><span data-ttu-id="38931-116">Para inicializar o ESE e criar um banco de dados</span><span class="sxs-lookup"><span data-stu-id="38931-116">To initialize ESE and create a database</span></span>

1.  <span data-ttu-id="38931-117">[JetCreateInstance](./jetcreateinstance-function.md): cria uma instância do mecanismo de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="38931-117">[JetCreateInstance](./jetcreateinstance-function.md): Creates an instance of the database engine.</span></span>
    
    <span data-ttu-id="38931-118">**Windows XP e posterior:** Essa função está disponível no Windows XP e versões posteriores.</span><span class="sxs-lookup"><span data-stu-id="38931-118">**Windows XP and later:** This function is available in Windows XP and later.</span></span> <span data-ttu-id="38931-119">No Windows 2000, há suporte apenas para uma instância e essa instância é criada implicitamente</span><span class="sxs-lookup"><span data-stu-id="38931-119">On Windows 2000, only one instance is supported and that instance is created implicitly</span></span>

2.  <span data-ttu-id="38931-120">[JetSetSystemParameter](./jetsetsystemparameter-function.md): os parâmetros do sistema que afetam o layout físico, como o JET_paramLogFilePath e JET_paramSystemPath devem ser definidos antes de inicializar a instância com [JetInit](./jetinit-function.md).</span><span class="sxs-lookup"><span data-stu-id="38931-120">[JetSetSystemParameter](./jetsetsystemparameter-function.md): System parameters that the affect the physical layout such as the JET_paramLogFilePath and JET_paramSystemPath must be set before initializing the instance with [JetInit](./jetinit-function.md).</span></span> <span data-ttu-id="38931-121">Os parâmetros definidos neste estágio são definidos para todos os bancos de dados criados na instância.</span><span class="sxs-lookup"><span data-stu-id="38931-121">The parameters set at this stage are set for all databases created in the instance.</span></span> <span data-ttu-id="38931-122">[JetSetSystemParameter](./jetsetsystemparameter-function.md) é a única função que pode usar a instância antes de ser inicializada com [JetInit](./jetinit-function.md).</span><span class="sxs-lookup"><span data-stu-id="38931-122">[JetSetSystemParameter](./jetsetsystemparameter-function.md) is the only function that can use the instance before it is initialized with [JetInit](./jetinit-function.md).</span></span>

3.  <span data-ttu-id="38931-123">[JetInit](./jetinit-function.md): Inicializa a instância.</span><span class="sxs-lookup"><span data-stu-id="38931-123">[JetInit](./jetinit-function.md): Initializes the instance.</span></span> <span data-ttu-id="38931-124">A instância deve ser inicializada com [JetInit](./jetinit-function.md) antes que possa ser usada com outras funções.</span><span class="sxs-lookup"><span data-stu-id="38931-124">Instance must be initialized with [JetInit](./jetinit-function.md) before it can be used with any other functions.</span></span>

4.  <span data-ttu-id="38931-125">[JetBeginSession](./jetbeginsession-function.md): cria a sessão para todas as transações subsequentes.</span><span class="sxs-lookup"><span data-stu-id="38931-125">[JetBeginSession](./jetbeginsession-function.md): Creates the session for all subsequent transactions.</span></span> <span data-ttu-id="38931-126">Todas as transações de banco de dados ocorrem no contexto da sessão ([JET_SESID](./jet-sesid.md)).</span><span class="sxs-lookup"><span data-stu-id="38931-126">All database transactions take place in the context of the session ([JET_SESID](./jet-sesid.md)).</span></span>

5.  <span data-ttu-id="38931-127">[JetCreateDatabase](./jetcreatedatabase-function.md): cria o banco de dados e retorna um identificador para a ID do banco de dados ([JET_DBID](./jet-dbid.md)).</span><span class="sxs-lookup"><span data-stu-id="38931-127">[JetCreateDatabase](./jetcreatedatabase-function.md): Creates the database and returns a handle to the database ID ([JET_DBID](./jet-dbid.md)).</span></span>
    
    <span data-ttu-id="38931-128">Se o banco de dados já existir, a etapa 5 acima será substituída pelas duas etapas a seguir:</span><span class="sxs-lookup"><span data-stu-id="38931-128">If the database already exists, step 5 above is replaced by the following two steps:</span></span>
    
    1.  <span data-ttu-id="38931-129">[JetAttachDatabase](./jetattachdatabase-function.md): anexa o banco de dados pelo nome à sessão</span><span class="sxs-lookup"><span data-stu-id="38931-129">[JetAttachDatabase](./jetattachdatabase-function.md): Attaches the database by name to the session</span></span>
    
    2.  <span data-ttu-id="38931-130">[JetOpenDatabase](./jetopendatabase-function.md): retorna a ID do banco de dados que é usada em operações de banco de dados subsequentes.</span><span class="sxs-lookup"><span data-stu-id="38931-130">[JetOpenDatabase](./jetopendatabase-function.md): Returns the database ID that is used in subsequent database operations.</span></span>

<span data-ttu-id="38931-131">Um banco de dados pode ser desanexado de uma instância do ESE usando [JetDetachDatabase](./jetdetachdatabase-function.md) e posterior anexado a outra instância com [JetAttachDatabase](./jetattachdatabase-function.md).</span><span class="sxs-lookup"><span data-stu-id="38931-131">A database can be detached from one ESE instance using [JetDetachDatabase](./jetdetachdatabase-function.md) and later attached to another instance with [JetAttachDatabase](./jetattachdatabase-function.md).</span></span> <span data-ttu-id="38931-132">Quando o banco de dados é desanexado, ele pode ser copiado como um único arquivo usando utilitários padrão do Windows.</span><span class="sxs-lookup"><span data-stu-id="38931-132">When the database is detached, it can be copied as a single file using standard Windows utilities.</span></span> <span data-ttu-id="38931-133">No entanto, quando o banco de dados é anexado a uma instância ESE, ele não pode ser copiado porque o ESE abre exclusivamente os arquivos de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="38931-133">However, when the database is attached to an ESE instance it cannot be copied since ESE opens database files exclusively.</span></span> <span data-ttu-id="38931-134">Além disso, se a instância falhar, o arquivo de banco de dados não poderá ser copiado sozinho porque precisa que os arquivos de log de transações associados a ele se recuperem dessa falha.</span><span class="sxs-lookup"><span data-stu-id="38931-134">Also, if the instance crashes then the database file cannot be copied alone because it needs the transaction log files associated with it to recover from that crash.</span></span>
