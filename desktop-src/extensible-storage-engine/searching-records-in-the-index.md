---
description: 'Saiba mais sobre: pesquisa de registros no índice'
title: Pesquisando registros no índice
TOCTitle: Searching Records in the Index
ms:assetid: 9141b1d6-81b6-49ad-a5d4-2409fe0d511a
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269342(v=EXCHG.10)
ms:contentKeyID: 32765631
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: 89a4ffe1f1c13280f236442ae218580fa5699741
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105789479"
---
# <a name="searching-records-in-the-index"></a><span data-ttu-id="e4833-103">Pesquisando registros no índice</span><span class="sxs-lookup"><span data-stu-id="e4833-103">Searching Records in the Index</span></span>


<span data-ttu-id="e4833-104">_**Aplica-se a:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="e4833-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="searching-records-in-the-index"></a><span data-ttu-id="e4833-105">Pesquisando registros no índice</span><span class="sxs-lookup"><span data-stu-id="e4833-105">Searching Records in the Index</span></span>

<span data-ttu-id="e4833-106">As chaves de pesquisa são criadas para pesquisar uma única entrada ou um conjunto de entradas em um índice.</span><span class="sxs-lookup"><span data-stu-id="e4833-106">Search keys are created to search for a single entry or a set of entries in an index.</span></span> <span data-ttu-id="e4833-107">As chaves de pesquisa só podem ser construídas para as colunas de chave no índice e podem conter um ou mais valores de coluna.</span><span class="sxs-lookup"><span data-stu-id="e4833-107">Search keys may only be constructed for the key columns in the index, and may contain one or more column values.</span></span> <span data-ttu-id="e4833-108">A chave de pesquisa é construída com uma única chamada ou uma série de chamadas para [JetMakeKey](./jetmakekey-function.md)e pode ser recuperada com [JetRetrieveKey](./jetretrievekey-function.md) usando JET_bitRetrieveCopy.</span><span class="sxs-lookup"><span data-stu-id="e4833-108">The search key is constructed with a single call or a series of calls to [JetMakeKey](./jetmakekey-function.md), and may be retrieved with [JetRetrieveKey](./jetretrievekey-function.md) using JET_bitRetrieveCopy.</span></span> <span data-ttu-id="e4833-109">Depois que a chave de pesquisa é construída, ela pode ser usada para mover o cursor para o registro no índice.</span><span class="sxs-lookup"><span data-stu-id="e4833-109">After the search key is constructed it can be used to move the cursor to the record in the index.</span></span>

<span data-ttu-id="e4833-110">Há três métodos de localizar registros em uma tabela:</span><span class="sxs-lookup"><span data-stu-id="e4833-110">There are three methods of finding records in a table:</span></span>

1.  <span data-ttu-id="e4833-111">Procure uma única entrada de índice.</span><span class="sxs-lookup"><span data-stu-id="e4833-111">Search for a single index entry.</span></span> <span data-ttu-id="e4833-112">Para fazer isso, crie a chave de pesquisa com [JetMakeKey](./jetmakekey-function.md)e, em seguida, mova para esse registro com [JetSeek](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="e4833-112">To do this, create the search key with [JetMakeKey](./jetmakekey-function.md), and then move to that record with [JetSeek](./jetseek-function.md).</span></span>

2.  <span data-ttu-id="e4833-113">Pesquise o índice registro por registro.</span><span class="sxs-lookup"><span data-stu-id="e4833-113">Search the index record-by-record.</span></span> <span data-ttu-id="e4833-114">Os registros podem ser atravessados em um registro por vez, chamando [JetMove](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="e4833-114">Records can be traversed one record at a time by calling [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="e4833-115">O cursor pode ser movido para o primeiro registro no índice, especificando JET_MoveFirst no parâmetro de *galinha* de [JetMove](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="e4833-115">The cursor can be moved to the first record in the index by specifying JET_MoveFirst in the *cRow* parameter of [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="e4833-116">Da mesma forma, o cursor pode ser movido para frente, para trás ou para a última entrada no índice.</span><span class="sxs-lookup"><span data-stu-id="e4833-116">In the same way, the cursor can be moved forward, backward, or to the last entry in the index.</span></span>

3.  <span data-ttu-id="e4833-117">Pesquisar em um conjunto de registros.</span><span class="sxs-lookup"><span data-stu-id="e4833-117">Search through a set of records.</span></span> <span data-ttu-id="e4833-118">Para fazer isso, defina um intervalo de entradas de índice a serem pesquisadas e, em seguida, mova os registros sequencialmente.</span><span class="sxs-lookup"><span data-stu-id="e4833-118">To do this, set a range of index entries to search, then move through the records sequentially.</span></span> <span data-ttu-id="e4833-119">Para obter mais informações, consulte [pesquisando um conjunto de registros]() seção deste tópico.</span><span class="sxs-lookup"><span data-stu-id="e4833-119">For more information, see [Searching Through a Set of Records]() section of this topic.</span></span>

### <a name="searching-through-a-set-of-records"></a><span data-ttu-id="e4833-120">Pesquisando um conjunto de registros</span><span class="sxs-lookup"><span data-stu-id="e4833-120">Searching Through a Set of Records</span></span>

<span data-ttu-id="e4833-121">O diagrama aqui mostra o cursor passando por um intervalo de entradas de índice definidas por chamadas para [JetSeek](./jetseek-function.md) e [JetSetIndexRange](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="e4833-121">The diagram here shows the cursor moving through a range of index entries defined by calls to [JetSeek](./jetseek-function.md) and [JetSetIndexRange](./jetsetindexrange-function.md).</span></span>

<span data-ttu-id="e4833-122">Use o procedimento a seguir para pesquisar em um conjunto de registros em um índice.</span><span class="sxs-lookup"><span data-stu-id="e4833-122">Use the following procedure to search through a set of records in an index.</span></span>

### <a name="to-search-a-set-of-records-in-an-index"></a><span data-ttu-id="e4833-123">Para pesquisar um conjunto de registros em um índice</span><span class="sxs-lookup"><span data-stu-id="e4833-123">To search a set of records in an index</span></span>

1.  <span data-ttu-id="e4833-124">Crie a chave de pesquisa para o primeiro registro no conjunto de registros a ser pesquisado com [JetMakeKey](./jetmakekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="e4833-124">Create the search key for the first record in the set of records to be searched with [JetMakeKey](./jetmakekey-function.md).</span></span>

2.  <span data-ttu-id="e4833-125">Mova o cursor para o registro indicado na chave de pesquisa com [JetSeek](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="e4833-125">Move the cursor to the record indicated in the search key with [JetSeek](./jetseek-function.md).</span></span>

3.  <span data-ttu-id="e4833-126">Crie outra chave de pesquisa para a última entrada de índice no intervalo com [JetMakeKey](./jetmakekey-function.md).</span><span class="sxs-lookup"><span data-stu-id="e4833-126">Create another search key for the last index entry in the range with [JetMakeKey](./jetmakekey-function.md).</span></span>

4.  <span data-ttu-id="e4833-127">Defina o intervalo de índice com [JetSetIndexRange](./jetsetindexrange-function.md) usando a chave criada na etapa 3.</span><span class="sxs-lookup"><span data-stu-id="e4833-127">Set the index range with [JetSetIndexRange](./jetsetindexrange-function.md) using the key created in step 3.</span></span>

5.  <span data-ttu-id="e4833-128">Chame [JetMove](./jetmove-function.md) para mover sequencialmente por cada registro no intervalo de índice, conforme mostrado no diagrama a seguir.</span><span class="sxs-lookup"><span data-stu-id="e4833-128">Call [JetMove](./jetmove-function.md) to move sequentially through each record in the index range as shown in the following diagram.</span></span>

<span data-ttu-id="e4833-129">![ESE_Documentation_IndexRange](images/Gg269342.ESE_Documentation_IndexRange(EXCHG.10).gif "ESE_Documentation_IndexRange")</span><span class="sxs-lookup"><span data-stu-id="e4833-129">![ESE_Documentation_IndexRange](images/Gg269342.ESE_Documentation_IndexRange(EXCHG.10).gif "ESE_Documentation_IndexRange")</span></span>

<span data-ttu-id="e4833-130">O cursor no diagrama aqui só pode percorrer o intervalo de índices definido na chamada para [JetSetIndexRange](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="e4833-130">The cursor in the diagram here may only move through the range of indices set in the call to [JetSetIndexRange](./jetsetindexrange-function.md).</span></span> <span data-ttu-id="e4833-131">Se o aplicativo tentar mover o cursor além do intervalo de índice, o ESE retornará um erro Jet_errNoCurrentRecord da chamada para [JetMove](./jetmove-function.md).</span><span class="sxs-lookup"><span data-stu-id="e4833-131">If the application attempts to move the cursor beyond the index range, ESE returns a Jet_errNoCurrentRecord error from the call to [JetMove](./jetmove-function.md).</span></span> <span data-ttu-id="e4833-132">Observe que qualquer tipo de navegação com esse cursor diferente de mover para o registro seguinte ou anterior cancelará o intervalo de índice.</span><span class="sxs-lookup"><span data-stu-id="e4833-132">Note that any type of navigation with this cursor other than moving to the next or previous record will cancel the index range.</span></span> <span data-ttu-id="e4833-133">Consulte [JetSetIndexRange](./jetsetindexrange-function.md) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="e4833-133">See [JetSetIndexRange](./jetsetindexrange-function.md) for more information.</span></span>

<span data-ttu-id="e4833-134">O tipo de dados inserido no parâmetro *pvData* para [JetMakeKey](./jetmakekey-function.md) deve corresponder ao tipo de dados e às propriedades especificadas para a coluna.</span><span class="sxs-lookup"><span data-stu-id="e4833-134">The type of data entered in the *pvData* parameter for [JetMakeKey](./jetmakekey-function.md) must match the type of data and properties specified for the column.</span></span> <span data-ttu-id="e4833-135">Por exemplo, chamar [JetMakeKey](./jetmakekey-function.md) com "Ben Miller" especificado no parâmetro *pvData* para um tipo de coluna JET_coltypText é uma correspondência de tipo de dados válida.</span><span class="sxs-lookup"><span data-stu-id="e4833-135">For example, calling [JetMakeKey](./jetmakekey-function.md) with "Ben Miller" specified in the *pvData* parameter for a column type JET_coltypText is a valid data type match.</span></span> <span data-ttu-id="e4833-136">Se você quiser criar uma chave de pesquisa para pesquisar entre os nomes "Ben Miller" e "Max Stevens" em um índice, mova o cursor para o registro com o nome "Ben Miller" chamando [JetSeek](./jetseek-function.md).</span><span class="sxs-lookup"><span data-stu-id="e4833-136">If you want to create a search key to search between the names "Ben Miller" and "Max Stevens" in an index, move the cursor to the record with the name "Ben Miller" by calling [JetSeek](./jetseek-function.md).</span></span> <span data-ttu-id="e4833-137">Chame [JetMakeKey](./jetmakekey-function.md) uma segunda vez e especifique um ponteiro para uma cadeia de caracteres que contenha o nome "Max Stevens".</span><span class="sxs-lookup"><span data-stu-id="e4833-137">Call [JetMakeKey](./jetmakekey-function.md) a second time and specify a pointer to a string containing the name "Max Stevens".</span></span> <span data-ttu-id="e4833-138">O intervalo de índice é definido para limitar o cursor a ser movido entre os nomes "Ben Miller" e "Max Stevens" na chamada para [JetSetIndexRange](./jetsetindexrange-function.md).</span><span class="sxs-lookup"><span data-stu-id="e4833-138">The index range is set to limit the cursor to move between the names "Ben Miller" and "Max Stevens" in the call to [JetSetIndexRange](./jetsetindexrange-function.md).</span></span>
