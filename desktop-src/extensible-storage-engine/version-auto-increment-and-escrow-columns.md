---
description: 'Saiba mais sobre: versões, incremento automático e colunas de caução'
title: Colunas de versão, incremento automático e caução
TOCTitle: Version, Auto-Increment and Escrow Columns
ms:assetid: b12724a4-6846-49a7-9223-43895f91427e
ms:mtpsurl: https://msdn.microsoft.com/library/Gg294059(v=EXCHG.10)
ms:contentKeyID: 32765674
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: e5966990a51e87b90946416161e20d677116f8c1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105765024"
---
# <a name="version-auto-increment-and-escrow-columns"></a><span data-ttu-id="cf5e1-103">Colunas de versão, incremento automático e caução</span><span class="sxs-lookup"><span data-stu-id="cf5e1-103">Version, Auto-Increment and Escrow Columns</span></span>


<span data-ttu-id="cf5e1-104">_**Aplica-se a:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="cf5e1-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="version-auto-increment-and-escrow-columns"></a><span data-ttu-id="cf5e1-105">Colunas de versão, incremento automático e caução</span><span class="sxs-lookup"><span data-stu-id="cf5e1-105">Version, Auto-Increment and Escrow Columns</span></span>

<span data-ttu-id="cf5e1-106">O ESE fornece tipos de coluna de atualização de versão, incremento automático e caução que têm capacidades especiais.</span><span class="sxs-lookup"><span data-stu-id="cf5e1-106">ESE provides version, auto-increment, and escrow update column types that have special abilities.</span></span> <span data-ttu-id="cf5e1-107">As opções de coluna definidas no membro **grbit** da estrutura [JET_COLUMNDEF](./jet-columndef-structure.md) usada na chamada para [JetAddColumn](./jetaddcolumn-function.md) indicam se a coluna é um dos tipos especializados indicados aqui.</span><span class="sxs-lookup"><span data-stu-id="cf5e1-107">The column options set in the **grbit** member of the [JET_COLUMNDEF](./jet-columndef-structure.md) structure used in the call to [JetAddColumn](./jetaddcolumn-function.md) indicate whether the column is one of the specialized types noted here.</span></span>

### <a name="version-jet_bitcolumnversion"></a><span data-ttu-id="cf5e1-108">Versão (JET_bitColumnVersion)</span><span class="sxs-lookup"><span data-stu-id="cf5e1-108">Version (JET_bitColumnVersion)</span></span>

<span data-ttu-id="cf5e1-109">A opção de coluna Version, aplicada somente a JET_coltypLong colunas, indica que a coluna contém informações de versão sobre o registro que podem ser usadas para determinar se uma cópia na memória de um determinado registro precisa ser atualizada.</span><span class="sxs-lookup"><span data-stu-id="cf5e1-109">The version column option, applied only to JET_coltypLong columns, indicates that the column contains version information about the record that can be used to determine if an in-memory copy of a given record needs to be refreshed.</span></span> <span data-ttu-id="cf5e1-110">As colunas de versão são incrementadas automaticamente pelo ESE quando a coluna é modificada pelo aplicativo por meio de [JetUpdate](./jetupdate-function.md).</span><span class="sxs-lookup"><span data-stu-id="cf5e1-110">Version columns are automatically incremented by ESE when the column is modified by the application via [JetUpdate](./jetupdate-function.md).</span></span>

### <a name="auto-increment-jet_bitcolumnautoincrement"></a><span data-ttu-id="cf5e1-111">Incremento automático (JET_bitColumnAutoincrement)</span><span class="sxs-lookup"><span data-stu-id="cf5e1-111">Auto-Increment (JET_bitColumnAutoincrement)</span></span>

<span data-ttu-id="cf5e1-112">As colunas de incremento automático são incrementadas automaticamente pelo ESE quando um novo registro é inserido na tabela.</span><span class="sxs-lookup"><span data-stu-id="cf5e1-112">Auto increment columns are automatically incremented by ESE when a new record is inserted into the table.</span></span> <span data-ttu-id="cf5e1-113">O valor contido na coluna de incremento automático é exclusivo para cada registro na tabela e não é garantido que seja contínuo.</span><span class="sxs-lookup"><span data-stu-id="cf5e1-113">The value contained in the auto-increment column is unique for every record in the table and is not guaranteed to be continuous.</span></span> <span data-ttu-id="cf5e1-114">Esses valores não são reciclados, mas podem ser reutilizados em determinados casos.</span><span class="sxs-lookup"><span data-stu-id="cf5e1-114">These values are not recycled, but can be reused in certain cases.</span></span> <span data-ttu-id="cf5e1-115">Somente colunas do tipo JET_coltypLong e JET_coltypLongLong podem ser colunas de incremento automático.</span><span class="sxs-lookup"><span data-stu-id="cf5e1-115">Only columns of type JET_coltypLong and JET_coltypLongLong may be auto increment columns.</span></span>

### <a name="escrow-jet_bitcolumnescrowupdate"></a><span data-ttu-id="cf5e1-116">Caução (JET_bitColumnEscrowUpdate)</span><span class="sxs-lookup"><span data-stu-id="cf5e1-116">Escrow (JET_bitColumnEscrowUpdate)</span></span>

<span data-ttu-id="cf5e1-117">Colunas de caução podem ser modificadas na chamada para [JetEscrowUpdate](./jetescrowupdate-function.md).</span><span class="sxs-lookup"><span data-stu-id="cf5e1-117">Escrow columns can be modified in the call to [JetEscrowUpdate](./jetescrowupdate-function.md).</span></span> <span data-ttu-id="cf5e1-118">As atualizações na caução são operações Delta numéricas que não sofrem com conflitos de gravação.</span><span class="sxs-lookup"><span data-stu-id="cf5e1-118">Updates in escrow are numeric delta operations that do not suffer from write conflicts.</span></span> <span data-ttu-id="cf5e1-119">Isso significa que qualquer número de sessões pode atualizar simultaneamente uma coluna de caução em um registro por meio de [JetEscrowUpdate](./jetescrowupdate-function.md) sem conflitos.</span><span class="sxs-lookup"><span data-stu-id="cf5e1-119">What this means is that any number of sessions can concurrently update an escrow column in a record via [JetEscrowUpdate](./jetescrowupdate-function.md) without conflicts.</span></span> <span data-ttu-id="cf5e1-120">Observe que qualquer outra operação de atualização ainda pode resultar em um conflito de gravação com uma operação de atualização de caução.</span><span class="sxs-lookup"><span data-stu-id="cf5e1-120">Note that any other update operation may still result in a write conflict with an escrow update operation.</span></span> <span data-ttu-id="cf5e1-121">As atualizações de caução só podem ser feitas em colunas do tipo JET_coltypLong que têm um valor padrão.</span><span class="sxs-lookup"><span data-stu-id="cf5e1-121">Escrow updates can only be made to columns of type JET_coltypLong that have a default value.</span></span> <span data-ttu-id="cf5e1-122">Essas colunas também devem ser adicionadas a uma tabela antes de serem carregadas com linhas.</span><span class="sxs-lookup"><span data-stu-id="cf5e1-122">These columns must also be added to a table before it is loaded with rows.</span></span> <span data-ttu-id="cf5e1-123">Finalmente, as linhas que contêm uma coluna de atualização de caução podem ser configuradas para dar suporte a um retorno de chamada de finalização de linha (JET_bitColumnFinalize) ou para serem excluídas automaticamente se a contagem de referência chegar a zero (JET_bitColumnDeleteOnZero).</span><span class="sxs-lookup"><span data-stu-id="cf5e1-123">Finally, rows containing an escrow update column may be configured to support a row finalization callback (JET_bitColumnFinalize) or to be automatically deleted if the ref count reaches zero (JET_bitColumnDeleteOnZero).</span></span> <span data-ttu-id="cf5e1-124">Para obter mais informações, consulte a estrutura de [JET_COLUMNDEF](./jet-columndef-structure.md) .</span><span class="sxs-lookup"><span data-stu-id="cf5e1-124">For more information, see the [JET_COLUMNDEF](./jet-columndef-structure.md) structure.</span></span>
