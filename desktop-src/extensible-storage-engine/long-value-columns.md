---
description: 'Saiba mais sobre: colunas de valor longo'
title: Colunas de valor longo
TOCTitle: Long Value Columns
ms:assetid: 0690f9d3-1a58-4e53-92e1-213630fc88f4
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269179(v=EXCHG.10)
ms:contentKeyID: 32765482
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: bb5618227d49de9e246adf69868a3cb2dc498dca
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104010396"
---
# <a name="long-value-columns"></a><span data-ttu-id="8ee62-103">Colunas de valor longo</span><span class="sxs-lookup"><span data-stu-id="8ee62-103">Long Value Columns</span></span>


<span data-ttu-id="8ee62-104">_**Aplica-se a:** Windows | Windows Server_</span><span class="sxs-lookup"><span data-stu-id="8ee62-104">_**Applies to:** Windows | Windows Server_</span></span>

## <a name="long-value-columns"></a><span data-ttu-id="8ee62-105">Colunas de valor longo</span><span class="sxs-lookup"><span data-stu-id="8ee62-105">Long Value Columns</span></span>

<span data-ttu-id="8ee62-106">Os tipos de coluna ESE JET_coltypLongText e JET_coltypLongBinary são chamados de tipos de coluna de valor longo.</span><span class="sxs-lookup"><span data-stu-id="8ee62-106">The ESE column types JET_coltypLongText and JET_coltypLongBinary are called long value column types.</span></span> <span data-ttu-id="8ee62-107">Essas colunas são grandes cadeias de caracteres e objetos binários grandes que podem ser armazenados em árvores B + separadas fora do índice primário.</span><span class="sxs-lookup"><span data-stu-id="8ee62-107">These columns are large string and large binary objects that may be stored in separate B+ trees away from the primary index.</span></span> <span data-ttu-id="8ee62-108">Quando valores longos são armazenados separados do registro primário, eles são internamente inseridos em uma ID de valor longo (tampa) e em um deslocamento de bytes e acessados como um fluxo.</span><span class="sxs-lookup"><span data-stu-id="8ee62-108">When long values are stored separate from the primary record, they are internally keyed on a long value ID (LID) and byte offset and accessed as a stream.</span></span> <span data-ttu-id="8ee62-109">Colunas de valor longo são adicionadas à tabela na chamada de [JetAddColumn](./jetaddcolumn-function.md) com o membro **coltyp** da estrutura de [JET_COLUMNDEF](./jet-columndef-structure.md) definida como JET_coltypLongText ou JET_coltypLongBinary.</span><span class="sxs-lookup"><span data-stu-id="8ee62-109">Long value columns are added to the table in the call to [JetAddColumn](./jetaddcolumn-function.md) with the **coltyp** member of the [JET_COLUMNDEF](./jet-columndef-structure.md) structure set to either JET_coltypLongText or JET_coltypLongBinary.</span></span> <span data-ttu-id="8ee62-110">O tamanho máximo de um valor longo ou de coluna binária longa é 2 GB-1.</span><span class="sxs-lookup"><span data-stu-id="8ee62-110">The maximum size of a Long Text or Long Binary column value is 2 GB -1.</span></span>

<span data-ttu-id="8ee62-111">O ESE dá suporte a operações de acréscimo, substituição de intervalo de bytes e definição de tamanho para colunas de valor longo para dar suporte a implementações de fluxo eficientes nesses tipos de coluna.</span><span class="sxs-lookup"><span data-stu-id="8ee62-111">ESE supports append, byte range overwrite, and set size operations for long value columns to support efficient stream implementations on these column types.</span></span> <span data-ttu-id="8ee62-112">Por padrão, os dados de valor longo são armazenados em uma árvore B + separada se ele for maior que 1024 bytes ou se o registro não couber em uma única página de banco de dados quando o valor longo for armazenado no registro.</span><span class="sxs-lookup"><span data-stu-id="8ee62-112">By default, long value data is stored in a separate B+ tree if it is larger than 1024 bytes, or if the record does not fit on a single database page when the long value data is stored in the record.</span></span> <span data-ttu-id="8ee62-113">O aplicativo tem a opção de substituir o comportamento padrão definindo opções para armazenar dados de valor longo no registro (JET_bitSetIntrinsicLV) ou forçá-los a serem armazenados na árvore B + separada (JET_bitSetIntrinsicLV).</span><span class="sxs-lookup"><span data-stu-id="8ee62-113">The application has the option to override the default behavior by setting options to store long value data in the record (JET_bitSetIntrinsicLV) or to force them to be stored in the separate B+ tree (JET_bitSetIntrinsicLV).</span></span> <span data-ttu-id="8ee62-114">Esses valores são definidos no parâmetro *grbit* em [JetSetColumn](./jetsetcolumn-function.md), ou o membro **grbit** [JET_SETCOLUMN](./jet-setcolumn-structure.md) usado na chamada para [JetSetColumns](./jetsetcolumns-function.md) da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="8ee62-114">These values are set in the *grbit* parameter in [JetSetColumn](./jetsetcolumn-function.md), or the **grbit** member [JET_SETCOLUMN](./jet-setcolumn-structure.md) used in the call to [JetSetColumns](./jetsetcolumns-function.md) as follows:</span></span>

  - <span data-ttu-id="8ee62-115">Acrescentar: (JET_bitSetAppendLV)</span><span class="sxs-lookup"><span data-stu-id="8ee62-115">Append: (JET_bitSetAppendLV)</span></span>

  - <span data-ttu-id="8ee62-116">Substituição de intervalo de bytes: (JET_bitSetOverwriteLV)</span><span class="sxs-lookup"><span data-stu-id="8ee62-116">Byte Range Overwrite: (JET_bitSetOverwriteLV)</span></span>

  - <span data-ttu-id="8ee62-117">Definir tamanho: (JET_bitSetSizeLV)</span><span class="sxs-lookup"><span data-stu-id="8ee62-117">Set Size: (JET_bitSetSizeLV)</span></span>

  - <span data-ttu-id="8ee62-118">Forçar separado: (JET_bitSetSeparateLV)</span><span class="sxs-lookup"><span data-stu-id="8ee62-118">Force Separate: (JET_bitSetSeparateLV)</span></span>

  - <span data-ttu-id="8ee62-119">Armazenar no registro: (JET_bitSetIntrinsicLV)</span><span class="sxs-lookup"><span data-stu-id="8ee62-119">Store In Record: (JET_bitSetIntrinsicLV)</span></span>

<span data-ttu-id="8ee62-120">Os dados de valor longo são definidos indicando o deslocamento no blob de valor longo e o comprimento dos dados de valor longo no BLOB.</span><span class="sxs-lookup"><span data-stu-id="8ee62-120">The long value data is set by indicating the offset into the long value blob, and the length of the long value data in the blob.</span></span> <span data-ttu-id="8ee62-121">O deslocamento para o blob de valor longo é definido no membro **ibLongValue** da estrutura de [JET_SETINFO](./jet-setinfo-structure.md) (para [JetSetColumn](./jetsetcolumn-function.md)) ou no membro **IbLongValue** da estrutura de [JET_SETCOLUMN](./jet-setcolumn-structure.md) (para [JetSetColumns](./jetsetcolumns-function.md)).</span><span class="sxs-lookup"><span data-stu-id="8ee62-121">The offset to the long value blob is set in the **ibLongValue** member of [JET_SETINFO](./jet-setinfo-structure.md) structure (for [JetSetColumn](./jetsetcolumn-function.md)) or the **ibLongValue** member of the [JET_SETCOLUMN](./jet-setcolumn-structure.md) structure (for [JetSetColumns](./jetsetcolumns-function.md)).</span></span> <span data-ttu-id="8ee62-122">O membro **pvData** de [JET_SETCOLUMN](./jet-setcolumn-structure.md)e o parâmetro *pvData* na chamada para [JetSetColumn](./jetsetcolumn-function.md) contém os dados de valor longo.</span><span class="sxs-lookup"><span data-stu-id="8ee62-122">The **pvData** member of [JET_SETCOLUMN](./jet-setcolumn-structure.md), and *pvData* parameter in the call to [JetSetColumn](./jetsetcolumn-function.md) contains the long value data.</span></span> <span data-ttu-id="8ee62-123">As atualizações para colunas de valor longo devem ser executadas dentro de uma transação.</span><span class="sxs-lookup"><span data-stu-id="8ee62-123">Updates to long value columns must be performed inside a transaction.</span></span>

<span data-ttu-id="8ee62-124">Os dados de valor longo sempre são armazenados em uma tabela separada quando o aplicativo define o JET_bitSetSeparateLV ou o JET_bitSetIntrinsicLV, caso contrário, ele é uma decisão heurística.</span><span class="sxs-lookup"><span data-stu-id="8ee62-124">The long value data is always stored in a separate table is when the application sets the JET_bitSetSeparateLV or JET_bitSetIntrinsicLV, otherwise it is heuristically decided.</span></span> <span data-ttu-id="8ee62-125">O ESE armazena o valor longo separado se for maior que 1024 bytes ou se o registro não couber em uma única página de banco de dados, se estiver armazenado em registro.</span><span class="sxs-lookup"><span data-stu-id="8ee62-125">ESE stores the long value separated if it is larger than 1024 bytes or if the record would not fit on a single database page if stored in record.</span></span>

<span data-ttu-id="8ee62-126">O diagrama a seguir mostra os dados de valor longo armazenados em uma tabela separada.</span><span class="sxs-lookup"><span data-stu-id="8ee62-126">The following diagram shows the long value data stored in separate table.</span></span> <span data-ttu-id="8ee62-127">Quando um valor longo é armazenado fora do registro, uma nova ID de valor longo é criada para se referir ao seu valor.</span><span class="sxs-lookup"><span data-stu-id="8ee62-127">When a long value is stored outside the record, a new long valued ID is created to refer to its value.</span></span> <span data-ttu-id="8ee62-128">Isso permite que vários registros façam referência ao mesmo valor de coluna.</span><span class="sxs-lookup"><span data-stu-id="8ee62-128">This allows multiple records to refer to the same column value.</span></span> <span data-ttu-id="8ee62-129">As contagens de referência para os dados serão aumentadas se mais de um registro nos dados apontar para os mesmos dados de valor longo.</span><span class="sxs-lookup"><span data-stu-id="8ee62-129">Reference counts to the data are increased if more than one record in the data points to the same long value data.</span></span>

<span data-ttu-id="8ee62-130">![ESE_Documentation_longvaluedtree2](images/Gg269179.ESE_Documentation_longvaluedtree2(EXCHG.10).gif "ESE_Documentation_longvaluedtree2")</span><span class="sxs-lookup"><span data-stu-id="8ee62-130">![ESE_Documentation_longvaluedtree2](images/Gg269179.ESE_Documentation_longvaluedtree2(EXCHG.10).gif "ESE_Documentation_longvaluedtree2")</span></span>

<span data-ttu-id="8ee62-131">O ESE também dá suporte a um recurso de repositório de instância única que permite que vários registros façam referência ao mesmo objeto binário grande, como embora cada registro tenha sua própria cópia das informações; evitando assim cópias duplicadas dos dados do valor da coluna.</span><span class="sxs-lookup"><span data-stu-id="8ee62-131">ESE also supports a single instance store feature that allows multiple records to reference the same large binary object as though each record had its own copy of the information; thus avoiding duplicate copies of the column value data.</span></span> <span data-ttu-id="8ee62-132">Esse recurso é habilitado na chamada para [JetPrepareUpdate](./jetprepareupdate-function.md) com a opção JET_prepInsertCopy definida no parâmetro *Prep* .</span><span class="sxs-lookup"><span data-stu-id="8ee62-132">This feature is enabled in the call to [JetPrepareUpdate](./jetprepareupdate-function.md) with the JET_prepInsertCopy option set in the *prep* parameter.</span></span>
