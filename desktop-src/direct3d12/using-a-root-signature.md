---
title: Usando uma assinatura de raiz
description: A assinatura raiz é a definição de uma coleção organizada arbitrariamente de tabelas de descritores (incluindo seu layout), constantes raiz e descritores raiz.
ms.assetid: 0131CDE4-02DB-440A-92B8-B0933C6414B0
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3babe26dc06d4f85ce3d6fb771e18c78b54a3701
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "74104778"
---
# <a name="using-a-root-signature"></a><span data-ttu-id="711d2-103">Usando uma assinatura de raiz</span><span class="sxs-lookup"><span data-stu-id="711d2-103">Using a Root Signature</span></span>

<span data-ttu-id="711d2-104">A assinatura raiz é a definição de uma coleção organizada arbitrariamente de tabelas de descritores (incluindo seu layout), constantes raiz e descritores raiz.</span><span class="sxs-lookup"><span data-stu-id="711d2-104">The root signature is the definition of an arbitrarily arranged collection of descriptor tables (including their layout), root constants and root descriptors.</span></span> <span data-ttu-id="711d2-105">Cada entrada tem um custo em direção a um limite máximo, portanto, o aplicativo pode compensar o equilíbrio entre o número de cada tipo de entrada que a assinatura raiz conterá.</span><span class="sxs-lookup"><span data-stu-id="711d2-105">Each entry has a cost towards a maximum limit, so the application can trade off the balance between how many of each type of entry the root signature will contain.</span></span>

-   [<span data-ttu-id="711d2-106">Semântica de lista de comandos</span><span class="sxs-lookup"><span data-stu-id="711d2-106">Command List Semantic</span></span>](#command-list-semantic)
-   [<span data-ttu-id="711d2-107">Semântica do pacote</span><span class="sxs-lookup"><span data-stu-id="711d2-107">Bundle Semantics</span></span>](#bundle-semantics)
-   [<span data-ttu-id="711d2-108">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="711d2-108">Related topics</span></span>](#related-topics)

<span data-ttu-id="711d2-109">A assinatura raiz é um objeto que pode ser criado pela especificação manual na API.</span><span class="sxs-lookup"><span data-stu-id="711d2-109">The root signature is an object that can be created by manual specification at the API.</span></span> <span data-ttu-id="711d2-110">Todos os sombreadores em um PSO devem ser compatíveis com o layout raiz especificado com o PSO ou os sombreadores individuais devem incluir layouts de raiz incorporados que correspondam uns aos outros; caso contrário, haverá falha na criação do PSO.</span><span class="sxs-lookup"><span data-stu-id="711d2-110">All shaders in a PSO must be compatible with the root layout specified with the PSO, or else the individual shaders must include embedded root layouts that match each other; otherwise, PSO creation will fail.</span></span> <span data-ttu-id="711d2-111">Uma propriedade da assinatura raiz é que os sombreadores não precisam saber sobre ele quando criados, embora as assinaturas raiz também possam ser criadas diretamente em sombreadores, se desejado.</span><span class="sxs-lookup"><span data-stu-id="711d2-111">One property of the root signature is that shaders don't have to know about it when authored, although root signatures can also be authored directly in shaders if desired.</span></span> <span data-ttu-id="711d2-112">Os ativos de sombreador existentes não exigem nenhuma alteração para serem compatíveis com as assinaturas raiz.</span><span class="sxs-lookup"><span data-stu-id="711d2-112">Existing shader assets do not require any changes to be compatible with root signatures.</span></span> <span data-ttu-id="711d2-113">O Shader Model 5,1 é introduzido para fornecer uma flexibilidade extra (indexação dinâmica de descritores de dentro de sombreadores) e pode ser adotado incrementalmente a partir de ativos de sombreador existentes, conforme desejado.</span><span class="sxs-lookup"><span data-stu-id="711d2-113">Shader Model 5.1 is introduced to provide some extra flexibility (dynamic indexing of descriptors from within shaders), and can be incrementally adopted starting from existing shader assets as desired.</span></span>

## <a name="command-list-semantic"></a><span data-ttu-id="711d2-114">Semântica de lista de comandos</span><span class="sxs-lookup"><span data-stu-id="711d2-114">Command List Semantic</span></span>

<span data-ttu-id="711d2-115">No início de uma lista de comandos, a assinatura raiz é indefinida.</span><span class="sxs-lookup"><span data-stu-id="711d2-115">At the beginning of a command list, the root signature is undefined.</span></span> <span data-ttu-id="711d2-116">Os sombreadores de gráficos têm uma assinatura de raiz separada do sombreador de computação, cada um atribuído de forma independente em uma lista de comandos.</span><span class="sxs-lookup"><span data-stu-id="711d2-116">Graphics shaders have a separate root signature from the compute shader, each independently assigned on a command list.</span></span> <span data-ttu-id="711d2-117">A assinatura raiz definida em uma lista de comandos ou um pacote também deve corresponder ao PSO definido no momento em empate/Dispatch; caso contrário, o comportamento será indefinido.</span><span class="sxs-lookup"><span data-stu-id="711d2-117">The root signature set on a command list or bundle must also match the currently set PSO at Draw/Dispatch; otherwise, the behavior is undefined.</span></span> <span data-ttu-id="711d2-118">Incompatibilidades de assinatura de raiz transitória antes de desenhar/distribuir são boas, como definir um PSO incompatível antes de alternar para uma assinatura raiz compatível (desde que eles sejam compatíveis com o tempo que o empate/expedição seja chamado).</span><span class="sxs-lookup"><span data-stu-id="711d2-118">Transient root signature mismatches before Draw/Dispatch are fine - such as setting an incompatible PSO before switching to a compatible root signature (as long as these are compatible by the time Draw/Dispatch is called).</span></span> <span data-ttu-id="711d2-119">A definição de um PSO não altera a assinatura raiz.</span><span class="sxs-lookup"><span data-stu-id="711d2-119">Setting a PSO does not change the root signature.</span></span> <span data-ttu-id="711d2-120">O aplicativo deve chamar uma API dedicada para definir a assinatura raiz.</span><span class="sxs-lookup"><span data-stu-id="711d2-120">The application must call a dedicated API for setting the root signature.</span></span>

<span data-ttu-id="711d2-121">Depois que uma assinatura de raiz tiver sido definida em uma lista de comandos, o layout definirá o conjunto de associações que o aplicativo deve fornecer e qual PSOs poderá ser usado (aqueles compilados com o mesmo layout) para as próximas chamadas de emissão/expedição.</span><span class="sxs-lookup"><span data-stu-id="711d2-121">Once a root signature has been set on a command list, the layout defines the set of bindings that the application is expected to provide, and which PSOs can be used (those compiled with the same layout) for the next draw/dispatch calls.</span></span> <span data-ttu-id="711d2-122">Por exemplo, uma assinatura raiz pode ser definida pelo aplicativo para ter as seguintes entradas.</span><span class="sxs-lookup"><span data-stu-id="711d2-122">For example, a root signature could be defined by the application to have the following entries.</span></span> <span data-ttu-id="711d2-123">Cada entrada é chamada de "slot".</span><span class="sxs-lookup"><span data-stu-id="711d2-123">Each entry is referred to as a "slot".</span></span>

-   <span data-ttu-id="711d2-124">\[0 \] um descritor cbv embutido (inscriprs raiz)</span><span class="sxs-lookup"><span data-stu-id="711d2-124">\[0\] A CBV descriptor inline (root descriptors)</span></span>
-   <span data-ttu-id="711d2-125">\[1 \] uma tabela de descritores contendo 2 SRVs, 1 CBVs e 1 UAV</span><span class="sxs-lookup"><span data-stu-id="711d2-125">\[1\] A descriptor table containing 2 SRVs, 1 CBVs, and 1 UAV</span></span>
-   <span data-ttu-id="711d2-126">\[2 \] uma tabela de descritores contendo 1 amostra</span><span class="sxs-lookup"><span data-stu-id="711d2-126">\[2\] A descriptor table containing 1 sampler</span></span>
-   <span data-ttu-id="711d2-127">\[3 \] uma coleção 4x32 de constantes de raiz</span><span class="sxs-lookup"><span data-stu-id="711d2-127">\[3\] A 4x32-bit collection of root constants</span></span>
-   <span data-ttu-id="711d2-128">\[4 \] uma tabela de descritores contendo um número não especificado de SRVs</span><span class="sxs-lookup"><span data-stu-id="711d2-128">\[4\] A descriptor table containing an unspecified number of SRVs</span></span>

<span data-ttu-id="711d2-129">Nesse caso, antes de poder emitir um empate/expedição, espera-se que o aplicativo defina a ligação apropriada para cada um dos slots \[ 0.. 4 \] que o aplicativo definiu com sua assinatura raiz atual.</span><span class="sxs-lookup"><span data-stu-id="711d2-129">In this case, before being able to issue a Draw/Dispatch, the application is expected to set the appropriate binding to each of the slots \[0..4\] that the application defined with its current root signature.</span></span> <span data-ttu-id="711d2-130">Por exemplo, no slot \[ 1 \] , uma tabela de descritores deve ser associada, que é uma região contígua em um heap de descritor que contém (ou conterá na execução) 2 SRVs, 1 CBVs e 1 UAV.</span><span class="sxs-lookup"><span data-stu-id="711d2-130">For instance, at slot \[1\], a descriptor table must be bound, which is a contiguous region in a descriptor heap that contains (or will contain at execution) 2 SRVs, 1 CBVs, and 1 UAV.</span></span> <span data-ttu-id="711d2-131">Da mesma forma, as tabelas de descritores devem ser definidas nos slots \[ 2 \] e \[ 4 \] .</span><span class="sxs-lookup"><span data-stu-id="711d2-131">Similarly, descriptor tables must be set at slots \[2\] and \[4\].</span></span>

<span data-ttu-id="711d2-132">O aplicativo pode alterar parte das associações de assinatura raiz de cada vez (o restante permanece inalterado).</span><span class="sxs-lookup"><span data-stu-id="711d2-132">The application can change part of the root signature bindings at a time (the rest remain unchanged).</span></span> <span data-ttu-id="711d2-133">Por exemplo, se a única coisa que precisa ser alterada entre o desenho for uma das constantes no slot \[ 2 \] , isso é tudo o que o aplicativo precisa para reassociar.</span><span class="sxs-lookup"><span data-stu-id="711d2-133">For example, if the only thing that needs to change between draws is one of the constants at slot \[2\], that is all the application needs to rebind.</span></span> <span data-ttu-id="711d2-134">Conforme discutido anteriormente, as versões de driver/hardware de todos os Estados de ligação de assinatura de raiz, conforme são modificadas automaticamente.</span><span class="sxs-lookup"><span data-stu-id="711d2-134">As discussed previously, the driver/hardware versions all root signature bind state as it is modified automatically.</span></span> <span data-ttu-id="711d2-135">Se uma assinatura de raiz for alterada em uma lista de comandos, todas as associações de assinatura de raiz anteriores se tornarão obsoletas e todas as associações esperadas deverão ser definidas antes de desenhar/distribuir; caso contrário, o comportamento será indefinido.</span><span class="sxs-lookup"><span data-stu-id="711d2-135">If a root signature is changed on a command list, all previous root signature bindings become stale and all newly expected bindings must be set before Draw/Dispatch; otherwise, the behavior is undefined.</span></span> <span data-ttu-id="711d2-136">Se a assinatura raiz estiver definida com redundância para a mesma definida atualmente, as associações de assinatura raiz existentes não se tornarão obsoletas.</span><span class="sxs-lookup"><span data-stu-id="711d2-136">If the root signature is redundantly set to the same one currently set, existing root signature bindings do not become stale.</span></span>

## <a name="bundle-semantics"></a><span data-ttu-id="711d2-137">Semântica do pacote</span><span class="sxs-lookup"><span data-stu-id="711d2-137">Bundle Semantics</span></span>

<span data-ttu-id="711d2-138">Os grupos herdam as associações de assinatura raiz da lista de comandos (as associações para os vários slots no exemplo de lista de comandos acima).</span><span class="sxs-lookup"><span data-stu-id="711d2-138">Bundles inherit the command list's root signature bindings (the bindings to the various slots in the Command List example above).</span></span> <span data-ttu-id="711d2-139">Se um pacote precisar alterar algumas das associações de assinatura raiz herdadas, primeiro será necessário definir a assinatura raiz como a mesma que a lista de comandos de chamada (as associações herdadas não se tornarão obsoletas).</span><span class="sxs-lookup"><span data-stu-id="711d2-139">If a bundle needs to change some of the inherited root signature bindings, it must first set the root signature to be the same as the calling command list (the inherited bindings do not become stale).</span></span> <span data-ttu-id="711d2-140">Se o pacote definir a assinatura raiz para ser diferente da lista de comandos de chamada, que tem o mesmo efeito que alterar a assinatura raiz na lista de comandos descrita acima: todas as associações de assinatura raiz anteriores são obsoletas e as associações esperadas recentemente devem ser definidas antes de desenhar/distribuir; caso contrário, o comportamento será indefinido.</span><span class="sxs-lookup"><span data-stu-id="711d2-140">If the bundle sets the root signature to be different than the calling command list, that has the same effect as changing the root signature on the command list described above: all previous root signature bindings are stale and newly expected bindings must be set before Draw/Dispatch; otherwise, the behavior is undefined.</span></span> <span data-ttu-id="711d2-141">Se um pacote não precisar alterar nenhuma associação de assinatura raiz, ele não precisará definir a assinatura raiz.</span><span class="sxs-lookup"><span data-stu-id="711d2-141">If a bundle does not need to change any root signature bindings, it does not need to set the root signature.</span></span>

<span data-ttu-id="711d2-142">O código a seguir mostra um fluxo de chamada de exemplo em um pacote.</span><span class="sxs-lookup"><span data-stu-id="711d2-142">The following code shows an example call flow into a bundle.</span></span>

``` syntax
// Command List
...
pCmdList->SetGraphicsRootSignature(pRootSig); // new parameter space
MyEngine_SetTextures(); // bundle inherits descriptor table setting
MyEngine_SetAnimationFactor(fTime); // bundle inherits root constant
pCmdList->ExecuteBundle(...);
...
// Bundle
pBundle->SetGraphicsRootSignature(pRootSig); // same as caller, in order to inherits bindings
pBundle->SetPipelineState(pPS); 
pBundle->SetGraphicsRoot32BitConstant(drawConstantsSlot,0,drawIDOffset);
pBundle->Draw(...); // using inherited textures / animation factor
pBundle->SetGraphicsRoot32BitConstant(drawConstantsSlot,1,drawIDOffset);
pBundle->Draw(...);
...
```

<span data-ttu-id="711d2-143">Saindo de um pacote, todas as alterações de layout raiz e/ou alterações de associação de um pacote são herdadas de volta para a lista de comandos de chamada quando um pacote termina de ser executado.</span><span class="sxs-lookup"><span data-stu-id="711d2-143">Coming out of a bundle, any root layout changes and/or binding changes a bundle makes are inherited back to the calling command list when a bundle finishes executing.</span></span>

<span data-ttu-id="711d2-144">Para obter mais informações sobre herança, consulte a seção **herança de estado de pipeline de gráficos** de [Gerenciando o estado do pipeline de gráficos no Direct3D 12](managing-graphics-pipeline-state-in-direct3d-12.md).</span><span class="sxs-lookup"><span data-stu-id="711d2-144">For more information on inheritance, refer to the **Graphics pipeline state inheritance** section of [Managing Graphics Pipeline State in Direct3D 12](managing-graphics-pipeline-state-in-direct3d-12.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="711d2-145">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="711d2-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="711d2-146">Assinaturas raiz</span><span class="sxs-lookup"><span data-stu-id="711d2-146">Root Signatures</span></span>](root-signatures.md)
</dt> </dl>

 

 




