---
description: O sistema de propriedades do Windows é um sistema de leitura/gravação extensível de definições de dados que fornece uma maneira uniforme de expressar os metadados sobre itens de Shell.
ms.assetid: eb2dc2be-fc53-40aa-81f6-f353ab1d3a57
title: Visão geral do sistema de propriedades
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dab3a17eacdbaa9a5d0255004ba544b7c3f7ff2b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105785103"
---
# <a name="property-system-overview"></a><span data-ttu-id="6a13b-103">Visão geral do sistema de propriedades</span><span class="sxs-lookup"><span data-stu-id="6a13b-103">Property System Overview</span></span>

<span data-ttu-id="6a13b-104">O sistema de propriedades do Windows é um sistema de leitura/gravação extensível de definições de dados que fornece uma maneira uniforme de expressar os metadados sobre itens de Shell.</span><span class="sxs-lookup"><span data-stu-id="6a13b-104">The Windows Property System is an extensible read/write system of data definitions that provides a uniform way of expressing metadata about Shell items.</span></span> <span data-ttu-id="6a13b-105">O sistema de propriedades do Windows no Windows Vista e posterior permite que você armazene e recupere metadados para itens de Shell.</span><span class="sxs-lookup"><span data-stu-id="6a13b-105">The Windows Property system in Windows Vista and later enables you to store and retrieve metadata for Shell items.</span></span> <span data-ttu-id="6a13b-106">Um item de Shell é qualquer conteúdo único, como um arquivo, uma pasta, um email ou um contato.</span><span class="sxs-lookup"><span data-stu-id="6a13b-106">A Shell item is any single piece of content, such as a file, folder, email, or contact.</span></span> <span data-ttu-id="6a13b-107">Uma propriedade é uma parte individual dos metadados associados a um item de Shell.</span><span class="sxs-lookup"><span data-stu-id="6a13b-107">A property is an individual piece of metadata associated with a Shell item.</span></span> <span data-ttu-id="6a13b-108">Os valores de propriedade são expressos como uma estrutura [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="6a13b-108">Property values are expressed as a [**PROPVARIANT**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) structure.</span></span>

<span data-ttu-id="6a13b-109">Este tópico é organizado da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="6a13b-109">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="6a13b-110">Introdução</span><span class="sxs-lookup"><span data-stu-id="6a13b-110">Introduction</span></span>](#introduction)
-   [<span data-ttu-id="6a13b-111">Cenários de desenvolvimento</span><span class="sxs-lookup"><span data-stu-id="6a13b-111">Development Scenarios</span></span>](#development-scenarios)
-   [<span data-ttu-id="6a13b-112">Propriedades e pesquisa do Windows</span><span class="sxs-lookup"><span data-stu-id="6a13b-112">Properties and Windows Search</span></span>](#properties-and-windows-search)
-   [<span data-ttu-id="6a13b-113">Observação para implementadores</span><span class="sxs-lookup"><span data-stu-id="6a13b-113">Note to Implementers</span></span>](#note-to-implementers)
-   [<span data-ttu-id="6a13b-114">Documentação do sistema de propriedades do Windows</span><span class="sxs-lookup"><span data-stu-id="6a13b-114">Windows Property System Documentation</span></span>](#windows-property-system-documentation)
-   [<span data-ttu-id="6a13b-115">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="6a13b-115">Additional Resources</span></span>](#additional-resources)
-   [<span data-ttu-id="6a13b-116">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="6a13b-116">Related topics</span></span>](#related-topics)

## <a name="introduction"></a><span data-ttu-id="6a13b-117">Introdução</span><span class="sxs-lookup"><span data-stu-id="6a13b-117">Introduction</span></span>

<span data-ttu-id="6a13b-118">As propriedades são identificadas exclusivamente por seu nome canônico (como `System.Document.LastAuthor` ) e chave de propriedade (como `PKEY_Document_LastAuthor` ).</span><span class="sxs-lookup"><span data-stu-id="6a13b-118">Properties are uniquely identified by their canonical name (such as `System.Document.LastAuthor`) and property key (such as `PKEY_Document_LastAuthor`).</span></span> <span data-ttu-id="6a13b-119">Uma chave de propriedade (PKEY) é a parte do nome de um par de nome-valor que consiste em um PKEY/PROPVARIANT ou uma cadeia de caracteres/PROPVARIANT, em que a cadeia de caracteres é o nome canônico do PKEY (como `System.Document.LastAuthor` ).</span><span class="sxs-lookup"><span data-stu-id="6a13b-119">A property key (PKEY) is the name portion of a name-value pair that consists of a PKEY/PROPVARIANT or a string/PROPVARIANT, where the string is the canonical name of the PKEY (such as `System.Document.LastAuthor`).</span></span> <span data-ttu-id="6a13b-120">Um PKEY é uma definição que diz ao sistema de propriedades tudo o que ele precisa saber sobre a propriedade, enquanto o valor é uma instância real da propriedade.</span><span class="sxs-lookup"><span data-stu-id="6a13b-120">A PKEY is a definition that tells the property system everything it needs to know about the property, whereas the value is an actual instance of the property.</span></span> <span data-ttu-id="6a13b-121">Um PKEY internamente contém um FormatID e propID.</span><span class="sxs-lookup"><span data-stu-id="6a13b-121">A PKEY internally contains a formatID and propID.</span></span>

<span data-ttu-id="6a13b-122">Uma propriedade individual consiste nas seguintes três partes:</span><span class="sxs-lookup"><span data-stu-id="6a13b-122">An individual property consists of the following three pieces:</span></span>

-   <span data-ttu-id="6a13b-123">Um nome canônico, como `System.Music.Artist` .</span><span class="sxs-lookup"><span data-stu-id="6a13b-123">A canonical name, such as `System.Music.Artist`.</span></span>
-   <span data-ttu-id="6a13b-124">Uma descrição do esquema, que é especificada no formato de arquivo XML. propDesc e expressa programaticamente por meio de [**IPropertyDescription**](/windows/desktop/api/Propsys/nn-propsys-ipropertydescription).</span><span class="sxs-lookup"><span data-stu-id="6a13b-124">A schema description, which is specified in the .propdesc XML file format and expressed programmatically through [**IPropertyDescription**](/windows/desktop/api/Propsys/nn-propsys-ipropertydescription).</span></span>
-   <span data-ttu-id="6a13b-125">Um valor, como o nome de um cantor.</span><span class="sxs-lookup"><span data-stu-id="6a13b-125">A value, such as the name of a singer.</span></span>

<span data-ttu-id="6a13b-126">A descrição do esquema consiste em informações sobre a propriedade, como o nome da propriedade, o tipo de dados, as restrições, informações sobre como a propriedade interage com exibições e o sistema de pesquisa e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="6a13b-126">The schema description consists of information about the property, such as the property name, data type, constraints, information on how the property interacts with views and the search system, and so forth.</span></span> <span data-ttu-id="6a13b-127">O nome e a descrição do esquema são definidos globalmente e são os mesmos para todos os itens e tipos.</span><span class="sxs-lookup"><span data-stu-id="6a13b-127">The name and schema description are defined globally, and are the same for all items and types.</span></span> <span data-ttu-id="6a13b-128">Um valor é específico de um item individual.</span><span class="sxs-lookup"><span data-stu-id="6a13b-128">A value is specific to an individual item.</span></span> <span data-ttu-id="6a13b-129">Ou seja, a `System.Music.Artist` propriedade é sempre definida como uma cadeia de caracteres de valores múltiplos, mas pode ter um valor diferente (ou nenhum valor) para cada item.</span><span class="sxs-lookup"><span data-stu-id="6a13b-129">That is, the `System.Music.Artist` property is always defined as a multi-value string, but may have a different value (or no value at all) for each item.</span></span>

<span data-ttu-id="6a13b-130">Um manipulador de propriedades traduz os dados armazenados em um arquivo em um esquema estruturado que é reconhecido pelo e pode ser acessado pelo Windows Explorer, pelo Windows Search e por outros aplicativos.</span><span class="sxs-lookup"><span data-stu-id="6a13b-130">A property handler translates data stored in a file into a structured schema that is recognized by and can be accessed by Windows Explorer, Windows Search, and other applications.</span></span> <span data-ttu-id="6a13b-131">Esses sistemas podem interagir com o manipulador de propriedades para gravar e ler propriedades de e para o arquivo.</span><span class="sxs-lookup"><span data-stu-id="6a13b-131">These systems can then interact with the property handler to write and read properties to and from the file.</span></span> <span data-ttu-id="6a13b-132">Os dados traduzidos são expostos programaticamente e mostrados para o usuário por meio do Windows Explorer em uma variedade de contextos, incluindo exibição de detalhes, infotips, painel de detalhes, páginas de propriedades e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="6a13b-132">The translated data is exposed programmatically and shown to the user through Windows Explorer in a variety of contexts including details view, infotips, details pane, property pages, and so forth.</span></span> <span data-ttu-id="6a13b-133">Cada manipulador de propriedade é associado a um tipo de arquivo específico, que é identificado pela extensão de nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="6a13b-133">Each property handler is associated with a particular file type, which is identified by the file name extension.</span></span> <span data-ttu-id="6a13b-134">Os desenvolvedores devem implementar um manipulador de propriedades que produza e consuma o formato nativo do tipo de arquivo, como. jpg ou. png, ou usar o armazenamento de propriedades In-Memory, que produz e consome o formato binário MS-PROPSTORE.</span><span class="sxs-lookup"><span data-stu-id="6a13b-134">Developers should implement a property handler that produces and consumes their file type's native format, such as .jpg or .png, or use the In-Memory Property Store, which produces and consumes the MS-PROPSTORE binary format.</span></span>

<span data-ttu-id="6a13b-135">O sistema de propriedades do Windows cria um modelo de dados abstrato que fornece um nível de abstração de formatos de arquivo individuais.</span><span class="sxs-lookup"><span data-stu-id="6a13b-135">The Windows Property System creates an abstract data model that provides a level of abstraction from individual file formats.</span></span> <span data-ttu-id="6a13b-136">O modelo de dados abstrato fornecido pelo sistema de propriedades do Windows é um método para ler e gravar um conjunto extensível de valores nomeados associados a um item de Shell.</span><span class="sxs-lookup"><span data-stu-id="6a13b-136">The abstract data model provided by the Windows Property System is a method for reading and writing an extensible set of named values that are associated with a Shell item.</span></span> <span data-ttu-id="6a13b-137">A expressão de valor é flexível, dá suporte a muitos tipos de dados e é extensível, habilitando dados arbitrários (**\_ blob VT**) e objetos a serem expressos como um valor.</span><span class="sxs-lookup"><span data-stu-id="6a13b-137">The value expression is flexible, supporting many data types, and is extensible, enabling arbitrary data (**VT\_BLOB**) and objects to be expressed as a value.</span></span>

<span data-ttu-id="6a13b-138">Devido à abstração, você pode consultar os atributos ou os metadados de qualquer item.</span><span class="sxs-lookup"><span data-stu-id="6a13b-138">Due to the abstraction, you can query the attributes or metadata of any item.</span></span> <span data-ttu-id="6a13b-139">Exemplos de itens que podem ser dissociados incluem documentos Microsoft Office, marcas ID3 e o AutoCAD e outros softwares proprietários de terceiros.</span><span class="sxs-lookup"><span data-stu-id="6a13b-139">Examples of items that can be abstracted include Microsoft Office documents, ID3 tags, and AutoCAD and other third-party proprietary software.</span></span> <span data-ttu-id="6a13b-140">Da mesma forma, se você tiver um arquivo. jpeg, poderá usar os codecs. jpeg e EXIF para ler os bytes do arquivo para descobrir quais são as dimensões da imagem.</span><span class="sxs-lookup"><span data-stu-id="6a13b-140">Similarly, if you have a .jpeg file, you can use the .jpeg and EXIF codecs to read the bytes of the file to discover what the dimensions of the image are.</span></span> <span data-ttu-id="6a13b-141">Se você tiver um arquivo. png, você precisará de um codec diferente e um código diferente para fazer isso.</span><span class="sxs-lookup"><span data-stu-id="6a13b-141">If you have a .png file instead, you need a different codec and different code to do so.</span></span> <span data-ttu-id="6a13b-142">O uso do sistema de propriedades do Windows evita esse tipo de problema.</span><span class="sxs-lookup"><span data-stu-id="6a13b-142">Using the Windows Property System avoids this sort of problem.</span></span> <span data-ttu-id="6a13b-143">Se você implementar um novo tipo de arquivo, terá a opção de conectar-se à abstração uniforme oferecida pelo sistema de propriedades do Windows e especificar como tornar seus metadados consumíveis.</span><span class="sxs-lookup"><span data-stu-id="6a13b-143">If you implement a new file type, you have the option to plug into the uniform abstraction offered by the Windows Property System and specify how to make your metadata consumable.</span></span> <span data-ttu-id="6a13b-144">Por esses motivos, é sempre preferível usar a plataforma comum fornecida pelo sistema de propriedades do Windows.</span><span class="sxs-lookup"><span data-stu-id="6a13b-144">For these reasons, it is always preferable to use the common platform provided by the Windows Property System.</span></span>

## <a name="development-scenarios"></a><span data-ttu-id="6a13b-145">Cenários de desenvolvimento</span><span class="sxs-lookup"><span data-stu-id="6a13b-145">Development Scenarios</span></span>

<span data-ttu-id="6a13b-146">As propriedades são expressas por produtores e consumidores.</span><span class="sxs-lookup"><span data-stu-id="6a13b-146">Properties are expressed by producers and by consumers.</span></span> <span data-ttu-id="6a13b-147">Nesse contexto, os produtores são os inventores das propriedades no sistema de propriedades do Windows e os consumidores são aplicativos (e seus desenvolvedores) que consomem informações de propriedade deste sistema.</span><span class="sxs-lookup"><span data-stu-id="6a13b-147">In this context, producers are the inventors of properties in the Windows Property System and consumers are applications (and their developers) that consume property information from this system.</span></span> <span data-ttu-id="6a13b-148">Os usos do e dos participantes no sistema de propriedades do Windows são identificados na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="6a13b-148">Uses of and participants in the Windows Property System are identified in the following table.</span></span>



| <span data-ttu-id="6a13b-149">Uso do sistema de propriedades do Windows</span><span class="sxs-lookup"><span data-stu-id="6a13b-149">Use of the Windows Property System</span></span>                                                                                                                                                                                            | <span data-ttu-id="6a13b-150">Participante</span><span class="sxs-lookup"><span data-stu-id="6a13b-150">Participant</span></span> |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|
| <span data-ttu-id="6a13b-151">Um bloco de construção que fornece um registro extensível de descrições de propriedade, uma implementação de armazenamento de propriedade na memória e serviços para associação a manipuladores de propriedade, conversão de tipos e serialização de armazenamentos de propriedade.</span><span class="sxs-lookup"><span data-stu-id="6a13b-151">A building block that provides an extensible registry of property descriptions, an in-memory property store implementation, and services for binding to property handlers, converting types, and serializing property stores.</span></span> | <span data-ttu-id="6a13b-152">Consumidor</span><span class="sxs-lookup"><span data-stu-id="6a13b-152">Consumer</span></span>    |
| <span data-ttu-id="6a13b-153">Aplicativos que desejam ler e gravar propriedades de forma abstrata.</span><span class="sxs-lookup"><span data-stu-id="6a13b-153">Applications that want to read and write properties in an abstract way.</span></span>                                                                                                                                                       | <span data-ttu-id="6a13b-154">Consumidor</span><span class="sxs-lookup"><span data-stu-id="6a13b-154">Consumer</span></span>    |
| <span data-ttu-id="6a13b-155">Inventores de propriedade que definem novas propriedades para o sistema de propriedades definindo esquemas de propriedade personalizada e desenvolvendo seus próprios manipuladores de propriedade.</span><span class="sxs-lookup"><span data-stu-id="6a13b-155">Property inventors who define new properties for the property system by defining custom property schemas and developing their own property handlers.</span></span>                                                                          | <span data-ttu-id="6a13b-156">Produtor</span><span class="sxs-lookup"><span data-stu-id="6a13b-156">Producer</span></span>    |
| <span data-ttu-id="6a13b-157">Proprietários de formato de arquivo que desejam habilitar o acesso às propriedades armazenadas em seus formatos de arquivo personalizados.</span><span class="sxs-lookup"><span data-stu-id="6a13b-157">File format owners who want to enable access to the properties stored in their custom file formats.</span></span>                                                                                                                           | <span data-ttu-id="6a13b-158">Produtor</span><span class="sxs-lookup"><span data-stu-id="6a13b-158">Producer</span></span>    |



 

<span data-ttu-id="6a13b-159">Os consumidores consomem Propriedades, esquemas e manipuladores de propriedade existentes.</span><span class="sxs-lookup"><span data-stu-id="6a13b-159">Consumers consume existing properties, schemas, and property handlers.</span></span> <span data-ttu-id="6a13b-160">As propriedades disponíveis para consumo incluem propriedades de leitura/gravação de manipuladores de propriedade para tipos de arquivo com suporte e também podem incluir algumas propriedades personalizadas.</span><span class="sxs-lookup"><span data-stu-id="6a13b-160">Properties available for consumption include read/write properties from property handlers for supported file types and may also include some custom properties.</span></span> <span data-ttu-id="6a13b-161">Os esquemas disponíveis incluem pelo menos o esquema do sistema e, às vezes, outros também.</span><span class="sxs-lookup"><span data-stu-id="6a13b-161">Available schemas include at least the system schema, and sometimes others, too.</span></span> <span data-ttu-id="6a13b-162">Um consumidor pode criar um aplicativo para consumir metadados e criar uma exibição com base no artista, independentemente de quais pastas os itens estão armazenados.</span><span class="sxs-lookup"><span data-stu-id="6a13b-162">A consumer can create an application to consume metadata and build a view based on artist, regardless of what folders the items are stored in.</span></span> <span data-ttu-id="6a13b-163">A hierarquia de pastas de arquivos é irrelevante.</span><span class="sxs-lookup"><span data-stu-id="6a13b-163">The file folder hierarchy is irrelevant.</span></span> <span data-ttu-id="6a13b-164">Por exemplo, você pode especificar todos os itens de música por um determinado cantor sem se preocupar com a localização desses itens.</span><span class="sxs-lookup"><span data-stu-id="6a13b-164">For example, you can specify all song items by a particular singer without being concerned about the location of such items.</span></span> <span data-ttu-id="6a13b-165">Esse cenário complexo de ponta a ponta não se limita ao sistema de propriedades do Windows, mas envolve vários componentes diferentes, como as pastas de indexação e pesquisa.</span><span class="sxs-lookup"><span data-stu-id="6a13b-165">This complex, end-to-end scenario is not limited to the Windows Property System, but involves several different components, such as the indexing and search folders.</span></span>

<span data-ttu-id="6a13b-166">Os inventores de propriedade ou desenvolvedores de terceiros são produtores no sistema de propriedades do Windows.</span><span class="sxs-lookup"><span data-stu-id="6a13b-166">Property inventors, or third-party developers, are producers in the Windows Property System.</span></span> <span data-ttu-id="6a13b-167">Ao se preparar para definir uma nova propriedade, primeiro Inspecione o conjunto de propriedades que o Windows define.</span><span class="sxs-lookup"><span data-stu-id="6a13b-167">When preparing to define a new property, first inspect the set of properties that Windows defines.</span></span> <span data-ttu-id="6a13b-168">Se você encontrar um que atenda às suas necessidades, do tipo e da semântica que correspondem ao seu uso necessário, use essa propriedade e não crie uma nova.</span><span class="sxs-lookup"><span data-stu-id="6a13b-168">If you find one that meets your needs, of the type and semantics that match your required use, use that property and do not invent a new one.</span></span> <span data-ttu-id="6a13b-169">Se você estiver definindo uma nova propriedade personalizada, tente obter o contrato com outros desenvolvedores que talvez queiram usá-lo e publicar o resultado desse contrato para que eles possam ingressar na Comunidade de usuários dessa propriedade.</span><span class="sxs-lookup"><span data-stu-id="6a13b-169">If you are defining a new custom property, try to obtain agreement with other developers that might want to use it and publish the result of that agreement so that they can join the community of users of that property.</span></span>

<span data-ttu-id="6a13b-170">Os produtores podem aproveitar a funcionalidade do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="6a13b-170">Producers can take advantage of Windows Explorer functionality.</span></span> <span data-ttu-id="6a13b-171">Por exemplo, se você estiver escrevendo um novo formato de imagem e implementar um manipulador de propriedades, o novo formato de arquivo ficará disponível no Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="6a13b-171">For example, if you are writing a new image format, and implement a property handler, your new file format becomes available in Windows Explorer.</span></span> <span data-ttu-id="6a13b-172">Os usuários podem marcar suas fotografias e dinamizar sua coleção de fotografias com base em qualquer propriedade no sistema de propriedades do Windows.</span><span class="sxs-lookup"><span data-stu-id="6a13b-172">Users can then tag their photographs and pivot their collection of photographs based on any property in the Windows Property System.</span></span> <span data-ttu-id="6a13b-173">Na verdade, tudo o que o Shell faz com propriedades, desenvolvedores de terceiros podem fazer em seus próprios aplicativos.</span><span class="sxs-lookup"><span data-stu-id="6a13b-173">In fact, anything that Shell does with properties, third-party developers can do in their own applications.</span></span> <span data-ttu-id="6a13b-174">Isso inclui agrupamento, classificação, consulta e exibição de propriedades completas.</span><span class="sxs-lookup"><span data-stu-id="6a13b-174">This includes grouping, sorting, querying, and displaying full properties.</span></span> <span data-ttu-id="6a13b-175">A experiência do usuário que o Windows Explorer fornece pode ser amplamente implementada por terceiros com APIs disponíveis publicamente.</span><span class="sxs-lookup"><span data-stu-id="6a13b-175">The user experience that Windows Explorer provides can be largely implemented by third parties with publically available APIs.</span></span> <span data-ttu-id="6a13b-176">O Windows Explorer pode ser substituído ou estendido usando essas APIs.</span><span class="sxs-lookup"><span data-stu-id="6a13b-176">Windows Explorer can be replaced or extended using these APIs.</span></span>

<span data-ttu-id="6a13b-177">Do ponto de vista de um aplicativo que usa o modelo de dados do Shell, há uma grande variedade de cenários que envolvem o uso do sistema de propriedades do Windows.</span><span class="sxs-lookup"><span data-stu-id="6a13b-177">From the point of view of an application that uses the Shell data model, there are a huge variety of scenarios that involve the use of the Windows property system.</span></span> <span data-ttu-id="6a13b-178">Os aplicativos de gerenciamento de mídia são um exemplo proeminente.</span><span class="sxs-lookup"><span data-stu-id="6a13b-178">Media management applications are a prominent example.</span></span> <span data-ttu-id="6a13b-179">Os principais cenários do sistema de propriedades incluem cenários como a leitura da Propriedade Keyword de uma fotografia ou a definição da propriedade DateTaken.</span><span class="sxs-lookup"><span data-stu-id="6a13b-179">Core property system scenarios include scenarios such as reading the keyword property of a photograph or setting the datetaken property.</span></span> <span data-ttu-id="6a13b-180">Exemplos de cenários de integração de ponta a ponta que o sistema de propriedades do Windows habilita, mas que exigem que vários outros componentes funcionem, incluindo a exibição de todas as imagens ou a localização de um documento que contém uma palavra-chave.</span><span class="sxs-lookup"><span data-stu-id="6a13b-180">Examples of end-to-end integration scenarios that the Windows Property System enables, but that require several other components to function, include showing all pictures, or finding a document that contains a keyword.</span></span>

## <a name="properties-and-windows-search"></a><span data-ttu-id="6a13b-181">Propriedades e pesquisa do Windows</span><span class="sxs-lookup"><span data-stu-id="6a13b-181">Properties and Windows Search</span></span>

<span data-ttu-id="6a13b-182">As propriedades servem para produtores e consumidores quando eles fazem interface com o Windows Search e indexação.</span><span class="sxs-lookup"><span data-stu-id="6a13b-182">Properties serve both producers and consumers when they interface with Windows Search and indexing.</span></span> <span data-ttu-id="6a13b-183">O Windows Search tem um cache de valores de propriedade que são usados na implementação do Windows Serviço de Pesquisa (WSS).</span><span class="sxs-lookup"><span data-stu-id="6a13b-183">Windows Search has a cache of property values that are used in the implementation of the Windows Search Service (WSS).</span></span> <span data-ttu-id="6a13b-184">Esses valores de propriedade podem ser consultados programaticamente usando o provedor de OLE DB do Windows Search ou por meio de [**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory), que representa os itens nos resultados da pesquisa e exibições baseadas em consulta.</span><span class="sxs-lookup"><span data-stu-id="6a13b-184">These property values can be programmatically queried by using the Windows Search OLE DB provider, or through [**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory), which represents items in search results and query-based views.</span></span> <span data-ttu-id="6a13b-185">Em seguida, o Windows Search coleta e armazena as propriedades emitidas por manipuladores de filtro ou manipuladores de propriedades quando um item, como um documento do Word, é indexado.</span><span class="sxs-lookup"><span data-stu-id="6a13b-185">Windows Search then collects and stores properties emitted by filter handlers or property handlers when an item such as a Word document is indexed.</span></span> <span data-ttu-id="6a13b-186">Esse armazenamento é Descartado e recriado quando o índice é recriado.</span><span class="sxs-lookup"><span data-stu-id="6a13b-186">This store is discarded and rebuilt when the index is rebuilt.</span></span>

> [!Note]  
> <span data-ttu-id="6a13b-187">Lembre-se de que quando você registra novamente um esquema, as alterações feitas em atributos de propriedades definidas anteriormente podem não ser respeitadas pelo indexador.</span><span class="sxs-lookup"><span data-stu-id="6a13b-187">Remember that when you reregister a schema, changes made to attributes of previously defined properties may not be respected by the indexer.</span></span> <span data-ttu-id="6a13b-188">A solução é recriar o índice ou introduzir novas propriedades que reflitam as alterações em vez de atualizar as antigas (não recomendado).</span><span class="sxs-lookup"><span data-stu-id="6a13b-188">The solution is either to rebuild the index, or introduce new properties that reflect the changes instead of updating old ones (not recommended).</span></span> <span data-ttu-id="6a13b-189">Para obter mais informações, consulte [Observação para implementadores](#note-to-implementers) mais adiante neste tópico.</span><span class="sxs-lookup"><span data-stu-id="6a13b-189">For more information, see [Note to Implementers](#note-to-implementers) later in this topic.</span></span>

 

<span data-ttu-id="6a13b-190">Por exemplo, um desenvolvedor que cria um aplicativo de mídia deseja mostrar aos usuários do aplicativo todas as músicas disponíveis por um determinado artista.</span><span class="sxs-lookup"><span data-stu-id="6a13b-190">For example, a developer creating a media application wants to show users of the application all available music by a particular artist.</span></span> <span data-ttu-id="6a13b-191">O aplicativo forneceria ao usuário uma lista de artistas disponíveis e, em seguida, geraria uma lista de todas as músicas disponíveis pelo artista que o usuário selecionar.</span><span class="sxs-lookup"><span data-stu-id="6a13b-191">The application would provide the user with a list of available artists, and then generate a list of all available music by the artist that the user selects.</span></span> <span data-ttu-id="6a13b-192">Ou um usuário final pode querer fazer uma consulta para? artista: Sinfonia? e ser exposto à lista completa de propriedades disponíveis no decorrer de sua pesquisa.</span><span class="sxs-lookup"><span data-stu-id="6a13b-192">Or an end user might want to do a query for ?artist:Beethoven?, and be exposed to the full list of available properties in the course of their searche.</span></span> <span data-ttu-id="6a13b-193">Este exemplo envolve o uso do namespace do Shell, manipuladores de propriedade e/ou consulta do índice por meio de um dos seguintes:</span><span class="sxs-lookup"><span data-stu-id="6a13b-193">This example involves the use of the Shell namespace, property handlers, and/or querying the index through one of the following:</span></span>

-   <span data-ttu-id="6a13b-194">Uma fonte de dados do Shell.</span><span class="sxs-lookup"><span data-stu-id="6a13b-194">A Shell data source.</span></span>
-   <span data-ttu-id="6a13b-195">Um provedor OLE DB.</span><span class="sxs-lookup"><span data-stu-id="6a13b-195">An OLE DB provider.</span></span>
-   <span data-ttu-id="6a13b-196">Um arquivo de pesquisa salvo (. Search-MS) que é usado para iniciar uma consulta navegando até o arquivo de pesquisa no Windows Explorer ou ligando para [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) de forma programática.</span><span class="sxs-lookup"><span data-stu-id="6a13b-196">A Saved Search file (.search-ms) that is used to initiate a query by navigating to the search file in Windows Explorer or binding to [**IShellFolder**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) programmatically.</span></span>

> [!Note]  
> <span data-ttu-id="6a13b-197">Embora a `System.Kind` propriedade não participe desse cenário de aplicativo de mídia, ela pode ser usada para criar uma consulta que retornaria todos os arquivos. Search-MS em um escopo específico.</span><span class="sxs-lookup"><span data-stu-id="6a13b-197">Although the `System.Kind` property does not participate in this media application scenario, it could be used to build a query that would return all of the .search-ms files in a particular scope.</span></span>

 

<span data-ttu-id="6a13b-198">A maneira preferida de acessar as APIs de pesquisa e criar aplicativos de pesquisa do Windows é por meio de uma fonte de dados do Shell.</span><span class="sxs-lookup"><span data-stu-id="6a13b-198">The preferred way to access the Search APIs and create Windows Search applications is through a Shell data source.</span></span> <span data-ttu-id="6a13b-199">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) é um componente que pode criar instâncias da fonte de dados da pasta de pesquisa, que é um tipo de fonte de dados "virtual" fornecida pelo shell que pode executar consultas em outras fontes de dados no namespace do Shell e enumerar os resultados.</span><span class="sxs-lookup"><span data-stu-id="6a13b-199">[**ISearchFolderItemFactory**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) is a component that can create instances of the Search folder data source, which is a sort of "virtual" data source provided by the Shell that can execute queries over other data sources in the Shell namespace and enumerate results.</span></span> <span data-ttu-id="6a13b-200">Isso pode ser feito usando o indexador ou enumerando manualmente e inspecionando itens nos escopos especificados.</span><span class="sxs-lookup"><span data-stu-id="6a13b-200">It can do so either by using the indexer, or by manually enumerating and inspecting items in the specified scopes.</span></span>

<span data-ttu-id="6a13b-201">Desenvolvedores de terceiros podem criar aplicativos que consomem os dados no índice por meio de consultas programáticas e podem estender os dados no índice para tipos de arquivo e item personalizados a serem indexados pelo Windows Search.</span><span class="sxs-lookup"><span data-stu-id="6a13b-201">Third-party developers can create applications that consume the data in the index through programmatic queries, and can extend the data in the index for custom file and item types to be indexed by Windows Search.</span></span> <span data-ttu-id="6a13b-202">Se você quiser mostrar os resultados da consulta no Windows Explorer, deverá implementar uma fonte de dados do Shell antes de poder criar um manipulador de protocolo para estender o índice.</span><span class="sxs-lookup"><span data-stu-id="6a13b-202">If you want to show query results in Windows Explorer, you must implement a Shell data source before you can create a protocol handler to extend the index.</span></span> <span data-ttu-id="6a13b-203">No entanto, se todas as consultas forem programáticas (por meio de OLE DB, por exemplo) e interpretadas pelo código do aplicativo? s, em vez do Shell, um namespace do Shell ainda é preferido, mas não é necessário.</span><span class="sxs-lookup"><span data-stu-id="6a13b-203">However, if all queries will be programmatic (through OLE DB for example) and interpreted by the application?s code rather than the Shell, then a Shell namespace is still preferred but not required.</span></span> <span data-ttu-id="6a13b-204">Um manipulador de protocolo é necessário para que o Windows Obtenha informações sobre o conteúdo do arquivo, como itens em bancos de dados ou tipos de arquivo personalizados.</span><span class="sxs-lookup"><span data-stu-id="6a13b-204">A protocol handler is required for Windows to obtain information about file contents, such as items in databases or custom file types.</span></span> <span data-ttu-id="6a13b-205">Embora o Windows Search possa indexar o nome e as propriedades do arquivo, o Windows não tem informações sobre o conteúdo do arquivo.</span><span class="sxs-lookup"><span data-stu-id="6a13b-205">While Windows Search can index the name and properties of the file, Windows has no information about the content of the file.</span></span> <span data-ttu-id="6a13b-206">Como resultado, esses itens não podem ser indexados ou expostos no Shell do Windows.</span><span class="sxs-lookup"><span data-stu-id="6a13b-206">As a result, such items cannot be indexed or exposed in the Windows Shell.</span></span> <span data-ttu-id="6a13b-207">Ao implementar um manipulador de protocolo personalizado, você pode expor esses itens.</span><span class="sxs-lookup"><span data-stu-id="6a13b-207">By implementing a custom protocol handler, you can expose these items.</span></span> <span data-ttu-id="6a13b-208">Para obter uma lista de manipuladores identificados pelo cenário de desenvolvedor que você está tentando obter, consulte "visão geral de manipuladores" no [Windows Search como uma plataforma de desenvolvimento](../search/-search-3x-wds-development-ovr.md).</span><span class="sxs-lookup"><span data-stu-id="6a13b-208">For a list of handlers identified by the developer scenario you are trying to achieve, see "Overview of Handlers" in [Windows Search as a Development Platform](../search/-search-3x-wds-development-ovr.md).</span></span>

> [!Note]  
> <span data-ttu-id="6a13b-209">Algumas vezes, uma fonte de dados do Shell é conhecida como extensão de namespace do Shell.</span><span class="sxs-lookup"><span data-stu-id="6a13b-209">A Shell data source is sometimes known as a Shell namespace extension.</span></span> <span data-ttu-id="6a13b-210">Um manipulador é, às vezes, conhecido como uma extensão de shell ou um manipulador de extensão de Shell.</span><span class="sxs-lookup"><span data-stu-id="6a13b-210">A handler is sometimes known as a Shell extension or a Shell extension handler.</span></span>

 

## <a name="note-to-implementers"></a><span data-ttu-id="6a13b-211">Observação para implementadores</span><span class="sxs-lookup"><span data-stu-id="6a13b-211">Note to Implementers</span></span>

<span data-ttu-id="6a13b-212">Devido a possíveis dificuldades que o indexador pode ter ao consumir o esquema do sistema de propriedades, é fundamental que você defina atributos com cuidado e estrategicamente para a primeira versão do esquema.</span><span class="sxs-lookup"><span data-stu-id="6a13b-212">Due to potential difficulties that the indexer may have when consuming the property system's schema, it is critical that you define attributes carefully and strategically for the first release of the schema.</span></span> <span data-ttu-id="6a13b-213">Qualquer alteração nos atributos (tipo, largura da coluna, se indexible) não será refletida no banco de dados depois que um esquema tiver sido registrado.</span><span class="sxs-lookup"><span data-stu-id="6a13b-213">Any changes to attributes (type, column width, whether indexible) will not be reflected in the database after a schema has been registered.</span></span> <span data-ttu-id="6a13b-214">As únicas maneiras de ter essas alterações reconhecidas depois que o esquema foi registrado uma vez em um sistema seriam recriar o índice e, em seguida, registrar o novo esquema, ou registrar o esquema e, em seguida, criar uma nova propriedade para cada versão subsequente; por exemplo `PKEY_GroupName_PropertyNameV2` , `PKEY_GroupName_PropertyNameV3` , e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="6a13b-214">The only ways to have these changes recognized after the schema has been registered once on a system would be either to rebuild the index and then register the new schema, or to register the schema and then create a new property for each subsequent release; for example `PKEY_GroupName_PropertyNameV2`, `PKEY_GroupName_PropertyNameV3`, and so forth.</span></span> <span data-ttu-id="6a13b-215">Não recomendamos a criação de novas propriedades dessa maneira, pois várias colunas estranhas podem afetar o desempenho do sistema.</span><span class="sxs-lookup"><span data-stu-id="6a13b-215">We do not recommend creating new properties in this manner, because multiple extraneous columns may impact system performance.</span></span>

## <a name="windows-property-system-documentation"></a><span data-ttu-id="6a13b-216">Documentação do sistema de propriedades do Windows</span><span class="sxs-lookup"><span data-stu-id="6a13b-216">Windows Property System Documentation</span></span>

<span data-ttu-id="6a13b-217">O restante desta documentação contém as seguintes seções:</span><span class="sxs-lookup"><span data-stu-id="6a13b-217">The remainder of this documentation contains the following sections:</span></span>

-   [<span data-ttu-id="6a13b-218">Guia do desenvolvedor do sistema de propriedades do Windows</span><span class="sxs-lookup"><span data-stu-id="6a13b-218">Windows Property System Developer's Guide</span></span>](property-system-developer-s-guide.md)

    <span data-ttu-id="6a13b-219">Descreve detalhadamente como implementar os principais cenários de desenvolvimento usando o sistema de propriedades do Windows.</span><span class="sxs-lookup"><span data-stu-id="6a13b-219">Describes in detail how to implement the main development scenarios using the Windows Property System.</span></span>

-   [<span data-ttu-id="6a13b-220">Referência do sistema de propriedades</span><span class="sxs-lookup"><span data-stu-id="6a13b-220">Property System Reference</span></span>](property-system-reference.md)

    <span data-ttu-id="6a13b-221">Documenta as [Propriedades do Windows](props.md), o [esquema de descrição de propriedade](property-description-schema.md), as [interfaces](interfaces.md), as [funções](functions.md), as [estruturas](structures.md)e as [constantes, enumerações e sinalizadores](constants--enumerations--and-flags.md) do sistema de propriedades do Windows.</span><span class="sxs-lookup"><span data-stu-id="6a13b-221">Documents the [Windows Properties](props.md), [Property Description Schema](property-description-schema.md), [Interfaces](interfaces.md), [Functions](functions.md), [Structures](structures.md), and [Constants, Enumerations, and Flags](constants--enumerations--and-flags.md) of the Windows Property System.</span></span>

-   [<span data-ttu-id="6a13b-222">Exemplos de código do sistema de propriedades</span><span class="sxs-lookup"><span data-stu-id="6a13b-222">Property System Code Samples</span></span>](property-system-code-samples.md)

    <span data-ttu-id="6a13b-223">Descreve exemplos que demonstram como usar o sistema de propriedades do Windows.</span><span class="sxs-lookup"><span data-stu-id="6a13b-223">Describes samples that demonstrate how to use the Windows Property System.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="6a13b-224">Recursos adicionais</span><span class="sxs-lookup"><span data-stu-id="6a13b-224">Additional Resources</span></span>

-   <span data-ttu-id="6a13b-225">Para obter informações sobre como reutilizar o repositório de propriedades In-Memory, consulte [inicializando manipuladores de propriedade](building-property-handlers-property-handlers.md) e [**PSCreateMemoryPropertyStore**](/windows/desktop/api/Propsys/nf-propsys-pscreatememorypropertystore).</span><span class="sxs-lookup"><span data-stu-id="6a13b-225">For information about reusing the In-Memory Property Store, see [Initializing Property Handlers](building-property-handlers-property-handlers.md) and [**PSCreateMemoryPropertyStore**](/windows/desktop/api/Propsys/nf-propsys-pscreatememorypropertystore).</span></span>
-   <span data-ttu-id="6a13b-226">Para obter uma especificação do formato de arquivo binário do armazenamento de propriedades da Microsoft, consulte [ \[ MS \_ PROPSTORE \] ](/openspecs/windows_protocols/ms-propstore/39ea873f-7af5-44dd-92f9-bc1f293852cc).</span><span class="sxs-lookup"><span data-stu-id="6a13b-226">For a specification of the Microsoft Property Store Binary File Format, see [\[MS\_PROPSTORE\]](/openspecs/windows_protocols/ms-propstore/39ea873f-7af5-44dd-92f9-bc1f293852cc).</span></span>
-   <span data-ttu-id="6a13b-227">A relação entre a pesquisa e a indexação do Windows e como estender o índice é explicada nos seguintes tópicos do Windows Search:</span><span class="sxs-lookup"><span data-stu-id="6a13b-227">The relationship between Windows Search and indexing, and how to extend the index, are explained in the following topics in Windows Search:</span></span>
    -   [<span data-ttu-id="6a13b-228">Desenvolvendo manipuladores de filtro para o Windows Search</span><span class="sxs-lookup"><span data-stu-id="6a13b-228">Developing Filter Handlers for Windows Search</span></span>](../search/-search-ifilter-conceptual.md)
    -   [<span data-ttu-id="6a13b-229">Desenvolvendo manipuladores de protocolo para o Windows Search</span><span class="sxs-lookup"><span data-stu-id="6a13b-229">Developing Protocol Handlers for Windows Search</span></span>](../search/-search-3x-wds-phaddins.md)
    -   [<span data-ttu-id="6a13b-230">Desenvolvendo manipuladores de propriedade para o Windows Search</span><span class="sxs-lookup"><span data-stu-id="6a13b-230">Developing Property Handlers for Windows Search</span></span>](../search/-search-3x-wds-extidx-propertyhandlers.md)
    -   <span data-ttu-id="6a13b-231">Para obter o download do SDK do Windows Vista ou atualizado, consulte a [SDK do Windows](https://msdn.microsoft.com/windowsvista/bb980924.aspx).</span><span class="sxs-lookup"><span data-stu-id="6a13b-231">For the Windows 7 or updated Windows Vista SDK download, see the [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx).</span></span>

## <a name="related-topics"></a><span data-ttu-id="6a13b-232">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="6a13b-232">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="6a13b-233">Guia do desenvolvedor do sistema de propriedades do Windows</span><span class="sxs-lookup"><span data-stu-id="6a13b-233">Windows Property System Developer's Guide</span></span>](property-system-developer-s-guide.md)
</dt> <dt>

[<span data-ttu-id="6a13b-234">Referência do sistema de propriedades</span><span class="sxs-lookup"><span data-stu-id="6a13b-234">Property System Reference</span></span>](property-system-reference.md)
</dt> <dt>

[<span data-ttu-id="6a13b-235">Exemplos de código do sistema de propriedades</span><span class="sxs-lookup"><span data-stu-id="6a13b-235">Property System Code Samples</span></span>](property-system-code-samples.md)
</dt> </dl>

 

 
