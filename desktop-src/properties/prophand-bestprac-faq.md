---
description: Este artigo inclui as práticas recomendadas e perguntas frequentes sobre como criar e registrar manipuladores de propriedade para trabalhar com o sistema de propriedades do Windows.
ms.assetid: E583A00B-F615-41c8-AECF-061F1396DB9A
title: Práticas recomendadas e perguntas frequentes do manipulador de propriedades
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5605c39f1021fcfe91259405bb99f8981510d3dc
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/19/2021
ms.locfileid: "112405949"
---
# <a name="property-handler-best-practices-and-faq"></a><span data-ttu-id="cef00-103">Práticas recomendadas e perguntas frequentes do manipulador de propriedades</span><span class="sxs-lookup"><span data-stu-id="cef00-103">Property Handler Best Practices and FAQ</span></span>

<span data-ttu-id="cef00-104">Este tópico explica como criar e registrar manipuladores de propriedade para trabalhar com o sistema de propriedades do Windows.</span><span class="sxs-lookup"><span data-stu-id="cef00-104">This topic explains how to create and register property handlers to work with the Windows property system.</span></span>

<span data-ttu-id="cef00-105">Este tópico é organizado da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="cef00-105">This topic is organized as follows:</span></span>

-   [<span data-ttu-id="cef00-106">Práticas recomendadas</span><span class="sxs-lookup"><span data-stu-id="cef00-106">Best Practices</span></span>](#property-handler-best-practices-and-faq)
    -   [<span data-ttu-id="cef00-107">Substituindo Propriedades do sistema de arquivos</span><span class="sxs-lookup"><span data-stu-id="cef00-107">Overriding File System Properties</span></span>](#overriding-file-system-properties)
    -   [<span data-ttu-id="cef00-108">Armazenando Propriedades em formatos de arquivo baseados em XML</span><span class="sxs-lookup"><span data-stu-id="cef00-108">Storing Properties in XML-based File Formats</span></span>](#storing-properties-in-xml-based-file-formats)
    -   [<span data-ttu-id="cef00-109">Propriedades computadas</span><span class="sxs-lookup"><span data-stu-id="cef00-109">Computed Properties</span></span>](#computed-properties)
-   [<span data-ttu-id="cef00-110">Perguntas frequentes</span><span class="sxs-lookup"><span data-stu-id="cef00-110">Frequently Asked Questions</span></span>](#property-handler-best-practices-and-faq)
-   [<span data-ttu-id="cef00-111">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="cef00-111">Related topics</span></span>](#related-topics)

## <a name="best-practices"></a><span data-ttu-id="cef00-112">Práticas Recomendadas</span><span class="sxs-lookup"><span data-stu-id="cef00-112">Best Practices</span></span>

<span data-ttu-id="cef00-113">As práticas recomendadas descritas aqui fornecem dicas úteis de implementação.</span><span class="sxs-lookup"><span data-stu-id="cef00-113">The best practices outlined here provide useful implementation tips.</span></span>

### <a name="overriding-file-system-properties"></a><span data-ttu-id="cef00-114">Substituindo Propriedades do sistema de arquivos</span><span class="sxs-lookup"><span data-stu-id="cef00-114">Overriding File System Properties</span></span>

<span data-ttu-id="cef00-115">Algumas propriedades de arquivos são fornecidas pela fonte de dados do sistema de arquivos, como:</span><span class="sxs-lookup"><span data-stu-id="cef00-115">Some properties for files are provided by the file system data source, such as:</span></span>

-   <span data-ttu-id="cef00-116">\_Nome de arquivo PKEY</span><span class="sxs-lookup"><span data-stu-id="cef00-116">PKEY\_FileName</span></span>
-   <span data-ttu-id="cef00-117">\_Extensão PKEY</span><span class="sxs-lookup"><span data-stu-id="cef00-117">PKEY\_Extension</span></span>
-   <span data-ttu-id="cef00-118">PKEY \_ modifiedtime</span><span class="sxs-lookup"><span data-stu-id="cef00-118">PKEY\_ModifiedTime</span></span>

<span data-ttu-id="cef00-119">Em geral, os manipuladores de propriedade não podem fornecer valores para essas propriedades.</span><span class="sxs-lookup"><span data-stu-id="cef00-119">In general, property handlers cannot provide values for these properties.</span></span> <span data-ttu-id="cef00-120">No entanto, em alguns casos, essas propriedades podem ser substituídas com base nas informações de registro fornecidas pelo manipulador de propriedade.</span><span class="sxs-lookup"><span data-stu-id="cef00-120">However, in some cases these properties can be overridden based on registration information provided by the property handler.</span></span> <span data-ttu-id="cef00-121">Manipuladores de propriedade populam **\_ classes hKey \_ raiz** \\ **CLSID** \\ *{Handler CLSID}* \\ **OverrideFileSystemProperties** com os nomes das propriedades que desejam substituir.</span><span class="sxs-lookup"><span data-stu-id="cef00-121">Property handlers populate **HKEY\_CLASSES\_ROOT**\\**CLSID**\\ *{handler clsid}*\\**OverrideFileSystemProperties** with the names of properties that they want to override.</span></span> <span data-ttu-id="cef00-122">Isso é limitado a um conjunto fixo de propriedades mostrado na lista a seguir da qual o sistema tem conhecimento.</span><span class="sxs-lookup"><span data-stu-id="cef00-122">This is limited to a fixed set of properties shown in the following list of which the system has knowledge.</span></span>

<span data-ttu-id="cef00-123">A substituição tem suporte para os seguintes valores de propriedade:</span><span class="sxs-lookup"><span data-stu-id="cef00-123">Overriding is supported for the following property values:</span></span>

-   [<span data-ttu-id="cef00-124">Sistema. Kind</span><span class="sxs-lookup"><span data-stu-id="cef00-124">System.Kind</span></span>](./props-system-kind.md)
-   [<span data-ttu-id="cef00-125">System. FileName</span><span class="sxs-lookup"><span data-stu-id="cef00-125">System.FileName</span></span>](./props-system-filename.md)
-   [<span data-ttu-id="cef00-126">System. IsPinnedToNameSpaceTree</span><span class="sxs-lookup"><span data-stu-id="cef00-126">System.IsPinnedToNameSpaceTree</span></span>](./props-system-ispinnedtonamespacetree.md)
-   [<span data-ttu-id="cef00-127">System.ItemNameDisplay</span><span class="sxs-lookup"><span data-stu-id="cef00-127">System.ItemNameDisplay</span></span>](./props-system-itemnamedisplay.md)
-   [<span data-ttu-id="cef00-128">System. SFGAOFlags</span><span class="sxs-lookup"><span data-stu-id="cef00-128">System.SFGAOFlags</span></span>](./props-system-sfgaoflags.md)
-   [<span data-ttu-id="cef00-129">System. ItemPathDisplay</span><span class="sxs-lookup"><span data-stu-id="cef00-129">System.ItemPathDisplay</span></span>](./props-system-itempathdisplay.md)
-   [<span data-ttu-id="cef00-130">System. ItemPathDisplayNarrow</span><span class="sxs-lookup"><span data-stu-id="cef00-130">System.ItemPathDisplayNarrow</span></span>](./props-system-itempathdisplaynarrow.md)
-   [<span data-ttu-id="cef00-131">System. ItemFolderNameDisplay</span><span class="sxs-lookup"><span data-stu-id="cef00-131">System.ItemFolderNameDisplay</span></span>](./props-system-itemfoldernamedisplay.md)
-   [<span data-ttu-id="cef00-132">System. ItemFolderPathDisplay</span><span class="sxs-lookup"><span data-stu-id="cef00-132">System.ItemFolderPathDisplay</span></span>](./props-system-itemfolderpathdisplay.md)
-   [<span data-ttu-id="cef00-133">System. ItemFolderPathDisplayNarrow</span><span class="sxs-lookup"><span data-stu-id="cef00-133">System.ItemFolderPathDisplayNarrow</span></span>](./props-system-itemfolderpathdisplaynarrow.md)

<span data-ttu-id="cef00-134">Para obter uma lista completa de todas as propriedades do Shell, consulte [Propriedades do Shell](./props.md).</span><span class="sxs-lookup"><span data-stu-id="cef00-134">For a full list of all Shell properties, see [Shell Properties](./props.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="cef00-135">Os valores de propriedade substituídos são usados somente quando os arquivos são indexados.</span><span class="sxs-lookup"><span data-stu-id="cef00-135">The overridden property values are used only when the files are indexed.</span></span> <span data-ttu-id="cef00-136">Assim, a pesquisa de arquivos da fonte de dados do sistema de arquivos não revela os valores substituídos.</span><span class="sxs-lookup"><span data-stu-id="cef00-136">Thus, browsing files from the file system data source does not reveal the overridden values.</span></span>

 

### <a name="storing-properties-in-xml-based-file-formats"></a><span data-ttu-id="cef00-137">Armazenando Propriedades em formatos de arquivo baseados em XML</span><span class="sxs-lookup"><span data-stu-id="cef00-137">Storing Properties in XML-based File Formats</span></span>

<span data-ttu-id="cef00-138">Há duas opções básicas disponíveis para armazenar propriedades em formatos de arquivo baseados em XML:</span><span class="sxs-lookup"><span data-stu-id="cef00-138">There are two basic options available for storing properties in XML-based file formats:</span></span>

-   <span data-ttu-id="cef00-139">Armazene cada propriedade usando elementos XML e atributos de acordo com o esquema XML do documento.</span><span class="sxs-lookup"><span data-stu-id="cef00-139">Store each property using XML elements and attributes according to the XML schema of the document.</span></span> <span data-ttu-id="cef00-140">Essa abordagem é mais "amigável para XML".</span><span class="sxs-lookup"><span data-stu-id="cef00-140">This approach is more "XML friendly".</span></span>
-   <span data-ttu-id="cef00-141">Serialize todo o repositório de propriedades em um BLOB (objeto binário grande) de memória, converta o BLOB em uma cadeia de caracteres codificada em Base64 e, em seguida, armazene essa cadeia de caracteres no XML.</span><span class="sxs-lookup"><span data-stu-id="cef00-141">Serialize the entire property store into a memory Binary large object (BLOB), convert the BLOB into a base64-encoded string, and then store that string in the XML.</span></span> <span data-ttu-id="cef00-142">Essa é a mais simples das duas abordagens e pode ser usada para fornecer suporte trivial aos metadados abertos.</span><span class="sxs-lookup"><span data-stu-id="cef00-142">This is the simpler of the two approaches and can be used to trivially provide support for open metadata.</span></span>

<span data-ttu-id="cef00-143">Alguns manipuladores podem combinar essas abordagens, armazenando alguns valores importantes no formato XML padrão e armazenando o restante em um BLOB, por exemplo.</span><span class="sxs-lookup"><span data-stu-id="cef00-143">Some handlers might combine these approaches, storing some important values in standard XML format and storing the rest in a BLOB, for example.</span></span>

### <a name="computed-properties"></a><span data-ttu-id="cef00-144">Propriedades computadas</span><span class="sxs-lookup"><span data-stu-id="cef00-144">Computed Properties</span></span>

<span data-ttu-id="cef00-145">Algumas propriedades são derivadas de atributos específicos de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="cef00-145">Some properties are derived from specific attributes of a file.</span></span> <span data-ttu-id="cef00-146">Por exemplo, a propriedade [System. Image. Dimensions](./props-system-image-dimensions.md) é determinada pelas dimensões reais da imagem em um arquivo de imagem.</span><span class="sxs-lookup"><span data-stu-id="cef00-146">For example, the [System.Image.Dimensions](./props-system-image-dimensions.md) property is determined by the actual dimensions of the image in an image file.</span></span> <span data-ttu-id="cef00-147">Como esses valores de propriedade não podem ser alterados pelo manipulador de propriedades, eles são marcados `isInnate="true"` na descrição da propriedade.</span><span class="sxs-lookup"><span data-stu-id="cef00-147">Because such property values cannot be changed by the property handler, they are thus marked `isInnate="true"` in the property description.</span></span> <span data-ttu-id="cef00-148">Outras propriedades são computadas de uma parte de uma propriedade específica ou agregando os valores de várias propriedades.</span><span class="sxs-lookup"><span data-stu-id="cef00-148">Other properties are computed from a part of a specific property or by aggregating the values of multiple properties.</span></span> <span data-ttu-id="cef00-149">Como as atualizações dessas propriedades "computadas" poderiam criar ambiguidades quanto à forma como os valores de "origem" devem ser alterados, as propriedades computadas devem ser marcadas `isInnate="true"` na descrição da propriedade ou relatadas como somente leitura.</span><span class="sxs-lookup"><span data-stu-id="cef00-149">Because updates to these "computed" properties would create ambiguity as to how the "source" values should be changed, computed properties should be marked `isInnate="true"` in the property description or reported as read-only.</span></span> <span data-ttu-id="cef00-150">A última opção está disponível instruindo o manipulador a retornar S \_ false de [**IPropertyStoreCapabilities:: IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable).</span><span class="sxs-lookup"><span data-stu-id="cef00-150">The latter option is available by instructing the handler to return S\_FALSE from [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable).</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="cef00-151">Perguntas frequentes</span><span class="sxs-lookup"><span data-stu-id="cef00-151">Frequently Asked Questions</span></span>

<span data-ttu-id="cef00-152">Esta seção fornece respostas para perguntas frequentes sobre propriedades e manipuladores de propriedade e respostas de acompanhamento.</span><span class="sxs-lookup"><span data-stu-id="cef00-152">This section provides answers to frequently asked questions about properties and property handlers, and accompanying answers.</span></span>

-   <span data-ttu-id="cef00-153">**Pergunta:** Por que o meu manipulador de propriedades não está sendo carregado pelo indexador do Windows Search?</span><span class="sxs-lookup"><span data-stu-id="cef00-153">**Question:** Why isn't my property handler being loaded by the Windows Search indexer?</span></span>

    <span data-ttu-id="cef00-154">O indexador de pesquisa do Windows é executado como um serviço do sistema e não pode carregar DLLs armazenadas no diretório de perfil do usuário.</span><span class="sxs-lookup"><span data-stu-id="cef00-154">The Windows Search indexer runs as a system service and cannot load DLLs that are stored in the user profile directory.</span></span> <span data-ttu-id="cef00-155">Se você estiver criando e Depurando usando Microsoft Visual Studio, ele posicionará a DLL no seu perfil de usuário (e, portanto, não será carregado pelo indexador).</span><span class="sxs-lookup"><span data-stu-id="cef00-155">If you are building and debugging using Microsoft Visual Studio, it will place the DLL in your user profile (and therefore it won't be loaded by the indexer).</span></span> <span data-ttu-id="cef00-156">Para solucionar esse erro, copie a DLL fora da sua pasta de perfil (por exemplo, em **C: \\ Program Files \\ nomedoseuaplicativo**) e registre-o lá.</span><span class="sxs-lookup"><span data-stu-id="cef00-156">To work around this, copy your DLL outside of your profile folder (for example, into **C:\\Program Files\\YourAppName**) and register it there.</span></span>

    <span data-ttu-id="cef00-157">Para obter diretrizes mais específicas sobre como desenvolver manipuladores de propriedade para trabalhar com o indexador do Windows Search, consulte [desenvolvendo manipuladores de propriedade para o Windows Search](../search/-search-3x-wds-extidx-propertyhandlers.md).</span><span class="sxs-lookup"><span data-stu-id="cef00-157">For more specific guidance on developing property handlers to work with the Windows Search indexer, see [Developing Property Handlers for Windows Search](../search/-search-3x-wds-extidx-propertyhandlers.md).</span></span>

-   <span data-ttu-id="cef00-158">**Pergunta:** Quais propriedades devem ser detectáveis por meio dos métodos de enumeração [**IPropertyStore:: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) e [**IPropertyStore:: GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) ?</span><span class="sxs-lookup"><span data-stu-id="cef00-158">**Question:** Which properties should be discoverable through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) enumeration methods?</span></span>

    <span data-ttu-id="cef00-159">Nem todos os clientes dos objetos de armazenamento de propriedade usam esses métodos.</span><span class="sxs-lookup"><span data-stu-id="cef00-159">Not all clients of property store objects use these methods.</span></span> <span data-ttu-id="cef00-160">Alguns clientes estão cientes das propriedades que planejam solicitar diretamente (por nome de PKEY) ou recebem informações de propriedade por meio de uma lista de descrição de propriedade.</span><span class="sxs-lookup"><span data-stu-id="cef00-160">Some clients are aware of the properties they plan to request directly (by PKEY name), or receive property information through a property description list.</span></span> <span data-ttu-id="cef00-161">Os métodos de descoberta de propriedade suportem vários outros cenários.</span><span class="sxs-lookup"><span data-stu-id="cef00-161">The property discovery methods suppport several other scenarios.</span></span> <span data-ttu-id="cef00-162">Se uma propriedade não precisar participar desses cenários, ela não precisará ser enumerada.</span><span class="sxs-lookup"><span data-stu-id="cef00-162">If a property does not need to participate in these scenarios, it does not need to be enumerated.</span></span> <span data-ttu-id="cef00-163">Portanto, um manipulador de propriedades pode produzir um valor não-VT \_ vazio para propriedades que não são descobertas por meio dos métodos [**IPropertyStore:: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) e [**IPropertyStore:: GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="cef00-163">Hence, a property handler can produce a non-VT\_EMPTY value for properties that are not discovered through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) methods.</span></span>

    <span data-ttu-id="cef00-164">No entanto, as propriedades devem ser visíveis por meio desses métodos se qualquer uma das seguintes condições forem atendidas:</span><span class="sxs-lookup"><span data-stu-id="cef00-164">However, properties should be visible via these methods if any of the following conditions are met:</span></span>

    -   <span data-ttu-id="cef00-165">**Se a propriedade for indexada para que seja pesquisável:** Isso significa que ele está incluído no armazenamento de propriedades de pesquisa do Windows (indicado por `isColumn = "true"` no esquema de descrição da propriedade) ou disponível para pesquisas de texto completo ( `inInvertedIndex = "true"` ).</span><span class="sxs-lookup"><span data-stu-id="cef00-165">**If the property is indexed so that it is searchable:** This means it is included in the Windows Search property store (denoted by `isColumn = "true"` in the property description schema) or available for full text searches (`inInvertedIndex = "true"`).</span></span> <span data-ttu-id="cef00-166">Na ausência desses sinalizadores ou na ausência de uma descrição de propriedade, as propriedades do tipo "String" serão adicionadas automaticamente ao índice invertido para habilitar a pesquisa.</span><span class="sxs-lookup"><span data-stu-id="cef00-166">In the absence of these flags or the absence of a property description, properties of type "string" will be added automatically to the inverted index to enable searching.</span></span> <span data-ttu-id="cef00-167">Como a lista de propriedades conhecidas (aquelas com descrições de propriedade instaladas) no sistema de propriedades é muito grande (mais de 800 Propriedades), seria impraticável perguntar a cada manipulador de propriedade todas as propriedades registradas no sistema de propriedades.</span><span class="sxs-lookup"><span data-stu-id="cef00-167">Because the list of known properties (those with installed property descriptions) in the property system is very large (more than 800 properties), it would be impractical to ask every property handler for every property registered in the property system.</span></span> <span data-ttu-id="cef00-168">Em vez disso, o processo de indexação enumera as propriedades relevantes do manipulador de propriedade para cada item que indexa e usa os valores das propriedades enumeradas para criar o índice de texto completo.</span><span class="sxs-lookup"><span data-stu-id="cef00-168">Instead, the indexing process enumerates the relevant properties from the property handler for each item it indexes, and it uses the values of the enumerated properties to build the full text index.</span></span>
    -   <span data-ttu-id="cef00-169">**Se a propriedade deve ser copiada quando o conjunto de propriedades do item for duplicado:** Para implementar uma função "copiar um conjunto de propriedades", o item de origem faz as propriedades que devem ser copiadas visíveis pelos métodos [**IPropertyStore:: GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) e [**IPropertyStore:: GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="cef00-169">**If the property should be copied when the item's property set is duplicated:** To implement a "copy a property set" function, the source item makes the properties that should be copied visible through the [**IPropertyStore::GetCount**](/previous-versions/windows/desktop/legacy/bb761472(v=vs.85)) and [**IPropertyStore::GetAt**](/previous-versions/windows/desktop/legacy/bb761471(v=vs.85)) methods.</span></span> <span data-ttu-id="cef00-170">As propriedades que não precisam ser copiadas ou não fazem sentido ser copiada não devem ser incluídas.</span><span class="sxs-lookup"><span data-stu-id="cef00-170">Properties that do not need to be copied or do not make sense being copied should not be included.</span></span>
    -   <span data-ttu-id="cef00-171">**Se o valor da propriedade não estiver vazio (VT \_ Empty):** os valores de propriedade vazios não serão úteis para os clientes.</span><span class="sxs-lookup"><span data-stu-id="cef00-171">**If the property value is not empty (VT\_EMPTY):** Property values that are empty are not useful for clients.</span></span> <span data-ttu-id="cef00-172">Quando os clientes tentam retornar valores de propriedade vazios, um valor de VT \_ vazio é retornado.</span><span class="sxs-lookup"><span data-stu-id="cef00-172">When clients attempt to return empty property values, a value of VT\_EMPTY is returned.</span></span> <span data-ttu-id="cef00-173">Portanto, as propriedades com valores vazios não devem ser enumeradas.</span><span class="sxs-lookup"><span data-stu-id="cef00-173">Thus, properties with empty values should not be enumerated.</span></span>
    -   <span data-ttu-id="cef00-174">**Se a propriedade deve ser removida ao invocar a função "remover propriedades":** Este recurso existe para proteger a privacidade; Ele descobre todos os valores do manipulador de propriedade por meio da enumeração e Remove cada um selecionado para remoção pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="cef00-174">**If the property should be removed when invoking the "remove properties" function:** This feature exists to protect privacy; it discovers all values from the property handler through enumeration and removes each one selected for removal by the user.</span></span>
        > [!Note]  
        > <span data-ttu-id="cef00-175">Enumerar Propriedades não comunica o conjunto de propriedades que um manipulador de propriedade específico suporta se o manipulador der suporte a um esquema fixo (e não a metadados abertos).</span><span class="sxs-lookup"><span data-stu-id="cef00-175">Enumerating properties does not communicate the set of properties that a particular property handler supports if the handler supports a fixed schema (and not open metadata).</span></span> <span data-ttu-id="cef00-176">Em vez disso, esses manipuladores devem documentar o conjunto de propriedades que eles suportam.</span><span class="sxs-lookup"><span data-stu-id="cef00-176">Instead, such handlers should document the set of properties that they support.</span></span>

         

-   <span data-ttu-id="cef00-177">**Pergunta:** Como fazer saber quais formatos de arquivo dão suporte a metadados abertos?</span><span class="sxs-lookup"><span data-stu-id="cef00-177">**Question:** How do I know which file formats support open metadata?</span></span>

    <span data-ttu-id="cef00-178">Para obter informações sobre o suporte para metadados abertos, consulte "tipos de arquivo que dão suporte a metadados abertos" em [tipos de arquivo](../shell/fa-file-types.md).</span><span class="sxs-lookup"><span data-stu-id="cef00-178">For information about support for open metadata, see "File Types that Support Open Metadata" in [File Types](../shell/fa-file-types.md).</span></span>

-   <span data-ttu-id="cef00-179">**Pergunta:** \_Os valores nulos de VT podem ser armazenados usando um manipulador de propriedades?</span><span class="sxs-lookup"><span data-stu-id="cef00-179">**Question:** Can VT\_NULL values be stored using a property handler?</span></span>

    <span data-ttu-id="cef00-180">Não.</span><span class="sxs-lookup"><span data-stu-id="cef00-180">No.</span></span> <span data-ttu-id="cef00-181">\_Os valores nulos de VT serão convertidos em VT \_ vazio em chamadas para [**IPropertyStore:: GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) e [**IPropertyStore:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="cef00-181">VT\_NULL values will be converted to VT\_EMPTY on calls to [**IPropertyStore::GetValue**](/previous-versions/windows/desktop/legacy/bb761473(v=vs.85)) and [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

-   <span data-ttu-id="cef00-182">**Pergunta:** Quais formatos de cadeia de caracteres de data têm suporte na função [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) ?</span><span class="sxs-lookup"><span data-stu-id="cef00-182">**Question:** Which date string formats are supported by the [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) function?</span></span>

    <span data-ttu-id="cef00-183">Geralmente, as propriedades que representam os valores de data/hora devem ser representadas usando VT \_ FILETIME.</span><span class="sxs-lookup"><span data-stu-id="cef00-183">Generally, properties that represent date/time values should be represented using VT\_FILETIME.</span></span> <span data-ttu-id="cef00-184">No entanto, muitas fontes de dados fornecem essas informações em forma de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="cef00-184">However, many data sources provide this information in string form.</span></span> <span data-ttu-id="cef00-185">A API auxiliar do [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) dá suporte à coerção de alguns formatos de data de cadeia de caracteres em valores [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) , conforme mostrado na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="cef00-185">The [**PropVariantChangeType**](/windows/win32/api/propvarutil/nf-propvarutil-propvariantchangetype) helper API supports coercing some string date formats into [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) values, as shown in the following table.</span></span>

    

    | <span data-ttu-id="cef00-186">Formatar</span><span class="sxs-lookup"><span data-stu-id="cef00-186">Format</span></span>                  | <span data-ttu-id="cef00-187">Windows Vista, Windows XP e Microsoft Windows Desktop Search (WDS)</span><span class="sxs-lookup"><span data-stu-id="cef00-187">Windows Vista, Windows XP, and Microsoft Windows Desktop Search (WDS)</span></span> | <span data-ttu-id="cef00-188">Windows 7</span><span class="sxs-lookup"><span data-stu-id="cef00-188">Windows 7</span></span> | <span data-ttu-id="cef00-189">Observações</span><span class="sxs-lookup"><span data-stu-id="cef00-189">Notes</span></span>                                                                                                                                                                                                 |
    |-------------------------|-----------------------------------------------------------------------|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | <span data-ttu-id="cef00-190">aaaa/mm/dd: hh: mm: SS. uuu</span><span class="sxs-lookup"><span data-stu-id="cef00-190">yyyy/mm/dd:hh:mm:ss.uuu</span></span> | <span data-ttu-id="cef00-191">Sim</span><span class="sxs-lookup"><span data-stu-id="cef00-191">Yes</span></span>                                                                   | <span data-ttu-id="cef00-192">Sim</span><span class="sxs-lookup"><span data-stu-id="cef00-192">Yes</span></span>       | <span data-ttu-id="cef00-193">HORÁRIO y = ano, m = mês, d = data, h = horas (relógio de 24 horas), m = minutos, s = segundos, u = microssegundos</span><span class="sxs-lookup"><span data-stu-id="cef00-193">UTC; y=year, m=month, d=date, h=hours (24-hour clock), m=minutes, s=seconds, u=microseconds</span></span>                                                                                                           |
    | <span data-ttu-id="cef00-194">aaaa-mm-ddThh: mm: ssZ</span><span class="sxs-lookup"><span data-stu-id="cef00-194">yyyy-mm-ddThh:mm:ssZ</span></span>    | <span data-ttu-id="cef00-195">Não</span><span class="sxs-lookup"><span data-stu-id="cef00-195">No</span></span>                                                                    | <span data-ttu-id="cef00-196">Sim</span><span class="sxs-lookup"><span data-stu-id="cef00-196">Yes</span></span>       | <span data-ttu-id="cef00-197">**Especificação de formato ISO8601** UTC (indicado pelo indicador de fuso horário ' Z '); y = ano, m = mês, d = data, h = horas (relógio de 24 horas), m = minutos, s = segundos; ' T' é um delimitador para a parte de tempo.</span><span class="sxs-lookup"><span data-stu-id="cef00-197">**ISO8601 format specification** UTC (denoted by 'Z' time zone indicator); y=year, m=month, d=date, h=hours (24-hour clock), m=minutes, s=seconds; 'T' is a delimiter for the time portion.</span></span><br/> |

    

     

-   <span data-ttu-id="cef00-198">**Pergunta:** É possível criar um manipulador de propriedades somente leitura?</span><span class="sxs-lookup"><span data-stu-id="cef00-198">**Question:** Is it possible to create a read-only property handler?</span></span>

    <span data-ttu-id="cef00-199">Sim.</span><span class="sxs-lookup"><span data-stu-id="cef00-199">Yes.</span></span> <span data-ttu-id="cef00-200">Algumas implementações do manipulador de propriedades não dão suporte à gravação de valores de propriedade.</span><span class="sxs-lookup"><span data-stu-id="cef00-200">Some property handler implementations do not support writing of property values.</span></span> <span data-ttu-id="cef00-201">Esses manipuladores de propriedade devem retornar STGM \_ E \_ ACCESSDENIED em chamadas para **IInitializeXXX:: Initialize** que passem STGM \_ ReadWrite ou em qualquer chamada para [**IPropertyStore:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="cef00-201">These property handlers should return STGM\_E\_ACCESSDENIED on calls to **IInitializeXXX::Initialize** that pass STGM\_READWRITE, or on any call to [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

    <span data-ttu-id="cef00-202">Todos os manipuladores de propriedade abertos no \_ modo de leitura STGM devem retornar STGM \_ E \_ ACCESSDENIED em chamadas para [**IPropertyStore:: SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="cef00-202">All property handlers opened in STGM\_READ mode should return STGM\_E\_ACCESSDENIED on calls to [**IPropertyStore::SetValue**](/previous-versions/windows/desktop/legacy/bb761475(v=vs.85)).</span></span>

-   <span data-ttu-id="cef00-203">**Pergunta:** Um manipulador de propriedades pode tratar uma propriedade como somente leitura, mesmo que o esquema indique que a propriedade é gravável?</span><span class="sxs-lookup"><span data-stu-id="cef00-203">**Question:** Can a property handler treat a property as read-only, even if the schema indicates that the property is writeable?</span></span>

    <span data-ttu-id="cef00-204">Sim.</span><span class="sxs-lookup"><span data-stu-id="cef00-204">Yes.</span></span> <span data-ttu-id="cef00-205">No sistema de esquema, as propriedades são anotadas como somente leitura (incluindo aquelas com `isInnate = "true"` ) ou leitura/gravação.</span><span class="sxs-lookup"><span data-stu-id="cef00-205">In the schema system, properties are annotated as read-only (including those with `isInnate = "true"`) or read/write.</span></span> <span data-ttu-id="cef00-206">Os manipuladores de propriedade que não dão suporte à gravação de uma determinada propriedade que o esquema diz devem ser graváveis devem implementar [**IPropertyStoreCapabilities**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) e retornar S \_ false em chamadas para [**IPropertyStoreCapabilities:: IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) para essa propriedade.</span><span class="sxs-lookup"><span data-stu-id="cef00-206">Property handlers that do not support writing a particular property that the schema says should be writeable should implement [**IPropertyStoreCapabilities**](/windows/win32/api/propsys/nn-propsys-ipropertystorecapabilities) and return S\_FALSE on calls to [**IPropertyStoreCapabilities::IsPropertyWritable**](/windows/win32/api/propsys/nf-propsys-ipropertystorecapabilities-ispropertywritable) for that property.</span></span> <span data-ttu-id="cef00-207">Isso indica que no contexto desse manipulador e esse arquivo, a propriedade não é gravável.</span><span class="sxs-lookup"><span data-stu-id="cef00-207">This indicates that in the context of this handler and this file, the property is not writeable.</span></span>

    > [!Note]  
    > <span data-ttu-id="cef00-208">A ação inversa não é possível.</span><span class="sxs-lookup"><span data-stu-id="cef00-208">The reverse action is not possible.</span></span> <span data-ttu-id="cef00-209">Não é possível habilitar um manipulador de propriedades para gravar uma propriedade marcada como somente leitura no esquema</span><span class="sxs-lookup"><span data-stu-id="cef00-209">You cannot enable a property handler to write a property that is marked as read-only in the schema</span></span>

     

## <a name="related-topics"></a><span data-ttu-id="cef00-210">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="cef00-210">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="cef00-211">Noções básicas sobre manipuladores de propriedade</span><span class="sxs-lookup"><span data-stu-id="cef00-211">Understanding Property Handlers</span></span>](./building-property-handlers-properties.md)
</dt> <dt>

[<span data-ttu-id="cef00-212">Usando nomes de tipos</span><span class="sxs-lookup"><span data-stu-id="cef00-212">Using Kind Names</span></span>](./building-property-handlers-user-friendly-kind-names.md)
</dt> <dt>

[<span data-ttu-id="cef00-213">Usando listas de propriedades</span><span class="sxs-lookup"><span data-stu-id="cef00-213">Using Property Lists</span></span>](./building-property-handlers-property-lists.md)
</dt> <dt>

[<span data-ttu-id="cef00-214">Inicializando manipuladores de propriedade</span><span class="sxs-lookup"><span data-stu-id="cef00-214">Initializing Property Handlers</span></span>](./building-property-handlers-property-handlers.md)
</dt> <dt>

[<span data-ttu-id="cef00-215">Registrando e distribuindo manipuladores de propriedade</span><span class="sxs-lookup"><span data-stu-id="cef00-215">Registering and Distributing Property Handlers</span></span>](./prophand-reg-dist.md)
</dt> </dl>

 

 
