---
title: Estágio do sombreador Geometry
description: O estágio Geometry-Shader (GS) executa o código do sombreador especificado pelo aplicativo com vértices como entrada e a capacidade de gerar vértices na saída.
ms.assetid: F3208862-980E-403F-9154-13B34A882787
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: da66b1e3f9abf4e7db8010887f3e78676d02a874
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "103641371"
---
# <a name="geometry-shader-stage"></a><span data-ttu-id="92ac7-103">Estágio do sombreador Geometry</span><span class="sxs-lookup"><span data-stu-id="92ac7-103">Geometry Shader Stage</span></span>

<span data-ttu-id="92ac7-104">O estágio Geometry-Shader (GS) executa o código do sombreador especificado pelo aplicativo com vértices como entrada e a capacidade de gerar vértices na saída.</span><span class="sxs-lookup"><span data-stu-id="92ac7-104">The geometry-shader (GS) stage runs application-specified shader code with vertices as input and the ability to generate vertices on output.</span></span>

## <a name="the-geometry-shader"></a><span data-ttu-id="92ac7-105">O sombreador Geometry</span><span class="sxs-lookup"><span data-stu-id="92ac7-105">The Geometry Shader</span></span>

<span data-ttu-id="92ac7-106">Ao contrário dos sombreadores de vértice, que operam em um único vértice, as entradas do sombreador de geometria são os vértices de um primitivo completo (dois vértices para linhas, três vértices para triângulos ou um único vértice para ponto).</span><span class="sxs-lookup"><span data-stu-id="92ac7-106">Unlike vertex shaders, which operate on a single vertex, the geometry shader's inputs are the vertices for a full primitive (two vertices for lines, three vertices for triangles, or single vertex for point).</span></span> <span data-ttu-id="92ac7-107">Os sombreadores de geometria também podem trazer os dados de vértice para os primitivos adjacentes de borda como entrada (dois vértices adicionais para uma linha, três adicionais para um triângulo).</span><span class="sxs-lookup"><span data-stu-id="92ac7-107">Geometry shaders can also bring in the vertex data for the edge-adjacent primitives as input (an additional two vertices for a line, an additional three for a triangle).</span></span> <span data-ttu-id="92ac7-108">A ilustração a seguir mostra um triângulo e uma linha com vértices adjacentes.</span><span class="sxs-lookup"><span data-stu-id="92ac7-108">The following illustration shows a triangle and a line with adjacent vertices.</span></span>

![ilustração de um triângulo e uma linha com vértices adjacentes](images/d3d10-gs.png)

|     |                 |
|-----|-----------------|
| <span data-ttu-id="92ac7-110">TV</span><span class="sxs-lookup"><span data-stu-id="92ac7-110">TV</span></span>  | <span data-ttu-id="92ac7-111">Vértice do triângulo</span><span class="sxs-lookup"><span data-stu-id="92ac7-111">Triangle vertex</span></span> |
| <span data-ttu-id="92ac7-112">AV</span><span class="sxs-lookup"><span data-stu-id="92ac7-112">AV</span></span>  | <span data-ttu-id="92ac7-113">Vértice adjacentes</span><span class="sxs-lookup"><span data-stu-id="92ac7-113">Adjacent vertex</span></span> |
| <span data-ttu-id="92ac7-114">LV</span><span class="sxs-lookup"><span data-stu-id="92ac7-114">LV</span></span>  | <span data-ttu-id="92ac7-115">Vértice de linha</span><span class="sxs-lookup"><span data-stu-id="92ac7-115">Line vertex</span></span>     |



 

<span data-ttu-id="92ac7-116">O estágio Geometry-Shader pode consumir o \_ [valor gerado pelo sistema](d3d10-graphics-programming-guide-input-assembler-stage-using.md) da VA primitivaid que é gerado automaticamente pelo ia.</span><span class="sxs-lookup"><span data-stu-id="92ac7-116">The geometry-shader stage can consume the SV\_PrimitiveID [system-generated value](d3d10-graphics-programming-guide-input-assembler-stage-using.md) that is auto-generated by the IA.</span></span> <span data-ttu-id="92ac7-117">Isso permite que os dados por primitivo sejam buscados ou calculados, se desejado.</span><span class="sxs-lookup"><span data-stu-id="92ac7-117">This allows per-primitive data to be fetched or computed if desired.</span></span>

<span data-ttu-id="92ac7-118">O estágio Geometry-Shader é capaz de produzir vários vértices que formam uma única topologia selecionada (as topologias de saída do estágio GS disponíveis são: tristrip, linestrip e PointList).</span><span class="sxs-lookup"><span data-stu-id="92ac7-118">The geometry-shader stage is capable of outputting multiple vertices forming a single selected topology (GS stage output topologies available are: tristrip, linestrip, and pointlist).</span></span> <span data-ttu-id="92ac7-119">O número de primitivos emitidos pode variar livremente dentro de qualquer chamada do sombreador de geometria, embora o número máximo de vértices que podem ser emitidos deva ser declarado estaticamente.</span><span class="sxs-lookup"><span data-stu-id="92ac7-119">The number of primitives emitted can vary freely within any invocation of the geometry shader, though the maximum number of vertices that could be emitted must be declared statically.</span></span> <span data-ttu-id="92ac7-120">Os tamanhos de faixa emitidos a partir de uma chamada de sombreador de geometria podem ser arbitrários, e novas faixas podem ser criadas por meio da função HLSL [RestartStrip](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-so-restartstrip).</span><span class="sxs-lookup"><span data-stu-id="92ac7-120">Strip lengths emitted from a geometry shader invocation can be arbitrary, and new strips can be created via the [RestartStrip](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-so-restartstrip) HLSL function.</span></span>

<span data-ttu-id="92ac7-121">A saída do sombreador de geometria pode ser alimentada no estágio do rasterizador e/ou em um buffer de vértice na memória através do estágio de saída de fluxo.</span><span class="sxs-lookup"><span data-stu-id="92ac7-121">Geometry shader output may be fed to the rasterizer stage and/or to a vertex buffer in memory via the stream output stage.</span></span> <span data-ttu-id="92ac7-122">A saída alimentada na memória é expandida em listas de linhas/pontos/triângulos individuais (exatamente da forma como seriam passados para o rasterizador).</span><span class="sxs-lookup"><span data-stu-id="92ac7-122">Output fed to memory is expanded to individual point/line/triangle lists (exactly as they would be passed to the rasterizer).</span></span>

<span data-ttu-id="92ac7-123">Quando um sombreador de geometria está ativo, ele é chamado uma vez para cada primitivo passado para baixo ou gerado anteriormente no pipeline.</span><span class="sxs-lookup"><span data-stu-id="92ac7-123">When a geometry shader is active, it is invoked once for every primitive passed down or generated earlier in the pipeline.</span></span> <span data-ttu-id="92ac7-124">Cada invocação do sombreador de geometria vê como entrada os dados para a invocação do primitivo, independentemente de ser um único ponto, uma única linha ou um único triângulo.</span><span class="sxs-lookup"><span data-stu-id="92ac7-124">Each invocation of the geometry shader sees as input the data for the invoking primitive, whether that is a single point, a single line, or a single triangle.</span></span> <span data-ttu-id="92ac7-125">Uma faixa de triângulos de versões anteriores no pipeline resultaria em uma chamada de sombreador de geometria de cada triângulo individual na faixa (como se a faixa fosse expandida em uma lista de triângulos).</span><span class="sxs-lookup"><span data-stu-id="92ac7-125">A triangle strip from earlier in the pipeline would result in an invocation of the geometry shader for each individual triangle in the strip (as if the strip were expanded out into a triangle list).</span></span> <span data-ttu-id="92ac7-126">Todos os dados de entrada para cada vértice no primitivo individual estão disponíveis (ou seja, três vértices para triângulo), além de dados de vértice adjacentes, se aplicável/disponíveis.</span><span class="sxs-lookup"><span data-stu-id="92ac7-126">All the input data for each vertex in the individual primitive is available (i.e. 3 vertices for triangle), plus adjacent vertex data if applicable/available.</span></span>

<span data-ttu-id="92ac7-127">Um sombreador de geometria produz um vértice de dados por vez, acrescentando vértices a um objeto de fluxo de saída.</span><span class="sxs-lookup"><span data-stu-id="92ac7-127">A geometry shader outputs data one vertex at a time by appending vertices to an output stream object.</span></span> <span data-ttu-id="92ac7-128">A topologia dos fluxos é determinada por uma declaração fixa, escolhendo um destes: PointStream, LineStream ou TriangleStream como a saída para o estágio GS.</span><span class="sxs-lookup"><span data-stu-id="92ac7-128">The topology of the streams is determined by a fixed declaration, choosing one of: PointStream, LineStream, or TriangleStream as the output for the GS stage.</span></span> <span data-ttu-id="92ac7-129">Há três tipos de objetos de fluxo disponíveis, PointStream, LineStream e TriangleStream que são todos os objetos modelo.</span><span class="sxs-lookup"><span data-stu-id="92ac7-129">There are three types of stream objects available, PointStream, LineStream and TriangleStream which are all templated objects.</span></span> <span data-ttu-id="92ac7-130">A topologia da saída é determinada pelo seu tipo de objeto correspondente, enquanto o formato dos vértices acrescentado ao fluxo é determinado pelo tipo de modelo.</span><span class="sxs-lookup"><span data-stu-id="92ac7-130">The topology of the output is determined by their respective object type, while the format of the vertices appended to the stream is determined by the template type.</span></span> <span data-ttu-id="92ac7-131">A execução de uma instância do sombreador de geometria é atômica das outras chamadas, exceto pelo fato dos dados adicionados aos fluxos serem seriais.</span><span class="sxs-lookup"><span data-stu-id="92ac7-131">Execution of a geometry shader instance is atomic from other invocations, except that data added to the streams is serial.</span></span> <span data-ttu-id="92ac7-132">As saídas de uma determinada chamada de um sombreador de geometria são independentes de outras chamadas (porém a ordem é respeitada).</span><span class="sxs-lookup"><span data-stu-id="92ac7-132">The outputs of a given invocation of a geometry shader are independent of other invocations (though ordering is respected).</span></span> <span data-ttu-id="92ac7-133">Um sombreador de geometria gerando faixas de triângulos iniciará uma faixa tira em cada chamada.</span><span class="sxs-lookup"><span data-stu-id="92ac7-133">A geometry shader generating triangle strips will start a new strip on every invocation.</span></span>

<span data-ttu-id="92ac7-134">Quando uma saída de sombreador de geometria é identificada como um valor interpretado do sistema (por exemplo, \_ RenderTargetArrayIndex de VA ou posição de VA \_ ), o hardware examina esses dados e executa algum comportamento dependente do valor, além de ser capaz de passar os dados em si para o próximo estágio de sombreamento para entrada.</span><span class="sxs-lookup"><span data-stu-id="92ac7-134">When a geometry shader output is identified as a System Interpreted Value (e.g. SV\_RenderTargetArrayIndex or SV\_Position), hardware looks at this data and performs some behavior dependent on the value, in addition to being able to pass the data itself to the next shader stage for input.</span></span> <span data-ttu-id="92ac7-135">Quando essa saída de dados do sombreador de geometria tem significado para o hardware por primitivo (como VA \_ RenderTargetArrayIndex ou VA \_ ViewportArrayIndex), em vez de por vértice (como a VA \_ ClipDistance \[ n \] ou a \_ posição da VA), os dados por primitivos são obtidos do vértice principal emitido para o primitivo.</span><span class="sxs-lookup"><span data-stu-id="92ac7-135">When such data output from the geometry shader has meaning to the hardware on a per-primitive basis (such as SV\_RenderTargetArrayIndex or SV\_ViewportArrayIndex), rather than on a per-vertex basis (such as SV\_ClipDistance\[n\] or SV\_Position), the per-primitive data is taken from the leading vertex emitted for the primitive.</span></span>

<span data-ttu-id="92ac7-136">Os primitivos parcialmente concluídos podem ser gerados pelo sombreador de geometria, se o sombreador de geometria terminar e o primitivo estiver incompleto.</span><span class="sxs-lookup"><span data-stu-id="92ac7-136">Partially completed primitives could be generated by the geometry shader if the geometry shader ends and the primitive is incomplete.</span></span> <span data-ttu-id="92ac7-137">Primitivos incompletos são descartados silenciosamente.</span><span class="sxs-lookup"><span data-stu-id="92ac7-137">Incomplete primitives are silently discarded.</span></span> <span data-ttu-id="92ac7-138">Isso é semelhante à maneira como o IA trata primitivos parcialmente concluídas.</span><span class="sxs-lookup"><span data-stu-id="92ac7-138">This is similar to the way the IA treats partially completed primitives.</span></span>

<span data-ttu-id="92ac7-139">O sombreador de geometria pode executar operações de amostragem de textura e carregamento onde não há necessidade de elementos derivados do espaço da tela (samplelevel, samplecmplevelzero, samplegrad).</span><span class="sxs-lookup"><span data-stu-id="92ac7-139">The geometry shader can perform load and texture sampling operations where screen-space derivatives are not required (samplelevel, samplecmplevelzero, samplegrad).</span></span>

<span data-ttu-id="92ac7-140">Os algoritmos que podem ser implementados no sombreador de geometria incluem:</span><span class="sxs-lookup"><span data-stu-id="92ac7-140">Algorithms that can be implemented in the geometry shader include:</span></span>

-   <span data-ttu-id="92ac7-141">Expansão de sprites de ponto</span><span class="sxs-lookup"><span data-stu-id="92ac7-141">Point Sprite Expansion</span></span>
-   <span data-ttu-id="92ac7-142">Sistemas de partículas dinâmicas</span><span class="sxs-lookup"><span data-stu-id="92ac7-142">Dynamic Particle Systems</span></span>
-   <span data-ttu-id="92ac7-143">Geração de pele/barbatana</span><span class="sxs-lookup"><span data-stu-id="92ac7-143">Fur/Fin Generation</span></span>
-   <span data-ttu-id="92ac7-144">Geração de volume de sombra</span><span class="sxs-lookup"><span data-stu-id="92ac7-144">Shadow Volume Generation</span></span>
-   <span data-ttu-id="92ac7-145">Única passagem de renderização para Cubemap</span><span class="sxs-lookup"><span data-stu-id="92ac7-145">Single Pass Render-to-Cubemap</span></span>
-   <span data-ttu-id="92ac7-146">Troca de material por primitivo</span><span class="sxs-lookup"><span data-stu-id="92ac7-146">Per-Primitive Material Swapping</span></span>
-   <span data-ttu-id="92ac7-147">Configuração de material do Per-Primitive-incluindo a geração de coordenadas barycentric como dados primitivos para que um sombreador de pixel possa executar a interpolação de atributo personalizado (para obter um exemplo de interpolação normal de ordem superior, consulte o [exemplo de CubeMapGS](https://msdn.microsoft.com/library/Ee416398(v=VS.85).aspx)).</span><span class="sxs-lookup"><span data-stu-id="92ac7-147">Per-Primitive Material Setup - Including generation of barycentric coordinates as primitive data so that a pixel shader can perform custom attribute interpolation (for an example of higher-order normal interpolation, see [CubeMapGS Sample](https://msdn.microsoft.com/library/Ee416398(v=VS.85).aspx)).</span></span>

## <a name="related-topics"></a><span data-ttu-id="92ac7-148">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="92ac7-148">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="92ac7-149">Pipeline de gráficos</span><span class="sxs-lookup"><span data-stu-id="92ac7-149">Graphics Pipeline</span></span>](overviews-direct3d-11-graphics-pipeline.md)
</dt> <dt>

[<span data-ttu-id="92ac7-150">Estágios de pipeline (Direct3D 10)</span><span class="sxs-lookup"><span data-stu-id="92ac7-150">Pipeline Stages (Direct3D 10)</span></span>](/windows/desktop/direct3d10/d3d10-graphics-programming-guide-pipeline-stages)
</dt> </dl>

 

 