---
title: Sobre os serviços de biblioteca
description: Sobre os serviços de biblioteca
ms.assetid: 2334aa4a-7988-481d-9b21-9f7b432fbd05
keywords:
- Windows Media Player, biblioteca
- Modelo de objeto do Windows Media Player, biblioteca
- modelo de objeto, biblioteca
- Controle ActiveX do Windows Media Player, biblioteca para modelo de objeto
- Controle ActiveX, biblioteca para modelo de objeto
- Controle ActiveX móvel do Windows Media Player, biblioteca para modelo de objeto
- Windows Media Player Mobile, biblioteca para modelo de objeto
- Biblioteca do Windows Media Player, sobre
- Biblioteca do Windows Media Player, serviços
- biblioteca, serviços
- biblioteca, sobre
- versões do Windows Media Player, serviços de biblioteca
- enumerações, serviços de biblioteca
- eventos, serviços de biblioteca
- exemplos, serviços de biblioteca
- interfaces, serviços de biblioteca
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 743efc8ae5cb464aa38655314c52112bc9541de6
ms.sourcegitcommit: b04e152a7f51618fc174ffa872654623fe088db2
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/21/2020
ms.locfileid: "105784927"
---
# <a name="about-library-services"></a><span data-ttu-id="08b11-119">Sobre os serviços de biblioteca</span><span class="sxs-lookup"><span data-stu-id="08b11-119">About Library Services</span></span>

<span data-ttu-id="08b11-120">Em versões anteriores do Windows Media Player, o software usava um banco de dados de biblioteca única para cada usuário.</span><span class="sxs-lookup"><span data-stu-id="08b11-120">In earlier versions of Windows Media Player, the software used a single library database for each user.</span></span> <span data-ttu-id="08b11-121">Esse banco de dados foi armazenado no computador do usuário e estava associado conceitualmente ao usuário e a uma instância específica do Player.</span><span class="sxs-lookup"><span data-stu-id="08b11-121">This database was stored on the user's computer and was conceptually tied to the user and a particular instance of the Player.</span></span>

<span data-ttu-id="08b11-122">O Windows Media Player 11 apresenta os conceitos de várias bibliotecas remotas.</span><span class="sxs-lookup"><span data-stu-id="08b11-122">Windows Media Player 11 introduces the concepts of multiple and remote libraries.</span></span> <span data-ttu-id="08b11-123">Agora, além de sua biblioteca padrão ou *local*, o Windows Media Player pode exibir o conteúdo recuperado de bibliotecas em outros computadores conectados a uma rede, o que pode incluir outros usuários conectados ao mesmo computador.</span><span class="sxs-lookup"><span data-stu-id="08b11-123">Now, in addition to its default, or *local*, library, Windows Media Player can display content retrieved from libraries on other computers connected to a network, which might include other users logged on to the same computer.</span></span> <span data-ttu-id="08b11-124">O Player também pode exibir exibições de biblioteca de outras fontes, como dispositivos habilitados para MTP ou CDs de dados.</span><span class="sxs-lookup"><span data-stu-id="08b11-124">The Player can also display library views from other sources, such as MTP-enabled devices or data CDs.</span></span> <span data-ttu-id="08b11-125">Da perspectiva do usuário final, isso significa que o conteúdo de mídia digital localizado em vários locais diferentes pode ser gerenciado de vários locais usando a mesma interface do usuário familiar do Windows Media Player.</span><span class="sxs-lookup"><span data-stu-id="08b11-125">From the end user's perspective, this means that digital media content located in many different places can be managed from multiple locations by using the same, familiar Windows Media Player user interface.</span></span> <span data-ttu-id="08b11-126">Da perspectiva do desenvolvedor, isso significa que você pode usar as interfaces COM do SDK do Windows Media Player para enumerar as bibliotecas disponíveis e, em seguida, usá-las, como você usou a biblioteca local em versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="08b11-126">From the developer's perspective, this means that you can use the Windows Media Player SDK COM interfaces to enumerate the available libraries and then use them like you have used the local library in earlier versions.</span></span>

<span data-ttu-id="08b11-127">Para enumerar as bibliotecas disponíveis, use a interface **IWMPLibraryServices** .</span><span class="sxs-lookup"><span data-stu-id="08b11-127">To enumerate the available libraries, use the **IWMPLibraryServices** interface.</span></span> <span data-ttu-id="08b11-128">Essa interface expõe o método [IWMPLibraryServices:: getCountByType](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibraryservices-getcountbytype) , que recupera a contagem de bibliotecas de um determinado tipo.</span><span class="sxs-lookup"><span data-stu-id="08b11-128">This interface exposes the [IWMPLibraryServices::getCountByType](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibraryservices-getcountbytype) method, which retrieves the count of libraries of a given type.</span></span> <span data-ttu-id="08b11-129">Os tipos de biblioteca são definidos pela enumeração [WMPLibraryType](/previous-versions/windows/desktop/api/wmp/ne-wmp-wmplibrarytype) .</span><span class="sxs-lookup"><span data-stu-id="08b11-129">Library types are defined by the [WMPLibraryType](/previous-versions/windows/desktop/api/wmp/ne-wmp-wmplibrarytype) enumeration.</span></span> <span data-ttu-id="08b11-130">Essa enumeração inclui um valor para a biblioteca local, wmpltLocal.</span><span class="sxs-lookup"><span data-stu-id="08b11-130">This enumeration includes a value for the local library, wmpltLocal.</span></span> <span data-ttu-id="08b11-131">Isso ocorre porque o recurso serviços de biblioteca sempre permite que você trabalhe com a biblioteca local usando **IWMPLibraryServices** e as interfaces relacionadas.</span><span class="sxs-lookup"><span data-stu-id="08b11-131">This is because the library services feature always enables you work with the local library by using **IWMPLibraryServices** and the related interfaces.</span></span>

> [!Note]  
> <span data-ttu-id="08b11-132">A enumeração **WMPLibraryType** inclui o valor wmpltRemote, que representa as bibliotecas de mídia compartilhadas pela rede.</span><span class="sxs-lookup"><span data-stu-id="08b11-132">The **WMPLibraryType** enumeration includes the value wmpltRemote, which represents media libraries shared by the network.</span></span> <span data-ttu-id="08b11-133">Para acessar essas bibliotecas compartilhadas, o controle do Player deve estar em execução no modo remoto.</span><span class="sxs-lookup"><span data-stu-id="08b11-133">To access those shared libraries, the Player control must be running in remote mode.</span></span> <span data-ttu-id="08b11-134">Para obter informações sobre como executar o controle Player no modo remoto, consulte [comunicação remota do controle do Windows Media Player](remoting-the-windows-media-player-control.md).</span><span class="sxs-lookup"><span data-stu-id="08b11-134">For information about running the Player control in remote mode, see [Remoting the Windows Media Player Control](remoting-the-windows-media-player-control.md).</span></span>

 

<span data-ttu-id="08b11-135">Depois de recuperar a contagem de bibliotecas, você pode iterar a coleção de bibliotecas disponíveis chamando repetidamente [IWMPLibraryServices:: getLibraryByType](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibraryservices-getlibrarybytype) em um loop, passando um novo valor de índice com cada iteração.</span><span class="sxs-lookup"><span data-stu-id="08b11-135">After you retrieve the library count, you can iterate the collection of available libraries by repeatedly calling [IWMPLibraryServices::getLibraryByType](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibraryservices-getlibrarybytype) in a loop, passing a new index value with each iteration.</span></span> <span data-ttu-id="08b11-136">Esse método recupera um ponteiro para uma interface [IWMPLibrary](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibrary) , que representa a biblioteca individual.</span><span class="sxs-lookup"><span data-stu-id="08b11-136">This method retrieves a pointer to an [IWMPLibrary](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibrary) interface, which represents the individual library.</span></span>

<span data-ttu-id="08b11-137">Depois de recuperar um ponteiro para **IWMPLibrary**, você pode chamar [IWMPLibrary:: get \_ mediacollection](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_mediacollection) para recuperar um ponteiro para uma interface **IWMPMediaCollection** .</span><span class="sxs-lookup"><span data-stu-id="08b11-137">After you retrieve a pointer to **IWMPLibrary**, you can call [IWMPLibrary::get\_mediaCollection](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_mediacollection) to retrieve a pointer to an **IWMPMediaCollection** interface.</span></span> <span data-ttu-id="08b11-138">Com esse ponteiro de interface, você pode trabalhar com uma biblioteca individual da mesma forma que usaria a biblioteca local.</span><span class="sxs-lookup"><span data-stu-id="08b11-138">With this interface pointer, you can work with an individual library much like you would use the local library.</span></span> <span data-ttu-id="08b11-139">Você também pode recuperar uma cadeia de caracteres que contém o nome da biblioteca chamando [IWMPLibrary:: get \_ Name](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_name), que será útil se você precisar exibir o nome da biblioteca para o usuário.</span><span class="sxs-lookup"><span data-stu-id="08b11-139">You can also retrieve a string containing the name of the library by calling [IWMPLibrary::get\_name](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_name), which is useful if you need to display the library name to the user.</span></span> <span data-ttu-id="08b11-140">Você pode chamar [IWMPLibrary:: get \_](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_type) para obter o **WMPLibraryType** de uma biblioteca específica.</span><span class="sxs-lookup"><span data-stu-id="08b11-140">You can call [IWMPLibrary::get\_type](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-get_type) to get the **WMPLibraryType** of a particular library.</span></span>

<span data-ttu-id="08b11-141">Você pode manipular o evento [IWMPEvents3:: LibraryConnect](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-libraryconnect) para saber quando uma biblioteca se torna disponível e o evento [IWMPEvents3:: LibraryDisconnect](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-librarydisconnect) para saber quando uma biblioteca se desconecta.</span><span class="sxs-lookup"><span data-stu-id="08b11-141">You can handle the [IWMPEvents3::LibraryConnect](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-libraryconnect) event to know when a library becomes available and the [IWMPEvents3::LibraryDisconnect](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-librarydisconnect) event to know when a library disconnects.</span></span> <span data-ttu-id="08b11-142">Cada um desses eventos fornece um ponteiro **IWMPLibrary** que representa a biblioteca conectada ou desconectada.</span><span class="sxs-lookup"><span data-stu-id="08b11-142">Each of these events provides an **IWMPLibrary** pointer that represents the library that connected or disconnected.</span></span> <span data-ttu-id="08b11-143">Você pode chamar [IWMPLibrary:: isidêntico](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-isidentical) para determinar se a biblioteca conectada ou desconectada é uma biblioteca que você está usando no momento.</span><span class="sxs-lookup"><span data-stu-id="08b11-143">You can call [IWMPLibrary::isIdentical](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmplibrary-isidentical) to determine whether the library that connected or disconnected is a library that you are currently using.</span></span>

<span data-ttu-id="08b11-144">Há algumas diferenças importantes quando você trabalha com uma biblioteca recuperada por meio da interface **IWMPLibraryServices** em comparação com o trabalho com uma biblioteca recuperada usando [IWMPCore:: get \_ mediacollection](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcore-get_mediacollection).</span><span class="sxs-lookup"><span data-stu-id="08b11-144">There are some important differences when you work with a library retrieved through the **IWMPLibraryServices** interface compared to working with a library retrieved by using [IWMPCore::get\_mediaCollection](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcore-get_mediacollection).</span></span> <span data-ttu-id="08b11-145">As seguintes diferenças aplicam:</span><span class="sxs-lookup"><span data-stu-id="08b11-145">The following differences apply:</span></span>

-   <span data-ttu-id="08b11-146">Normalmente, você pode recuperar resultados da consulta muito mais rapidamente das bibliotecas recuperadas por meio do **IWMPLibraryServices**.</span><span class="sxs-lookup"><span data-stu-id="08b11-146">You can usually retrieve query results much faster from libraries retrieved through **IWMPLibraryServices**.</span></span> <span data-ttu-id="08b11-147">(Isso pressupõe que outros fatores, como tempos de acesso de rede e disco rígido, sejam iguais.)</span><span class="sxs-lookup"><span data-stu-id="08b11-147">(This assumes that other factors such as network and hard disk access times are equal.)</span></span>
-   <span data-ttu-id="08b11-148">A lista de atributos de metadados de item de mídia disponíveis em bibliotecas recuperadas por meio de **IWMPLibraryServices** geralmente é um subconjunto daqueles disponíveis na biblioteca local recuperada por meio de [IWMPCore](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpcore).</span><span class="sxs-lookup"><span data-stu-id="08b11-148">The list of media item metadata attributes available from libraries retrieved through **IWMPLibraryServices** is usually a subset of those available from the local library retrieved through [IWMPCore](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpcore).</span></span>
-   <span data-ttu-id="08b11-149">Se você recuperar a biblioteca local por meio de **IWMPLibraryServices**, todos os mesmos atributos estarão disponíveis para seu uso como aqueles disponíveis quando você recuperar a biblioteca local por meio do **IWMPCore**.</span><span class="sxs-lookup"><span data-stu-id="08b11-149">If you retrieve the local library through **IWMPLibraryServices**, all of the same attributes are available for your use as those available when you retrieve the local library through **IWMPCore**.</span></span> <span data-ttu-id="08b11-150">No entanto, você poderá recuperar os resultados da consulta muito mais rapidamente para os atributos mais usados.</span><span class="sxs-lookup"><span data-stu-id="08b11-150">However, you will be able to retrieve query results much faster for the most commonly-used attributes.</span></span>
-   <span data-ttu-id="08b11-151">Você deve usar coleções de cadeia de caracteres para criar elementos de interface do usuário ao trabalhar com bibliotecas recuperadas por meio de **IWMPLibraryServices**.</span><span class="sxs-lookup"><span data-stu-id="08b11-151">You should use string collections to create user interface elements when you work with libraries retrieved through **IWMPLibraryServices**.</span></span> <span data-ttu-id="08b11-152">Por exemplo, [IWMPMediaCollection2:: getStringCollectionByQuery](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpmediacollection2-getstringcollectionbyquery) permite que você use uma consulta personalizada (representada pela interface **IWMPQuery** ) para recuperar uma coleção de cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="08b11-152">For example, [IWMPMediaCollection2::getStringCollectionByQuery](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpmediacollection2-getstringcollectionbyquery) enables you to use a custom query (represented by the **IWMPQuery** interface) to retrieve a string collection.</span></span>
-   <span data-ttu-id="08b11-153">Bibliotecas remotas recuperadas por meio da interface **IWMPLibraryServices** talvez nem sempre estejam conectadas à instância do Player atual.</span><span class="sxs-lookup"><span data-stu-id="08b11-153">Remote libraries retrieved through the **IWMPLibraryServices** interface might not always be connected to the current Player instance.</span></span> <span data-ttu-id="08b11-154">Isso significa que é importante manipular os eventos **LibraryConnect** e **LibraryDisconnect** para saber quando a disponibilidade da biblioteca é alterada e para manipular o evento [IWMPEvents3:: StringCollectionChange](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-stringcollectionchange) para saber quando as cadeias de caracteres são adicionadas ou removidas das coleções de cadeias que você usa para exibir elementos da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="08b11-154">This means that it is important to handle the **LibraryConnect** and **LibraryDisconnect** events to know when library availability changes, and to handle the [IWMPEvents3::StringCollectionChange](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-stringcollectionchange) event to know when strings are added to or removed from the string collections you use to display user interface elements.</span></span> <span data-ttu-id="08b11-155">Você também deve manipular eventos **StringCollectionChange** para a biblioteca local por motivos semelhantes.</span><span class="sxs-lookup"><span data-stu-id="08b11-155">You should also handle **StringCollectionChange** events for the local library for similar reasons.</span></span>

<span data-ttu-id="08b11-156">É importante entender que as coleções de cadeias de caracteres de uma determinada biblioteca podem ser alteradas a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="08b11-156">It is important to understand that string collections for a particular library can change at any time.</span></span> <span data-ttu-id="08b11-157">Uma coleção de cadeia de caracteres pode estar vazia quando você a recupera pela primeira vez, como no caso de uma biblioteca conectada recentemente, mas o Player ainda não tiver enumerado seu conteúdo.</span><span class="sxs-lookup"><span data-stu-id="08b11-157">A string collection could be empty when you first retrieve it, as in the case of a library that has recently connected but the Player has not yet enumerated its contents.</span></span> <span data-ttu-id="08b11-158">Por outro lado, uma coleção de cadeia de caracteres já pode conter todas as informações de que você precisa.</span><span class="sxs-lookup"><span data-stu-id="08b11-158">Conversely, a string collection might already contain all the information you need.</span></span> <span data-ttu-id="08b11-159">Nesse caso, você pode nunca receber um evento **StringCollectionChange** porque o conteúdo da biblioteca tinha sido completamente enumerado antes de você criar a consulta e nada mais está mudando.</span><span class="sxs-lookup"><span data-stu-id="08b11-159">In this case, you might never receive a **StringCollectionChange** event because the library's contents had been completely enumerated before you created your query and nothing else is changing.</span></span>

<span data-ttu-id="08b11-160">Portanto, para manter a interface do usuário atual, você deve enumerar o conteúdo da coleção de cadeias de caracteres ao recuperar a interface **IWMPStringCollection** e manipular o evento **StringCollectionChange** para saber mais sobre as atualizações quando elas ocorrerem.</span><span class="sxs-lookup"><span data-stu-id="08b11-160">Therefore, to keep your user interface current, you must both enumerate the string collection contents when you retrieve the **IWMPStringCollection** interface and handle the **StringCollectionChange** event to know about updates when they happen.</span></span>

## <a name="sample"></a><span data-ttu-id="08b11-161">Amostra</span><span class="sxs-lookup"><span data-stu-id="08b11-161">Sample</span></span>

<span data-ttu-id="08b11-162">O exemplo chamado WMPML demonstra como trabalhar com serviços de biblioteca.</span><span class="sxs-lookup"><span data-stu-id="08b11-162">The sample named WMPML demonstrates how to work with library services.</span></span> <span data-ttu-id="08b11-163">Para obter mais informações sobre exemplos do SDK do Windows Media Player, consulte [exemplos](samples.md).</span><span class="sxs-lookup"><span data-stu-id="08b11-163">For more information about Windows Media Player SDK samples, see [Samples](samples.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="08b11-164">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="08b11-164">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="08b11-165">**Sobre a biblioteca**</span><span class="sxs-lookup"><span data-stu-id="08b11-165">**About the Library**</span></span>](about-the-library.md)
</dt> <dt>

[<span data-ttu-id="08b11-166">**Sobre o objeto de consulta**</span><span class="sxs-lookup"><span data-stu-id="08b11-166">**About the Query Object**</span></span>](about-the-query-object.md)
</dt> <dt>

[<span data-ttu-id="08b11-167">**Interface IWMPEvents3**</span><span class="sxs-lookup"><span data-stu-id="08b11-167">**IWMPEvents3 Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpevents3)
</dt> <dt>

[<span data-ttu-id="08b11-168">**Interface IWMPLibrary**</span><span class="sxs-lookup"><span data-stu-id="08b11-168">**IWMPLibrary Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibrary)
</dt> <dt>

[<span data-ttu-id="08b11-169">**Interface IWMPLibrary (VB e C#)**</span><span class="sxs-lookup"><span data-stu-id="08b11-169">**IWMPLibrary Interface (VB and C#)**</span></span>](iwmplibrary--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="08b11-170">**Interface IWMPLibraryServices**</span><span class="sxs-lookup"><span data-stu-id="08b11-170">**IWMPLibraryServices Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmplibraryservices)
</dt> <dt>

[<span data-ttu-id="08b11-171">**Interface IWMPLibraryServices (VB e C#)**</span><span class="sxs-lookup"><span data-stu-id="08b11-171">**IWMPLibraryServices Interface (VB and C#)**</span></span>](iwmplibraryservices--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="08b11-172">**Interface IWMPMediaCollection**</span><span class="sxs-lookup"><span data-stu-id="08b11-172">**IWMPMediaCollection Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpmediacollection)
</dt> <dt>

[<span data-ttu-id="08b11-173">**Interface IWMPMediaCollection (VB e C#)**</span><span class="sxs-lookup"><span data-stu-id="08b11-173">**IWMPMediaCollection Interface (VB and C#)**</span></span>](iwmpmediacollection--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="08b11-174">**Interface IWMPStringCollection**</span><span class="sxs-lookup"><span data-stu-id="08b11-174">**IWMPStringCollection Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpstringcollection)
</dt> <dt>

[<span data-ttu-id="08b11-175">**Interface IWMPStringCollection (VB e C#)**</span><span class="sxs-lookup"><span data-stu-id="08b11-175">**IWMPStringCollection Interface (VB and C#)**</span></span>](iwmpstringcollection--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="08b11-176">**Interface IWMPQuery**</span><span class="sxs-lookup"><span data-stu-id="08b11-176">**IWMPQuery Interface**</span></span>](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpquery)
</dt> <dt>

[<span data-ttu-id="08b11-177">**Interface IWMPQuery (VB e C#)**</span><span class="sxs-lookup"><span data-stu-id="08b11-177">**IWMPQuery Interface (VB and C#)**</span></span>](iwmpquery--vb-and-c.md)
</dt> <dt>

[<span data-ttu-id="08b11-178">**Trabalhando com a biblioteca**</span><span class="sxs-lookup"><span data-stu-id="08b11-178">**Working with the Library**</span></span>](working-with-the-library.md)
</dt> </dl>

 

 




