---
title: Implementando a página de propriedades para um plug-in do DSP
description: Implementando a página de propriedades para um plug-in do DSP
ms.assetid: 3dd3e547-fd06-4f01-8731-da1f8c958a32
keywords:
- Plug-ins do Windows Media Player, DSP de áudio
- plug-ins, DSP de áudio
- plug-ins de processamento de sinal digital, propriedades de áudio
- Plug-ins do DSP, propriedades de áudio
- plug-ins do DSP de áudio, propriedades
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aec87318b77fec4e9218398c1cb43dd5954a49e0
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "103822459"
---
# <a name="implementing-the-property-page-for-a-dsp-plug-in"></a><span data-ttu-id="73b69-108">Implementando a página de propriedades para um plug-in do DSP</span><span class="sxs-lookup"><span data-stu-id="73b69-108">Implementing the Property Page for a DSP Plug-in</span></span>

<span data-ttu-id="73b69-109">O Windows Media Player pode exibir uma página de propriedades para cada plug-in do DSP para permitir que os usuários definam valores que alteram o comportamento do plug-in.</span><span class="sxs-lookup"><span data-stu-id="73b69-109">Windows Media Player can display a property page for each DSP plug-in to enable users to set values that change the behavior of the plug-in.</span></span> <span data-ttu-id="73b69-110">Os usuários podem acessar a página de propriedades da guia **plug-ins** da caixa de diálogo opções clicando no nome do plug-in do DSP para selecioná-lo e, em seguida, clicando em **Propriedades**.</span><span class="sxs-lookup"><span data-stu-id="73b69-110">Users can access the property page from the **Plug-ins** tab of the Options dialog box by clicking the name of the DSP plug-in to select it and then clicking **Properties**.</span></span>

<span data-ttu-id="73b69-111">O código de exemplo do assistente de plug-in do Windows Media Player fornece uma implementação padrão de uma página de propriedades que inclui uma única caixa de edição que recebe do usuário um valor que representa um fator de escala para o volume de áudio.</span><span class="sxs-lookup"><span data-stu-id="73b69-111">The Windows Media Player Plug-in Wizard sample code provides a default implementation of a property page that includes a single edit box that receives from the user a value representing a scale factor for the audio volume.</span></span> <span data-ttu-id="73b69-112">Quando o usuário clica em **aplicar**, a página de propriedades passa esse valor para o objeto de plug-in para que o plug-in possa alterar o valor que ele usa para dimensionar o volume durante o processamento.</span><span class="sxs-lookup"><span data-stu-id="73b69-112">When the user clicks **Apply**, the property page passes this value to the plug-in object so the plug-in can change the value it uses to scale the volume during processing.</span></span>

## <a name="about-the-property-page-object"></a><span data-ttu-id="73b69-113">Sobre o objeto da página de propriedades</span><span class="sxs-lookup"><span data-stu-id="73b69-113">About the Property Page Object</span></span>

<span data-ttu-id="73b69-114">O objeto da página de propriedades é um objeto COM que implementa a interface **IPropertyPage** .</span><span class="sxs-lookup"><span data-stu-id="73b69-114">The property page object is a COM object that implements the **IPropertyPage** interface.</span></span> <span data-ttu-id="73b69-115">O código de exemplo gerado pelo assistente de plug-in usa a implementação de ATL do **IPropertyPage**, que está documentada na documentação do Visual C++ no msdn.</span><span class="sxs-lookup"><span data-stu-id="73b69-115">The sample code generated by the plug-in wizard uses the ATL implementation of **IPropertyPage**, which is documented in the Visual C++ documentation on MSDN.</span></span> <span data-ttu-id="73b69-116">Seu código pelo menos deve fornecer implementações de substituição para **IPropertyPage:: OnInitDialog**, que manipula o evento que ocorre quando a página de propriedades é aberta e **IPropertyPage:: apply**, que manipula o evento que ocorre quando o usuário clica em **aplicar**.</span><span class="sxs-lookup"><span data-stu-id="73b69-116">Your code at least should provide override implementations for **IPropertyPage::OnInitDialog**, which handles the event that occurs when the property page opens, and **IPropertyPage::Apply**, which handles the event that occurs when the user clicks **Apply**.</span></span> <span data-ttu-id="73b69-117">O assistente de plug-in gera código de exemplo para cada um desses manipuladores de eventos.</span><span class="sxs-lookup"><span data-stu-id="73b69-117">The plug-in wizard generates sample code for each of these event handlers.</span></span> <span data-ttu-id="73b69-118">A implementação de exemplo de **OnInitDialog** recupera um valor do registro para que ele possa exibir a configuração do fator de escala atual.</span><span class="sxs-lookup"><span data-stu-id="73b69-118">The sample implementation of **OnInitDialog** retrieves a value from the registry so that it can display the current scale factor setting.</span></span> <span data-ttu-id="73b69-119">A implementação de exemplo de **Apply** valida a entrada do usuário testando para garantir que ela esteja dentro de um intervalo especificado e, em seguida, persiste o valor no registro e, em seguida, passe o valor (se for válido) para o método Put do plug-in do DSP, chamado **Put de \_ escala**.</span><span class="sxs-lookup"><span data-stu-id="73b69-119">The sample implementation of **Apply** validates the user input by testing to ensure that it falls within a specified range, then persists the value to the registry, and then passes the value (if valid) to the DSP plug-in property put method, named **put\_scale**.</span></span>

<span data-ttu-id="73b69-120">Além disso, você precisará adicionar código para manipular o evento que ocorre quando o usuário altera um valor em um controle que você fornece na página de propriedades.</span><span class="sxs-lookup"><span data-stu-id="73b69-120">Additionally, you will need to add code to handle the event that occurs when the user changes a value in a control you provide in the property page.</span></span> <span data-ttu-id="73b69-121">Por exemplo, o assistente de plug-in implementa uma função chamada **OnChangeScale**, que simplesmente habilita o botão **Apply** quando o usuário altera o texto na caixa de edição na página de propriedades chamando o método **SetDirty** com um valor de argumento **true**.</span><span class="sxs-lookup"><span data-stu-id="73b69-121">For example, the plug-in wizard implements a function named **OnChangeScale**, which simply enables the **Apply** button when the user changes the text in the edit box on the property page by calling the **SetDirty** method with an argument value of **TRUE**.</span></span>

## <a name="about-the-property-page-dialog-resource"></a><span data-ttu-id="73b69-122">Sobre o recurso de caixa de diálogo de página de propriedades</span><span class="sxs-lookup"><span data-stu-id="73b69-122">About the Property Page Dialog Resource</span></span>

<span data-ttu-id="73b69-123">A interface do usuário para a página de propriedades é armazenada como um recurso de caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="73b69-123">The user interface for the property page is stored as a dialog resource.</span></span> <span data-ttu-id="73b69-124">Você pode exibir e editar facilmente a caixa de diálogo da página de propriedades no Visual Studio selecionando a guia **ResourceView** na janela espaço de trabalho do projeto, abrindo a pasta **caixa de diálogo** e clicando duas vezes no nome do recurso da página de propriedades.</span><span class="sxs-lookup"><span data-stu-id="73b69-124">You can easily view and edit the property page dialog in Visual Studio by selecting the **ResourceView** tab in the Project Workspace window, then opening the **Dialog** folder, and then double-clicking the property page resource name.</span></span> <span data-ttu-id="73b69-125">O editor de recursos de caixa de diálogo no Visual Studio fornece as ferramentas necessárias para adicionar controles à caixa de diálogo de página de propriedades e criar manipuladores de eventos que são mapeados para as mensagens apropriadas do Windows.</span><span class="sxs-lookup"><span data-stu-id="73b69-125">The dialog resource editor in Visual Studio provides you with the tools you need to add controls to the property page dialog and to create event handlers that are mapped to the appropriate Windows messages.</span></span> <span data-ttu-id="73b69-126">Para obter detalhes sobre como usar o editor de recursos no Visual Studio, consulte a ajuda do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="73b69-126">For details about how to use the resource editor in Visual Studio, refer to Visual Studio Help.</span></span>

## <a name="about-ispecifypropertypages"></a><span data-ttu-id="73b69-127">Sobre o ISpecifyPropertyPages</span><span class="sxs-lookup"><span data-stu-id="73b69-127">About ISpecifyPropertyPages</span></span>

<span data-ttu-id="73b69-128">Se um plug-in do DSP fornecer uma página de propriedades, o plug-in deverá implementar a interface **ISpecifyPropertyPages** .</span><span class="sxs-lookup"><span data-stu-id="73b69-128">If a DSP plug-in provides a property page, the plug-in must implement the **ISpecifyPropertyPages** interface.</span></span> <span data-ttu-id="73b69-129">Essa interface contém apenas um método: **ISpecifyPropertyPages:: GetPages**.</span><span class="sxs-lookup"><span data-stu-id="73b69-129">This interface contains only one method: **ISpecifyPropertyPages::GetPages**.</span></span> <span data-ttu-id="73b69-130">Esse é o método que associa a página de propriedades ao plug-in do DSP.</span><span class="sxs-lookup"><span data-stu-id="73b69-130">This is the method that associates the property page with the DSP plug-in.</span></span> <span data-ttu-id="73b69-131">O Windows Media Player chama esse método quando o usuário chama a página de propriedades, passando um parâmetro do tipo CAUUID, que é uma matriz contada de GUIDs.</span><span class="sxs-lookup"><span data-stu-id="73b69-131">Windows Media Player calls this method when the user invokes the property page, passing a parameter of type CAUUID, which is a counted array of GUIDs.</span></span> <span data-ttu-id="73b69-132">A implementação de plug-in de exemplo de **GetPages** preenche essa estrutura com um único GUID que é a ID de classe do objeto da página de propriedades de plug-in.</span><span class="sxs-lookup"><span data-stu-id="73b69-132">The sample plug-in implementation of **GetPages** fills this structure with a single GUID that is the class id of the plug-in property page object.</span></span> <span data-ttu-id="73b69-133">Em seguida, o Windows Media Player usa a ID de classe para criar o objeto da página de propriedades.</span><span class="sxs-lookup"><span data-stu-id="73b69-133">Windows Media Player then uses the class id to create the property page object.</span></span>

<span data-ttu-id="73b69-134">Você pode observar que a implementação de exemplo de **GetPages** usa **CoTaskMemAlloc** para alocar memória para a estrutura de GUID.</span><span class="sxs-lookup"><span data-stu-id="73b69-134">You might notice that the sample implementation of **GetPages** uses **CoTaskMemAlloc** to allocate memory for the GUID structure.</span></span> <span data-ttu-id="73b69-135">É responsabilidade do chamador, nesse caso, o Windows Media Player, para usar o **CoTaskMemFree** para liberar a memória.</span><span class="sxs-lookup"><span data-stu-id="73b69-135">It is the responsibility of the caller, in this case Windows Media Player, to use **CoTaskMemFree** to release the memory.</span></span> <span data-ttu-id="73b69-136">Para obter detalhes sobre a estrutura CAUUID, consulte a documentação do Platform SDK.</span><span class="sxs-lookup"><span data-stu-id="73b69-136">For details about the CAUUID structure, see the Platform SDK documentation.</span></span>

## <a name="about-the-proxystub-dll"></a><span data-ttu-id="73b69-137">Sobre a DLL de proxy/stub</span><span class="sxs-lookup"><span data-stu-id="73b69-137">About the Proxy/Stub DLL</span></span>

<span data-ttu-id="73b69-138">Para que um plug-in do DSP funcione no Windows Media Player 11 em execução no Windows Vista, você deve fornecer uma DLL de proxy/stub para interfaces personalizadas usadas para comunicar alterações nas configurações de uma caixa de diálogo de página de propriedades para a classe de plug-in.</span><span class="sxs-lookup"><span data-stu-id="73b69-138">For a DSP plug-in to work in Windows Media Player 11 running on Windows Vista, you must provide a proxy/stub DLL for custom interfaces used to communicate changes in settings from a property page dialog box to the plug-in class.</span></span> <span data-ttu-id="73b69-139">As chamadas de método feitas por meio dessas interfaces devem ser empacotadas quando as chamadas são feitas entre limites de processo ou de apartamento.</span><span class="sxs-lookup"><span data-stu-id="73b69-139">Method calls made through such interfaces must be marshaled when the calls are made across process or apartment boundaries.</span></span> <span data-ttu-id="73b69-140">A versão mais recente do assistente de plug-in cria um exemplo de projeto de DLL de proxy/stub.</span><span class="sxs-lookup"><span data-stu-id="73b69-140">The latest version of the plug-in wizard creates a sample proxy/stub DLL project.</span></span>

## <a name="related-topics"></a><span data-ttu-id="73b69-141">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="73b69-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="73b69-142">**Implementando um plug-in do DSP de áudio**</span><span class="sxs-lookup"><span data-stu-id="73b69-142">**Implementing an Audio DSP Plug-in**</span></span>](implementing-an-audio-dsp-plug-in.md)
</dt> </dl>

 

 




