---
title: Plug-in da loja online de tipo 2
description: Plug-in da loja online de tipo 2
ms.assetid: 16e90a01-20be-49a6-96df-de81a7283f42
keywords:
- Repositórios online do Windows Media Player, plug-ins
- lojas online, plug-ins
- Digite 2 lojas online, plug-ins
- Lojas online do Windows Media Player, interface IWMPSubscriptionService
- lojas online, interface IWMPSubscriptionService
- tipo 2 lojas online, interface IWMPSubscriptionService
- plug-ins, lojas online do Windows Media Player
- plug-ins, lojas online
- plug-ins, tipo 2 lojas online
- plug-ins, interface IWMPSubscriptionService
- Plug-ins do Windows Media Player, tipo 2 lojas online
- Plug-ins do Windows Media Player, lojas online
- Plug-ins do Windows Media Player, lojas online do Windows Media Player
- Plug-ins do Windows Media Player, interface IWMPSubscriptionService
- IWMPSubscriptionService
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c6d2f3aeeaa7456c3452b498a1a728e24c96783c
ms.sourcegitcommit: ad672d3a10192c5ccac619ad2524407109266e93
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 05/25/2020
ms.locfileid: "104084401"
---
# <a name="type-2-online-store-plug-in"></a><span data-ttu-id="15281-118">Plug-in da loja online de tipo 2</span><span class="sxs-lookup"><span data-stu-id="15281-118">Type 2 Online Store Plug-in</span></span>

<span data-ttu-id="15281-119">Um plug-in de loja online tipo 2 é um componente COM que implementa a interface [IWMPSubscriptionService](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice) e, opcionalmente, a interface [IWMPSubscriptionService2](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice2) .</span><span class="sxs-lookup"><span data-stu-id="15281-119">A type 2 online store plug-in is a COM component that implements the [IWMPSubscriptionService](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice) interface and optionally the [IWMPSubscriptionService2](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice2) interface.</span></span> <span data-ttu-id="15281-120">O Windows Media Player 9 chama os métodos da interface **IWMPSubscriptionService** .</span><span class="sxs-lookup"><span data-stu-id="15281-120">Windows Media Player 9 calls the methods of the **IWMPSubscriptionService** interface.</span></span> <span data-ttu-id="15281-121">O Windows Media Player 10 ou posterior chama os métodos das interfaces **IWMPSubscriptionService** e **IWMPSubscriptionService2** .</span><span class="sxs-lookup"><span data-stu-id="15281-121">Windows Media Player 10 or later calls the methods of both the **IWMPSubscriptionService** and **IWMPSubscriptionService2** interfaces.</span></span>

<span data-ttu-id="15281-122">Um plug-in de loja online tipo 2 é empacotado como um servidor COM em processo.</span><span class="sxs-lookup"><span data-stu-id="15281-122">A type 2 online store plug-in is packaged as an in-process COM server.</span></span> <span data-ttu-id="15281-123">Ou seja, o plug-in é implementado em um arquivo. dll que é mapeado para o processo do Windows Media Player.</span><span class="sxs-lookup"><span data-stu-id="15281-123">That is, the plug-in is implemented in a .dll file that is mapped into the Windows Media Player process.</span></span>

<span data-ttu-id="15281-124">O Windows Media Player ativa plug-ins de loja online do tipo 2, conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="15281-124">Windows Media Player activates type 2 online store plug-ins as needed.</span></span> <span data-ttu-id="15281-125">Por exemplo, suponha que o usuário tente reproduzir uma música protegida e não haja licença atual para reproduzi-la.</span><span class="sxs-lookup"><span data-stu-id="15281-125">For example, suppose the user attempts to play a protected song, and there is no current license to play it.</span></span> <span data-ttu-id="15281-126">Nesse caso, o Windows Media Player inspeciona o atributo **ContentDistributor** no cabeçalho do arquivo ou no cabeçalho DRM.</span><span class="sxs-lookup"><span data-stu-id="15281-126">In that case, Windows Media Player inspects the **ContentDistributor** attribute in either the file header or the DRM header.</span></span> <span data-ttu-id="15281-127">Se existir um valor que corresponda ao nome da chave de uma loja online, o Windows Media Player verificará o registro para ver se o repositório online forneceu um plug-in do tipo 2.</span><span class="sxs-lookup"><span data-stu-id="15281-127">If a value exists that matches the key name of an online store, Windows Media Player checks the registry to see whether that online store has provided a type 2 plug-in.</span></span> <span data-ttu-id="15281-128">Se o plug-in existir, o Windows Media Player carregará o plug-in e chamará seus métodos para determinar se o usuário tem os direitos de reproduzir a música.</span><span class="sxs-lookup"><span data-stu-id="15281-128">If the plug-in exists, Windows Media Player loads the plug-in and calls its methods to determine whether the user is has the rights to play the song.</span></span>

<span data-ttu-id="15281-129">A lista a seguir descreve alguns dos cenários nos quais o Windows Media Player chama um plug-in de loja online tipo 2.</span><span class="sxs-lookup"><span data-stu-id="15281-129">The following list describes some of the scenarios in which Windows Media Player calls a type 2 online store plug-in.</span></span>

-   <span data-ttu-id="15281-130">**O usuário tenta reproduzir o conteúdo da loja online.**</span><span class="sxs-lookup"><span data-stu-id="15281-130">**The user attempts to play online store content.**</span></span> <span data-ttu-id="15281-131">Quando isso acontece, o Windows Media Player chama o método [IWMPSubscriptionService:: allowPlay](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-allowplay) do plug-in, passando um ponteiro para o item de mídia digital que o usuário está tentando reproduzir.</span><span class="sxs-lookup"><span data-stu-id="15281-131">When this happens, Windows Media Player calls the plug-in's [IWMPSubscriptionService::allowPlay](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-allowplay) method, passing a pointer to the digital media item that the user is attempting to play.</span></span> <span data-ttu-id="15281-132">O repositório online pode usar isso como uma oportunidade de atualizar a licença do usuário para reproduzir o conteúdo ou para não permitir a reprodução.</span><span class="sxs-lookup"><span data-stu-id="15281-132">The online store can use this as an opportunity to update the user's license to play the content or to disallow playback.</span></span> <span data-ttu-id="15281-133">Se o plug-in retornar **true** no parâmetro *PfAllowPlay* , o Windows Media Player tentará reproduzir o conteúdo.</span><span class="sxs-lookup"><span data-stu-id="15281-133">If the plug-in returns **TRUE** in the *pfAllowPlay* parameter, Windows Media Player attempts to play the content.</span></span> <span data-ttu-id="15281-134">A reprodução continuará falhando se uma licença válida não existir; Esse processo não evita o gerenciamento de direitos digitais (DRM).</span><span class="sxs-lookup"><span data-stu-id="15281-134">Playback will still fail if a valid license does not exist; this process does not circumvent digital rights management (DRM).</span></span>
-   <span data-ttu-id="15281-135">**O usuário solicita permissão para gravar conteúdo em um CD ou DVD.**</span><span class="sxs-lookup"><span data-stu-id="15281-135">**The user requests permission to burn content to a CD or DVD.**</span></span> <span data-ttu-id="15281-136">Quando isso acontece, o Windows Media Player chama o método [IWMPSubscriptionService:: allowCDBurn](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-allowcdburn) do plug-in.</span><span class="sxs-lookup"><span data-stu-id="15281-136">When this happens, Windows Media Player calls the plug-in's [IWMPSubscriptionService::allowCDBurn](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-allowcdburn) method.</span></span>
-   <span data-ttu-id="15281-137">**O usuário tenta sincronizar o conteúdo da loja online com um dispositivo ou o Windows Media Player está pronto para sincronizar automaticamente o conteúdo da loja online com um dispositivo.**</span><span class="sxs-lookup"><span data-stu-id="15281-137">**The user attempts to synchronize online store content with a device, or Windows Media Player is ready to automatically synchronize online store content with a device.**</span></span> <span data-ttu-id="15281-138">Quando isso acontece, o Windows Media Player chama o método [IWMPSubscriptionService2::P repareforsync](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-prepareforsync) do plug-in para alertar a loja online que um item de mídia está prestes a ser sincronizado com um dispositivo específico, que é identificado por seu nome canônico.</span><span class="sxs-lookup"><span data-stu-id="15281-138">When this happens, Windows Media Player calls the plug-in's [IWMPSubscriptionService2::prepareForSync](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-prepareforsync) method to alert the online store that a media item is about to be synchronized with a particular device, which is identified by its canonical name.</span></span> <span data-ttu-id="15281-139">Essa é uma oportunidade para a loja online determinar se o usuário tem permissão para sincronizar o item de mídia com o dispositivo.</span><span class="sxs-lookup"><span data-stu-id="15281-139">This is an opportunity for the online store to determine whether the user is allowed to synchronize the media item with the device.</span></span> <span data-ttu-id="15281-140">Também é uma oportunidade para a loja online preparar o dispositivo para sincronização e para atualizar registros, como contagens de sincronização, associadas ao dispositivo ou ao item de mídia.</span><span class="sxs-lookup"><span data-stu-id="15281-140">It is also an opportunity for the online store to prepare the device for synchronization and to update records, such as synchronization counts, associated with the device or the media item.</span></span> <span data-ttu-id="15281-141">O plug-in deve passar as tarefas de permissão, preparação e manutenção de registros para um thread separado e retornar imediatamente do **prepareForSync**.</span><span class="sxs-lookup"><span data-stu-id="15281-141">The plug-in should pass the permission, preparation, and record-keeping tasks to a separate thread and return immediately from **prepareForSync**.</span></span> <span data-ttu-id="15281-142">Quando o thread separado terminar seu trabalho, ele deverá notificar o Windows Media Player chamando [IWMPSubscriptionServiceCallback:: OnComplete](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservicecallback-oncomplete).</span><span class="sxs-lookup"><span data-stu-id="15281-142">When the separate thread has finished its work, it must notify Windows Media Player by calling [IWMPSubscriptionServiceCallback::onComplete](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservicecallback-oncomplete).</span></span>
-   <span data-ttu-id="15281-143">**Um dispositivo fica disponível para processamento em segundo plano.**</span><span class="sxs-lookup"><span data-stu-id="15281-143">**A device becomes available for background processing.**</span></span> <span data-ttu-id="15281-144">Quando um dispositivo está conectado, o Windows Media Player alerta a loja online de que o dispositivo está disponível e está ocioso chamando [IWMPSubscriptionService2::D eviceavailable](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-deviceavailable).</span><span class="sxs-lookup"><span data-stu-id="15281-144">When a device is connected, Windows Media Player alerts the online store that the device is available and idle by calling [IWMPSubscriptionService2::deviceAvailable](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-deviceavailable).</span></span>
-   <span data-ttu-id="15281-145">**O usuário clica em um botão para ativar uma loja online no Windows Media Player.**</span><span class="sxs-lookup"><span data-stu-id="15281-145">**The user clicks a button to activate an online store in Windows Media Player.**</span></span> <span data-ttu-id="15281-146">Quando isso ocorre, o Windows Media Player chama o método [IWMPSubscriptionService2:: OnEvent](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-serviceevent) do plug-in.</span><span class="sxs-lookup"><span data-stu-id="15281-146">When this occurs, Windows Media Player calls the plug-in's [IWMPSubscriptionService2::serviceEvent](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-serviceevent) method.</span></span> <span data-ttu-id="15281-147">O Windows Media Player também chama esse método quando o usuário alterna para outro serviço.</span><span class="sxs-lookup"><span data-stu-id="15281-147">Windows Media Player also calls this method when the user switches to another service.</span></span>
-   <span data-ttu-id="15281-148">**O Windows Media Player entra em um estado de baixa atividade.**</span><span class="sxs-lookup"><span data-stu-id="15281-148">**Windows Media Player enters a state of low activity.**</span></span> <span data-ttu-id="15281-149">Quando isso acontece, o Player chama o método [IWMPSubscriptionService:: startBackgroundProcessing](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-startbackgroundprocessing) do plug-in.</span><span class="sxs-lookup"><span data-stu-id="15281-149">When this happens, the Player calls the plug-in's [IWMPSubscriptionService::startBackgroundProcessing](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-startbackgroundprocessing) method.</span></span> <span data-ttu-id="15281-150">O repositório online pode usar essa oportunidade para iniciar ou ativar quaisquer threads que executam tarefas em segundo plano, como renovar licenças expiradas ou compilar dados de contagem de reprodução.</span><span class="sxs-lookup"><span data-stu-id="15281-150">The online store can use this opportunity to start or wake up any threads that perform background tasks, such as renewing expired licenses or compiling play-count data.</span></span>
-   <span data-ttu-id="15281-151">**O Windows Media Player entra em um estado de alta atividade.**</span><span class="sxs-lookup"><span data-stu-id="15281-151">**Windows Media Player enters a state of high activity.**</span></span> <span data-ttu-id="15281-152">Quando isso acontece, o Windows Media Player chama o método [IWMPSubscriptionService2:: stopBackgroundProcessing](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-stopbackgroundprocessing) do plug-in.</span><span class="sxs-lookup"><span data-stu-id="15281-152">When this happens, Windows Media Player calls the plug-in's [IWMPSubscriptionService2::stopBackgroundProcessing](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-stopbackgroundprocessing) method.</span></span> <span data-ttu-id="15281-153">Isso informa ao plug-in que ele deve suspender os threads que estão executando tarefas em segundo plano.</span><span class="sxs-lookup"><span data-stu-id="15281-153">This informs the plug-in that it must suspend any threads that are performing background tasks.</span></span>

<span data-ttu-id="15281-154">O Windows Media Player libera o componente de loja online quando a sessão do Player termina.</span><span class="sxs-lookup"><span data-stu-id="15281-154">Windows Media Player releases the online store component when the Player session ends.</span></span> <span data-ttu-id="15281-155">Após a liberação, o componente deve interromper qualquer processamento em segundo plano em andamento e, em seguida, desligar.</span><span class="sxs-lookup"><span data-stu-id="15281-155">Upon release, the component must interrupt any background processing in progress and then shut down.</span></span>

## <a name="related-topics"></a><span data-ttu-id="15281-156">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="15281-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="15281-157">**Interface IWMPSubscriptionService**</span><span class="sxs-lookup"><span data-stu-id="15281-157">**IWMPSubscriptionService Interface**</span></span>](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice)
</dt> <dt>

[<span data-ttu-id="15281-158">**Interface IWMPSubscriptionService2**</span><span class="sxs-lookup"><span data-stu-id="15281-158">**IWMPSubscriptionService2 Interface**</span></span>](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice2)
</dt> <dt>

[<span data-ttu-id="15281-159">**Interface IWMPSubscriptionServiceCallback**</span><span class="sxs-lookup"><span data-stu-id="15281-159">**IWMPSubscriptionServiceCallback Interface**</span></span>](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservicecallback)
</dt> <dt>

[<span data-ttu-id="15281-160">**Tipo 2 amostras de loja online**</span><span class="sxs-lookup"><span data-stu-id="15281-160">**Type 2 Online Store Samples**</span></span>](type-2-online-store-samples.md)
</dt> </dl>

 

 




