---
title: atributo de objeto
description: O atributo \ Object \ interface identifica uma interface COM.
ms.assetid: 51e34ef3-eea7-45f4-b961-a9f742700fe5
keywords:
- MIDL de atributo de objeto
topic_type:
- apiref
api_name:
- object
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: cb2c21246282646dcf6ae488411316e07ab62b2f
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/19/2020
ms.locfileid: "103640858"
---
# <a name="object-attribute"></a><span data-ttu-id="f69bb-104">atributo de objeto</span><span class="sxs-lookup"><span data-stu-id="f69bb-104">object attribute</span></span>

<span data-ttu-id="f69bb-105">O atributo de interface de **\[ objeto \]** identifica uma interface com.</span><span class="sxs-lookup"><span data-stu-id="f69bb-105">The **\[object\]** interface attribute identifies a COM interface.</span></span> <span data-ttu-id="f69bb-106">(Uma lista de atributos de interface que não inclui o atributo **\[ Object \]** indica uma interface RPC DCE.)</span><span class="sxs-lookup"><span data-stu-id="f69bb-106">(An interface attribute list that does not include the **\[object\]** attribute indicates a DCE RPC interface.)</span></span>

``` syntax
[ 
    object, 
    uuid(string-uuid)
    [ , interface-attribute-list] 
] 
interface interface-name : base-interface
{
...    
}
```

## <a name="parameters"></a><span data-ttu-id="f69bb-107">Parâmetros</span><span class="sxs-lookup"><span data-stu-id="f69bb-107">Parameters</span></span>

<dl> <dt>

<span data-ttu-id="f69bb-108">*Cadeia de caracteres-UUID*</span><span class="sxs-lookup"><span data-stu-id="f69bb-108">*string-uuid*</span></span> 
</dt> <dd>

<span data-ttu-id="f69bb-109">Uma cadeia de caracteres UUID gerada pelo utilitário Uuidgen.</span><span class="sxs-lookup"><span data-stu-id="f69bb-109">A UUID string generated by the Uuidgen utility.</span></span> <span data-ttu-id="f69bb-110">Você pode colocar a cadeia de caracteres UUID entre aspas.</span><span class="sxs-lookup"><span data-stu-id="f69bb-110">You can enclose the UUID string in quotes.</span></span>

</dd> <dt>

<span data-ttu-id="f69bb-111">*interface-atributo-lista*</span><span class="sxs-lookup"><span data-stu-id="f69bb-111">*interface-attribute-list*</span></span> 
</dt> <dd>

<span data-ttu-id="f69bb-112">Outros atributos que se aplicam à interface como um todo.</span><span class="sxs-lookup"><span data-stu-id="f69bb-112">Other attributes that apply to the interface as a whole.</span></span>

</dd> <dt>

<span data-ttu-id="f69bb-113">*nome da interface*</span><span class="sxs-lookup"><span data-stu-id="f69bb-113">*interface-name*</span></span> 
</dt> <dd>

<span data-ttu-id="f69bb-114">O nome da interface.</span><span class="sxs-lookup"><span data-stu-id="f69bb-114">The name of the interface.</span></span>

</dd> <dt>

<span data-ttu-id="f69bb-115">*interface base*</span><span class="sxs-lookup"><span data-stu-id="f69bb-115">*base-interface*</span></span> 
</dt> <dd>

<span data-ttu-id="f69bb-116">A interface COM da qual essa interface deriva.</span><span class="sxs-lookup"><span data-stu-id="f69bb-116">The COM interface from which this interface derives.</span></span> <span data-ttu-id="f69bb-117">A interface base deve ser [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)ou outra interface com que derive, direta ou indiretamente, de **IUnknown** ou **IDispatch**.</span><span class="sxs-lookup"><span data-stu-id="f69bb-117">The base interface must be [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch), or another COM interface that derives, either directly or indirectly, from **IUnknown** or **IDispatch**.</span></span>

</dd> </dl>

## <a name="remarks"></a><span data-ttu-id="f69bb-118">Comentários</span><span class="sxs-lookup"><span data-stu-id="f69bb-118">Remarks</span></span>

<span data-ttu-id="f69bb-119">Uma lista de atributos de interface para uma interface COM deve incluir o **\[** atributo [**UUID**](uuid.md) **\]** , mas não pode incluir o **\[** [](version.md) **\]** atributo Version.</span><span class="sxs-lookup"><span data-stu-id="f69bb-119">An interface attribute list for a COM interface must include the **\[**[**uuid**](uuid.md)**\]** attribute, but it cannot include the **\[**[**version**](version.md)**\]** attribute.</span></span>

<span data-ttu-id="f69bb-120">Por padrão, a compilação de uma interface com com o compilador MIDL gera os arquivos necessários para criar uma DLL de proxy.</span><span class="sxs-lookup"><span data-stu-id="f69bb-120">By default, compiling a COM interface with the MIDL compiler generates the files needed to build a proxy DLL.</span></span> <span data-ttu-id="f69bb-121">Essa DLL contém o código para dar suporte ao uso da interface COM personalizada por aplicativos cliente e servidores de objetos.</span><span class="sxs-lookup"><span data-stu-id="f69bb-121">This DLL contains the code to support the use of the custom COM interface by both client applications and object servers.</span></span> <span data-ttu-id="f69bb-122">No entanto, se a lista de atributos de interface de uma interface COM especificar o **\[** atributo [**local**](local.md) **\]** , o compilador MIDL gerará apenas o arquivo de cabeçalho da interface.</span><span class="sxs-lookup"><span data-stu-id="f69bb-122">However, if the interface attribute list for a COM interface specifies the **\[**[**local**](local.md)**\]** attribute, the MIDL compiler generates only the interface header file.</span></span>

<span data-ttu-id="f69bb-123">O compilador MIDL gera automaticamente um tipo de dados de interface para uma interface COM.</span><span class="sxs-lookup"><span data-stu-id="f69bb-123">The MIDL compiler automatically generates an interface data type for a COM interface.</span></span> <span data-ttu-id="f69bb-124">Como alternativa, você pode usar [**typedef**](typedef.md) com a palavra-chave [**interface**](interface.md) para definir explicitamente um tipo de dados de interface.</span><span class="sxs-lookup"><span data-stu-id="f69bb-124">As an alternative, you can use [**typedef**](typedef.md) with the [**interface**](interface.md) keyword to explicitly define an interface data type.</span></span> <span data-ttu-id="f69bb-125">A especificação de interface pode usar o tipo de dados de interface nos parâmetros de função e valores de retorno, membros de [**struct**](struct.md) e [**Union**](union.md) e outras declarações de tipo.</span><span class="sxs-lookup"><span data-stu-id="f69bb-125">The interface specification can then use the interface data type in function parameters and return values, [**struct**](struct.md) and [**union**](union.md) members, and other type declarations.</span></span> <span data-ttu-id="f69bb-126">O exemplo a seguir ilustra o uso de um tipo de dados [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) gerado automaticamente:</span><span class="sxs-lookup"><span data-stu-id="f69bb-126">The following example illustrates the use of an automatically generated [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) data type:</span></span>

``` syntax
[
    object, 
    uuid (ABCDEFOO-1234-1234-5678-ABCDEF123456)
] 
interface IStream : IUnknown
{ 
    typedef IStream * LPSTREAM; 
    // Other interface definition statements.
}
```

<span data-ttu-id="f69bb-127">Em uma interface COM, todas as funções de membro de interface são consideradas como funções virtuais.</span><span class="sxs-lookup"><span data-stu-id="f69bb-127">In a COM interface, all the interface member functions are assumed to be virtual functions.</span></span> <span data-ttu-id="f69bb-128">Uma função virtual tem um indicador implícito **desse** ponteiro como o primeiro parâmetro.</span><span class="sxs-lookup"><span data-stu-id="f69bb-128">A virtual function has an implicit **this** pointer as the first parameter.</span></span> <span data-ttu-id="f69bb-129">A tabela de funções virtuais contém uma entrada para cada função de membro de interface.</span><span class="sxs-lookup"><span data-stu-id="f69bb-129">The virtual function table contains an entry for each interface member function.</span></span>

<span data-ttu-id="f69bb-130">**\[**[](local.md) **\]** Funções de membro de interface de objeto não local devem ter um valor de retorno de HRESULT ou SCODE.</span><span class="sxs-lookup"><span data-stu-id="f69bb-130">Non-**\[**[**local**](local.md)**\]** object interface member functions must have a return value of HRESULT or SCODE.</span></span> <span data-ttu-id="f69bb-131">(Observe que as versões anteriores do MIDL permitiam que as funções de membro retornassem [**void**](void.md).</span><span class="sxs-lookup"><span data-stu-id="f69bb-131">(Note that earlier versions of MIDL allowed member functions to return [**void**](void.md).</span></span> <span data-ttu-id="f69bb-132">No entanto, a partir do MIDL versão 3,0, retornar **void** gera um erro do compilador.) Ter um valor de retorno de HRESULT ou SCODE significa que, se uma exceção for gerada durante uma chamada remota, os proxies gerados capturarão a exceção e retornarão o código de exceção no valor de retorno.</span><span class="sxs-lookup"><span data-stu-id="f69bb-132">However, beginning with MIDL version 3.0, returning **void** generates a compiler error.) Having a return value of HRESULT or SCODE means that if an exception is generated during a remote call, the generated proxies catch the exception and return the exception code in the return value.</span></span> <span data-ttu-id="f69bb-133">Se seu aplicativo puder ignorar os erros que ocorrem durante uma chamada de procedimento remoto, você poderá especificar HRESULT como o tipo de retorno sem verificar o valor de retorno após a chamada.</span><span class="sxs-lookup"><span data-stu-id="f69bb-133">If your application can afford to ignore errors that occur during a remote procedure call, you can specify HRESULT as the return type without checking the return value after the call.</span></span>

<span data-ttu-id="f69bb-134">Se você estiver recompilando um aplicativo antigo, alterar os tipos de retorno poderá apresentar problemas de compatibilidade com versões anteriores quando o servidor enviar o resultado introduzido recentemente ao cliente.</span><span class="sxs-lookup"><span data-stu-id="f69bb-134">If you are recompiling an old application, changing the return types can introduce backward compatibility problems when the server sends the newly introduced result to the client.</span></span> <span data-ttu-id="f69bb-135">Como alternativa à alteração do tipo de retorno, você pode rotular a função que retorna [**void**](void.md) com a **\[** [**chamada \_ como**](call-as.md) **\]** atributo, tornando-a uma função local.</span><span class="sxs-lookup"><span data-stu-id="f69bb-135">As an alternative to changing the return type, you can label the function that returns [**void**](void.md) with the **\[**[**call\_as**](call-as.md)**\]** attribute, thus making it a local function.</span></span> <span data-ttu-id="f69bb-136">Em seguida, defina uma função remota relacionada com os mesmos parâmetros, mas com o tipo de retorno de HRESULT.</span><span class="sxs-lookup"><span data-stu-id="f69bb-136">Then define a related remote function with the same parameters but with the return type of HRESULT.</span></span> <span data-ttu-id="f69bb-137">A função local pode gerar uma exceção com base nesse valor HRESULT, se necessário.</span><span class="sxs-lookup"><span data-stu-id="f69bb-137">The local function can raise an exception based on that HRESULT value, if necessary.</span></span>

<span data-ttu-id="f69bb-138">O atributo **\[ \] Object** não está disponível quando você compila usando a opção [**/OSF**](-osf.md) do compilador MIDL.</span><span class="sxs-lookup"><span data-stu-id="f69bb-138">The **\[object\]** attribute is not available when you compile using the MIDL compiler [**/osf**](-osf.md) switch.</span></span>

## <a name="examples"></a><span data-ttu-id="f69bb-139">Exemplos</span><span class="sxs-lookup"><span data-stu-id="f69bb-139">Examples</span></span>

``` syntax
[
    uuid(12345678-1234-1234-1234-123456789ABC), 
    object
] 
interface IMyInterface : IUnknown
{
    // Interface definition statements.
}

[
    uuid(87654321-1234-1234-1234-123456789ABC), 
    object, 
    local
] 
interface ILocalInterface : ISomeOldCOMInterface
{
    // Interface definition statements.
}
```

## <a name="see-also"></a><span data-ttu-id="f69bb-140">Confira também</span><span class="sxs-lookup"><span data-stu-id="f69bb-140">See also</span></span>

<dl> <dt>

[<span data-ttu-id="f69bb-141">**chamar \_ como**</span><span class="sxs-lookup"><span data-stu-id="f69bb-141">**call\_as**</span></span>](call-as.md)
</dt> <dt>

[<span data-ttu-id="f69bb-142">Arquivo de definição de interface (IDL)</span><span class="sxs-lookup"><span data-stu-id="f69bb-142">Interface Definition (IDL) File</span></span>](interface-definition-idl-file.md)
</dt> <dt>

[<span data-ttu-id="f69bb-143">**IID \_ é**</span><span class="sxs-lookup"><span data-stu-id="f69bb-143">**iid\_is**</span></span>](iid-is.md)
</dt> <dt>

[<span data-ttu-id="f69bb-144">**interface**</span><span class="sxs-lookup"><span data-stu-id="f69bb-144">**interface**</span></span>](interface.md)
</dt> <dt>

[<span data-ttu-id="f69bb-145">**local**</span><span class="sxs-lookup"><span data-stu-id="f69bb-145">**local**</span></span>](local.md)
</dt> <dt>

[<span data-ttu-id="f69bb-146">**/osf**</span><span class="sxs-lookup"><span data-stu-id="f69bb-146">**/osf**</span></span>](-osf.md)
</dt> <dt>

[<span data-ttu-id="f69bb-147">**typedef**</span><span class="sxs-lookup"><span data-stu-id="f69bb-147">**typedef**</span></span>](typedef.md)
</dt> <dt>

[<span data-ttu-id="f69bb-148">**personalizado**</span><span class="sxs-lookup"><span data-stu-id="f69bb-148">**uuid**</span></span>](uuid.md)
</dt> <dt>

[<span data-ttu-id="f69bb-149">**Versão**</span><span class="sxs-lookup"><span data-stu-id="f69bb-149">**version**</span></span>](version.md)
</dt> </dl>

 

 