---
title: Empacotamento de tipos de dados OLE
description: Marshaling de automação e tipos de dados OLE.
ms.assetid: 0cab4208-d40d-40a1-88f2-4933b52c0c29
keywords:
- MIDL e MIDL de COM, marshaling de tipos de dados OLE
- empacotamento de MIDL
- MIDL de dados OLE
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5970c6e0fef9d0fc88b8a0a11a087fa4396d7a7c
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/19/2020
ms.locfileid: "103640563"
---
# <a name="marshaling-ole-data-types"></a><span data-ttu-id="c5c41-106">Empacotamento de tipos de dados OLE</span><span class="sxs-lookup"><span data-stu-id="c5c41-106">Marshaling OLE Data Types</span></span>

<span data-ttu-id="c5c41-107">Para facilitar o uso de determinados tipos de dados OLE e de automação, bem como alguns identificadores de sistema frequentemente usados em COM, typedefs para esses tipos de dados e suas funções auxiliares relacionadas estão disponíveis Importando arquivos IDL do Windows e vinculando aos arquivos DLL OLE e Automation.</span><span class="sxs-lookup"><span data-stu-id="c5c41-107">To make it easier to use certain Automation and OLE data types, as well as some system handles frequently used in COM, typedefs for these data types and their related helper functions are available by importing Windows IDL files and linking to the OLE and Automation DLL files.</span></span> <span data-ttu-id="c5c41-108">Esses arquivos são instalados automaticamente no seu sistema.</span><span class="sxs-lookup"><span data-stu-id="c5c41-108">These files are automatically installed on your system.</span></span>

-   <span data-ttu-id="c5c41-109">Para usar o tipo de dados [**BSTR**](/previous-versions/windows/desktop/automat/bstr) em chamadas de procedimento remoto, importe o arquivo wtypes. idl para seu arquivo de definição de interface (IDL) e vincule a Oleaut32. lib ao compilar seu aplicativo distribuído.</span><span class="sxs-lookup"><span data-stu-id="c5c41-109">To use the [**BSTR**](/previous-versions/windows/desktop/automat/bstr) data type in remote procedure calls, import the wtypes.idl file into your interface definition (IDL) file and link to Oleaut32.lib when building your distributed application.</span></span> <span data-ttu-id="c5c41-110">Isso permitirá que seus stubs usem as funções auxiliares **BSTR \_ nosize**, **BSTR \_ usermarshal**, **BSTR \_ UserUnmarshal** e **BSTR \_ unfree**.</span><span class="sxs-lookup"><span data-stu-id="c5c41-110">This will let your stubs use the ready-made helper functions **BSTR\_UserSize**, **BSTR\_UserMarshal**, **BSTR\_UserUnmarshal**, and **BSTR\_UserFree**.</span></span>
-   <span data-ttu-id="c5c41-111">Para usar outros tipos de dados de automação, como [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) e [**SafeArray**](/windows/win32/api/oaidl/ns-oaidl-safearray), ou tipos que usam esses tipos (por exemplo, [**DISPPARAMS**](/windows/win32/api/oaidl/ns-oaidl-dispparams) e [**EXCEPINFO**](/windows/win32/api/oaidl/ns-oaidl-excepinfo)), importe o arquivo Objidl. idl para o arquivo IDL e vincule ao Oleaut32. lib no momento da compilação.</span><span class="sxs-lookup"><span data-stu-id="c5c41-111">To use other Automation data types, such as [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) and [**SAFEARRAY**](/windows/win32/api/oaidl/ns-oaidl-safearray), or types that use those types (for example, [**DISPPARAMS**](/windows/win32/api/oaidl/ns-oaidl-dispparams) and [**EXCEPINFO**](/windows/win32/api/oaidl/ns-oaidl-excepinfo)), import the objidl.idl file into your IDL file and link to the oleaut32.lib at build time.</span></span> <span data-ttu-id="c5c41-112">Isso permitirá que você use as rotinas apropriadas do auxiliar.</span><span class="sxs-lookup"><span data-stu-id="c5c41-112">This will allow you to use the appropriate helper routines.</span></span>
-   <span data-ttu-id="c5c41-113">Para usar tipos de dados OLE (como CLIPFORMAT, SNB, STGMEDIUM, ASYNC \_ STGMEDIUM) ou identificadores do sistema (como HMETAFILE \_ PICT, HENHMETAFILE, HMETAFILE, HBITMAP, HPALETTE e HGLOBAL), importe o arquivo Objidl. idl para o arquivo de definição de interface e vincule ao Ole32. lib no momento da compilação.</span><span class="sxs-lookup"><span data-stu-id="c5c41-113">To use OLE data types (such as CLIPFORMAT, SNB, STGMEDIUM, ASYNC\_STGMEDIUM), or system handles (such as HMETAFILE\_PICT, HENHMETAFILE, HMETAFILE, HBITMAP, HPALETTE, and HGLOBAL), import the objidl.idl file into your interface definition file and link to the ole32.lib at build time.</span></span>
-   <span data-ttu-id="c5c41-114">Os seguintes identificadores OLE também são definidos com o atributo de **\[ \_ marshaling \] de fio** , mas somente como identificadores em um computador, pois não podem ser usados em chamadas de procedimento remoto para outros computadores neste momento: HWND, HMENU, HACCEL, HDC, HFONT, hicon, HBRUSH.</span><span class="sxs-lookup"><span data-stu-id="c5c41-114">The following OLE handles are also defined with the **\[wire\_marshal\]** attribute, but only as handles within a computer since they cannot be used in remote procedure calls to other computers at this time: HWND, HMENU, HACCEL, HDC, HFONT, HICON, HBRUSH.</span></span> <span data-ttu-id="c5c41-115">Importe o arquivo Objidl. idl para o arquivo IDL e vincule a Ole32. lib no momento da compilação para usar esses identificadores na comunicação entre processos em um único computador.</span><span class="sxs-lookup"><span data-stu-id="c5c41-115">Import the objidl.idl file into your IDL file and link to ole32.lib at build time to use these handles in interprocess communication on a single computer.</span></span>

<span data-ttu-id="c5c41-116">Para obter mais informações, consulte [o \_ atributo de marshaling de fio](/windows/desktop/Rpc/the-wire-marshal-attribute), [a \_ função Usersize](/windows/desktop/Rpc/the-type-usersize-function), [o tipo \_ função usermarshal](/windows/desktop/Rpc/the-type-usermarshal-function), [o tipo \_ UserUnmarshal function](/windows/desktop/Rpc/the-type-userunmarshal-function), [o tipo \_ usergratuito function](/windows/desktop/Rpc/the-type-userfree-function)e [direcionando stubs para plataformas específicas de 32 bits ou 64 bits](targeting-stubs-for-specific-32-bit-or-64-bit-platforms.md).</span><span class="sxs-lookup"><span data-stu-id="c5c41-116">For more information, see [The wire\_marshal Attribute](/windows/desktop/Rpc/the-wire-marshal-attribute), [The type\_UserSize Function](/windows/desktop/Rpc/the-type-usersize-function), [The type\_UserMarshal Function](/windows/desktop/Rpc/the-type-usermarshal-function), [The type\_UserUnmarshal Function](/windows/desktop/Rpc/the-type-userunmarshal-function), [The type\_UserFree Function](/windows/desktop/Rpc/the-type-userfree-function), and [Targeting Stubs for Specific 32-bit or 64-bit Platforms](targeting-stubs-for-specific-32-bit-or-64-bit-platforms.md).</span></span>

 

 