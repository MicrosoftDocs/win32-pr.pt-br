---
title: Bibliotecas COM, DCOM e tipos
description: O COM (Component Object Model) e o Distributed Component Object Model (DCOM) usam chamadas de procedimento remoto (RPC) para permitir que objetos de componente distribuído se comuniquem entre si.
ms.assetid: 7bade397-676e-43be-82f4-b23cd768fd16
keywords:
- interfaces MIDL, COM
- interfaces MIDL, DCOM
- MIDL de interfaces, bibliotecas de tipos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4f0b21aad9f88f02d8029d478eead50f5501ecc
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/19/2020
ms.locfileid: "103823731"
---
# <a name="com-dcom-and-type-libraries"></a><span data-ttu-id="3cfe5-106">Bibliotecas COM, DCOM e tipos</span><span class="sxs-lookup"><span data-stu-id="3cfe5-106">COM, DCOM, and Type Libraries</span></span>

<span data-ttu-id="3cfe5-107">O COM (Component Object Model) e o Distributed Component Object Model (DCOM) usam chamadas de procedimento remoto (RPC) para permitir que objetos de componente distribuído se comuniquem entre si.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-107">Component Object Model (COM) and Distributed Component Object Model (DCOM) use Remote Procedure Calls (RPC) to enable distributed component objects to communicate with each other.</span></span> <span data-ttu-id="3cfe5-108">Portanto, uma interface COM ou DCOM define a identidade e as características externas de um objeto COM.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-108">Thus, a COM or DCOM interface defines the identity and external characteristics of a COM object.</span></span> <span data-ttu-id="3cfe5-109">Ele forma o meio pelo qual os clientes podem obter acesso aos métodos e dados de um objeto.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-109">It forms the means by which clients can gain access to an object's methods and data.</span></span> <span data-ttu-id="3cfe5-110">Com o DCOM, esse acesso é possível independentemente de os objetos existirem no mesmo processo, processos diferentes no mesmo computador ou em máquinas diferentes.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-110">With DCOM, this access is possible regardless of whether the objects exist in the same process, different processes on the same machine, or on different machines.</span></span> <span data-ttu-id="3cfe5-111">Assim como acontece com as interfaces cliente/servidor RPC, um objeto COM ou DCOM pode expor sua funcionalidade de várias maneiras diferentes e por meio de diversas interfaces.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-111">As with RPC client/server interfaces, a COM or DCOM object can expose its functionality in a number of different ways and through multiple interfaces.</span></span>

## <a name="type-library"></a><span data-ttu-id="3cfe5-112">Biblioteca de tipos</span><span class="sxs-lookup"><span data-stu-id="3cfe5-112">Type Library</span></span>

<span data-ttu-id="3cfe5-113">Uma biblioteca de tipos (. tlb) é um arquivo binário que armazena informações sobre as propriedades e os métodos de um objeto COM ou DCOM em um formulário que pode ser acessado por outros aplicativos em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-113">A type library (.tlb) is a binary file that stores information about a COM or DCOM object's properties and methods in a form that is accessible to other applications at runtime.</span></span> <span data-ttu-id="3cfe5-114">Usando uma biblioteca de tipos, um aplicativo ou navegador pode determinar a quais interfaces um objeto dá suporte e invocar os métodos de interface de um objeto.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-114">Using a type library, an application or browser can determine which interfaces an object supports, and invoke an object's interface methods.</span></span> <span data-ttu-id="3cfe5-115">Isso pode ocorrer mesmo que os aplicativos de objeto e cliente tenham sido escritos em linguagens de programação diferentes.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-115">This can occur even if the object and client applications were written in different programming languages.</span></span> <span data-ttu-id="3cfe5-116">O ambiente de tempo de execução COM/DCOM também pode usar uma biblioteca de tipos para fornecer marshaling automático entre vários apartamento, processo e entre computadores para interfaces descritas em bibliotecas de tipos.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-116">The COM/DCOM run-time environment can also use a type library to provide automatic cross-apartment, cross-process, and cross-machine marshaling for interfaces described in type libraries.</span></span>

## <a name="characteristics-of-an-interface"></a><span data-ttu-id="3cfe5-117">Características de uma interface</span><span class="sxs-lookup"><span data-stu-id="3cfe5-117">Characteristics of an Interface</span></span>

<span data-ttu-id="3cfe5-118">Você define as características de uma interface em um arquivo de definição de interface (IDL) e um arquivo de configuração de aplicativo opcional (ACF):</span><span class="sxs-lookup"><span data-stu-id="3cfe5-118">You define the characteristics of an interface in an interface definition (IDL) file and an optional application configuration file (ACF):</span></span>

-   <span data-ttu-id="3cfe5-119">O arquivo IDL especifica as características das interfaces do aplicativo na conexão, ou seja, como os dados serão transmitidos entre o cliente e o servidor ou entre objetos COM.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-119">The IDL file specifies the characteristics of the application's interfaces on the wire — that is, how data is to be transmitted between client and server, or between COM objects.</span></span>
-   <span data-ttu-id="3cfe5-120">O arquivo ACF especifica características de interface, como identificadores de associação, que pertencem apenas ao ambiente operacional local.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-120">The ACF file specifies interface characteristics, such as binding handles, that pertain only to the local operating environment.</span></span> <span data-ttu-id="3cfe5-121">O arquivo ACF também pode especificar como realizar marshaling e transmitir uma estrutura de dados complexa em um formulário independente de máquina.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-121">The ACF file can also specify how to marshal and transmit a complex data structure in a machine-independent form.</span></span>

<span data-ttu-id="3cfe5-122">Para obter mais informações sobre arquivos IDL e ACF, consulte [os arquivos IDL e ACF](/windows/desktop/Rpc/the-idl-and-acf-files).</span><span class="sxs-lookup"><span data-stu-id="3cfe5-122">For more information on IDL and ACF files, see [The IDL and ACF Files](/windows/desktop/Rpc/the-idl-and-acf-files).</span></span>

<span data-ttu-id="3cfe5-123">Os arquivos IDL e ACF são scripts escritos em linguagem IDL da Microsoft (MIDL), que é a implementação da Microsoft e a extensão da IDL (linguagem de definição de interface) uso-DCE.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-123">The IDL and ACF files are scripts written in Microsoft Interface Definition Language (MIDL), which is the Microsoft implementation and extension of the OSF-DCE interface definition language (IDL).</span></span> <span data-ttu-id="3cfe5-124">As extensões da Microsoft para a linguagem IDL permitem que você crie interfaces COM e bibliotecas de tipos.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-124">The Microsoft extensions to the IDL language enable you to create COM interfaces and type libraries.</span></span> <span data-ttu-id="3cfe5-125">O compilador, Midl.exe, usa esses scripts para gerar stubs de linguagem C e arquivos de cabeçalho, bem como arquivos de biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-125">The compiler, Midl.exe, uses these scripts to generate C-language stubs and header files as well as type library files.</span></span>

## <a name="the-midl-compiler"></a><span data-ttu-id="3cfe5-126">O compilador MIDL</span><span class="sxs-lookup"><span data-stu-id="3cfe5-126">The MIDL Compiler</span></span>

<span data-ttu-id="3cfe5-127">Dependendo do conteúdo do seu arquivo IDL, o compilador MIDL gerará qualquer um dos arquivos a seguir.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-127">Depending on the contents of your IDL file, the MIDL compiler will generate any of the following files.</span></span>

<span data-ttu-id="3cfe5-128">Um arquivo de proxy/stub do idioma C, um arquivo de identificador de interface, um arquivo de dados DLL e um arquivo de cabeçalho relacionado para uma interface COM personalizada.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-128">A C-language proxy/stub file, an interface identifier file, a DLL data file, and a related header file for a custom COM interface.</span></span> <span data-ttu-id="3cfe5-129">O compilador MIDL gera esses arquivos quando encontra o atributo Object em uma lista de atributos de interface.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-129">The MIDL compiler generates these files when it encounters the object attribute in an interface attribute list.</span></span> <span data-ttu-id="3cfe5-130">Para obter informações mais detalhadas sobre esses arquivos, consulte [arquivos gerados para uma interface com](files-generated-for-a-com-interface.md).</span><span class="sxs-lookup"><span data-stu-id="3cfe5-130">For more detailed information on these files, see [Files Generated for a COM Interface](files-generated-for-a-com-interface.md).</span></span>

<span data-ttu-id="3cfe5-131">Um arquivo de biblioteca de tipos compilado (. tlb) e um arquivo de cabeçalho relacionado.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-131">A compiled type library (.tlb) file and related header file.</span></span> <span data-ttu-id="3cfe5-132">O MIDL gera esses arquivos quando encontra uma instrução de [**biblioteca**](library.md) no arquivo IDL.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-132">MIDL generates these files when it encounters a [**library**](library.md) statement in the IDL file.</span></span> <span data-ttu-id="3cfe5-133">Para obter informações gerais sobre bibliotecas de tipos, consulte [conteúdo de uma biblioteca de tipos](/previous-versions/windows/desktop/automat/contents-of-a-type-library), na referência do programador de automação.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-133">For general information about type libraries, see [Contents of a Type Library](/previous-versions/windows/desktop/automat/contents-of-a-type-library), in the Automation Programmer's Reference.</span></span>

<span data-ttu-id="3cfe5-134">Arquivos stub de servidor e de cliente de linguagem C/C++ e arquivo de cabeçalho relacionado para uma interface RPC.</span><span class="sxs-lookup"><span data-stu-id="3cfe5-134">C/C++-language client and server stub files and related header file for an RPC interface.</span></span> <span data-ttu-id="3cfe5-135">Esses arquivos são gerados quando há interfaces no arquivo IDL que não têm o atributo [**Object**](object.md) .</span><span class="sxs-lookup"><span data-stu-id="3cfe5-135">These files are generated when there are interfaces in the IDL file that do not have the [**object**](object.md) attribute.</span></span> <span data-ttu-id="3cfe5-136">Para obter uma visão geral dos arquivos stub e de cabeçalho, consulte [procedimento de Build geral](/windows/desktop/Rpc/general-build-procedure).</span><span class="sxs-lookup"><span data-stu-id="3cfe5-136">For an overview of the stub and header files, see [General Build Procedure](/windows/desktop/Rpc/general-build-procedure).</span></span> <span data-ttu-id="3cfe5-137">Para obter informações mais detalhadas, consulte [arquivos gerados para uma interface RPC](files-generated-for-an-rpc-interface.md).</span><span class="sxs-lookup"><span data-stu-id="3cfe5-137">For more detailed information, see [Files Generated for an RPC Interface](files-generated-for-an-rpc-interface.md).</span></span>

 

 