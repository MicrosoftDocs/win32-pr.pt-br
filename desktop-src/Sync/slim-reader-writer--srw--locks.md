---
description: Bloqueios de SRW (leitor/gravador) reduzidos permitem que os threads de um único processo acessem recursos compartilhados; Eles são otimizados para velocidade e ocupam muito pouca memória.
ms.assetid: 2d439b21-291f-4ff0-910a-c1c27e800019
title: Bloqueios de SRW (leitor/gravador) reduzidos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fe7d76d956e1425531eae43b0daa6817002a92bc
ms.sourcegitcommit: 663239b4560bfd5314e86901c65805c9bbcab07d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/15/2021
ms.locfileid: "105756131"
---
# <a name="slim-readerwriter-srw-locks"></a><span data-ttu-id="ffcac-103">Bloqueios de SRW (leitor/gravador) reduzidos</span><span class="sxs-lookup"><span data-stu-id="ffcac-103">Slim Reader/Writer (SRW) Locks</span></span>

<span data-ttu-id="ffcac-104">Bloqueios de SRW (leitor/gravador) reduzidos permitem que os threads de um único processo acessem recursos compartilhados; Eles são otimizados para velocidade e ocupam muito pouca memória.</span><span class="sxs-lookup"><span data-stu-id="ffcac-104">Slim reader/writer (SRW) locks enable the threads of a single process to access shared resources; they are optimized for speed and occupy very little memory.</span></span> <span data-ttu-id="ffcac-105">Leitor reduzido-os bloqueios de gravador não podem ser compartilhados entre processos.</span><span class="sxs-lookup"><span data-stu-id="ffcac-105">Slim reader-writer locks cannot be shared across processes.</span></span>

<span data-ttu-id="ffcac-106">Os threads de leitor lêem dados de um recurso compartilhado, enquanto os threads do gravador gravam dados em um recurso compartilhado.</span><span class="sxs-lookup"><span data-stu-id="ffcac-106">Reader threads read data from a shared resource whereas writer threads write data to a shared resource.</span></span> <span data-ttu-id="ffcac-107">Quando vários threads estão lendo e gravando usando um recurso compartilhado, bloqueios exclusivos, como uma seção crítica ou mutex, podem se tornar um afunilamento se os threads de leitor são executados continuamente, mas as operações de gravação são raras.</span><span class="sxs-lookup"><span data-stu-id="ffcac-107">When multiple threads are reading and writing using a shared resource, exclusive locks such as a critical section or mutex can become a bottleneck if the reader threads run continuously but write operations are rare.</span></span>

<span data-ttu-id="ffcac-108">Os bloqueios de SRW fornecem dois modos nos quais os threads podem acessar um recurso compartilhado:</span><span class="sxs-lookup"><span data-stu-id="ffcac-108">SRW locks provide two modes in which threads can access a shared resource:</span></span>

-   <span data-ttu-id="ffcac-109">**Modo compartilhado**, que concede acesso somente leitura compartilhado a vários threads de leitor, o que permite que eles leiam dados do recurso compartilhado simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="ffcac-109">**Shared mode**, which grants shared read-only access to multiple reader threads, which enables them to read data from the shared resource concurrently.</span></span> <span data-ttu-id="ffcac-110">Se operações de leitura excederem operações de gravação, essa simultaneidade aumentará o desempenho e a taxa de transferência em comparação com as seções críticas</span><span class="sxs-lookup"><span data-stu-id="ffcac-110">If read operations exceed write operations, this concurrency increases performance and throughput compared to critical sections.</span></span>
    > [!NOTE]
    > <span data-ttu-id="ffcac-111">Os bloqueios de SRW de modo compartilhado não devem ser adquiridos recursivamente, pois isso pode levar a deadlocks quando combinado com aquisição exclusiva.</span><span class="sxs-lookup"><span data-stu-id="ffcac-111">Shared mode SRW locks should not be acquired recursively as this can lead to deadlocks when combined with exclusive acquisition.</span></span>

-   <span data-ttu-id="ffcac-112">**Modo exclusivo**, que concede acesso de leitura/gravação a um thread de gravador por vez.</span><span class="sxs-lookup"><span data-stu-id="ffcac-112">**Exclusive mode**, which grants read/write access to one writer thread at a time.</span></span> <span data-ttu-id="ffcac-113">Quando o bloqueio for adquirido em modo exclusivo, nenhum outro thread poderá acessar o recurso compartilhado até que o gravador libere o bloqueio.</span><span class="sxs-lookup"><span data-stu-id="ffcac-113">When the lock has been acquired in exclusive mode, no other thread can access the shared resource until the writer releases the lock.</span></span>
    > [!NOTE]
    > <span data-ttu-id="ffcac-114">Os bloqueios de SRW em modo exclusivo não podem ser adquiridos recursivamente.</span><span class="sxs-lookup"><span data-stu-id="ffcac-114">Exclusive mode SRW locks cannot be acquired recursively.</span></span> <span data-ttu-id="ffcac-115">Se um thread tentar adquirir um bloqueio que ele já contém, essa tentativa falhará (para [**TryAcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive)) ou deadlock (para [**AcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive))</span><span class="sxs-lookup"><span data-stu-id="ffcac-115">If a thread tries to acquire a lock that it already holds, that attempt will fail (for [**TryAcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive)) or deadlock (for [**AcquireSRWLockExclusive**](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive))</span></span>

<span data-ttu-id="ffcac-116">Um único bloqueio de SRW pode ser adquirido em ambos os modos; os threads do leitor podem adquiri-lo no modo compartilhado, enquanto os threads do gravador podem adquiri-lo em modo exclusivo.</span><span class="sxs-lookup"><span data-stu-id="ffcac-116">A single SRW lock can be acquired in either mode; reader threads can acquire it in shared mode whereas writer threads can acquire it in exclusive mode.</span></span> <span data-ttu-id="ffcac-117">Não há nenhuma garantia sobre a ordem em que os threads que solicitam a propriedade serão concedidos à propriedade; Os bloqueios de SRW não são justos nem FIFO.</span><span class="sxs-lookup"><span data-stu-id="ffcac-117">There is no guarantee about the order in which threads that request ownership will be granted ownership; SRW locks are neither fair nor FIFO.</span></span>

<span data-ttu-id="ffcac-118">Um bloqueio de SRW é o tamanho de um ponteiro.</span><span class="sxs-lookup"><span data-stu-id="ffcac-118">An SRW lock is the size of a pointer.</span></span> <span data-ttu-id="ffcac-119">A vantagem é que é rápido atualizar o estado de bloqueio.</span><span class="sxs-lookup"><span data-stu-id="ffcac-119">The advantage is that it is fast to update the lock state.</span></span> <span data-ttu-id="ffcac-120">A desvantagem é que muito poucas informações de estado podem ser armazenadas, portanto, os bloqueios de SRW não detectam o uso recursivo incorreto no modo compartilhado.</span><span class="sxs-lookup"><span data-stu-id="ffcac-120">The disadvantage is that very little state information can be stored, so SRW locks do not detect incorrect recursive use in shared mode.</span></span> <span data-ttu-id="ffcac-121">Além disso, um thread que possui um bloqueio de SRW no modo compartilhado não pode atualizar sua propriedade do bloqueio para o modo exclusivo.</span><span class="sxs-lookup"><span data-stu-id="ffcac-121">In addition, a thread that owns an SRW lock in shared mode cannot upgrade its ownership of the lock to exclusive mode.</span></span>

<span data-ttu-id="ffcac-122">O chamador deve alocar uma estrutura SRWLOCK e inicializá-la chamando [**InitializeSRWLock**](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock) (para inicializar a estrutura dinamicamente) ou atribuir a constante **SRWLock \_ init** à variável de estrutura (para inicializar a estrutura estaticamente).</span><span class="sxs-lookup"><span data-stu-id="ffcac-122">The caller must allocate an SRWLOCK structure and initialize it by either calling [**InitializeSRWLock**](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock) (to initialize the structure dynamically) or assign the constant **SRWLOCK\_INIT** to the structure variable (to initialize the structure statically).</span></span>

<span data-ttu-id="ffcac-123">Você pode usar [Application Verifier](/windows-hardware/drivers/devtest/application-verifier) para localizar o uso recursivo (reentrante) de bloqueios de SRW.</span><span class="sxs-lookup"><span data-stu-id="ffcac-123">You can use [Application Verifier](/windows-hardware/drivers/devtest/application-verifier) to find recursive (reentrant) use of SRW locks.</span></span>

<span data-ttu-id="ffcac-124">A seguir estão as funções de bloqueio de SRW.</span><span class="sxs-lookup"><span data-stu-id="ffcac-124">The following are the SRW lock functions.</span></span>

| <span data-ttu-id="ffcac-125">Função de bloqueio de SRW</span><span class="sxs-lookup"><span data-stu-id="ffcac-125">SRW lock function</span></span>                                                | <span data-ttu-id="ffcac-126">Descrição</span><span class="sxs-lookup"><span data-stu-id="ffcac-126">Description</span></span>                                                                                                                                       |
|------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="ffcac-127">**AcquireSRWLockExclusive**</span><span class="sxs-lookup"><span data-stu-id="ffcac-127">**AcquireSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockexclusive)       | <span data-ttu-id="ffcac-128">Adquire um bloqueio de SRW em modo exclusivo.</span><span class="sxs-lookup"><span data-stu-id="ffcac-128">Acquires an SRW lock in exclusive mode.</span></span>                                                                                                           |
| [<span data-ttu-id="ffcac-129">**AcquireSRWLockShared**</span><span class="sxs-lookup"><span data-stu-id="ffcac-129">**AcquireSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-acquiresrwlockshared)             | <span data-ttu-id="ffcac-130">Adquire um bloqueio de SRW no modo compartilhado.</span><span class="sxs-lookup"><span data-stu-id="ffcac-130">Acquires an SRW lock in shared mode.</span></span>                                                                                                              |
| [<span data-ttu-id="ffcac-131">**InitializeSRWLock**</span><span class="sxs-lookup"><span data-stu-id="ffcac-131">**InitializeSRWLock**</span></span>](/windows/win32/api/synchapi/nf-synchapi-initializesrwlock)                   | <span data-ttu-id="ffcac-132">Inicializar um bloqueio de SRW.</span><span class="sxs-lookup"><span data-stu-id="ffcac-132">Initialize an SRW lock.</span></span>                                                                                                                           |
| [<span data-ttu-id="ffcac-133">**ReleaseSRWLockExclusive**</span><span class="sxs-lookup"><span data-stu-id="ffcac-133">**ReleaseSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-releasesrwlockexclusive)       | <span data-ttu-id="ffcac-134">Libera um bloqueio de SRW que foi aberto em modo exclusivo.</span><span class="sxs-lookup"><span data-stu-id="ffcac-134">Releases an SRW lock that was opened in exclusive mode.</span></span>                                                                                           |
| [<span data-ttu-id="ffcac-135">**ReleaseSRWLockShared**</span><span class="sxs-lookup"><span data-stu-id="ffcac-135">**ReleaseSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-releasesrwlockshared)             | <span data-ttu-id="ffcac-136">Libera um bloqueio de SRW que foi aberto no modo compartilhado.</span><span class="sxs-lookup"><span data-stu-id="ffcac-136">Releases an SRW lock that was opened in shared mode.</span></span>                                                                                              |
| [<span data-ttu-id="ffcac-137">**SleepConditionVariableSRW**</span><span class="sxs-lookup"><span data-stu-id="ffcac-137">**SleepConditionVariableSRW**</span></span>](/windows/win32/api/synchapi/nf-synchapi-sleepconditionvariablesrw)   | <span data-ttu-id="ffcac-138">Dorme na variável de condição especificada e libera o bloqueio especificado como uma operação atômica.</span><span class="sxs-lookup"><span data-stu-id="ffcac-138">Sleeps on the specified condition variable and releases the specified lock as an atomic operation.</span></span>                                                |
| [<span data-ttu-id="ffcac-139">**TryAcquireSRWLockExclusive**</span><span class="sxs-lookup"><span data-stu-id="ffcac-139">**TryAcquireSRWLockExclusive**</span></span>](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockexclusive) | <span data-ttu-id="ffcac-140">Tenta adquirir um bloqueio de SRW (leitor/gravador) reduzido no modo exclusivo.</span><span class="sxs-lookup"><span data-stu-id="ffcac-140">Attempts to acquire a slim reader/writer (SRW) lock in exclusive mode.</span></span> <span data-ttu-id="ffcac-141">Se a chamada for bem-sucedida, o thread de chamada assumirá a propriedade do bloqueio.</span><span class="sxs-lookup"><span data-stu-id="ffcac-141">If the call is successful, the calling thread takes ownership of the lock.</span></span> |
| [<span data-ttu-id="ffcac-142">**TryAcquireSRWLockShared**</span><span class="sxs-lookup"><span data-stu-id="ffcac-142">**TryAcquireSRWLockShared**</span></span>](/windows/win32/api/synchapi/nf-synchapi-tryacquiresrwlockshared)       | <span data-ttu-id="ffcac-143">Tenta adquirir um bloqueio de SRW (leitor/gravador) reduzido no modo compartilhado.</span><span class="sxs-lookup"><span data-stu-id="ffcac-143">Attempts to acquire a slim reader/writer (SRW) lock in shared mode.</span></span> <span data-ttu-id="ffcac-144">Se a chamada for bem-sucedida, o thread de chamada assumirá a propriedade do bloqueio.</span><span class="sxs-lookup"><span data-stu-id="ffcac-144">If the call is successful, the calling thread takes ownership of the lock.</span></span>    |

 
