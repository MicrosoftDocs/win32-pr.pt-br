---
title: Inscrevendo-se em eventos de automação da interface do usuário
description: A automação da interface do usuário da Microsoft permite que os clientes assinem eventos de interesse. Esse recurso melhora o desempenho ao eliminar a necessidade de sondar continuamente os elementos da interface do usuário no sistema para ver se alguma informação, estrutura ou estado foi alterada.
ms.assetid: 7019ecb8-6123-4e00-926c-6725d7e71385
keywords:
- clientes, eventos de automação da interface do usuário
- clientes, eventos para automação da interface do usuário
- Automação da interface do usuário, eventos para clientes
- Automação da interface do usuário, eventos de cliente
- Automação da interface do usuário, inscrevendo-se em eventos
- Automação da interface do usuário, métodos de assinatura
- Automação da interface do usuário, exemplos de código
- Automação da interface do usuário, exemplos
- Automação da interface do usuário, amostras
- assinando eventos de Automação de Interface de Usuário
- eventos, assinatura de automação da interface do usuário
- Exemplos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5d9a89df1b9d2afc401e07b6cd77d1307d912f11
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104292279"
---
# <a name="subscribing-to-ui-automation-events"></a><span data-ttu-id="9e76f-116">Inscrevendo-se em eventos de automação da interface do usuário</span><span class="sxs-lookup"><span data-stu-id="9e76f-116">Subscribing to UI Automation Events</span></span>

<span data-ttu-id="9e76f-117">A automação da interface do usuário da Microsoft permite que os clientes assinem eventos de interesse.</span><span class="sxs-lookup"><span data-stu-id="9e76f-117">Microsoft UI Automation allows clients to subscribe to events of interest.</span></span> <span data-ttu-id="9e76f-118">Esse recurso melhora o desempenho ao eliminar a necessidade de sondar continuamente os elementos da interface do usuário no sistema para ver se alguma informação, estrutura ou estado foi alterada.</span><span class="sxs-lookup"><span data-stu-id="9e76f-118">This capability improves performance by eliminating the need to continually poll the UI elements in the system to see if any information, structure, or state has changed.</span></span>

<span data-ttu-id="9e76f-119">A eficiência também é aprimorada pela capacidade de escutar eventos somente dentro de um escopo definido.</span><span class="sxs-lookup"><span data-stu-id="9e76f-119">Efficiency is also improved by the ability to listen for events only within a defined scope.</span></span> <span data-ttu-id="9e76f-120">Por exemplo, um cliente pode escutar alterações de seleção em um item de uma lista, na própria lista ou em uma caixa de diálogo inteira.</span><span class="sxs-lookup"><span data-stu-id="9e76f-120">For example, a client can listen for selection changes on an item in a list, on the list itself, or on an entire dialog box.</span></span>

> [!Note]  
> <span data-ttu-id="9e76f-121">Não presuma que todos os eventos possíveis sejam gerados por um provedor de automação de interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="9e76f-121">Do not assume that all possible events are raised by a UI Automation provider.</span></span> <span data-ttu-id="9e76f-122">Por exemplo, nem todas as alterações de propriedade fazem com que os eventos sejam gerados pelos provedores de proxy padrão para os controles Windows Forms e Microsoft Win32.</span><span class="sxs-lookup"><span data-stu-id="9e76f-122">For example, not all property changes cause events to be raised by the standard proxy providers for Windows Forms and Microsoft Win32 controls.</span></span>

 

<span data-ttu-id="9e76f-123">Para obter uma visão mais ampla dos eventos de automação da interface do usuário, consulte [visão geral dos eventos de automação da IU](uiauto-eventsoverview.md).</span><span class="sxs-lookup"><span data-stu-id="9e76f-123">For a broader view of UI Automation events, see [UI Automation Events Overview](uiauto-eventsoverview.md).</span></span>

> [!Note]  
> <span data-ttu-id="9e76f-124">Antes de implementar um manipulador de eventos, você deve estar familiarizado com os problemas de Threading descritos em [noções básicas sobre problemas de Threading](uiauto-threading.md).</span><span class="sxs-lookup"><span data-stu-id="9e76f-124">Before implementing an event handler, you should be familiar with the threading issues described in [Understanding Threading Issues](uiauto-threading.md).</span></span>

 

<span data-ttu-id="9e76f-125">Este tópico inclui as seções a seguir.</span><span class="sxs-lookup"><span data-stu-id="9e76f-125">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="9e76f-126">Registrando manipuladores de eventos</span><span class="sxs-lookup"><span data-stu-id="9e76f-126">Registering Event Handlers</span></span>](#registering-event-handlers)
-   [<span data-ttu-id="9e76f-127">Exemplos</span><span class="sxs-lookup"><span data-stu-id="9e76f-127">Examples</span></span>](#examples)
-   [<span data-ttu-id="9e76f-128">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="9e76f-128">Related topics</span></span>](#related-topics)

## <a name="registering-event-handlers"></a><span data-ttu-id="9e76f-129">Registrando manipuladores de eventos</span><span class="sxs-lookup"><span data-stu-id="9e76f-129">Registering Event Handlers</span></span>

<span data-ttu-id="9e76f-130">Os aplicativos cliente assinam eventos de um tipo específico registrando um manipulador de eventos, usando um dos seguintes métodos [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) .</span><span class="sxs-lookup"><span data-stu-id="9e76f-130">Client applications subscribe to events of a particular kind by registering an event handler, using one of the following [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) methods.</span></span>



| <span data-ttu-id="9e76f-131">Método de assinatura</span><span class="sxs-lookup"><span data-stu-id="9e76f-131">Subscription Method</span></span>                                                                                                                                                                                                | <span data-ttu-id="9e76f-132">Tipo de evento</span><span class="sxs-lookup"><span data-stu-id="9e76f-132">Event Type</span></span>       | <span data-ttu-id="9e76f-133">Interface de retorno de chamada</span><span class="sxs-lookup"><span data-stu-id="9e76f-133">Callback Interface</span></span>                                                                                    |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------|-------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9e76f-134">**AddFocusChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9e76f-134">**AddFocusChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addfocuschangedeventhandler)                                                                                                                            | <span data-ttu-id="9e76f-135">Alteração de foco</span><span class="sxs-lookup"><span data-stu-id="9e76f-135">Focus change</span></span>     | [<span data-ttu-id="9e76f-136">**IUIAutomationFocusChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9e76f-136">**IUIAutomationFocusChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler)         |
| <span data-ttu-id="9e76f-137">[**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler), [ **AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray)</span><span class="sxs-lookup"><span data-stu-id="9e76f-137">[**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler), [**AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray)</span></span> | <span data-ttu-id="9e76f-138">Alteração da propriedade</span><span class="sxs-lookup"><span data-stu-id="9e76f-138">Property change</span></span>  | [<span data-ttu-id="9e76f-139">**IUIAutomationPropertyChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9e76f-139">**IUIAutomationPropertyChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationpropertychangedeventhandler)   |
| [<span data-ttu-id="9e76f-140">**AddStructureChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9e76f-140">**AddStructureChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addstructurechangedeventhandler)                                                                                                                    | <span data-ttu-id="9e76f-141">Alteração de estrutura</span><span class="sxs-lookup"><span data-stu-id="9e76f-141">Structure change</span></span> | [<span data-ttu-id="9e76f-142">**IUIAutomationStructureChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9e76f-142">**IUIAutomationStructureChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationstructurechangedeventhandler) |
| [<span data-ttu-id="9e76f-143">**AddNotificationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9e76f-143">**AddNotificationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-addnotificationeventhandler)                                                                                                                           | <span data-ttu-id="9e76f-144">Notificação</span><span class="sxs-lookup"><span data-stu-id="9e76f-144">Notification</span></span>     | [<span data-ttu-id="9e76f-145">**IUIAutomationNotificationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9e76f-145">**IUIAutomationNotificationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationnotificationeventhandler)         |
| [<span data-ttu-id="9e76f-146">**AddAutomationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9e76f-146">**AddAutomationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addautomationeventhandler)                                                                                                                                | <span data-ttu-id="9e76f-147">Outros eventos</span><span class="sxs-lookup"><span data-stu-id="9e76f-147">Other events</span></span>     | [<span data-ttu-id="9e76f-148">**IUIAutomationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9e76f-148">**IUIAutomationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationeventhandler)                                 |



 

<span data-ttu-id="9e76f-149">Quando um cliente adiciona um manipulador de eventos para todos os descendentes (os [**\_ descendentes TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope)), a automação da interface do usuário adiciona apenas um manipulador para a raiz da subárvore e o manipulador escuta em todos os descendentes.</span><span class="sxs-lookup"><span data-stu-id="9e76f-149">When a client adds an event handler for all descendants ([**TreeScope\_Descendants**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope)), UI Automation adds only one handler for the root of sub-tree, and the handler listens across all descendents.</span></span> <span data-ttu-id="9e76f-150">A automação da interface do usuário não Adiciona manipuladores de eventos recursivamente.</span><span class="sxs-lookup"><span data-stu-id="9e76f-150">UI Automation does not add event handlers recursively.</span></span>

<span data-ttu-id="9e76f-151">Quando um cliente chama o método [**IUIAutomation:: RemoveAllEventHandlers**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removealleventhandlers) , a automação da interface do usuário remove todos os manipuladores de eventos do processo do cliente.</span><span class="sxs-lookup"><span data-stu-id="9e76f-151">When a client calls the [**IUIAutomation::RemoveAllEventHandlers**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removealleventhandlers) method, UI Automation removes all event handlers from the client process.</span></span>

<span data-ttu-id="9e76f-152">Para receber e manipular eventos, você implementa um objeto de manipulação de eventos que expõe uma interface de retorno de chamada, e você deve registrar o objeto chamando um método de registro de evento, como [**IUIAutomation:: AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler).</span><span class="sxs-lookup"><span data-stu-id="9e76f-152">To receive and handle events, you implement an event-handling object that exposes a callback interface, and you must register the object by calling an event registration method such as [**IUIAutomation::AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler).</span></span> <span data-ttu-id="9e76f-153">A interface de retorno de chamada tem um único método; A automação da interface do usuário chama esse método quando o evento é processado.</span><span class="sxs-lookup"><span data-stu-id="9e76f-153">The callback interface has a single method; UI Automation calls this method when the event is processed.</span></span>

<span data-ttu-id="9e76f-154">No desligamento, ou quando eventos de automação da interface do usuário não são mais interessantes para o aplicativo, os clientes de automação da interface do usuário devem chamar um ou mais dos seguintes métodos [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) .</span><span class="sxs-lookup"><span data-stu-id="9e76f-154">On shutdown, or when UI Automation events are no longer of interest to the application, UI Automation clients should call one or more of the following [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) methods.</span></span>

> [!Note]  
> <span data-ttu-id="9e76f-155">Um cliente de automação de interface do usuário não deve usar vários threads para adicionar ou remover manipuladores de eventos.</span><span class="sxs-lookup"><span data-stu-id="9e76f-155">A UI Automation client should not use multiple threads to add or remove event handlers.</span></span> <span data-ttu-id="9e76f-156">Um comportamento inesperado pode ocorrer se um manipulador de eventos estiver sendo adicionado ou removido enquanto outro estiver sendo adicionado ou removido no mesmo processo de cliente.</span><span class="sxs-lookup"><span data-stu-id="9e76f-156">Unexpected behavior can result if one event handler is being added or removed while another is being added or removed in the same client process.</span></span>

 



| <span data-ttu-id="9e76f-157">Método</span><span class="sxs-lookup"><span data-stu-id="9e76f-157">Method</span></span>                                                                                                | <span data-ttu-id="9e76f-158">Descrição</span><span class="sxs-lookup"><span data-stu-id="9e76f-158">Description</span></span>                                                                                                                                                                                                                                                                     |
|-------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="9e76f-159">**RemoveAutomationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9e76f-159">**RemoveAutomationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removeautomationeventhandler)             | <span data-ttu-id="9e76f-160">Cancela o registro de um manipulador de eventos que foi registrado usando [**AddAutomationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addautomationeventhandler).</span><span class="sxs-lookup"><span data-stu-id="9e76f-160">Unregisters an event handler that was registered by using [**AddAutomationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addautomationeventhandler).</span></span>                                                                                                                                  |
| [<span data-ttu-id="9e76f-161">**RemoveFocusChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9e76f-161">**RemoveFocusChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removefocuschangedeventhandler)         | <span data-ttu-id="9e76f-162">Cancela o registro de um manipulador de eventos que foi registrado usando [**AddFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addfocuschangedeventhandler).</span><span class="sxs-lookup"><span data-stu-id="9e76f-162">Unregisters an event handler that was registered by using [**AddFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addfocuschangedeventhandler).</span></span>                                                                                                                              |
| [<span data-ttu-id="9e76f-163">**RemovePropertyChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9e76f-163">**RemovePropertyChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removepropertychangedeventhandler)   | <span data-ttu-id="9e76f-164">Cancela o registro de um manipulador de eventos que foi registrado usando [**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler) ou [**AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray).</span><span class="sxs-lookup"><span data-stu-id="9e76f-164">Unregisters an event handler that was registered by using [**AddPropertyChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandler) or [**AddPropertyChangedEventHandlerNativeArray**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addpropertychangedeventhandlernativearray).</span></span> |
| [<span data-ttu-id="9e76f-165">**RemoveStructureChangedEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9e76f-165">**RemoveStructureChangedEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removestructurechangedeventhandler) | <span data-ttu-id="9e76f-166">Cancela o registro de um manipulador de eventos que foi registrado usando [**AddStructureChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addstructurechangedeventhandler).</span><span class="sxs-lookup"><span data-stu-id="9e76f-166">Unregisters an event handler that was registered by using [**AddStructureChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-addstructurechangedeventhandler).</span></span>                                                                                                                      |
| [<span data-ttu-id="9e76f-167">**RemoveNotificationEventHandler**</span><span class="sxs-lookup"><span data-stu-id="9e76f-167">**RemoveNotificationEventHandler**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-removenotificationeventhandler)        | <span data-ttu-id="9e76f-168">Cancela o registro de um manipulador de eventos que Weas registrado usando [**AddNotificationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-addnotificationeventhandler).</span><span class="sxs-lookup"><span data-stu-id="9e76f-168">Unregisters an event handler that weas registered by using [**AddNotificationEventHandler**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation5-addnotificationeventhandler).</span></span>                                                                                                                            |
| [<span data-ttu-id="9e76f-169">**RemoveAllEventHandlers**</span><span class="sxs-lookup"><span data-stu-id="9e76f-169">**RemoveAllEventHandlers**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-removealleventhandlers)                         | <span data-ttu-id="9e76f-170">Cancela o registro de todos os manipuladores de eventos registrados.</span><span class="sxs-lookup"><span data-stu-id="9e76f-170">Unregisters all registered event handlers.</span></span>                                                                                                                                                                                                                                      |



 

<span data-ttu-id="9e76f-171">É possível que um evento seja entregue a um manipulador de eventos após o cancelamento da assinatura do manipulador, se o evento for recebido simultaneamente com a solicitação para cancelar a assinatura do evento.</span><span class="sxs-lookup"><span data-stu-id="9e76f-171">It is possible for an event to be delivered to an event handler after the handler has been unsubscribed, if the event is received simultaneously with the request to unsubscribe the event.</span></span> <span data-ttu-id="9e76f-172">A prática recomendada é seguir o padrão de Component Object Model (COM) e evitar destruir o objeto manipulador de eventos até que sua contagem de referência tenha atingido zero.</span><span class="sxs-lookup"><span data-stu-id="9e76f-172">The best practice is to follow the Component Object Model (COM) standard and avoid destroying the event handler object until its reference count has reached zero.</span></span> <span data-ttu-id="9e76f-173">Destruir um manipulador de eventos imediatamente após a desentrada de eventos pode resultar em uma violação de acesso se um evento for entregue tardiamente.</span><span class="sxs-lookup"><span data-stu-id="9e76f-173">Destroying an event handler immediately after unsubscribing for events may result in an access violation if an event is delivered late.</span></span>

## <a name="examples"></a><span data-ttu-id="9e76f-174">Exemplos</span><span class="sxs-lookup"><span data-stu-id="9e76f-174">Examples</span></span>

<span data-ttu-id="9e76f-175">Para obter exemplos de código que mostram como manipular eventos de automação da interface do usuário, consulte [como implementar manipuladores de eventos](uiauto-howto-implement-event-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="9e76f-175">For code examples that show how to handle UI Automation events, see [How to Implement Event Handlers](uiauto-howto-implement-event-handlers.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="9e76f-176">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="9e76f-176">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="9e76f-177">**Conceitua**</span><span class="sxs-lookup"><span data-stu-id="9e76f-177">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="9e76f-178">Visão geral sobre eventos de automação de interface do usuário</span><span class="sxs-lookup"><span data-stu-id="9e76f-178">UI Automation Events Overview</span></span>](uiauto-eventsoverview.md)
</dt> <dt>

[<span data-ttu-id="9e76f-179">Noções básicas sobre problemas de Threading</span><span class="sxs-lookup"><span data-stu-id="9e76f-179">Understanding Threading Issues</span></span>](uiauto-threading.md)
</dt> </dl>

 

 




