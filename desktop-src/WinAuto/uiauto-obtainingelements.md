---
title: Obtendo elementos da automação interface do usuário
description: Este tópico descreve várias maneiras de obter interfaces IUIAutomationElement para elementos de interface do usuário.
ms.assetid: 8675851a-4a72-4cbe-ab71-ed6fc891be17
keywords:
- clientes, obtendo elementos de automação da interface do usuário
- clientes, elementos de automação da interface do usuário
- clientes, elementos raiz
- clientes, escopo da pesquisa
- Automação da interface do usuário, obtendo elementos
- Automação da interface do usuário, elementos
- Automação da interface do usuário, elementos raiz
- Automação da interface do usuário, condições
- Automação da interface do usuário, escopo da pesquisa
- obtendo elementos de automação da interface do usuário
- elementos raiz
- escopo da pesquisa
ms.topic: article
ms.date: 05/31/2018
ms.custom: project-verbatim
ms.openlocfilehash: a1adbcea5cea81f97350ef15c491b289e07d3ee6
ms.sourcegitcommit: af120ad5c30da2fc5eb717ca2a1c4c45878efd71
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/20/2021
ms.locfileid: "105813355"
---
# <a name="obtaining-ui-automation-elements"></a><span data-ttu-id="49007-115">Obtendo elementos da automação interface do usuário</span><span class="sxs-lookup"><span data-stu-id="49007-115">Obtaining UI Automation Elements</span></span>

<span data-ttu-id="49007-116">Este tópico descreve várias maneiras de obter interfaces [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) para elementos de interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="49007-116">This topic describes various ways to obtain [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interfaces for UI elements.</span></span>

<span data-ttu-id="49007-117">**IUIAutomationElement** é usado no [aplicativo de exemplo de cliente de conteúdo do documento de automação de IU](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient).</span><span class="sxs-lookup"><span data-stu-id="49007-117">**IUIAutomationElement** is used in the [UI Automation document content client sample app](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient).</span></span>

## <a name="root-element"></a><span data-ttu-id="49007-118">Elemento Root</span><span class="sxs-lookup"><span data-stu-id="49007-118">Root Element</span></span>

<span data-ttu-id="49007-119">Embora elementos possam ser recuperados diretamente usando métodos, como [**IUIAutomation:: Getconcentrouelement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), alguns aplicativos cliente exigem uma exibição da estrutura hierárquica dos elementos, conhecida como árvore de automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="49007-119">Although elements can be retrieved directly by using methods, such as [**IUIAutomation::GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), some client applications require a view of the hierarchical structure of elements, known as the UI Automation tree.</span></span> <span data-ttu-id="49007-120">O elemento raiz dessa hierarquia é a área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="49007-120">The root element of this hierarchy is the desktop.</span></span> <span data-ttu-id="49007-121">Você pode obter esse elemento usando o método [**IUIAutomation:: getRootElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelement) ou o método [**IUIAutomation:: GetRootElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelementbuildcache) .</span><span class="sxs-lookup"><span data-stu-id="49007-121">You can obtain this element by using the [**IUIAutomation::GetRootElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelement) method or the [**IUIAutomation::GetRootElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getrootelementbuildcache) method.</span></span> <span data-ttu-id="49007-122">Ambos os métodos recuperam um ponteiro de interface [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) .</span><span class="sxs-lookup"><span data-stu-id="49007-122">Both these methods retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface pointer.</span></span> <span data-ttu-id="49007-123">Você pode Pesquisar elementos descendentes usando métodos, como [**IUIAutomationElement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) e [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall).</span><span class="sxs-lookup"><span data-stu-id="49007-123">You can search for descendant elements by using methods, such as [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) and [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall).</span></span>

> [!Note]  
> <span data-ttu-id="49007-124">Em geral, você deve tentar obter apenas filhos diretos do elemento raiz.</span><span class="sxs-lookup"><span data-stu-id="49007-124">In general, you should try to obtain only direct children of the root element.</span></span> <span data-ttu-id="49007-125">Uma pesquisa por descendentes pode iterar por centenas ou milhares de elementos.</span><span class="sxs-lookup"><span data-stu-id="49007-125">A search for descendants may iterate through hundreds or thousands of elements.</span></span> <span data-ttu-id="49007-126">Se você estiver tentando obter um elemento específico em um nível inferior, deverá iniciar a pesquisa na janela do aplicativo ou em um contêiner em um nível inferior.</span><span class="sxs-lookup"><span data-stu-id="49007-126">If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.</span></span>

 

## <a name="conditions"></a><span data-ttu-id="49007-127">Condições</span><span class="sxs-lookup"><span data-stu-id="49007-127">Conditions</span></span>

<span data-ttu-id="49007-128">Para a maioria das técnicas que você usa para recuperar elementos de automação da interface do usuário, você deve especificar uma condição.</span><span class="sxs-lookup"><span data-stu-id="49007-128">For most techniques you use to retrieve UI Automation elements, you must specify a condition.</span></span> <span data-ttu-id="49007-129">Uma condição é um conjunto de critérios que define os elementos que você deseja recuperar.</span><span class="sxs-lookup"><span data-stu-id="49007-129">A condition is a set of criteria that defines the elements that you want to retrieve.</span></span> <span data-ttu-id="49007-130">Uma condição é representada pela interface [**IUIAutomationCondition**](/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationcondition) .</span><span class="sxs-lookup"><span data-stu-id="49007-130">A condition is represented by the [**IUIAutomationCondition**](/windows/win32/api/uiautomationclient/nn-uiautomationclient-iuiautomationcondition) interface.</span></span>

<span data-ttu-id="49007-131">A condição mais simples é a condição verdadeira, que é um objeto predefinido que especifica que todos os elementos no escopo de pesquisa devem ser retornados.</span><span class="sxs-lookup"><span data-stu-id="49007-131">The simplest condition is the true condition, which is a predefined object that specifies that all elements in the search scope are to be returned.</span></span> <span data-ttu-id="49007-132">A condição false é o inverso da condição verdadeira e é menos útil, pois isso impediria que nenhum elemento fosse encontrado.</span><span class="sxs-lookup"><span data-stu-id="49007-132">The false condition is the inverse of the true condition and is less useful, because it would prevent any elements from being found.</span></span> <span data-ttu-id="49007-133">Você pode obter uma interface para a condição verdadeira usando [**IUIAutomation:: CreateTrueCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtruecondition).</span><span class="sxs-lookup"><span data-stu-id="49007-133">You can obtain an interface to the true condition by using [**IUIAutomation::CreateTrueCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtruecondition).</span></span>

<span data-ttu-id="49007-134">Três outras condições predefinidas, disponíveis como propriedades no objeto [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) , podem ser usadas sozinhas ou em combinação com outras condições: [**IUIAutomation:: ContentViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewcondition), [**ControlViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewcondition)e [**RawViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewcondition).</span><span class="sxs-lookup"><span data-stu-id="49007-134">Three other predefined conditions, available as properties on the [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation) object, can be used alone or in combination with other conditions: [**IUIAutomation::ContentViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewcondition), [**ControlViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewcondition), and [**RawViewCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewcondition).</span></span> <span data-ttu-id="49007-135">**RawViewCondition**, usado por si só, é equivalente à condição true, porque não filtra elementos pelas propriedades [**IUIAutomationElement:: CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) ou [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) .</span><span class="sxs-lookup"><span data-stu-id="49007-135">**RawViewCondition**, used by itself, is equivalent to the true condition, because it does not filter elements by the [**IUIAutomationElement::CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) or [**CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) properties.</span></span>

<span data-ttu-id="49007-136">Outras condições são criadas a partir de objetos Condition, cada um deles especifica um valor de propriedade.</span><span class="sxs-lookup"><span data-stu-id="49007-136">Other conditions are built from condition objects, each of which specifies a property value.</span></span> <span data-ttu-id="49007-137">Por exemplo, uma condição de propriedade pode especificar que o elemento está habilitado ou que ele dá suporte a um determinado padrão de controle.</span><span class="sxs-lookup"><span data-stu-id="49007-137">For example, a property condition might specify that the element is enabled or that it supports a certain control pattern.</span></span>

<span data-ttu-id="49007-138">As condições que usam a lógica booliana podem ser combinadas chamando [**IUIAutomation:: CreateAndCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createandcondition), [**CreateOrCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createorcondition), [**CreateNotCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createnotcondition)e métodos relacionados.</span><span class="sxs-lookup"><span data-stu-id="49007-138">Conditions that use Boolean logic can be combined by calling [**IUIAutomation::CreateAndCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createandcondition), [**CreateOrCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createorcondition), [**CreateNotCondition**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createnotcondition), and related methods.</span></span>

## <a name="search-scope"></a><span data-ttu-id="49007-139">Escopo de pesquisa</span><span class="sxs-lookup"><span data-stu-id="49007-139">Search Scope</span></span>

<span data-ttu-id="49007-140">As pesquisas executadas usando [**IUIAutomationElement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) ou [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) devem ter um escopo e um local de início.</span><span class="sxs-lookup"><span data-stu-id="49007-140">Searches that are performed by using [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) or [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) must have a scope and a starting place.</span></span>

> [!Note]  
> <span data-ttu-id="49007-141">Comentários sobre esses dois métodos também se aplicam a [**IUIAutomationElement:: FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache) e [**FindAllBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findallbuildcache).</span><span class="sxs-lookup"><span data-stu-id="49007-141">Any commentary about these two methods also applies to [**IUIAutomationElement::FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache) and [**FindAllBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findallbuildcache).</span></span>

 

<span data-ttu-id="49007-142">O escopo define o espaço em volta do local inicial que deve ser pesquisado.</span><span class="sxs-lookup"><span data-stu-id="49007-142">The scope defines the space around the starting place that is to be searched.</span></span> <span data-ttu-id="49007-143">Isso pode incluir o próprio elemento, seus irmãos, seu pai, seus filhos imediatos e seus descendentes.</span><span class="sxs-lookup"><span data-stu-id="49007-143">This might include the element itself, its siblings, its parent, its immediate children, and its descendants.</span></span> <span data-ttu-id="49007-144">Lembre-se de que os métodos **Find** não dão suporte à pesquisa da árvore de automação da interface do usuário da Microsoft. ou seja, não há suporte para a pesquisa de elementos ancestrais.</span><span class="sxs-lookup"><span data-stu-id="49007-144">Be aware that the **Find** methods do not support searching up the Microsoft UI Automation tree; that is, searching for ancestor elements is not supported.</span></span>

<span data-ttu-id="49007-145">O escopo de uma pesquisa é definido por uma combinação de bits de valores do tipo enumerado [**TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) .</span><span class="sxs-lookup"><span data-stu-id="49007-145">The scope of a search is defined by a bitwise combination of values from the [**TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) enumerated type.</span></span>

## <a name="finding-a-known-element"></a><span data-ttu-id="49007-146">Encontrando um elemento conhecido</span><span class="sxs-lookup"><span data-stu-id="49007-146">Finding a Known Element</span></span>

<span data-ttu-id="49007-147">Para localizar um elemento conhecido que é identificado por nome, ID de automação ou alguma outra propriedade ou combinação de propriedades, é mais fácil usar o método [**IUIAutomationElement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) .</span><span class="sxs-lookup"><span data-stu-id="49007-147">To find a known element that is identified by name, automation ID, or some other property or combination of properties, it is easiest to use the [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) method.</span></span> <span data-ttu-id="49007-148">Se o elemento procurado for uma janela de aplicativo, o ponto de partida da pesquisa poderá ser o elemento raiz.</span><span class="sxs-lookup"><span data-stu-id="49007-148">If the element sought is an application window, the starting point of the search can be the root element.</span></span>

<span data-ttu-id="49007-149">Essa forma de localizar elementos de automação da interface do usuário é mais útil em cenários de teste automatizados.</span><span class="sxs-lookup"><span data-stu-id="49007-149">This way of finding UI Automation elements is most useful in automated testing scenarios.</span></span>

<span data-ttu-id="49007-150">Para obter um exemplo de código que mostra como encontrar um elemento conhecer, consulte [localizando um elemento por nome](uiauto-howto-find-ui-elements.md).</span><span class="sxs-lookup"><span data-stu-id="49007-150">For a code example that shows how to find a know element, see [Finding an Element by Name](uiauto-howto-find-ui-elements.md).</span></span>

## <a name="finding-elements-in-a-subtree"></a><span data-ttu-id="49007-151">Localizando elementos em uma subárvore</span><span class="sxs-lookup"><span data-stu-id="49007-151">Finding Elements in a Subtree</span></span>

<span data-ttu-id="49007-152">Para localizar todos os elementos que atendem a critérios específicos e estão relacionados a um elemento conhecido, você pode chamar [**IUIAutomationElement:: FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) no elemento conhecido.</span><span class="sxs-lookup"><span data-stu-id="49007-152">To find all elements that meet specific criteria and are related to a known element, you can call [**IUIAutomationElement::FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall) on the known element.</span></span> <span data-ttu-id="49007-153">Por exemplo, use esse método para recuperar itens de lista ou itens de menu de uma lista ou menu, ou para identificar todos os controles em uma caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="49007-153">For example, use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.</span></span>

<span data-ttu-id="49007-154">Para obter um exemplo de código que mostra como localizar elementos em uma subárvore, consulte [Localizando elementos relacionados](uiauto-howto-find-ui-elements.md).</span><span class="sxs-lookup"><span data-stu-id="49007-154">For a code example that shows how to find elements in a subtree, see [Finding Related Elements](uiauto-howto-find-ui-elements.md).</span></span>

## <a name="walking-a-subtree"></a><span data-ttu-id="49007-155">Examinando uma subárvore</span><span class="sxs-lookup"><span data-stu-id="49007-155">Walking a Subtree</span></span>

<span data-ttu-id="49007-156">Se você não tiver conhecimento prévio dos aplicativos com os quais seu cliente pode ser usado, poderá construir uma subárvore de todos os elementos de interesse usando o [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker).</span><span class="sxs-lookup"><span data-stu-id="49007-156">If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker).</span></span> <span data-ttu-id="49007-157">O cliente pode fazer isso, por exemplo, em resposta a um evento de alteração de foco; ou seja, quando um aplicativo ou controle recebe o foco de entrada, o cliente de automação da interface do usuário examina os filhos e talvez todos os descendentes do elemento focado.</span><span class="sxs-lookup"><span data-stu-id="49007-157">Your client might do this, for example, in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.</span></span>

<span data-ttu-id="49007-158">Lembre-se de que a movimentação da árvore de automação da interface do usuário exige muitos recursos.</span><span class="sxs-lookup"><span data-stu-id="49007-158">Be aware that walking the UI Automation tree is resource-intensive.</span></span> <span data-ttu-id="49007-159">Oriente a árvore somente quando não for possível usar os métodos [**IUIAutomationElement:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst), [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall)ou [**BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache) .</span><span class="sxs-lookup"><span data-stu-id="49007-159">Walk the tree only when it is not feasible to use the [**IUIAutomationElement::FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst), [**FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall), or [**BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache) methods.</span></span>

<span data-ttu-id="49007-160">Você pode definir seu próprio Walker de árvore passando uma condição personalizada para [**IUIAutomation:: CreateTreeWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtreewalker)ou pode usar um dos seguintes objetos predefinidos que são definidos como propriedades do [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation)base.</span><span class="sxs-lookup"><span data-stu-id="49007-160">You can define your own tree walker by passing a custom condition to [**IUIAutomation::CreateTreeWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createtreewalker), or you can use one of the following predefined objects that are defined as properties of the base [**IUIAutomation**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomation).</span></span>



| <span data-ttu-id="49007-161">Objeto</span><span class="sxs-lookup"><span data-stu-id="49007-161">Object</span></span>                                                              | <span data-ttu-id="49007-162">Finalidade</span><span class="sxs-lookup"><span data-stu-id="49007-162">Purpose</span></span>                                                                                                                                                      |
|---------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="49007-163">**ContentViewWalker**</span><span class="sxs-lookup"><span data-stu-id="49007-163">**ContentViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker) | <span data-ttu-id="49007-164">Localiza somente elementos cuja propriedade [**IUIAutomationElement:: CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) é **true**.</span><span class="sxs-lookup"><span data-stu-id="49007-164">Finds only elements whose [**IUIAutomationElement::CurrentIsContentElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontentelement) property is **TRUE**.</span></span> |
| [<span data-ttu-id="49007-165">**ControlViewWalker**</span><span class="sxs-lookup"><span data-stu-id="49007-165">**ControlViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_controlviewwalker) | <span data-ttu-id="49007-166">Localiza somente elementos cuja propriedade [**IUIAutomationElement:: CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) é **true**.</span><span class="sxs-lookup"><span data-stu-id="49007-166">Finds only elements whose [**IUIAutomationElement::CurrentIsControlElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentiscontrolelement) property is **TRUE**.</span></span> |
| [<span data-ttu-id="49007-167">**RawViewWalker**</span><span class="sxs-lookup"><span data-stu-id="49007-167">**RawViewWalker**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_rawviewwalker)         | <span data-ttu-id="49007-168">Localiza todos os elementos.</span><span class="sxs-lookup"><span data-stu-id="49007-168">Finds all elements.</span></span>                                                                                                                                          |



 

<span data-ttu-id="49007-169">Depois de obter um [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker), chame os métodos **IUIAutomationTreeWalker:: GetXxx** para navegar pelos elementos da subárvore, passando o elemento do qual iniciar a movimentação.</span><span class="sxs-lookup"><span data-stu-id="49007-169">After you obtain an [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker), call the **IUIAutomationTreeWalker::GetXxx** methods to navigate elements of the subtree, passing in the element from which to start walking.</span></span>

<span data-ttu-id="49007-170">O método [**IUIAutomationTreeWalker:: Normalize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-normalizeelement) pode ser usado para navegar para um elemento na subárvore de outro elemento que não faz parte da exibição.</span><span class="sxs-lookup"><span data-stu-id="49007-170">The [**IUIAutomationTreeWalker::Normalize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-normalizeelement) method can be used for navigating to an element in the subtree from another element that is not part of the view.</span></span> <span data-ttu-id="49007-171">Por exemplo, suponha que você crie uma exibição de uma subárvore usando [**IUIAutomation:: ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker).</span><span class="sxs-lookup"><span data-stu-id="49007-171">For example, suppose you create a view of a subtree by using [**IUIAutomation::ContentViewWalker**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-get_contentviewwalker).</span></span> <span data-ttu-id="49007-172">Seu aplicativo recebe uma notificação de que uma barra de rolagem recebeu o foco de entrada.</span><span class="sxs-lookup"><span data-stu-id="49007-172">Your application receives notification that a scroll bar has received the input focus.</span></span> <span data-ttu-id="49007-173">Como uma barra de rolagem não é um elemento de conteúdo, ela não está presente na exibição da subárvore.</span><span class="sxs-lookup"><span data-stu-id="49007-173">Because a scroll bar is not a content element, it is not present in your view of the subtree.</span></span> <span data-ttu-id="49007-174">No entanto, você pode passar o [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) que representa a barra de rolagem para **IUIAutomationTreeWalker:: Normalize** e recuperar o ancestral mais próximo que está na exibição de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="49007-174">However, you can pass the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) that represents the scroll bar to **IUIAutomationTreeWalker::Normalize** and retrieve the nearest ancestor that is in the content view.</span></span>

<span data-ttu-id="49007-175">Para obter exemplos de código que mostram como usar a interface [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) , consulte [como percorrer a árvore de automação da interface do usuário](uiauto-howto-walk-uiautomation-tree.md).</span><span class="sxs-lookup"><span data-stu-id="49007-175">For code examples that show how to use the [**IUIAutomationTreeWalker**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker) interface, see [How to Walk the UI Automation Tree](uiauto-howto-walk-uiautomation-tree.md).</span></span>

## <a name="other-ways-to-retrieve-an-element"></a><span data-ttu-id="49007-176">Outras maneiras de recuperar um elemento</span><span class="sxs-lookup"><span data-stu-id="49007-176">Other Ways to Retrieve an Element</span></span>

<span data-ttu-id="49007-177">Além de pesquisas e navegação, você pode recuperar um [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) das seguintes maneiras.</span><span class="sxs-lookup"><span data-stu-id="49007-177">In addition to searches and navigation, you can retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) in the following ways.</span></span>

### <a name="from-an-event"></a><span data-ttu-id="49007-178">De um evento</span><span class="sxs-lookup"><span data-stu-id="49007-178">From an Event</span></span>

<span data-ttu-id="49007-179">Quando seu aplicativo recebe um evento de automação de interface do usuário, o objeto de origem passado para o manipulador de eventos é representado por um [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement).</span><span class="sxs-lookup"><span data-stu-id="49007-179">When your application receives a UI Automation event, the source object passed to your event handler is represented by an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement).</span></span> <span data-ttu-id="49007-180">Por exemplo, se você se inscrever em eventos de foco alterado, a origem passada para seu [**IUIAutomationFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler) é o elemento que recebeu o foco.</span><span class="sxs-lookup"><span data-stu-id="49007-180">For example, if you subscribe to focus-changed events, the source passed to your [**IUIAutomationFocusChangedEventHandler**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationfocuschangedeventhandler) is the element that received the focus.</span></span> <span data-ttu-id="49007-181">Para obter mais informações, consulte [inscrevendo-se em eventos de automação da interface do usuário](uiauto-eventsforclients.md).</span><span class="sxs-lookup"><span data-stu-id="49007-181">For more information, see [Subscribing to UI Automation Events](uiauto-eventsforclients.md).</span></span>

### <a name="from-a-point"></a><span data-ttu-id="49007-182">De um ponto</span><span class="sxs-lookup"><span data-stu-id="49007-182">From a Point</span></span>

<span data-ttu-id="49007-183">Para recuperar um [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) de coordenadas de tela, por exemplo, uma posição de cursor, use o método [**IUIAutomation:: ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) .</span><span class="sxs-lookup"><span data-stu-id="49007-183">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) from screen coordinates, for example, a cursor position, use the [**IUIAutomation::ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) method.</span></span>

### <a name="from-a-window-handle"></a><span data-ttu-id="49007-184">De um identificador de janela</span><span class="sxs-lookup"><span data-stu-id="49007-184">From a Window Handle</span></span>

<span data-ttu-id="49007-185">Para recuperar um [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) de um **HWND**, use o método [**IUIAutomation:: ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle) .</span><span class="sxs-lookup"><span data-stu-id="49007-185">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) from an **HWND**, use the [**IUIAutomation::ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle) method.</span></span>

### <a name="from-the-focused-control"></a><span data-ttu-id="49007-186">Do controle focado</span><span class="sxs-lookup"><span data-stu-id="49007-186">From the Focused Control</span></span>

<span data-ttu-id="49007-187">Para recuperar um [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) que representa o controle focalizado, use o método [**IUIAutomation:: getconcentrouelement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement) .</span><span class="sxs-lookup"><span data-stu-id="49007-187">To retrieve an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) that represents the focused control, use the [**IUIAutomation::GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement) method.</span></span>

## <a name="related-topics"></a><span data-ttu-id="49007-188">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="49007-188">Related topics</span></span>

[<span data-ttu-id="49007-189">Visão geral da árvore de automação de interface do usuário</span><span class="sxs-lookup"><span data-stu-id="49007-189">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)

[<span data-ttu-id="49007-190">Aplicativo de amostra do cliente de conteúdo do documento de automação de IU</span><span class="sxs-lookup"><span data-stu-id="49007-190">UI Automation document content client sample app</span></span>](https://github.com/microsoft/Windows-classic-samples/tree/master/Samples/UIAutomationDocumentClient)
