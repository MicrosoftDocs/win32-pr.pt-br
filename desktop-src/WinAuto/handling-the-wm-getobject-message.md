---
title: Manipulando a mensagem de WM_GETOBJECT
description: O Microsoft Acessibilidade Ativa e a automação da interface do usuário da Microsoft enviam a mensagem do WM \_ GetObject para um aplicativo de servidor ou provedor para recuperar informações sobre um objeto acessível com suporte no servidor ou provedor.
ms.assetid: 4b8e551f-aba7-4a89-8874-ba690175f525
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 695fad8f050606f0a95a1780551d35499e39d166
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "105780309"
---
# <a name="handling-the-wm_getobject-message"></a><span data-ttu-id="12180-103">Manipulando a \_ mensagem do WM GETobject</span><span class="sxs-lookup"><span data-stu-id="12180-103">Handling the WM\_GETOBJECT Message</span></span>

<span data-ttu-id="12180-104">O Microsoft Acessibilidade Ativa e a automação da interface do usuário da Microsoft enviam a mensagem do [**WM \_ GetObject**](wm-getobject.md) para um aplicativo de servidor ou provedor para recuperar informações sobre um objeto acessível com suporte no servidor ou provedor.</span><span class="sxs-lookup"><span data-stu-id="12180-104">Both Microsoft Active Accessibility and Microsoft UI Automation send the [**WM\_GETOBJECT**](wm-getobject.md) message to a server or provider application to retrieve information about an accessible object supported by the server or provider.</span></span> <span data-ttu-id="12180-105">Os clientes nunca enviam o **WM \_ GetObject** diretamente.</span><span class="sxs-lookup"><span data-stu-id="12180-105">Clients never send **WM\_GETOBJECT** directly.</span></span> <span data-ttu-id="12180-106">Em vez disso, o Microsoft Acessibilidade Ativa envia essa mensagem quando um cliente chama as funções [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent)e [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) .</span><span class="sxs-lookup"><span data-stu-id="12180-106">Instead, Microsoft Active Accessibility sends this message when a client calls the [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint), [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent), and [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) functions.</span></span> <span data-ttu-id="12180-107">A automação da interface do usuário envia o **WM \_ GetObject** quando um cliente chama [**IUIAutomation:: ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle), [**ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint)e [**getconcentrouelement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement)e ao manipular eventos para os quais o cliente registrou.</span><span class="sxs-lookup"><span data-stu-id="12180-107">UI Automation sends **WM\_GETOBJECT** when a client calls [**IUIAutomation::ElementFromHandle**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfromhandle), [**ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint), and [**GetFocusedElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-getfocusedelement), and when handling events for which the client has registered.</span></span>

<span data-ttu-id="12180-108">O Microsoft Acessibilidade Ativa ou a automação da interface do usuário especifica o tipo de objeto do qual precisa de informações, passando um valor chamado *identificador de objeto* com a mensagem do [**WM \_ GetObject**](wm-getobject.md) .</span><span class="sxs-lookup"><span data-stu-id="12180-108">Microsoft Active Accessibility or UI Automation specifies the type of object it needs information for by passing a valued called an *object identifier* with the [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="12180-109">Quando ele recebe a mensagem, o servidor ou o provedor examina o identificador de objeto para determinar como responder à mensagem.</span><span class="sxs-lookup"><span data-stu-id="12180-109">When it receives the message, the server or provider examines the object identifier to determine how to respond to the message.</span></span> <span data-ttu-id="12180-110">A resposta depende de se o aplicativo receptor implementa o Microsoft Acessibilidade Ativa (um servidor), a automação da interface do usuário (um provedor) ou nenhum deles para o objeto especificado.</span><span class="sxs-lookup"><span data-stu-id="12180-110">The response depends on whether the receiving application implements Microsoft Active Accessibility (a server), UI Automation (a provider), or neither, for the specified object.</span></span>

-   <span data-ttu-id="12180-111">Se o aplicativo de recebimento for um Microsoft Acessibilidade Ativa Server e a mensagem do [**WM \_ GetObject**](wm-getobject.md) incluir um identificador de objeto do [**\_ cliente OBJID**](object-identifiers.md), o servidor deverá retornar o valor obtido passando a interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) do objeto para a função [**LresultFromObject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject) .</span><span class="sxs-lookup"><span data-stu-id="12180-111">If the receiving application is an Microsoft Active Accessibility server and the [**WM\_GETOBJECT**](wm-getobject.md) message includes an object identifier of [**OBJID\_CLIENT**](object-identifiers.md), the server should return the value obtained by passing the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface of the object to the [**LresultFromObject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject) function.</span></span>
-   <span data-ttu-id="12180-112">Se o aplicativo de recebimento for o provedor de automação aUI e o identificador de objeto for **UiaRootObjectId**, o provedor deverá retornar a interface [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) do objeto.</span><span class="sxs-lookup"><span data-stu-id="12180-112">If the receiving application is aUI Automation provider and the object identifier is **UiaRootObjectId**, the provider should return the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface of the object.</span></span> <span data-ttu-id="12180-113">O provedor Obtém a interface chamando a função [**UiaReturnRawElementProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiareturnrawelementprovider) .</span><span class="sxs-lookup"><span data-stu-id="12180-113">The provider obtains the interface by calling the [**UiaReturnRawElementProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiareturnrawelementprovider) function.</span></span>
-   <span data-ttu-id="12180-114">Se o aplicativo receptor não implementar o Microsoft Acessibilidade Ativa nem a automação da interface do usuário, ele deverá passar a mensagem do [**WM \_ GetObject**](wm-getobject.md) para a função [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) .</span><span class="sxs-lookup"><span data-stu-id="12180-114">If the receiving application implements neither Microsoft Active Accessibility nor UI Automation, it should pass the [**WM\_GETOBJECT**](wm-getobject.md) message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> <span data-ttu-id="12180-115">Passar a mensagem permite que a estrutura de acessibilidade determine se um proxy está disponível para o objeto especificado.</span><span class="sxs-lookup"><span data-stu-id="12180-115">Passing the message enables the accessibility framework to determine if a proxy is available for the specified object.</span></span>
-   <span data-ttu-id="12180-116">Se o identificador de objeto não [**for \_ cliente OBJID**](object-identifiers.md) nem UiaRootObjectId, o aplicativo de recebimento deverá passar a mensagem do [**WM \_ GetObject**](wm-getobject.md) para a função [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) .</span><span class="sxs-lookup"><span data-stu-id="12180-116">If the object identifier is neither [**OBJID\_CLIENT**](object-identifiers.md) nor UiaRootObjectId, the receiving application should pass the [**WM\_GETOBJECT**](wm-getobject.md) message to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> <span data-ttu-id="12180-117">Passar a mensagem permite que a estrutura de acessibilidade use os provedores padrão para elementos da interface do usuário padrão.</span><span class="sxs-lookup"><span data-stu-id="12180-117">Passing the message enables the accessibility framework to use the default providers for standard UI elements.</span></span>

<span data-ttu-id="12180-118">A Microsoft Acessibilidade Ativa e a automação da interface do usuário podem passar identificadores de objeto personalizados em uma mensagem do [**WM \_ GetObject**](wm-getobject.md) para recuperar valores ou objetos definidos pelo aplicativo de um servidor ou provedor.</span><span class="sxs-lookup"><span data-stu-id="12180-118">Microsoft Active Accessibility and UI Automation can pass custom object identifiers in a [**WM\_GETOBJECT**](wm-getobject.md) message to retrieve application-defined values or objects from a server or provider.</span></span> <span data-ttu-id="12180-119">O identificador de objeto [**OBJID \_ NATIVEOM**](object-identifiers.md) ou [**OBJID \_ QUERYCLASSNAMEIDX**](object-identifiers.md) pode ser usado para recuperar uma interface de modelo de objeto nativo ou para solicitar um objeto proxy específico com suporte pelo Oleacc.dll.</span><span class="sxs-lookup"><span data-stu-id="12180-119">The [**OBJID\_NATIVEOM**](object-identifiers.md) or [**OBJID\_QUERYCLASSNAMEIDX**](object-identifiers.md) object identifier can be used to retrieve a native Object Model interface, or to request a specific proxy object that is supported by Oleacc.dll.</span></span>

<span data-ttu-id="12180-120">Ao manipular o [**\_ cliente OBJID**](object-identifiers.md) e os identificadores de objeto **UiaRootObjectId** , uma implementação do Microsoft acessibilidade ativa Server pode coexistir junto com uma implementação do provedor de automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="12180-120">By handling both the [**OBJID\_CLIENT**](object-identifiers.md) and **UiaRootObjectId** object identifiers, a Microsoft Active Accessibility server implementation can co-exist alongside a UI Automation provider implementation.</span></span> <span data-ttu-id="12180-121">Como a maioria dos controles padrão do Windows e os controles comuns implementados pela biblioteca de controle comum (ComCtl32.dll) não implementam o Microsoft Acessibilidade Ativa ou a automação da interface do usuário, normalmente esses controles não manipulam a mensagem do [**WM \_ GetObject**](wm-getobject.md) .</span><span class="sxs-lookup"><span data-stu-id="12180-121">Because most standard Windows controls and common controls implemented by the common control library (ComCtl32.dll) do not implement either Microsoft Active Accessibility or UI Automation, these controls typically do not handle the [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="12180-122">Em vez disso, o Microsoft Acessibilidade Ativa ou a estrutura de automação de interface do usuário verifica se um objeto proxy está disponível para um determinado elemento de interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="12180-122">Instead, the Microsoft Active Accessibility or UI Automation framework checks if a proxy object is available for a particular UI element.</span></span> <span data-ttu-id="12180-123">Caso contrário, ele fornece o objeto proxy padrão para o objeto de janela do host.</span><span class="sxs-lookup"><span data-stu-id="12180-123">Otherwise, it provides the default proxy object for the host window object.</span></span>

 

 