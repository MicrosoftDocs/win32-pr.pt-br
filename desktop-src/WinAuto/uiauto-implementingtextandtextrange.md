---
title: Padrões de controle Text e TextRange
description: Descreve as diretrizes e convenções para implementar ITextProvider, ITextProvider2 e ITextRangeProvider, incluindo informações sobre propriedades e métodos.
ms.assetid: 4d541c31-11f7-4d7e-a0e0-9ed1da873d07
keywords:
- Automação da interface do usuário, implementando padrão de controle de texto
- Automação da interface do usuário, implementando o padrão de controle TextRange
- Automação da interface do usuário, padrão de controle de texto
- Automação da interface do usuário, padrão de controle TextRange
- Automação da interface do usuário, ITextProvider
- Automação da interface do usuário, ITextRangeProvider
- ITextProvider
- ITextRangeProvider
- Implementando o padrão de controle de texto de automação da IU
- Implementando padrão de controle TextRange de automação da interface do usuário
- Padrão de controle de texto
- Padrão de controle TextRange
- padrões de controle, ITextProvider
- padrões de controle, ITextRangeProvider
- padrões de controle, implementação de texto de automação da interface do usuário
- padrões de controle, como implementar o TextRange de automação da interface do usuário
- padrões de controle, texto
- padrões de controle, TextRange
- interfaces, ITextProvider
- interfaces, ITextRangeProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f53429dc8ec137a83b6a40db377b5c84aeb36120
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104555966"
---
# <a name="text-and-textrange-control-patterns"></a><span data-ttu-id="1f90f-123">Padrões de controle Text e TextRange</span><span class="sxs-lookup"><span data-stu-id="1f90f-123">Text and TextRange Control Patterns</span></span>

<span data-ttu-id="1f90f-124">Descreve as diretrizes e convenções para implementar [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider), [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2)e [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider), incluindo informações sobre propriedades e métodos.</span><span class="sxs-lookup"><span data-stu-id="1f90f-124">Describes guidelines and conventions for implementing [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider), [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2), and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider), including information about properties and methods.</span></span> <span data-ttu-id="1f90f-125">O padrão de controle de **texto** permite que aplicativos e controles exponham um modelo de objeto de texto simples, permitindo que os clientes recuperem conteúdo textual, atributos de texto e objetos incorporados de controles baseados em texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-125">The **Text** control pattern enables applications and controls to expose a simple text object model, enabling clients to retrieve textual content, text attributes, and embedded objects from text-based controls.</span></span>

<span data-ttu-id="1f90f-126">Para dar suporte ao padrão de controle de **texto** , os controles implementam as interfaces [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) e [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) .</span><span class="sxs-lookup"><span data-stu-id="1f90f-126">To support the **Text** control pattern, controls implement the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interfaces.</span></span> <span data-ttu-id="1f90f-127">Os tipos de controle que devem dar suporte ao padrão de controle de **texto** incluem os tipos de controle de [documento](uiauto-supportdocumentcontroltype.md) e de [edição](uiauto-supporteditcontroltype.md) e qualquer outro tipo de controle que permita que o usuário insira texto ou selecione texto somente leitura.</span><span class="sxs-lookup"><span data-stu-id="1f90f-127">Control types that should support the **Text** control pattern include the [Edit](uiauto-supporteditcontroltype.md) and [Document](uiauto-supportdocumentcontroltype.md) control types, and any other control type that enables the user to enter text or select read-only text.</span></span>

<span data-ttu-id="1f90f-128">O padrão de controle de **texto** pode ser usado com outros padrões de controle de automação da interface do usuário da Microsoft para dar suporte a vários tipos de objetos inseridos no texto, incluindo tabelas, hiperlinks e botões de comando.</span><span class="sxs-lookup"><span data-stu-id="1f90f-128">The **Text** control pattern can be used with other Microsoft UI Automation control patterns to support several types of embedded objects in the text, including tables, hyperlinks, and command buttons.</span></span>

<span data-ttu-id="1f90f-129">As interfaces [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) e [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) incluem vários métodos para adquirir intervalos de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-129">The [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interfaces include a number of methods for acquiring text ranges.</span></span> <span data-ttu-id="1f90f-130">Um *intervalo de texto* é um objeto que representa um trecho de texto contíguo, ou vários trechos de texto separados, em um contêiner de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-130">A *text range* is an object that represents a contiguous span of text—or multiple, disjoint spans of text—in a text container.</span></span> <span data-ttu-id="1f90f-131">Um método **ITextProvider** adquire um intervalo de texto que representa o documento inteiro, enquanto outros adquirem intervalos de texto que representam alguma parte do documento, como o texto selecionado, o texto visível ou um objeto inserido no texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-131">One **ITextProvider** method acquires a text range that represents the entire document, while others acquire text ranges that represent some portion of the document, such as the selected text, the visible text, or an object embedded in the text.</span></span>

<span data-ttu-id="1f90f-132">Um objeto de intervalo de texto é representado pelo padrão de controle **TextRange** , que é implementado por meio da interface [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) .</span><span class="sxs-lookup"><span data-stu-id="1f90f-132">A text range object is represented by the **TextRange** control pattern, which is implemented through the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface.</span></span> <span data-ttu-id="1f90f-133">O padrão de controle **TextRange** fornece métodos e propriedades usados para expor informações sobre o texto no intervalo, mover os pontos de extremidade do intervalo, selecionar ou desmarcar o texto, rolar o intervalo para a exibição e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="1f90f-133">The **TextRange** control pattern provides methods and properties used to expose information about the text in the range, move the endpoints of the range, select or deselect text, scroll the range into view, and so on.</span></span>

<span data-ttu-id="1f90f-134">Para obter mais informações sobre os padrões de controle **Text** e **TextRange** , consulte [suporte à automação da interface do usuário para conteúdo textual](uiauto-ui-automation-textpattern-overview.md).</span><span class="sxs-lookup"><span data-stu-id="1f90f-134">For more information about the **Text** and **TextRange** control patterns, see [UI Automation Support for Textual Content](uiauto-ui-automation-textpattern-overview.md).</span></span>

<span data-ttu-id="1f90f-135">A partir do Windows 8.1 provedores podem implementar a interface [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) .</span><span class="sxs-lookup"><span data-stu-id="1f90f-135">Starting with Windows 8.1 providers can implement the [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interface.</span></span> <span data-ttu-id="1f90f-136">Isso permite invocar menus de contexto associados a um intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-136">This enables invoking context menus that are associated with a text range.</span></span> <span data-ttu-id="1f90f-137">Isso dá suporte a cenários como a correção automática de texto ou a seleção de candidatos do IME (editor de método de entrada).</span><span class="sxs-lookup"><span data-stu-id="1f90f-137">This supports scenarios such as text autocorrection or Input Method Editor (IME) candidate selection.</span></span>

<span data-ttu-id="1f90f-138">Este tópico inclui as seções a seguir.</span><span class="sxs-lookup"><span data-stu-id="1f90f-138">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="1f90f-139">Diretrizes e convenções de implementação</span><span class="sxs-lookup"><span data-stu-id="1f90f-139">Implementation Guidelines and Conventions</span></span>](#implementation-guidelines-and-conventions)
-   [<span data-ttu-id="1f90f-140">Membros necessários para **ITextProvider**</span><span class="sxs-lookup"><span data-stu-id="1f90f-140">Required Members for **ITextProvider**</span></span>](#required-members-for-itextprovider)
-   [<span data-ttu-id="1f90f-141">Membros necessários para **ITextRangeProvider**</span><span class="sxs-lookup"><span data-stu-id="1f90f-141">Required Members for **ITextRangeProvider**</span></span>](#required-members-for-itextrangeprovider)
-   [<span data-ttu-id="1f90f-142">Suporte a intervalos de texto</span><span class="sxs-lookup"><span data-stu-id="1f90f-142">Supporting Text Ranges</span></span>](#supporting-text-ranges)
    -   [<span data-ttu-id="1f90f-143">Manipulando um intervalo de texto por unidade de texto</span><span class="sxs-lookup"><span data-stu-id="1f90f-143">Manipulating a Text Range by Text Unit</span></span>](#manipulating-a-text-range-by-text-unit)
    -   [<span data-ttu-id="1f90f-144">Selecionando texto em um intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="1f90f-144">Selecting Text in a Text Range</span></span>](#selecting-text-in-a-text-range)
    -   [<span data-ttu-id="1f90f-145">Adquirindo texto de um intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="1f90f-145">Acquiring Text from a Text Range</span></span>](#acquiring-text-from-a-text-range)
    -   [<span data-ttu-id="1f90f-146">Implementando o subcontextmenu</span><span class="sxs-lookup"><span data-stu-id="1f90f-146">Implementing ShowContextMenu</span></span>](#implementing-showcontextmenu)
-   [<span data-ttu-id="1f90f-147">Interoperabilidade com o cursor do sistema</span><span class="sxs-lookup"><span data-stu-id="1f90f-147">Interoperability with the System Caret</span></span>](#interoperability-with-the-system-caret)
-   [<span data-ttu-id="1f90f-148">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="1f90f-148">Related topics</span></span>](#related-topics)

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="1f90f-149">Diretrizes e convenções de implementação</span><span class="sxs-lookup"><span data-stu-id="1f90f-149">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="1f90f-150">Ao implementar o padrão de controle de **texto** , observe as seguintes diretrizes e convenções:</span><span class="sxs-lookup"><span data-stu-id="1f90f-150">When implementing the **Text** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="1f90f-151">Qualquer controle que habilite o acesso ao texto (por exemplo, inserção de texto ou seleção de texto somente leitura) deve dar suporte ao padrão de controle de **texto** .</span><span class="sxs-lookup"><span data-stu-id="1f90f-151">Any control that enables access to text (for example, entering text or selecting read-only text) should support the **Text** control pattern.</span></span>
-   <span data-ttu-id="1f90f-152">O padrão de controle de **texto** pode ser usado com qualquer elemento de interface do usuário que apresente texto, até mesmo um rótulo estático em um controle de botão padrão.</span><span class="sxs-lookup"><span data-stu-id="1f90f-152">The **Text** control pattern can be used with any UI element that presents text, even a static label on a standard button control.</span></span> <span data-ttu-id="1f90f-153">No entanto, ele não é necessário em controles de texto estáticos que não podem ser selecionados ou não têm um ponto de inserção.</span><span class="sxs-lookup"><span data-stu-id="1f90f-153">However, it is not required on static text controls that cannot be selected or do not have an insertion point.</span></span>
-   <span data-ttu-id="1f90f-154">Para garantir que o texto esteja totalmente acessível, os controles que implementam [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) também devem oferecer suporte à interface [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) .</span><span class="sxs-lookup"><span data-stu-id="1f90f-154">To ensure that text is fully accessible, controls that implement [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) should also support the [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider) interface.</span></span> <span data-ttu-id="1f90f-155">O **IValueProvider** complementa o **ITextProvider** fornecendo uma maneira programática de alterar o texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-155">**IValueProvider** complements **ITextProvider** by providing a programmatic way to change the text.</span></span> <span data-ttu-id="1f90f-156">Ele também oferece maior compatibilidade com aplicativos cliente de tecnologia assistencial, incluindo aqueles baseados em tecnologias herdadas, como o Microsoft Acessibilidade Ativa.</span><span class="sxs-lookup"><span data-stu-id="1f90f-156">It also offers greater compatibility with assistive technology client applications, including those based on legacy technologies such as Microsoft Active Accessibility.</span></span> <span data-ttu-id="1f90f-157">Quando ambos os padrões de controle são implementados, o evento **TextChanged** ([**UIA \_ Text \_ TextChangedEventId**](uiauto-event-ids.md)) e o evento **AutomationPropertyChanged** ([**UIA \_ AutomationPropertyChangedEventId**](uiauto-event-ids.md)) são equivalentes à propriedade **Value** ([**UIA \_ ValueValuePropertyId**](uiauto-control-pattern-propids.md)).</span><span class="sxs-lookup"><span data-stu-id="1f90f-157">When both control patterns are implemented, the **TextChanged** event ([**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md)) and **AutomationPropertyChanged** event ([**UIA\_AutomationPropertyChangedEventId**](uiauto-event-ids.md)) are equivalent for the **Value** property ([**UIA\_ValueValuePropertyId**](uiauto-control-pattern-propids.md)).</span></span> <span data-ttu-id="1f90f-158">Os dois eventos devem ter suporte.</span><span class="sxs-lookup"><span data-stu-id="1f90f-158">Both events must be supported.</span></span>
-   <span data-ttu-id="1f90f-159">O padrão de controle de **texto** dá suporte a apenas um fluxo de texto e um visor por controle.</span><span class="sxs-lookup"><span data-stu-id="1f90f-159">The **Text** control pattern supports only one stream of text and one viewport per control.</span></span> <span data-ttu-id="1f90f-160">Se o aplicativo oferece várias exibições de documento em painéis, cada exibição (controle) deve dar suporte a [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) de forma independente.</span><span class="sxs-lookup"><span data-stu-id="1f90f-160">If the application offers multiple views of document in panes, each view (control) should support [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) independently.</span></span>
-   <span data-ttu-id="1f90f-161">O método [**ITextProvider:: getseleções**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) pode retornar um único intervalo de texto que representa o texto atualmente selecionado.</span><span class="sxs-lookup"><span data-stu-id="1f90f-161">The [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) method may return a single text range representing the currently selected text.</span></span> <span data-ttu-id="1f90f-162">Se um controle oferecer suporte à seleção de várias extensões não contíguas de texto, o método **GetSelection** deverá retornar uma matriz que contenha uma interface [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) para cada intervalo selecionado de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-162">If a control supports the selection of multiple, noncontiguous spans of text, the **GetSelection** method should return an array that contains one [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface for each selected span of text.</span></span>
-   <span data-ttu-id="1f90f-163">O padrão de controle de **texto** representa o ponto de inserção como um intervalo de texto degenerado (vazio).</span><span class="sxs-lookup"><span data-stu-id="1f90f-163">The **Text** control pattern represents the insertion point as a degenerate (empty) text range.</span></span> <span data-ttu-id="1f90f-164">O método [**ITextProvider:: getseleções**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) deve retornar um intervalo de texto degenerado quando o ponto de inserção existir e nenhum texto for selecionado.</span><span class="sxs-lookup"><span data-stu-id="1f90f-164">The [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) method should return a degenerate text range when the insertion point exists and no text is selected.</span></span> <span data-ttu-id="1f90f-165">Para obter mais informações, consulte [interoperabilidade com o cursor do sistema](#interoperability-with-the-system-caret).</span><span class="sxs-lookup"><span data-stu-id="1f90f-165">For more information, see [Interoperability with the System Caret](#interoperability-with-the-system-caret).</span></span>
-   <span data-ttu-id="1f90f-166">O método [**ITextProvider:: GetVisibleRanges**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges) pode retornar um único intervalo de texto se um intervalo de texto contíguo estiver visível no visor ou puder retornar uma matriz de intervalos de texto não contíguos que representem várias linhas de texto parcialmente visíveis.</span><span class="sxs-lookup"><span data-stu-id="1f90f-166">The [**ITextProvider::GetVisibleRanges**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges) method may return a single text range if a contiguous range of text is visible in the viewport, or it may return an array of disjoint text ranges representing multiple, partially visible lines of text.</span></span>
-   <span data-ttu-id="1f90f-167">O método [**ITextProvider:: RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) deve retornar um intervalo degenerado se o elemento filho não contiver nenhum texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-167">The [**ITextProvider::RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) method should return a degenerate range if the child element contains no text.</span></span> <span data-ttu-id="1f90f-168">Como um objeto incorporado pode incluir texto, o método **RangeFromChild** nem sempre pode retornar um intervalo de texto degenerado.</span><span class="sxs-lookup"><span data-stu-id="1f90f-168">Because an embedded object can include text, the **RangeFromChild** method may not always return a degenerate text range.</span></span> <span data-ttu-id="1f90f-169">Para obter mais informações, consulte [como a automação da interface do usuário expõe objetos inseridos](uiauto-textpattern-and-embedded-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="1f90f-169">For more information, see [How UI Automation Exposes Embedded Objects](uiauto-textpattern-and-embedded-objects-overview.md).</span></span>
-   <span data-ttu-id="1f90f-170">O método [**ITextProvider:: RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) executa testes de clique na área do documento usando as coordenadas de tela especificadas.</span><span class="sxs-lookup"><span data-stu-id="1f90f-170">The [**ITextProvider::RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) method performs hit testing in the document area using the specified screen coordinates.</span></span> <span data-ttu-id="1f90f-171">O intervalo de texto resultante deve ser consistente com o ponto de inserção ou a seleção resultante do clique no local nas coordenadas da tela especificada.</span><span class="sxs-lookup"><span data-stu-id="1f90f-171">The resulting text range should be consistent with the insertion point or selection that would result from clicking the location at the specified screen coordinates.</span></span> <span data-ttu-id="1f90f-172">Por exemplo, se uma imagem residir nas coordenadas de tela especificadas, o intervalo de texto resultante deverá ser o mesmo que o intervalo de texto que o método [**ITextProvider:: RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) adquiriria para a imagem.</span><span class="sxs-lookup"><span data-stu-id="1f90f-172">For example, if an image resides at the specified screen coordinates, the resulting text range should be the same as the text range that the [**ITextProvider::RangeFromChild**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild) method would acquire for the image.</span></span> <span data-ttu-id="1f90f-173">Da mesma forma, se um aplicativo cliente solicitar um intervalo de texto para o local no centro do cursor do sistema (o ponto de inserção), o intervalo de texto resultante deverá ser o mesmo que o local do cursor do sistema.</span><span class="sxs-lookup"><span data-stu-id="1f90f-173">Similarly, if a client application requests a text range for the location at the center of the system caret (the insertion point), the resulting text range should be the same as the system caret location.</span></span>
-   <span data-ttu-id="1f90f-174">A propriedade [**ITextProvider::D ocumentrange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) sempre deve fornecer um intervalo de texto que inclua todo o texto suportado pela implementação [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) correspondente.</span><span class="sxs-lookup"><span data-stu-id="1f90f-174">The [**ITextProvider::DocumentRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) property should always provide a text range that includes all of the text supported by the corresponding [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) implementation.</span></span>
-   <span data-ttu-id="1f90f-175">O [**evento \_ \_ TextChangedEventId de texto UIA**](uiauto-event-ids.md) deve ser gerado depois que qualquer alteração de texto ocorrer, mesmo se a alteração não estiver visível no visor.</span><span class="sxs-lookup"><span data-stu-id="1f90f-175">The [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event must be raised after any text change occurs, even if the change is not visible in the viewport.</span></span> <span data-ttu-id="1f90f-176">Por exemplo, o provedor deve gerar o evento mesmo se o usuário colar exatamente o mesmo texto sobre o texto selecionado.</span><span class="sxs-lookup"><span data-stu-id="1f90f-176">For example, the provider should raise the event even if the user pastes the exact same text over the selected text.</span></span>
-   <span data-ttu-id="1f90f-177">O [**\_ \_ TextSelectionChangedEventId de texto UIA**](uiauto-event-ids.md) deve ser gerado sempre que a seleção de texto é alterada ou sempre que o ponto de inserção (circunflexo) se move entre o texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-177">The [**UIA\_Text\_TextSelectionChangedEventId**](uiauto-event-ids.md) must be raised whenever the selection of text changes, or whenever the insertion point (caret) moves among the text.</span></span>

<span data-ttu-id="1f90f-178">Ao implementar o padrão de controle **TextRange** , observe as seguintes diretrizes e convenções:</span><span class="sxs-lookup"><span data-stu-id="1f90f-178">When implementing the **TextRange** control pattern, note the following guidelines and conventions:</span></span>

-   <span data-ttu-id="1f90f-179">Todos os métodos do padrão de controle **TextRange** devem executar operações de texto, independentemente do estado de visibilidade do texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-179">All methods of the **TextRange** control pattern should perform text operations regardless of the visibility state of the text.</span></span> <span data-ttu-id="1f90f-180">A visibilidade de um intervalo de texto sempre pode ser determinada consultando o atributo de texto **IsHidden** ([**UIA \_ IsHiddenAttributeId**](uiauto-textattribute-ids.md)).</span><span class="sxs-lookup"><span data-stu-id="1f90f-180">The visibility of a text range can always be determined by querying the **IsHidden** text attribute ([**UIA\_IsHiddenAttributeId**](uiauto-textattribute-ids.md)).</span></span>
-   <span data-ttu-id="1f90f-181">Se possível, um provedor deve garantir que qualquer alteração de texto, como exclusões, inserções e movimentações, seja refletida nos objetos de intervalo de texto associados (instâncias da interface [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) ) e gere um evento de [**\_ \_ TextChangedEventId de texto UIA**](uiauto-event-ids.md) .</span><span class="sxs-lookup"><span data-stu-id="1f90f-181">If possible, a provider should ensure that any text changes, such as deletions, insertions, and moves, are reflected in the associated text range objects (instances of [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface) and raise a [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event.</span></span> <span data-ttu-id="1f90f-182">Os clientes podem usar o evento como uma dica para confirmar as alterações editoriais feitas no texto de um controle.</span><span class="sxs-lookup"><span data-stu-id="1f90f-182">Clients may use the event as a hint to confirm editorial changes made to the text of a control.</span></span>
-   <span data-ttu-id="1f90f-183">Todos os objetos de intervalo de texto usados pelos métodos [**ITextRangeProvider:: Compare**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare), [**CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints)e [**MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) devem ser pares da mesma implementação de padrão de controle de **texto** .</span><span class="sxs-lookup"><span data-stu-id="1f90f-183">All of the text range objects used by the [**ITextRangeProvider::Compare**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare), [**CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints), and [**MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) methods must be peers of the same **Text** control pattern implementation.</span></span>
-   <span data-ttu-id="1f90f-184">Embora não seja necessário, o valor *pRetVal* recuperado pelo método [**ITextRangeProvider:: CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints) pode indicar a distância, em caracteres ([**\_ caractere TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)), entre os dois pontos de extremidade.</span><span class="sxs-lookup"><span data-stu-id="1f90f-184">Although not required, the *pRetVal* value retrieved by the [**ITextRangeProvider::CompareEndpoints**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints) method can indicate the distance, in characters ([**TextUnit\_Character**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit)), between the two endpoints.</span></span> <span data-ttu-id="1f90f-185">No entanto, os aplicativos cliente não devem depender da precisão de *pRetVal* além de seu valor positivo ou negativo.</span><span class="sxs-lookup"><span data-stu-id="1f90f-185">However, client applications should not depend on the accuracy of *pRetVal* beyond its positive or negative value.</span></span>
-   <span data-ttu-id="1f90f-186">Os métodos [**ITextRangeProvider:: ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit), [**move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)e [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) exigem uma consideração cuidadosa da unidade de texto especificada.</span><span class="sxs-lookup"><span data-stu-id="1f90f-186">The [**ITextRangeProvider::ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit), [**Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), and [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) methods require careful consideration of the specified text unit.</span></span> <span data-ttu-id="1f90f-187">Para obter mais informações, consulte manipulando um TextRange por unidade de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-187">For more information, see Manipulating a TextRange by Text Unit.</span></span>
-   <span data-ttu-id="1f90f-188">Para obter os requisitos de implementação relacionados aos métodos [**ITextRangeProvider:: SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select), [**AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection)e [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) , consulte selecionando texto em um intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-188">For implementation requirements related to the [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select), [**AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection), and [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) methods, see Selecting Text in a Text Range.</span></span>
-   <span data-ttu-id="1f90f-189">Os métodos [**ITextRangeProvider:: FindText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext) e [**FindAttribute**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute) pesquisam para frente ou para trás para uma única cadeia de texto ou atributo de texto correspondente.</span><span class="sxs-lookup"><span data-stu-id="1f90f-189">The [**ITextRangeProvider::FindText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext) and [**FindAttribute**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute) methods search forward or backward for a single matching text string or text attribute.</span></span> <span data-ttu-id="1f90f-190">Eles deverão retornar **NULL** se nenhuma correspondência for encontrada.</span><span class="sxs-lookup"><span data-stu-id="1f90f-190">They should return **NULL** if no match is found.</span></span>
-   <span data-ttu-id="1f90f-191">O método [**ITextRangeProvider:: GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) deve retornar o endereço adquirido da função [**UiaGetReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) ou [**UiaGetReservedNotSupportedValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservednotsupportedvalue) se o atributo associado variar no intervalo ou se o atributo não tiver suporte do controle de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-191">The [**ITextRangeProvider::GetAttributeValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue) method must return the address acquired from the [**UiaGetReservedMixedAttributeValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservedmixedattributevalue) or [**UiaGetReservedNotSupportedValue**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiagetreservednotsupportedvalue) function if the associated attribute varies in the range, or if the attribute is not supported by the text control.</span></span> <span data-ttu-id="1f90f-192">A especificação do padrão de controle **TextRange** não permite adicionar novos identificadores de atributo de texto ou alterar como os atributos existentes são definidos.</span><span class="sxs-lookup"><span data-stu-id="1f90f-192">The **TextRange** control pattern specification does not allow adding new text-attribute identifiers or changing how the existing attributes are defined.</span></span>
-   <span data-ttu-id="1f90f-193">Se possível, o método [**ITextRangeProvider:: GetBoundingRectangles**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) deve retornar uma matriz que contém um retângulo delimitador para cada linha de texto totalmente ou parcialmente visível em um intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-193">If possible, the [**ITextRangeProvider::GetBoundingRectangles**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) method should return an array that contains one bounding rectangle for each fully or partially visible line of text in a text range.</span></span> <span data-ttu-id="1f90f-194">Se isso não for possível, o provedor poderá retornar uma matriz que contém os retângulos delimitadores de apenas linhas totalmente visíveis; no entanto, isso limita a capacidade de um aplicativo cliente de descrever com precisão como o texto é apresentado na tela.</span><span class="sxs-lookup"><span data-stu-id="1f90f-194">If this is not possible, the provider can return an array that contains the bounding rectangles of only fully visible lines; however, this limits a client application's ability to accurately describe how the text is being presented on the screen.</span></span>
-   <span data-ttu-id="1f90f-195">O método [**ITextRangeProvider:: GetChildren**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) deve retornar todos os elementos filho inseridos em um intervalo de texto, mas não precisa retornar nenhum filho dos elementos filho.</span><span class="sxs-lookup"><span data-stu-id="1f90f-195">The [**ITextRangeProvider::GetChildren**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) method should return all child elements embedded in a text range, but it does not need to return any children of the child elements.</span></span> <span data-ttu-id="1f90f-196">Por exemplo, se um intervalo de texto contiver uma tabela que tenha um número de células filho, o método **GetChildren** poderá retornar apenas o elemento TABLE e não os elementos Cell.</span><span class="sxs-lookup"><span data-stu-id="1f90f-196">For example, if a text range contains a table that has a number of child cells, the **GetChildren** method may return just the table element and not the cell elements.</span></span> <span data-ttu-id="1f90f-197">Por motivos de desempenho ou arquitetura, um provedor pode não ser capaz de expor todos os objetos inseridos hospedados em um documento na árvore de automação.</span><span class="sxs-lookup"><span data-stu-id="1f90f-197">For performance or architectural reasons, a provider may not be able to expose all embedded objects that are hosted in a document in the automation tree.</span></span> <span data-ttu-id="1f90f-198">Nesse caso, o provedor deve, pelo menos, dar suporte à enumeração de objetos filho por meio do método **GetChildren** e, como uma opção, oferecer suporte ao padrão de controle [VirtualizedItem](uiauto-implementingvirtualizeditem.md) para o suporte de desvirtualização.</span><span class="sxs-lookup"><span data-stu-id="1f90f-198">In this case, the provider should at least support the enumerating of child objects through the **GetChildren** method and, as an option, support the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern for de-virtualization support.</span></span>
-   <span data-ttu-id="1f90f-199">O método [**ITextRangeProvider:: GetEnclosingElement**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement) normalmente retorna o provedor de texto que fornece o intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-199">The [**ITextRangeProvider::GetEnclosingElement**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement) method typically returns the text provider that supplies the text range.</span></span> <span data-ttu-id="1f90f-200">No entanto, se o provedor de texto oferecer suporte a objetos filho, como tabelas ou hiperlinks, o elemento delimitador poderá ser um descendente do provedor de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-200">However, if the text provider supports child objects such as tables or hyperlinks, the enclosing element could be a descendant of the text provider.</span></span> <span data-ttu-id="1f90f-201">O elemento retornado por **GetEnclosingElement** deve ser o elemento mais próximo do intervalo de texto especificado.</span><span class="sxs-lookup"><span data-stu-id="1f90f-201">The element returned by **GetEnclosingElement** should be the element closest to the given text range.</span></span> <span data-ttu-id="1f90f-202">Por exemplo, se o intervalo de texto estiver em uma célula de uma tabela, **GetEnclosingElement** deverá retornar a célula que a contém, em vez do elemento table.</span><span class="sxs-lookup"><span data-stu-id="1f90f-202">For example, if the text range is in a cell of a table, **GetEnclosingElement** should return the containing cell instead of the table element.</span></span>
-   <span data-ttu-id="1f90f-203">O método [**ITextRangeProvider:: gettext**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) deve retornar o texto sem formatação no intervalo.</span><span class="sxs-lookup"><span data-stu-id="1f90f-203">The [**ITextRangeProvider::GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) method should return the plain text in the range.</span></span> <span data-ttu-id="1f90f-204">Para obter mais informações, consulte adquirindo texto de um intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-204">For more information, see Acquiring Text from a Text Range.</span></span>
-   <span data-ttu-id="1f90f-205">Chamar [**ITextRangeProvider:: ScrollIntoView**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview) deve alinhar o texto no visor do controle de texto conforme especificado pelo parâmetro *alignToTop* .</span><span class="sxs-lookup"><span data-stu-id="1f90f-205">Calling [**ITextRangeProvider::ScrollIntoView**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview) should align the text in the viewport of the text control as specified by the *alignToTop* parameter.</span></span> <span data-ttu-id="1f90f-206">Embora não haja nenhum requisito em termos de alinhamento horizontal, o intervalo de texto deve ser visível tanto horizontal como verticalmente.</span><span class="sxs-lookup"><span data-stu-id="1f90f-206">Although there is no requirement in terms of horizontal alignment, the text range should be visible both horizontally and vertically.</span></span> <span data-ttu-id="1f90f-207">Ao avaliar o parâmetro *alignToTop* , um provedor deve levar em consideração a orientação do controle de texto e a direção do fluxo do texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-207">When evaluating the *alignToTop* parameter, a provider must take into account the orientation of the text control and the flow direction of the text.</span></span> <span data-ttu-id="1f90f-208">Por exemplo, se *alignToTop* for **true** para um controle de texto orientado verticalmente contendo texto que flua da direita para a esquerda, o provedor deverá alinhar o intervalo de texto com o lado direito do visor.</span><span class="sxs-lookup"><span data-stu-id="1f90f-208">For example, if *alignToTop* is **TRUE** for a vertically oriented text control containing text that flows from right to left, the provider should align the text range with the right side of the viewport.</span></span>
-   <span data-ttu-id="1f90f-209">Ao mover um documento por [**\_ linha TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit), se o intervalo de texto entrar em uma tabela inserida, cada linha de texto em uma célula deverá ser tratada como uma linha.</span><span class="sxs-lookup"><span data-stu-id="1f90f-209">When moving through a document by [**TextUnit\_Line**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit), if the text range enters an embedded table, each line of text in a cell should be treated as a line.</span></span>

## <a name="required-members-for-itextprovider"></a><span data-ttu-id="1f90f-210">Membros necessários para **ITextProvider**</span><span class="sxs-lookup"><span data-stu-id="1f90f-210">Required Members for **ITextProvider**</span></span>

<span data-ttu-id="1f90f-211">As propriedades e os métodos a seguir são necessários para implementar a interface [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) .</span><span class="sxs-lookup"><span data-stu-id="1f90f-211">The following properties and methods are required for implementing the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) interface.</span></span>



| <span data-ttu-id="1f90f-212">Membros necessários</span><span class="sxs-lookup"><span data-stu-id="1f90f-212">Required members</span></span>                                                                                        | <span data-ttu-id="1f90f-213">Tipo de membro</span><span class="sxs-lookup"><span data-stu-id="1f90f-213">Member type</span></span> | <span data-ttu-id="1f90f-214">Observações</span><span class="sxs-lookup"><span data-stu-id="1f90f-214">Notes</span></span> |
|---------------------------------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="1f90f-215">**DocumentRange**</span><span class="sxs-lookup"><span data-stu-id="1f90f-215">**DocumentRange**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange)                                             | <span data-ttu-id="1f90f-216">Propriedade</span><span class="sxs-lookup"><span data-stu-id="1f90f-216">Property</span></span>    | <span data-ttu-id="1f90f-217">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-217">None</span></span>  |
| [<span data-ttu-id="1f90f-218">**SupportedTextSelection**</span><span class="sxs-lookup"><span data-stu-id="1f90f-218">**SupportedTextSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection)                           | <span data-ttu-id="1f90f-219">Propriedade</span><span class="sxs-lookup"><span data-stu-id="1f90f-219">Property</span></span>    | <span data-ttu-id="1f90f-220">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-220">None</span></span>  |
| [<span data-ttu-id="1f90f-221">**Getseleções**</span><span class="sxs-lookup"><span data-stu-id="1f90f-221">**GetSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection)                                               | <span data-ttu-id="1f90f-222">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-222">Method</span></span>      | <span data-ttu-id="1f90f-223">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-223">None</span></span>  |
| [<span data-ttu-id="1f90f-224">**GetVisibleRanges**</span><span class="sxs-lookup"><span data-stu-id="1f90f-224">**GetVisibleRanges**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getvisibleranges)                                       | <span data-ttu-id="1f90f-225">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-225">Method</span></span>      | <span data-ttu-id="1f90f-226">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-226">None</span></span>  |
| [<span data-ttu-id="1f90f-227">**RangeFromChild**</span><span class="sxs-lookup"><span data-stu-id="1f90f-227">**RangeFromChild**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefromchild)                                           | <span data-ttu-id="1f90f-228">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-228">Method</span></span>      | <span data-ttu-id="1f90f-229">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-229">None</span></span>  |
| [<span data-ttu-id="1f90f-230">**RangeFromPoint**</span><span class="sxs-lookup"><span data-stu-id="1f90f-230">**RangeFromPoint**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint)                                           | <span data-ttu-id="1f90f-231">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-231">Method</span></span>      | <span data-ttu-id="1f90f-232">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-232">None</span></span>  |
| [<span data-ttu-id="1f90f-233">**\_TextChangedEventId de texto UIA \_**</span><span class="sxs-lookup"><span data-stu-id="1f90f-233">**UIA\_Text\_TextChangedEventId**</span></span>](uiauto-event-ids.md)                   | <span data-ttu-id="1f90f-234">Evento</span><span class="sxs-lookup"><span data-stu-id="1f90f-234">Event</span></span>       | <span data-ttu-id="1f90f-235">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-235">None</span></span>  |
| [<span data-ttu-id="1f90f-236">**\_TextSelectionChangedEventId de texto UIA \_**</span><span class="sxs-lookup"><span data-stu-id="1f90f-236">**UIA\_Text\_TextSelectionChangedEventId**</span></span>](uiauto-event-ids.md) | <span data-ttu-id="1f90f-237">Evento</span><span class="sxs-lookup"><span data-stu-id="1f90f-237">Event</span></span>       | <span data-ttu-id="1f90f-238">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-238">None</span></span>  |



 

<span data-ttu-id="1f90f-239">As propriedades e os métodos adicionais a seguir são necessários para implementar a interface [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) .</span><span class="sxs-lookup"><span data-stu-id="1f90f-239">The following additional properties and methods are required for implementing the [**ITextProvider2**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextprovider2) interface.</span></span>



| <span data-ttu-id="1f90f-240">Membros necessários</span><span class="sxs-lookup"><span data-stu-id="1f90f-240">Required members</span></span>                                                         | <span data-ttu-id="1f90f-241">Tipo de membro</span><span class="sxs-lookup"><span data-stu-id="1f90f-241">Member type</span></span> | <span data-ttu-id="1f90f-242">Observações</span><span class="sxs-lookup"><span data-stu-id="1f90f-242">Notes</span></span> |
|--------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="1f90f-243">**GetCaretRange**</span><span class="sxs-lookup"><span data-stu-id="1f90f-243">**GetCaretRange**</span></span>](/windows/desktop/api/uiautomationcore/nf-uiautomationcore-itextprovider2-getcaretrange)         | <span data-ttu-id="1f90f-244">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-244">Method</span></span>      | <span data-ttu-id="1f90f-245">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-245">None</span></span>  |
| [<span data-ttu-id="1f90f-246">**RangeFromAnnotation**</span><span class="sxs-lookup"><span data-stu-id="1f90f-246">**RangeFromAnnotation**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider2-rangefromannotation) | <span data-ttu-id="1f90f-247">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-247">Method</span></span>      | <span data-ttu-id="1f90f-248">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-248">None</span></span>  |



 

## <a name="required-members-for-itextrangeprovider"></a><span data-ttu-id="1f90f-249">Membros necessários para **ITextRangeProvider**</span><span class="sxs-lookup"><span data-stu-id="1f90f-249">Required Members for **ITextRangeProvider**</span></span>

<span data-ttu-id="1f90f-250">As propriedades e os métodos a seguir são necessários para implementar a interface [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) .</span><span class="sxs-lookup"><span data-stu-id="1f90f-250">The following properties and methods are required for implementing the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface.</span></span>



| <span data-ttu-id="1f90f-251">Membros necessários</span><span class="sxs-lookup"><span data-stu-id="1f90f-251">Required members</span></span>                                                                 | <span data-ttu-id="1f90f-252">Tipo de membro</span><span class="sxs-lookup"><span data-stu-id="1f90f-252">Member type</span></span> | <span data-ttu-id="1f90f-253">Observações</span><span class="sxs-lookup"><span data-stu-id="1f90f-253">Notes</span></span> |
|----------------------------------------------------------------------------------|-------------|-------|
| [<span data-ttu-id="1f90f-254">**AddToSelection**</span><span class="sxs-lookup"><span data-stu-id="1f90f-254">**AddToSelection**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection)               | <span data-ttu-id="1f90f-255">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-255">Method</span></span>      | <span data-ttu-id="1f90f-256">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-256">None</span></span>  |
| [<span data-ttu-id="1f90f-257">**8i**</span><span class="sxs-lookup"><span data-stu-id="1f90f-257">**Clone**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-clone)                                 | <span data-ttu-id="1f90f-258">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-258">Method</span></span>      | <span data-ttu-id="1f90f-259">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-259">None</span></span>  |
| [<span data-ttu-id="1f90f-260">**Comparar**</span><span class="sxs-lookup"><span data-stu-id="1f90f-260">**Compare**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compare)                             | <span data-ttu-id="1f90f-261">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-261">Method</span></span>      | <span data-ttu-id="1f90f-262">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-262">None</span></span>  |
| [<span data-ttu-id="1f90f-263">**CompareEndpoints**</span><span class="sxs-lookup"><span data-stu-id="1f90f-263">**CompareEndpoints**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-compareendpoints)           | <span data-ttu-id="1f90f-264">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-264">Method</span></span>      | <span data-ttu-id="1f90f-265">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-265">None</span></span>  |
| [<span data-ttu-id="1f90f-266">**ExpandToEnclosingUnit**</span><span class="sxs-lookup"><span data-stu-id="1f90f-266">**ExpandToEnclosingUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) | <span data-ttu-id="1f90f-267">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-267">Method</span></span>      | <span data-ttu-id="1f90f-268">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-268">None</span></span>  |
| [<span data-ttu-id="1f90f-269">**FindAttribute**</span><span class="sxs-lookup"><span data-stu-id="1f90f-269">**FindAttribute**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findattribute)                 | <span data-ttu-id="1f90f-270">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-270">Method</span></span>      | <span data-ttu-id="1f90f-271">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-271">None</span></span>  |
| [<span data-ttu-id="1f90f-272">**FindText**</span><span class="sxs-lookup"><span data-stu-id="1f90f-272">**FindText**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-findtext)                           | <span data-ttu-id="1f90f-273">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-273">Method</span></span>      | <span data-ttu-id="1f90f-274">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-274">None</span></span>  |
| [<span data-ttu-id="1f90f-275">**GetAttributeValue**</span><span class="sxs-lookup"><span data-stu-id="1f90f-275">**GetAttributeValue**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getattributevalue)         | <span data-ttu-id="1f90f-276">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-276">Method</span></span>      | <span data-ttu-id="1f90f-277">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-277">None</span></span>  |
| [<span data-ttu-id="1f90f-278">**GetBoundingRectangles**</span><span class="sxs-lookup"><span data-stu-id="1f90f-278">**GetBoundingRectangles**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getboundingrectangles) | <span data-ttu-id="1f90f-279">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-279">Method</span></span>      | <span data-ttu-id="1f90f-280">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-280">None</span></span>  |
| [<span data-ttu-id="1f90f-281">**GetChildren**</span><span class="sxs-lookup"><span data-stu-id="1f90f-281">**GetChildren**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren)                     | <span data-ttu-id="1f90f-282">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-282">Method</span></span>      | <span data-ttu-id="1f90f-283">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-283">None</span></span>  |
| [<span data-ttu-id="1f90f-284">**GetEnclosingElement**</span><span class="sxs-lookup"><span data-stu-id="1f90f-284">**GetEnclosingElement**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getenclosingelement)     | <span data-ttu-id="1f90f-285">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-285">Method</span></span>      | <span data-ttu-id="1f90f-286">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-286">None</span></span>  |
| [<span data-ttu-id="1f90f-287">**GetText**</span><span class="sxs-lookup"><span data-stu-id="1f90f-287">**GetText**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext)                             | <span data-ttu-id="1f90f-288">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-288">Method</span></span>      | <span data-ttu-id="1f90f-289">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-289">None</span></span>  |
| [<span data-ttu-id="1f90f-290">**Mover**</span><span class="sxs-lookup"><span data-stu-id="1f90f-290">**Move**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move)                                   | <span data-ttu-id="1f90f-291">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-291">Method</span></span>      | <span data-ttu-id="1f90f-292">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-292">None</span></span>  |
| [<span data-ttu-id="1f90f-293">**MoveEndpointByUnit**</span><span class="sxs-lookup"><span data-stu-id="1f90f-293">**MoveEndpointByUnit**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)       | <span data-ttu-id="1f90f-294">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-294">Method</span></span>      | <span data-ttu-id="1f90f-295">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-295">None</span></span>  |
| [<span data-ttu-id="1f90f-296">**MoveEndpointByRange**</span><span class="sxs-lookup"><span data-stu-id="1f90f-296">**MoveEndpointByRange**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange)     | <span data-ttu-id="1f90f-297">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-297">Method</span></span>      | <span data-ttu-id="1f90f-298">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-298">None</span></span>  |
| [<span data-ttu-id="1f90f-299">**Não**</span><span class="sxs-lookup"><span data-stu-id="1f90f-299">**Select**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select)                               | <span data-ttu-id="1f90f-300">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-300">Method</span></span>      | <span data-ttu-id="1f90f-301">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-301">None</span></span>  |
| [<span data-ttu-id="1f90f-302">**ScrollIntoView**</span><span class="sxs-lookup"><span data-stu-id="1f90f-302">**ScrollIntoView**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-scrollintoview)               | <span data-ttu-id="1f90f-303">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-303">Method</span></span>      | <span data-ttu-id="1f90f-304">Nenhum</span><span class="sxs-lookup"><span data-stu-id="1f90f-304">None</span></span>  |



 

<span data-ttu-id="1f90f-305">As propriedades e os métodos adicionais a seguir são necessários para implementar a interface [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) .</span><span class="sxs-lookup"><span data-stu-id="1f90f-305">The following additional properties and methods are required for implementing the [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interface.</span></span>



| <span data-ttu-id="1f90f-306">Membros necessários</span><span class="sxs-lookup"><span data-stu-id="1f90f-306">Required members</span></span>                                                      | <span data-ttu-id="1f90f-307">Tipo de membro</span><span class="sxs-lookup"><span data-stu-id="1f90f-307">Member type</span></span> | <span data-ttu-id="1f90f-308">Observações</span><span class="sxs-lookup"><span data-stu-id="1f90f-308">Notes</span></span>                                      |
|-----------------------------------------------------------------------|-------------|--------------------------------------------|
| [<span data-ttu-id="1f90f-309">**ShowContextMenu**</span><span class="sxs-lookup"><span data-stu-id="1f90f-309">**ShowContextMenu**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) | <span data-ttu-id="1f90f-310">Método</span><span class="sxs-lookup"><span data-stu-id="1f90f-310">Method</span></span>      | <span data-ttu-id="1f90f-311">Consulte a seção "Implementando o subcontextmenu"</span><span class="sxs-lookup"><span data-stu-id="1f90f-311">See "Implementing ShowContextMenu" section</span></span> |



 

<span data-ttu-id="1f90f-312">O padrão de controle **TextRange** não tem eventos associados.</span><span class="sxs-lookup"><span data-stu-id="1f90f-312">The **TextRange** control pattern has no associated events.</span></span>

## <a name="supporting-text-ranges"></a><span data-ttu-id="1f90f-313">Suporte a intervalos de texto</span><span class="sxs-lookup"><span data-stu-id="1f90f-313">Supporting Text Ranges</span></span>

<span data-ttu-id="1f90f-314">Esta seção descreve como um provedor deve implementar vários métodos das interfaces [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) e [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) para dar suporte ao padrão de controle **TextRange** .</span><span class="sxs-lookup"><span data-stu-id="1f90f-314">This section describes how a provider should implement various methods of the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) and [**ITextRangeProvider2**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider2) interfaces to support the **TextRange** control pattern.</span></span>

### <a name="manipulating-a-text-range-by-text-unit"></a><span data-ttu-id="1f90f-315">Manipulando um intervalo de texto por unidade de texto</span><span class="sxs-lookup"><span data-stu-id="1f90f-315">Manipulating a Text Range by Text Unit</span></span>

<span data-ttu-id="1f90f-316">A interface [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) fornece vários métodos para manipular e navegar em intervalos de texto em um controle baseado em texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-316">The [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface provides several methods for manipulating and navigating text ranges in a text-based control.</span></span> <span data-ttu-id="1f90f-317">Os métodos [**ITextRangeProvider:: move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit)e [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) movem um intervalo de texto ou um de seus pontos de extremidade pela unidade de texto especificada, como caractere, palavra, parágrafo e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="1f90f-317">The [**ITextRangeProvider::Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move), [**MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit), and [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) methods move a text range or one of its endpoints by the specified text unit, such as character, word, paragraph, and so on.</span></span> <span data-ttu-id="1f90f-318">Para obter mais informações, consulte [unidades de texto de automação da interface do usuário](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span><span class="sxs-lookup"><span data-stu-id="1f90f-318">For more information, see [UI Automation Text Units](/windows/desktop/WinAuto/uiauto-uiautomationtextunits).</span></span>

<span data-ttu-id="1f90f-319">Apesar de seu nome, o método [**ITextRangeProvider:: ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) não expande necessariamente um intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-319">Despite its name, the [**ITextRangeProvider::ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) method does not necessarily expand a text range.</span></span> <span data-ttu-id="1f90f-320">Em vez disso, ele "normaliza" um intervalo de texto movendo os pontos de extremidade para que o intervalo abranja a unidade de texto especificada.</span><span class="sxs-lookup"><span data-stu-id="1f90f-320">Instead, it "normalizes" a text range by moving the endpoints so that the range encompasses the specified text unit.</span></span> <span data-ttu-id="1f90f-321">O intervalo será expandido se for menor que a unidade especificada, ou reduzido se for maior que a unidade especificada.</span><span class="sxs-lookup"><span data-stu-id="1f90f-321">The range is expanded if it is smaller than the specified unit, or shortened if it is longer than the specified unit.</span></span> <span data-ttu-id="1f90f-322">É fundamental que o método **ExpandToEnclosingUnit** sempre normalizasse os intervalos de texto de maneira consistente; caso contrário, outros aspectos da manipulação de intervalo de texto por unidade de texto seriam imprevisíveis.</span><span class="sxs-lookup"><span data-stu-id="1f90f-322">It is critical that the **ExpandToEnclosingUnit** method always normalizes text ranges in a consistent manner; otherwise, other aspects of text range manipulation by text unit would be unpredictable.</span></span> <span data-ttu-id="1f90f-323">O diagrama a seguir mostra como o **ExpandToEnclosingUnit** normaliza um intervalo de texto movendo os pontos de extremidade do intervalo.</span><span class="sxs-lookup"><span data-stu-id="1f90f-323">The following diagram shows how **ExpandToEnclosingUnit** normalizes a text range by moving the endpoints of the range.</span></span>

![diagrama mostrando posições de ponto de extremidade de intervalo de texto antes e depois de uma chamada para ExpandToEnclosingUnit](images/expandtoenclosingunit.jpg)

<span data-ttu-id="1f90f-325">Se o intervalo de texto começar no início de uma unidade de texto e terminar no início de, ou antes, no próximo limite de unidade de texto, o ponto de extremidade final será movido para o próximo limite de unidade de texto (consulte 1 e 2 no diagrama anterior).</span><span class="sxs-lookup"><span data-stu-id="1f90f-325">If the text range starts at the beginning of a text unit and ends at the beginning of, or before, the next text unit boundary, the ending endpoint is moved to the next text unit boundary (see 1 and 2 in the previous diagram).</span></span>

<span data-ttu-id="1f90f-326">Se o intervalo de texto começar no início de uma unidade de texto e terminar em, ou após, o próximo limite de unidade, o ponto de extremidade final permanecerá ou será movido para trás para o próximo limite de unidade após o ponto de extremidade inicial (consulte 3 e 4 na ilustração anterior).</span><span class="sxs-lookup"><span data-stu-id="1f90f-326">If the text range starts at the beginning of a text unit and ends at, or after, the next unit boundary, the ending endpoint stays or is moved backward to the next unit boundary after the starting endpoint (see 3 and 4 in the previous illustration).</span></span> <span data-ttu-id="1f90f-327">Se houver mais de um limite de unidade de texto entre os pontos de extremidade inicial e final, o ponto de extremidade final será movido para trás para o próximo limite de unidade após o ponto final de partida, resultando em um intervalo de texto que é uma unidade de texto de comprimento.</span><span class="sxs-lookup"><span data-stu-id="1f90f-327">If there is more than one text unit boundary between the starting and ending endpoints, the ending endpoint is moved backward to the next unit boundary after the starting endpoint, resulting in a text range that is one text unit in length.</span></span>

<span data-ttu-id="1f90f-328">Se o intervalo de texto for iniciado em um meio da unidade de texto, o ponto de extremidade inicial será movido para trás até o início da unidade de texto, e o ponto de extremidade final será movido para frente ou para trás, conforme necessário, para o próximo limite de unidade após o ponto de extremidade inicial (consulte de 5 a 8 no diagrama anterior).</span><span class="sxs-lookup"><span data-stu-id="1f90f-328">If the text range starts in a middle of the text unit, the starting endpoint is moved backward to the beginning of the text unit, and the ending endpoint is moved forward or backward, as necessary, to the next unit boundary after the starting endpoint (see 5 through 8 in the previous diagram).</span></span>

<span data-ttu-id="1f90f-329">Quando o método [**ITextRangeProvider:: move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move) é chamado, o provedor normaliza o intervalo de texto pela unidade de texto especificada, usando a mesma lógica de normalização que o método [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) .</span><span class="sxs-lookup"><span data-stu-id="1f90f-329">When the [**ITextRangeProvider::Move**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-move) method is called, the provider normalizes the text range by the specified text unit, using the same normalization logic as the [**ExpandToEnclosingUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-expandtoenclosingunit) method.</span></span> <span data-ttu-id="1f90f-330">Em seguida, o provedor move o intervalo para trás ou para frente pelo número especificado de unidades de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-330">Then, the provider moves the range backward or forward by the specified number of text units.</span></span> <span data-ttu-id="1f90f-331">Ao mover o intervalo, o provedor deve ignorar os limites de todos os objetos inseridos no texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-331">When moving the range, the provider should ignore the boundaries of any embedded objects in the text.</span></span> <span data-ttu-id="1f90f-332">(No entanto, o limite de unidade em si pode ser afetado pela existência de um objeto incorporado).</span><span class="sxs-lookup"><span data-stu-id="1f90f-332">(However, the unit boundary itself may be affected by the existence of an embedded object).</span></span> <span data-ttu-id="1f90f-333">O diagrama a seguir demonstra como o método **mover** move um intervalo de texto, unidade por unidade, entre objetos incorporados e limites de unidade de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-333">The following diagram demonstrates how the **Move** method moves a text range, unit by unit, across embedded objects and text unit boundaries.</span></span>

![diagrama mostrando como o método mover move os pontos de extremidade de intervalo entre os limites de objeto e de unidade de texto](images/move.jpg)

<span data-ttu-id="1f90f-335">O método [**ITextRangeProvider:: MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) move um dos pontos de extremidade para frente ou para trás pela unidade de texto especificada, como mostra a ilustração a seguir.</span><span class="sxs-lookup"><span data-stu-id="1f90f-335">The [**ITextRangeProvider::MoveEndpointByUnit**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyunit) method moves one of the endpoints forward or backward by specified text unit, as the following illustration shows.</span></span>

![diagrama mostrando como o moveendpointbyunit move o ponto de extremidade de um intervalo](images/moveendpointbyunit.gif)

<span data-ttu-id="1f90f-337">O método [**ITextRangeProvider:: MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) permite que um aplicativo cliente defina um ponto de extremidade de um intervalo de texto para o mesmo local que o ponto de extremidade especificado de um segundo intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-337">The [**ITextRangeProvider::MoveEndpointByRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-moveendpointbyrange) method enables a client application to set one endpoint of a text range to same location as the specified endpoint of a second text range.</span></span>

### <a name="selecting-text-in-a-text-range"></a><span data-ttu-id="1f90f-338">Selecionando texto em um intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="1f90f-338">Selecting Text in a Text Range</span></span>

<span data-ttu-id="1f90f-339">A interface [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) inclui vários métodos para controlar a seleção de texto em um controle baseado em texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-339">The [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interface includes several methods for controlling the selection of text in a text-based control.</span></span>

<span data-ttu-id="1f90f-340">O método [**ITextRangeProvider:: SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) deve selecionar o texto que corresponde a um intervalo de texto e remover a seleção anterior, se houver, do controle de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-340">The [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) method should select the text that corresponds to a text range, and remove the previous selection, if any, from the text control.</span></span> <span data-ttu-id="1f90f-341">Se **Select** for chamado em um intervalo de texto degenerado, o provedor deverá mover o ponto de inserção para o local do intervalo de texto sem selecionar nenhum texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-341">If **Select** is called on a degenerate text range, the provider should move the insertion point to the location of the text range without selecting any text.</span></span>

<span data-ttu-id="1f90f-342">Se um controle oferecer suporte à seleção de vários conjuntos de texto não contíguos, os métodos [**ITextRangeProvider:: AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) e [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) adicionarão intervalos de texto a e os removerão da coleção de intervalos de texto selecionados.</span><span class="sxs-lookup"><span data-stu-id="1f90f-342">If a control supports the selection of multiple, disjoint spans of text, the [**ITextRangeProvider::AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) and [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) methods add text ranges to, and remove them from, the collection of selected text ranges.</span></span> <span data-ttu-id="1f90f-343">Se o controle oferecer suporte apenas a um intervalo de texto selecionado por vez, mas a operação de seleção resultar na seleção de vários intervalos de texto não contíguos, o provedor deverá retornar um erro **E \_ INVALIDOPERATION** ou deverá estender ou truncar a seleção atual.</span><span class="sxs-lookup"><span data-stu-id="1f90f-343">If the control only supports one selected text range at a time, but the selection operation would result in the selection of multiple disjoint text ranges, the provider should either return an **E\_INVALIDOPERATION** error, or should extend or truncate the current selection.</span></span> <span data-ttu-id="1f90f-344">A propriedade [**ITextProvider:: SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) deve indicar se um controle dá suporte à seleção de uma ou várias extensões de texto ou nenhuma.</span><span class="sxs-lookup"><span data-stu-id="1f90f-344">The [**ITextProvider::SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) property should indicate whether a control supports the selection of single or multiple spans of text, or none at all.</span></span>

<span data-ttu-id="1f90f-345">Se um controle baseado em texto oferecer suporte a inserções de texto, chamar [**ITextRangeProvider:: AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) ou [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) em um intervalo de texto degenerado no controle deve mover o ponto de inserção, mas não deve selecionar nenhum texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-345">If a text-based control supports text insertions, calling [**ITextRangeProvider::AddToSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-addtoselection) or [**RemoveFromSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-removefromselection) on a degenerate text range in the control should move the insertion point but should not select any text.</span></span>

### <a name="acquiring-text-from-a-text-range"></a><span data-ttu-id="1f90f-346">Adquirindo texto de um intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="1f90f-346">Acquiring Text from a Text Range</span></span>

<span data-ttu-id="1f90f-347">O método [**ITextRangeProvider:: gettext**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) deve retornar o texto sem formatação de um intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-347">The [**ITextRangeProvider::GetText**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-gettext) method should return the plain text of a text range.</span></span> <span data-ttu-id="1f90f-348">O texto sem formatação deve incluir todos os caracteres de controle encontrados no texto de origem, como retornos de carro e a marca Unicode da esquerda para a direita (LRM).</span><span class="sxs-lookup"><span data-stu-id="1f90f-348">The plain text should include all control characters found in the source text, such as carriage returns and the Unicode left-to-right mark (LRM).</span></span> <span data-ttu-id="1f90f-349">O texto sem formatação não deve incluir marcas de marcação, como HTML, que possam estar presentes no texto de origem.</span><span class="sxs-lookup"><span data-stu-id="1f90f-349">The plain text should not include any markup tags such as HTML that may be present in the source text.</span></span> <span data-ttu-id="1f90f-350">Além disso, todos os códigos de escape no texto de origem devem ser convertidos para os equivalentes de texto sem formatação.</span><span class="sxs-lookup"><span data-stu-id="1f90f-350">Also, any escape codes in the source text should be converted to the plain text equivalents.</span></span> <span data-ttu-id="1f90f-351">Por exemplo, " &nbsp; " deve ser convertido em um caractere de espaço simples.</span><span class="sxs-lookup"><span data-stu-id="1f90f-351">For example, "&nbsp;" should be converted to a simple space character.</span></span>

<span data-ttu-id="1f90f-352">Se um objeto inserido abranger um intervalo de texto, o texto sem formatação deverá incluir o texto interno do objeto, mas não o texto alternativo (a propriedade Name do objeto incorporado), pois ele pode estar inconsistente com o texto interno descritivo.</span><span class="sxs-lookup"><span data-stu-id="1f90f-352">If an embedded object spans a range of text, the plain text should include the inner text of the object, but not the alternative text (the name property of the embedded object) because it might be inconsistent with the descriptive inner text.</span></span> <span data-ttu-id="1f90f-353">Para obter mais informações, consulte [como a automação da interface do usuário expõe objetos inseridos](uiauto-textpattern-and-embedded-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="1f90f-353">For more information, see [How UI Automation Exposes Embedded Objects](uiauto-textpattern-and-embedded-objects-overview.md).</span></span>

### <a name="implementing-showcontextmenu"></a><span data-ttu-id="1f90f-354">Implementando o subcontextmenu</span><span class="sxs-lookup"><span data-stu-id="1f90f-354">Implementing ShowContextMenu</span></span>

<span data-ttu-id="1f90f-355">[**ITextRangeProvider2:: o addcontextmenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) sempre deve mostrar o menu de contexto no ponto de extremidade inicial do intervalo.</span><span class="sxs-lookup"><span data-stu-id="1f90f-355">[**ITextRangeProvider2::ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) should always show the context menu at the beginning end point of the range.</span></span> <span data-ttu-id="1f90f-356">Isso deve ser equivalente ao que aconteceria se o usuário pressionasse a tecla do menu de contexto ou SHIFT + F10 com o ponto de inserção no início do intervalo.</span><span class="sxs-lookup"><span data-stu-id="1f90f-356">This should be equivalent to what would happen if the user pressed the context menu key or SHIFT + F10 with the insertion point at the beginning of the range.</span></span>

<span data-ttu-id="1f90f-357">Se a exibição do menu de contexto normalmente resultar no deslocamento do ponto de inserção para um determinado local, ele deverá fazer isso para invocar [**Procontextmenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) programaticamente para o suporte de automação da interface do usuário também.</span><span class="sxs-lookup"><span data-stu-id="1f90f-357">If showing the context menu would typically result in the insertion point moving to a given location, then it should do so for programmatically invoking [**ShowContextMenu**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider2-showcontextmenu) for UI Automation support also.</span></span>

## <a name="interoperability-with-the-system-caret"></a><span data-ttu-id="1f90f-358">Interoperabilidade com o cursor do sistema</span><span class="sxs-lookup"><span data-stu-id="1f90f-358">Interoperability with the System Caret</span></span>

<span data-ttu-id="1f90f-359">O suporte correto ao ponto de inserção é essencial para muitos aplicativos cliente, incluindo aqueles não baseados na automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="1f90f-359">Correctly supporting the insertion point is critical to many client applications, including those not based on UI Automation.</span></span> <span data-ttu-id="1f90f-360">No padrão de controle de **texto** , o ponto de inserção é representado por um intervalo de texto degenerado (vazio) na posição do cursor do sistema.</span><span class="sxs-lookup"><span data-stu-id="1f90f-360">In the **Text** control pattern, the insertion point is represented by a degenerate (empty) text range at the position of the system caret.</span></span> <span data-ttu-id="1f90f-361">Quando o ponto de inserção é movido, um controle deve gerar o evento **Textselectionchanged** ([**UIA \_ Text \_ TextSelectionChangedEventId**](uiauto-event-ids.md)).</span><span class="sxs-lookup"><span data-stu-id="1f90f-361">When the insertion point moves, a control should raise the **TextSelectionChanged** event ([**UIA\_Text\_TextSelectionChangedEventId**](uiauto-event-ids.md)).</span></span> <span data-ttu-id="1f90f-362">Alguns aplicativos cliente dependem desse evento para monitorar o local do ponto de inserção e controlar a seleção de texto.</span><span class="sxs-lookup"><span data-stu-id="1f90f-362">Some client applications depend on this event to monitor the location of the insertion point, and to keep track of the text selection.</span></span>

<span data-ttu-id="1f90f-363">Quando um controle contém o texto selecionado, o design atual do padrão de controle de **texto** não fornece uma maneira de associar diretamente o local do ponto de inserção a um intervalo de texto específico.</span><span class="sxs-lookup"><span data-stu-id="1f90f-363">When a control contains selected text, the current design of the **Text** control pattern does not provide a way to directly associate the location of the insertion point with a particular text range.</span></span> <span data-ttu-id="1f90f-364">O provedor deve manter o controle da seleção de texto e definir o local do ponto de inserção adequadamente.</span><span class="sxs-lookup"><span data-stu-id="1f90f-364">The provider must keep track of the text selection and set the location of the insertion point appropriately.</span></span> <span data-ttu-id="1f90f-365">Como selecionar o texto normalmente é feito movendo o ponto de inserção enquanto mantém pressionada a tecla SHIFT ou CTRL, ou ambos, um provedor pode rastrear a seleção de texto verificando o estado dessas chaves sempre que a seleção é alterada.</span><span class="sxs-lookup"><span data-stu-id="1f90f-365">Because selecting text is typically done by moving the insertion point while holding down the SHIFT or CTRL key, or both, a provider can track the text selection by checking the state of these keys whenever the selection changes.</span></span>

<span data-ttu-id="1f90f-366">Como a estrutura de acessibilidade fornece suporte interno para o cursor do sistema, mas não para um cursor personalizado, os controles baseados em texto devem usar o cursor do sistema sempre que possível.</span><span class="sxs-lookup"><span data-stu-id="1f90f-366">Because the accessibility framework provides built-in support for the system caret but not for a custom caret, text-based controls should use the system caret whenever possible.</span></span> <span data-ttu-id="1f90f-367">Os controles que usam um cursor personalizado podem garantir que o cursor seja acessível criando um cursor do sistema que tenha as mesmas dimensões que o cursor personalizado e posicionando o cursor do sistema no mesmo local da interface do usuário do controle como o cursor personalizado — ou seja, no ponto de inserção.</span><span class="sxs-lookup"><span data-stu-id="1f90f-367">Controls that use a custom caret can ensure that the caret is accessible by creating a system caret that has the same dimensions as the custom caret, and positioning the system caret at the same location in the UI of the control as the custom caret—that is, at the insertion point.</span></span> <span data-ttu-id="1f90f-368">Como alternativa, um controle que usa um cursor personalizado pode implementar um provedor Microsoft Acessibilidade Ativa para o [**\_ cursor OBJID**](object-identifiers.md) para fornecer informações de acessibilidade diretamente para o seu cursor personalizado.</span><span class="sxs-lookup"><span data-stu-id="1f90f-368">As an alternative, a control that uses a custom caret can implement a Microsoft Active Accessibility provider for [**OBJID\_CARET**](object-identifiers.md) to provide accessibility information directly for your custom caret.</span></span>

<span data-ttu-id="1f90f-369">Para obter mais informações sobre o cursor do sistema, consulte [Cursors](/windows/desktop/menurc/carets).</span><span class="sxs-lookup"><span data-stu-id="1f90f-369">For more information about the system caret, see [Carets](/windows/desktop/menurc/carets).</span></span>

<span data-ttu-id="1f90f-370">Para testar se o controle expõe corretamente o local do cursor do sistema, use as ferramentas [inspecionar](inspect-objects.md) e [acessar o Inspetor de eventos](accessible-event-watcher.md) .</span><span class="sxs-lookup"><span data-stu-id="1f90f-370">To test whether your control properly exposes the location of the system caret, use the [Inspect](inspect-objects.md) and [Accessible Event Watcher](accessible-event-watcher.md) tools.</span></span>

<span data-ttu-id="1f90f-371">As coordenadas de tela do centro do bitmap de cursor do sistema devem sempre corresponder ao local do ponto de inserção.</span><span class="sxs-lookup"><span data-stu-id="1f90f-371">The screen coordinates of the center of the system caret bitmap should always match the location of the insertion point.</span></span> <span data-ttu-id="1f90f-372">Dessa forma, um cliente pode usar as coordenadas da tela de cursor em uma chamada para [**ITextProvider:: RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) para recuperar um intervalo de texto que representa precisamente o local do ponto de inserção.</span><span class="sxs-lookup"><span data-stu-id="1f90f-372">That way, a client can use the caret screen coordinates in a call to [**ITextProvider::RangeFromPoint**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-rangefrompoint) to retrieve a text range that accurately represents the location of the insertion point.</span></span>

## <a name="related-topics"></a><span data-ttu-id="1f90f-373">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="1f90f-373">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="1f90f-374">Tipos de controle e seus padrões de controle com suporte</span><span class="sxs-lookup"><span data-stu-id="1f90f-374">Control Types and Their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="1f90f-375">Tipo de controle de texto</span><span class="sxs-lookup"><span data-stu-id="1f90f-375">Text Control Type</span></span>](uiauto-supporttextcontroltype.md)
</dt> <dt>

[<span data-ttu-id="1f90f-376">Padrão de controle editor</span><span class="sxs-lookup"><span data-stu-id="1f90f-376">TextEdit Control Pattern</span></span>](textedit-control-pattern.md)
</dt> <dt>

[<span data-ttu-id="1f90f-377">Padrão de controle textchild</span><span class="sxs-lookup"><span data-stu-id="1f90f-377">TextChild Control Pattern</span></span>](textchild-control-pattern.md)
</dt> <dt>

[<span data-ttu-id="1f90f-378">Visão Geral de Padrões de Controle de Automação de Interface de Usuário</span><span class="sxs-lookup"><span data-stu-id="1f90f-378">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="1f90f-379">Suporte à automação da interface do usuário para conteúdo textual</span><span class="sxs-lookup"><span data-stu-id="1f90f-379">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)
</dt> <dt>

[<span data-ttu-id="1f90f-380">Visão geral da árvore de automação de interface do usuário</span><span class="sxs-lookup"><span data-stu-id="1f90f-380">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> </dl>

 

 