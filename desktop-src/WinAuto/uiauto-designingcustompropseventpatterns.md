---
title: Criar propriedades personalizadas, eventos e padrões de controle
description: O design de um padrão de propriedade, evento ou controle personalizado deve ser útil em uma ampla variedade de implementações de controle.
ms.assetid: e4b224a0-3958-4ae7-96cb-fe6dc16511a7
keywords:
- Automação da interface do usuário, propriedades personalizadas
- Automação da interface do usuário, visão geral de eventos
- Visão geral da automação da interface do usuário, padrões de controle
- Automação da interface do usuário, criando Propriedades personalizadas
- Automação da interface do usuário, criação de eventos
- Automação da interface do usuário, design de padrões de controle
- Automação da interface do usuário, WinEvents
- Propriedades personalizadas, criando
- eventos, criando
- eventos, WinEvents
- padrões de controle, design
- WinEvents
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 93e6973356fe6be922e73eef70e5107b6dcabe0a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104366072"
---
# <a name="design-custom-properties-events-and-control-patterns"></a><span data-ttu-id="6143e-115">Criar propriedades personalizadas, eventos e padrões de controle</span><span class="sxs-lookup"><span data-stu-id="6143e-115">Design custom properties, events, and control patterns</span></span>

<span data-ttu-id="6143e-116">O design de um padrão de propriedade, evento ou controle personalizado deve ser útil em uma ampla variedade de implementações de controle.</span><span class="sxs-lookup"><span data-stu-id="6143e-116">The design of a custom property, event, or control pattern should be useful in a wide variety of control implementations.</span></span> <span data-ttu-id="6143e-117">Designs específicos de controle ou aplicativo que são úteis apenas em cenários limitados devem ser evitados.</span><span class="sxs-lookup"><span data-stu-id="6143e-117">Control- or application-specific designs that are useful only in limited scenarios should be avoided.</span></span> <span data-ttu-id="6143e-118">O design deve seguir o exemplo das propriedades de automação da interface do usuário da Microsoft, eventos e padrões de controle existentes, que foram cuidadosamente especificados para atender às necessidades de uma ampla variedade de aplicativos de acessibilidade e de teste automatizados.</span><span class="sxs-lookup"><span data-stu-id="6143e-118">The design should follow the example of the existing Microsoft UI Automation properties, events, and control patterns, which were carefully specified to meet the needs of a wide variety of accessibility and automated testing applications.</span></span>

<span data-ttu-id="6143e-119">A implementação da especificação de um padrão de propriedade, evento ou controle personalizado envolve a cooperação e o contrato de partes nos lados do cliente e do provedor e exige que ambas as partes implementem a especificação de forma consistente.</span><span class="sxs-lookup"><span data-stu-id="6143e-119">Implementing the specification for a custom property, event, or control pattern involves the cooperation and agreement of parties on both the client and provider sides, and requires both parties to implement the specification consistently.</span></span> <span data-ttu-id="6143e-120">As empresas são incentivadas a trabalhar com organizações do setor, como a [AIA (Accessibility Interoperability Alliance)](https://www.atia.org/) , para projetar e publicar a especificação para a propriedade personalizada, evento ou padrão de controle.</span><span class="sxs-lookup"><span data-stu-id="6143e-120">Companies are encouraged to work with industry organizations such as the [Accessibility Interoperability Alliance (AIA)](https://www.atia.org/) to design and publish the specification for the custom property, event, or control pattern.</span></span> <span data-ttu-id="6143e-121">Dessa forma, o consenso pode ser alcançado e a interoperabilidade com a maior variedade de aplicativos pode ser garantida.</span><span class="sxs-lookup"><span data-stu-id="6143e-121">In this way, consensus can be reached and interoperability with the widest variety of applications can be ensured.</span></span>

<span data-ttu-id="6143e-122">Este tópico contém as seguintes seções:</span><span class="sxs-lookup"><span data-stu-id="6143e-122">This topic contains the following sections:</span></span>

-   [<span data-ttu-id="6143e-123">Quando usar propriedades e eventos personalizados</span><span class="sxs-lookup"><span data-stu-id="6143e-123">When to Use Custom Properties and Events</span></span>](#when-to-use-custom-properties-and-events)
-   [<span data-ttu-id="6143e-124">Criando Propriedades personalizadas</span><span class="sxs-lookup"><span data-stu-id="6143e-124">Designing Custom Properties</span></span>](#designing-custom-properties)
-   [<span data-ttu-id="6143e-125">Criando eventos personalizados</span><span class="sxs-lookup"><span data-stu-id="6143e-125">Designing Custom Events</span></span>](#designing-custom-events)
    -   [<span data-ttu-id="6143e-126">Eventos personalizados de automação de interface do usuário e WinEvents</span><span class="sxs-lookup"><span data-stu-id="6143e-126">Custom UI Automation Events and WinEvents</span></span>](#custom-ui-automation-events-and-winevents)
-   [<span data-ttu-id="6143e-127">Criando padrões de controle personalizados</span><span class="sxs-lookup"><span data-stu-id="6143e-127">Designing Custom Control Patterns</span></span>](#designing-custom-control-patterns)
-   [<span data-ttu-id="6143e-128">Tipos de controle personalizados</span><span class="sxs-lookup"><span data-stu-id="6143e-128">Custom Control Types</span></span>](#custom-control-types)
-   [<span data-ttu-id="6143e-129">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="6143e-129">Related topics</span></span>](#related-topics)

## <a name="when-to-use-custom-properties-and-events"></a><span data-ttu-id="6143e-130">Quando usar propriedades e eventos personalizados</span><span class="sxs-lookup"><span data-stu-id="6143e-130">When to Use Custom Properties and Events</span></span>

<span data-ttu-id="6143e-131">Antes de criar uma propriedade personalizada, evento ou padrão de controle, verifique se a automação da interface do usuário não fornece uma solução existente.</span><span class="sxs-lookup"><span data-stu-id="6143e-131">Before creating a custom property, event, or control pattern, make sure that UI Automation does not provide an existing solution.</span></span> <span data-ttu-id="6143e-132">Por exemplo, a criação de um padrão de controle "click" personalizado não é necessária porque o padrão de controle [Invoke](uiauto-implementinginvoke.md) já descreve essa funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="6143e-132">For example, creating a custom "Click" control pattern is not necessary because the [Invoke](uiauto-implementinginvoke.md) control pattern already describes that functionality.</span></span>

<span data-ttu-id="6143e-133">Se você decidir que um padrão de propriedade, evento ou controle personalizado é necessário, verifique se ele não é muito vago ou genérico.</span><span class="sxs-lookup"><span data-stu-id="6143e-133">If you decide that a custom property, event, or control pattern is needed, make sure that it is not too vague or generic.</span></span> <span data-ttu-id="6143e-134">Por exemplo, um padrão de controle chamado "Mostrar" não é útil porque a visibilidade de um controle pode ser indicada por uma propriedade de disponibilidade no elemento, como [**UIA \_ IsExpandCollapsePatternAvailablePropertyId**](uiauto-control-pattern-availability-propids.md) ou [**UIA \_ IsScrollItemPatternAvailablePropertyId**](uiauto-control-pattern-availability-propids.md).</span><span class="sxs-lookup"><span data-stu-id="6143e-134">For example, a control pattern called "Show" is not useful because the visibility of a control can be indicated by an availability property on the element, such as [**UIA\_IsExpandCollapsePatternAvailablePropertyId**](uiauto-control-pattern-availability-propids.md) or [**UIA\_IsScrollItemPatternAvailablePropertyId**](uiauto-control-pattern-availability-propids.md).</span></span>

<span data-ttu-id="6143e-135">Antes de implementar uma solução personalizada, confirme cuidadosamente que ela é necessária e, em seguida, crie a funcionalidade completamente.</span><span class="sxs-lookup"><span data-stu-id="6143e-135">Before implementing a custom solution, carefully confirm it is needed and then design the functionality completely.</span></span>

## <a name="designing-custom-properties"></a><span data-ttu-id="6143e-136">Criando Propriedades personalizadas</span><span class="sxs-lookup"><span data-stu-id="6143e-136">Designing Custom Properties</span></span>

<span data-ttu-id="6143e-137">A automação da interface do usuário inclui dois tipos básicos de propriedades: propriedades do elemento Automation e propriedades de padrão de controle.</span><span class="sxs-lookup"><span data-stu-id="6143e-137">UI Automation includes two basic types of properties: automation element properties, and control pattern properties.</span></span> <span data-ttu-id="6143e-138">As propriedades do elemento Automation consistem em um conjunto comum de propriedades, como Name, AcceleratorKey e ClassName, que são expostas por todos os elementos de automação da interface do usuário, independentemente do tipo de controle.</span><span class="sxs-lookup"><span data-stu-id="6143e-138">The automation element properties consist of a common set of properties, such as Name, AcceleratorKey, and ClassName, that are exposed by all UI Automation elements, regardless of the control type.</span></span> <span data-ttu-id="6143e-139">As propriedades de padrão de controle são expostas por um controle por meio de um padrão de controle específico.</span><span class="sxs-lookup"><span data-stu-id="6143e-139">Control pattern properties are exposed by a control through a particular control pattern.</span></span> <span data-ttu-id="6143e-140">Cada padrão de controle tem um conjunto correspondente de propriedades de padrão de controle que o controle deve expor.</span><span class="sxs-lookup"><span data-stu-id="6143e-140">Each control pattern has a corresponding set of control pattern properties that the control must expose.</span></span> <span data-ttu-id="6143e-141">Por exemplo, um controle que dá suporte ao padrão de controle de [grade](uiauto-implementinggrid.md) expõe as propriedades ColumnCount e RowCount.</span><span class="sxs-lookup"><span data-stu-id="6143e-141">For example, a control that supports the [Grid](uiauto-implementinggrid.md) control pattern exposes the ColumnCount and RowCount properties.</span></span>

<span data-ttu-id="6143e-142">Uma propriedade de elemento de automação personalizada ou propriedade de padrão de controle deve aderir às seguintes diretrizes de design:</span><span class="sxs-lookup"><span data-stu-id="6143e-142">A custom automation element property or control pattern property should adhere to the following design guidelines:</span></span>

-   <span data-ttu-id="6143e-143">Uma propriedade personalizada deve ter um dos seguintes tipos de dados especificados pela enumeração [**UIAutomationType**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype) .</span><span class="sxs-lookup"><span data-stu-id="6143e-143">A custom property must have one of the following data types specified by the [**UIAutomationType**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype) enumeration.</span></span> <span data-ttu-id="6143e-144">Nenhum outro tipo de dados tem suporte para propriedades personalizadas.</span><span class="sxs-lookup"><span data-stu-id="6143e-144">No other data types are supported for custom properties.</span></span>
    -   <span data-ttu-id="6143e-145">**\_Bool UIAutomationType**</span><span class="sxs-lookup"><span data-stu-id="6143e-145">**UIAutomationType\_Bool**</span></span>
    -   <span data-ttu-id="6143e-146">**UIAutomationType \_ duplo**</span><span class="sxs-lookup"><span data-stu-id="6143e-146">**UIAutomationType\_Double**</span></span>
    -   <span data-ttu-id="6143e-147">**\_Elemento UIAutomationType**</span><span class="sxs-lookup"><span data-stu-id="6143e-147">**UIAutomationType\_Element**</span></span>
    -   <span data-ttu-id="6143e-148">**UIAutomationType \_ int**</span><span class="sxs-lookup"><span data-stu-id="6143e-148">**UIAutomationType\_Int**</span></span>
    -   <span data-ttu-id="6143e-149">**Ponto de UIAutomationType \_**</span><span class="sxs-lookup"><span data-stu-id="6143e-149">**UIAutomationType\_Point**</span></span>
    -   <span data-ttu-id="6143e-150">**\_Cadeia de caracteres UIAutomationType**</span><span class="sxs-lookup"><span data-stu-id="6143e-150">**UIAutomationType\_String**</span></span>
-   <span data-ttu-id="6143e-151">Se a propriedade personalizada contiver dados de cadeia de caracteres ([**BSTR**](/previous-versions/windows/desktop/automat/bstr)), a especificação deverá indicar se a propriedade é localizável (ou seja, se a cadeia de caracteres pode ser convertida em diferentes idiomas da interface do usuário).</span><span class="sxs-lookup"><span data-stu-id="6143e-151">If the custom property contains string data ([**BSTR**](/previous-versions/windows/desktop/automat/bstr)), the specification must state whether the property is localizable (that is, whether the string can be translated into different UI languages).</span></span>
-   <span data-ttu-id="6143e-152">A propriedade personalizada não deve se sobrepor aos recursos ou à funcionalidade de propriedades existentes.</span><span class="sxs-lookup"><span data-stu-id="6143e-152">The custom property should not overlap with the features or functionality of existing properties.</span></span>

## <a name="designing-custom-events"></a><span data-ttu-id="6143e-153">Criando eventos personalizados</span><span class="sxs-lookup"><span data-stu-id="6143e-153">Designing Custom Events</span></span>

<span data-ttu-id="6143e-154">Os aplicativos usam notificações de eventos de automação da interface do usuário para responder a alterações e ações envolvendo itens da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="6143e-154">Applications use UI Automation event notifications to respond to changes and actions involving UI items.</span></span> <span data-ttu-id="6143e-155">A maioria das propriedades tem eventos de alteração de propriedade associados que a automação da interface do usuário gera quando o valor da propriedade é alterado.</span><span class="sxs-lookup"><span data-stu-id="6143e-155">Most properties have associated property-changed events that UI Automation raises when the value of the property changes.</span></span> <span data-ttu-id="6143e-156">Se você introduzir uma propriedade personalizada, deverá considerar a introdução de qualquer evento personalizado correspondente que também possa ser necessário.</span><span class="sxs-lookup"><span data-stu-id="6143e-156">If you introduce a custom property, you should consider introducing any corresponding custom events that may also be needed.</span></span>

<span data-ttu-id="6143e-157">Um evento personalizado deve aderir às seguintes diretrizes de design:</span><span class="sxs-lookup"><span data-stu-id="6143e-157">A custom event should adhere to the following design guidelines:</span></span>

-   <span data-ttu-id="6143e-158">O evento personalizado deve ser "sem estado".</span><span class="sxs-lookup"><span data-stu-id="6143e-158">The custom event must be "stateless."</span></span> <span data-ttu-id="6143e-159">Ele não pode ser associado a uma propriedade ou valor específico.</span><span class="sxs-lookup"><span data-stu-id="6143e-159">It cannot be associated with a specific property or value.</span></span>
-   <span data-ttu-id="6143e-160">O evento personalizado não deve se sobrepor à definição ou à função de qualquer evento existente.</span><span class="sxs-lookup"><span data-stu-id="6143e-160">The custom event should not overlap with the definition or role of any existing event.</span></span>

### <a name="custom-ui-automation-events-and-winevents"></a><span data-ttu-id="6143e-161">Eventos personalizados de automação de interface do usuário e WinEvents</span><span class="sxs-lookup"><span data-stu-id="6143e-161">Custom UI Automation Events and WinEvents</span></span>

<span data-ttu-id="6143e-162">[WinEvents](winevents-infrastructure.md) são um mecanismo útil de comunicação entre processos e eventos na plataforma Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="6143e-162">[WinEvents](winevents-infrastructure.md) are a useful interprocess communication and eventing mechanism in the Microsoft Windows platform.</span></span> <span data-ttu-id="6143e-163">No entanto, a introdução de uma nova ID de WinEvent é arriscada porque pode causar colisões com outros aplicativos ou o sistema operacional, resultando no sistema se tornar instável.</span><span class="sxs-lookup"><span data-stu-id="6143e-163">However, introducing a new WinEvent ID is risky because it can cause collisions with other applications or the operating system, resulting in the system becoming unstable.</span></span> <span data-ttu-id="6143e-164">Para evitar colisões, a Microsoft definiu várias categorias diferentes de WinEvents e, para cada categoria, definiu um ou mais intervalos de valores para uso como IDs WinEvent.</span><span class="sxs-lookup"><span data-stu-id="6143e-164">To avoid collisions, Microsoft has defined several different categories of WinEvents and, for each category, has defined one or more ranges of values for use as WinEvent IDs.</span></span> <span data-ttu-id="6143e-165">Para obter mais informações, consulte [alocação de IDs WinEvent](allocation-of-winevent-ids.md).</span><span class="sxs-lookup"><span data-stu-id="6143e-165">For more information, see [Allocation of WinEvent IDs](allocation-of-winevent-ids.md).</span></span>

<span data-ttu-id="6143e-166">Eventos de automação de interface do usuário personalizados evitam conflitos alocando a ID do evento internamente na estrutura de automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="6143e-166">Custom UI Automation events avoid conflicts by allocating the event ID internally in the UI Automation framework.</span></span>

## <a name="designing-custom-control-patterns"></a><span data-ttu-id="6143e-167">Criando padrões de controle personalizados</span><span class="sxs-lookup"><span data-stu-id="6143e-167">Designing Custom Control Patterns</span></span>

<span data-ttu-id="6143e-168">Um padrão de controle é uma interface com propriedades, métodos e eventos que definem uma parte discreta da funcionalidade disponível a partir de um elemento de automação.</span><span class="sxs-lookup"><span data-stu-id="6143e-168">A control pattern is an interface with properties, methods, and events that define a discrete piece of functionality available from an automation element.</span></span> <span data-ttu-id="6143e-169">Os métodos de padrão de controle permitem que os clientes de automação da interface do usuário manipulem um aspecto específico do controle.</span><span class="sxs-lookup"><span data-stu-id="6143e-169">Control pattern methods allow UI Automation clients to manipulate a particular aspect of the control.</span></span> <span data-ttu-id="6143e-170">As propriedades e os eventos do padrão de controle fornecem informações sobre algum aspecto do controle e fornecem informações sobre o estado do elemento de automação que implementa o padrão de controle.</span><span class="sxs-lookup"><span data-stu-id="6143e-170">The control pattern properties and events provide information about some aspect of the control, and provide information about the state of the automation element that implements the control pattern.</span></span>

<span data-ttu-id="6143e-171">Um padrão de controle personalizado deve aderir às seguintes diretrizes de design:</span><span class="sxs-lookup"><span data-stu-id="6143e-171">A custom control pattern should adhere to the following design guidelines:</span></span>

-   <span data-ttu-id="6143e-172">Um padrão de controle personalizado deve abranger um cenário específico.</span><span class="sxs-lookup"><span data-stu-id="6143e-172">A custom control pattern should cover a particular scenario.</span></span> <span data-ttu-id="6143e-173">Por exemplo, o padrão de controle de [IsContainer](uiauto-implementingitemcontainer.md) é destinado a consultar um objeto contido independentemente do estado de virtualização, mas não enumera ou conta os objetos contidos.</span><span class="sxs-lookup"><span data-stu-id="6143e-173">For example, the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern is intended for querying a contained object regardless of the virtualization state, but it does not enumerate or count the contained objects.</span></span>
-   <span data-ttu-id="6143e-174">Um padrão de controle personalizado não deve se sobrepor aos recursos dos padrões de controle existentes.</span><span class="sxs-lookup"><span data-stu-id="6143e-174">A custom control pattern should not overlap with the features of existing control patterns.</span></span> <span data-ttu-id="6143e-175">Por exemplo, os padrões de controle [Invoke](uiauto-implementinginvoke.md) e [ExpandCollapse](uiauto-implementingexpandcollapse.md) não devem ser combinados e apresentados como um novo padrão de controle.</span><span class="sxs-lookup"><span data-stu-id="6143e-175">For example, the [Invoke](uiauto-implementinginvoke.md) and [ExpandCollapse](uiauto-implementingexpandcollapse.md) control patterns should not be combined and presented as a new control pattern.</span></span> <span data-ttu-id="6143e-176">Reutilize os padrões de controle existentes ou defina cenários exclusivos com novos padrões de controle.</span><span class="sxs-lookup"><span data-stu-id="6143e-176">Either reuse existing control patterns or define unique scenarios with new control patterns.</span></span>
-   <span data-ttu-id="6143e-177">Vários padrões de controle personalizados podem ser criados juntos para dar suporte a cenários complexos.</span><span class="sxs-lookup"><span data-stu-id="6143e-177">Multiple custom control patterns can be designed together to support complex scenarios.</span></span> <span data-ttu-id="6143e-178">Por exemplo, os padrões de controle [Selection](uiauto-implementingselection.md) e [SelectionItem](uiauto-implementingselectionitem.md) funcionam juntos para dar suporte a cenários de seleção de objetos gerais.</span><span class="sxs-lookup"><span data-stu-id="6143e-178">For example, the [Selection](uiauto-implementingselection.md) and [SelectionItem](uiauto-implementingselectionitem.md) control patterns work together to support general object selection scenarios.</span></span>

## <a name="custom-control-types"></a><span data-ttu-id="6143e-179">Tipos de controle personalizados</span><span class="sxs-lookup"><span data-stu-id="6143e-179">Custom Control Types</span></span>

<span data-ttu-id="6143e-180">Embora este tópico se concentre em como registrar Propriedades personalizadas de automação de interface do usuário, eventos e padrões de controle, também é possível introduzir novos tipos de controle.</span><span class="sxs-lookup"><span data-stu-id="6143e-180">Although this topic focuses on how to register custom UI Automation properties, events, and control patterns, it is also possible to introduce new control types.</span></span> <span data-ttu-id="6143e-181">Diferentemente de propriedades personalizadas, eventos e padrões de controle, um tipo de controle personalizado não pode ser registrado programaticamente em tempo de execução porque, na verdade, é apenas um valor potencial da propriedade ControlType de automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="6143e-181">Unlike custom properties, events, and control patterns, a custom control type cannot be registered programmatically at runtime because it is actually just a potential value of the UI Automation ControlType property.</span></span> <span data-ttu-id="6143e-182">No entanto, uma ID de tipo de controle personalizado pode ser definida, publicada e disponibilizada para outros clientes e provedores usarem.</span><span class="sxs-lookup"><span data-stu-id="6143e-182">However, a custom control type ID can be defined, published, and made available for other clients and providers to use.</span></span> <span data-ttu-id="6143e-183">Para obter mais informações sobre tipos de controle, consulte [visão geral de tipos de controle de automação da interface do usuário](uiauto-controltypesoverview.md).</span><span class="sxs-lookup"><span data-stu-id="6143e-183">For more information about control types, see [UI Automation Control Types Overview](uiauto-controltypesoverview.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="6143e-184">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="6143e-184">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="6143e-185">**Conceitua**</span><span class="sxs-lookup"><span data-stu-id="6143e-185">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="6143e-186">Registrando Propriedades personalizadas, eventos e padrões de controle</span><span class="sxs-lookup"><span data-stu-id="6143e-186">Registering Custom Properties, Events, and Control Patterns</span></span>](uiauto-regcustompropseventpatterns.md)
</dt> <dt>

[<span data-ttu-id="6143e-187">Visão geral das propriedades de automação da interface do usuário</span><span class="sxs-lookup"><span data-stu-id="6143e-187">UI Automation Properties Overview</span></span>](uiauto-propertiesoverview.md)
</dt> <dt>

[<span data-ttu-id="6143e-188">Visão geral sobre eventos de automação de interface do usuário</span><span class="sxs-lookup"><span data-stu-id="6143e-188">UI Automation Events Overview</span></span>](uiauto-eventsoverview.md)
</dt> <dt>

[<span data-ttu-id="6143e-189">Visão Geral de Padrões de Controle de Automação de Interface de Usuário</span><span class="sxs-lookup"><span data-stu-id="6143e-189">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> </dl>

 

 