---
title: Como consultar um item virtualizado no modo de exibição de itens
description: Este tópico descreve como usar a automação da interface do usuário da Microsoft para recuperar informações da interface do usuário sobre itens virtualizados na exibição de itens do Windows 7.
ms.assetid: a0bff8a1-47b1-4750-8086-e2e65a79099e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a098635d6e1045c6ff4573de088d8455685014d3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104364340"
---
# <a name="how-to-query-a-virtualized-item-in-items-view"></a><span data-ttu-id="21c98-103">Como consultar um item virtualizado no modo de exibição de itens</span><span class="sxs-lookup"><span data-stu-id="21c98-103">How to Query a Virtualized Item in Items View</span></span>

<span data-ttu-id="21c98-104">Este tópico descreve como usar a automação da interface do usuário da Microsoft para recuperar informações da interface do usuário sobre itens virtualizados na exibição de itens do Windows 7.</span><span class="sxs-lookup"><span data-stu-id="21c98-104">This topic describes how to use Microsoft UI Automation to retrieve UI information about virtualized items in the Windows 7 Items View.</span></span> <span data-ttu-id="21c98-105">Este tópico inclui as seções a seguir.</span><span class="sxs-lookup"><span data-stu-id="21c98-105">This topic includes the following sections.</span></span>

> [!Note]  
> <span data-ttu-id="21c98-106">Este tópico aplica-se somente ao Windows 7.</span><span class="sxs-lookup"><span data-stu-id="21c98-106">This topic applies to Windows 7 only.</span></span> <span data-ttu-id="21c98-107">Lembre-se de que os recursos de acessibilidade descritos neste tópico podem ser alterados em versões futuras do Windows.</span><span class="sxs-lookup"><span data-stu-id="21c98-107">Be aware that the accessibility features described in this topic may change in future versions of Windows.</span></span>

 

-   [<span data-ttu-id="21c98-108">Visão geral</span><span class="sxs-lookup"><span data-stu-id="21c98-108">Overview</span></span>](#overview)
-   [<span data-ttu-id="21c98-109">Estrutura de árvore de exibição de itens</span><span class="sxs-lookup"><span data-stu-id="21c98-109">Items View Tree Structure</span></span>](#items-view-tree-structure)
-   [<span data-ttu-id="21c98-110">Virtualização</span><span class="sxs-lookup"><span data-stu-id="21c98-110">Virtualization</span></span>](#virtualization)
-   [<span data-ttu-id="21c98-111">Obtendo uma contagem de todos os itens</span><span class="sxs-lookup"><span data-stu-id="21c98-111">Obtaining a Count of All Items</span></span>](#obtaining-a-count-of-all-items)
-   [<span data-ttu-id="21c98-112">Obtendo um índice de item com relação a todos os itens</span><span class="sxs-lookup"><span data-stu-id="21c98-112">Obtaining an Item Index with Respect to All Items</span></span>](#obtaining-an-item-index-with-respect-to-all-items)
-   [<span data-ttu-id="21c98-113">Obtendo uma referência a um item Vitualized</span><span class="sxs-lookup"><span data-stu-id="21c98-113">Obtaining a Reference to a Vitualized Item</span></span>](#obtaining-a-reference-to-a-vitualized-item)
-   [<span data-ttu-id="21c98-114">Rolando um item virtualizado na tela</span><span class="sxs-lookup"><span data-stu-id="21c98-114">Scrolling a Virtualized Item on Screen</span></span>](#scrolling-a-virtualized-item-on-screen)
-   [<span data-ttu-id="21c98-115">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="21c98-115">Related topics</span></span>](#related-topics)

## <a name="overview"></a><span data-ttu-id="21c98-116">Visão geral</span><span class="sxs-lookup"><span data-stu-id="21c98-116">Overview</span></span>

<span data-ttu-id="21c98-117">A exibição de itens é um componente de interface do usuário que permite aos usuários exibir e interagir com arquivos e outros itens.</span><span class="sxs-lookup"><span data-stu-id="21c98-117">Items View is a user interface component that enables users to view and interact with files and other items.</span></span> <span data-ttu-id="21c98-118">No Windows 7, a exibição de itens substitui o controle de exibição de lista para apresentar itens na exibição padrão do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="21c98-118">In Windows 7, Items View replaces the list-view control for presenting items in the default view of Windows Explorer.</span></span> <span data-ttu-id="21c98-119">A exibição itens também é usada na caixa de diálogo item comum, resultados da pesquisa do menu iniciar e outros elementos da interface do usuário do Windows 7 que usam o controle navegador do Explorer.</span><span class="sxs-lookup"><span data-stu-id="21c98-119">Items View is also used in the Common Item Dialog, Start menu search results, and other Windows 7 UI elements that use the Explorer Browser control.</span></span> <span data-ttu-id="21c98-120">Em comparação com o controle de exibição de lista, a exibição de itens oferece as seguintes vantagens para os usuários:</span><span class="sxs-lookup"><span data-stu-id="21c98-120">Compared to the list-view control, Items View offers the following advantages to users:</span></span>

-   <span data-ttu-id="21c98-121">A exibição de itens pode apresentar itens de maneiras mais úteis, desejáveis e relevantes, permitindo que os usuários encontrem e organizem itens de forma mais simples, rápida e apreciada.</span><span class="sxs-lookup"><span data-stu-id="21c98-121">Items View can present items in ways that are more useful, desirable, and relevant, enabling users to find and organize items more simply, quickly, and enjoyably.</span></span>
-   <span data-ttu-id="21c98-122">A exibição de itens pode exibir grandes conjuntos de itens de fontes de dados que têm características de desempenho diferentes, permitindo que os usuários naveguem e pesquisem toda a coleção de itens em várias fontes.</span><span class="sxs-lookup"><span data-stu-id="21c98-122">Items View can display large sets of items from data sources that have different performance characteristics, enabling users to browse and search their entire collection of items across multiple sources.</span></span>

<span data-ttu-id="21c98-123">A imagem a seguir mostra a exibição itens no Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="21c98-123">The following image shows the Items View in Windows Explorer.</span></span>

![captura de tela mostrando o componente de exibição de itens com o Windows Explorer](images/itemsview.gif)

<span data-ttu-id="21c98-125">Da perspectiva de um desenvolvedor, a estrutura geral e a funcionalidade da exibição de itens é semelhante à do controle de exibição de lista.</span><span class="sxs-lookup"><span data-stu-id="21c98-125">From a developer's perspective, the general structure and functionality of Items View is similar to that of the list-view control.</span></span> <span data-ttu-id="21c98-126">A principal diferença é que a exibição de itens dá suporte à virtualização, enquanto o controle de exibição de lista não.</span><span class="sxs-lookup"><span data-stu-id="21c98-126">The main difference is that Items View supports virtualization, whereas the list-view control does not.</span></span> <span data-ttu-id="21c98-127">Além disso, a exibição de itens usa duas novas interfaces de automação de interface do usuário para garantir que o conteúdo virtualizado fornecido pela exibição de itens seja acessível.</span><span class="sxs-lookup"><span data-stu-id="21c98-127">Also, Items View uses two new UI Automation interfaces to ensure that virtualized content provided by Items View is accessible.</span></span> <span data-ttu-id="21c98-128">Essas interfaces são descritas nas seções a seguir deste tópico.</span><span class="sxs-lookup"><span data-stu-id="21c98-128">These interfaces are described in the following sections of this topic.</span></span>

<span data-ttu-id="21c98-129">Para obter informações gerais sobre a virtualização na automação da interface do usuário, consulte [trabalhando com itens virtualizados](uiauto-workingwithvirtualizeditems.md).</span><span class="sxs-lookup"><span data-stu-id="21c98-129">For general information about virtualization in UI Automation, see [Working with Virtualized Items](uiauto-workingwithvirtualizeditems.md).</span></span>

## <a name="items-view-tree-structure"></a><span data-ttu-id="21c98-130">Estrutura de árvore de exibição de itens</span><span class="sxs-lookup"><span data-stu-id="21c98-130">Items View Tree Structure</span></span>

<span data-ttu-id="21c98-131">Na árvore de automação da interface do usuário, o elemento da automação da interface do usuário de nível superior da exibição itens tem o nome "ItemsView" e o tipo de controle "lista".</span><span class="sxs-lookup"><span data-stu-id="21c98-131">In the UI Automation tree, the top level UI Automation element of Items View has the name "ItemsView" and the control type "list".</span></span> <span data-ttu-id="21c98-132">Na imagem anterior, o elemento de automação da interface do usuário do amItemsView é descrito em vermelho.</span><span class="sxs-lookup"><span data-stu-id="21c98-132">In the previous image, the ItemsView UI Automation element is outlined in red.</span></span> <span data-ttu-id="21c98-133">Existem vários elementos de automação da interface do usuário abaixo do nível superior de ItemsView, mas somente dois outros elementos de automação da interface do usuário são referenciados neste documento: itens de grupo e itens de lista.</span><span class="sxs-lookup"><span data-stu-id="21c98-133">Various UI Automation elements exist below the top level of ItemsView, but only two other UI Automation elements are referenced in this document: group items and list items.</span></span>

<span data-ttu-id="21c98-134">Os itens de grupo são os elementos de automação da interface do usuário que contêm todos os itens de lista desse grupo — seu tipo de controle é "grupo" e seus nomes variam de acordo com o nome do grupo.</span><span class="sxs-lookup"><span data-stu-id="21c98-134">The group items are the UI Automation elements that contain all of the list items of that group—their control type is "Group" and their names vary depending on the group name.</span></span> <span data-ttu-id="21c98-135">Na imagem anterior, o primeiro item de grupo contém o cabeçalho "A-H (1)" e o item de lista "pasta", e seu nome é "A-H".</span><span class="sxs-lookup"><span data-stu-id="21c98-135">In the previous image, the first group item contains both the "A-H (1)" header and the "Folder" list item, and its name is "A-H".</span></span>

<span data-ttu-id="21c98-136">Os itens de lista são os elementos de automação da interface do usuário que representam os itens de folha na exibição — o tipo de controle é "ListItem" e seus nomes variam de acordo com o nome do item.</span><span class="sxs-lookup"><span data-stu-id="21c98-136">The list items are the UI Automation elements that represent the leaf items in the view—their control type is "ListItem" and their names vary depending on the item name.</span></span> <span data-ttu-id="21c98-137">Na imagem anterior, os elementos da lista são os elementos folha, como "pasta", "música" e "imagem".</span><span class="sxs-lookup"><span data-stu-id="21c98-137">In the previous image, the list elements are the leaf elements such as "Folder", "Music", and "Picture".</span></span> <span data-ttu-id="21c98-138">Esses três elementos de automação de interface do usuário são referidos pelo elemento terms ItemsView, elemento Group e element ListItem no restante deste documento.</span><span class="sxs-lookup"><span data-stu-id="21c98-138">These three UI Automation elements are referred to by the terms ItemsView element, Group element, and ListItem element in the remainder of this document.</span></span>

## <a name="virtualization"></a><span data-ttu-id="21c98-139">Virtualização</span><span class="sxs-lookup"><span data-stu-id="21c98-139">Virtualization</span></span>

<span data-ttu-id="21c98-140">A exibição de itens usa a virtualização, o que significa que os itens fora da área visível da exibição não são buscados no sistema e a representação da interface do usuário deles não é criada.</span><span class="sxs-lookup"><span data-stu-id="21c98-140">Items View uses virtualization, which means that items outside the visible area of the view are not fetched from the system, and the UI representation of them is not created.</span></span> <span data-ttu-id="21c98-141">Esses itens são chamados de *itens virtualizados*.</span><span class="sxs-lookup"><span data-stu-id="21c98-141">These items are called *virtualized items*.</span></span> <span data-ttu-id="21c98-142">Como eles não são criados, os itens virtualizados não têm elementos de automação da interface do usuário e, portanto, não aparecem na árvore de automação da interface do usuário quando um cliente de automação da interface do usuário enumera a árvore.</span><span class="sxs-lookup"><span data-stu-id="21c98-142">Because they are not created, virtualized items do not have UI Automation elements and therefore do not appear in the UI Automation tree when a UI Automation client enumerates the tree.</span></span> <span data-ttu-id="21c98-143">Além disso, os padrões de controle de automação da interface do usuário operam somente em elementos visíveis.</span><span class="sxs-lookup"><span data-stu-id="21c98-143">Also, UI Automation control patterns operate only on visible elements.</span></span> <span data-ttu-id="21c98-144">Por exemplo, o padrão de controle [Selection](uiauto-implementingselection.md) retorna apenas os itens visíveis selecionados quando um cliente chama o método [**IUIAutomationSelectionPattern:: GetCurrentSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection) .</span><span class="sxs-lookup"><span data-stu-id="21c98-144">For example, the [Selection](uiauto-implementingselection.md) control pattern returns only the visible selected items when a client calls the [**IUIAutomationSelectionPattern::GetCurrentSelection**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection) method.</span></span>

<span data-ttu-id="21c98-145">A exibição de itens dá suporte à capacidade de recuperar as seguintes informações sobre itens virtualizados:</span><span class="sxs-lookup"><span data-stu-id="21c98-145">Items View supports the ability to retrieve the following information about virtualized items:</span></span>

-   <span data-ttu-id="21c98-146">Uma contagem do número total de itens, incluindo itens virtualizados</span><span class="sxs-lookup"><span data-stu-id="21c98-146">A count of the total number of items, including virtualized items</span></span>
-   <span data-ttu-id="21c98-147">Elementos de automação da interface do usuário para itens virtualizados</span><span class="sxs-lookup"><span data-stu-id="21c98-147">UI Automation elements for virtualized items</span></span>
-   <span data-ttu-id="21c98-148">Elementos de automação da interface do usuário para os itens virtualizados que são selecionados</span><span class="sxs-lookup"><span data-stu-id="21c98-148">UI Automation elements for the virtualized items that are selected</span></span>

## <a name="obtaining-a-count-of-all-items"></a><span data-ttu-id="21c98-149">Obtendo uma contagem de todos os itens</span><span class="sxs-lookup"><span data-stu-id="21c98-149">Obtaining a Count of All Items</span></span>

<span data-ttu-id="21c98-150">Um cliente pode usar o elemento ItemsView para obter uma contagem de todos os itens, bem como uma contagem dos itens selecionados.</span><span class="sxs-lookup"><span data-stu-id="21c98-150">A client can use the ItemsView element to get a count of all items, as well as a count of the selected items.</span></span> <span data-ttu-id="21c98-151">O elemento ItemsView fornece duas maneiras de obter essas contagens.</span><span class="sxs-lookup"><span data-stu-id="21c98-151">The ItemsView element provides two ways to get these counts.</span></span> <span data-ttu-id="21c98-152">A primeira é obter a propriedade ItemProperty do elemento ItemsView, e a segunda é obter propriedades personalizadas do elemento ItemsView.</span><span class="sxs-lookup"><span data-stu-id="21c98-152">The first is by getting the ItemStatus property of the ItemsView element, and the second is by getting custom properties from the ItemsView element.</span></span>

<span data-ttu-id="21c98-153">A propriedade ItemProperty é uma cadeia de caracteres que especifica uma contagem do número total de itens e uma contagem dos itens selecionados, separados por uma vírgula.</span><span class="sxs-lookup"><span data-stu-id="21c98-153">The ItemStatus property is a string that specifies a count of the total number of items and a count of the selected items, separated by a comma.</span></span> <span data-ttu-id="21c98-154">Por exemplo: "3 itens, 1 item selecionado".</span><span class="sxs-lookup"><span data-stu-id="21c98-154">For example: "3 items, 1 item selected".</span></span> <span data-ttu-id="21c98-155">Essa cadeia de caracteres é localizada e pode ser comunicada diretamente ao usuário.</span><span class="sxs-lookup"><span data-stu-id="21c98-155">This string is localized and can be communicated directly to the user.</span></span>

<span data-ttu-id="21c98-156">As propriedades personalizadas do elemento ItemsView incluem uma propriedade para a contagem de itens e outra para a contagem de seleção.</span><span class="sxs-lookup"><span data-stu-id="21c98-156">The custom properties of the ItemsView element include one property for the item count, and another for the selection count.</span></span> <span data-ttu-id="21c98-157">Entre elas estão:</span><span class="sxs-lookup"><span data-stu-id="21c98-157">They include:</span></span>

-   <span data-ttu-id="21c98-158">\_ \_ ABBF5C45-5CCC-47b7-BB4E-87CB87BBD162 (GUID da propriedade ItemCount) — a contagem de todos os itens exclusivos na exibição.</span><span class="sxs-lookup"><span data-stu-id="21c98-158">ItemCount\_Property\_GUID (ABBF5C45-5CCC-47b7-BB4E-87CB87BBD162)—The count of all unique items in the view.</span></span> <span data-ttu-id="21c98-159">Se agrupado por uma propriedade de vários valores (MVP) para que um único item possa aparecer várias vezes, cada item é contado apenas uma vez.</span><span class="sxs-lookup"><span data-stu-id="21c98-159">If grouped by a multi-value property (MVP) so that a single item can appear multiple times, each item is counted only once.</span></span>

    <span data-ttu-id="21c98-160">(UIAutomationType: [**UIAutomationType \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), nome programático: "ItemCount")</span><span class="sxs-lookup"><span data-stu-id="21c98-160">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "ItemCount")</span></span>

-   <span data-ttu-id="21c98-161">\_ \_ GUID da propriedade SELECTEDITEMCOUNT (92A053DA-2969-4021-BF27-514CFC2E4A69) — a contagem de todos os itens exclusivos selecionados na exibição.</span><span class="sxs-lookup"><span data-stu-id="21c98-161">SelectedItemCount\_Property\_GUID (92A053DA-2969-4021-BF27-514CFC2E4A69)—The count of all unique items selected in the view.</span></span> <span data-ttu-id="21c98-162">Se agrupado por uma propriedade de vários valores (MVP) para que um único item possa aparecer várias vezes, cada item é contado apenas uma vez.</span><span class="sxs-lookup"><span data-stu-id="21c98-162">If grouped by a multi-value property (MVP) so that a single item can appear multiple times, each item is counted only once.</span></span>

    <span data-ttu-id="21c98-163">(UIAutomationType: [**UIAutomationType \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), nome programático: "SelectedItemCount")</span><span class="sxs-lookup"><span data-stu-id="21c98-163">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "SelectedItemCount")</span></span>

<span data-ttu-id="21c98-164">Essas propriedades personalizadas são definidas no Shlguid. h, que está incluído no SDK (Software Development Kit) do Windows, e essas propriedades são registradas por meio do método [**IUIAutomationRegistrar:: RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) .</span><span class="sxs-lookup"><span data-stu-id="21c98-164">These custom properties are defined in Shlguid.h, which is included in the Windows Software Development Kit (SDK), and these properties are registered through the [**IUIAutomationRegistrar::RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) method.</span></span> <span data-ttu-id="21c98-165">Os clientes de automação da interface do usuário usam **RegisterProperty** para recuperar identificadores de propriedade (PROPERTYIDs) para as propriedades personalizadas.</span><span class="sxs-lookup"><span data-stu-id="21c98-165">UI Automation clients use **RegisterProperty** to retrieve property identifiers (PROPERTYIDs) for the custom properties.</span></span>

## <a name="obtaining-an-item-index-with-respect-to-all-items"></a><span data-ttu-id="21c98-166">Obtendo um índice de item com relação a todos os itens</span><span class="sxs-lookup"><span data-stu-id="21c98-166">Obtaining an Item Index with Respect to All Items</span></span>

<span data-ttu-id="21c98-167">Um cliente pode obter o índice de um item obtendo a propriedade ItemProperty de um elemento ListItem ou obtendo uma propriedade personalizada de um elemento ListItem.</span><span class="sxs-lookup"><span data-stu-id="21c98-167">A client can obtain the index of an item either by getting the ItemStatus property of a ListItem element, or by getting a custom property of a ListItem element.</span></span>

<span data-ttu-id="21c98-168">A propriedade ItemProperty é uma cadeia de caracteres que contém o índice de um item em relação ao número total de itens.</span><span class="sxs-lookup"><span data-stu-id="21c98-168">The ItemStatus property is a string that contains the index of an item with respect to the total number of items.</span></span> <span data-ttu-id="21c98-169">Por exemplo: "item 1 de 3".</span><span class="sxs-lookup"><span data-stu-id="21c98-169">For example: "item 1 of 3".</span></span> <span data-ttu-id="21c98-170">Essa cadeia de caracteres é localizada e pode ser comunicada diretamente ao usuário.</span><span class="sxs-lookup"><span data-stu-id="21c98-170">This string is localized and can be communicated directly to the user.</span></span>

<span data-ttu-id="21c98-171">A propriedade personalizada a seguir obtém o índice de item de um elemento ListItem:</span><span class="sxs-lookup"><span data-stu-id="21c98-171">The following custom property gets the item index of a ListItem element:</span></span>

-   <span data-ttu-id="21c98-172">\_ \_ GUID da propriedade ITEMINDEX (92A053DA-2969-4021-BF27-514CFC2E4A69) — o índice absoluto com base em 1 de um item.</span><span class="sxs-lookup"><span data-stu-id="21c98-172">ItemIndex\_Property\_GUID (92A053DA-2969-4021-BF27-514CFC2E4A69)—The 1-based absolute index of an item.</span></span> <span data-ttu-id="21c98-173">Se agrupado por uma propriedade de vários valores (MVP) para que um único item possa aparecer duas vezes, cada aparência do item obterá um índice separado.</span><span class="sxs-lookup"><span data-stu-id="21c98-173">If grouped by a multi-value property (MVP) so that a single item can appear twice, each appearance of the item gets a separate index.</span></span>

    <span data-ttu-id="21c98-174">(UIAutomationType: [**UIAutomationType \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), nome programático: "ItemIndex")</span><span class="sxs-lookup"><span data-stu-id="21c98-174">(UIAutomationType: [**UIAutomationType\_Int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), Programmatic Name: "ItemIndex")</span></span>

<span data-ttu-id="21c98-175">Essa propriedade personalizada é definida em Shlguid. h, que é incluída no SDK do Windows e é registrada por meio do método [**IUIAutomationRegistrar:: RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) .</span><span class="sxs-lookup"><span data-stu-id="21c98-175">This custom property is defined in Shlguid.h, which is included in the Windows SDK, and is registered through the [**IUIAutomationRegistrar::RegisterProperty**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) method.</span></span> <span data-ttu-id="21c98-176">Os clientes de automação da interface do usuário usam **RegisterProperty** para recuperar um PROPERTYIDs (identificador de propriedade) para a propriedade personalizada.</span><span class="sxs-lookup"><span data-stu-id="21c98-176">UI Automation clients use **RegisterProperty** to retrieve a property identifier (PROPERTYIDs) for the custom property.</span></span>

## <a name="obtaining-a-reference-to-a-vitualized-item"></a><span data-ttu-id="21c98-177">Obtendo uma referência a um item Vitualized</span><span class="sxs-lookup"><span data-stu-id="21c98-177">Obtaining a Reference to a Vitualized Item</span></span>

<span data-ttu-id="21c98-178">Um elemento ItemsView implementa o padrão de controle [MyContainer](uiauto-implementingitemcontainer.md) (interface [**IItemContainerProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider) ), que permite que um cliente obtenha um elemento de automação da interface do usuário para um item virtualizado (um item que está fora da área visível).</span><span class="sxs-lookup"><span data-stu-id="21c98-178">An ItemsView element implements the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern ([**IItemContainerProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider) interface), which allows a client to get a UI Automation element for a virtualized item (an item that is outside the visible area).</span></span> <span data-ttu-id="21c98-179">ItemsView permite que o cliente encontre um elemento ListItem pesquisando nas propriedades Name e Selection — tentar Pesquisar em qualquer outra propriedade falhará.</span><span class="sxs-lookup"><span data-stu-id="21c98-179">ItemsView allows the client to find a ListItem element by searching on the Name and Selection properties—attempting to search on any other property will fail.</span></span>

<span data-ttu-id="21c98-180">Um elemento virtual implementa apenas o padrão de controle [VirtualizedItem](uiauto-implementingvirtualizeditem.md) (interface [**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) ).</span><span class="sxs-lookup"><span data-stu-id="21c98-180">A virtual element implements only the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) interface).</span></span> <span data-ttu-id="21c98-181">Como o item representado por um elemento de automação de interface do usuário virtualizado ainda não existe, a tentativa de obter qualquer outro padrão de controle ou Propriedade do elemento falhará.</span><span class="sxs-lookup"><span data-stu-id="21c98-181">Because the item that is represented by a virtualized UI Automation element does not exist yet, attempting to get any other control pattern or property of the element will fail.</span></span>

<span data-ttu-id="21c98-182">Os elementos ListItem e Group são virtualizados, mas somente elementos ListItem podem ser retornados do padrão de controle de item [contido](uiauto-implementingitemcontainer.md) .</span><span class="sxs-lookup"><span data-stu-id="21c98-182">Both ListItem and Group elements are virtualized, but only ListItem elements can be returned from the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern.</span></span> <span data-ttu-id="21c98-183">Como a chamada para o método [**IUIAutomationItemContainerPattern:: FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) é executada no thread da interface do usuário e está sendo bloqueada, a exibição não responderá até que **FindItemByProperty** seja retornado, e quaisquer outras chamadas de método no provedor deverão aguardar até que **FindItemByProperty** seja concluído.</span><span class="sxs-lookup"><span data-stu-id="21c98-183">Because the call to the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method runs on the UI thread and is blocking, the view will not respond until **FindItemByProperty** returns, and any other method calls on the provider must wait until **FindItemByProperty** finishes.</span></span> <span data-ttu-id="21c98-184">Em alguns casos, o **FindItemByProperty** deve processar todo o conjunto de dados antes de retornar, o que pode consumir muitos recursos.</span><span class="sxs-lookup"><span data-stu-id="21c98-184">In some instances, **FindItemByProperty** must process the entire data set before returning, which can be resource-intensive.</span></span> <span data-ttu-id="21c98-185">A especificação de **NULL** como o elemento inicial faz com que **FindItemByProperty** inicie a pesquisa com o primeiro item na exibição.</span><span class="sxs-lookup"><span data-stu-id="21c98-185">Specifying **NULL** as the starting element causes **FindItemByProperty** to begin the search with the first item in the view.</span></span>

<span data-ttu-id="21c98-186">O ItemsView dá suporte às seguintes propriedades para [**FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty):</span><span class="sxs-lookup"><span data-stu-id="21c98-186">ItemsView supports the following properties for [**FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty):</span></span>

-   <span data-ttu-id="21c98-187">Name (UIA \_ NamePropertyId) – procura o primeiro item cujo nome corresponde totalmente à cadeia de caracteres especificada.</span><span class="sxs-lookup"><span data-stu-id="21c98-187">Name (UIA\_NamePropertyId)—Searches for the first item whose name fully matches the specified string.</span></span> <span data-ttu-id="21c98-188">A pesquisa não diferencia maiúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="21c98-188">The search is not case sensitive.</span></span> <span data-ttu-id="21c98-189">Não há suporte para caracteres curinga ou correspondência parcial.</span><span class="sxs-lookup"><span data-stu-id="21c98-189">Wildcard characters or partial matching is not supported.</span></span> <span data-ttu-id="21c98-190">Se um nome **nulo** for especificado, o próximo item após o elemento inicial será retornado.</span><span class="sxs-lookup"><span data-stu-id="21c98-190">If a **NULL** name is specified, the next item after the starting element is returned.</span></span> <span data-ttu-id="21c98-191">A especificação de nomes **nulos** permite que um cliente de automação da interface do usuário Enumere todos os itens na exibição; no entanto, a enumeração de todos os itens é desencorajada porque faz com que todos os itens na exibição sejam percebidos.</span><span class="sxs-lookup"><span data-stu-id="21c98-191">Specifying **NULL** names allows a UI Automation client to enumerate all items in the view; however, enumerating all items is discouraged because it causes all items in the view to be realized.</span></span>
-   <span data-ttu-id="21c98-192">SelectionItem \_ IsSelected (UIA \_ SelectionItemIsSelectedPropertyId) — procura o primeiro item cuja \_ propriedade IsSelected SelectionItem corresponde ao valor especificado.</span><span class="sxs-lookup"><span data-stu-id="21c98-192">SelectionItem\_IsSelected (UIA\_SelectionItemIsSelectedPropertyId)—Searches for the first item whose SelectionItem\_IsSelected property matches the specified value.</span></span> <span data-ttu-id="21c98-193">Especifique **true** para localizar o primeiro item selecionado ou **false** para localizar o primeiro item não selecionado.</span><span class="sxs-lookup"><span data-stu-id="21c98-193">Specify **TRUE** to find the first selected item, or **FALSE** to find the first non-selected item.</span></span> <span data-ttu-id="21c98-194">Tenha cuidado ao enumerar todos os itens selecionados porque o número de itens selecionados pode ser muito grande, especialmente se o usuário tiver selecionado todos os itens.</span><span class="sxs-lookup"><span data-stu-id="21c98-194">Be careful when enumerating all selected items because the number of selected items can be very large, especially if the user has selected all items.</span></span>

## <a name="scrolling-a-virtualized-item-on-screen"></a><span data-ttu-id="21c98-195">Rolando um item virtualizado na tela</span><span class="sxs-lookup"><span data-stu-id="21c98-195">Scrolling a Virtualized Item on Screen</span></span>

<span data-ttu-id="21c98-196">Depois de obter uma referência a um elemento de automação da interface do usuário para um item virtualizado (fora da tela), o cliente pode rolar o item para a exibição usando o método [**IUIAutomationVirtualizeItemPattern:: perceba**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) do padrão de controle [VirtualizedItem](uiauto-implementingvirtualizeditem.md) .</span><span class="sxs-lookup"><span data-stu-id="21c98-196">After obtaining a reference to a UI Automation element for a virtualized (off-screen) item, the client can scroll the item into view by using the [**IUIAutomationVirtualizeItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) method of the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="21c98-197">Depois que o item é percebido, ele fica visível e todas as propriedades e padrões de controle normalmente associados a um elemento ListItem estão disponíveis para o cliente.</span><span class="sxs-lookup"><span data-stu-id="21c98-197">After the item is realized, it is visible, and all properties and control patterns normally associated with a ListItem element are available to the client.</span></span>

<span data-ttu-id="21c98-198">Somente os elementos ListItem obtidos pelo método [**IUIAutomationItemContainerPattern:: FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) expõem o padrão de controle [VirtualizedItem](uiauto-implementingvirtualizeditem.md) .</span><span class="sxs-lookup"><span data-stu-id="21c98-198">Only ListItem elements obtained by the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method expose the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="21c98-199">Quando um elemento na tela é rolado para fora da tela, o elemento torna-se inválido e o cliente deve chamar **FindItemByProperty** para obter a referência fora da tela.</span><span class="sxs-lookup"><span data-stu-id="21c98-199">When an on-screen element is scrolled off-screen, the element becomes invalid and the client must call **FindItemByProperty** to get the off-screen reference.</span></span>

<span data-ttu-id="21c98-200">Também é possível mover itens para dentro e fora do modo de exibição usando o padrão de controle [Scroll](uiauto-implementingscroll.md) (ou usando as barras de rolagem).</span><span class="sxs-lookup"><span data-stu-id="21c98-200">It is also possible to move items into and out of view by using the [Scroll](uiauto-implementingscroll.md) control pattern (or by using the scroll bars).</span></span> <span data-ttu-id="21c98-201">Os itens e os grupos são percebidos quando rolam para a exibição e são virtualizados à medida que rolam para fora da exibição.</span><span class="sxs-lookup"><span data-stu-id="21c98-201">Items and groups are realized as they scroll into view, and are virtualized as they scroll out of view.</span></span>

## <a name="related-topics"></a><span data-ttu-id="21c98-202">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="21c98-202">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="21c98-203">Trabalhando com itens virtualizados</span><span class="sxs-lookup"><span data-stu-id="21c98-203">Working with Virtualized Items</span></span>](uiauto-workingwithvirtualizeditems.md)
</dt> </dl>

 

 




