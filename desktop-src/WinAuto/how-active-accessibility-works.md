---
title: Como Acessibilidade Ativa funciona
description: O Microsoft Acessibilidade Ativa foi projetado para ajudar os auxílios de acessibilidade, chamados de clientes, a interagir com elementos de interface do usuário padrão e personalizados de outros aplicativos e o sistema operacional.
ms.assetid: 29325f0a-c6ca-42b1-b85d-2671f7041034
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fdeffcebd96ffba804bfc24672bf867028e9b0c7
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/29/2020
ms.locfileid: "103823540"
---
# <a name="how-active-accessibility-works"></a><span data-ttu-id="2fb5c-103">Como Acessibilidade Ativa funciona</span><span class="sxs-lookup"><span data-stu-id="2fb5c-103">How Active Accessibility Works</span></span>

<span data-ttu-id="2fb5c-104">O Microsoft Acessibilidade Ativa foi projetado para ajudar os auxílios de acessibilidade, chamados de *clientes*, a interagir com elementos de interface do usuário padrão e personalizados de outros aplicativos e o sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-104">Microsoft Active Accessibility is designed to help accessibility aids, called *clients*, interact with standard and custom UI elements of other applications and the operating system.</span></span> <span data-ttu-id="2fb5c-105">Um cliente do Microsoft Acessibilidade Ativa é qualquer programa que usa o Microsoft Acessibilidade Ativa para acessar, identificar ou manipular os elementos da interface do usuário de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-105">A Microsoft Active Accessibility client is any program that uses Microsoft Active Accessibility to access, identify, or manipulate the UI elements of an application.</span></span> <span data-ttu-id="2fb5c-106">Os clientes incluem auxílios de acessibilidade, ferramentas de teste automatizadas e alguns aplicativos de treinamento baseados em computador.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-106">Clients include accessibility aids, automated testing tools, and some computer-based training applications.</span></span>

<span data-ttu-id="2fb5c-107">Usando o Microsoft Acessibilidade Ativa, um aplicativo cliente pode:</span><span class="sxs-lookup"><span data-stu-id="2fb5c-107">Using Microsoft Active Accessibility, a client application can:</span></span>

-   <span data-ttu-id="2fb5c-108">Consultar informações; por exemplo, sobre um elemento de interface do usuário em um local específico.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-108">Query for information; for example, about a UI element at a particular location.</span></span>
-   <span data-ttu-id="2fb5c-109">Receber notificações quando as informações forem alteradas; por exemplo, quando um controle torna-se acinzentado ou quando uma cadeia de texto é alterada.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-109">Receive notifications when information changes; for example, when a control becomes grayed or when a text string changes.</span></span>
-   <span data-ttu-id="2fb5c-110">Executar ações que afetam o conteúdo da interface do usuário ou do documento; por exemplo, clique em um botão de ação, menu suspenso e escolha um comando de menu.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-110">Carry out actions that affect user interface or document contents; for example, click a push button, drop down a menu, and choose a menu command.</span></span>

<span data-ttu-id="2fb5c-111">Os aplicativos que interagem com e fornecem informações para clientes são chamados de *servidores*.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-111">The applications that interact with and provide information for clients are called *servers*.</span></span> <span data-ttu-id="2fb5c-112">Um servidor usa o Microsoft Acessibilidade Ativa para fornecer informações sobre seus elementos de interface do usuário aos clientes.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-112">A server uses Microsoft Active Accessibility to provide information about its UI elements to clients.</span></span> <span data-ttu-id="2fb5c-113">Qualquer controle, módulo ou aplicativo que usa o Microsoft Acessibilidade Ativa para expor informações sobre sua interface do usuário é considerado um Microsoft Acessibilidade Ativa Server.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-113">Any control, module, or application that uses Microsoft Active Accessibility to expose information about its user interface is considered a Microsoft Active Accessibility server.</span></span> <span data-ttu-id="2fb5c-114">Os servidores se comunicam com clientes enviando notificações de eventos (como chamar [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent)) e respondendo a solicitações de clientes para acesso a elementos da interface do usuário (como o tratamento de mensagens do [**WM \_ GetObject**](wm-getobject.md) enviadas do [*OLEACC*](uiauto-glossary.md)).</span><span class="sxs-lookup"><span data-stu-id="2fb5c-114">Servers communicate with clients by sending event notifications (such as calling [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent)) and responding to client requests for access to UI elements (such as handling [**WM\_GETOBJECT**](wm-getobject.md) messages sent from [*OLEACC*](uiauto-glossary.md)).</span></span> <span data-ttu-id="2fb5c-115">Os servidores expõem informações por meio da interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .</span><span class="sxs-lookup"><span data-stu-id="2fb5c-115">Servers expose information through the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface.</span></span>

<span data-ttu-id="2fb5c-116">Usando o Microsoft Acessibilidade Ativa, um aplicativo de servidor pode:</span><span class="sxs-lookup"><span data-stu-id="2fb5c-116">Using Microsoft Active Accessibility, a server application can:</span></span>

-   <span data-ttu-id="2fb5c-117">Forneça informações sobre seus objetos de interface do usuário personalizados e o conteúdo de suas janelas cliente.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-117">Provide information about its custom user interface objects and the contents of its client windows.</span></span>
-   <span data-ttu-id="2fb5c-118">Enviar notificações quando a interface do usuário for alterada.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-118">Send notifications when its user interface changes.</span></span>

<span data-ttu-id="2fb5c-119">Por exemplo, para permitir que um usuário selecione comandos de forma verbal em uma barra de ferramentas personalizada do processador de texto, um programa de reconhecimento de fala deve ter informações sobre essa barra de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-119">For example, to enable a user to select commands verbally from a word processor custom toolbar, a speech recognition program must have information about that toolbar.</span></span> <span data-ttu-id="2fb5c-120">Portanto, o processador de texto precisaria disponibilizar essas informações.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-120">The word processor would therefore need to make that information available.</span></span> <span data-ttu-id="2fb5c-121">O Microsoft Acessibilidade Ativa fornece os meios para o processador de texto expor informações sobre sua barra de ferramentas personalizada e para que o programa de reconhecimento de fala obtenha essas informações.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-121">Microsoft Active Accessibility provides the means for the word processor to expose information about its custom toolbar and for the speech recognition program to get that information.</span></span>

### <a name="client-applications-and-active-accessibility"></a><span data-ttu-id="2fb5c-122">Aplicativos cliente e Acessibilidade Ativa</span><span class="sxs-lookup"><span data-stu-id="2fb5c-122">Client Applications and Active Accessibility</span></span>

<span data-ttu-id="2fb5c-123">Um cliente Microsoft Acessibilidade Ativa deve ser notificado quando a interface do usuário do servidor for alterada para que possa transmitir essas informações ao usuário.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-123">A Microsoft Active Accessibility client must be notified when the server UI has changed so that it can convey that information to the user.</span></span> <span data-ttu-id="2fb5c-124">Para garantir que o cliente seja informado sobre as alterações da interface do usuário, ele usa um mecanismo chamado eventos de janela, ou WinEvents, para se registrar para receber notificações.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-124">To ensure that the client is informed about UI changes, it uses a mechanism called Window Events, or WinEvents, to register to receive notifications.</span></span> <span data-ttu-id="2fb5c-125">Para obter mais informações, consulte [WinEvents](winevents-infrastructure.md).</span><span class="sxs-lookup"><span data-stu-id="2fb5c-125">For more information, see [WinEvents](winevents-infrastructure.md).</span></span>

<span data-ttu-id="2fb5c-126">Para saber mais e manipular um determinado elemento de interface do usuário, os clientes usam a interface COM (Microsoft Acessibilidade Ativa Component Object Model), o [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible).</span><span class="sxs-lookup"><span data-stu-id="2fb5c-126">To learn about and manipulate a particular UI element, clients use the Microsoft Active Accessibility Component Object Model (COM) interface, [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible).</span></span>

<span data-ttu-id="2fb5c-127">Um cliente pode recuperar um objeto [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) para um elemento de interface do usuário das quatro maneiras a seguir:</span><span class="sxs-lookup"><span data-stu-id="2fb5c-127">A client can retrieve an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object for a UI element in the following four ways:</span></span>

-   <span data-ttu-id="2fb5c-128">Chame [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) e passe o identificador de janela do elemento de interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-128">Call [**AccessibleObjectFromWindow**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) and pass the UI element's window handle.</span></span>
-   <span data-ttu-id="2fb5c-129">Chame [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint) e passe um local de tela que esteja dentro do retângulo delimitador do elemento de interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-129">Call [**AccessibleObjectFromPoint**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint) and pass a screen location that lies within the UI element's bounding rectangle.</span></span>
-   <span data-ttu-id="2fb5c-130">Defina um gancho WinEvent, receba uma notificação e chame [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) para recuperar um ponteiro de interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) para o elemento de interface do usuário que gerou o evento.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-130">Set a WinEvent hook, receive a notification, and call [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) to retrieve an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer for the UI element that generated the event.</span></span>
-   <span data-ttu-id="2fb5c-131">Chame um método [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) como [**accNavigate**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate) ou [**Get \_ AccParent**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accparent) para mover para um objeto **IAccessible** diferente.</span><span class="sxs-lookup"><span data-stu-id="2fb5c-131">Call an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) method such as [**accNavigate**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate) or [**get\_accParent**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accparent) to move to a different **IAccessible** object.</span></span>

 

 




