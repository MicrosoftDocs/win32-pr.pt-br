---
title: Chamando APIs de Acessibilidade Ativa
description: O Microsoft Acessibilidade Ativa fornece APIs (interfaces de programação de aplicativo) para clientes e servidores.
ms.assetid: c40441d2-7294-4c76-8b42-08ed66eccb7e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 209a239495fddbcaf2275f095abc889295568b3c
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104007691"
---
# <a name="calling-active-accessibility-apis"></a><span data-ttu-id="831f4-103">Chamando APIs de Acessibilidade Ativa</span><span class="sxs-lookup"><span data-stu-id="831f4-103">Calling Active Accessibility APIs</span></span>

<span data-ttu-id="831f4-104">O Microsoft Acessibilidade Ativa fornece APIs (interfaces de programação de aplicativo) para clientes e servidores.</span><span class="sxs-lookup"><span data-stu-id="831f4-104">Microsoft Active Accessibility provides application programming interfaces (APIs) for both clients and servers.</span></span> <span data-ttu-id="831f4-105">A maioria deles é implementada na biblioteca de vínculo dinâmico do Microsoft Acessibilidade Ativa, Oleacc.dll, mas [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook)e [**UnhookWinEvent**](/windows/desktop/api/Winuser/nf-winuser-unhookwinevent) são implementadas no user32.dll, que é um componente principal do sistema operacional Microsoft Windows.</span><span class="sxs-lookup"><span data-stu-id="831f4-105">Most are implemented in the Microsoft Active Accessibility dynamic-link library, Oleacc.dll, but [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook), and [**UnhookWinEvent**](/windows/desktop/api/Winuser/nf-winuser-unhookwinevent) are implemented in user32.dll, which is a core component of the Microsoft Windows operating system.</span></span>

<span data-ttu-id="831f4-106">Computadores que executam o Windows 95 ou o Microsoft Windows NT 4,0 não têm Oleacc.dll e a versão correta do user32.dll instalados porque a Microsoft Acessibilidade Ativa foi incorporada em estágios em versões com sucesso do Windows.</span><span class="sxs-lookup"><span data-stu-id="831f4-106">Computers running Windows 95 or Microsoft Windows NT 4.0 do not have Oleacc.dll and the correct version of user32.dll installed because Microsoft Active Accessibility was incorporated in stages into succeeding versions of Windows.</span></span> <span data-ttu-id="831f4-107">Como resultado, os aplicativos executados nessas plataformas vinculam-se explicitamente a Oleacc.dll em tempo de execução usando a função [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) em vez de depender de bibliotecas de importação.</span><span class="sxs-lookup"><span data-stu-id="831f4-107">As a result, applications that run on these platforms explicitly link to Oleacc.dll at run time using the [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) function instead of relying on import libraries.</span></span> <span data-ttu-id="831f4-108">O Acessibilidade Ativa 1,3 dá suporte ao Windows 95 e ao Microsoft Windows NT 4,0.</span><span class="sxs-lookup"><span data-stu-id="831f4-108">Active Accessibility 1.3 supports Windows 95 and Microsoft Windows NT 4.0.</span></span> <span data-ttu-id="831f4-109">As versões anteriores do Windows não têm suporte do Microsoft Acessibilidade Ativa.</span><span class="sxs-lookup"><span data-stu-id="831f4-109">Earlier versions of Windows are not supported by Microsoft Active Accessibility.</span></span>

<span data-ttu-id="831f4-110">Os aplicativos de servidor usam a função [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) para recuperar o endereço de uma função de acessibilidade ativa da Microsoft e, em seguida, fazer a chamada por meio de um ponteiro de função.</span><span class="sxs-lookup"><span data-stu-id="831f4-110">Server applications use the [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) function to retrieve the address of an Microsoft Active Accessibility function and then make the call through a function pointer.</span></span> <span data-ttu-id="831f4-111">Se você chamar uma função que foi implementada no Oleacc.dll, os aplicativos de servidor usarão o identificador retornado de [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) na chamada para **GetProcAddress**.</span><span class="sxs-lookup"><span data-stu-id="831f4-111">If calling a function that was implemented in Oleacc.dll, server applications use the handle returned from [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) in the call to **GetProcAddress**.</span></span> <span data-ttu-id="831f4-112">Se chamar uma função definida no user32.dll, os aplicativos de servidor chamarão [**GetModuleHandle**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandlea) ESPECIFICANDO "user32" e usarão o identificador de módulo retornado na chamada para **GetProcAddress**.</span><span class="sxs-lookup"><span data-stu-id="831f4-112">If calling a function defined in user32.dll, server applications call [**GetModuleHandle**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandlea) specifying "USER32" and use the returned module handle in the call to **GetProcAddress**.</span></span>

<span data-ttu-id="831f4-113">Por exemplo, se um aplicativo usar [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), ele chamará [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) usando o identificador de módulo de user32.dll para obter o endereço da função.</span><span class="sxs-lookup"><span data-stu-id="831f4-113">For example, if an application uses [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent), it calls [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) using the module handle of user32.dll to get the address of the function.</span></span> <span data-ttu-id="831f4-114">Se a chamada for bem-sucedida (o que significa que esta versão do Windows dá suporte ao Microsoft Acessibilidade Ativa), o aplicativo define um sinalizador que indica que é seguro chamar **NotifyWinEvent**.</span><span class="sxs-lookup"><span data-stu-id="831f4-114">If the call is successful (meaning that this version of Windows supports Microsoft Active Accessibility), then the application sets a flag that indicates that it is safe to call **NotifyWinEvent**.</span></span> <span data-ttu-id="831f4-115">O endereço recebido de **GetProcAddress** é armazenado em uma variável de ponteiro de função e usado em todo o código.</span><span class="sxs-lookup"><span data-stu-id="831f4-115">The address received from **GetProcAddress** is stored in a function pointer variable and used throughout the code.</span></span>

 

 