---
title: Trabalhando com itens virtualizados
description: Este tópico descreve como usar a funcionalidade fornecida pelos padrões de controle contido e VirtualizedItem para localizar e recuperar informações sobre itens virtualizados.
ms.assetid: e1898ba0-5ffa-4c61-b378-c7ef7c4a2c52
keywords:
- clientes, itens virtualizados de automação da interface do usuário
- clientes, itens virtualizados
- clientes, padrões de controle
- clientes, padrões de controle VirtualizedItem
- clientes, padrões de controle de IsContainer
- clientes, padrões de controle VirtualizedItem de automação da interface do usuário
- clientes, padrões de controle de automação da interface do usuário
- clientes, padrões de controle do contêiner de automação da interface do usuário
- Automação da interface do usuário, itens virtualizados
- Automação da interface do usuário, padrões de controle
- Automação da interface do usuário, padrões de controle VirtualizedItem
- Automação da interface do usuário, padrões de controle de IsContainer
- Padrões de controle VirtualizedItem
- Padrões de controle de IsContainer
- padrões de controle, VirtualizedItem
- padrões de controle, IsContainer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb29232b06304079ad5b9dfdfb589ad510a5b51f
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104292540"
---
# <a name="working-with-virtualized-items"></a><span data-ttu-id="fdc94-119">Trabalhando com itens virtualizados</span><span class="sxs-lookup"><span data-stu-id="fdc94-119">Working with Virtualized Items</span></span>

<span data-ttu-id="fdc94-120">Este tópico descreve como usar a funcionalidade fornecida pelos padrões de controle [contido](uiauto-implementingitemcontainer.md) e [VirtualizedItem](uiauto-implementingvirtualizeditem.md) para localizar e recuperar informações sobre itens virtualizados.</span><span class="sxs-lookup"><span data-stu-id="fdc94-120">This topic describes how to use functionality provided by the [ItemContainer](uiauto-implementingitemcontainer.md) and [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control patterns to find and retrieve information about virtualized items.</span></span>

-   [<span data-ttu-id="fdc94-121">Visão geral da virtualização</span><span class="sxs-lookup"><span data-stu-id="fdc94-121">Overview of Virtualization</span></span>](#overview-of-virtualization)
-   [<span data-ttu-id="fdc94-122">Como um controle dá suporte à virtualização</span><span class="sxs-lookup"><span data-stu-id="fdc94-122">How a Control Supports Virtualization</span></span>](#how-a-control-supports-virtualization)
-   [<span data-ttu-id="fdc94-123">Como os clientes encontram e percebem itens virtualizados</span><span class="sxs-lookup"><span data-stu-id="fdc94-123">How Clients Find and Realize Virtualized Items</span></span>](#how-clients-find-and-realize-virtualized-items)
-   [<span data-ttu-id="fdc94-124">Exemplo</span><span class="sxs-lookup"><span data-stu-id="fdc94-124">Example</span></span>](#example)
-   [<span data-ttu-id="fdc94-125">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="fdc94-125">Related topics</span></span>](#related-topics)

## <a name="overview-of-virtualization"></a><span data-ttu-id="fdc94-126">Visão geral da virtualização</span><span class="sxs-lookup"><span data-stu-id="fdc94-126">Overview of Virtualization</span></span>

<span data-ttu-id="fdc94-127">Controles que contêm um grande número de itens filho podem usar a virtualização para gerenciar os itens com eficiência.</span><span class="sxs-lookup"><span data-stu-id="fdc94-127">Controls that contain a large number of child items can use virtualization to efficiently manage the items.</span></span> <span data-ttu-id="fdc94-128">Com a virtualização, o controle mantém informações completas na memória apenas para um subconjunto de itens em um determinado momento.</span><span class="sxs-lookup"><span data-stu-id="fdc94-128">With virtualization, the control maintains full information in memory for only a subset of items at any given time.</span></span> <span data-ttu-id="fdc94-129">Normalmente, o subconjunto inclui apenas os itens que estão visíveis para o usuário no momento.</span><span class="sxs-lookup"><span data-stu-id="fdc94-129">Typically, the subset includes only those items that are currently visible to the user.</span></span> <span data-ttu-id="fdc94-130">As informações completas sobre os itens virtualizados restantes são mantidas no armazenamento e são carregadas na memória ou realizadas, pois o controle precisa dele, por exemplo, à medida que novos itens se tornam visíveis para o usuário.</span><span class="sxs-lookup"><span data-stu-id="fdc94-130">Full information about the remaining virtualized items is kept in storage and is loaded into memory, or realized, as the control needs it, for example, as new items become visible to the user.</span></span>

<span data-ttu-id="fdc94-131">Os controles que usam a virtualização representam um desafio porque apenas itens percebidos estão totalmente disponíveis como elementos de automação da interface do usuário da Microsoft na árvore de automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="fdc94-131">Controls that use virtualization represent a challenge because only realized items are fully available as Microsoft UI Automation elements in the UI Automation tree.</span></span> <span data-ttu-id="fdc94-132">Os itens virtualizados não existem na árvore, portanto, as informações sobre eles não estão disponíveis para os clientes.</span><span class="sxs-lookup"><span data-stu-id="fdc94-132">Virtualized items do not exist in the tree, so information about them is not available to clients.</span></span> <span data-ttu-id="fdc94-133">Para recuperar informações sobre itens virtualizados, os clientes precisam de uma maneira de forçar a automação da interface do usuário a passar a solicitação para obter os itens para o controle.</span><span class="sxs-lookup"><span data-stu-id="fdc94-133">To retrieve information about virtualized items, clients need a way to force UI Automation to pass the request to realize the items to the control.</span></span> <span data-ttu-id="fdc94-134">Depois que os itens forem percebidos, a automação da interface do usuário poderá criar elementos de automação da interface do usuário para eles.</span><span class="sxs-lookup"><span data-stu-id="fdc94-134">After the items have been realized, UI Automation can create UI Automation elements for them.</span></span> <span data-ttu-id="fdc94-135">A automação da interface do usuário inclui dois padrões de controle para permitir que os clientes trabalhem com itens virtualizados: [MyContainer](uiauto-implementingitemcontainer.md) e [VirtualizedItem](uiauto-implementingvirtualizeditem.md).</span><span class="sxs-lookup"><span data-stu-id="fdc94-135">UI Automation includes two control patterns to enable clients to work with virtualized items: [ItemContainer](uiauto-implementingitemcontainer.md) and [VirtualizedItem](uiauto-implementingvirtualizeditem.md).</span></span>

## <a name="how-a-control-supports-virtualization"></a><span data-ttu-id="fdc94-136">Como um controle dá suporte à virtualização</span><span class="sxs-lookup"><span data-stu-id="fdc94-136">How a Control Supports Virtualization</span></span>

<span data-ttu-id="fdc94-137">Qualquer controle que possa conter itens virtualizados deve dar suporte ao padrão de controle de [IsContainer](uiauto-implementingitemcontainer.md) .</span><span class="sxs-lookup"><span data-stu-id="fdc94-137">Any control that can contain virtualized items must support the [ItemContainer](uiauto-implementingitemcontainer.md) control pattern.</span></span> <span data-ttu-id="fdc94-138">Além disso, qualquer item que possa ser virtualizado deve dar suporte ao padrão de controle [VirtualizedItem](uiauto-implementingvirtualizeditem.md) .</span><span class="sxs-lookup"><span data-stu-id="fdc94-138">Further, any item that can be virtualized must support the [VirtualizedItem](uiauto-implementingvirtualizeditem.md) control pattern.</span></span> <span data-ttu-id="fdc94-139">A funcionalidade que é exposta pelos padrões de controle de contêiner e VirtualizedItem é acessível aos clientes por meio das interfaces [**IUIAutomationItemContainerPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationitemcontainerpattern) e [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) .</span><span class="sxs-lookup"><span data-stu-id="fdc94-139">The functionality that is exposed by the ItemContainer and VirtualizedItem control patterns is accessible to clients through the [**IUIAutomationItemContainerPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationitemcontainerpattern) and [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interfaces.</span></span>

## <a name="how-clients-find-and-realize-virtualized-items"></a><span data-ttu-id="fdc94-140">Como os clientes encontram e percebem itens virtualizados</span><span class="sxs-lookup"><span data-stu-id="fdc94-140">How Clients Find and Realize Virtualized Items</span></span>

<span data-ttu-id="fdc94-141">Os clientes podem usar o método [**IUIAutomationItemContainerPattern:: FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) para pesquisar itens filho no contêiner com base no valor de uma determinada propriedade.</span><span class="sxs-lookup"><span data-stu-id="fdc94-141">Clients can use the [**IUIAutomationItemContainerPattern::FindItemByProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) method to search for child items in the container based on the value of a particular property.</span></span> <span data-ttu-id="fdc94-142">O método também pode recuperar o primeiro item no contêiner ou o item que segue o item especificado.</span><span class="sxs-lookup"><span data-stu-id="fdc94-142">The method can also retrieve the first item in the container or the item that follows the specified item.</span></span> <span data-ttu-id="fdc94-143">Se um item filho correspondente for encontrado, o **FindItemByProperty** recuperará uma interface [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) para o item.</span><span class="sxs-lookup"><span data-stu-id="fdc94-143">If a matching child item is found, the **FindItemByProperty** retrieves an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for the item.</span></span> <span data-ttu-id="fdc94-144">No entanto, se o item filho for virtualizado, a interface **IUIAutomationElement** será um espaço reservado.</span><span class="sxs-lookup"><span data-stu-id="fdc94-144">However, if the child item is virtualized, the **IUIAutomationElement** interface is a placeholder.</span></span> <span data-ttu-id="fdc94-145">O erro [**UIA \_ E \_ ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) ocorre quando o cliente tenta usar a interface **IUIAutomationElement** para recuperar valores de propriedade ou chamar métodos que ainda não estão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="fdc94-145">The [**UIA\_E\_ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) error occurs when the client attempts to use the **IUIAutomationElement** interface to retrieve property values or call methods that are not yet available.</span></span> <span data-ttu-id="fdc94-146">Quais propriedades ou métodos estão disponíveis por meio de um espaço reservado depende da implementação do controle.</span><span class="sxs-lookup"><span data-stu-id="fdc94-146">Which properties or methods are available through a placeholder depends on the control implementation.</span></span> <span data-ttu-id="fdc94-147">O único requisito para um espaço reservado é dar suporte à interface [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) .</span><span class="sxs-lookup"><span data-stu-id="fdc94-147">The only requirement for a placeholder is to support the [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interface.</span></span>

<span data-ttu-id="fdc94-148">O erro [**UIA \_ E \_ ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) é uma indicação para o cliente que um item pode ser virtualizado.</span><span class="sxs-lookup"><span data-stu-id="fdc94-148">The [**UIA\_E\_ELEMENTNOTAVAILABLE**](uiauto-error-codes.md) error is an indication to the client that an item may be virtualized.</span></span> <span data-ttu-id="fdc94-149">O cliente deve responder recuperando a interface [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) para o item e, em seguida, obtendo o item chamando o método [**IUIAutomationVirtualizedItemPattern:: concretizar**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) .</span><span class="sxs-lookup"><span data-stu-id="fdc94-149">The client should respond by retrieving the [**IUIAutomationVirtualizedItemPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) interface for the item, and then realizing the item by calling the [**IUIAutomationVirtualizedItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) method.</span></span> <span data-ttu-id="fdc94-150">Se isso tiver sucesso, a interface [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) será totalmente funcional com todas as propriedades apropriadas disponíveis.</span><span class="sxs-lookup"><span data-stu-id="fdc94-150">If this succeeds, the [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface is fully functional with all appropriate properties available.</span></span>

<span data-ttu-id="fdc94-151">Dependendo da implementação do controle, chamar [**IUIAutomationVirtualizedItemPattern:: perceber**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) pode fazer com que o controle role o item para a exibição.</span><span class="sxs-lookup"><span data-stu-id="fdc94-151">Depending on the control implementation, calling [**IUIAutomationVirtualizedItemPattern::Realize**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) may cause the control to scroll the item into view.</span></span> <span data-ttu-id="fdc94-152">No entanto, um cliente não deve confiar no item que rola para a exibição ou tornou-se visível.</span><span class="sxs-lookup"><span data-stu-id="fdc94-152">However, a client should not rely on the item scrolling into view or made visible.</span></span> <span data-ttu-id="fdc94-153">Para garantir que o item esteja visível, o cliente pode usar o método [**IUIAutomationScrollItemPattern:: ScrollIntoView**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationscrollitempattern-scrollintoview) .</span><span class="sxs-lookup"><span data-stu-id="fdc94-153">To ensure that the item is visible, the client can use the [**IUIAutomationScrollItemPattern::ScrollIntoView**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationscrollitempattern-scrollintoview) method.</span></span>

## <a name="example"></a><span data-ttu-id="fdc94-154">Exemplo</span><span class="sxs-lookup"><span data-stu-id="fdc94-154">Example</span></span>

<span data-ttu-id="fdc94-155">Por exemplo, código que mostra como usar o suporte de automação da interface do usuário para virtualização, consulte [como recuperar um item virtualizado](uiauto-howto-retrieve-virtualized-item.md).</span><span class="sxs-lookup"><span data-stu-id="fdc94-155">For example code that shows how to use the UI Automation support for virtualization, see [How to Retrieve a Virtualized Item](uiauto-howto-retrieve-virtualized-item.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="fdc94-156">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="fdc94-156">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="fdc94-157">Visão Geral de Padrões de Controle de Automação de Interface de Usuário</span><span class="sxs-lookup"><span data-stu-id="fdc94-157">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> </dl>

 

 




