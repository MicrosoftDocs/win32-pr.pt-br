---
title: Usando a anotação do servidor
description: Este tópico fornece informações sobre como usar a anotação de servidor para especificar um objeto de retorno de chamada.
ms.assetid: eeeebddc-2752-4d8f-b4fa-38ce156acc08
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb545cd4dd016901d69f67d5ab5cab15dda08875
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "105807204"
---
# <a name="using-server-annotation"></a><span data-ttu-id="6d03b-103">Usando a anotação do servidor</span><span class="sxs-lookup"><span data-stu-id="6d03b-103">Using Server Annotation</span></span>

<span data-ttu-id="6d03b-104">Este tópico fornece informações sobre como usar a anotação de servidor para especificar um objeto de retorno de chamada.</span><span class="sxs-lookup"><span data-stu-id="6d03b-104">This topic provides information about using server annotation to specify a callback object.</span></span>

<span data-ttu-id="6d03b-105">**Para substituir uma propriedade que especifica um objeto de retorno de chamada**</span><span class="sxs-lookup"><span data-stu-id="6d03b-105">**To override a property that specifies a callback object**</span></span>

1.  <span data-ttu-id="6d03b-106">Obtenha um ponteiro de interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) para o elemento acessível que deve ser anotado.</span><span class="sxs-lookup"><span data-stu-id="6d03b-106">Obtain an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface pointer to the accessible element that is to be annotated.</span></span>
2.  <span data-ttu-id="6d03b-107">Chame [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) no elemento acessível para obter um ponteiro de interface [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) .</span><span class="sxs-lookup"><span data-stu-id="6d03b-107">Call [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) on the accessible element to get an [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) interface pointer.</span></span>
3.  <span data-ttu-id="6d03b-108">Chame [**IAccIdentity:: GetIdentityString ()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccidentity-getidentitystring) no ponteiro de interface [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) para obter uma cadeia de caracteres que identifica exclusivamente o elemento acessível a ser anotado.</span><span class="sxs-lookup"><span data-stu-id="6d03b-108">Call [**IAccIdentity::GetIdentityString()**](/windows/desktop/api/Oleacc/nf-oleacc-iaccidentity-getidentitystring) on the [**IAccIdentity**](/windows/desktop/api/oleacc/nn-oleacc-iaccidentity) interface pointer to obtain a string that uniquely identifies the accessible element that is to be annotated.</span></span>
4.  <span data-ttu-id="6d03b-109">Use [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) ou [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) para criar o objeto [**IAccPropServices**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices) .</span><span class="sxs-lookup"><span data-stu-id="6d03b-109">Use [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) or [**CoCreateInstanceEx**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstanceex) to create the [**IAccPropServices**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropservices) object.</span></span>
5.  <span data-ttu-id="6d03b-110">Crie um objeto COM (Component Object Model) que implemente [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver).</span><span class="sxs-lookup"><span data-stu-id="6d03b-110">Create a Component Object Model (COM) object that implements [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver).</span></span>
6.  <span data-ttu-id="6d03b-111">Chame [**IAccPropServices:: SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver), passando a cadeia de caracteres de identidade, um GUID indicando a propriedade a ser substituída e um ponteiro para o objeto de retorno de chamada [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver) .</span><span class="sxs-lookup"><span data-stu-id="6d03b-111">Call [**IAccPropServices::SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver), passing the identity string, a GUID indicating the property to be overridden, and a pointer to the [**IAccPropServer**](/windows/desktop/api/oleacc/nn-oleacc-iaccpropserver) callback object.</span></span>
7.  <span data-ttu-id="6d03b-112">Ponteiros de interface de versão e memória livre.</span><span class="sxs-lookup"><span data-stu-id="6d03b-112">Release interface pointers and free memory.</span></span>

<span data-ttu-id="6d03b-113">Quando um cliente solicita a propriedade do elemento acessível, o objeto de retorno de chamada será chamado e retornará o valor para o cliente.</span><span class="sxs-lookup"><span data-stu-id="6d03b-113">When a client requests the property of the accessible element, the callback object will be called and will return the value to the client.</span></span>

<span data-ttu-id="6d03b-114">Como ao especificar um valor, os desenvolvedores de servidor podem usar como alternativa o método [**IAccPropServices:: ComposeHwndIdentityString**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-composehwndidentitystring) para obter uma cadeia de caracteres de identidade; ou podem usar o método [**IAccPropServices:: SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) e especificar os parâmetros *HWND*, *idObject* ou *idChild* em vez de uma cadeia de caracteres de identidade.</span><span class="sxs-lookup"><span data-stu-id="6d03b-114">As when specifying a value, server developers can alternatively use the [**IAccPropServices::ComposeHwndIdentityString**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-composehwndidentitystring) method to obtain an identity string; or they can use the [**IAccPropServices::SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) method and specify the *hwnd*, *idObject*, or *idChild* parameters instead of an identity string.</span></span>

<span data-ttu-id="6d03b-115">Ao usar [**SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver) ou [**SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) em um objeto de contêiner, os desenvolvedores de servidor podem especificar, opcionalmente, que as informações de substituição também devem ser aplicadas a todos os elementos filho desse contêiner.</span><span class="sxs-lookup"><span data-stu-id="6d03b-115">When using either [**SetPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-setpropserver) or [**SetHwndPropServer**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-sethwndpropserver) on a container object, server developers can optionally specify that the overriding information should also apply to all element children of that container.</span></span>

<span data-ttu-id="6d03b-116">Os servidores podem limpar explicitamente a anotação a qualquer momento usando [**IAccPropServices:: ClearProps**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearprops).</span><span class="sxs-lookup"><span data-stu-id="6d03b-116">Servers can explicitly clear the annotation at any time by using [**IAccPropServices::ClearProps**](/windows/desktop/api/Oleacc/nf-oleacc-iaccpropservices-clearprops).</span></span> <span data-ttu-id="6d03b-117">Isso geralmente não é necessário, pois o serviço de anotação irá limpar automaticamente e liberar informações de anotação quando o elemento acessível que está sendo anotado desaparecer.</span><span class="sxs-lookup"><span data-stu-id="6d03b-117">This is usually not required, as the annotation service will automatically clean up and release annotation information when the accessible element being annotated disappears.</span></span>

<span data-ttu-id="6d03b-118">Abaixo está uma lista de propriedades que podem ser anotadas usando este procedimento.</span><span class="sxs-lookup"><span data-stu-id="6d03b-118">Below is a list of properties that can be annotated using this procedure.</span></span>

## <a name="properties-supported-when-specifying-a-callback"></a><span data-ttu-id="6d03b-119">Propriedades com suporte ao especificar um retorno de chamada</span><span class="sxs-lookup"><span data-stu-id="6d03b-119">Properties Supported When Specifying a Callback</span></span>

<span data-ttu-id="6d03b-120">Ao especificar um retorno de chamada, as propriedades a seguir podem ser anotadas.</span><span class="sxs-lookup"><span data-stu-id="6d03b-120">When specifying a callback, the following properties can be annotated.</span></span> <span data-ttu-id="6d03b-121">Atualmente, essas propriedades não podem ser anotadas diretamente, especificando um valor.</span><span class="sxs-lookup"><span data-stu-id="6d03b-121">Currently these properties cannot be annotated directly by specifying a value.</span></span>



| <span data-ttu-id="6d03b-122">Propriedade</span><span class="sxs-lookup"><span data-stu-id="6d03b-122">Property</span></span>                      | <span data-ttu-id="6d03b-123">Tipo</span><span class="sxs-lookup"><span data-stu-id="6d03b-123">Type</span></span>                                                             |
|-------------------------------|------------------------------------------------------------------|
| <span data-ttu-id="6d03b-124">\_nome da ACC de Propid \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-124">PROPID\_ACC\_NAME</span></span>             | <span data-ttu-id="6d03b-125">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="6d03b-125">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="6d03b-126">\_Descrição da ACC de Propid \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-126">PROPID\_ACC\_DESCRIPTION</span></span>      | <span data-ttu-id="6d03b-127">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="6d03b-127">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="6d03b-128">\_função de ACC de Propid \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-128">PROPID\_ACC\_ROLE</span></span>             | <span data-ttu-id="6d03b-129">\_I4 VT</span><span class="sxs-lookup"><span data-stu-id="6d03b-129">VT\_I4</span></span>                                                           |
| <span data-ttu-id="6d03b-130">\_estado de ACC de Propid \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-130">PROPID\_ACC\_STATE</span></span>            | <span data-ttu-id="6d03b-131">\_I4 VT</span><span class="sxs-lookup"><span data-stu-id="6d03b-131">VT\_I4</span></span>                                                           |
| <span data-ttu-id="6d03b-132">\_ajuda de ACC de Propid \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-132">PROPID\_ACC\_HELP</span></span>             | <span data-ttu-id="6d03b-133">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="6d03b-133">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="6d03b-134">PROPID \_ ACC \_ KEYBOARDSHORTCUT</span><span class="sxs-lookup"><span data-stu-id="6d03b-134">PROPID\_ACC\_KEYBOARDSHORTCUT</span></span> | <span data-ttu-id="6d03b-135">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="6d03b-135">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="6d03b-136">PROPID \_ ACC \_ DEFAULTACTION</span><span class="sxs-lookup"><span data-stu-id="6d03b-136">PROPID\_ACC\_DEFAULTACTION</span></span>    | <span data-ttu-id="6d03b-137">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="6d03b-137">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="6d03b-138">PROPID \_ ACC \_ VALUEMAP</span><span class="sxs-lookup"><span data-stu-id="6d03b-138">PROPID\_ACC\_VALUEMAP</span></span>         | <span data-ttu-id="6d03b-139">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="6d03b-139">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="6d03b-140">PROPID \_ ACC \_ ROLEMAP</span><span class="sxs-lookup"><span data-stu-id="6d03b-140">PROPID\_ACC\_ROLEMAP</span></span>          | <span data-ttu-id="6d03b-141">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="6d03b-141">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="6d03b-142">PROPID \_ ACC \_ STATEMAP</span><span class="sxs-lookup"><span data-stu-id="6d03b-142">PROPID\_ACC\_STATEMAP</span></span>         | <span data-ttu-id="6d03b-143">VT \_ BSTR</span><span class="sxs-lookup"><span data-stu-id="6d03b-143">VT\_BSTR</span></span>                                                         |
| <span data-ttu-id="6d03b-144">foco do PROPID \_ ACC \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-144">PROPID\_ACC\_FOCUS</span></span>            | <span data-ttu-id="6d03b-145">expedição de VT \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-145">VT\_DISPATCH</span></span><br/> <span data-ttu-id="6d03b-146">\_I4 VT</span><span class="sxs-lookup"><span data-stu-id="6d03b-146">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="6d03b-147">\_seleção de ACC de Propid \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-147">PROPID\_ACC\_SELECTION</span></span>        | <span data-ttu-id="6d03b-148">expedição de VT \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-148">VT\_DISPATCH</span></span><br/> <span data-ttu-id="6d03b-149">\_I4 VT</span><span class="sxs-lookup"><span data-stu-id="6d03b-149">VT\_I4</span></span><br/> <span data-ttu-id="6d03b-150">VT \_ desconhecido</span><span class="sxs-lookup"><span data-stu-id="6d03b-150">VT\_UNKNOWN</span></span><br/> |
| <span data-ttu-id="6d03b-151">\_pai de ACC de Propid \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-151">PROPID\_ACC\_PARENT</span></span>           | <span data-ttu-id="6d03b-152">expedição de VT \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-152">VT\_DISPATCH</span></span>                                                     |
| <span data-ttu-id="6d03b-153">\_NAV ACC do Propid \_ \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-153">PROPID\_ACC\_NAV\_UP</span></span>          | <span data-ttu-id="6d03b-154">expedição de VT \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-154">VT\_DISPATCH</span></span><br/> <span data-ttu-id="6d03b-155">\_I4 VT</span><span class="sxs-lookup"><span data-stu-id="6d03b-155">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="6d03b-156">navegação do PROPID \_ ACC \_ \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-156">PROPID\_ACC\_NAV\_DOWN</span></span>        | <span data-ttu-id="6d03b-157">expedição de VT \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-157">VT\_DISPATCH</span></span><br/> <span data-ttu-id="6d03b-158">\_I4 VT</span><span class="sxs-lookup"><span data-stu-id="6d03b-158">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="6d03b-159">navegação do PROPID \_ ACC \_ \_ à esquerda</span><span class="sxs-lookup"><span data-stu-id="6d03b-159">PROPID\_ACC\_NAV\_LEFT</span></span>        | <span data-ttu-id="6d03b-160">expedição de VT \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-160">VT\_DISPATCH</span></span><br/> <span data-ttu-id="6d03b-161">\_I4 VT</span><span class="sxs-lookup"><span data-stu-id="6d03b-161">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="6d03b-162">\_ \_ navegação do Propid ACC \_ direita</span><span class="sxs-lookup"><span data-stu-id="6d03b-162">PROPID\_ACC\_NAV\_RIGHT</span></span>       | <span data-ttu-id="6d03b-163">expedição de VT \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-163">VT\_DISPATCH</span></span><br/> <span data-ttu-id="6d03b-164">\_I4 VT</span><span class="sxs-lookup"><span data-stu-id="6d03b-164">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="6d03b-165">\_ \_ navegação \_ anterior do Propid ACC</span><span class="sxs-lookup"><span data-stu-id="6d03b-165">PROPID\_ACC\_NAV\_PREV</span></span>        | <span data-ttu-id="6d03b-166">expedição de VT \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-166">VT\_DISPATCH</span></span><br/> <span data-ttu-id="6d03b-167">\_I4 VT</span><span class="sxs-lookup"><span data-stu-id="6d03b-167">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="6d03b-168">PROPID \_ ACC da \_ NAV \_ Next</span><span class="sxs-lookup"><span data-stu-id="6d03b-168">PROPID\_ACC\_NAV\_NEXT</span></span>        | <span data-ttu-id="6d03b-169">expedição de VT \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-169">VT\_DISPATCH</span></span><br/> <span data-ttu-id="6d03b-170">\_I4 VT</span><span class="sxs-lookup"><span data-stu-id="6d03b-170">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="6d03b-171">PROPID \_ ACC \_ NAV \_ FIRSTCHILD</span><span class="sxs-lookup"><span data-stu-id="6d03b-171">PROPID\_ACC\_NAV\_FIRSTCHILD</span></span>  | <span data-ttu-id="6d03b-172">expedição de VT \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-172">VT\_DISPATCH</span></span><br/> <span data-ttu-id="6d03b-173">\_I4 VT</span><span class="sxs-lookup"><span data-stu-id="6d03b-173">VT\_I4</span></span><br/>                        |
| <span data-ttu-id="6d03b-174">PROPID \_ ACC \_ NAV \_ LASTCHILD</span><span class="sxs-lookup"><span data-stu-id="6d03b-174">PROPID\_ACC\_NAV\_LASTCHILD</span></span>   | <span data-ttu-id="6d03b-175">expedição de VT \_</span><span class="sxs-lookup"><span data-stu-id="6d03b-175">VT\_DISPATCH</span></span><br/> <span data-ttu-id="6d03b-176">\_I4 VT</span><span class="sxs-lookup"><span data-stu-id="6d03b-176">VT\_I4</span></span><br/>                        |



 

 

