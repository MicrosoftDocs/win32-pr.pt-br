---
title: Noções básicas sobre problemas de dimensionamento de tela
description: O Windows Vista e versões posteriores do sistema operacional permitem que os usuários alterem a configuração de pontos por polegada (DPI) para que a maioria dos elementos da interface do usuário na tela pareçam maiores.
ms.assetid: 27dc49e7-2466-4ea3-a6d9-5ea86d6b4c60
keywords:
- clientes, dimensionamento de tela de automação da interface do usuário
- clientes, dimensionamento de tela
- clientes, dimensionando
- Automação da interface do usuário, dimensionamento de tela
- Automação da interface do usuário, dimensionamento
- dimensionamento de tela
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 05d790ee7747f258847cd23aea8bbbe8c25813fe
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104366522"
---
# <a name="understanding-screen-scaling-issues"></a><span data-ttu-id="25880-109">Noções básicas sobre problemas de dimensionamento de tela</span><span class="sxs-lookup"><span data-stu-id="25880-109">Understanding Screen Scaling Issues</span></span>

<span data-ttu-id="25880-110">O Windows Vista e versões posteriores do sistema operacional permitem que os usuários alterem a configuração de pontos por polegada (DPI) para que a maioria dos elementos da interface do usuário na tela pareçam maiores.</span><span class="sxs-lookup"><span data-stu-id="25880-110">Windows Vista and later versions of the operating system enable users to change the dots per inch (dpi) setting so that most UI elements on the screen appear larger.</span></span> <span data-ttu-id="25880-111">Em versões anteriores do Windows, o dimensionamento precisava ser implementado por aplicativos.</span><span class="sxs-lookup"><span data-stu-id="25880-111">In earlier versions of Windows, the scaling had to be implemented by applications.</span></span> <span data-ttu-id="25880-112">No Windows Vista e posterior, o Gerenciador de Janelas da Área de Trabalho (DWM) executa o dimensionamento padrão para todos os aplicativos que não manipulam seu próprio dimensionamento.</span><span class="sxs-lookup"><span data-stu-id="25880-112">In Windows Vista and later, the Desktop Window Manager (DWM) performs default scaling for all applications that do not handle their own scaling.</span></span> <span data-ttu-id="25880-113">Os aplicativos cliente de automação da interface do usuário da Microsoft devem levar esse recurso em conta.</span><span class="sxs-lookup"><span data-stu-id="25880-113">Microsoft UI Automation client applications must take this feature into account.</span></span>

<span data-ttu-id="25880-114">Este tópico contém as seguintes seções:</span><span class="sxs-lookup"><span data-stu-id="25880-114">This topic contains the following sections:</span></span>

-   [<span data-ttu-id="25880-115">Dimensionamento no Windows Vista e posterior</span><span class="sxs-lookup"><span data-stu-id="25880-115">Scaling in Windows Vista and Later</span></span>](#scaling-in-windows-vista-and-later)
-   [<span data-ttu-id="25880-116">Dimensionamento em clientes de automação da interface do usuário</span><span class="sxs-lookup"><span data-stu-id="25880-116">Scaling in UI Automation Clients</span></span>](#scaling-in-ui-automation-clients)

## <a name="scaling-in-windows-vista-and-later"></a><span data-ttu-id="25880-117">Dimensionamento no Windows Vista e posterior</span><span class="sxs-lookup"><span data-stu-id="25880-117">Scaling in Windows Vista and Later</span></span>

<span data-ttu-id="25880-118">A configuração padrão de DPI é 96, o que significa que 96 pixels ocupam uma largura ou altura de uma polegada de conceito.</span><span class="sxs-lookup"><span data-stu-id="25880-118">The default dpi setting is 96, which means that 96 pixels occupy a width or height of one notional inch.</span></span> <span data-ttu-id="25880-119">A medida exata de uma "polegada" depende do tamanho e da resolução física do monitor.</span><span class="sxs-lookup"><span data-stu-id="25880-119">The exact measure of an "inch" depends on the size and physical resolution of the monitor.</span></span> <span data-ttu-id="25880-120">Por exemplo, em um monitor de 12 polegadas de largura, com uma resolução horizontal de 1280 pixels, uma linha horizontal de 96 pixels se estende cerca de 9/10 de uma polegada.</span><span class="sxs-lookup"><span data-stu-id="25880-120">For example, on a monitor 12 inches wide, at a horizontal resolution of 1280 pixels, a horizontal line of 96 pixels extends about 9/10 of an inch.</span></span>

<span data-ttu-id="25880-121">Alterar a configuração de DPI não é o mesmo que alterar a resolução da tela.</span><span class="sxs-lookup"><span data-stu-id="25880-121">Changing the dpi setting is not the same as changing the screen resolution.</span></span> <span data-ttu-id="25880-122">Com o ajuste de DPI, o número de pixels físicos na tela permanece o mesmo.</span><span class="sxs-lookup"><span data-stu-id="25880-122">With dpi scaling, the number of physical pixels on the screen remains the same.</span></span> <span data-ttu-id="25880-123">No entanto, o dimensionamento é aplicado ao tamanho e ao local dos elementos da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="25880-123">However, scaling is applied to the size and location of UI elements.</span></span> <span data-ttu-id="25880-124">Esse dimensionamento pode ser executado automaticamente pelo DWM para a área de trabalho e para aplicativos que não pedem explicitamente que não sejam dimensionados.</span><span class="sxs-lookup"><span data-stu-id="25880-124">This scaling can be performed automatically by the DWM for the desktop and for applications that do not explicitly ask not to be scaled.</span></span>

<span data-ttu-id="25880-125">Em vigor, quando o usuário define o fator de escala como 120 dpi, uma polegada vertical ou horizontal na tela se torna maior em 25%.</span><span class="sxs-lookup"><span data-stu-id="25880-125">In effect, when the user sets the scale factor to 120 dpi, a vertical or horizontal inch on the screen becomes bigger by 25 percent.</span></span> <span data-ttu-id="25880-126">Todas as dimensões são dimensionadas de acordo.</span><span class="sxs-lookup"><span data-stu-id="25880-126">All dimensions are scaled accordingly.</span></span> <span data-ttu-id="25880-127">O deslocamento de uma janela de aplicativo da borda superior e da borda esquerda da tela aumenta em 25%.</span><span class="sxs-lookup"><span data-stu-id="25880-127">The offset of an application window from the top edge and left edge of the screen increases by 25 percent.</span></span> <span data-ttu-id="25880-128">Se o dimensionamento de aplicativos estiver habilitado e o aplicativo não reconhecer dpi, o tamanho da janela aumentará na mesma proporção, juntamente com os deslocamentos e tamanhos de todos os elementos da interface do usuário que ele contém.</span><span class="sxs-lookup"><span data-stu-id="25880-128">If application scaling is enabled and the application is not dpi-aware, the size of the window increases in the same proportion, along with the offsets and sizes of all UI elements it contains.</span></span>

> [!Note]  
> <span data-ttu-id="25880-129">Por padrão, o DWM não executa o dimensionamento para aplicativos que não reconhecem dpi quando o usuário define o DPI como 120, mas realiza o dimensionamento quando o DPI é definido como um valor personalizado de 144 ou superior.</span><span class="sxs-lookup"><span data-stu-id="25880-129">By default, the DWM does not perform scaling for non-dpi-aware applications when the user sets the dpi to 120, but does perform scaling when the dpi is set to a custom value of 144 or higher.</span></span> <span data-ttu-id="25880-130">No entanto, o usuário pode substituir o comportamento padrão.</span><span class="sxs-lookup"><span data-stu-id="25880-130">However, the user can override the default behavior.</span></span>

 

<span data-ttu-id="25880-131">O dimensionamento de tela cria novos desafios para aplicativos que se preocupam de qualquer forma com coordenadas de tela.</span><span class="sxs-lookup"><span data-stu-id="25880-131">Screen scaling creates new challenges for applications that are concerned in any way with screen coordinates.</span></span> <span data-ttu-id="25880-132">A tela agora contém dois sistemas de coordenadas: físico e lógico.</span><span class="sxs-lookup"><span data-stu-id="25880-132">The screen now contains two coordinate systems: physical and logical.</span></span> <span data-ttu-id="25880-133">As coordenadas físicas de um ponto são o deslocamento real em pixels do canto superior esquerdo do ponto de origem.</span><span class="sxs-lookup"><span data-stu-id="25880-133">The physical coordinates of a point are the actual offset in pixels from the upper-left of the origin point.</span></span> <span data-ttu-id="25880-134">As coordenadas lógicas são os deslocamentos como seriam se os próprios pixels fossem dimensionados.</span><span class="sxs-lookup"><span data-stu-id="25880-134">The logical coordinates are the offsets as they would be if the pixels themselves were scaled.</span></span>

<span data-ttu-id="25880-135">Suponha que você projete uma caixa de diálogo com um botão nas coordenadas (100, 48).</span><span class="sxs-lookup"><span data-stu-id="25880-135">Suppose you design a dialog box with a button at coordinates (100, 48).</span></span> <span data-ttu-id="25880-136">Quando essa caixa de diálogo é exibida no padrão de 96 dpi, o botão está localizado em coordenadas físicas de (100, 48).</span><span class="sxs-lookup"><span data-stu-id="25880-136">When this dialog box is displayed at the default 96 dpi, the button is located at physical coordinates of (100, 48).</span></span> <span data-ttu-id="25880-137">Em 120 dpi, ele está localizado em coordenadas físicas de (125, 60).</span><span class="sxs-lookup"><span data-stu-id="25880-137">At 120 dpi, it is located at physical coordinates of (125, 60).</span></span> <span data-ttu-id="25880-138">Mas as coordenadas lógicas são as mesmas em qualquer configuração de DPI: (100, 48).</span><span class="sxs-lookup"><span data-stu-id="25880-138">But the logical coordinates are the same at any dpi setting: (100, 48).</span></span>

<span data-ttu-id="25880-139">As coordenadas lógicas são importantes, pois tornam o comportamento do sistema operacional e dos aplicativos consistentes, independentemente da configuração de DPI.</span><span class="sxs-lookup"><span data-stu-id="25880-139">Logical coordinates are important, because they make the behavior of the operating system and applications consistent, regardless of the dpi setting.</span></span> <span data-ttu-id="25880-140">Por exemplo, normalmente, a função [**GetCursorPos**](/windows/desktop/api/winuser/nf-winuser-getcursorpos) retorna as coordenadas lógicas.</span><span class="sxs-lookup"><span data-stu-id="25880-140">For example, typically, the [**GetCursorPos**](/windows/desktop/api/winuser/nf-winuser-getcursorpos) function returns the logical coordinates.</span></span> <span data-ttu-id="25880-141">Se você mover o cursor sobre um elemento em uma caixa de diálogo, as mesmas coordenadas serão retornadas, independentemente da configuração de DPI.</span><span class="sxs-lookup"><span data-stu-id="25880-141">If you move the cursor over an element in a dialog box, the same coordinates are returned, regardless of the dpi setting.</span></span> <span data-ttu-id="25880-142">Se você desenhar um controle em (100, 100), ele será desenhado para essas coordenadas lógicas e ocupará a mesma posição relativa em qualquer configuração de DPI.</span><span class="sxs-lookup"><span data-stu-id="25880-142">If you draw a control at (100, 100), it is drawn to those logical coordinates, and will occupy the same relative position at any dpi setting.</span></span>

## <a name="scaling-in-ui-automation-clients"></a><span data-ttu-id="25880-143">Dimensionamento em clientes de automação da interface do usuário</span><span class="sxs-lookup"><span data-stu-id="25880-143">Scaling in UI Automation Clients</span></span>

<span data-ttu-id="25880-144">A API de automação da interface do usuário não usa coordenadas lógicas.</span><span class="sxs-lookup"><span data-stu-id="25880-144">The UI Automation API does not use logical coordinates.</span></span> <span data-ttu-id="25880-145">Os métodos e as propriedades a seguir retornam coordenadas físicas ou tomam coordenadas físicas como parâmetros.</span><span class="sxs-lookup"><span data-stu-id="25880-145">The following methods and properties return physical coordinates or take physical coordinates as parameters.</span></span>

-   [<span data-ttu-id="25880-146">**IUIAutomation::ElementFromPoint**</span><span class="sxs-lookup"><span data-stu-id="25880-146">**IUIAutomation::ElementFromPoint**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint)
-   [<span data-ttu-id="25880-147">**IUIAutomation::ElementFromPointBuildCache**</span><span class="sxs-lookup"><span data-stu-id="25880-147">**IUIAutomation::ElementFromPointBuildCache**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompointbuildcache)
-   [<span data-ttu-id="25880-148">**IUIAutomationElement::GetClickablePoint**</span><span class="sxs-lookup"><span data-stu-id="25880-148">**IUIAutomationElement::GetClickablePoint**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getclickablepoint)
-   [<span data-ttu-id="25880-149">**IUIAutomationElement::CurrentBoundingRectangle**</span><span class="sxs-lookup"><span data-stu-id="25880-149">**IUIAutomationElement::CurrentBoundingRectangle**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentboundingrectangle)
-   [<span data-ttu-id="25880-150">**IUIAutomationElement::CachedBoundingRectangle**</span><span class="sxs-lookup"><span data-stu-id="25880-150">**IUIAutomationElement::CachedBoundingRectangle**</span></span>](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_cachedboundingrectangle)
-   [<span data-ttu-id="25880-151">**IRawElementProviderFragment::BoundingRectangle**</span><span class="sxs-lookup"><span data-stu-id="25880-151">**IRawElementProviderFragment::BoundingRectangle**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-get_boundingrectangle)

<span data-ttu-id="25880-152">Por padrão, os aplicativos de automação da interface do usuário que estão sendo executados em um ambiente que não está definido como 96 DPI não obterão os resultados corretos desses métodos e propriedades.</span><span class="sxs-lookup"><span data-stu-id="25880-152">By default, UI Automation applications that are running in an environment that is not set to 96 dpi will not obtain correct results from these methods and properties.</span></span> <span data-ttu-id="25880-153">Por exemplo, como a posição do cursor está em coordenadas lógicas, o cliente não pode passar essas coordenadas para [**IUIAutomation:: ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) para obter o elemento que está sob o cursor.</span><span class="sxs-lookup"><span data-stu-id="25880-153">For example, because the cursor position is in logical coordinates, the client cannot pass these coordinates to [**IUIAutomation::ElementFromPoint**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompoint) to obtain the element that is under the cursor.</span></span> <span data-ttu-id="25880-154">Além disso, o aplicativo não será capaz de posicionar corretamente o Windows fora de sua área de cliente.</span><span class="sxs-lookup"><span data-stu-id="25880-154">In addition, the application will not be able to correctly place windows outside its client area.</span></span>

<span data-ttu-id="25880-155">A solução tem duas partes.</span><span class="sxs-lookup"><span data-stu-id="25880-155">The solution has two parts.</span></span>

<span data-ttu-id="25880-156">Primeiro, torne o reconhecimento de DPI do aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="25880-156">First, make the client application dpi-aware.</span></span> <span data-ttu-id="25880-157">Para fazer isso, chame a função [**SetProcessDPIAware**](/windows/desktop/api/winuser/nf-winuser-setprocessdpiaware) na inicialização.</span><span class="sxs-lookup"><span data-stu-id="25880-157">To do this, call the [**SetProcessDPIAware**](/windows/desktop/api/winuser/nf-winuser-setprocessdpiaware) function at startup.</span></span> <span data-ttu-id="25880-158">Essa função faz com que todo o processo reconheça o DPI, o que significa que todas as janelas que pertencem ao processo não são dimensionadas.</span><span class="sxs-lookup"><span data-stu-id="25880-158">This function makes the entire process dpi-aware, meaning that all windows that belong to the process are unscaled.</span></span>

<span data-ttu-id="25880-159">Em segundo lugar, para obter as coordenadas do cursor, chame a função [**GetPhysicalCursorPos**](/windows/desktop/api/winuser/nf-winuser-getphysicalcursorpos) .</span><span class="sxs-lookup"><span data-stu-id="25880-159">Second, to get cursor coordinates, call the [**GetPhysicalCursorPos**](/windows/desktop/api/winuser/nf-winuser-getphysicalcursorpos) function.</span></span>

 

 