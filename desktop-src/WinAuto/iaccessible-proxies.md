---
title: Proxies do IAccessible
description: Os proxies do IAccessible fornecem informações de acessibilidade padrão para elementos de interface do usuário padrão, menus de usuário e controles comuns de COMCTL e COMCTL32.
ms.assetid: 236c2064-de44-4021-8825-f1519312dbfc
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 53dcb4cae8980e4003d9915c6783e4ddb043a8c8
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104294240"
---
# <a name="iaccessible-proxies"></a><span data-ttu-id="f82c2-103">Proxies do IAccessible</span><span class="sxs-lookup"><span data-stu-id="f82c2-103">IAccessible Proxies</span></span>

<span data-ttu-id="f82c2-104">Os proxies do [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) fornecem informações de acessibilidade padrão para elementos da interface do usuário padrão: controles de usuários, menus de usuário e controles comuns de COMCTL e Comctl32.</span><span class="sxs-lookup"><span data-stu-id="f82c2-104">[**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) proxies provide default accessibility information for standard UI elements: USER controls, USER menus, and common controls from COMCTL and COMCTL32.</span></span> <span data-ttu-id="f82c2-105">Esse suporte padrão é exposto por meio de objetos do **IAccessible** criados por Oleacc.dll e fornece suporte ao Microsoft acessibilidade ativa sem trabalho adicional de desenvolvimento do servidor.</span><span class="sxs-lookup"><span data-stu-id="f82c2-105">This default support is exposed through **IAccessible** objects created by Oleacc.dll and delivers Microsoft Active Accessibility support without additional server development work.</span></span> <span data-ttu-id="f82c2-106">O servidor pode usar a [API de anotação dinâmica](dynamic-annotation-api.md) para modificar grande parte das informações expostas por Oleacc.dll, mas não tem controle total.</span><span class="sxs-lookup"><span data-stu-id="f82c2-106">The server can then use the [Dynamic Annotation API](dynamic-annotation-api.md) to modify much of the information exposed by Oleacc.dll, but it does not have complete control.</span></span>

## <a name="creating-a-proxy"></a><span data-ttu-id="f82c2-107">Criando um proxy</span><span class="sxs-lookup"><span data-stu-id="f82c2-107">Creating a Proxy</span></span>

<span data-ttu-id="f82c2-108">Para determinar se um elemento de interface do usuário dá suporte nativo à interface [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , Oleacc.dll envia a ela uma mensagem do [**WM \_ GetObject**](wm-getobject.md) .</span><span class="sxs-lookup"><span data-stu-id="f82c2-108">To determine whether a UI element natively supports the [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) interface, Oleacc.dll sends it a [**WM\_GETOBJECT**](wm-getobject.md) message.</span></span> <span data-ttu-id="f82c2-109">Um valor de retorno diferente de zero significa que o elemento suporta nativamente o Microsoft Acessibilidade Ativa e fornece seu próprio suporte de **IAccessible** .</span><span class="sxs-lookup"><span data-stu-id="f82c2-109">A nonzero return value means the element natively supports Microsoft Active Accessibility and provides its own **IAccessible** support.</span></span> <span data-ttu-id="f82c2-110">No entanto, se o valor de retorno for zero, Oleacc.dll fornecerá um objeto proxy para o elemento de interface do usuário e tentará retornar informações significativas em seu nome.</span><span class="sxs-lookup"><span data-stu-id="f82c2-110">However, if the return value is zero, Oleacc.dll provides a proxy object for the UI element and attempts to return meaningful information on its behalf.</span></span> <span data-ttu-id="f82c2-111">Para obter mais informações sobre o **WM \_ GetObject**, consulte [como o WM \_ GetObject funciona](how-wm-getobject-works.md).</span><span class="sxs-lookup"><span data-stu-id="f82c2-111">For more information about **WM\_GETOBJECT**, see [How WM\_GETOBJECT Works](how-wm-getobject-works.md).</span></span>

## <a name="what-information-is-exposed"></a><span data-ttu-id="f82c2-112">Quais informações são expostas</span><span class="sxs-lookup"><span data-stu-id="f82c2-112">What Information Is Exposed</span></span>

<span data-ttu-id="f82c2-113">Oleacc.dll usa o nome de classe do Windows do elemento de interface do usuário para determinar quais informações devem ser expostas para cada uma de suas propriedades [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) e como coletar essas informações.</span><span class="sxs-lookup"><span data-stu-id="f82c2-113">Oleacc.dll uses the UI element's Windows class name to determine what information should be exposed for each of its [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) properties and how to collect that information.</span></span> <span data-ttu-id="f82c2-114">Por exemplo, Oleacc.dll chama a função [**GetWindowText**](/windows/desktop/api/winuser/nf-winuser-getwindowtexta) para recuperar a propriedade [**Name**](name-property.md) para um botão Push padrão, mas chama essa mesma função para recuperar a propriedade [**Value**](value-property.md) de um controle de edição padrão.</span><span class="sxs-lookup"><span data-stu-id="f82c2-114">For example, Oleacc.dll calls the [**GetWindowText**](/windows/desktop/api/winuser/nf-winuser-getwindowtexta) function to retrieve the [**Name**](name-property.md) property for a standard push button, but calls this same function to retrieve the [**Value**](value-property.md) property for a standard edit control.</span></span> <span data-ttu-id="f82c2-115">Na verdade, Oleacc.dll está mapeando cada método **IAccessible** para um Microsoft Win32 ou uma mensagem específica de controle ou chamada de função.</span><span class="sxs-lookup"><span data-stu-id="f82c2-115">In effect, Oleacc.dll is mapping each **IAccessible** method to an appropriate Microsoft Win32 or control-specific message or function call.</span></span> <span data-ttu-id="f82c2-116">Usando esse uso especial com base no nome de classe, ele pode retornar informações significativas por meio de proxies do **IAccessible** sem qualquer suporte de acessibilidade ativa da Microsoft no servidor.</span><span class="sxs-lookup"><span data-stu-id="f82c2-116">By using this class name-based special casing, it can return meaningful information through **IAccessible** proxies without any Microsoft Active Accessibility support in the server.</span></span>

<span data-ttu-id="f82c2-117">Aplicativos criados com elementos de interface do usuário padrão normalmente recebem suporte completo do Microsoft Acessibilidade Ativa sem trabalho de desenvolvimento adicional.</span><span class="sxs-lookup"><span data-stu-id="f82c2-117">Applications built with standard UI elements typically get full Microsoft Active Accessibility support without additional development work.</span></span> <span data-ttu-id="f82c2-118">As exceções a essa regra são controles que foram subclasses, que não armazenam suas próprias cadeias de caracteres (ausência do estilo **HASSTRINGS** ) ou que são desenhadas pelo proprietário.</span><span class="sxs-lookup"><span data-stu-id="f82c2-118">The exceptions to this rule are controls that have been subclassed, that do not store their own strings (absence of the **HASSTRINGS** style), or that are owner-drawn.</span></span> <span data-ttu-id="f82c2-119">Nesses casos, Oleacc.dll não pode coletar as informações necessárias porque as informações são armazenadas fora do controle.</span><span class="sxs-lookup"><span data-stu-id="f82c2-119">In these cases, Oleacc.dll cannot gather the information it needs because the information is stored outside the control.</span></span> <span data-ttu-id="f82c2-120">No entanto, em muitos desses cenários, soluções alternativas estabelecidas ou o uso de anotação dinâmica, permita que o servidor cooperasse com os proxies fornecidos pelo Oleacc.dll.</span><span class="sxs-lookup"><span data-stu-id="f82c2-120">However in many of these scenarios, established workarounds, or the use of Dynamic Annotation, allow the server to cooperate with the proxies provided by Oleacc.dll.</span></span>

## <a name="generic-proxy-objects"></a><span data-ttu-id="f82c2-121">Objetos de proxy genéricos</span><span class="sxs-lookup"><span data-stu-id="f82c2-121">Generic Proxy Objects</span></span>

<span data-ttu-id="f82c2-122">Se Oleacc.dll não reconhecer o nome de classe do elemento de interface do usuário, ele criará um proxy genérico que expõe o máximo de informações possível.</span><span class="sxs-lookup"><span data-stu-id="f82c2-122">If Oleacc.dll does not recognize the class name of the UI element, it creates a generic proxy that exposes as much information as possible.</span></span> <span data-ttu-id="f82c2-123">No máximo, isso inclui o retângulo delimitador do objeto, o objeto pai, o nome (do [**WM \_ gettext**](/windows/desktop/winmsg/wm-gettext)) e quaisquer filhos na hierarquia da janela.</span><span class="sxs-lookup"><span data-stu-id="f82c2-123">At most, this includes the object's bounding rectangle, parent object, name (from [**WM\_GETTEXT**](/windows/desktop/winmsg/wm-gettext)), and any children in the window hierarchy.</span></span>

 

 