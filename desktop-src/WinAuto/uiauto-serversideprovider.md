---
title: Implementar um provedor de automação de interface do usuário Server-Side
description: Este tópico descreve como implementar um provedor de automação de interface do usuário da Microsoft no lado do servidor para um controle personalizado escrito em C++.
ms.assetid: c3a919b2-8b8c-4dde-ad71-587f3845a9f5
keywords:
- Automação da interface do usuário, implementação do provedor do lado do servidor
- Automação da interface do usuário, implementação do provedor
- Automação da interface do usuário, Implementando provedores do lado do servidor
- Automação da interface do usuário, Implementando provedores
- provedores do lado do servidor, implementando
- provedores do lado do servidor, interfaces
- provedores do lado do servidor, valores de propriedade
- provedores do lado do servidor, eventos
- provedores do lado do servidor, atribuindo um novo pai
- eventos, provedores do lado do servidor
- interfaces, provedores do lado do servidor
- provedores, implementando
- Implementando provedores do lado do servidor
- Implementando provedores
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e7fafbb9d03a25eb2e4713330c0622c25d17f9ff
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "105759104"
---
# <a name="implement-a-server-side-ui-automation-provider"></a><span data-ttu-id="f4c26-117">Implementar um provedor de automação de interface do usuário Server-Side</span><span class="sxs-lookup"><span data-stu-id="f4c26-117">Implement a Server-Side UI Automation Provider</span></span>

<span data-ttu-id="f4c26-118">Este tópico descreve como implementar um provedor de automação de interface do usuário da Microsoft no lado do servidor para um controle personalizado escrito em C++.</span><span class="sxs-lookup"><span data-stu-id="f4c26-118">This topic describes how to implement a server-side Microsoft UI Automation provider for a custom control written in C++.</span></span> <span data-ttu-id="f4c26-119">Ele contém as seções a seguir:</span><span class="sxs-lookup"><span data-stu-id="f4c26-119">It contains the following sections:</span></span>

-   [<span data-ttu-id="f4c26-120">Interfaces de provedor</span><span class="sxs-lookup"><span data-stu-id="f4c26-120">Provider Interfaces</span></span>](#provider-interfaces)
-   [<span data-ttu-id="f4c26-121">Funcionalidade necessária para provedores de automação de interface do usuário</span><span class="sxs-lookup"><span data-stu-id="f4c26-121">Required Functionality for UI Automation Providers</span></span>](#required-functionality-for-ui-automation-providers)
-   [<span data-ttu-id="f4c26-122">Valores de propriedade</span><span class="sxs-lookup"><span data-stu-id="f4c26-122">Property Values</span></span>](#property-values)
-   [<span data-ttu-id="f4c26-123">Eventos de provedores</span><span class="sxs-lookup"><span data-stu-id="f4c26-123">Events from Providers</span></span>](#events-from-providers)
-   [<span data-ttu-id="f4c26-124">Navegação do provedor</span><span class="sxs-lookup"><span data-stu-id="f4c26-124">Provider Navigation</span></span>](#provider-navigation)
-   [<span data-ttu-id="f4c26-125">Atribuindo um novo pai</span><span class="sxs-lookup"><span data-stu-id="f4c26-125">Assigning a New Parent</span></span>](#assigning-a-new-parent)
-   [<span data-ttu-id="f4c26-126">Reposicionamento do provedor</span><span class="sxs-lookup"><span data-stu-id="f4c26-126">Provider Repositioning</span></span>](#provider-repositioning)
-   [<span data-ttu-id="f4c26-127">Desconectando provedores</span><span class="sxs-lookup"><span data-stu-id="f4c26-127">Disconnecting Providers</span></span>](#disconnecting-providers)
-   [<span data-ttu-id="f4c26-128">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="f4c26-128">Related topics</span></span>](#related-topics)

<span data-ttu-id="f4c26-129">Para obter exemplos de código que mostram como implementar provedores do lado do servidor, consulte os [Tópicos de instruções para provedores de automação da interface do usuário](uiauto-howto-topics-for-uiautomation-providers.md).</span><span class="sxs-lookup"><span data-stu-id="f4c26-129">For code examples that show how to implement server-side providers, see [How-To Topics for UI Automation Providers](uiauto-howto-topics-for-uiautomation-providers.md).</span></span>

## <a name="provider-interfaces"></a><span data-ttu-id="f4c26-130">Interfaces de provedor</span><span class="sxs-lookup"><span data-stu-id="f4c26-130">Provider Interfaces</span></span>

<span data-ttu-id="f4c26-131">As seguintes interfaces de Component Object Model (COM) fornecem funcionalidade para controles personalizados.</span><span class="sxs-lookup"><span data-stu-id="f4c26-131">The following Component Object Model (COM) interfaces provide functionality for custom controls.</span></span> <span data-ttu-id="f4c26-132">Para fornecer funcionalidade básica, cada provedor de automação de interface do usuário deve implementar pelo menos a interface [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) .</span><span class="sxs-lookup"><span data-stu-id="f4c26-132">To provide basic functionality, every UI Automation provider must implement at least the [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple) interface.</span></span> <span data-ttu-id="f4c26-133">As interfaces [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) e [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) são opcionais, mas devem ser implementadas para elementos em um controle complexo para fornecer funcionalidade adicional.</span><span class="sxs-lookup"><span data-stu-id="f4c26-133">The [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) and [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) interfaces are optional, but should be implemented for elements in a complex control to provide additional functionality.</span></span>



| <span data-ttu-id="f4c26-134">Interface</span><span class="sxs-lookup"><span data-stu-id="f4c26-134">Interface</span></span>                                                                         | <span data-ttu-id="f4c26-135">Descrição</span><span class="sxs-lookup"><span data-stu-id="f4c26-135">Description</span></span>                                                                                                                                                                   |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="f4c26-136">**IRawElementProviderSimple**</span><span class="sxs-lookup"><span data-stu-id="f4c26-136">**IRawElementProviderSimple**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple)             | <span data-ttu-id="f4c26-137">Fornece funcionalidade básica para um controle hospedado em uma janela, incluindo suporte para padrões de controle e propriedades.</span><span class="sxs-lookup"><span data-stu-id="f4c26-137">Provides basic functionality for a control hosted in a window, including support for control patterns and properties.</span></span>                                                         |
| [<span data-ttu-id="f4c26-138">**IRawElementProviderFragment**</span><span class="sxs-lookup"><span data-stu-id="f4c26-138">**IRawElementProviderFragment**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment)         | <span data-ttu-id="f4c26-139">Adiciona a funcionalidade para um elemento em um controle complexo, incluindo navegar no fragmento, definir o foco e retornar o retângulo delimitador do elemento.</span><span class="sxs-lookup"><span data-stu-id="f4c26-139">Adds functionality for an element in a complex control, including navigating in the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>             |
| [<span data-ttu-id="f4c26-140">**IRawElementProviderFragmentRoot**</span><span class="sxs-lookup"><span data-stu-id="f4c26-140">**IRawElementProviderFragmentRoot**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot) | <span data-ttu-id="f4c26-141">Adiciona a funcionalidade para o elemento raiz em um controle complexo, incluindo a localização de um elemento filho em coordenadas especificadas e a definição do estado de foco para todo o controle.</span><span class="sxs-lookup"><span data-stu-id="f4c26-141">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span> |



 

> [!Note]  
> <span data-ttu-id="f4c26-142">Na API de automação da interface do usuário para código gerenciado, essas interfaces formam uma hierarquia de herança.</span><span class="sxs-lookup"><span data-stu-id="f4c26-142">In the UI Automation API for managed code, these interfaces form an inheritance hierarchy.</span></span> <span data-ttu-id="f4c26-143">Esse não é o caso em C++, onde as interfaces são completamente separadas.</span><span class="sxs-lookup"><span data-stu-id="f4c26-143">This is not the case in C++, where the interfaces are completely separate.</span></span>

 

<span data-ttu-id="f4c26-144">As interfaces a seguir fornecem funcionalidade adicional, mas a implementação é opcional.</span><span class="sxs-lookup"><span data-stu-id="f4c26-144">The following interfaces provide added functionality but implementation is optional.</span></span>



| <span data-ttu-id="f4c26-145">Interface</span><span class="sxs-lookup"><span data-stu-id="f4c26-145">Interface</span></span>                                                                         | <span data-ttu-id="f4c26-146">Descrição</span><span class="sxs-lookup"><span data-stu-id="f4c26-146">Description</span></span>                                                                             |
|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| [<span data-ttu-id="f4c26-147">**IRawElementProviderAdviseEvents**</span><span class="sxs-lookup"><span data-stu-id="f4c26-147">**IRawElementProviderAdviseEvents**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovideradviseevents) | <span data-ttu-id="f4c26-148">Permite que o provedor rastreie solicitações de eventos.</span><span class="sxs-lookup"><span data-stu-id="f4c26-148">Enables the provider to track requests for events.</span></span>                                      |
| [<span data-ttu-id="f4c26-149">**IRawElementProviderHwndOverride**</span><span class="sxs-lookup"><span data-stu-id="f4c26-149">**IRawElementProviderHwndOverride**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) | <span data-ttu-id="f4c26-150">Habilita a reposicionamento de elementos baseados em janela na árvore de automação da interface do usuário de um fragmento.</span><span class="sxs-lookup"><span data-stu-id="f4c26-150">Enables repositioning of window-based elements in the UI Automation tree of a fragment.</span></span> |



 

## <a name="required-functionality-for-ui-automation-providers"></a><span data-ttu-id="f4c26-151">Funcionalidade necessária para provedores de automação de interface do usuário</span><span class="sxs-lookup"><span data-stu-id="f4c26-151">Required Functionality for UI Automation Providers</span></span>

<span data-ttu-id="f4c26-152">Para se comunicar com a automação da interface do usuário, seu controle deve implementar as principais áreas de funcionalidade descritas na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="f4c26-152">To communicate with UI Automation, your control must implement the main areas of functionality described in the following table.</span></span>



| <span data-ttu-id="f4c26-153">Funcionalidade</span><span class="sxs-lookup"><span data-stu-id="f4c26-153">Functionality</span></span>                                              | <span data-ttu-id="f4c26-154">Implementação</span><span class="sxs-lookup"><span data-stu-id="f4c26-154">Implementation</span></span>                                                                                                                                                                                                                                                                                                |
|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="f4c26-155">Expor o provedor à automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="f4c26-155">Expose the provider to UI Automation.</span></span>                      | <span data-ttu-id="f4c26-156">Em resposta a uma mensagem do [**WM \_ GetObject**](wm-getobject.md) enviada para a janela de controle, retorne o objeto que implementa [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple).</span><span class="sxs-lookup"><span data-stu-id="f4c26-156">In response to a [**WM\_GETOBJECT**](wm-getobject.md) message sent to the control window, return the object that implements [**IRawElementProviderSimple**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple).</span></span> <span data-ttu-id="f4c26-157">Para fragmentos, esse deve ser o provedor para a raiz do fragmento.</span><span class="sxs-lookup"><span data-stu-id="f4c26-157">For fragments, this must be the provider for the fragment root.</span></span>                                           |
| <span data-ttu-id="f4c26-158">Forneça valores de propriedade.</span><span class="sxs-lookup"><span data-stu-id="f4c26-158">Provide property values.</span></span>                                   | <span data-ttu-id="f4c26-159">Implemente [**IRawElementProviderSimple:: GetPropertyValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpropertyvalue) para fornecer ou substituir valores.</span><span class="sxs-lookup"><span data-stu-id="f4c26-159">Implement [**IRawElementProviderSimple::GetPropertyValue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpropertyvalue) to provide or override values.</span></span>                                                                                                                                                             |
| <span data-ttu-id="f4c26-160">Habilite o cliente para interagir com o controle.</span><span class="sxs-lookup"><span data-stu-id="f4c26-160">Enable the client to interact with the control.</span></span>            | <span data-ttu-id="f4c26-161">Implemente interfaces que dão suporte a cada padrão de controle apropriado, como [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider).</span><span class="sxs-lookup"><span data-stu-id="f4c26-161">Implement interfaces that support each appropriate control pattern, such as [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider).</span></span> <span data-ttu-id="f4c26-162">Retorne esses provedores de padrão de controle em sua implementação de [**IRawElementProviderSimple:: GetPatternProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpatternprovider).</span><span class="sxs-lookup"><span data-stu-id="f4c26-162">Return these control pattern providers in your implementation of [**IRawElementProviderSimple::GetPatternProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-getpatternprovider).</span></span> |
| <span data-ttu-id="f4c26-163">Gerar eventos.</span><span class="sxs-lookup"><span data-stu-id="f4c26-163">Raise events.</span></span>                                              | <span data-ttu-id="f4c26-164">[**UiaRaiseAutomationEvent**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent), métodos de [**IProxyProviderWinEventSink**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iproxyproviderwineventsink).</span><span class="sxs-lookup"><span data-stu-id="f4c26-164">[**UiaRaiseAutomationEvent**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent), methods of [**IProxyProviderWinEventSink**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iproxyproviderwineventsink).</span></span>                                                                                                                                                |
| <span data-ttu-id="f4c26-165">Habilitar navegação e foco em um fragmento.</span><span class="sxs-lookup"><span data-stu-id="f4c26-165">Enable navigating and focusing in a fragment.</span></span>              | <span data-ttu-id="f4c26-166">Implemente [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) para cada elemento dentro do fragmento.</span><span class="sxs-lookup"><span data-stu-id="f4c26-166">Implement [**IRawElementProviderFragment**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragment) for each element within the fragment.</span></span> <span data-ttu-id="f4c26-167">Não é necessário para elementos que não fazem parte de um fragmento.</span><span class="sxs-lookup"><span data-stu-id="f4c26-167">Not necessary for elements that are not part of a fragment.</span></span>                                                                                                                         |
| <span data-ttu-id="f4c26-168">Habilitar foco e localização de elementos filho em um fragmento.</span><span class="sxs-lookup"><span data-stu-id="f4c26-168">Enable focusing and locating child elements in a fragment.</span></span> | <span data-ttu-id="f4c26-169">Implemente [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot).</span><span class="sxs-lookup"><span data-stu-id="f4c26-169">Implement [**IRawElementProviderFragmentRoot**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderfragmentroot).</span></span> <span data-ttu-id="f4c26-170">Não é necessário para elementos que não são raízes de fragmento.</span><span class="sxs-lookup"><span data-stu-id="f4c26-170">Not necessary for elements that are not fragment roots.</span></span>                                                                                                                                                          |



 

## <a name="property-values"></a><span data-ttu-id="f4c26-171">Valores da propriedade</span><span class="sxs-lookup"><span data-stu-id="f4c26-171">Property Values</span></span>

<span data-ttu-id="f4c26-172">Provedores de automação de interface do usuário para controles personalizados devem dar suporte a determinadas propriedades que podem ser usadas pela automação da interface do usuário e por aplicativos cliente.</span><span class="sxs-lookup"><span data-stu-id="f4c26-172">UI Automation providers for custom controls must support certain properties that can be used by UI Automation and by client applications.</span></span> <span data-ttu-id="f4c26-173">Para elementos que são hospedados no Windows, a automação da interface do usuário pode recuperar algumas propriedades do provedor de janela padrão, mas deve obter outras do provedor personalizado.</span><span class="sxs-lookup"><span data-stu-id="f4c26-173">For elements that are hosted in windows, UI Automation can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="f4c26-174">Normalmente, os provedores de controles baseados em janela não precisam fornecer as seguintes propriedades que são identificadas por **PropertyId**:</span><span class="sxs-lookup"><span data-stu-id="f4c26-174">Typically, providers for window-based controls do not need to provide the following properties that are identified by **PROPERTYID**:</span></span>

-   [<span data-ttu-id="f4c26-175">**UIA \_ BoundingRectanglePropertyId**</span><span class="sxs-lookup"><span data-stu-id="f4c26-175">**UIA\_BoundingRectanglePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="f4c26-176">**UIA \_ ClickablePointPropertyId**</span><span class="sxs-lookup"><span data-stu-id="f4c26-176">**UIA\_ClickablePointPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="f4c26-177">**UIA \_ ProcessIdPropertyId**</span><span class="sxs-lookup"><span data-stu-id="f4c26-177">**UIA\_ProcessIdPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="f4c26-178">**UIA \_ ClassNamePropertyId**</span><span class="sxs-lookup"><span data-stu-id="f4c26-178">**UIA\_ClassNamePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="f4c26-179">**UIA \_ HasKeyboardFocusPropertyId**</span><span class="sxs-lookup"><span data-stu-id="f4c26-179">**UIA\_HasKeyboardFocusPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="f4c26-180">**UIA \_ IsEnabledPropertyId**</span><span class="sxs-lookup"><span data-stu-id="f4c26-180">**UIA\_IsEnabledPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="f4c26-181">**UIA \_ IsKeyboardFocusablePropertyId**</span><span class="sxs-lookup"><span data-stu-id="f4c26-181">**UIA\_IsKeyboardFocusablePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="f4c26-182">**UIA \_ IsPasswordPropertyId**</span><span class="sxs-lookup"><span data-stu-id="f4c26-182">**UIA\_IsPasswordPropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="f4c26-183">**UIA \_ NamePropertyId**</span><span class="sxs-lookup"><span data-stu-id="f4c26-183">**UIA\_NamePropertyId**</span></span>](uiauto-automation-element-propids.md)
-   [<span data-ttu-id="f4c26-184">**UIA \_ RuntimeIdPropertyId**</span><span class="sxs-lookup"><span data-stu-id="f4c26-184">**UIA\_RuntimeIdPropertyId**</span></span>](uiauto-automation-element-propids.md)

<span data-ttu-id="f4c26-185">A propriedade runtimeId de um elemento simples ou raiz de fragmento hospedada em uma janela é obtida na janela.</span><span class="sxs-lookup"><span data-stu-id="f4c26-185">The RuntimeId property of a simple element or fragment root hosted in a window is obtained from the window.</span></span> <span data-ttu-id="f4c26-186">No entanto, os elementos de fragmento abaixo da raiz, como itens de lista em uma caixa de listagem, devem fornecer seus próprios identificadores.</span><span class="sxs-lookup"><span data-stu-id="f4c26-186">However, fragment elements below the root, such as list items in a list box, must provide their own identifiers.</span></span> <span data-ttu-id="f4c26-187">Para obter mais informações, consulte [**IRawElementProviderFragment:: GetRuntimeId**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getruntimeid).</span><span class="sxs-lookup"><span data-stu-id="f4c26-187">For more information, see [**IRawElementProviderFragment::GetRuntimeId**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-getruntimeid).</span></span>

<span data-ttu-id="f4c26-188">A Propriedade IsKeyboardFocusable deve ser retornada para provedores hospedados em um controle de Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="f4c26-188">The IsKeyboardFocusable property should be returned for providers hosted in a Windows Forms control.</span></span> <span data-ttu-id="f4c26-189">Nesse caso, o provedor de janela padrão pode não conseguir recuperar o valor correto.</span><span class="sxs-lookup"><span data-stu-id="f4c26-189">In this case, the default window provider may be unable to retrieve the correct value.</span></span>

<span data-ttu-id="f4c26-190">A propriedade Name geralmente é fornecida pelo provedor de host.</span><span class="sxs-lookup"><span data-stu-id="f4c26-190">The Name property is usually supplied by the host provider.</span></span>

## <a name="events-from-providers"></a><span data-ttu-id="f4c26-191">Eventos de provedores</span><span class="sxs-lookup"><span data-stu-id="f4c26-191">Events from Providers</span></span>

<span data-ttu-id="f4c26-192">Os provedores de automação da interface do usuário devem gerar eventos para notificar aplicativos cliente sobre alterações no estado da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="f4c26-192">UI Automation providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="f4c26-193">As funções a seguir são usadas para gerar eventos.</span><span class="sxs-lookup"><span data-stu-id="f4c26-193">The following functions are used to raise events.</span></span>



| <span data-ttu-id="f4c26-194">Função</span><span class="sxs-lookup"><span data-stu-id="f4c26-194">Function</span></span>                                                                                   | <span data-ttu-id="f4c26-195">Descrição</span><span class="sxs-lookup"><span data-stu-id="f4c26-195">Description</span></span>                                                                                                              |
|--------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="f4c26-196">**UiaRaiseAutomationEvent**</span><span class="sxs-lookup"><span data-stu-id="f4c26-196">**UiaRaiseAutomationEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationevent)                  | <span data-ttu-id="f4c26-197">Gera vários eventos, incluindo eventos disparados por padrões de controle.</span><span class="sxs-lookup"><span data-stu-id="f4c26-197">Raises various events, including events triggered by control patterns.</span></span>                                                   |
| [<span data-ttu-id="f4c26-198">**UiaRaiseAutomationPropertyChangedEvent**</span><span class="sxs-lookup"><span data-stu-id="f4c26-198">**UiaRaiseAutomationPropertyChangedEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraiseautomationpropertychangedevent) | <span data-ttu-id="f4c26-199">Gera um evento quando uma propriedade de automação da interface do usuário é alterada.</span><span class="sxs-lookup"><span data-stu-id="f4c26-199">Raises an event when a UI Automation property has changed.</span></span>                                                               |
| [<span data-ttu-id="f4c26-200">**UiaRaiseStructureChangedEvent**</span><span class="sxs-lookup"><span data-stu-id="f4c26-200">**UiaRaiseStructureChangedEvent**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaraisestructurechangedevent)      | <span data-ttu-id="f4c26-201">Gera um evento quando a estrutura da árvore de automação da interface do usuário é alterada, por exemplo, removendo ou adicionando um elemento.</span><span class="sxs-lookup"><span data-stu-id="f4c26-201">Raises an event when the structure of the UI Automation tree has changed, for example, by removing or adding an element.</span></span> |



 

<span data-ttu-id="f4c26-202">A finalidade de um evento é notificar o cliente sobre algo que está ocorrendo na interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="f4c26-202">The purpose of an event is to notify the client of something taking place in the UI.</span></span> <span data-ttu-id="f4c26-203">Os provedores devem gerar um evento independentemente se a alteração foi disparada pela entrada do usuário ou por um aplicativo cliente usando a automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="f4c26-203">Providers should raise an event regardless of whether the change was triggered by user input or by a client application using UI Automation.</span></span> <span data-ttu-id="f4c26-204">Por exemplo, o evento identificado por [**UIA \_ Invoke \_ InvokedEventId**](uiauto-event-ids.md) deve ser gerado sempre que o controle é invocado, seja por meio de entrada direta do usuário ou pelo aplicativo cliente chamando [**IUIAutomationInvokePattern:: Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span><span class="sxs-lookup"><span data-stu-id="f4c26-204">For example, the event identified by [**UIA\_Invoke\_InvokedEventId**](uiauto-event-ids.md) should be raised whenever the control is invoked, either through direct user input or by the client application calling [**IUIAutomationInvokePattern::Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span></span>

<span data-ttu-id="f4c26-205">Para otimizar o desempenho, um provedor poderá acionar eventos seletivamente ou não gerar nenhum evento se nenhum aplicativo cliente estiver registrado para recebê-los.</span><span class="sxs-lookup"><span data-stu-id="f4c26-205">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="f4c26-206">Os seguintes elementos de API são usados para otimização.</span><span class="sxs-lookup"><span data-stu-id="f4c26-206">The following API elements are used for optimization.</span></span>



| <span data-ttu-id="f4c26-207">Elemento API</span><span class="sxs-lookup"><span data-stu-id="f4c26-207">API Element</span></span>                                                                       | <span data-ttu-id="f4c26-208">Descrição</span><span class="sxs-lookup"><span data-stu-id="f4c26-208">Description</span></span>                                                                                                                                                       |
|-----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="f4c26-209">**UiaClientsAreListening**</span><span class="sxs-lookup"><span data-stu-id="f4c26-209">**UiaClientsAreListening**</span></span>](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening)           | <span data-ttu-id="f4c26-210">Essa função determina se algum aplicativo cliente assinou eventos de automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="f4c26-210">This function ascertains whether any client applications have subscribed to UI Automation events.</span></span>                                                                 |
| [<span data-ttu-id="f4c26-211">**IRawElementProviderAdviseEvents**</span><span class="sxs-lookup"><span data-stu-id="f4c26-211">**IRawElementProviderAdviseEvents**</span></span>](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovideradviseevents) | <span data-ttu-id="f4c26-212">A implementação dessa interface em uma raiz de fragmento permite que o provedor seja avisado quando os clientes registram e cancelam o registro de manipuladores de eventos para eventos no fragmento.</span><span class="sxs-lookup"><span data-stu-id="f4c26-212">Implementing this interface on a fragment root enables the provider to be advised when clients register and unregister event handlers for events on the fragment.</span></span> |



 

> [!Note]  
> <span data-ttu-id="f4c26-213">Semelhante à implementação da contagem de referência na programação COM, é importante que os provedores de automação da interface do usuário tratem os métodos [**IRawElementProviderAdviseEvents:: AdviseEventAdded**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventadded) e [**AdviseEventRemoved**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventremoved) como os métodos [**IUnknown:: AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref) e [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) da interface [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) .</span><span class="sxs-lookup"><span data-stu-id="f4c26-213">Similar to implementing reference counting in COM programming, it is important for UI Automation providers to treat the [**IRawElementProviderAdviseEvents::AdviseEventAdded**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventadded) and [**AdviseEventRemoved**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovideradviseevents-adviseeventremoved) methods like the [**IUnknown::AddRef**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref) and [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) methods of the [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) interface.</span></span> <span data-ttu-id="f4c26-214">Desde que **AdviseEventAdded** tenha sido chamado mais vezes do que **AdviseEventRemoved** para um evento ou propriedade específica, o provedor deve continuar a gerar eventos correspondentes, pois alguns clientes ainda estão ouvindo.</span><span class="sxs-lookup"><span data-stu-id="f4c26-214">As long as **AdviseEventAdded** has been called more times than **AdviseEventRemoved** for a specific event or property, the provider should continue to raise corresponding events, because some clients are still listening.</span></span> <span data-ttu-id="f4c26-215">Como alternativa, os provedores de automação da interface do usuário podem usar a função [**UiaClientsAreListening**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening) para determinar se pelo menos um cliente está ouvindo e, em caso afirmativo, gera todos os eventos apropriados.</span><span class="sxs-lookup"><span data-stu-id="f4c26-215">Alternatively, UI Automation providers can use the [**UiaClientsAreListening**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiaclientsarelistening) function to determine whether at least one client is listening and, if so, raise all appropriate events.</span></span>

 

## <a name="provider-navigation"></a><span data-ttu-id="f4c26-216">Navegação do provedor</span><span class="sxs-lookup"><span data-stu-id="f4c26-216">Provider Navigation</span></span>

<span data-ttu-id="f4c26-217">Provedores para controles simples, como um botão personalizado hospedado em uma janela, não precisam dar suporte à navegação na árvore de automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="f4c26-217">Providers for simple controls, such as a custom button hosted in a window, do not need to support navigation in the UI Automation tree.</span></span> <span data-ttu-id="f4c26-218">A navegação de e para o elemento é manipulada pelo provedor padrão para a janela do host, que é especificada na implementação de [**IRawElementProviderSimple:: HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider).</span><span class="sxs-lookup"><span data-stu-id="f4c26-218">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider).</span></span> <span data-ttu-id="f4c26-219">No entanto, quando você implementa um provedor para um controle personalizado complexo, deve dar suporte à navegação entre o nó raiz do fragmento e seus descendentes e entre nós irmãos.</span><span class="sxs-lookup"><span data-stu-id="f4c26-219">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!Note]  
> <span data-ttu-id="f4c26-220">Elementos de um fragmento diferente da raiz devem retornar **NULL** de [**HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), porque eles não são hospedados diretamente em uma janela, e nenhum provedor padrão pode dar suporte à navegação de e para eles.</span><span class="sxs-lookup"><span data-stu-id="f4c26-220">Elements of a fragment other than the root must return **NULL** from [**HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

 

<span data-ttu-id="f4c26-221">A estrutura do fragmento é determinada pela implementação de [**IRawElementProviderFragment:: Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate).</span><span class="sxs-lookup"><span data-stu-id="f4c26-221">The structure of the fragment is determined by your implementation of [**IRawElementProviderFragment::Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate).</span></span> <span data-ttu-id="f4c26-222">Para cada direção possível de cada fragmento, esse método retorna o objeto do provedor para o elemento nessa direção.</span><span class="sxs-lookup"><span data-stu-id="f4c26-222">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="f4c26-223">Se não houver nenhum elemento nessa direção, o método retornará **NULL**.</span><span class="sxs-lookup"><span data-stu-id="f4c26-223">If there is no element in that direction, the method returns **NULL**.</span></span>

<span data-ttu-id="f4c26-224">A raiz do fragmento dá suporte à navegação somente para elementos filho.</span><span class="sxs-lookup"><span data-stu-id="f4c26-224">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="f4c26-225">Por exemplo, uma caixa de listagem retorna o primeiro item da lista quando a direção é **NavigateDirection \_ FirstChild** e retorna o último item quando a direção é **NavigateDirection \_ LastChild**.</span><span class="sxs-lookup"><span data-stu-id="f4c26-225">For example, a list box returns the first item in the list when the direction is **NavigateDirection\_FirstChild**, and returns the last item when the direction is **NavigateDirection\_LastChild**.</span></span> <span data-ttu-id="f4c26-226">A raiz do fragmento não dá suporte à navegação para um pai ou para irmãos; Isso é tratado pelo provedor de janela do host.</span><span class="sxs-lookup"><span data-stu-id="f4c26-226">The fragment root does not support navigation to a parent or to siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="f4c26-227">Elementos de um fragmento que não são a raiz devem dar suporte à navegação para o pai e a quaisquer irmãos e filhos que eles têm.</span><span class="sxs-lookup"><span data-stu-id="f4c26-227">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

## <a name="assigning-a-new-parent"></a><span data-ttu-id="f4c26-228">Atribuindo um novo pai</span><span class="sxs-lookup"><span data-stu-id="f4c26-228">Assigning a New Parent</span></span>

<span data-ttu-id="f4c26-229">As janelas pop-up são, na verdade, janelas de nível superior e, por padrão, aparecem na árvore de automação da interface do usuário como filhos da área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="f4c26-229">Pop-up windows are actually top-level windows, and by default, appear in the UI Automation tree as children of the desktop.</span></span> <span data-ttu-id="f4c26-230">Em muitos casos, no entanto, janelas pop-up são logicamente filhos de algum outro controle.</span><span class="sxs-lookup"><span data-stu-id="f4c26-230">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="f4c26-231">Por exemplo, a lista suspensa de uma caixa de combinação é logicamente um filho da caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="f4c26-231">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="f4c26-232">Da mesma forma, uma janela pop-up de menu é logicamente um filho do menu.</span><span class="sxs-lookup"><span data-stu-id="f4c26-232">Similarly, a menu pop-up window is logically a child of the menu.</span></span> <span data-ttu-id="f4c26-233">A automação da interface do usuário fornece suporte para atribuir um novo pai a uma janela pop-up para que pareça ser um filho do controle associado.</span><span class="sxs-lookup"><span data-stu-id="f4c26-233">UI Automation provides support to assign a new parent to a pop-up window so that it appears to be a child of the associated control.</span></span>

<span data-ttu-id="f4c26-234">Para atribuir um novo pai a uma janela pop-up:</span><span class="sxs-lookup"><span data-stu-id="f4c26-234">To assign a new parent to a pop-up window:</span></span>

1.  <span data-ttu-id="f4c26-235">Crie um provedor para a janela pop-up.</span><span class="sxs-lookup"><span data-stu-id="f4c26-235">Create a provider for the pop-up window.</span></span> <span data-ttu-id="f4c26-236">Isso requer que a classe da janela pop-up seja conhecida com antecedência.</span><span class="sxs-lookup"><span data-stu-id="f4c26-236">This requires that the class of the pop-up window be known in advance.</span></span>
2.  <span data-ttu-id="f4c26-237">Implemente todas as propriedades e padrões de controle como de costume para esse pop-up, como se fosse um controle por si só.</span><span class="sxs-lookup"><span data-stu-id="f4c26-237">Implement all properties and control patterns as usual for that pop-up, as though it were a control in its own right.</span></span>
3.  <span data-ttu-id="f4c26-238">Implemente a propriedade [**IRawElementProviderSimple:: HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) para que ela retorne o valor obtido de [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), em que o parâmetro é o identificador da janela pop-up.</span><span class="sxs-lookup"><span data-stu-id="f4c26-238">Implement the [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider) property so that it returns the value obtained from [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), where the parameter is the window handle of the pop-up window.</span></span>
4.  <span data-ttu-id="f4c26-239">Implemente [**IRawElementProviderFragment:: Navegue**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate) para a janela pop-up e seu pai para que a navegação seja manipulada corretamente do pai lógico para os filhos lógicos e entre filhos irmãos.</span><span class="sxs-lookup"><span data-stu-id="f4c26-239">Implement [**IRawElementProviderFragment::Navigate**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderfragment-navigate) for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="f4c26-240">Quando a automação da interface do usuário encontra a janela pop-up, ela reconhece que a navegação está sendo substituída do padrão e ignora a janela pop-up quando ela é encontrada como um filho da área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="f4c26-240">When UI Automation encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="f4c26-241">Em vez disso, o nó só pode ser acessado por meio do fragmento.</span><span class="sxs-lookup"><span data-stu-id="f4c26-241">Instead, the node is reachable only through the fragment.</span></span>

<span data-ttu-id="f4c26-242">A atribuição de um novo pai não é adequada para casos em que um controle pode hospedar uma janela de qualquer classe.</span><span class="sxs-lookup"><span data-stu-id="f4c26-242">Assigning a new parent is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="f4c26-243">Por exemplo, um controle rebar pode hospedar qualquer tipo de janela em suas bandas.</span><span class="sxs-lookup"><span data-stu-id="f4c26-243">For example, a rebar control can host any type of window in its bands.</span></span> <span data-ttu-id="f4c26-244">Para lidar com esses casos, a automação da interface do usuário dá suporte a uma forma alternativa de realocação de janela, conforme descrito na próxima seção.</span><span class="sxs-lookup"><span data-stu-id="f4c26-244">To handle these cases, UI Automation supports an alternative form of window relocation, as described in the next section.</span></span>

## <a name="provider-repositioning"></a><span data-ttu-id="f4c26-245">Reposicionamento do provedor</span><span class="sxs-lookup"><span data-stu-id="f4c26-245">Provider Repositioning</span></span>

<span data-ttu-id="f4c26-246">Fragmentos de automação da interface do usuário podem conter dois ou mais elementos que estão contidos em uma janela.</span><span class="sxs-lookup"><span data-stu-id="f4c26-246">UI Automation fragments may contain two or more elements that are each contained in a window.</span></span> <span data-ttu-id="f4c26-247">Como cada janela tem seu próprio provedor padrão que considera que a janela é um filho de uma janela recipiente, a árvore de automação da interface do usuário, por padrão, mostrará as janelas no fragmento como filhos da janela pai.</span><span class="sxs-lookup"><span data-stu-id="f4c26-247">Because each window has its own default provider that considers the window to be a child of a containing window, the UI Automation tree by default, will show the windows in the fragment as children of the parent window.</span></span> <span data-ttu-id="f4c26-248">Na maioria dos casos, esse comportamento é desejável, mas às vezes pode levar à confusão porque não corresponde à estrutura lógica da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="f4c26-248">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the UI.</span></span>

<span data-ttu-id="f4c26-249">Um bom exemplo disso é um controle rebar.</span><span class="sxs-lookup"><span data-stu-id="f4c26-249">A good example of this is a rebar control.</span></span> <span data-ttu-id="f4c26-250">Um controle rebar contém bandas, e cada uma delas pode, por sua vez, conter um controle baseado em janela, como uma barra de ferramentas, uma caixa de edição ou uma caixa de combinação.</span><span class="sxs-lookup"><span data-stu-id="f4c26-250">A rebar control contains bands, each of which can in turn contain a window-based control, such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="f4c26-251">O provedor de janela padrão da janela rebar vê as janelas de controle de banda como filhas, e o provedor de rebar vê as faixas como filhas.</span><span class="sxs-lookup"><span data-stu-id="f4c26-251">The default window provider for the rebar window sees the band control windows as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="f4c26-252">Como o provedor de janela e o provedor de rebar estão trabalhando em tandem e combinando seus filhos, as faixas e os controles baseados em janela aparecem como filhos do controle rebar.</span><span class="sxs-lookup"><span data-stu-id="f4c26-252">Because the window provider and the rebar provider are working in tandem and combining their children, both the bands and the window-based controls appear as children of the rebar control.</span></span> <span data-ttu-id="f4c26-253">No entanto, logicamente, somente as faixas devem aparecer como filhos do controle rebar, e cada provedor de banda deve ser acoplado ao provedor de janela padrão para o controle que ele contém.</span><span class="sxs-lookup"><span data-stu-id="f4c26-253">Logically, however, only the bands should appear as children of the rebar control, and each band provider should be coupled with the default window provider for the control it contains.</span></span>

<span data-ttu-id="f4c26-254">Para fazer isso, o provedor raiz do fragmento do controle rebar expõe um conjunto de filhos representando as faixas.</span><span class="sxs-lookup"><span data-stu-id="f4c26-254">To accomplish this, the fragment root provider for the rebar control exposes a set of children representing the bands.</span></span> <span data-ttu-id="f4c26-255">Cada banda tem um único provedor que pode expor propriedades e padrões de controle.</span><span class="sxs-lookup"><span data-stu-id="f4c26-255">Each band has a single provider that may expose properties and control patterns.</span></span> <span data-ttu-id="f4c26-256">Em sua implementação de [**IRawElementProviderSimple:: HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), o provedor de banda retorna o provedor de janela padrão para a janela de controle, que é obtido chamando [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), passando o identificador de janela do controle (**hWnd**).</span><span class="sxs-lookup"><span data-stu-id="f4c26-256">In its implementation of [**IRawElementProviderSimple::HostRawElementProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementprovidersimple-get_hostrawelementprovider), the band provider returns the default window provider for the control window, which it obtains by calling [**UiaHostProviderFromHwnd**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiahostproviderfromhwnd), passing in the control's window handle (**HWND**).</span></span> <span data-ttu-id="f4c26-257">Por fim, o provedor raiz do fragmento para o rebar implementa a interface [**IRawElementProviderHwndOverride**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) e, em sua implementação de [**IRawElementProviderHwndOverride:: GetOverrideProviderForHwnd**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderhwndoverride-getoverrideproviderforhwnd), ele retorna o provedor de banda apropriado para o controle contido na janela especificada.</span><span class="sxs-lookup"><span data-stu-id="f4c26-257">Finally, the fragment root provider for the rebar implements the [**IRawElementProviderHwndOverride**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementproviderhwndoverride) interface, and in its implementation of [**IRawElementProviderHwndOverride::GetOverrideProviderForHwnd**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-irawelementproviderhwndoverride-getoverrideproviderforhwnd), it returns the appropriate band provider for the control contained in the specified window.</span></span>

## <a name="disconnecting-providers"></a><span data-ttu-id="f4c26-258">Desconectando provedores</span><span class="sxs-lookup"><span data-stu-id="f4c26-258">Disconnecting Providers</span></span>

<span data-ttu-id="f4c26-259">Normalmente, os aplicativos criam controles conforme eles são necessários e os destrói posteriormente.</span><span class="sxs-lookup"><span data-stu-id="f4c26-259">Applications typically create controls as they are needed and destroy them afterward.</span></span> <span data-ttu-id="f4c26-260">Depois de destruir um controle, os recursos do provedor de automação da interface do usuário associados ao controle devem ser liberados chamando o [**UiaDisconnectProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectprovider).</span><span class="sxs-lookup"><span data-stu-id="f4c26-260">After destroying a control, the UI Automation provider resources associated with the control should be released by calling the [**UiaDisconnectProvider**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectprovider).</span></span>

<span data-ttu-id="f4c26-261">Da mesma forma, um aplicativo deve usar a função [**UiaDisconnectAllProviders**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectallproviders) para liberar todos os recursos de automação da interface do usuário mantidos por todos os provedores no aplicativo antes de desligar.</span><span class="sxs-lookup"><span data-stu-id="f4c26-261">Similarly, an application should use the [**UiaDisconnectAllProviders**](/windows/desktop/api/UIAutomationCoreApi/nf-uiautomationcoreapi-uiadisconnectallproviders) function to release all UI Automation resources held by all providers in the application before shutting down.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f4c26-262">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="f4c26-262">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f4c26-263">Guia do programador do provedor de automação de interface do usuário</span><span class="sxs-lookup"><span data-stu-id="f4c26-263">UI Automation Provider Programmer's Guide</span></span>](uiauto-providerportal.md)
</dt> </dl>

 

 