---
title: Sobre os padrões de controle Text e TextRange
description: O conteúdo textual de um controle é exposto usando o padrão de controle de texto, que representa o conteúdo de um contêiner de texto como um fluxo de texto.
ms.assetid: acc2b513-9367-416a-b0d9-3c2bcc14a8a7
keywords:
- Automação da interface do usuário, suporte a conteúdo textual
- Automação da interface do usuário, visão geral do padrão de texto
- Visão geral da automação da interface do usuário, controles de texto
- Automação da interface do usuário, padrão de controle de texto
- Automação da interface do usuário, TSF (estrutura de serviços de texto)
- Automação da interface do usuário, TSF
- Automação da interface do usuário, desempenho
- padrões de texto, sobre
- padrões de texto, TSF (estrutura de serviços de texto)
- controles de texto, sobre
- conteúdo textual, suporte para
- controles de texto, desempenho
- Padrão de controle de texto
- padrões de controle, texto
- TFS (Estrutura de Serviços de Texto)
- TSF (estrutura de serviços de texto)
- desempenho
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bb9ff1eb75227454e3e9df6035798a304096a958
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "105797894"
---
# <a name="about-the-text-and-textrange-control-patterns"></a><span data-ttu-id="76db9-120">Sobre os padrões de controle Text e TextRange</span><span class="sxs-lookup"><span data-stu-id="76db9-120">About the Text and TextRange Control Patterns</span></span>

<span data-ttu-id="76db9-121">O conteúdo textual de um controle é exposto usando o padrão de controle de [texto](uiauto-implementingtextandtextrange.md) , que representa o conteúdo de um contêiner de texto como um fluxo de texto.</span><span class="sxs-lookup"><span data-stu-id="76db9-121">The textual content of a control is exposed by using the [Text](uiauto-implementingtextandtextrange.md) control pattern, which represents the contents of a text container as a text stream.</span></span> <span data-ttu-id="76db9-122">O padrão de controle de texto requer o suporte do padrão de controle TextRange para expor atributos de formato e estilo.</span><span class="sxs-lookup"><span data-stu-id="76db9-122">The Text control pattern requires the support of the TextRange control pattern to expose format and style attributes.</span></span> <span data-ttu-id="76db9-123">O padrão de controle TextRange dá suporte ao padrão de controle de texto, representando intervalos de texto separados ou múltiplos, não contíguos (ou faixas) em um contêiner de texto com uma coleção de pontos de extremidade inicial e final.</span><span class="sxs-lookup"><span data-stu-id="76db9-123">The TextRange control pattern supports the Text control pattern by representing contiguous or multiple, disjoint text spans (or ranges) in a text container with a collection of start and end endpoints.</span></span> <span data-ttu-id="76db9-124">O padrão de controle TextRange oferece suporte a funcionalidades como seleção, comparação, recuperação e passagem.</span><span class="sxs-lookup"><span data-stu-id="76db9-124">The TextRange control pattern supports functionality such as selection, comparison, retrieval and traversal.</span></span>

> [!Note]  
> <span data-ttu-id="76db9-125">O padrão de controle de [texto](uiauto-implementingtextandtextrange.md) não fornece um meio para inserir ou modificar texto.</span><span class="sxs-lookup"><span data-stu-id="76db9-125">The [Text](uiauto-implementingtextandtextrange.md) control pattern does not provide a means to insert or modify text.</span></span> <span data-ttu-id="76db9-126">No entanto, dependendo do controle, isso pode ser feito usando o padrão de controle de [valor](uiauto-implementingvalue.md) de automação da interface do usuário da Microsoft ou por meio de entrada de teclado direto.</span><span class="sxs-lookup"><span data-stu-id="76db9-126">However, depending on the control, this may be accomplished by using the Microsoft UI Automation [Value](uiauto-implementingvalue.md) control pattern or through direct keyboard input.</span></span> <span data-ttu-id="76db9-127">Também há um padrão [**Editor**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itexteditprovider) que dá suporte à alteração programática em texto.</span><span class="sxs-lookup"><span data-stu-id="76db9-127">There's also a [**TextEdit**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itexteditprovider) pattern that supports programmatic change to text.</span></span>

 

<span data-ttu-id="76db9-128">A funcionalidade descrita neste tópico é vital para fornecedores de tecnologia assistencial e seus usuários finais.</span><span class="sxs-lookup"><span data-stu-id="76db9-128">The functionality described in this topic is vital to assistive technology vendors and their end users.</span></span> <span data-ttu-id="76db9-129">Tecnologias assistenciais podem usar a automação da interface do usuário para reunir informações completas de formatação de texto para o utilizador e fornecer navegação programática e seleção de texto por [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) (caractere, palavra, linha ou parágrafo).</span><span class="sxs-lookup"><span data-stu-id="76db9-129">Assistive technologies can use UI Automation to gather complete text formatting information for the user and provide programmatic navigation and selection of text by [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) (character, word, line, or paragraph).</span></span>

<span data-ttu-id="76db9-130">Este tópico contém as seguintes seções:</span><span class="sxs-lookup"><span data-stu-id="76db9-130">This topic contains the following sections:</span></span>

-   [<span data-ttu-id="76db9-131">TextPattern da automação da interface do usuário e a estrutura de serviços de texto</span><span class="sxs-lookup"><span data-stu-id="76db9-131">UI Automation TextPattern and the Text Services Framework</span></span>](#ui-automation-textpattern-and-the-text-services-framework)
-   [<span data-ttu-id="76db9-132">Tipos de controle</span><span class="sxs-lookup"><span data-stu-id="76db9-132">Control Types</span></span>](#control-types)
-   [<span data-ttu-id="76db9-133">Interfaces de provedor</span><span class="sxs-lookup"><span data-stu-id="76db9-133">Provider Interfaces</span></span>](#provider-interfaces)
-   [<span data-ttu-id="76db9-134">Interfaces de cliente</span><span class="sxs-lookup"><span data-stu-id="76db9-134">Client Interfaces</span></span>](#client-interfaces)
-   [<span data-ttu-id="76db9-135">Desempenho</span><span class="sxs-lookup"><span data-stu-id="76db9-135">Performance</span></span>](#performance)
-   [<span data-ttu-id="76db9-136">Padrão de texto e objetos incorporados virtualizados</span><span class="sxs-lookup"><span data-stu-id="76db9-136">Text Pattern and Virtualized Embedded Objects</span></span>](#text-pattern-and-virtualized-embedded-objects)
-   [<span data-ttu-id="76db9-137">Usando o tipo de controle personalizado com o padrão de controle de texto</span><span class="sxs-lookup"><span data-stu-id="76db9-137">Using the Custom Control Type with the Text Control Pattern</span></span>](#using-the-custom-control-type-with-the-text-control-pattern)
-   [<span data-ttu-id="76db9-138">Tempo de vida de um intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="76db9-138">Lifetime of a Text Range</span></span>](#lifetime-of-a-text-range)
-   [<span data-ttu-id="76db9-139">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="76db9-139">Related topics</span></span>](#related-topics)

## <a name="ui-automation-textpattern-and-the-text-services-framework"></a><span data-ttu-id="76db9-140">TextPattern da automação da interface do usuário e a estrutura de serviços de texto</span><span class="sxs-lookup"><span data-stu-id="76db9-140">UI Automation TextPattern and the Text Services Framework</span></span>

<span data-ttu-id="76db9-141">A TSF (estrutura de serviços de texto) é uma estrutura de sistema simples e escalonável que permite serviços de linguagem natural e entrada de texto avançada na área de trabalho e em aplicativos.</span><span class="sxs-lookup"><span data-stu-id="76db9-141">Text Services Framework (TSF) is a simple and scalable system framework that enables natural language services and advanced text input on the desktop and in applications.</span></span> <span data-ttu-id="76db9-142">Além de fornecer interfaces para que os aplicativos exponham seu armazenamento de texto, ele também dá suporte a metadados para o armazenamento de texto.</span><span class="sxs-lookup"><span data-stu-id="76db9-142">In addition to providing interfaces for applications to expose their text store, it also supports metadata for the text store.</span></span>

<span data-ttu-id="76db9-143">O TSF foi projetado para aplicativos que precisam injetar entrada em cenários com reconhecimento de contexto.</span><span class="sxs-lookup"><span data-stu-id="76db9-143">TSF was designed for applications that need to inject input into context-aware scenarios.</span></span> <span data-ttu-id="76db9-144">O padrão de controle de [texto](uiauto-implementingtextandtextrange.md) , no entanto, é uma solução somente leitura que é destinada a fornecer acesso otimizado a um armazenamento de texto para leitores de tela e dispositivos de braille.</span><span class="sxs-lookup"><span data-stu-id="76db9-144">The [Text](uiauto-implementingtextandtextrange.md) control pattern, however, is a read-only solution that is intended to provide optimized access to a text store for screen-readers and Braille devices.</span></span>

<span data-ttu-id="76db9-145">Tecnologias acessíveis que exigem acesso somente leitura a um armazenamento de texto podem usar o padrão de controle de texto, mas precisarão da funcionalidade do TSF para entrada com reconhecimento de contexto.</span><span class="sxs-lookup"><span data-stu-id="76db9-145">Accessible technologies that require read-only access to a text store can use the Text control pattern, but will need the functionality of TSF for context-aware input.</span></span>

<span data-ttu-id="76db9-146">Para obter mais informações, consulte [estrutura de serviços de texto](/windows/desktop/TSF/text-services-framework).</span><span class="sxs-lookup"><span data-stu-id="76db9-146">For more information, see [Text Services Framework](/windows/desktop/TSF/text-services-framework).</span></span>

## <a name="control-types"></a><span data-ttu-id="76db9-147">Tipos de controle</span><span class="sxs-lookup"><span data-stu-id="76db9-147">Control Types</span></span>

<span data-ttu-id="76db9-148">O tipo de controle de [edição](uiauto-supporteditcontroltype.md) de automação da interface do usuário e o tipo de controle de [documento](uiauto-supportdocumentcontroltype.md) devem suportar o padrão de controle de [texto](uiauto-implementingtextandtextrange.md)</span><span class="sxs-lookup"><span data-stu-id="76db9-148">The UI Automation [Edit](uiauto-supporteditcontroltype.md) control type and [Document](uiauto-supportdocumentcontroltype.md) control type must support the [Text](uiauto-implementingtextandtextrange.md) control pattern.</span></span> <span data-ttu-id="76db9-149">Para melhorar a acessibilidade, a Microsoft recomenda que os tipos de controle de texto e [dica de ferramenta](uiauto-supporttooltipcontroltype.md) também ofereçam suporte ao padrão de controle de texto, mas isso não é necessário.</span><span class="sxs-lookup"><span data-stu-id="76db9-149">For improved accessibility, Microsoft recommends that the [ToolTip](uiauto-supporttooltipcontroltype.md) and Text control types also support the Text control pattern, but it is not required.</span></span>

## <a name="provider-interfaces"></a><span data-ttu-id="76db9-150">Interfaces de provedor</span><span class="sxs-lookup"><span data-stu-id="76db9-150">Provider Interfaces</span></span>

<span data-ttu-id="76db9-151">Os provedores de automação de interface do usuário dão suporte ao padrão de controle de [texto](uiauto-implementingtextandtextrange.md) para um controle implementando as interfaces [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) e [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) .</span><span class="sxs-lookup"><span data-stu-id="76db9-151">UI Automation providers support the [Text](uiauto-implementingtextandtextrange.md) control pattern for a control by implementing the [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) interfaces.</span></span> <span data-ttu-id="76db9-152">Essas interfaces expõem informações detalhadas de atributo para texto no controle e fornecem recursos de navegação robustos.</span><span class="sxs-lookup"><span data-stu-id="76db9-152">These interfaces expose detailed attribute information for text in the control and provide robust navigational capabilities.</span></span>

<span data-ttu-id="76db9-153">Um provedor não precisará dar suporte a todos os atributos de texto se o controle não tiver suporte para nenhum atributo específico.</span><span class="sxs-lookup"><span data-stu-id="76db9-153">A provider does not need to support all text attributes if the control lacks support for any particular attribute.</span></span>

<span data-ttu-id="76db9-154">Um provedor deve dar suporte aos métodos [**ITextProvider::**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) GetSelection e [**ITextRangeProvider:: SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) se o controle oferecer suporte à seleção de texto ou ao posicionamento do cursor de texto (ou do cursor do sistema) na área de texto.</span><span class="sxs-lookup"><span data-stu-id="76db9-154">A provider must support the [**ITextProvider::GetSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) and [**ITextRangeProvider::Select**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) methods if the control supports text selection or placement of the text cursor (or system caret) within the text area.</span></span> <span data-ttu-id="76db9-155">Se o controle não oferecer suporte a essa funcionalidade, ele não precisará oferecer suporte a nenhum desses métodos.</span><span class="sxs-lookup"><span data-stu-id="76db9-155">If the control does not support this functionality, it does not need to support either of these methods.</span></span> <span data-ttu-id="76db9-156">No entanto, o controle deve expor o tipo de seleção de texto compatível com a implementação da propriedade [**ITextProvider:: SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) .</span><span class="sxs-lookup"><span data-stu-id="76db9-156">However, the control must expose the type of text selection it supports by implementing the [**ITextProvider::SupportedTextSelection**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) property.</span></span>

<span data-ttu-id="76db9-157">Um provedor deve sempre dar suporte às constantes [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) , timeunit **\_ Character** e **TextUnit \_**, bem como a qualquer outra pessoa com suporte.</span><span class="sxs-lookup"><span data-stu-id="76db9-157">A provider must always support the [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) constants, **TextUnit\_Character** and **TextUnit\_Document**, as well as any others it is capable of supporting.</span></span>

> [!Note]  
> <span data-ttu-id="76db9-158">O provedor pode ignorar o suporte para uma [**fileunit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) específica, desferindo-se à próxima unidade maior com suporte na seguinte ordem: **\_ caractere TextUnit**, **\_ formato TextUnit**, **timeunit \_ Word**, **timeunit \_ line**, TextUnit **\_ Paragraph**, **TextUnit \_ Page** e **TextUnit \_ Document**.</span><span class="sxs-lookup"><span data-stu-id="76db9-158">The provider may skip support for a specific [**TextUnit**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) by deferring to the next largest unit supported in the following order: **TextUnit\_Character**, **TextUnit\_Format**, **TextUnit\_Word**, **TextUnit\_Line**, **TextUnit\_Paragraph**, **TextUnit\_Page**, and **TextUnit\_Document**.</span></span>

 

## <a name="client-interfaces"></a><span data-ttu-id="76db9-159">Interfaces de cliente</span><span class="sxs-lookup"><span data-stu-id="76db9-159">Client Interfaces</span></span>

<span data-ttu-id="76db9-160">Os aplicativos cliente de automação da interface do usuário usam as interfaces [**IUIAutomationTextPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) e [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) para acessar o conteúdo textual de um controle de texto.</span><span class="sxs-lookup"><span data-stu-id="76db9-160">UI Automation client applications use the [**IUIAutomationTextPattern**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) and [**IUIAutomationTextRange**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) interfaces to access the textual content of a text control.</span></span> <span data-ttu-id="76db9-161">Os clientes usam **IUIAutomationTextPattern** para selecionar trechos de texto chamados de *intervalos de texto* e para recuperar ponteiros para interfaces **IUIAutomationTextRange** para os intervalos.</span><span class="sxs-lookup"><span data-stu-id="76db9-161">Clients use **IUIAutomationTextPattern** to select spans of text called *text ranges*, and to retrieve pointers to **IUIAutomationTextRange** interfaces for the ranges.</span></span> <span data-ttu-id="76db9-162">A interface **IUIAutomationTextRange** permite que os clientes manipulem o intervalo de texto e recuperem informações sobre o texto no intervalo, incluindo atributos como nome da fonte, cor de primeiro plano, estilo de sublinhado e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="76db9-162">The **IUIAutomationTextRange** interface enables clients to manipulate the text range, and to retrieve information about the text in the range, including attributes such as font name, foreground color, underline style, and so on.</span></span> <span data-ttu-id="76db9-163">Para obter mais informações, consulte [identificadores de atributo de texto](uiauto-textattribute-ids.md).</span><span class="sxs-lookup"><span data-stu-id="76db9-163">For more information, see [Text Attribute Identifiers](uiauto-textattribute-ids.md).</span></span>

## <a name="performance"></a><span data-ttu-id="76db9-164">Desempenho</span><span class="sxs-lookup"><span data-stu-id="76db9-164">Performance</span></span>

<span data-ttu-id="76db9-165">O padrão de controle de **texto** se baseia em chamadas de processo cruzado para a maior parte de sua funcionalidade, portanto, ele não fornece um mecanismo de cache para melhorar o desempenho ao processar o conteúdo.</span><span class="sxs-lookup"><span data-stu-id="76db9-165">The **Text** control pattern relies on cross-process calls for most of its functionality, so it does not provide a caching mechanism to improve performance when it processes content.</span></span> <span data-ttu-id="76db9-166">Outros padrões de controle na automação da interface do usuário da Microsoft podem ser acessados usando o método [**IUIAutomationElement:: GetCachedPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedpattern) .</span><span class="sxs-lookup"><span data-stu-id="76db9-166">Other control patterns in Microsoft UI Automation can be accessed by using the [**IUIAutomationElement::GetCachedPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedpattern) method.</span></span>

<span data-ttu-id="76db9-167">Uma técnica para melhorar o desempenho é garantir que os clientes de automação da interface do usuário tentem recuperar blocos de texto de tamanho moderado usando o método [**IUIAutomationTextRange:: gettext**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) .</span><span class="sxs-lookup"><span data-stu-id="76db9-167">One technique for improving performance is to ensure that UI Automation clients attempt to retrieve moderately sized blocks of text by using the [**IUIAutomationTextRange::GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) method.</span></span> <span data-ttu-id="76db9-168">Por exemplo, usar **gettext** para recuperar caracteres únicos incorrerá em ocorrências de processo cruzado para cada caractere, enquanto não especificar um comprimento máximo ao chamar **gettext** incorrerá em uma ocorrência em processo cruzado, mas poderá ter alta latência dependendo do tamanho do intervalo de texto.</span><span class="sxs-lookup"><span data-stu-id="76db9-168">For example, using **GetText** to retrieve single characters will incur cross-process hits for each character, whereas not specifying a maximum length when calling **GetText** will incur one cross-process hit, but can have high latency depending on the size of the text range.</span></span>

## <a name="text-pattern-and-virtualized-embedded-objects"></a><span data-ttu-id="76db9-169">Padrão de texto e objetos incorporados virtualizados</span><span class="sxs-lookup"><span data-stu-id="76db9-169">Text Pattern and Virtualized Embedded Objects</span></span>

<span data-ttu-id="76db9-170">Sempre que possível, uma implementação de provedor de [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) e [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) deve dar suporte a todo o texto de um documento, incluindo qualquer texto fora do visor.</span><span class="sxs-lookup"><span data-stu-id="76db9-170">Whenever possible, a provider implementation of [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) and [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) should support the entire text of a document, including any text outside of the viewport.</span></span> <span data-ttu-id="76db9-171">Para objetos de texto fora da tela ou incorporados que são virtualizados, os provedores devem dar suporte ao [padrão de controle VirtualizedItem](uiauto-implementingvirtualizeditem.md) ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider)).</span><span class="sxs-lookup"><span data-stu-id="76db9-171">For off-screen text or embedded objects that are virtualized, providers should support the [VirtualizedItem control pattern](uiauto-implementingvirtualizeditem.md) ([**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider)).</span></span>

<span data-ttu-id="76db9-172">Se um documento for virtualizado enquanto o fluxo de texto inteiro ainda estiver disponível, a propriedade [**ITextProvider::D ocumentrange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) recuperará um intervalo de texto que inclui o documento inteiro.</span><span class="sxs-lookup"><span data-stu-id="76db9-172">If a document is virtualized while the entire text stream is still available, the [**ITextProvider::DocumentRange**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) property will retrieve a text range that includes the entire document.</span></span> <span data-ttu-id="76db9-173">No entanto, chamar o método [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) recuperará uma coleção de objetos virtualizados que representam todos os objetos inseridos no documento.</span><span class="sxs-lookup"><span data-stu-id="76db9-173">However, calling the [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) method will retrieve a collection of virtualized objects that represent all embedded objects in the document.</span></span> <span data-ttu-id="76db9-174">Para interagir com um objeto inserido virtualizado, os clientes devem chamar o método [**IVirtualizedItemProvider:: perceba**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivirtualizeditemprovider-realize) , o que torna os itens totalmente acessíveis como elementos de automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="76db9-174">To interact with a virtualized embedded object, clients must call the [**IVirtualizedItemProvider::Realize**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivirtualizeditemprovider-realize) method, which makes the items fully accessible as UI Automation elements.</span></span> <span data-ttu-id="76db9-175">Os clientes devem seguir um processo semelhante para trabalhar com elementos de grade em uma tabela incorporada em que uma parte da tabela está fora da tela e virtualizada.</span><span class="sxs-lookup"><span data-stu-id="76db9-175">Clients must follow a similar process to work with grid elements in an embedded table where a portion of the table is off-screen and virtualized.</span></span>

## <a name="using-the-custom-control-type-with-the-text-control-pattern"></a><span data-ttu-id="76db9-176">Usando o tipo de controle personalizado com o padrão de controle de texto</span><span class="sxs-lookup"><span data-stu-id="76db9-176">Using the Custom Control Type with the Text Control Pattern</span></span>

<span data-ttu-id="76db9-177">Enquanto o padrão de controle de [texto](uiauto-implementingtextandtextrange.md) dá suporte a muitos atributos de texto e objetos incorporados, não é possível definir com antecedência todos os elementos de documento e tipos de apresentação possíveis.</span><span class="sxs-lookup"><span data-stu-id="76db9-177">While the [Text](uiauto-implementingtextandtextrange.md) control pattern supports many text attributes and embedded objects, it is not possible to define in advance all possible document elements and presentation types.</span></span> <span data-ttu-id="76db9-178">Para elementos de documento que não são suportados pelos atributos existentes ou tipos de controle padrão, os provedores podem usar os recursos de extensibilidade fornecidos pelo tipo de controle **personalizado** de automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="76db9-178">For document elements that are not supported by the existing attributes or standard control types, providers can use the extensibility features provided by the UI Automation **Custom** control type.</span></span>

<span data-ttu-id="76db9-179">Para aplicativos e interfaces do usuário que são baseados em apresentações de página, a apresentação de limite e de layout de "Page" também pode ser expressa como um objeto incorporado que tem um tipo de controle personalizado (ou seja, `LocalizedControlType="page"` ).</span><span class="sxs-lookup"><span data-stu-id="76db9-179">For applications and user interfaces that are based on page presentations, the boundary and layout presentation of "page" can also be expressed as an embedded object that has a custom control type (that is, `LocalizedControlType="page"`).</span></span> <span data-ttu-id="76db9-180">Dessa forma, o objeto incorporado pode hospedar outros elementos de página que não podem facilmente fazer parte do fluxo de texto do documento, como os campos de cabeçalho e rodapé de cada página, como filhos do objeto incorporado "Page".</span><span class="sxs-lookup"><span data-stu-id="76db9-180">That way, the embedded object can host other page elements that cannot easily be part of the document text stream, such as the header and footer fields of each page, as children of the "page" embedded object.</span></span> <span data-ttu-id="76db9-181">Como alternativa, cada objeto "Page" pode dar suporte ao padrão de controle de [texto](uiauto-implementingtextandtextrange.md) de forma independente, o que funciona bem para aplicativos como ferramentas de criação para apresentações de apresentação de slides ou ambientes de publicação de área de trabalho baseados em página.</span><span class="sxs-lookup"><span data-stu-id="76db9-181">Alternatively, each "page" object can support the [Text](uiauto-implementingtextandtextrange.md) control pattern independently, which works well for applications such as authoring tools for slide show presentations, or page-based desktop publishing environments.</span></span>

## <a name="lifetime-of-a-text-range"></a><span data-ttu-id="76db9-182">Tempo de vida de um intervalo de texto</span><span class="sxs-lookup"><span data-stu-id="76db9-182">Lifetime of a Text Range</span></span>

<span data-ttu-id="76db9-183">Se possível, um provedor deve garantir que qualquer alteração de texto, como exclusões, inserções e movimentações, seja refletida no intervalo de texto associado.</span><span class="sxs-lookup"><span data-stu-id="76db9-183">If possible, a provider should ensure that any text changes, such as deletions, insertions, and moves, are reflected in the associated text range.</span></span> <span data-ttu-id="76db9-184">Se a atualização do intervalo de texto não for possível, o provedor deverá gerar um evento [**\_ \_ TextChangedEventId de texto UIA**](uiauto-event-ids.md) para notificar os clientes de que o intervalo de texto não é mais válido e um novo deve ser recuperado.</span><span class="sxs-lookup"><span data-stu-id="76db9-184">If updating the text range is not possible, the provider should raise a [**UIA\_Text\_TextChangedEventId**](uiauto-event-ids.md) event to notify clients that the text range is no longer valid and a new one must be retrieved.</span></span>

## <a name="related-topics"></a><span data-ttu-id="76db9-185">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="76db9-185">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="76db9-186">**Conceitua**</span><span class="sxs-lookup"><span data-stu-id="76db9-186">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="76db9-187">Como a automação da IU dá suporte a objetos inseridos</span><span class="sxs-lookup"><span data-stu-id="76db9-187">How UI Automation Supports Embedded Objects</span></span>](uiauto-textpattern-and-embedded-objects-overview.md)
</dt> <dt>

[<span data-ttu-id="76db9-188">Visão Geral de Padrões de Controle de Automação de Interface de Usuário</span><span class="sxs-lookup"><span data-stu-id="76db9-188">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="76db9-189">Suporte à automação da interface do usuário para conteúdo textual</span><span class="sxs-lookup"><span data-stu-id="76db9-189">UI Automation Support for Textual Content</span></span>](uiauto-ui-automation-textpattern-overview.md)
</dt> <dt>

[<span data-ttu-id="76db9-190">Trabalhando com controles baseados em texto</span><span class="sxs-lookup"><span data-stu-id="76db9-190">Working with Text-based Controls</span></span>](uiauto-workingwithtextbasedcontrols.md)
</dt> <dt>

<span data-ttu-id="76db9-191">**Outros recursos**</span><span class="sxs-lookup"><span data-stu-id="76db9-191">**Other Resources**</span></span>
</dt> <dt>

[<span data-ttu-id="76db9-192">Estrutura de serviços de texto</span><span class="sxs-lookup"><span data-stu-id="76db9-192">Text Services Framework</span></span>](/windows/desktop/TSF/text-services-framework)
</dt> </dl>

 

 