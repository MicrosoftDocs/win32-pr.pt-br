---
title: Arrastar padrão de controle
description: Fornece diretrizes e convenções para implementar o padrão de controle de arrastar usando IDragProvider, incluindo informações sobre propriedades e métodos. O padrão de controle de arrastar é usado para dar suporte a controles arrastáveis ou controles com itens arrastáveis.
ms.assetid: 9853E9CB-D04B-4F67-8E9E-7F1F99BACEA7
keywords:
- Automação da interface do usuário, implementando o padrão de controle de arrastar
- Automação da interface do usuário, arrastar padrão de controle
- Automação da interface do usuário, IDragProvider
- IDragProvider
- implementação da automação da interface do usuário arrastar padrões de controle
- Arrastar padrões de controle
- padrões de controle, IDragProvider
- padrões de controle, implementação da automação da interface do usuário
- padrões de controle, arraste
- interfaces, IDragProvider
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 548f0212eca37e1890596143f27e9af70e1fb19a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104007769"
---
# <a name="drag-control-pattern"></a><span data-ttu-id="bb4b1-114">Arrastar padrão de controle</span><span class="sxs-lookup"><span data-stu-id="bb4b1-114">Drag Control Pattern</span></span>

<span data-ttu-id="bb4b1-115">Fornece diretrizes e convenções para implementar o padrão de controle de **arrastar** usando [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider), incluindo informações sobre propriedades e métodos.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-115">Provides guidelines and conventions for implementing the **Drag** control pattern by using [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider), including information about properties and methods.</span></span> <span data-ttu-id="bb4b1-116">O padrão de controle de **arrastar** é usado para dar suporte a controles arrastáveis ou controles com itens arrastáveis.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-116">The **Drag** control pattern is used to support draggable controls, or controls with draggable items.</span></span>

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="bb4b1-117">Diretrizes e convenções de implementação</span><span class="sxs-lookup"><span data-stu-id="bb4b1-117">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="bb4b1-118">Ao implementar o padrão de controle de **arrastar** , use estas diretrizes e convenções:</span><span class="sxs-lookup"><span data-stu-id="bb4b1-118">When implementing the **Drag** control pattern, use these guidelines and conventions:</span></span>

-   <span data-ttu-id="bb4b1-119">A interface [**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) dá suporte a dois estilos de arrastar diferentes: o estilo de origem/destino e o estilo somente origem.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-119">The [**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) interface supports two different dragging styles: the source/target style, and the source-only style.</span></span> <span data-ttu-id="bb4b1-120">Você precisa escolher o estilo que funciona melhor para seus cenários de arrastar e soltar:</span><span class="sxs-lookup"><span data-stu-id="bb4b1-120">You need to choose the style that works best for your drag-and-drop scenarios:</span></span>
    -   <span data-ttu-id="bb4b1-121">**Estilo de origem/destino:** Cada destino possível drop é representado por um elemento que implementa a interface [**IDropTargetProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idroptargetprovider) .</span><span class="sxs-lookup"><span data-stu-id="bb4b1-121">**Source/target style:** Each possible drop target is represented by an element that implements the [**IDropTargetProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idroptargetprovider) interface.</span></span> <span data-ttu-id="bb4b1-122">Durante uma operação de arrastar, os eventos de automação da interface do usuário da Microsoft originam-se do elemento que está sendo arrastado e dos elementos de destino.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-122">During a drag operation, Microsoft UI Automation events originate from the element that is being dragged, and from the drop-target elements.</span></span>
    -   <span data-ttu-id="bb4b1-123">**Estilo somente de origem:** Os destinos de destino não são representados pelos elementos de automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-123">**Source-only style:** Drop targets are not represented by UI Automation elements.</span></span> <span data-ttu-id="bb4b1-124">Durante uma operação de arrastar, os eventos se originam apenas do elemento que está sendo arrastado.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-124">During a drag operation, events originate only from the element that is being dragged.</span></span>
-   <span data-ttu-id="bb4b1-125">[**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) é uma interface somente leitura destinada ao monitoramento de operações de arrastar.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-125">[**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) is a read-only interface intended for monitoring drag operations.</span></span> <span data-ttu-id="bb4b1-126">Você não pode usá-lo para controlar uma operação de arrastar.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-126">You cannot use it to control a drag operation.</span></span> <span data-ttu-id="bb4b1-127">Você pode automatizar operações de arrastar enviando a entrada do mouse para um controle.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-127">You can automate drag operations by sending mouse input to a control.</span></span>
-   <span data-ttu-id="bb4b1-128">A propriedade [**IDragProvider:: iscapturado**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) é necessária.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-128">The [**IDragProvider::IsGrabbed**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) property is required.</span></span>
-   <span data-ttu-id="bb4b1-129">As propriedades [**IDragProvider::D ropeffect**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) e [**IDragProvider::D ropeffects**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects) são necessárias para uma implementação de estilo somente de origem e são proibidas para uma implementação de estilo de origem/destino.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-129">The [**IDragProvider::DropEffect**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) and [**IDragProvider::DropEffects**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects) properties are required for a source-only style implementation, and prohibited for a source/target style implementation.</span></span> <span data-ttu-id="bb4b1-130">Em uma implementação de estilo de origem/destino, elementos de destino podem ser consultados para seus efeitos de soltar.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-130">In a source/target style implementation, drop-target elements can be queried for their drop effects.</span></span>
-   <span data-ttu-id="bb4b1-131">A propriedade [**IDragProvider:: GrabbedItems**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems) representa o arrasto de vários itens.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-131">The [**IDragProvider::GrabbedItems**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems) property represents the dragging of multiple items.</span></span> <span data-ttu-id="bb4b1-132">Quando o usuário inicia a operação de arrastar, você precisa criar um novo elemento de automação de interface do usuário para servir como o elemento de origem do evento.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-132">When the user begins the drag operation, you need to create a new UI Automation element to serve as the event source element.</span></span> <span data-ttu-id="bb4b1-133">Esse novo elemento dispara todos os eventos que o elemento de origem teria acionado no modo de origem/destino ou somente de origem, enquanto nenhum dos elementos que realmente estão sendo arrastados aciona qualquer evento.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-133">This new element fires all events that the source element would have fired in either the source/target or source-only mode, while none of the elements that are actually being dragged fire any events.</span></span> <span data-ttu-id="bb4b1-134">Quando a operação de arrastar for concluída, destrua o elemento de origem do evento.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-134">When the drag operation is complete, destroy the event source element.</span></span>
-   <span data-ttu-id="bb4b1-135">O elemento deve acionar eventos de propriedade alterada para as propriedades **DropEffect** ([**UIA \_ DragDropEffectPropertyId**](uiauto-control-pattern-propids.md)) e **DropEffects** ([**UIA \_ DragDropEffectsPropertyId**](uiauto-control-pattern-propids.md)) quando elas forem alteradas.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-135">The element must fire property-changed events for the **DropEffect** ([**UIA\_DragDropEffectPropertyId**](uiauto-control-pattern-propids.md)) and **DropEffects** ([**UIA\_DragDropEffectsPropertyId**](uiauto-control-pattern-propids.md)) properties when they change.</span></span> <span data-ttu-id="bb4b1-136">Eventos de propriedade alterada para as outras propriedades são permitidos, mas podem ser inferidos dos eventos obrigatórios **DragStart** ([**UIA \_ Drag \_ DragStartEventId**](uiauto-event-ids.md)), **DragCancel** ([**UIA \_ Arraste \_ DragCancelEventId**](uiauto-event-ids.md)) e **DragComplete** ([**UIA \_ Drag \_ DragCompleteEventId**](uiauto-event-ids.md)).</span><span class="sxs-lookup"><span data-stu-id="bb4b1-136">Property-changed events for the other properties are allowed, but can be inferred from the required **DragStart** ([**UIA\_Drag\_DragStartEventId**](uiauto-event-ids.md)), **DragCancel** ([**UIA\_Drag\_DragCancelEventId**](uiauto-event-ids.md)), and **DragComplete** ([**UIA\_Drag\_DragCompleteEventId**](uiauto-event-ids.md)) events.</span></span>
-   

## <a name="required-members-for-idragprovider"></a><span data-ttu-id="bb4b1-137">Membros necessários para **IDragProvider**</span><span class="sxs-lookup"><span data-stu-id="bb4b1-137">Required Members for **IDragProvider**</span></span>

<span data-ttu-id="bb4b1-138">As propriedades e os métodos a seguir são necessários para implementar a interface [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider) .</span><span class="sxs-lookup"><span data-stu-id="bb4b1-138">The following properties and methods are required for implementing the [**IDragProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider) interface.</span></span>



| <span data-ttu-id="bb4b1-139">Membros necessários</span><span class="sxs-lookup"><span data-stu-id="bb4b1-139">Required members</span></span>                                                                        | <span data-ttu-id="bb4b1-140">Tipo de membro</span><span class="sxs-lookup"><span data-stu-id="bb4b1-140">Member type</span></span> | <span data-ttu-id="bb4b1-141">Observações</span><span class="sxs-lookup"><span data-stu-id="bb4b1-141">Notes</span></span>                                                                         |
|-----------------------------------------------------------------------------------------|-------------|-------------------------------------------------------------------------------|
| [<span data-ttu-id="bb4b1-142">**Iscapturado**</span><span class="sxs-lookup"><span data-stu-id="bb4b1-142">**IsGrabbed**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed)                                     | <span data-ttu-id="bb4b1-143">Propriedade</span><span class="sxs-lookup"><span data-stu-id="bb4b1-143">Property</span></span>    | <span data-ttu-id="bb4b1-144">Nenhum</span><span class="sxs-lookup"><span data-stu-id="bb4b1-144">None</span></span>                                                                          |
| [<span data-ttu-id="bb4b1-145">**DropEffect**</span><span class="sxs-lookup"><span data-stu-id="bb4b1-145">**DropEffect**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect)                                   | <span data-ttu-id="bb4b1-146">Propriedade</span><span class="sxs-lookup"><span data-stu-id="bb4b1-146">Property</span></span>    | <span data-ttu-id="bb4b1-147">Necessário para uma implementação do estilo somente origem.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-147">Required for an implementation of the source-only style.</span></span>                      |
| [<span data-ttu-id="bb4b1-148">**DropEffects**</span><span class="sxs-lookup"><span data-stu-id="bb4b1-148">**DropEffects**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects)                                 | <span data-ttu-id="bb4b1-149">Propriedade</span><span class="sxs-lookup"><span data-stu-id="bb4b1-149">Property</span></span>    | <span data-ttu-id="bb4b1-150">Necessário se houver mais de um possível efeito de soltar para o item capturado.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-150">Required if there is more than one possible drop effect for the grabbed item.</span></span> |
| [<span data-ttu-id="bb4b1-151">**GetGrabbedItems**</span><span class="sxs-lookup"><span data-stu-id="bb4b1-151">**GetGrabbedItems**</span></span>](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems)                         | <span data-ttu-id="bb4b1-152">Método</span><span class="sxs-lookup"><span data-stu-id="bb4b1-152">Method</span></span>      | <span data-ttu-id="bb4b1-153">Necessário para uma operação de arrastar com vários itens.</span><span class="sxs-lookup"><span data-stu-id="bb4b1-153">Required for a multiple-item drag operation.</span></span>                                  |
| [<span data-ttu-id="bb4b1-154">**UIA \_ arrastar \_ DragStartEventId**</span><span class="sxs-lookup"><span data-stu-id="bb4b1-154">**UIA\_Drag\_DragStartEventId**</span></span>](uiauto-event-ids.md)       | <span data-ttu-id="bb4b1-155">Evento</span><span class="sxs-lookup"><span data-stu-id="bb4b1-155">Event</span></span>       | <span data-ttu-id="bb4b1-156">Nenhum</span><span class="sxs-lookup"><span data-stu-id="bb4b1-156">None</span></span>                                                                          |
| [<span data-ttu-id="bb4b1-157">**UIA \_ arrastar \_ DragCancelEventId**</span><span class="sxs-lookup"><span data-stu-id="bb4b1-157">**UIA\_Drag\_DragCancelEventId**</span></span>](uiauto-event-ids.md)     | <span data-ttu-id="bb4b1-158">Evento</span><span class="sxs-lookup"><span data-stu-id="bb4b1-158">Event</span></span>       | <span data-ttu-id="bb4b1-159">Nenhum</span><span class="sxs-lookup"><span data-stu-id="bb4b1-159">None</span></span>                                                                          |
| [<span data-ttu-id="bb4b1-160">**UIA \_ arrastar \_ DragCompleteEventId**</span><span class="sxs-lookup"><span data-stu-id="bb4b1-160">**UIA\_Drag\_DragCompleteEventId**</span></span>](uiauto-event-ids.md) | <span data-ttu-id="bb4b1-161">Evento</span><span class="sxs-lookup"><span data-stu-id="bb4b1-161">Event</span></span>       | <span data-ttu-id="bb4b1-162">Nenhum</span><span class="sxs-lookup"><span data-stu-id="bb4b1-162">None</span></span>                                                                          |



 

## <a name="related-topics"></a><span data-ttu-id="bb4b1-163">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="bb4b1-163">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="bb4b1-164">Tipos de controle e seus padrões de controle com suporte</span><span class="sxs-lookup"><span data-stu-id="bb4b1-164">Control Types and their Supported Control Patterns</span></span>](uiauto-controlpatternmapping.md)
</dt> <dt>

[<span data-ttu-id="bb4b1-165">Padrão de controle DropTarget</span><span class="sxs-lookup"><span data-stu-id="bb4b1-165">DropTarget Control Pattern</span></span>](/windows/desktop/WinAuto/uiauto-implementingdroptarget)
</dt> <dt>

[<span data-ttu-id="bb4b1-166">Visão Geral de Padrões de Controle de Automação de Interface de Usuário</span><span class="sxs-lookup"><span data-stu-id="bb4b1-166">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="bb4b1-167">Visão geral da árvore de automação de interface do usuário</span><span class="sxs-lookup"><span data-stu-id="bb4b1-167">UI Automation Tree Overview</span></span>](uiauto-treeoverview.md)
</dt> <dt>

[<span data-ttu-id="bb4b1-168">Suporte à automação da interface do usuário para arrastar e soltar</span><span class="sxs-lookup"><span data-stu-id="bb4b1-168">UI Automation Support for Drag-and-Drop</span></span>](ui-automation-support-for-drag-and-drop.md)
</dt> </dl>

 

 