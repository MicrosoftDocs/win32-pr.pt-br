---
title: Visão geral de WinEvents e Acessibilidade Ativa
description: Os servidores do Microsoft Acessibilidade Ativa geram WinEvents para notificar os clientes quando um objeto acessível é alterado.
ms.assetid: a2d486ee-84ef-4c44-a832-dbc0dae81542
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b351b1ce7b6337c4ca0ac0827daff2978c6611af
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/29/2020
ms.locfileid: "103916941"
---
# <a name="winevents-and-active-accessibility"></a><span data-ttu-id="57e58-103">WinEvents e Acessibilidade Ativa</span><span class="sxs-lookup"><span data-stu-id="57e58-103">WinEvents and Active Accessibility</span></span>

<span data-ttu-id="57e58-104">Os servidores do Microsoft Acessibilidade Ativa geram *WinEvents* para notificar os clientes quando um objeto acessível é alterado.</span><span class="sxs-lookup"><span data-stu-id="57e58-104">Microsoft Active Accessibility servers raise *WinEvents* to notify clients when an accessible object changes.</span></span> <span data-ttu-id="57e58-105">Há várias condições em que um servidor notifica um cliente sobre uma alteração.</span><span class="sxs-lookup"><span data-stu-id="57e58-105">There are numerous conditions in which a server notifies a client of a change.</span></span> <span data-ttu-id="57e58-106">Cada [constante de evento](event-constants.md) definida pelo Microsoft acessibilidade ativa descreve uma condição sobre a qual um cliente é notificado.</span><span class="sxs-lookup"><span data-stu-id="57e58-106">Each [event constant](event-constants.md) defined by Microsoft Active Accessibility describes a condition about which a client is notified.</span></span> <span data-ttu-id="57e58-107">Por exemplo, WinEvents pode sinalizar:</span><span class="sxs-lookup"><span data-stu-id="57e58-107">For example, WinEvents can signal:</span></span>

- <span data-ttu-id="57e58-108">Quando um objeto é criado ou destruído.</span><span class="sxs-lookup"><span data-stu-id="57e58-108">When an object is created or destroyed.</span></span>
- <span data-ttu-id="57e58-109">Quando um objeto recebe ou perde o foco.</span><span class="sxs-lookup"><span data-stu-id="57e58-109">When an object receives or loses focus.</span></span>
- <span data-ttu-id="57e58-110">Quando o estado ou o local de um objeto é alterado.</span><span class="sxs-lookup"><span data-stu-id="57e58-110">When the state or location of an object changes.</span></span>
- <span data-ttu-id="57e58-111">Quando qualquer propriedade de um objeto é alterada.</span><span class="sxs-lookup"><span data-stu-id="57e58-111">When any property of an object changes.</span></span>

<span data-ttu-id="57e58-112">Os aplicativos cliente não recebem notificações de eventos automaticamente; Eles devem especificar quais eventos eles desejam receber chamando a função [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook) .</span><span class="sxs-lookup"><span data-stu-id="57e58-112">Client applications do not receive event notifications automatically; they must specify which events they want to receive by calling the [**SetWinEventHook**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook) function.</span></span> <span data-ttu-id="57e58-113">Com o **SetWinEventHook**, um cliente registra para receber um ou mais eventos e define uma função de Hook para manipular os eventos especificados.</span><span class="sxs-lookup"><span data-stu-id="57e58-113">With **SetWinEventHook**, a client registers to receive one or more events and sets a hook function to handle the specified events.</span></span> <span data-ttu-id="57e58-114">Os clientes podem usar a mesma função de gancho para lidar com vários tipos de eventos ou podem usar funções de gancho multipe.</span><span class="sxs-lookup"><span data-stu-id="57e58-114">Clients can use the same hook function to handle multiple types of events, or it can use multipe hook functions.</span></span> <span data-ttu-id="57e58-115">Os clientes chamam o **SetWinEventHook** uma vez para cada função de gancho que precisa registrar.</span><span class="sxs-lookup"><span data-stu-id="57e58-115">Clients call the **SetWinEventHook** once for each hook function it needs to register.</span></span>

<span data-ttu-id="57e58-116">As funções de gancho estão localizadas no corpo do código do cliente, em uma DLL mapeada no processo do cliente ou em uma DLL mapeada no processo do servidor.</span><span class="sxs-lookup"><span data-stu-id="57e58-116">Hook functions are located within the client's code body, in a DLL mapped into the client's process, or in a DLL mapped into the server's process.</span></span> <span data-ttu-id="57e58-117">Cada um desses métodos tem vantagens e desvantagens.</span><span class="sxs-lookup"><span data-stu-id="57e58-117">Each of these methods has advantages and disadvantages.</span></span> <span data-ttu-id="57e58-118">Para obter mais informações, consulte [funções de gancho em contexto e fora de contexto](in-context-and-out-of-context-hook-functions.md).</span><span class="sxs-lookup"><span data-stu-id="57e58-118">For more information, see [In-Context and Out-of-Context Hook Functions](in-context-and-out-of-context-hook-functions.md).</span></span>

<span data-ttu-id="57e58-119">Para notificar os clientes sobre uma ocorrência de evento, os servidores chamam [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent).</span><span class="sxs-lookup"><span data-stu-id="57e58-119">To notify clients of an event occurrence, servers call [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent).</span></span> <span data-ttu-id="57e58-120">O sistema verifica se algum aplicativo cliente definiu funções de gancho para o evento e chama as funções de gancho apropriadas conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="57e58-120">The system checks whether any client applications have set hook functions for the event and calls the appropriate hook functions as necessary.</span></span>

<span data-ttu-id="57e58-121">Quando a função de gancho do cliente é chamada, ela recebe um número de parâmetros que descrevem o evento e o objeto que gerou o evento.</span><span class="sxs-lookup"><span data-stu-id="57e58-121">When the client's hook function is called, it receives a number of parameters that describe the event and the object that generated the event.</span></span> <span data-ttu-id="57e58-122">Para obter acesso ao objeto que gerou o evento, a função de gancho do cliente chama [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent).</span><span class="sxs-lookup"><span data-stu-id="57e58-122">To gain access to the object that generated the event, the client hook function calls [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent).</span></span>

> [!NOTE]
> <span data-ttu-id="57e58-123">Se nenhum cliente tiver se registrado para receber WinEvents, o impacto no desempenho em um servidor para chamar [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) será insignificante.</span><span class="sxs-lookup"><span data-stu-id="57e58-123">If no clients have registered to receive WinEvents, the performance impact on a server for calling [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) is negligible.</span></span>
>
> <span data-ttu-id="57e58-124">Os servidores chamam [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) para alterações somente em seus próprios objetos acessíveis; Eles não chamam **NotifyWinEvent** para alterações nos elementos da interface do usuário fornecidos pelo sistema.</span><span class="sxs-lookup"><span data-stu-id="57e58-124">Servers call [**NotifyWinEvent**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) for changes only in their own accessible objects; they do not call **NotifyWinEvent** for changes in system-provided user interface elements.</span></span>

## <a name="event-driven-communication"></a><span data-ttu-id="57e58-125">Event-Driven comunicação</span><span class="sxs-lookup"><span data-stu-id="57e58-125">Event-Driven Communication</span></span>

<span data-ttu-id="57e58-126">Os clientes devem registrar um gancho de WinEvent antes que possam receber notificações de WinEvent.</span><span class="sxs-lookup"><span data-stu-id="57e58-126">Clients must register a WinEvent hook before they can receive WinEvent notifications.</span></span> <span data-ttu-id="57e58-127">Para evitar retornos de chamada desnecessários e melhorar o desempenho, os clientes são aconselhados a registrar somente os eventos que precisam receber.</span><span class="sxs-lookup"><span data-stu-id="57e58-127">To avoid unnecessary callbacks and improve performance, clients are advised to register only for the events they need to receive.</span></span>

<span data-ttu-id="57e58-128">Dentro do procedimento de gancho, o cliente pode chamar [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) para recuperar um objeto [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) para o elemento ao qual o evento se aplica.</span><span class="sxs-lookup"><span data-stu-id="57e58-128">Inside the hook procedure, the client can call [**AccessibleObjectFromEvent**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) to retrieve an [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) object for the element to which the event applies.</span></span> <span data-ttu-id="57e58-129">Com esse objeto, o cliente pode começar a chamar métodos de **IAccessible** para recuperar informações ou interagir com o elemento de interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="57e58-129">With this object, the client can begin calling **IAccessible** methods to retrieve information or interact with the UI element.</span></span>

## <a name="related-topics"></a><span data-ttu-id="57e58-130">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="57e58-130">Related topics</span></span>

[<span data-ttu-id="57e58-131">WinEvents</span><span class="sxs-lookup"><span data-stu-id="57e58-131">WinEvents</span></span>](winevents-infrastructure.md)
