---
title: Cache de propriedades de automação da interface do usuário e padrões de controle
description: Ao usar a automação da interface do usuário da Microsoft, os clientes geralmente precisam recuperar várias propriedades para vários elementos de automação.
ms.assetid: 948b3bb9-75a9-4197-9680-e6fe7bb86feb
keywords:
- cache, propriedades de automação da interface do usuário
- cache, propriedades
- Caching, padrões de controle de automação da interface do usuário
- cache, padrões de controle
- Automação da interface do usuário, propriedades de cache
- Automação da interface do usuário, cache de propriedades
- clientes, cache propriedades de automação da interface do usuário
- clientes, cache de padrões de controle de automação da interface do usuário
- Automação da interface do usuário, padrões de controle de cache
- Automação da interface do usuário, cache de padrão de controle
- padrões de controle, Caching
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 69f75a7dc9491565fdfdc0ecc73808c2fb6a9d82
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104363814"
---
# <a name="caching-ui-automation-properties-and-control-patterns"></a><span data-ttu-id="de0ed-114">Cache de propriedades de automação da interface do usuário e padrões de controle</span><span class="sxs-lookup"><span data-stu-id="de0ed-114">Caching UI Automation Properties and Control Patterns</span></span>

<span data-ttu-id="de0ed-115">Ao usar a automação da interface do usuário da Microsoft, os clientes geralmente precisam recuperar várias propriedades para vários elementos de automação.</span><span class="sxs-lookup"><span data-stu-id="de0ed-115">When using Microsoft UI Automation, clients often need to retrieve multiple properties for multiple automation elements.</span></span> <span data-ttu-id="de0ed-116">Um cliente pode recuperar propriedades individuais de um elemento por vez usando os métodos de recuperação de propriedade, como [**IUIAutomationElement:: CurrentName**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentname) ou [**CurrentAccessKey**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentaccesskey).</span><span class="sxs-lookup"><span data-stu-id="de0ed-116">A client could retrieve individual properties one element at a time by using the property retrieval methods such as [**IUIAutomationElement::CurrentName**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentname) or [**CurrentAccessKey**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentaccesskey).</span></span> <span data-ttu-id="de0ed-117">No entanto, esse método é lento e ineficiente porque requer uma chamada de processo cruzado para cada propriedade que está sendo recuperada.</span><span class="sxs-lookup"><span data-stu-id="de0ed-117">However, this method is slow and inefficient because it requires a cross-process call for each property being retrieved.</span></span> <span data-ttu-id="de0ed-118">Para melhorar o desempenho, os clientes podem usar os recursos de cache (também chamados de busca em massa) da automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="de0ed-118">To improve performance, clients can use the caching (also called bulk fetching) capabilities of UI Automation.</span></span> <span data-ttu-id="de0ed-119">O Caching permite que um cliente recupere todas as propriedades desejadas para todos os elementos desejados com uma única chamada de método.</span><span class="sxs-lookup"><span data-stu-id="de0ed-119">Caching enables a client to retrieve all of the desired properties for all of the desired elements with a single method call.</span></span> <span data-ttu-id="de0ed-120">O cliente pode então recuperar as propriedades individuais do cache conforme necessário e pode obter um novo instantâneo do cache periodicamente, geralmente em resposta a eventos que significam alterações na interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="de0ed-120">The client can then retrieve the individual properties from the cache as needed, and can get a new snapshot of the cache periodically, generally in response to events that signify changes in the UI.</span></span>

<span data-ttu-id="de0ed-121">O aplicativo pode solicitar o Caching ao recuperar um elemento de automação da interface do usuário usando um método, como [**IUIAutomation:: ElementFromPointBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompointbuildcache), [**IUIAutomationTreeWalker:: GetFirstChildElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-getfirstchildelementbuildcache)ou [**IUIAutomationElement:: FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache).</span><span class="sxs-lookup"><span data-stu-id="de0ed-121">The application can request caching when it retrieves a UI Automation element by using a method, such as [**IUIAutomation::ElementFromPointBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-elementfrompointbuildcache), [**IUIAutomationTreeWalker::GetFirstChildElementBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtreewalker-getfirstchildelementbuildcache), or [**IUIAutomationElement::FindFirstBuildCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirstbuildcache).</span></span>

<span data-ttu-id="de0ed-122">O Caching também ocorre quando você especifica uma solicitação de cache ao assinar eventos.</span><span class="sxs-lookup"><span data-stu-id="de0ed-122">Caching also occurs when you specify a cache request while subscribing to events.</span></span> <span data-ttu-id="de0ed-123">O elemento de automação da interface do usuário passado para o manipulador de eventos como a origem de um evento contém as propriedades armazenadas em cache e os padrões de controle que são especificados pela solicitação de cache.</span><span class="sxs-lookup"><span data-stu-id="de0ed-123">The UI Automation element passed to your event handler as the source of an event contains the cached properties and control patterns that are specified by the cache request.</span></span> <span data-ttu-id="de0ed-124">As alterações feitas na solicitação de cache depois que você assina o evento não têm nenhum efeito.</span><span class="sxs-lookup"><span data-stu-id="de0ed-124">Any changes made to the cache request after you subscribe to the event have no effect.</span></span>

<span data-ttu-id="de0ed-125">Este tópico inclui as seções a seguir.</span><span class="sxs-lookup"><span data-stu-id="de0ed-125">This topic contains the following sections.</span></span>

-   [<span data-ttu-id="de0ed-126">Solicitações de cache</span><span class="sxs-lookup"><span data-stu-id="de0ed-126">Cache Requests</span></span>](#cache-requests)
    -   [<span data-ttu-id="de0ed-127">Especificando padrões de propriedade e de controle para armazenar em cache</span><span class="sxs-lookup"><span data-stu-id="de0ed-127">Specifying Property and Control Patterns to Cache</span></span>](#specifying-property-and-control-patterns-to-cache)
    -   [<span data-ttu-id="de0ed-128">Especificando o escopo e a filtragem de uma solicitação de cache</span><span class="sxs-lookup"><span data-stu-id="de0ed-128">Specifying the Scoping and Filtering of a Caching Request</span></span>](#specifying-the-scoping-and-filtering-of-a-caching-request)
    -   [<span data-ttu-id="de0ed-129">Força das referências de elemento</span><span class="sxs-lookup"><span data-stu-id="de0ed-129">Strength of Element References</span></span>](#strength-of-element-references)
-   [<span data-ttu-id="de0ed-130">Recuperando filhos e pais armazenados em cache</span><span class="sxs-lookup"><span data-stu-id="de0ed-130">Retrieving Cached Children and Parents</span></span>](#retrieving-cached-children-and-parents)
-   [<span data-ttu-id="de0ed-131">Recuperando um novo instantâneo do cache</span><span class="sxs-lookup"><span data-stu-id="de0ed-131">Retrieving a New Snapshot of the Cache</span></span>](#retrieving-a-new-snapshot-of-the-cache)
-   [<span data-ttu-id="de0ed-132">Exemplos</span><span class="sxs-lookup"><span data-stu-id="de0ed-132">Examples</span></span>](#examples)
-   [<span data-ttu-id="de0ed-133">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="de0ed-133">Related topics</span></span>](#related-topics)

## <a name="cache-requests"></a><span data-ttu-id="de0ed-134">Solicitações de cache</span><span class="sxs-lookup"><span data-stu-id="de0ed-134">Cache Requests</span></span>

<span data-ttu-id="de0ed-135">O Caching envolve determinar quais propriedades recuperar e quais elementos os quais recuperar e, em seguida, usar essas informações para criar uma solicitação de cache.</span><span class="sxs-lookup"><span data-stu-id="de0ed-135">Caching involves determining which properties to retrieve and which elements to retrieve them from, and then using this information to create a cache request.</span></span> <span data-ttu-id="de0ed-136">Sempre que o cliente obtém uma interface [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) para o item da interface do usuário, a automação da interface do usuário armazena em cache as informações especificadas na solicitação de cache.</span><span class="sxs-lookup"><span data-stu-id="de0ed-136">Whenever the client obtains an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) interface for UI item, UI Automation caches the information that is specified in the cache request.</span></span>

<span data-ttu-id="de0ed-137">Para criar uma solicitação de cache, comece usando o método [**IUIAutomation:: createcacherequest**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createcacherequest) para recuperar um ponteiro de interface [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) .</span><span class="sxs-lookup"><span data-stu-id="de0ed-137">To create a cache request, begin by using the [**IUIAutomation::CreateCacheRequest**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-createcacherequest) method to retrieve an [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) interface pointer.</span></span> <span data-ttu-id="de0ed-138">Em seguida, configure a solicitação de cache usando os métodos de **IUIAutomationCacheRequest**.</span><span class="sxs-lookup"><span data-stu-id="de0ed-138">Next, configure the cache request by using the methods of **IUIAutomationCacheRequest**.</span></span>

### <a name="specifying-property-and-control-patterns-to-cache"></a><span data-ttu-id="de0ed-139">Especificando padrões de propriedade e de controle para armazenar em cache</span><span class="sxs-lookup"><span data-stu-id="de0ed-139">Specifying Property and Control Patterns to Cache</span></span>

<span data-ttu-id="de0ed-140">Você pode especificar propriedades para armazenar em cache chamando [**IUIAutomationCacheRequest:: AddProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addproperty).</span><span class="sxs-lookup"><span data-stu-id="de0ed-140">You can specify properties to cache by calling [**IUIAutomationCacheRequest::AddProperty**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addproperty).</span></span> <span data-ttu-id="de0ed-141">Você pode especificar padrões de controle para cache chamando [**IUIAutomationCacheRequest:: addpattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addpattern).</span><span class="sxs-lookup"><span data-stu-id="de0ed-141">You can specify control patterns to cache by calling [**IUIAutomationCacheRequest::AddPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-addpattern).</span></span> <span data-ttu-id="de0ed-142">Quando um padrão de controle é armazenado em cache, suas propriedades não são armazenadas em cache automaticamente; Você deve especificar as propriedades que deseja armazenar em cache usando **AddProperty**.</span><span class="sxs-lookup"><span data-stu-id="de0ed-142">When a control pattern is cached, its properties are not automatically cached; you must specify the properties you want to cache by using **AddProperty**.</span></span>

<span data-ttu-id="de0ed-143">Você pode recuperar uma propriedade de padrão de controle (por exemplo, a propriedade Value do padrão de controle [Value](uiauto-implementingvalue.md) ), sem precisar recuperar todo o padrão de controle no cache.</span><span class="sxs-lookup"><span data-stu-id="de0ed-143">You can retrieve a control pattern property (for example, the Value property of the [Value](uiauto-implementingvalue.md) control pattern), without having to retrieve the entire control pattern into the cache.</span></span> <span data-ttu-id="de0ed-144">Você deve recuperar o padrão de controle somente se precisar usar um método de padrão de controle.</span><span class="sxs-lookup"><span data-stu-id="de0ed-144">You must retrieve the control pattern only if you need to use a control pattern method.</span></span>

### <a name="specifying-the-scoping-and-filtering-of-a-caching-request"></a><span data-ttu-id="de0ed-145">Especificando o escopo e a filtragem de uma solicitação de cache</span><span class="sxs-lookup"><span data-stu-id="de0ed-145">Specifying the Scoping and Filtering of a Caching Request</span></span>

<span data-ttu-id="de0ed-146">Você pode especificar os elementos cujas propriedades e padrões de controle você deseja armazenar em cache definindo a propriedade [**IUIAutomationCacheRequest:: TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) antes de usar a solicitação.</span><span class="sxs-lookup"><span data-stu-id="de0ed-146">You can specify the elements whose properties and control patterns you want to cache by setting the [**IUIAutomationCacheRequest::TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) property before using the request.</span></span> <span data-ttu-id="de0ed-147">O escopo é relativo aos elementos que são recuperados pelo método para o qual a solicitação de cache é passada.</span><span class="sxs-lookup"><span data-stu-id="de0ed-147">The scope is relative to the elements that are retrieved by the method to which the cache request is passed.</span></span> <span data-ttu-id="de0ed-148">Por exemplo, se você definir apenas [**\_ filhos TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope)e, em seguida, recuperar um elemento de automação da interface do usuário, as propriedades e os padrões de controle dos filhos desse elemento serão armazenados em cache, mas as propriedades e os padrões de controle do elemento em si não serão armazenados em cache.</span><span class="sxs-lookup"><span data-stu-id="de0ed-148">For example, if you set only [**TreeScope\_Children**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope), and then retrieve a UI Automation element, the properties and control patterns of children of that element are cached, but the properties and control patterns of the element itself are not cached.</span></span> <span data-ttu-id="de0ed-149">Para garantir que o cache seja feito para o próprio elemento recuperado, você deve incluir o **\_ elemento TreeScope** na propriedade **IUIAutomationCacheRequest:: TreeScope** .</span><span class="sxs-lookup"><span data-stu-id="de0ed-149">To ensure that caching is done for the retrieved element itself, you must include **TreeScope\_Element** in the **IUIAutomationCacheRequest::TreeScope** property.</span></span> <span data-ttu-id="de0ed-150">Não é possível definir o escopo para **\_ ancestrais** **\_ pai** ou TreeScope TreeScope.</span><span class="sxs-lookup"><span data-stu-id="de0ed-150">It is not possible to set the scope to **TreeScope\_Parent** or **TreeScope\_Ancestors**.</span></span> <span data-ttu-id="de0ed-151">No entanto, um elemento pai pode ser armazenado em cache quando um elemento filho é armazenado em cache; consulte Recuperando filhos e pais em cache neste tópico.</span><span class="sxs-lookup"><span data-stu-id="de0ed-151">However, a parent element can be cached when a child element is cached; see Retrieving Cached Children and Parents in this topic.</span></span>

<span data-ttu-id="de0ed-152">A extensão do cache também é afetada pela propriedade [**IUIAutomationCacheRequest:: TreeFilter**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treefilter) .</span><span class="sxs-lookup"><span data-stu-id="de0ed-152">The extent of caching is also affected by the [**IUIAutomationCacheRequest::TreeFilter**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treefilter) property.</span></span> <span data-ttu-id="de0ed-153">Por padrão, o cache é executado somente para elementos que aparecem na exibição de controle da árvore de automação da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="de0ed-153">By default, caching is performed only for elements that appear in the control view of the UI Automation tree.</span></span> <span data-ttu-id="de0ed-154">No entanto, você pode alterar essa propriedade para aplicar o cache a todos os elementos ou somente a elementos que aparecem na exibição de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="de0ed-154">However, you can change this property to apply caching to all elements, or only to elements that appear in the content view.</span></span>

### <a name="strength-of-element-references"></a><span data-ttu-id="de0ed-155">Força das referências de elemento</span><span class="sxs-lookup"><span data-stu-id="de0ed-155">Strength of Element References</span></span>

<span data-ttu-id="de0ed-156">Quando você recupera um elemento de automação, por padrão, você tem acesso a todas as propriedades e padrões de controle desse elemento, incluindo as propriedades e os padrões de controle que não foram armazenados em cache.</span><span class="sxs-lookup"><span data-stu-id="de0ed-156">When you retrieve an automation element, by default you have access to all properties and control patterns of that element, including those properties and control patterns that were not cached.</span></span> <span data-ttu-id="de0ed-157">No entanto, você pode especificar que a referência ao elemento se refere somente a dados armazenados em cache, definindo a propriedade [**IUIAutomationCacheRequest:: AutomationElementMode**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_automationelementmode) como **AutomationElementMode \_ None**.</span><span class="sxs-lookup"><span data-stu-id="de0ed-157">However, you can specify that the reference to the element refers to cached data only, by setting the [**IUIAutomationCacheRequest::AutomationElementMode**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_automationelementmode) property to **AutomationElementMode\_None**.</span></span> <span data-ttu-id="de0ed-158">Nesse caso, você não tem acesso a nenhuma propriedade não armazenada em cache e padrões de controle dos elementos recuperados.</span><span class="sxs-lookup"><span data-stu-id="de0ed-158">In this case, you do not have access to any uncached properties and control patterns of retrieved elements.</span></span> <span data-ttu-id="de0ed-159">Isso significa que você não pode acessar nenhuma propriedade atual, como [**IUIAutomationElement:: CurrentIsEnabled**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentisenabled) ou recuperar um padrão de controle usando [**IUIAutomationElement:: GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern).</span><span class="sxs-lookup"><span data-stu-id="de0ed-159">This means that you cannot access any current properties such as [**IUIAutomationElement::CurrentIsEnabled**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentisenabled) or retrieve a control pattern by using [**IUIAutomationElement::GetCurrentPattern**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcurrentpattern).</span></span> <span data-ttu-id="de0ed-160">Em padrões de controle armazenados em cache, você não pode chamar métodos que executam ações no controle, como [**IUIAutomationInvokePattern:: Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span><span class="sxs-lookup"><span data-stu-id="de0ed-160">On cached control patterns, you cannot call methods that perform actions on the control, such as [**IUIAutomationInvokePattern::Invoke**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationinvokepattern-invoke).</span></span>

<span data-ttu-id="de0ed-161">Um exemplo de um aplicativo que pode não precisar de referências completas a objetos é um leitor de tela, que pode fazer prefetch das propriedades de tipo de nome e de controle de elementos em uma janela sem precisar dos próprios objetos de elemento de automação.</span><span class="sxs-lookup"><span data-stu-id="de0ed-161">An example of an application that might not need full references to objects is a screen reader, which might prefetch the name and control type properties of elements in a window without needing the automation element objects themselves.</span></span>

## <a name="retrieving-cached-children-and-parents"></a><span data-ttu-id="de0ed-162">Recuperando filhos e pais armazenados em cache</span><span class="sxs-lookup"><span data-stu-id="de0ed-162">Retrieving Cached Children and Parents</span></span>

<span data-ttu-id="de0ed-163">Quando você recupera um elemento Automation e solicita o cache para os filhos desse elemento por meio da propriedade [**IUIAutomationCacheRequest:: TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) da solicitação, é possível obter os elementos filho chamando [**IUIAutomationElement:: GetCachedChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedchildren) no elemento que você recuperou.</span><span class="sxs-lookup"><span data-stu-id="de0ed-163">When you retrieve an automation element and request caching for children of that element through the [**IUIAutomationCacheRequest::TreeScope**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationcacherequest-get_treescope) property of the request, it is possible to get the child elements by calling [**IUIAutomationElement::GetCachedChildren**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedchildren) on the element you retrieved.</span></span>

<span data-ttu-id="de0ed-164">Se [**o \_ elemento TreeScope**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) foi incluído no escopo da solicitação de cache, o elemento raiz da solicitação poderá ser recuperado chamando [**IUIAutomationElement:: GetCachedParent**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedparent) em qualquer um dos elementos filho.</span><span class="sxs-lookup"><span data-stu-id="de0ed-164">If [**TreeScope\_Element**](/windows/desktop/api/UIAutomationClient/ne-uiautomationclient-treescope) was included in the scope of the cache request, the root element of the request can be retrieved by calling [**IUIAutomationElement::GetCachedParent**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedparent) on any of the child elements.</span></span>

> [!Note]  
> <span data-ttu-id="de0ed-165">Você não pode armazenar em cache pais ou ancestrais do elemento raiz da solicitação.</span><span class="sxs-lookup"><span data-stu-id="de0ed-165">You cannot cache parents or ancestors of the root element of the request.</span></span>

 

## <a name="retrieving-a-new-snapshot-of-the-cache"></a><span data-ttu-id="de0ed-166">Recuperando um novo instantâneo do cache</span><span class="sxs-lookup"><span data-stu-id="de0ed-166">Retrieving a New Snapshot of the Cache</span></span>

<span data-ttu-id="de0ed-167">O cache é válido somente quando nada é alterado na interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="de0ed-167">The cache is valid only as long as nothing changes in the UI.</span></span> <span data-ttu-id="de0ed-168">Seu aplicativo é responsável por recuperar um novo instantâneo do cache, normalmente, em resposta a eventos.</span><span class="sxs-lookup"><span data-stu-id="de0ed-168">Your application is responsible for retrieving a new snapshot of the cache, typically, in response to events.</span></span>

<span data-ttu-id="de0ed-169">Se você assinar um evento com uma solicitação de cache, obterá um novo instantâneo [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) do cache como a origem do evento sempre que seu manipulador de eventos for chamado.</span><span class="sxs-lookup"><span data-stu-id="de0ed-169">If you subscribe to an event with a cache request, you obtain an [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) new snapshot of the cache as the source of the event whenever your event handler is called.</span></span> <span data-ttu-id="de0ed-170">Você também pode recuperar um novo instantâneo de informações armazenadas em cache para um elemento chamando [**IUIAutomationElement:: BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache).</span><span class="sxs-lookup"><span data-stu-id="de0ed-170">You can also retrieve a new snapshot of cached information for an element by calling [**IUIAutomationElement::BuildUpdatedCache**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-buildupdatedcache).</span></span> <span data-ttu-id="de0ed-171">Você pode passar o [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) original para obter um novo instantâneo de todas as informações que foram anteriormente armazenadas em cache.</span><span class="sxs-lookup"><span data-stu-id="de0ed-171">You can pass in the original [**IUIAutomationCacheRequest**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationcacherequest) to get a new snapshot of all information that was previously cached.</span></span>

<span data-ttu-id="de0ed-172">A recuperação de um novo instantâneo do cache não modifica as propriedades de nenhuma referência de [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) existente.</span><span class="sxs-lookup"><span data-stu-id="de0ed-172">Retrieving a new snapshot of the cache does not modify the properties of any existing [**IUIAutomationElement**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) references.</span></span>

## <a name="examples"></a><span data-ttu-id="de0ed-173">Exemplos</span><span class="sxs-lookup"><span data-stu-id="de0ed-173">Examples</span></span>

<span data-ttu-id="de0ed-174">Para obter exemplos de código que mostram como usar os recursos de cache da automação da interface do usuário, consulte [como usar o Caching](uiauto-howto-use-caching.md).</span><span class="sxs-lookup"><span data-stu-id="de0ed-174">For code examples that show how to use the caching capabilities of UI Automation, see [How to Use Caching](uiauto-howto-use-caching.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="de0ed-175">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="de0ed-175">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="de0ed-176">**Conceitua**</span><span class="sxs-lookup"><span data-stu-id="de0ed-176">**Conceptual**</span></span>
</dt> <dt>

[<span data-ttu-id="de0ed-177">Visão Geral de Padrões de Controle de Automação de Interface de Usuário</span><span class="sxs-lookup"><span data-stu-id="de0ed-177">UI Automation Control Patterns Overview</span></span>](uiauto-controlpatternsoverview.md)
</dt> <dt>

[<span data-ttu-id="de0ed-178">Obtendo elementos da automação interface do usuário</span><span class="sxs-lookup"><span data-stu-id="de0ed-178">Obtaining UI Automation Elements</span></span>](uiauto-obtainingelements.md)
</dt> <dt>

[<span data-ttu-id="de0ed-179">Visão geral das propriedades de automação da interface do usuário</span><span class="sxs-lookup"><span data-stu-id="de0ed-179">UI Automation Properties Overview</span></span>](uiauto-propertiesoverview.md)
</dt> </dl>

 

 




