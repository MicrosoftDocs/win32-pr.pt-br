---
title: Desenvolvendo suplementos do IFilter
description: Você pode estender o Microsoft Windows Desktop Search (WDS) com suplementos de filtro, componentes que implementam o IFilterinterface, para incluir novos tipos de arquivo.
ms.assetid: 71dd515d-a73e-4e0a-b0da-c8a6209d09fe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 79f846cf2101eefc17b1e92fbd7992529a06fb43
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104454042"
---
# <a name="developing-ifilter-add-ins"></a><span data-ttu-id="75ffe-103">Desenvolvendo suplementos do IFilter</span><span class="sxs-lookup"><span data-stu-id="75ffe-103">Developing IFilter Add-ins</span></span>

> [!NOTE]
> <span data-ttu-id="75ffe-104">O Windows Desktop Search 2. x é uma tecnologia obsoleta que originalmente estava disponível como um suplemento para o Windows XP e o Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="75ffe-104">Windows Desktop Search 2.x is an obsolete technology that was originally available as an add-in for Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="75ffe-105">Em versões posteriores, use o [Windows Search](../search/-search-3x-wds-overview.md) em vez disso.</span><span class="sxs-lookup"><span data-stu-id="75ffe-105">On later releases, use [Windows Search](../search/-search-3x-wds-overview.md) instead.</span></span>

<span data-ttu-id="75ffe-106">Você pode estender o Microsoft Windows Desktop Search (WDS) com suplementos de filtro, componentes que implementam a interface [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter), para incluir novos tipos de arquivo.</span><span class="sxs-lookup"><span data-stu-id="75ffe-106">You can extend Microsoft Windows Desktop Search (WDS) with filter add-ins, components that implement the [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)interface, to include new file types.</span></span> <span data-ttu-id="75ffe-107">Os filtros são responsáveis por acessar e analisar dados em arquivos e retornar pares de propriedades e valores, bem como partes de texto para indexação.</span><span class="sxs-lookup"><span data-stu-id="75ffe-107">Filters are responsible for accessing and parsing data in files and for returning pairs of properties and values as well as chunks of text for indexing.</span></span> <span data-ttu-id="75ffe-108">Durante o processo de indexação, o WDS chama o filtro apropriado com a URL para cada arquivo ou item.</span><span class="sxs-lookup"><span data-stu-id="75ffe-108">During the indexing process, WDS calls the appropriate filter with the URL for each file or item.</span></span> <span data-ttu-id="75ffe-109">O filtro primeiro extrai metadados que correspondem às propriedades que são marcadas como recuperáveis no esquema do WDS, como título, tamanho do arquivo e data da última modificação.</span><span class="sxs-lookup"><span data-stu-id="75ffe-109">The filter first extracts metadata that corresponds to properties that are marked retrievable in the WDS schema, such as title, file size, and last modified date.</span></span> <span data-ttu-id="75ffe-110">Em seguida, ele quebra o conteúdo do item em partes do texto.</span><span class="sxs-lookup"><span data-stu-id="75ffe-110">Then it breaks the item content into chunks of text.</span></span> <span data-ttu-id="75ffe-111">O WDS adiciona as propriedades e o texto retornado pelo filtro ao catálogo.</span><span class="sxs-lookup"><span data-stu-id="75ffe-111">WDS adds the properties and text returned by the filter to the catalog.</span></span> <span data-ttu-id="75ffe-112">O WDS pode indexar qualquer tipo de arquivo para o qual ele tenha um filtro registrado.</span><span class="sxs-lookup"><span data-stu-id="75ffe-112">WDS can index any file type for which it has a registered filter.</span></span>

<span data-ttu-id="75ffe-113">Em algumas circunstâncias, você não precisa escrever um novo filtro.</span><span class="sxs-lookup"><span data-stu-id="75ffe-113">In some circumstances, you do not need to write a new filter.</span></span> <span data-ttu-id="75ffe-114">O WDS 2. x contém filtros para mais de 200 tipos de itens (incluindo itens de texto sem formatação, como HTML, XML e arquivos de código-fonte) e usa a mesma tecnologia de [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)que os serviços do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="75ffe-114">WDS 2.x contains filters for over 200 types of items (including plaintext items such as HTML, XML, and source code files) and uses the same [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)technology as SharePoint Services.</span></span> <span data-ttu-id="75ffe-115">Se você já tiver filtros instalados para os tipos de arquivo, o WDS poderá usar esses filtros existentes para indexar esses dados.</span><span class="sxs-lookup"><span data-stu-id="75ffe-115">If you already have filters installed for your file types, WDS can use those existing filters to index this data.</span></span> <span data-ttu-id="75ffe-116">Além disso, o WDS inclui um filtro geral para tipos de arquivos que são baseados em texto sem formatação.</span><span class="sxs-lookup"><span data-stu-id="75ffe-116">Furthermore, WDS includes a general filter for file types that are plaintext-based.</span></span> <span data-ttu-id="75ffe-117">Se você tiver um tipo de arquivo que possa ser processado por um filtro existente dos serviços do SharePoint ou o filtro de texto não criptografado, poderá adicionar a extensão de nome de arquivo e o GUID de filtro ao registro para que o WDS possa localizá-lo e usá-lo (consulte [para registrar um suplemento de filtro](#to-register-a-filter-add-in) para obter mais informações).</span><span class="sxs-lookup"><span data-stu-id="75ffe-117">If you have a file type that can be processed by either an existing SharePoint Services filter or the plaintext filter, you can add the file name extension and filter GUID to the Registry so WDS can locate and use it (see [To Register a Filter Add-in](#to-register-a-filter-add-in) for more information).</span></span>

<span data-ttu-id="75ffe-118">No entanto, se você tiver um formato de arquivo ou dados sem texto não criptografado e proprietário, escrever uma implementação de filtro personalizado será a única maneira de garantir que o WDS possa indexar o formato de arquivo no catálogo.</span><span class="sxs-lookup"><span data-stu-id="75ffe-118">If, however, you have a non-plaintext and proprietary data or file format, writing a custom filter implementation is the only way to ensure WDS can index the file format in the catalog.</span></span> <span data-ttu-id="75ffe-119">Você pode ter apenas um suplemento de filtro para um tipo de arquivo, portanto, é possível substituir um filtro existente ou fazer com que outro filtro substitua seu para um tipo de arquivo específico.</span><span class="sxs-lookup"><span data-stu-id="75ffe-119">You can have only one filter add-in for a file type, so it is possible to override an existing filter or to have another filter override yours for a specific file type.</span></span>

<span data-ttu-id="75ffe-120">Esta seção contém os seguintes tópicos:</span><span class="sxs-lookup"><span data-stu-id="75ffe-120">This section contains the following topics:</span></span>

-   [<span data-ttu-id="75ffe-121">Interfaces de filtro necessárias</span><span class="sxs-lookup"><span data-stu-id="75ffe-121">Required Filter Interfaces</span></span>](#required-filter-interfaces)
    -   [<span data-ttu-id="75ffe-122">Interface IFilter</span><span class="sxs-lookup"><span data-stu-id="75ffe-122">IFilter Interface</span></span>](#ifilter-interface)
    -   [<span data-ttu-id="75ffe-123">IPersistStream</span><span class="sxs-lookup"><span data-stu-id="75ffe-123">IPersistStream</span></span>](#ipersiststream)
    -   [<span data-ttu-id="75ffe-124">IPersistFile</span><span class="sxs-lookup"><span data-stu-id="75ffe-124">IPersistFile</span></span>](#ipersistfile)
    -   [<span data-ttu-id="75ffe-125">IPersistStorage</span><span class="sxs-lookup"><span data-stu-id="75ffe-125">IPersistStorage</span></span>](#ipersiststorage)
-   [<span data-ttu-id="75ffe-126">Propriedades de saída com filtros</span><span class="sxs-lookup"><span data-stu-id="75ffe-126">Outputting Properties with Filters</span></span>](#outputting-properties-with-filters)
    -   [<span data-ttu-id="75ffe-127">Valores de propriedade</span><span class="sxs-lookup"><span data-stu-id="75ffe-127">Property Values</span></span>](#property-values)
-   [<span data-ttu-id="75ffe-128">Instalação do suplemento de filtro</span><span class="sxs-lookup"><span data-stu-id="75ffe-128">Filter Add-in Installation</span></span>](#filter-add-in-installation)
    -   [<span data-ttu-id="75ffe-129">CLSIDs necessários para o registro</span><span class="sxs-lookup"><span data-stu-id="75ffe-129">CLSIDs Required for Registration</span></span>](#clsids-required-for-registration)
    -   [<span data-ttu-id="75ffe-130">Modelo de registro</span><span class="sxs-lookup"><span data-stu-id="75ffe-130">Registration Model</span></span>](#registration-model)
    -   [<span data-ttu-id="75ffe-131">Para registrar um suplemento de filtro</span><span class="sxs-lookup"><span data-stu-id="75ffe-131">To Register a Filter Add-in</span></span>](#to-register-a-filter-add-in)
-   [<span data-ttu-id="75ffe-132">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="75ffe-132">Related topics</span></span>](#related-topics)

## <a name="required-filter-interfaces"></a><span data-ttu-id="75ffe-133">Interfaces de filtro necessárias</span><span class="sxs-lookup"><span data-stu-id="75ffe-133">Required Filter Interfaces</span></span>

<span data-ttu-id="75ffe-134">Um suplemento de filtro deve implementar a interface [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)e uma das seguintes interfaces:</span><span class="sxs-lookup"><span data-stu-id="75ffe-134">A filter add-in must implement the [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)interface and one of the following interfaces:</span></span>

-   <span data-ttu-id="75ffe-135">[IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) -para carregar dados de um fluxo.</span><span class="sxs-lookup"><span data-stu-id="75ffe-135">[IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) - To load data from a stream.</span></span> <span data-ttu-id="75ffe-136">Isso é mais seguro do que usar arquivos porque nada é gravado em disco.</span><span class="sxs-lookup"><span data-stu-id="75ffe-136">This is more secure than using files because nothing is written to disk.</span></span> <span data-ttu-id="75ffe-137">A interface IPersistStream é o método preferencial para a compatibilidade de encaminhamento com o Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="75ffe-137">The IPersistStream interface is the preferred method for forward compatibility with Windows Vista.</span></span>
-   <span data-ttu-id="75ffe-138">[Interface IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) – para carregar dados de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="75ffe-138">[IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile) - To load data from a file.</span></span> <span data-ttu-id="75ffe-139">Não há suporte para essa interface no Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="75ffe-139">This interface is not supported in Windows Vista.</span></span>
-   <span data-ttu-id="75ffe-140">[Interface IPersistStorage](/windows/win32/api/objidl/nn-objidl-ipersiststorage) – para carregar dados de um armazenamento estruturado com OLE.</span><span class="sxs-lookup"><span data-stu-id="75ffe-140">[IPersistStorage Interface](/windows/win32/api/objidl/nn-objidl-ipersiststorage) - To load data from an OLE COM Structured Storage.</span></span>

<span data-ttu-id="75ffe-141">Um suplemento de filtro usa essas interfaces para obter o conteúdo do item e retorná-los iterativamente para o índice até que o final do arquivo seja atingido.</span><span class="sxs-lookup"><span data-stu-id="75ffe-141">A filter add-in uses these interfaces to get the contents of the item and return them iteratively to the index until the end of the file is reached.</span></span> <span data-ttu-id="75ffe-142">Um suplemento de filtro deve ser o mais robusto possível para lidar com arquivos corrompidos e aqueles que não atendem aos formatos de entrada esperados.</span><span class="sxs-lookup"><span data-stu-id="75ffe-142">A filter add-in should be as robust as possible to handle corrupt files and those that do not meet expected input formats.</span></span>

### <a name="ifilter-interface"></a><span data-ttu-id="75ffe-143">Interface IFilter</span><span class="sxs-lookup"><span data-stu-id="75ffe-143">IFilter Interface</span></span>

<span data-ttu-id="75ffe-144">Esta é uma interface necessária para uma implementação de filtro.</span><span class="sxs-lookup"><span data-stu-id="75ffe-144">This is a required interface for a filter implementation.</span></span> <span data-ttu-id="75ffe-145">Para obter mais informações, consulte a referência de interface do [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter).</span><span class="sxs-lookup"><span data-stu-id="75ffe-145">For more information, see the [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)interface reference.</span></span>



| <span data-ttu-id="75ffe-146">Método</span><span class="sxs-lookup"><span data-stu-id="75ffe-146">Method</span></span>       | <span data-ttu-id="75ffe-147">Descrição</span><span class="sxs-lookup"><span data-stu-id="75ffe-147">Description</span></span>                                                                            |
|--------------|----------------------------------------------------------------------------------------|
| <span data-ttu-id="75ffe-148">Init ()</span><span class="sxs-lookup"><span data-stu-id="75ffe-148">Init()</span></span>       | <span data-ttu-id="75ffe-149">Inicializa uma sessão de filtragem.</span><span class="sxs-lookup"><span data-stu-id="75ffe-149">Initializes a filtering session.</span></span>                                                       |
| <span data-ttu-id="75ffe-150">GetChunk ()</span><span class="sxs-lookup"><span data-stu-id="75ffe-150">GetChunk()</span></span>   | <span data-ttu-id="75ffe-151">Posiciona o filtro no início da primeira ou próxima parte e retorna um descritor.</span><span class="sxs-lookup"><span data-stu-id="75ffe-151">Positions the filter at the beginning of first or next chunk and returns a descriptor.</span></span> |
| <span data-ttu-id="75ffe-152">Gettext ()</span><span class="sxs-lookup"><span data-stu-id="75ffe-152">GetText()</span></span>    | <span data-ttu-id="75ffe-153">Recupera o texto da parte atual.</span><span class="sxs-lookup"><span data-stu-id="75ffe-153">Retrieves text from the current chunk.</span></span>                                                 |
| <span data-ttu-id="75ffe-154">GetValue ()</span><span class="sxs-lookup"><span data-stu-id="75ffe-154">GetValue()</span></span>   | <span data-ttu-id="75ffe-155">Recupera os valores de propriedade da parte atual.</span><span class="sxs-lookup"><span data-stu-id="75ffe-155">Retrieves property values from the current chunk.</span></span>                                      |
| <span data-ttu-id="75ffe-156">BindRegion()</span><span class="sxs-lookup"><span data-stu-id="75ffe-156">BindRegion()</span></span> | <span data-ttu-id="75ffe-157">Atualmente reservado para uso interno; Não implementar.</span><span class="sxs-lookup"><span data-stu-id="75ffe-157">Currently reserved for internal use; do not implement.</span></span> <span data-ttu-id="75ffe-158">Esse método retorna E \_ NOTIMPL.</span><span class="sxs-lookup"><span data-stu-id="75ffe-158">This method returns E\_NOTIMPL.</span></span> |



 

### <a name="ipersiststream"></a><span data-ttu-id="75ffe-159">IPersistStream</span><span class="sxs-lookup"><span data-stu-id="75ffe-159">IPersistStream</span></span>

<span data-ttu-id="75ffe-160">Essa interface carrega um arquivo de um fluxo para um processamento mais seguro do que a [interface IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile) porque o contexto no qual um filtro [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) é executado não precisa dos direitos para abrir arquivos no disco ou pela rede.</span><span class="sxs-lookup"><span data-stu-id="75ffe-160">This interface loads a file from a stream for more secure processing than [IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile) because the context in which a [IPersistStream](/windows/win32/api/objidl/nn-objidl-ipersiststream) filter runs does not need the rights to open any files on the disk or over the network.</span></span> <span data-ttu-id="75ffe-161">Dos dois métodos para acessar um único arquivo, esse é o método preferencial para a compatibilidade de encaminhamento com o Windows.</span><span class="sxs-lookup"><span data-stu-id="75ffe-161">Of the two methods for accessing a single file, this is the preferred method for forward compatibility with Windows.</span></span>



| <span data-ttu-id="75ffe-162">Método</span><span class="sxs-lookup"><span data-stu-id="75ffe-162">Method</span></span>       | <span data-ttu-id="75ffe-163">Descrição</span><span class="sxs-lookup"><span data-stu-id="75ffe-163">Description</span></span>                                                                                                                                        |
|--------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="75ffe-164">IsDirty ()</span><span class="sxs-lookup"><span data-stu-id="75ffe-164">IsDirty()</span></span>    | <span data-ttu-id="75ffe-165">Verifica se houve uma alteração.</span><span class="sxs-lookup"><span data-stu-id="75ffe-165">Checks if there has been a change.</span></span> <span data-ttu-id="75ffe-166">Esse método retorna E \_ NOTIMPL em filtros.</span><span class="sxs-lookup"><span data-stu-id="75ffe-166">This method returns E\_NOTIMPL in filters.</span></span>                                                                      |
| <span data-ttu-id="75ffe-167">InitNew()</span><span class="sxs-lookup"><span data-stu-id="75ffe-167">InitNew()</span></span>    | <span data-ttu-id="75ffe-168">Cria um novo armazenamento.</span><span class="sxs-lookup"><span data-stu-id="75ffe-168">Creates a new storage.</span></span> <span data-ttu-id="75ffe-169">Esse método retorna E \_ NOTIMPL em filtros.</span><span class="sxs-lookup"><span data-stu-id="75ffe-169">This method returns E\_NOTIMPL in filters.</span></span>                                                                                  |
| <span data-ttu-id="75ffe-170">Carregar ()</span><span class="sxs-lookup"><span data-stu-id="75ffe-170">Load()</span></span>       | <span data-ttu-id="75ffe-171">Inicializa um objeto do fluxo de onde ele foi salvo anteriormente.</span><span class="sxs-lookup"><span data-stu-id="75ffe-171">Initializes an object from the stream where it was previously saved.</span></span>                                                                               |
| <span data-ttu-id="75ffe-172">Salvar ()</span><span class="sxs-lookup"><span data-stu-id="75ffe-172">Save()</span></span>       | <span data-ttu-id="75ffe-173">Salva um objeto no fluxo especificado e indica se o objeto deve redefinir seu sinalizador sujo.</span><span class="sxs-lookup"><span data-stu-id="75ffe-173">Saves an object into the specified stream and indicates whether the object should reset its dirty flag.</span></span> <span data-ttu-id="75ffe-174">Esse método retorna E \_ NOTIMPL em filtros.</span><span class="sxs-lookup"><span data-stu-id="75ffe-174">This method returns E\_NOTIMPL in filters.</span></span> |
| <span data-ttu-id="75ffe-175">GetSizeMax()</span><span class="sxs-lookup"><span data-stu-id="75ffe-175">GetSizeMax()</span></span> | <span data-ttu-id="75ffe-176">Retorna o tamanho em bytes do fluxo necessário para salvar o objeto.</span><span class="sxs-lookup"><span data-stu-id="75ffe-176">Returns the size in bytes of the stream needed to save the object.</span></span> <span data-ttu-id="75ffe-177">Esse método retorna E \_ NOTIMPL em filtros.</span><span class="sxs-lookup"><span data-stu-id="75ffe-177">This method returns E\_NOTIMPL in filters.</span></span>                                      |



 

### <a name="ipersistfile"></a><span data-ttu-id="75ffe-178">IPersistFile</span><span class="sxs-lookup"><span data-stu-id="75ffe-178">IPersistFile</span></span>

<span data-ttu-id="75ffe-179">Essa interface carrega um arquivo por caminho absoluto e não tem suporte no Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="75ffe-179">This interface loads a file by absolute path and is not supported in Windows Vista.</span></span>



| <span data-ttu-id="75ffe-180">Método</span><span class="sxs-lookup"><span data-stu-id="75ffe-180">Method</span></span>          | <span data-ttu-id="75ffe-181">Descrição</span><span class="sxs-lookup"><span data-stu-id="75ffe-181">Description</span></span>                                                                                                                  |
|-----------------|------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="75ffe-182">GetCurFile()</span><span class="sxs-lookup"><span data-stu-id="75ffe-182">GetCurFile()</span></span>    | <span data-ttu-id="75ffe-183">Obtém o nome atual do arquivo associado ao objeto.</span><span class="sxs-lookup"><span data-stu-id="75ffe-183">Gets the current name of the file associated with the object.</span></span> <span data-ttu-id="75ffe-184">Retorna o caminho especificado em Load ().</span><span class="sxs-lookup"><span data-stu-id="75ffe-184">Returns the path specified in Load().</span></span>                          |
| <span data-ttu-id="75ffe-185">Carregar ()</span><span class="sxs-lookup"><span data-stu-id="75ffe-185">Load()</span></span>          | <span data-ttu-id="75ffe-186">Abre o arquivo especificado e inicializa um objeto do conteúdo do arquivo.</span><span class="sxs-lookup"><span data-stu-id="75ffe-186">Opens the specified file and initializes an object from the file contents.</span></span> <span data-ttu-id="75ffe-187">Você pode atrasar a abertura do arquivo até precisar dele.</span><span class="sxs-lookup"><span data-stu-id="75ffe-187">You can delay opening the file until you need it.</span></span> |
| <span data-ttu-id="75ffe-188">GetClassID ()</span><span class="sxs-lookup"><span data-stu-id="75ffe-188">GetClassID()</span></span>    | <span data-ttu-id="75ffe-189">Retorna o identificador de classe (CLSID) para o novo tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="75ffe-189">Returns the class identifier (CLSID) for the new file type.</span></span> <span data-ttu-id="75ffe-190">Você deve usar uuidgen.exe para gerar um CLSID exclusivo.</span><span class="sxs-lookup"><span data-stu-id="75ffe-190">You should use uuidgen.exe to generate a unique CLSID.</span></span>           |
| <span data-ttu-id="75ffe-191">IsDirty ()</span><span class="sxs-lookup"><span data-stu-id="75ffe-191">IsDirty()</span></span>       | <span data-ttu-id="75ffe-192">Só é necessário retornar E \_ NOTIMPL em filtros</span><span class="sxs-lookup"><span data-stu-id="75ffe-192">Need only return E\_NOTIMPL in filters</span></span>                                                                                       |
| <span data-ttu-id="75ffe-193">Salvar ()</span><span class="sxs-lookup"><span data-stu-id="75ffe-193">Save()</span></span>          | <span data-ttu-id="75ffe-194">Só é necessário retornar E \_ NOTIMPL em filtros</span><span class="sxs-lookup"><span data-stu-id="75ffe-194">Need only return E\_NOTIMPL in filters</span></span>                                                                                       |
| <span data-ttu-id="75ffe-195">SaveCompleted()</span><span class="sxs-lookup"><span data-stu-id="75ffe-195">SaveCompleted()</span></span> | <span data-ttu-id="75ffe-196">Só é necessário retornar E \_ NOTIMPL em filtros</span><span class="sxs-lookup"><span data-stu-id="75ffe-196">Need only return E\_NOTIMPL in filters</span></span>                                                                                       |



 

### <a name="ipersiststorage"></a><span data-ttu-id="75ffe-197">IPersistStorage</span><span class="sxs-lookup"><span data-stu-id="75ffe-197">IPersistStorage</span></span>

<span data-ttu-id="75ffe-198">Essa interface dá suporte ao modelo de armazenamento estruturado, no qual cada objeto contido tem seu próprio armazenamento aninhado dentro do armazenamento do contêiner.</span><span class="sxs-lookup"><span data-stu-id="75ffe-198">This interface supports the structured storage model, in which each contained object has its own storage that is nested within the container's storage.</span></span> <span data-ttu-id="75ffe-199">Assim como a [interface IPersistFile](/windows/win32/api/objidl/nn-objidl-ipersistfile), essa interface é carregada por caminho absoluto e não tem suporte no Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="75ffe-199">Like [IPersistFile Interface](/windows/win32/api/objidl/nn-objidl-ipersistfile), this interface loads by absolute path and is not supported in Windows Vista.</span></span>



| <span data-ttu-id="75ffe-200">Método</span><span class="sxs-lookup"><span data-stu-id="75ffe-200">Method</span></span>            | <span data-ttu-id="75ffe-201">Descrição</span><span class="sxs-lookup"><span data-stu-id="75ffe-201">Description</span></span>                                                                                                   |
|-------------------|---------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="75ffe-202">IsDirty ()</span><span class="sxs-lookup"><span data-stu-id="75ffe-202">IsDirty()</span></span>         | <span data-ttu-id="75ffe-203">Verifica se houve uma alteração.</span><span class="sxs-lookup"><span data-stu-id="75ffe-203">Checks if there has been a change.</span></span> <span data-ttu-id="75ffe-204">Esse método retorna E \_ NOTIMPL em filtros.</span><span class="sxs-lookup"><span data-stu-id="75ffe-204">This method returns E\_NOTIMPL in filters.</span></span>                                 |
| <span data-ttu-id="75ffe-205">InitNew()</span><span class="sxs-lookup"><span data-stu-id="75ffe-205">InitNew()</span></span>         | <span data-ttu-id="75ffe-206">Cria um novo armazenamento.</span><span class="sxs-lookup"><span data-stu-id="75ffe-206">Creates a new storage.</span></span> <span data-ttu-id="75ffe-207">Esse método retorna E \_ NOTIMPL em filtros.</span><span class="sxs-lookup"><span data-stu-id="75ffe-207">This method returns E\_NOTIMPL in filters.</span></span>                                             |
| <span data-ttu-id="75ffe-208">Carregar ()</span><span class="sxs-lookup"><span data-stu-id="75ffe-208">Load()</span></span>            | <span data-ttu-id="75ffe-209">Salva o armazenamento.</span><span class="sxs-lookup"><span data-stu-id="75ffe-209">Saves the storage.</span></span> <span data-ttu-id="75ffe-210">Esse método retorna E \_ NOTIMPL em filtros.</span><span class="sxs-lookup"><span data-stu-id="75ffe-210">This method returns E\_NOTIMPL in filters.</span></span>                                                 |
| <span data-ttu-id="75ffe-211">Salvar ()</span><span class="sxs-lookup"><span data-stu-id="75ffe-211">Save()</span></span>            | <span data-ttu-id="75ffe-212">Retorna o tamanho em bytes do fluxo necessário para salvar o objeto.</span><span class="sxs-lookup"><span data-stu-id="75ffe-212">Returns the size in bytes of the stream needed to save the object.</span></span> <span data-ttu-id="75ffe-213">Esse método retorna E \_ NOTIMPL em filtros.</span><span class="sxs-lookup"><span data-stu-id="75ffe-213">This method returns E\_NOTIMPL in filters.</span></span> |
| <span data-ttu-id="75ffe-214">SaveCompleted()</span><span class="sxs-lookup"><span data-stu-id="75ffe-214">SaveCompleted()</span></span>   | <span data-ttu-id="75ffe-215">Reservado para uso interno.</span><span class="sxs-lookup"><span data-stu-id="75ffe-215">Reserved for internal use.</span></span> <span data-ttu-id="75ffe-216">Esse método retorna E \_ NOTIMPL em filtros.</span><span class="sxs-lookup"><span data-stu-id="75ffe-216">This method returns E\_NOTIMPL in filters.</span></span>                                         |
| <span data-ttu-id="75ffe-217">HandsOffStorage()</span><span class="sxs-lookup"><span data-stu-id="75ffe-217">HandsOffStorage()</span></span> | <span data-ttu-id="75ffe-218">Reservado para uso interno.</span><span class="sxs-lookup"><span data-stu-id="75ffe-218">Reserved for internal use.</span></span> <span data-ttu-id="75ffe-219">Esse método retorna E \_ NOTIMPL em filtros.</span><span class="sxs-lookup"><span data-stu-id="75ffe-219">This method returns E\_NOTIMPL in filters.</span></span>                                         |



 

## <a name="outputting-properties-with-filters"></a><span data-ttu-id="75ffe-220">Propriedades de saída com filtros</span><span class="sxs-lookup"><span data-stu-id="75ffe-220">Outputting Properties with Filters</span></span>

<span data-ttu-id="75ffe-221">A finalidade de um filtro é extrair o conteúdo e as propriedades dos arquivos para inclusão no índice de texto completo.</span><span class="sxs-lookup"><span data-stu-id="75ffe-221">The purpose of a filter is to extract the content and properties of files for inclusion in the full-text index.</span></span> <span data-ttu-id="75ffe-222">O WDS primeiro chama o método Load nas implementações IPersistFile, IPersistStream ou IPersistStorage e, em seguida, invoca o método Init da implementação do IFilter.</span><span class="sxs-lookup"><span data-stu-id="75ffe-222">WDS first calls the Load method on either the IPersistFile, IPersistStream, or IPersistStorage implementations and then invokes the Init method of the IFilter implementation.</span></span> <span data-ttu-id="75ffe-223">**GetChunk** é chamado para recuperar partes de dados de valor de texto ou propriedade e, em seguida, **gettext** ou **GetValue** é chamado quantas vezes forem necessárias para recuperar todos os valores de texto ou propriedade associados à parte.</span><span class="sxs-lookup"><span data-stu-id="75ffe-223">**GetChunk** is called to retrieve chunks of text or property value data, and then either **GetText** or **GetValue** is called as many times as needed to retrieve all of the text or property values associated with the chunk.</span></span> <span data-ttu-id="75ffe-224">Esse processo se repete até que **GetChunk** relate que não há mais partes no documento.</span><span class="sxs-lookup"><span data-stu-id="75ffe-224">This process repeats until **GetChunk** reports that there are no more chunks in the document.</span></span>

<span data-ttu-id="75ffe-225">O método **GetChunk** recupera informações sobre o primeiro ou o próximo bloco lógico de informações do arquivo que está sendo filtrado e retorna essas informações em uma estrutura de partes de estatística \_ , incluindo uma ID de parte de aumento monotônico, informações de status sobre como a parte atual está relacionada à parte anterior, um sinalizador que indica se a parte contém texto ou um valor, a localidade da parte e a especificação de</span><span class="sxs-lookup"><span data-stu-id="75ffe-225">The **GetChunk** method retrieves information about the first or next logical block of information from the file being filtered and returns that information in a STAT\_CHUNK structure, including a monotonically increasing chunk ID, status information about how the current chunk relates to the previous chunk, a flag indicating whether the chunk contains text or a value, the chunk's locale, and the chunk's property specification.</span></span> <span data-ttu-id="75ffe-226">A especificação de propriedade é um [**FULLPROPSPEC**](/windows/desktop/api/filter/ns-filter-fullpropspec) que consiste em um CLSID e um identificador de propriedade de cadeia de caracteres ou inteiro (por exemplo, D5CDD505-2E9C-101B-9397-08002B2CF9AE/percebidotype).</span><span class="sxs-lookup"><span data-stu-id="75ffe-226">The property specification is a [**FULLPROPSPEC**](/windows/desktop/api/filter/ns-filter-fullpropspec) consisting of a CLSID and either an integer or string property identifier (for example, D5CDD505-2E9C-101B-9397-08002B2CF9AE/PerceivedType).</span></span> <span data-ttu-id="75ffe-227">Ele identifica o tipo de propriedade em vez do próprio valor da propriedade.</span><span class="sxs-lookup"><span data-stu-id="75ffe-227">It identifies the type of property rather than the property value itself.</span></span>

<span data-ttu-id="75ffe-228">O identificador de localidade da parte é usado para escolher um separador de palavras apropriado e é muito importante que você o identifique corretamente.</span><span class="sxs-lookup"><span data-stu-id="75ffe-228">The chunk locale identifier is used to choose an appropriate word breaker, and it is very important that you correctly identify it.</span></span> <span data-ttu-id="75ffe-229">Se o filtro não puder determinar a localidade do texto, ele deverá assumir a localidade do sistema padrão, disponível usando **GetSystemDefaultLCID**.</span><span class="sxs-lookup"><span data-stu-id="75ffe-229">If the filter cannot determine the locale of the text, it should assume the default system locale, available by using **GetSystemDefaultLCID**.</span></span> <span data-ttu-id="75ffe-230">Se você controlar o formato de arquivo e ele não contiver informações de localidade, você deverá adicionar um recurso de usuário para habilitar a identificação de localidade adequada.</span><span class="sxs-lookup"><span data-stu-id="75ffe-230">If you control the file format and it currently does not contain locale information, you should add a user feature to enable proper locale identification.</span></span> <span data-ttu-id="75ffe-231">Usar um separador de palavras incompatível pode levar a uma experiência de consulta inadequada para o usuário.</span><span class="sxs-lookup"><span data-stu-id="75ffe-231">Using a mismatched word breaker can lead to a bad query experience for the user.</span></span>

<span data-ttu-id="75ffe-232">**GetChunk** só gerencia o acesso a partes e não retorna o valor de texto ou propriedade.</span><span class="sxs-lookup"><span data-stu-id="75ffe-232">**GetChunk** only manages accessing chunks and does not return the text or property value itself.</span></span> <span data-ttu-id="75ffe-233">Em vez disso, as chamadas subsequentes para **gettext** e **GetValue** recuperam o corpo da parte.</span><span class="sxs-lookup"><span data-stu-id="75ffe-233">Rather, subsequent calls to **GetText** and **GetValue** retrieve the body of the chunk.</span></span> <span data-ttu-id="75ffe-234">**Gettext** retorna partes de texto, que são cadeias de caracteres Unicode, da parte de texto da parte atual \_ .</span><span class="sxs-lookup"><span data-stu-id="75ffe-234">**GetText** returns text chunks, which are Unicode strings, from the current CHUNK\_TEXT chunk.</span></span> <span data-ttu-id="75ffe-235">Se a parte atual for muito grande, mais de uma chamada para o método **gettext** poderá ser necessária.</span><span class="sxs-lookup"><span data-stu-id="75ffe-235">If the current chunk is too large, more than one call to the **GetText** method can be required.</span></span> <span data-ttu-id="75ffe-236">Cada chamada para o método **gettext** recupera o texto que segue imediatamente o texto da última chamada para o método **gettext** .</span><span class="sxs-lookup"><span data-stu-id="75ffe-236">Each call to the **GetText** method retrieves text that immediately follows the text from the last call to the **GetText** method.</span></span> <span data-ttu-id="75ffe-237">Por exemplo, o último caractere de uma chamada pode estar no meio de uma palavra, e o primeiro caractere na próxima chamada continuaria a palavra.</span><span class="sxs-lookup"><span data-stu-id="75ffe-237">For example, the last character from one call can be in the middle of a word, and the first character in the next call would continue that word.</span></span> <span data-ttu-id="75ffe-238">Os mecanismos de pesquisa devem lidar com essa situação.</span><span class="sxs-lookup"><span data-stu-id="75ffe-238">Search engines must handle this situation.</span></span>

<span data-ttu-id="75ffe-239">**GetValue** retorna valores de propriedade para a parte do valor da parte atual \_ em estruturas PROPVARIANT, que pode conter uma ampla variedade de tipos de dados.</span><span class="sxs-lookup"><span data-stu-id="75ffe-239">**GetValue** returns property values for the current CHUNK\_VALUE chunk in PROPVARIANT structures, which can hold a wide variety of data types.</span></span> <span data-ttu-id="75ffe-240">**GetValue** deve alocar a estrutura PROPVARIANT em si usando CoTaskMemAlloc.</span><span class="sxs-lookup"><span data-stu-id="75ffe-240">**GetValue** must allocate the PROPVARIANT structure itself using CoTaskMemAlloc.</span></span> <span data-ttu-id="75ffe-241">O chamador de **GetValue** é responsável por liberar memória apontada pelo PROPVARIANT usando PropVariantClear e para liberar a estrutura em si com CoTaskMemFree.</span><span class="sxs-lookup"><span data-stu-id="75ffe-241">The caller of **GetValue** is responsible for freeing memory pointed to by the PROPVARIANT using PropVariantClear, and for freeing the structure itself with CoTaskMemFree.</span></span> <span data-ttu-id="75ffe-242">Para obter mais informações sobre o PROPVARIANTs, consulte a referência do [PROPVARIANT](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .</span><span class="sxs-lookup"><span data-stu-id="75ffe-242">For more information on PROPVARIANTs, see the [PROPVARIANT](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) reference.</span></span>

### <a name="property-values"></a><span data-ttu-id="75ffe-243">Valores da propriedade</span><span class="sxs-lookup"><span data-stu-id="75ffe-243">Property Values</span></span>

<span data-ttu-id="75ffe-244">Os filtros devem produzir no mínimo as propriedades a seguir, que são as colunas padrão na exibição de resultados do WDS.</span><span class="sxs-lookup"><span data-stu-id="75ffe-244">Filters should output at a minimum the following properties which are the default columns in the WDS results view.</span></span>



| <span data-ttu-id="75ffe-245">GUID</span><span class="sxs-lookup"><span data-stu-id="75ffe-245">GUID</span></span>                                 | <span data-ttu-id="75ffe-246">PROPSPEC</span><span class="sxs-lookup"><span data-stu-id="75ffe-246">PROPSPEC</span></span>      | <span data-ttu-id="75ffe-247">Nome amigável</span><span class="sxs-lookup"><span data-stu-id="75ffe-247">Friendly Name</span></span>  | <span data-ttu-id="75ffe-248">Descrição</span><span class="sxs-lookup"><span data-stu-id="75ffe-248">Description</span></span>                                                                                                                                     |
|--------------------------------------|---------------|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="75ffe-249">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span><span class="sxs-lookup"><span data-stu-id="75ffe-249">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span></span> | <span data-ttu-id="75ffe-250">2</span><span class="sxs-lookup"><span data-stu-id="75ffe-250">2</span></span>             | <span data-ttu-id="75ffe-251">PrimaryTitle</span><span class="sxs-lookup"><span data-stu-id="75ffe-251">PrimaryTitle</span></span>   | <span data-ttu-id="75ffe-252">Título que é exibido para este item.</span><span class="sxs-lookup"><span data-stu-id="75ffe-252">Title that displays for this item.</span></span>                                                                                                              |
| <span data-ttu-id="75ffe-253">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span><span class="sxs-lookup"><span data-stu-id="75ffe-253">F29F85E0-4FF9-1068-AB91-08002B27B3D9</span></span> | <span data-ttu-id="75ffe-254">4</span><span class="sxs-lookup"><span data-stu-id="75ffe-254">4</span></span>             | <span data-ttu-id="75ffe-255">PrimaryAuthors</span><span class="sxs-lookup"><span data-stu-id="75ffe-255">PrimaryAuthors</span></span> | <span data-ttu-id="75ffe-256">Pessoa mais associada a este item.</span><span class="sxs-lookup"><span data-stu-id="75ffe-256">Person most associated with this item.</span></span>                                                                                                          |
| <span data-ttu-id="75ffe-257">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span><span class="sxs-lookup"><span data-stu-id="75ffe-257">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span></span> | <span data-ttu-id="75ffe-258">PrimaryDate</span><span class="sxs-lookup"><span data-stu-id="75ffe-258">PrimaryDate</span></span>   | <span data-ttu-id="75ffe-259">PrimaryDate</span><span class="sxs-lookup"><span data-stu-id="75ffe-259">PrimaryDate</span></span>    | <span data-ttu-id="75ffe-260">Data mais importante para o item, como data de recebimento de email ou modificado para arquivos.</span><span class="sxs-lookup"><span data-stu-id="75ffe-260">Most important date for item, like date received for email or modified for files.</span></span>                                                               |
| <span data-ttu-id="75ffe-261">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span><span class="sxs-lookup"><span data-stu-id="75ffe-261">D5CDD505-2E9C-101B-9397-08002B2CF9AE</span></span> | <span data-ttu-id="75ffe-262">PerceivedType</span><span class="sxs-lookup"><span data-stu-id="75ffe-262">PerceivedType</span></span> | <span data-ttu-id="75ffe-263">PerceivedType</span><span class="sxs-lookup"><span data-stu-id="75ffe-263">PerceivedType</span></span>  | <span data-ttu-id="75ffe-264">Tipo de arquivo que está sendo analisado.</span><span class="sxs-lookup"><span data-stu-id="75ffe-264">Type of file being parsed.</span></span> <span data-ttu-id="75ffe-265">Deve corresponder a um dos tipos de pesquisa da área de trabalho do Windows listados no [tipo percebido](-search-2x-wds-perceivedtype.md)pelo WDS.</span><span class="sxs-lookup"><span data-stu-id="75ffe-265">Must match one of the Windows Desktop Search types listed in WDS [Perceived Type](-search-2x-wds-perceivedtype.md).</span></span> |



 

<span data-ttu-id="75ffe-266">Para itens de texto não criptografado, o WDS extrai todas as propriedades definidas pelo sistema e pelo texto, como tamanho do arquivo ou extensão, incluindo novos tipos de arquivo de texto sem formatação para o índice).</span><span class="sxs-lookup"><span data-stu-id="75ffe-266">For plaintext items, WDS extracts all text and system-defined properties such as file size or extension on including new plaintext file types to the index).</span></span> <span data-ttu-id="75ffe-267">Outros tipos de propriedades que podem ser retornadas para o índice incluem:</span><span class="sxs-lookup"><span data-stu-id="75ffe-267">Other types of properties that can be returned to the index include:</span></span>

-   <span data-ttu-id="75ffe-268">Para arquivos: autor, título, status, palavras-chave</span><span class="sxs-lookup"><span data-stu-id="75ffe-268">For files: author, title, status, keywords</span></span>
-   <span data-ttu-id="75ffe-269">Para mídia: álbum, gênero, marca de câmera, data de uso</span><span class="sxs-lookup"><span data-stu-id="75ffe-269">For media: album, genre, camera make, date taken</span></span>
-   <span data-ttu-id="75ffe-270">Para comunicações: de, para, CC, importância</span><span class="sxs-lookup"><span data-stu-id="75ffe-270">For communications: from, to, cc, importance</span></span>
-   <span data-ttu-id="75ffe-271">Para contatos: cargo, telefone comercial, empresa</span><span class="sxs-lookup"><span data-stu-id="75ffe-271">For contacts: job title, business phone, company</span></span>

<span data-ttu-id="75ffe-272">A lista acima agrupa as propriedades comuns a um tipo percebido especificado; no entanto, qualquer propriedade pode ser usada independentemente do tipo.</span><span class="sxs-lookup"><span data-stu-id="75ffe-272">The list above groups properties common to a specified Perceived Type; however, any property can be used regardless of the type.</span></span> <span data-ttu-id="75ffe-273">Por exemplo, a empresa pode ser usada para o nome do empregador de um contato e também pode ser usada para se referir ao nome de um cliente ao qual o arquivo está relacionado.</span><span class="sxs-lookup"><span data-stu-id="75ffe-273">For example, company could be used for a contact's employer name and could also be used to refer to the name of a client the file relates to.</span></span> <span data-ttu-id="75ffe-274">Muitas dessas propriedades são usadas para exibir os resultados da pesquisa no modo de exibição de resultados do WDS.</span><span class="sxs-lookup"><span data-stu-id="75ffe-274">Many of these properties are used to display search results in the WDS results view.</span></span> <span data-ttu-id="75ffe-275">Por exemplo, a propriedade título de um arquivo é mostrada como a coluna principal na exibição de resultados padrão.</span><span class="sxs-lookup"><span data-stu-id="75ffe-275">For example, a file's Title property is shown as the main column in the default results view.</span></span> <span data-ttu-id="75ffe-276">Os objetos IFilter devem gerar todas as propriedades relacionadas ao tipo de item que estão analisando.</span><span class="sxs-lookup"><span data-stu-id="75ffe-276">IFilter objects should output all the properties related to the item type they are parsing.</span></span> <span data-ttu-id="75ffe-277">As propriedades personalizadas não podem ser adicionadas no WDS 2. x.</span><span class="sxs-lookup"><span data-stu-id="75ffe-277">Custom properties cannot be added in WDS 2.x.</span></span> <span data-ttu-id="75ffe-278">Para obter uma lista completa das propriedades disponíveis, consulte o [esquema do WDS](-search-2x-wds-schematable.md).</span><span class="sxs-lookup"><span data-stu-id="75ffe-278">For a full list of properties available, see the [WDS Schema](-search-2x-wds-schematable.md).</span></span>

## <a name="filter-add-in-installation"></a><span data-ttu-id="75ffe-279">Instalação do suplemento de filtro</span><span class="sxs-lookup"><span data-stu-id="75ffe-279">Filter Add-in Installation</span></span>

<span data-ttu-id="75ffe-280">A instalação do filtro envolve copiar a DLL para um local apropriado no diretório arquivos de programas e registrá-lo.</span><span class="sxs-lookup"><span data-stu-id="75ffe-280">Installing the filter involves copying the DLL to an appropriate location in the Program Files directory and registering it.</span></span> <span data-ttu-id="75ffe-281">Os filtros devem implementar o auto-registro para instalação e devem seguir estas diretrizes:</span><span class="sxs-lookup"><span data-stu-id="75ffe-281">Filters should implement self-registration for installation and should follow these guidelines:</span></span>

-   <span data-ttu-id="75ffe-282">O instalador deve usar o EXE ou o instalador MSI.</span><span class="sxs-lookup"><span data-stu-id="75ffe-282">The installer must use either EXE or MSI installer.</span></span>
-   <span data-ttu-id="75ffe-283">As notas de versão devem ser fornecidas.</span><span class="sxs-lookup"><span data-stu-id="75ffe-283">Release notes must be provided.</span></span>
-   <span data-ttu-id="75ffe-284">Uma entrada **Adicionar/remover programas** deve ser criada para cada suplemento instalado.</span><span class="sxs-lookup"><span data-stu-id="75ffe-284">An **Add/Remove Programs** entry must be created for each add-in installed.</span></span>
-   <span data-ttu-id="75ffe-285">O instalador deve assumir todas as configurações do registro para o tipo de arquivo específico ou o armazenamento que o suplemento atual compreende.</span><span class="sxs-lookup"><span data-stu-id="75ffe-285">The installer must take over all registry settings for the particular file type or store that the current add-in understands.</span></span>
-   <span data-ttu-id="75ffe-286">Se um suplemento anterior estiver sendo substituído, o instalador deverá notificar o usuário.</span><span class="sxs-lookup"><span data-stu-id="75ffe-286">If a previous add-in is being overwritten, the installer should notify the user.</span></span>
-   <span data-ttu-id="75ffe-287">Se um suplemento mais recente tiver substituído o suplemento anterior, deverá haver a capacidade de restaurar a funcionalidade do suplemento anterior e torná-lo o suplemento padrão para esse tipo de arquivo ou armazenar novamente.</span><span class="sxs-lookup"><span data-stu-id="75ffe-287">If a newer add-in has overwritten the previous add-in, there should be the ability to restore the previous add-in's functionality and make it the default add-in for that file type or store again.</span></span>

### <a name="clsids-required-for-registration"></a><span data-ttu-id="75ffe-288">CLSIDs necessários para o registro</span><span class="sxs-lookup"><span data-stu-id="75ffe-288">CLSIDs Required for Registration</span></span>

<span data-ttu-id="75ffe-289">Há três identificadores de classe, ou CLSIDs, associados a cada filtro.</span><span class="sxs-lookup"><span data-stu-id="75ffe-289">There are three class identifiers, or CLSIDs, associated with every filter.</span></span> <span data-ttu-id="75ffe-290">Você precisará gerar um ou mais desses (use uuidgen.exe) para registrar seu suplemento de filtro.</span><span class="sxs-lookup"><span data-stu-id="75ffe-290">You'll need to generate one or more of these (use uuidgen.exe) to register your filter add-in.</span></span>

-   <span data-ttu-id="75ffe-291">O primeiro identifica o manipulador persistente de todos os filtros, o IFilter de IID \_ , que é {89BCB740-6119-101A-BCB7-00DD010655AF}.</span><span class="sxs-lookup"><span data-stu-id="75ffe-291">The first identifies all filters' persistent handler, IID\_IFilter, which is {89BCB740-6119-101A-BCB7-00DD010655AF}.</span></span> <span data-ttu-id="75ffe-292">Esse CLSID é constante para todos os filtros que implementam IFilter.</span><span class="sxs-lookup"><span data-stu-id="75ffe-292">This CLSID is constant for all filters that implement IFilter.</span></span>
-   <span data-ttu-id="75ffe-293">O segundo (o valor da \_ chave IFilter do IID) identifica a implementação do IFilter para o tipo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="75ffe-293">The second (the value of the IID\_IFilter key) identifies the IFilter implementation for your file type.</span></span> <span data-ttu-id="75ffe-294">Essa chave contém um valor InprocServer32 que especifica o nome da DLL por caminho e o modelo de Threading.</span><span class="sxs-lookup"><span data-stu-id="75ffe-294">This key contains an InprocServer32 value that specifies the DLL name by path and the threading model.</span></span> <span data-ttu-id="75ffe-295">Se o filtro estiver no caminho do sistema, como o diretório system32, um nome de arquivo será suficiente.</span><span class="sxs-lookup"><span data-stu-id="75ffe-295">If the filter is in the system path, like the system32 directory, a file name is sufficient.</span></span> <span data-ttu-id="75ffe-296">Caso contrário, esse valor deve ter uma especificação de caminho completo.</span><span class="sxs-lookup"><span data-stu-id="75ffe-296">Otherwise, this value should have a full path specification.</span></span>
-   <span data-ttu-id="75ffe-297">O terceiro identifica o tipo de arquivo que o filtro processa e é retornado pelo método GetClassID em sua interface IPersist.</span><span class="sxs-lookup"><span data-stu-id="75ffe-297">The third identifies the file type the filter processes and is returned by the GetClassID method on your IPersist interface.</span></span>

> [!Note]
>
> <span data-ttu-id="75ffe-298">Em versões futuras dos sistemas operacionais da Microsoft, a instalação de arquivos no diretório system32 pode ser mais difícil, portanto, recomendamos que você os instale em arquivos de programas e inclua um caminho completo para o filtro no registro.</span><span class="sxs-lookup"><span data-stu-id="75ffe-298">In future versions of Microsoft operating systems, installing files in the system32 directory may get more difficult, so we recommend you install them under Program Files and include a full path to the filter in the registry.</span></span> <span data-ttu-id="75ffe-299">Por motivos de segurança, também é prudente especificar um caminho completo para a DLL no registro.</span><span class="sxs-lookup"><span data-stu-id="75ffe-299">For security reasons, it is also prudent to specify a full path to your DLL in the registry.</span></span> <span data-ttu-id="75ffe-300">Caso contrário, uma versão de "cavalo de Troia" de sua DLL poderia ser carregada se estiver no caminho do processo antes da sua versão.</span><span class="sxs-lookup"><span data-stu-id="75ffe-300">Otherwise, a "Trojan horse" version of your DLL could be loaded if it happens to be in the process path before your version.</span></span>

 

### <a name="registration-model"></a><span data-ttu-id="75ffe-301">Modelo de registro</span><span class="sxs-lookup"><span data-stu-id="75ffe-301">Registration Model</span></span>

<span data-ttu-id="75ffe-302">Quando o WDS está pronto para filtrar um arquivo, ele procura no registro na extensão do arquivo para determinar qual filtro deve ser carregado.</span><span class="sxs-lookup"><span data-stu-id="75ffe-302">When WDS is ready to filter a file, it looks in the registry under the file's extension to determine which filter to load.</span></span> <span data-ttu-id="75ffe-303">Em seguida, ele segue uma série de links de registro para localizar o nome da DLL de filtro, nesta ordem:</span><span class="sxs-lookup"><span data-stu-id="75ffe-303">It then follows a series of registry links to find the name of the filter DLL, in this order:</span></span>

1.  <span data-ttu-id="75ffe-304">De CLSIDs localizados em:</span><span class="sxs-lookup"><span data-stu-id="75ffe-304">From CLSIDs located at:</span></span>

    <span data-ttu-id="75ffe-305">**HKEY \_ Current \_ user \\ software \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters \\ override \\ RSApp**</span><span class="sxs-lookup"><span data-stu-id="75ffe-305">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters\\Override\\RSApp**</span></span>

    <span data-ttu-id="75ffe-306">**HKEY \_ Current \_ user \\ software \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters**</span><span class="sxs-lookup"><span data-stu-id="75ffe-306">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters**</span></span>

2.  <span data-ttu-id="75ffe-307">No tipo de conteúdo arquivo em:</span><span class="sxs-lookup"><span data-stu-id="75ffe-307">From the file content type at:</span></span>

    <span data-ttu-id="75ffe-308">**HKEY \_ local \_ Machine \\ software \\ classes \\ \\ tipo de conteúdo de banco de dados MIME \\**</span><span class="sxs-lookup"><span data-stu-id="75ffe-308">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\MIME\\Database\\Content Type**</span></span>

3.  <span data-ttu-id="75ffe-309">Na extensão de nome de arquivo (igual à API loadifilter do Win32) em:</span><span class="sxs-lookup"><span data-stu-id="75ffe-309">From the file name extension (same as Win32 LoadIFilter API) at:</span></span>

    <span data-ttu-id="75ffe-310">**HKEY \_ Current \_ user \\ software \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters \\ override \\ RSApp**</span><span class="sxs-lookup"><span data-stu-id="75ffe-310">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters\\Override\\RSApp**</span></span>

    <span data-ttu-id="75ffe-311">**HKEY \_ Current \_ user \\ software \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters**</span><span class="sxs-lookup"><span data-stu-id="75ffe-311">**HKEY\_CURRENT\_USER\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters**</span></span>

    <span data-ttu-id="75ffe-312">**HKEY \_ classes \_ raiz \\ EXTPERSISTENTHANDLER->CLSID->IFilter do IID \_ ->CLSID**</span><span class="sxs-lookup"><span data-stu-id="75ffe-312">**HKEY\_CLASSES\_ROOT\\extpersistentHandler->CLSID->IID\_IFilter->CLSID**</span></span>

4.  <span data-ttu-id="75ffe-313">De padrão em:</span><span class="sxs-lookup"><span data-stu-id="75ffe-313">From Default at:</span></span>

    <span data-ttu-id="75ffe-314">**HKEY \_ local \_ Machine \\ software \\ Microsoft \\ RSSearch \\ ContentIndexCommon \\ Filters**</span><span class="sxs-lookup"><span data-stu-id="75ffe-314">**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\RSSearch\\ContentIndexCommon\\Filters**</span></span>

### <a name="to-register-a-filter-add-in"></a><span data-ttu-id="75ffe-315">Para registrar um suplemento de filtro</span><span class="sxs-lookup"><span data-stu-id="75ffe-315">To Register a Filter Add-in</span></span>

<span data-ttu-id="75ffe-316">Você precisa fazer um total de oito entradas no registro para registrar seu suplemento de filtro, em que:</span><span class="sxs-lookup"><span data-stu-id="75ffe-316">You need to make a total of eight entries in the registry to register your filter add-in, where:</span></span>

-   <span data-ttu-id="75ffe-317">**. ext** é a nova extensão de nome de arquivo</span><span class="sxs-lookup"><span data-stu-id="75ffe-317">**.ext** is the new file name extension</span></span>
-   <span data-ttu-id="75ffe-318">O **GUID \_ 1** pode ser qualquer novo GUID gerado para esta extensão</span><span class="sxs-lookup"><span data-stu-id="75ffe-318">**GUID\_1** can be any new GUID generated for this extension</span></span>
-   <span data-ttu-id="75ffe-319">**89BCB740-6119-101A-BCB7-00DD010655AF** é o GUID da interface do IFilter, que é uma constante para todas as implementações de IFilter.</span><span class="sxs-lookup"><span data-stu-id="75ffe-319">**89BCB740-6119-101A-BCB7-00DD010655AF** is the IFilter interface GUID, which is a constant for all IFilter implementations.</span></span>

1.  <span data-ttu-id="75ffe-320">Registre o manipulador persistente para a extensão de nome de arquivo com as seguintes chaves e valores:</span><span class="sxs-lookup"><span data-stu-id="75ffe-320">Register the persistent handler for the file name extension with the following keys and values:</span></span>

    ```
    HKEY_CLASSES_ROOT\<.ext>\PersistentHandler
       (Default) = {GUID_1}
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}
       (Default) = <Persistent Handler Description>
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}\PersistentAddinsRegistered
       (Default) = (Value Not Set)
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}\PersistentAddinsRegistered\{89BCB740-6119-101A-BCB7-00DD010655AF}
       (Default) = {CLSID of IFilter implementation}
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{GUID_1}\PersistentHandler
       (Default) = {GUID_1}
    ```

2.  <span data-ttu-id="75ffe-321">Registre a implementação do IFilter com as seguintes chaves e valores:</span><span class="sxs-lookup"><span data-stu-id="75ffe-321">Register the IFilter implementation with the following keys and values:</span></span>

    ```
    HKEY_CLASSES_ROOT\CLSID\{CLSID of IFilter implementation}
       (Default) = Extension IFilter Description">
    ```

    ```
    HKEY_CLASSES_ROOT\CLSID\{CLSID of IFilter implementation}\InprocServer32
       (Default) = <DLL Install Path>
       ThreadingModel = Both
    ```

3.  <span data-ttu-id="75ffe-322">Registre a implementação do IFilter com o Windows Desktop Search com a seguinte chave e valor:</span><span class="sxs-lookup"><span data-stu-id="75ffe-322">Register the IFilter implementation with Windows Desktop Search with the following key and value:</span></span>

    ```
    HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\RSSearch\ContentIndexCommon\Filters\Extension\<.ext>
       (Default) = {CLSID of IFilter implementation}"
    ```

## <a name="related-topics"></a><span data-ttu-id="75ffe-323">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="75ffe-323">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="75ffe-324">**Referência**</span><span class="sxs-lookup"><span data-stu-id="75ffe-324">**Reference**</span></span>
</dt> <dt>

[<span data-ttu-id="75ffe-325">Esquematable</span><span class="sxs-lookup"><span data-stu-id="75ffe-325">SchemaTable</span></span>](-search-2x-wds-schematable.md)
</dt> <dt>

[<span data-ttu-id="75ffe-326">Tipos observados</span><span class="sxs-lookup"><span data-stu-id="75ffe-326">Perceived Types</span></span>](-search-2x-wds-perceivedtype.md)
</dt> <dt>

[<span data-ttu-id="75ffe-327">Desenvolvendo manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="75ffe-327">Developing Protocol Handlers</span></span>](-search-2x-wds-phaddins.md)
</dt> <dt>

<span data-ttu-id="75ffe-328">**Outros recursos**</span><span class="sxs-lookup"><span data-stu-id="75ffe-328">**Other Resources**</span></span>
</dt> <dt>

[<span data-ttu-id="75ffe-329">**Visio**</span><span class="sxs-lookup"><span data-stu-id="75ffe-329">**IFilter**</span></span>](/windows/desktop/api/filter/nn-filter-ifilter)
</dt> </dl>

 

 