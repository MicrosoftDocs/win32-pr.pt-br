---
title: Implementação de uma Exibição de pasta
description: O Shell do Windows fornece uma implementação padrão da exibição de pasta, coloquialmente conhecida como DefView, para que você possa evitar grande parte do trabalho de implementar sua própria extensão de namespace.
ms.assetid: 8c6712d8-c3cb-4450-8277-3a8675622651
keywords:
- objeto de exibição de pasta
- IShellView
- IShellBrowser, objetos de exibição de pasta
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 48c7b86d587154a034f276d4bdab903e5337ed4b
ms.sourcegitcommit: 469b6de41e2a565b7ead231d7f282ec4071ac158
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/11/2020
ms.locfileid: "104366858"
---
# <a name="implementing-a-folder-view"></a><span data-ttu-id="2923e-106">Implementação de uma Exibição de pasta</span><span class="sxs-lookup"><span data-stu-id="2923e-106">Implementing a Folder View</span></span>

<span data-ttu-id="2923e-107">O Shell do Windows fornece uma implementação padrão da exibição de pasta, coloquialmente conhecida como DefView, para que você possa evitar grande parte do trabalho de implementar sua própria extensão de namespace.</span><span class="sxs-lookup"><span data-stu-id="2923e-107">Windows Shell provides a default implementation of the folder view, colloquially known as DefView, so that you can avoid much of the work of implementing your own namespace extension.</span></span> <span data-ttu-id="2923e-108">Como alguns recursos de exibição não podem ser obtidos por meio de exibições personalizadas, geralmente é recomendável que o objeto de exibição de pasta do sistema padrão seja usado no lugar de uma exibição personalizada.</span><span class="sxs-lookup"><span data-stu-id="2923e-108">Because some view features cannot be achieved through custom views, it is often recommended that the default system folder view object is used in place of a custom view.</span></span> <span data-ttu-id="2923e-109">Para obter mais informações, consulte [**SHCreateShellFolderView**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview).</span><span class="sxs-lookup"><span data-stu-id="2923e-109">For more information, see [**SHCreateShellFolderView**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview).</span></span> <span data-ttu-id="2923e-110">O restante deste tópico aborda a implementação de uma exibição de pasta personalizada que não dá suporte a recursos de exibição mais recentes.</span><span class="sxs-lookup"><span data-stu-id="2923e-110">The remainder of this topic discusses implementing a custom folder view that cannot support newer view features.</span></span>

<span data-ttu-id="2923e-111">Ao contrário do modo de exibição de árvore, o Windows Explorer não gerencia o conteúdo de uma exibição de pasta.</span><span class="sxs-lookup"><span data-stu-id="2923e-111">Unlike the tree view, Windows Explorer does not manage the contents of a folder view.</span></span> <span data-ttu-id="2923e-112">Em vez disso, a janela de exibição de pasta hospeda uma janela filho que é fornecida pelo objeto Folder.</span><span class="sxs-lookup"><span data-stu-id="2923e-112">Instead, the folder view window hosts a child window that is provided by the folder object.</span></span> <span data-ttu-id="2923e-113">O objeto Folder é responsável por criar um objeto de exibição de pasta para exibir o conteúdo da pasta na janela filho.</span><span class="sxs-lookup"><span data-stu-id="2923e-113">The folder object is responsible for creating a folder view object to display the folder's contents in the child window.</span></span>

<span data-ttu-id="2923e-114">A chave para implementar um objeto de exibição de pasta é a interface [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) .</span><span class="sxs-lookup"><span data-stu-id="2923e-114">The key to implementing a folder view object is the [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span> <span data-ttu-id="2923e-115">Essa interface é usada pelo Windows Explorer para se comunicar com o objeto de exibição de pasta.</span><span class="sxs-lookup"><span data-stu-id="2923e-115">This interface is used by Windows Explorer to communicate with the folder view object.</span></span> <span data-ttu-id="2923e-116">Antes de exibir uma exibição de pasta, o Windows Explorer chama o método [**IShellFolder:: CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) do objeto de pasta com *RIID* definido como IID \_ IShellView.</span><span class="sxs-lookup"><span data-stu-id="2923e-116">Before displaying a folder view, Windows Explorer calls the folder object's [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) method with *riid* set to IID\_IShellView.</span></span> <span data-ttu-id="2923e-117">Crie um objeto de exibição de pasta e retorne sua interface **IShellView** .</span><span class="sxs-lookup"><span data-stu-id="2923e-117">Create a folder view object and return its **IShellView** interface.</span></span> <span data-ttu-id="2923e-118">O objeto de exibição de pasta deve criar uma janela filho da janela de exibição de pasta e usar a janela filho para exibir informações sobre o conteúdo da pasta.</span><span class="sxs-lookup"><span data-stu-id="2923e-118">The folder view object must then create a child window of the folder view window and use the child window to display information about the folder's contents.</span></span>

<span data-ttu-id="2923e-119">Além de controlar como os dados são exibidos, as extensões também podem personalizar vários recursos do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-119">In addition to controlling how data is displayed, extensions can also customize a number of the features of Windows Explorer.</span></span> <span data-ttu-id="2923e-120">Por exemplo, uma extensão pode adicionar itens à barra de ferramentas ou à barra de menus ou exibir informações na barra de status.</span><span class="sxs-lookup"><span data-stu-id="2923e-120">For instance, an extension can add items to the toolbar or menu bar, or display information on the status bar.</span></span>

-   [<span data-ttu-id="2923e-121">O objeto de exibição de pasta</span><span class="sxs-lookup"><span data-stu-id="2923e-121">The Folder View Object</span></span>](#the-folder-view-object)
-   [<span data-ttu-id="2923e-122">Inicializando o objeto de exibição de pasta</span><span class="sxs-lookup"><span data-stu-id="2923e-122">Initializing the Folder View Object</span></span>](#initializing-the-folder-view-object)
-   [<span data-ttu-id="2923e-123">Exibindo a exibição de pasta</span><span class="sxs-lookup"><span data-stu-id="2923e-123">Displaying the Folder View</span></span>](#displaying-the-folder-view)
-   [<span data-ttu-id="2923e-124">Implementando IShellView</span><span class="sxs-lookup"><span data-stu-id="2923e-124">Implementing IShellView</span></span>](#implementing-ishellview)
    -   [<span data-ttu-id="2923e-125">AddPropertySheetPages</span><span class="sxs-lookup"><span data-stu-id="2923e-125">AddPropertySheetPages</span></span>](#addpropertysheetpages)
    -   [<span data-ttu-id="2923e-126">GetCurrentInfo</span><span class="sxs-lookup"><span data-stu-id="2923e-126">GetCurrentInfo</span></span>](#getcurrentinfo)
    -   [<span data-ttu-id="2923e-127">Atualizar</span><span class="sxs-lookup"><span data-stu-id="2923e-127">Refresh</span></span>](#refresh)
    -   [<span data-ttu-id="2923e-128">SaveViewState</span><span class="sxs-lookup"><span data-stu-id="2923e-128">SaveViewState</span></span>](#saveviewstate)
    -   [<span data-ttu-id="2923e-129">TranslateAcelerator</span><span class="sxs-lookup"><span data-stu-id="2923e-129">TranslateAcelerator</span></span>](#translateacelerator)
-   [<span data-ttu-id="2923e-130">Usando o IShellBrowser para se comunicar com o Windows Explorer</span><span class="sxs-lookup"><span data-stu-id="2923e-130">Using IShellBrowser to Communicate with Windows Explorer</span></span>](#using-ishellbrowser-to-communicate-with-windows-explorer)
    -   [<span data-ttu-id="2923e-131">Modificando a barra de menus do Windows Explorer</span><span class="sxs-lookup"><span data-stu-id="2923e-131">Modifying the Windows Explorer Menu Bar</span></span>](#modifying-the-windows-explorer-menu-bar)
    -   [<span data-ttu-id="2923e-132">Modificando a barra de ferramentas do Windows Explorer</span><span class="sxs-lookup"><span data-stu-id="2923e-132">Modifying the Windows Explorer Toolbar</span></span>](#modifying-the-windows-explorer-toolbar)
    -   [<span data-ttu-id="2923e-133">Modificando a barra de status do Windows Explorer</span><span class="sxs-lookup"><span data-stu-id="2923e-133">Modifying the Windows Explorer Status Bar</span></span>](#modifying-the-windows-explorer-status-bar)
    -   [<span data-ttu-id="2923e-134">Armazenando informações específicas da exibição</span><span class="sxs-lookup"><span data-stu-id="2923e-134">Storing View-specific Information</span></span>](#storing-view-specific-information)

## <a name="the-folder-view-object"></a><span data-ttu-id="2923e-135">O objeto de exibição de pasta</span><span class="sxs-lookup"><span data-stu-id="2923e-135">The Folder View Object</span></span>

<span data-ttu-id="2923e-136">Um objeto de exibição de pasta é um objeto de Component Object Model (COM) que expõe uma interface [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) .</span><span class="sxs-lookup"><span data-stu-id="2923e-136">A folder view object is a Component Object Model (COM) object that exposes an [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span> <span data-ttu-id="2923e-137">Este objeto é responsável por:</span><span class="sxs-lookup"><span data-stu-id="2923e-137">This object is responsible for:</span></span>

-   <span data-ttu-id="2923e-138">Criar uma janela filho da janela de exibição de pasta e usá-la para exibir o conteúdo da pasta.</span><span class="sxs-lookup"><span data-stu-id="2923e-138">Creating a child window of the folder view window and using it to display the contents of the folder.</span></span>
-   <span data-ttu-id="2923e-139">Lidando com a comunicação com o Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-139">Handling communication with Windows Explorer.</span></span>
-   <span data-ttu-id="2923e-140">Adicionar comandos específicos da pasta à barra de menus do Windows Explorer e à barra de ferramentas e manipular esses comandos quando eles são selecionados.</span><span class="sxs-lookup"><span data-stu-id="2923e-140">Adding folder-specific commands to the Windows Explorer menu bar and toolbar and handling those commands when they are selected.</span></span>
-   <span data-ttu-id="2923e-141">Gerenciar a interação do usuário com a janela de exibição de pasta, como exibir menus de atalho ou manipular operações de arrastar e soltar.</span><span class="sxs-lookup"><span data-stu-id="2923e-141">Managing user interaction with the folder view window, such as displaying shortcut menus or handling drag-and-drop operations.</span></span>

<span data-ttu-id="2923e-142">Este documento aborda os três primeiros tópicos.</span><span class="sxs-lookup"><span data-stu-id="2923e-142">This document discusses the first three topics.</span></span> <span data-ttu-id="2923e-143">Como a interação do usuário com o modo de exibição de pasta ocorre dentro de sua janela filho, o objeto de exibição de pasta é responsável por tratá-lo como faria em qualquer outra janela.</span><span class="sxs-lookup"><span data-stu-id="2923e-143">Because user interaction with the folder view takes place within your child window, your folder view object is responsible for handling it as it would for any other window.</span></span>

<span data-ttu-id="2923e-144">O Windows Explorer solicita um objeto de exibição de pasta chamando o objeto de pasta [**IShellFolder:: CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) com *RIID* definido como IID \_ IShellView.</span><span class="sxs-lookup"><span data-stu-id="2923e-144">Windows Explorer requests a folder view object by calling your folder object's [**IShellFolder::CreateViewObject**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellfolder-createviewobject) with *riid* set to IID\_IShellView.</span></span> <span data-ttu-id="2923e-145">O procedimento para criar uma exibição de pasta é:</span><span class="sxs-lookup"><span data-stu-id="2923e-145">The procedure for creating a folder view is:</span></span>

1.  <span data-ttu-id="2923e-146">O objeto de pasta cria uma nova instância do objeto de exibição de pasta e retorna um ponteiro para sua interface [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) .</span><span class="sxs-lookup"><span data-stu-id="2923e-146">Your folder object creates a new instance of your folder view object and returns a pointer to its [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span>
2.  <span data-ttu-id="2923e-147">O Windows Explorer Inicializa o objeto de exibição de pasta chamando o método [**IShellView:: CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) .</span><span class="sxs-lookup"><span data-stu-id="2923e-147">Windows Explorer initializes the folder view object by calling the [**IShellView::CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) method.</span></span> <span data-ttu-id="2923e-148">Crie uma janela filho da janela de exibição de pasta e retorne seu identificador para o Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-148">Create a child window of the folder view window and return its handle to Windows Explorer.</span></span>
3.  <span data-ttu-id="2923e-149">O objeto de exibição de pasta usa a interface [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) do Windows Explorer para personalizar a barra de ferramentas, a barra de menus e a barra de status do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-149">The folder view object uses the Windows Explorer [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) interface to customize the Windows Explorer toolbar, menu bar, and status bar.</span></span>
4.  <span data-ttu-id="2923e-150">O objeto de exibição de pasta exibe o conteúdo da pasta na janela filho.</span><span class="sxs-lookup"><span data-stu-id="2923e-150">The folder view object displays the contents of the folder in the child window.</span></span>
5.  <span data-ttu-id="2923e-151">O objeto de exibição de pasta manipula a interação do usuário com o modo de exibição de pasta e qualquer barra de ferramentas ou itens de barra de menus específicos da pasta.</span><span class="sxs-lookup"><span data-stu-id="2923e-151">The folder view object handles user interaction with the folder view and any folder-specific toolbar or menu bar items.</span></span>

## <a name="initializing-the-folder-view-object"></a><span data-ttu-id="2923e-152">Inicializando o objeto de exibição de pasta</span><span class="sxs-lookup"><span data-stu-id="2923e-152">Initializing the Folder View Object</span></span>

<span data-ttu-id="2923e-153">O Windows Explorer Inicializa o objeto de exibição de pasta chamando o método [**IShellView:: CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) .</span><span class="sxs-lookup"><span data-stu-id="2923e-153">Windows Explorer initializes the folder view object by calling the [**IShellView::CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) method.</span></span> <span data-ttu-id="2923e-154">Os parâmetros do método fornecem o objeto de exibição de pasta com as informações necessárias para criar a janela filho que será usada para exibir o conteúdo da pasta:</span><span class="sxs-lookup"><span data-stu-id="2923e-154">The method's parameters provide the folder view object with the information it needs to create the child window that will be used to display the folder's contents:</span></span>

-   <span data-ttu-id="2923e-155">Um ponteiro para a interface de [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) do objeto de exibição de pasta anterior.</span><span class="sxs-lookup"><span data-stu-id="2923e-155">A pointer to the previous folder view object's [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface.</span></span> <span data-ttu-id="2923e-156">Esse parâmetro pode ser definido como **nulo**.</span><span class="sxs-lookup"><span data-stu-id="2923e-156">This parameter can be set to **NULL**.</span></span>
-   <span data-ttu-id="2923e-157">Uma estrutura [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) que contém as configurações da exibição da pasta anterior.</span><span class="sxs-lookup"><span data-stu-id="2923e-157">A [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) structure that contains the previous folder view's settings.</span></span>
-   <span data-ttu-id="2923e-158">Um ponteiro para a interface [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-158">A pointer to the Windows Explorer [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) interface.</span></span>
-   <span data-ttu-id="2923e-159">Uma estrutura [Rect](/previous-versions//ms536136(v=vs.85)) com as dimensões da janela de exibição de pasta.</span><span class="sxs-lookup"><span data-stu-id="2923e-159">A [RECT](/previous-versions//ms536136(v=vs.85)) structure with the dimensions of the folder view window.</span></span>

<span data-ttu-id="2923e-160">O método [**IShellView:: CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) é chamado antes de o objeto de exibição de pasta anterior ser destruído.</span><span class="sxs-lookup"><span data-stu-id="2923e-160">The [**IShellView::CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) method is called before the previous folder view object is destroyed.</span></span> <span data-ttu-id="2923e-161">Assim, o ponteiro de interface [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) permite que você se comunique com o objeto de exibição de pasta anterior.</span><span class="sxs-lookup"><span data-stu-id="2923e-161">The [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface pointer thus allows you to communicate with the previous folder view object.</span></span> <span data-ttu-id="2923e-162">Essa interface é útil principalmente se a pasta anterior pertencia à sua extensão e usou o mesmo esquema de exibição.</span><span class="sxs-lookup"><span data-stu-id="2923e-162">This interface is primarily useful if the previous folder belonged to your extension and used the same display scheme.</span></span> <span data-ttu-id="2923e-163">Nesse caso, você pode se comunicar com o objeto de exibição de pasta anterior para tais finalidades como a troca de configurações privadas.</span><span class="sxs-lookup"><span data-stu-id="2923e-163">If so, you can communicate with the previous folder view object for such purposes as exchanging private settings.</span></span>

<span data-ttu-id="2923e-164">Uma maneira simples de determinar se o ponteiro [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) pertence à sua extensão é fazer com que todos os objetos de exibição de pasta exponham uma interface privada.</span><span class="sxs-lookup"><span data-stu-id="2923e-164">A simple way to determine whether the [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) pointer belongs to your extension is to have all your folder view objects expose a private interface.</span></span> <span data-ttu-id="2923e-165">Chame [IShellView:: QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) para solicitar a interface privada e examine o valor de retorno para determinar se o objeto de exibição de pasta é um dos seus.</span><span class="sxs-lookup"><span data-stu-id="2923e-165">Call [IShellView::QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) to request the private interface, and examine the return value to determine whether the folder view object is one of yours.</span></span> <span data-ttu-id="2923e-166">Você pode usar um método particular nessa interface para trocar informações.</span><span class="sxs-lookup"><span data-stu-id="2923e-166">You can then use a private method on that interface to exchange information.</span></span>

<span data-ttu-id="2923e-167">A estrutura [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) contém as configurações de exibição da exibição de pasta anterior.</span><span class="sxs-lookup"><span data-stu-id="2923e-167">The [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) structure contains the previous folder view's display settings.</span></span> <span data-ttu-id="2923e-168">A configuração principal é o modo de exibição: ícone grande, ícone pequeno, lista ou detalhes.</span><span class="sxs-lookup"><span data-stu-id="2923e-168">The primary setting is the viewing mode: large icon, small icon, list, or details.</span></span> <span data-ttu-id="2923e-169">Há também um sinalizador que contém as configurações de uma variedade de opções de exibição, como se a exibição deve ser alinhada à esquerda.</span><span class="sxs-lookup"><span data-stu-id="2923e-169">There is also a flag that contains the settings of a variety of display options, such as whether the view should be left-aligned.</span></span> <span data-ttu-id="2923e-170">A exibição da pasta deve seguir essas configurações na extensão possível, para fornecer aos usuários uma experiência consistente, uma vez que eles vão de uma pasta para outra.</span><span class="sxs-lookup"><span data-stu-id="2923e-170">Your folder display should follow these settings to the extent possible, to give users a consistent experience as they go from one folder to another.</span></span> <span data-ttu-id="2923e-171">Você deve armazenar essa estrutura e atualizá-la conforme a alteração das configurações.</span><span class="sxs-lookup"><span data-stu-id="2923e-171">You should store this structure and update it as the settings change.</span></span> <span data-ttu-id="2923e-172">O Windows Explorer chama [**IShellView:: GetCurrentInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-getcurrentinfo) para obter o valor mais recente dessa estrutura antes de abrir a próxima exibição de pasta.</span><span class="sxs-lookup"><span data-stu-id="2923e-172">Windows Explorer calls [**IShellView::GetCurrentInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-getcurrentinfo) to obtain the most recent value of this structure before it opens the next folder view.</span></span>

<span data-ttu-id="2923e-173">A interface [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) é exposta pelo Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-173">The [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) interface is exposed by Windows Explorer.</span></span> <span data-ttu-id="2923e-174">Essa interface é um complemento do [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) e permite que um objeto de exibição de pasta se comunique com o Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-174">This interface is a companion to [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) and allows a folder view object to communicate with Windows Explorer.</span></span> <span data-ttu-id="2923e-175">Não há nenhuma outra maneira de recuperar esse ponteiro de interface, portanto, o objeto de exibição de pasta deve armazená-lo para uso posterior.</span><span class="sxs-lookup"><span data-stu-id="2923e-175">There is no other way to retrieve this interface pointer, so your folder view object should store it for later use.</span></span> <span data-ttu-id="2923e-176">Em particular, você precisará chamar [IShellBrowser:: GetWindow](/windows/win32/api/oleidl/nf-oleidl-iolewindow-getwindow) para recuperar a janela de exibição da pasta pai que será usada para criar sua janela filho.</span><span class="sxs-lookup"><span data-stu-id="2923e-176">In particular, you will need to call [IShellBrowser::GetWindow](/windows/win32/api/oleidl/nf-oleidl-iolewindow-getwindow) to retrieve the parent folder view window that you will use to create your child window.</span></span> <span data-ttu-id="2923e-177">Observe que o método IShellBrowser:: GetWindow não está incluído na documentação do **IShellBrowser** porque ele é herdado de [IOleWindow](/windows/win32/api/oleidl/nn-oleidl-iolewindow).</span><span class="sxs-lookup"><span data-stu-id="2923e-177">Note that the IShellBrowser::GetWindow method is not included in the **IShellBrowser** documentation because it is inherited from [IOleWindow](/windows/win32/api/oleidl/nn-oleidl-iolewindow).</span></span> <span data-ttu-id="2923e-178">Depois de armazenar o ponteiro de interface, lembre-se de chamar [IShellBrowser:: AddRef](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) para incrementar a contagem de referência da interface.</span><span class="sxs-lookup"><span data-stu-id="2923e-178">After storing the interface pointer, remember to call [IShellBrowser::AddRef](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) to increment the interface's reference count.</span></span> <span data-ttu-id="2923e-179">Quando você não precisar mais da interface, chame [IShellBrowser:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release).</span><span class="sxs-lookup"><span data-stu-id="2923e-179">When you no longer need the interface, call [IShellBrowser::Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release).</span></span>

<span data-ttu-id="2923e-180">Para criar sua janela filho:</span><span class="sxs-lookup"><span data-stu-id="2923e-180">To create your child window:</span></span>

1.  <span data-ttu-id="2923e-181">Examine as estruturas [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) e [Rect](/previous-versions//ms536136(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="2923e-181">Examine the [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) and [RECT](/previous-versions//ms536136(v=vs.85)) structures.</span></span>
2.  <span data-ttu-id="2923e-182">Se necessário, obtenha as configurações particulares do objeto de exibição de pasta anterior.</span><span class="sxs-lookup"><span data-stu-id="2923e-182">If needed, obtain private settings from the previous folder view object.</span></span>
3.  <span data-ttu-id="2923e-183">Chame [IShellBrowser:: GetWindow](/windows/win32/api/oleidl/nf-oleidl-iolewindow-getwindow) para recuperar a janela de exibição da pasta pai.</span><span class="sxs-lookup"><span data-stu-id="2923e-183">Call [IShellBrowser::GetWindow](/windows/win32/api/oleidl/nf-oleidl-iolewindow-getwindow) to retrieve the parent folder view window.</span></span>
4.  <span data-ttu-id="2923e-184">Crie um filho da janela de exibição de pasta obtida na etapa anterior e retorne-o para o Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-184">Create a child of the folder view window obtained in the previous step and return it to Windows Explorer.</span></span>

## <a name="displaying-the-folder-view"></a><span data-ttu-id="2923e-185">Exibindo a exibição de pasta</span><span class="sxs-lookup"><span data-stu-id="2923e-185">Displaying the Folder View</span></span>

<span data-ttu-id="2923e-186">Depois de criar a janela filho e retorne-a para o Windows Explorer, você poderá exibir o conteúdo da pasta.</span><span class="sxs-lookup"><span data-stu-id="2923e-186">Once you have created the child window and returned it to Windows Explorer, you can display the folder's contents.</span></span> <span data-ttu-id="2923e-187">Normalmente, as extensões exibem suas informações fazendo com que a janela filho hospede um [controle de exibição de lista](../controls/list-view-control-reference.md) ou um **controle WebBrowser**.</span><span class="sxs-lookup"><span data-stu-id="2923e-187">Typically, extensions display their information by having the child window host either a [list view control](../controls/list-view-control-reference.md) or a **WebBrowser control**.</span></span> <span data-ttu-id="2923e-188">O controle de exibição de lista permite replicar a [exibição clássica](web-view.md)do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-188">The list view control allows you to replicate the Windows Explorer [classic view](web-view.md).</span></span> <span data-ttu-id="2923e-189">O controle WebBrowser permite que você use um documento HTML dinâmico (DHTML) para exibir suas informações, assim como a exibição da Web do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-189">The WebBrowser control allows you to use a Dynamic HTML (DHTML) document to display your information, much like the Windows Explorer Web view.</span></span> <span data-ttu-id="2923e-190">Para obter mais informações, consulte a documentação desses controles.</span><span class="sxs-lookup"><span data-stu-id="2923e-190">For further information, refer to the documentation of those controls.</span></span>

<span data-ttu-id="2923e-191">A janela de exibição de pasta sempre existe, mesmo que ela não tenha foco.</span><span class="sxs-lookup"><span data-stu-id="2923e-191">The folder view window always exists, even if it does not have focus.</span></span> <span data-ttu-id="2923e-192">Portanto, você deve manter três Estados para sua janela filho:</span><span class="sxs-lookup"><span data-stu-id="2923e-192">You should therefore maintain three states for your child window:</span></span>

-   <span data-ttu-id="2923e-193">Ativado com foco.</span><span class="sxs-lookup"><span data-stu-id="2923e-193">Activated with focus.</span></span> <span data-ttu-id="2923e-194">O modo de exibição de pasta foi criado e tem foco.</span><span class="sxs-lookup"><span data-stu-id="2923e-194">The folder view has been created and has focus.</span></span> <span data-ttu-id="2923e-195">Defina a barra de menus ou os itens da barra de ferramentas que são apropriados para um estado focalizado.</span><span class="sxs-lookup"><span data-stu-id="2923e-195">Set the menu bar or toolbar items that are appropriate for a focused state.</span></span>
-   <span data-ttu-id="2923e-196">Ativado sem foco.</span><span class="sxs-lookup"><span data-stu-id="2923e-196">Activated without focus.</span></span> <span data-ttu-id="2923e-197">A exibição de pasta foi criada e está ativa, mas não tem foco.</span><span class="sxs-lookup"><span data-stu-id="2923e-197">The folder view has been created and is active, but it does not have focus.</span></span> <span data-ttu-id="2923e-198">Defina a barra de menus ou os itens da barra de ferramentas que são apropriados para um estado não focalizado.</span><span class="sxs-lookup"><span data-stu-id="2923e-198">Set the menu bar or toolbar items that are appropriate for a nonfocused state.</span></span> <span data-ttu-id="2923e-199">Omita todos os itens que se aplicam à seleção de itens no modo de exibição de pasta.</span><span class="sxs-lookup"><span data-stu-id="2923e-199">Omit any items that apply to the selection of items within the folder view.</span></span>
-   <span data-ttu-id="2923e-200">Desativado.</span><span class="sxs-lookup"><span data-stu-id="2923e-200">Deactivated.</span></span> <span data-ttu-id="2923e-201">A exibição de pasta está prestes a ser destruída.</span><span class="sxs-lookup"><span data-stu-id="2923e-201">The folder view is about to be destroyed.</span></span> <span data-ttu-id="2923e-202">Remova todos os itens de menu específicos da pasta.</span><span class="sxs-lookup"><span data-stu-id="2923e-202">Remove all folder-specific menu items.</span></span>

<span data-ttu-id="2923e-203">O Windows Explorer notifica seu objeto de exibição de pasta quando o estado da janela é alterado chamando [**IShellView:: UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate).</span><span class="sxs-lookup"><span data-stu-id="2923e-203">Windows Explorer notifies your folder view object when the window state changes by calling [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate).</span></span> <span data-ttu-id="2923e-204">Por sua vez, o objeto de exibição de pasta deve notificar o Windows Explorer quando um usuário ativar a janela de exibição de pasta chamando [**IShellBrowser:: OnViewWindowActive**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-onviewwindowactive).</span><span class="sxs-lookup"><span data-stu-id="2923e-204">In turn, the folder view object should notify Windows Explorer when a user activates the folder view window by calling [**IShellBrowser::OnViewWindowActive**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-onviewwindowactive).</span></span> <span data-ttu-id="2923e-205">Para obter mais informações sobre essa interface, consulte [usando o IShellBrowser para se comunicar com o Windows Explorer](#using-ishellbrowser-to-communicate-with-windows-explorer).</span><span class="sxs-lookup"><span data-stu-id="2923e-205">For further discussion of this interface, see [Using IShellBrowser to Communicate with Windows Explorer](#using-ishellbrowser-to-communicate-with-windows-explorer).</span></span>

<span data-ttu-id="2923e-206">Embora a exibição de pasta esteja ativa, você precisa processar todas as mensagens do Windows, como o [ \_ tamanho do WM](../winmsg/wm-size.md), que pertencem à sua janela filho.</span><span class="sxs-lookup"><span data-stu-id="2923e-206">While the folder view is active, you need to process any Windows messages, such as [WM\_SIZE](../winmsg/wm-size.md), that belong to your child window.</span></span> <span data-ttu-id="2923e-207">O procedimento de janela também receberá mensagens de [ \_ comando do WM](../menurc/wm-command.md) para todos os itens que você adicionou à barra de menus ou barra de ferramentas do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-207">Your window procedure will also receive [WM\_COMMAND](../menurc/wm-command.md) messages for any items you have added to the Windows Explorer menu bar or toolbar.</span></span>

<span data-ttu-id="2923e-208">Depois de criar a exibição de pasta, o Windows Explorer chama a interface [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) do objeto de exibição de pasta para passar uma variedade de informações.</span><span class="sxs-lookup"><span data-stu-id="2923e-208">After creating the folder view, Windows Explorer calls the folder view object's [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) interface to pass it a variety of information.</span></span> <span data-ttu-id="2923e-209">O objeto deve modificar sua exibição de acordo.</span><span class="sxs-lookup"><span data-stu-id="2923e-209">Your object must modify its display accordingly.</span></span> <span data-ttu-id="2923e-210">Quando a exibição de pasta está prestes a ser destruída, o Windows Explorer notifica o objeto de exibição de pasta chamando seu método [**IShellView::D estroyviewwindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-destroyviewwindow) .</span><span class="sxs-lookup"><span data-stu-id="2923e-210">When the folder view is about to be destroyed, Windows Explorer notifies the folder view object by calling its [**IShellView::DestroyViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-destroyviewwindow) method.</span></span>

## <a name="implementing-ishellview"></a><span data-ttu-id="2923e-211">Implementando IShellView</span><span class="sxs-lookup"><span data-stu-id="2923e-211">Implementing IShellView</span></span>

<span data-ttu-id="2923e-212">Depois que o objeto Folder tiver sido criado, o Windows Explorer chamará vários métodos [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) para solicitar informações ou notificar o objeto de uma alteração no estado do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-212">After the folder object has been created, Windows Explorer calls various [**IShellView**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellview) methods to either request information or notify the object of a change in the state of Windows Explorer.</span></span> <span data-ttu-id="2923e-213">Esta seção descreve como implementar esses métodos **IShellView** .</span><span class="sxs-lookup"><span data-stu-id="2923e-213">This section outlines how to implement those **IShellView** methods.</span></span> <span data-ttu-id="2923e-214">Os métodos restantes são usados para fins mais especializados, como a caixa de diálogo abrir arquivo comum.</span><span class="sxs-lookup"><span data-stu-id="2923e-214">The remaining methods are used for more specialized purposes, such as the File Open common dialog box.</span></span> <span data-ttu-id="2923e-215">Para obter detalhes, consulte a documentação do **IShellView** .</span><span class="sxs-lookup"><span data-stu-id="2923e-215">For details, see the **IShellView** documentation.</span></span>

### <a name="addpropertysheetpages"></a><span data-ttu-id="2923e-216">AddPropertySheetPages</span><span class="sxs-lookup"><span data-stu-id="2923e-216">AddPropertySheetPages</span></span>

<span data-ttu-id="2923e-217">Quando um usuário seleciona **Opções de pasta** no menu **ferramentas** do Windows Explorer, é exibida uma folha de propriedades que permite ao usuário modificar as opções de pasta.</span><span class="sxs-lookup"><span data-stu-id="2923e-217">When a user selects **Folder Options** from the Windows Explorer **Tools** menu, a property sheet is displayed that allows the user to modify the folder options.</span></span> <span data-ttu-id="2923e-218">O Windows Explorer chama o método [**IShellView:: AddPropertySheetPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-addpropertysheetpages) do objeto de exibição de pasta para permitir que você adicione uma página a essa folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="2923e-218">Windows Explorer calls your folder view object's [**IShellView::AddPropertySheetPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-addpropertysheetpages) method to allow you to add a page to this property sheet.</span></span>

<span data-ttu-id="2923e-219">O Windows Explorer passa um ponteiro para uma função de retorno de chamada [AddPropSheetPageProc](/windows/win32/api/prsht/nc-prsht-lpfnaddpropsheetpage) no parâmetro *lpfn* de [**IShellView:: AddPropertySheetPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-addpropertysheetpages).</span><span class="sxs-lookup"><span data-stu-id="2923e-219">Windows Explorer passes a pointer to an [AddPropSheetPageProc](/windows/win32/api/prsht/nc-prsht-lpfnaddpropsheetpage) callback function in the *lpfn* parameter of [**IShellView::AddPropertySheetPages**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-addpropertysheetpages).</span></span> <span data-ttu-id="2923e-220">Chame [CreatePropertySheetPage](/windows/win32/api/prsht/nf-prsht-createpropertysheetpagea) para criar a página e, em seguida, chame o AddPropSheetPageProc para adicioná-lo à folha de propriedades.</span><span class="sxs-lookup"><span data-stu-id="2923e-220">Call [CreatePropertySheetPage](/windows/win32/api/prsht/nf-prsht-createpropertysheetpagea) to create the page, and then call the AddPropSheetPageProc to add it to the property sheet.</span></span> <span data-ttu-id="2923e-221">Para obter mais informações sobre como lidar com folhas de propriedades, consulte [folhas de propriedades](../controls/property-sheets.md).</span><span class="sxs-lookup"><span data-stu-id="2923e-221">For further discussion of how to handle property sheets, see [Property Sheets](../controls/property-sheets.md).</span></span>

### <a name="getcurrentinfo"></a><span data-ttu-id="2923e-222">GetCurrentInfo</span><span class="sxs-lookup"><span data-stu-id="2923e-222">GetCurrentInfo</span></span>

<span data-ttu-id="2923e-223">Quando o usuário alterna de uma pasta para outra, o Windows Explorer tenta manter uma exibição de pasta semelhante.</span><span class="sxs-lookup"><span data-stu-id="2923e-223">When the user switches from one folder to another, Windows Explorer attempts to maintain a similar folder view.</span></span> <span data-ttu-id="2923e-224">Por exemplo, se a exibição de pasta anterior mostrar ícones grandes, o próximo também deverá ser.</span><span class="sxs-lookup"><span data-stu-id="2923e-224">For instance, if the previous folder view showed large icons, the next should as well.</span></span> <span data-ttu-id="2923e-225">Quando o Windows Explorer chama [**IShellView:: CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) para inicializar o objeto de exibição de pasta, o método recebe uma estrutura [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) .</span><span class="sxs-lookup"><span data-stu-id="2923e-225">When Windows Explorer calls [**IShellView::CreateViewWindow**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-createviewwindow) to initialize your folder view object, the method receives a [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) structure.</span></span> <span data-ttu-id="2923e-226">Essa estrutura contém informações que permitem que você torne o modo de exibição de pasta consistente com o modo de exibição de pasta anterior.</span><span class="sxs-lookup"><span data-stu-id="2923e-226">This structure contains information that allows you to make your folder view display consistent with the previous folder view.</span></span>

<span data-ttu-id="2923e-227">Para ajudar a garantir que a próxima exibição seja consistente com a exibição atual, armazene a estrutura [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) .</span><span class="sxs-lookup"><span data-stu-id="2923e-227">To help ensure that the next view is consistent with the current view, store the [**FOLDERSETTINGS**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-foldersettings) structure.</span></span> <span data-ttu-id="2923e-228">Se a exibição for alterada, por exemplo, de ícones grandes para pequenos, atualize a estrutura de acordo.</span><span class="sxs-lookup"><span data-stu-id="2923e-228">If the view changes, for instance from large to small icons, update the structure accordingly.</span></span> <span data-ttu-id="2923e-229">Antes de alternar as exibições, o Windows Explorer chamará [**IShellView:: GetCurrentInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-getcurrentinfo) para solicitar os valores de **FOLDERSETTINGS** atuais para passá-los para o próximo objeto de exibição de pasta.</span><span class="sxs-lookup"><span data-stu-id="2923e-229">Prior to switching views, Windows Explorer will call [**IShellView::GetCurrentInfo**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-getcurrentinfo) to request the current **FOLDERSETTINGS** values to pass them to the next folder view object.</span></span>

### <a name="refresh"></a><span data-ttu-id="2923e-230">Atualizar</span><span class="sxs-lookup"><span data-stu-id="2923e-230">Refresh</span></span>

<span data-ttu-id="2923e-231">O usuário pode garantir que a exibição de pasta reflita o estado atual da pasta selecionando **Atualizar** no menu **Exibir** ou pressionando a tecla F5.</span><span class="sxs-lookup"><span data-stu-id="2923e-231">The user can ensure that the folder view reflects the current state of the folder by selecting **Refresh** from the **View** menu or pressing the F5 key.</span></span> <span data-ttu-id="2923e-232">Quando o usuário faz isso, o Windows Explorer chama o método [**IShellView:: Refresh**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-refresh) .</span><span class="sxs-lookup"><span data-stu-id="2923e-232">When the user does so, Windows Explorer calls the [**IShellView::Refresh**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-refresh) method.</span></span> <span data-ttu-id="2923e-233">O objeto de exibição de pasta deve atualizar imediatamente a exibição de exibição de pasta.</span><span class="sxs-lookup"><span data-stu-id="2923e-233">Your folder view object should immediately update the folder view display.</span></span>

### <a name="saveviewstate"></a><span data-ttu-id="2923e-234">SaveViewState</span><span class="sxs-lookup"><span data-stu-id="2923e-234">SaveViewState</span></span>

<span data-ttu-id="2923e-235">O Windows Explorer chama o método [**IShellView:: SaveViewState**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-saveviewstate) para solicitar que o objeto de exibição de pasta salve seu estado de exibição.</span><span class="sxs-lookup"><span data-stu-id="2923e-235">Windows Explorer calls the [**IShellView::SaveViewState**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-saveviewstate) method to prompt your folder view object to save its view state.</span></span> <span data-ttu-id="2923e-236">Em seguida, você pode recuperar o estado na próxima vez que a pasta for exibida.</span><span class="sxs-lookup"><span data-stu-id="2923e-236">You can then recover the state the next time the folder is viewed.</span></span> <span data-ttu-id="2923e-237">A maneira preferida de salvar um estado de exibição é chamando o método [**IShellBrowser:: GetViewStateStream**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-getviewstatestream) .</span><span class="sxs-lookup"><span data-stu-id="2923e-237">The preferred way to save a view state is by calling the [**IShellBrowser::GetViewStateStream**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-getviewstatestream) method.</span></span> <span data-ttu-id="2923e-238">Esse método retorna uma interface [IStream](/windows/win32/api/objidl/nn-objidl-istream) que o objeto de exibição de pasta pode usar para salvar seu estado.</span><span class="sxs-lookup"><span data-stu-id="2923e-238">This method returns an [IStream](/windows/win32/api/objidl/nn-objidl-istream) interface that your folder view object can use to save its state.</span></span> <span data-ttu-id="2923e-239">Ao criar outra exibição de pasta, você pode chamar o mesmo método **IShellBrowser:: GetViewStateStream** para obter um ponteiro de IStream que permite que você leia as configurações salvas pelas exibições de pasta anteriores.</span><span class="sxs-lookup"><span data-stu-id="2923e-239">When you create another folder view, you can call the same **IShellBrowser::GetViewStateStream** method to obtain an IStream pointer that allows you to read the settings saved by previous folder views.</span></span>

### <a name="translateacelerator"></a><span data-ttu-id="2923e-240">TranslateAcelerator</span><span class="sxs-lookup"><span data-stu-id="2923e-240">TranslateAcelerator</span></span>

<span data-ttu-id="2923e-241">Quando o usuário pressiona uma tecla de atalho, o Windows Explorer passa a mensagem para o objeto de exibição de pasta chamando [**IShellView:: TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-translateaccelerator).</span><span class="sxs-lookup"><span data-stu-id="2923e-241">When the user presses a shortcut key, Windows Explorer passes the message to the folder view object by calling [**IShellView::TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-translateaccelerator).</span></span> <span data-ttu-id="2923e-242">Retorne \_ os S false para que o Windows Explorer processe a mensagem.</span><span class="sxs-lookup"><span data-stu-id="2923e-242">Return S\_FALSE to have Windows Explorer process the message.</span></span> <span data-ttu-id="2923e-243">Se o objeto de exibição de pasta tiver processado a mensagem, retorne S \_ OK.</span><span class="sxs-lookup"><span data-stu-id="2923e-243">If your folder view object has processed the message, return S\_OK.</span></span>

<span data-ttu-id="2923e-244">Quando a janela de exibição de pasta tem foco, o Windows Explorer chama [**IShellView:: TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-translateaccelerator) antes de processar a mensagem.</span><span class="sxs-lookup"><span data-stu-id="2923e-244">When the folder view window has focus, Windows Explorer calls [**IShellView::TranslateAccelerator**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-translateaccelerator) before it processes the message.</span></span> <span data-ttu-id="2923e-245">Como a maioria das mensagens é normalmente associada à barra de menus ou aos comandos da barra de ferramentas do Windows Explorer, o objeto de exibição de pasta normalmente retorna S \_ false.</span><span class="sxs-lookup"><span data-stu-id="2923e-245">Because most of the messages are typically associated with Windows Explorer menu bar or toolbar commands, your folder view object should normally return S\_FALSE.</span></span> <span data-ttu-id="2923e-246">O Windows Explorer pode processar a mensagem normalmente.</span><span class="sxs-lookup"><span data-stu-id="2923e-246">Windows Explorer can then process the message normally.</span></span> <span data-ttu-id="2923e-247">Retorne \_ os S Ok somente se a mensagem for específica da pasta e você não quiser que o Windows Explorer faça nenhum processamento adicional.</span><span class="sxs-lookup"><span data-stu-id="2923e-247">Return S\_OK only if the message is folder-specific and you do not want Windows Explorer to do any further processing.</span></span> <span data-ttu-id="2923e-248">Se a exibição de pasta não tiver foco, o Windows Explorer processará a mensagem primeiro.</span><span class="sxs-lookup"><span data-stu-id="2923e-248">If the folder view does not have focus, Windows Explorer processes the message first.</span></span> <span data-ttu-id="2923e-249">Ele chama [**IShellBrowser:: TranslateAcceleratorSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-translateacceleratorsb) somente se não tratar a mensagem.</span><span class="sxs-lookup"><span data-stu-id="2923e-249">It calls [**IShellBrowser::TranslateAcceleratorSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-translateacceleratorsb) only if it does not handle the message.</span></span>

## <a name="using-ishellbrowser-to-communicate-with-windows-explorer"></a><span data-ttu-id="2923e-250">Usando o IShellBrowser para se comunicar com o Windows Explorer</span><span class="sxs-lookup"><span data-stu-id="2923e-250">Using IShellBrowser to Communicate with Windows Explorer</span></span>

<span data-ttu-id="2923e-251">A interface [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) é usada pelo objeto de exibição de pasta para se comunicar com o Windows Explorer para uma variedade de finalidades, incluindo:</span><span class="sxs-lookup"><span data-stu-id="2923e-251">The [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) interface is used by the folder view object to communicate with Windows Explorer for a variety of purposes, including:</span></span>

-   [<span data-ttu-id="2923e-252">Modificando a barra de menus do Windows Explorer</span><span class="sxs-lookup"><span data-stu-id="2923e-252">Modifying the Windows Explorer Menu Bar</span></span>](#modifying-the-windows-explorer-menu-bar)
-   [<span data-ttu-id="2923e-253">Modificando a barra de ferramentas do Windows Explorer</span><span class="sxs-lookup"><span data-stu-id="2923e-253">Modifying the Windows Explorer Toolbar</span></span>](#modifying-the-windows-explorer-toolbar)
-   [<span data-ttu-id="2923e-254">Modificando a barra de status do Windows Explorer</span><span class="sxs-lookup"><span data-stu-id="2923e-254">Modifying the Windows Explorer Status Bar</span></span>](#modifying-the-windows-explorer-status-bar)
-   [<span data-ttu-id="2923e-255">Armazenando informações específicas da exibição</span><span class="sxs-lookup"><span data-stu-id="2923e-255">Storing View-specific Information</span></span>](#storing-view-specific-information)

### <a name="modifying-the-windows-explorer-menu-bar"></a><span data-ttu-id="2923e-256">Modificando a barra de menus do Windows Explorer</span><span class="sxs-lookup"><span data-stu-id="2923e-256">Modifying the Windows Explorer Menu Bar</span></span>

<span data-ttu-id="2923e-257">A barra de menus do Windows Explorer permite que o usuário inicie uma variedade de comandos.</span><span class="sxs-lookup"><span data-stu-id="2923e-257">The Windows Explorer menu bar allows the user to launch a variety of commands.</span></span> <span data-ttu-id="2923e-258">Por padrão, a barra de menus só dá suporte a comandos que são específicos do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-258">By default, the menu bar only supports commands that are specific to Windows Explorer.</span></span> <span data-ttu-id="2923e-259">As mensagens [de \_ comando do WM](../menurc/wm-command.md) relacionadas são processadas pelo Windows Explorer e não são passadas para o objeto de exibição de pasta.</span><span class="sxs-lookup"><span data-stu-id="2923e-259">The related [WM\_COMMAND](../menurc/wm-command.md) messages are processed by Windows Explorer and are not passed to your folder view object.</span></span> <span data-ttu-id="2923e-260">No entanto, você pode modificar a barra de menus para incluir um ou mais itens de menu específicos da pasta com [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser).</span><span class="sxs-lookup"><span data-stu-id="2923e-260">However, you can modify the menu bar to include one or more folder-specific menu items with [**IShellBrowser**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellbrowser).</span></span> <span data-ttu-id="2923e-261">O Windows Explorer passa as \_ mensagens de comando do WM associadas a esses itens para o procedimento de janela do seu objeto de pasta para processamento.</span><span class="sxs-lookup"><span data-stu-id="2923e-261">Windows Explorer passes the associated WM\_COMMAND messages of those items to your folder object's window procedure for processing.</span></span> <span data-ttu-id="2923e-262">Você também pode remover ou desabilitar os comandos padrão que não se aplicam ao seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="2923e-262">You can also remove or disable any standard commands that do not apply to your application.</span></span>

<span data-ttu-id="2923e-263">Os objetos de exibição de pasta normalmente modificam a barra de menus antes de a exibição de pasta ser exibida pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="2923e-263">Folder view objects typically modify the menu bar before the folder view is first displayed.</span></span> <span data-ttu-id="2923e-264">Eles devem retornar a barra de menus para seu estado original quando a exibição de pasta for destruída.</span><span class="sxs-lookup"><span data-stu-id="2923e-264">They must return the menu bar to its original state when the folder view is destroyed.</span></span> <span data-ttu-id="2923e-265">Talvez você também precise modificar a barra de menus sempre que a exibição da pasta obtiver ou perder o foco.</span><span class="sxs-lookup"><span data-stu-id="2923e-265">You might also need to modify the menu bar each time your folder view gains or loses focus.</span></span>

<span data-ttu-id="2923e-266">Como o Windows Explorer chama [**IShellView:: UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) sempre que o estado da janela de exibição de pasta é alterado, a modificação da barra de menus normalmente é incluída na implementação desse método.</span><span class="sxs-lookup"><span data-stu-id="2923e-266">Because Windows Explorer calls [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) each time the folder view window's state changes, menu bar modification is normally included in that method's implementation.</span></span> <span data-ttu-id="2923e-267">O procedimento básico para modificar a barra de menus do Windows Explorer é:</span><span class="sxs-lookup"><span data-stu-id="2923e-267">The basic procedure for modifying the Windows Explorer menu bar is:</span></span>

1.  <span data-ttu-id="2923e-268">Chame [CreateMenu](/windows/win32/api/winuser/nf-winuser-createmenu) para criar um identificador de menu.</span><span class="sxs-lookup"><span data-stu-id="2923e-268">Call [CreateMenu](/windows/win32/api/winuser/nf-winuser-createmenu) to create a menu handle.</span></span>
2.  <span data-ttu-id="2923e-269">Passe esse identificador de menu para o Windows Explorer chamando [**IShellBrowser:: InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb).</span><span class="sxs-lookup"><span data-stu-id="2923e-269">Pass that menu handle to Windows Explorer by calling [**IShellBrowser::InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb).</span></span> <span data-ttu-id="2923e-270">O Windows Explorer preencherá suas informações de menu.</span><span class="sxs-lookup"><span data-stu-id="2923e-270">Windows Explorer will fill in its menu information.</span></span>
3.  <span data-ttu-id="2923e-271">Modifique o menu conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="2923e-271">Modify the menu as needed.</span></span>
4.  <span data-ttu-id="2923e-272">Chame [**IShellBrowser:: SetMenuSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setmenusb) para que o Windows Explorer exiba a barra de menus modificada.</span><span class="sxs-lookup"><span data-stu-id="2923e-272">Call [**IShellBrowser::SetMenuSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setmenusb) to have Windows Explorer display the modified menu bar.</span></span>

<span data-ttu-id="2923e-273">O Windows Explorer tem seis menus pop-up na barra de menus.</span><span class="sxs-lookup"><span data-stu-id="2923e-273">Windows Explorer has six pop-up menus on its menu bar.</span></span> <span data-ttu-id="2923e-274">Assim como acontece com todos os contêineres OLE, o menu do Windows Explorer é dividido em seis grupos: arquivo, editar, contêiner, objeto, janela e ajuda.</span><span class="sxs-lookup"><span data-stu-id="2923e-274">As with all OLE containers, the Windows Explorer menu is divided into six groups: File, Edit, Container, Object, Window, and Help.</span></span> <span data-ttu-id="2923e-275">A tabela a seguir lista os menus pop-up do Windows Explorer e seu grupo associado, juntamente com as IDs de menu.</span><span class="sxs-lookup"><span data-stu-id="2923e-275">The following table lists the Windows Explorer pop-up menus and their associated group, along with the menu IDs.</span></span>



| <span data-ttu-id="2923e-276">Menu pop-up</span><span class="sxs-lookup"><span data-stu-id="2923e-276">Pop-up menu</span></span> | <span data-ttu-id="2923e-277">ID</span><span class="sxs-lookup"><span data-stu-id="2923e-277">ID</span></span>                     | <span data-ttu-id="2923e-278">Grupo</span><span class="sxs-lookup"><span data-stu-id="2923e-278">Group</span></span>     |
|-------------|------------------------|-----------|
| <span data-ttu-id="2923e-279">Arquivo</span><span class="sxs-lookup"><span data-stu-id="2923e-279">File</span></span>        | <span data-ttu-id="2923e-280">\_arquivo de menu FCIDM \_</span><span class="sxs-lookup"><span data-stu-id="2923e-280">FCIDM\_MENU\_FILE</span></span>      | <span data-ttu-id="2923e-281">Arquivo</span><span class="sxs-lookup"><span data-stu-id="2923e-281">File</span></span>      |
| <span data-ttu-id="2923e-282">Editar</span><span class="sxs-lookup"><span data-stu-id="2923e-282">Edit</span></span>        | <span data-ttu-id="2923e-283">\_edição do menu FCIDM \_</span><span class="sxs-lookup"><span data-stu-id="2923e-283">FCIDM\_MENU\_EDIT</span></span>      | <span data-ttu-id="2923e-284">Arquivo</span><span class="sxs-lookup"><span data-stu-id="2923e-284">File</span></span>      |
| <span data-ttu-id="2923e-285">Visualizar</span><span class="sxs-lookup"><span data-stu-id="2923e-285">View</span></span>        | <span data-ttu-id="2923e-286">\_exibição do menu FCIDM \_</span><span class="sxs-lookup"><span data-stu-id="2923e-286">FCIDM\_MENU\_VIEW</span></span>      | <span data-ttu-id="2923e-287">Contêiner</span><span class="sxs-lookup"><span data-stu-id="2923e-287">Container</span></span> |
| <span data-ttu-id="2923e-288">Favoritos</span><span class="sxs-lookup"><span data-stu-id="2923e-288">Favorites</span></span>   | <span data-ttu-id="2923e-289">\_favoritos do menu FCIDM \_</span><span class="sxs-lookup"><span data-stu-id="2923e-289">FCIDM\_MENU\_FAVORITES</span></span> | <span data-ttu-id="2923e-290">Contêiner</span><span class="sxs-lookup"><span data-stu-id="2923e-290">Container</span></span> |
| <span data-ttu-id="2923e-291">Ferramentas</span><span class="sxs-lookup"><span data-stu-id="2923e-291">Tools</span></span>       | <span data-ttu-id="2923e-292">\_Ferramentas do menu FCIDM \_</span><span class="sxs-lookup"><span data-stu-id="2923e-292">FCIDM\_MENU\_TOOLS</span></span>     | <span data-ttu-id="2923e-293">Contêiner</span><span class="sxs-lookup"><span data-stu-id="2923e-293">Container</span></span> |
| <span data-ttu-id="2923e-294">Ajuda</span><span class="sxs-lookup"><span data-stu-id="2923e-294">Help</span></span>        | <span data-ttu-id="2923e-295">\_ajuda do menu FCIDM \_</span><span class="sxs-lookup"><span data-stu-id="2923e-295">FCIDM\_MENU\_HELP</span></span>      | <span data-ttu-id="2923e-296">Janela</span><span class="sxs-lookup"><span data-stu-id="2923e-296">Window</span></span>    |



 

<span data-ttu-id="2923e-297">Ao passar o identificador de menu para o Windows Explorer chamando [**IShellBrowser:: InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb), você também deve passar um ponteiro para uma estrutura [OLEMENUGROUPWIDTHS](/windows/win32/api/oleidl/ns-oleidl-olemenugroupwidths) cujos membros foram inicializados como zero.</span><span class="sxs-lookup"><span data-stu-id="2923e-297">When you pass the menu handle to Windows Explorer by calling [**IShellBrowser::InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb), you must also pass a pointer to an [OLEMENUGROUPWIDTHS](/windows/win32/api/oleidl/ns-oleidl-olemenugroupwidths) structure whose members have been initialized to zero.</span></span>

<span data-ttu-id="2923e-298">Quando [**IShellBrowser:: InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb) retornar, o Windows Explorer terá adicionado seus itens de menu.</span><span class="sxs-lookup"><span data-stu-id="2923e-298">When [**IShellBrowser::InsertMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-insertmenussb) returns, Windows Explorer will have added its menu items.</span></span> <span data-ttu-id="2923e-299">Você pode usar o identificador de menu retornado com funções de menu padrão do Windows, como [InsertMenuItem](/windows/win32/api/winuser/nf-winuser-insertmenuitema) para:</span><span class="sxs-lookup"><span data-stu-id="2923e-299">You can then use the returned menu handle with standard Windows menu functions such as [InsertMenuItem](/windows/win32/api/winuser/nf-winuser-insertmenuitema) to:</span></span>

-   <span data-ttu-id="2923e-300">Adicione itens aos menus pop-up do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-300">Add items to the Windows Explorer pop-up menus.</span></span>
-   <span data-ttu-id="2923e-301">Modifique ou exclua itens existentes nos menus pop-up do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-301">Modify or delete existing items in the Windows Explorer pop-up menus.</span></span>
-   <span data-ttu-id="2923e-302">Adicione novos menus pop-up.</span><span class="sxs-lookup"><span data-stu-id="2923e-302">Add new pop-up menus.</span></span>

<span data-ttu-id="2923e-303">Use as IDs listadas na tabela para identificar os vários menus pop-up do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="2923e-303">Use the IDs listed in the table to identify the various Windows Explorer pop-up menus.</span></span>

> [!Note]  
> <span data-ttu-id="2923e-304">Para evitar conflitos com IDs de comando do Windows Explorer, as IDs de qualquer item de menu que você adicionar devem estar entre FCIDM \_ SHVIEWFIRST e FCIDM \_ SHVIEWLAST.</span><span class="sxs-lookup"><span data-stu-id="2923e-304">To avoid conflicts with Windows Explorer command IDs, the IDs of any menu items that you add must fall between FCIDM\_SHVIEWFIRST and FCIDM\_SHVIEWLAST.</span></span> <span data-ttu-id="2923e-305">Esses dois valores são definidos em shlobj. h.</span><span class="sxs-lookup"><span data-stu-id="2923e-305">These two values are defined in Shlobj.h.</span></span>

 

<span data-ttu-id="2923e-306">Depois de terminar de modificar o menu, chame [**IShellBrowser:: SetMenuSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setmenusb) para que o Windows Explorer exiba a nova barra de menus.</span><span class="sxs-lookup"><span data-stu-id="2923e-306">Once you have finished modifying the menu, call [**IShellBrowser::SetMenuSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setmenusb) to have Windows Explorer display the new menu bar.</span></span>

<span data-ttu-id="2923e-307">Depois que a exibição de pasta é exibida inicialmente, o Windows Explorer chama [**IShellView:: UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) sempre que a exibição da pasta Obtém ou perde o foco.</span><span class="sxs-lookup"><span data-stu-id="2923e-307">After the folder view is initially displayed, Windows Explorer calls [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) each time the folder view gains or loses focus.</span></span> <span data-ttu-id="2923e-308">Se você tiver itens de menu sensíveis ao estado do modo de exibição de pasta, modifique o menu adequadamente, sempre que o estado for alterado.</span><span class="sxs-lookup"><span data-stu-id="2923e-308">If you have any menu items that are sensitive to the state of the folder view, you should modify the menu accordingly, each time the state changes.</span></span> <span data-ttu-id="2923e-309">Por exemplo, você pode ter um item de menu que atue em um item no modo de exibição de pasta que foi selecionado pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="2923e-309">For instance, you might have a menu item that acts on an item in the folder view that has been selected by the user.</span></span> <span data-ttu-id="2923e-310">Você deve desabilitar ou remover esse item de menu quando a exibição de pasta perder o foco.</span><span class="sxs-lookup"><span data-stu-id="2923e-310">You should disable or remove this menu item when the folder view loses focus.</span></span>

<span data-ttu-id="2923e-311">Quando o Windows Explorer chama [**IShellView:: UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) para indicar que a exibição de pasta está sendo desativada, restaure a barra de menus para seu estado original chamando [**IShellBrowser:: RemoveMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-removemenussb).</span><span class="sxs-lookup"><span data-stu-id="2923e-311">When Windows Explorer calls [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) to indicate that the folder view is being deactivated, restore the menu bar to its original state by calling [**IShellBrowser::RemoveMenusSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-removemenussb).</span></span>

### <a name="modifying-the-windows-explorer-toolbar"></a><span data-ttu-id="2923e-312">Modificando a barra de ferramentas do Windows Explorer</span><span class="sxs-lookup"><span data-stu-id="2923e-312">Modifying the Windows Explorer Toolbar</span></span>

<span data-ttu-id="2923e-313">Além de modificar a barra de menus do Windows Explorer, você também pode adicionar botões à barra de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="2923e-313">In addition to modifying the Windows Explorer menu bar, you can also add buttons to the toolbar.</span></span> <span data-ttu-id="2923e-314">Assim como acontece com a barra de menus, a modificação da barra de ferramentas geralmente faz parte da implementação [**IShellView:: UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) .</span><span class="sxs-lookup"><span data-stu-id="2923e-314">As with the menu bar, toolbar modification is usually part of the [**IShellView::UIActivate**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-uiactivate) implementation.</span></span> <span data-ttu-id="2923e-315">O procedimento para adicionar botões à barra de ferramentas do Windows Explorer é:</span><span class="sxs-lookup"><span data-stu-id="2923e-315">The procedure for adding buttons to the Windows Explorer toolbar is:</span></span>

1.  <span data-ttu-id="2923e-316">Adicione o bitmap do botão à lista de imagens da barra de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="2923e-316">Add the button's bitmap to the toolbar's image list.</span></span>
2.  <span data-ttu-id="2923e-317">Defina a cadeia de texto do botão.</span><span class="sxs-lookup"><span data-stu-id="2923e-317">Define the button's text string.</span></span>
3.  <span data-ttu-id="2923e-318">Adicione o botão à barra de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="2923e-318">Add the button to the toolbar.</span></span>

<span data-ttu-id="2923e-319">Para adicionar um bitmap à lista de imagens de uma barra de ferramentas, envie a barra de ferramentas uma mensagem de [TB \_ AddBitmap](../controls/tb-addbitmap.md) chamando [**IShellBrowser:: SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg).</span><span class="sxs-lookup"><span data-stu-id="2923e-319">To add a bitmap to a toolbar's image list, send the toolbar a [TB\_ADDBITMAP](../controls/tb-addbitmap.md) message by calling [**IShellBrowser::SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg).</span></span> <span data-ttu-id="2923e-320">Para especificar o controle ToolBar, defina o parâmetro *ID* do método como **FCW \_ Toolbar**.</span><span class="sxs-lookup"><span data-stu-id="2923e-320">To specify the toolbar control, set the method's *id* parameter to **FCW\_TOOLBAR**.</span></span> <span data-ttu-id="2923e-321">Defina *wParam* como o número de imagens de botão no bitmap e *lParam* para o endereço de uma estrutura [TBADDBITMAP](/windows/win32/api/commctrl/ns-commctrl-tbaddbitmap) .</span><span class="sxs-lookup"><span data-stu-id="2923e-321">Set *wParam* to the number of button images in the bitmap, and *lParam* to the address of a [TBADDBITMAP](/windows/win32/api/commctrl/ns-commctrl-tbaddbitmap) structure.</span></span> <span data-ttu-id="2923e-322">O índice de imagem é retornado no parâmetro *pret* .</span><span class="sxs-lookup"><span data-stu-id="2923e-322">The image index is returned in the *pret* parameter.</span></span>

<span data-ttu-id="2923e-323">Há duas maneiras de definir uma cadeia de caracteres para o botão:</span><span class="sxs-lookup"><span data-stu-id="2923e-323">There are two ways to define a string for the button:</span></span>

-   <span data-ttu-id="2923e-324">Atribua a cadeia de caracteres ao membro **isastring** da estrutura [TBBUTTON](/windows/win32/api/commctrl/ns-commctrl-tbbutton) do botão.</span><span class="sxs-lookup"><span data-stu-id="2923e-324">Assign the string to the **iString** member of the button's [TBBUTTON](/windows/win32/api/commctrl/ns-commctrl-tbbutton) structure.</span></span>
-   <span data-ttu-id="2923e-325">Chame [**IShellBrowser:: SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg) para enviar a barra de ferramentas para o controle de uma mensagem de [TB \_ AddString](../controls/tb-addstring.md) .</span><span class="sxs-lookup"><span data-stu-id="2923e-325">Call [**IShellBrowser::SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg) to send the toolbar control a [TB\_ADDSTRING](../controls/tb-addstring.md) message.</span></span> <span data-ttu-id="2923e-326">O parâmetro *wParam* deve ser definido como zero e o parâmetro *lParam* para a cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="2923e-326">The *wParam* parameter should be set to zero and the *lParam* parameter to the string.</span></span> <span data-ttu-id="2923e-327">O índice de cadeia de caracteres é retornado no parâmetro *pret* .</span><span class="sxs-lookup"><span data-stu-id="2923e-327">The string index is returned in the *pret* parameter.</span></span>

<span data-ttu-id="2923e-328">Para adicionar o botão à barra de ferramentas, preencha uma estrutura [TBBUTTON](/windows/win32/api/commctrl/ns-commctrl-tbbutton) e passe-a para [**IShellBrowser:: SetToolbarItems**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-settoolbaritems).</span><span class="sxs-lookup"><span data-stu-id="2923e-328">To add the button to the toolbar, fill in a [TBBUTTON](/windows/win32/api/commctrl/ns-commctrl-tbbutton) structure and pass it to [**IShellBrowser::SetToolbarItems**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-settoolbaritems).</span></span> <span data-ttu-id="2923e-329">Assim como no menu, a ID de comando deve estar entre FCIDM \_ SHVIEWFIRST e FCIDM \_ SHVIEWLAST.</span><span class="sxs-lookup"><span data-stu-id="2923e-329">As with the menu, your command ID must fall between FCIDM\_SHVIEWFIRST and FCIDM\_SHVIEWLAST.</span></span> <span data-ttu-id="2923e-330">A barra de ferramentas acrescentará o botão à direita dos botões existentes.</span><span class="sxs-lookup"><span data-stu-id="2923e-330">The toolbar will then append the button to the right of the existing buttons.</span></span>

<span data-ttu-id="2923e-331">Por exemplo, o fragmento de código a seguir adiciona um botão padrão à barra de ferramentas do Windows Explorer com uma ID de comando de MYBUTTON de IDB \_ .</span><span class="sxs-lookup"><span data-stu-id="2923e-331">For instance, the following code fragment adds one standard button to the Windows Explorer toolbar with a command ID of IDB\_MYBUTTON.</span></span>


```
TBADDBITMAP tbadbm;
int iButtonIndex;
TBBUTTON tbb;

tbadbm.hInst = g_hInstance;    // The module's instance handle
tbadbm.nID = IDB_BUTTONIMAGE;  // The bitmap's resource ID

psb->SendControlMsg(FCW_TOOLBAR, TB_ADDBITMAP, 1,
                    reinterpret_cast<LPARAM>(&tbadbm), &iButtonIndex);

psb->SendControlMsg(FCW_TOOLBAR, TB_ADDSTRING, NULL,
                    reinterpret_cast<LPARAM>(szLabel), &iStringIndex);

ZeroMemory(&tbb, sizeof(TBBUTTON));
tbb.iBitmap = iButtonIndex;
tbb.iCommand = IDB_MYBUTTON;
tbb.iString = iStringIndex;
tbb.fsState = TBSTATE_ENABLED;
tbb.fsStyle = TBSTYLE_BUTTON;

psb->SetToolbarItems(&tbb, 1, FCT_MERGE);
```



<span data-ttu-id="2923e-332">Para obter mais informações sobre como manipular controles da barra de ferramentas, consulte [controles da barra de ferramentas](../controls/toolbar-control-reference.md).</span><span class="sxs-lookup"><span data-stu-id="2923e-332">For further discussion of how to handle toolbar controls, see [Toolbar Controls](../controls/toolbar-control-reference.md).</span></span>

### <a name="modifying-the-windows-explorer-status-bar"></a><span data-ttu-id="2923e-333">Modificando a barra de status do Windows Explorer</span><span class="sxs-lookup"><span data-stu-id="2923e-333">Modifying the Windows Explorer Status Bar</span></span>

<span data-ttu-id="2923e-334">Você pode usar a barra de status do Windows Explorer para exibir uma variedade de informações úteis.</span><span class="sxs-lookup"><span data-stu-id="2923e-334">You can use the Windows Explorer status bar to display a variety of useful information.</span></span> <span data-ttu-id="2923e-335">Há duas maneiras de usar a barra de status:</span><span class="sxs-lookup"><span data-stu-id="2923e-335">There are two ways to use the status bar:</span></span>

-   <span data-ttu-id="2923e-336">Use [**IShellBrowser:: SetStatusTextSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setstatustextsb) para exibir uma cadeia de texto na barra de status.</span><span class="sxs-lookup"><span data-stu-id="2923e-336">Use [**IShellBrowser::SetStatusTextSB**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-setstatustextsb) to display a text string on the status bar.</span></span>
-   <span data-ttu-id="2923e-337">Envie mensagens diretamente para o controle da barra de status com [**IShellBrowser:: SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg).</span><span class="sxs-lookup"><span data-stu-id="2923e-337">Send messages directly to the status bar control with [**IShellBrowser::SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg).</span></span>

<span data-ttu-id="2923e-338">O primeiro método é simples, mas suficiente para muitas finalidades.</span><span class="sxs-lookup"><span data-stu-id="2923e-338">The first method is straightforward but sufficient for many purposes.</span></span> <span data-ttu-id="2923e-339">Para obter maior flexibilidade, você pode enviar mensagens diretamente para o controle da barra de status chamando [**IShellBrowser:: SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg) com o parâmetro *ID* definido como **FCW \_ status**.</span><span class="sxs-lookup"><span data-stu-id="2923e-339">For greater flexibility, you can send messages directly to the status bar control by calling [**IShellBrowser::SendControlMsg**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-sendcontrolmsg) with the *id* parameter set to **FCW\_STATUS**.</span></span> <span data-ttu-id="2923e-340">Para obter mais informações sobre controles de barra de status, consulte [barras de status](../controls/status-bars.md).</span><span class="sxs-lookup"><span data-stu-id="2923e-340">For further discussion of status bar controls, see [Status Bars](../controls/status-bars.md).</span></span>

### <a name="storing-view-specific-information"></a><span data-ttu-id="2923e-341">Armazenando informações específicas da exibição</span><span class="sxs-lookup"><span data-stu-id="2923e-341">Storing View-specific Information</span></span>

<span data-ttu-id="2923e-342">Quando uma exibição está prestes a ser destruída, geralmente é útil armazenar informações como o estado da exibição ou as configurações.</span><span class="sxs-lookup"><span data-stu-id="2923e-342">When a view is about to be destroyed, it is often useful to store information such as the view's state or settings.</span></span> <span data-ttu-id="2923e-343">O Windows Explorer solicita que você execute essa tarefa chamando [**IShellView:: SaveViewState**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-saveviewstate).</span><span class="sxs-lookup"><span data-stu-id="2923e-343">Windows Explorer prompts you to do this task by calling [**IShellView::SaveViewState**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellview-saveviewstate).</span></span> <span data-ttu-id="2923e-344">A maneira preferida de salvar informações específicas do modo de exibição é chamar [**IShellBrowser:: GetViewStateStream**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-getviewstatestream).</span><span class="sxs-lookup"><span data-stu-id="2923e-344">The preferred way to save view-specific information is to call [**IShellBrowser::GetViewStateStream**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellbrowser-getviewstatestream).</span></span> <span data-ttu-id="2923e-345">Esse método fornece uma interface [IStream](/windows/win32/api/objidl/nn-objidl-istream) que você pode usar para armazenar as informações.</span><span class="sxs-lookup"><span data-stu-id="2923e-345">This method provides you with an [IStream](/windows/win32/api/objidl/nn-objidl-istream) interface that you can use to store the information.</span></span> <span data-ttu-id="2923e-346">Você está livre para usar qualquer formato de dados adequado.</span><span class="sxs-lookup"><span data-stu-id="2923e-346">You are free to use any suitable data format.</span></span>

 

 
