---
title: Suporte à entrada de fala
description: Suporte à entrada de fala
ms.assetid: 4702b941-fcc9-4d00-aba2-eca624b6d417
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8ecb6f2ddfbbe10f8b892ce922cd466eca96890
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/19/2020
ms.locfileid: "105748304"
---
# <a name="speech-input-support"></a><span data-ttu-id="9f08d-103">Suporte à entrada de fala</span><span class="sxs-lookup"><span data-stu-id="9f08d-103">Speech Input Support</span></span>

<span data-ttu-id="9f08d-104">\[O Microsoft Agent foi preterido a partir do Windows 7 e pode não estar disponível nas versões subsequentes do Windows.\]</span><span class="sxs-lookup"><span data-stu-id="9f08d-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="9f08d-105">Além de dar suporte à interação entre mouse e teclado, o Microsoft Agent inclui suporte direto para entrada de fala.</span><span class="sxs-lookup"><span data-stu-id="9f08d-105">In addition to supporting mouse and keyboard interaction, Microsoft Agent includes direct support for speech input.</span></span> <span data-ttu-id="9f08d-106">Como o suporte do Microsoft Agent para entrada de fala é baseado no Microsoft SAPI (fala, interface de programação de aplicativo), você pode usar o Microsoft Agent com mecanismos de controle e comando de reconhecimento de fala que incluem o suporte a SAPI-required.</span><span class="sxs-lookup"><span data-stu-id="9f08d-106">Because Microsoft Agent's support for speech input is based on Microsoft SAPI (Speech Application Programming Interface), you can use Microsoft Agent with speech recognition command and control engines that include the SAPI-required support.</span></span> <span data-ttu-id="9f08d-107">Para obter mais informações sobre os requisitos do mecanismo de fala, consulte [requisitos de suporte do mecanismo de fala](requirements-for-speech-recognition-engines.md).</span><span class="sxs-lookup"><span data-stu-id="9f08d-107">For more information on speech engine requirements, see [Speech Engine Support Requirements](requirements-for-speech-recognition-engines.md).</span></span>

<span data-ttu-id="9f08d-108">A Microsoft fornece um mecanismo de reconhecimento de fala de comando e controle que você pode usar com o Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="9f08d-108">Microsoft provides a command-and-control speech recognition engine you can use with Microsoft Agent.</span></span> <span data-ttu-id="9f08d-109">Para obter mais informações, consulte [seleção do mecanismo de fala](speech-engine-selection.md).</span><span class="sxs-lookup"><span data-stu-id="9f08d-109">For more information, see [Speech Engine Selection](speech-engine-selection.md).</span></span>

<span data-ttu-id="9f08d-110">O usuário pode iniciar a entrada de fala pressionando e segurando a tecla de atalho de escuta Push a Talk.</span><span class="sxs-lookup"><span data-stu-id="9f08d-110">The user can initiate speech input by pressing and holding the push-to-talk Listening hotkey.</span></span> <span data-ttu-id="9f08d-111">Nesse modo de escuta, se o mecanismo de fala receber o início da entrada falada, ele manterá o canal de áudio aberto até detectar o final do expressão.</span><span class="sxs-lookup"><span data-stu-id="9f08d-111">In this Listening mode, if the speech engine receives the beginning of spoken input, it holds the audio channel open until it detects the end of the utterance.</span></span> <span data-ttu-id="9f08d-112">No entanto, quando não estiver recebendo entrada, ela não bloqueará a saída de áudio.</span><span class="sxs-lookup"><span data-stu-id="9f08d-112">However, when not receiving input, it does not block audio output.</span></span> <span data-ttu-id="9f08d-113">Isso permite que o usuário emita vários comandos de voz enquanto mantém pressionada a tecla e o caractere pode responder quando o usuário não está falando.</span><span class="sxs-lookup"><span data-stu-id="9f08d-113">This enables the user to issue multiple voice commands while holding down the key, and the character can respond when the user isn't speaking.</span></span>

<span data-ttu-id="9f08d-114">O modo de escuta atinge o tempo limite quando o usuário libera a chave de escuta.</span><span class="sxs-lookup"><span data-stu-id="9f08d-114">The Listening mode times out once the user releases the Listening key.</span></span> <span data-ttu-id="9f08d-115">O usuário pode ajustar o tempo limite para esse modo usando as opções de caractere avançadas.</span><span class="sxs-lookup"><span data-stu-id="9f08d-115">The user can adjust the time-out for this mode using the Advanced Character Options.</span></span> <span data-ttu-id="9f08d-116">Você não pode definir esse tempo limite do código do aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="9f08d-116">You cannot set this time-out from your client application code.</span></span>

<span data-ttu-id="9f08d-117">Se um caractere tentar falar enquanto o usuário estiver falando, a saída audível do caractere falhará, embora o texto ainda possa ser exibido em seu balão de palavras.</span><span class="sxs-lookup"><span data-stu-id="9f08d-117">If a character attempts to speak while the user is speaking, the character's audible output fails though text may still be displayed in its word balloon.</span></span> <span data-ttu-id="9f08d-118">Se o caractere tiver o canal de áudio enquanto a tecla de escuta for pressionada, o servidor transferirá automaticamente o controle de volta para o usuário depois de processar o texto no método [**Speak**](speak-method.md) .</span><span class="sxs-lookup"><span data-stu-id="9f08d-118">If the character has the audio channel while the Listening key is pressed, the server automatically transfers control back to the user after processing the text in the [**Speak**](speak-method.md) method.</span></span> <span data-ttu-id="9f08d-119">Um tom MIDI opcional é tocado para marcar o usuário para começar a falar.</span><span class="sxs-lookup"><span data-stu-id="9f08d-119">An optional MIDI tone is played to cue the user to begin speaking.</span></span> <span data-ttu-id="9f08d-120">Isso permite que o usuário forneça entrada mesmo se o aplicativo que está direcionando o caractere não fornecer pausas lógicas em sua saída.</span><span class="sxs-lookup"><span data-stu-id="9f08d-120">This enables the user to provide input even if the application driving the character failed to provide logical pauses in its output.</span></span>

<span data-ttu-id="9f08d-121">Você também pode usar o método [**Listen**](listen-method.md) para iniciar a entrada de fala.</span><span class="sxs-lookup"><span data-stu-id="9f08d-121">You can also use the [**Listen**](listen-method.md) method to initiate speech input.</span></span> <span data-ttu-id="9f08d-122">Chamar esse método ativa o reconhecimento de fala por um período de tempo predefinido.</span><span class="sxs-lookup"><span data-stu-id="9f08d-122">Calling this method turns on the speech recognition for a predefined period of time.</span></span> <span data-ttu-id="9f08d-123">Se não houver nenhuma entrada durante esse intervalo, o Microsoft Agent desligará automaticamente o mecanismo de reconhecimento de fala e liberará o canal de áudio.</span><span class="sxs-lookup"><span data-stu-id="9f08d-123">If there is no input during this interval, Microsoft Agent automatically turns off the speech recognition engine and frees up the audio channel.</span></span> <span data-ttu-id="9f08d-124">Isso evita o bloqueio de entrada ou saída do dispositivo de áudio e minimiza a sobrecarga do processador que o reconhecimento de fala usa quando está ligado.</span><span class="sxs-lookup"><span data-stu-id="9f08d-124">This avoids blocking input to or output from the audio device and minimizes the processor overhead the speech recognition uses when it is on.</span></span> <span data-ttu-id="9f08d-125">Você também pode usar o método **Listen** para desativar a entrada de fala.</span><span class="sxs-lookup"><span data-stu-id="9f08d-125">You can also use the **Listen** method to turn off speech input.</span></span> <span data-ttu-id="9f08d-126">No entanto, lembre-se de que, como o mecanismo de reconhecimento de fala Opera de forma assíncrona, o efeito pode não ser imediato.</span><span class="sxs-lookup"><span data-stu-id="9f08d-126">However, be aware that because the speech recognition engine operates asynchronously, the effect may not be immediate.</span></span> <span data-ttu-id="9f08d-127">Como resultado, é possível receber um evento de [**comando**](command-event.md) mesmo após o código chamado **escutar** para desativar a entrada de fala.</span><span class="sxs-lookup"><span data-stu-id="9f08d-127">As a result, it is possible to receive a [**Command**](command-event.md) event even after your code called **Listen** to turn off speech input.</span></span>

<span data-ttu-id="9f08d-128">Para dar suporte à entrada de fala, você define uma *gramática*, um conjunto de palavras que você deseja que o mecanismo de reconhecimento de fala escute e corresponda como a configuração de **voz** para um [**comando**](/windows/desktop/lwef/the-command-object) em sua coleção de [**comandos**](/windows/desktop/lwef/the-commands-collection-object) .</span><span class="sxs-lookup"><span data-stu-id="9f08d-128">To support speech input, you define a *grammar*, a set of words you want the speech recognition engine to listen and match for as the **Voice** setting for a [**Command**](/windows/desktop/lwef/the-command-object) in your [**Commands**](/windows/desktop/lwef/the-commands-collection-object) collection.</span></span> <span data-ttu-id="9f08d-129">Você pode incluir palavras opcionais e alternativas e sequências repetidas na sua gramática.</span><span class="sxs-lookup"><span data-stu-id="9f08d-129">You can include optional and alternative words and repeated sequences in your grammar.</span></span> <span data-ttu-id="9f08d-130">Observe que o Agent não habilita a tecla de atalho de escuta até que um de seus clientes tenha carregado com êxito um mecanismo de fala ou tenha criado uma **voz** para um de seus objetos de **comando** .</span><span class="sxs-lookup"><span data-stu-id="9f08d-130">Note that Agent does not enable the Listening hotkey until one of its clients has successfully loaded a speech engine or has authored a **Voice** for one of its **Command** objects.</span></span>

<span data-ttu-id="9f08d-131">Se o usuário pressionar a tecla de atalho de escuta ou o aplicativo cliente chamar o método [**Listen**](listen-method.md) para iniciar a entrada de fala, o mecanismo de reconhecimento de fala tentará corresponder a uma entrada de expressão para a gramática dos comandos que foram definidos e passará as informações de volta ao servidor.</span><span class="sxs-lookup"><span data-stu-id="9f08d-131">Whether the user presses the Listening hotkey or your client application calls the [**Listen**](listen-method.md) method to initiate speech input, the speech recognition engine attempts to match an utterance's input to the grammar for the commands that have been defined, and passes the information back the server.</span></span> <span data-ttu-id="9f08d-132">Em seguida, o servidor notifica o aplicativo cliente usando o evento de [**comando**](command-event.md) ([**IAgentNotifySink:: Command**](iagentnotifysink--command.md)); repassando o objeto [**userinput**](/windows/desktop/lwef/iagentuserinput) que inclui a ID de comando da melhor correspondência e as duas próximas correspondências alternativas (se houver), uma pontuação de confiança e o texto correspondente para cada correspondência.</span><span class="sxs-lookup"><span data-stu-id="9f08d-132">The server then notifies the client application using the [**Command**](command-event.md) event ([**IAgentNotifySink::Command**](iagentnotifysink--command.md)); passing back the [**UserInput**](/windows/desktop/lwef/iagentuserinput) object that includes the command ID of the best match and next two alternative matches (if any), a confidence score, and the matching text for each match.</span></span>

<span data-ttu-id="9f08d-133">O servidor também notifica seu aplicativo cliente quando ele corresponde à entrada de fala para um de seus comandos fornecidos.</span><span class="sxs-lookup"><span data-stu-id="9f08d-133">The server also notifies your client application when it matches the speech input to one of its supplied commands.</span></span> <span data-ttu-id="9f08d-134">Enquanto a ID de comando é **nula**, você ainda Obtém a pontuação de confiança e o texto correspondente.</span><span class="sxs-lookup"><span data-stu-id="9f08d-134">While the command ID is **NULL**, you still get the confidence score and text matched.</span></span> <span data-ttu-id="9f08d-135">Quando estiver no modo de escuta, o servidor reproduzirá automaticamente a animação atribuída ao estado de **escuta** do caractere.</span><span class="sxs-lookup"><span data-stu-id="9f08d-135">When in Listening mode, the server automatically plays the animation assigned to the character's **Listening** state.</span></span> <span data-ttu-id="9f08d-136">Em seguida, quando um expressão é realmente detectado, o servidor reproduz a animação de estado **audição** do caractere.</span><span class="sxs-lookup"><span data-stu-id="9f08d-136">Then, when an utterance is actually detected, the server plays the character's **Hearing** state animation.</span></span> <span data-ttu-id="9f08d-137">O servidor manterá o caractere em um estado cuidadosa até que o expressão seja encerrado.</span><span class="sxs-lookup"><span data-stu-id="9f08d-137">The server will keep the character in an attentive state until the utterance has ended.</span></span> <span data-ttu-id="9f08d-138">Isso fornece os comentários sociais apropriados para marcar o usuário para entrada.</span><span class="sxs-lookup"><span data-stu-id="9f08d-138">This provides the appropriate social feedback to cue the user for input.</span></span>

<span data-ttu-id="9f08d-139">Se o usuário desabilitar a entrada de fala em opções avançadas de caracteres, a tecla de escuta também será desabilitada.</span><span class="sxs-lookup"><span data-stu-id="9f08d-139">If the user disables speech input in Advanced Character Options, the Listening hotkey will also be disabled.</span></span> <span data-ttu-id="9f08d-140">Da mesma forma, a tentativa de chamar o método [**Listen**](listen-method.md) quando a entrada de fala está desabilitada causará falha no método.</span><span class="sxs-lookup"><span data-stu-id="9f08d-140">Similarly, attempting to call the [**Listen**](listen-method.md) method when speech input is disabled will cause the method to fail.</span></span>

 

 