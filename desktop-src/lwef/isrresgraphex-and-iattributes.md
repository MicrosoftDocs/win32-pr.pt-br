---
title: ISRResGraphEx e IAttributes
description: ISRResGraphEx e IAttributes
ms.assetid: 6eb37da1-5252-4c41-891c-c19cca6fb7d1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 659d7d4723bfc5145fb8abcc77043031a0e48e8b
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104007376"
---
# <a name="isrresgraphex-and-iattributes"></a><span data-ttu-id="cfcb2-103">ISRResGraphEx e IAttributes</span><span class="sxs-lookup"><span data-stu-id="cfcb2-103">ISRResGraphEx and IAttributes</span></span>

<span data-ttu-id="cfcb2-104">\[O Microsoft Agent foi preterido a partir do Windows 7 e pode não estar disponível nas versões subsequentes do Windows.\]</span><span class="sxs-lookup"><span data-stu-id="cfcb2-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="cfcb2-105">Os objetos de resultados retornados pelo mecanismo devem dar suporte à interface ISRResGraphEx e à interface IAttributes.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-105">The results objects returned by the engine must support the ISRResGraphEx interface and the IAttributes interface.</span></span> <span data-ttu-id="cfcb2-106">Simplesmente dar suporte à interface ISRResGraphEx é suficiente para habilitar o editor de som a fornecer informações de quebra de palavras, mas não fornece o suporte necessário para informações de fonema.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-106">Merely supporting the ISRResGraphEx interface is enough to enable the sound editor to provide word break information, but does not provide the necessary support for phoneme information.</span></span>

<span data-ttu-id="cfcb2-107">O editor de som requer que os mecanismos também ofereçam suporte a um atributo DWord especial, **SRATTR \_ PHONESEG**.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-107">The sound editor requires that engines also support a special DWord attribute, **SRATTR\_PHONESEG**.</span></span> <span data-ttu-id="cfcb2-108">O editor consulta os mecanismos para ver a interface IAttributes e tenta definir o **SRATTR \_ PHONESEG** como 1.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-108">The editor queries the engines to see IAttributes interface and attempts to set the **SRATTR\_PHONESEG** to 1.</span></span> <span data-ttu-id="cfcb2-109">Se essa chamada for realizada com sucesso, o editor de som assumirá que os resultados do mecanismo oferecerão suporte à coleta de informações de segmentação de fonema do objeto de resultados.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-109">If that call succeeds, the sound editor assumes that the engine's results will support the gathering of phoneme-segmentation information from results object.</span></span>

`#define    SRATTR_PHONESEG    MAKELONG (1, SRVEN_MICROSOFT)`

<span data-ttu-id="cfcb2-110">Quando um objeto de resultados é transmitido para o editor de som, ele consulta esse objeto para sua implementação de ISRResGraphEx.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-110">When a results object is transmitted to the sound editor, it queries that object for its implementation of ISRResGraphEx.</span></span> <span data-ttu-id="cfcb2-111">ISRResGraphEx contém uma função de membro, DataGet, com assinatura de tipo</span><span class="sxs-lookup"><span data-stu-id="cfcb2-111">ISRResGraphEx contains a member function, DataGet, with type signature</span></span>

`HRESULT  DataGet  (DWord, dwID, GUID gAttrib, SDATA *psData)`

<span data-ttu-id="cfcb2-112">Em que **dwID** é o identificador do objeto de grafo, **GATTRIB** é um GUID correspondente ao atributo procurado e **psData** é um ponteiro para um objeto SDATA que contém os dados retornados.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-112">Where **dwID** is the identifier of the graph object, **gAttrib** is a GUID corresponding to the attribute sought, and **psData** is a pointer to an SDATA object containing the data returned.</span></span> <span data-ttu-id="cfcb2-113">O mecanismo é responsável por alocar os dados armazenados em **psData** por meio de [**CoTaskMemAlloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemalloc).</span><span class="sxs-lookup"><span data-stu-id="cfcb2-113">The engine is responsible for allocating the data stored in **psData** through [**CoTaskMemAlloc**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemalloc).</span></span> <span data-ttu-id="cfcb2-114">O aplicativo de chamada (neste caso, o editor de som) é responsável por liberá-lo por meio de [**CoTaskMemFree**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemfree) quando ele é concluído.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-114">The calling application (in this case the sound editor) is responsible for freeing it through [**CoTaskMemFree**](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemfree) when it is finished.</span></span>

<span data-ttu-id="cfcb2-115">DataGet é necessário para reconhecer três GUIDs predefinidos, listados na documentação do SAPI.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-115">DataGet is required to recognize three predefined GUIDs, which are listed in the SAPI documentation.</span></span> <span data-ttu-id="cfcb2-116">Um mecanismo que retorna um código de êxito para a chamada para **dwordset (SRATTR \_ PHONESEG, 1)** também é necessário para reconhecer um GUID específico, **SRGARC \_ PHONEMESEGMENTATION**, quando chamado com um **dwID** que corresponde a uma borda no grafo.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-116">An engine which returns a success code to the call to **DWORDSet(SRATTR\_PHONESEG, 1)** is also required to recognize a specific GUID, **SRGARC\_PHONEMESEGMENTATION**, when called with a **dwID** that corresponds to an edge in the graph.</span></span>

`DEFINE_GUID(SRGARC_PHONMESEGMENTATION, 0xd05405b0, 0x1db1, 0x11d2, 0x94, 0x2, 0x0, 0xc0, 0x4f, 0x8e, 0xf4, 0x8f);`

<span data-ttu-id="cfcb2-117">Quando a chamada retorna, **psData** deve apontar para uma matriz de estrutura alinhada em DWORD do tipo **PHONESEG**, definida por:</span><span class="sxs-lookup"><span data-stu-id="cfcb2-117">When the call returns, **psData** should point to an array of DWORD-aligned structure of type **PHONESEG**, defined by:</span></span>

``` syntax
typedef struct tagSRPHONESEG {
   DWORD   dwSize;       // Size of the SRPHONESEG structure + phone data
   QWORD   qwStartTime;  // SAPI timestamp of the start of the seqment
   …QWORD   qwEndTime;    // SAPI timestamp of the end of the seqment
   int      nScore;      // The segment's score
   WCHAR   aPhones[0];   // Array of phone(s) making up the segment
} SRPHONESEG,  *PSRPHONESEG;
```

<span data-ttu-id="cfcb2-118">onde **qwStartTime** e **qwEndTime** apontam para o início e o fim de cada fonema que compõem a palavra coberta pela borda, e **aPhones** é uma matriz de caracteres Unicode correspondente à representação IPA do telefone, que foi produzido nesse segmento.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-118">where **qwStartTime** and **qwEndTime** point to the beginning and end of each phoneme making up the word covered by the edge, and **aPhones** is an array of Unicode characters corresponding to the IPA representation of the phone, which were produced in this segment.</span></span> <span data-ttu-id="cfcb2-119">(Em alguns idiomas, há fonemas que são escritos com mais de um fonema IPA.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-119">(In some languages, there are phonemes which are spelled with more than one IPA phoneme.</span></span> <span data-ttu-id="cfcb2-120">Em inglês, por exemplo, o som "Long I" na palavra "Live" é, na verdade, um diphthong, composto de dois fonemas mais simples concatenados juntos.) A matriz **aPhones** deve ser terminada em zero e preenchida no final para fazer com que cada estrutura **SRPHONESEG** na matriz tenha um múltiplo par de quatro bytes de comprimento.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-120">In English, for instance, the "long I" sound in the word "live" is actually a diphthong, made up of two simpler phonemes concatenated together.) The **aPhones** array should be zero terminated and padded at the end to make each **SRPHONESEG** structure in the array an even multiple of four bytes long.</span></span>

<span data-ttu-id="cfcb2-121">Por exemplo, suponha que a palavra falada no arco 4 fosse "feita".</span><span class="sxs-lookup"><span data-stu-id="cfcb2-121">For example, suppose the word spoken on arc 4 was "made".</span></span> <span data-ttu-id="cfcb2-122">Em seguida, a chamada para DataGet (4, **SRGARC \_ PHONEMESEGMENTATION**, &SD) pode retornar uma matriz de três segmentos de fonema,/m/em execução de **qwStartTime**= 328434 bytes a **qwEndTime**= 330354 bytes,/1e/em execução de **qwStartTime**= 330354 bytes para **qwEndTime**= 344114 bytes e/d/em execução de **qwStartTime**= 344114 bytes para **qwEndTime**= 347314 bytes.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-122">Then the call to DataGet(4, **SRGARC\_PHONEMESEGMENTATION**, &sd) might return an array of three phoneme segments, /m/ running from **qwStartTime**=328434 bytes to **qwEndTime**=330354 bytes, /1e/ running from **qwStartTime**=330354 bytes to **qwEndTime**=344114 bytes, and /d/ running from **qwStartTime**=344114 bytes to **qwEndTime**=347314 bytes.</span></span> <span data-ttu-id="cfcb2-123">Eles seriam apresentados como uma matriz empacotada de três estruturas **SRPHONESEG** de tamanhos 28, 32 e 28 bytes, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-123">These would be presented as a packed array of three **SRPHONESEG** structures of sizes 28, 32, and 28 bytes, respectively.</span></span> <span data-ttu-id="cfcb2-124">Observe que há algum preenchimento no final da estrutura do meio **SRPHONESEG** , para que o próximo item na matriz comece com um limite de 4 bytes.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-124">Notice that there is some padding at the end of the middle **SRPHONESEG** structure, so that the next item in the array starts at a 4-byte boundary.</span></span>

<span data-ttu-id="cfcb2-125">O SDK do SAPI 4,0 inclui uma ferramenta (SRFunc) para testar a conformidade com a especificação SAPI 4,0. Incluídos nessa ferramenta há um teste de conformidade com esse conjunto de interfaces.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-125">The SAPI 4.0 SDK includes a tool (SRFunc) for testing compliance with the SAPI 4.0 spec. Included in that tool is a test for compliance with this set of interfaces.</span></span> <span data-ttu-id="cfcb2-126">O código-fonte para essa ferramenta é um bom ponto de partida para entender como essas interfaces irão interagir com o editor de som e depurar as interfaces durante o desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="cfcb2-126">The source code for that tool is a good place to start in order to understand how these interfaces will interact with the sound editor, and to debug the interfaces during development.</span></span>

 

 