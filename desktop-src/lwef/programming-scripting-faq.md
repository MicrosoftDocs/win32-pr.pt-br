---
title: Perguntas frequentes sobre programação de scripts
description: Perguntas frequentes sobre programação de scripts
ms.assetid: 84078c5b-7b04-48fa-9d0a-d95393c323eb
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 28dec468eb5147968ca0db774f081212a78cf40d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104004774"
---
# <a name="programming-scripting-faq"></a><span data-ttu-id="25072-103">Perguntas frequentes sobre programação de scripts</span><span class="sxs-lookup"><span data-stu-id="25072-103">Programming Scripting FAQ</span></span>

<span data-ttu-id="25072-104">\[O Microsoft Agent foi preterido a partir do Windows 7 e pode não estar disponível nas versões subsequentes do Windows.\]</span><span class="sxs-lookup"><span data-stu-id="25072-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

### <a name="when-i-use-microsoft-visual-basic-or-other-development-tools-for-scripting-microsoft-agent-i-do-not-see-all-the-properties-and-events-used-in-your-samples-how-do-i-access-them"></a><span data-ttu-id="25072-105">Quando uso o Microsoft Visual Basic (ou outras ferramentas de desenvolvimento) para gerar scripts no Microsoft Agent, não vejo todas as propriedades e os eventos usados em seus exemplos.</span><span class="sxs-lookup"><span data-stu-id="25072-105">When I use Microsoft Visual Basic (or other development tools) for scripting Microsoft Agent, I do not see all the properties and events used in your samples.</span></span> <span data-ttu-id="25072-106">Como fazer acessá-los?</span><span class="sxs-lookup"><span data-stu-id="25072-106">How do I access them?</span></span>

<span data-ttu-id="25072-107">A maioria dos eventos, métodos e propriedades com suporte pelo controle do Microsoft Agent é exposta somente em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="25072-107">Most of the events, methods, and properties supported by the Microsoft Agent control are exposed only at run time.</span></span> <span data-ttu-id="25072-108">Consulte [programação do controle do Microsoft Agent](programming-the-microsoft-agent-control.md) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="25072-108">Consult [Programming the Microsoft Agent Control](programming-the-microsoft-agent-control.md) for further information.</span></span>

### <a name="the-map-tag-or-some-other-tag-doesnt-seem-to-work"></a><span data-ttu-id="25072-109">A marca de mapa (ou alguma outra marca) não parece funcionar.</span><span class="sxs-lookup"><span data-stu-id="25072-109">The Map tag (or some other tag) doesn't seem to work.</span></span>

<span data-ttu-id="25072-110">Algumas marcas incluem cadeias de caracteres entre aspas.</span><span class="sxs-lookup"><span data-stu-id="25072-110">Some tags include quoted strings.</span></span> <span data-ttu-id="25072-111">Para algumas linguagens de programação, como Microsoft Visual Basic e Visual Basic Scripting Edition, talvez seja necessário usar duas aspas para designar o parâmetro da marca ou concatenar um caractere de aspas duplas como parte da cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="25072-111">For some programming languages, such as Microsoft Visual Basic and Visual Basic Scripting Edition, you may have to use two quote marks to designate the tag's parameter or concatenate a double-quote character as part of the string.</span></span> <span data-ttu-id="25072-112">O último é mostrado neste Visual Basic exemplo:</span><span class="sxs-lookup"><span data-stu-id="25072-112">The latter is shown in this Visual Basic example:</span></span>

<span data-ttu-id="25072-113">Agent1. Characters ("gênio"). Fale "é \\ map =" + Chr (34) + "texto falado" \_ + Chr (34) + "=" + Chr (34) + "texto de balão" + Chr (34) + " \\ ."</span><span class="sxs-lookup"><span data-stu-id="25072-113">Agent1.Characters("Genie").Speak "This is \\map=" + chr(34) + "Spoken text" \_ + chr(34) + "=" + chr(34) + "Balloon text" + chr(34) + "\\."</span></span>

<span data-ttu-id="25072-114">Para a programação C, C++ e Java, preceda as barras invertidas e aspas duplas com uma barra invertida.</span><span class="sxs-lookup"><span data-stu-id="25072-114">For C, C++, and Java programming, precede backslashes and double quotes with a backslash.</span></span> <span data-ttu-id="25072-115">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="25072-115">For example:</span></span>

<span data-ttu-id="25072-116">BSTR bszSpeak = SysAllocString (L "é \\ \\ map = \\ " texto falado \\ "= \\ " texto de balão \\ " \\ \\ ");</span><span class="sxs-lookup"><span data-stu-id="25072-116">BSTR bszSpeak = SysAllocString(L"This is \\\\map=\\"Spoken text\\"=\\"Balloon text\\"\\\\");</span></span>

<span data-ttu-id="25072-117">pCharacter->falar (bszSpeak,......);</span><span class="sxs-lookup"><span data-stu-id="25072-117">pCharacter->Speak(bszSpeak, ......);</span></span>

> [!Note]  
> <span data-ttu-id="25072-118">O Microsoft Agent não oferece suporte a todas as marcas especificadas no Microsoft Speech API.</span><span class="sxs-lookup"><span data-stu-id="25072-118">Microsoft Agent does not support all the tags specified in the Microsoft Speech API.</span></span> <span data-ttu-id="25072-119">Além disso, o suporte para alguns parâmetros pode depender do mecanismo de conversão de texto em fala instalado.</span><span class="sxs-lookup"><span data-stu-id="25072-119">In addition, support for some parameters may depend on the text-to-speech engine installed.</span></span> <span data-ttu-id="25072-120">Para obter mais informações, consulte [marcas de saída de fala do Microsoft Agent](microsoft-agent-speech-output-tags.md).</span><span class="sxs-lookup"><span data-stu-id="25072-120">For further information, see [Microsoft Agent Speech Output Tags](microsoft-agent-speech-output-tags.md).</span></span>

 

### <a name="i-dont-seem-to-get-requeststart-and-requestcomplete-events-in-my-script-or-program"></a><span data-ttu-id="25072-121">Não parece obter eventos RequestStart e RequestComplete em meu script (ou programa).</span><span class="sxs-lookup"><span data-stu-id="25072-121">I don't seem to get RequestStart and RequestComplete events in my script (or program).</span></span>

<span data-ttu-id="25072-122">Isso pode ser causado por um dos seguintes problemas:</span><span class="sxs-lookup"><span data-stu-id="25072-122">This could be caused by one of the following problems:</span></span>

-   <span data-ttu-id="25072-123">Sua linguagem de programação não dá suporte total a controles ActiveX.</span><span class="sxs-lookup"><span data-stu-id="25072-123">Your programming language doesn't fully support ActiveX controls.</span></span> <span data-ttu-id="25072-124">Verifique sua documentação para garantir que ela dê suporte à interface e aos eventos do ActiveX para objetos ActiveX.</span><span class="sxs-lookup"><span data-stu-id="25072-124">Check your documentation to ensure that it supports the ActiveX interface and events for ActiveX objects.</span></span>
-   <span data-ttu-id="25072-125">Em uma página da Web com script, não foi possível instalar ou carregar outro controle.</span><span class="sxs-lookup"><span data-stu-id="25072-125">On a scripted webpage, another control has failed to install or load.</span></span> <span data-ttu-id="25072-126">Verifique se todos os outros controles estão instalados e carregando corretamente sem o Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="25072-126">Check to ensure that all other controls are installed and loading properly without Microsoft Agent.</span></span>
-   <span data-ttu-id="25072-127">Em uma página da Web com script com quadros, você tem a `<OBJECT>` marca para o controle do Microsoft Agent em uma página e os eventos com script em outra página.</span><span class="sxs-lookup"><span data-stu-id="25072-127">On a scripted webpage with frames, you have the `<OBJECT>` tag for the Microsoft Agent control on one page, and the events scripted on another page.</span></span> <span data-ttu-id="25072-128">Os eventos são enviados somente para a página que hospeda o controle.</span><span class="sxs-lookup"><span data-stu-id="25072-128">Events are sent only to the page that hosts the control.</span></span>

### <a name="i-am-using-the-microsoft-agent-control-with-other-activex-controls-on-my-webpage-and-i-dont-seem-to-get-any-events"></a><span data-ttu-id="25072-129">Estou usando o controle de agente da Microsoft com outros controles ActiveX na minha página da Web, e não parece ter nenhum evento.</span><span class="sxs-lookup"><span data-stu-id="25072-129">I am using the Microsoft Agent control with other ActiveX controls on my webpage, and I don't seem to get any events.</span></span>

<span data-ttu-id="25072-130">Verifique se os outros controles estão instalados corretamente.</span><span class="sxs-lookup"><span data-stu-id="25072-130">Check to see if the other controls are correctly installed.</span></span> <span data-ttu-id="25072-131">Se outro controle ActiveX falhar em registrar-se corretamente, o controle do Microsoft Agent poderá receber seus eventos.</span><span class="sxs-lookup"><span data-stu-id="25072-131">If another ActiveX control fails to correctly register itself, the Microsoft Agent control may receive its events.</span></span>

### <a name="what-programming-languages-can-i-use-to-program-the-microsoft-agent-control"></a><span data-ttu-id="25072-132">Quais linguagens de programação posso usar para programar o Microsoft Agent Control?</span><span class="sxs-lookup"><span data-stu-id="25072-132">What programming languages can I use to program the Microsoft Agent control?</span></span>

<span data-ttu-id="25072-133">O Microsoft Agent deve ser compatível com qualquer linguagem que dê suporte à interface do ActiveX.</span><span class="sxs-lookup"><span data-stu-id="25072-133">Microsoft Agent should be supportable from any language that supports the ActiveX interface.</span></span> <span data-ttu-id="25072-134">Ele inclui exemplos de código para Visual Basic, VBScript, JScript, C/C++ e Java.</span><span class="sxs-lookup"><span data-stu-id="25072-134">It includes code samples for Visual Basic, VBScript, JScript, C/C++, and Java.</span></span>

### <a name="can-i-access-the-parameters-returned-from-microsoft-agent-using-jscript"></a><span data-ttu-id="25072-135">Posso acessar os parâmetros retornados do Microsoft Agent usando o JScript?</span><span class="sxs-lookup"><span data-stu-id="25072-135">Can I access the parameters returned from Microsoft Agent using JScript?</span></span>

<span data-ttu-id="25072-136">Sim, mas atualmente a única maneira de fazer isso é usando a `<SCRIPT LANGUAGE="JScript" FOR="*object*" EVENT="event()">` sintaxe.</span><span class="sxs-lookup"><span data-stu-id="25072-136">Yes, but currently the only way to do this is using the `<SCRIPT LANGUAGE="JScript" FOR="*object*" EVENT="event()">` syntax.</span></span> <span data-ttu-id="25072-137">Embora essa sintaxe tenha suporte para o Microsoft Internet Explorer, outros navegadores não dão suporte a ela, portanto, convém evitar o uso do JScript para essa parte do script de sua página.</span><span class="sxs-lookup"><span data-stu-id="25072-137">Although this syntax is supported for Microsoft Internet Explorer, other browsers do not support it, so you may want to avoid using JScript for this part of your page's script.</span></span>

### <a name="can-microsoft-agent-be-used-with-speech-recognition-or-speech-synthesis-text-to-speech-or-tts-engines-other-than-those-supplied-by-microsoft"></a><span data-ttu-id="25072-138">O Microsoft Agent pode ser usado com mecanismos de reconhecimento de fala ou de síntese de fala (conversão de texto em fala ou TTS) diferentes daqueles fornecidos pela Microsoft?</span><span class="sxs-lookup"><span data-stu-id="25072-138">Can Microsoft Agent be used with speech recognition or speech synthesis (text-to-speech, or TTS) engines other than those supplied by Microsoft?</span></span>

<span data-ttu-id="25072-139">Sim, desde que o mecanismo dê suporte às interfaces do Microsoft Speech API (SAPI) 4,0 exigidas pelo Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="25072-139">Yes, provided that the engine supports the Microsoft Speech API (SAPI) 4.0 interfaces required by Microsoft Agent.</span></span> <span data-ttu-id="25072-140">Verifique com o fornecedor do mecanismo.</span><span class="sxs-lookup"><span data-stu-id="25072-140">Check with the engine supplier.</span></span> <span data-ttu-id="25072-141">Para obter detalhes completos sobre as interfaces SAPI exigidas pelo Microsoft Agent, consulte [requisitos de suporte do mecanismo de fala](speech-engine-support-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="25072-141">For complete details on the SAPI interfaces required by Microsoft Agent, see [Speech Engine Support Requirements](speech-engine-support-requirements.md).</span></span>

### <a name="my-page-includes-html-object-tags-for-microsoft-agent-the-lernout--hauspie-truvoice-tts-engine-and-the-microsoft-command-and-control-speech-recognition-engine-but-not-all-the-components-install"></a><span data-ttu-id="25072-142">Minha página inclui marcas de objeto HTML para o Microsoft Agent, o mecanismo Lernout & Hauspie TruVoice TTS e o mecanismo de reconhecimento de fala de comando e controle da Microsoft, mas nem todos os componentes são instalados.</span><span class="sxs-lookup"><span data-stu-id="25072-142">My page includes HTML Object tags for Microsoft Agent, the Lernout & Hauspie TruVoice TTS engine, and the Microsoft Command and Control speech recognition engine, but not all the components install.</span></span>

<span data-ttu-id="25072-143">Normalmente, o problema pode ser corrigido atualizando a página.</span><span class="sxs-lookup"><span data-stu-id="25072-143">Typically, the problem can be corrected by refreshing the page.</span></span> <span data-ttu-id="25072-144">Como uma prática geral, é melhor especificar primeiro a marca de controle do Microsoft Agent `<OBJECT>` , depois o mecanismo de reconhecimento de fala de Lernout & Hauspie, em seguida, o comando e controlar o mecanismo.</span><span class="sxs-lookup"><span data-stu-id="25072-144">As a general practice, it is best to specify the Microsoft Agent Control `<OBJECT>` tag first, then the Lernout & Hauspie TruVoice engine, then the Command and Control speech recognition engine.</span></span>

### <a name="after-calling-the-moveto-method-my-character-seems-to-freeze-even-though-i-have-return-animations-assigned-to-moving-state-animations"></a><span data-ttu-id="25072-145">Depois de chamar o método MoveTo, meu caractere parece congelar, embora eu tenha animações de retorno atribuídas à movimentação de animações de estado.</span><span class="sxs-lookup"><span data-stu-id="25072-145">After calling the MoveTo method, my character seems to freeze even though I have Return animations assigned to Moving state animations.</span></span>

<span data-ttu-id="25072-146">Quando você joga uma animação, os serviços de animação continuam a exibir seu último quadro até que outra animação seja chamada.</span><span class="sxs-lookup"><span data-stu-id="25072-146">When you play an animation, the animation services continue to display its last frame until another animation is called.</span></span> <span data-ttu-id="25072-147">Portanto, você deve reproduzir outra animação depois de chamar [**MoveTo**](moveto-method.md).</span><span class="sxs-lookup"><span data-stu-id="25072-147">Therefore, you should play another animation after calling [**MoveTo**](moveto-method.md).</span></span> <span data-ttu-id="25072-148">Se você tiver definido uma animação de **retorno** para a animação do estado **móvel** , o servidor a executará primeiro.</span><span class="sxs-lookup"><span data-stu-id="25072-148">If you defined a **Return** animation for the **Moving** state animation, the server will play it first.</span></span>

### <a name="when-i-query-the-characters-pitch-property-it-returns-a-value-of--1"></a><span data-ttu-id="25072-149">Quando eu consulta a propriedade Pitch do caractere, ela retorna um valor de-1.</span><span class="sxs-lookup"><span data-stu-id="25072-149">When I query the character's Pitch property, it returns a value of -1.</span></span>

<span data-ttu-id="25072-150">Isso ocorre se o caractere tiver sido compilado usando a propriedade de densidade padrão de um mecanismo de fala; ou seja, a inclinação não foi alterada quando o caractere foi compilado.</span><span class="sxs-lookup"><span data-stu-id="25072-150">This occurs if the character has been compiled using a speech engine's default pitch property; that is, the pitch was not changed when the character was built.</span></span>

### <a name="when-my-code-attempts-to-set-the-tts-mode-id-for-a-text-to-speech-engine-i-get-the-following-error-an-outgoing-call-cannot-be-made-since-the-application-is-dispatching-an-input-synchronous-call"></a><span data-ttu-id="25072-151">Quando meu código tenta definir a ID do modo TTS para um mecanismo de conversão de texto em fala, obtenho o seguinte erro: uma chamada de saída não pode ser feita porque o aplicativo está expedindo uma chamada de entrada síncrona.</span><span class="sxs-lookup"><span data-stu-id="25072-151">When my code attempts to set the TTS mode ID for a text-to-speech engine, I get the following error: An outgoing call cannot be made since the application is dispatching an input-synchronous call.</span></span>

<span data-ttu-id="25072-152">Para definir a propriedade TTSModeID, você deve ter Speech.dll instalado.</span><span class="sxs-lookup"><span data-stu-id="25072-152">To set the TTSModeID property, you must have Speech.dll installed.</span></span> <span data-ttu-id="25072-153">Normalmente, isso é uma parte do código de instalação do mecanismo de fala.</span><span class="sxs-lookup"><span data-stu-id="25072-153">This is typically a part of the speech engine's installation code.</span></span> <span data-ttu-id="25072-154">Você também pode instalar isso instalando o painel de controle do objeto de fala, disponível na página de downloads do Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="25072-154">You may also install this by installing the Speech object control panel , available from the Microsoft Agent Downloads page.</span></span>

### <a name="when-i-retry-loading-a-character-that-failed-to-load-the-call-fails-with-a-character-already-loaded-error"></a><span data-ttu-id="25072-155">Ao tentar carregar novamente um caractere que falhou ao ser carregado, a chamada falha com um erro "caractere já carregado".</span><span class="sxs-lookup"><span data-stu-id="25072-155">When I retry loading a character that failed to load, the call fails with a "Character already loaded" error.</span></span>

<span data-ttu-id="25072-156">O controle do Microsoft Agent não descarrega um objeto Character (libere a referência) quando seu arquivo de caractere associado não for carregado.</span><span class="sxs-lookup"><span data-stu-id="25072-156">The Microsoft Agent control does not unload a character object (release the reference) when its associated character file fails to load.</span></span> <span data-ttu-id="25072-157">Se você quiser tentar carregar o caractere novamente, deverá chamar [**Unload**](unload-method.md) explicitamente antes de chamar [**Load**](load-method.md) da segunda vez.</span><span class="sxs-lookup"><span data-stu-id="25072-157">If you want to retry loading the character, you must explicitly call [**Unload**](unload-method.md) before you call [**Load**](load-method.md) the second time.</span></span> <span data-ttu-id="25072-158">Se você tentar isso a partir de um script de página da Web, também precisará preceder a chamada **Unload** com uma instrução On Error continue Next ou a chamada **Unload** também falhará.</span><span class="sxs-lookup"><span data-stu-id="25072-158">If you attempt this from a webpage script, you also need to precede the **Unload** call with an On Error Resume Next statement, or the **Unload** call will also fail.</span></span> <span data-ttu-id="25072-159">(Observe que o JScript não tem o erro retomar a próxima instrução.)</span><span class="sxs-lookup"><span data-stu-id="25072-159">(Note that JScript has no On Error Resume Next statement.)</span></span>

<span data-ttu-id="25072-160">No entanto, talvez você não precise incluir o código para repetir o carregamento de um caractere imediatamente quando o arquivo falhar ao ser carregado.</span><span class="sxs-lookup"><span data-stu-id="25072-160">However, you may not need to include code to immediately retry loading a character when the file fails to load.</span></span> <span data-ttu-id="25072-161">O Microsoft Internet Explorer e o componente de servidor do Microsoft Agent tentam tentar novamente várias vezes, portanto, as chances de que sua repetição resulte em uma carga bem-sucedida sejam remotas.</span><span class="sxs-lookup"><span data-stu-id="25072-161">Microsoft Internet Explorer and the Microsoft Agent server component automatically attempt to retry several times, so the chances that your retry will result in a successful load are remote.</span></span> <span data-ttu-id="25072-162">Uma estratégia melhor é aguardar (definir um temporizador) alguns segundos antes de tentar novamente.</span><span class="sxs-lookup"><span data-stu-id="25072-162">A better strategy is to wait (set a timer) a few seconds before you retry.</span></span>

### <a name="how-can-i-install-microsoft-agent-as-part-of-my-application-or-from-my-web-server"></a><span data-ttu-id="25072-163">Como posso instalar o Microsoft Agent como parte do meu aplicativo ou do meu servidor Web?</span><span class="sxs-lookup"><span data-stu-id="25072-163">How can I install Microsoft Agent as part of my application or from my web server?</span></span>

<span data-ttu-id="25072-164">Você pode instalar o agente do site da Microsoft, incluindo seu *CLSID em uma marca de objeto HTML*.</span><span class="sxs-lookup"><span data-stu-id="25072-164">You can install Agent from the Microsoft website by including its *CLSID in an HTML Object tag*.</span></span> <span data-ttu-id="25072-165">No entanto, se desejar incluir e instalar o agente do seu próprio programa de instalação de aplicativo ou de seu próprio servidor, você deverá baixar o arquivo de gabinete de autoinstalação do Microsoft Agent, baixando-o da página de downloads.</span><span class="sxs-lookup"><span data-stu-id="25072-165">However, if you want to include and install Agent from your own application installation program or from your own server, you must download the Microsoft Agent self-installing cabinet file, by downloading it from the Downloads page.</span></span> <span data-ttu-id="25072-166">Ao baixar, escolha a opção salvar em vez de executar do navegador.</span><span class="sxs-lookup"><span data-stu-id="25072-166">When downloading, choose the browser's Save rather than Run option.</span></span> <span data-ttu-id="25072-167">Sempre que esse arquivo for executado, ele instalará automaticamente o Microsoft Agent no computador de destino.</span><span class="sxs-lookup"><span data-stu-id="25072-167">Whenever this file is run, it automatically will install Microsoft Agent on the target machine.</span></span> <span data-ttu-id="25072-168">Portanto, você pode especificar o arquivo em seu script de instalação.</span><span class="sxs-lookup"><span data-stu-id="25072-168">Therefore you can specify the file in your installation script.</span></span>

<span data-ttu-id="25072-169">Não tente instalar o Microsoft Agent copiando seus vários. DLLs e tentando registrá-la por conta própria.</span><span class="sxs-lookup"><span data-stu-id="25072-169">Do not attempt to install Microsoft Agent by copying its various .DLLs and attempting to register it yourself.</span></span> <span data-ttu-id="25072-170">A tentativa de instalar o agente por outros meios significa que não há suporte para executar seu arquivo de gabinete de autoinstalação.</span><span class="sxs-lookup"><span data-stu-id="25072-170">Attempting to install Agent by any other means then executing its self-installing cabinet file is not supported.</span></span>

<span data-ttu-id="25072-171">O sistema de destino também deve incluir versões recentes do MSVCRT.DLL (VC + + Runtime), REGSVR32.EXE (ferramenta de registro incluída no Microsoft VC + +) e COM.</span><span class="sxs-lookup"><span data-stu-id="25072-171">The target system must also include recent versions of MSVCRT.DLL (VC++ runtime), REGSVR32.EXE (registration tool included with Microsoft VC++), and COM.</span></span> <span data-ttu-id="25072-172">A melhor maneira de garantir que as versões corretas estejam instaladas é exigir que o Microsoft Internet Explorer 3, 2 ou posterior esteja instalado.</span><span class="sxs-lookup"><span data-stu-id="25072-172">The best way to ensure that the correct versions are installed is to require that Microsoft Internet Explorer 3.02 or later is installed.</span></span> <span data-ttu-id="25072-173">No entanto, você também pode licenciar esses requisitos de tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="25072-173">However, you can also license these runtime requirements.</span></span> <span data-ttu-id="25072-174">(Para a versão mais recente do COM, acesse a atualização DCOM do site da Microsoft.)</span><span class="sxs-lookup"><span data-stu-id="25072-174">(For the latest version of COM, access the DCOM update from the Microsoft website.)</span></span>

<span data-ttu-id="25072-175">O Microsoft Agent 2,0 não será instalado no Microsoft Windows 2000, pois esta versão do sistema operacional já inclui o Agent.</span><span class="sxs-lookup"><span data-stu-id="25072-175">Microsoft Agent 2.0 will not install on Microsoft Windows 2000 since this version of the operating system already includes Agent.</span></span>

### <a name="can-i-use-the-visual-basic-setup-wizard-to-install-microsoft-agent"></a><span data-ttu-id="25072-176">Posso usar o assistente de instalação do Visual Basic para instalar o Microsoft Agent?</span><span class="sxs-lookup"><span data-stu-id="25072-176">Can I use the Visual Basic Setup Wizard to install Microsoft Agent?</span></span>

<span data-ttu-id="25072-177">Embora você possa criar seu próprio programa de instalação usando o Visual Basic (VB), não é possível usar o assistente de instalação do Visual Basic para fazer isso.</span><span class="sxs-lookup"><span data-stu-id="25072-177">While you can create your own installation program using Visual Basic (VB) code you can't use the Visual Basic Setup Wizard to do this.</span></span> <span data-ttu-id="25072-178">Para instalar o agente do VB, você pode usar o comando do Shell, especificando o arquivo de gabinete de instalação automática do Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="25072-178">To install Agent from VB, you can use Shell command, specifying the Microsoft Agent self-installing cabinet file.</span></span>

### <a name="how-do-i-install-microsoft-agent-on-windows-2000"></a><span data-ttu-id="25072-179">Como fazer instalar o Microsoft Agent no Windows 2000?</span><span class="sxs-lookup"><span data-stu-id="25072-179">How do I install Microsoft Agent on Windows 2000?</span></span>

<span data-ttu-id="25072-180">O Microsoft Agent 2,0 não é instalado no Windows 2000 porque já está incluído como parte do sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="25072-180">Microsoft Agent 2.0 does not install on Windows 2000 because it is already included as a part of the operating system.</span></span>

### <a name="agentsvr-crashes-when-speak-is-called-with-a-wav-file"></a><span data-ttu-id="25072-181">AgentSvr falha quando a fala é chamada com um arquivo WAV.</span><span class="sxs-lookup"><span data-stu-id="25072-181">AgentSvr crashes when Speak is called with a WAV file.</span></span>

<span data-ttu-id="25072-182">Isso pode ocorrer quando o caractere usa o TTS para saída falada e, em seguida, muda para usar um arquivo WAV.</span><span class="sxs-lookup"><span data-stu-id="25072-182">This may result when the character has been using TTS for spoken output, then changes to use a WAV file.</span></span> <span data-ttu-id="25072-183">O texto não foi fornecido no primeiro parâmetro do método Speak.</span><span class="sxs-lookup"><span data-stu-id="25072-183">Text was not supplied in the first parameter of the Speak method.</span></span>

<span data-ttu-id="25072-184">Para evitar a falha, inclua um caractere de espaço no primeiro parâmetro do método Speak, mesmo que você não tenha nenhuma saída de texto.</span><span class="sxs-lookup"><span data-stu-id="25072-184">To avoid the crash, include a space character in the first parameter of the Speak method, even if you have no text output.</span></span>

### <a name="even-though-i-have-already-installed-the-agent-language-component-dll-for-a-particular-language-i-still-got-an-error-that-the-component-is-missing-when-i-set-the-characters-language-to-that-language"></a><span data-ttu-id="25072-185">Embora eu já tenha instalado o componente de linguagem do agente (DLL) para um idioma específico, ainda tenho um erro de que o componente está ausente quando eu defini o idioma do caractere para esse idioma.</span><span class="sxs-lookup"><span data-stu-id="25072-185">Even though I have already installed the Agent language component (DLL) for a particular language, I still got an error that the component is missing when I set the character's language to that language.</span></span>

<span data-ttu-id="25072-186">Isso geralmente acontece quando você tem aplicativos de agente como o Microsoft Office 2000 aberto ao instalar o componente de idioma do agente.</span><span class="sxs-lookup"><span data-stu-id="25072-186">This usually happens when you have Agent applications such as Microsoft Office 2000 open when you install the Agent language component.</span></span> <span data-ttu-id="25072-187">Feche todos os aplicativos e tente novamente.</span><span class="sxs-lookup"><span data-stu-id="25072-187">Close all applications and try again.</span></span> <span data-ttu-id="25072-188">Se o problema persistir, reinicie o computador e você poderá definir a ID do idioma agora.</span><span class="sxs-lookup"><span data-stu-id="25072-188">If the problem persists, restart your computer and you should be able to set the language ID now.</span></span>

### <a name="when-i-use-the-ampersand--symbol-the-text-around-the-symbol-in-the-characters-word-balloons-is-truncated"></a><span data-ttu-id="25072-189">Quando uso o símbolo de "&" e comercial, o texto em volta do símbolo nos balões de palavras do caractere é truncado.</span><span class="sxs-lookup"><span data-stu-id="25072-189">When I use the ampersand "&" symbol, the text around the symbol in the character's word balloons is truncated.</span></span>

<span data-ttu-id="25072-190">Este é um problema conhecido.</span><span class="sxs-lookup"><span data-stu-id="25072-190">This is a known issue.</span></span> <span data-ttu-id="25072-191">Você pode contornar isso usando a marca de mapa.</span><span class="sxs-lookup"><span data-stu-id="25072-191">You can work around this by using the map tag.</span></span> <span data-ttu-id="25072-192">Por exemplo, para exibir "A & B" no balão de palavras do caractere, use "A \\ map =" e "=" && " \\ B" na instrução Speak.</span><span class="sxs-lookup"><span data-stu-id="25072-192">For example to display "A & B" in the character's word balloon, use "A \\map="and"="&&"\\ B" in the Speak statement.</span></span>

### <a name="my-application-allows-users-to-change-the-default-character-and-when-they-do-the-program-crashes"></a><span data-ttu-id="25072-193">Meu aplicativo permite que os usuários alterem o caractere padrão e, quando fazem isso, o programa falha.</span><span class="sxs-lookup"><span data-stu-id="25072-193">My application allows users to change the default character and when they do, the program crashes.</span></span>

<span data-ttu-id="25072-194">Há duas causas possíveis:</span><span class="sxs-lookup"><span data-stu-id="25072-194">There are two possible causes:</span></span>

<span data-ttu-id="25072-195">Se você alterar a ID do modo TTS do caractere padrão e permitir que o usuário altere o caractere padrão por meio de ShowDefaultCharacterProperties, AgentSvr falhará.</span><span class="sxs-lookup"><span data-stu-id="25072-195">If you change the TTS Mode ID of the default character and then allow the user to change the default character through ShowDefaultCharacterProperties, AgentSvr will crash.</span></span>

<span data-ttu-id="25072-196">Esse problema foi corrigido nos sistemas operacionais Windows 2000 e Windows XP.</span><span class="sxs-lookup"><span data-stu-id="25072-196">This problem has been fixed in the Windows 2000 and Windows XP operating systems.</span></span> <span data-ttu-id="25072-197">Para evitar a falha em outras plataformas, você não deve permitir que o usuário altere o caractere padrão depois de alterar a ID do modo TTS do caractere padrão ou não usar o caractere padrão em seu aplicativo ou página da Web.</span><span class="sxs-lookup"><span data-stu-id="25072-197">To avoid the crash on other platforms, you should either not allow the user to change the default character after you change the default character's TTS Mode ID, or do not use the default character in your application or webpage.</span></span>

<span data-ttu-id="25072-198">Se seu aplicativo não usar caracteres de agente fornecidos pela Microsoft, verifique se o caractere personalizado usa uma paleta com uma paleta completa de 256 cores.</span><span class="sxs-lookup"><span data-stu-id="25072-198">If your application does not use Microsoft-supplied Agent characters, make sure that your customized character uses a palette with a full palette of 256 colors.</span></span> <span data-ttu-id="25072-199">Para obter mais informações, consulte o documento criando caracteres para o Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="25072-199">For more information see the Designing Characters for Microsoft Agent document.</span></span>

### <a name="my-page-loads-the-agent-character-from-multiple-frames-with-ie-5-i-get-the-microsoft-agent-failed-to-load-error"></a><span data-ttu-id="25072-200">Minha página carrega o caractere do agente de vários quadros.</span><span class="sxs-lookup"><span data-stu-id="25072-200">My page loads the Agent character from multiple frames.</span></span> <span data-ttu-id="25072-201">Com o IE 5, obtenho um erro ao carregar o Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="25072-201">With IE 5, I get the Microsoft Agent failed to load error.</span></span>

<span data-ttu-id="25072-202">Esse é um problema conhecido com o IE 5.</span><span class="sxs-lookup"><span data-stu-id="25072-202">This is a known issue with IE 5.</span></span> <span data-ttu-id="25072-203">Houve uma alteração na forma como o navegador manipula um determinado evento, o que faz com que o script HTML comece a ser executado antes que AgentSvr seja iniciado.</span><span class="sxs-lookup"><span data-stu-id="25072-203">There was a change in how the browser handles a certain event, which causes the HTML script to begin running before AgentSvr is started.</span></span> <span data-ttu-id="25072-204">Para fazer com que sua página funcione com todas as versões do navegador, você precisa adicionar essa linha ao seu script:</span><span class="sxs-lookup"><span data-stu-id="25072-204">In order to make your page work with all versions of the browser, you need to add this line to your script:</span></span>

<span data-ttu-id="25072-205">AgentControl. Connected = true</span><span class="sxs-lookup"><span data-stu-id="25072-205">AgentControl.Connected = True</span></span>

<span data-ttu-id="25072-206">que cria explicitamente uma conexão com o AgentSvr.</span><span class="sxs-lookup"><span data-stu-id="25072-206">which explicitly creates a connection to the AgentSvr.</span></span> <span data-ttu-id="25072-207">Observe que você só precisa fazer isso se a página carregar o agente de vários quadros.</span><span class="sxs-lookup"><span data-stu-id="25072-207">Note that you only need to do this if your page loads Agent from multiple frames.</span></span>

### <a name="when-my-application-tries-to-install-microsoft-agent-on-windows-2000-or-windows-xp-i-get-the-error-that-agent-is-not-compatible-with-windows-2000-or-windows-xp"></a><span data-ttu-id="25072-208">Quando meu aplicativo tenta instalar o Microsoft Agent no Windows 2000 (ou no Windows XP), obtenho o erro de que o Agent não é compatível com o Windows 2000 (ou Windows XP).</span><span class="sxs-lookup"><span data-stu-id="25072-208">When my application tries to install Microsoft Agent on Windows 2000 (or Windows XP), I get the error that Agent is not compatible with Windows 2000 (or Windows XP).</span></span>

<span data-ttu-id="25072-209">Uma versão anterior do arquivo de gabinete do componente principal do Agent MSAGENT.exe, quando executada no Windows 2000 (e no Windows XP), bloqueará a instalação e exibirá uma mensagem de erro imprecisa que o Agent não é compatível com a versão do sistema operacional que você está executando.</span><span class="sxs-lookup"><span data-stu-id="25072-209">A previous version of the Agent core component cabinet file MSAGENT.exe, when executed on Windows 2000 (and Windows XP), will block installation and display an inaccurate error message that Agent is not compatible with the version of the operating system you are running.</span></span> <span data-ttu-id="25072-210">Na verdade, os componentes principais do Microsoft Agent 2,0 são incluídos como parte do Windows 2000 (e do Windows XP) e já estão instalados por padrão por meio da instalação do Windows.</span><span class="sxs-lookup"><span data-stu-id="25072-210">In fact, Microsoft Agent 2.0 core components are included as part of Windows 2000 (and Windows XP), and are already installed by default through Windows setup.</span></span>

<span data-ttu-id="25072-211">Nesta versão, a verificação é removida e o arquivo de instalação não exibe a mensagem de erro mencionada anteriormente no Windows 2000 (ou no Windows XP).</span><span class="sxs-lookup"><span data-stu-id="25072-211">In this version, the check is removed and the installation file will not display the aforementioned error message under Windows 2000 (or Windows XP).</span></span> <span data-ttu-id="25072-212">Observe que essa é a única alteração no arquivo de instalação e não há nenhuma alteração de código para os componentes principais do agente.</span><span class="sxs-lookup"><span data-stu-id="25072-212">Note that this is the only change to the installation file, and there are no code changes to the Agent core components themselves.</span></span> <span data-ttu-id="25072-213">Portanto, você não será afetado por essa atualização se já tiver o Agent 2,0 instalado ou se seu site usar uma marca de objeto para disparar Downloads automáticos dos componentes principais do agente do armazenamento de objetos da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="25072-213">Therefore, you are not affected by this update if you already have Agent 2.0 installed, or if your website uses an object tag to trigger automatic downloads of the Agent core components from the Microsoft Object Store.</span></span>

<span data-ttu-id="25072-214">Se você incluir o arquivo de instalação do componente de núcleo do agente com seu aplicativo, ou se você publicar o arquivo de instalação no servidor, convém baixar essa atualização.</span><span class="sxs-lookup"><span data-stu-id="25072-214">If you include the Agent core component installation file with your application, or if you post the installation file on your server, you may want to download this update.</span></span> <span data-ttu-id="25072-215">Para fazer isso, clique aqui e selecione a opção "salvar este programa em disco".</span><span class="sxs-lookup"><span data-stu-id="25072-215">To do so, click here and select the "Save this program to disk" option.</span></span> <span data-ttu-id="25072-216">Você deve ter uma licença válida e de distribuição de agente atual para essas circunstâncias.</span><span class="sxs-lookup"><span data-stu-id="25072-216">You must have a valid and current Agent distribution license for these circumstances.</span></span>

<span data-ttu-id="25072-217">Como alternativa, você também pode contornar esse problema usando a opção silencioso ao instalar a versão anterior do arquivo de instalação do MSAGENT.exe.</span><span class="sxs-lookup"><span data-stu-id="25072-217">Alternately, you can also work around this problem by using the silent option when installing the previous version of the MSAGENT.exe installation file.</span></span> <span data-ttu-id="25072-218">O comando do Shell é:</span><span class="sxs-lookup"><span data-stu-id="25072-218">The shell command is:</span></span>

<span data-ttu-id="25072-219">**MSAGENT.exe/q: a**</span><span class="sxs-lookup"><span data-stu-id="25072-219">**MSAGENT.exe /q:a**</span></span>

<span data-ttu-id="25072-220">O mesmo se aplica aos componentes de idioma do agente que foram originalmente lançados em outubro de 1998.</span><span class="sxs-lookup"><span data-stu-id="25072-220">The same applies to the Agent language components that were originally released in October 1998.</span></span> <span data-ttu-id="25072-221">Houve uma verificação que impediria que os componentes árabe, francês, alemão, Hebraico, italiano, japonês, coreano, chinês simplificado, espanhol e chinês tradicional sejam instalados no Windows 2000 (e no Windows XP).</span><span class="sxs-lookup"><span data-stu-id="25072-221">There was a check that would prevent the Arabic, French, German, Hebrew, Italian, Japanese, Korean, Simplified Chinese, Spanish, and Traditional Chinese language components from installing under Windows 2000 (and Windows XP).</span></span> <span data-ttu-id="25072-222">As versões mais recentes desses arquivos de instalação, juntamente com os 19 idiomas adicionais, foram adicionados em março de 2000, não contêm essa verificação e serão instaladas com êxito no Windows 2000 (e no Windows XP).</span><span class="sxs-lookup"><span data-stu-id="25072-222">The newer versions of these installation files, along with the additional 19 languages added in March 2000, do not contain this check and will install successfully on Windows 2000 (and Windows XP).</span></span>

### <a name="my-customized-character-exhibits-some-unexpected-behavior-with-its-transparency-color-on-windows-2000-and-windows-xp"></a><span data-ttu-id="25072-223">Meu caractere personalizado exibe algum comportamento inesperado com sua cor de transparência no Windows 2000 (e no Windows XP).</span><span class="sxs-lookup"><span data-stu-id="25072-223">My customized character exhibits some unexpected behavior with its transparency color on Windows 2000 (and Windows XP).</span></span>

<span data-ttu-id="25072-224">Esse é um problema conhecido para caracteres criados com uma paleta com menos de 256 cores.</span><span class="sxs-lookup"><span data-stu-id="25072-224">This is a known issue for characters created with a palette of less than 256 colors.</span></span> <span data-ttu-id="25072-225">Problemas com esses caracteres incluem a cor de transparência mostrada em segundo plano, texto de balão transparente, borda de balão transparente ou plano de fundo de balão transparente.</span><span class="sxs-lookup"><span data-stu-id="25072-225">Issues with these characters include the transparency color showing in the background, transparent balloon text, transparent balloon border, or transparent balloon background.</span></span> <span data-ttu-id="25072-226">Observe que esses caracteres podem fazer com que seus aplicativos falhem quando carregados na caixa de diálogo Seletor de caracteres do agente ou na galeria do assistente de Microsoft Office.</span><span class="sxs-lookup"><span data-stu-id="25072-226">Note that such characters may cause your applications to crash when loaded in the Agent character picker dialog or the Microsoft Office Assistant gallery.</span></span> <span data-ttu-id="25072-227">Seus caracteres personalizados devem usar uma paleta completa com 256 cores.</span><span class="sxs-lookup"><span data-stu-id="25072-227">Your customized characters must use a full palette with 256 colors.</span></span> <span data-ttu-id="25072-228">Você pode usar a paleta de exemplo fornecida para caracteres do assistente do Office como um ponto de partida com uma paleta de cores 256 completa.</span><span class="sxs-lookup"><span data-stu-id="25072-228">You can use the sample palette provided for Office Assistant characters as a starting point with a full 256 color palette.</span></span>

### <a name="the-character-does-not-use-the-british-english-tts-engine-even-though-i-have-set-its-language-id-to-british-english-h0809"></a><span data-ttu-id="25072-229">O caractere não usa o mecanismo de TTS em inglês britânico, embora tenha definido sua ID de idioma como inglês britânico &h0809.</span><span class="sxs-lookup"><span data-stu-id="25072-229">The character does not use the British English TTS engine even though I have set its language ID to British English &h0809.</span></span>

<span data-ttu-id="25072-230">Primeiro, verifique se você tem todos os componentes necessários instalados — componentes principais do agente, os binários de tempo de execução SAPI e um mecanismo de TTS em inglês britânico SAPI4 compatível, como o mecanismo TTS3000 britânico em inglês, disponível para download na página de downloads do agente.</span><span class="sxs-lookup"><span data-stu-id="25072-230">First make sure you have all the necessary components installed—Agent core components, the SAPI runtime binaries, and a SAPI4 compliant British English TTS engine like the TTS3000 British English engine, available for download on the Agent Downloads page.</span></span> <span data-ttu-id="25072-231">Se o seu caractere ainda não estiver usando o mecanismo de TTS em inglês britânico, é provável que você também tenha um mecanismo de TTS inglês americano instalado.</span><span class="sxs-lookup"><span data-stu-id="25072-231">If your character is still not using the British English TTS engine, it's likely you also have an American English TTS engine installed.</span></span> <span data-ttu-id="25072-232">Como o inglês britânico e o inglês americano compartilham o mesmo idioma principal (inglês) e inglês americano é o padrão, o Agent escolherá o primeiro mecanismo de TTS do inglês americano disponível, conforme retornado pelo SAPI.</span><span class="sxs-lookup"><span data-stu-id="25072-232">Since both British and American English share the same primary language (English) and American English is the default, Agent will pick the first available American English TTS engine as returned by SAPI.</span></span> <span data-ttu-id="25072-233">Para usar um mecanismo de TTS em inglês britânico, use a propriedade TTSModeID do caractere em vez disso.</span><span class="sxs-lookup"><span data-stu-id="25072-233">To use a British English TTS engine, use the character's TTSModeID property instead.</span></span> <span data-ttu-id="25072-234">Por exemplo, o TTSModeID para a voz masculina de inglês britânico TTS3000 é {227A0E41-A92A-11d1-B17B-0020AFED142E}.</span><span class="sxs-lookup"><span data-stu-id="25072-234">For example, the TTSModeID for the TTS3000 British English male voice is {227A0E41-A92A-11d1-B17B-0020AFED142E}.</span></span> <span data-ttu-id="25072-235">No Microsoft Visual Basic você pode usar esse mecanismo definindo o TTSModeID da Merlin da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="25072-235">In Microsoft Visual Basic you can use this engine by setting Merlin's TTSModeID as follows:</span></span>

<span data-ttu-id="25072-236">AgentControl. Characters ("Merlin"). TTSModeID = {227A0E41-A92A-11d1-B17B-0020AFED142E}</span><span class="sxs-lookup"><span data-stu-id="25072-236">AgentControl.Characters("Merlin").TTSModeID = {227A0E41-A92A-11d1-B17B-0020AFED142E}</span></span>

### <a name="when-the-characters-volume-is-set-to-zero-using-the-speech-tag-vol0-it-either-has-no-effects-or-crashes-the-agentsvr"></a><span data-ttu-id="25072-237">Quando o volume do caractere é definido como zero usando a marca de fala \\ vol = 0 \\ , ele não tem nenhum efeito ou cai Agentsvr.</span><span class="sxs-lookup"><span data-stu-id="25072-237">When the character's volume is set to zero using the speech tag \\Vol=0\\, it either has no effects or crashes the AgentSvr.</span></span>

<span data-ttu-id="25072-238">Esse é um problema conhecido.</span><span class="sxs-lookup"><span data-stu-id="25072-238">This is a known problem.</span></span> <span data-ttu-id="25072-239">Nos sistemas operacionais Windows 95, Windows 98 e Windows me, o volume do caractere não é alterado, mas permanecerá no nível definido anteriormente.</span><span class="sxs-lookup"><span data-stu-id="25072-239">On Windows 95, Windows 98, and Windows Me operating systems, the character's volume does not change but will remain at the previously set level.</span></span> <span data-ttu-id="25072-240">Nas plataformas Windows NT 4,0, Windows 2000 e Windows XP, isso fará com que o AgentSvr falhe, mesmo quando um mecanismo de TTS não estiver instalado.</span><span class="sxs-lookup"><span data-stu-id="25072-240">On Windows NT 4.0, Windows 2000 and Windows XP platforms, this will cause AgentSvr to crash, even when a TTS engine is not installed.</span></span> <span data-ttu-id="25072-241">Como o intervalo do volume do caractere, de 0 (silêncio) a 65535 (volume máximo), é grande e a diferença entre níveis sucessivos não é mais discernida, a solução fácil é definir o volume como 1 em vez de 0 quando você deseja que a voz do caractere seja inaudível.</span><span class="sxs-lookup"><span data-stu-id="25072-241">Since the range of the character's volume, from 0 (silence) to 65535 (maximum volume), is large and the difference between successive levels is hardly discernable, the easy workaround is to set the volume to 1 instead of 0 when you want the character's voice to be inaudible.</span></span>

### <a name="my-customized-characters-return-animation-does-not-play-correctly-after-the-movedown-moveleft-moveright-andor-moveup-animations"></a><span data-ttu-id="25072-242">A animação de retorno do meu caractere personalizado não é reproduzida corretamente após as animações MoveDown, MoveLeft, MoveRight e/ou MoveUp.</span><span class="sxs-lookup"><span data-stu-id="25072-242">My customized character's Return animation does not play correctly after the MoveDown, MoveLeft, MoveRight and/or MoveUp animations.</span></span>

<span data-ttu-id="25072-243">Certifique-se de que uma animação de fala simples seja atribuída ao estado de fala.</span><span class="sxs-lookup"><span data-stu-id="25072-243">Make sure a simple speaking animation is assigned to the Speaking State.</span></span> <span data-ttu-id="25072-244">Por exemplo, você pode usar um único quadro que consiste na posição neutra do caractere com sobreposições de boca.</span><span class="sxs-lookup"><span data-stu-id="25072-244">For example, you can use a single frame consisting of the character's neutral position with mouth overlays.</span></span>

 

 




