---
title: Alterações no Microsoft Agent no Windows Vista
description: Alterações no Microsoft Agent no Windows Vista
ms.assetid: 2498e8d5-2274-477c-a807-77443c76afb7
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f73af45553f876c413fbea906de2369e888f1483
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/16/2019
ms.locfileid: "104159943"
---
# <a name="microsoft-agent-changes-in-windows-vista"></a><span data-ttu-id="884a0-103">Alterações no Microsoft Agent no Windows Vista</span><span class="sxs-lookup"><span data-stu-id="884a0-103">Microsoft Agent Changes in Windows Vista</span></span>

<span data-ttu-id="884a0-104">\[O Microsoft Agent foi preterido a partir do Windows 7 e pode não estar disponível nas versões subsequentes do Windows.\]</span><span class="sxs-lookup"><span data-stu-id="884a0-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="884a0-105">O Windows Vista apresenta algumas alterações na forma como o reconhecimento de fala e fala interage com o Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="884a0-105">Windows Vista introduces some changes in how speech and speech recognition interact with Windows Vista.</span></span>

<span data-ttu-id="884a0-106">O Microsoft Agent agora dá suporte a componentes de reconhecimento de fala e de texto para fala do SAPI 5.</span><span class="sxs-lookup"><span data-stu-id="884a0-106">Microsoft Agent now supports SAPI 5 Text-to-Speech and Speech Recognition components.</span></span> <span data-ttu-id="884a0-107">As propriedades TTSModeID e SRModeID do objeto Agent ainda são usadas para determinar qual voz ou reconhecedor está selecionado para o agente e para alterar essa seleção.</span><span class="sxs-lookup"><span data-stu-id="884a0-107">The TTSModeID and SRModeID properties of the Agent object are still used to determine which voice or recognizer is selected for the agent and to alter this selection.</span></span> <span data-ttu-id="884a0-108">Os modos SAPI 4 aparecem como cadeias de caracteres GUID, como "{ca141fd0-ac7f-11D1-97a3-006008273000}", enquanto os tokens SAPI 5 (equivalentes aos modos) aparecem como nomes regulares, como "Microsoft Anna".</span><span class="sxs-lookup"><span data-stu-id="884a0-108">SAPI 4 modes appear as GUID strings such as "{ca141fd0-ac7f-11d1-97a3-006008273000}", while SAPI 5 tokens (equivalent to modes) appear as regular names, such as "Microsoft Anna".</span></span> <span data-ttu-id="884a0-109">Como em versões anteriores, o agente fará uma escolha padrão dos mecanismos TTS e SR.</span><span class="sxs-lookup"><span data-stu-id="884a0-109">As in earlier releases, the agent will make a default choice of TTS and SR engines.</span></span> <span data-ttu-id="884a0-110">Se os mecanismos SAPI 5 estiverem instalados, eles serão sempre preferidos em todos os mecanismos SAPI 4 que podem ser instalados.</span><span class="sxs-lookup"><span data-stu-id="884a0-110">If SAPI 5 engines are installed then these will always be preferred over any SAPI 4 engines that may be installed.</span></span> <span data-ttu-id="884a0-111">O mecanismo de conversão de texto em fala padrão do usuário, conforme especificado no painel de controle, será usado se seu gênero corresponder ao do caractere; caso contrário, um mecanismo SAPI 5 do mesmo gênero será escolhido se um estiver disponível.</span><span class="sxs-lookup"><span data-stu-id="884a0-111">The user's default Text-to-Speech engine, as specified in the control panel, is used if its gender matches that of the character, otherwise a SAPI 5 engine of the same gender is chosen if one is available.</span></span> <span data-ttu-id="884a0-112">As IDs de modo especificadas diretamente no caractere serão ignoradas se os mecanismos SAPI 5 estiverem presentes.</span><span class="sxs-lookup"><span data-stu-id="884a0-112">Mode ids specified directly on the character are ignored if SAPI 5 engines are present.</span></span> <span data-ttu-id="884a0-113">As seleções padrão podem ser verificadas lendo as propriedades TTSModeID e SRModeID no início do script.</span><span class="sxs-lookup"><span data-stu-id="884a0-113">The default selections can be verified by reading the TTSModeID and SRModeID properties at the beginning of your script.</span></span>

<span data-ttu-id="884a0-114">Como antes, TTSModeID e SRModeID retornará uma cadeia de caracteres em branco se o recurso de reconhecimento de fala ou de texto para fala não estiver presente.</span><span class="sxs-lookup"><span data-stu-id="884a0-114">As before, TTSModeID and SRModeID will return a blank string if the Text-to-Speech or Speech Recognition capability is not present.</span></span> <span data-ttu-id="884a0-115">Um reconhecedor ou voz específico pode ser selecionado definindo essas propriedades para a cadeia de caracteres do modo SAPI 4 ou o nome do token SAPI 5 apropriado.</span><span class="sxs-lookup"><span data-stu-id="884a0-115">A specific voice or recognizer can be selected by setting these properties to the appropriate SAPI 4 mode string or SAPI 5 token name.</span></span> <span data-ttu-id="884a0-116">Depois de definir um modo ou token específico, você também pode ler a propriedade novamente para verificar se seu valor foi obtido, o que indica que o novo modo ou token estava realmente disponível e foi selecionado com êxito.</span><span class="sxs-lookup"><span data-stu-id="884a0-116">After setting a specific mode or token, you can also read the property back again to verify that its value has taken, which indicates that the new mode or token was indeed available, and was successfully selected.</span></span> <span data-ttu-id="884a0-117">Para os desenvolvedores que implantam o agente pela Web, observe que muitos usuários do vista terão uma ou mais vozes SAPI 5 instaladas, portanto, convém evitar o download automático de vozes SAPI 4, a menos que o script solicite-as especificamente, pois a voz baixada não acabaria sendo usada.</span><span class="sxs-lookup"><span data-stu-id="884a0-117">For developers deploying Agent over the web, please note that many Vista users will have one or more SAPI 5 voices installed already, so you may want to avoid auto-downloading SAPI 4 voices unless your script specifically requests them, as the downloaded voice would not end up being used.</span></span>

<span data-ttu-id="884a0-118">Os mecanismos de conversão de texto em fala do SAPI 5 usam um conjunto diferente de padrões do que o SAPI 4 para anotar a fala com marcação, por exemplo, para alterar a densidade ou a taxa da fala.</span><span class="sxs-lookup"><span data-stu-id="884a0-118">SAPI 5 Text-to-Speech engines use a different set of standards than SAPI 4 for annotating speech with markup, for example to change the pitch or rate of the speech.</span></span> <span data-ttu-id="884a0-119">No SAPI 4, você usa comandos de "barra", como/Pit = 170/.</span><span class="sxs-lookup"><span data-stu-id="884a0-119">In SAPI 4 you use "slash" commands, such as /pit=170/.</span></span> <span data-ttu-id="884a0-120">No SAPI 5, você usa marcas XML, como <PITCH MIDDLE="5"/> .</span><span class="sxs-lookup"><span data-stu-id="884a0-120">In SAPI 5 you use XML tags, such as <PITCH MIDDLE="5"/>.</span></span> <span data-ttu-id="884a0-121">No Vista, o Agent aceitará os dois tipos de anotações nos comandos "barra" de cadeias de caracteres do método de fala serão ignorados por mecanismos do SAPI 5 e as marcas XML serão ignoradas pelos mecanismos do SAPI 4.</span><span class="sxs-lookup"><span data-stu-id="884a0-121">In Vista, Agent will accept both types of annotations in Speak method strings "slash" commands will be ignored by SAPI 5 engines, and XML tags will be ignored by SAPI 4 engines.</span></span> <span data-ttu-id="884a0-122">Como com as marcas de barra, o suporte para marcas XML SAPI 5 varia de fornecedor para fornecedor e alguns fornecedores podem dar suporte a marcas adicionais.</span><span class="sxs-lookup"><span data-stu-id="884a0-122">As with slash tags, support for SAPI 5 XML tags varies from vendor to vendor, and some vendors may support additional tags.</span></span> <span data-ttu-id="884a0-123">Para obter mais informações sobre marcas XML SAPI 5, consulte a especificação SAPI 5.</span><span class="sxs-lookup"><span data-stu-id="884a0-123">For more information on SAPI 5 XML tags, please see the SAPI 5 Specification.</span></span>

<span data-ttu-id="884a0-124">O Agent não inclui mais suporte para vários idiomas.</span><span class="sxs-lookup"><span data-stu-id="884a0-124">Agent no longer includes support for multiple languages.</span></span> <span data-ttu-id="884a0-125">O idioma usado pelo Agent sempre é considerado o idioma atual do usuário, como registrado no sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="884a0-125">The language used by Agent is always assumed to be the user's current language, as registered with the operating system.</span></span> <span data-ttu-id="884a0-126">A propriedade LanguageID do objeto Agent ainda é gravável, mas seu valor é ignorado pelo Agent no vista.</span><span class="sxs-lookup"><span data-stu-id="884a0-126">The LanguageID property of the Agent object is still writable, but its value is ignored by Agent on Vista.</span></span> <span data-ttu-id="884a0-127">Por exemplo, se o idioma do usuário estiver definido como inglês americano (&H0409), e ele usar um programa que defina LanguageID como francês (&H040C), o texto da dica de voz e as caixas de diálogo opções de caractere avançadas ainda aparecerão em inglês.</span><span class="sxs-lookup"><span data-stu-id="884a0-127">For example if the user's language is set to US English (&H0409), and he or she uses a program that sets the LanguageID to French (&H040C), then the voice tip text, and Advanced Character Options dialogs will still appear in English.</span></span>

 

 




