---
title: Criando um manipulador de limpeza de disco
description: Um tempo axioma comprovado e novamente no mundo dos computadores é que, independentemente do tamanho da capacidade de armazenamento do seu computador, você acabará preenchendo.
ms.assetid: f85e0db7-fbdb-452e-90c8-672f716b5692
keywords:
- manipuladores de limpeza de disco
- Limpeza de Disco
- DataDrivenCleaner
- registrar, manipuladores de limpeza de disco
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 30584439ae2c38ae8a9b7106dae96f69eea5df37
ms.sourcegitcommit: ae73f4dd3cf5a3c6a1ea7d191ca32a5b01f6686b
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/08/2020
ms.locfileid: "105781164"
---
# <a name="creating-a-disk-cleanup-handler"></a><span data-ttu-id="bc6a6-107">Criando um manipulador de limpeza de disco</span><span class="sxs-lookup"><span data-stu-id="bc6a6-107">Creating a Disk Cleanup Handler</span></span>

<span data-ttu-id="bc6a6-108">Um tempo axioma comprovado e novamente no mundo dos computadores é que, independentemente do tamanho da capacidade de armazenamento do seu computador, você acabará preenchendo.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-108">One axiom proven time and again in the world of computers is that regardless of the size of your computer's storage capacity, you will eventually fill it up.</span></span> <span data-ttu-id="bc6a6-109">Embora o tamanho médio do disco rígido de um computador tenha aumentado drasticamente ao longo do tempo, os aplicativos também cresceram de acordo, deixando os usuários buscando formas de criar mais espaço livre no disco rígido.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-109">While the average size of a computer's hard disk has increased dramatically over time, applications have also grown accordingly, leaving users looking for ways to create more free hard disk space.</span></span> <span data-ttu-id="bc6a6-110">O espaço disponível também é reduzido pelos vários arquivos temporários que os aplicativos criam para fins de backup ou desempenho.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-110">Available space is also reduced by the many temporary files that applications create for backup or performance reasons.</span></span> <span data-ttu-id="bc6a6-111">Quando o espaço em disco fica baixo, ele se torna necessário para reduzir a quantidade de espaço usado pelos aplicativos.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-111">When disk space becomes low, it becomes necessary to reduce the amount of space used by applications.</span></span> <span data-ttu-id="bc6a6-112">O espaço em disco pode ser liberado usando uma variedade de meios, incluindo o seguinte:</span><span class="sxs-lookup"><span data-stu-id="bc6a6-112">Disk space can be freed using a variety of means, including the following:</span></span>

-   <span data-ttu-id="bc6a6-113">Excluindo arquivos.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-113">Deleting files.</span></span>
-   <span data-ttu-id="bc6a6-114">Compactando arquivos.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-114">Compressing files.</span></span>
-   <span data-ttu-id="bc6a6-115">Movendo arquivos para um meio de backup.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-115">Moving files to a backup medium.</span></span>
-   <span data-ttu-id="bc6a6-116">Transferindo arquivos para um servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-116">Transferring files to a remote server.</span></span>

<span data-ttu-id="bc6a6-117">Os arquivos que são bons candidatos à limpeza incluem:</span><span class="sxs-lookup"><span data-stu-id="bc6a6-117">Files that are good candidates for cleanup include:</span></span>

-   <span data-ttu-id="bc6a6-118">Arquivos que o usuário nunca precisará novamente.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-118">Files that the user will never need again.</span></span>
-   <span data-ttu-id="bc6a6-119">Arquivos temporários que existem apenas por motivos de desempenho.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-119">Temporary files that exist only for performance reasons.</span></span>
-   <span data-ttu-id="bc6a6-120">Arquivos que podem ser restaurados, se necessário, de um CD de instalação.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-120">Files that can be restored, if needed, from an installation CD.</span></span>
-   <span data-ttu-id="bc6a6-121">Arquivos de dados que possivelmente foram substituídos por versões mais recentes, como arquivos de backup antigos.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-121">Data files that have possibly been superseded by newer versions, such as old backup files.</span></span>
-   <span data-ttu-id="bc6a6-122">Arquivos mais antigos que não foram usados em muito tempo.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-122">Older files that have not been used in a long time.</span></span>

<span data-ttu-id="bc6a6-123">A exclusão é particularmente apropriada para os arquivos que o usuário nunca precisará novamente, por exemplo, arquivos que são armazenados temporariamente em cache por motivos de desempenho.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-123">Deletion is particularly appropriate for files that the user will never need again for example, files that are temporarily cached for performance reasons.</span></span> <span data-ttu-id="bc6a6-124">A exclusão também é apropriada para arquivos que são facilmente restaurados, como arquivos gráficos que podem ser recarregados a partir de um CD de instalação.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-124">Deletion is also appropriate for files that are easily restored, such as graphics files that can be reloaded from an installation CD.</span></span> <span data-ttu-id="bc6a6-125">Os arquivos que o usuário pode precisar mais tarde ou que seriam difíceis de reconstruir são candidatos melhores para compactação ou backup.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-125">Files that the user might need later or that would be difficult to reconstruct are better candidates for compression or backup.</span></span>

<span data-ttu-id="bc6a6-126">Esperar que um usuário limpe manualmente o sistema de arquivos não é uma boa solução.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-126">Expecting a user to manually clean the file system is not a good solution.</span></span> <span data-ttu-id="bc6a6-127">O usuário pode não saber onde muitos arquivos estão localizados ou como reconhecer quais deles podem ser removidos com segurança.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-127">The user may not know where many of the files are located or how to recognize which ones can be safely removed.</span></span> <span data-ttu-id="bc6a6-128">Além disso, há o risco de que o usuário possa excluir arquivos essenciais.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-128">In addition, there's the risk that the user might delete essential files.</span></span>

<span data-ttu-id="bc6a6-129">As facetas a seguir do utilitário limpeza de disco são discutidas neste tópico.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-129">The following facets of the Disk Cleanup utility are discussed in this topic.</span></span>

-   [<span data-ttu-id="bc6a6-130">O utilitário de limpeza de disco do Windows</span><span class="sxs-lookup"><span data-stu-id="bc6a6-130">The Windows Disk Cleanup Utility</span></span>](#the-windows-disk-cleanup-utility)
-   [<span data-ttu-id="bc6a6-131">Noções básicas de implementação</span><span class="sxs-lookup"><span data-stu-id="bc6a6-131">Implementation Basics</span></span>](#implementation-basics)
    -   [<span data-ttu-id="bc6a6-132">Inicializar/InitializeEx</span><span class="sxs-lookup"><span data-stu-id="bc6a6-132">Initialize/InitializeEx</span></span>](#initializeinitializeex)
    -   [<span data-ttu-id="bc6a6-133">GetSpaceUsed</span><span class="sxs-lookup"><span data-stu-id="bc6a6-133">GetSpaceUsed</span></span>](#getspaceused)
    -   [<span data-ttu-id="bc6a6-134">Mostrarproperties</span><span class="sxs-lookup"><span data-stu-id="bc6a6-134">ShowProperties</span></span>](#showproperties)
    -   [<span data-ttu-id="bc6a6-135">Limpar</span><span class="sxs-lookup"><span data-stu-id="bc6a6-135">Purge</span></span>](#purge)
    -   [<span data-ttu-id="bc6a6-136">Desativar</span><span class="sxs-lookup"><span data-stu-id="bc6a6-136">Deactivate</span></span>](#deactivate)
-   [<span data-ttu-id="bc6a6-137">Registrando um manipulador de limpeza de disco</span><span class="sxs-lookup"><span data-stu-id="bc6a6-137">Registering a Disk Cleanup Handler</span></span>](#registering-a-disk-cleanup-handler)
    -   [<span data-ttu-id="bc6a6-138">Registrando o CLSID de um manipulador</span><span class="sxs-lookup"><span data-stu-id="bc6a6-138">Registering a Handler's CLSID</span></span>](#registering-a-handlers-clsid)
    -   [<span data-ttu-id="bc6a6-139">Registrando um manipulador com o Gerenciador de limpeza de disco: geral</span><span class="sxs-lookup"><span data-stu-id="bc6a6-139">Registering a Handler with the Disk Cleanup Manager: General</span></span>](#registering-a-handler-with-the-disk-cleanup-manager-general)
    -   [<span data-ttu-id="bc6a6-140">Registrando um manipulador com o Gerenciador de limpeza de disco: Windows 2000 ou sistemas posteriores</span><span class="sxs-lookup"><span data-stu-id="bc6a6-140">Registering a Handler with the Disk Cleanup Manager: Windows 2000 or Later Systems</span></span>](#registering-a-handler-with-the-disk-cleanup-manager-windows-2000-or-later-systems)
    -   [<span data-ttu-id="bc6a6-141">Usando o objeto DataDrivenCleaner</span><span class="sxs-lookup"><span data-stu-id="bc6a6-141">Using the DataDrivenCleaner Object</span></span>](#using-the-datadrivencleaner-object)
    -   [<span data-ttu-id="bc6a6-142">Exemplo de registro de um manipulador de limpeza de disco</span><span class="sxs-lookup"><span data-stu-id="bc6a6-142">Example Registration of a Disk Cleanup Handler</span></span>](#example-registration-of-a-disk-cleanup-handler)

## <a name="the-windows-disk-cleanup-utility"></a><span data-ttu-id="bc6a6-143">O utilitário de limpeza de disco do Windows</span><span class="sxs-lookup"><span data-stu-id="bc6a6-143">The Windows Disk Cleanup Utility</span></span>

<span data-ttu-id="bc6a6-144">A partir do Windows 98, o sistema operacional Windows inclui a limpeza de disco, um utilitário que torna muito mais fácil para o usuário gerenciar o espaço disponível no disco rígido.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-144">Starting on Windows 98, the Windows operating system includes Disk Cleanup, a utility that makes it much easier for the user to manage available hard disk space.</span></span> <span data-ttu-id="bc6a6-145">O utilitário limpeza de disco foi projetado para liberar o máximo possível de espaço em disco e diminuir o risco de que o usuário exclua arquivos essenciais acidentalmente.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-145">The Disk Cleanup utility is designed to free up as much disk space as possible and decrease the risk that the user will delete essential files accidentally.</span></span>

<span data-ttu-id="bc6a6-146">A limpeza de disco pode ser iniciada de três maneiras.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-146">Disk cleanup can be initiated in three ways.</span></span>

-   <span data-ttu-id="bc6a6-147">O usuário pode iniciar a limpeza de disco clicando em **Iniciar**; apontando para **todos os programas**, **acessórios** e **Ferramentas do sistema**; e, em seguida, clicando em **limpeza de disco**.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-147">The user can initiate disk cleanup by clicking **Start**; pointing to **All Programs**, **Accessories**, and **System Tools**; and then clicking **Disk Cleanup**.</span></span>
-   <span data-ttu-id="bc6a6-148">O sistema notifica o usuário com uma caixa de mensagem informando que o espaço em disco não utilizado atingiu o modo crítico.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-148">The system notifies the user with a message box that unused disk space has reached critical mode.</span></span> <span data-ttu-id="bc6a6-149">O limite de modo crítico para uma unidade maior que 2,25 gigabytes (GB) é 200 megabytes (MB).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-149">The critical mode threshold for a drive larger than 2.25 gigabytes (GB) is 200 megabytes (MB).</span></span> <span data-ttu-id="bc6a6-150">Os avisos subsequentes são fornecidos em 80, 50 e 1 MB.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-150">Subsequent warnings are given at 80, 50, and 1 MB.</span></span> <span data-ttu-id="bc6a6-151">O usuário recebe a opção de liberar espaço em disco manualmente ou iniciar o utilitário de limpeza de disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-151">The user is given the option of freeing disk space manually or starting the Disk Cleanup utility.</span></span>
-   <span data-ttu-id="bc6a6-152">O usuário pode ter o assistente de tarefa agendada do Windows (conhecido como o assistente de manutenção em sistemas mais antigos) executar o utilitário limpeza de disco automaticamente em horários agendados.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-152">The user can have the Windows Scheduled Task Wizard (known as the Maintenance Wizard on older systems) run the Disk Cleanup utility automatically at scheduled times.</span></span>

<span data-ttu-id="bc6a6-153">O desafio básico inerente à limpeza de disco é liberar o máximo possível de espaço em disco sem excluir arquivos essenciais.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-153">The basic challenge inherent in disk cleanup is to free as much disk space as possible without deleting essential files.</span></span> <span data-ttu-id="bc6a6-154">Como não há uma maneira padrão de marcar arquivos para limpeza, nenhum aplicativo pode detectar e limpar de forma confiável todos os arquivos não essenciais.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-154">Because there is no standard way to mark files for cleanup, no single application can reliably detect and clean all unessential files.</span></span> <span data-ttu-id="bc6a6-155">O utilitário limpeza de disco resolve esse problema, dividindo a operação de limpeza entre um único *Gerenciador de limpeza de disco* e uma coleção de *manipuladores de limpeza de disco*.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-155">The Disk Cleanup utility addresses this problem by splitting the cleanup operation between a single *disk cleanup manager* and a collection of *disk cleanup handlers*.</span></span>

<span data-ttu-id="bc6a6-156">Quando o utilitário limpeza de disco é executado, o usuário vê a caixa de diálogo a seguir.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-156">When the Disk Cleanup utility is run, the user sees the following dialog box.</span></span> <span data-ttu-id="bc6a6-157">(Se houver mais de um disco ou partição de disco no computador, primeiro será solicitado que o usuário escolha uma unidade antes que essa caixa de diálogo seja exibida.)</span><span class="sxs-lookup"><span data-stu-id="bc6a6-157">(If more than one disk or disk partition exists on the computer, the user is first asked to choose a drive before this dialog is displayed.)</span></span>

![captura de tela da caixa de diálogo limpar](images/cleanup1.png)

<span data-ttu-id="bc6a6-159">O Gerenciador de limpeza de disco faz parte do sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-159">The disk cleanup manager is part of the operating system.</span></span> <span data-ttu-id="bc6a6-160">Ele exibe a caixa de diálogo mostrada na ilustração anterior, manipula a entrada do usuário e gerencia a operação de limpeza.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-160">It displays the dialog box shown in the preceding illustration, handles user input, and manages the cleanup operation.</span></span> <span data-ttu-id="bc6a6-161">A seleção e a limpeza reais de arquivos desnecessários é feita pelos manipuladores de limpeza de disco individuais mostrados na caixa de listagem do Gerenciador de limpeza de disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-161">The actual selection and cleanup of unneeded files is done by the individual disk cleanup handlers shown in the disk cleanup manager's list box.</span></span> <span data-ttu-id="bc6a6-162">O usuário tem a opção de habilitar ou desabilitar manipuladores individuais marcando ou desmarcando sua caixa de seleção na interface do usuário do Gerenciador de limpeza de disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-162">The user has the option of enabling or disabling individual handlers by selecting or clearing their check box in the disk cleanup manager's UI.</span></span>

<span data-ttu-id="bc6a6-163">Cada manipulador é responsável por um conjunto bem definido de arquivos.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-163">Each handler is responsible for a well defined set of files.</span></span> <span data-ttu-id="bc6a6-164">Por exemplo, o manipulador selecionado na ilustração é responsável por limpar os arquivos de programa baixados.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-164">For example, the selected handler in the illustration is responsible for cleaning up downloaded program files.</span></span> <span data-ttu-id="bc6a6-165">O manipulador selecionado na ilustração também fornece um botão **Exibir arquivos** .</span><span class="sxs-lookup"><span data-stu-id="bc6a6-165">The handler selected in the illustration also provides a **View Files** button.</span></span> <span data-ttu-id="bc6a6-166">Ao clicar no botão, o usuário pode solicitar que o manipulador exiba uma interface do usuário normalmente uma janela do Windows Explorer que permite ao usuário especificar quais arquivos ou classes de arquivos limpar.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-166">By clicking the button, the user can request that the handler display a UI typically a Windows Explorer window that allows the user to specify which files or classes of files to clean.</span></span>

<span data-ttu-id="bc6a6-167">Embora o Windows venha com vários manipuladores de limpeza de disco, eles não são projetados para lidar com arquivos produzidos por outros aplicativos.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-167">Although Windows comes with a number of disk cleanup handlers, they aren't designed to handle files produced by other applications.</span></span> <span data-ttu-id="bc6a6-168">Em vez disso, o Gerenciador de limpeza de disco é projetado para ser flexível e extensível, permitindo que qualquer desenvolvedor implemente e Registre seu próprio manipulador de limpeza de disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-168">Instead, the disk cleanup manager is designed to be flexible and extensible by enabling any developer to implement and register their own disk cleanup handler.</span></span> <span data-ttu-id="bc6a6-169">Qualquer desenvolvedor pode estender os serviços de limpeza de disco disponíveis implementando e registrando um manipulador de limpeza de disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-169">Any developer can extend the available disk cleanup services by implementing and registering a disk cleanup handler.</span></span>

<span data-ttu-id="bc6a6-170">Todos os aplicativos que produzem arquivos temporários podem e devem implementar e registrar um manipulador de limpeza de disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-170">All applications that produce temporary files can and should implement and register a disk cleanup handler.</span></span> <span data-ttu-id="bc6a6-171">Isso fornece aos usuários uma maneira conveniente e confiável de gerenciar os arquivos temporários do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-171">Doing so gives users a convenient and reliable way to manage the application's temporary files.</span></span> <span data-ttu-id="bc6a6-172">Ao implementar o manipulador, você pode decidir quais arquivos são afetados e determinar como ocorre a limpeza real.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-172">When you implement the handler, you can decide which files are affected and determine how the actual cleanup happens.</span></span>

## <a name="implementation-basics"></a><span data-ttu-id="bc6a6-173">Noções básicas de implementação</span><span class="sxs-lookup"><span data-stu-id="bc6a6-173">Implementation Basics</span></span>

<span data-ttu-id="bc6a6-174">Os manipuladores de limpeza são objetos COM (Component Object Model de servidor) em processo.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-174">Cleanup handlers are in-process server Component Object Model (COM) objects.</span></span> <span data-ttu-id="bc6a6-175">O Windows fornece um objeto de manipulador existente chamado DataDrivenCleaner para seu uso.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-175">Windows provides an existing handler object called the DataDrivenCleaner for your use.</span></span> <span data-ttu-id="bc6a6-176">Você também pode optar por implementar um manipulador por conta própria para obter mais flexibilidade.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-176">You can also opt to implement a handler yourself for more flexibility.</span></span> <span data-ttu-id="bc6a6-177">Esses objetos permitem que você especifique como selecionar arquivos, liberar espaço em disco e, no caso de um manipulador implementado, exibir a interface do usuário opcional para um controle mais granular.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-177">These objects then allow you to specify how to select files, free disk space, and, in the case of an implemented handler, display the optional UI for more granular control.</span></span> <span data-ttu-id="bc6a6-178">Esta seção aborda a questão de implementar seu próprio manipulador.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-178">This section addresses the matter of implementing your own handler.</span></span> <span data-ttu-id="bc6a6-179">Para obter detalhes sobre o uso do objeto DataDrivenCleaner, consulte [usando o objeto DataDrivenCleaner](#using-the-datadrivencleaner-object).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-179">For details concerning the use of the DataDrivenCleaner object, see [Using the DataDrivenCleaner Object](#using-the-datadrivencleaner-object).</span></span>

<span data-ttu-id="bc6a6-180">Um manipulador de limpeza de disco deve executar essas cinco tarefas básicas.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-180">A disk cleanup handler should perform these five basic tasks.</span></span>

-   <span data-ttu-id="bc6a6-181">Inicialize o objeto do manipulador.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-181">Initialize the handler object.</span></span>
-   <span data-ttu-id="bc6a6-182">Verifique o disco para determinar a quantidade de espaço em disco que pode ser liberada.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-182">Scan the disk to determine how much disk space can be freed.</span></span>
-   <span data-ttu-id="bc6a6-183">Exiba a interface do usuário para obter comentários de usuários sobre quais arquivos limpar.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-183">Display the UI to obtain user feedback about which files to clean.</span></span> <span data-ttu-id="bc6a6-184">(Opcional)</span><span class="sxs-lookup"><span data-stu-id="bc6a6-184">(Optional)</span></span>
-   <span data-ttu-id="bc6a6-185">Faça a limpeza.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-185">Do the cleanup.</span></span>
-   <span data-ttu-id="bc6a6-186">Desligar.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-186">Shut down.</span></span>

<span data-ttu-id="bc6a6-187">Para permitir que o Gerenciador de limpeza de disco gerencie essas tarefas, um manipulador deve exportar o [**IEmptyVolumeCache**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache) para Windows 98 ou [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) para Windows Millennium Edition (Windows Me), Windows 2000 e Windows XP.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-187">To allow the disk cleanup manager to manage these tasks, a handler must export either [**IEmptyVolumeCache**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache) for Windows 98 or [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) for Windows Millennium Edition (Windows Me), Windows 2000, and Windows XP.</span></span> <span data-ttu-id="bc6a6-188">Como **IEmptyVolumeCache2** é herdado de **IEmptyVolumeCache**, adicionar apenas o método adicional **InitializeEx**, relativamente pouco trabalho extra é necessário para implementar ambos.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-188">Because **IEmptyVolumeCache2** inherits from **IEmptyVolumeCache**, adding only the additional method **InitializeEx**, relatively little extra work is required to implement both.</span></span> <span data-ttu-id="bc6a6-189">A menos que seu manipulador seja destinado a apenas um desses sistemas operacionais, ele deve exportar ambas as interfaces.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-189">Unless your handler is intended for only one of these operating systems, it should export both interfaces.</span></span>

<span data-ttu-id="bc6a6-190">Para exportar essas interfaces, você deve implementar esses métodos correspondentes às cinco tarefas básicas.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-190">To export these interfaces, you must implement these methods corresponding to the five basic tasks.</span></span>

-   [<span data-ttu-id="bc6a6-191">Inicializar/InitializeEx</span><span class="sxs-lookup"><span data-stu-id="bc6a6-191">Initialize/InitializeEx</span></span>](#initializeinitializeex)
-   [<span data-ttu-id="bc6a6-192">GetSpaceUsed</span><span class="sxs-lookup"><span data-stu-id="bc6a6-192">GetSpaceUsed</span></span>](#getspaceused)
-   [<span data-ttu-id="bc6a6-193">Mostrarproperties</span><span class="sxs-lookup"><span data-stu-id="bc6a6-193">ShowProperties</span></span>](#showproperties)
-   [<span data-ttu-id="bc6a6-194">Limpar</span><span class="sxs-lookup"><span data-stu-id="bc6a6-194">Purge</span></span>](#purge)
-   [<span data-ttu-id="bc6a6-195">Desativar</span><span class="sxs-lookup"><span data-stu-id="bc6a6-195">Deactivate</span></span>](#deactivate)

### <a name="initializeinitializeex"></a><span data-ttu-id="bc6a6-196">Inicializar/InitializeEx</span><span class="sxs-lookup"><span data-stu-id="bc6a6-196">Initialize/InitializeEx</span></span>

<span data-ttu-id="bc6a6-197">Os dois métodos de inicialização, que são bastante semelhantes, são chamados quando o utilitário de limpeza de disco é executado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-197">The two initialization methods, which are quite similar, are called when the Disk Cleanup utility is run.</span></span> <span data-ttu-id="bc6a6-198">O Gerenciador de limpeza de disco do Windows 98 chama o método [**IEmptyVolumeCache:: Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) de um manipulador.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-198">The Windows 98 disk cleanup manager calls a handler's [**IEmptyVolumeCache::Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) method.</span></span> <span data-ttu-id="bc6a6-199">O Windows Millennium Edition (Windows me), o Windows 2000 ou o Gerenciador de limpeza de disco do Windows XP, no entanto, primeiro tenta chamar [**IEmptyVolumeCache2:: InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) e só usa **IEmptyVolumeCache:: Initialize** se [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) não é exposto pelo manipulador.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-199">The Windows Millennium Edition (Windows Me), Windows 2000, or Windows XP disk cleanup manager, however, first tries calling [**IEmptyVolumeCache2::InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) and only uses **IEmptyVolumeCache::Initialize** if [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) is not exposed by the handler.</span></span> <span data-ttu-id="bc6a6-200">O Gerenciador de limpeza de disco passa informações para o método, como a chave do registro do manipulador e o volume do disco a ser limpo.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-200">The disk cleanup manager passes information to the method, such as the handler's registry key and the disk volume that is to be cleaned.</span></span>

<span data-ttu-id="bc6a6-201">Qualquer um dos métodos pode retornar várias cadeias de caracteres de exibição e definir um ou mais sinalizadores.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-201">Either method can return various display strings and set one or more flags.</span></span> <span data-ttu-id="bc6a6-202">A principal diferença entre os dois métodos é como o texto exibido no Gerenciador de limpeza de disco é manipulado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-202">The primary difference between the two methods is how the text displayed in the disk cleanup manager is handled.</span></span> <span data-ttu-id="bc6a6-203">As três cadeias de caracteres a seguir são afetadas.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-203">The following three strings are affected.</span></span>



| <span data-ttu-id="bc6a6-204">String</span><span class="sxs-lookup"><span data-stu-id="bc6a6-204">String</span></span>       | <span data-ttu-id="bc6a6-205">Finalidade</span><span class="sxs-lookup"><span data-stu-id="bc6a6-205">Purpose</span></span>                                                                            | <span data-ttu-id="bc6a6-206">Inicializar</span><span class="sxs-lookup"><span data-stu-id="bc6a6-206">Initialize</span></span>                                                                           | <span data-ttu-id="bc6a6-207">InitializeEx</span><span class="sxs-lookup"><span data-stu-id="bc6a6-207">InitializeEx</span></span>                                                                                     |
|--------------|------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|
| <span data-ttu-id="bc6a6-208">Nome de exibição</span><span class="sxs-lookup"><span data-stu-id="bc6a6-208">Display Name</span></span> | <span data-ttu-id="bc6a6-209">O nome do manipulador exibido na caixa de listagem do Gerenciador de limpeza de disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-209">The handler's name displayed in the disk cleanup manager's list box.</span></span>               | <span data-ttu-id="bc6a6-210">Se *ppwszDisplayName* for **NULL**, o valor padrão será recuperado do registro.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-210">If *ppwszDisplayName* is **NULL**, the default value is retrieved from the registry.</span></span> | <span data-ttu-id="bc6a6-211">Uma cadeia de caracteres localizada corretamente deve ser especificada em *ppwszDisplayName* nenhum valor de registro é usado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-211">A properly localized string must be specified in *ppwszDisplayName* no registry values are used.</span></span> |
| <span data-ttu-id="bc6a6-212">Descrição</span><span class="sxs-lookup"><span data-stu-id="bc6a6-212">Description</span></span>  | <span data-ttu-id="bc6a6-213">Texto descritivo exibido abaixo da caixa de listagem quando o nome do manipulador é selecionado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-213">Descriptive text displayed below the list box when the handler's name is selected.</span></span> | <span data-ttu-id="bc6a6-214">Se *ppwszDescription* for **NULL**, o valor padrão será recuperado do registro.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-214">If *ppwszDescription* is **NULL**, the default value is retrieved from the registry.</span></span> | <span data-ttu-id="bc6a6-215">Uma cadeia de caracteres localizada corretamente deve ser especificada em *ppwszDescription* nenhum valor de registro é usado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-215">A properly localized string must be specified in *ppwszDescription* no registry values are used.</span></span> |
| <span data-ttu-id="bc6a6-216">Texto do botão</span><span class="sxs-lookup"><span data-stu-id="bc6a6-216">Button Text</span></span>  | <span data-ttu-id="bc6a6-217">Texto do botão opcional que permite aos usuários exibir a interface do usuário do manipulador.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-217">Text for the optional button that allows users to display the handler's UI.</span></span>        | <span data-ttu-id="bc6a6-218">Nenhum parâmetro disponível.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-218">No parameter available.</span></span> <span data-ttu-id="bc6a6-219">Deve ser especificado no registro.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-219">Must be specified in the registry.</span></span>                           | <span data-ttu-id="bc6a6-220">Uma cadeia de caracteres localizada corretamente deve ser especificada em *ppwszBtnText* nenhum valor de registro é usado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-220">A properly localized string must be specified in *ppwszBtnText* no registry values are used.</span></span>     |



 

<span data-ttu-id="bc6a6-221">O parâmetro *pdwFlags* encontrado em ambos os métodos de inicialização reconhece o mesmo conjunto de sinalizadores.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-221">The *pdwFlags* parameter found in both initialization methods recognizes the same set of flags.</span></span> <span data-ttu-id="bc6a6-222">Dois desses sinalizadores são passados para o método pelo Gerenciador de limpeza de disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-222">Two of these flags are passed to the method by the disk cleanup manager.</span></span>

-   <span data-ttu-id="bc6a6-223">**EVCF \_ settingsmode**</span><span class="sxs-lookup"><span data-stu-id="bc6a6-223">**EVCF\_SETTINGSMODE**</span></span>

    <span data-ttu-id="bc6a6-224">Se o Gerenciador de limpeza de disco estiver sendo executado em um agendamento, ele definirá o sinalizador **EVCF \_ settingsmode** .</span><span class="sxs-lookup"><span data-stu-id="bc6a6-224">If the disk cleanup manager is being run on a schedule, it sets the **EVCF\_SETTINGSMODE** flag.</span></span> <span data-ttu-id="bc6a6-225">Se esse sinalizador estiver definido, o Gerenciador de limpeza de disco não chamará os métodos [GetSpaceUsed](#getspaceused), [Purge](#purge)ou [showProperties](#showproperties) .</span><span class="sxs-lookup"><span data-stu-id="bc6a6-225">If this flag is set, the disk cleanup manager does not call the [GetSpaceUsed](#getspaceused), [Purge](#purge), or [ShowProperties](#showproperties) methods.</span></span> <span data-ttu-id="bc6a6-226">O método [**Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) ou [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) do manipulador deve lidar com todas as tarefas normalmente executadas por [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) e [**Purge**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-purge).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-226">The handler's [**Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) or [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) method must handle all of the tasks normally performed by [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) and [**Purge**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-purge).</span></span> <span data-ttu-id="bc6a6-227">Como não há oportunidade de comentários do usuário, somente os arquivos extremamente seguros para limpeza devem ser tocadas.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-227">Because there is no opportunity for user feedback, only those files that are extremely safe to clean up should be touched.</span></span> <span data-ttu-id="bc6a6-228">Você deve ignorar o parâmetro *pcwszVolume* do método de inicialização e limpar os arquivos desnecessários, independentemente de em qual unidade eles estão.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-228">You should ignore the initialization method's *pcwszVolume* parameter and clean unneeded files regardless of what drive they are on.</span></span>

-   <span data-ttu-id="bc6a6-229">**EVCF \_ OUTOFDISKSPACE**</span><span class="sxs-lookup"><span data-stu-id="bc6a6-229">**EVCF\_OUTOFDISKSPACE**</span></span>

    <span data-ttu-id="bc6a6-230">Se o sinalizador **EVCF \_ OUTOFDISKSPACE** for definido, a unidade de disco do usuário será extremamente pequena de espaço.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-230">If the **EVCF\_OUTOFDISKSPACE** flag is set, the user's disk drive is critically short of space.</span></span> <span data-ttu-id="bc6a6-231">O manipulador deve ser agressivo em relação à exclusão de arquivos, mesmo que ele resulte em uma perda de desempenho.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-231">The handler should be aggressive about deleting files, even if it results in a performance loss.</span></span> <span data-ttu-id="bc6a6-232">No entanto, o manipulador obviamente não deve excluir arquivos que poderiam causar uma falha no aplicativo ou que o usuário perca dados.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-232">However, the handler obviously should not delete files that would cause an application to fail or the user to lose data.</span></span>

<span data-ttu-id="bc6a6-233">Os sinalizadores restantes são definidos pelo manipulador de limpeza de disco e retornados para o Gerenciador de limpeza de disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-233">The remaining flags are set by the disk cleanup handler and returned to the disk cleanup manager.</span></span> <span data-ttu-id="bc6a6-234">Para obter mais informações, consulte as páginas de referência de método para [**IEmptyVolumeCache:: Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) e [**IEmptyVolumeCache2:: InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-234">For more information, see the method reference pages for [**IEmptyVolumeCache::Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) and [**IEmptyVolumeCache2::InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex).</span></span>

-   <span data-ttu-id="bc6a6-235">EVCF \_ DONTSHOWIFZERO</span><span class="sxs-lookup"><span data-stu-id="bc6a6-235">EVCF\_DONTSHOWIFZERO</span></span>

    <span data-ttu-id="bc6a6-236">Exiba o manipulador na caixa de listagem do Gerenciador de limpeza de disco somente se o valor retornado por [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) indicar que o manipulador pode liberar algum espaço em disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-236">Display the handler in the disk cleanup manager's list box only if the value returned by [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) indicates that the handler can free some disk space.</span></span>

-   <span data-ttu-id="bc6a6-237">EVCF \_ ENABLEBYDEFAULT</span><span class="sxs-lookup"><span data-stu-id="bc6a6-237">EVCF\_ENABLEBYDEFAULT</span></span>

    <span data-ttu-id="bc6a6-238">Especifica que o manipulador está habilitado por padrão.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-238">Specifies that the handler is enabled by default.</span></span> <span data-ttu-id="bc6a6-239">Ele será executado toda vez que uma limpeza de disco ocorrer, a menos que o usuário a desative, desmarcando sua caixa de seleção na lista de manipuladores do Gerenciador de limpeza de disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-239">It will run every time a disk cleanup takes place unless the user disables it by clearing its check box in the disk cleanup manager's list of handlers.</span></span>

-   <span data-ttu-id="bc6a6-240">EVCF \_ ENABLEBYDEFAULT \_ auto</span><span class="sxs-lookup"><span data-stu-id="bc6a6-240">EVCF\_ENABLEBYDEFAULT\_AUTO</span></span>

    <span data-ttu-id="bc6a6-241">Especifica que o manipulador é habilitado automaticamente para execução durante as limpezas agendadas.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-241">Specifies that the handler is automatically enabled to run during scheduled cleanups.</span></span>

-   <span data-ttu-id="bc6a6-242">EVCF \_ HASSETTINGS</span><span class="sxs-lookup"><span data-stu-id="bc6a6-242">EVCF\_HASSETTINGS</span></span>

    <span data-ttu-id="bc6a6-243">Defina esse sinalizador se o seu manipulador tiver uma interface do usuário para exibir.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-243">Set this flag if your handler has a UI to display.</span></span> <span data-ttu-id="bc6a6-244">Em resposta, o Gerenciador de limpeza de disco exibe um botão quando esse manipulador é selecionado na caixa de listagem.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-244">In response, the disk cleanup manager displays a button when that handler is selected in the list box.</span></span> <span data-ttu-id="bc6a6-245">Se esse botão for clicado, o Gerenciador de limpeza de disco chamará [**mostrarproperties**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-showproperties).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-245">If that button is clicked, the disk cleanup manager calls [**ShowProperties**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-showproperties).</span></span>

-   <span data-ttu-id="bc6a6-246">EVCF \_ REMOVEFROMLIST</span><span class="sxs-lookup"><span data-stu-id="bc6a6-246">EVCF\_REMOVEFROMLIST</span></span>

    <span data-ttu-id="bc6a6-247">Exclua o nome do manipulador da lista de manipuladores disponíveis depois que o manipulador tiver sido executado uma vez.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-247">Delete the handler's name from the list of available handlers after the handler has been run once.</span></span> <span data-ttu-id="bc6a6-248">As informações de registro do manipulador também são excluídas.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-248">The handler's registry information is also deleted.</span></span>

### <a name="getspaceused"></a><span data-ttu-id="bc6a6-249">GetSpaceUsed</span><span class="sxs-lookup"><span data-stu-id="bc6a6-249">GetSpaceUsed</span></span>

<span data-ttu-id="bc6a6-250">O Gerenciador de limpeza de disco chama esse método para determinar a quantidade de espaço que um manipulador de limpeza de disco pode liberar.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-250">The disk cleanup manager calls this method to determine how much space a disk cleanup handler can potentially free.</span></span> <span data-ttu-id="bc6a6-251">Em seguida, o Gerenciador de limpeza de disco exibe esse valor à direita do nome do manipulador na caixa de listagem.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-251">The disk cleanup manager then displays that value to the right of the handler's name in the list box.</span></span> <span data-ttu-id="bc6a6-252">Essa operação é executada em todos os manipuladores registrados com o Gerenciador de limpeza de disco quando o gerente é iniciado e antes da interface do usuário principal do gerente ser exibida.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-252">This operation is performed on all of the handlers registered with the disk cleanup manager when the manager is launched and before the manager's main UI is displayed.</span></span> <span data-ttu-id="bc6a6-253">Quando [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) é chamado, o manipulador deve verificar os arquivos dos quais ele é responsável, determinar quais deles são candidatos à limpeza e retornar a quantidade de espaço em disco que ele pode liberar.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-253">When [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) is called, the handler should scan the files that it is responsible for, determine which of them are cleanup candidates, and return the amount of disk space that it can free.</span></span>

<span data-ttu-id="bc6a6-254">Como a verificação pode ser um processo demorado, o Gerenciador de limpeza de disco usa o parâmetro *picb* do método para passar um ponteiro para uma interface [**IEmptyVolumeCacheCallBack**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecachecallback) .</span><span class="sxs-lookup"><span data-stu-id="bc6a6-254">Because scanning can be a lengthy process, the disk cleanup manager uses this method's *picb* parameter to pass a pointer to an [**IEmptyVolumeCacheCallBack**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecachecallback) interface.</span></span> <span data-ttu-id="bc6a6-255">O manipulador usa a interface periodicamente durante a verificação para chamar [**IEmptyVolumeCacheCallBack:: ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress), que atende a duas finalidades.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-255">The handler uses the interface periodically during the scan to call [**IEmptyVolumeCacheCallBack::ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress), which serves two purposes.</span></span>

-   <span data-ttu-id="bc6a6-256">Permite que o Gerenciador de limpeza de disco atualize uma barra de progresso, informando ao usuário como a verificação está progredindo.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-256">Allows the disk cleanup manager to update a progress bar, informing the user how the scan is progressing.</span></span>
-   <span data-ttu-id="bc6a6-257">Notifica o manipulador para interromper a verificação caso o botão **Cancelar** da janela de progresso seja clicado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-257">Notifies the handler to stop the scan in the event that the progress window's **Cancel** button is clicked.</span></span> <span data-ttu-id="bc6a6-258">Esse evento de botão não é comunicado diretamente ao manipulador; em vez disso, o Gerenciador de limpeza de disco retorna E \_ aborta na próxima vez em que [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) chama [**IEmptyVolumeCacheCallBack:: ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-258">That button event is not communicated directly to the handler; instead, the disk cleanup manager returns E\_ABORT the next time [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) calls [**IEmptyVolumeCacheCallBack::ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress).</span></span>

### <a name="showproperties"></a><span data-ttu-id="bc6a6-259">Mostrarproperties</span><span class="sxs-lookup"><span data-stu-id="bc6a6-259">ShowProperties</span></span>

<span data-ttu-id="bc6a6-260">Antes de iniciar a limpeza, o manipulador pode exibir uma interface do usuário normalmente na forma de uma janela do Windows Explorer que permite ao usuário ver uma lista de arquivos ou classes de arquivos selecionados para limpeza pelo manipulador.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-260">Before starting cleanup, the handler can display a UI typically in the form of a Windows Explorer window that allows the user to see a list of files or classes of files selected for cleanup by the handler.</span></span> <span data-ttu-id="bc6a6-261">Se o manipulador define o sinalizador **EVCF \_ HASSETTINGS** quando [**Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) ou [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) é chamado, o usuário pode solicitar a interface do usuário clicando no botão exibido para essa finalidade no Gerenciador de limpeza de disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-261">If the handler sets the **EVCF\_HASSETTINGS** flag when [**Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize) or [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) is called, the user can request the UI by clicking the button displayed for that purpose in the disk cleanup manager.</span></span> <span data-ttu-id="bc6a6-262">O texto do botão varia de um manipulador para um manipulador, mas "exibir arquivos", "exibir páginas" e "opções" são rótulos comuns.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-262">The button text varies from handler to handler, but "View Files," "View Pages," and "Options" are common labels.</span></span>

<span data-ttu-id="bc6a6-263">Quando o botão é clicado, o Gerenciador de limpeza de disco chama [**mostrarproperties**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-showproperties) para solicitar que o manipulador exiba a interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-263">When the button is clicked, the disk cleanup manager calls [**ShowProperties**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-showproperties) to prompt the handler to display the UI.</span></span> <span data-ttu-id="bc6a6-264">A interface do usuário deve ser criada como um filho da janela cujo identificador é passado no parâmetro *HWND* do método **showProperties** .</span><span class="sxs-lookup"><span data-stu-id="bc6a6-264">The UI should be created as a child of the window whose handle is passed in the **ShowProperties** method's *hwnd* parameter.</span></span>

### <a name="purge"></a><span data-ttu-id="bc6a6-265">Limpar</span><span class="sxs-lookup"><span data-stu-id="bc6a6-265">Purge</span></span>

<span data-ttu-id="bc6a6-266">O Gerenciador de limpeza de disco chama o [**método de limpeza do**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-purge) manipulador para definir a limpeza em movimento.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-266">The disk cleanup manager calls the handler's [**Purge**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-purge) method to set the cleanup in motion.</span></span> <span data-ttu-id="bc6a6-267">O parâmetro *picb* do método é um ponteiro para a interface [**IEmptyVolumeCacheCallBack**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecachecallback) do Gerenciador de limpeza de disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-267">The method's *picb* parameter is a pointer to the disk cleanup manager's [**IEmptyVolumeCacheCallBack**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecachecallback) interface.</span></span> <span data-ttu-id="bc6a6-268">Assim como com o método [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) , o manipulador deve usar a interface de retorno de chamada periodicamente para relatar seu progresso e consultar o Gerenciador de limpeza de disco se o usuário clicou em **Cancelar**.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-268">As with the [**GetSpaceUsed**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-getspaceused) method, the handler should use the callback interface periodically to report its progress and query the disk cleanup manager whether the user has clicked **Cancel**.</span></span> <span data-ttu-id="bc6a6-269">No entanto, observe que o método **Purge** deve chamar [**IEmptyVolumeCacheCallBack::P Urgeprogress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-purgeprogress), não [**ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-269">However, note that the **Purge** method must call [**IEmptyVolumeCacheCallBack::PurgeProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-purgeprogress), not [**ScanProgress**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecachecallback-scanprogress).</span></span>

### <a name="deactivate"></a><span data-ttu-id="bc6a6-270">Desativar</span><span class="sxs-lookup"><span data-stu-id="bc6a6-270">Deactivate</span></span>

<span data-ttu-id="bc6a6-271">O método [**Deactivate**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-deactivate) é chamado quando o Gerenciador de limpeza de disco está se preparando para desligar.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-271">The [**Deactivate**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-deactivate) method is called when the disk cleanup manager is preparing to shut down.</span></span> <span data-ttu-id="bc6a6-272">O manipulador deve executar todas as tarefas de limpeza necessárias e retornar.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-272">The handler should perform any needed cleanup tasks and return.</span></span> <span data-ttu-id="bc6a6-273">Se você não quiser que o manipulador seja executado novamente, defina o sinalizador **EVCF \_ REMOVEFROMLIST** no parâmetro *pdwFlags* do método de inicialização.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-273">If you don't want the handler to be run again, set the **EVCF\_REMOVEFROMLIST** flag in the initialization method's *pdwFlags* parameter.</span></span> <span data-ttu-id="bc6a6-274">Se esse sinalizador for definido, o Gerenciador de limpeza de disco removerá o manipulador de sua lista e excluirá as entradas do registro do manipulador.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-274">If this flag is set, the disk cleanup manager removes the handler from its list and deletes the handler's registry entries.</span></span> <span data-ttu-id="bc6a6-275">Você deve adicionar novamente as entradas do registro para executar o manipulador novamente.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-275">You must re-add the registry entries to run the handler again.</span></span> <span data-ttu-id="bc6a6-276">Esse sinalizador é normalmente usado para manipuladores que são executados apenas uma vez.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-276">This flag is typically used for handlers that are run only once.</span></span>

## <a name="registering-a-disk-cleanup-handler"></a><span data-ttu-id="bc6a6-277">Registrando um manipulador de limpeza de disco</span><span class="sxs-lookup"><span data-stu-id="bc6a6-277">Registering a Disk Cleanup Handler</span></span>

<span data-ttu-id="bc6a6-278">Para adicionar um manipulador à lista do Gerenciador de limpeza de disco, determinadas chaves e valores devem ser adicionados ao registro do Windows.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-278">To add a handler to the disk cleanup manager's list, certain keys and values must be added to the Windows registry.</span></span>

-   [<span data-ttu-id="bc6a6-279">Registrando o CLSID de um manipulador</span><span class="sxs-lookup"><span data-stu-id="bc6a6-279">Registering a Handler's CLSID</span></span>](#registering-a-handlers-clsid)
-   [<span data-ttu-id="bc6a6-280">Registrando um manipulador com o Gerenciador de limpeza de disco: geral</span><span class="sxs-lookup"><span data-stu-id="bc6a6-280">Registering a Handler with the Disk Cleanup Manager: General</span></span>](#registering-a-handler-with-the-disk-cleanup-manager-general)
-   [<span data-ttu-id="bc6a6-281">Registrando um manipulador com o Gerenciador de limpeza de disco: Windows 2000 ou sistemas posteriores</span><span class="sxs-lookup"><span data-stu-id="bc6a6-281">Registering a Handler with the Disk Cleanup Manager: Windows 2000 or Later Systems</span></span>](#registering-a-handler-with-the-disk-cleanup-manager-windows-2000-or-later-systems)
-   [<span data-ttu-id="bc6a6-282">Usando o objeto DataDrivenCleaner</span><span class="sxs-lookup"><span data-stu-id="bc6a6-282">Using the DataDrivenCleaner Object</span></span>](#using-the-datadrivencleaner-object)
-   [<span data-ttu-id="bc6a6-283">Exemplo de registro de um manipulador de limpeza de disco</span><span class="sxs-lookup"><span data-stu-id="bc6a6-283">Example Registration of a Disk Cleanup Handler</span></span>](#example-registration-of-a-disk-cleanup-handler)

### <a name="registering-a-handlers-clsid"></a><span data-ttu-id="bc6a6-284">Registrando o CLSID de um manipulador</span><span class="sxs-lookup"><span data-stu-id="bc6a6-284">Registering a Handler's CLSID</span></span>

<span data-ttu-id="bc6a6-285">Assim como com todos os objetos COM, o GUID e a DLL do objeto Handler devem ser registrados sob a chave **CLSID** na **\_ \_ raiz de classes hKey**.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-285">As with all COM objects, the handler object's GUID and DLL must be registered under the **CLSID** key in **HKEY\_CLASSES\_ROOT**.</span></span> <span data-ttu-id="bc6a6-286">Você também pode registrar um ícone que é exibido ao lado do nome do manipulador na caixa de listagem do Gerenciador de limpeza de disco, mas isso é opcional.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-286">You can also register an icon that is displayed next to the handler's name in the disk cleanup manager's list box, but this is optional.</span></span> <span data-ttu-id="bc6a6-287">O exemplo a seguir mostra as chaves, os valores e os dados envolvidos.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-287">The following example shows the keys, values, and data involved.</span></span>

```
HKEY_CLASSES_ROOT
   CLSID
      Handler's GUID
         DefaultIcon
            (Default) = Handler's Icon Path, Icon Index
         InprocServer32
            (Default) = Handler's DLL path
            ThreadingModel = Apartment
```

### <a name="registering-a-handler-with-the-disk-cleanup-manager-general"></a><span data-ttu-id="bc6a6-288">Registrando um manipulador com o Gerenciador de limpeza de disco: geral</span><span class="sxs-lookup"><span data-stu-id="bc6a6-288">Registering a Handler with the Disk Cleanup Manager: General</span></span>

<span data-ttu-id="bc6a6-289">Para concluir o registro, um manipulador deve adicionar uma chave que contém suas especificidades, conforme mostrado aqui.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-289">To complete the registration, a handler must add a key holding its specifics as shown here.</span></span> <span data-ttu-id="bc6a6-290">O restante desta seção aborda o conteúdo dessa chave.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-290">The remainder of this section discusses the contents of this key.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  VolumeCaches
                     Handler's Key
```

<span data-ttu-id="bc6a6-291">Em geral, o nome da chave que contém as particularidades de um manipulador é nomeado para o tipo de arquivo que ele manipula, como **arquivos de programas baixados**, mas isso não é um requisito.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-291">In general, the name of the key holding a handler's particulars is named for the type of file that it handles, such as **Downloaded Program Files**, but this is not a requirement.</span></span> <span data-ttu-id="bc6a6-292">A tabela a seguir detalha os possíveis valores encontrados nessa chave.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-292">The following table details the possible values found under this key.</span></span>

> [!Note]  
> <span data-ttu-id="bc6a6-293">Somente o valor padrão que especifica o identificador de classe do manipulador (CLSID) é necessário todos os outros valores são opcionais.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-293">Only the Default value specifying the handler's class identifier (CLSID) is required all other values are optional.</span></span>

 



<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="bc6a6-294">Valor</span><span class="sxs-lookup"><span data-stu-id="bc6a6-294">Value</span></span></th>
<th><span data-ttu-id="bc6a6-295">Type</span><span class="sxs-lookup"><span data-stu-id="bc6a6-295">Type</span></span></th>
<th><span data-ttu-id="bc6a6-296">Significado</span><span class="sxs-lookup"><span data-stu-id="bc6a6-296">Meaning</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="bc6a6-297">Padrão</span><span class="sxs-lookup"><span data-stu-id="bc6a6-297">Default</span></span></td>
<td><span data-ttu-id="bc6a6-298">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="bc6a6-298">REG_SZ</span></span></td>
<td><span data-ttu-id="bc6a6-299">O CLSID do manipulador, conforme registrado em <strong>HKEY_CLASSES_ROOT</strong> \ <strong>CLSID</strong>.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-299">The handler's CLSID as registered under <strong>HKEY_CLASSES_ROOT</strong>\<strong>CLSID</strong>.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="bc6a6-300">AdvancedButtonText</span><span class="sxs-lookup"><span data-stu-id="bc6a6-300">AdvancedButtonText</span></span></td>
<td><span data-ttu-id="bc6a6-301">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="bc6a6-301">REG_SZ</span></span></td>
<td><span data-ttu-id="bc6a6-302">Texto do botão opcional no qual os usuários podem clicar para exibir a interface do usuário do manipulador.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-302">Text for the optional button that users can click to display the handler's UI.</span></span> <span data-ttu-id="bc6a6-303">O caractere de & pode ser colocado antes de um caractere para atribuir um atalho de teclado para o botão.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-303">The & character can be placed before a character to assign a keyboard shortcut for the button.</span></span> <span data-ttu-id="bc6a6-304">O valor de AdvancedButtonText é ignorado por manipuladores expondo <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2:: InitializeEx</strong></a>.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-304">The AdvancedButtonText value is ignored by handlers exposing <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2::InitializeEx</strong></a>.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="bc6a6-305">Limpeza</span><span class="sxs-lookup"><span data-stu-id="bc6a6-305">CleanupString</span></span></td>
<td><span data-ttu-id="bc6a6-306">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="bc6a6-306">REG_SZ</span></span></td>
<td><span data-ttu-id="bc6a6-307">Linha de comando especificando um arquivo executável e parâmetros de linha de comando opcionais.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-307">Command line specifying an executable file and optional command line parameters.</span></span> <span data-ttu-id="bc6a6-308">Essa linha de comando é executada na conclusão da limpeza de disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-308">This command line is run at the completion of the disk cleanup.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="bc6a6-309">CSIDl</span><span class="sxs-lookup"><span data-stu-id="bc6a6-309">CSIDL</span></span></td>
<td><span data-ttu-id="bc6a6-310">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="bc6a6-310">REG_DWORD</span></span></td>
<td><span data-ttu-id="bc6a6-311">Um identificador independente do sistema para uma pasta especial a ser incluída na pesquisa de arquivo.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-311">A system-independent identifier for a special folder to include in the file search.</span></span> <span data-ttu-id="bc6a6-312">Esse valor deve ser inserido como um valor numérico para a instância, 0x0000001c em vez de CSIDL_LOCAL_APPDATA.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-312">This value must be entered as a numerical value for instance, 0x0000001c rather than CSIDL_LOCAL_APPDATA.</span></span> <span data-ttu-id="bc6a6-313">Para obter uma lista de valores possíveis, consulte <a href="/windows/desktop/shell/csidl"><strong>CSIDL</strong></a>.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-313">For a list of possible values, see <a href="/windows/desktop/shell/csidl"><strong>CSIDL</strong></a>.</span></span> <span data-ttu-id="bc6a6-314">Apenas um único valor pode ser usado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-314">Only a single value can be used.</span></span><br/> <span data-ttu-id="bc6a6-315">Se o valor da pasta for especificado, o local indicado pelo valor CSIDl será anexado a essas informações para compor um caminho de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-315">If the Folder value is specified, the location indicated by the CSIDL value is prepended to that information to compose a search path.</span></span> <span data-ttu-id="bc6a6-316">Por exemplo, considere o cenário a seguir.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-316">For instance, consider the following scenario.</span></span><br/>
<ul>
<li><span data-ttu-id="bc6a6-317">O valor CSIDl é especificado como 0x0000000d (CSIDL_MYMUSIC)</span><span class="sxs-lookup"><span data-stu-id="bc6a6-317">The CSIDL value is specified as 0x0000000d (CSIDL_MYMUSIC)</span></span></li>
<li><span data-ttu-id="bc6a6-318">Sua pasta minhas músicas está localizada em C:\Documents and Settings \<em>nome_do_usuário</em>\Meus Music</span><span class="sxs-lookup"><span data-stu-id="bc6a6-318">Your My Music folder is located at C:\Documents and Settings\<em>username</em>\My Music</span></span></li>
<li><span data-ttu-id="bc6a6-319">O valor da pasta contém &quot; Jazz\Singers&quot;</span><span class="sxs-lookup"><span data-stu-id="bc6a6-319">The Folder value contains &quot;Jazz\Singers&quot;</span></span></li>
</ul>
<span data-ttu-id="bc6a6-320">O resultado desse cenário é que o manipulador de limpeza de disco pesquisa a pasta C:\Documents and Settings \<em>username</em>Music\Jazz\Singers.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-320">The result of that scenario is that the disk cleanup handler searches the C:\Documents and Settings\<em>username</em>\My Music\Jazz\Singers folder.</span></span> <span data-ttu-id="bc6a6-321">Observe que a barra que precede o valor da pasta será adicionada se não estiver presente.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-321">Note that the slash preceding the Folder value is added if it is not present.</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="bc6a6-322">Descrição</span><span class="sxs-lookup"><span data-stu-id="bc6a6-322">Description</span></span></td>
<td><span data-ttu-id="bc6a6-323">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="bc6a6-323">REG_SZ</span></span></td>
<td><span data-ttu-id="bc6a6-324">Texto descritivo exibido abaixo da caixa de listagem do Gerenciador de limpeza de disco quando o nome do manipulador é selecionado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-324">Descriptive text displayed below the disk cleanup manager's list box when the handler's name is selected.</span></span> <span data-ttu-id="bc6a6-325">Aqui você pode explicar o que o manipulador faz, em quais arquivos ele se preocupa e quaisquer outras informações elucidatory ao usuário.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-325">Here you can explain what the handler does, what files it concerns itself with, and any other information elucidatory to the user.</span></span> <span data-ttu-id="bc6a6-326">Se <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2:: InitializeEx</strong></a> não for exposto pelo manipulador, esse texto poderá ser substituído por meio do método <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache:: Initialize</strong></a> do manipulador, especificando uma cadeia de caracteres alternativa no parâmetro <em>ppwszDescription</em> quando o método for chamado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-326">If <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2::InitializeEx</strong></a> is not exposed by the handler, this text can be overridden through the handler's <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache::Initialize</strong></a> method by specifying an alternate string in the <em>ppwszDescription</em> parameter when the method is called.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="bc6a6-327">Monitor</span><span class="sxs-lookup"><span data-stu-id="bc6a6-327">Display</span></span></td>
<td><span data-ttu-id="bc6a6-328">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="bc6a6-328">REG_SZ</span></span></td>
<td><span data-ttu-id="bc6a6-329">O nome do manipulador a ser exibido na caixa de listagem do Gerenciador de limpeza de disco.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-329">The handler's name to be displayed in the disk cleanup manager's list box.</span></span> <span data-ttu-id="bc6a6-330">Se <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2:: InitializeEx</strong></a> não for exposto pelo manipulador, esse texto poderá ser substituído por meio do método <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache:: Initialize</strong></a> do manipulador, especificando uma cadeia de caracteres alternativa no parâmetro <em>ppwszDisplayName</em> quando o método for chamado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-330">If <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2::InitializeEx</strong></a> is not exposed by the handler, this text can be overridden through the handler's <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache::Initialize</strong></a> method by specifying an alternate string in the <em>ppwszDisplayName</em> parameter when the method is called.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="bc6a6-331">FileList</span><span class="sxs-lookup"><span data-stu-id="bc6a6-331">FileList</span></span></td>
<td><span data-ttu-id="bc6a6-332">REG_SZ ou REG_MULTI_SZ</span><span class="sxs-lookup"><span data-stu-id="bc6a6-332">REG_SZ or REG_MULTI_SZ</span></span></td>
<td><span data-ttu-id="bc6a6-333">Uma lista de arquivos pesquisados e limpos por esse manipulador.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-333">A list of files searched for and cleaned by this handler.</span></span> <span data-ttu-id="bc6a6-334">Você pode especificar curingas usando o?</span><span class="sxs-lookup"><span data-stu-id="bc6a6-334">You can specify wildcards using the ?</span></span> <span data-ttu-id="bc6a6-335">ou \* caracteres.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-335">or \* characters.</span></span> <span data-ttu-id="bc6a6-336">Se o valor for do tipo REG_SZ, várias extensões serão separadas usando o | ou: caracteres, sem espaços em ambos os lados.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-336">If the value is of type REG_SZ, multiple extensions are separated using the | or : characters, with no spaces on either side of them.</span></span><br/> <span data-ttu-id="bc6a6-337">Se o sinalizador de DDEVCF_REMOVEDIRS for definido no valor de flags, esses valores poderão especificar nomes de diretório, bem como arquivos.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-337">If the DDEVCF_REMOVEDIRS flag is set in the Flags value, these values can specify directory names as well as files.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="bc6a6-338">Flags</span><span class="sxs-lookup"><span data-stu-id="bc6a6-338">Flags</span></span></td>
<td><span data-ttu-id="bc6a6-339">REG_DWORD ou REG_BINARY</span><span class="sxs-lookup"><span data-stu-id="bc6a6-339">REG_DWORD or REG_BINARY</span></span></td>
<td><span data-ttu-id="bc6a6-340">Sinalizadores que controlam os elementos do procedimento de pesquisa e limpeza.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-340">Flags controlling elements of the search and cleaning procedure.</span></span> <span data-ttu-id="bc6a6-341">Um ou mais dos valores a seguir.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-341">One or more of the following values.</span></span>
<ul>
<li><span data-ttu-id="bc6a6-342">DDEVCF_DOSUBDIRS (0x00000001).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-342">DDEVCF_DOSUBDIRS (0x00000001).</span></span> <span data-ttu-id="bc6a6-343">Pesquisar e remover recursivamente.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-343">Search and remove recursively.</span></span></li>
<li><span data-ttu-id="bc6a6-344">DDEVCF_REMOVEAFTERCLEAN (0x00000002).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-344">DDEVCF_REMOVEAFTERCLEAN (0x00000002).</span></span> <span data-ttu-id="bc6a6-345">Depois que o manipulador for executado uma vez, remova-o do registro.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-345">After the handler is run once, remove it from the registry.</span></span></li>
<li><span data-ttu-id="bc6a6-346">DDEVCF_REMOVEREADONLY (0x00000004).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-346">DDEVCF_REMOVEREADONLY (0x00000004).</span></span> <span data-ttu-id="bc6a6-347">Remova os arquivos que atendem aos critérios de pesquisa, mesmo que eles sejam somente leitura.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-347">Remove files that meet the search criteria even if they are read-only.</span></span></li>
<li><span data-ttu-id="bc6a6-348">DDEVCF_REMOVESYSTEM (0x00000008).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-348">DDEVCF_REMOVESYSTEM (0x00000008).</span></span> <span data-ttu-id="bc6a6-349">Remova os arquivos que atendem aos critérios de pesquisa, mesmo que eles sejam arquivos do sistema.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-349">Remove files that meet the search criteria even if they are system files.</span></span></li>
<li><span data-ttu-id="bc6a6-350">DDEVCF_REMOVEHIDDEN (0x00000010).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-350">DDEVCF_REMOVEHIDDEN (0x00000010).</span></span> <span data-ttu-id="bc6a6-351">Remova os arquivos que atendem aos critérios de pesquisa, mesmo que eles sejam arquivos ocultos.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-351">Remove files that meet the search criteria even if they are hidden files.</span></span></li>
<li><span data-ttu-id="bc6a6-352">DDEVCF_DONTSHOWIFZERO (0x00000020).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-352">DDEVCF_DONTSHOWIFZERO (0x00000020).</span></span> <span data-ttu-id="bc6a6-353">Não exibirá esse manipulador no Gerenciador de limpeza de disco se nenhum arquivo corresponder aos seus critérios de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-353">Do not display this handler in the disk cleanup manager if no files match its search criteria.</span></span></li>
<li><span data-ttu-id="bc6a6-354">DDEVCF_REMOVEDIRS (0x00000040).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-354">DDEVCF_REMOVEDIRS (0x00000040).</span></span> <span data-ttu-id="bc6a6-355">Corresponder o valor de Filelist em diretórios e remover correspondências e todos os seus subdiretórios.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-355">Match the FileList value against directories and remove matches and all of their subdirectories.</span></span></li>
<li><span data-ttu-id="bc6a6-356">DDEVCF_RUNIFOUTOFDISKSPACE (0x00000080).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-356">DDEVCF_RUNIFOUTOFDISKSPACE (0x00000080).</span></span> <span data-ttu-id="bc6a6-357">Execute esse manipulador somente se o espaço em disco disponível estiver abaixo do valor crítico, determinado pelo Gerenciador de limpeza de disco definindo o sinalizador de EVCF_OUTOFDISKSPACE por meio de <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache:: Initialize</strong></a> ou <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2:: InitializeEx</strong></a>.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-357">Run this handler only if available disk space has fallen below the critical value, determined by the disk cleanup manager setting the EVCF_OUTOFDISKSPACE flag through <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize"><strong>IEmptyVolumeCache::Initialize</strong></a> or <a href="/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex"><strong>IEmptyVolumeCache2::InitializeEx</strong></a>.</span></span></li>
<li><span data-ttu-id="bc6a6-358">DDEVCF_REMOVEPARENTDIR (0x00000100).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-358">DDEVCF_REMOVEPARENTDIR (0x00000100).</span></span> <span data-ttu-id="bc6a6-359">Remova o diretório pai dos arquivos especificados quando o limpador tiver sido executado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-359">Remove the parent directory of the specified files once the cleaner has run.</span></span></li>
<li><span data-ttu-id="bc6a6-360">DDEVCF_PRIVATE_LASTACCESS (0x10000000).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-360">DDEVCF_PRIVATE_LASTACCESS (0x10000000).</span></span> <span data-ttu-id="bc6a6-361">Use o valor LastAccess, se fornecido, em concerto quais arquivos devem ser limpos.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-361">Use the LastAccess value, if provided, in ascertaining which files should be cleaned.</span></span> <span data-ttu-id="bc6a6-362">Esse sinalizador é ignorado ao usar o <a href="#using-the-datadrivencleaner-object">DataDrivenCleaner</a> qualquer valor LastAccess fornecido é sempre usado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-362">This flag is ignored when using the <a href="#using-the-datadrivencleaner-object">DataDrivenCleaner</a> any provided LastAccess value is always used.</span></span></li>
</ul></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="bc6a6-363">Pasta</span><span class="sxs-lookup"><span data-stu-id="bc6a6-363">Folder</span></span></td>
<td><span data-ttu-id="bc6a6-364">REG_SZ, REG_MULTI_SZ ou REG_EXPAND_SZ</span><span class="sxs-lookup"><span data-stu-id="bc6a6-364">REG_SZ, REG_MULTI_SZ, or REG_EXPAND_SZ</span></span></td>
<td><span data-ttu-id="bc6a6-365">Uma pasta ou pastas específicas para procurar itens que correspondem a entradas no valor de FileList.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-365">A specific folder or folders to search for items matching entries in the FileList value.</span></span> <span data-ttu-id="bc6a6-366">Você pode especificar curingas usando o?</span><span class="sxs-lookup"><span data-stu-id="bc6a6-366">You can specify wildcards using the ?</span></span> <span data-ttu-id="bc6a6-367">ou \* caracteres.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-367">or \* characters.</span></span> <span data-ttu-id="bc6a6-368">Se o valor for do tipo REG_SZ, vários nomes de pastas serão separados usando o | caractere, sem espaços em ambos os lados.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-368">If the value is of type REG_SZ, multiple folder names are separated using the | character, without spaces on either side of it.</span></span><br/> <span data-ttu-id="bc6a6-369">Se um valor CSIDl estiver presente, somente uma pasta poderá ser especificada nesse valor.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-369">If a CSIDL value is present, only one folder can be specified in this value.</span></span> <span data-ttu-id="bc6a6-370">O local indicado pelo valor CSIDl é anexado a esse caminho de pasta para compor um caminho de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-370">The location indicated by the CSIDL value is prepended to that folder path to compose a search path.</span></span> <span data-ttu-id="bc6a6-371">Para obter um exemplo, consulte a descrição do valor CSIDl.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-371">For an example, see the CSIDL value description.</span></span><br/> <span data-ttu-id="bc6a6-372">Se esse valor estiver ausente no Windows Vista Service Pack 1 (SP1) e posterior, o manipulador de limpeza será ignorado e ele retornará S_FALSE na inicialização.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-372">If this value is absent on Windows Vista Service Pack 1 (SP1) and later, the cleanup handler is ignored and it returns S_FALSE on initialization.</span></span><br/> <span data-ttu-id="bc6a6-373">Se esse valor estiver ausente na versão original do Windows Vista e versões anteriores, a pasta raiz do volume atual será usada.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-373">If this value is absent on the original release of Windows Vista and earlier, the root folder of the current volume is used.</span></span> <span data-ttu-id="bc6a6-374">O sinalizador de DDEVCF_DOSUBDIRS é necessário nesse caso para pesquisar a unidade inteira.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-374">The DDEVCF_DOSUBDIRS flag is needed in that case to search the entire drive.</span></span> <span data-ttu-id="bc6a6-375">Sem ele, somente a própria pasta raiz é pesquisada.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-375">Without it, only the root folder itself is searched.</span></span><br/> <span data-ttu-id="bc6a6-376">Uma unidade ou unidades devem ser especificadas.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-376">A drive or drives must be specified.</span></span> <span data-ttu-id="bc6a6-377">Isso pode ser fornecido por meio do valor CSIDl ou por meio de uma cadeia de caracteres REG_EXPAND_SZ.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-377">This can be provided through the CSIDL value or through a REG_EXPAND_SZ string.</span></span> <span data-ttu-id="bc6a6-378">No entanto, o bloqueio dessas opções, no entanto, a unidade a ser pesquisada deve ser especificada no nome da pasta.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-378">Barring those options, however, the drive to search must be specified in the folder name.</span></span> <span data-ttu-id="bc6a6-379">Usar?: para pesquisar a pasta na unidade atual.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-379">Use ?: to search the folder on the current drive.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="bc6a6-380">IconPath</span><span class="sxs-lookup"><span data-stu-id="bc6a6-380">IconPath</span></span></td>
<td><span data-ttu-id="bc6a6-381">REG_SZ ou REG_EXPAND_SZ</span><span class="sxs-lookup"><span data-stu-id="bc6a6-381">REG_SZ or REG_EXPAND_SZ</span></span></td>
<td><span data-ttu-id="bc6a6-382">O caminho para o recurso do qual obter um ícone para usar em associação com o manipulador.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-382">The path to the resource from which to obtain an icon to use in association with the handler.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="bc6a6-383">LastAccess</span><span class="sxs-lookup"><span data-stu-id="bc6a6-383">LastAccess</span></span></td>
<td><span data-ttu-id="bc6a6-384">REG_DWORD ou REG_BINARY</span><span class="sxs-lookup"><span data-stu-id="bc6a6-384">REG_DWORD or REG_BINARY</span></span></td>
<td><span data-ttu-id="bc6a6-385">O número de dias que devem ter decorrido desde que um arquivo foi acessado pela última vez ou que um diretório foi criado para esse arquivo ou diretório ser considerado para limpeza.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-385">The number of days that must have elapsed since a file was last accessed or a directory was created for that file or directory to be considered for cleanup.</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="bc6a6-386">Prioridade</span><span class="sxs-lookup"><span data-stu-id="bc6a6-386">Priority</span></span></td>
<td><span data-ttu-id="bc6a6-387">REG_DWORD ou REG_BINARY</span><span class="sxs-lookup"><span data-stu-id="bc6a6-387">REG_DWORD or REG_BINARY</span></span></td>
<td><span data-ttu-id="bc6a6-388">Determina a ordem em que o manipulador é executado em relação a outros manipuladores.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-388">Determines the order that the handler is run with respect to other handlers.</span></span> <span data-ttu-id="bc6a6-389">Quanto maior o número, anteriormente no processo em que o manipulador é executado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-389">The higher the number, the earlier in the process that the handler runs.</span></span> <span data-ttu-id="bc6a6-390">Não há um intervalo definido, nenhum número é aceitável.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-390">There is no defined range any number is acceptable.</span></span></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="bc6a6-391">PropertyBag</span><span class="sxs-lookup"><span data-stu-id="bc6a6-391">PropertyBag</span></span></td>
<td><span data-ttu-id="bc6a6-392">REG_SZ</span><span class="sxs-lookup"><span data-stu-id="bc6a6-392">REG_SZ</span></span></td>
<td><span data-ttu-id="bc6a6-393">O CLSID de um recurso usado para fornecer texto localizado para o nome de exibição, a descrição e o texto do botão.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-393">The CLSID of a resource used to provide localized text for the display name, description, and button text.</span></span> <span data-ttu-id="bc6a6-394">Esse recurso é útil na situação em que um manipulador não implementa <a href="/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache"><strong>IEmptyVolumeCache</strong></a> e o manipulador está sendo executado no Microsoft Windows NT ou no Windows XP.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-394">This resource is useful in the situation where a handler does not implement <a href="/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache"><strong>IEmptyVolumeCache</strong></a> and the handler is being run under Microsoft Windows NT or Windows XP.</span></span><br/> <span data-ttu-id="bc6a6-395">O Gerenciador de limpeza de disco verifica primeiro se a rotina de inicialização do manipulador retornou essas cadeias de caracteres, como seria o caso quando <a href="/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2"><strong>IEmptyVolumeCache2</strong></a> é implementado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-395">The disk cleanup manager first checks whether the handler's initialization routine returned those strings, as would be the case when <a href="/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2"><strong>IEmptyVolumeCache2</strong></a> is implemented.</span></span> <span data-ttu-id="bc6a6-396">Com falha, o gerente avançará para um conjunto de propriedades chamado nesse valor.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-396">Failing that, the manager next turns to a property bag named in this value.</span></span> <span data-ttu-id="bc6a6-397">Se nenhum tiver sido fornecido, ele recuperará o texto do registro.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-397">If none has been provided, it retrieves the text from the registry.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="bc6a6-398">StateFlags</span><span class="sxs-lookup"><span data-stu-id="bc6a6-398">StateFlags</span></span></td>
<td><span data-ttu-id="bc6a6-399">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="bc6a6-399">REG_DWORD</span></span></td>
<td><span data-ttu-id="bc6a6-400">Ao executar o arquivo executável do Gerenciador de limpeza de disco Cleanmgr.exe de uma linha de comando, você pode declarar <em>perfis</em>de limpeza.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-400">By running the disk cleanup manager's executable file Cleanmgr.exe from a command line, you can declare cleanup <em>profiles</em>.</span></span> <span data-ttu-id="bc6a6-401">Esses perfis são compostos de um subconjunto dos manipuladores disponíveis e recebem um rótulo numérico exclusivo.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-401">These profiles are composed of a subset of the available handlers and are given a unique numeric label.</span></span> <span data-ttu-id="bc6a6-402">Isso permite que você automatize a execução de diferentes conjuntos de manipuladores em momentos diferentes.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-402">This allows you to automate the running of different sets of handlers at different times.</span></span><br/> <span data-ttu-id="bc6a6-403">A linha de comando &quot;cleanmgr.exe/sageset:<strong>nnnn</strong> &quot; , em que <strong>nnnn</strong> é um rótulo numérico exclusivo, exibe uma interface do usuário que permite que você escolha os manipuladores a serem incluídos nesse perfil.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-403">The command line &quot;cleanmgr.exe /sageset:<strong>nnnn</strong>&quot;, where <strong>nnnn</strong> is a unique numeric label, displays a UI allowing you to choose the handlers to be included in that profile.</span></span> <span data-ttu-id="bc6a6-404">Além de definir o perfil, o parâmetro sageset também grava um valor chamado StateFlags<strong>nnnn</strong>, em que <strong>nnnn</strong> é o rótulo usado no parâmetro, para todas as subchaves em <strong>VolumeCaches</strong>.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-404">As well as defining the profile, the sageset parameter also writes a value named StateFlags<strong>nnnn</strong>, where <strong>nnnn</strong> is the label you used in the parameter, to all of the subkeys under <strong>VolumeCaches</strong>.</span></span> <span data-ttu-id="bc6a6-405">Há dois valores de dados possíveis para essas entradas.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-405">There are two possible data values for those entries.</span></span>
<ul>
<li><span data-ttu-id="bc6a6-406">0: não execute este manipulador quando este perfil for executado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-406">0: Do not run this handler when this profile is run.</span></span></li>
<li><span data-ttu-id="bc6a6-407">2: incluir esse manipulador quando este perfil for executado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-407">2: Include this handler when this profile is run.</span></span></li>
</ul>
<br/> <span data-ttu-id="bc6a6-408">Por exemplo, suponha que a linha de comando &quot;cleanmgr.exe/sageset: 1234 &quot; seja executada.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-408">For example, suppose that the command line &quot;cleanmgr.exe /sageset:1234&quot; is run.</span></span> <span data-ttu-id="bc6a6-409">Na interface do usuário que é apresentada, o usuário escolhe <strong>arquivos de programas baixados</strong>, mas não escolhe <strong>arquivos de Internet temporários</strong>.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-409">In the UI that is presented, the user chooses <strong>Downloaded Program Files</strong>, but does not choose <strong>Temporary Internet Files</strong>.</span></span> <span data-ttu-id="bc6a6-410">Os valores a seguir são gravados no registro.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-410">The following values are then written to the registry.</span></span><br/>
<pre data-space="preserve"><code>HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  VolumeCaches
                     Downloaded Program Files
                        StateFlags1234 = 0x00000002
                     Internet Cache Files
                        StateFlags1234 = 0x00000000</code></pre>
<br/> <span data-ttu-id="bc6a6-411">A linha &quot; de comandocleanmgr.exe/sagerun:<strong>nnnn</strong> &quot; , em que o valor de <strong>nnnn</strong> corresponde ao rótulo declarado com o parâmetro do sageset, executa todos os manipuladores selecionados nesse perfil.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-411">The command line &quot;cleanmgr.exe /sagerun:<strong>nnnn</strong>&quot;, where the value of <strong>nnnn</strong> matches the label declared with the sageset parameter, runs all of the handlers selected in that profile.</span></span><br/> <span data-ttu-id="bc6a6-412">Um valor StateFlags genérico é gravado no registro quando a limpeza de disco é executada normalmente.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-412">A generic StateFlags value is written to the registry when Disk Cleanup is run normally.</span></span> <span data-ttu-id="bc6a6-413">Esse valor simplesmente armazena o estado (marcado ou desmarcado) do manipulador na última vez em que foi apresentado como uma opção para o usuário.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-413">This value simply stores the state (checked or unchecked) of the handler the last time it was presented as an option to the user.</span></span> <span data-ttu-id="bc6a6-414">Há dois valores de dados possíveis para essas entradas.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-414">There are two possible data values for those entries.</span></span>
<ul>
<li><span data-ttu-id="bc6a6-415">0: o manipulador não foi selecionado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-415">0: The handler was not selected.</span></span></li>
<li><span data-ttu-id="bc6a6-416">1: o manipulador foi selecionado.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-416">1: The handler was selected.</span></span></li>
</ul>
<br/></td>
</tr>
</tbody>
</table>



 

### <a name="registering-a-handler-with-the-disk-cleanup-manager-windows-2000-or-later-systems"></a><span data-ttu-id="bc6a6-417">Registrando um manipulador com o Gerenciador de limpeza de disco: Windows 2000 ou sistemas posteriores</span><span class="sxs-lookup"><span data-stu-id="bc6a6-417">Registering a Handler with the Disk Cleanup Manager: Windows 2000 or Later Systems</span></span>

<span data-ttu-id="bc6a6-418">Especificar o texto de exibição no registro pode dificultar a localização do software.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-418">Specifying display text in the registry can make it difficult to localize software.</span></span> <span data-ttu-id="bc6a6-419">Por esse motivo, o Windows 2000 e o Windows XP dão suporte à interface [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) com seu método de inicialização preferencial [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-419">For this reason, Windows 2000 and Windows XP support the [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2) interface with its preferred initialization method [**InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex).</span></span> <span data-ttu-id="bc6a6-420">No Windows 2000 ou posterior, uma tentativa sempre é feita para chamar **IEmptyVolumeCache2:: InitializeEx** antes de [**IEmptyVolumeCache:: Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-420">Under Windows 2000 or later, an attempt is always made to call **IEmptyVolumeCache2::InitializeEx** before [**IEmptyVolumeCache::Initialize**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache-initialize).</span></span> <span data-ttu-id="bc6a6-421">O sistema usará **Initialize** somente para inicializar um manipulador se **IEmptyVolumeCache2** não for exposto.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-421">The system only uses **Initialize** to initialize a handler if **IEmptyVolumeCache2** is not exposed.</span></span>

<span data-ttu-id="bc6a6-422">Em relação ao registro, a única diferença no Windows 2000 ou posterior é que você pode omitir os valores de AdvancedButtonText, exibição e descrição quando [**IEmptyVolumeCache2:: InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) é exposto pelo manipulador.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-422">In regard to the registry, the only difference under Windows 2000 or later is that you can omit the AdvancedButtonText, Display, and Description values when [**IEmptyVolumeCache2::InitializeEx**](/windows/desktop/api/Emptyvc/nf-emptyvc-iemptyvolumecache2-initializeex) is exposed by the handler.</span></span> <span data-ttu-id="bc6a6-423">Esses valores, que contêm texto localizado corretamente, são fornecidos ao Gerenciador de limpeza de disco quando ele chama **InitializeEx**.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-423">Those values, containing properly localized text, are provided to the disk cleanup manager when it calls **InitializeEx**.</span></span>

### <a name="using-the-datadrivencleaner-object"></a><span data-ttu-id="bc6a6-424">Usando o objeto DataDrivenCleaner</span><span class="sxs-lookup"><span data-stu-id="bc6a6-424">Using the DataDrivenCleaner Object</span></span>

<span data-ttu-id="bc6a6-425">Um manipulador de limpeza de disco básico, chamado de DataDrivenCleaner, é fornecido pelo sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-425">A basic disk cleanup handler, called the DataDrivenCleaner, is provided by the operating system.</span></span> <span data-ttu-id="bc6a6-426">Para usar esse objeto como um manipulador em vez de implementar seu próprio, use o CLSID {C0E13E61-0CC6-11d1-BBB6-0060978B2AE6} como o valor padrão para a subchave do manipulador em **VolumeCaches** , conforme descrito em [registrando um manipulador com o Gerenciador de limpeza de disco: geral](#registering-a-handler-with-the-disk-cleanup-manager-general).</span><span class="sxs-lookup"><span data-stu-id="bc6a6-426">To use this object as a handler rather than implementing your own, use the CLSID {C0E13E61-0CC6-11d1-BBB6-0060978B2AE6} as the Default value for the handler's subkey under **VolumeCaches** as described in [Registering a Handler with the Disk Cleanup Manager: General](#registering-a-handler-with-the-disk-cleanup-manager-general).</span></span>

<span data-ttu-id="bc6a6-427">O DataDrivenCleaner não expõe [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2), portanto os valores de exibição e descrição são fornecidos pelo registro.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-427">The DataDrivenCleaner does not expose [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2), so the Display and Description values are provided through the registry.</span></span> <span data-ttu-id="bc6a6-428">Ao declarar essas cadeias de caracteres, lembre-se de que isso pode causar problemas de localização.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-428">When declaring those strings, be aware that this could cause localization issues.</span></span> <span data-ttu-id="bc6a6-429">O texto localizado pode ser fornecido por meio do valor PropertyBag.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-429">Localized text can be provided through the PropertyBag value.</span></span> <span data-ttu-id="bc6a6-430">O valor de AdvancedButtonText é ignorado, pois não há interface do usuário e, portanto, nenhum botão para exibi-lo está disponível para esse manipulador.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-430">The AdvancedButtonText value is ignored since no UI, and thus no button to display it, is available for this handler.</span></span>

### <a name="example-registration-of-a-disk-cleanup-handler"></a><span data-ttu-id="bc6a6-431">Exemplo de registro de um manipulador de limpeza de disco</span><span class="sxs-lookup"><span data-stu-id="bc6a6-431">Example Registration of a Disk Cleanup Handler</span></span>

<span data-ttu-id="bc6a6-432">Veja a seguir um exemplo de registro de um manipulador de limpeza de disco implementado pela companhia telefônica.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-432">The following shows an example registration for a disk cleanup handler implemented by The Phone Company.</span></span> <span data-ttu-id="bc6a6-433">Esse manipulador implementa [**IEmptyVolumeCache**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache) e [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2)e, portanto, fornece os valores de AdvancedButtonText, descrição e exibição, caso ele seja usado em um computador que executa o Windows 98.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-433">This handler implements both [**IEmptyVolumeCache**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache) and [**IEmptyVolumeCache2**](/windows/desktop/api/Emptyvc/nn-emptyvc-iemptyvolumecache2), and so provides AdvancedButtonText, Description, and Display values in case it is used on a computer running Windows 98.</span></span> <span data-ttu-id="bc6a6-434">O manipulador combina os valores de CSIDl e de pasta para pesquisar arquivos nos arquivos de \\ programas C: \\ o diretório temporário da empresa telefônica \\ e o \_ sinalizador DDEVCF DOSUBDIRS é definido para que seus subdiretórios também sejam pesquisados.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-434">The handler combines the CSIDL and Folder values to search for files in the C:\\Program Files\\The Phone Company\\Temp directory, and the DDEVCF\_DOSUBDIRS flag is set so that its subdirectories are also searched.</span></span> <span data-ttu-id="bc6a6-435">Somente os arquivos com as extensões. tmp e. TPC são considerados para limpeza e o \_ \_ sinalizador LASTACCESS privado DDEVCF é definido para que esses arquivos, somente aqueles que não tenham sido acessados por 14 dias ou mais, sejam considerados.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-435">Only those files with .tmp and .tpc extensions are considered for cleanup, and the DDEVCF\_PRIVATE\_LASTACCESS flag is set so that out of those files, only those that have not been accessed for 14 days or more are considered.</span></span> <span data-ttu-id="bc6a6-436">O \_ sinalizador DDEVCF DONTSHOWIFZERO também é definido para que o manipulador não apareça na lista, a menos que tenha encontrado candidatos à limpeza.</span><span class="sxs-lookup"><span data-stu-id="bc6a6-436">The DDEVCF\_DONTSHOWIFZERO flag is also set so that the handler does not appear on the list unless it has found cleanup candidates.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  VolumeCaches
                     The Phone Company Files
                        (Default) = {the CLSID GUID}
                        AdvancedButtonText = &View Files
                        CleanupString = c:\tpc.exe
                        CSIDL = 0x00000026
                        Description = Old temporary files.
                        Display = The Phone Company Files
                        FileList = *.tmp|*.tpc
                        Flags = 0x10000021
                        Folder = \The Phone Company\Temp
                        IconPath = c:\Program Files\The Phone Company\tpc.dll,2
                        LastAccess = 0x0000000e
                        Priority = 200
                        PropertyBag = {Property Bag CLSID GUID}
```

 

