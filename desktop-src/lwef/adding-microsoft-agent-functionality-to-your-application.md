---
title: Adicionando a funcionalidade do Microsoft Agent ao seu aplicativo
description: Adicionando a funcionalidade do Microsoft Agent ao seu aplicativo
ms.assetid: 2b4816dd-11bf-4c17-873e-4bdbb7fa1ccf
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8a2972b0251a4114e5d280d8f739d416ebc5dc1c
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104293960"
---
# <a name="adding-microsoft-agent-functionality-to-your-application"></a><span data-ttu-id="035a7-103">Adicionando a funcionalidade do Microsoft Agent ao seu aplicativo</span><span class="sxs-lookup"><span data-stu-id="035a7-103">Adding Microsoft Agent Functionality to Your Application</span></span>

<span data-ttu-id="035a7-104">\[O Microsoft Agent foi preterido a partir do Windows 7 e pode não estar disponível nas versões subsequentes do Windows.\]</span><span class="sxs-lookup"><span data-stu-id="035a7-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="035a7-105">Para acessar as interfaces de servidor do Microsoft Agent, o Agent já deve estar instalado no sistema de destino.</span><span class="sxs-lookup"><span data-stu-id="035a7-105">To access Microsoft Agent's server interfaces, Agent must already be installed on the target system.</span></span> <span data-ttu-id="035a7-106">Não há suporte para a instalação que não seja usar o arquivo executável de autoinstalação do agente, como a tentativa de copiar e registrar arquivos de componente do agente.</span><span class="sxs-lookup"><span data-stu-id="035a7-106">Installation other than using Agent's self-installing executable file, such as attempting to copy and register Agent component files, is not supported.</span></span> <span data-ttu-id="035a7-107">Isso garante a instalação consistente e completa.</span><span class="sxs-lookup"><span data-stu-id="035a7-107">This ensures consistent and complete installation.</span></span> <span data-ttu-id="035a7-108">Observe que o arquivo de instalação automática do Microsoft Agent não será instalado no Microsoft Windows 2000 e nos sistemas operacionais posteriores, pois essas versões do sistema operacional já incluem sua própria versão do Agent.</span><span class="sxs-lookup"><span data-stu-id="035a7-108">Note that the Microsoft Agent self-installing file will not install on Microsoft Windows 2000 and later operating systems because these versions of the operating system already include their own version of Agent.</span></span>

<span data-ttu-id="035a7-109">Para instalar com êxito o agente em um sistema de destino com um sistema operacional anterior do Microsoft Windows, você também deve garantir que o sistema de destino tenha uma versão recente do tempo de execução de Microsoft Visual C++ (Msvcrt.dll), a Regsvr32.dll (ferramenta de registro da Microsoft) e as DLLs do Microsoft COM.</span><span class="sxs-lookup"><span data-stu-id="035a7-109">To successfully install Agent on a target system with a prior Microsoft Windows operating system, you must also ensure that the target system has a recent version of the Microsoft Visual C++ runtime (Msvcrt.dll), Microsoft registration tool (Regsvr32.dll), and Microsoft COM dlls.</span></span> <span data-ttu-id="035a7-110">A maneira mais fácil de garantir que os componentes necessários estejam no sistema de destino é exigir que o Microsoft Internet Explorer 3, 2 ou posterior esteja instalado.</span><span class="sxs-lookup"><span data-stu-id="035a7-110">The easiest way to ensure that the necessary components are on the target system is to require that Microsoft Internet Explorer 3.02 or later is installed.</span></span> <span data-ttu-id="035a7-111">Como alternativa, você pode instalar os dois primeiros componentes que estão disponíveis como parte do Microsoft Visual C++.</span><span class="sxs-lookup"><span data-stu-id="035a7-111">Alternatively, you can install the first two components which are available as part of Microsoft Visual C++.</span></span> <span data-ttu-id="035a7-112">As DLLs COM necessárias podem ser instaladas como parte da atualização DCOM da Microsoft, disponível no site da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="035a7-112">The necessary COM dlls can be installed as part of the Microsoft DCOM update, available at the Microsoft website.</span></span> <span data-ttu-id="035a7-113">Você pode encontrar mais informações e informações de licenciamento para esses componentes no site da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="035a7-113">You can find further information and licensing information for these components at the Microsoft website.</span></span>

<span data-ttu-id="035a7-114">Os componentes de idioma do agente podem ser instalados da mesma maneira.</span><span class="sxs-lookup"><span data-stu-id="035a7-114">Agent's language components can be installed the same way.</span></span> <span data-ttu-id="035a7-115">Da mesma forma, você pode usar essa técnica para instalar o formato do ACS dos caracteres da Microsoft disponíveis para distribuição no site do Microsoft Agent.</span><span class="sxs-lookup"><span data-stu-id="035a7-115">Similarly, you can use this technique to install the ACS format of the Microsoft characters available for distribution from the Microsoft Agent website.</span></span> <span data-ttu-id="035a7-116">Os arquivos de caractere são instalados automaticamente no subdiretório de caracteres do Microsoft Agent \\ .</span><span class="sxs-lookup"><span data-stu-id="035a7-116">The character files automatically install to the Microsoft Agent \\Chars subdirectory.</span></span>

<span data-ttu-id="035a7-117">Como os componentes do Microsoft Agent são projetados como componentes do sistema operacional, o Agent pode não ser desinstalado.</span><span class="sxs-lookup"><span data-stu-id="035a7-117">Because Microsoft Agent's components are designed as operating system components, Agent may not be uninstalled.</span></span> <span data-ttu-id="035a7-118">Da mesma forma, onde o Agent já está instalado como parte do sistema operacional Windows, o gabinete de instalação automática do agente pode não ser instalado.</span><span class="sxs-lookup"><span data-stu-id="035a7-118">Similarly, where Agent is already installed as part of the Windows operating system, the Agent self-installing cabinet may not install.</span></span>

<span data-ttu-id="035a7-119">Uma vez instalado, para chamar as interfaces do agente, crie uma instância do servidor e solicite um ponteiro para uma interface específica que o servidor dá suporte usando a Convenção COM padrão.</span><span class="sxs-lookup"><span data-stu-id="035a7-119">Once installed, to call Agent's interfaces, create an instance of the server and request a pointer to a specific interface that the server supports using the standard COM convention.</span></span> <span data-ttu-id="035a7-120">Em particular, a biblioteca COM fornece uma função de API, [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance), que cria uma instância do objeto e retorna um ponteiro para a interface solicitada do objeto.</span><span class="sxs-lookup"><span data-stu-id="035a7-120">In particular, the COM library provides an API function, [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance), that creates an instance of the object and returns a pointer to the requested interface of the object.</span></span> <span data-ttu-id="035a7-121">Solicite um ponteiro para a interface [**IAgent**](iagent.md) ou [**IAgentEx**](iagentex.md) em sua chamada **CoCreateInstance** ou em uma chamada subsequente para [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span><span class="sxs-lookup"><span data-stu-id="035a7-121">Request a pointer to the [**IAgent**](iagent.md) or [**IAgentEx**](iagentex.md) interface in your **CoCreateInstance** call or in a subsequent call to [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)).</span></span>

<span data-ttu-id="035a7-122">O código a seguir ilustra isso em C/C++.</span><span class="sxs-lookup"><span data-stu-id="035a7-122">The following code illustrates this in C/C++.</span></span>


```
hRes = CoCreateInstance(CLSID_AgentServer,
                     NULL,
                     CLSCTX_SERVER,
                     IID_IAgentEx,
                     (LPVOID *)&amp;pAgentEx);
```



<span data-ttu-id="035a7-123">Se o servidor do Microsoft Agent estiver em execução, essa função se conectará ao servidor; caso contrário, ele inicia o servidor.</span><span class="sxs-lookup"><span data-stu-id="035a7-123">If the Microsoft Agent server is running, this function connects to the server; otherwise, it starts up the server.</span></span>

<span data-ttu-id="035a7-124">Observe que as interfaces de servidor do Microsoft Agent geralmente incluem interfaces estendidas que incluem um sufixo "ex".</span><span class="sxs-lookup"><span data-stu-id="035a7-124">Note that the Microsoft Agent server interfaces often include extended interfaces that include an "Ex" suffix.</span></span> <span data-ttu-id="035a7-125">Essas interfaces são derivadas de e, portanto, incluem toda a funcionalidade do, suas contrapartes não-ex.</span><span class="sxs-lookup"><span data-stu-id="035a7-125">These interfaces are derived from, and therefore include all the functionality of, their non-Ex counterparts.</span></span> <span data-ttu-id="035a7-126">Se você quiser usar qualquer um dos recursos estendidos, use as interfaces ex.</span><span class="sxs-lookup"><span data-stu-id="035a7-126">If you want to use any of the extended features, use the Ex interfaces.</span></span>

<span data-ttu-id="035a7-127">Funções que usam ponteiros para BSTRs alocam memória usando [**SysAllocString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysallocstring).</span><span class="sxs-lookup"><span data-stu-id="035a7-127">Functions that take pointers to BSTRs allocate memory using [**SysAllocString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysallocstring).</span></span> <span data-ttu-id="035a7-128">É responsabilidade do chamador liberar essa memória usando [**SysFreeString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysfreestring).</span><span class="sxs-lookup"><span data-stu-id="035a7-128">It is the caller's responsibility to free this memory using [**SysFreeString**](/previous-versions/windows/desktop/api/oleauto/nf-oleauto-sysfreestring).</span></span>

 

 