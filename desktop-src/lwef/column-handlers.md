---
title: Criando manipuladores de coluna
description: A exibição de detalhes no Windows Windows Explorer normalmente exibe várias colunas padrão.
ms.assetid: 805e0e13-d09e-40f8-955b-c585f388e07e
keywords:
- manipuladores de coluna
- registrar, manipuladores de coluna
- GetColumnInfo
- GetItemData
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 940796e75f29ba0fcfa025d9a56267e14bdff38f
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104569754"
---
# <a name="creating-column-handlers"></a><span data-ttu-id="88cb8-107">Criando manipuladores de coluna</span><span class="sxs-lookup"><span data-stu-id="88cb8-107">Creating Column Handlers</span></span>

<span data-ttu-id="88cb8-108">\[Esse recurso tem suporte apenas no Windows XP ou anterior.</span><span class="sxs-lookup"><span data-stu-id="88cb8-108">\[This feature is supported only under Windows XP or earlier.</span></span> <span data-ttu-id="88cb8-109">\]</span><span class="sxs-lookup"><span data-stu-id="88cb8-109">\]</span></span>

<span data-ttu-id="88cb8-110">A exibição de detalhes no Windows Windows Explorer normalmente exibe várias colunas padrão.</span><span class="sxs-lookup"><span data-stu-id="88cb8-110">The Details view in the Windows Windows Explorer normally displays several standard columns.</span></span> <span data-ttu-id="88cb8-111">Cada coluna lista informações, como o tamanho ou o tipo do arquivo, para cada arquivo na pasta atual.</span><span class="sxs-lookup"><span data-stu-id="88cb8-111">Each column lists information, such as the file size or type, for each file in the current folder.</span></span> <span data-ttu-id="88cb8-112">Ao implementar e registrar um manipulador de colunas, você pode disponibilizar colunas personalizadas para exibição.</span><span class="sxs-lookup"><span data-stu-id="88cb8-112">By implementing and registering a column handler, you can make custom columns available for display.</span></span>

<span data-ttu-id="88cb8-113">Os procedimentos gerais para implementar e registrar um manipulador de extensão de shell são discutidos na [criação de manipuladores de extensão de shell](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="88cb8-113">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="88cb8-114">Este documento se concentra nesses aspectos da implementação que são específicos para manipuladores de coluna.</span><span class="sxs-lookup"><span data-stu-id="88cb8-114">This document focuses on those aspects of implementation that are specific to column handlers.</span></span>

<span data-ttu-id="88cb8-115">Os tópicos a seguir são discutidos.</span><span class="sxs-lookup"><span data-stu-id="88cb8-115">The following topics are discussed.</span></span>

-   [<span data-ttu-id="88cb8-116">Como funcionam os manipuladores de coluna</span><span class="sxs-lookup"><span data-stu-id="88cb8-116">How Column Handlers Work</span></span>](#how-column-handlers-work)
-   [<span data-ttu-id="88cb8-117">Registrando manipuladores de coluna</span><span class="sxs-lookup"><span data-stu-id="88cb8-117">Registering Column Handlers</span></span>](#registering-column-handlers)
-   [<span data-ttu-id="88cb8-118">Implementando manipuladores de coluna</span><span class="sxs-lookup"><span data-stu-id="88cb8-118">Implementing Column Handlers</span></span>](#implementing-column-handlers)
    -   [<span data-ttu-id="88cb8-119">O método Initialize</span><span class="sxs-lookup"><span data-stu-id="88cb8-119">The Initialize Method</span></span>](#the-initialize-method)
    -   [<span data-ttu-id="88cb8-120">O método GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="88cb8-120">The GetColumnInfo Method</span></span>](#the-getcolumninfo-method)
    -   [<span data-ttu-id="88cb8-121">O método GetItemData</span><span class="sxs-lookup"><span data-stu-id="88cb8-121">The GetItemData Method</span></span>](#the-getitemdata-method)

## <a name="how-column-handlers-work"></a><span data-ttu-id="88cb8-122">Como funcionam os manipuladores de coluna</span><span class="sxs-lookup"><span data-stu-id="88cb8-122">How Column Handlers Work</span></span>

<span data-ttu-id="88cb8-123">A ilustração a seguir mostra o Windows Explorer no modo de exibição detalhes.</span><span class="sxs-lookup"><span data-stu-id="88cb8-123">The following illustration shows Windows Explorer in Details view.</span></span>

![captura de tela do Windows Explorer no modo de exibição detalhes](images/columnproviderhandler1.jpg)

<span data-ttu-id="88cb8-125">Com o Windows 2000, a pasta também pode oferecer suporte a várias colunas que, por padrão, não são exibidas.</span><span class="sxs-lookup"><span data-stu-id="88cb8-125">With Windows 2000, the folder can also support a number of columns that, by default, are not displayed.</span></span> <span data-ttu-id="88cb8-126">O usuário pode exibir colunas adicionais clicando com o botão direito do mouse em um dos cabeçalhos de coluna e selecionando o comando **mais...** no menu.</span><span class="sxs-lookup"><span data-stu-id="88cb8-126">The user can display additional columns by right-clicking one of the column headers and selecting the **More...** command from the menu.</span></span> <span data-ttu-id="88cb8-127">Será exibida uma caixa de diálogo que lista as colunas disponíveis para a pasta e permite que o usuário Selecione quais colunas exibir.</span><span class="sxs-lookup"><span data-stu-id="88cb8-127">A dialog box then appears that lists the available columns for the folder and allows the user to select which columns to display.</span></span> <span data-ttu-id="88cb8-128">A ilustração a seguir mostra essa caixa de diálogo para o exemplo anterior.</span><span class="sxs-lookup"><span data-stu-id="88cb8-128">The following illustration shows this dialog box for the preceding example.</span></span>

![captura de tela do Windows Explorer com a caixa de diálogo escolher detalhes exibida](images/columnproviderhandler2.jpg)

<span data-ttu-id="88cb8-130">Ao criar um manipulador de colunas, você pode criar colunas personalizadas e adicioná-las a essa lista.</span><span class="sxs-lookup"><span data-stu-id="88cb8-130">By creating a column handler, you can create custom columns and add them to that list.</span></span> <span data-ttu-id="88cb8-131">Por exemplo, uma coleção de arquivos que contêm música pode usar um manipulador de coluna para exibir colunas que listam o artista e a parte contida em cada arquivo.</span><span class="sxs-lookup"><span data-stu-id="88cb8-131">For example, a collection of files that contain music could use a column handler to display columns listing the artist and piece contained by each file.</span></span>

<span data-ttu-id="88cb8-132">Um manipulador de coluna é um objeto global que é chamado toda vez que o Windows Explorer exibe a exibição de detalhes.</span><span class="sxs-lookup"><span data-stu-id="88cb8-132">A column handler is a global object that is called every time Windows Explorer displays the Details view.</span></span> <span data-ttu-id="88cb8-133">No entanto, os manipuladores de coluna normalmente são usados para exibir colunas personalizadas somente para membros de um determinado [tipo de arquivo](/windows/desktop/shell/fa-file-types).</span><span class="sxs-lookup"><span data-stu-id="88cb8-133">However, column handlers are typically used to display custom columns only for members of a particular [file type](/windows/desktop/shell/fa-file-types).</span></span> <span data-ttu-id="88cb8-134">Antes de exibir a exibição de detalhes, o Windows Explorer consulta todos os manipuladores de coluna registrados para suas características de coluna.</span><span class="sxs-lookup"><span data-stu-id="88cb8-134">Before it displays the Details view, Windows Explorer queries all registered column handlers for their column characteristics.</span></span> <span data-ttu-id="88cb8-135">Se o usuário tiver selecionado uma das colunas do manipulador, o Windows Explorer consultará o manipulador para os dados associados.</span><span class="sxs-lookup"><span data-stu-id="88cb8-135">If the user has selected one of the handler's columns, Windows Explorer queries the handler for the associated data.</span></span> <span data-ttu-id="88cb8-136">Quando um manipulador de coluna receber uma solicitação de dados, ele o fornecerá se o arquivo for um membro de seu tipo com suporte.</span><span class="sxs-lookup"><span data-stu-id="88cb8-136">When a column handler receives a request for data, it provides it if the file is a member of its supported type.</span></span> <span data-ttu-id="88cb8-137">Caso contrário, ele ignora a solicitação retornando S \_ false.</span><span class="sxs-lookup"><span data-stu-id="88cb8-137">Otherwise, it ignores the request by returning S\_FALSE.</span></span>

## <a name="registering-column-handlers"></a><span data-ttu-id="88cb8-138">Registrando manipuladores de coluna</span><span class="sxs-lookup"><span data-stu-id="88cb8-138">Registering Column Handlers</span></span>

<span data-ttu-id="88cb8-139">Os manipuladores de coluna são registrados na subchave a seguir.</span><span class="sxs-lookup"><span data-stu-id="88cb8-139">Column handlers are registered under the following subkey.</span></span>

```
HKEY_CLASSES_ROOT
   Folder
      shellex
         ColumnHandlers
```

<span data-ttu-id="88cb8-140">Crie uma subchave de **ColumnHandlers** chamada com a forma de cadeia de caracteres do GUID de identificador de classe (CLSID) do manipulador.</span><span class="sxs-lookup"><span data-stu-id="88cb8-140">Create a subkey of **ColumnHandlers** named with the string form of the handler's class identifier (CLSID) GUID.</span></span> <span data-ttu-id="88cb8-141">Para obter uma discussão geral sobre como registrar manipuladores de extensão de Shell, consulte [criando manipuladores de extensão de shell](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="88cb8-141">For a general discussion of how to register Shell extension handlers, see [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="88cb8-142">O exemplo a seguir ilustra como registrar um manipulador de coluna.</span><span class="sxs-lookup"><span data-stu-id="88cb8-142">The following example illustrates how to register a column handler.</span></span>

```
HKEY_CLASSES_ROOT
   Folder
      shellex
         ColumnHandlers
            {My Column Handler CLSID GUID}
```

## <a name="implementing-column-handlers"></a><span data-ttu-id="88cb8-143">Implementando manipuladores de coluna</span><span class="sxs-lookup"><span data-stu-id="88cb8-143">Implementing Column Handlers</span></span>

<span data-ttu-id="88cb8-144">Como todos os manipuladores de extensão do Shell, os manipuladores de coluna são objetos COM (Component Object Model) em processo implementados como DLLs.</span><span class="sxs-lookup"><span data-stu-id="88cb8-144">Like all Shell extension handlers, column handlers are in-process Component Object Model (COM) objects implemented as DLLs.</span></span> <span data-ttu-id="88cb8-145">Eles exportam a interface [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) além de [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span><span class="sxs-lookup"><span data-stu-id="88cb8-145">They export the [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) interface in addition to [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown).</span></span>

<span data-ttu-id="88cb8-146">O Windows Explorer chama os três métodos exportados pelo [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) para solicitar as informações necessárias para exibir a coluna.</span><span class="sxs-lookup"><span data-stu-id="88cb8-146">Windows Explorer calls the three methods exported by [**IColumnProvider**](/windows/desktop/api/shlobj/nn-shlobj-icolumnprovider) to request the information it needs to display the column.</span></span> <span data-ttu-id="88cb8-147">O procedimento usado pelo Windows Explorer é:</span><span class="sxs-lookup"><span data-stu-id="88cb8-147">The procedure used by Windows Explorer is:</span></span>

1.  <span data-ttu-id="88cb8-148">Chame [**IColumnProvider:: Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) para especificar a pasta que está prestes a ser exibida.</span><span class="sxs-lookup"><span data-stu-id="88cb8-148">Call [**IColumnProvider::Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) to specify the folder that is about to be displayed.</span></span>
2.  <span data-ttu-id="88cb8-149">Chame [**IColumnProvider:: GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) para recuperar o identificador e as características da coluna.</span><span class="sxs-lookup"><span data-stu-id="88cb8-149">Call [**IColumnProvider::GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) to retrieve the column's identifier and characteristics.</span></span>
3.  <span data-ttu-id="88cb8-150">Se a coluna tiver sido selecionada pelo usuário, chame [**IColumnProvider:: GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) para cada arquivo na pasta para recuperar os dados que pertencem à entrada de coluna do arquivo.</span><span class="sxs-lookup"><span data-stu-id="88cb8-150">If the column has been selected by the user, call [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) for each file in the folder to retrieve the data that belongs in the file's column entry.</span></span>

### <a name="the-initialize-method"></a><span data-ttu-id="88cb8-151">O método Initialize</span><span class="sxs-lookup"><span data-stu-id="88cb8-151">The Initialize Method</span></span>

<span data-ttu-id="88cb8-152">O Windows Explorer chama [**IColumnProvider:: Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) para inicializar o manipulador de colunas.</span><span class="sxs-lookup"><span data-stu-id="88cb8-152">Windows Explorer calls [**IColumnProvider::Initialize**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-initialize) to initialize the column handler.</span></span> <span data-ttu-id="88cb8-153">O método tem três parâmetros, mas somente *wszFolder* está sendo usado.</span><span class="sxs-lookup"><span data-stu-id="88cb8-153">The method has three parameters, but only *wszFolder* is currently used.</span></span> <span data-ttu-id="88cb8-154">Ele é definido para a pasta cuja exibição de detalhes está prestes a ser exibida.</span><span class="sxs-lookup"><span data-stu-id="88cb8-154">It is set to the folder whose Details view is about to be displayed.</span></span> <span data-ttu-id="88cb8-155">Armazene o nome da pasta para uso posterior e inicialize o objeto do manipulador conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="88cb8-155">Store the folder name for later use and initialize the handler object as needed.</span></span>

### <a name="the-getcolumninfo-method"></a><span data-ttu-id="88cb8-156">O método GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="88cb8-156">The GetColumnInfo Method</span></span>

<span data-ttu-id="88cb8-157">O Windows Explorer Next chama [**IColumnProvider:: GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) para solicitar o identificador e as características da coluna.</span><span class="sxs-lookup"><span data-stu-id="88cb8-157">Windows Explorer next calls [**IColumnProvider::GetColumnInfo**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getcolumninfo) to request the column's identifier and characteristics.</span></span> <span data-ttu-id="88cb8-158">Ele passa um índice para a coluna no parâmetro *dwIndex* .</span><span class="sxs-lookup"><span data-stu-id="88cb8-158">It passes in an index for the column in the *dwIndex* parameter.</span></span> <span data-ttu-id="88cb8-159">Esse índice é um valor arbitrário que é usado para enumerar colunas.</span><span class="sxs-lookup"><span data-stu-id="88cb8-159">This index is an arbitrary value that is used to enumerate columns.</span></span> <span data-ttu-id="88cb8-160">O Windows Explorer também passa um ponteiro para uma estrutura [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) .</span><span class="sxs-lookup"><span data-stu-id="88cb8-160">Windows Explorer also passes in a pointer to an [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure.</span></span> <span data-ttu-id="88cb8-161">Essa estrutura é usada para retornar o identificador e as características da coluna.</span><span class="sxs-lookup"><span data-stu-id="88cb8-161">This structure is used to return the column's identifier and characteristics.</span></span> <span data-ttu-id="88cb8-162">**IColumnProvider:: GetColumnInfo** deve atribuir valores apropriados aos membros da estrutura e retornar.</span><span class="sxs-lookup"><span data-stu-id="88cb8-162">**IColumnProvider::GetColumnInfo** should assign appropriate values to the members of the structure and return.</span></span>

<span data-ttu-id="88cb8-163">As colunas são identificadas por sua ID de conjunto de propriedades OLE (FMTID) e uma ID de propriedade associada (PID).</span><span class="sxs-lookup"><span data-stu-id="88cb8-163">Columns are identified by their OLE property set ID (FMTID) and an associated property ID (PID).</span></span> <span data-ttu-id="88cb8-164">O primeiro membro da estrutura [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) , **scid**, é um ponteiro para uma estrutura [**SHCOLUMNID**](/windows/desktop/shell/objects) que é usada para identificar a coluna.</span><span class="sxs-lookup"><span data-stu-id="88cb8-164">The first member of the [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure, **scid**, is a pointer to an [**SHCOLUMNID**](/windows/desktop/shell/objects) structure that is used to identify the column.</span></span> <span data-ttu-id="88cb8-165">Seu membro **fmtid** mantém o fmtid da coluna e seu membro **PID** contém o PID da coluna.</span><span class="sxs-lookup"><span data-stu-id="88cb8-165">Its **fmtid** member holds the column's FMTID, and its **pid** member holds the column's PID.</span></span> <span data-ttu-id="88cb8-166">Por exemplo, um par padrão de FMTID/PID que normalmente é usado para identificar colunas é a PID do autor do conjunto de propriedades de informações resumidas.</span><span class="sxs-lookup"><span data-stu-id="88cb8-166">For example, a standard FMTID/PID pair that is commonly used to identify columns is the Author PID of the Summary Information property set.</span></span>

<span data-ttu-id="88cb8-167">Se possível, seu manipulador deve usar FMTIDs e PIDs existentes para identificar a coluna à qual ele dá suporte.</span><span class="sxs-lookup"><span data-stu-id="88cb8-167">If possible, your handler should use existing FMTIDs and PIDs to identify the column it supports.</span></span> <span data-ttu-id="88cb8-168">Se você usar uma estrutura [**SHCOLUMNID**](/windows/desktop/shell/objects) personalizada, a coluna exibirá dados somente para os arquivos com suporte no manipulador.</span><span class="sxs-lookup"><span data-stu-id="88cb8-168">If you use a custom [**SHCOLUMNID**](/windows/desktop/shell/objects) structure, the column will display data only for those files that are supported by the handler.</span></span> <span data-ttu-id="88cb8-169">Se a pasta contiver outros arquivos, suas entradas ficarão em branco.</span><span class="sxs-lookup"><span data-stu-id="88cb8-169">If the folder contains other files, their entries will be blank.</span></span> <span data-ttu-id="88cb8-170">Se uma pasta contiver arquivos de mais de um tipo de arquivo, usar valores padrão de FMTID/PID poderá tornar possível mesclar dados de diferentes tipos na mesma coluna.</span><span class="sxs-lookup"><span data-stu-id="88cb8-170">If a folder contains files from more than one file type, using standard FMTID/PID values could make it possible to merge data from different types into the same column.</span></span>

<span data-ttu-id="88cb8-171">Defina o membro **VT** como o [](/windows/win32/api/oaidl/ns-oaidl-variant)   tipo de variante dos dados que você deseja exibir na coluna.</span><span class="sxs-lookup"><span data-stu-id="88cb8-171">Set the **vt** member to the [**VARIANT**](/windows/win32/api/oaidl/ns-oaidl-variant) type of the data you want to display in the column.</span></span> <span data-ttu-id="88cb8-172">O tipo mais comumente usado é VT \_ LPStr, pois a maioria das colunas exibe seus dados como cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="88cb8-172">The most commonly used type is VT\_LPSTR, as most columns display their data as character strings.</span></span> <span data-ttu-id="88cb8-173">Os membros restantes da estrutura [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) são usados para definir as características da coluna.</span><span class="sxs-lookup"><span data-stu-id="88cb8-173">The remaining members of the [**SHCOLUMNINFO**](/windows/desktop/api/shlobj/ns-shlobj-shcolumninfo) structure are used to define the characteristics of the column.</span></span> <span data-ttu-id="88cb8-174">Atribua valores conforme apropriado.</span><span class="sxs-lookup"><span data-stu-id="88cb8-174">Assign values as appropriate.</span></span>

### <a name="the-getitemdata-method"></a><span data-ttu-id="88cb8-175">O método GetItemData</span><span class="sxs-lookup"><span data-stu-id="88cb8-175">The GetItemData Method</span></span>

<span data-ttu-id="88cb8-176">Se a coluna do manipulador de coluna tiver sido selecionada, o Windows Explorer chamará [**IColumnProvider:: GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) para cada arquivo na pasta a ser exibida.</span><span class="sxs-lookup"><span data-stu-id="88cb8-176">If the column handler's column has been selected, Windows Explorer calls [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) for each file in the folder that is to be displayed.</span></span> <span data-ttu-id="88cb8-177">O parâmetro *pscid* é um ponteiro para uma estrutura [**SHCOLUMNID**](/windows/desktop/shell/objects) que identifica a coluna.</span><span class="sxs-lookup"><span data-stu-id="88cb8-177">The *pscid* parameter is a pointer to an [**SHCOLUMNID**](/windows/desktop/shell/objects) structure that identifies the column.</span></span> <span data-ttu-id="88cb8-178">O parâmetro *pscd* aponta para uma estrutura [**SHCOLUMNDATA**](/windows/desktop/api/shlobj/ns-shlobj-shcolumndata) que identifica o arquivo específico.</span><span class="sxs-lookup"><span data-stu-id="88cb8-178">The *pscd* parameter points to an [**SHCOLUMNDATA**](/windows/desktop/api/shlobj/ns-shlobj-shcolumndata) structure that identifies the particular file.</span></span>

<span data-ttu-id="88cb8-179">O parâmetro *pvarData* retorna os dados que devem ser exibidos na coluna do manipulador para o arquivo especificado por *pscd*.</span><span class="sxs-lookup"><span data-stu-id="88cb8-179">The *pvarData* parameter returns the data that should be displayed in the handler's column for the file specified by *pscd*.</span></span> <span data-ttu-id="88cb8-180">Se esse arquivo for suportado pelo seu manipulador de coluna, atribua seu valor de dados a *pvarData* e retorne S \_ OK.</span><span class="sxs-lookup"><span data-stu-id="88cb8-180">If that file is supported by your column handler, assign its data value to *pvarData* and return S\_OK.</span></span> <span data-ttu-id="88cb8-181">Se o arquivo não tiver suporte do seu manipulador de coluna, retorne S \_ false sem atribuir um valor a *pvarData*.</span><span class="sxs-lookup"><span data-stu-id="88cb8-181">If the file is not supported by your column handler, return S\_FALSE without assigning a value to *pvarData*.</span></span>

<span data-ttu-id="88cb8-182">Várias pastas conterão vários arquivos que não têm suporte em nenhum manipulador de coluna específico.</span><span class="sxs-lookup"><span data-stu-id="88cb8-182">Many folders will contain a number of files that are not supported by any particular column handler.</span></span> <span data-ttu-id="88cb8-183">Para melhorar a eficiência, [**IColumnProvider:: GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) deve primeiro verificar o membro **pwszExt** da estrutura apontada por *pscd*.</span><span class="sxs-lookup"><span data-stu-id="88cb8-183">To improve efficiency, [**IColumnProvider::GetItemData**](/windows/desktop/api/shlobj/nf-shlobj-icolumnprovider-getitemdata) should first check the **pwszExt** member of the structure pointed to by *pscd*.</span></span> <span data-ttu-id="88cb8-184">Esse membro contém a extensão de nome de arquivo.</span><span class="sxs-lookup"><span data-stu-id="88cb8-184">This member holds the file name extension.</span></span> <span data-ttu-id="88cb8-185">Se a extensão indicar que o arquivo não é um membro de um tipo de arquivo com suporte pelo seu manipulador, evite o processamento desnecessário retornando imediatamente S \_ false.</span><span class="sxs-lookup"><span data-stu-id="88cb8-185">If the extension indicates that the file is not a member of a file type supported by your handler, avoid unnecessary processing by immediately returning S\_FALSE.</span></span>

 

 