---
title: Desenvolvendo suplementos de manipulador de protocolo
description: Você pode estender o Microsoft Windows Desktop Search (WDS) para incluir novos armazenamentos de dados implementando um manipulador de protocolo personalizado.
ms.assetid: 2447d95f-5832-453c-8857-3b4f4c158177
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45a8688621f7d2fda653d769c0e1dfdadd240f49
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104499044"
---
# <a name="developing-protocol-handler-add-ins"></a><span data-ttu-id="62eb0-103">Desenvolvendo suplementos de manipulador de protocolo</span><span class="sxs-lookup"><span data-stu-id="62eb0-103">Developing Protocol Handler Add-ins</span></span>

> [!NOTE]
> <span data-ttu-id="62eb0-104">O Windows Desktop Search 2. x é uma tecnologia obsoleta que originalmente estava disponível como um suplemento para o Windows XP e o Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="62eb0-104">Windows Desktop Search 2.x is an obsolete technology that was originally available as an add-in for Windows XP and Windows Server 2003.</span></span> <span data-ttu-id="62eb0-105">Em versões posteriores, use o [Windows Search](../search/-search-3x-wds-overview.md) em vez disso.</span><span class="sxs-lookup"><span data-stu-id="62eb0-105">On later releases, use [Windows Search](../search/-search-3x-wds-overview.md) instead.</span></span>

<span data-ttu-id="62eb0-106">Você pode estender o Microsoft Windows Desktop Search (WDS) para incluir novos armazenamentos de dados implementando um manipulador de protocolo personalizado.</span><span class="sxs-lookup"><span data-stu-id="62eb0-106">You can extend Microsoft Windows Desktop Search (WDS) to include new data stores by implementing a custom protocol handler.</span></span>

## <a name="indexing-data-stores-with-protocol-handlers"></a><span data-ttu-id="62eb0-107">Indexando armazenamentos de dados com manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="62eb0-107">Indexing Data Stores with Protocol Handlers</span></span>

<span data-ttu-id="62eb0-108">Um repositório de dados é uma fonte de conteúdo (um sistema de banco de dado, um diretório, um sistema de arquivos) em que os dados são armazenados e podem ser rastreados pelo indexador do WDS.</span><span class="sxs-lookup"><span data-stu-id="62eb0-108">A data store is a content source (a database system, a directory, a file system) where data is stored and can be crawled by the WDS Indexer.</span></span> <span data-ttu-id="62eb0-109">O repositório pode ser hierárquico (como um banco de dados) ou baseado em link (como um site).</span><span class="sxs-lookup"><span data-stu-id="62eb0-109">The store can be hierarchical (like a database) or link-based (like a website).</span></span> <span data-ttu-id="62eb0-110">Um manipulador de protocolo permite que aplicativos de indexação como o WDS rastreiem sistematicamente os nós de um armazenamento de dados para extrair informações relevantes a serem incluídas no índice.</span><span class="sxs-lookup"><span data-stu-id="62eb0-110">A protocol handler enables indexing applications like WDS to systematically crawl the nodes of a data store to extract relevant information to include in the index.</span></span> <span data-ttu-id="62eb0-111">Cada manipulador de protocolo é usado para indexar um tipo específico de armazenamento de dados.</span><span class="sxs-lookup"><span data-stu-id="62eb0-111">Each protocol handler is used to index a specific type of data store.</span></span> <span data-ttu-id="62eb0-112">O WDS é fornecido com manipuladores de protocolo para armazenamentos do sistema de arquivos e para armazenamentos de dados do Microsoft Outlook e do Microsoft Outlook Express (armazenamentos de emails,. Arquivos PST e assim por diante).</span><span class="sxs-lookup"><span data-stu-id="62eb0-112">WDS ships with protocol handlers for file system stores and for both Microsoft Outlook and Microsoft Outlook Express data stores (email stores, .PST files, and so on).</span></span> <span data-ttu-id="62eb0-113">Ao indexar emails do Outlook, por exemplo, o manipulador de protocolo rastreia todas as mensagens em todas as pastas que extraem informações de cada mensagem e anexo.</span><span class="sxs-lookup"><span data-stu-id="62eb0-113">When indexing Outlook email, for example, the protocol handler crawls all messages in all folders extracting information from each message and attachment.</span></span> <span data-ttu-id="62eb0-114">Essas informações são passadas para o indexador para incluir no catálogo do WDS.</span><span class="sxs-lookup"><span data-stu-id="62eb0-114">This information is passed to the Indexer to include in the WDS catalog.</span></span>

<span data-ttu-id="62eb0-115">Muitas vezes, os usuários precisam pesquisar outros armazenamentos de dados, como bancos de dados herdados, armazenamentos de email ou estruturas de data sem suporte pelo WDS.</span><span class="sxs-lookup"><span data-stu-id="62eb0-115">Often users need to search other data stores such as legacy databases, email stores or data structures not supported by WDS.</span></span> <span data-ttu-id="62eb0-116">Você pode estender o WDS para rastrear um novo armazenamento de dados usando ou implementando um manipulador de protocolo especificamente para esse armazenamento de dados.</span><span class="sxs-lookup"><span data-stu-id="62eb0-116">You can extend WDS to crawl a new data store by using or implementing a protocol handler specifically for that data store.</span></span> <span data-ttu-id="62eb0-117">Primeiro, primeiro você deve determinar se um manipulador de protocolo já existe para seu armazenamento de dados, talvez para uso com outro aplicativo, como os serviços do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="62eb0-117">First, you should first determine if a protocol handler already exists for your data store, perhaps for use with another application like SharePoint Services.</span></span> <span data-ttu-id="62eb0-118">Nesse caso, você pode instalar esse manipulador de protocolo no sistema.</span><span class="sxs-lookup"><span data-stu-id="62eb0-118">If so, you can install that protocol handler on the system.</span></span> <span data-ttu-id="62eb0-119">No entanto, se outro manipulador de protocolo não existir, você precisará implementar um.</span><span class="sxs-lookup"><span data-stu-id="62eb0-119">If, however, another protocol handler does not exist, then you need to implement one.</span></span> <span data-ttu-id="62eb0-120">Os manipuladores de protocolo do WDS usam as mesmas especificações de design que os serviços do SharePoint e, em geral, podem ser usados de maneira intercambiável.</span><span class="sxs-lookup"><span data-stu-id="62eb0-120">WDS protocol handlers use the same design specifications as SharePoint Services, and they can often be used interchangeably.</span></span>

<span data-ttu-id="62eb0-121">Além disso, se o armazenamento de dados contiver dados ou tipos de arquivos diferentes de um dos tipos de arquivo 200 com suporte no WDS, você também precisará implementar um filtro para acessar e indexar o conteúdo dos itens no repositório.</span><span class="sxs-lookup"><span data-stu-id="62eb0-121">Furthermore, if the data store contains data or file types other than one of the 200 file types supported by WDS, you also need to implement a filter to access and index the contents of items in the store.</span></span> <span data-ttu-id="62eb0-122">O WDS 2. x usa o manipulador de protocolo e a tecnologia [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)usada pelos serviços do SharePoint.</span><span class="sxs-lookup"><span data-stu-id="62eb0-122">WDS 2.x uses the protocol handler and [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)technology used by SharePoint Services.</span></span> <span data-ttu-id="62eb0-123">Se você já tiver filtros para um repositório e tipo de arquivo específicos instalados no sistema que está sendo indexado, o WDS usará as interfaces existentes para indexar esses dados.</span><span class="sxs-lookup"><span data-stu-id="62eb0-123">If you already have filters for a specific store and file type installed on the system being indexed, WDS uses the existing interfaces to index this data.</span></span>

 

## <a name="roadmap-to-adding-new-data-stores"></a><span data-ttu-id="62eb0-124">Roteiro para adicionar novos armazenamentos de dados</span><span class="sxs-lookup"><span data-stu-id="62eb0-124">Roadmap to Adding New Data Stores</span></span>

<span data-ttu-id="62eb0-125">Para estender o WDS para rastrear novos armazenamentos de dados, você pode criar um manipulador de protocolo e um ou mais dos seguintes suplementos: manipulador de menu de contexto, manipulador de ícone e um suplemento SearchProtocolOptions.</span><span class="sxs-lookup"><span data-stu-id="62eb0-125">To extend WDS to crawl new data stores, you can create a protocol handler and one or more of the following add-ins: context menu handler, icon handler and a SearchProtocolOptions add-in.</span></span>

1.  <span data-ttu-id="62eb0-126">Criar e registrar um manipulador de protocolo multithread para o armazenamento de dados:</span><span class="sxs-lookup"><span data-stu-id="62eb0-126">Create and register a multithreaded protocol handler for the data store:</span></span>
    -   <span data-ttu-id="62eb0-127">**ISearchProtocol** -essa interface acessa um protocolo e MAPEIA uma URL para um IUrlAccessor.</span><span class="sxs-lookup"><span data-stu-id="62eb0-127">**ISearchProtocol** - This interface accesses a protocol and maps a URL to an IUrlAccessor.</span></span>
    -   <span data-ttu-id="62eb0-128">**IUrlAccessor** -essa é a interface principal usada para acessar itens da fonte de conteúdo e ligar o conteúdo ao filtro apropriado.</span><span class="sxs-lookup"><span data-stu-id="62eb0-128">**IUrlAccessor** - This is the main interface used for accessing items from the content source and binding the content to appropriate filter.</span></span>
    -   <span data-ttu-id="62eb0-129">**IProtocolHandlerSite** -essa interface é usada para solicitar e carregar filtros adicionais.</span><span class="sxs-lookup"><span data-stu-id="62eb0-129">**IProtocolHandlerSite** - This interface is used to request and load additional filters.</span></span>
    -   <span data-ttu-id="62eb0-130">**IFilter** – essa interface retorna a URL de cada item em uma pasta como propriedades de valor para processamento.</span><span class="sxs-lookup"><span data-stu-id="62eb0-130">**IFilter** - This interface returns the URL of each item in a folder as value properties for processing.</span></span>

    > [!Note]
    >
    > <span data-ttu-id="62eb0-131">A funcionalidade de suplemento mínima necessária para retornar os resultados da pesquisa de um armazenamento de dados não hierárquico é uma implementação das interfaces ISearchProtocol e IUrlAccessor.</span><span class="sxs-lookup"><span data-stu-id="62eb0-131">The minimum add-in functionality needed to return search results from a non-hierarchical data store is an implementation of ISearchProtocol and IUrlAccessor interfaces.</span></span>

     

2.  <span data-ttu-id="62eb0-132">Implemente a interface ISearchProtocolOptions para incluir opções de manipulador de protocolo personalizadas, como páginas de início predefinidas:</span><span class="sxs-lookup"><span data-stu-id="62eb0-132">Implement the ISearchProtocolOptions interface to include customized protocol handler options, like predefined start page(s):</span></span>
    -   <span data-ttu-id="62eb0-133">**ISearchProtocolOptions** -essa interface define as URLs padrão para o manipulador de protocolo para processar, determina quais são os requisitos para um manipulador de protocolo e determina se os requisitos foram atendidos em determinado sistema.</span><span class="sxs-lookup"><span data-stu-id="62eb0-133">**ISearchProtocolOptions** - This interface defines default URLs for the protocol handler to process, determines what the requirements are for a protocol handler, and determines whether the requirements have been met on a given system.</span></span>
3.  <span data-ttu-id="62eb0-134">Estenda o Shell para incluir elementos da interface do usuário, como menus de contexto e ícones específicos de arquivo, implementando as seguintes interfaces:</span><span class="sxs-lookup"><span data-stu-id="62eb0-134">Extend Shell to include user interface elements, like context menus and file-specific icons, by implementing the following interfaces:</span></span>
    -   <span data-ttu-id="62eb0-135">**IShellFolder** -essa interface, que é usada para gerenciar pastas, é necessária para fornecer as interfaces IContextMenu e IExtractIcon para uma URL em um novo repositório.</span><span class="sxs-lookup"><span data-stu-id="62eb0-135">**IShellFolder** - This interface, which is used to manage folders, is required to provide the IContextMenu and IExtractIcon interfaces for a URL in a new store.</span></span>
    -   <span data-ttu-id="62eb0-136">**IPersistFolder** -essa interface é necessária para instruir um objeto de pasta do Shell a se inicializar.</span><span class="sxs-lookup"><span data-stu-id="62eb0-136">**IPersistFolder** - This interface is required to instruct a Shell folder object to initialize itself.</span></span>
    -   <span data-ttu-id="62eb0-137">**IPersist** -essa interface fornece o identificador de classe (CLSID) de um objeto que pode ser armazenado de forma persistente no sistema.</span><span class="sxs-lookup"><span data-stu-id="62eb0-137">**IPersist** - This interface supplies the class identifier (CLSID) of an object that can be stored persistently in the system.</span></span>
    -   <span data-ttu-id="62eb0-138">**IContextMenu** -essa interface define o menu de contexto de clique com o botão direito do mouse para um item apontado por URL.</span><span class="sxs-lookup"><span data-stu-id="62eb0-138">**IContextMenu** - This interface defines the right-click context menu for an item pointed to by URL.</span></span>
    -   <span data-ttu-id="62eb0-139">**IExtractIcon** -essa interface define o ícone a ser exibido para um item apontado por URL.</span><span class="sxs-lookup"><span data-stu-id="62eb0-139">**IExtractIcon** - This interface defines the icon to display for an item pointed to by URL.</span></span>
4.  <span data-ttu-id="62eb0-140">Implemente um mecanismo para notificar o indexador de alterações no armazenamento de dados:</span><span class="sxs-lookup"><span data-stu-id="62eb0-140">Implement a mechanism to notify the Indexer of changes to your data store:</span></span>
    -   <span data-ttu-id="62eb0-141">**ISearchItemsChangedSink** -essa interface permite que o manipulador de protocolo notifique o índice de alterações no armazenamento de dados.</span><span class="sxs-lookup"><span data-stu-id="62eb0-141">**ISearchItemsChangedSink** - This interface enables your protocol handler to notify the Index of changes to your data store.</span></span> <span data-ttu-id="62eb0-142">Isso melhora o desempenho garantindo que o indexador não rastreie todo o armazenamento em índices incrementais.</span><span class="sxs-lookup"><span data-stu-id="62eb0-142">This improves performance by ensuring the Indexer doesn't crawl the entire store on incremental indexes.</span></span>

## <a name="related-topics"></a><span data-ttu-id="62eb0-143">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="62eb0-143">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="62eb0-144">**Referência**</span><span class="sxs-lookup"><span data-stu-id="62eb0-144">**Reference**</span></span>
</dt> <dt>

[<span data-ttu-id="62eb0-145">Implementando um manipulador de protocolo para o WDS</span><span class="sxs-lookup"><span data-stu-id="62eb0-145">Implementing a Protocol Handler for WDS</span></span>](-search-2x-wds-phimplementing.md)
</dt> <dt>

[<span data-ttu-id="62eb0-146">Adicionando ícones, visualizações e menus de contexto com extensões de Shell</span><span class="sxs-lookup"><span data-stu-id="62eb0-146">Adding Icons, Previews, and Context Menus with Shell Extensions</span></span>](-search-2x-wds-ph-ui-extensions.md)
</dt> <dt>

[<span data-ttu-id="62eb0-147">Notificando o índice das alterações</span><span class="sxs-lookup"><span data-stu-id="62eb0-147">Notifying the Index of Changes</span></span>](-search-2x-wds-notifyingofchanges.md)
</dt> <dt>

[<span data-ttu-id="62eb0-148">Instalando e Registrando manipuladores de protocolo</span><span class="sxs-lookup"><span data-stu-id="62eb0-148">Installing and Registering Protocol Handlers</span></span>](-search-2x-wds-ph-install-registration.md)
</dt> </dl>

 

 