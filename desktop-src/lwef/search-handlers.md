---
title: Criando manipuladores de pesquisa
description: O Shell dá suporte a vários utilitários de pesquisa que permitem aos usuários localizar objetos de namespace, como arquivos ou impressoras. Você pode criar um mecanismo de pesquisa personalizado e torná-lo disponível para os usuários implementando e registrando um manipulador de pesquisa.
ms.assetid: ffd023bb-16ab-43ce-b00b-5e32656c8013
keywords:
- manipuladores de pesquisa
- registrar, manipuladores de pesquisa
- manipuladores de pesquisa estáticos
- registrar, manipuladores de pesquisa estáticos
- manipuladores de pesquisa dinâmica
- registrar, manipuladores de pesquisa dinâmica
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e6476109302a176822137747353b2762b0caea8a
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/19/2020
ms.locfileid: "104294026"
---
# <a name="creating-search-handlers"></a><span data-ttu-id="daf02-110">Criando manipuladores de pesquisa</span><span class="sxs-lookup"><span data-stu-id="daf02-110">Creating Search Handlers</span></span>

<span data-ttu-id="daf02-111">\[Esse recurso tem suporte apenas no Windows XP ou anterior.</span><span class="sxs-lookup"><span data-stu-id="daf02-111">\[This feature is supported only under Windows XP or earlier.</span></span> <span data-ttu-id="daf02-112">Em vez disso, use o Windows Search.\]</span><span class="sxs-lookup"><span data-stu-id="daf02-112">Use Windows Search instead.\]</span></span>

<span data-ttu-id="daf02-113">O Shell dá suporte a vários utilitários de pesquisa que permitem aos usuários localizar objetos de namespace, como arquivos ou impressoras.</span><span class="sxs-lookup"><span data-stu-id="daf02-113">The Shell supports several search utilities that allow users to locate namespace objects such as files or printers.</span></span> <span data-ttu-id="daf02-114">Você pode criar um mecanismo de pesquisa personalizado e torná-lo disponível para os usuários implementando e registrando um *manipulador de pesquisa*.</span><span class="sxs-lookup"><span data-stu-id="daf02-114">You can create a custom search engine and make it available to users by implementing and registering a *search handler*.</span></span>

<span data-ttu-id="daf02-115">Os procedimentos gerais para implementar e registrar um manipulador de extensão de shell são discutidos na [criação de manipuladores de extensão de shell](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="daf02-115">The general procedures for implementing and registering a Shell extension handler are discussed in [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span> <span data-ttu-id="daf02-116">Este documento se concentra nesses aspectos da implementação que são específicos para os manipuladores de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="daf02-116">This document focuses on those aspects of implementation that are specific to search handlers.</span></span>

-   [<span data-ttu-id="daf02-117">Como funcionam os manipuladores de pesquisa</span><span class="sxs-lookup"><span data-stu-id="daf02-117">How Search Handlers Work</span></span>](#how-search-handlers-work)
-   [<span data-ttu-id="daf02-118">Registrando manipuladores de pesquisa</span><span class="sxs-lookup"><span data-stu-id="daf02-118">Registering Search Handlers</span></span>](#registering-search-handlers)
    -   [<span data-ttu-id="daf02-119">Registrando um manipulador de pesquisa estático</span><span class="sxs-lookup"><span data-stu-id="daf02-119">Registering a Static Search Handler</span></span>](#registering-a-static-search-handler)
    -   [<span data-ttu-id="daf02-120">Registrando um manipulador de pesquisa dinâmica</span><span class="sxs-lookup"><span data-stu-id="daf02-120">Registering a Dynamic Search Handler</span></span>](#registering-a-dynamic-search-handler)
-   [<span data-ttu-id="daf02-121">Implementando manipuladores de pesquisa</span><span class="sxs-lookup"><span data-stu-id="daf02-121">Implementing Search Handlers</span></span>](#implementing-search-handlers)

## <a name="how-search-handlers-work"></a><span data-ttu-id="daf02-122">Como funcionam os manipuladores de pesquisa</span><span class="sxs-lookup"><span data-stu-id="daf02-122">How Search Handlers Work</span></span>

<span data-ttu-id="daf02-123">Os usuários têm duas maneiras de selecionar um mecanismo de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="daf02-123">Users have two ways to select a search engine.</span></span> <span data-ttu-id="daf02-124">A primeira maneira é a partir do menu iniciar.</span><span class="sxs-lookup"><span data-stu-id="daf02-124">The first way is from the Start menu.</span></span> <span data-ttu-id="daf02-125">Com sistemas anteriores ao Windows 2000, selecionar o comando **Localizar** no menu **Iniciar** exibe um submenu dos mecanismos de pesquisa disponíveis.</span><span class="sxs-lookup"><span data-stu-id="daf02-125">With systems earlier than Windows 2000, selecting the **Find** command on the **Start** menu displays a submenu of the available search engines.</span></span> <span data-ttu-id="daf02-126">Com o Windows 2000 e posterior, o comando **Find** do menu de arte **St** é renomeado como pesquisa.</span><span class="sxs-lookup"><span data-stu-id="daf02-126">With Windows 2000 and later, the **St** art menu's **Find** command is renamed Search.</span></span> <span data-ttu-id="daf02-127">A ilustração a seguir mostra o botão de **pesquisa** em um sistema Windows XP.</span><span class="sxs-lookup"><span data-stu-id="daf02-127">The following illustration shows the **Search** button on a Windows XP system.</span></span>

![o submenu Pesquisar do menu iniciar](images/searchhandler1.jpg)

<span data-ttu-id="daf02-129">Os usuários também podem iniciar uma pesquisa no Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="daf02-129">Users can also launch a search from Windows Explorer.</span></span> <span data-ttu-id="daf02-130">Em sistemas anteriores ao Windows 2000, eles clicam no comando **Localizar** no menu **ferramentas** para exibir essencialmente o mesmo menu como aquele associado ao menu **Iniciar** .</span><span class="sxs-lookup"><span data-stu-id="daf02-130">On systems earlier than Windows 2000, they click the **Find** command on the **Tools** menu to display essentially the same menu as the one associated with the **Start** menu.</span></span> <span data-ttu-id="daf02-131">No entanto, o Windows Explorer para Windows 2000 lida com mecanismos de pesquisa de uma maneira muito diferente.</span><span class="sxs-lookup"><span data-stu-id="daf02-131">However, Windows Explorer for Windows 2000 handles search engines in a very different way.</span></span> <span data-ttu-id="daf02-132">Em vez de manipular mecanismos de pesquisa como um submenu do menu **ferramentas** , agora há um botão **Pesquisar** na barra de ferramentas.</span><span class="sxs-lookup"><span data-stu-id="daf02-132">Instead of handling search engines as a submenu of the **Tools** menu, there is now a **Search** button on the toolbar.</span></span> <span data-ttu-id="daf02-133">Clicar nesse botão abre o painel de **pesquisa** da barra do Explorer.</span><span class="sxs-lookup"><span data-stu-id="daf02-133">Clicking this button opens the Explorer bar's **Search** pane.</span></span> <span data-ttu-id="daf02-134">A ilustração a seguir mostra o painel pesquisa **de arquivos e pastas** .</span><span class="sxs-lookup"><span data-stu-id="daf02-134">The following illustration shows the **Search For Files And Folders** search pane.</span></span>

![painel de pesquisa da barra do Windows Explorer](images/searchhandler2.jpg)

<span data-ttu-id="daf02-136">Há várias diferenças em como o Windows 2000 e sistemas anteriores gerenciam manipuladores de pesquisa que afetam a implementação e o registro.</span><span class="sxs-lookup"><span data-stu-id="daf02-136">There are a number of differences in how Windows 2000 and earlier systems manage search handlers that affect both implementation and registration.</span></span>



| <span data-ttu-id="daf02-137">Pré-Windows 2000</span><span class="sxs-lookup"><span data-stu-id="daf02-137">Pre-Windows 2000</span></span>                                                                                                                                                                                                       | <span data-ttu-id="daf02-138">Windows 2000 e posterior</span><span class="sxs-lookup"><span data-stu-id="daf02-138">Windows 2000 and later</span></span>                                                                                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="daf02-139">Os manipuladores de pesquisa são implementados como um tipo de [manipulador de menu de atalho](/windows/desktop/shell/context-menu-handlers).</span><span class="sxs-lookup"><span data-stu-id="daf02-139">Search handlers are implemented as a type of [shortcut menu handler](/windows/desktop/shell/context-menu-handlers).</span></span>                                                                                                                     | <span data-ttu-id="daf02-140">Os manipuladores de pesquisa podem ser implementados como manipuladores de menu de atalho ou como documentos HTML dinâmico (DHTML).</span><span class="sxs-lookup"><span data-stu-id="daf02-140">Search handlers can be implemented as shortcut menu handlers, or as Dynamic HTML (DHTML) documents.</span></span>                                                                                                                                                                                                               |
| <span data-ttu-id="daf02-141">Os manipuladores de pesquisa podem ser estáticos ou dinâmicos.</span><span class="sxs-lookup"><span data-stu-id="daf02-141">Search handlers can be either static or dynamic.</span></span> <span data-ttu-id="daf02-142">Manipuladores estáticos são carregados somente quando são selecionados pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="daf02-142">Static handlers are loaded only when they are selected by the user.</span></span> <span data-ttu-id="daf02-143">Os manipuladores dinâmicos são carregados pelo shell na inicialização e não são encerrados até que o Shell saia.</span><span class="sxs-lookup"><span data-stu-id="daf02-143">Dynamic handlers are loaded by the Shell at startup and are not terminated until the Shell exits.</span></span> | <span data-ttu-id="daf02-144">Os manipuladores implementados como manipuladores de menu de atalho podem ser estáticos ou dinâmicos.</span><span class="sxs-lookup"><span data-stu-id="daf02-144">Handlers implemented as shortcut menu handlers can be either static or dynamic.</span></span> <span data-ttu-id="daf02-145">Os manipuladores implementados como documentos DHTML devem ser estáticos.</span><span class="sxs-lookup"><span data-stu-id="daf02-145">Handlers implemented as DHTML documents must be static.</span></span>                                                                                                                                                                           |
| <span data-ttu-id="daf02-146">Os manipuladores de pesquisa são exibidos no submenu **Localizar** do menu **Iniciar** e no submenu **Localizar** do menu  **ferramentas** do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="daf02-146">Search handlers appear on the **Find** submenu of the **Start** menu and the **Find** submenu of the Windows Explorer **Tools** menu.</span></span>                                                                                  | <span data-ttu-id="daf02-147">Os manipuladores de pesquisa aparecem apenas no submenu **Pesquisar** do menu **Iniciar** .</span><span class="sxs-lookup"><span data-stu-id="daf02-147">Search handlers appear only on the **Search** submenu of the **Start** menu.</span></span> <span data-ttu-id="daf02-148">Para disponibilizar um painel de pesquisa personalizado por meio da barra de menus do Windows Explorer, você deve implementá-lo como um [objeto de faixa](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="daf02-148">To make a custom search pane available through the Windows Explorer menu bar, you must implement it as a [band object](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span></span> <span data-ttu-id="daf02-149">Em seguida, ele é listado no submenu **barra do Explorer** do menu  **Exibir** do Windows Explorer.</span><span class="sxs-lookup"><span data-stu-id="daf02-149">It is then listed on the **Explorer Bar** submenu of the Windows Explorer **View** menu.</span></span> |



 

## <a name="registering-search-handlers"></a><span data-ttu-id="daf02-150">Registrando manipuladores de pesquisa</span><span class="sxs-lookup"><span data-stu-id="daf02-150">Registering Search Handlers</span></span>

<span data-ttu-id="daf02-151">Os manipuladores de pesquisa são registrados na subchave **FindExtensions** dos tipos de arquivo.</span><span class="sxs-lookup"><span data-stu-id="daf02-151">Search handlers are registered under the file types's **FindExtensions** subkey.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
```

<span data-ttu-id="daf02-152">A partir desse ponto, o procedimento de registro depende se o manipulador deve ser estático ou dinâmico.</span><span class="sxs-lookup"><span data-stu-id="daf02-152">From this point, the registration procedure depends on whether the handler is to be static or dynamic.</span></span> <span data-ttu-id="daf02-153">Para obter uma discussão geral sobre como registrar manipuladores de extensão de Shell, consulte [criando manipuladores de extensão de shell](/windows/desktop/shell/handlers).</span><span class="sxs-lookup"><span data-stu-id="daf02-153">For a general discussion of how to register Shell extension handlers, see [Creating Shell Extension Handlers](/windows/desktop/shell/handlers).</span></span>

### <a name="registering-a-static-search-handler"></a><span data-ttu-id="daf02-154">Registrando um manipulador de pesquisa estático</span><span class="sxs-lookup"><span data-stu-id="daf02-154">Registering a Static Search Handler</span></span>

<span data-ttu-id="daf02-155">Os manipuladores de pesquisa estáticos são carregados somente quando são iniciados pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="daf02-155">Static search handlers are loaded only when they are launched by the user.</span></span> <span data-ttu-id="daf02-156">Essa abordagem funciona melhor para DLLs que são pequenas e podem ser carregadas rapidamente.</span><span class="sxs-lookup"><span data-stu-id="daf02-156">This approach works best for DLLs that are small and can be loaded quickly.</span></span> <span data-ttu-id="daf02-157">Se você estiver usando o DHTML para implementar seu manipulador, ele deverá ser estático.</span><span class="sxs-lookup"><span data-stu-id="daf02-157">If you are using DHTML to implement your handler, it must be static.</span></span> <span data-ttu-id="daf02-158">Para registrar um manipulador de extensão estático, crie uma subchave chamada para o manipulador sob a subchave **estática** da subchave **FindExtensions** .</span><span class="sxs-lookup"><span data-stu-id="daf02-158">To register a static extension handler, create a subkey named for the handler under the **Static** subkey of the **FindExtensions** subkey.</span></span> <span data-ttu-id="daf02-159">O nome não é usado pelo sistema, mas não deve ser idêntico a outros nomes de manipuladores de pesquisa na subchave **FindExtensions** .</span><span class="sxs-lookup"><span data-stu-id="daf02-159">The name is not used by the system, but it must not be identical to other search handler names under the **FindExtensions** subkey.</span></span>

### <a name="shortcut-menu-based-search-handlers"></a><span data-ttu-id="daf02-160">Manipuladores de pesquisa baseados em menu de atalho</span><span class="sxs-lookup"><span data-stu-id="daf02-160">Shortcut menu-based search handlers</span></span>

<span data-ttu-id="daf02-161">Se o manipulador for implementado como um [manipulador de menu de atalho](/windows/desktop/shell/context-menu-handlers), defina o valor padrão da subchave Name do manipulador para o GUID do identificador de classe (CLSID) do objeto.</span><span class="sxs-lookup"><span data-stu-id="daf02-161">If your handler is implemented as a [shortcut menu handler](/windows/desktop/shell/context-menu-handlers), set the default value of the handler's name subkey to the object's class identifier (CLSID) GUID.</span></span> <span data-ttu-id="daf02-162">Na subchave Name do manipulador, crie uma subchave chamada **0**   (zero) e defina seu valor padrão como a cadeia de caracteres que será exibida no submenu **Pesquisar** ou **Localizar** .</span><span class="sxs-lookup"><span data-stu-id="daf02-162">Under the handler's name subkey, create a subkey named **0** (zero) and set its default value to the string that will be displayed in the **Search** or **Find** submenu.</span></span> <span data-ttu-id="daf02-163">Você pode habilitar atalhos de teclado da maneira usual, precedendo o caractere de atalho com um e comercial (&).</span><span class="sxs-lookup"><span data-stu-id="daf02-163">You can enable keyboard shortcuts in the usual way, by preceding the shortcut character with an ampersand (&).</span></span> <span data-ttu-id="daf02-164">Você pode ter um ícone pequeno opcional exibido à direita do texto do menu criando uma subchave **DefaultIcon** na subchave **0** .</span><span class="sxs-lookup"><span data-stu-id="daf02-164">You can have an optional small icon displayed to the right of the menu text by creating a **DefaultIcon** subkey under the **0** subkey.</span></span> <span data-ttu-id="daf02-165">Defina seu valor padrão como uma cadeia de caracteres que contém o caminho do arquivo que contém o ícone, seguido por uma vírgula, seguido pelo índice de base zero do ícone.</span><span class="sxs-lookup"><span data-stu-id="daf02-165">Set its default value to a string containing the path of the file containing the icon, followed by a comma, followed by the icon's zero-based index.</span></span>

<span data-ttu-id="daf02-166">O exemplo a seguir registra o manipulador de pesquisa **MySearchEngine** .</span><span class="sxs-lookup"><span data-stu-id="daf02-166">The following example registers the **MySearchEngine** search handler.</span></span> <span data-ttu-id="daf02-167">O texto do menu é "meu mecanismo de pesquisa", com M especificado como a tecla de atalho.</span><span class="sxs-lookup"><span data-stu-id="daf02-167">The menu text is "My Search Engine", with M specified as the shortcut key.</span></span> <span data-ttu-id="daf02-168">O ícone está em C: \\ MyDir \\MySearch.dll, com um índice de 2.</span><span class="sxs-lookup"><span data-stu-id="daf02-168">The icon is in C:\\MyDir\\MySearch.dll, with an index of 2.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     Static
                        MySearchEngine
                           (Default) = {MySearchEngine CLSID GUID}
                           0
                              (Default) = &My Search Engine
                              DefaultIcon
                                 (Default) = c:\MyDir\MySearch.dll,2
```

### <a name="dhtml-based-search-handlers"></a><span data-ttu-id="daf02-169">Manipuladores de pesquisa baseados em DHTML</span><span class="sxs-lookup"><span data-stu-id="daf02-169">DHTML-based search handlers</span></span>

<span data-ttu-id="daf02-170">Com o Windows 2000, você também pode implementar um manipulador de pesquisa como um documento DHTML.</span><span class="sxs-lookup"><span data-stu-id="daf02-170">With Windows 2000, you can also implement a search handler as a DHTML document.</span></span> <span data-ttu-id="daf02-171">Seu nome está listado no submenu **Pesquisar** do menu **Iniciar** .</span><span class="sxs-lookup"><span data-stu-id="daf02-171">Its name is listed in the **Search** submenu of the **Start** menu.</span></span> <span data-ttu-id="daf02-172">Quando o usuário o seleciona, ele inicia o Windows Explorer com a barra do Explorer aberta no documento de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="daf02-172">When the user selects it, it launches Windows Explorer with the Explorer bar opened to the search document.</span></span> <span data-ttu-id="daf02-173">Você também pode especificar um documento DHTML a ser exibido à direita da barra do Explorer.</span><span class="sxs-lookup"><span data-stu-id="daf02-173">You can also specify a DHTML document to be displayed to the right of the Explorer bar.</span></span> <span data-ttu-id="daf02-174">Não é possível iniciar um manipulador diferente no painel de pesquisa padrão.</span><span class="sxs-lookup"><span data-stu-id="daf02-174">There is no way to launch a different handler from the default Search pane.</span></span> <span data-ttu-id="daf02-175">Os mecanismos de pesquisa podem ser iniciados diretamente do Windows Explorer, mas somente se forem implementados como [objetos de faixa](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="daf02-175">Search engines can be launched directly from Windows Explorer, but only if they are implemented as as [band objects](/previous-versions/windows/desktop/legacy/cc144099(v=vs.85)).</span></span>

<span data-ttu-id="daf02-176">Para registrar um manipulador de pesquisa baseado em DHTML, defina a subchave Name do manipulador como a forma de cadeia de caracteres de CLSID \_ ShellSearchExt (atualmente, {169A0691-8DF9-11D1-A1C4-00C04FD75D13}) e crie as seguintes subchaves.</span><span class="sxs-lookup"><span data-stu-id="daf02-176">To register a DHTML-based search handler, set the handler's name subkey to the string form of CLSID\_ShellSearchExt (currently {169A0691-8DF9-11d1-A1C4-00C04FD75D13}) and create the following subkeys.</span></span>

1.  <span data-ttu-id="daf02-177">Crie uma subchave **0**(zero) na subchave de nome do manipulador e defina seu valor padrão como o texto do menu.</span><span class="sxs-lookup"><span data-stu-id="daf02-177">Create a **0**(zero) subkey under the handler name subkey and set its default value to the menu text.</span></span>
2.  <span data-ttu-id="daf02-178">Para que um ícone seja exibido ao lado do texto do menu, crie uma subchave **DefaultIcon** em **0** e defina seu valor padrão como o caminho e o índice do ícone.</span><span class="sxs-lookup"><span data-stu-id="daf02-178">To have an icon displayed next to the menu text, create a **DefaultIcon** subkey under **0** and set its default value to the icon's path and index.</span></span>
3.  <span data-ttu-id="daf02-179">Crie uma subchave **SearchGUID** em **0**.</span><span class="sxs-lookup"><span data-stu-id="daf02-179">Create a **SearchGUID** subkey under **0**.</span></span> <span data-ttu-id="daf02-180">Atribua um GUID ao documento DHTML e defina o valor padrão de **SearchGUID** para seu formulário de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="daf02-180">Assign a GUID to the DHTML document and set the default value of **SearchGUID** to its string form.</span></span> <span data-ttu-id="daf02-181">Este GUID não precisa ser registrado em **HKEY \_ classes \_ raiz \\ CLSID**.</span><span class="sxs-lookup"><span data-stu-id="daf02-181">This GUID does not need to be registered under **HKEY\_CLASSES\_ROOT\\CLSID**.</span></span>
4.  <span data-ttu-id="daf02-182">Crie uma subchave de **URL** em **SearchGUID**.</span><span class="sxs-lookup"><span data-stu-id="daf02-182">Create a **Url** subkey under **SearchGUID**.</span></span> <span data-ttu-id="daf02-183">Defina seu valor padrão como o caminho do documento HTML que aparecerá na barra do Explorer.</span><span class="sxs-lookup"><span data-stu-id="daf02-183">Set its default value to the path of the HTML document that will appear in the Explorer bar.</span></span>
5.  <span data-ttu-id="daf02-184">Crie uma subchave **UrlNavNew** em **SearchGUID**.</span><span class="sxs-lookup"><span data-stu-id="daf02-184">Create a **UrlNavNew** subkey under **SearchGUID**.</span></span> <span data-ttu-id="daf02-185">Defina seu valor padrão como o caminho do documento HTML que será exibido à direita da barra do Explorer.</span><span class="sxs-lookup"><span data-stu-id="daf02-185">Set its default value to the path of the HTML document that will appear to the right of the Explorer bar.</span></span>

<span data-ttu-id="daf02-186">O exemplo a seguir registra o manipulador de pesquisa **MySearchEngine** implementado como um documento DHTML.</span><span class="sxs-lookup"><span data-stu-id="daf02-186">The following example registers the **MySearchEngine** search handler implemented as a DHTML document.</span></span> <span data-ttu-id="daf02-187">O texto do menu é "meu mecanismo de pesquisa", com M especificado como a tecla de atalho.</span><span class="sxs-lookup"><span data-stu-id="daf02-187">The menu text is "My Search Engine", with M specified as the shortcut key.</span></span> <span data-ttu-id="daf02-188">O ícone está em C: \\ MyDir \\MySearch.dll, com um índice de 2.</span><span class="sxs-lookup"><span data-stu-id="daf02-188">The icon is in C:\\MyDir\\MySearch.dll, with an index of 2.</span></span> <span data-ttu-id="daf02-189">O documento DHTML da barra do Explorer é C: \\ MyDir \\MySearch.htm e o documento que será exibido à direita da barra do Explorer é c: \\ mydir \\MySearchPage.htm.</span><span class="sxs-lookup"><span data-stu-id="daf02-189">The Explorer bar's DHTML document is C:\\MyDir\\MySearch.htm, and the document that will be displayed to the right of the Explorer bar is C:\\MyDir\\MySearchPage.htm.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     Static
                        MySearchEngine
                           (Default) = {169A0691-8DF9-11d1-A1C4-00C04FD75D13}
                           0
                              (Default) = &My Search Engine
                              DefaultIcon
                                 (Default) = c:\MyDir\MySearch.dll,2
                                 SearchGUID
                                    (Default) = {My Search GUID}
                                    Url
                                       (Default) = C:\MyDir\MySearch.htm
                                    UrlNavNew
                                       (Default) = C:\MyDir\MySearchPage.htm
```

### <a name="registering-a-dynamic-search-handler"></a><span data-ttu-id="daf02-190">Registrando um manipulador de pesquisa dinâmica</span><span class="sxs-lookup"><span data-stu-id="daf02-190">Registering a Dynamic Search Handler</span></span>

<span data-ttu-id="daf02-191">Se o manipulador for implementado como um [manipulador de menu de atalho](/windows/desktop/shell/context-menu-handlers), você também poderá registrá-lo como um manipulador dinâmico.</span><span class="sxs-lookup"><span data-stu-id="daf02-191">If your handler is implemented as a [shortcut menu handler](/windows/desktop/shell/context-menu-handlers), you can also register it as a dynamic handler.</span></span> <span data-ttu-id="daf02-192">Nesse caso, ele será carregado com o Shell e será encerrado somente quando o Shell for encerrado.</span><span class="sxs-lookup"><span data-stu-id="daf02-192">In that case, it will be loaded with the Shell and will terminate only when the Shell exits.</span></span> <span data-ttu-id="daf02-193">Os manipuladores de pesquisa dinâmica respondem muito mais rapidamente do que os manipuladores estáticos quando são iniciados pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="daf02-193">Dynamic search handlers respond much more quickly than static handlers when they are launched by the user.</span></span> <span data-ttu-id="daf02-194">Essa abordagem funciona melhor se a DLL do manipulador pode demorar muito tempo para ser carregada ou se for provável que seja chamada com frequência.</span><span class="sxs-lookup"><span data-stu-id="daf02-194">This approach works best if your handler's DLL might take a long time to load, or if it is likely to be called frequently.</span></span>

<span data-ttu-id="daf02-195">Os manipuladores de pesquisa dinâmica são registrados na subchave **FindExtensions** .</span><span class="sxs-lookup"><span data-stu-id="daf02-195">Dynamic search handlers are registered under the **FindExtensions** subkey.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
```

<span data-ttu-id="daf02-196">Crie uma subchave de **FindExtensions** chamada para o manipulador e defina seu valor padrão para o GUID CLSID do manipulador.</span><span class="sxs-lookup"><span data-stu-id="daf02-196">Create a subkey of **FindExtensions** named for the handler, and set its default value to the handler's CLSID GUID.</span></span> <span data-ttu-id="daf02-197">Os ícones de menu não têm suporte para manipuladores de pesquisa dinâmica.</span><span class="sxs-lookup"><span data-stu-id="daf02-197">Menu icons are not supported for dynamic search handlers.</span></span> <span data-ttu-id="daf02-198">O exemplo a seguir registra MySearchEngine como um manipulador de pesquisa dinâmica.</span><span class="sxs-lookup"><span data-stu-id="daf02-198">The following example registers MySearchEngine as a dynamic search handler.</span></span>

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  FindExtensions
                     MySearchEngine
                        (Default) = {MySearchEngine CLSID GUID}
                        0
                           (Default) = &My Search Engine
```

<span data-ttu-id="daf02-199">Ao contrário dos manipuladores de pesquisa estáticos, você não especifica o texto do menu no registro.</span><span class="sxs-lookup"><span data-stu-id="daf02-199">Unlike static search handlers, you do not specify the menu text in the registry.</span></span> <span data-ttu-id="daf02-200">Quando o manipulador for carregado, o Shell chamará o método [**IContextMenu:: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) do manipulador para adicionar itens ao submenu **Localizar** ou **Pesquisar** .</span><span class="sxs-lookup"><span data-stu-id="daf02-200">When the handler is loaded, the Shell will call the handler's [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) method to add items to the **Find** or **Search** submenu.</span></span>

## <a name="implementing-search-handlers"></a><span data-ttu-id="daf02-201">Implementando manipuladores de pesquisa</span><span class="sxs-lookup"><span data-stu-id="daf02-201">Implementing Search Handlers</span></span>

<span data-ttu-id="daf02-202">Os manipuladores de pesquisa podem ser implementados como manipuladores de menu de atalho para todas as versões do Windows.</span><span class="sxs-lookup"><span data-stu-id="daf02-202">Search handlers can be implemented as shortcut menu handlers for all versions of Windows.</span></span> <span data-ttu-id="daf02-203">Para o Windows 2000, eles também podem ser implementados como documentos DHTML.</span><span class="sxs-lookup"><span data-stu-id="daf02-203">For Windows 2000, they can also be implemented as DHTML documents.</span></span>

<span data-ttu-id="daf02-204">Para obter uma discussão geral sobre como implementar manipuladores de menu de atalho, consulte [criando manipuladores de menu de contexto](/windows/desktop/shell/context-menu-handlers).</span><span class="sxs-lookup"><span data-stu-id="daf02-204">For a general discussion of how to implement shortcut menu handlers, see [Creating Context Menu Handlers](/windows/desktop/shell/context-menu-handlers).</span></span> <span data-ttu-id="daf02-205">Os manipuladores de pesquisa diferem dos manipuladores de menu de atalho padrão de apenas algumas maneiras.</span><span class="sxs-lookup"><span data-stu-id="daf02-205">Search handlers differ from standard shortcut menu handlers in only a few ways.</span></span>

<span data-ttu-id="daf02-206">Para manipuladores de menu estático, o submenu **Localizar** ou **Pesquisar** é criado com base nas informações no registro.</span><span class="sxs-lookup"><span data-stu-id="daf02-206">For static menu handlers, the **Find** or **Search** submenu is created from the information in the registry.</span></span> <span data-ttu-id="daf02-207">Não é necessário que o manipulador adicione um item de menu, uma vez que um manipulador de menu de atalho normal faria.</span><span class="sxs-lookup"><span data-stu-id="daf02-207">There is no need to have the handler add a menu item, as a normal shortcut menu handler would.</span></span> <span data-ttu-id="daf02-208">O Shell gerencia manipuladores de menu estáticos da seguinte maneira.</span><span class="sxs-lookup"><span data-stu-id="daf02-208">The Shell manages static menu handlers in the following way.</span></span>

-   <span data-ttu-id="daf02-209">Quando o usuário inicia o item de menu do manipulador, o Shell carrega a DLL do manipulador e chama [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) para notificar o manipulador para iniciar o mecanismo de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="daf02-209">When the user launches the handler's menu item, the Shell loads the handler's DLL and calls [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) to notify the handler to launch the search engine.</span></span> <span data-ttu-id="daf02-210">Os métodos [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) e [**IContextMenu:: QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) não são chamados.</span><span class="sxs-lookup"><span data-stu-id="daf02-210">The [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) and [**IContextMenu::QueryContextMenu**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu) methods are not called.</span></span>
-   <span data-ttu-id="daf02-211">Quando [**IContextMenu:: InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) é chamado, o membro **LpVerb** da estrutura [**CMINVOKECOMMANDINFO**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) que é transmitida identifica o comando.</span><span class="sxs-lookup"><span data-stu-id="daf02-211">When [**IContextMenu::InvokeCommand**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) is called, the **lpVerb** member of the [**CMINVOKECOMMANDINFO**](/windows/desktop/api/shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) structure that is passed in identifies the command.</span></span> <span data-ttu-id="daf02-212">A palavra de ordem inferior de **lpVerb** é definida como o equivalente numérico do nome da subchave do comando.</span><span class="sxs-lookup"><span data-stu-id="daf02-212">The low-order word of **lpVerb** is set to the numerical equivalent of the command's subkey name.</span></span> <span data-ttu-id="daf02-213">Como essa subchave normalmente é chamada de **0**, **lpVerb** geralmente é definido como zero.</span><span class="sxs-lookup"><span data-stu-id="daf02-213">Since this subkey is normally named **0**, **lpVerb** is usually set to zero.</span></span> <span data-ttu-id="daf02-214">Em seguida, o manipulador deve iniciar o mecanismo de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="daf02-214">The handler should then launch the search engine.</span></span>

<span data-ttu-id="daf02-215">Os manipuladores de pesquisa dinâmica são implementados quase da mesma forma que os manipuladores de menu de atalho normais.</span><span class="sxs-lookup"><span data-stu-id="daf02-215">Dynamic search handlers are implemented in much the same way as normal shortcut menu handlers.</span></span> <span data-ttu-id="daf02-216">A principal exceção é que quando [**IShellExtInit:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) é chamado, os argumentos *pidlFolder* e *lpdobj* são definidos como **NULL**.</span><span class="sxs-lookup"><span data-stu-id="daf02-216">The primary exception is that when [**IShellExtInit::Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) is called, the *pidlFolder* and *lpdobj* arguments are set to **NULL**.</span></span>

<span data-ttu-id="daf02-217">Os manipuladores de pesquisa baseados em DHTML são implementados como um documento DHTML normal.</span><span class="sxs-lookup"><span data-stu-id="daf02-217">DHTML-based search handlers are implemented as a normal DHTML document.</span></span> <span data-ttu-id="daf02-218">Eles podem incluir qualquer tecnologia HTML, DHTML ou script que tenha suporte do Windows Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="daf02-218">They can include any HTML, DHTML, or scripting technology that is supported by Windows Internet Explorer.</span></span>

 

 