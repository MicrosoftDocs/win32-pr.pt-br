---
title: Efeito de mapa de tom branco
description: Esse efeito permite que o nível branco de uma imagem seja dimensionado linearmente. Isso é especialmente útil quando você converte entre o espaço de luminância de exibição referenciado e o espaço de luminância mencionado na cena, ou vice-versa.
ms.topic: article
ms.date: 02/01/2019
ms.openlocfilehash: 70a38f37f5a5461b968099bebe4be120a727c053
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/12/2020
ms.locfileid: "103918687"
---
# <a name="white-level-adjustment-effect"></a><span data-ttu-id="6c72c-104">Efeito de ajuste de nível branco</span><span class="sxs-lookup"><span data-stu-id="6c72c-104">White level adjustment effect</span></span>

<span data-ttu-id="6c72c-105">Esse efeito permite que o nível branco de uma imagem seja dimensionado linearmente.</span><span class="sxs-lookup"><span data-stu-id="6c72c-105">This effect allows the white level of an image to be linearly scaled.</span></span> <span data-ttu-id="6c72c-106">Isso é especialmente útil quando você converte entre o espaço de luminância de exibição referenciado e o espaço de luminância mencionado na cena, ou vice-versa.</span><span class="sxs-lookup"><span data-stu-id="6c72c-106">This is especially helpful when you convert between display-referred luminance space and scene-referred luminance space, or vice versa.</span></span>

<span data-ttu-id="6c72c-107">As propriedades desse efeito são identificadas pela [**enumeração D2D1_WHITELEVELADJUSTMENT_PROP**](/windows/desktop/api/d2d1effects_2/ne-d2d1effects_2-d2d1_whiteleveladjustment_prop)e o CLSID é **CLSID_D2D1WhiteLevelAdjustment**.</span><span class="sxs-lookup"><span data-stu-id="6c72c-107">The properties for this effect are identified by the [**D2D1_WHITELEVELADJUSTMENT_PROP enumeration**](/windows/desktop/api/d2d1effects_2/ne-d2d1effects_2-d2d1_whiteleveladjustment_prop), and the CLSID is **CLSID_D2D1WhiteLevelAdjustment**.</span></span>

## <a name="effect-properties"></a><span data-ttu-id="6c72c-108">Propriedades do efeito</span><span class="sxs-lookup"><span data-stu-id="6c72c-108">Effect properties</span></span>

| <span data-ttu-id="6c72c-109">Nome de exibição e enumeração de índice</span><span class="sxs-lookup"><span data-stu-id="6c72c-109">Display name and index enumeration</span></span> | <span data-ttu-id="6c72c-110">Tipo e valor padrão</span><span class="sxs-lookup"><span data-stu-id="6c72c-110">Type and default value</span></span> | <span data-ttu-id="6c72c-111">Descrição</span><span class="sxs-lookup"><span data-stu-id="6c72c-111">Description</span></span> |
|-|-|-|
| <span data-ttu-id="6c72c-112">InputWhiteLevel, D2D1_WHITELEVELADJUSTMENT_PROP_INPUT_WHITE_LEVEL</span><span class="sxs-lookup"><span data-stu-id="6c72c-112">InputWhiteLevel, D2D1_WHITELEVELADJUSTMENT_PROP_INPUT_WHITE_LEVEL</span></span> | <span data-ttu-id="6c72c-113">FLOAT</span><span class="sxs-lookup"><span data-stu-id="6c72c-113">FLOAT</span></span> | <span data-ttu-id="6c72c-114">O nível branco da imagem de entrada, em nits.</span><span class="sxs-lookup"><span data-stu-id="6c72c-114">The white level of the input image, in nits.</span></span> |
| <span data-ttu-id="6c72c-115">OutputWhiteLevel, D2D1_WHITELEVELADJUSTMENT_PROP_OUTPUT_WHITE_LEVEL</span><span class="sxs-lookup"><span data-stu-id="6c72c-115">OutputWhiteLevel, D2D1_WHITELEVELADJUSTMENT_PROP_OUTPUT_WHITE_LEVEL</span></span> | <span data-ttu-id="6c72c-116">FLOAT</span><span class="sxs-lookup"><span data-stu-id="6c72c-116">FLOAT</span></span> | <span data-ttu-id="6c72c-117">O nível branco da imagem de saída, em nits.</span><span class="sxs-lookup"><span data-stu-id="6c72c-117">The white level of the output image, in nits.</span></span> |

## <a name="remarks"></a><span data-ttu-id="6c72c-118">Comentários</span><span class="sxs-lookup"><span data-stu-id="6c72c-118">Remarks</span></span>
<span data-ttu-id="6c72c-119">Esse efeito deve ser combinado com o efeito de [mapa de tons HDR](hdr-tone-map-effect.md) para permitir que você processe imagens HDR no Direct2D com o gerenciamento de cores e o mapeamento de Tom adequados.</span><span class="sxs-lookup"><span data-stu-id="6c72c-119">This effect is intended to be combined with the [HDR tone map effect](hdr-tone-map-effect.md) to allow you to render HDR images in Direct2D with proper color management and tone mapping.</span></span> <span data-ttu-id="6c72c-120">Consulte os **comentários** deste tópico para obter mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="6c72c-120">See that topic's **Remarks** for more details.</span></span> <span data-ttu-id="6c72c-121">Os efeitos são direcionados a qualquer estrutura que queira fornecer uma experiência de exibição de imagem HDR de melhor qualidade que lide com todos os formatos de imagem HDR do Windows e se adapte aos recursos da tela (seja HDR ou WCG/SDR).</span><span class="sxs-lookup"><span data-stu-id="6c72c-121">The effects are aimed at any framework that wants to provide a best-in-class HDR image viewing experience that handles all of the Windows HDR image formats, and adapts to the capabilities of the display (whether that's HDR or WCG/SDR).</span></span>

<span data-ttu-id="6c72c-122">No Windows, supõe-se que todo o conteúdo do SDR/WCG esteja em um espaço de luminância de exibição conhecido, o que significa que o nível de branco do conteúdo deve ser dimensionado para o nível branco da tela antes de ser apresentado.</span><span class="sxs-lookup"><span data-stu-id="6c72c-122">On Windows, all SDR/WCG content is assumed to be in a display-referred luminance space, meaning that the white level of the content should be scaled up to the display's white level before it is ultimately presented.</span></span> <span data-ttu-id="6c72c-123">No entanto, nem sempre é responsabilidade do seu aplicativo fazer isso.</span><span class="sxs-lookup"><span data-stu-id="6c72c-123">However, it's not always your application's responsibility to do this.</span></span> <span data-ttu-id="6c72c-124">Por outro lado, supõe-se que o conteúdo HDR esteja em um espaço de luminância referido pela cena, o que significa que ele não deve ser expandido para coincidir com o nível branco da exibição.</span><span class="sxs-lookup"><span data-stu-id="6c72c-124">In contrast, HDR content is assumed to be in a scene-referred luminance space, meaning that it shouldn't ultimately be scaled to match the display's white level.</span></span> <span data-ttu-id="6c72c-125">Dito isso, seu aplicativo pode precisar executar o dimensionamento em algumas circunstâncias ao renderizar conteúdo HDR para garantir que esse é o resultado líquido.</span><span class="sxs-lookup"><span data-stu-id="6c72c-125">That said, your application may need to perform scaling in some circumstances when rendering HDR content to ensure that this is the net result.</span></span>

<span data-ttu-id="6c72c-126">Quando a área de trabalho do Windows está no modo SDR ou WCG, a área de trabalho é composta em um espaço de luminância de exibição conhecido.</span><span class="sxs-lookup"><span data-stu-id="6c72c-126">When the Windows desktop is in SDR or WCG mode, the desktop is composed in a display-referred luminance space.</span></span> <span data-ttu-id="6c72c-127">Mas se a área de trabalho do Windows estiver no modo HDR, a composição de área de trabalho ocorrerá em um espaço de luminância referido pela cena.</span><span class="sxs-lookup"><span data-stu-id="6c72c-127">But if the Windows desktop is in HDR mode, then desktop composition happens in scene-referred luminance space.</span></span> <span data-ttu-id="6c72c-128">Dito isso, o Gerenciador de Janelas da Área de Trabalho (DWM) em si executa ajustes de luminância (geralmente chamados de SDRBoost) para superfícies de composição de 8 bits, e isso simplifica seu aplicativo para esse caso.</span><span class="sxs-lookup"><span data-stu-id="6c72c-128">That said, the Desktop Window Manager (DWM) itself performs luminance adjustments (often called SDRBoost) for 8-bit composition surfaces, and that simplifies your application for that case.</span></span> <span data-ttu-id="6c72c-129">Mesmo assim, o aumento automático significa que a função do seu aplicativo na conversão de um espaço de luminância para outro depende do formato de composição que seu aplicativo está usando para apresentar seu conteúdo.</span><span class="sxs-lookup"><span data-stu-id="6c72c-129">Even so, the automatic boost means that your application's role in converting from one luminance space to another is dependent upon the composition format that your application is using to present its content.</span></span>

<span data-ttu-id="6c72c-130">A tabela a seguir descreve os casos em que o aplicativo deve e não deve executar um ajuste de nível branco, bem como o que esse ajuste deve ser.</span><span class="sxs-lookup"><span data-stu-id="6c72c-130">The table below describes the cases when your application should and should not perform a white level adjustment, as well as what that adjustment should be.</span></span> <span data-ttu-id="6c72c-131">Em geral, o ajuste depende de três fatores.</span><span class="sxs-lookup"><span data-stu-id="6c72c-131">In general, the adjustment depends on three factors.</span></span>

1. <span data-ttu-id="6c72c-132">Colorspace de conteúdo de entrada.</span><span class="sxs-lookup"><span data-stu-id="6c72c-132">Input content colorspace.</span></span> <span data-ttu-id="6c72c-133">Se seu conteúdo de entrada contém valores altos de luminância de intervalo dinâmico (HDR) ou não.</span><span class="sxs-lookup"><span data-stu-id="6c72c-133">Whether your input content contains high dynamic range (HDR) luminance values or not.</span></span> <span data-ttu-id="6c72c-134">O conteúdo do WCG se comporta da mesma forma que o SDR para o comportamento de luminância.</span><span class="sxs-lookup"><span data-stu-id="6c72c-134">WCG content behaves the same as SDR for luminance behavior.</span></span>
2. <span data-ttu-id="6c72c-135">Formato de composição.</span><span class="sxs-lookup"><span data-stu-id="6c72c-135">Composition format.</span></span> <span data-ttu-id="6c72c-136">O formato de pixel da superfície de destino que é apresentada ao DWM &mdash; , por exemplo, uma [cadeia de permuta](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain) ou uma superfície de [composição](/uwp/api/Windows.UI.Composition.ICompositionSurface).</span><span class="sxs-lookup"><span data-stu-id="6c72c-136">The pixel format of the target surface that is presented to the DWM&mdash;for example, a [swap chain](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain) or a [composition surface](/uwp/api/Windows.UI.Composition.ICompositionSurface).</span></span> <span data-ttu-id="6c72c-137">Durante a renderização usando Direct2D, isso é **UINT8** ou **FP16**.</span><span class="sxs-lookup"><span data-stu-id="6c72c-137">When rendering using Direct2D, this is either **UINT8** or **FP16**.</span></span>
3. <span data-ttu-id="6c72c-138">Modo de cor avançado da área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="6c72c-138">Desktop advanced color mode.</span></span> <span data-ttu-id="6c72c-139">Se o DWM está sendo executado no modo SDR, WCG ou HDR para a exibição atual.</span><span class="sxs-lookup"><span data-stu-id="6c72c-139">Whether the DWM is running in SDR, WCG, or HDR mode for the current display.</span></span> <span data-ttu-id="6c72c-140">Obtenha essas informações por meio de [**DXGI_OUTPUT_DESC1:: colorspace**](/windows/desktop/api/dxgi1_6/ns-dxgi1_6-dxgi_output_desc1) ou [**AdvancedColorInfo. CurrentAdvancedColorKind**](/uwp/api/windows.graphics.display.advancedcolorinfo.currentadvancedcolorkind).</span><span class="sxs-lookup"><span data-stu-id="6c72c-140">Obtain this information via [**DXGI_OUTPUT_DESC1::ColorSpace**](/windows/desktop/api/dxgi1_6/ns-dxgi1_6-dxgi_output_desc1) or [**AdvancedColorInfo.CurrentAdvancedColorKind**](/uwp/api/windows.graphics.display.advancedcolorinfo.currentadvancedcolorkind).</span></span>

<span data-ttu-id="6c72c-141">Com base nesses três fatores, você deve definir os valores apropriados para as `InputWhiteLevel` `OutputWhiteLevel` Propriedades e.</span><span class="sxs-lookup"><span data-stu-id="6c72c-141">Based on these three factors, you should set the appropriate values for the `InputWhiteLevel` and `OutputWhiteLevel` properties.</span></span>

|<span data-ttu-id="6c72c-142">Conteúdo de entrada</span><span class="sxs-lookup"><span data-stu-id="6c72c-142">Input content</span></span>|<span data-ttu-id="6c72c-143">Formato de composição</span><span class="sxs-lookup"><span data-stu-id="6c72c-143">Composition format</span></span>|<span data-ttu-id="6c72c-144">Modo de cor avançado</span><span class="sxs-lookup"><span data-stu-id="6c72c-144">Advanced color mode</span></span>|<span data-ttu-id="6c72c-145">InputWhiteLevel</span><span class="sxs-lookup"><span data-stu-id="6c72c-145">InputWhiteLevel</span></span>|<span data-ttu-id="6c72c-146">OutputWhiteLevel</span><span class="sxs-lookup"><span data-stu-id="6c72c-146">OutputWhiteLevel</span></span>|
|-|-|-|-|-|
|<span data-ttu-id="6c72c-147">SDR/WCG</span><span class="sxs-lookup"><span data-stu-id="6c72c-147">SDR/WCG</span></span>|<span data-ttu-id="6c72c-148">**UINT8**</span><span class="sxs-lookup"><span data-stu-id="6c72c-148">**UINT8**</span></span>|<span data-ttu-id="6c72c-149">Qualquer</span><span class="sxs-lookup"><span data-stu-id="6c72c-149">Any</span></span>|<span data-ttu-id="6c72c-150">N/D</span><span class="sxs-lookup"><span data-stu-id="6c72c-150">N/A</span></span>|<span data-ttu-id="6c72c-151">N/D</span><span class="sxs-lookup"><span data-stu-id="6c72c-151">N/A</span></span>|
|<span data-ttu-id="6c72c-152">SDR/WCG</span><span class="sxs-lookup"><span data-stu-id="6c72c-152">SDR/WCG</span></span>|<span data-ttu-id="6c72c-153">**FP16**</span><span class="sxs-lookup"><span data-stu-id="6c72c-153">**FP16**</span></span>|<span data-ttu-id="6c72c-154">SDR/WCG</span><span class="sxs-lookup"><span data-stu-id="6c72c-154">SDR/WCG</span></span>|<span data-ttu-id="6c72c-155">N/D</span><span class="sxs-lookup"><span data-stu-id="6c72c-155">N/A</span></span>|<span data-ttu-id="6c72c-156">N/D</span><span class="sxs-lookup"><span data-stu-id="6c72c-156">N/A</span></span>|
|<span data-ttu-id="6c72c-157">SDR/WCG</span><span class="sxs-lookup"><span data-stu-id="6c72c-157">SDR/WCG</span></span>|<span data-ttu-id="6c72c-158">**FP16**</span><span class="sxs-lookup"><span data-stu-id="6c72c-158">**FP16**</span></span>|<span data-ttu-id="6c72c-159">HDR</span><span class="sxs-lookup"><span data-stu-id="6c72c-159">HDR</span></span>|<span data-ttu-id="6c72c-160">SDRWhite</span><span class="sxs-lookup"><span data-stu-id="6c72c-160">SDRWhite</span></span>|<span data-ttu-id="6c72c-161">80</span><span class="sxs-lookup"><span data-stu-id="6c72c-161">80</span></span>|
|<span data-ttu-id="6c72c-162">HDR</span><span class="sxs-lookup"><span data-stu-id="6c72c-162">HDR</span></span>|<span data-ttu-id="6c72c-163">Qualquer</span><span class="sxs-lookup"><span data-stu-id="6c72c-163">Any</span></span>|<span data-ttu-id="6c72c-164">SDR/WCG</span><span class="sxs-lookup"><span data-stu-id="6c72c-164">SDR/WCG</span></span>|<span data-ttu-id="6c72c-165">80</span><span class="sxs-lookup"><span data-stu-id="6c72c-165">80</span></span>|[<span data-ttu-id="6c72c-166">**DXGI_OUTPUT_DESC1:: MaxLuminance**</span><span class="sxs-lookup"><span data-stu-id="6c72c-166">**DXGI_OUTPUT_DESC1::MaxLuminance**</span></span>](/windows/desktop/api/dxgi1_6/ns-dxgi1_6-dxgi_output_desc1)|
|<span data-ttu-id="6c72c-167">HDR</span><span class="sxs-lookup"><span data-stu-id="6c72c-167">HDR</span></span>|<span data-ttu-id="6c72c-168">**UINT8**</span><span class="sxs-lookup"><span data-stu-id="6c72c-168">**UINT8**</span></span>|<span data-ttu-id="6c72c-169">HDR</span><span class="sxs-lookup"><span data-stu-id="6c72c-169">HDR</span></span>|<span data-ttu-id="6c72c-170">80</span><span class="sxs-lookup"><span data-stu-id="6c72c-170">80</span></span>|<span data-ttu-id="6c72c-171">SDRWhite</span><span class="sxs-lookup"><span data-stu-id="6c72c-171">SDRWhite</span></span>|
|<span data-ttu-id="6c72c-172">HDR</span><span class="sxs-lookup"><span data-stu-id="6c72c-172">HDR</span></span>|<span data-ttu-id="6c72c-173">**FP16**</span><span class="sxs-lookup"><span data-stu-id="6c72c-173">**FP16**</span></span>|<span data-ttu-id="6c72c-174">HDR</span><span class="sxs-lookup"><span data-stu-id="6c72c-174">HDR</span></span>|<span data-ttu-id="6c72c-175">N/D</span><span class="sxs-lookup"><span data-stu-id="6c72c-175">N/A</span></span>|<span data-ttu-id="6c72c-176">N/D</span><span class="sxs-lookup"><span data-stu-id="6c72c-176">N/A</span></span>|

<span data-ttu-id="6c72c-177">Na tabela, o valor 80 é o nível branco de referência, em nits, para o conteúdo sRGB ou scRGB.</span><span class="sxs-lookup"><span data-stu-id="6c72c-177">In the table, the value 80 is the reference white level, in nits, for sRGB or scRGB content.</span></span> <span data-ttu-id="6c72c-178">Para isso, você pode usar a constante [**D2D1_SCENE_REFERRED_SDR_WHITE_LEVEL**](/windows/desktop/direct2d/direct2d-constants), que é definida em `d2d1effects_2.h` .</span><span class="sxs-lookup"><span data-stu-id="6c72c-178">For this, you can use the constant [**D2D1_SCENE_REFERRED_SDR_WHITE_LEVEL**](/windows/desktop/direct2d/direct2d-constants), which is defined in `d2d1effects_2.h`.</span></span> <span data-ttu-id="6c72c-179">O valor `SDRWhite` é o número de nits que a exibição deve usar para exibir o conteúdo de sRGB branco.</span><span class="sxs-lookup"><span data-stu-id="6c72c-179">The value `SDRWhite` is the number of nits that the display should use to display white sRGB content.</span></span> <span data-ttu-id="6c72c-180">Você pode recuperar esse valor acessando a propriedade [**AdvancedColorInfo. SdrWhiteLevelInNits**](/uwp/api/windows.graphics.display.advancedcolorinfo.sdrwhitelevelinnits) .</span><span class="sxs-lookup"><span data-stu-id="6c72c-180">You can retrieve this value by accessing the [**AdvancedColorInfo.SdrWhiteLevelInNits**](/uwp/api/windows.graphics.display.advancedcolorinfo.sdrwhitelevelinnits) property.</span></span> <span data-ttu-id="6c72c-181">O valor N/A significa que o ajuste de nível de branco não é usado neste cenário; Você pode remover o efeito do grafo ou definir valores para um não op.</span><span class="sxs-lookup"><span data-stu-id="6c72c-181">The value N/A means that white level adjustment is not used in this scenario; you can either remove the effect from your graph, or set values for a no-op.</span></span>

<span data-ttu-id="6c72c-182">Observe que, nos casos em que um ajuste de nível branco não é necessário para o aplicativo, o DWM ou a exibição pode estar manipulando a conversão do espaço de luminância de exibição referenciado para o espaço de luminescência referido pela cena.</span><span class="sxs-lookup"><span data-stu-id="6c72c-182">Note that, in cases where a white level adjustment is not needed by the application, the DWM or the display may be handling the conversion from display-referred luminance space to scene-referred luminance space.</span></span>

- <span data-ttu-id="6c72c-183">No modo SDR/WCG, a conversão ocorre após a composição do DWM e se aplica a todo o conteúdo apresentado à exibição.</span><span class="sxs-lookup"><span data-stu-id="6c72c-183">In SDR/WCG mode, the conversion happens after DWM composition, and applies to all content presented to that display.</span></span> <span data-ttu-id="6c72c-184">A exibição executa implicitamente essa conversão.</span><span class="sxs-lookup"><span data-stu-id="6c72c-184">The display implicitly performs this conversion.</span></span>
- <span data-ttu-id="6c72c-185">No modo HDR, a conversão é executada automaticamente pelo DWM antes da composição, desde que a superfície de composição do seu aplicativo seja SDR.</span><span class="sxs-lookup"><span data-stu-id="6c72c-185">In HDR mode, the conversion is performed automatically by the DWM before composition, so long as your application's composition surface is SDR.</span></span>

## <a name="requirements"></a><span data-ttu-id="6c72c-186">Requisitos</span><span class="sxs-lookup"><span data-stu-id="6c72c-186">Requirements</span></span>

| <span data-ttu-id="6c72c-187">Requisito</span><span class="sxs-lookup"><span data-stu-id="6c72c-187">Requirement</span></span> | <span data-ttu-id="6c72c-188">Valor</span><span class="sxs-lookup"><span data-stu-id="6c72c-188">Value</span></span> |
|-|-|
| <span data-ttu-id="6c72c-189">Cliente mínimo com suporte</span><span class="sxs-lookup"><span data-stu-id="6c72c-189">Minimum supported client</span></span> | <span data-ttu-id="6c72c-190">Windows 10, versão 1809 (10,0; Build 17763) aplicativos de \[ Desktop aplicativos \| UWP\]</span><span class="sxs-lookup"><span data-stu-id="6c72c-190">Windows 10, version 1809 (10.0; Build 17763) \[desktop apps \| UWP apps\]</span></span> |
| <span data-ttu-id="6c72c-191">parâmetro</span><span class="sxs-lookup"><span data-stu-id="6c72c-191">Header</span></span> | <span data-ttu-id="6c72c-192">d2d1effects \_ 2. h</span><span class="sxs-lookup"><span data-stu-id="6c72c-192">d2d1effects\_2.h</span></span> |
| <span data-ttu-id="6c72c-193">Biblioteca</span><span class="sxs-lookup"><span data-stu-id="6c72c-193">Library</span></span> | <span data-ttu-id="6c72c-194">d2d1. lib, dxguid. lib</span><span class="sxs-lookup"><span data-stu-id="6c72c-194">d2d1.lib, dxguid.lib</span></span> |

## <a name="related-topics"></a><span data-ttu-id="6c72c-195">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="6c72c-195">Related topics</span></span>

* [<span data-ttu-id="6c72c-196">Interface ID2D1Effect</span><span class="sxs-lookup"><span data-stu-id="6c72c-196">ID2D1Effect interface</span></span>](/windows/desktop/api/d2d1_1/nn-d2d1_1-id2d1effect)
* [<span data-ttu-id="6c72c-197">Enumeração de D2D1_WHITELEVELADJUSTMENT_PROP</span><span class="sxs-lookup"><span data-stu-id="6c72c-197">D2D1_WHITELEVELADJUSTMENT_PROP enumeration</span></span>](/windows/desktop/api/d2d1effects_2/ne-d2d1effects_2-d2d1_whiteleveladjustment_prop)
