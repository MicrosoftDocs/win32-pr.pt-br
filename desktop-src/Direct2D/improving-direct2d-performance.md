---
title: Melhorando o desempenho de aplicativos Direct2D
description: Descreve as técnicas para melhorar o desempenho do Direct2D.
ms.assetid: e6b02925-4e75-42b0-b0c4-00f1ddb85e46
keywords:
- Direct2D, desempenho
- Direct2D, bitmaps
- Direct2D, uso de recursos
- Direct2D, método Flush
- Direct2D, conteúdo estático
- desempenho para Direct2D
- bitmaps para Direct2D
- Interoperação Direct2D, GDI
- Direct2D, interoperabilidade
- interoperabilidade, Direct2D
- Graphics Device Interface (GDI)
- GDI (Graphics Device Interface)
- interoperabilidade, Graphics Device Interface (GDI)
ms.topic: article
ms.date: 05/31/2018
ms.custom: seodec18
ms.openlocfilehash: 5a413b96e00514b64b3cf1b1ee451a84a9e9ff09
ms.sourcegitcommit: 6eb53540b8d882fd035d428567d7d1c5ec17042c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/12/2020
ms.locfileid: "104454436"
---
# <a name="improving-the-performance-of-direct2d-apps"></a><span data-ttu-id="51d7c-116">Melhorando o desempenho de aplicativos Direct2D</span><span class="sxs-lookup"><span data-stu-id="51d7c-116">Improving the performance of Direct2D apps</span></span>

<span data-ttu-id="51d7c-117">Embora o [Direct2D](./direct2d-portal.md) seja acelerado por hardware e seja destinado a alto desempenho, você deve usar os recursos corretamente para maximizar a taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="51d7c-117">Although [Direct2D](./direct2d-portal.md) is hardware accelerated and is meant for high performance, you must use the features correctly to maximize throughput.</span></span> <span data-ttu-id="51d7c-118">As técnicas que mostramos aqui são derivadas de estudar cenários comuns e podem não se aplicar a todos os cenários de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="51d7c-118">The techniques we show here are derived from studying common scenarios and might not apply to all app scenarios.</span></span> <span data-ttu-id="51d7c-119">Portanto, uma compreensão cuidadosa do comportamento do aplicativo e das metas de desempenho pode ajudar a atingir os resultados desejados.</span><span class="sxs-lookup"><span data-stu-id="51d7c-119">Therefore, careful understanding of app behavior and performance goals can help achieve the results that you want.</span></span>

-   [<span data-ttu-id="51d7c-120">Uso de recursos</span><span class="sxs-lookup"><span data-stu-id="51d7c-120">Resource usage</span></span>](#resource-usage)
    -   [<span data-ttu-id="51d7c-121">Reutilizar recursos</span><span class="sxs-lookup"><span data-stu-id="51d7c-121">Reuse resources</span></span>](#reuse-resources)
-   [<span data-ttu-id="51d7c-122">Restringir o uso de flush</span><span class="sxs-lookup"><span data-stu-id="51d7c-122">Restrict the use of flush</span></span>](#restrict-the-use-of-flush)
-   [<span data-ttu-id="51d7c-123">Bitmaps</span><span class="sxs-lookup"><span data-stu-id="51d7c-123">Bitmaps</span></span>](#create-large-bitmaps)
    -   [<span data-ttu-id="51d7c-124">Criar bitmaps grandes</span><span class="sxs-lookup"><span data-stu-id="51d7c-124">Create large bitmaps</span></span>](#create-large-bitmaps)
    -   [<span data-ttu-id="51d7c-125">Criar um Atlas de bitmaps</span><span class="sxs-lookup"><span data-stu-id="51d7c-125">Create an atlas of bitmaps</span></span>](#create-an-atlas-of-bitmaps)
    -   [<span data-ttu-id="51d7c-126">Criar bitmaps compartilhados</span><span class="sxs-lookup"><span data-stu-id="51d7c-126">Create shared bitmaps</span></span>](#create-shared-bitmaps)
    -   [<span data-ttu-id="51d7c-127">Copiando bitmaps</span><span class="sxs-lookup"><span data-stu-id="51d7c-127">Copying bitmaps</span></span>](#copying-bitmaps)
-   [<span data-ttu-id="51d7c-128">Usar bitmap em ladrilhos sobre tracejado</span><span class="sxs-lookup"><span data-stu-id="51d7c-128">Use tiled bitmap over dashing</span></span>](#use-tiled-bitmap-over-dashing)
-   [<span data-ttu-id="51d7c-129">Diretrizes gerais para a renderização de conteúdo estático complexo</span><span class="sxs-lookup"><span data-stu-id="51d7c-129">General guidelines for rendering complex static content</span></span>](#general-guidelines-for-rendering-complex-static-content)
    -   [<span data-ttu-id="51d7c-130">Cache de cena completa usando um bitmap de cor</span><span class="sxs-lookup"><span data-stu-id="51d7c-130">Full scene caching using a color bitmap</span></span>](#full-scene-caching-using-a-color-bitmap)
    -   [<span data-ttu-id="51d7c-131">Por cache primitivo usando um bitmap A8 e o método FillOpacityMask</span><span class="sxs-lookup"><span data-stu-id="51d7c-131">Per primitive caching using an A8 bitmap and the FillOpacityMask method</span></span>](#per-primitive-caching-using-an-a8-bitmap-and-the-fillopacitymask-method)
-   [<span data-ttu-id="51d7c-132">Cache por primitivo usando a realização de geometria</span><span class="sxs-lookup"><span data-stu-id="51d7c-132">Per-primitive caching using geometry realizations</span></span>](#per-primitive-caching-using-geometry-realizations)
-   [<span data-ttu-id="51d7c-133">Renderização de geometria</span><span class="sxs-lookup"><span data-stu-id="51d7c-133">Geometry rendering</span></span>](#geometry-rendering)
    -   [<span data-ttu-id="51d7c-134">Usar primitiva de desenho específico sobre geometria de desenho</span><span class="sxs-lookup"><span data-stu-id="51d7c-134">Use specific draw primitive over draw geometry</span></span>](#use-specific-draw-primitive-over-draw-geometry)
    -   [<span data-ttu-id="51d7c-135">Renderizando geometria estática</span><span class="sxs-lookup"><span data-stu-id="51d7c-135">Rendering static geometry</span></span>](#rendering-static-geometry)
    -   [<span data-ttu-id="51d7c-136">Usar um contexto de dispositivo multithread</span><span class="sxs-lookup"><span data-stu-id="51d7c-136">Use a multithreaded device context</span></span>](#use-a-multithreaded-device-context)
-   [<span data-ttu-id="51d7c-137">Desenho de texto com Direct2D</span><span class="sxs-lookup"><span data-stu-id="51d7c-137">Drawing text with Direct2D</span></span>](#use-a-multithreaded-device-context)
    -   [<span data-ttu-id="51d7c-138">DrawTextLayout versus DrawText</span><span class="sxs-lookup"><span data-stu-id="51d7c-138">DrawTextLayout Vs. DrawText</span></span>](#drawtextlayout-vs-drawtext)
    -   [<span data-ttu-id="51d7c-139">Escolhendo o modo de renderização de texto correto</span><span class="sxs-lookup"><span data-stu-id="51d7c-139">Choosing the right text rendering mode</span></span>](#choosing-the-right-text-rendering-mode)
    -   [<span data-ttu-id="51d7c-140">Cache</span><span class="sxs-lookup"><span data-stu-id="51d7c-140">Caching</span></span>](#full-scene-caching-using-a-color-bitmap)
-   [<span data-ttu-id="51d7c-141">Recortando uma forma arbitrária</span><span class="sxs-lookup"><span data-stu-id="51d7c-141">Clipping an arbitrary shape</span></span>](#clipping-an-arbitrary-shape)
    -   [<span data-ttu-id="51d7c-142">PushLayer no Windows 8</span><span class="sxs-lookup"><span data-stu-id="51d7c-142">PushLayer in Windows 8</span></span>](#pushlayer-in-windows-8)
    -   [<span data-ttu-id="51d7c-143">Clipes alinhados por eixo</span><span class="sxs-lookup"><span data-stu-id="51d7c-143">Axis-aligned clips</span></span>](#axis-aligned-clips)
-   [<span data-ttu-id="51d7c-144">Interoperabilidade de DXGI: Evite comutadores frequentes</span><span class="sxs-lookup"><span data-stu-id="51d7c-144">DXGI interoperability: avoid frequent switches</span></span>](#dxgi-interoperability-avoid-frequent-switches)
-   [<span data-ttu-id="51d7c-145">Saber seu formato de pixel</span><span class="sxs-lookup"><span data-stu-id="51d7c-145">Know Your Pixel Format</span></span>](#know-your-pixel-format)
-   [<span data-ttu-id="51d7c-146">Complexidade da cena</span><span class="sxs-lookup"><span data-stu-id="51d7c-146">Scene Complexity</span></span>](#scene-complexity)
    -   [<span data-ttu-id="51d7c-147">Entender a complexidade da cena</span><span class="sxs-lookup"><span data-stu-id="51d7c-147">Understand Scene Complexity</span></span>](#understand-scene-complexity)
-   [<span data-ttu-id="51d7c-148">Melhorando o desempenho para aplicativos de impressão Direct2D</span><span class="sxs-lookup"><span data-stu-id="51d7c-148">Improving performance for Direct2D printing apps</span></span>](#improving-performance-for-direct2d-printing-apps)
    -   [<span data-ttu-id="51d7c-149">Definir os valores de propriedade corretos ao criar o controle de impressão D2D</span><span class="sxs-lookup"><span data-stu-id="51d7c-149">Set the right property values when you create the D2D print control</span></span>](#set-the-right-property-values-when-you-create-the-d2d-print-control)
    -   [<span data-ttu-id="51d7c-150">Evite usar determinados padrões de desenho Direct2D</span><span class="sxs-lookup"><span data-stu-id="51d7c-150">Avoid using certain Direct2D drawing patterns</span></span>](#avoid-using-certain-direct2d-drawing-patterns)
    -   [<span data-ttu-id="51d7c-151">Desenhar texto de maneira direta e simples</span><span class="sxs-lookup"><span data-stu-id="51d7c-151">Draw text in a direct and plain way</span></span>](#draw-text-in-a-direct-and-plain-way)
    -   [<span data-ttu-id="51d7c-152">Desenhe os bitmaps originais quando possível</span><span class="sxs-lookup"><span data-stu-id="51d7c-152">Draw the original bitmaps when possible</span></span>](#draw-the-original-bitmaps-when-possible)
-   [<span data-ttu-id="51d7c-153">Conclusão</span><span class="sxs-lookup"><span data-stu-id="51d7c-153">Conclusion</span></span>](#conclusion)

## <a name="resource-usage"></a><span data-ttu-id="51d7c-154">Uso de recursos</span><span class="sxs-lookup"><span data-stu-id="51d7c-154">Resource usage</span></span>

<span data-ttu-id="51d7c-155">Um recurso é uma alocação de algum tipo, seja na memória de vídeo ou do sistema.</span><span class="sxs-lookup"><span data-stu-id="51d7c-155">A resource is an allocation of some kind, either in video or system memory.</span></span> <span data-ttu-id="51d7c-156">Bitmaps e pincéis são exemplos de recursos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-156">Bitmaps and brushes are examples of resources.</span></span>

<span data-ttu-id="51d7c-157">No Direct2D, os recursos podem ser criados em software e hardware.</span><span class="sxs-lookup"><span data-stu-id="51d7c-157">In Direct2D, resources can be created both in software and hardware.</span></span> <span data-ttu-id="51d7c-158">A criação e a exclusão de recursos no hardware são operações caras porque exigem muita sobrecarga para a comunicação com a placa de vídeo.</span><span class="sxs-lookup"><span data-stu-id="51d7c-158">Resource creation and deletion on hardware are expensive operations because they require lots of overhead for communicating with the video card.</span></span> <span data-ttu-id="51d7c-159">Vamos ver como o Direct2D renderiza o conteúdo para um destino.</span><span class="sxs-lookup"><span data-stu-id="51d7c-159">Let's see how Direct2D renders content to a target.</span></span>

<span data-ttu-id="51d7c-160">No Direct2D, todos os comandos de renderização são colocados entre uma chamada para [**BeginDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-begindraw) e uma chamada para [**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw).</span><span class="sxs-lookup"><span data-stu-id="51d7c-160">In Direct2D, all the rendering commands are enclosed between a call to [**BeginDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-begindraw) and a call to [**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw).</span></span> <span data-ttu-id="51d7c-161">Essas chamadas são feitas para um destino de renderização.</span><span class="sxs-lookup"><span data-stu-id="51d7c-161">These calls are made to a render target.</span></span> <span data-ttu-id="51d7c-162">Você deve chamar o método **BeginDraw** antes de chamar as operações de renderização.</span><span class="sxs-lookup"><span data-stu-id="51d7c-162">You must call the **BeginDraw** method before you call rendering operations .</span></span> <span data-ttu-id="51d7c-163">Depois de chamar **BeginDraw** , um contexto normalmente cria um lote de comandos de renderização, mas atrasa o processamento desses comandos até que uma dessas instruções seja verdadeira:</span><span class="sxs-lookup"><span data-stu-id="51d7c-163">After you call **BeginDraw** , a context typically builds up a batch of rendering commands, but delays processing of these commands until one of these statements is true:</span></span>

-   <span data-ttu-id="51d7c-164">[**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw) ocorreu.</span><span class="sxs-lookup"><span data-stu-id="51d7c-164">[**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw) occurred.</span></span> <span data-ttu-id="51d7c-165">Quando **EndDraw** é chamado, ele faz com que todas as operações de desenho em lote sejam concluídas e retorna o status da operação.</span><span class="sxs-lookup"><span data-stu-id="51d7c-165">When **EndDraw** is called, it causes any batched drawing operations to complete and returns the status of the operation.</span></span>
-   <span data-ttu-id="51d7c-166">Você faz uma chamada explícita para [**flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush): o método **flush** faz com que o lote seja processado e todos os comandos pendentes sejam emitidos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-166">You make an explicit call to [**Flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush): The **Flush** method causes the batch to be processed and all pending commands to be issued.</span></span>
-   <span data-ttu-id="51d7c-167">O buffer que contém os comandos de renderização está cheio.</span><span class="sxs-lookup"><span data-stu-id="51d7c-167">The buffer holding the rendering commands is full.</span></span> <span data-ttu-id="51d7c-168">Se esse buffer ficar cheio antes que as duas condições anteriores sejam atendidas, os comandos de renderização serão liberados.</span><span class="sxs-lookup"><span data-stu-id="51d7c-168">If this buffer becomes full before the previous two conditions are fulfilled, the rendering commands are flushed out.</span></span>

<span data-ttu-id="51d7c-169">Até que os primitivos sejam liberados, o Direct2D mantém referências internas a recursos correspondentes, como bitmaps e pincéis.</span><span class="sxs-lookup"><span data-stu-id="51d7c-169">Until the primitives are flushed, Direct2D keeps internal references to corresponding resources like bitmaps and brushes.</span></span>

### <a name="reuse-resources"></a><span data-ttu-id="51d7c-170">Reutilizar recursos</span><span class="sxs-lookup"><span data-stu-id="51d7c-170">Reuse resources</span></span>

<span data-ttu-id="51d7c-171">Como já mencionado, a criação e a exclusão de recursos são caras no hardware.</span><span class="sxs-lookup"><span data-stu-id="51d7c-171">As already mentioned, resource creation and deletion is expensive on hardware.</span></span> <span data-ttu-id="51d7c-172">Portanto, reutilize os recursos quando possível.</span><span class="sxs-lookup"><span data-stu-id="51d7c-172">So reuse resources when possible.</span></span> <span data-ttu-id="51d7c-173">Veja o exemplo de criação de bitmap no desenvolvimento de jogos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-173">Take the example of bitmap creation in game development.</span></span> <span data-ttu-id="51d7c-174">Normalmente, os bitmaps que compõem uma cena em um jogo são todos criados ao mesmo tempo com todas as diferentes variações necessárias para renderização de quadro a quadro posterior.</span><span class="sxs-lookup"><span data-stu-id="51d7c-174">Usually, bitmaps that make up a scene in a game are all created at the same time with all the different variations that are required for later frame-to-frame rendering.</span></span> <span data-ttu-id="51d7c-175">No momento da renderização real da cena e da rerenderização, esses bitmaps são reutilizados em vez de recriados.</span><span class="sxs-lookup"><span data-stu-id="51d7c-175">At the time of actual scene rendering and re-rendering, these bitmaps are reused instead of re-created.</span></span>

> [!Note]  
> <span data-ttu-id="51d7c-176">Não é possível reutilizar recursos para a operação de redimensionamento de janela.</span><span class="sxs-lookup"><span data-stu-id="51d7c-176">You can't reuse resources for the window resize operation.</span></span> <span data-ttu-id="51d7c-177">Quando uma janela é redimensionada, alguns recursos dependentes de escala, como destinos de renderização compatíveis e, possivelmente, alguns recursos de camada devem ser recriados porque o conteúdo da janela deve ser redesenhado.</span><span class="sxs-lookup"><span data-stu-id="51d7c-177">When a window is resized, some scale-dependent resources such as compatible render targets and possibly some layer resources must be re-created because the window content has to be redrawn.</span></span> <span data-ttu-id="51d7c-178">Isso pode ser importante para manter a qualidade geral da cena renderizada.</span><span class="sxs-lookup"><span data-stu-id="51d7c-178">This can be important for maintaining the overall quality of the rendered scene.</span></span>

 

## <a name="restrict-the-use-of-flush"></a><span data-ttu-id="51d7c-179">Restringir o uso de flush</span><span class="sxs-lookup"><span data-stu-id="51d7c-179">Restrict the use of flush</span></span>

<span data-ttu-id="51d7c-180">Como o método [**flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush) faz com que os comandos de renderização em lote sejam processados, recomendamos que você não o use.</span><span class="sxs-lookup"><span data-stu-id="51d7c-180">Because the [**Flush**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-flush) method causes the batched rendering commands to be processed, we recommend that you don't use it.</span></span> <span data-ttu-id="51d7c-181">Para cenários mais comuns, deixe o gerenciamento de recursos para Direct2D.</span><span class="sxs-lookup"><span data-stu-id="51d7c-181">For most common scenarios, leave resource management to Direct2D.</span></span>

## <a name="bitmaps"></a><span data-ttu-id="51d7c-182">Bitmaps</span><span class="sxs-lookup"><span data-stu-id="51d7c-182">Bitmaps</span></span>

<span data-ttu-id="51d7c-183">Como mencionado anteriormente, a criação e a exclusão de recursos são operações muito caras no hardware.</span><span class="sxs-lookup"><span data-stu-id="51d7c-183">As mentioned earlier, resource creation and deletion are very expensive operations in hardware.</span></span> <span data-ttu-id="51d7c-184">Um bitmap é um tipo de recurso que é usado com frequência.</span><span class="sxs-lookup"><span data-stu-id="51d7c-184">A bitmap is a kind of resource that is used often.</span></span> <span data-ttu-id="51d7c-185">A criação de bitmaps na placa de vídeo é cara.</span><span class="sxs-lookup"><span data-stu-id="51d7c-185">Creating bitmaps on the video card is expensive.</span></span> <span data-ttu-id="51d7c-186">Reusá-los pode ajudar a tornar o aplicativo mais rápido.</span><span class="sxs-lookup"><span data-stu-id="51d7c-186">Reusing them can help make the application faster.</span></span>

### <a name="create-large-bitmaps"></a><span data-ttu-id="51d7c-187">Criar bitmaps grandes</span><span class="sxs-lookup"><span data-stu-id="51d7c-187">Create large bitmaps</span></span>

<span data-ttu-id="51d7c-188">As placas de vídeo normalmente têm um tamanho mínimo de alocação de memória.</span><span class="sxs-lookup"><span data-stu-id="51d7c-188">Video cards typically have a minimum memory allocation size.</span></span> <span data-ttu-id="51d7c-189">Se for solicitada uma alocação que seja menor do que isso, um recurso desse tamanho mínimo será alocado e a memória excedente será desperdiçada e não estará disponível para outras coisas.</span><span class="sxs-lookup"><span data-stu-id="51d7c-189">If an allocation is requested that is smaller than this, a resource of this minimum size is allocated and the surplus memory is wasted and unavailable for other things.</span></span> <span data-ttu-id="51d7c-190">Se você precisar de muitos bitmaps pequenos, uma técnica melhor é alocar um bitmap grande e armazenar todo o conteúdo de bitmap pequeno nesse bitmap grande.</span><span class="sxs-lookup"><span data-stu-id="51d7c-190">If you need many small bitmaps, a better technique is to allocate one large bitmap and store all the small bitmap contents in this large bitmap.</span></span> <span data-ttu-id="51d7c-191">Em seguida, subáreas do bitmap maior podem ser lidas onde são necessários os bitmaps menores.</span><span class="sxs-lookup"><span data-stu-id="51d7c-191">Then subareas of the larger bitmap can be read where the smaller bitmaps are needed.</span></span> <span data-ttu-id="51d7c-192">Geralmente, você deve incluir o preenchimento (pixels pretos transparentes) entre os bitmaps pequenos para evitar qualquer interação entre as imagens menores durante as operações.</span><span class="sxs-lookup"><span data-stu-id="51d7c-192">Often, you should include padding (transparent black pixels) in between the small bitmaps to avoid any interaction between the smaller images during operations.</span></span> <span data-ttu-id="51d7c-193">Isso também é conhecido como *Atlas* e tem a vantagem de reduzir a sobrecarga de criação de bitmap e o desperdício de memória de pequenas alocações de bitmap.</span><span class="sxs-lookup"><span data-stu-id="51d7c-193">This is also known as an *atlas*, and it has the benefit of reducing bitmap creation overhead and the memory waste of small bitmap allocations.</span></span> <span data-ttu-id="51d7c-194">Recomendamos que você mantenha a maioria dos bitmaps em pelo menos 64 KB e limite o número de bitmaps menores que 4 KB.</span><span class="sxs-lookup"><span data-stu-id="51d7c-194">We recommend that you keep most bitmaps to at least 64 KB and limit the number of bitmaps that are smaller than 4 KB.</span></span>

### <a name="create-an-atlas-of-bitmaps"></a><span data-ttu-id="51d7c-195">Criar um Atlas de bitmaps</span><span class="sxs-lookup"><span data-stu-id="51d7c-195">Create an atlas of bitmaps</span></span>

<span data-ttu-id="51d7c-196">Há alguns cenários comuns para os quais um bitmap do Atlas pode fornecer muito bem.</span><span class="sxs-lookup"><span data-stu-id="51d7c-196">There are some common scenarios for which a bitmap atlas can serve very well.</span></span> <span data-ttu-id="51d7c-197">Os bitmaps pequenos podem ser armazenados dentro de um bitmap grande.</span><span class="sxs-lookup"><span data-stu-id="51d7c-197">Small bitmaps can be stored inside a large bitmap.</span></span> <span data-ttu-id="51d7c-198">Esses pequenos bitmaps podem ser extraídos do bitmap maior quando você precisar deles, especificando o retângulo de destino.</span><span class="sxs-lookup"><span data-stu-id="51d7c-198">These small bitmaps can be pulled out of the larger bitmap when you need them by specifying the destination rectangle.</span></span> <span data-ttu-id="51d7c-199">Por exemplo, um aplicativo tem que desenhar vários ícones.</span><span class="sxs-lookup"><span data-stu-id="51d7c-199">For example, an application has to draw multiple icons.</span></span> <span data-ttu-id="51d7c-200">Todos os bitmaps associados aos ícones podem ser carregados em um bitmap grande com antecedência.</span><span class="sxs-lookup"><span data-stu-id="51d7c-200">All the bitmaps associated with the icons can be loaded into a large bitmap up front.</span></span> <span data-ttu-id="51d7c-201">E, no momento da renderização, eles podem ser recuperados do bitmap grande.</span><span class="sxs-lookup"><span data-stu-id="51d7c-201">And at rendering time, they can be retrieved from the large bitmap.</span></span>

> [!Note]  
> <span data-ttu-id="51d7c-202">Um bitmap Direct2D criado na memória de vídeo é limitado ao tamanho máximo de bitmap com suporte pelo adaptador no qual ele está armazenado.</span><span class="sxs-lookup"><span data-stu-id="51d7c-202">A Direct2D bitmap created in video memory is limited to the maximum bitmap size supported by the adapter on which it is stored.</span></span> <span data-ttu-id="51d7c-203">A criação de um bitmap maior do que isso pode resultar em um erro.</span><span class="sxs-lookup"><span data-stu-id="51d7c-203">Creating a bitmap larger than that might result in an error.</span></span>

 

> [!Note]  
> <span data-ttu-id="51d7c-204">A partir do Windows 8, o Direct2D inclui um [efeito do Atlas](atlas.md) que pode facilitar esse processo.</span><span class="sxs-lookup"><span data-stu-id="51d7c-204">Starting in Windows 8, Direct2D includes an [Atlas effect](atlas.md) that can make this process easier.</span></span>

 

### <a name="create-shared-bitmaps"></a><span data-ttu-id="51d7c-205">Criar bitmaps compartilhados</span><span class="sxs-lookup"><span data-stu-id="51d7c-205">Create shared bitmaps</span></span>

<span data-ttu-id="51d7c-206">A criação de bitmaps compartilhados permite que chamadores avançados criem objetos de bitmap Direct2D que são apoiados diretamente por um objeto existente, já compatível com o destino de renderização.</span><span class="sxs-lookup"><span data-stu-id="51d7c-206">Creating shared bitmaps enables advanced callers to create Direct2D bitmap objects that are backed directly by an existing object, already compatible with the render target.</span></span> <span data-ttu-id="51d7c-207">Isso evita a criação de várias superfícies e ajuda a reduzir a sobrecarga de desempenho.</span><span class="sxs-lookup"><span data-stu-id="51d7c-207">This avoids creating multiple surfaces and helps in reducing performance overhead.</span></span>

> [!Note]  
> <span data-ttu-id="51d7c-208">Os bitmaps compartilhados geralmente são limitados a destinos de software ou a destinos interoperáveis com DXGI.</span><span class="sxs-lookup"><span data-stu-id="51d7c-208">Shared bitmaps are usually limited to software targets or to targets interoperable with DXGI.</span></span> <span data-ttu-id="51d7c-209">Use os métodos [**CreateBitmapFromDxgiSurface**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromdxgisurface(idxgisurface_constd2d1_bitmap_properties1_id2d1bitmap1)), [**CreateBitmapFromWicBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1))e [**CreateSharedBitmap**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createsharedbitmap) para criar bitmaps compartilhados.</span><span class="sxs-lookup"><span data-stu-id="51d7c-209">Use the [**CreateBitmapFromDxgiSurface**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromdxgisurface(idxgisurface_constd2d1_bitmap_properties1_id2d1bitmap1)), [**CreateBitmapFromWicBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1)), and [**CreateSharedBitmap**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createsharedbitmap) methods to create shared bitmaps.</span></span>

 

### <a name="copying-bitmaps"></a><span data-ttu-id="51d7c-210">Copiando bitmaps</span><span class="sxs-lookup"><span data-stu-id="51d7c-210">Copying bitmaps</span></span>

<span data-ttu-id="51d7c-211">A criação de uma superfície DXGI é uma operação cara, portanto, reutilizar superfícies existentes quando possível.</span><span class="sxs-lookup"><span data-stu-id="51d7c-211">Creating a DXGI surface is an expensive operation so reuse existing surfaces when you can.</span></span> <span data-ttu-id="51d7c-212">Mesmo no software, se um bitmap estiver principalmente no formato desejado, exceto por uma pequena parte, será melhor atualizar essa parte do que lançar todo o bitmap e recriar tudo.</span><span class="sxs-lookup"><span data-stu-id="51d7c-212">Even in software, if a bitmap is mostly in the form you want except for a small portion, it is better to update that portion than to throw the whole bitmap away and re-create everything.</span></span> <span data-ttu-id="51d7c-213">Embora você possa usar o [**CreateCompatibleRenderTarget**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createcompatiblerendertarget(id2d1bitmaprendertarget)) para obter os mesmos resultados, a renderização geralmente é uma operação muito mais cara do que a cópia.</span><span class="sxs-lookup"><span data-stu-id="51d7c-213">Although you can use [**CreateCompatibleRenderTarget**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createcompatiblerendertarget(id2d1bitmaprendertarget)) to achieve the same results, rendering is generally a much more expensive operation than copying.</span></span> <span data-ttu-id="51d7c-214">Isso ocorre porque, para melhorar a localidade do cache, o hardware não armazena de fato um bitmap na mesma ordem de memória que o bitmap é endereçado.</span><span class="sxs-lookup"><span data-stu-id="51d7c-214">This is because, to improve cache locality, the hardware doesn't actually store a bitmap in the same memory order that the bitmap is addressed.</span></span> <span data-ttu-id="51d7c-215">Em vez disso, o bitmap pode ser swizzled.</span><span class="sxs-lookup"><span data-stu-id="51d7c-215">Instead, the bitmap might be swizzled.</span></span> <span data-ttu-id="51d7c-216">O swizzling é ocultado da CPU pelo driver (que é lento e usado apenas em partes de extremidade inferior) ou pelo Gerenciador de memória na GPU.</span><span class="sxs-lookup"><span data-stu-id="51d7c-216">The swizzling is hidden from the CPU either by the driver (which is slow and used only on lower-end parts), or by the memory manager on the GPU.</span></span> <span data-ttu-id="51d7c-217">Devido a restrições de como os dados são gravados em um destino de renderização durante a renderização, os destinos de renderização normalmente não são swizzled ou swizzled de forma que seja menos ideal do que pode ser obtido se você souber que nunca precisará renderizar para a superfície.</span><span class="sxs-lookup"><span data-stu-id="51d7c-217">Because of constraints on how data is written into a render target when rendering, render targets are typically either not swizzled, or swizzled in a way that is less optimal than can be achieved if you know that you never have to render to the surface.</span></span> <span data-ttu-id="51d7c-218">Portanto, os métodos [CopyFrom](/windows/desktop/api/d2d1/nn-d2d1-id2d1bitmap) \* são fornecidos para copiar retângulos de uma origem para o bitmap Direct2D.</span><span class="sxs-lookup"><span data-stu-id="51d7c-218">Therefore, the [CopyFrom](/windows/desktop/api/d2d1/nn-d2d1-id2d1bitmap)\* methods are provided for copying rectangles from a source to the Direct2D bitmap.</span></span>

<span data-ttu-id="51d7c-219">CopyFrom pode ser usado em qualquer uma de suas três formas:</span><span class="sxs-lookup"><span data-stu-id="51d7c-219">CopyFrom can be used in any of its three forms:</span></span>

-   [<span data-ttu-id="51d7c-220">**CopyFromBitmap**</span><span class="sxs-lookup"><span data-stu-id="51d7c-220">**CopyFromBitmap**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfrombitmap)
-   [<span data-ttu-id="51d7c-221">**CopyFromRenderTarget**</span><span class="sxs-lookup"><span data-stu-id="51d7c-221">**CopyFromRenderTarget**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfromrendertarget)
-   [<span data-ttu-id="51d7c-222">**CopyFromMemory**</span><span class="sxs-lookup"><span data-stu-id="51d7c-222">**CopyFromMemory**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfrommemory)

## <a name="use-tiled-bitmap-over-dashing"></a><span data-ttu-id="51d7c-223">Usar bitmap em ladrilhos sobre tracejado</span><span class="sxs-lookup"><span data-stu-id="51d7c-223">Use tiled bitmap over dashing</span></span>

<span data-ttu-id="51d7c-224">A renderização de uma linha tracejada é uma operação muito cara devido à alta qualidade e à precisão do algoritmo subjacente.</span><span class="sxs-lookup"><span data-stu-id="51d7c-224">Rendering a dashed line is a very expensive operation because of the high quality and accuracy of the underlying algorithm.</span></span> <span data-ttu-id="51d7c-225">Para a maioria dos casos que não envolvem geometrias de rectilinear, o mesmo efeito pode ser gerado mais rapidamente com o uso de bitmaps em ladrilhos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-225">For most of the cases not involving rectilinear geometries, the same effect can be generated faster by using tiled bitmaps.</span></span>

## <a name="general-guidelines-for-rendering-complex-static-content"></a><span data-ttu-id="51d7c-226">Diretrizes gerais para a renderização de conteúdo estático complexo</span><span class="sxs-lookup"><span data-stu-id="51d7c-226">General guidelines for rendering complex static content</span></span>

<span data-ttu-id="51d7c-227">Armazenar o conteúdo em cache se você renderizar o mesmo quadro de conteúdo ao longo do quadro, especialmente quando a cena for complexa.</span><span class="sxs-lookup"><span data-stu-id="51d7c-227">Cache content if you render the same content frame over frame, especially when the scene is complex.</span></span>

<span data-ttu-id="51d7c-228">Há três técnicas de cache que você pode usar:</span><span class="sxs-lookup"><span data-stu-id="51d7c-228">There are three caching techniques that you can use:</span></span>

-   <span data-ttu-id="51d7c-229">Cache de cena completa usando um bitmap de cor.</span><span class="sxs-lookup"><span data-stu-id="51d7c-229">Full scene caching using a color bitmap.</span></span>
-   <span data-ttu-id="51d7c-230">Por cache primitivo usando um bitmap A8 e o método [**FillOpacityMask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-fillopacitymask(id2d1bitmap_id2d1brush_constd2d1_rect_f_constd2d1_rect_f)) .</span><span class="sxs-lookup"><span data-stu-id="51d7c-230">Per primitive caching using an A8 bitmap and the [**FillOpacityMask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-fillopacitymask(id2d1bitmap_id2d1brush_constd2d1_rect_f_constd2d1_rect_f)) method.</span></span>
-   <span data-ttu-id="51d7c-231">Cache por primitivo usando a realização de geometria.</span><span class="sxs-lookup"><span data-stu-id="51d7c-231">Per-primitive caching using geometry realizations.</span></span>

<span data-ttu-id="51d7c-232">Vamos examinar cada um deles mais detalhadamente.</span><span class="sxs-lookup"><span data-stu-id="51d7c-232">Let's look at each of these in more detail.</span></span>

### <a name="full-scene-caching-using-a-color-bitmap"></a><span data-ttu-id="51d7c-233">Cache de cena completa usando um bitmap de cor</span><span class="sxs-lookup"><span data-stu-id="51d7c-233">Full scene caching using a color bitmap</span></span>

<span data-ttu-id="51d7c-234">Ao renderizar conteúdo estático, em cenários como animação, crie outro bitmap de cor completa em vez de gravar diretamente no bitmap da tela.</span><span class="sxs-lookup"><span data-stu-id="51d7c-234">When you render static content, in scenarios like animation, create another full color bitmap instead of writing directly to the screen bitmap.</span></span> <span data-ttu-id="51d7c-235">Salve o destino atual, defina o destino para o bitmap intermediário e processe o conteúdo estático.</span><span class="sxs-lookup"><span data-stu-id="51d7c-235">Save the current target, set target to the intermediate bitmap, and render the static content.</span></span> <span data-ttu-id="51d7c-236">Em seguida, volte para o bitmap da tela original e desenhe o bitmap intermediário nele.</span><span class="sxs-lookup"><span data-stu-id="51d7c-236">Then, switch back to the original screen bitmap and draw the intermediate bitmap on it.</span></span>

<span data-ttu-id="51d7c-237">Veja um exemplo:</span><span class="sxs-lookup"><span data-stu-id="51d7c-237">Here's an example:</span></span>


```C++
// Create a bitmap.
m_d2dContext->CreateBitmap(size, nullptr, 0,
    D2D1::BitmapProperties(
        D2D1_BITMAP_OPTIONS_TARGET,
        D2D1::PixelFormat(
            DXGI_FORMAT_B8G8R8A8_UNORM,
            D2D1_ALPHA_MODE_PREMULTIPLIED),
        dpiX, dpiY),
    &sceneBitmap);

// Preserve the pre-existing target.
ComPtr<ID2D1Image> oldTarget;
m_d2dContext->GetTarget(&oldTarget);

// Render static content to the sceneBitmap.
m_d2dContext->SetTarget(sceneBitmap.Get());
m_d2dContext->BeginDraw();
…
m_d2dContext->EndDraw();

// Render sceneBitmap to oldTarget.
m_d2dContext->SetTarget(oldTarget.Get());
m_d2dContext->DrawBitmap(sceneBitmap.Get());
```



<span data-ttu-id="51d7c-238">Este exemplo usa bitmaps intermediários para armazenar em cache e alterna o bitmap ao qual o contexto do dispositivo aponta quando ele é renderizado.</span><span class="sxs-lookup"><span data-stu-id="51d7c-238">This example uses intermediate bitmaps for caching and switches the bitmap that the device context points to when it renders.</span></span> <span data-ttu-id="51d7c-239">Isso evita a necessidade de criar um destino de renderização compatível com a mesma finalidade.</span><span class="sxs-lookup"><span data-stu-id="51d7c-239">This avoids the need to create a compatible render target for the same purpose.</span></span>

### <a name="per-primitive-caching-using-an-a8-bitmap-and-the-fillopacitymask-method"></a><span data-ttu-id="51d7c-240">Por cache primitivo usando um bitmap A8 e o método FillOpacityMask</span><span class="sxs-lookup"><span data-stu-id="51d7c-240">Per primitive caching using an A8 bitmap and the FillOpacityMask method</span></span>

<span data-ttu-id="51d7c-241">Quando a cena completa não é estática, mas consiste em elementos como geometry ou text estáticos, você pode usar uma técnica de cache por primitiva.</span><span class="sxs-lookup"><span data-stu-id="51d7c-241">When the full scene is not static, but consists of elements like geometry or text that are static, you can use a per primitive caching technique.</span></span> <span data-ttu-id="51d7c-242">Essa técnica preserva as características de suavização do primitivo que está sendo armazenado em cache e funciona com a alteração dos tipos de pincel.</span><span class="sxs-lookup"><span data-stu-id="51d7c-242">This technique preserves the antialiasing characteristics of the primitive being cached and works with changing brush types.</span></span> <span data-ttu-id="51d7c-243">Ele usa um bitmap A8 em que A8 é um tipo de formato de pixel que representa um canal alfa com 8 bits.</span><span class="sxs-lookup"><span data-stu-id="51d7c-243">It uses an A8 bitmap where A8 is a kind of pixel format which represents an alpha channel with 8 bits.</span></span> <span data-ttu-id="51d7c-244">Os bitmaps A8 são úteis para desenhar geometria/texto como uma máscara.</span><span class="sxs-lookup"><span data-stu-id="51d7c-244">A8 bitmaps are useful for drawing geometry/text as a mask.</span></span> <span data-ttu-id="51d7c-245">Quando você deve manipular a opacidade de conteúdo estático, em vez de manipular o próprio conteúdo, você pode traduzir, girar, distorcer ou dimensionar a opacidade da máscara.</span><span class="sxs-lookup"><span data-stu-id="51d7c-245">When you must manipulate the opacity of static content , instead of manipulating the content itself, you can translate, rotate, skew, or scale the opacity of the mask.</span></span>

<span data-ttu-id="51d7c-246">Veja um exemplo:</span><span class="sxs-lookup"><span data-stu-id="51d7c-246">Here's an example:</span></span>


```C++
// Create an opacity bitmap.
m_d2dContext->CreateBitmap(size, nullptr, 0,
    D2D1::BitmapProperties(
        D2D1_BITMAP_OPTIONS_TARGET,
        D2D1::PixelFormat(
            DXGI_FORMAT_A8_UNORM,
            D2D1_ALPHA_MODE_PREMULTIPLIED),
        dpiX, dpiY),
    &opacityBitmap);

// Preserve the pre-existing target.
ComPtr<ID2D1Image> oldTarget;
m_d2dContext->GetTarget(&oldTarget);

// Render to the opacityBitmap.
m_d2dContext->SetTarget(opacityBitmap.Get());
m_d2dContext->BeginDraw();
…
m_d2dContext->EndDraw();

// Call the FillOpacityMask method
// Note: for this call to work correctly the anti alias mode must be D2D1_ANTIALIAS_MODE_ALIASED. 
m_d2dContext->SetTarget(oldTarget.Get());
m_d2dContext->FillOpacityMask(
    opacityBitmap.Get(),
    m_contentBrush().Get(),
    D2D1_OPACITY_MASK_CONTENT_GRAPHICS);
```



## <a name="per-primitive-caching-using-geometry-realizations"></a><span data-ttu-id="51d7c-247">Cache por primitivo usando a realização de geometria</span><span class="sxs-lookup"><span data-stu-id="51d7c-247">Per-primitive caching using geometry realizations</span></span>

<span data-ttu-id="51d7c-248">Outra técnica de cache por primitivo, chamada de realização de geometria, oferece maior flexibilidade ao lidar com a geometria.</span><span class="sxs-lookup"><span data-stu-id="51d7c-248">Another per-primitive caching technique, called geometry realizations, provides greater flexibility when dealing with geometry.</span></span> <span data-ttu-id="51d7c-249">Quando você deseja desenhar repetidamente geometrias com alias ou com alias, é mais rápido convertê-las em realizações de geometria e desenhar repetidamente as realizações do que é para desenhar repetidamente as geometrias.</span><span class="sxs-lookup"><span data-stu-id="51d7c-249">When you want to repeatedly draw aliased or anti-aliased geometries, it is faster to convert them to geometry realizations and repeatedly draw the realizations than it is to repeatedly draw the geometries themselves.</span></span> <span data-ttu-id="51d7c-250">As realizações de geometria também geralmente consomem menos memória que as máscaras de opacidade (especialmente para geometrias grandes) e são menos sensíveis a alterações em escala.</span><span class="sxs-lookup"><span data-stu-id="51d7c-250">Geometry realizations also generally consume less memory than opacity masks (especially for large geometries), and they are less sensitive to changes in scale.</span></span> <span data-ttu-id="51d7c-251">Para obter mais informações, consulte [visão geral de realização de geometria](geometry-realizations-overview.md).</span><span class="sxs-lookup"><span data-stu-id="51d7c-251">For more information, see [Geometry Realizations Overview](geometry-realizations-overview.md).</span></span>

<span data-ttu-id="51d7c-252">Veja um exemplo:</span><span class="sxs-lookup"><span data-stu-id="51d7c-252">Here's an example:</span></span>


```C++
    // Compute a flattening tolerance based on the scales at which the realization will be used.
    float flatteningTolerance = D2D1::ComputeFlatteningTolerance(...);

    ComPtr<ID2D1GeometryRealization> geometryRealization;

    // Create realization of the filled interior of the geometry.
    m_d2dDeviceContext1->CreateFilledGeometryRealization(
        geometry.Get(),
        flatteningTolerance,
        &geometryRealization
        );

    // In your app's rendering code, draw the geometry realization with a brush.
    m_d2dDeviceContext1->BeginDraw();
    m_d2dDeviceContext1->DrawGeometryRealization(
        geometryRealization.Get(),
        m_brush.Get()
        );
    m_d2dDeviceContext1->EndDraw();
```



## <a name="geometry-rendering"></a><span data-ttu-id="51d7c-253">Renderização de geometria</span><span class="sxs-lookup"><span data-stu-id="51d7c-253">Geometry rendering</span></span>

### <a name="use-specific-draw-primitive-over-draw-geometry"></a><span data-ttu-id="51d7c-254">Usar primitiva de desenho específico sobre geometria de desenho</span><span class="sxs-lookup"><span data-stu-id="51d7c-254">Use specific draw primitive over draw geometry</span></span>

<span data-ttu-id="51d7c-255">Use chamadas *primitivas* de desenho mais específicas, como [**DrawRectangle**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawrectangle(constd2d1_rect_f__id2d1brush_float_id2d1strokestyle)) sobre chamadas [**DrawGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawgeometry) genéricas.</span><span class="sxs-lookup"><span data-stu-id="51d7c-255">Use more specific draw *primitive* calls like [**DrawRectangle**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawrectangle(constd2d1_rect_f__id2d1brush_float_id2d1strokestyle)) over generic [**DrawGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawgeometry) calls.</span></span> <span data-ttu-id="51d7c-256">Isso ocorre porque, com **DrawRectangle**, a geometria já é conhecida e, portanto, o processamento é mais rápido.</span><span class="sxs-lookup"><span data-stu-id="51d7c-256">This is because with **DrawRectangle**, the geometry is already known so rendering is faster.</span></span>

### <a name="rendering-static-geometry"></a><span data-ttu-id="51d7c-257">Renderizando geometria estática</span><span class="sxs-lookup"><span data-stu-id="51d7c-257">Rendering static geometry</span></span>

<span data-ttu-id="51d7c-258">Em cenários em que a geometria é estática, use as técnicas de cache por primitivo explicadas acima.</span><span class="sxs-lookup"><span data-stu-id="51d7c-258">In scenarios where the geometry is static, use the per-primitive caching techniques explained above.</span></span> <span data-ttu-id="51d7c-259">As máscaras de opacidade e as realizações de geometria podem melhorar muito a velocidade de renderização de cenas que contêm geometria estática.</span><span class="sxs-lookup"><span data-stu-id="51d7c-259">Opacity masks and geometry realizations can greatly improve the rendering speed of scenes that contain static geometry..</span></span>

### <a name="use-a-multithreaded-device-context"></a><span data-ttu-id="51d7c-260">Usar um contexto de dispositivo multithread</span><span class="sxs-lookup"><span data-stu-id="51d7c-260">Use a multithreaded device context</span></span>

<span data-ttu-id="51d7c-261">Os aplicativos que esperam renderizar quantidades significativas de conteúdo geométrico complexo devem considerar especificar as [**Opções de contexto de dispositivo d2d1 habilitar sinalizador de \_ \_ \_ \_ \_ \_ \_ otimizações de vários threads**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_device_context_options) ao criar um contexto de dispositivo [Direct2D](./direct2d-portal.md) .</span><span class="sxs-lookup"><span data-stu-id="51d7c-261">Applications that expect to render significant amounts of complex geometric content should consider specifying the [**D2D1\_DEVICE\_CONTEXT\_OPTIONS\_ENABLE\_MULTI\_THREADED\_OPTIMIZATIONS**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_device_context_options) flag when creating a [Direct2D](./direct2d-portal.md) device context.</span></span> <span data-ttu-id="51d7c-262">Quando esse sinalizador for especificado, o Direct2D distribuirá a renderização em todos os núcleos lógicos presentes no sistema, o que pode reduzir significativamente o tempo de renderização geral.</span><span class="sxs-lookup"><span data-stu-id="51d7c-262">When this flag is specified, Direct2D will distribute rendering across all of the logical cores present on the system, which can significantly decrease overall rendering time.</span></span>

<span data-ttu-id="51d7c-263">Observações:</span><span class="sxs-lookup"><span data-stu-id="51d7c-263">Notes:</span></span>

-   <span data-ttu-id="51d7c-264">A partir de Windows 8.1, esse sinalizador afeta apenas a renderização de geometria de caminho.</span><span class="sxs-lookup"><span data-stu-id="51d7c-264">As of Windows 8.1, this flag only affects path geometry rendering.</span></span> <span data-ttu-id="51d7c-265">Ele não tem impacto sobre os bastidores que contêm apenas outros tipos primitivos (como texto, bitmaps ou realizações de geometria).</span><span class="sxs-lookup"><span data-stu-id="51d7c-265">It has no impact on scenes containing only other primitive types (such as text, bitmaps, or geometry realizations).</span></span>
-   <span data-ttu-id="51d7c-266">Esse sinalizador também não tem impacto ao renderizar no software (ou seja, ao renderizar com um dispositivo Direct3D detorcedor).</span><span class="sxs-lookup"><span data-stu-id="51d7c-266">This flag also has no impact when rendering in software (i.e. when rendering with a WARP Direct3D device).</span></span> <span data-ttu-id="51d7c-267">Para controlar multithreading de software, os chamadores devem usar \_ o \_ sinalizador D3D11 criar dispositivo \_ impedir \_ \_ otimizações internas de Threading \_ ao criar o dispositivo Direct3D de detorção.</span><span class="sxs-lookup"><span data-stu-id="51d7c-267">To control software multithreading, callers should use the D3D11\_CREATE\_DEVICE\_PREVENT\_INTERNAL\_THREADING\_OPTIMIZATIONS flag when creating the WARP Direct3D device.</span></span>
-   <span data-ttu-id="51d7c-268">A especificação desse sinalizador pode aumentar o conjunto de trabalho de pico durante a renderização e também pode aumentar a contenção de thread em aplicativos que já aproveitam o processamento multi-threaded.</span><span class="sxs-lookup"><span data-stu-id="51d7c-268">Specifying this flag can increase peak working set during rendering and can also increase thread contention in applications that already take advantage of multithreaded processing.</span></span>

## <a name="drawing-text-with-direct2d"></a><span data-ttu-id="51d7c-269">Desenho de texto com Direct2D</span><span class="sxs-lookup"><span data-stu-id="51d7c-269">Drawing text with Direct2D</span></span>

<span data-ttu-id="51d7c-270">A funcionalidade de renderização de texto Direct2D é oferecida em duas partes.</span><span class="sxs-lookup"><span data-stu-id="51d7c-270">Direct2D text rendering functionality is offered in two parts.</span></span> <span data-ttu-id="51d7c-271">A primeira parte, exposta como o método [**ID2D1RenderTarget::D rawtext**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) e [**ID2D1RenderTarget::D rawtextlayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) , permite que um chamador passe uma cadeia de caracteres e parâmetros de formatação ou um objeto de layout de texto DWrite para vários formatos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-271">The first part, exposed as the [**ID2D1RenderTarget::DrawText**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) and [**ID2D1RenderTarget::DrawTextLayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) method, enables a caller to pass either a string and formatting parameters or a DWrite text layout object for multiple formats.</span></span> <span data-ttu-id="51d7c-272">Isso deve ser adequado para a maioria dos chamadores.</span><span class="sxs-lookup"><span data-stu-id="51d7c-272">This should be suitable for most callers.</span></span> <span data-ttu-id="51d7c-273">A segunda maneira de renderizar texto, exposto como o método [**ID2D1RenderTarget::D rawglyphrun**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawglyphrun) , fornece rasterização para clientes que já conhecem a posição dos glifos que desejam renderizar.</span><span class="sxs-lookup"><span data-stu-id="51d7c-273">The second way to render text, exposed as the [**ID2D1RenderTarget::DrawGlyphRun**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawglyphrun) method, provides rasterization for customers who already know the position of the glyphs they want to render.</span></span> <span data-ttu-id="51d7c-274">As duas regras gerais a seguir podem ajudar a melhorar o desempenho de texto ao desenhar em Direct2D.</span><span class="sxs-lookup"><span data-stu-id="51d7c-274">The following two general rules can help improve text performance when drawing in Direct2D.</span></span>

### <a name="drawtextlayout-vs-drawtext"></a><span data-ttu-id="51d7c-275">DrawTextLayout versus DrawText</span><span class="sxs-lookup"><span data-stu-id="51d7c-275">DrawTextLayout Vs. DrawText</span></span>

<span data-ttu-id="51d7c-276">Tanto o [**DrawText**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) quanto o [**DrawTextLayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) permitem que um aplicativo processe facilmente o texto formatado pela API do [DirectWrite](/windows/desktop/DirectWrite/direct-write-portal) .</span><span class="sxs-lookup"><span data-stu-id="51d7c-276">Both [**DrawText**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtext(constwchar_uint32_idwritetextformat_constd2d1_rect_f__id2d1brush_d2d1_draw_text_options_dwrite_measuring_mode)) and [**DrawTextLayout**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawtextlayout) enable an application to easily render text that is formatted by the [DirectWrite](/windows/desktop/DirectWrite/direct-write-portal) API.</span></span> <span data-ttu-id="51d7c-277">**DrawTextLayout** desenha um objeto [**DWriteTextLayout**](/windows/desktop/api/dwrite/nn-dwrite-idwritetextlayout) existente para o [**renderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget)e **DrawText** constrói um layout DirectWrite para o chamador, com base nos parâmetros que são passados.</span><span class="sxs-lookup"><span data-stu-id="51d7c-277">**DrawTextLayout** draws an existing [**DWriteTextLayout**](/windows/desktop/api/dwrite/nn-dwrite-idwritetextlayout) object to the [**RenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget), and **DrawText** constructs a DirectWrite layout for the caller, based on the parameters that are passed in.</span></span> <span data-ttu-id="51d7c-278">Se o mesmo texto tiver que ser renderizado várias vezes, use **DrawTextLayout** em vez de **DrawText**, pois o **DrawText** cria um layout toda vez que ele é chamado.</span><span class="sxs-lookup"><span data-stu-id="51d7c-278">If the same text has to be rendered multiple times, use **DrawTextLayout** instead of **DrawText**, because **DrawText** creates a layout every time that it is called.</span></span>

### <a name="choosing-the-right-text-rendering-mode"></a><span data-ttu-id="51d7c-279">Escolhendo o modo de renderização de texto correto</span><span class="sxs-lookup"><span data-stu-id="51d7c-279">Choosing the right text rendering mode</span></span>

<span data-ttu-id="51d7c-280">Defina o modo de suavização de texto como [**\_ \_ modo AntiAlias de texto d2d1 em \_ escala de \_ cinza**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_text_antialias_mode) explicitamente.</span><span class="sxs-lookup"><span data-stu-id="51d7c-280">Set the text antialias mode to [**D2D1\_TEXT\_ANTIALIAS\_MODE\_GRAYSCALE**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_text_antialias_mode) explicitly.</span></span> <span data-ttu-id="51d7c-281">A qualidade do processamento de texto em escala de cinza é comparável ao ClearType, mas é muito mais rápida.</span><span class="sxs-lookup"><span data-stu-id="51d7c-281">The quality of rendering grayscale text is comparable to ClearType but is much faster.</span></span>

### <a name="caching"></a><span data-ttu-id="51d7c-282">Cache</span><span class="sxs-lookup"><span data-stu-id="51d7c-282">Caching</span></span>

<span data-ttu-id="51d7c-283">Use a cena completa ou o cache de bitmap por primitiva, como com o desenho de outros primitivos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-283">Use full scene or per primitive bitmap caching like with drawing other primitives.</span></span>

## <a name="clipping-an-arbitrary-shape"></a><span data-ttu-id="51d7c-284">Recortando uma forma arbitrária</span><span class="sxs-lookup"><span data-stu-id="51d7c-284">Clipping an arbitrary shape</span></span>

<span data-ttu-id="51d7c-285">A figura aqui mostra o resultado da aplicação de um clipe a uma imagem.</span><span class="sxs-lookup"><span data-stu-id="51d7c-285">The figure here shows the result of applying a clip to an image.</span></span>

![uma imagem que mostra um exemplo de uma imagem antes e depois de um clipe.](images/clip.png)

<span data-ttu-id="51d7c-287">Você pode obter esse resultado usando camadas com uma máscara de geometria ou o método [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) com um pincel de opacidade.</span><span class="sxs-lookup"><span data-stu-id="51d7c-287">You can get this result by using layers with a geometry mask or the [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) method with an opacity brush.</span></span>

<span data-ttu-id="51d7c-288">Aqui está um exemplo que usa uma camada:</span><span class="sxs-lookup"><span data-stu-id="51d7c-288">Here's an example that uses a layer:</span></span>


```C++
// Call PushLayer() and pass in the clipping geometry.
m_d2dContext->PushLayer(
    D2D1::LayerParameters(
        boundsRect,
        geometricMask));
```



<span data-ttu-id="51d7c-289">Aqui está um exemplo que usa o método [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) :</span><span class="sxs-lookup"><span data-stu-id="51d7c-289">Here's an example that uses the [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) method:</span></span>


```C++
// Create an opacity bitmap and render content.
m_d2dContext->CreateBitmap(size, nullptr, 0,
    D2D1::BitmapProperties(
        D2D1_BITMAP_OPTIONS_TARGET,
        D2D1::PixelFormat(
            DXGI_FORMAT_A8_UNORM,
            D2D1_ALPHA_MODE_PREMULTIPLIED),
        dpiX, dpiY),
    &opacityBitmap);

m_d2dContext->SetTarget(opacityBitmap.Get());
m_d2dContext->BeginDraw();
…
m_d2dContext->EndDraw();

// Create an opacity brush from the opacity bitmap.
m_d2dContext->CreateBitmapBrush(opacityBitmap.Get(),
    D2D1::BitmapBrushProperties(),
    D2D1::BrushProperties(),
    &bitmapBrush);

// Call the FillGeometry method and pass in the clip geometry and the opacity brush
m_d2dContext->FillGeometry( 
    clipGeometry.Get(),
    brush.Get(),
    opacityBrush.Get()); 
```



<span data-ttu-id="51d7c-290">Neste exemplo de código, ao chamar o método PushLayer, você não passa uma camada de aplicativo criado.</span><span class="sxs-lookup"><span data-stu-id="51d7c-290">In this code example, when you call the PushLayer method, you don't pass in an app created layer.</span></span> <span data-ttu-id="51d7c-291">O Direct2D cria uma camada para você.</span><span class="sxs-lookup"><span data-stu-id="51d7c-291">Direct2D creates a layer for you.</span></span> <span data-ttu-id="51d7c-292">O Direct2D é capaz de gerenciar a alocação e a destruição desse recurso sem qualquer envolvimento do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="51d7c-292">Direct2D is able to manage the allocation and destruction of this resource without any involvement from the app.</span></span> <span data-ttu-id="51d7c-293">Isso permite que o Direct2D reutilize as camadas internamente e aplique otimizações de gerenciamento de recursos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-293">This allows Direct2D to reuse layers internally and apply resource management optimizations.</span></span>

<span data-ttu-id="51d7c-294">No Windows 8, muitas otimizações foram feitas no uso de camadas e recomendamos que você tente usar APIs de camada em vez de [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) sempre que possível.</span><span class="sxs-lookup"><span data-stu-id="51d7c-294">In Windows 8 many optimizations have been made to the usage of layers and we recommend you try using layer APIs instead of [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry) whenever possible.</span></span>

### <a name="pushlayer-in-windows-8"></a><span data-ttu-id="51d7c-295">PushLayer no Windows 8</span><span class="sxs-lookup"><span data-stu-id="51d7c-295">PushLayer in Windows 8</span></span>

<span data-ttu-id="51d7c-296">A interface [**ID2D1DeviceContext**](/windows/win32/api/d2d1_1/nn-d2d1_1-id2d1devicecontext) é derivada da interface [**ID2D1RenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget) e é a chave para exibir o conteúdo de Direct2D no Windows 8, para obter mais informações sobre essa interface, confira [dispositivos e contextos de dispositivo](devices-and-device-contexts.md).</span><span class="sxs-lookup"><span data-stu-id="51d7c-296">The [**ID2D1DeviceContext**](/windows/win32/api/d2d1_1/nn-d2d1_1-id2d1devicecontext) interface is derived from the [**ID2D1RenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget) interface and is key to displaying Direct2D content in Windows 8, for more information about this interface see [Devices and Device Contexts](devices-and-device-contexts.md).</span></span> <span data-ttu-id="51d7c-297">Com a interface de contexto do dispositivo, você pode ignorar a chamada do método [**CreateLayer**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createlayer(id2d1layer)) e, em seguida, passar NULL para o método [**ID2D1DeviceContext::P ushlayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-pushlayer(constd2d1_layer_parameters1_id2d1layer)) .</span><span class="sxs-lookup"><span data-stu-id="51d7c-297">With the device context interface, you can skip calling the [**CreateLayer**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createlayer(id2d1layer)) method and then pass NULL to the [**ID2D1DeviceContext::PushLayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-pushlayer(constd2d1_layer_parameters1_id2d1layer)) method.</span></span> <span data-ttu-id="51d7c-298">O Direct2D gerencia automaticamente o recurso de camada e pode compartilhar recursos entre camadas e grafos de efeitos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-298">Direct2D automatically manages the layer resource and can share resources between layers and effect graphs.</span></span>

### <a name="axis-aligned-clips"></a><span data-ttu-id="51d7c-299">Clipes alinhados por eixo</span><span class="sxs-lookup"><span data-stu-id="51d7c-299">Axis-aligned clips</span></span>

<span data-ttu-id="51d7c-300">Se a região a ser recortada estiver alinhada ao eixo da superfície de desenho, em vez de arbitrária.</span><span class="sxs-lookup"><span data-stu-id="51d7c-300">If the region to be clipped is aligned to the axis of the drawing surface, instead of arbitrary.</span></span> <span data-ttu-id="51d7c-301">Esse caso é adequado para usar um retângulo de clipe em vez de uma camada.</span><span class="sxs-lookup"><span data-stu-id="51d7c-301">This case is suited for using a clip rectangle instead of a layer.</span></span> <span data-ttu-id="51d7c-302">O lucro de desempenho é mais para geometria com alias do que a geometria de suavização de serrilhado.</span><span class="sxs-lookup"><span data-stu-id="51d7c-302">The performance gain is more for aliased geometry than antialiased geometry.</span></span> <span data-ttu-id="51d7c-303">Para obter mais informações sobre clipes alinhados por eixo, consulte o tópico [**PushAxisAlignedClip**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-pushaxisalignedclip(constd2d1_rect_f__d2d1_antialias_mode)) .</span><span class="sxs-lookup"><span data-stu-id="51d7c-303">For more info on axis aligned clips, see the [**PushAxisAlignedClip**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-pushaxisalignedclip(constd2d1_rect_f__d2d1_antialias_mode)) topic.</span></span>

## <a name="dxgi-interoperability-avoid-frequent-switches"></a><span data-ttu-id="51d7c-304">Interoperabilidade de DXGI: Evite comutadores frequentes</span><span class="sxs-lookup"><span data-stu-id="51d7c-304">DXGI interoperability: avoid frequent switches</span></span>

<span data-ttu-id="51d7c-305">O Direct2D pode interoperar diretamente com superfícies do Direct3D.</span><span class="sxs-lookup"><span data-stu-id="51d7c-305">Direct2D can interoperate seamlessly with Direct3D surfaces.</span></span> <span data-ttu-id="51d7c-306">Isso é muito útil para a criação de aplicativos que renderizam uma mistura de conteúdo 2D e 3D.</span><span class="sxs-lookup"><span data-stu-id="51d7c-306">This is very useful for creating applications that render a mixture of 2D and 3D content.</span></span> <span data-ttu-id="51d7c-307">Mas cada comutador entre o Direct2D de desenho e o conteúdo do Direct3D afeta o desempenho.</span><span class="sxs-lookup"><span data-stu-id="51d7c-307">But each switch between drawing Direct2D and Direct3D content affects performance.</span></span>

<span data-ttu-id="51d7c-308">Ao renderizar para uma superfície DXGI, o Direct2D salva o estado dos dispositivos Direct3D durante a renderização e a restaura quando a renderização é concluída.</span><span class="sxs-lookup"><span data-stu-id="51d7c-308">When rendering to a DXGI surface, Direct2D saves the state of the Direct3D devices while rendering and restores it when rendering is completed.</span></span> <span data-ttu-id="51d7c-309">Sempre que um lote de processamento Direct2D é concluído, o custo desse salvamento e restauração e o custo da liberação de todas as operações de 2D são pagos e, ainda assim, o dispositivo Direct3D não é liberado.</span><span class="sxs-lookup"><span data-stu-id="51d7c-309">Every time that a batch of Direct2D rendering is completed, the cost of this save and restore and the cost of flushing all the 2D operations are paid, and yet, the Direct3D device is not flushed.</span></span> <span data-ttu-id="51d7c-310">Portanto, para aumentar o desempenho, limite o número de comutadores de renderização entre Direct2D e Direct3D.</span><span class="sxs-lookup"><span data-stu-id="51d7c-310">Therefore, to increase performance, limit the number of rendering switches between Direct2D and Direct3D.</span></span>

## <a name="know-your-pixel-format"></a><span data-ttu-id="51d7c-311">Saber seu formato de pixel</span><span class="sxs-lookup"><span data-stu-id="51d7c-311">Know Your Pixel Format</span></span>

<span data-ttu-id="51d7c-312">Ao criar um destino de renderização, você pode usar a estrutura de [**\_ \_ formato de pixel d2d1**](/windows/desktop/api/dcommon/ns-dcommon-d2d1_pixel_format) especificar o formato de pixel e o modo alfa usados pelo destino de renderização.</span><span class="sxs-lookup"><span data-stu-id="51d7c-312">When you create a render target, you can use the [**D2D1\_PIXEL\_FORMAT**](/windows/desktop/api/dcommon/ns-dcommon-d2d1_pixel_format) structure specify the pixel format and alpha mode used by the render target.</span></span> <span data-ttu-id="51d7c-313">Um canal alfa faz parte do formato de pixel que especifica o valor de cobertura ou as informações de opacidade.</span><span class="sxs-lookup"><span data-stu-id="51d7c-313">An alpha channel is part of the pixel format that specifies the coverage value or opacity information.</span></span> <span data-ttu-id="51d7c-314">Se um destino de renderização não usar o canal alfa, ele deverá ser criado usando o modo alfa do [**d2d1, \_ \_ \_ ignore**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) a.</span><span class="sxs-lookup"><span data-stu-id="51d7c-314">If a render target does not use the alpha channel, it should be created by using the [**D2D1\_ALPHA\_MODE\_IGNORE**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) alpha mode.</span></span> <span data-ttu-id="51d7c-315">Isso poupa o tempo gasto na renderização de um canal alfa que não é necessário.</span><span class="sxs-lookup"><span data-stu-id="51d7c-315">This spares the time that is spent on rendering an alpha channel that is not needed.</span></span>

<span data-ttu-id="51d7c-316">Para obter mais informações sobre formatos de pixel e modos alfa, consulte [supported pixel formats and Alpha Modes](supported-pixel-formats-and-alpha-modes.md).</span><span class="sxs-lookup"><span data-stu-id="51d7c-316">For more information about pixel formats and alpha modes, see [Supported Pixel Formats and Alpha Modes](supported-pixel-formats-and-alpha-modes.md).</span></span>

## <a name="scene-complexity"></a><span data-ttu-id="51d7c-317">Complexidade da cena</span><span class="sxs-lookup"><span data-stu-id="51d7c-317">Scene Complexity</span></span>

<span data-ttu-id="51d7c-318">Ao analisar os pontos de acesso de desempenho em uma cena que será renderizada, saber se a cena é associada à taxa de preenchimento ou se a associação de vértice pode fornecer informações úteis.</span><span class="sxs-lookup"><span data-stu-id="51d7c-318">When you analyze performance hot spots in a scene that will be rendered, knowing whether the scene is fill-rate bound or vertex bound can provide useful information.</span></span>

-   <span data-ttu-id="51d7c-319">Taxa de preenchimento: a taxa de preenchimento refere-se ao número de pixels que uma placa gráfica pode renderizar e gravar na memória de vídeo por segundo.</span><span class="sxs-lookup"><span data-stu-id="51d7c-319">Fill Rate: Fill rate refers to the number of pixels that a graphics card can render and write to video memory per second.</span></span>
-   <span data-ttu-id="51d7c-320">Vértice associado: uma cena é associada ao vértice quando ele contém uma grande geometria complexa.</span><span class="sxs-lookup"><span data-stu-id="51d7c-320">Vertex Bound: A scene is vertex bound when it contains lots of complex geometry.</span></span>

### <a name="understand-scene-complexity"></a><span data-ttu-id="51d7c-321">Entender a complexidade da cena</span><span class="sxs-lookup"><span data-stu-id="51d7c-321">Understand Scene Complexity</span></span>

<span data-ttu-id="51d7c-322">Você pode analisar a complexidade da sua cena alterando o tamanho do destino de renderização.</span><span class="sxs-lookup"><span data-stu-id="51d7c-322">You can analyze your scene complexity by altering the size of the render target.</span></span> <span data-ttu-id="51d7c-323">Se os ganhos de desempenho estiverem visíveis para uma redução proporcional no tamanho do destino de renderização, o aplicativo será associado à taxa de preenchimento.</span><span class="sxs-lookup"><span data-stu-id="51d7c-323">If performance gains are visible for a proportional reduction in size of the render target, then the application is fill-rate bound.</span></span> <span data-ttu-id="51d7c-324">Caso contrário, a complexidade da cena é o afunilamento de desempenho.</span><span class="sxs-lookup"><span data-stu-id="51d7c-324">Otherwise, the scene complexity is the performance bottleneck.</span></span>

<span data-ttu-id="51d7c-325">Quando uma cena é associada à taxa de preenchimento, reduzir o tamanho do destino de renderização pode melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="51d7c-325">When a scene is fill-rate bound, reducing the size of the render target can improve the performance.</span></span> <span data-ttu-id="51d7c-326">Isso ocorre porque o número de pixels a serem renderizados será reduzido proporcionalmente com o tamanho do destino de renderização.</span><span class="sxs-lookup"><span data-stu-id="51d7c-326">This is because the number of pixels to be rendered will be reduced proportionally with the size of the render target.</span></span>

<span data-ttu-id="51d7c-327">Quando uma cena é associada ao vértice, reduza a complexidade da geometria.</span><span class="sxs-lookup"><span data-stu-id="51d7c-327">When a scene is vertex bound, reduce the complexity of the geometry.</span></span> <span data-ttu-id="51d7c-328">Mas lembre-se de que isso é feito às custas da qualidade da imagem.</span><span class="sxs-lookup"><span data-stu-id="51d7c-328">But remember that this is done at the expense of image quality.</span></span> <span data-ttu-id="51d7c-329">Portanto, uma decisão de compensação cuidadosa deve ser feita entre a qualidade desejada e o desempenho necessário.</span><span class="sxs-lookup"><span data-stu-id="51d7c-329">Therefore, a careful tradeoff decision should be made between the desired quality and the performance that is required.</span></span>

## <a name="improving-performance-for-direct2d-printing-apps"></a><span data-ttu-id="51d7c-330">Melhorando o desempenho para aplicativos de impressão Direct2D</span><span class="sxs-lookup"><span data-stu-id="51d7c-330">Improving performance for Direct2D printing apps</span></span>

<span data-ttu-id="51d7c-331">O [Direct2D](./direct2d-portal.md) oferece compatibilidade com a impressão.</span><span class="sxs-lookup"><span data-stu-id="51d7c-331">[Direct2D](./direct2d-portal.md) offers compatibility with printing.</span></span> <span data-ttu-id="51d7c-332">Você pode enviar os mesmos comandos de desenho Direct2D (na forma de listas de comandos Direct2D) para o controle de impressão Direct2D para impressão, se você não souber quais dispositivos você está desenhando ou como o desenho é traduzido para impressão.</span><span class="sxs-lookup"><span data-stu-id="51d7c-332">You can send the same Direct2D drawing commands (in the form of Direct2D command lists) to the Direct2D print control for printing, if you don't know what devices you are drawing to, or how the drawing is translated to printing.</span></span>

<span data-ttu-id="51d7c-333">Você pode ajustar ainda mais o uso do controle de impressão [Direct2D](./direct2d-portal.md) e seus comandos de desenho Direct2D para fornecer resultados de impressão com melhor desempenho.</span><span class="sxs-lookup"><span data-stu-id="51d7c-333">You can further fine-tune their usage of the [Direct2D](./direct2d-portal.md) print control and your Direct2D drawing commands to deliver printing results with better performance.</span></span>

<span data-ttu-id="51d7c-334">O controle de impressão de [Direct2D](./direct2d-portal.md) gera mensagens de depuração quando vê um padrão de código Direct2D que leva a uma qualidade de impressão ou desempenho mais baixo (como os padrões de código listados posteriormente neste tópico) para lembrá-lo de onde você pode evitar problemas de desempenho.</span><span class="sxs-lookup"><span data-stu-id="51d7c-334">The [Direct2D](./direct2d-portal.md) print control outputs debug messages when it sees a Direct2D code pattern that leads to lower printing quality or performance (like, code patterns listed later in this topic) to remind you where you can avoid performance problems.</span></span> <span data-ttu-id="51d7c-335">Para ver essas mensagens de depuração, você precisa habilitar a [camada de depuração Direct2D](direct2ddebuglayer-portal.md) em seu código.</span><span class="sxs-lookup"><span data-stu-id="51d7c-335">To see those debug messages, you need to enable [Direct2D Debug Layer](direct2ddebuglayer-portal.md) in your code.</span></span> <span data-ttu-id="51d7c-336">Consulte [depurar mensagens](direct2ddebuglayer-debugmessages.md) para obter instruções para habilitar a saída da mensagem de depuração.</span><span class="sxs-lookup"><span data-stu-id="51d7c-336">See [Debug Messages](direct2ddebuglayer-debugmessages.md) for instructions to enable debug message output.</span></span>

### <a name="set-the-right-property-values-when-you-create-the-d2d-print-control"></a><span data-ttu-id="51d7c-337">Definir os valores de propriedade corretos ao criar o controle de impressão D2D</span><span class="sxs-lookup"><span data-stu-id="51d7c-337">Set the right property values when you create the D2D print control</span></span>

<span data-ttu-id="51d7c-338">Há três propriedades que você pode definir ao criar o controle de impressão [Direct2D](./direct2d-portal.md) .</span><span class="sxs-lookup"><span data-stu-id="51d7c-338">There are three properties that you can set when you create the [Direct2D](./direct2d-portal.md) print control.</span></span> <span data-ttu-id="51d7c-339">Duas dessas propriedades afetam como o controle de impressão Direct2D lida com determinados comandos Direct2D e, por sua vez, impacta o desempenho geral.</span><span class="sxs-lookup"><span data-stu-id="51d7c-339">Two of these properties impact how the Direct2D print control handles certain Direct2D commands and in turn impact the overall performance.</span></span>

-   <span data-ttu-id="51d7c-340">Modo de subconjunto de fontes: o controle de impressão [Direct2D](./direct2d-portal.md) subdefine os recursos de fonte usados em cada página antes de enviar a página a ser impressa.</span><span class="sxs-lookup"><span data-stu-id="51d7c-340">Font Subset Mode: The [Direct2D](./direct2d-portal.md) print control subsets font resources used in each page before it sends the page to be printed.</span></span> <span data-ttu-id="51d7c-341">Esse modo reduz o tamanho dos recursos de página necessários para a impressão.</span><span class="sxs-lookup"><span data-stu-id="51d7c-341">This mode reduces the size of page resources needed to print.</span></span> <span data-ttu-id="51d7c-342">Dependendo do uso da fonte na página, você pode escolher diferentes modos de subconjuntos de fontes para obter o melhor desempenho.</span><span class="sxs-lookup"><span data-stu-id="51d7c-342">Depending on font usage on the page, you can choose different font subset modes for the best performance.</span></span>
    -   <span data-ttu-id="51d7c-343">[**D2d1 \_ O \_ modo de subconjunto de fontes de impressão \_ \_ \_ padrão**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) fornece o melhor desempenho de impressão na maioria dos casos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-343">[**D2D1\_PRINT\_FONT\_SUBSET\_MODE\_DEFAULT**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) provides the best printing performance in most cases.</span></span> <span data-ttu-id="51d7c-344">Quando definido para esse modo, o controle de impressão [Direct2D](./direct2d-portal.md) usa uma estratégia heurística para decidir quando subagrupar as fontes.</span><span class="sxs-lookup"><span data-stu-id="51d7c-344">When set to this mode, the [Direct2D](./direct2d-portal.md) print control uses a heuristic strategy to decide when to subset fonts.</span></span>
    -   <span data-ttu-id="51d7c-345">Para trabalhos de impressão curtos com 1 ou 2 páginas, recomendamos o [**\_ modo de \_ subconjunto de fontes de impressão d2d1 \_ \_ \_ EACHPAGE**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) , em que o controle de impressão [Direct2D](./direct2d-portal.md) subconjuntos e insere recursos de fonte em cada página e, em seguida, descarta esse subconjunto de fontes após a página ser impressa.</span><span class="sxs-lookup"><span data-stu-id="51d7c-345">For short print jobs with 1 or 2 pages, we recommend [**D2D1\_PRINT\_FONT\_SUBSET\_MODE\_EACHPAGE**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode) , where the [Direct2D](./direct2d-portal.md) print control subsets and embeds font resources in each page, then discards that font subset after the page prints.</span></span> <span data-ttu-id="51d7c-346">Essa opção garante que cada página possa ser impressa imediatamente após ser gerada, mas aumenta ligeiramente o tamanho dos recursos da página necessários para a impressão (com geralmente subconjuntos de fontes grandes).</span><span class="sxs-lookup"><span data-stu-id="51d7c-346">This option makes sure each page can be printed immediately after it is generated but slightly increases size of page resources needed for printing (with usually large font subsets).</span></span>
    -   <span data-ttu-id="51d7c-347">Para trabalhos de impressão com muitas páginas de textos e tamanhos de fontes pequenos (como 100 páginas de texto que usam uma única fonte), recomendamos o [**\_ \_ \_ \_ modo de \_ subconjunto de fontes de impressão d2d1**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode), em que o controle de impressão [Direct2D](./direct2d-portal.md) não subagrupará os recursos de fonte; em vez disso, ele envia os recursos originais da fonte junto com a página que usa a fonte pela primeira vez e reutiliza os recursos de fonte para as páginas posteriores, sem reenviá-los.</span><span class="sxs-lookup"><span data-stu-id="51d7c-347">For print jobs with many pages of texts and small font sizes (like 100 pages of text that uses a single font), we recommend [**D2D1\_PRINT\_FONT\_SUBSET\_MODE\_NONE**](/windows/desktop/api/d2d1_1/ne-d2d1_1-d2d1_print_font_subset_mode), where the [Direct2D](./direct2d-portal.md) print control doesn't subset font resources at all; instead, it sends out the original font resources along with the page that first uses the font, and re-uses the font resources for later pages without resending them.</span></span>
-   <span data-ttu-id="51d7c-348">DPI de rasterização: quando o controle de impressão [Direct2D](./direct2d-portal.md) precisa rasterizar comandos Direct2D durante a conversão de DIRECT2D-XPS, ele usa esse dpi para rasterização.</span><span class="sxs-lookup"><span data-stu-id="51d7c-348">Rasterization DPI: When the [Direct2D](./direct2d-portal.md) print control needs to rasterize Direct2D commands during Direct2D-XPS conversion, it uses this DPI for rasterization.</span></span> <span data-ttu-id="51d7c-349">Em outras palavras, se a página não tiver nenhum conteúdo rasterizado, a definição de qualquer DPI não alterará o desempenho e a qualidade.</span><span class="sxs-lookup"><span data-stu-id="51d7c-349">In other words, if the page doesn't have any rasterized contents, setting any DPI won't change performance and quality.</span></span> <span data-ttu-id="51d7c-350">Dependendo do uso da rasterização na página, você pode escolher DPIs de rasterização diferentes para obter o melhor equilíbrio entre a fidelidade e o desempenho.</span><span class="sxs-lookup"><span data-stu-id="51d7c-350">Depending on rasterization usage on the page, you can choose different rasterization DPIs for the best balance between fidelity and performance.</span></span>
    -   <span data-ttu-id="51d7c-351">150 é o valor padrão se você não especificar um valor ao criar o controle de impressão [Direct2D](./direct2d-portal.md) , que é o melhor equilíbrio entre qualidade de impressão e desempenho de impressão na maioria dos casos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-351">150 is the default value if you don't specify a value when you create the [Direct2D](./direct2d-portal.md) print control, which is the best balance of printing quality and printing performance in most cases.</span></span>
    -   <span data-ttu-id="51d7c-352">Valores de DPI mais altos geralmente resultam em melhor qualidade de impressão (assim como em mais detalhes preservados), mas reduz o desempenho devido aos bitmaps maiores que ele gera.</span><span class="sxs-lookup"><span data-stu-id="51d7c-352">Higher DPI values usually result in better printing quality (as in more details preserved) but lower performance due to the larger bitmaps it generates.</span></span> <span data-ttu-id="51d7c-353">Não recomendamos nenhum valor de DPI maior que 300, já que isso não introduzirá informações extras visualmente perceptível por olhos humanos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-353">We don't recommend any DPI value greater than 300 since that won't introduce extra information visually perceivable by human eyes.</span></span>
    -   <span data-ttu-id="51d7c-354">O DPI inferior pode significar um melhor desempenho, mas também pode produzir uma qualidade menor.</span><span class="sxs-lookup"><span data-stu-id="51d7c-354">Lower DPI may mean better performance but may also produce lower quality.</span></span>

### <a name="avoid-using-certain-direct2d-drawing-patterns"></a><span data-ttu-id="51d7c-355">Evite usar determinados padrões de desenho Direct2D</span><span class="sxs-lookup"><span data-stu-id="51d7c-355">Avoid using certain Direct2D drawing patterns</span></span>

<span data-ttu-id="51d7c-356">Há diferenças entre o que o [Direct2D](./direct2d-portal.md) pode representar visualmente e o que o subsistema de impressão pode manter e transportar ao longo de todo o pipeline de impressão.</span><span class="sxs-lookup"><span data-stu-id="51d7c-356">There are differences between what [Direct2D](./direct2d-portal.md) can represent visually and what the print subsystem can maintain and transport along the whole print pipeline.</span></span> <span data-ttu-id="51d7c-357">O controle de impressão Direct2D une essas lacunas por aproximar ou rasterizando primitivos Direct2D para os quais o subsistema de impressão não dá suporte nativo.</span><span class="sxs-lookup"><span data-stu-id="51d7c-357">The Direct2D print control bridges those gaps by either approximating or rasterizing Direct2D primitives that the print subsystem doesn't natively support.</span></span> <span data-ttu-id="51d7c-358">Essa aproximação geralmente resulta em menos fidelidade de impressão, menor desempenho de impressão ou ambos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-358">Such approximation usually results in lower printing fidelity, lower printing performance, or both.</span></span> <span data-ttu-id="51d7c-359">Portanto, embora um cliente possa usar os mesmos padrões de desenho para a renderização de tela e impressão, ele não é ideal em todos os casos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-359">Therefore, even though a customer can use the same drawing patterns for both screen and print rendering, it is not ideal in all cases.</span></span> <span data-ttu-id="51d7c-360">É melhor não usar Direct2D primitivos e padrões tanto quanto possível para o caminho de impressão, ou para você ter a rasterização, na qual você tem controle total sobre a qualidade e o tamanho das imagens rasterizadas.</span><span class="sxs-lookup"><span data-stu-id="51d7c-360">It's best not to use such Direct2D primitives and patterns as much as possible for the print path, or to do you own rasterization where you have full control of the quality and the size of the rasterized images.</span></span>

<span data-ttu-id="51d7c-361">Aqui está uma lista de casos em que o desempenho de impressão e a qualidade não serão ideais e talvez você queira considerar a variação do caminho de código para o melhor desempenho de impressão.</span><span class="sxs-lookup"><span data-stu-id="51d7c-361">The here is a list of cases where the print performance and quality won't be ideal and the you might want to consider varying the code path for optimal print performance.</span></span>

-   <span data-ttu-id="51d7c-362">Evite usar o modo de mistura primitiva diferente de [**d2d1 \_ Primitive \_ Blend \_ SOURCEOVER**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_primitive_blend).</span><span class="sxs-lookup"><span data-stu-id="51d7c-362">Avoid using primitive blend mode other than [**D2D1\_PRIMITIVE\_BLEND\_SOURCEOVER**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_primitive_blend).</span></span>
-   <span data-ttu-id="51d7c-363">Evite usar modos de composição ao desenhar uma imagem diferente [**da \_ \_ origem do \_ modo \_ composto d2d1**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_composite_mode) e o **\_ \_ destino do modo \_ \_ composto d2d1**.</span><span class="sxs-lookup"><span data-stu-id="51d7c-363">Avoid using Composition Modes when drawing an image other than [**D2D1\_COMPOSITE\_MODE\_SOURCE\_OVER**](/windows/desktop/api/D2d1_1/ne-d2d1_1-d2d1_composite_mode) and **D2D1\_COMPOSITE\_MODE\_DESTINATION\_OVER**.</span></span>
-   <span data-ttu-id="51d7c-364">Evite desenhar um meta arquivo GDI.</span><span class="sxs-lookup"><span data-stu-id="51d7c-364">Avoid drawing a GDI Meta File.</span></span>
-   <span data-ttu-id="51d7c-365">Evite enviar por push um recurso de camada que copia o plano de fundo de origem (chamando [**PushLayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-pushlayer) com a [**\_ camada d2d1 \_ OPTIONS1 \_ inicializar \_ de \_ background**](/windows/desktop/api/d2d1_1/ns-d2d1_1-d2d1_layer_parameters1) para a **\_ camada d2d1 \_ PARAMETERS1** struct).</span><span class="sxs-lookup"><span data-stu-id="51d7c-365">Avoid pushing a layer resource that copies the source background (calling [**PushLayer**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-pushlayer) with passing [**D2D1\_LAYER\_OPTIONS1\_INITIALIZE\_FROM\_BACKGROUND**](/windows/desktop/api/d2d1_1/ns-d2d1_1-d2d1_layer_parameters1) to the **D2D1\_LAYER\_PARAMETERS1** struct).</span></span>
-   <span data-ttu-id="51d7c-366">Evite criar um pincel de bitmap ou um pincel de imagem com o \_ modo d2d1 Extend \_ \_ fixe.</span><span class="sxs-lookup"><span data-stu-id="51d7c-366">Avoid creating Bitmap Brush or Image Brush with D2D1\_EXTEND\_MODE\_CLAMP.</span></span> <span data-ttu-id="51d7c-367">Recomendamos que você use \_ o \_ espelho do modo d2d1 Extend \_ se não se importar em pixels fora da imagem associada (como, a imagem anexada ao pincel é conhecida como maior que a região de destino preenchida).</span><span class="sxs-lookup"><span data-stu-id="51d7c-367">We recommend you use D2D1\_EXTEND\_MODE\_MIRROR if don't care about pixels outside of the image bound at all (like, the image attached to the brush is known to be larger than the filled target region).</span></span>
-   <span data-ttu-id="51d7c-368">Evite desenhar bitmaps com [transformações em perspectiva](3d-perspective-transform.md).</span><span class="sxs-lookup"><span data-stu-id="51d7c-368">Avoid drawing Bitmaps with [Perspective Transforms](3d-perspective-transform.md).</span></span>

### <a name="draw-text-in-a-direct-and-plain-way"></a><span data-ttu-id="51d7c-369">Desenhar texto de maneira direta e simples</span><span class="sxs-lookup"><span data-stu-id="51d7c-369">Draw text in a direct and plain way</span></span>

<span data-ttu-id="51d7c-370">O Direct2D tem várias otimizações ao renderizar textos para serem exibidos para melhorar o desempenho e/ou melhor qualidade visual.</span><span class="sxs-lookup"><span data-stu-id="51d7c-370">Direct2D has several optimizations when rendering texts to display for better performance and/or better visual quality.</span></span> <span data-ttu-id="51d7c-371">Mas nem todas as otimizações melhoram o desempenho e a qualidade da impressão, já que a impressão em papel geralmente está em um DPI muito maior, e a impressão não precisa acomodar cenários como animação.</span><span class="sxs-lookup"><span data-stu-id="51d7c-371">But not all optimizations improve the printing performance and quality since the printing on paper is usually in a much higher DPI, and printing does not need to accommodate scenarios like animation.</span></span> <span data-ttu-id="51d7c-372">Portanto, recomendamos que você desenhe o texto original ou os glifos diretamente e evite qualquer uma das otimizações a seguir ao criar a lista de comandos para impressão.</span><span class="sxs-lookup"><span data-stu-id="51d7c-372">So, we recommend you draw the original text or glyphs directly and avoid any of the following optimizations when creating the command list for printing.</span></span>

-   <span data-ttu-id="51d7c-373">Evite desenhar texto com o método [**FillOpacityMask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-fillopacitymask) .</span><span class="sxs-lookup"><span data-stu-id="51d7c-373">Avoid drawing text with the [**FillOpacityMask**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1commandsink-fillopacitymask) method.</span></span>
-   <span data-ttu-id="51d7c-374">Evite desenhar o texto no modo com alias.</span><span class="sxs-lookup"><span data-stu-id="51d7c-374">Avoid drawing text in Aliased Mode.</span></span>

### <a name="draw-the-original-bitmaps-when-possible"></a><span data-ttu-id="51d7c-375">Desenhe os bitmaps originais quando possível</span><span class="sxs-lookup"><span data-stu-id="51d7c-375">Draw the original bitmaps when possible</span></span>

<span data-ttu-id="51d7c-376">Se o bitmap de destino for um JPEG, PNG, TIFF ou JPEG-XR, você poderá criar um bitmap do WIC a partir de um arquivo de disco ou de um fluxo na memória, em seguida, criar um bitmap do [Direct2D](./direct2d-portal.md) a partir desse bitmap do WIC usando [**ID2D1DeviceContext:: CreateBitmapFromWicBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1))e, por fim, passar diretamente pelo Direct2D bitmap para o controle de impressão Direct2D sem mais manipulação.</span><span class="sxs-lookup"><span data-stu-id="51d7c-376">If the target bitmap is a JPEG, PNG, TIFF, or JPEG-XR, you can create a WIC bitmap either from a disk file or from an in-memory stream, then create a [Direct2D](./direct2d-portal.md) bitmap from that WIC bitmap using [**ID2D1DeviceContext::CreateBitmapFromWicBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties1_id2d1bitmap1)), and finally directly pass that Direct2D bitmap to the Direct2D print control without further manipulation.</span></span> <span data-ttu-id="51d7c-377">Ao fazer isso, o controle de impressão Direct2D é capaz de reutilizar o fluxo de bitmap, que geralmente leva a um melhor desempenho de impressão (ignorando codificação e decodificação de bitmap redundante) e melhor qualidade de impressão (quando os metadados, como perfis de cor, no bitmap serão preservados).</span><span class="sxs-lookup"><span data-stu-id="51d7c-377">By doing so, the Direct2D print control is able to reuse the bitmap stream, which usually leads to better printing performance (by skipping redundant bitmap encoding and decoding), and better printing quality (when metadata, such as color profiles, in the bitmap will be preserved).</span></span>

<span data-ttu-id="51d7c-378">O desenho do bitmap original fornece os benefícios a seguir para os aplicativos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-378">Drawing the original bitmap provides the following benefit for applications.</span></span>

-   <span data-ttu-id="51d7c-379">Em geral, a impressão [Direct2D](./direct2d-portal.md) preserva as informações originais (sem perda ou ruído) até o final do pipeline, especialmente quando os aplicativos não sabem (ou não querem saber) os detalhes do pipeline de impressão (como a impressora na qual ele está imprimindo, qual DPI é a impressora de destino e assim por diante).</span><span class="sxs-lookup"><span data-stu-id="51d7c-379">In general, [Direct2D](./direct2d-portal.md) print preserves the original information (without loss or noise) until late in the pipeline, especially when apps don't know (or do not want to know) the details of the print pipeline (like which printer it is printing to, what DPI is the target printer, and so on).</span></span>
-   <span data-ttu-id="51d7c-380">Em muitos casos, atrasar a rasterização de bitmap significa melhor desempenho (como ao imprimir uma foto 96dpi em uma impressora 600dpi).</span><span class="sxs-lookup"><span data-stu-id="51d7c-380">In many cases, delaying bitmap rasterization means better performance (like when printing an 96dpi photo to a 600dpi printer).</span></span>
-   <span data-ttu-id="51d7c-381">Em determinados casos, passar as imagens originais é a única maneira de honrar a alta fidelidade (como perfis de cores incorporados).</span><span class="sxs-lookup"><span data-stu-id="51d7c-381">In certain cases, passing the original images is the only way to honor high fidelity (like embedded color profiles).</span></span>

<span data-ttu-id="51d7c-382">No entanto, um você não pode optar por essa otimização porque:</span><span class="sxs-lookup"><span data-stu-id="51d7c-382">However, an you can't opt in such optimization because:</span></span>

-   <span data-ttu-id="51d7c-383">Ao consultar as informações da impressora e a rasterização antecipada, você pode rasterizar o próprio conteúdo com controle total da aparência final em papel.</span><span class="sxs-lookup"><span data-stu-id="51d7c-383">By querying printer info and early rasterization, you can rasterize contents themselves with full control of the final appearance on paper.</span></span>
-   <span data-ttu-id="51d7c-384">Em determinados casos, a rasterização antecipada pode realmente melhorar o desempenho de ponta a ponta do aplicativo (como impressão de carteiras de tamanho).</span><span class="sxs-lookup"><span data-stu-id="51d7c-384">In certain cases, early rasterization might actually improves an app’s end-to-end performance (like printing wallets-size photos).</span></span>
-   <span data-ttu-id="51d7c-385">Em determinados casos, passar os bitmaps originais requer uma alteração significativa da arquitetura de código existente (como carregamento de atraso de imagem e caminhos de atualização de recursos encontrados em determinados aplicativos).</span><span class="sxs-lookup"><span data-stu-id="51d7c-385">In certain cases, passing the original bitmaps require significant change of existing code architecture (like image delay loading and resource update paths found in certain applications).</span></span>

## <a name="conclusion"></a><span data-ttu-id="51d7c-386">Conclusão</span><span class="sxs-lookup"><span data-stu-id="51d7c-386">Conclusion</span></span>

<span data-ttu-id="51d7c-387">Embora o Direct2D seja acelerado por hardware e seja destinado a alto desempenho, você deve usar os recursos corretamente para maximizar a taxa de transferência.</span><span class="sxs-lookup"><span data-stu-id="51d7c-387">Although Direct2D is hardware accelerated and is meant for high performance, you must use the features correctly to maximize throughput.</span></span> <span data-ttu-id="51d7c-388">As técnicas que vimos aqui são derivadas de estudar cenários comuns e podem não se aplicar a todos os cenários de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="51d7c-388">The techniques we looked at here are derived from studying common scenarios and might not apply to all application scenarios.</span></span>

 

 
