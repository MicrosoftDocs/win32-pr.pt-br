---
title: Aplicativos Direct2D com multithread
description: Descreve as práticas recomendadas para a criação de aplicativos Direct2D multithread.
ms.assetid: FDD770D4-817F-44D9-86C4-15DD04D214AE
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6be979b867edd6d36583959c4a595dbd507ca94f
ms.sourcegitcommit: c3243ec4ada05b7faf9d563853cb667ecef825e8
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/03/2020
ms.locfileid: "103642972"
---
# <a name="multithreaded-direct2d-apps"></a><span data-ttu-id="4867b-103">Aplicativos Direct2D com multithread</span><span class="sxs-lookup"><span data-stu-id="4867b-103">Multithreaded Direct2D Apps</span></span>

<span data-ttu-id="4867b-104">Se você desenvolver aplicativos [Direct2D](./direct2d-portal.md) , talvez seja necessário acessar os recursos do Direct2D de mais de um thread.</span><span class="sxs-lookup"><span data-stu-id="4867b-104">If you develop [Direct2D](./direct2d-portal.md) apps, you may need to access Direct2D resources from more than one thread.</span></span> <span data-ttu-id="4867b-105">Em outros casos, talvez você queira usar multithreading para obter melhor desempenho ou melhor capacidade de resposta (como usar um thread para exibição de tela e um thread separado para renderização offline).</span><span class="sxs-lookup"><span data-stu-id="4867b-105">In other cases, you may want to use multi-threading to get better performance or better responsiveness (like using one thread for screen display and a separate thread for offline rendering).</span></span>

<span data-ttu-id="4867b-106">Este tópico descreve as práticas recomendadas para o desenvolvimento de aplicativos [Direct2D](./direct2d-portal.md) multithread com pouca ou nenhuma renderização [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) .</span><span class="sxs-lookup"><span data-stu-id="4867b-106">This topic describes the best practices for developing multithreaded [Direct2D](./direct2d-portal.md) apps with little to no [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) rendering.</span></span> <span data-ttu-id="4867b-107">Os defeitos de software causados por problemas de simultaneidade podem ser difíceis de rastrear e é útil planejar sua política de multithread e seguir as práticas recomendadas descritas aqui.</span><span class="sxs-lookup"><span data-stu-id="4867b-107">Software defects caused by concurrency issues can be difficult to track down, and it is helpful to plan your multithreading policy and to follow the best practices described here.</span></span>

> [!Note]  
> <span data-ttu-id="4867b-108">Se você acessar dois recursos de [Direct2D](./direct2d-portal.md) criados de duas fábricas de Direct2D de thread único diferentes, isso não causará conflitos de acesso, contanto que os dispositivos [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) subjacentes e contextos de dispositivo também sejam distintos.</span><span class="sxs-lookup"><span data-stu-id="4867b-108">If you access two [Direct2D](./direct2d-portal.md) resources created from two different single threaded Direct2D factories it doesn't cause access conflicts as long as the underlying [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) devices and device contexts are also distinct.</span></span> <span data-ttu-id="4867b-109">Ao falar sobre "acessando recursos de Direct2D" neste artigo, isso significa, na verdade, "acessando recursos Direct2D criados no mesmo dispositivo Direct2D", a menos que declarado de outra forma.</span><span class="sxs-lookup"><span data-stu-id="4867b-109">When talking about "accessing Direct2D resources" in this article, it really means "accessing Direct2D resources created from the same Direct2D Device" unless stated otherwise.</span></span>

## <a name="developing-thread-safe-apps-that-call-only-direct2d-apis"></a><span data-ttu-id="4867b-110">Desenvolvendo Thread-Safe aplicativos que chamam apenas APIs Direct2D</span><span class="sxs-lookup"><span data-stu-id="4867b-110">Developing Thread-Safe Apps that Call Only Direct2D APIs</span></span>

<span data-ttu-id="4867b-111">Você pode criar uma instância de fábrica [Direct2D](./direct2d-portal.md) de vários threads.</span><span class="sxs-lookup"><span data-stu-id="4867b-111">You can create a multithreaded [Direct2D](./direct2d-portal.md) factory instance.</span></span> <span data-ttu-id="4867b-112">Você pode usar e compartilhar uma fábrica multithread e todos os seus recursos de mais de um thread, mas o acesso a esses recursos (por meio de chamadas Direct2D) são serializados por Direct2D, portanto, nenhum conflito de acesso ocorre.</span><span class="sxs-lookup"><span data-stu-id="4867b-112">You can use and share a multithreaded factory and all its resources from more than one thread, but accesses to those resources (via Direct2D calls) are serialized by Direct2D, so no access conflicts occur.</span></span> <span data-ttu-id="4867b-113">Se seu aplicativo chamar apenas APIs Direct2D, essa proteção será feita automaticamente pelo Direct2D em um nível granular com sobrecarga mínima.</span><span class="sxs-lookup"><span data-stu-id="4867b-113">If your app calls only Direct2D APIs, such protection is automatically done by Direct2D in a granular level with minimum overhead.</span></span> <span data-ttu-id="4867b-114">O código para criar uma fábrica multi-threaded aqui.</span><span class="sxs-lookup"><span data-stu-id="4867b-114">The code to create a multithreaded factory here.</span></span>

```cpp
ID2D1Factory* m_D2DFactory;

// Create a Direct2D factory.
HRESULT hr = D2D1CreateFactory(
    D2D1_FACTORY_TYPE_MULTI_THREADED,
    &m_D2DFactory
);
```

<span data-ttu-id="4867b-115">A imagem aqui mostra como o [Direct2D](./direct2d-portal.md) serializa dois threads que fazem chamadas usando apenas a API Direct2D.</span><span class="sxs-lookup"><span data-stu-id="4867b-115">The image here shows how [Direct2D](./direct2d-portal.md) serializes two threads that make calls using only the Direct2D API.</span></span>

![diagrama de dois threads serializados.](images/multi-thread.png)

## <a name="developing-thread-safe-direct2d-apps-with-minimal-direct3d-or-dxgi-calls"></a><span data-ttu-id="4867b-117">Desenvolvendo Thread-Safe aplicativos Direct2D com chamadas Direct3D ou DXGI mínimas</span><span class="sxs-lookup"><span data-stu-id="4867b-117">Developing Thread-Safe Direct2D Apps with minimal Direct3D or DXGI Calls</span></span>

<span data-ttu-id="4867b-118">É mais do que vezes que um aplicativo [Direct2D](./direct2d-portal.md) também faz algumas chamadas de [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) ou dxgi.</span><span class="sxs-lookup"><span data-stu-id="4867b-118">It is more than often that a [Direct2D](./direct2d-portal.md) app also makes some [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) or DXGI calls.</span></span> <span data-ttu-id="4867b-119">Por exemplo, um thread de exibição será desenhado em Direct2D e apresentará o uso de uma [**cadeia de permuta dxgi**](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain).</span><span class="sxs-lookup"><span data-stu-id="4867b-119">For example, a display thread will draw in Direct2D then present using a [**DXGI swap chain**](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain).</span></span>

<span data-ttu-id="4867b-120">Nesse caso, garantir a segurança de thread é mais complicado: algumas chamadas [Direct2D](./direct2d-portal.md) indiretamente acessam os recursos subjacentes do [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) , que podem ser acessados simultaneamente por outro thread que chama Direct3D ou dxgi.</span><span class="sxs-lookup"><span data-stu-id="4867b-120">In this case, assuring thread-safety is more complicated: some [Direct2D](./direct2d-portal.md) calls indirectly access the underlying [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) resources, which might be simultaneously accessed by another thread which calls Direct3D or DXGI.</span></span> <span data-ttu-id="4867b-121">Como essas chamadas de Direct3D ou DXGI estão fora do reconhecimento e do controle do Direct2D's, você precisa criar uma fábrica de Direct2D multithread, mas deve fazer o mor para evitar conflitos de acesso.</span><span class="sxs-lookup"><span data-stu-id="4867b-121">Since those Direct3D or DXGI calls are out of Direct2D’s awareness and control, you need to create a multithreaded Direct2D factory, but you must do mor to avoid access conflicts.</span></span>

<span data-ttu-id="4867b-122">O diagrama aqui mostra um conflito de acesso ao recurso do [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) devido ao thread T0 acessando um recurso indiretamente por meio de uma chamada [Direct2D](./direct2d-portal.md) e T2 acessando o mesmo recurso diretamente por meio de uma chamada Direct3D ou dxgi.</span><span class="sxs-lookup"><span data-stu-id="4867b-122">The diagram here shows a [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) resource access conflict due to thread T0 accessing a resource indirectly via a [Direct2D](./direct2d-portal.md) call and T2 accessing the same resource directly via a Direct3D or DXGI call.</span></span>

> [!Note]  
> <span data-ttu-id="4867b-123">A proteção de thread que o [Direct2D](./direct2d-portal.md) fornece (o bloqueio azul nessa imagem) não ajuda nesse caso.</span><span class="sxs-lookup"><span data-stu-id="4867b-123">The thread protection that [Direct2D](./direct2d-portal.md) provides (the blue lock in this image) doesn't help in this case.</span></span>

 

![diagrama de proteção de thread.](images/multi-thread2.png)

<span data-ttu-id="4867b-125">Para evitar conflitos de acesso de recursos aqui, recomendamos que você adquira explicitamente o bloqueio que o [Direct2D](./direct2d-portal.md) usa para sincronização de acesso interno e aplique esse bloqueio quando um thread precisar fazer chamadas [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) ou dxgi que possam causar conflito de acesso, como mostrado aqui.</span><span class="sxs-lookup"><span data-stu-id="4867b-125">To avoid resource access conflict here, we recommend you explicitly acquire the lock that [Direct2D](./direct2d-portal.md) uses for internal access synchronization, and apply that lock when a thread needs to make [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) or DXGI calls that might cause access conflict as shown here.</span></span> <span data-ttu-id="4867b-126">Em particular, você deve tomar cuidado especial com o código que usa exceções ou um sistema de início com base em códigos de retorno HRESULT.</span><span class="sxs-lookup"><span data-stu-id="4867b-126">In particular, you should take special care with code that uses exceptions or an early out system based on HRESULT return codes.</span></span> <span data-ttu-id="4867b-127">Por esse motivo, recomendamos que você use um padrão RAII (aquisição de recursos é inicialização) para chamar os métodos [**Enter**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-enter) e [**Leave**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-leave) .</span><span class="sxs-lookup"><span data-stu-id="4867b-127">For this reason, we recommend you use an RAII (Resource Acquisition Is Initialization) pattern to call the [**Enter**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-enter) and [**Leave**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-leave) methods.</span></span>

> [!Note]  
> <span data-ttu-id="4867b-128">É importante que você emparelhe as chamadas para os métodos [**Enter**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-enter) e [**Leave**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-leave) , caso contrário, o aplicativo pode ser bloqueado.</span><span class="sxs-lookup"><span data-stu-id="4867b-128">It is important that you pair up calls to the [**Enter**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-enter) and [**Leave**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-leave) methods, otherwise your app can deadlock.</span></span>

 

<span data-ttu-id="4867b-129">O código aqui mostra um exemplo de quando bloquear e, em seguida, desbloqueá-las em chamadas de [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) ou dxgi.</span><span class="sxs-lookup"><span data-stu-id="4867b-129">The code here shows an example of when to lock and then and unlock around [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) or DXGI calls.</span></span>


```C++
void MyApp::DrawFromThread2()
{
    // We are accessing Direct3D resources directly without Direct2D's knowledge, so we
    // must manually acquire and apply the Direct2D factory lock.
    ID2D1Multithread* m_D2DMultithread;
    m_D2DFactory->QueryInterface(IID_PPV_ARGS(&m_D2DMultithread));
    m_D2DMultithread->Enter();
    
    // Now it is safe to make Direct3D/DXGI calls, such as IDXGISwapChain::Present
    MakeDirect3DCalls();

    // It is absolutely critical that the factory lock be released upon
    // exiting this function, or else any consequent Direct2D calls will be blocked.
    m_D2DMultithread->Leave();
}
```



> [!Note]  
> <span data-ttu-id="4867b-130">Algumas chamadas de [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) ou dxgi (notavelmente [**IDXGISwapChain::P reenviada**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-present)) podem adquirir bloqueios e/ou disparar retornos de chamada no código da função ou método de chamada.</span><span class="sxs-lookup"><span data-stu-id="4867b-130">Some [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) or DXGI calls (notably [**IDXGISwapChain::Present**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-present)) may acquire locks and/or trigger callbacks into the code of the calling function or method.</span></span> <span data-ttu-id="4867b-131">Você deve estar ciente disso e verificar se esse comportamento não causa deadlocks.</span><span class="sxs-lookup"><span data-stu-id="4867b-131">You should be aware of this and make sure that such behavior doesn't cause deadlocks.</span></span> <span data-ttu-id="4867b-132">Para obter mais informações, consulte o tópico [visão geral do dxgi](/windows/desktop/direct3ddxgi/d3d10-graphics-programming-guide-dxgi) .</span><span class="sxs-lookup"><span data-stu-id="4867b-132">For more info, see the [DXGI Overview](/windows/desktop/direct3ddxgi/d3d10-graphics-programming-guide-dxgi) topic.</span></span>

 

![diagrama de bloqueio de thread Direct2D e Direct3D.](images/multi-thread3.png)

<span data-ttu-id="4867b-134">Quando você usa os métodos [**Enter**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-enter) e [**Leave**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-leave) , as chamadas são protegidas pelo [Direct2D](./direct2d-portal.md) automático e pelo bloqueio explícito, de modo que o aplicativo não atinge o conflito de acesso.</span><span class="sxs-lookup"><span data-stu-id="4867b-134">When you use the [**Enter**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-enter) and [**Leave**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1multithread-leave) methods, the calls are protected by the automatic [Direct2D](./direct2d-portal.md) and the explicit lock, so the app doesn't hit access conflict.</span></span>

<span data-ttu-id="4867b-135">Há outras abordagens para contornar esse problema.</span><span class="sxs-lookup"><span data-stu-id="4867b-135">There are other approaches to work around this issue.</span></span> <span data-ttu-id="4867b-136">No entanto, é recomendável que você proteja explicitamente as chamadas de [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) ou dxgi com o bloqueio [Direct2D](./direct2d-portal.md) porque ela geralmente fornece melhor desempenho, pois protege a simultaneidade em um nível muito mais refinado e com menor sobrecarga na capa Direct2D's.</span><span class="sxs-lookup"><span data-stu-id="4867b-136">However, we recommend you explicitly guard [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) or DXGI calls with the [Direct2D](./direct2d-portal.md) lock because it usually provides better performance as it protects concurrency at a much finer level and with lower overhead under Direct2D’s cover.</span></span>

## <a name="ensuring-atomicity-of-stateful-operations"></a><span data-ttu-id="4867b-137">Garantindo a atomicidade de operações com estado</span><span class="sxs-lookup"><span data-stu-id="4867b-137">Ensuring Atomicity of Stateful Operations</span></span>

<span data-ttu-id="4867b-138">Embora os recursos de segurança de thread do [DirectX](/previous-versions//ee663301(v=vs.85)) possam ajudar a garantir que duas chamadas de API individuais sejam feitas simultaneamente, você também deve garantir que os threads que fazem chamadas de API com estado não interfiram uns com os outros.</span><span class="sxs-lookup"><span data-stu-id="4867b-138">While thread-safety features of [DirectX](/previous-versions//ee663301(v=vs.85)) can help ensure that no two individual API calls are made concurrently, you must also ensure that threads that make stateful API calls don't interfere with each other.</span></span> <span data-ttu-id="4867b-139">Veja um exemplo.</span><span class="sxs-lookup"><span data-stu-id="4867b-139">Here is an example.</span></span>

1.  <span data-ttu-id="4867b-140">Há duas linhas de texto que você deseja renderizar na tela (por thread 0) e fora da tela (por thread 1): \# a linha 1 é "A é maior" e a linha \# 2 é "do que B", e ambas serão desenhadas usando um pincel preto sólido.</span><span class="sxs-lookup"><span data-stu-id="4867b-140">There are two lines of text that you want to render to both on-screen (by Thread 0) and off-screen (by Thread 1): Line \#1 is "A is greater" and Line \#2 is "than B", both of which will be drawn using a solid black brush.</span></span>
2.  <span data-ttu-id="4867b-141">O thread 1 desenha a primeira linha de texto.</span><span class="sxs-lookup"><span data-stu-id="4867b-141">Thread 1 draws the first line of text.</span></span>
3.  <span data-ttu-id="4867b-142">O thread 0 reage a uma entrada do usuário, atualiza as linhas de texto para "B é menor" e "de A", respectivamente, e alterou a cor do pincel para vermelho sólido para seu próprio desenho;</span><span class="sxs-lookup"><span data-stu-id="4867b-142">Thread 0 reacts to a user input, updates both text lines to "B is smaller" and "than A" respectively, and changed the brush color to solid red for its own drawing;</span></span>
4.  <span data-ttu-id="4867b-143">O thread 1 continua desenhando a segunda linha de texto, que agora é "de A", com o pincel de cor vermelha;</span><span class="sxs-lookup"><span data-stu-id="4867b-143">Thread 1 continues drawing the second line of text, which is now "than A", with the red color brush;</span></span>
5.  <span data-ttu-id="4867b-144">Por fim, obtemos duas linhas de texto no destino de desenho fora da tela: "A é maior" em preto e "do que" em vermelho.</span><span class="sxs-lookup"><span data-stu-id="4867b-144">Finally, we get two lines of text on the off-screen drawing target: "A is greater" in black and "than A" in red.</span></span>

![um diagrama de threads de tela ativados e desativados.](images/multi-thread4.png)

<span data-ttu-id="4867b-146">Na linha superior, o thread 0 desenha com cadeias de texto atuais e o pincel preto atual.</span><span class="sxs-lookup"><span data-stu-id="4867b-146">In the top row, Thread 0 draws with current text strings and the current black brush.</span></span> <span data-ttu-id="4867b-147">O thread 1 termina apenas o desenho fora da tela na metade superior.</span><span class="sxs-lookup"><span data-stu-id="4867b-147">Thread 1 only finishes off-screen drawing on the top half.</span></span>

<span data-ttu-id="4867b-148">Na linha intermediária, o thread 0 responde à interação do usuário, atualiza as cadeias de caracteres de texto e o pincel e, em seguida, atualiza a tela.</span><span class="sxs-lookup"><span data-stu-id="4867b-148">In the middle row, Thread 0 responds to user interaction, updates the text strings and the brush, then refreshes the screen.</span></span> <span data-ttu-id="4867b-149">Neste ponto, o thread 1 está bloqueado.</span><span class="sxs-lookup"><span data-stu-id="4867b-149">At this point, Thread 1 is blocked.</span></span> <span data-ttu-id="4867b-150">Na linha inferior, a renderização final fora da tela após o thread 1 retoma o desenho da metade inferior com um pincel alterado e uma cadeia de caracteres de texto alterada.</span><span class="sxs-lookup"><span data-stu-id="4867b-150">In the bottom row, the final off-screen rendering after Thread 1 resumes drawing the bottom half with an altered brush and an altered text string.</span></span>

<span data-ttu-id="4867b-151">Para resolver esse problema, recomendamos que você tenha um contexto separado para cada thread, de modo que:</span><span class="sxs-lookup"><span data-stu-id="4867b-151">To address this issue, we recommend you have a separate context for each thread, so that:</span></span>

-   <span data-ttu-id="4867b-152">Você deve criar uma cópia do contexto do dispositivo para que os recursos mutáveis (ou seja, os recursos que podem variar durante a exibição ou impressão, como conteúdo de texto ou o pincel de cor sólida no exemplo) não sejam alterados quando você renderiza.</span><span class="sxs-lookup"><span data-stu-id="4867b-152">You should create a copy of the device context so that mutable resources (i.e. resources that may vary during display or printing, such as text contents or the solid color brush in the example) don't change when you render.</span></span> <span data-ttu-id="4867b-153">Neste exemplo, você deve manter uma cópia dessas duas linhas de texto e o pincel de cor antes de desenhar.</span><span class="sxs-lookup"><span data-stu-id="4867b-153">In this sample, you should maintain a copy of those two lines of texts and the color brush before you draw.</span></span> <span data-ttu-id="4867b-154">Ao fazer isso, você garante que cada thread tenha conteúdo completo e consistente para desenhar e apresentar.</span><span class="sxs-lookup"><span data-stu-id="4867b-154">By doing so, you guarantee each thread has complete and consistent content to draw and present.</span></span>
-   <span data-ttu-id="4867b-155">Você deve compartilhar recursos pesados (como bitmaps e grafos de efeitos complexos) que são inicializados uma vez e nunca são modificados em threads para aumentar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="4867b-155">You should share heavy-weight resources (like bitmaps and complex effect graphs) that are initialized once and then never modified across threads to increase performance.</span></span>
-   <span data-ttu-id="4867b-156">Você pode compartilhar recursos leves (como pincéis de cor sólida e formatos de texto) que são inicializados uma vez e nunca são modificados em threads ou não</span><span class="sxs-lookup"><span data-stu-id="4867b-156">You can either share light-weight resources (like solid color brushes and text formats) that are initialized once and then never modified across threads or not</span></span>

## <a name="summary"></a><span data-ttu-id="4867b-157">Resumo</span><span class="sxs-lookup"><span data-stu-id="4867b-157">Summary</span></span>

<span data-ttu-id="4867b-158">Ao desenvolver aplicativos [Direct2D](./direct2d-portal.md) multithread, você deve criar uma fábrica de Direct2D multithread e, em seguida, derivar todos os recursos de Direct2D dessa fábrica.</span><span class="sxs-lookup"><span data-stu-id="4867b-158">When you develop multithreaded [Direct2D](./direct2d-portal.md) apps, you must create a multithreaded Direct2D factory then derive all Direct2D resources from that factory.</span></span> <span data-ttu-id="4867b-159">Se um thread fizer chamadas de [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) ou dxgi, você também deverá adquirir explicitamente e aplicar o bloqueio Direct2D para proteger essas chamadas de Direct3D ou dxgi.</span><span class="sxs-lookup"><span data-stu-id="4867b-159">If a thread will make [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) or DXGI calls, you also must explicitly acquire then apply the Direct2D lock to guard those Direct3D or DXGI calls.</span></span> <span data-ttu-id="4867b-160">Além disso, você deve garantir a integridade do contexto tendo uma cópia de recursos mutáveis para cada thread.</span><span class="sxs-lookup"><span data-stu-id="4867b-160">Moreover, you must ensure context integrity by having a copy of mutable resources for each thread.</span></span>
