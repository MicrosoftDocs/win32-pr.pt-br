---
title: Compactação de bloco
description: Descreve como funciona a compactação de bloco e como usá-la em WIC e Direct2D.
ms.assetid: 52AF86A5-16E8-4AC8-BB67-CC2F1A3635B5
ms.topic: article
ms.date: 05/31/2018
ms.custom: seodec18
ms.openlocfilehash: aeb6ba9427a04f7a251a1d59062be508e4249b41
ms.sourcegitcommit: ee06501cc29132927ade9813e0888aaa4decc487
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/28/2021
ms.locfileid: "104506313"
---
# <a name="block-compression"></a><span data-ttu-id="7518f-103">Compactação de bloco</span><span class="sxs-lookup"><span data-stu-id="7518f-103">Block compression</span></span>

<span data-ttu-id="7518f-104">A partir do Windows 8.1, o Direct2D dá suporte a vários formatos de pixel compactados de bloco.</span><span class="sxs-lookup"><span data-stu-id="7518f-104">Starting with Windows 8.1, Direct2D supports several block compressed pixel formats.</span></span> <span data-ttu-id="7518f-105">Além disso, Windows 8.1 contém um novo codec DDS do Windows Imaging Component (WIC) para habilitar o carregamento e o armazenamento de imagens compactadas em bloco no formato de arquivo DDS.</span><span class="sxs-lookup"><span data-stu-id="7518f-105">In addition, Windows 8.1 contains a new Windows Imaging Component (WIC) DDS codec to enable loading and storing block compressed images in the DDS file format.</span></span> <span data-ttu-id="7518f-106">A compactação de bloco é uma técnica para reduzir a quantidade de memória gráfica consumida pelo conteúdo de bitmap.</span><span class="sxs-lookup"><span data-stu-id="7518f-106">Block compression is a technique for reducing the amount of graphics memory that is consumed by bitmap content.</span></span> <span data-ttu-id="7518f-107">Usando a compactação de bloco, seu aplicativo pode reduzir o consumo de memória e tempos de carregamento para as mesmas imagens de resolução.</span><span class="sxs-lookup"><span data-stu-id="7518f-107">By using block compression, your app can reduce memory consumption and load times for the same resolution images.</span></span> <span data-ttu-id="7518f-108">Ou, seu aplicativo pode usar imagens de resolução mais ou mais altas enquanto ainda estiver consumindo a mesma superfície de memória de GPU.</span><span class="sxs-lookup"><span data-stu-id="7518f-108">Or, your app can use more or higher resolution images while still consuming the same GPU memory footprint.</span></span>

<span data-ttu-id="7518f-109">A compactação de bloco foi usada por aplicativos de Direct3D por muito tempo, e com o Windows 8.1 também está disponível para os desenvolvedores de aplicativos convencionais e Direct2D.</span><span class="sxs-lookup"><span data-stu-id="7518f-109">Block compression has been used by Direct3D applications for a long time, and with Windows 8.1 is available to mainstream and Direct2D application developers as well.</span></span>

<span data-ttu-id="7518f-110">Este tópico descreve como funciona a compactação de bloco e como usá-la em WIC e Direct2D.</span><span class="sxs-lookup"><span data-stu-id="7518f-110">This topic describes how block compression works and how to use it in WIC and Direct2D.</span></span>

## <a name="about-block-compression"></a><span data-ttu-id="7518f-111">Sobre a compactação de bloco</span><span class="sxs-lookup"><span data-stu-id="7518f-111">About Block Compression</span></span>

<span data-ttu-id="7518f-112">A [compactação de bloqueio](/windows/desktop/direct3d10/d3d10-graphics-programming-guide-resources-block-compression) (BC) refere-se a uma classe de técnicas de compactação para reduzir os tamanhos de textura.</span><span class="sxs-lookup"><span data-stu-id="7518f-112">[Block Compression](/windows/desktop/direct3d10/d3d10-graphics-programming-guide-resources-block-compression) (BC) refers to a class of compression techniques for reducing texture sizes.</span></span> <span data-ttu-id="7518f-113">O Direct3D 11 dá suporte a até 7 formatos de BC diferentes, dependendo do nível de recurso.</span><span class="sxs-lookup"><span data-stu-id="7518f-113">Direct3D 11 supports up to 7 different BC formats depending on feature level.</span></span> <span data-ttu-id="7518f-114">No Windows 8.1 Direct2D apresenta suporte para os formatos BC1, BC2 e BC3 que estão disponíveis em todos os níveis de recurso.</span><span class="sxs-lookup"><span data-stu-id="7518f-114">In Windows 8.1 Direct2D introduces support for the BC1, BC2 and BC3 formats which are available across all feature levels.</span></span>

### <a name="how-block-compression-works"></a><span data-ttu-id="7518f-115">Como funciona a compactação de bloco</span><span class="sxs-lookup"><span data-stu-id="7518f-115">How Block Compression works</span></span>

<span data-ttu-id="7518f-116">Todos os formatos compactados de bloco usam a mesma técnica básica para reduzir o espaço consumido pelos dados coloridos.</span><span class="sxs-lookup"><span data-stu-id="7518f-116">The block compressed formats all use the same basic technique to reduce the space consumed by color data.</span></span> <span data-ttu-id="7518f-117">Esta seção resume o algoritmo mais simples, BC1.</span><span class="sxs-lookup"><span data-stu-id="7518f-117">This section summarizes the simplest algorithm, BC1.</span></span> <span data-ttu-id="7518f-118">Para obter uma explicação mais detalhada, consulte [Bloquear compactação](/windows/desktop/direct3d11/texture-block-compression-in-direct3d-11).</span><span class="sxs-lookup"><span data-stu-id="7518f-118">For a more detailed explanation, see [Block Compression](/windows/desktop/direct3d11/texture-block-compression-in-direct3d-11).</span></span>

<span data-ttu-id="7518f-119">Primeiro, a imagem é dividida em blocos de 4 por 4 pixels.</span><span class="sxs-lookup"><span data-stu-id="7518f-119">First, the image is divided into blocks of 4 by 4 pixels.</span></span> <span data-ttu-id="7518f-120">Cada bloco é compactado separadamente.</span><span class="sxs-lookup"><span data-stu-id="7518f-120">Each block is compressed separately.</span></span>

> [!Note]  
> <span data-ttu-id="7518f-121">Isso significa que a largura e a altura de uma imagem devem ser um múltiplo de 4 pixels para que ela seja bloqueada.</span><span class="sxs-lookup"><span data-stu-id="7518f-121">This means an image’s width and height must each be a multiple of 4 pixel for it to be block compressed.</span></span>

 

<span data-ttu-id="7518f-122">Esta imagem de exemplo mostra um bloco de pixel 4x4 dentro de uma imagem.</span><span class="sxs-lookup"><span data-stu-id="7518f-122">This example image shows a 4x4 pixel block within an image.</span></span>

![uma imagem de exemplo mostra um bloco de pixel 4x4 dentro de uma imagem.](images/dds1.png)

<span data-ttu-id="7518f-124">Em seguida, dentro de um bloco 4 por 4, duas cores de "referência" são selecionadas e codificadas como valores de 2 16 bits (5 bits vermelho, 6 bits verde, 5 bits azul).</span><span class="sxs-lookup"><span data-stu-id="7518f-124">Next, within a 4 by 4 block, two “reference” colors are selected and are encoded as two 16 bit values (5 bits red, 6 bits green, 5 bits blue).</span></span> <span data-ttu-id="7518f-125">A escolha dessas cores afeta significativamente a qualidade da imagem e não é trivial.</span><span class="sxs-lookup"><span data-stu-id="7518f-125">The choice of these colors significantly affects image quality and is nontrivial.</span></span> <span data-ttu-id="7518f-126">Duas cores intermediárias são calculadas por interpolação linear entre as duas cores de referência no espaço de cores RGB.</span><span class="sxs-lookup"><span data-stu-id="7518f-126">Two intermediate colors are calculated by linearly interpolating between the two reference colors in the RGB color space.</span></span> <span data-ttu-id="7518f-127">Isso produz um total de 4 cores possíveis diferentes; cada cor é atribuída a um valor de índice de dois bits.</span><span class="sxs-lookup"><span data-stu-id="7518f-127">This produces a total of 4 different possible colors; each color is assigned a two bit index value.</span></span> <span data-ttu-id="7518f-128">No entanto, observe que apenas as duas cores do ponto de extremidade precisam ser armazenadas conforme a interpolação é fixa.</span><span class="sxs-lookup"><span data-stu-id="7518f-128">However, note that only the two endpoint colors need to be stored as the interpolation is fixed.</span></span>

<span data-ttu-id="7518f-129">Nesta figura, as cores 0 e 3 são selecionadas como cores de "referência" para o bloco, enquanto as cores 1 e 2 são calculadas usando interpolação linear.</span><span class="sxs-lookup"><span data-stu-id="7518f-129">In this figure, colors 0 and 3 are selected as “reference” colors for the block, while colors 1 and 2 are calculated using linear interpolation.</span></span>

![Diagrama que mostra o cálculo de 4 valores de cor para representar o bloco.](images/dds2.png)

<span data-ttu-id="7518f-131">Por fim, cada pixel no bloco é mapeado para uma das quatro cores calculadas anteriormente e cada pixel é codificado usando o valor de índice de dois bits.</span><span class="sxs-lookup"><span data-stu-id="7518f-131">Finally, every pixel in the block is mapped to one of the four previously calculated colors, and each pixel is encoded using the two bit index value.</span></span>

<span data-ttu-id="7518f-132">A quantidade total de dados usados para representar esses 16 pixels é:</span><span class="sxs-lookup"><span data-stu-id="7518f-132">The total amount of data used to represent these 16 pixels is:</span></span>

`16 bits [to define a reference color] * 2 + 2 bits * 16 [number of pixels]  = 64 bits`

<span data-ttu-id="7518f-133">Isso resulta em uma densidade média de 4 bits por pixel.</span><span class="sxs-lookup"><span data-stu-id="7518f-133">This results in an average density of 4 bits per pixel.</span></span> <span data-ttu-id="7518f-134">Para comparação, o \_ \_ formato B8G8R8A8 UNORM pixel do formato dxgi comum \_ consome 32 bits por pixel.</span><span class="sxs-lookup"><span data-stu-id="7518f-134">For comparison, the common DXGI\_FORMAT\_B8G8R8A8\_UNORM pixel format consumes 32 bits per pixel.</span></span>

<span data-ttu-id="7518f-135">Este diagrama mostra que cada pixel é codificado como um índice de 2 bits.</span><span class="sxs-lookup"><span data-stu-id="7518f-135">This diagram shows that each pixel is encoded as a 2 bit index.</span></span> <span data-ttu-id="7518f-136">O bloco inteiro é codificado em 64 bits.</span><span class="sxs-lookup"><span data-stu-id="7518f-136">The entire block is encoded in 64 bits.</span></span>

![Calculando 4 valores de cor para representar o bloco.](images/dds3.png)

<span data-ttu-id="7518f-138">Há variações para dar suporte a dados alfa e números variados de canais de cor.</span><span class="sxs-lookup"><span data-stu-id="7518f-138">There are variations to support alpha data and varying numbers of color channels.</span></span> <span data-ttu-id="7518f-139">BC6H e BC7 usam algoritmos significativamente diferentes para dar suporte ao conteúdo de intervalo dinâmico alto (HDR) e aumentar a qualidade da imagem, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="7518f-139">BC6H and BC7 use significantly different algorithms in order to support high dynamic range (HDR) content and increase image quality, respectively.</span></span>

### <a name="directdraw-surface-dds-file-format"></a><span data-ttu-id="7518f-140">Formato de arquivo da superfície do DirectDraw (DDS)</span><span class="sxs-lookup"><span data-stu-id="7518f-140">DirectDraw Surface (DDS) file format</span></span>

<span data-ttu-id="7518f-141">Bloquear dados compactados normalmente são armazenados em arquivos de [superfície do DirectDraw (DDS)](/windows/desktop/direct3ddds/dx-graphics-dds-reference) .</span><span class="sxs-lookup"><span data-stu-id="7518f-141">Block compressed data is typically stored in [DirectDraw Surface (DDS)](/windows/desktop/direct3ddds/dx-graphics-dds-reference) files.</span></span> <span data-ttu-id="7518f-142">Você pode estar familiarizado com arquivos DDS se você for um desenvolvedor de Direct3D.</span><span class="sxs-lookup"><span data-stu-id="7518f-142">You may be familiar with DDS files if you are a Direct3D developer.</span></span> <span data-ttu-id="7518f-143">Observe que o Direct2D dá suporte apenas a determinados recursos de DDS; para obter mais informações, consulte [requisitos de DDS](#dds-requirements).</span><span class="sxs-lookup"><span data-stu-id="7518f-143">Note that Direct2D only supports certain DDS features; for more information see [DDS Requirements](#dds-requirements).</span></span>

### <a name="advantages-of-block-compression"></a><span data-ttu-id="7518f-144">Vantagens da compactação de bloco</span><span class="sxs-lookup"><span data-stu-id="7518f-144">Advantages of block compression</span></span>

<span data-ttu-id="7518f-145">Os formatos compactados de bloco diferem dos formatos comuns de compactação de imagem do setor, como JPEG, nos formatos de BC com suporte nativo pelas GPUs modernas.</span><span class="sxs-lookup"><span data-stu-id="7518f-145">Block compressed formats differ from common industry image compression formats such as JPEG in that BC formats are natively supported by modern GPUs.</span></span> <span data-ttu-id="7518f-146">Isso significa que você pode carregar diretamente uma imagem compactada de bloco na GPU sem qualquer decodificação ou descompactação.</span><span class="sxs-lookup"><span data-stu-id="7518f-146">This means that you can directly load a block compressed image onto the GPU without any decoding or decompression.</span></span> <span data-ttu-id="7518f-147">Os formatos de BC consomem de 4 a 8 bits por pixel em média; quando comparado a um bitmap típico descompactado de 32 bits por pixel BGRA, isso resulta na economia de memória de 75% a 87,5%.</span><span class="sxs-lookup"><span data-stu-id="7518f-147">BC formats consume from 4 to 8 bits per pixel on average; when compared to a typical uncompressed 32 bit per pixel BGRA bitmap, this results in memory savings of 75% to 87.5%.</span></span> <span data-ttu-id="7518f-148">Além disso, como não há nenhuma etapa de decodificação, o tempo para carregar uma imagem de BC é significativamente reduzido em comparação com formatos como JPEG.</span><span class="sxs-lookup"><span data-stu-id="7518f-148">Also, because there is no decode step, the time to load a BC image is significantly reduced compared to formats like JPEG.</span></span>

### <a name="when-to-use-block-compression"></a><span data-ttu-id="7518f-149">Quando usar a compactação de bloco</span><span class="sxs-lookup"><span data-stu-id="7518f-149">When to use Block Compression</span></span>

<span data-ttu-id="7518f-150">Você deve considerar o uso de imagens compactadas em bloco em seu aplicativo, em vez de outros formatos, como JPEG, se quiser reduzir o consumo de memória de bitmaps ou se quiser reduzir os tempos de decodificação e carregamento.</span><span class="sxs-lookup"><span data-stu-id="7518f-150">You should consider using block compressed images in your app instead of other formats such as JPEG if you want to reduce the memory consumption of bitmaps or want to reduce decode and load times.</span></span>

<span data-ttu-id="7518f-151">No entanto, a compactação de bloco não é apropriada para todos os casos e requer algumas compensações.</span><span class="sxs-lookup"><span data-stu-id="7518f-151">However, block compression is not appropriate for all cases and requires some tradeoffs.</span></span> <span data-ttu-id="7518f-152">Primeiro, os algoritmos de compactação de bloco estão com perdas.</span><span class="sxs-lookup"><span data-stu-id="7518f-152">First, the block compression algorithms are lossy.</span></span> <span data-ttu-id="7518f-153">A compactação de bloco funciona bem com conteúdo fotográfico natural, mas pode introduzir artefatos visuais indesejados em imagens com limites nítidos de alto contraste, como capturas de tela geradas por computador.</span><span class="sxs-lookup"><span data-stu-id="7518f-153">Block compression works well with natural photographic content but can introduce unwanted visual artifacts into images with sharp, high contrast boundaries, such as computer-generated screenshots.</span></span> <span data-ttu-id="7518f-154">Você deve garantir que seus ativos de imagem compactada em bloco tenham qualidade de imagem aceitável antes de usá-los.</span><span class="sxs-lookup"><span data-stu-id="7518f-154">You should ensure that your block compressed image assets have acceptable image quality before using them.</span></span>

<span data-ttu-id="7518f-155">Em segundo lugar, bloquear arquivos DDS compactados geralmente consome mais espaço em disco do que imagens JPEG comparáveis.</span><span class="sxs-lookup"><span data-stu-id="7518f-155">Second, block compressed DDS files generally consume more space on disk than comparable JPEG images.</span></span> <span data-ttu-id="7518f-156">Isso, por sua vez, aumentará o tamanho do pacote do aplicativo e os requisitos de largura de banda da rede.</span><span class="sxs-lookup"><span data-stu-id="7518f-156">This in turn will increase your app’s package size and network bandwidth requirements.</span></span>

## <a name="using-block-compression"></a><span data-ttu-id="7518f-157">Usando compactação de bloco</span><span class="sxs-lookup"><span data-stu-id="7518f-157">Using Block Compression</span></span>

<span data-ttu-id="7518f-158">Esta seção explica como gerar e usar os ativos compactados em bloco em um aplicativo Direct2D.</span><span class="sxs-lookup"><span data-stu-id="7518f-158">This section explains how to generate and use block compressed assets in a Direct2D app.</span></span>

### <a name="overview"></a><span data-ttu-id="7518f-159">Visão geral</span><span class="sxs-lookup"><span data-stu-id="7518f-159">Overview</span></span>

<span data-ttu-id="7518f-160">Bloquear arquivos DDS compactados são um formato otimizado para tempo de execução, o que significa que eles são especificamente otimizados para um bom desempenho no tempo de execução do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="7518f-160">Block compressed DDS files are a runtime-optimized format, meaning that they are specifically optimized for good performance at app runtime.</span></span> <span data-ttu-id="7518f-161">Recomendamos que você continue a usar a criação de ativos e o pipeline de edição existentes e converta somente em um formato de bloco compactado ao importá-los para seu projeto de aplicativo ou em tempo de compilação.</span><span class="sxs-lookup"><span data-stu-id="7518f-161">We recommend that you continue to use your existing asset creation and editing pipeline, and only convert to a block compressed format when you import them into your application project, or at build time.</span></span>

### <a name="dds-requirements"></a><span data-ttu-id="7518f-162">Requisitos de DDS</span><span class="sxs-lookup"><span data-stu-id="7518f-162">DDS requirements</span></span>

<span data-ttu-id="7518f-163">O formato de arquivo DDS foi projetado para dar suporte a uma ampla gama de recursos usados no Direct3D.</span><span class="sxs-lookup"><span data-stu-id="7518f-163">The DDS file format was designed to support a wide range of features used in Direct3D.</span></span> <span data-ttu-id="7518f-164">Direct2D usa apenas um subconjunto desses recursos.</span><span class="sxs-lookup"><span data-stu-id="7518f-164">Direct2D only uses a subset of these features.</span></span> <span data-ttu-id="7518f-165">Portanto, ao criar imagens DDS para uso com Direct2D, você deve ter em mente as seguintes restrições:</span><span class="sxs-lookup"><span data-stu-id="7518f-165">Therefore when you are creating DDS images for use with Direct2D, you must keep in mind the following restrictions:</span></span>

-   <span data-ttu-id="7518f-166">Somente os seguintes valores de [**\_ formato dxgi**](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format) são permitidos:</span><span class="sxs-lookup"><span data-stu-id="7518f-166">Only the following [**DXGI\_FORMAT**](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format) values are allowed:</span></span>
    -   <span data-ttu-id="7518f-167">\_Formato dxgi \_ BC1 \_ UNORM</span><span class="sxs-lookup"><span data-stu-id="7518f-167">DXGI\_FORMAT\_BC1\_UNORM</span></span>
    -   <span data-ttu-id="7518f-168">\_Formato dxgi \_ BC2 \_ UNORM</span><span class="sxs-lookup"><span data-stu-id="7518f-168">DXGI\_FORMAT\_BC2\_UNORM</span></span>
    -   <span data-ttu-id="7518f-169">\_Formato dxgi \_ BC3 \_ UNORM</span><span class="sxs-lookup"><span data-stu-id="7518f-169">DXGI\_FORMAT\_BC3\_UNORM</span></span>
-   <span data-ttu-id="7518f-170">Os dados alfa precalculados devem ser usados.</span><span class="sxs-lookup"><span data-stu-id="7518f-170">Premultiplied alpha data must be used.</span></span> <span data-ttu-id="7518f-171">Isso inclui arquivos DDS herdados usando formatos que definem explicitamente alfa (DXT1, DXT2, DXT4), bem como arquivos DDS que usam a \_ estrutura do cabeçalho DDS \_ DX10 com os \_ \_ \_ \_ \_ \_ valores precalculados do modo alfa do DDS opaco e DDS.</span><span class="sxs-lookup"><span data-stu-id="7518f-171">This includes legacy DDS files using formats that explicitly define premultiplied alpha (DXT1, DXT2, DXT4), as well as DDS files that use the DDS\_HEADER\_DX10 structure with the DDS\_ALPHA\_MODE\_OPAQUE and DDS\_ALPHA\_MODE\_PREMULTIPLIED values.</span></span>
-   <span data-ttu-id="7518f-172">As dimensões X e Y devem ser múltiplos de 4 pixels.</span><span class="sxs-lookup"><span data-stu-id="7518f-172">The X and Y dimensions must be multiples of 4 pixels.</span></span>
-   <span data-ttu-id="7518f-173">As texturas de volume, cubemaps, mipmaps ou de textura não são permitidas.</span><span class="sxs-lookup"><span data-stu-id="7518f-173">Volume textures, cubemaps, mipmaps, or texture arrays are not allowed.</span></span> <span data-ttu-id="7518f-174">Você só deve usar imagens de origem de quadro único.</span><span class="sxs-lookup"><span data-stu-id="7518f-174">You should only use single frame source images.</span></span>

### <a name="generating-block-compressed-assets"></a><span data-ttu-id="7518f-175">Gerando ativos compactados de bloco</span><span class="sxs-lookup"><span data-stu-id="7518f-175">Generating Block Compressed assets</span></span>

<span data-ttu-id="7518f-176">Há uma variedade de ferramentas de criação de DDS disponíveis para criar ou converter arquivos DDS compactados de bloqueio.</span><span class="sxs-lookup"><span data-stu-id="7518f-176">There are a variety of DDS authoring tools available to create or convert block compressed DDS files.</span></span> <span data-ttu-id="7518f-177">Observação nem todas as ferramentas dão suporte aos requisitos de uso de arquivos DDS com Direct2D, conforme detalhado na seção anterior.</span><span class="sxs-lookup"><span data-stu-id="7518f-177">Note not all tools support the requirements for using DDS files with Direct2D, as detailed in the previous section.</span></span>

<span data-ttu-id="7518f-178">A partir do Visual Studio 2013, você pode fazer com que o Visual Studio converta ativos visuais existentes, como JPEG e PNG, no formato de bloqueio de DDS correto como uma parte automática do seu processo de compilação.</span><span class="sxs-lookup"><span data-stu-id="7518f-178">Beginning with Visual Studio 2013, you can have Visual Studio convert existing visual assets such as JPEG and PNG to the correct DDS block compressed format as an automatic part of your build process.</span></span> <span data-ttu-id="7518f-179">Isso é feito usando a etapa de compilação personalizada da tarefa conteúdo da imagem.</span><span class="sxs-lookup"><span data-stu-id="7518f-179">This is accomplished using the Image Content Task custom build step.</span></span>

<span data-ttu-id="7518f-180">Para obter informações sobre como configurar isso para seu projeto, consulte: [como exportar uma textura para uso com aplicativos Direct2D ou Javascipt](/previous-versions/visualstudio/visual-studio-2013/dn392693(v=vs.120)).</span><span class="sxs-lookup"><span data-stu-id="7518f-180">For information on how to set this up for your project, see: [How to: Export a Texture for Use with Direct2D or Javascipt Apps](/previous-versions/visualstudio/visual-studio-2013/dn392693(v=vs.120)).</span></span>

### <a name="direct2d-apis"></a><span data-ttu-id="7518f-181">APIs do Direct2D</span><span class="sxs-lookup"><span data-stu-id="7518f-181">Direct2D APIs</span></span>

<span data-ttu-id="7518f-182">Direct2D é atualizado no Windows 8.1 para dar suporte aos seguintes formatos de pixel:</span><span class="sxs-lookup"><span data-stu-id="7518f-182">Direct2D is updated in Windows 8.1 to support the following pixel formats:</span></span>

-   <span data-ttu-id="7518f-183">\_Formato dxgi \_ BC1 \_ UNORM</span><span class="sxs-lookup"><span data-stu-id="7518f-183">DXGI\_FORMAT\_BC1\_UNORM</span></span>
-   <span data-ttu-id="7518f-184">\_Formato dxgi \_ BC2 \_ UNORM</span><span class="sxs-lookup"><span data-stu-id="7518f-184">DXGI\_FORMAT\_BC2\_UNORM</span></span>
-   <span data-ttu-id="7518f-185">\_Formato dxgi \_ BC3 \_ UNORM</span><span class="sxs-lookup"><span data-stu-id="7518f-185">DXGI\_FORMAT\_BC3\_UNORM</span></span>

<span data-ttu-id="7518f-186">Para os formatos anteriores, você deve usar alfa-geomultiplicado.</span><span class="sxs-lookup"><span data-stu-id="7518f-186">For the preceding formats, you must use premultiplied alpha.</span></span> <span data-ttu-id="7518f-187">Além disso, esses formatos só são válidos para uso como origem, não como um destino.</span><span class="sxs-lookup"><span data-stu-id="7518f-187">In addition, these formats are only valid for use as a source, not a target.</span></span> <span data-ttu-id="7518f-188">Por exemplo, isso significa que você pode criar um bitmap Direct2D usando BC1, mas não um contexto de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="7518f-188">For example, this means that you can create a Direct2D bitmap using BC1, but not a device context.</span></span>

<span data-ttu-id="7518f-189">Os métodos a seguir são atualizados no Windows 8.1 para oferecer suporte aos formatos de BC:</span><span class="sxs-lookup"><span data-stu-id="7518f-189">The following methods are updated in Windows 8.1 to support BC formats:</span></span>

-   [<span data-ttu-id="7518f-190">**ID2D1DeviceContext:: IsDxgiFormatSupported**</span><span class="sxs-lookup"><span data-stu-id="7518f-190">**ID2D1DeviceContext::IsDxgiFormatSupported**</span></span>](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-isdxgiformatsupported)
-   <span data-ttu-id="7518f-191">[**ID2D1DeviceContext:: CreateBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmap(d2d1_size_u_constvoid_uint32_constd2d1_bitmap_properties1__id2d1bitmap1))</span><span class="sxs-lookup"><span data-stu-id="7518f-191">[**ID2D1DeviceContext::CreateBitmap**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmap(d2d1_size_u_constvoid_uint32_constd2d1_bitmap_properties1__id2d1bitmap1))</span></span>
-   <span data-ttu-id="7518f-192">[**ID2D1DeviceContext:: CreateBitmapFromDxgiSurface**](/windows/desktop/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromdxgisurface(idxgisurface_constd2d1_bitmap_properties1__id2d1bitmap1))</span><span class="sxs-lookup"><span data-stu-id="7518f-192">[**ID2D1DeviceContext::CreateBitmapFromDxgiSurface**](/windows/desktop/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createbitmapfromdxgisurface(idxgisurface_constd2d1_bitmap_properties1__id2d1bitmap1))</span></span>
-   [<span data-ttu-id="7518f-193">**ID2D1RenderTarget:: CreateSharedBitmap**</span><span class="sxs-lookup"><span data-stu-id="7518f-193">**ID2D1RenderTarget::CreateSharedBitmap**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createsharedbitmap)
-   [<span data-ttu-id="7518f-194">**ID2D1RenderTarget:: CreateBitmapFromWicBitmap**</span><span class="sxs-lookup"><span data-stu-id="7518f-194">**ID2D1RenderTarget::CreateBitmapFromWicBitmap**</span></span>](id2d1rendertarget-createbitmapfromwicbitmap.md)
-   [<span data-ttu-id="7518f-195">**ID2D1Bitmap::CopyFromMemory**</span><span class="sxs-lookup"><span data-stu-id="7518f-195">**ID2D1Bitmap::CopyFromMemory**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfrommemory)
-   [<span data-ttu-id="7518f-196">**ID2D1Bitmap::CopyFromBitmap**</span><span class="sxs-lookup"><span data-stu-id="7518f-196">**ID2D1Bitmap::CopyFromBitmap**</span></span>](/windows/win32/api/d2d1/nf-d2d1-id2d1bitmap-copyfrombitmap)
-   [<span data-ttu-id="7518f-197">**ID2D1Bitmap1:: getsurface**</span><span class="sxs-lookup"><span data-stu-id="7518f-197">**ID2D1Bitmap1::GetSurface**</span></span>](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1bitmap1-getsurface)

<span data-ttu-id="7518f-198">Observe que o [**CreateBitmapFromWicBitmap**](id2d1devicecontext-createbitmapfromwicbitmap-overload.md) usa [**IWICBitmapSource**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapsource) como uma interface; no entanto, no Windows 8.1 o WIC não dá suporte à obtenção de dados compactados de bloqueio de **IWICBitmapSource**, e não há nenhum formato de pixel do WIC correspondente ao \_ formato dxgi \_ BC1 \_ UNORM, etc. Em vez disso, **CreateBitmapFromWicBitmap** determina se **IWICBITMAPSOURCE** é um DDS [**IWICBitmapFrameDecode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframedecode) válido e carrega diretamente os dados compactados em bloco.</span><span class="sxs-lookup"><span data-stu-id="7518f-198">Note that [**CreateBitmapFromWicBitmap**](id2d1devicecontext-createbitmapfromwicbitmap-overload.md) takes [**IWICBitmapSource**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapsource) as an interface; however in Windows 8.1 WIC does not support obtaining block compressed data from **IWICBitmapSource**, and there is no WIC pixel format corresponding to DXGI\_FORMAT\_BC1\_UNORM, etc. Instead, **CreateBitmapFromWicBitmap** determines if the **IWICBitmapSource** is a valid DDS [**IWICBitmapFrameDecode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframedecode) and directly loads the block compressed data.</span></span> <span data-ttu-id="7518f-199">Você pode especificar explicitamente o formato de pixel no [**d2d1 \_ bitmap \_ PROPERTIES1**](/windows/desktop/api/D2D1_1/ns-d2d1_1-d2d1_bitmap_properties1) struct ou permitir que Direct2D determine automaticamente o formato correto.</span><span class="sxs-lookup"><span data-stu-id="7518f-199">You can either explicitly specify the pixel format in the [**D2D1\_BITMAP\_PROPERTIES1**](/windows/desktop/api/D2D1_1/ns-d2d1_1-d2d1_bitmap_properties1) struct, or allow Direct2D to automatically determine the correct format.</span></span>

### <a name="windows-imaging-component-apis"></a><span data-ttu-id="7518f-200">APIs do Windows Imaging Component</span><span class="sxs-lookup"><span data-stu-id="7518f-200">Windows Imaging Component APIs</span></span>

<span data-ttu-id="7518f-201">O Windows Imaging Component (WIC) adiciona um novo codec DDS no Windows 8.1.</span><span class="sxs-lookup"><span data-stu-id="7518f-201">The Windows Imaging Component (WIC) adds a new DDS codec in Windows 8.1.</span></span> <span data-ttu-id="7518f-202">Além disso, ele adiciona novas interfaces que dão suporte ao acesso a dados específicos de DDS, incluindo dados de pixels compactados em bloco:</span><span class="sxs-lookup"><span data-stu-id="7518f-202">In addition, it adds new interfaces that support accessing DDS-specific data, including block compressed pixel data:</span></span>

-   [<span data-ttu-id="7518f-203">**IWICDdsDecoder**</span><span class="sxs-lookup"><span data-stu-id="7518f-203">**IWICDdsDecoder**</span></span>](/windows/desktop/api/wincodec/nn-wincodec-iwicddsdecoder)
-   [<span data-ttu-id="7518f-204">**IWICDdsEncoder**</span><span class="sxs-lookup"><span data-stu-id="7518f-204">**IWICDdsEncoder**</span></span>](/windows/desktop/api/wincodec/nn-wincodec-iwicddsencoder)
-   [<span data-ttu-id="7518f-205">**IWICDdsFrameDecode**</span><span class="sxs-lookup"><span data-stu-id="7518f-205">**IWICDdsFrameDecode**</span></span>](/windows/desktop/api/wincodec/nn-wincodec-iwicddsframedecode)

### <a name="block-compressed-wic-pixel-formats"></a><span data-ttu-id="7518f-206">Bloquear formatos de pixel WIC compactados</span><span class="sxs-lookup"><span data-stu-id="7518f-206">Block Compressed WIC pixel formats</span></span>

<span data-ttu-id="7518f-207">Não há novos formatos de pixel compactados em bloco de WIC no Windows 8.1.</span><span class="sxs-lookup"><span data-stu-id="7518f-207">There are no new WIC block compressed pixel formats in Windows 8.1.</span></span> <span data-ttu-id="7518f-208">Em vez disso, se você obtiver um [**IWICBitmapFrameDecode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframedecode) do decodificador DDS e chamar [**CopyPixels**](/windows/desktop/api/wincodec/nf-wincodec-iwicbitmapsource-copypixels), receberá pixels não compactados padrão, como WICPixelFormat32bppPBGRA.</span><span class="sxs-lookup"><span data-stu-id="7518f-208">Instead, if you obtain an [**IWICBitmapFrameDecode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframedecode) from the DDS decoder and call [**CopyPixels**](/windows/desktop/api/wincodec/nf-wincodec-iwicbitmapsource-copypixels), you will receive standard uncompressed pixels such as WICPixelFormat32bppPBGRA.</span></span> <span data-ttu-id="7518f-209">Você pode usar [**IWICDdsFrameDecode:: CopyBlocks**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsframedecode-copyblocks) para obter os dados compactados de blocos brutos na forma de um buffer de memória de um arquivo DDS.</span><span class="sxs-lookup"><span data-stu-id="7518f-209">You can use [**IWICDdsFrameDecode::CopyBlocks**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsframedecode-copyblocks) to obtain the raw block compressed data in the form of a memory buffer from a DDS file.</span></span>

### <a name="multi-frame-dds-access"></a><span data-ttu-id="7518f-210">Acesso de DDS de vários quadros</span><span class="sxs-lookup"><span data-stu-id="7518f-210">Multi-frame DDS access</span></span>

<span data-ttu-id="7518f-211">O formato de arquivo DDS permite que várias imagens relacionadas sejam armazenadas em um único arquivo.</span><span class="sxs-lookup"><span data-stu-id="7518f-211">The DDS file format allows for multiple related images to be stored in a single file.</span></span> <span data-ttu-id="7518f-212">Por exemplo, um arquivo DDS pode conter um cubemap, uma textura de volume ou uma matriz de textura, que pode ser mipmapped.</span><span class="sxs-lookup"><span data-stu-id="7518f-212">For example, a DDS file may contain a cubemap, volume texture, or texture array, all of which can be mipmapped.</span></span> <span data-ttu-id="7518f-213">No Direct3D, essas várias imagens são expostas como subrecursos.</span><span class="sxs-lookup"><span data-stu-id="7518f-213">In Direct3D, these multiple images are exposed as subresources.</span></span> <span data-ttu-id="7518f-214">No WIC, várias imagens são expostas como quadros ([**IWICBitmapFrameDecode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframedecode) e [**IWICBitmapFrameEncode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframeencode)).</span><span class="sxs-lookup"><span data-stu-id="7518f-214">In WIC, multiple images are exposed as frames ([**IWICBitmapFrameDecode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframedecode) and [**IWICBitmapFrameEncode**](/windows/desktop/api/wincodec/nn-wincodec-iwicbitmapframeencode)).</span></span>

<span data-ttu-id="7518f-215">O WIC só dá suporte à noção de uma única matriz dimensional de quadros, enquanto o DDS dá suporte a três dimensões independentes (embora somente duas possam ser usadas em um arquivo).</span><span class="sxs-lookup"><span data-stu-id="7518f-215">WIC only supports the notion of a single dimensional array of frames, while DDS supports three independent dimensions (although only two may be used in any one file).</span></span> <span data-ttu-id="7518f-216">O WIC fornece métodos de conveniência para auxiliar no mapeamento entre um subrecurso DDS e um quadro WIC.</span><span class="sxs-lookup"><span data-stu-id="7518f-216">WIC provides convenience methods to assist with mapping between a DDS subresource and WIC frame.</span></span> <span data-ttu-id="7518f-217">Para decodificação, [**IWICDdsDecoder:: GetFrame**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsdecoder-getframe) permite que você especifique o índice de matriz, o nível de MIP e o índice de fatia do subrecurso e retorna o quadro WIC correto.</span><span class="sxs-lookup"><span data-stu-id="7518f-217">For decoding, [**IWICDdsDecoder::GetFrame**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsdecoder-getframe) lets you specify the array index, mip level and slice index of the subresource, and returns the correct WIC frame.</span></span>

<span data-ttu-id="7518f-218">Para codificação, [**IWICDdsEncoder:: CreateNewFrame**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsencoder-createnewframe) computa o índice de matriz resultante, o nível de MIP e o índice de fatia quando você cria um novo quadro.</span><span class="sxs-lookup"><span data-stu-id="7518f-218">For encoding, [**IWICDdsEncoder::CreateNewFrame**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsencoder-createnewframe) computes the resulting array index, mip level and slice index when you create a new frame.</span></span> <span data-ttu-id="7518f-219">Primeiro, você deve ter chamado [**IWICDdsEncoder:: Parameters**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsencoder-setparameters) para definir os parâmetros de arquivo específicos do DDS.</span><span class="sxs-lookup"><span data-stu-id="7518f-219">You must have first called [**IWICDdsEncoder::SetParameters**](/windows/desktop/api/wincodec/nf-wincodec-iwicddsencoder-setparameters) to define the DDS-specific file parameters.</span></span>

## <a name="related-topics"></a><span data-ttu-id="7518f-220">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="7518f-220">Related topics</span></span>

<dl> <dt>

<span data-ttu-id="7518f-221">[Como exportar uma textura para uso com aplicativos Direct2D ou Javascipt](/previous-versions/visualstudio/visual-studio-2013/dn392693(v=vs.120))</span><span class="sxs-lookup"><span data-stu-id="7518f-221">[How to: Export a Texture for Use with Direct2D or Javascipt Apps](/previous-versions/visualstudio/visual-studio-2013/dn392693(v=vs.120))</span></span>
</dt> <dt>

[<span data-ttu-id="7518f-222">Referência para DDS</span><span class="sxs-lookup"><span data-stu-id="7518f-222">Reference for DDS</span></span>](/windows/desktop/direct3ddds/dx-graphics-dds-reference)
</dt> <dt>

[<span data-ttu-id="7518f-223">Compactação de bloco</span><span class="sxs-lookup"><span data-stu-id="7518f-223">Block Compression</span></span>](/windows/desktop/direct3d10/d3d10-graphics-programming-guide-resources-block-compression)
</dt> </dl>

 

 