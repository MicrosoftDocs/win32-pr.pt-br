---
title: Visão geral de realizações de geometria
description: Este tópico descreve como usar a realização de geometria de Direct2D para melhorar o desempenho de renderização de geometria do aplicativo em determinados cenários.
ms.assetid: E8C4C4E5-3102-4F53-847E-A4C2D12A6921
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5b903e047ee58a803a7584aaca407281fc803e30
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "105749282"
---
# <a name="geometry-realizations-overview"></a><span data-ttu-id="57da0-103">Visão geral de realizações de geometria</span><span class="sxs-lookup"><span data-stu-id="57da0-103">Geometry Realizations Overview</span></span>

<span data-ttu-id="57da0-104">Este tópico descreve como usar a realização de geometria de [Direct2D](direct2d-portal.md) para melhorar o desempenho de renderização de geometria do aplicativo em determinados cenários.</span><span class="sxs-lookup"><span data-stu-id="57da0-104">This topic describes how to use [Direct2D](direct2d-portal.md) geometry realizations to improve your app’s geometry rendering performance in certain scenarios.</span></span>

<span data-ttu-id="57da0-105">Ele contém as seções a seguir:</span><span class="sxs-lookup"><span data-stu-id="57da0-105">It contains the following sections:</span></span>

-   [<span data-ttu-id="57da0-106">O que são a realização de geometria?</span><span class="sxs-lookup"><span data-stu-id="57da0-106">What are geometry realizations?</span></span>](#what-are-geometry-realizations)
-   [<span data-ttu-id="57da0-107">Por que usar a realização de geometria?</span><span class="sxs-lookup"><span data-stu-id="57da0-107">Why use geometry realizations?</span></span>](#why-use-geometry-realizations)
-   [<span data-ttu-id="57da0-108">Quando usar a realização de geometrias</span><span class="sxs-lookup"><span data-stu-id="57da0-108">When to use geometry realizations</span></span>](#when-to-use-geometry-realizations)
-   [<span data-ttu-id="57da0-109">Criando realizações de geometria</span><span class="sxs-lookup"><span data-stu-id="57da0-109">Creating geometry realizations</span></span>](#creating-geometry-realizations)
-   [<span data-ttu-id="57da0-110">Desenhando a realização de geometria</span><span class="sxs-lookup"><span data-stu-id="57da0-110">Drawing geometry realizations</span></span>](#drawing-geometry-realizations)
-   [<span data-ttu-id="57da0-111">Dimensionamento de comparações de geometria</span><span class="sxs-lookup"><span data-stu-id="57da0-111">Scaling geometry realizations</span></span>](#scaling-geometry-realizations)
    -   [<span data-ttu-id="57da0-112">Usando a realização de geometria em aplicativos que não são dimensionados</span><span class="sxs-lookup"><span data-stu-id="57da0-112">Using geometry realizations in apps that do not scale</span></span>](#using-geometry-realizations-in-apps-that-do-not-scale)
    -   [<span data-ttu-id="57da0-113">Usando a realização de geometria em aplicativos que são dimensionados por uma pequena quantidade</span><span class="sxs-lookup"><span data-stu-id="57da0-113">Using geometry realizations in apps that scale by a small amount</span></span>](#using-geometry-realizations-in-apps-that-scale-by-a-small-amount)
    -   [<span data-ttu-id="57da0-114">Usando a realização de geometria em aplicativos que são dimensionados por uma grande quantidade</span><span class="sxs-lookup"><span data-stu-id="57da0-114">Using geometry realizations in apps that scale by a large amount</span></span>](#using-geometry-realizations-in-apps-that-scale-by-a-large-amount)
-   [<span data-ttu-id="57da0-115">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="57da0-115">Related topics</span></span>](#related-topics)

## <a name="what-are-geometry-realizations"></a><span data-ttu-id="57da0-116">O que são a realização de geometria?</span><span class="sxs-lookup"><span data-stu-id="57da0-116">What are geometry realizations?</span></span>

<span data-ttu-id="57da0-117">As realizações de geometria, introduzidas na Windows 8.1, são um novo tipo de primitivo de desenho que facilita para aplicativos [Direct2D](direct2d-portal.md) melhorar o desempenho de renderização de geometria em determinados casos.</span><span class="sxs-lookup"><span data-stu-id="57da0-117">Geometry realizations, introduced in Windows 8.1, are a new type of drawing primitive that make it easy for [Direct2D](direct2d-portal.md) apps to improve geometry rendering performance in certain cases.</span></span> <span data-ttu-id="57da0-118">As realizações de geometria são representadas pela interface [**ID2D1GeometryRealization**](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1geometryrealization) .</span><span class="sxs-lookup"><span data-stu-id="57da0-118">Geometry realizations are represented by the [**ID2D1GeometryRealization**](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1geometryrealization) interface.</span></span>

## <a name="why-use-geometry-realizations"></a><span data-ttu-id="57da0-119">Por que usar a realização de geometria?</span><span class="sxs-lookup"><span data-stu-id="57da0-119">Why use geometry realizations?</span></span>

<span data-ttu-id="57da0-120">Quando [Direct2D](direct2d-portal.md) renderiza um objeto [**ID2D1Geometry**](/windows/win32/api/d2d1/nn-d2d1-id2d1geometry) , ele deve converter essa geometria em um formulário que o hardware de gráficos entenda através de um processo chamado Mosaicing.</span><span class="sxs-lookup"><span data-stu-id="57da0-120">When [Direct2D](direct2d-portal.md) renders an [**ID2D1Geometry**](/windows/win32/api/d2d1/nn-d2d1-id2d1geometry) object, it must convert that geometry to a form the graphics hardware understands through a process called tessellation.</span></span> <span data-ttu-id="57da0-121">Normalmente, Direct2D deve incluí Geometry a cada quadro que é desenhado, mesmo que a geometria não seja alterada.</span><span class="sxs-lookup"><span data-stu-id="57da0-121">Typically, Direct2D must tessellate geometry every frame it is drawn, even if the geometry does not change.</span></span> <span data-ttu-id="57da0-122">Se seu aplicativo renderizar a mesma geometria de cada quadro, a nova estrutura de remosaico representará um esforço computacional desperdiçado.</span><span class="sxs-lookup"><span data-stu-id="57da0-122">If your app renders the same geometry every frame, then the repeated re-tessellation represents wasted computational effort.</span></span> <span data-ttu-id="57da0-123">É mais eficiente em cache o mosaico, ou até mesmo a rasterização completa, da geometria e para desenhar essa representação em cache em cada quadro, em vez de inclusão repetidamente.</span><span class="sxs-lookup"><span data-stu-id="57da0-123">It is more computationally efficient to cache the tessellation, or even the full rasterization, of the geometry, and to draw that cached representation each frame instead of repeatedly re-tessellating.</span></span>

<span data-ttu-id="57da0-124">Uma maneira comum de os desenvolvedores resolverem esse problema é armazenar em cache a rasterização completa da geometria.</span><span class="sxs-lookup"><span data-stu-id="57da0-124">A common way that developers solve this problem is to cache the full rasterization of the geometry.</span></span> <span data-ttu-id="57da0-125">Em particular, é comum criar um novo bitmap, rasterizar a geometria para esse bitmap e, em seguida, desenhar esse bitmap para a cena, conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="57da0-125">In particular, it is common to create a new bitmap, rasterize the geometry to that bitmap, and then draw that bitmap to the scene as needed.</span></span> <span data-ttu-id="57da0-126">(Essa abordagem é descrita na seção [renderização de geometria](improving-direct2d-performance.md) de aprimorar o desempenho de aplicativos Direct2D.) Embora essa abordagem seja computacionalmente eficiente, ela tem algumas desvantagens:</span><span class="sxs-lookup"><span data-stu-id="57da0-126">(This approach is described in the [Geometry rendering](improving-direct2d-performance.md) section of Improving the performance of Direct2D apps.) While this approach is very computationally efficient, it has some drawbacks:</span></span>

-   <span data-ttu-id="57da0-127">O bitmap armazenado em cache é sensível a alterações na transformação aplicada à cena.</span><span class="sxs-lookup"><span data-stu-id="57da0-127">The cached bitmap is sensitive to changes in the transform applied to the scene.</span></span> <span data-ttu-id="57da0-128">Por exemplo, dimensionar a rasterização pode resultar em um artefato de dimensionamento perceptível.</span><span class="sxs-lookup"><span data-stu-id="57da0-128">For example, scaling the rasterization can result in a noticeable scaling artifacts.</span></span> <span data-ttu-id="57da0-129">A mitigação desses artefatos com algoritmos de dimensionamento de alta qualidade pode ser computacionalmente cara.</span><span class="sxs-lookup"><span data-stu-id="57da0-129">Mitigating these artifacts with high-quality scaling algorithms can be computationally expensive.</span></span>
-   <span data-ttu-id="57da0-130">O bitmap em cache consome uma quantidade significativa de memória, especialmente se for rasterizado em uma resolução alta.</span><span class="sxs-lookup"><span data-stu-id="57da0-130">The cached bitmap consumes a significant amount of memory, especially if it is rasterized at a high resolution.</span></span>

<span data-ttu-id="57da0-131">A realização de geometria fornece uma maneira alternativa de armazenar em cache a geometria que evita as desvantagens acima.</span><span class="sxs-lookup"><span data-stu-id="57da0-131">Geometry realizations provide an alternative way to cache geometry that avoids the above drawbacks.</span></span> <span data-ttu-id="57da0-132">As realizações de geometria são representadas não por pixels (como é o caso com uma rasterização completa), mas em vez de pontos em um plano matemático.</span><span class="sxs-lookup"><span data-stu-id="57da0-132">Geometry realizations are represented not by pixels (as is the case with a full rasterization) but instead by points on a mathematical plane.</span></span> <span data-ttu-id="57da0-133">Por esse motivo, eles são menos sensíveis do que rasterizações completas para dimensionar e outras manipulações e consomem significativamente menos memória.</span><span class="sxs-lookup"><span data-stu-id="57da0-133">For this reason they are less sensitive than full rasterizations to scaling and other manipulation, and they consume significantly less memory.</span></span>

## <a name="when-to-use-geometry-realizations"></a><span data-ttu-id="57da0-134">Quando usar a realização de geometrias</span><span class="sxs-lookup"><span data-stu-id="57da0-134">When to use geometry realizations</span></span>

<span data-ttu-id="57da0-135">Considere o uso de comparações de geometria quando seu aplicativo renderizar geometrias complexas cujas formas mudam com pouca frequência, mas que podem estar sujeitas a alterações de transformações.</span><span class="sxs-lookup"><span data-stu-id="57da0-135">Consider using geometry realizations when your app renders complex geometries whose shapes change infrequently but which may be subject to changing transforms.</span></span>

<span data-ttu-id="57da0-136">Por exemplo, considere um aplicativo de mapeamento que mostra um mapa estático, mas que permite ao usuário ampliar e reduzir. Este aplicativo pode se beneficiar com a realização de contratações de geometria.</span><span class="sxs-lookup"><span data-stu-id="57da0-136">For example, consider a mapping application that shows a static map but which allows the user to zoom in and out. This app can benefit from using geometry realizations.</span></span> <span data-ttu-id="57da0-137">Como as geometrias que estão sendo renderizadas permanecem estáticas, é útil armazená-las em cache para salvar o trabalho de mosaico.</span><span class="sxs-lookup"><span data-stu-id="57da0-137">Since the geometries being rendered remain static, it is useful to cache them in order to save tessellation work.</span></span> <span data-ttu-id="57da0-138">Mas como os mapas são dimensionados quando o usuário se aplica, o cache de uma rasterização completa não é o ideal, devido aos artefatos de dimensionamento.</span><span class="sxs-lookup"><span data-stu-id="57da0-138">But because the maps are scaled when the user zooms, caching a full rasterization is not ideal, due to scaling artifacts.</span></span> <span data-ttu-id="57da0-139">O cache de realizações de geometria permitiria que o aplicativo evitasse o trabalho de novo mosaico, mantendo a alta qualidade visual durante o dimensionamento.</span><span class="sxs-lookup"><span data-stu-id="57da0-139">Caching geometry realizations would allow the app to avoid re-tessellation work while maintaining high visual quality during scaling.</span></span>

<span data-ttu-id="57da0-140">Por outro lado, considere um aplicativo caleidoscópio com geometria animada que muda continuamente.</span><span class="sxs-lookup"><span data-stu-id="57da0-140">On the other hand, consider a kaleidoscope app with animated geometry that continually changes.</span></span> <span data-ttu-id="57da0-141">Esse aplicativo provavelmente não se beneficiaria do uso de realizações de geometria.</span><span class="sxs-lookup"><span data-stu-id="57da0-141">This app would probably not benefit from using geometry realizations.</span></span> <span data-ttu-id="57da0-142">Como as próprias formas mudam de quadro para quadro, não é útil armazenar em cache seus mosaicos.</span><span class="sxs-lookup"><span data-stu-id="57da0-142">Since the shapes themselves change from frame to frame, it is not useful to cache their tessellations.</span></span> <span data-ttu-id="57da0-143">A melhor abordagem para esse aplicativo é desenhar objetos [**ID2D1Geometry**](/windows/win32/api/d2d1/nn-d2d1-id2d1geometry) diretamente.</span><span class="sxs-lookup"><span data-stu-id="57da0-143">The best approach for this app is to draw [**ID2D1Geometry**](/windows/win32/api/d2d1/nn-d2d1-id2d1geometry) objects directly.</span></span>

## <a name="creating-geometry-realizations"></a><span data-ttu-id="57da0-144">Criando realizações de geometria</span><span class="sxs-lookup"><span data-stu-id="57da0-144">Creating geometry realizations</span></span>

<span data-ttu-id="57da0-145">Um objeto [**ID2D1GeometryRealization**](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1geometryrealization) deve ser criado a partir de um objeto [**ID2D1Geometry**](/windows/win32/api/d2d1/nn-d2d1-id2d1geometry) existente.</span><span class="sxs-lookup"><span data-stu-id="57da0-145">An [**ID2D1GeometryRealization**](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1geometryrealization) object must be created from an existing [**ID2D1Geometry**](/windows/win32/api/d2d1/nn-d2d1-id2d1geometry) object.</span></span> <span data-ttu-id="57da0-146">Para criar uma realização de geometria, chame o método [**CreateFilledGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createfilledgeometryrealization) ou o método [**CreateStrokedGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createstrokedgeometryrealization) e passe o **ID2D1Geometry** para ser percebido.</span><span class="sxs-lookup"><span data-stu-id="57da0-146">To create a geometry realization, call the [**CreateFilledGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createfilledgeometryrealization) method or the [**CreateStrokedGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createstrokedgeometryrealization) method and pass in the **ID2D1Geometry** to be realized.</span></span>

-   <span data-ttu-id="57da0-147">[**CreateFilledGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createfilledgeometryrealization) cria uma realização do interior da forma: a região que seria desenhada chamando [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry).</span><span class="sxs-lookup"><span data-stu-id="57da0-147">[**CreateFilledGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createfilledgeometryrealization) creates a realization of the interior of the shape: the region that would be drawn by calling [**FillGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-fillgeometry).</span></span>
-   <span data-ttu-id="57da0-148">[**CreateStrokedGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createstrokedgeometryrealization) cria uma realização do traço da forma: a região que seria desenhada chamando [**DrawGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawgeometry).</span><span class="sxs-lookup"><span data-stu-id="57da0-148">[**CreateStrokedGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-createstrokedgeometryrealization) creates a realization of the stroke of the shape: the region that would be drawn by calling [**DrawGeometry**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawgeometry).</span></span>

<span data-ttu-id="57da0-149">Os dois tipos de realização de geometria são representados pela interface [**ID2D1GeometryRealization**](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1geometryrealization) .</span><span class="sxs-lookup"><span data-stu-id="57da0-149">Both kinds of geometry realization are represented by the [**ID2D1GeometryRealization**](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1geometryrealization) interface.</span></span>

<span data-ttu-id="57da0-150">Ao criar uma realização de geometria, [Direct2D](direct2d-portal.md) deve mesclar todas as curvas na geometria fornecida para as aproximaçãos poligonal.</span><span class="sxs-lookup"><span data-stu-id="57da0-150">When creating a geometry realization, [Direct2D](direct2d-portal.md) must flatten any curves in the provided geometry to polygonal approximations.</span></span> <span data-ttu-id="57da0-151">Você deve fornecer um parâmetro de tolerância de nivelamento para o método de criação — isso especifica a distância máxima, em pixels independentes de dispositivo (DIPs), entre a curva verdadeira da geometria e sua aproximação poligonal.</span><span class="sxs-lookup"><span data-stu-id="57da0-151">You must provide a flattening tolerance parameter to the creation method—this specifies the maximum distance, in device-independent pixels (DIPs), between the geometry’s true curve and its polygonal approximation.</span></span> <span data-ttu-id="57da0-152">Quanto menor a tolerância de nivelamento que você fornece, maior a fidelidade do objeto de realização de geometria resultante.</span><span class="sxs-lookup"><span data-stu-id="57da0-152">The lower the flattening tolerance you provide, the higher the fidelity of the resulting geometry realization object.</span></span> <span data-ttu-id="57da0-153">Da mesma forma, fornecer uma tolerância de nivelamento maior produz uma realização de geometria de baixa fidelidade.</span><span class="sxs-lookup"><span data-stu-id="57da0-153">Similarly, providing a higher flattening tolerance yields a lower-fidelity geometry realization.</span></span> <span data-ttu-id="57da0-154">Observe que as realizações de geometria de alta fidelidade são mais caras de desenhar do que as menos baratas, mas elas podem ser ampliadas ainda mais antes de introduzir artefatos visíveis.</span><span class="sxs-lookup"><span data-stu-id="57da0-154">Note that higher-fidelity geometry realizations are more expensive to draw than lower-fidelity ones, but they can be scaled further before introducing visible artifacts.</span></span> <span data-ttu-id="57da0-155">Para obter orientação sobre como usar tolerâncias de nivelamento, confira [dimensionamento](#scaling-geometry-realizations) de conversões de geometria abaixo.</span><span class="sxs-lookup"><span data-stu-id="57da0-155">For guidance on using flattening tolerances, see [Scaling geometry realizations](#scaling-geometry-realizations) below.</span></span>

> [!Note]  
> <span data-ttu-id="57da0-156">Os objetos de realização de geometria são associados a um dispositivo de gráficos específico: eles são recursos dependentes de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="57da0-156">Geometry realization objects are associated with a particular graphics device: they are device-dependent resources.</span></span>

 

## <a name="drawing-geometry-realizations"></a><span data-ttu-id="57da0-157">Desenhando a realização de geometria</span><span class="sxs-lookup"><span data-stu-id="57da0-157">Drawing geometry realizations</span></span>

<span data-ttu-id="57da0-158">O desenho de realizações de geometria é semelhante ao desenho de outros primitivos de [Direct2D](direct2d-portal.md) , como bitmaps.</span><span class="sxs-lookup"><span data-stu-id="57da0-158">Drawing geometry realizations is similar to drawing other [Direct2D](direct2d-portal.md) primitives, like bitmaps.</span></span> <span data-ttu-id="57da0-159">Para fazer isso, chame o método [**DrawGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-drawgeometryrealization) e passe o objeto de realização de geometria a ser desenhado e o pincel a ser usado.</span><span class="sxs-lookup"><span data-stu-id="57da0-159">To do so, call the [**DrawGeometryRealization**](/windows/win32/api/d2d1_2/nf-d2d1_2-id2d1devicecontext1-drawgeometryrealization) method and pass it the geometry realization object to be drawn and the brush to use.</span></span> <span data-ttu-id="57da0-160">Assim como ocorre com outros métodos de desenho Direct2D, você deve chamar **DrawGeometryRealization** entre chamadas para [**BeginDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-begindraw) e [**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw).</span><span class="sxs-lookup"><span data-stu-id="57da0-160">As with other Direct2D drawing methods, you must call **DrawGeometryRealization** between calls to [**BeginDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-begindraw) and [**EndDraw**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-enddraw).</span></span>

## <a name="scaling-geometry-realizations"></a><span data-ttu-id="57da0-161">Dimensionamento de comparações de geometria</span><span class="sxs-lookup"><span data-stu-id="57da0-161">Scaling geometry realizations</span></span>

<span data-ttu-id="57da0-162">A realização de geometria, como outras primitivas de [Direct2D](direct2d-portal.md) , respeitam a transformação definida no contexto do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="57da0-162">Geometry realizations, like other [Direct2D](direct2d-portal.md) primitives, respect the transform set on the device context.</span></span> <span data-ttu-id="57da0-163">Embora as transformações de conversão e de rotação não tenham efeito sobre a qualidade visual da realização de geometria, as transformações de escala podem produzir artefatos visuais.</span><span class="sxs-lookup"><span data-stu-id="57da0-163">Although translation and rotation transforms have no effect on the visual quality of geometry realizations, scale transforms can produce visual artifacts.</span></span>

<span data-ttu-id="57da0-164">Em particular, aplicar uma escala grande o suficiente a qualquer realização de geometria pode revelar a aproximação poligonal das curvas reais.</span><span class="sxs-lookup"><span data-stu-id="57da0-164">In particular, applying a large enough scale to any geometry realization can reveal the polygonal approximation of the true curves.</span></span> <span data-ttu-id="57da0-165">A imagem aqui mostra um par de realizações de geometria elíptico (preenchimento e traço) que foram dimensionados muito longe.</span><span class="sxs-lookup"><span data-stu-id="57da0-165">The image here shows a pair of elliptical geometry realizations (fill and stroke) that have been scaled up too far.</span></span> <span data-ttu-id="57da0-166">Os artefatos de mesclagem de curva são visíveis.</span><span class="sxs-lookup"><span data-stu-id="57da0-166">Curve-flattening artifacts are visible.</span></span>

![um par de realizações de geometria elíptica (preenchimento e traço) que foram dimensionados muito longe.](images/zoomed-in.png)

<span data-ttu-id="57da0-169">Os aplicativos que são sensíveis à qualidade visual devem tomar medidas para garantir que isso não aconteça.</span><span class="sxs-lookup"><span data-stu-id="57da0-169">Apps that are sensitive to visual quality should take measures to ensure this does not happen.</span></span> <span data-ttu-id="57da0-170">A maneira como você lida com o dimensionamento depende das necessidades do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="57da0-170">How you handle scaling depends on the needs of your app.</span></span> <span data-ttu-id="57da0-171">A seguir, há várias abordagens recomendadas para vários tipos diferentes de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="57da0-171">Following are several recommended approaches for several different types of app.</span></span>

### <a name="using-geometry-realizations-in-apps-that-do-not-scale"></a><span data-ttu-id="57da0-172">Usando a realização de geometria em aplicativos que não são dimensionados</span><span class="sxs-lookup"><span data-stu-id="57da0-172">Using geometry realizations in apps that do not scale</span></span>

<span data-ttu-id="57da0-173">Se seu aplicativo não executar qualquer escala na realização da geometria, será seguro criar as realizações apenas uma vez, usando uma única tolerância de nivelamento.</span><span class="sxs-lookup"><span data-stu-id="57da0-173">If your app does not perform any scaling on the geometry realizations, then it is safe to create the realizations only once, using a single flattening tolerance.</span></span> <span data-ttu-id="57da0-174">(As transformações sem dimensionamento não afetam a qualidade visual da realização da geometria renderizada.) Use a função [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)) para calcular a tolerância de nivelamento apropriada para o DPI:</span><span class="sxs-lookup"><span data-stu-id="57da0-174">(Non-scaling transforms do not affect the visual quality of rendered geometry realizations.) Use the [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)) function to calculate the appropriate flattening tolerance for the DPI:</span></span>


```C++
    float dpiX, dpiY;
    deviceContext->GetDpi(&dpiX, &dpiY);

    float flatteningTolerance = D2D1::ComputeFlatteningTolerance(
        D2D1::Matrix3x2F::Identity(),   // apply no additional scaling transform
        dpiX,                           // horizontal DPI
        dpiY                            // vertical DPI
        );
```



### <a name="using-geometry-realizations-in-apps-that-scale-by-a-small-amount"></a><span data-ttu-id="57da0-175">Usando a realização de geometria em aplicativos que são dimensionados por uma pequena quantidade</span><span class="sxs-lookup"><span data-stu-id="57da0-175">Using geometry realizations in apps that scale by a small amount</span></span>

<span data-ttu-id="57da0-176">Se seu aplicativo puder dimensionar uma realização de geometria por um valor pequeno (por exemplo, até 2x ou 3x), pode ser apropriado simplesmente criar a realização de geometria uma vez, em uma tolerância de nivelamento proporcionalmente menor do que o padrão.</span><span class="sxs-lookup"><span data-stu-id="57da0-176">If your app can scale a geometry realization up by only a small amount (for example, up to 2x or 3x), then it may be appropriate simply to create the geometry realization once, at a proportionally lower flattening tolerance than the default.</span></span> <span data-ttu-id="57da0-177">Isso cria uma percepção de alta fidelidade que pode ser aumentada significativamente antes de incorrer em artefatos de dimensionamento; a desvantagem é que desenhar a realização de alta fidelidade requer mais trabalho.</span><span class="sxs-lookup"><span data-stu-id="57da0-177">This creates a higher-fidelity realization that can be scaled up significantly before incurring scaling artifacts; the trade-off is that drawing the higher-fidelity realization requires more work.</span></span>

<span data-ttu-id="57da0-178">Por exemplo, suponha que você saiba que seu aplicativo nunca dimensionará uma realização de geometria em mais de 2x.</span><span class="sxs-lookup"><span data-stu-id="57da0-178">For example, suppose you know that your app will never scale a geometry realization by more than 2x.</span></span> <span data-ttu-id="57da0-179">Seu aplicativo pode criar a realização de geometria usando uma tolerância de nivelamento que é metade do valor padrão e simplesmente dimensionar a realização conforme necessário, até 2x.</span><span class="sxs-lookup"><span data-stu-id="57da0-179">Your app can create the geometry realization using a flattening tolerance that’s half the default value and simply scale the realization as needed, up to 2x.</span></span> <span data-ttu-id="57da0-180">Use a função [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)) para calcular a tolerância de nivelamento apropriada passando 2,0 como o parâmetro *maxZoomFactor* :</span><span class="sxs-lookup"><span data-stu-id="57da0-180">Use the [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)) function to calculate the appropriate flattening tolerance by passing 2.0 as the *maxZoomFactor* parameter:</span></span>


```C++
    float dpiX, dpiY;
    deviceContext->GetDpi(&dpiX, &dpiY);
    
    float flatteningTolerance = D2D1::ComputeFlatteningTolerance(
        D2D1::Matrix3x2F::Identity(),   // apply no additional scaling transform
        dpiX,                           // horizontal DPI
        dpiY,                           // vertical DPI
        2.0f                            // realization can be scaled by an additional 2x
        );
```



### <a name="using-geometry-realizations-in-apps-that-scale-by-a-large-amount"></a><span data-ttu-id="57da0-181">Usando a realização de geometria em aplicativos que são dimensionados por uma grande quantidade</span><span class="sxs-lookup"><span data-stu-id="57da0-181">Using geometry realizations in apps that scale by a large amount</span></span>

<span data-ttu-id="57da0-182">Se seu aplicativo puder dimensionar uma realização de geometria para cima ou para baixo por grandes quantidades (por exemplo, por 10x ou mais), manipular o dimensionamento adequadamente é mais complicado.</span><span class="sxs-lookup"><span data-stu-id="57da0-182">If your app can scale a geometry realization up or down by large amounts (for example, by 10x or more), then handling scaling appropriately is more complicated.</span></span>

<span data-ttu-id="57da0-183">Para a maioria desses aplicativos, a abordagem recomendada é recriar a realização de geometria em tolerâncias de nivelamento progressivamente menores conforme a cena é expandida, a fim de manter a fidelidade visual e evitar artefatos de dimensionamento.</span><span class="sxs-lookup"><span data-stu-id="57da0-183">For most of these apps, the recommended approach is to recreate the geometry realization at progressively lower flattening tolerances as the scene is scaled up, in order to maintain visual fidelity and avoid scaling artifacts.</span></span> <span data-ttu-id="57da0-184">Da mesma forma, à medida que a cena é reduzida, o aplicativo deve recriar as realizações de geometria em tolerâncias de nivelamento progressivamente maiores, para evitar a renderização de detalhes que não são visíveis.</span><span class="sxs-lookup"><span data-stu-id="57da0-184">Similarly, as the scene is scaled down, the app should recreate the geometry realizations at progressively higher flattening tolerances, in order to avoid wastefully rendering details that aren’t visible.</span></span> <span data-ttu-id="57da0-185">O aplicativo não deve recriar a realização de geometria toda vez que a escala é alterada, pois isso anula a finalidade de armazenar em cache o trabalho de mosaico.</span><span class="sxs-lookup"><span data-stu-id="57da0-185">The app shouldn’t recreate the geometry realizations every time the scale changes, because doing so defeats the purpose of caching the tessellation work.</span></span> <span data-ttu-id="57da0-186">Em vez disso, o aplicativo deve recriar a realização de geometria com menos frequência: por exemplo, após cada 2x aumento ou diminuição na escala.</span><span class="sxs-lookup"><span data-stu-id="57da0-186">Instead, the app should recreate the geometry realizations less frequently: for example, after every 2x increase or decrease in scale.</span></span>

<span data-ttu-id="57da0-187">Cada vez que a escala é alterada em um aplicativo em resposta à interação do usuário, o aplicativo pode comparar a nova escala em relação à escala na qual a realização da geometria foi criada pela última vez (armazenado, por exemplo, em um membro **m \_ lastScale** ).</span><span class="sxs-lookup"><span data-stu-id="57da0-187">Each time the scale changes in an app in response to user interaction, the app could compare the new scale against the scale at which the geometry realizations were last created (stored, for example, in an **m\_lastScale** member).</span></span> <span data-ttu-id="57da0-188">Se os dois valores estiverem próximos (nesse caso, dentro de um fator de 2), nenhuma ação adicional será executada.</span><span class="sxs-lookup"><span data-stu-id="57da0-188">If the two values are close (in this case, within a factor of 2), then no further action is taken.</span></span> <span data-ttu-id="57da0-189">Mas se os dois valores não estiverem próximos, a realização da geometria será recriada.</span><span class="sxs-lookup"><span data-stu-id="57da0-189">But if the two values are not close, then the geometry realizations are re-created.</span></span> <span data-ttu-id="57da0-190">A função [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)) é usada para computar uma tolerância de nivelamento apropriada para a nova escala e **m \_ lastScale** é atualizado para a nova escala.</span><span class="sxs-lookup"><span data-stu-id="57da0-190">The [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)) function is used to compute a flattening tolerance appropriate for the new scale, and **m\_lastScale** is updated to the new scale.</span></span>

<span data-ttu-id="57da0-191">Além disso, o aplicativo sempre cria realizações usando uma tolerância menor do que o que normalmente seria usado para a nova escala, passando um valor de 2 como o parâmetro *maxZoomFactor* para [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="57da0-191">In addition, the app always creates realizations using a smaller tolerance than what would normally be used for the new scale, by passing a value of 2 as the *maxZoomFactor* parameter to [**ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85)).</span></span> <span data-ttu-id="57da0-192">Isso permite que a nova realização de geometria seja dimensionada por um fator adicional de 2 sem incorrer em artefatos de dimensionamento.</span><span class="sxs-lookup"><span data-stu-id="57da0-192">This allows the new geometry realizations to be scaled up by an additional factor of 2 without incurring scaling artifacts.</span></span>

> [!Note]  
> <span data-ttu-id="57da0-193">A abordagem descrita aqui pode não ser apropriada para todos os aplicativos.</span><span class="sxs-lookup"><span data-stu-id="57da0-193">The approach described here may not be appropriate for all apps.</span></span> <span data-ttu-id="57da0-194">Por exemplo, se seu aplicativo permitir que a cena seja dimensionada por fatores muito grandes muito rapidamente (por exemplo, se ele contiver um controle deslizante de "zoom" que possa ser movido de 100% para 1 milhão% no intervalo de alguns quadros), essa abordagem poderá resultar em excesso de trabalho recriando a realização de geometria a cada quadro.</span><span class="sxs-lookup"><span data-stu-id="57da0-194">For example, if your app allows the scene to be scaled by very large factors very quickly (for example, if it contains a “zoom” slider that can be moved from 100% to 1,000,000% in the span of a few frames) then this approach may result in excess work by recreating the geometry realizations every frame.</span></span> <span data-ttu-id="57da0-195">Uma abordagem alternativa é recriar a realização de geometria somente após a conclusão de cada manipulação da escala da cena (por exemplo, depois que o usuário tiver concluído um gesto de pinçar).</span><span class="sxs-lookup"><span data-stu-id="57da0-195">An alternative approach is to recreate the geometry realizations only after each manipulation of the scene’s scale has been completed (for example, after the user has completed a pinch gesture).</span></span>

 

## <a name="related-topics"></a><span data-ttu-id="57da0-196">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="57da0-196">Related topics</span></span>

[<span data-ttu-id="57da0-197">Visão geral de geometrias</span><span class="sxs-lookup"><span data-stu-id="57da0-197">Geometries Overview</span></span>](direct2d-geometries-overview.md)

[<span data-ttu-id="57da0-198">Melhorando o desempenho de aplicativos Direct2D</span><span class="sxs-lookup"><span data-stu-id="57da0-198">Improving the performance of Direct2D apps</span></span>](improving-direct2d-performance.md)

[<span data-ttu-id="57da0-199">Diretrizes gerais para a renderização de conteúdo estático complexo</span><span class="sxs-lookup"><span data-stu-id="57da0-199">General guidelines for rendering complex static content</span></span>](improving-direct2d-performance.md)

[<span data-ttu-id="57da0-200">**ID2D1DeviceContext1**</span><span class="sxs-lookup"><span data-stu-id="57da0-200">**ID2D1DeviceContext1**</span></span>](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1devicecontext1)

[<span data-ttu-id="57da0-201">**ID2D1GeometryRealization**</span><span class="sxs-lookup"><span data-stu-id="57da0-201">**ID2D1GeometryRealization**</span></span>](/windows/win32/api/d2d1_2/nn-d2d1_2-id2d1geometryrealization)

<span data-ttu-id="57da0-202">[**Função ComputeFlatteningTolerance**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="57da0-202">[**ComputeFlatteningTolerance function**](/previous-versions/windows/desktop/legacy/dn280327(v=vs.85))</span></span>