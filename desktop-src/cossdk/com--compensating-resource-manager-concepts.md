---
description: Você pode usar o CRM (Gerenciador de recursos de compensação COM+) para integrar facilmente e rapidamente recursos de aplicativos com transações do Microsoft Coordenador de Transações Distribuídas (DTC).
ms.assetid: 8d1d034f-8a09-40ae-842a-5251135bd3c8
title: Conceitos do Gerenciador de recursos de compensação COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 14206a54ffcb4f7e06ddf7362736a722393b0791
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103920340"
---
# <a name="com-compensating-resource-manager-concepts"></a><span data-ttu-id="a01a6-103">Conceitos do Gerenciador de recursos de compensação COM+</span><span class="sxs-lookup"><span data-stu-id="a01a6-103">COM+ Compensating Resource Manager Concepts</span></span>

<span data-ttu-id="a01a6-104">Você pode usar o CRM (Gerenciador de recursos de compensação COM+) para integrar facilmente e rapidamente recursos de aplicativos com transações do Microsoft Coordenador de Transações Distribuídas (DTC).</span><span class="sxs-lookup"><span data-stu-id="a01a6-104">You can use the COM+ Compensating Resource Manager (CRM) to easily and quickly integrate application resources with Microsoft Distributed Transaction Coordinator (DTC) transactions.</span></span> <span data-ttu-id="a01a6-105">Os recursos do aplicativo podem votar no resultado de uma transação e podem receber a notificação final de seu resultado.</span><span class="sxs-lookup"><span data-stu-id="a01a6-105">Your application resources can vote on the outcome of a transaction and can receive final notification of its outcome.</span></span> <span data-ttu-id="a01a6-106">Um log durável é gerado para que os recursos do aplicativo possam gravar registros que sobrevivem a falhas e o CRM recupera esse arquivo de log quando o aplicativo é reiniciado.</span><span class="sxs-lookup"><span data-stu-id="a01a6-106">A durable log is generated so that your application resources can write records that survive failures, and the CRM recovers this log file when the application restarts.</span></span>

<span data-ttu-id="a01a6-107">Um CRM consiste nos dois componentes a seguir:</span><span class="sxs-lookup"><span data-stu-id="a01a6-107">A CRM consists of the following two components:</span></span>

-   <span data-ttu-id="a01a6-108">CRM Worker.</span><span class="sxs-lookup"><span data-stu-id="a01a6-108">CRM Worker.</span></span> <span data-ttu-id="a01a6-109">Esse componente executa o trabalho principal do CRM específico e implementa uma interface específica para a tarefa que precisa ser executada.</span><span class="sxs-lookup"><span data-stu-id="a01a6-109">This component performs the main work of the specific CRM and implements an interface specific to the task it needs to perform.</span></span> <span data-ttu-id="a01a6-110">A infraestrutura do CRM fornece uma interface para o trabalhador do CRM por meio da qual o trabalhador do CRM pode gravar registros em um arquivo de log durável no disco.</span><span class="sxs-lookup"><span data-stu-id="a01a6-110">The CRM infrastructure provides an interface to the CRM Worker through which the CRM Worker can write records to a durable log file on disk.</span></span> <span data-ttu-id="a01a6-111">O trabalho do CRM deve gravar registros no log e torná-los duráveis antes de executar seu trabalho para que, se ocorrer uma falha, a recuperação possa ocorrer corretamente.</span><span class="sxs-lookup"><span data-stu-id="a01a6-111">The CRM Worker must write records to the log and make them durable before it performs its work so that, if a crash occurs, recovery can occur correctly.</span></span> <span data-ttu-id="a01a6-112">O trabalhador do CRM sempre requer uma transação.</span><span class="sxs-lookup"><span data-stu-id="a01a6-112">The CRM Worker always requires a transaction.</span></span>
-   <span data-ttu-id="a01a6-113">Compensador de CRM.</span><span class="sxs-lookup"><span data-stu-id="a01a6-113">CRM Compensator.</span></span> <span data-ttu-id="a01a6-114">Esse componente é criado pela infraestrutura do CRM na conclusão da transação.</span><span class="sxs-lookup"><span data-stu-id="a01a6-114">This component is created by the CRM infrastructure at the completion of the transaction.</span></span> <span data-ttu-id="a01a6-115">Ele implementa uma interface definida pela qual a infra-estrutura de CRM pode passar notificações de conclusão de transação e os registros de log que foram gravados anteriormente pelo trabalhador do CRM.</span><span class="sxs-lookup"><span data-stu-id="a01a6-115">It implements a defined interface by which the CRM infrastructure can pass on notifications of transaction completion and the log records that were previously written by the CRM Worker.</span></span>

<span data-ttu-id="a01a6-116">Um CRM do COM+ fornece atomicidade com notificações transacionais e durabilidade com o log do CRM, mas não fornece isolamento de recursos.</span><span class="sxs-lookup"><span data-stu-id="a01a6-116">A COM+ CRM provides atomicity with transactional notifications, and durability with the CRM log, but does not provide isolation of resources.</span></span> <span data-ttu-id="a01a6-117">Em um ambiente multithread, é responsabilidade do desenvolvedor de CRM garantir que o acesso aos recursos, seja por vários trabalhadores do CRM ou aplicativos externos, seja serializado durante uma transação.</span><span class="sxs-lookup"><span data-stu-id="a01a6-117">In a multithreaded environment, it is the responsibility of the CRM developer to ensure that access to resources, either by multiple CRM Workers or external applications, is serialized while in a transaction.</span></span>

<span data-ttu-id="a01a6-118">Depois que a transação tiver passado para a fase de preparação, o compensador de CRM e os funcionários do CRM poderão ser executados simultaneamente.</span><span class="sxs-lookup"><span data-stu-id="a01a6-118">After the transaction has passed the prepare phase, the CRM Compensator and CRM Workers can be running concurrently.</span></span> <span data-ttu-id="a01a6-119">É possível que o componente de trabalho do CRM de uma nova transação fique ativo enquanto o compensador de CRM de uma transação anterior ainda está processando a transação anterior.</span><span class="sxs-lookup"><span data-stu-id="a01a6-119">It is possible for the CRM Worker component of a new transaction to become active while the CRM Compensator of a previous transaction is still processing the previous transaction.</span></span>

<span data-ttu-id="a01a6-120">Durante as falhas antes da recuperação do aplicativo do servidor do CRM, uma transação interrompida deve ser considerada ativa e não concluída.</span><span class="sxs-lookup"><span data-stu-id="a01a6-120">During failures prior to recovery of the CRM server application, an interrupted transaction should be considered active and not complete.</span></span> <span data-ttu-id="a01a6-121">Não deve ser possível que os processos externos acessem os recursos que estavam sendo alterados por essa transação específica antes da recuperação do processo do servidor do CRM.</span><span class="sxs-lookup"><span data-stu-id="a01a6-121">It should not be possible for external processes to access the resources that were being changed by this particular transaction prior to recovery of the CRM server process.</span></span>

<span data-ttu-id="a01a6-122">O CRM define três tipos de interface para as funções básicas do CRM:</span><span class="sxs-lookup"><span data-stu-id="a01a6-122">The CRM defines three interface types for the basic CRM functions:</span></span>

-   <span data-ttu-id="a01a6-123">O [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol) é implementado no administrador do CRM e é usado pelo trabalhador do CRM para gravar registros de log no log.</span><span class="sxs-lookup"><span data-stu-id="a01a6-123">[**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol) is implemented on the CRM clerk and is used by the CRM Worker to write log records to the log.</span></span> <span data-ttu-id="a01a6-124">Ele também pode ser usado pelo compensador de CRM.</span><span class="sxs-lookup"><span data-stu-id="a01a6-124">It can also used by the CRM Compensator.</span></span>
-   <span data-ttu-id="a01a6-125">[**ICrmCompensator**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmcompensator) e [**ICrmCompensatorVariants**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmcompensatorvariants) são implementados no compensador de CRM.</span><span class="sxs-lookup"><span data-stu-id="a01a6-125">[**ICrmCompensator**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmcompensator) and [**ICrmCompensatorVariants**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmcompensatorvariants) are implemented on the CRM Compensator.</span></span> <span data-ttu-id="a01a6-126">Essas interfaces são usadas para fornecer notificações de resultado da transação e seus registros de log associados ao compensador de CRM.</span><span class="sxs-lookup"><span data-stu-id="a01a6-126">These interfaces are used to deliver transaction outcome notifications and their associated log records to the CRM Compensator.</span></span> <span data-ttu-id="a01a6-127">Normalmente, o compensador de CRM implementa apenas uma dessas interfaces, dependendo se ela exigiu registros de log estruturados ou não estruturados.</span><span class="sxs-lookup"><span data-stu-id="a01a6-127">Normally, the CRM Compensator would implement only one of these interfaces, depending on whether it required unstructured or structured log records.</span></span> <span data-ttu-id="a01a6-128">Os *registros de log estruturados* são aqueles que são criados como uma coleção de variantes e normalmente são usados pelo Microsoft Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="a01a6-128">*Structured log records* are those that are built up as a collection of Variants and are typically for use by Microsoft Visual Basic.</span></span> <span data-ttu-id="a01a6-129">Os *registros de log não estruturados* são apenas um buffer de bytes e normalmente são usados pelo Microsoft Visual C++.</span><span class="sxs-lookup"><span data-stu-id="a01a6-129">*Unstructured log records* are just a buffer of bytes and are typically for use by Microsoft Visual C++.</span></span> <span data-ttu-id="a01a6-130">Um compensador de CRM pode implementar ambas as interfaces compensadoras; no entanto, apenas um de cada vez é usado para entregar registros de log.</span><span class="sxs-lookup"><span data-stu-id="a01a6-130">A CRM Compensator can implement both of the compensator interfaces; however, only one at a time is used to deliver log records.</span></span>
-   <span data-ttu-id="a01a6-131">As interfaces de monitoramento do CRM do COM+ são usadas para monitorar o CRMs em um aplicativo de servidor específico.</span><span class="sxs-lookup"><span data-stu-id="a01a6-131">The COM+ CRM monitoring interfaces are used for monitoring the CRMs within a particular server application.</span></span> <span data-ttu-id="a01a6-132">Para obter informações detalhadas sobre as interfaces de monitoramento, consulte [interfaces de monitoramento do com+ CRM](com--crm-monitoring-interfaces.md).</span><span class="sxs-lookup"><span data-stu-id="a01a6-132">For detailed information about the monitoring interfaces, see [COM+ CRM Monitoring Interfaces](com--crm-monitoring-interfaces.md).</span></span>

<span data-ttu-id="a01a6-133">Os tópicos a seguir nesta seção fornecem mais detalhes sobre o serviço CRM do COM+:</span><span class="sxs-lookup"><span data-stu-id="a01a6-133">The following topics in this section provide more detail about the COM+ CRM service:</span></span>

-   [<span data-ttu-id="a01a6-134">Considerações de segurança do CRM do COM+</span><span class="sxs-lookup"><span data-stu-id="a01a6-134">COM+ CRM Security Considerations</span></span>](com--crm-security-considerations.md)
-   [<span data-ttu-id="a01a6-135">Processo operacional de CRM do COM+</span><span class="sxs-lookup"><span data-stu-id="a01a6-135">COM+ CRM Operating Process</span></span>](com--crm-operating-process.md)
-   [<span data-ttu-id="a01a6-136">Inicialização e recuperação do CRM do COM+</span><span class="sxs-lookup"><span data-stu-id="a01a6-136">COM+ CRM Startup and Recovery</span></span>](com--crm-startup-and-recovery.md)
-   [<span data-ttu-id="a01a6-137">Usando o CRM do COM+ em um ambiente de cluster</span><span class="sxs-lookup"><span data-stu-id="a01a6-137">Using the COM+ CRM in a Cluster Environment</span></span>](using-the-com--crm-in-a-cluster-environment.md)
-   [<span data-ttu-id="a01a6-138">Tratamento de erros no CRM COM+</span><span class="sxs-lookup"><span data-stu-id="a01a6-138">Error Handling in the COM+ CRM</span></span>](error-handling-in-the-com--crm.md)
-   [<span data-ttu-id="a01a6-139">Configurações do registro do CRM do COM+</span><span class="sxs-lookup"><span data-stu-id="a01a6-139">COM+ CRM Registry Settings</span></span>](com--crm-registry-settings.md)
-   [<span data-ttu-id="a01a6-140">Solucionando problemas do CRM do COM+</span><span class="sxs-lookup"><span data-stu-id="a01a6-140">Troubleshooting the COM+ CRM</span></span>](troubleshooting-the-com--crm.md)
-   [<span data-ttu-id="a01a6-141">Sugestões de design para o desenvolvimento de um CRM COM+</span><span class="sxs-lookup"><span data-stu-id="a01a6-141">Design Suggestions for Developing a COM+ CRM</span></span>](design-suggestions-for-developing-a-com--crm.md)
-   [<span data-ttu-id="a01a6-142">Interfaces de monitoramento do COM+ CRM</span><span class="sxs-lookup"><span data-stu-id="a01a6-142">COM+ CRM Monitoring Interfaces</span></span>](com--crm-monitoring-interfaces.md)
-   [<span data-ttu-id="a01a6-143">Interfaces do CRM COM+</span><span class="sxs-lookup"><span data-stu-id="a01a6-143">COM+ CRM Interfaces</span></span>](com--crm-interfaces.md)

## <a name="related-topics"></a><span data-ttu-id="a01a6-144">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="a01a6-144">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="a01a6-145">Tarefas do Gerenciador de recursos de compensação COM+</span><span class="sxs-lookup"><span data-stu-id="a01a6-145">COM+ Compensating Resource Manager Tasks</span></span>](com--compensating-resource-manager-tasks.md)
</dt> </dl>

 

 



