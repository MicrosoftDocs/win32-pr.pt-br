---
description: Suporte à depuração de Visual Basic COM+ em contraste com o MTS
ms.assetid: aa012f88-1f88-4c7f-b774-82b9e29da5e9
title: Suporte à depuração de Visual Basic COM+ em contraste com o MTS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 038b29bbc6fbe5c8375f91f0006b85940f00b944
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105798263"
---
# <a name="com-visual-basic-debugging-support-contrasted-with-mts"></a><span data-ttu-id="d6b9f-103">Suporte à depuração de Visual Basic COM+ em contraste com o MTS</span><span class="sxs-lookup"><span data-stu-id="d6b9f-103">COM+ Visual Basic Debugging Support Contrasted with MTS</span></span>

<span data-ttu-id="d6b9f-104">COM+ remove ou reduz várias limitações de depuração com o Microsoft Visual Basic 6,0 e o MTS.</span><span class="sxs-lookup"><span data-stu-id="d6b9f-104">COM+ removes or reduces several limitations of debugging with Microsoft Visual Basic 6.0 and MTS.</span></span> <span data-ttu-id="d6b9f-105">A lista a seguir resume as alterações que você pode esperar com o COM+:</span><span class="sxs-lookup"><span data-stu-id="d6b9f-105">The following list summarizes changes you can expect with COM+:</span></span>

-   <span data-ttu-id="d6b9f-106">Depurando vários componentes — no COM+, você pode depurar cenários nos quais um cliente em execução em uma instância do IDE faz chamadas para qualquer número de DLLs em execução em outro como um grupo de projetos.</span><span class="sxs-lookup"><span data-stu-id="d6b9f-106">Debugging multiple components—In COM+, you can debug scenarios in which a client running in one instance of the IDE makes calls to any number of DLLs running in another as a project group.</span></span> <span data-ttu-id="d6b9f-107">Os objetos nos projetos de DLL agrupados podem chamar uns aos outros arbitrariamente, fluindo o contexto conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="d6b9f-107">The objects in the grouped DLL projects can call each other arbitrarily, flowing context as needed.</span></span> <span data-ttu-id="d6b9f-108">É claro que isso também funciona quando as DLLs e o cliente estão no mesmo grupo de projetos na mesma instância do IDE.</span><span class="sxs-lookup"><span data-stu-id="d6b9f-108">Of course, this also works when the DLLs and the client are in the same project group in the same instance of the IDE.</span></span>

-   <span data-ttu-id="d6b9f-109">Limitações de depuração em \_ eventos de inicialização de classe e de \_ término de classe — com o com+, você pode colocar o código nos eventos de inicialização de classe \_ e de classe \_ de um componente de aplicativo com+, mesmo que esse código tente acessar o objeto ou seu objeto de contexto correspondente.</span><span class="sxs-lookup"><span data-stu-id="d6b9f-109">Debugging Limitations on Class\_Initialize and Class\_Terminate Events—With COM+, you can put code in the Class\_Initialize and Class\_Terminate events of a COM+ application component even if that code attempts to access the object or its corresponding context object.</span></span> <span data-ttu-id="d6b9f-110">Você pode definir pontos de interrupção e usar inspeções.</span><span class="sxs-lookup"><span data-stu-id="d6b9f-110">You can set breakpoints there and use watches.</span></span> <span data-ttu-id="d6b9f-111">Você também pode definir pontos de interrupção no \_ evento classe Terminate.</span><span class="sxs-lookup"><span data-stu-id="d6b9f-111">You can also set breakpoints in the Class\_Terminate event.</span></span>

    <span data-ttu-id="d6b9f-112">Embora não seja mais necessário como uma solução alternativa, você ainda pode implementar a interface [**controledeobjetoi**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) e usar seus métodos [**Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) e [**Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) se precisar executar o código durante a inicialização e o desligamento do seu componente.</span><span class="sxs-lookup"><span data-stu-id="d6b9f-112">Although it is no longer needed as a workaround, you can still implement the [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) interface and use its [**Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) and [**Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) methods if you need to execute code during startup and shutdown of your component.</span></span> <span data-ttu-id="d6b9f-113">Agora você também pode colocar pontos de interrupção no código para os métodos **Deactivate** ou [**CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) .</span><span class="sxs-lookup"><span data-stu-id="d6b9f-113">You can also now put breakpoints in code for the **Deactivate** or [**CanBePooled**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-canbepooled) methods.</span></span>

-   <span data-ttu-id="d6b9f-114">Observando objetos do MTS — com o COM+, você pode adicionar inspeções para variáveis de objeto retornadas pelo COM+, incluindo valores de retorno dos métodos [**SafeRef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef), [**getObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext)e [**IObjectContext:: CreateInstance**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-createinstance) .</span><span class="sxs-lookup"><span data-stu-id="d6b9f-114">Watching MTS Objects—With COM+, you can add watches for object variables returned by COM+, including return values from the [**SafeRef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef), [**GetObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext), and [**IObjectContext::CreateInstance**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-createinstance) methods.</span></span>

-   <span data-ttu-id="d6b9f-115">Maior estabilidade quando os componentes falham — no COM+, uma falha de componente deixará de ser interrompida sempre Visual Basic (que é executado no mesmo processo que o componente depurado).</span><span class="sxs-lookup"><span data-stu-id="d6b9f-115">Increased stability when components fail—In COM+, a component failure will no longer always stop Visual Basic (which runs in the same process as the debugged component).</span></span> <span data-ttu-id="d6b9f-116">Por exemplo, o suporte para falhas de reativação JIT (just-in-time) agora permite que você examine o contexto do objeto durante a depuração.</span><span class="sxs-lookup"><span data-stu-id="d6b9f-116">For example, support for just-in-time (JIT) reactivation failures now allows you to look at the object context while debugging.</span></span>

-   <span data-ttu-id="d6b9f-117">O depurador pode reativar objetos liberados pelo COM+ — assim como no MTS, Visual Basic 6,0 pode reativar objetos COM+ enquanto você está Depurando uma única etapa por meio de um cliente.</span><span class="sxs-lookup"><span data-stu-id="d6b9f-117">Debugger may reactivate objects released by COM+—As with MTS, Visual Basic 6.0 may reactivate COM+ objects while you are debugging single-step through a client.</span></span> <span data-ttu-id="d6b9f-118">Por causa da maneira que Visual Basic 6,0 descobre informações sobre objetos, esse é o comportamento esperado.</span><span class="sxs-lookup"><span data-stu-id="d6b9f-118">Because of the way that Visual Basic 6.0 discovers information about objects, this is expected behavior.</span></span> <span data-ttu-id="d6b9f-119">Por exemplo, considere o seguinte código:</span><span class="sxs-lookup"><span data-stu-id="d6b9f-119">For example, consider the following code:</span></span>

    ``` syntax
    Dim obj As Object
    Set obj = CreateObject("MyApp.MyClass")
    obj.Test  'Call the user-defined subroutine named Test.
    Set obj = Nothing
    ```

    <span data-ttu-id="d6b9f-120">Se obj. O método de teste chama [**IObjectContext:: SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete), com+ imediatamente libera o obj da memória, mas obj ainda não foi definido como Nothing.</span><span class="sxs-lookup"><span data-stu-id="d6b9f-120">If the obj.Test method calls [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete), COM+ immediately frees obj from memory, but obj has not yet been set to Nothing.</span></span> <span data-ttu-id="d6b9f-121">Quando obj. Testes de retorno, o depurador de Visual Basic chama [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) em obj para a interface [**IProvideClassInfo**](/windows/desktop/api/ocidl/nn-ocidl-iprovideclassinfo) .</span><span class="sxs-lookup"><span data-stu-id="d6b9f-121">When obj.Test returns, the Visual Basic debugger calls [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) on obj for the [**IProvideClassInfo**](/windows/desktop/api/ocidl/nn-ocidl-iprovideclassinfo) interface.</span></span> <span data-ttu-id="d6b9f-122">O wrapper de contexto associado a obj cria uma nova instância de MyApp. MyClass para atender à chamada de **QueryInterface** .</span><span class="sxs-lookup"><span data-stu-id="d6b9f-122">The context wrapper associated with obj creates a new instance of MyApp.MyClass to service the **QueryInterface** call.</span></span> <span data-ttu-id="d6b9f-123">Como resultado, você verá esse objeto não inicializado no depurador após o obj. O teste foi retornado.</span><span class="sxs-lookup"><span data-stu-id="d6b9f-123">As a result, you will see this uninitialized object in the debugger after obj.Test has returned.</span></span> <span data-ttu-id="d6b9f-124">Esse objeto aparece apenas no depurador e é removido pela instrução subsequente para definir obj como Nothing.</span><span class="sxs-lookup"><span data-stu-id="d6b9f-124">This object appears only in the debugger and is removed by the subsequent instruction to set obj to Nothing.</span></span>

## <a name="related-topics"></a><span data-ttu-id="d6b9f-125">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="d6b9f-125">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="d6b9f-126">Depurando componentes de Visual Basic compilados</span><span class="sxs-lookup"><span data-stu-id="d6b9f-126">Debugging Compiled Visual Basic Components</span></span>](debugging-compiled-visual-basic-components.md)
</dt> <dt>

[<span data-ttu-id="d6b9f-127">Depuração no IDE Visual Basic</span><span class="sxs-lookup"><span data-stu-id="d6b9f-127">Debugging in the Visual Basic IDE</span></span>](debugging-in-the-visual-basic-ide.md)
</dt> </dl>

 

 
