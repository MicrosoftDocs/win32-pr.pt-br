---
description: O serviço de eventos COM+ usa um objeto de classe de evento para gerenciar a conexão entre o Publicador e o Assinante.
ms.assetid: 877c5890-588d-4978-8fb2-b4ecf4134068
title: O objeto de classe de evento COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aae397f647354ac24395fa073365160829a687a2
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103920333"
---
# <a name="the-com-event-class-object"></a><span data-ttu-id="84e97-103">O objeto de classe de evento COM+</span><span class="sxs-lookup"><span data-stu-id="84e97-103">The COM+ Event Class Object</span></span>

<span data-ttu-id="84e97-104">O serviço de eventos COM+ usa um *objeto de classe de evento* para gerenciar a conexão entre o Publicador e o Assinante.</span><span class="sxs-lookup"><span data-stu-id="84e97-104">The COM+ Events service uses an *event class object* to manage the connection between publisher and subscriber.</span></span> <span data-ttu-id="84e97-105">O objeto de classe de evento é um componente COM+ que é gerenciado e armazenado pelo sistema de eventos COM+ e contém as interfaces e os métodos usados por um Publicador para acionar eventos.</span><span class="sxs-lookup"><span data-stu-id="84e97-105">The event class object is a COM+ component that is managed and stored by the COM+ Events system and contains the interfaces and methods used by a publisher to fire events.</span></span> <span data-ttu-id="84e97-106">É um objeto persistente que indica os eventos que podem ocorrer e, opcionalmente, identifica o Publicador.</span><span class="sxs-lookup"><span data-stu-id="84e97-106">It is a persistent object that indicates the events that can occur and, optionally, identifies the publisher.</span></span> <span data-ttu-id="84e97-107">Especifique as interfaces e os métodos que você deseja que uma classe de evento contenha, fornecendo uma biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="84e97-107">You specify the interfaces and methods you want an event class to contain by providing a type library.</span></span>

<span data-ttu-id="84e97-108">Para acionar um evento, o Publicador instancia o objeto da classe de evento chamando [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) ou o método **CreateObject** do Microsoft Visual Basic e solicitando que a interface do evento seja retornada.</span><span class="sxs-lookup"><span data-stu-id="84e97-108">To fire an event, the publisher instantiates the event class object by calling [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) or the Microsoft Visual Basic **CreateObject** method and requesting the event interface be returned.</span></span> <span data-ttu-id="84e97-109">O objeto de classe de evento instanciado contém a implementação do sistema de eventos da interface solicitada.</span><span class="sxs-lookup"><span data-stu-id="84e97-109">The instantiated event class object contains the event system's implementation of the requested interface.</span></span> <span data-ttu-id="84e97-110">Um assinante interessado também deve implementar a interface de classe de evento para receber eventos de um determinado Publicador.</span><span class="sxs-lookup"><span data-stu-id="84e97-110">An interested subscriber must also implement the event class interface to receive events from a given publisher.</span></span> <span data-ttu-id="84e97-111">Quando o objeto da classe de evento é instanciado, o sistema de eventos o associa aos assinantes apropriados.</span><span class="sxs-lookup"><span data-stu-id="84e97-111">When the event class object is instantiated, the event system associates it with the appropriate subscribers.</span></span> <span data-ttu-id="84e97-112">A lista de assinantes é mantida durante o tempo de vida do objeto de classe de evento.</span><span class="sxs-lookup"><span data-stu-id="84e97-112">The list of subscribers is maintained for the lifetime of the event class object.</span></span> <span data-ttu-id="84e97-113">Um evento pode ser entregue a vários assinantes em série ou em paralelo.</span><span class="sxs-lookup"><span data-stu-id="84e97-113">An event can be delivered to multiple subscribers either serially or in parallel.</span></span>

<span data-ttu-id="84e97-114">Ao implementar um objeto de classe de evento, você deve fornecer uma DLL de registro automático que exporta as funções [**DllRegisterServer**](/windows/desktop/api/olectl/nf-olectl-dllregisterserver) e [**DllUnregisterServer**](/windows/desktop/api/olectl/nf-olectl-dllunregisterserver) .</span><span class="sxs-lookup"><span data-stu-id="84e97-114">When you implement an event class object, you should provide a self-registering DLL that exports the [**DllRegisterServer**](/windows/desktop/api/olectl/nf-olectl-dllregisterserver) and [**DllUnregisterServer**](/windows/desktop/api/olectl/nf-olectl-dllunregisterserver) functions.</span></span> <span data-ttu-id="84e97-115">A função **DllRegisterServer** registra uma classe com e a função **DllUnregisterServer** cancela o registro do componente.</span><span class="sxs-lookup"><span data-stu-id="84e97-115">The **DllRegisterServer** function registers a COM class, and the **DllUnregisterServer** function unregisters the component.</span></span> <span data-ttu-id="84e97-116">Os objetos da classe de evento são armazenados no catálogo COM+, seja usando a ferramenta de administração de serviços de componentes ou programaticamente usando os métodos das interfaces [**ICOMAdminCatalog:: InstallEventClass**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installeventclass) ou [**ICOMAdminCatalog:: InstallMultipleEventClasses**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installmultipleeventclasses) .</span><span class="sxs-lookup"><span data-stu-id="84e97-116">Event class objects are stored in the COM+ catalog, either by using the Component Services administration tool or programmatically by using the methods of the [**ICOMAdminCatalog::InstallEventClass**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installeventclass) or [**ICOMAdminCatalog::InstallMultipleEventClasses**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installmultipleeventclasses) interfaces.</span></span> <span data-ttu-id="84e97-117">Para obter informações detalhadas sobre como registrar objetos de classe de evento, consulte [registrando uma classe de evento](registering-an-event-class.md).</span><span class="sxs-lookup"><span data-stu-id="84e97-117">For detailed information about registering event class objects, see [Registering an Event Class](registering-an-event-class.md).</span></span>

<span data-ttu-id="84e97-118">Como os objetos de classe de evento são componentes configurados, outros atributos, como enfileiramento, transações, segurança e assim por diante, podem ser configurados para eles usando a ferramenta de administração de serviços de componentes ou as funções do SDK administrativo do COM+.</span><span class="sxs-lookup"><span data-stu-id="84e97-118">Because event class objects are configured components, other attributes, such as queuing, transactions, security, and so on, can be configured for them by using either the Component Services administration tool or the COM+ Administrative SDK functions.</span></span>

> [!Note]  
> <span data-ttu-id="84e97-119">O serviço de eventos COM+ usa o marshaling de biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="84e97-119">The COM+ Events service uses type library marshaling.</span></span> <span data-ttu-id="84e97-120">Isso coloca algumas restrições em interfaces de classe de evento.</span><span class="sxs-lookup"><span data-stu-id="84e97-120">This places some restrictions on event class interfaces.</span></span> <span data-ttu-id="84e97-121">Por exemplo, o empacotador de biblioteca de tipos não dá suporte ao [**tamanho \_**](/windows/desktop/Midl/size-is) de atributos MIDL e o [**comprimento \_ é**](/windows/desktop/Midl/length-is).</span><span class="sxs-lookup"><span data-stu-id="84e97-121">For example, the type library marshaler does not support the MIDL attributes [**size\_is**](/windows/desktop/Midl/size-is) and [**length\_is**](/windows/desktop/Midl/length-is).</span></span>

 

<span data-ttu-id="84e97-122">Um objeto de classe de evento possui atributos de publicação que determinam a maneira como os eventos são publicados, bem como as seguintes propriedades:</span><span class="sxs-lookup"><span data-stu-id="84e97-122">An event class object possesses publication attributes that determine the way events are published, as well as the following properties:</span></span>

-   <span data-ttu-id="84e97-123">**EventCLSID**.</span><span class="sxs-lookup"><span data-stu-id="84e97-123">**EventCLSID**.</span></span> <span data-ttu-id="84e97-124">Um identificador exclusivo que especifica o CLSID do componente.</span><span class="sxs-lookup"><span data-stu-id="84e97-124">A unique identifier that specifies the CLSID of the component.</span></span>
-   <span data-ttu-id="84e97-125">**EventClassName**.</span><span class="sxs-lookup"><span data-stu-id="84e97-125">**EventClassName**.</span></span> <span data-ttu-id="84e97-126">Um identificador exclusivo que especifica o PROGID do componente.</span><span class="sxs-lookup"><span data-stu-id="84e97-126">A unique identifier that specifies the PROGID of the component.</span></span>
-   <span data-ttu-id="84e97-127">**Biblioteca**.</span><span class="sxs-lookup"><span data-stu-id="84e97-127">**TypeLibrary**.</span></span> <span data-ttu-id="84e97-128">Fornece uma lista de interfaces oferecidas pelo objeto de classe de evento.</span><span class="sxs-lookup"><span data-stu-id="84e97-128">Provides a list of interfaces offered by the event class object.</span></span> <span data-ttu-id="84e97-129">Não é necessário implementar as interfaces de acionamento especificadas na biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="84e97-129">There is no need to implement the firing interfaces specified in the type library.</span></span>

## <a name="related-topics"></a><span data-ttu-id="84e97-130">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="84e97-130">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="84e97-131">Considerações de segurança de eventos COM+</span><span class="sxs-lookup"><span data-stu-id="84e97-131">COM+ Events Security Considerations</span></span>](com--events-security-considerations.md)
</dt> <dt>

[<span data-ttu-id="84e97-132">Filtrando eventos no COM+</span><span class="sxs-lookup"><span data-stu-id="84e97-132">Filtering Events in COM+</span></span>](filtering-events-in-com-.md)
</dt> <dt>

[<span data-ttu-id="84e97-133">Publicando e fornecendo eventos no COM+</span><span class="sxs-lookup"><span data-stu-id="84e97-133">Publishing and Delivering Events in COM+</span></span>](publishing-and-delivering-events-in-com-.md)
</dt> <dt>

[<span data-ttu-id="84e97-134">Assinaturas</span><span class="sxs-lookup"><span data-stu-id="84e97-134">Subscriptions</span></span>](subscriptions.md)
</dt> <dt>

[<span data-ttu-id="84e97-135">Usando eventos COM+ com componentes em fila COM+</span><span class="sxs-lookup"><span data-stu-id="84e97-135">Using COM+ Events with COM+ Queued Components</span></span>](using-com--events-with-com--queued-components.md)
</dt> </dl>

 

 
