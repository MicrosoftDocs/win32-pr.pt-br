---
description: Melhorando o desempenho com o pooling de objetos
ms.assetid: 7a8a38d8-6549-4686-a298-f3b427b380e3
title: Melhorando o desempenho com o pooling de objetos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 398b9140080d3a439293b5152b4da7251978e800
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105811642"
---
# <a name="improving-performance-with-object-pooling"></a><span data-ttu-id="4ba23-103">Melhorando o desempenho com o pooling de objetos</span><span class="sxs-lookup"><span data-stu-id="4ba23-103">Improving Performance with Object Pooling</span></span>

<span data-ttu-id="4ba23-104">O pooling de objetos pode ser extremamente eficaz em determinadas circunstâncias, gerando aumentos substanciais no desempenho.</span><span class="sxs-lookup"><span data-stu-id="4ba23-104">Object pooling can be extremely effective in certain circumstances, yielding substantial increases in performance.</span></span> <span data-ttu-id="4ba23-105">A ideia geral para reutilizar objetos para a melhor vantagem é agrupar o máximo possível de recursos, fatorar a inicialização a partir do trabalho real realizado e, em seguida, adaptar administrativamente as características do pool ao hardware real no momento da implantação.</span><span class="sxs-lookup"><span data-stu-id="4ba23-105">The general idea for reusing objects to best advantage is to pool as many resources as possible, factoring out initialization from actual work performed, and then to administratively tailor the pool characteristics to actual hardware at deployment time.</span></span> <span data-ttu-id="4ba23-106">Ou seja, você deve continuar de acordo com as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="4ba23-106">That is, you should proceed according to the following steps:</span></span>

1.  <span data-ttu-id="4ba23-107">Escreva o objeto para fatorar a inicialização cara e a aquisição de recursos que são executadas para qualquer cliente como um pré-requisito para fazer o trabalho real em nome do cliente.</span><span class="sxs-lookup"><span data-stu-id="4ba23-107">Write the object so as to factor out expensive initialization and resource acquisition that is performed for any client as a prerequisite to doing actual work on the client's behalf.</span></span> <span data-ttu-id="4ba23-108">Grave construtores de objeto pesado no pool o máximo de recursos possível para que eles sejam mantidos pelo objeto e imediatamente disponíveis quando os clientes obtiverem um objeto do pool.</span><span class="sxs-lookup"><span data-stu-id="4ba23-108">Write heavy object constructors to pool as many resources as possible so that these are held by the object and immediately available when clients get an object from the pool.</span></span>
2.  <span data-ttu-id="4ba23-109">Configure administrativamente o pool para obter o melhor equilíbrio entre os recursos de hardware disponíveis, normalmente negociando a memória dedicada à manutenção de um pool de um determinado tamanho no Exchange para o acesso de cliente e o uso de objetos mais rápidos.</span><span class="sxs-lookup"><span data-stu-id="4ba23-109">Administratively configure the pool to achieve the best balance in available hardware resources, usually trading the memory dedicated to maintaining a pool of a certain size in exchange for faster client access and use of objects.</span></span> <span data-ttu-id="4ba23-110">Em um determinado ponto, o pooling atingirá os retornos e você poderá obter um bom desempenho suficiente ao mesmo tempo em que limita o possível uso de recursos por um componente específico.</span><span class="sxs-lookup"><span data-stu-id="4ba23-110">At a certain point, pooling will achieve diminishing returns and you can get good enough performance while limiting possible resource usage by a particular component.</span></span>

## <a name="doing-actual-work-or-acquiring-resources"></a><span data-ttu-id="4ba23-111">Fazendo trabalho real ou adquirindo recursos</span><span class="sxs-lookup"><span data-stu-id="4ba23-111">Doing Actual Work or Acquiring Resources</span></span>

<span data-ttu-id="4ba23-112">Se você tiver um componente que os clientes usarão brevemente e em uma rápida sucessão, em que uma parte significativa do tempo de uso do objeto é gasta na aquisição de recursos ou inicialização antes de fazer um trabalho específico para o cliente, é provável que escrever seu componente para usar o pooling de objetos será um grande ganho para você.</span><span class="sxs-lookup"><span data-stu-id="4ba23-112">If you have a component that clients will use briefly and in rapid succession, where a significant portion of object use time is spent in acquiring resources or initializing prior to doing specific work for the client, chances are that writing your component to use object pooling will be a big win for you.</span></span>

<span data-ttu-id="4ba23-113">Você pode escrever o componente de modo que, no construtor do objeto, você execute o trabalho demorado que seja uniforme para todos os clientes, adquirindo uma ou várias conexões, executando scripts, buscando dados de inicialização de arquivos ou em uma rede e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="4ba23-113">You can write the component so that in the object's constructor you perform as much of the time-consuming work that is uniform for all clients as possible—acquiring one or several connections, running scripts, fetching initialization data from files or across a network, and so forth.</span></span> <span data-ttu-id="4ba23-114">Isso tem o efeito de agrupar todos esses recursos.</span><span class="sxs-lookup"><span data-stu-id="4ba23-114">This has the effect of pooling every such resource.</span></span> <span data-ttu-id="4ba23-115">Você está agrupando a combinação de recursos e o estado genérico necessário para executar algum trabalho.</span><span class="sxs-lookup"><span data-stu-id="4ba23-115">You are pooling the combination of resources and generic state necessary to perform some work.</span></span>

<span data-ttu-id="4ba23-116">Nessa circunstância, quando os clientes obtêm um objeto do pool, eles têm esses recursos imediatamente disponíveis.</span><span class="sxs-lookup"><span data-stu-id="4ba23-116">In this circumstance, when clients get an object from the pool, they have those resources immediately available.</span></span> <span data-ttu-id="4ba23-117">Normalmente, eles usarão o objeto para fazer alguma pequena unidade de trabalho, enviar ou extrair dados e, em seguida, o objeto chamará [**IObjectContext:: SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) ou [**IObjectContext:: SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort) e Return.</span><span class="sxs-lookup"><span data-stu-id="4ba23-117">Typically, they will use the object to do some small unit of work, pushing or pulling data, and then the object will call [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) or [**IObjectContext::SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort) and return.</span></span> <span data-ttu-id="4ba23-118">Com padrões de uso de incêndio rápido, como esse, o pooling gera excelentes benefícios de desempenho.</span><span class="sxs-lookup"><span data-stu-id="4ba23-118">With rapid-fire use patterns such as this, pooling yields excellent performance benefits.</span></span> <span data-ttu-id="4ba23-119">Você pode aproveitar totalmente a simplicidade do modelo de programação de transação automática sem estado e, ainda assim, obter desempenho em comparação com componentes com estado tradicional.</span><span class="sxs-lookup"><span data-stu-id="4ba23-119">You can fully leverage the simplicity of the stateless automatic transaction programming model yet achieve performance on par with traditional stateful components.</span></span>

<span data-ttu-id="4ba23-120">No entanto, se os clientes usarem um objeto por um longo tempo toda vez que chamá-lo, o pooling fará menos sentido.</span><span class="sxs-lookup"><span data-stu-id="4ba23-120">However, if clients use an object for a long time each time they call it, pooling will make less sense.</span></span> <span data-ttu-id="4ba23-121">A vantagem da velocidade obtida é marginal, pois o tempo de uso aumenta em relação ao tempo de inicialização.</span><span class="sxs-lookup"><span data-stu-id="4ba23-121">The speed advantage that you gain is marginal as use time increases relative to initialization time.</span></span> <span data-ttu-id="4ba23-122">Você fica diminuindo os retornos que podem não justificar o custo da memória necessária para manter um pool de objetos ativos.</span><span class="sxs-lookup"><span data-stu-id="4ba23-122">You get diminishing returns that may not justify the cost of the memory necessary to hold a pool of active objects.</span></span>

## <a name="sharing-cost-across-multiple-clients"></a><span data-ttu-id="4ba23-123">Compartilhando custos entre vários clientes</span><span class="sxs-lookup"><span data-stu-id="4ba23-123">Sharing Cost Across Multiple Clients</span></span>

<span data-ttu-id="4ba23-124">Uma variação na inicialização de fatoração é que você pode usar o pooling para amortizar estatisticamente o custo de aquisição de recursos caros.</span><span class="sxs-lookup"><span data-stu-id="4ba23-124">A variation on factoring out initialization is that you can use pooling to statistically amortize the cost of acquiring expensive resources.</span></span> <span data-ttu-id="4ba23-125">Se você tomar a queda de aquisição ou inicialização uma vez e, em seguida, reutilizar o objeto, você compartilhará esse custo em todos os clientes que usam o objeto durante seu tempo de vida.</span><span class="sxs-lookup"><span data-stu-id="4ba23-125">If you take the hit of acquisition or initialization once and then reuse the object, you share that cost across all clients that use the object during its lifetime.</span></span> <span data-ttu-id="4ba23-126">O tempo de construção pesado é incorrido apenas uma vez por objeto.</span><span class="sxs-lookup"><span data-stu-id="4ba23-126">Heavy construction time is incurred only once per object.</span></span>

## <a name="preallocating-objects"></a><span data-ttu-id="4ba23-127">Pré-alocando objetos</span><span class="sxs-lookup"><span data-stu-id="4ba23-127">Preallocating Objects</span></span>

<span data-ttu-id="4ba23-128">Se você especificar um tamanho mínimo de pool diferente de zero, esse número mínimo de objetos será criado e agrupado quando o aplicativo for iniciado, pronto para todos os clientes que chamarem para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4ba23-128">If you specify a nonzero minimum pool size, that minimum number of objects will be created and pooled when the application starts, ready for any clients that call in to the application.</span></span>

## <a name="governing-resource-use-with-pool-management"></a><span data-ttu-id="4ba23-129">Controlando o uso de recursos com o gerenciamento de pool</span><span class="sxs-lookup"><span data-stu-id="4ba23-129">Governing Resource Use with Pool Management</span></span>

<span data-ttu-id="4ba23-130">Você pode usar o tamanho máximo do pool para controlar muito precisamente como você usa os recursos.</span><span class="sxs-lookup"><span data-stu-id="4ba23-130">You can use the maximum pool size to govern very precisely how you use resources.</span></span> <span data-ttu-id="4ba23-131">Por exemplo, se você tiver licenciado um determinado número de conexões de banco de dados, poderá controlar quantas conexões você abriu a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="4ba23-131">For example, if you have licensed a certain number of database connections, you can control how many connections you have open at any time.</span></span>

<span data-ttu-id="4ba23-132">Quando você leva em consideração padrões de uso do cliente, características de uso de objeto e recursos físicos como memória e conexões, é provável que você encontre algum ponto de equilíbrio ideal ao fazer o ajuste de desempenho.</span><span class="sxs-lookup"><span data-stu-id="4ba23-132">When you take into consideration client use patterns, object use characteristics, and physical resources such as memory and connections, you are likely to find some optimal balance point when you do performance tuning.</span></span> <span data-ttu-id="4ba23-133">Os objetos de Pooling produzirão uma redução de retornos após um determinado ponto.</span><span class="sxs-lookup"><span data-stu-id="4ba23-133">Pooling objects will yield diminishing returns after a certain point.</span></span> <span data-ttu-id="4ba23-134">Você pode determinar o nível de desempenho que você precisa e equilibrar isso em relação aos recursos necessários para obtê-lo.</span><span class="sxs-lookup"><span data-stu-id="4ba23-134">You can determine what level of performance you require and balance that against what resources are necessary to achieve it.</span></span>

<span data-ttu-id="4ba23-135">Para facilitar o ajuste de desempenho ao configurar o pool de objetos, você pode monitorar as estatísticas de objeto dos componentes em um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4ba23-135">To facilitate performance tuning when you configure object pooling, you can monitor object statistics for the components in an application.</span></span> <span data-ttu-id="4ba23-136">Para obter detalhes, consulte [monitorando estatísticas de objeto](monitoring-object-statistics.md).</span><span class="sxs-lookup"><span data-stu-id="4ba23-136">For details, see [Monitoring Object Statistics](monitoring-object-statistics.md).</span></span>

## <a name="improve-performance-of-jit-activated-components"></a><span data-ttu-id="4ba23-137">Melhorar o desempenho de componentes de JIT-Activated</span><span class="sxs-lookup"><span data-stu-id="4ba23-137">Improve Performance of JIT-Activated Components</span></span>

<span data-ttu-id="4ba23-138">O pool de objetos funciona muito bem com o serviço de [ativação Just-in-time do com+](com--just-in-time-activation.md) .</span><span class="sxs-lookup"><span data-stu-id="4ba23-138">Object pooling works very well with the [COM+ just-in-time activation](com--just-in-time-activation.md) service.</span></span> <span data-ttu-id="4ba23-139">Ao agrupar objetos que estão sendo ativados por JIT, você pode acelerar a reativação de objetos.</span><span class="sxs-lookup"><span data-stu-id="4ba23-139">By pooling objects that are being JIT-activated, you can speed object reactivation.</span></span> <span data-ttu-id="4ba23-140">Você Obtém os benefícios de manter o canal aberto pela ativação JIT e, ao mesmo tempo, reduzir o custo da reativação.</span><span class="sxs-lookup"><span data-stu-id="4ba23-140">You get the benefits of holding the channel open by JIT activation while mitigating the cost of reactivation.</span></span> <span data-ttu-id="4ba23-141">Você pode usar o pooling nesse caso para controlar a quantidade de memória que deseja alocar a objetos que têm referências ativas.</span><span class="sxs-lookup"><span data-stu-id="4ba23-141">You can use pooling in this case to govern how much memory you wish to allocate to objects that have references active.</span></span>

<span data-ttu-id="4ba23-142">É mais provável que você esteja agrupando componentes ativados por JIT quando eles são transacionais.</span><span class="sxs-lookup"><span data-stu-id="4ba23-142">You are most likely to be pooling JIT-activated components when they are transactional.</span></span> <span data-ttu-id="4ba23-143">O pooling de objetos é otimizado para manipular componentes transacionais.</span><span class="sxs-lookup"><span data-stu-id="4ba23-143">Object pooling is optimized to handle transactional components.</span></span> <span data-ttu-id="4ba23-144">Para obter mais informações, consulte [pooling de objetos transacionais](pooling-transactional-objects.md).</span><span class="sxs-lookup"><span data-stu-id="4ba23-144">For more information, see [Pooling Transactional Objects](pooling-transactional-objects.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="4ba23-145">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="4ba23-145">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="4ba23-146">Cadeias de caracteres do construtor do objeto COM+</span><span class="sxs-lookup"><span data-stu-id="4ba23-146">COM+ Object Constructor Strings</span></span>](com--object-constructor-strings.md)
</dt> <dt>

[<span data-ttu-id="4ba23-147">Controlando o tempo de vida e o estado do objeto</span><span class="sxs-lookup"><span data-stu-id="4ba23-147">Controlling Object Lifetime and State</span></span>](controlling-object-lifetime-and-state.md)
</dt> <dt>

[<span data-ttu-id="4ba23-148">Como o pool de objetos funciona</span><span class="sxs-lookup"><span data-stu-id="4ba23-148">How Object Pooling Works</span></span>](how-object-pooling-works.md)
</dt> <dt>

[<span data-ttu-id="4ba23-149">Pooling de objetos transacionais</span><span class="sxs-lookup"><span data-stu-id="4ba23-149">Pooling Transactional Objects</span></span>](pooling-transactional-objects.md)
</dt> <dt>

[<span data-ttu-id="4ba23-150">Requisitos para objetos pooling</span><span class="sxs-lookup"><span data-stu-id="4ba23-150">Requirements for Poolable Objects</span></span>](requirements-for-poolable-objects.md)
</dt> </dl>

 

 



