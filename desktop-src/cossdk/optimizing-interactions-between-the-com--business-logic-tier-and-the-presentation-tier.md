---
description: Normalmente, a latência entre as camadas de um aplicativo distribuído difere muito.
ms.assetid: 4780a9fd-5940-4b10-a596-22214b17c033
title: Otimização de interações entre a camada de lógica de negócios COM+ e a camada de apresentação
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fe6094cb12cc7875d8a18dea3d28ac55bf8d6ae2
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105760592"
---
# <a name="optimizing-interactions-between-the-com-business-logic-tier-and-the-presentation-tier"></a><span data-ttu-id="9cdfc-103">Otimização de interações entre a camada de lógica de negócios COM+ e a camada de apresentação</span><span class="sxs-lookup"><span data-stu-id="9cdfc-103">Optimizing Interactions Between the COM+ Business Logic Tier and the Presentation Tier</span></span>

<span data-ttu-id="9cdfc-104">Normalmente, a latência entre as camadas de um aplicativo distribuído difere muito.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-104">Typically, the latency between tiers of a distributed application differs greatly.</span></span> <span data-ttu-id="9cdfc-105">As chamadas entre a camada de apresentação e a camada de lógica de negócios geralmente são uma ordem de magnitude mais lenta do que as chamadas entre a camada de negócios e a camada de dados.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-105">Calls between the presentation tier and business logic tier are often an order of magnitude slower than calls between the business tier and data tier.</span></span> <span data-ttu-id="9cdfc-106">Como resultado, o estado retido é mais dispendioso ao chamar a camada de lógica de negócios.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-106">As a result, held state is more costly when calling into the business logic tier.</span></span>

<span data-ttu-id="9cdfc-107">Os tópicos a seguir discutem maneiras de passar dados entre as camadas de lógica de negócios e apresentação:</span><span class="sxs-lookup"><span data-stu-id="9cdfc-107">The following topics discuss ways to pass data between the presentation and business logic tiers:</span></span>

-   [<span data-ttu-id="9cdfc-108">Passar parâmetros</span><span class="sxs-lookup"><span data-stu-id="9cdfc-108">Passing Parameters</span></span>](#passing-parameters)
-   [<span data-ttu-id="9cdfc-109">Opções de passagem de dados</span><span class="sxs-lookup"><span data-stu-id="9cdfc-109">Data Passing Options</span></span>](#data-passing-options)
-   [<span data-ttu-id="9cdfc-110">Usando um padrão de fábrica para passar dados</span><span class="sxs-lookup"><span data-stu-id="9cdfc-110">Using a Factory Pattern to Pass Data</span></span>](#using-a-factory-pattern-to-pass-data)
-   [<span data-ttu-id="9cdfc-111">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="9cdfc-111">Related topics</span></span>](#related-topics)

## <a name="passing-parameters"></a><span data-ttu-id="9cdfc-112">Passar parâmetros</span><span class="sxs-lookup"><span data-stu-id="9cdfc-112">Passing Parameters</span></span>

<span data-ttu-id="9cdfc-113">Para um determinado conjunto de informações a ser passado entre a camada de apresentação e a camada de lógica de negócios, você pode ter uma única linha, várias linhas ou uma combinação de uma única linha (como um cabeçalho) e várias linhas de detalhes de dados.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-113">For a given set of information to be passed between the presentation tier and the business logic tier, you may have a single row, multiple rows, or a combination of a single row (such as a header) and multiple detail rows of data.</span></span> <span data-ttu-id="9cdfc-114">A maneira mais eficiente de passar essas informações entre camadas é por uma única chamada de método.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-114">The most efficient way to pass this information between tiers is by a single method call.</span></span> <span data-ttu-id="9cdfc-115">Essa chamada única gerenciaria todo o conjunto de informações a ser passado.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-115">This single call would manage the entire information set to be passed.</span></span> <span data-ttu-id="9cdfc-116">Isso é necessário, a menos que você opte por controlar a transação da camada de apresentação (e faça com que todo o tratamento da transação na camada de apresentação seja idêntico na função).</span><span class="sxs-lookup"><span data-stu-id="9cdfc-116">This is necessary unless you choose to control the transaction from the presentation tier (and make all transaction treatment in the presentation tier identical in function).</span></span> <span data-ttu-id="9cdfc-117">A Microsoft não recomenda a condução de transações da camada de apresentação porque as chamadas entre essa camada e a camada de lógica de negócios geralmente são as mais lentas de quaisquer chamadas em um aplicativo de várias camadas.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-117">Microsoft does not recommend conducting transactions from the presentation tier because calls between this tier and the business logic tier are usually the slowest of any calls in a multi-tier application.</span></span>

<span data-ttu-id="9cdfc-118">Uma maneira de criar esse método é passar linhas únicas de informações como parâmetros e passar várias linhas como conjuntos de registros ADO.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-118">One way to create such a method is to pass single rows of information as parameters and pass multiple rows as ADO recordsets.</span></span> <span data-ttu-id="9cdfc-119">Os conjuntos de registros são o núcleo da metodologia de acesso a dados ADO da Microsoft e o uso de conjuntos de registros ADO permite que você transmita todas as informações relacionadas a uma única transação em uma só etapa.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-119">Recordsets are the core of Microsoft's ADO data access methodology, and using ADO recordsets allows you to pass all the information related to a single transaction in one step.</span></span>

## <a name="data-passing-options"></a><span data-ttu-id="9cdfc-120">Opções de passagem de dados</span><span class="sxs-lookup"><span data-stu-id="9cdfc-120">Data Passing Options</span></span>

<span data-ttu-id="9cdfc-121">Há outras opções a serem consideradas ao passar dados.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-121">There are other options to consider when passing data.</span></span> <span data-ttu-id="9cdfc-122">Isso inclui o uso de uma lista de parâmetros e conjuntos de registros ADO (como discutido acima), apenas conjuntos de registros ADO, cadeias de caracteres codificadas em XML ou matrizes de estruturas.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-122">These include using a list of parameters and ADO recordsets (as discussed above), just ADO recordsets, XML encoded strings, or arrays of structures.</span></span> <span data-ttu-id="9cdfc-123">Esta seção aborda cada uma dessas opções.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-123">This section discusses each of these options.</span></span>

<span data-ttu-id="9cdfc-124">A tabela a seguir mostra áreas em que é necessário ter cuidado extra ao usar qualquer uma das quatro diferentes possibilidades de passagem de argumentos.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-124">The following table shows areas where extra care needs to be taken when using any of the four different argument-passing possibilities.</span></span> <span data-ttu-id="9cdfc-125">Um "X" representa áreas em que as compensações precisam ser compreendidas e avaliadas em relação às necessidades de cada projeto.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-125">An "X" represents areas where trade-offs need to be understood and weighed against the needs of each project.</span></span> <span data-ttu-id="9cdfc-126">Tente não fazer decisões de passagem de argumentos em uma base por componente.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-126">Try not to make argument-passing decisions on a per-component basis.</span></span> <span data-ttu-id="9cdfc-127">Os benefícios de um modelo de programação consistente em todo o projeto superam muito a vantagem de otimizar em uma base por método ou por componente em todas as circunstâncias mais extremas.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-127">The benefits of a consistent programming model throughout a project far outweigh any advantage of optimizing on a per-method or per-component basis in all but the most extreme circumstances.</span></span> <span data-ttu-id="9cdfc-128">As colunas são descritas na lista que segue a tabela.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-128">The columns are described in the list that follows the table.</span></span>



|                       | <span data-ttu-id="9cdfc-129">Simultaneidade</span><span class="sxs-lookup"><span data-stu-id="9cdfc-129">Concurrency</span></span>  | <span data-ttu-id="9cdfc-130">WAN</span><span class="sxs-lookup"><span data-stu-id="9cdfc-130">WAN</span></span>          | <span data-ttu-id="9cdfc-131">Implantação</span><span class="sxs-lookup"><span data-stu-id="9cdfc-131">Deployment</span></span>   | <span data-ttu-id="9cdfc-132">Complexidade</span><span class="sxs-lookup"><span data-stu-id="9cdfc-132">Complexity</span></span>   |
|-----------------------|--------------|--------------|--------------|--------------|
| <span data-ttu-id="9cdfc-133">Entrada</span><span class="sxs-lookup"><span data-stu-id="9cdfc-133">Entry</span></span> | <span data-ttu-id="9cdfc-134">Valor</span><span class="sxs-lookup"><span data-stu-id="9cdfc-134">Value</span></span> |
| <span data-ttu-id="9cdfc-135">Conjuntos</span><span class="sxs-lookup"><span data-stu-id="9cdfc-135">Recordsets</span></span><br/> |              | <span data-ttu-id="9cdfc-136">X</span><span class="sxs-lookup"><span data-stu-id="9cdfc-136">X</span></span><br/> | <span data-ttu-id="9cdfc-137">X</span><span class="sxs-lookup"><span data-stu-id="9cdfc-137">X</span></span><br/> | <span data-ttu-id="9cdfc-138">X</span><span class="sxs-lookup"><span data-stu-id="9cdfc-138">X</span></span><br/> |
| <span data-ttu-id="9cdfc-139">XML</span><span class="sxs-lookup"><span data-stu-id="9cdfc-139">XML</span></span><br/>        | <span data-ttu-id="9cdfc-140">X</span><span class="sxs-lookup"><span data-stu-id="9cdfc-140">X</span></span><br/> |              | <span data-ttu-id="9cdfc-141">X</span><span class="sxs-lookup"><span data-stu-id="9cdfc-141">X</span></span><br/> | <span data-ttu-id="9cdfc-142">X</span><span class="sxs-lookup"><span data-stu-id="9cdfc-142">X</span></span><br/> |
| <span data-ttu-id="9cdfc-143">Matrizes</span><span class="sxs-lookup"><span data-stu-id="9cdfc-143">Arrays</span></span><br/>     | <span data-ttu-id="9cdfc-144">X</span><span class="sxs-lookup"><span data-stu-id="9cdfc-144">X</span></span><br/> |              | <span data-ttu-id="9cdfc-145">X</span><span class="sxs-lookup"><span data-stu-id="9cdfc-145">X</span></span><br/> | <span data-ttu-id="9cdfc-146">X</span><span class="sxs-lookup"><span data-stu-id="9cdfc-146">X</span></span><br/> |



 

<span data-ttu-id="9cdfc-147">As quatro colunas definem áreas a serem inspecionadas ao usar essa opção para passar parâmetros.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-147">The four columns define areas to watch out for when using that option to pass parameters.</span></span>

-   <span data-ttu-id="9cdfc-148">**A coluna Concurrency** representa a necessidade de codificar ou fornecer um mecanismo que gerencia condições de bloqueio em operações de atualização.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-148">**The Concurrency column** represents the need to code or provide a mechanism that manages locking conditions on update operations.</span></span> <span data-ttu-id="9cdfc-149">Como os métodos que executam salvas podem representar atualizações, podem surgir problemas de simultaneidade.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-149">Since methods that perform saves can represent updates, concurrency problems can arise.</span></span> <span data-ttu-id="9cdfc-150">Dois tipos de bloqueio são predominantemente otimistas e pessimistas.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-150">Two types of locking are prevalent optimistic and pessimistic.</span></span> <span data-ttu-id="9cdfc-151">Os bloqueios pessimistas impedem que um usuário obtenha dados para atualização enquanto outro usuário tem o potencial de executar uma atualização.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-151">Pessimistic locks prevent a user from getting data for update while another user has the potential for performing an update.</span></span> <span data-ttu-id="9cdfc-152">O bloqueio otimista dá suporte a um grande número maior de usuários, negociando com a probabilidade de que os dois usuários atualizem o mesmo documento ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-152">Optimistic locking supports a great many more users by trading against the likelihood that any two users would be updating the same document at the same time.</span></span> <span data-ttu-id="9cdfc-153">Chamadas de bloqueio otimista para verificação para ver se os dados armazenados correspondem aos dados no ponto em que uma cópia dos dados foi acessada para modificação.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-153">Optimistic locking calls for checking to see that the data that is stored matches the data at the point when a copy of the data was accessed for modification.</span></span> <span data-ttu-id="9cdfc-154">Os conjuntos de registros ADO fornecem suporte automático para bloqueio otimista.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-154">ADO recordsets provide automatic support for optimistic locking.</span></span> <span data-ttu-id="9cdfc-155">Cenários de atualização que envolvem listas de parâmetros de linha única não fornecem suporte suficiente para verificação de simultaneidade.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-155">Update scenarios involving single row parameter lists do not provide sufficient support for concurrency checking.</span></span> <span data-ttu-id="9cdfc-156">O XML sofre a partir desse mesmo problema, pois nenhum reconhecimento de bloqueio está presente nos dados XML.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-156">XML suffers from this same problem, in that no locking awareness is present in XML data.</span></span>
-   <span data-ttu-id="9cdfc-157">**A coluna Wan representa as** condições em que pode haver contenção de transmissão em uma WAN (rede de longa distância).</span><span class="sxs-lookup"><span data-stu-id="9cdfc-157">**The WAN column** represents conditions where there may be transmission contention on a wide area network (WAN ).</span></span> <span data-ttu-id="9cdfc-158">Quando a WAN não tem capacidade suficiente para gerenciar todos os dados que estão sendo movidos a qualquer momento, os usuários do aplicativo experimentam atrasos de tempo de resposta.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-158">When the WAN does not have sufficient capacity to manage all of the data being moved at any one time, application users experience response time delays.</span></span> <span data-ttu-id="9cdfc-159">Para dar suporte à simultaneidade otimista, os conjuntos de registros ADO desconectados passam duas cópias dos dados do servidor para o cliente.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-159">To support optimistic concurrency, disconnected ADO recordsets pass two copies of the data from the server to the client.</span></span> <span data-ttu-id="9cdfc-160">A segunda cópia é usada pelo cliente para determinar o menor conjunto de linhas de atualização a ser passado quando uma alteração está sendo confirmada.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-160">The second copy is used by the client to determine the smallest update rowset to pass back when a change is being committed.</span></span> <span data-ttu-id="9cdfc-161">Embora isso reduz o tráfego da camada de apresentação para os dados, a carga extra da segunda cópia pode ser significativa.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-161">While this cuts down on traffic from the presentation tier to the data, the extra load of the second copy can be significant.</span></span> <span data-ttu-id="9cdfc-162">O uso de conjuntos de registros como o único meio de passar todas as informações, portanto, faz com que o dobro de dados seja passado entre as camadas conforme necessário, exceto quando o conjunto de linhas de atualização está sendo passado de volta para a camada de dados de uma camada de apresentação.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-162">Using recordsets as the sole means of passing all information therefore causes twice as much data to be passed between tiers as is required, except when the update rowset is being passed back to the data tier from a presentation tier.</span></span>
-   <span data-ttu-id="9cdfc-163">**A coluna de implantação** representa os problemas associados à passagem de dados quando uma tecnologia especial é necessária no lado do chamador e do componente da rede.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-163">**The Deployment column** represents issues associated with data passing when special technology is required on both the caller and component side of the network.</span></span> <span data-ttu-id="9cdfc-164">Por exemplo, o uso de conjuntos de registros ADO exige que os componentes do ADO estejam presentes no cliente e no servidor.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-164">For example, using ADO recordsets requires ADO components to be present on both client and server.</span></span> <span data-ttu-id="9cdfc-165">Analisadores XML também devem estar presentes em ambos os lados, para evitar ter que codificar analisadores em seus aplicativos.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-165">XML parsers must be present on both sides as well, to avoid having to code parsers into your applications.</span></span>
-   <span data-ttu-id="9cdfc-166">**A coluna complexidade** é indicada para todas as quatro opções e é uma questão de preferência ou experiência de modelo de programação anterior que pode já estar estabelecida em sua organização de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-166">**The Complexity column** is indicated for all four choices, and is a matter of preference or prior programming model experience that may be already established in your development organization.</span></span> <span data-ttu-id="9cdfc-167">Algumas pessoas acham a passagem de parâmetros para serem difíceis e acham que ela acrescenta muita complexidade ao problema de programação.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-167">Some people find parameter passing to be cumbersome and feel it adds too much complexity to the programming problem.</span></span> <span data-ttu-id="9cdfc-168">Manter o controle de qual parâmetro você está lidando e colocá-los visíveis em uma janela de edição pode criar uma complexidade logística que alguns desenvolvedores podem encontrar não gerenciáveis.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-168">Keeping track of which parameter you are handling, and getting them all visible in one editing window, can create a logistical complexity that some developers find unmanageable.</span></span>

<span data-ttu-id="9cdfc-169">O método de passagem de parâmetro também pode ter compensações, como as seguintes:</span><span class="sxs-lookup"><span data-stu-id="9cdfc-169">The parameter-passing method also can have trade-offs, such as the following:</span></span>

-   <span data-ttu-id="9cdfc-170">Os parâmetros podem envolver o gerenciamento de vários argumentos e tipos de argumento, bem como a necessidade de decidir quando é apropriado fazer com que um conjunto de registros seja um parâmetro.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-170">Parameters can involve managing multiple arguments and argument types as well as having to decide when it is appropriate to make a recordset a parameter.</span></span>
-   <span data-ttu-id="9cdfc-171">Os conjuntos de registros ADO podem cortar relações hierárquicas em parâmetros de método para um ou dois argumentos.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-171">ADO recordsets can cut hierarchical relationships in method parameters down to one or two arguments.</span></span> <span data-ttu-id="9cdfc-172">Isso simplifica drasticamente o modelo de programação e dá suporte à adição de colunas em um momento posterior, mas também oculta a hierarquia de informações.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-172">This simplifies the programming model dramatically and supports adding columns at a later time, but it also hides the information hierarchy.</span></span> <span data-ttu-id="9cdfc-173">O uso de informações em um conjunto de registros ADO e posteriormente sua extração envolve saber os nomes de cada coluna ou conhecer a ordem das colunas.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-173">Stuffing information into an ADO recordset and later extracting it involves knowing the names of each column or knowing the column order.</span></span> <span data-ttu-id="9cdfc-174">Essa situação pode adicionar complexidade para outros desenvolvedores de componentes ou aplicativos no projeto.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-174">This situation can add complexity for other component or application developers on the project.</span></span>
-   <span data-ttu-id="9cdfc-175">O XML é uma rotação diferente na complicação da hierarquia oculta mencionada acima.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-175">XML is a different spin on the hidden hierarchy complication mentioned above.</span></span> <span data-ttu-id="9cdfc-176">O programador precisa entender o uso de um analisador XML para obter acesso às informações e, muitas vezes, deve saber os nomes de cada item no conjunto de dados antes que o conjunto de dados possa ser encontrado.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-176">The programmer needs to understand the use of an XML parser to gain access to the information and often must know the names of each item in the data set before the data set can be found.</span></span>
-   <span data-ttu-id="9cdfc-177">Matrizes de estruturas apresentam a necessidade de uma compreensão comum das informações que estão sendo passadas por parte do chamador e do componente.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-177">Arrays of structures introduce the need for a common understanding of the information being passed on the part of both caller and component.</span></span> <span data-ttu-id="9cdfc-178">Essa necessidade de um mapa compartilhado entre dois elementos do sistema pode levar a dificuldades ao lidar com versões diferentes de componentes.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-178">This need for a map that is shared between two system elements can lead to difficulties when dealing with different versions of components.</span></span> <span data-ttu-id="9cdfc-179">Embora a assinatura do método não seja alterada, as alterações nas informações esperadas podem renderizar os programas de chamada incompatíveis.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-179">While the method signature might not change, changes to the expected information can render calling programs incompatible.</span></span>

<span data-ttu-id="9cdfc-180">Como os problemas de complexidade associados a todos os quatro métodos de passagem de parâmetros são tão semelhantes, é um debate de que há uma oportunidade de simplificação significativa associada a uma seleção.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-180">Because the complexity issues associated with all four parameter-passing methods are so similar, it is debatable that there is a significant simplification opportunity associated with any one selection.</span></span>

## <a name="using-a-factory-pattern-to-pass-data"></a><span data-ttu-id="9cdfc-181">Usando um padrão de fábrica para passar dados</span><span class="sxs-lookup"><span data-stu-id="9cdfc-181">Using a Factory Pattern to Pass Data</span></span>

<span data-ttu-id="9cdfc-182">Um ponto de design importante é a facilidade de uso.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-182">One important design point is ease of use.</span></span> <span data-ttu-id="9cdfc-183">No momento em que você decidiu usar conjuntos de registros ADO para passar um conjunto estruturado de detalhes de volta para a camada de apresentação, você introduziu um problema de complexidade.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-183">The moment you decided to use ADO recordsets to pass a structured set of details back to the presentation tier, you introduced a complexity problem.</span></span> <span data-ttu-id="9cdfc-184">Os programadores da camada de apresentação precisam entender a estrutura desses conjuntos de registros.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-184">Presentation tier programmers need to understand the structure of those recordsets.</span></span> <span data-ttu-id="9cdfc-185">Um problema maior de complexidade pode surgir quando você precisa de vários detalhes para que um conjunto de dados seja passado em um conjunto de registros.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-185">A greater complexity issue can arise when you require multiple details for a set of data to be passed in a recordset.</span></span> <span data-ttu-id="9cdfc-186">Para simplificar as coisas, você deve considerar a criação de um método de fábrica do conjunto de registros sempre que pretender exigir que os dados sejam passados em conjuntos de registros ADO estruturados.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-186">To simplify matters, you should consider creating a recordset factory method whenever you intend to require data to be passed in structured ADO recordsets.</span></span>

<span data-ttu-id="9cdfc-187">A fábrica do conjunto de registros deve retornar um conjunto de registros desconectado vazio, mas gravável para o chamador.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-187">The recordset factory should return an empty but writable disconnected recordset to the caller.</span></span> <span data-ttu-id="9cdfc-188">Esse conjunto de registros deve ter os campos apropriados (nomes e tipos de dados) já configurados para que o cliente de chamada não precise saber como fabricar o conjunto de registros.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-188">This recordset should have the proper fields (names and data types) already configured so that the calling client does not need to know how to manufacture the recordset.</span></span> <span data-ttu-id="9cdfc-189">Essa abordagem é geralmente conhecida como padrão de *fábrica* e é um padrão de solução comum que resolve a necessidade de criar um objeto de uma determinada complexidade sem ter que conhecer as nuances de criá-la.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-189">This approach is often referred to as the *factory pattern* and is a common solution pattern that solves the need to create an object of a given complexity without having to know the nuances of creating it.</span></span>

<span data-ttu-id="9cdfc-190">Opções de design simples, como escolher o mesmo nome de parâmetro para os mesmos dados em todos os métodos em que essas informações são passadas, facilitam a visão de um método e a sua expectativa.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-190">Simple design choices such as choosing the same parameter name for the same piece of data across every method where that information is passed makes it easy to look at a method and know what is expected.</span></span> <span data-ttu-id="9cdfc-191">Certificar-se de que a ordem na qual os argumentos são passados é consistente em toda a família de métodos fornece um ponto de conforto que impõe um modelo consistente.</span><span class="sxs-lookup"><span data-stu-id="9cdfc-191">Making sure that the order in which like arguments are passed is consistent across an entire family of methods provides a comfort point that enforces a consistent model.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9cdfc-192">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="9cdfc-192">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9cdfc-193">Otimização de interações entre a camada de lógica de negócios COM+ e a camada de dados</span><span class="sxs-lookup"><span data-stu-id="9cdfc-193">Optimizing Interactions Between the COM+ Business Logic Tier and the Data Tier</span></span>](optimizing-interactions-between-the-com--business-logic-tier-and-the-data-tier.md)
</dt> </dl>

 

 




