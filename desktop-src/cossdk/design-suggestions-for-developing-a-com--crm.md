---
description: Sugestões de design para o desenvolvimento de um CRM COM+
ms.assetid: dde1b978-6d35-4a75-91fd-69dfcc6c43d2
title: Sugestões de design para o desenvolvimento de um CRM COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8dcdb59f0ea23fb6879300d0bacec7df12970d81
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104164021"
---
# <a name="design-suggestions-for-developing-a-com-crm"></a><span data-ttu-id="f14a1-103">Sugestões de design para o desenvolvimento de um CRM COM+</span><span class="sxs-lookup"><span data-stu-id="f14a1-103">Design Suggestions for Developing a COM+ CRM</span></span>

<span data-ttu-id="f14a1-104">Veja a seguir as etapas sugeridas para o desenvolvimento de um CRM COM+:</span><span class="sxs-lookup"><span data-stu-id="f14a1-104">Following are suggested steps for developing a COM+ CRM:</span></span>

1.  <span data-ttu-id="f14a1-105">Antes de iniciar o desenvolvimento, defina o tempo limite da transação como zero (usando a ferramenta administrativa serviços de componentes).</span><span class="sxs-lookup"><span data-stu-id="f14a1-105">Before starting development, set the transaction time-out to zero (using the Component Services administrative tool).</span></span> <span data-ttu-id="f14a1-106">Defina o sinalizador do registro VTRACE1 (consulte [configurações do registro do com+ CRM](com--crm-registry-settings.md)) para ver as mensagens de aviso e de erro do CRM no rastreamento de depuração.</span><span class="sxs-lookup"><span data-stu-id="f14a1-106">Set the VTRACE1 registry flag (see [COM+ CRM Registry Settings](com--crm-registry-settings.md)) to see CRM warning and error messages on the debug trace.</span></span>
2.  <span data-ttu-id="f14a1-107">Determine qual conjunto de interfaces você precisa usar, estruturado (variantes) ou não estruturado.</span><span class="sxs-lookup"><span data-stu-id="f14a1-107">Determine which set of interfaces you need to use, structured (Variants) or non-structured.</span></span> <span data-ttu-id="f14a1-108">(Consulte [interfaces do CRM do com+](com--crm-interfaces.md).) Isso dependerá do idioma que você usa para desenvolver seu CRM, por exemplo, Microsoft Visual C++ ou Microsoft Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="f14a1-108">(See [COM+ CRM Interfaces](com--crm-interfaces.md).) This will depend on the language that you use to develop your CRM—for example, Microsoft Visual C++ or Microsoft Visual Basic.</span></span>
3.  <span data-ttu-id="f14a1-109">Desenvolva primeiro o trabalhador do CRM.</span><span class="sxs-lookup"><span data-stu-id="f14a1-109">Develop the CRM worker first.</span></span> <span data-ttu-id="f14a1-110">Determine as informações necessárias nos registros de log.</span><span class="sxs-lookup"><span data-stu-id="f14a1-110">Determine the information that is required in the log records.</span></span> <span data-ttu-id="f14a1-111">Defina os tipos de registros de log necessários e seu formato.</span><span class="sxs-lookup"><span data-stu-id="f14a1-111">Define the types of log records required and their format.</span></span>
4.  <span data-ttu-id="f14a1-112">Um compensador de CRM de depuração é fornecido como parte dos exemplos de CRM (no SDK do Windows).</span><span class="sxs-lookup"><span data-stu-id="f14a1-112">A debug CRM compensator is provided as part of the CRM samples (in the Windows SDK).</span></span> <span data-ttu-id="f14a1-113">Isso pode ser usado temporariamente ao depurar o trabalho do CRM no lugar do compensador de CRM real.</span><span class="sxs-lookup"><span data-stu-id="f14a1-113">This can be used temporarily when debugging the CRM worker in place of the real CRM compensator.</span></span>
5.  <span data-ttu-id="f14a1-114">Quando o trabalho do CRM estiver funcionando corretamente, desenvolva o compensador de CRM real e substitua o compensador de CRM de depuração pelo compensador de CRM real.</span><span class="sxs-lookup"><span data-stu-id="f14a1-114">When the CRM worker is working correctly, develop the real CRM compensator and replace the debug CRM compensator with the real CRM compensator.</span></span>
6.  <span data-ttu-id="f14a1-115">Pode ser desejável inicialmente não testar o caso de recuperação.</span><span class="sxs-lookup"><span data-stu-id="f14a1-115">It may be desirable to initially not test the recovery case.</span></span> <span data-ttu-id="f14a1-116">Nesse caso, exclua o arquivo de log do CRM para o aplicativo do servidor CRM sempre antes de iniciar esse aplicativo do CRM Server.</span><span class="sxs-lookup"><span data-stu-id="f14a1-116">If so, delete the CRM log file for the CRM server application each time before starting that CRM server application.</span></span>

## <a name="considerations"></a><span data-ttu-id="f14a1-117">Considerações</span><span class="sxs-lookup"><span data-stu-id="f14a1-117">Considerations</span></span>

1.  <span data-ttu-id="f14a1-118">**Write-ahead.**</span><span class="sxs-lookup"><span data-stu-id="f14a1-118">**Write ahead.**</span></span> <span data-ttu-id="f14a1-119">O componente de trabalho do CRM deve fazer write-ahead; ou seja, ele deve gravar um registro de log indicando que vai executar uma ação antes de realmente executar essa ação.</span><span class="sxs-lookup"><span data-stu-id="f14a1-119">The CRM worker component must write ahead; that is, it must write a log record indicating it is going to perform an action before actually performing that action.</span></span> <span data-ttu-id="f14a1-120">Além disso, esse registro de log deve ser forçado para o disco após a gravação e antes da ação ser executada.</span><span class="sxs-lookup"><span data-stu-id="f14a1-120">In addition, this log record must be forced to disk after the write and before the action is performed.</span></span>
2.  <span data-ttu-id="f14a1-121">**Isolado.**</span><span class="sxs-lookup"><span data-stu-id="f14a1-121">**Isolation.**</span></span> <span data-ttu-id="f14a1-122">O CRM não impõe o isolamento.</span><span class="sxs-lookup"><span data-stu-id="f14a1-122">The CRM does not enforce isolation.</span></span> <span data-ttu-id="f14a1-123">O design de CRM deve fornecer isolamento entre vários clientes em transações separadas e também deve considerar o caso antes da recuperação.</span><span class="sxs-lookup"><span data-stu-id="f14a1-123">The CRM design must provide isolation between multiple clients on separate transactions and must also consider the case prior to recovery.</span></span>
3.  <span data-ttu-id="f14a1-124">**Recuperação em andamento.**</span><span class="sxs-lookup"><span data-stu-id="f14a1-124">**Recovery in progress.**</span></span> <span data-ttu-id="f14a1-125">O trabalho do CRM deve lidar com o código de erro "recuperação em andamento".</span><span class="sxs-lookup"><span data-stu-id="f14a1-125">The CRM worker must handle the "recovery in progress" error code.</span></span> <span data-ttu-id="f14a1-126">Consulte [Solucionando problemas do CRM com+](troubleshooting-the-com--crm.md) para obter mais informações sobre esse código de erro.</span><span class="sxs-lookup"><span data-stu-id="f14a1-126">See [Troubleshooting the COM+ CRM](troubleshooting-the-com--crm.md) for more information about this error code.</span></span>
4.  <span data-ttu-id="f14a1-127">**Tratamento de erros.**</span><span class="sxs-lookup"><span data-stu-id="f14a1-127">**Error handling.**</span></span> <span data-ttu-id="f14a1-128">O trabalhador do CRM deve lidar com o caso em que a transação é anulada antes do esperado.</span><span class="sxs-lookup"><span data-stu-id="f14a1-128">The CRM worker must cope with the case where the transaction is aborted earlier than expected.</span></span> <span data-ttu-id="f14a1-129">Consulte a seção [tratamento de erros no CRM do com+](error-handling-in-the-com--crm.md).</span><span class="sxs-lookup"><span data-stu-id="f14a1-129">See the section [Error Handling in the COM+ CRM](error-handling-in-the-com--crm.md).</span></span>
5.  <span data-ttu-id="f14a1-130">**Tempo de recuperação.**</span><span class="sxs-lookup"><span data-stu-id="f14a1-130">**Recovery time.**</span></span> <span data-ttu-id="f14a1-131">O compensador de CRM deve ser criado para executar a recuperação rapidamente para que o novo trabalho para esse aplicativo do CRM Server não precise esperar.</span><span class="sxs-lookup"><span data-stu-id="f14a1-131">The CRM compensator should be designed to perform recovery quickly so that new work for that CRM server application does not have to wait.</span></span>
6.  <span data-ttu-id="f14a1-132">**Idempotência.**</span><span class="sxs-lookup"><span data-stu-id="f14a1-132">**Idempotence.**</span></span> <span data-ttu-id="f14a1-133">É possível que um compensador de CRM receba o mesmo registro de log novamente, para desfazer ou refazer uma ação que já foi desfeita ou refeita.</span><span class="sxs-lookup"><span data-stu-id="f14a1-133">It is possible that a CRM compensator might receive the same log record again, to undo or redo an action that has already been undone or redone.</span></span> <span data-ttu-id="f14a1-134">Ações que o compensador de CRM pode executar devem ser idempotentes, o que geralmente significa que os códigos de erro retornados dessas ações devem ser ignorados.</span><span class="sxs-lookup"><span data-stu-id="f14a1-134">Actions that the CRM compensator might perform must be idempotent, which often means that the error codes returned from these actions should be ignored.</span></span>
7.  <span data-ttu-id="f14a1-135">**Inicialização da recuperação.**</span><span class="sxs-lookup"><span data-stu-id="f14a1-135">**Initiation of recovery.**</span></span> <span data-ttu-id="f14a1-136">A recuperação de um aplicativo do servidor CRM é executada quando o aplicativo do servidor CRM é iniciado.</span><span class="sxs-lookup"><span data-stu-id="f14a1-136">Recovery of a CRM server application is performed when that CRM server application starts up.</span></span> <span data-ttu-id="f14a1-137">No entanto, não há nenhuma inicialização automática de um aplicativo do servidor CRM.</span><span class="sxs-lookup"><span data-stu-id="f14a1-137">However, there is no automatic startup of a CRM server application.</span></span> <span data-ttu-id="f14a1-138">O desenvolvedor do aplicativo deve considerar como a inicialização e a recuperação devem ser iniciadas.</span><span class="sxs-lookup"><span data-stu-id="f14a1-138">The application developer should consider how both startup and recovery should be initiated.</span></span>

## <a name="related-topics"></a><span data-ttu-id="f14a1-139">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="f14a1-139">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="f14a1-140">Conceitos do Gerenciador de recursos de compensação COM+</span><span class="sxs-lookup"><span data-stu-id="f14a1-140">COM+ Compensating Resource Manager Concepts</span></span>](com--compensating-resource-manager-concepts.md)
</dt> </dl>

 

 



