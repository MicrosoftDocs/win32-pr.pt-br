---
description: Acompanhamento de COM+
ms.assetid: ad3bdeb5-f303-411a-abfb-ccde3f9a86b9
title: Acompanhamento de COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 828cc87b5a24363fd814d37c29e61a3ce204d988
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104456960"
---
# <a name="com-tracking"></a><span data-ttu-id="e6dae-103">Acompanhamento de COM+</span><span class="sxs-lookup"><span data-stu-id="e6dae-103">COM+ Tracking</span></span>

<span data-ttu-id="e6dae-104">O serviço de controle COM+ permite que você crie seus próprios programas administrativos e de diagnóstico que acompanhem o status e o desempenho de aplicativos COM+ em execução.</span><span class="sxs-lookup"><span data-stu-id="e6dae-104">The COM+ tracking service enables you to build your own administrative and diagnostic programs that track the status and performance of running COM+ applications.</span></span> <span data-ttu-id="e6dae-105">O controle de COM+ fornece informações estatísticas sobre o uso de aplicativos COM+, bem como informações de status, como se uma instância de aplicativo do servidor COM+ está em pausa ou se foi reciclada.</span><span class="sxs-lookup"><span data-stu-id="e6dae-105">COM+ tracking provides statistical information about the use of COM+ applications as well as status information, such as whether a COM+ server application instance is paused or has been recycled.</span></span> <span data-ttu-id="e6dae-106">As ferramentas podem usar informações de rastreamento no monitoramento de diagnóstico ou para fins de exibição.</span><span class="sxs-lookup"><span data-stu-id="e6dae-106">Tools can use tracking information in diagnostic monitoring or for display purposes.</span></span> <span data-ttu-id="e6dae-107">Por exemplo, a ferramenta administrativa serviços de componentes usa o acompanhamento de COM+ para exibir o status das instâncias de aplicativo COM+ nas pastas aplicativos COM+ e processos em execução.</span><span class="sxs-lookup"><span data-stu-id="e6dae-107">For example, the Component Services administrative tool uses COM+ tracking to display the status of COM+ application instances in the COM+ Applications and Running Processes folders.</span></span>

<span data-ttu-id="e6dae-108">O controle de COM+ calcula e atualiza periodicamente um conjunto de métricas usadas com frequência, disponibilizando essas informações para programas que precisam dela.</span><span class="sxs-lookup"><span data-stu-id="e6dae-108">COM+ tracking calculates and periodically updates a set of commonly-used metrics, making this information available to programs that need it.</span></span> <span data-ttu-id="e6dae-109">É semelhante à instrumentação COM+, pois ambos os serviços coletam automaticamente dados de instâncias de aplicativos COM+ e disponibilizam esses dados aos consumidores.</span><span class="sxs-lookup"><span data-stu-id="e6dae-109">It is similar to COM+ Instrumentation in that both services automatically collect data from COM+ application instances and make this data available to consumers.</span></span> <span data-ttu-id="e6dae-110">No entanto, há algumas diferenças importantes entre esses serviços, tanto na funcionalidade fornecida quanto no uso típico.</span><span class="sxs-lookup"><span data-stu-id="e6dae-110">However, there are some important differences between these services, both in the functionality provided and typical usage.</span></span> <span data-ttu-id="e6dae-111">A tabela a seguir resume essas diferenças.</span><span class="sxs-lookup"><span data-stu-id="e6dae-111">The following table summarizes these differences.</span></span>



| <span data-ttu-id="e6dae-112">Instrumentação COM+</span><span class="sxs-lookup"><span data-stu-id="e6dae-112">COM+ Instrumentation</span></span>                                                                                                                                                                                                   | <span data-ttu-id="e6dae-113">Acompanhamento de COM+</span><span class="sxs-lookup"><span data-stu-id="e6dae-113">COM+ Tracking</span></span>                                                                                                                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e6dae-114">Dados refinados.</span><span class="sxs-lookup"><span data-stu-id="e6dae-114">Fine-grained data.</span></span> <span data-ttu-id="e6dae-115">O serviço de instrumentação COM+ notifica assinantes registrados de eventos discretos individuais (por exemplo, método chamado, objeto destruído) que ocorrem em uma instância do aplicativo COM+.</span><span class="sxs-lookup"><span data-stu-id="e6dae-115">The COM+ instrumentation service notifies registered subscribers of individual discrete events (for example, method called, object destroyed) that occur in a COM+ application instance.</span></span><br/> | <span data-ttu-id="e6dae-116">Dados agregados.</span><span class="sxs-lookup"><span data-stu-id="e6dae-116">Aggregated data.</span></span> <span data-ttu-id="e6dae-117">O controle de COM+ calcula e atualiza periodicamente as métricas usadas com frequência para o status e o desempenho das instâncias do aplicativo COM+.</span><span class="sxs-lookup"><span data-stu-id="e6dae-117">COM+ tracking calculates and periodically updates commonly-used metrics for the status and performance of COM+ application instances.</span></span><br/> |
| <span data-ttu-id="e6dae-118">Geralmente, os assinantes de eventos calculam métricas por conta própria, usando algoritmos e políticas ad hoc.</span><span class="sxs-lookup"><span data-stu-id="e6dae-118">Event subscribers typically calculate metrics on their own, using ad-hoc algorithms and policies.</span></span><br/>                                                                                                           | <span data-ttu-id="e6dae-119">As métricas são calculadas automaticamente pelo serviço de controle COM+.</span><span class="sxs-lookup"><span data-stu-id="e6dae-119">Metrics are calculated automatically by the COM+ tracking service.</span></span> <span data-ttu-id="e6dae-120">Todos os consumidores obtêm os mesmos dados, sem suporte para métricas personalizadas.</span><span class="sxs-lookup"><span data-stu-id="e6dae-120">All consumers get the same data, with no support for custom metrics.</span></span><br/>                |
| <span data-ttu-id="e6dae-121">Depois de registrar uma assinatura, o consumidor não recebe nenhuma informação sobre uma instância do aplicativo COM+ até que ocorra um evento.</span><span class="sxs-lookup"><span data-stu-id="e6dae-121">After registering a subscription, the consumer does not receive any information about a COM+ application instance until an event occurs.</span></span><br/>                                                                    | <span data-ttu-id="e6dae-122">Os dados de rastreamento de todas as instâncias do aplicativo COM+ podem ser recuperados a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="e6dae-122">Tracking data for all COM+ application instances may be retrieved at any time.</span></span><br/>                                                                         |
| <span data-ttu-id="e6dae-123">Dá suporte apenas a um mecanismo de assinatura baseado em eventos COM+ para consumidores.</span><span class="sxs-lookup"><span data-stu-id="e6dae-123">Supports only a COM+ events-based subscription mechanism for consumers.</span></span><br/>                                                                                                                                     | <span data-ttu-id="e6dae-124">Dá suporte a um mecanismo de assinatura baseado em eventos COM+ e à sondagem em uma interface de servidor local COM.</span><span class="sxs-lookup"><span data-stu-id="e6dae-124">Supports both a COM+ events-based subscription mechanism and polling on a COM local server interface.</span></span><br/>                                                  |
| <span data-ttu-id="e6dae-125">Exemplos</span><span class="sxs-lookup"><span data-stu-id="e6dae-125">Examples</span></span>                                                                                                                                                                                                               |                                                                                                                                                                   |
| <span data-ttu-id="e6dae-126">Notificações quando um método é chamado ou retorna.</span><span class="sxs-lookup"><span data-stu-id="e6dae-126">Notifications when a method is called or returns.</span></span><br/>                                                                                                                                                           | <span data-ttu-id="e6dae-127">Tempo médio de resposta da chamada, número de chamadas de método que tiveram êxito ou falharam em um período de tempo recente, número de objetos atualmente em uma chamada de método.</span><span class="sxs-lookup"><span data-stu-id="e6dae-127">Average call response time, number of method calls that succeeded or failed in a recent time period, number of objects currently in a method call.</span></span><br/>     |
| <span data-ttu-id="e6dae-128">Notificações quando um objeto é adicionado ou obtido do pool de objetos.</span><span class="sxs-lookup"><span data-stu-id="e6dae-128">Notifications when an object is added to or obtained from the object pool.</span></span><br/>                                                                                                                                  | <span data-ttu-id="e6dae-129">Número de objetos no pool, número total de objetos.</span><span class="sxs-lookup"><span data-stu-id="e6dae-129">Number of objects in the pool, total number of objects.</span></span><br/>                                                                                                |
| <span data-ttu-id="e6dae-130">Notificações quando um aplicativo de servidor COM+ é iniciado, pausado ou reciclado.</span><span class="sxs-lookup"><span data-stu-id="e6dae-130">Notifications when a COM+ server application is started, paused, or recycled.</span></span><br/>                                                                                                                               | <span data-ttu-id="e6dae-131">Status do processo do aplicativo do servidor COM+ (por exemplo, se ele está pausado ou reciclado).</span><span class="sxs-lookup"><span data-stu-id="e6dae-131">Status of the COM+ server application process (for example, whether it is paused or recycled).</span></span><br/>                                                         |
| <span data-ttu-id="e6dae-132">Notificações de eventos de início, preparação, anulação e confirmação de transação.</span><span class="sxs-lookup"><span data-stu-id="e6dae-132">Notifications of transaction start, prepare, abort, and commit events.</span></span><br/>                                                                                                                                      | <span data-ttu-id="e6dae-133">Não há equivalência.</span><span class="sxs-lookup"><span data-stu-id="e6dae-133">No equivalent.</span></span><br/>                                                                                                                                         |
| <span data-ttu-id="e6dae-134">Notificações de tentativas de autenticação de nível de chamada de método bem-sucedidas e com falha.</span><span class="sxs-lookup"><span data-stu-id="e6dae-134">Notifications of successful and failed method call level authentication attempts.</span></span><br/>                                                                                                                           | <span data-ttu-id="e6dae-135">Não há equivalência.</span><span class="sxs-lookup"><span data-stu-id="e6dae-135">No equivalent.</span></span><br/>                                                                                                                                         |



 

<span data-ttu-id="e6dae-136">Embora o controle COM+ seja mais limitado em termos de escopo de dados e flexibilidade para calcular métricas, as métricas que ele fornece devem ser suficientes para uma ampla variedade de programas administrativos e de diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="e6dae-136">Although COM+ tracking is more limited in terms of data scope and flexibility for calculating metrics, the metrics it provides should be sufficient for a wide variety of administrative and diagnostic programs.</span></span> <span data-ttu-id="e6dae-137">Ao usar o controle COM+, quando possível, o pode simplificar o design desses programas.</span><span class="sxs-lookup"><span data-stu-id="e6dae-137">Using COM+ tracking, when possible, can simplify the design of these programs.</span></span> <span data-ttu-id="e6dae-138">Além disso, o uso do controle COM+ em sistemas de produção pode ter um impacto de desempenho significativamente menor, o que o torna mais apropriado para ferramentas de monitoramento em tempo real.</span><span class="sxs-lookup"><span data-stu-id="e6dae-138">Additionally, using COM+ tracking in production systems can have a significantly lower performance impact, making it more appropriate for real-time monitoring tools.</span></span>

## <a name="how-com-tracking-collects-data"></a><span data-ttu-id="e6dae-139">Como o controle de COM+ coleta dados</span><span class="sxs-lookup"><span data-stu-id="e6dae-139">How COM+ Tracking Collects Data</span></span>

<span data-ttu-id="e6dae-140">Quando um processo de aplicativo do servidor do COM+ é iniciado, o COM+ registra o processo com o *servidor do controlador*, um componente do aplicativo do sistema.</span><span class="sxs-lookup"><span data-stu-id="e6dae-140">When a COM+ server application process is started, COM+ registers the process with the *tracker server*, a component of the system application.</span></span> <span data-ttu-id="e6dae-141">Os componentes em aplicativos e serviços de biblioteca COM+ sem contextos de componentes (SWC) também dão suporte ao rastreamento.</span><span class="sxs-lookup"><span data-stu-id="e6dae-141">Components in COM+ library applications and services without components (SWC) contexts also support tracking.</span></span> <span data-ttu-id="e6dae-142">Quando um componente de biblioteca ou contexto SWC é criado em um processo, o COM+ registra o processo com o servidor do controlador, caso ele ainda não tenha sido registrado.</span><span class="sxs-lookup"><span data-stu-id="e6dae-142">When a library component or SWC context is created in a process, COM+ registers the process with the tracker server if it has not been registered already.</span></span>

<span data-ttu-id="e6dae-143">O COM+ atualiza estatísticas para um processo rastreado quando determinados eventos ocorrem no processo, como a criação de um objeto ou a conclusão de uma chamada de método.</span><span class="sxs-lookup"><span data-stu-id="e6dae-143">COM+ updates statistics for a tracked process when certain events occur in the process, such as the creation of an object or the completion of a method call.</span></span> <span data-ttu-id="e6dae-144">Os dados atualizados são enviados periodicamente para o servidor do controlador e, nesse ponto, ficam disponíveis para os consumidores.</span><span class="sxs-lookup"><span data-stu-id="e6dae-144">Updated data is periodically submitted to the tracker server, at which point it becomes available to consumers.</span></span> <span data-ttu-id="e6dae-145">O servidor de controlador também é responsável por calcular algumas das métricas usadas pelos recursos de reciclagem de aplicativo COM+ e monitoramento de suspensão.</span><span class="sxs-lookup"><span data-stu-id="e6dae-145">The tracker server is also responsible for calculating some of the metrics used by the COM+ application recycling and hang monitoring features.</span></span> <span data-ttu-id="e6dae-146">Esses dados também estão disponíveis para os consumidores.</span><span class="sxs-lookup"><span data-stu-id="e6dae-146">This data is also available to consumers.</span></span>

<span data-ttu-id="e6dae-147">Os dados de rastreamento são organizados de acordo com o processo que gerou os dados.</span><span class="sxs-lookup"><span data-stu-id="e6dae-147">Tracking data is organized according to the process that generated the data.</span></span> <span data-ttu-id="e6dae-148">Os dados no nível de aplicativos COM+ individuais ou componentes no processo também estão disponíveis para consumidores que precisam dessas informações.</span><span class="sxs-lookup"><span data-stu-id="e6dae-148">Data at the level of individual COM+ applications or components in the process is also available for consumers that need this information.</span></span>

## <a name="events-versus-polling"></a><span data-ttu-id="e6dae-149">Eventos versus sondagem</span><span class="sxs-lookup"><span data-stu-id="e6dae-149">Events versus Polling</span></span>

<span data-ttu-id="e6dae-150">O controle de COM+ dá suporte a dois mecanismos para um consumidor obter dados de rastreamento do servidor do rastreador, um mecanismo de assinatura baseado em eventos COM+ e uma interface de servidor local COM.</span><span class="sxs-lookup"><span data-stu-id="e6dae-150">COM+ tracking supports two mechanisms for a consumer to obtain tracking data from the tracker server, a COM+ events-based subscription mechanism and a COM local server interface.</span></span>

<span data-ttu-id="e6dae-151">Os programas que precisam ser notificados periodicamente com dados de acompanhamento atualizados podem registrar uma assinatura para a interface de evento [**IComTrackingInfoEvents**](/windows/desktop/api/ComSvcs/nn-comsvcs-icomtrackinginfoevents) .</span><span class="sxs-lookup"><span data-stu-id="e6dae-151">Programs that need to be notified periodically with updated tracking data can register a subscription for the [**IComTrackingInfoEvents**](/windows/desktop/api/ComSvcs/nn-comsvcs-icomtrackinginfoevents) event interface.</span></span> <span data-ttu-id="e6dae-152">Aproximadamente a cada três segundos, o servidor de controlador chama o método [**IComTrackingInfoEvents:: OnNewTrackingInfo**](/windows/desktop/api/ComSvcs/nf-comsvcs-icomtrackinginfoevents-onnewtrackinginfo) de cada Assinante, enviando os dados de rastreamento mais recentes na forma de um objeto de coleção.</span><span class="sxs-lookup"><span data-stu-id="e6dae-152">Roughly every three seconds, the tracker server calls each subscriber's [**IComTrackingInfoEvents::OnNewTrackingInfo**](/windows/desktop/api/ComSvcs/nf-comsvcs-icomtrackinginfoevents-onnewtrackinginfo) method, sending the most recent tracking data in the form of a collection object.</span></span> <span data-ttu-id="e6dae-153">Esse objeto implementa a interface [**IComTrackingInfoCollection**](/windows/desktop/api/ComSvcs/nn-comsvcs-icomtrackinginfocollection) , e os assinantes podem navegar por essa coleção para localizar os dados em que estão interessados.</span><span class="sxs-lookup"><span data-stu-id="e6dae-153">This object implements the [**IComTrackingInfoCollection**](/windows/desktop/api/ComSvcs/nn-comsvcs-icomtrackinginfocollection) interface, and subscribers can navigate this collection to find the data they are interested in.</span></span>

<span data-ttu-id="e6dae-154">Por vários motivos, pode fazer mais sentido que um programa pesquise os dados no servidor do rastreador.</span><span class="sxs-lookup"><span data-stu-id="e6dae-154">For various reasons, it might make more sense for a program to poll tracker server for data.</span></span> <span data-ttu-id="e6dae-155">Por exemplo, uma ferramenta de monitoramento pode precisar de atualizações com muito menos frequência do que um programa que exibe o status em uma interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="e6dae-155">For example, a monitoring tool may need updates much less frequently than a program that displays status in a user interface.</span></span> <span data-ttu-id="e6dae-156">Além disso, um programa pode usar apenas uma pequena parte dos dados de rastreamento disponíveis para o sistema (por exemplo, uma ferramenta pode monitorar apenas o desempenho de instâncias de um único aplicativo COM+).</span><span class="sxs-lookup"><span data-stu-id="e6dae-156">Also, a program may use only a small portion of the tracking data available for the system (for example, a tool might only monitor the performance of instances of a single COM+ application).</span></span> <span data-ttu-id="e6dae-157">O modelo de assinatura envia a cada Assinante os dados de rastreamento de todos os aplicativos COM+ em cada notificação, e é responsabilidade do assinante encontrar os dados desejados.</span><span class="sxs-lookup"><span data-stu-id="e6dae-157">The subscription model sends each subscriber the tracking data for all COM+ applications in each notification, and it is the responsibility of the subscriber to find the data it wants.</span></span> <span data-ttu-id="e6dae-158">Por fim, os eventos COM+ são um mecanismo de notificação de eventos de melhor esforço.</span><span class="sxs-lookup"><span data-stu-id="e6dae-158">Finally, COM+ events is a best-effort event notification mechanism.</span></span> <span data-ttu-id="e6dae-159">Os serviços de entrega de mensagens confiáveis não são fornecidos e não há como um assinante detectar que o servidor do rastreador falhou ao enviar uma notificação.</span><span class="sxs-lookup"><span data-stu-id="e6dae-159">Reliable message delivery services are not provided, and there is no way for a subscriber to detect that the tracker server failed to send it a notification.</span></span>

<span data-ttu-id="e6dae-160">Um programa que precisa de mais controle sobre sua recuperação de dados de rastreamento pode usar a interface [**IGetAppTrackerData**](/windows/desktop/api/ComSvcs/nn-comsvcs-igetapptrackerdata) do servidor do controlador.</span><span class="sxs-lookup"><span data-stu-id="e6dae-160">A program that needs greater control over its retrieval of tracking data can use the [**IGetAppTrackerData**](/windows/desktop/api/ComSvcs/nn-comsvcs-igetapptrackerdata) interface of the tracker server.</span></span>

 

 




