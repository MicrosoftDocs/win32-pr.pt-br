---
description: A infraestrutura de CRM fornece um conjunto de interfaces que podem ser usadas para monitorar o CRMs em um determinado aplicativo de servidor.
ms.assetid: b8f40c91-001b-4003-b377-57a918988100
title: Interfaces de monitoramento do COM+ CRM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c893040c46810c980c647cbacdc808200e8d5f5e
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104163970"
---
# <a name="com-crm-monitoring-interfaces"></a><span data-ttu-id="38635-103">Interfaces de monitoramento do COM+ CRM</span><span class="sxs-lookup"><span data-stu-id="38635-103">COM+ CRM Monitoring Interfaces</span></span>

<span data-ttu-id="38635-104">A infraestrutura de CRM fornece um conjunto de interfaces que podem ser usadas para monitorar o CRMs em um determinado aplicativo de servidor.</span><span class="sxs-lookup"><span data-stu-id="38635-104">The CRM infrastructure provides a set of interfaces that can be used for monitoring the CRMs within a particular server application.</span></span> <span data-ttu-id="38635-105">Para acessar as interfaces de monitoramento, um componente em execução no aplicativo do servidor deve primeiro criar um administrador de CRM especializado chamado administrador de recuperação do CRM.</span><span class="sxs-lookup"><span data-stu-id="38635-105">To access the monitoring interfaces, a component running within the server application must first create a specialized CRM clerk called the CRM recovery clerk.</span></span>

<span data-ttu-id="38635-106">No uso normal de CRMs, espera-se que as transações sejam de curta duração e, portanto, os trabalhadores do CRM e os recompensas de CRM existem por um breve período de tempo, normalmente apenas alguns segundos no máximo.</span><span class="sxs-lookup"><span data-stu-id="38635-106">In normal use of CRMs, transactions are expected to be short-lived, and hence CRM Workers and CRM Compensators exist for a brief period of time, typically only a few seconds at most.</span></span> <span data-ttu-id="38635-107">As interfaces de monitoramento, portanto, são projetadas para fornecer um instantâneo do estado do CRMs em execução em um determinado ponto no tempo.</span><span class="sxs-lookup"><span data-stu-id="38635-107">The monitoring interfaces are therefore designed to give a snapshot of the state of the executing CRMs at a particular point in time.</span></span> <span data-ttu-id="38635-108">Se qualquer um dos CRMs estiver tendo problemas, as interfaces de monitoramento poderão ser usadas para zero no CRM problemático, para inspecionar seus registros de log e para anular sua transação, se necessário.</span><span class="sxs-lookup"><span data-stu-id="38635-108">If any of the CRMs are having problems, the monitoring interfaces can be used to zero in on the troublesome CRM, to inspect its log records and to abort its transaction if required.</span></span>

<span data-ttu-id="38635-109">A seguir estão as três interfaces de monitoramento de CRM e as descrições de como elas funcionam.</span><span class="sxs-lookup"><span data-stu-id="38635-109">Following are the three CRM monitoring interfaces and descriptions of how they work.</span></span>



| <span data-ttu-id="38635-110">Interface</span><span class="sxs-lookup"><span data-stu-id="38635-110">Interface</span></span>                                                         | <span data-ttu-id="38635-111">Descrição</span><span class="sxs-lookup"><span data-stu-id="38635-111">Description</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|-------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [<span data-ttu-id="38635-112">**ICrmMonitor**</span><span class="sxs-lookup"><span data-stu-id="38635-112">**ICrmMonitor**</span></span>](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitor)<br/>                     | <span data-ttu-id="38635-113">Usando [**ICrmMonitor::**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-getclerks)getadministradores, um instantâneo pode ser obtido do conjunto atual de administradores do Active Directory dentro do aplicativo do servidor.</span><span class="sxs-lookup"><span data-stu-id="38635-113">Using [**ICrmMonitor::GetClerks**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-getclerks), a snapshot can be obtained of the current set of active CRM clerks within the server application.</span></span> <span data-ttu-id="38635-114">A partir disso, um objeto de coleção de funcionário do CRM de interesse específico pode ser localizado e consultado, incluindo o estado atual de sua transação e os registros de log gravados pelo CRM.</span><span class="sxs-lookup"><span data-stu-id="38635-114">From this, a particular CRM clerk collection object of interest can be located and queried, including the current state of its transaction and the log records written by the CRM.</span></span><br/> <span data-ttu-id="38635-115">Quando a ferramenta de monitoramento determinou qual administrador é interessante, ela chama [**ICrmMonitor:: HoldClerk**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-holdclerk) para obter uma interface [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) nesse administrador específico.</span><span class="sxs-lookup"><span data-stu-id="38635-115">When the monitoring tool has determined which clerk is of interest, it calls [**ICrmMonitor::HoldClerk**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmmonitor-holdclerk) to get an [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) interface on that particular clerk.</span></span> <span data-ttu-id="38635-116">Neste ponto, a ferramenta de monitoramento está mantendo uma referência a esse administrador e, se a transação for concluída, o auxiliar será mantido na memória e não será liberado até que a ferramenta de monitoramento seja feita.</span><span class="sxs-lookup"><span data-stu-id="38635-116">At this point, the monitoring tool is holding a reference to that clerk, and if the transaction completes, the clerk is held in memory and is not released until the monitoring tool is done.</span></span><br/>                                                                                                                                                                                                    |
| [<span data-ttu-id="38635-117">**ICrmMonitorClerks**</span><span class="sxs-lookup"><span data-stu-id="38635-117">**ICrmMonitorClerks**</span></span>](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorclerks)<br/>         | <span data-ttu-id="38635-118">Usando essa interface, o objeto de coleção do auxiliar pode ser procurado por informações sobre o estado da coleção do auxiliar no momento em que foi obtido.</span><span class="sxs-lookup"><span data-stu-id="38635-118">Using this interface, the clerk collection object can be browsed for information about the state of the clerk collection at the moment it was obtained.</span></span> <span data-ttu-id="38635-119">Essas informações incluem o número de auxiliares, o ProgID do compensador de CRM usado pelo administrador, a descrição fornecida no momento em que o compensador de CRM foi registrado (usando [**ICrmLogControl:: RegisterCompensator**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-registercompensator)), a ID da unidade de trabalho da transação e a ID da atividade.</span><span class="sxs-lookup"><span data-stu-id="38635-119">This information includes the number of clerks, the ProgID of the CRM Compensator used by the clerk, the description provided at the time the CRM Compensator was registered (using [**ICrmLogControl::RegisterCompensator**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-registercompensator)), the transaction unit-of-work ID, and the activity ID.</span></span> <span data-ttu-id="38635-120">Os auxiliares individuais também são identificados exclusivamente por um "CLSID da instância do auxiliar", que não é um CLSID do COM no sentido normal do termo, mas simplesmente um GUID exclusivo que identifica esse determinado funcionário durante seu tempo de vida.</span><span class="sxs-lookup"><span data-stu-id="38635-120">Individual clerks are also uniquely identified by a "clerk instance CLSID," which is not a COM CLSID in the usual sense of the term but simply a unique GUID that identifies this particular clerk for its lifetime.</span></span><br/>                                                                                                                                                                                                                                                                                                |
| [<span data-ttu-id="38635-121">**ICrmMonitorLogRecords**</span><span class="sxs-lookup"><span data-stu-id="38635-121">**ICrmMonitorLogRecords**</span></span>](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords)<br/> | <span data-ttu-id="38635-122">Essa interface pode ser usada para consultar o estado atual da transação, para descobrir quantos registros de log esse administrador do CRM escreveu e obter os dados reais de registro de log.</span><span class="sxs-lookup"><span data-stu-id="38635-122">This interface can be used to query the current state of the transaction, to find out how many log records this CRM clerk has written, and to get the actual log record data.</span></span> <span data-ttu-id="38635-123">Os registros de log são fornecidos da interface [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) no mesmo formato em que foram gravados originalmente (usando [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol)).</span><span class="sxs-lookup"><span data-stu-id="38635-123">The log records are provided from the [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) interface in the same format that they were originally written (using [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol)).</span></span> <span data-ttu-id="38635-124">Além disso, o **ICrmMonitorLogRecords** pode ser implementado opcionalmente para converter os registros de log em formato exibível para que possam ser apresentados usando uma ferramenta de monitoramento genérica.</span><span class="sxs-lookup"><span data-stu-id="38635-124">In addition, **ICrmMonitorLogRecords** can be optionally implemented to convert the log records to viewable format so they can be presented using a generic monitoring tool.</span></span><br/> <span data-ttu-id="38635-125">Como o [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) é implementado diretamente no administrador do CRM, você pode [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) para [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol) (também implementado no administrador do CRM).</span><span class="sxs-lookup"><span data-stu-id="38635-125">Because [**ICrmMonitorLogRecords**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmmonitorlogrecords) is implemented directly on the CRM clerk, you can [**QueryInterface**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) for [**ICrmLogControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol) (also implemented on the CRM clerk).</span></span> <span data-ttu-id="38635-126">Isso pode ser usado para anular a transação diretamente, se necessário ([**ICrmLogControl:: ForceTransactionToAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-forcetransactiontoabort)).</span><span class="sxs-lookup"><span data-stu-id="38635-126">This can then be used to directly abort the transaction if required ([**ICrmLogControl::ForceTransactionToAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-icrmlogcontrol-forcetransactiontoabort)).</span></span><br/> |



 

## <a name="related-topics"></a><span data-ttu-id="38635-127">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="38635-127">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="38635-128">Conceitos do Gerenciador de recursos de compensação COM+</span><span class="sxs-lookup"><span data-stu-id="38635-128">COM+ Compensating Resource Manager Concepts</span></span>](com--compensating-resource-manager-concepts.md)
</dt> </dl>

 

