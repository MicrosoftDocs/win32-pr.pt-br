---
description: Passando objetos como parâmetros
ms.assetid: 174847c8-4545-4f61-ae13-42bdec1405e7
title: Passando objetos como parâmetros
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a58e012138bc65cec481f714ac216bb8227fb924
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104501048"
---
# <a name="passing-objects-as-parameters"></a><span data-ttu-id="81782-103">Passando objetos como parâmetros</span><span class="sxs-lookup"><span data-stu-id="81782-103">Passing Objects as Parameters</span></span>

<span data-ttu-id="81782-104">O serviço de componentes em fila COM+ não habilita o enfileiramento para todos os componentes COM existentes.</span><span class="sxs-lookup"><span data-stu-id="81782-104">The COM+ queued components service does not enable queuing for every existing COM component.</span></span> <span data-ttu-id="81782-105">Há restrições sobre os tipos de métodos que podem ser enfileirados.</span><span class="sxs-lookup"><span data-stu-id="81782-105">There are restrictions on the types of methods that can be queued.</span></span> <span data-ttu-id="81782-106">Devido a restrições de mensagens, os métodos devem aderir às seguintes regras:</span><span class="sxs-lookup"><span data-stu-id="81782-106">Because of messaging constraints, methods must adhere to the following rules:</span></span>

-   <span data-ttu-id="81782-107">Eles devem conter apenas parâmetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="81782-107">They must contain input parameters only.</span></span>
-   <span data-ttu-id="81782-108">Eles não devem retornar nenhum resultado específico do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="81782-108">They must return no application-specific result.</span></span>

<span data-ttu-id="81782-109">Além disso, há restrições sobre os tipos de parâmetros de entrada que podem ser passados para um componente enfileirado.</span><span class="sxs-lookup"><span data-stu-id="81782-109">Additionally, there are restrictions on the types of input parameters that can be passed to a queued component.</span></span> <span data-ttu-id="81782-110">Em tempo de execução, o serviço de componentes na fila empacota os argumentos no cliente e os passa para o componente de servidor usando o [enfileiramento de mensagens](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="81782-110">At run time, the queued components service packages the arguments at the client and passes them to the server component by using [Message Queuing](/previous-versions/windows/desktop/legacy/ms711472(v=vs.85)).</span></span> <span data-ttu-id="81782-111">Tipos simples, como números inteiros e boolianos, podem ser empacotados facilmente — tipos mais complexos não podem ser empacotados sem ajuda.</span><span class="sxs-lookup"><span data-stu-id="81782-111">Simple types, such as integers and Booleans, can be marshaled easily—more complex types cannot be marshaled without help.</span></span>

<span data-ttu-id="81782-112">No caso de passar um objeto por meio de uma chamada de método de componente enfileirada como um parâmetro, o cliente passa o objeto para o gravador.</span><span class="sxs-lookup"><span data-stu-id="81782-112">In the case of passing an object through a queued component's method call as a parameter, the client passes the object to the recorder.</span></span> <span data-ttu-id="81782-113">O gravador realiza marshaling do objeto em uma mensagem do serviço de enfileiramento de mensagens e passa-o para o ouvinte.</span><span class="sxs-lookup"><span data-stu-id="81782-113">The recorder marshals the object into a Message Queuing message and passes it to the listener.</span></span> <span data-ttu-id="81782-114">Depois que o ouvinte selecionar a mensagem e passá-la para o Player, o Player deverá recriar a instância do objeto para expedir para a chamada de método especificada pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="81782-114">After the listener picks up the message and passes it to the player, the player must reinstantiate the object to dispatch it to the method call specified by the client.</span></span> <span data-ttu-id="81782-115">Com base nos tempos de vida do cliente e do servidor em um ambiente em fila, a implicação é que esses objetos devem ser capazes de realizar marshaling por valor.</span><span class="sxs-lookup"><span data-stu-id="81782-115">Based on the lifetimes of the client and server in a queued environment, the implication is that these objects must be able to marshal by value.</span></span> <span data-ttu-id="81782-116">Como o COM+ não fornece semântica de passagem por valor para objetos COM padrão, o gravador e o Player precisam de ajuda do componente para realizar marshaling e Desempacotamento do objeto.</span><span class="sxs-lookup"><span data-stu-id="81782-116">Because COM+ does not provide pass-by-value semantics for standard COM objects, the recorder and player need help from the component to marshal and unmarshal the object.</span></span>

<span data-ttu-id="81782-117">Referências de objeto que dão suporte a [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) podem ser usadas como parâmetros para chamadas de método em componentes em fila.</span><span class="sxs-lookup"><span data-stu-id="81782-117">Object references that support [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) can be used as parameters to method calls on queued components.</span></span> <span data-ttu-id="81782-118">O objeto não pode fazer suposições sobre quando ele será reinstanciado.</span><span class="sxs-lookup"><span data-stu-id="81782-118">The object cannot make assumptions about when it will be reinstantiated.</span></span> <span data-ttu-id="81782-119">Por exemplo, o servidor pode estar indisponível ou o componente do servidor pode não ser iniciado até mais tarde no dia.</span><span class="sxs-lookup"><span data-stu-id="81782-119">For example, the server may be unavailable or the server component may not be started until later in the day.</span></span> <span data-ttu-id="81782-120">Os objetos que não dão suporte a **IPersistStream** retornarão um erro.</span><span class="sxs-lookup"><span data-stu-id="81782-120">Objects that do not support **IPersistStream** will return an error.</span></span>

## <a name="visual-basic-persistable-objects"></a><span data-ttu-id="81782-121">Visual Basic objetos persistentes</span><span class="sxs-lookup"><span data-stu-id="81782-121">Visual Basic Persistable Objects</span></span>

<span data-ttu-id="81782-122">O Microsoft Visual Basic 6 permite que objetos persistentes sejam criados.</span><span class="sxs-lookup"><span data-stu-id="81782-122">Microsoft Visual Basic 6 allows persistable objects to be created.</span></span> <span data-ttu-id="81782-123">Esses objetos dão suporte a [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) e podem ser passados como parâmetros para chamadas de método de componente em fila.</span><span class="sxs-lookup"><span data-stu-id="81782-123">These objects support [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) and can be passed as parameters to queued component method calls.</span></span> <span data-ttu-id="81782-124">Antes que um objeto de Visual Basic possa ser passado para um componente enfileirado, o objeto persistente deve ser inicializado.</span><span class="sxs-lookup"><span data-stu-id="81782-124">Before a Visual Basic object can be passed to a queued component, the persistable object must be initialized.</span></span> <span data-ttu-id="81782-125">Isso pode ser feito de uma das duas maneiras a seguir:</span><span class="sxs-lookup"><span data-stu-id="81782-125">This can be done in one of the following two ways:</span></span>

-   <span data-ttu-id="81782-126">Se o aplicativo que cria o objeto persistente for gravado em Visual Basic, o tempo de execução do Visual Basic tratará a inicialização do objeto automaticamente.</span><span class="sxs-lookup"><span data-stu-id="81782-126">If the application creating the persistable object is written in Visual Basic, the Visual Basic runtime handles the object initialization automatically.</span></span>
-   <span data-ttu-id="81782-127">Se o aplicativo que cria o Visual Basic objeto persistente é escrito em uma linguagem diferente de Visual Basic, como Microsoft Visual C++, o aplicativo deve inicializar explicitamente o componente consultando a interface [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) do objeto persistente ou chamando o método [**IPersistStreamInit:: InitNew**](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)ou [**IPersistStream:: Load**](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) .</span><span class="sxs-lookup"><span data-stu-id="81782-127">If the application that creates the Visual Basic persistable object is written in a language other than Visual Basic, such as Microsoft Visual C++, the application must explicitly initialize the component by either querying for the persistable object's [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream) interface or calling the [**IPersistStreamInit::InitNew**](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew), or [**IPersistStream::Load**](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) method.</span></span>

## <a name="ado-recordsets-and-ole-db-rowsets"></a><span data-ttu-id="81782-128">Conjuntos de linhas de OLE DB e Recordsets ADO</span><span class="sxs-lookup"><span data-stu-id="81782-128">ADO Recordsets and OLE DB Rowsets</span></span>

<span data-ttu-id="81782-129">Passar objetos **RECORDSET** ADO ou OLE DB conjunto de linhas entre componentes permite que um componente processe os resultados das consultas executadas por outro componente.</span><span class="sxs-lookup"><span data-stu-id="81782-129">Passing ADO **Recordset** or OLE DB rowset objects between components allows one component to process the results of queries executed by another component.</span></span> <span data-ttu-id="81782-130">Isso é útil ao implantar um aplicativo em vários computadores.</span><span class="sxs-lookup"><span data-stu-id="81782-130">This is helpful when deploying an application across multiple computers.</span></span> <span data-ttu-id="81782-131">Os objetos **Recordset** e Rowset podem ser passados como parâmetros de método para componentes em fila, com as seguintes restrições:</span><span class="sxs-lookup"><span data-stu-id="81782-131">**Recordset** and rowset objects can be passed as method parameters to queued components, with the following restrictions:</span></span>

-   <span data-ttu-id="81782-132">Os objetos **Recordset** do lado do servidor não podem ser empacotados usando [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream).</span><span class="sxs-lookup"><span data-stu-id="81782-132">Server-side **Recordset** objects cannot be marshaled using [**IPersistStream**](/windows/desktop/api/objidl/nn-objidl-ipersiststream).</span></span> <span data-ttu-id="81782-133">Somente objetos **Recordset** do lado do cliente podem ser passados como parâmetros para uma chamada de método de componente enfileirada.</span><span class="sxs-lookup"><span data-stu-id="81782-133">Only client-side **Recordset** objects can be passed as parameters to a queued component method call.</span></span>
-   <span data-ttu-id="81782-134">Se você trabalha diretamente com OLE DB, o conjunto de linhas de OLE DB deve ser definido como um conjunto de linhas do lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="81782-134">If you work directly with OLE DB, the OLE DB rowset must be defined as a client-side rowset.</span></span>

 

 
