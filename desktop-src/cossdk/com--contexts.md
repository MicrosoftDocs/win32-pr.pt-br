---
description: Para os componentes configurados em execução nos aplicativos COM+, os contextos são a base na qual os serviços COM+ são fornecidos.
ms.assetid: 62a0bef2-c3c2-4a60-a5d1-6c038958e13e
title: Contextos COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f0ae1228f89797f9124e817db07f11a23dbec12
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104370481"
---
# <a name="com-contexts"></a><span data-ttu-id="8ca99-103">Contextos COM+</span><span class="sxs-lookup"><span data-stu-id="8ca99-103">COM+ Contexts</span></span>

<span data-ttu-id="8ca99-104">Para os componentes configurados em execução nos aplicativos COM+, os *contextos* são a base na qual os serviços com+ são fornecidos.</span><span class="sxs-lookup"><span data-stu-id="8ca99-104">For configured components running within COM+ applications, *contexts* are the foundation on which COM+ services are provided.</span></span> <span data-ttu-id="8ca99-105">No COM+, um contexto é definido como um conjunto de propriedades de tempo de execução associadas a um ou mais objetos COM que são usados para fornecer serviços para esses objetos.</span><span class="sxs-lookup"><span data-stu-id="8ca99-105">In COM+, a context is defined as set of run-time properties associated with one or more COM objects that are used to provide services for those objects.</span></span>

<span data-ttu-id="8ca99-106">No COM+, cada objeto COM é associado a um contexto precisamente à medida que é executado (ou seja, entre sua ativação e desativação), e cada contexto reside em um apartamento COM precisamente.</span><span class="sxs-lookup"><span data-stu-id="8ca99-106">In COM+, every COM object is associated with precisely one context as it runs (that is, between its activation and deactivation), and every context resides within precisely one COM apartment.</span></span> <span data-ttu-id="8ca99-107">Vários objetos podem ser executados dentro do mesmo contexto e vários contextos podem residir no mesmo apartamento.</span><span class="sxs-lookup"><span data-stu-id="8ca99-107">Multiple objects can run within the same context, and multiple contexts can reside within the same apartment.</span></span> <span data-ttu-id="8ca99-108">Inicializado quando um objeto é ativado, as propriedades de contexto, como propriedades de contexto de segurança, representam as necessidades de tempo de execução de um objeto.</span><span class="sxs-lookup"><span data-stu-id="8ca99-108">Initialized when an object is activated, context properties, such as security context properties, represent the run-time needs of an object.</span></span>

> [!Note]  
> <span data-ttu-id="8ca99-109">Para componentes não configurados que não usam serviços COM+, o contexto é, na maior parte, ignorado.</span><span class="sxs-lookup"><span data-stu-id="8ca99-109">For unconfigured components that do not use COM+ services, the context is, for the most part, ignored.</span></span>

 

<span data-ttu-id="8ca99-110">O COM+ usa propriedades de contexto como a base para fornecer serviços em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="8ca99-110">COM+ uses context properties as the basis for providing run-time services.</span></span> <span data-ttu-id="8ca99-111">Essas propriedades mantêm o estado que determina como o ambiente de execução executa serviços para objetos dentro do contexto.</span><span class="sxs-lookup"><span data-stu-id="8ca99-111">These properties hold state that determines how the execution environment performs services for objects within the context.</span></span> <span data-ttu-id="8ca99-112">Em alguns casos, você pode interagir diretamente com as propriedades de contexto de um objeto para indicar algum estado relevante para um serviço que está sendo fornecido para o objeto.</span><span class="sxs-lookup"><span data-stu-id="8ca99-112">In some cases, you can interact directly with an object's context properties to indicate some state relevant to a service being provided for the object.</span></span> <span data-ttu-id="8ca99-113">Por exemplo, você faria isso quando um objeto que está participando de um voto automático de transações no resultado da transação.</span><span class="sxs-lookup"><span data-stu-id="8ca99-113">For example, you would do this when an object that is participating in an automatic transaction votes on the outcome of the transaction.</span></span>

<span data-ttu-id="8ca99-114">Para obter uma discussão detalhada da base COM desses conceitos, consulte [processos, threads e Apartments](/windows/desktop/com/processes--threads--and-apartments).</span><span class="sxs-lookup"><span data-stu-id="8ca99-114">For a detailed discussion of the COM foundation of these concepts, see [Processes, Threads, and Apartments](/windows/desktop/com/processes--threads--and-apartments).</span></span>

## <a name="programmatic-interaction-with-context-properties"></a><span data-ttu-id="8ca99-115">Interação programática com propriedades de contexto</span><span class="sxs-lookup"><span data-stu-id="8ca99-115">Programmatic Interaction with Context Properties</span></span>

<span data-ttu-id="8ca99-116">Cada contexto tem um objeto [**ObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext) associado que controla suas propriedades.</span><span class="sxs-lookup"><span data-stu-id="8ca99-116">Each context has an associated [**ObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-objectcontext) object that keeps track of its properties.</span></span> <span data-ttu-id="8ca99-117">Você pode acessar o **ObjectContext** chamando a função [**getObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext) .</span><span class="sxs-lookup"><span data-stu-id="8ca99-117">You can access **ObjectContext** by calling the [**GetObjectContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-getobjectcontext) function.</span></span> <span data-ttu-id="8ca99-118">Depois de ter acessado **ObjectContext**, você pode chamar métodos na interface [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext) que ele expõe para manipular propriedades de contexto.</span><span class="sxs-lookup"><span data-stu-id="8ca99-118">After you have accessed **ObjectContext**, you can call methods on the [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext) interface it exposes to manipulate context properties.</span></span>

<span data-ttu-id="8ca99-119">Por exemplo, chamar [**IObjectContext:: SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) tem o efeito de definir o bit de consistência da transação como "consistente" e o bit de [ativação JIT](com--just-in-time-activation.md) realizado para "Done" no contexto associado ao objeto.</span><span class="sxs-lookup"><span data-stu-id="8ca99-119">For example, calling [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) has the effect of setting the transaction consistency bit to "consistent" and the [JIT-activation](com--just-in-time-activation.md) done bit to "done" on the context associated with the object.</span></span> <span data-ttu-id="8ca99-120">Sinais "consistentes" para COM+ que você votou para confirmar a transação e "concluído" indicam que o objeto está pronto para ser desativado quando o método retorna.</span><span class="sxs-lookup"><span data-stu-id="8ca99-120">"Consistent" signals to COM+ that you vote to commit the transaction, and "done" indicates that your object is ready to be deactivated when the method returns.</span></span>

<span data-ttu-id="8ca99-121">Além de [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext), outras interfaces especializadas que fornecem acesso às propriedades de contexto são [**IObjectContextInfo**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextinfo), [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate)e [**IObjectContextActivity**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextactivity).</span><span class="sxs-lookup"><span data-stu-id="8ca99-121">In addition to [**IObjectContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontext), other specialized interfaces providing access to context properties are [**IObjectContextInfo**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextinfo), [**IContextState**](/windows/desktop/api/ComSvcs/nn-comsvcs-icontextstate), and [**IObjectContextActivity**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontextactivity).</span></span> <span data-ttu-id="8ca99-122">Para uma determinada extensão, o [**ISecurityCallContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) também acessa as propriedades de contexto.</span><span class="sxs-lookup"><span data-stu-id="8ca99-122">To a certain extent, [**ISecurityCallContext**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) also accesses context properties.</span></span> <span data-ttu-id="8ca99-123">Você pode usar [**IGetSecurityCallContext:: GetSecurityCallContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-igetsecuritycallcontext-getsecuritycallcontext) para obter **ISecurityCallContext**.</span><span class="sxs-lookup"><span data-stu-id="8ca99-123">You can use [**IGetSecurityCallContext::GetSecurityCallContext**](/windows/desktop/api/ComSvcs/nf-comsvcs-igetsecuritycallcontext-getsecuritycallcontext) to obtain **ISecurityCallContext**.</span></span>

## <a name="understanding-activation-and-interception"></a><span data-ttu-id="8ca99-124">Entendendo a ativação e a interceptação</span><span class="sxs-lookup"><span data-stu-id="8ca99-124">Understanding Activation and Interception</span></span>

<span data-ttu-id="8ca99-125">Em geral, você precisa pensar no contexto somente na medida em que ele representa uma série de propriedades, algumas das quais você pode definir ou obter, que são usadas para fornecer serviços COM+ para seus componentes.</span><span class="sxs-lookup"><span data-stu-id="8ca99-125">Generally, you need to think about context only to the extent that it represents a number of properties, some of which you can set or get, that are used to provide COM+ services for your components.</span></span> <span data-ttu-id="8ca99-126">Em algumas circunstâncias, no entanto, talvez seja necessário considerar as duas facetas inter-relacionadas de contextos com mais detalhes:</span><span class="sxs-lookup"><span data-stu-id="8ca99-126">In some circumstances, however, you might need to consider the following two interrelated facets of contexts in greater detail:</span></span>

-   <span data-ttu-id="8ca99-127">[Ativação de contexto](context-activation.md)ou a inicialização de um objeto em um contexto apropriado.</span><span class="sxs-lookup"><span data-stu-id="8ca99-127">[Context activation](context-activation.md), or the initialization of an object in an appropriate context.</span></span>
-   <span data-ttu-id="8ca99-128">[Interceptação](interception-of-cross-context-calls.md)ou o que o com+ faz em chamadas por um limite de contexto.</span><span class="sxs-lookup"><span data-stu-id="8ca99-128">[Interception](interception-of-cross-context-calls.md), or what COM+ does on calls across a context boundary.</span></span>

## <a name="relation-to-mts-context-wrappers"></a><span data-ttu-id="8ca99-129">Relação com os wrappers de contexto MTS</span><span class="sxs-lookup"><span data-stu-id="8ca99-129">Relation to MTS Context Wrappers</span></span>

<span data-ttu-id="8ca99-130">Os contextos substituem efetivamente os wrappers de contexto MTS.</span><span class="sxs-lookup"><span data-stu-id="8ca99-130">Contexts effectively replace the MTS context wrappers.</span></span> <span data-ttu-id="8ca99-131">A finalidade que eles serviam — fornecendo serviços automáticos ao interceptar solicitações de criação — agora é um recurso integrado do COM+.</span><span class="sxs-lookup"><span data-stu-id="8ca99-131">The purpose they served—providing automatic services by trapping creation requests—is now an integrated feature of COM+.</span></span> <span data-ttu-id="8ca99-132">Como resultado, você não precisa mais usar a função [**SafeRef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef) .</span><span class="sxs-lookup"><span data-stu-id="8ca99-132">As a result, you no longer need to use the [**SafeRef**](/windows/desktop/api/ComSvcs/nf-comsvcs-saferef) function.</span></span> <span data-ttu-id="8ca99-133">No MTS, o **SafeRef** foi usado para obter uma referência ao seu objeto que poderia ser passado fora do seu wrapper de contexto.</span><span class="sxs-lookup"><span data-stu-id="8ca99-133">In MTS, **SafeRef** was used to obtain a reference to your object which could be passed outside of its context wrapper.</span></span> <span data-ttu-id="8ca99-134">No COM+, isso é desnecessário; referências de objetos normais (**esses** ponteiros) funcionam.</span><span class="sxs-lookup"><span data-stu-id="8ca99-134">In COM+, this is unnecessary; normal object references (**this** pointers) work.</span></span>

 

 
