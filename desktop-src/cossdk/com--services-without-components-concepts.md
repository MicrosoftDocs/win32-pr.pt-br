---
description: O COM+ 1,5 apresenta a capacidade de usar serviços COM+ sem componentes.
ms.assetid: da93d164-234a-4d1e-b82c-f3f904bb8cb6
title: Conceitos dos serviços COM+ sem componentes
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4d692657d33143b9437a9c8134260a8c32431cb
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103826607"
---
# <a name="com-services-without-components-concepts"></a><span data-ttu-id="0c9d7-103">Conceitos dos serviços COM+ sem componentes</span><span class="sxs-lookup"><span data-stu-id="0c9d7-103">COM+ Services Without Components Concepts</span></span>

<span data-ttu-id="0c9d7-104">O COM+ 1,5 apresenta a capacidade de usar serviços COM+ sem componentes.</span><span class="sxs-lookup"><span data-stu-id="0c9d7-104">COM+ 1.5 introduces the ability to use COM+ services without components.</span></span> <span data-ttu-id="0c9d7-105">Isso reduz significativamente os custos de desempenho ao usar os serviços COM+ de um ambiente que não usa componentes e também elimina a complexidade de usar esses serviços.</span><span class="sxs-lookup"><span data-stu-id="0c9d7-105">This significantly reduces the performance costs when using COM+ services from an environment that doesn't use components, and it also eliminates the complexity of using these services.</span></span> <span data-ttu-id="0c9d7-106">A partir do IIS 6,0, o IIS e o ASP aproveitam o uso de serviços COM+ sem componentes.</span><span class="sxs-lookup"><span data-stu-id="0c9d7-106">Beginning with IIS 6.0, IIS and ASP take advantage of using COM+ services without components.</span></span>

<span data-ttu-id="0c9d7-107">Os serviços COM+ foram projetados originalmente para serem usados com componentes COM+.</span><span class="sxs-lookup"><span data-stu-id="0c9d7-107">COM+ services were originally designed to be used with COM+ components.</span></span> <span data-ttu-id="0c9d7-108">No entanto, alguns ambientes de programação não são baseados em componentes e, portanto, exigiam sobrecarga substancial para usar os serviços COM+.</span><span class="sxs-lookup"><span data-stu-id="0c9d7-108">However, some programming environments are not component-based and therefore required substantial overhead to use COM+ services.</span></span> <span data-ttu-id="0c9d7-109">Por exemplo, antes do lançamento do COM+ 1,5, o IIS tinha que criar objetos Shim unicamente para poder usar os serviços de transação COM+ em páginas ASP.</span><span class="sxs-lookup"><span data-stu-id="0c9d7-109">For example, before the release of COM+ 1.5, IIS had to create shim objects solely to be able to use COM+ transaction services in ASP pages.</span></span> <span data-ttu-id="0c9d7-110">Os custos de desempenho que vêm da criação desses objetos incluem o armazenamento dos dados de configuração na metabase do IIS e no banco de dados de registro do COM+ (RegDB), bem como a comunicação extra entre a metabase do IIS e o RegDB do COM+ que é necessário para gerenciar efetivamente os dados de configuração.</span><span class="sxs-lookup"><span data-stu-id="0c9d7-110">The performance costs that come from creating those objects include storing the configuration data in both the IIS metabase and the COM+ registration database (RegDB) as well as the extra communication between the IIS metabase and the COM+ RegDB that is needed to effectively manage the configuration data.</span></span>

<span data-ttu-id="0c9d7-111">Se o IIS precisasse usar um segundo serviço COM+, como a sincronização, ele tinha que criar um objeto de Shim completamente diferente para fazer isso.</span><span class="sxs-lookup"><span data-stu-id="0c9d7-111">If IIS needed to use a second COM+ service, such as synchronization, it had to create a completely different shim object to do so.</span></span> <span data-ttu-id="0c9d7-112">Para usar as transações COM+ e a sincronização, um terceiro tipo de objeto Shim seria necessário.</span><span class="sxs-lookup"><span data-stu-id="0c9d7-112">To use both COM+ transactions and synchronization, a third type of shim object would be needed.</span></span> <span data-ttu-id="0c9d7-113">A complexidade dessa abordagem é dimensionada como O (N2), tornando a implementação de novos serviços extremamente difícil.</span><span class="sxs-lookup"><span data-stu-id="0c9d7-113">The complexity of this approach scales as O(n2), making the implementation of new services extremely difficult.</span></span>

<span data-ttu-id="0c9d7-114">Com a introdução dos serviços COM+ sem componentes, os serviços que são necessários são configurados por meio de um objeto instanciado da classe.</span><span class="sxs-lookup"><span data-stu-id="0c9d7-114">With the introduction of COM+ services without components, the services that are needed are configured through an object instantiated from the class.</span></span> <span data-ttu-id="0c9d7-115">A classe [**CServiceConfig**](cserviceconfig.md) implementa as interfaces necessárias para configurar os diferentes serviços, fornecendo a flexibilidade para dar suporte a vários serviços ao mesmo tempo e a capacidade de dar suporte a novos serviços no futuro.</span><span class="sxs-lookup"><span data-stu-id="0c9d7-115">The [**CServiceConfig**](cserviceconfig.md) class implements the interfaces needed to configure the different services while providing the flexibility to support multiple services at the same time and the ability to support new services in the future.</span></span>

<span data-ttu-id="0c9d7-116">Os serviços configurados podem ser usados por meio de dois mecanismos diferentes: eles podem ser usados por meio da função [**CoCreateActivity**](/windows/desktop/api/ComSvcs/nf-comsvcs-cocreateactivity) , que aplica os serviços a todo o trabalho enviado por meio da atividade criada pela função e também podem ser usados pela inserção do trabalho que usa os serviços entre chamadas para as funções [**CoEnterServiceDomain**](/windows/desktop/api/ComSvcs/nf-comsvcs-coenterservicedomain) e [**CoLeaveServiceDomain**](/windows/desktop/api/ComSvcs/nf-comsvcs-coleaveservicedomain) .</span><span class="sxs-lookup"><span data-stu-id="0c9d7-116">The configured services can then be used through two different mechanisms: They can be used through the [**CoCreateActivity**](/windows/desktop/api/ComSvcs/nf-comsvcs-cocreateactivity) function, which applies the services to all of the work submitted via the activity that is created by the function, and they can also be used by embedding the work that uses the services between calls to the [**CoEnterServiceDomain**](/windows/desktop/api/ComSvcs/nf-comsvcs-coenterservicedomain) and [**CoLeaveServiceDomain**](/windows/desktop/api/ComSvcs/nf-comsvcs-coleaveservicedomain) functions.</span></span> <span data-ttu-id="0c9d7-117">Nenhuma dessas funções requer a criação de novos componentes para poder usar os serviços COM+; somente o objeto [**CServiceConfig**](cserviceconfig.md) é necessário.</span><span class="sxs-lookup"><span data-stu-id="0c9d7-117">None of these functions requires the creation of any new components to be able to use the COM+ services; only the [**CServiceConfig**](cserviceconfig.md) object is needed.</span></span>

## <a name="related-topics"></a><span data-ttu-id="0c9d7-118">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="0c9d7-118">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="0c9d7-119">Serviços COM+ sem tarefas de componentes</span><span class="sxs-lookup"><span data-stu-id="0c9d7-119">COM+ Services Without Components Tasks</span></span>](com--services-without-components-tasks.md)
</dt> </dl>

 

 



