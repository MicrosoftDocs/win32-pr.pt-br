---
description: O serviço de ativação Just-in-time (JIT) permite que o COM+ desative um objeto enquanto um cliente ainda mantém uma referência ativa para esse objeto.
ms.assetid: dbc7b257-8506-42c8-8a78-3474c6d4f4b6
title: Conceitos de ativação Just-in-time COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6c942bfeb342ea305083e0c7d7ebdea2fe96bf24
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105812395"
---
# <a name="com-just-in-time-activation-concepts"></a><span data-ttu-id="17f96-103">Conceitos de ativação Just-in-time COM+</span><span class="sxs-lookup"><span data-stu-id="17f96-103">COM+ Just-in-Time Activation Concepts</span></span>

<span data-ttu-id="17f96-104">O serviço de ativação Just-in-time (JIT) permite que o COM+ desative um objeto enquanto um cliente ainda mantém uma referência ativa para esse objeto.</span><span class="sxs-lookup"><span data-stu-id="17f96-104">The just-in-time (JIT) activation service enables COM+ to deactivate an object while a client still holds an active reference to that object.</span></span> <span data-ttu-id="17f96-105">Na próxima vez que o cliente chamar um método no objeto, que o cliente acredita que ainda esteja ativo, o serviço de ativação JIT do COM+ reativará o objeto de forma transparente para o cliente, just in time.</span><span class="sxs-lookup"><span data-stu-id="17f96-105">The next time the client calls a method on the object, which the client believes to be still active, the COM+ JIT activation service reactivates the object transparently to the client, just in time.</span></span>

<span data-ttu-id="17f96-106">A principal vantagem de usar o COM + ativação JIT é que você pode permitir que os clientes contenham referências a objetos enquanto eles precisarem, sem necessariamente ligar recursos de servidor valiosos, como memória.</span><span class="sxs-lookup"><span data-stu-id="17f96-106">The main advantage of using COM + JIT activation is that you can enable clients to hold references to objects for as long as they need them, without necessarily tying up valuable server resources such as memory.</span></span> <span data-ttu-id="17f96-107">Outros benefícios importantes incluem o seguinte:</span><span class="sxs-lookup"><span data-stu-id="17f96-107">Other important benefits include the following:</span></span>

-   <span data-ttu-id="17f96-108">O uso do serviço de ativação JIT do COM+ simplifica bastante o modelo de programação para o cliente, pois o cliente não precisa pensar em como ele usa objetos caros de servidor e recursos de servidor.</span><span class="sxs-lookup"><span data-stu-id="17f96-108">Using the COM+ JIT activation service greatly simplifies the programming model for the client because the client doesn't have to think about how it uses expensive server objects and server resources.</span></span> <span data-ttu-id="17f96-109">Sem a ativação JIT, os clientes podem incorrer em uma penalidade significativa quando freqüentemente precisam chamar e liberar objetos.</span><span class="sxs-lookup"><span data-stu-id="17f96-109">Without JIT activation, clients can incur a significant penalty when they frequently need to call and release objects.</span></span>
    > [!Note]  
    > <span data-ttu-id="17f96-110">Você pode refinar ainda mais esse benefício de desempenho usando o serviço de [pooling de objetos com+](com--object-pooling.md) .</span><span class="sxs-lookup"><span data-stu-id="17f96-110">You can refine this performance benefit further by using the [COM+ Object Pooling](com--object-pooling.md) service.</span></span> <span data-ttu-id="17f96-111">Ao agrupar objetos ativados por JIT, você pode acelerar muito a reativação de objetos para clientes ao reutilizar quaisquer recursos que eles possam estar mantendo, dando a você um controle mais preciso sobre a quantidade de memória usada por um determinado objeto no servidor.</span><span class="sxs-lookup"><span data-stu-id="17f96-111">By pooling JIT-activated objects, you can greatly speed object reactivation for clients while reusing whatever resources they might be holding, giving you more precise control over how much memory is used by a given object on the server.</span></span> <span data-ttu-id="17f96-112">Para obter mais detalhes, consulte [pooling de objetos e ativação JIT do com+](object-pooling-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="17f96-112">For more detail, see [Object Pooling and COM+ JIT Activation](object-pooling-and-com--jit-activation.md).</span></span>

     

-   <span data-ttu-id="17f96-113">Com aplicativos distribuídos, uma viagem de ida e volta de rede cara é necessária para a criação de cada objeto, e o mais distante do cliente é o servidor, quanto maior os custos de ativação e marshaling do objeto de servidor, abertura do canal e configuração do proxy e do stub.</span><span class="sxs-lookup"><span data-stu-id="17f96-113">With distributed applications, an expensive network round-trip is required for the creation of every object, and the farther the client is from the server, the greater the costs of activating and marshaling the server object, opening the channel, and setting up the proxy and stub.</span></span> <span data-ttu-id="17f96-114">Usando o serviço de ativação JIT do COM+, você pode minimizar a frequência de criação de objeto para melhorar significativamente o desempenho do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="17f96-114">By using the COM+ JIT activation service, you can minimize the frequency of object creation to significantly improve the performance of your application.</span></span>
-   <span data-ttu-id="17f96-115">Quando você usa a ativação JIT do COM+ para ativar esses objetos nos quais os clientes contêm referências de longa duração, mas que não estão necessariamente usando o tempo todo, a memória do servidor nem sempre está presa, mantendo esses objetos ativos.</span><span class="sxs-lookup"><span data-stu-id="17f96-115">When you use COM+ JIT activation to activate those objects to which clients hold long-lived references but which they aren't necessarily using all the time, server memory is not always tied up keeping those objects alive.</span></span> <span data-ttu-id="17f96-116">Isso pode aumentar significativamente a escalabilidade do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="17f96-116">This can significantly increase the scalability of your application.</span></span> <span data-ttu-id="17f96-117">O único impacto sobre o desempenho que os clientes veem é o tempo que leva para o COM+ reativar o objeto, geralmente apenas com margens mais tempo do que é necessário para alocar memória para o objeto e substancialmente menor do que a viagem de ida e volta da rede para a criação remota de objetos.</span><span class="sxs-lookup"><span data-stu-id="17f96-117">The only performance hit that clients see is the time it takes COM+ to reactivate the object, usually just marginally more time than it takes to allocate memory for the object and substantially less than the network round-trip for remote object creation.</span></span>

## <a name="enabling-com-jit-activation"></a><span data-ttu-id="17f96-118">Habilitando a ativação JIT do COM+</span><span class="sxs-lookup"><span data-stu-id="17f96-118">Enabling COM+ JIT Activation</span></span>

<span data-ttu-id="17f96-119">Você pode habilitar o serviço de ativação JIT do COM+ para um componente usando a ferramenta administrativa serviços de componentes ou as funções administrativas.</span><span class="sxs-lookup"><span data-stu-id="17f96-119">You can enable the COM+ JIT activation service for a component by using either the Component Services administrative tool or the Administrative functions.</span></span> <span data-ttu-id="17f96-120">Para obter detalhes sobre como fazer isso, consulte [habilitando a ativação JIT para um componente](enabling-jit-activation-for-a-component.md).</span><span class="sxs-lookup"><span data-stu-id="17f96-120">For details about how to do this, see [Enabling JIT Activation for a Component](enabling-jit-activation-for-a-component.md).</span></span>

<span data-ttu-id="17f96-121">A ativação JIT do COM+ pode interagir com outros serviços COM+, como o seguinte:</span><span class="sxs-lookup"><span data-stu-id="17f96-121">COM+ JIT activation can interact with other COM+ services, such as the following:</span></span>

-   <span data-ttu-id="17f96-122">Quando seu componente requer transações, a ativação JIT é habilitada automaticamente para ela.</span><span class="sxs-lookup"><span data-stu-id="17f96-122">When your component requires transactions, JIT activation is automatically enabled for it.</span></span> <span data-ttu-id="17f96-123">Para obter mais detalhes, consulte [Transações e ativação JIT do com+](transactions-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="17f96-123">For greater detail, see [Transactions and COM+ JIT Activation](transactions-and-com--jit-activation.md).</span></span>
-   <span data-ttu-id="17f96-124">Quando o componente está habilitado para ativação JIT, a sincronização é definida automaticamente como necessária.</span><span class="sxs-lookup"><span data-stu-id="17f96-124">When your component is enabled for JIT activation, synchronization is automatically set to required.</span></span> <span data-ttu-id="17f96-125">Isso significa que, se dois clientes chamarem simultaneamente um componente ativado por JIT e uma chamada de método para um deles retornar, fazendo com que o objeto seja desativado, o outro não será mantido à esquerda.</span><span class="sxs-lookup"><span data-stu-id="17f96-125">This means that if two clients simultaneously call a JIT-activated component and a method call for one of them returns, causing the object to be deactivated, the other is not left stranded.</span></span>

## <a name="how-deactivation-is-triggered"></a><span data-ttu-id="17f96-126">Como a desativação é disparada</span><span class="sxs-lookup"><span data-stu-id="17f96-126">How Deactivation Is Triggered</span></span>

<span data-ttu-id="17f96-127">O COM+ desativa um objeto com base no status do bit de conclusão no contexto do objeto.</span><span class="sxs-lookup"><span data-stu-id="17f96-127">COM+ deactivates an object based on the status of the doneness bit on the object context.</span></span> <span data-ttu-id="17f96-128">O objeto pode usar esse bit para sinalizar se ele está concluído — ou seja, pronto para ser desativado — durante uma determinada chamada de método.</span><span class="sxs-lookup"><span data-stu-id="17f96-128">Your object can use this bit to signal whether it is done—that is, ready to be deactivated—during a given method call.</span></span> <span data-ttu-id="17f96-129">Para obter mais informações, consulte [definindo o bit concluído](setting-the-done-bit.md).</span><span class="sxs-lookup"><span data-stu-id="17f96-129">For more information, see [Setting the Done Bit](setting-the-done-bit.md).</span></span>

## <a name="using-the-auto-done-property"></a><span data-ttu-id="17f96-130">Usando a propriedade auto-Done</span><span class="sxs-lookup"><span data-stu-id="17f96-130">Using the Auto-Done Property</span></span>

<span data-ttu-id="17f96-131">Usando a ferramenta administrativa serviços de componentes, você pode configurar um método de modo que o objeto seja desativado automaticamente no retorno do método.</span><span class="sxs-lookup"><span data-stu-id="17f96-131">Using the Component Services administrative tool, you can configure a method such that the object is automatically deactivated on method return.</span></span> <span data-ttu-id="17f96-132">(Consulte [habilitando auto-pronto para um método](enabling-auto-done-for-a-method.md) para obter instruções sobre como definir essa propriedade.) Ao selecionar essa opção, você pode eliminar as chamadas de método repetitivas para votação em transações.</span><span class="sxs-lookup"><span data-stu-id="17f96-132">(See [Enabling Auto-Done for a Method](enabling-auto-done-for-a-method.md) for instructions about how to set this property.) By selecting this option, you can eliminate the repetitive method calls for voting in transactions.</span></span> <span data-ttu-id="17f96-133">Como a configuração padrão para o bit de consistência é true, se você tiver alterado o bit Done para true também e não tomar nenhuma ação para alterar essas configurações, [**IObjectContext:: SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) será chamado automaticamente depois que o método retornar.</span><span class="sxs-lookup"><span data-stu-id="17f96-133">Because the default setting for the consistency bit is True, if you have changed the done bit to True as well and you take no action to change these settings, [**IObjectContext::SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) is called automatically after the method returns.</span></span>

<span data-ttu-id="17f96-134">No entanto, há uma limitação para esse comportamento: COM+ examinará o HRESULT que o método retorna.</span><span class="sxs-lookup"><span data-stu-id="17f96-134">However, there is one caveat to this behavior: COM+ will examine the HRESULT that the method returns.</span></span> <span data-ttu-id="17f96-135">Se esse HRESULT indicar falha, o bit de consistência será definido como false e o resultado será o mesmo que se você tivesse chamado [**IObjectContext:: SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span><span class="sxs-lookup"><span data-stu-id="17f96-135">If that HRESULT indicates failure, the consistency bit is set to False and the result is the same as if you had called [**IObjectContext::SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span></span>

<span data-ttu-id="17f96-136">Para resumir, se você selecionar automático para um método e não tomar nenhuma ação para definir quaisquer bits e se um HRESULT (HR) for retornado, o seguinte se aplicará:</span><span class="sxs-lookup"><span data-stu-id="17f96-136">To summarize, if you select auto-done for a method and don't take any action to set any bits, and if an HRESULT(hr) is returned, the following applies:</span></span>

-   <span data-ttu-id="17f96-137">Se for bem sucedido (HR), é como se você tivesse chamado [**SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete).</span><span class="sxs-lookup"><span data-stu-id="17f96-137">If SUCCEEDS(hr), it is as though you called [**SetComplete**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete).</span></span>
-   <span data-ttu-id="17f96-138">Se falha (HR), é como se você tivesse chamado [**SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span><span class="sxs-lookup"><span data-stu-id="17f96-138">If FAILED(hr), it is as though you called [**SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).</span></span>

## <a name="using-iobjectcontrol-to-manage-object-activation-and-deactivation"></a><span data-ttu-id="17f96-139">Usando o Controledeobjetoi para gerenciar a ativação e a desativação de objetos</span><span class="sxs-lookup"><span data-stu-id="17f96-139">Using IObjectControl to Manage Object Activation and Deactivation</span></span>

<span data-ttu-id="17f96-140">Você pode implementar a interface [**controledeobjetoi**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) para que o tempo de execução do com+ gerencie automaticamente a desativação e a reativação para seus objetos.</span><span class="sxs-lookup"><span data-stu-id="17f96-140">You can implement the [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) interface so that the COM+ runtime automatically manages deactivation and reactivation for your objects.</span></span> <span data-ttu-id="17f96-141">Quando um objeto implementa essa interface, o COM+ chama [**controledeobjetoi::D eactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) quando ele desativa o objeto e [**Controledeobjetoi:: Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) quando o reativa.</span><span class="sxs-lookup"><span data-stu-id="17f96-141">When an object implements this interface, COM+ calls [**IObjectControl::Deactivate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) when it deactivates the object and [**IObjectControl::Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) when it reactivates it.</span></span> <span data-ttu-id="17f96-142">Esses métodos habilitam a inicialização automática de contexto na ativação do objeto e na limpeza do estado na desativação.</span><span class="sxs-lookup"><span data-stu-id="17f96-142">These methods enable automatic context initialization on object activation and cleanup of state on deactivation.</span></span>

<span data-ttu-id="17f96-143">Se você estiver agrupando objetos que usam a ativação JIT do COM+, é altamente recomendável que você implemente [**controledeobjetoi**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span><span class="sxs-lookup"><span data-stu-id="17f96-143">If you are pooling objects that use COM+ JIT activation, it is highly recommended that you implement [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol).</span></span> <span data-ttu-id="17f96-144">Para obter mais detalhes, consulte [pooling de objetos e ativação JIT do com+](object-pooling-and-com--jit-activation.md).</span><span class="sxs-lookup"><span data-stu-id="17f96-144">For more detail, see [Object Pooling and COM+ JIT Activation](object-pooling-and-com--jit-activation.md).</span></span>

## <a name="statelessness-and-jit-activation"></a><span data-ttu-id="17f96-145">Sem estado e ativação JIT</span><span class="sxs-lookup"><span data-stu-id="17f96-145">Statelessness and JIT Activation</span></span>

<span data-ttu-id="17f96-146">Os objetos transacionais são necessariamente sem estado porque não é possível compartilhar o estado em um limite de transação.</span><span class="sxs-lookup"><span data-stu-id="17f96-146">Transactional objects are necessarily stateless because you cannot share state across a transaction boundary.</span></span> <span data-ttu-id="17f96-147">Portanto, você usaria a ativação JIT somente quando o objeto não mantiver nenhum estado que seria perdido na desativação; caso contrário, você viola o isolamento das transações.</span><span class="sxs-lookup"><span data-stu-id="17f96-147">Therefore, you would use JIT activation only when your object holds no state that would be lost on deactivation; otherwise, you violate the isolation of the transactions.</span></span> <span data-ttu-id="17f96-148">Devido aos padrões de uso natural de objetos transacionais, eles fazem alguma unidade de trabalho e liberam o objeto quando a transação é confirmada ou anulada — a ativação JIT e as transações automáticas estão relacionadas diretamente.</span><span class="sxs-lookup"><span data-stu-id="17f96-148">Due to the natural use patterns of transactional objects—they do some unit of work and release the object when the transaction commits or aborts—JIT activation and automatic transactions are closely related.</span></span> <span data-ttu-id="17f96-149">Configurar um objeto para exigir transações habilita a ativação JIT do COM+ automaticamente.</span><span class="sxs-lookup"><span data-stu-id="17f96-149">Configuring an object to require transactions enables COM+ JIT activation automatically.</span></span>

## <a name="related-topics"></a><span data-ttu-id="17f96-150">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="17f96-150">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="17f96-151">Tarefas de ativação Just-in-time COM+</span><span class="sxs-lookup"><span data-stu-id="17f96-151">COM+ Just-in-Time Activation Tasks</span></span>](com--just-in-time-activation-tasks.md)
</dt> <dt>

[<span data-ttu-id="17f96-152">Pooling de objetos e ativação JIT do COM+</span><span class="sxs-lookup"><span data-stu-id="17f96-152">Object Pooling and COM+ JIT Activation</span></span>](object-pooling-and-com--jit-activation.md)
</dt> <dt>

[<span data-ttu-id="17f96-153">Transações e ativação JIT do COM+</span><span class="sxs-lookup"><span data-stu-id="17f96-153">Transactions and COM+ JIT Activation</span></span>](transactions-and-com--jit-activation.md)
</dt> </dl>

 

 



