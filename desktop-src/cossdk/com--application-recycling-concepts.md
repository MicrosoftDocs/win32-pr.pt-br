---
description: A reciclagem de aplicativos pode aumentar significativamente a estabilidade geral de seus aplicativos COM+, oferecendo uma correção rápida para problemas conhecidos e ajudando a se proteger contra aqueles inesperados.
ms.assetid: bf98318b-4d87-44cc-85a1-68faf5547e06
title: Conceitos de reciclagem de aplicativo COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ab37376ff3bc6d03f454f63822641ed69fad0b47
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104370400"
---
# <a name="com-application-recycling-concepts"></a><span data-ttu-id="37042-103">Conceitos de reciclagem de aplicativo COM+</span><span class="sxs-lookup"><span data-stu-id="37042-103">COM+ Application Recycling Concepts</span></span>

<span data-ttu-id="37042-104">A reciclagem de aplicativos pode aumentar significativamente a estabilidade geral de seus aplicativos COM+, oferecendo uma correção rápida para problemas conhecidos e ajudando a se proteger contra aqueles inesperados.</span><span class="sxs-lookup"><span data-stu-id="37042-104">Application recycling can significantly increase the overall stability of your COM+ applications by offering a quick fix for known problems and helping to protect against unexpected ones.</span></span> <span data-ttu-id="37042-105">Por exemplo, o desempenho do aplicativo pode diminuir ao longo do tempo devido a problemas como vazamentos de memória, uso de recursos não escalonáveis e falha de processo.</span><span class="sxs-lookup"><span data-stu-id="37042-105">For example, application performance can degrade over time because of problems such as memory leaks, nonscalable resource usage, and process failure.</span></span> <span data-ttu-id="37042-106">O COM+ fornece a reciclagem de aplicativos como uma solução para esses problemas.</span><span class="sxs-lookup"><span data-stu-id="37042-106">COM+ provides application recycling as a solution to these problems.</span></span> <span data-ttu-id="37042-107">Você pode usar a reciclagem de aplicativos para desligar automaticamente um processo e reiniciá-lo, reinicializando um processo com falha e realocando a memória que ele usa.</span><span class="sxs-lookup"><span data-stu-id="37042-107">You can use application recycling to automatically shut down a process and restart it, thus reinitializing a failing process and reallocating memory it uses.</span></span>

<span data-ttu-id="37042-108">A reciclagem de aplicativos funciona criando uma duplicata do processo Dllhost associado a um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="37042-108">Application recycling works by creating a duplicate of the Dllhost process associated with an application.</span></span> <span data-ttu-id="37042-109">Esse processo Dllhost duplicado atende a todas as solicitações de objeto futuras, o que deixa o Dllhost antigo concluir a manutenção das solicitações de objeto restantes.</span><span class="sxs-lookup"><span data-stu-id="37042-109">This duplicate Dllhost process services all future object requests, which leaves the old Dllhost to finish servicing the remaining object requests.</span></span> <span data-ttu-id="37042-110">O antigo processo Dllhost é desligado quando detecta o lançamento de todas as referências externas a objetos no processo ou quando o valor do tempo limite de expiração é atingido.</span><span class="sxs-lookup"><span data-stu-id="37042-110">The old Dllhost process is shut down when it detects the release of all external references to objects in the process or when the expiration time-out value is reached.</span></span> <span data-ttu-id="37042-111">Por meio desse comportamento, a reciclagem de aplicativos garante que um aplicativo cliente não tenha uma interrupção de serviço.</span><span class="sxs-lookup"><span data-stu-id="37042-111">Through this behavior, application recycling ensures that a client application does not experience a service interruption.</span></span>

> [!Note]  
> <span data-ttu-id="37042-112">Não é possível reciclar um aplicativo COM+ que foi configurado para ser executado como um serviço do Windows.</span><span class="sxs-lookup"><span data-stu-id="37042-112">You cannot recycle a COM+ application that has been configured to run as a Windows service.</span></span> <span data-ttu-id="37042-113">Além disso, os aplicativos de biblioteca têm as propriedades de reciclagem e pooling de seu processo de host.</span><span class="sxs-lookup"><span data-stu-id="37042-113">Also, library applications have the recycling and pooling properties of their host process.</span></span>

 

<span data-ttu-id="37042-114">Você pode configurar a reciclagem de aplicativos administrativamente, usando a ferramenta administrativa serviços de componentes ou programaticamente, por meio do SDK administrativo do COM+.</span><span class="sxs-lookup"><span data-stu-id="37042-114">You can configure application recycling administratively, by using the Component Services administrative tool, or programmatically, through the COM+ Administrative SDK.</span></span> <span data-ttu-id="37042-115">Você pode reciclar processos com base em vários critérios, determinados pelas seguintes propriedades de um objeto [**COMAdminCatalogObject**](comadmincatalogobject.md) na coleção de [**aplicativos**](applications.md) :</span><span class="sxs-lookup"><span data-stu-id="37042-115">You can recycle processes based on several criteria, determined by the following properties of a [**COMAdminCatalogObject**](comadmincatalogobject.md) object in the [**Applications**](applications.md) collection:</span></span>

-   <span data-ttu-id="37042-116">**RecycleLifetimeLimit.**</span><span class="sxs-lookup"><span data-stu-id="37042-116">**RecycleLifetimeLimit.**</span></span> <span data-ttu-id="37042-117">O número máximo de minutos que um processo pode executar antes de ser reciclado.</span><span class="sxs-lookup"><span data-stu-id="37042-117">The maximum number of minutes a process can run before it's recycled.</span></span> <span data-ttu-id="37042-118">O intervalo válido é de 0 a 30.240 minutos (21 dias).</span><span class="sxs-lookup"><span data-stu-id="37042-118">The valid range is 0 through 30,240 minutes (21 days).</span></span> <span data-ttu-id="37042-119">O número padrão de minutos é 0, o que indica que o processo não fará a reciclagem de atingir um limite de tempo de vida.</span><span class="sxs-lookup"><span data-stu-id="37042-119">The default number of minutes is 0, which indicates that the process will not recycle from reaching a lifetime limit.</span></span>
-   <span data-ttu-id="37042-120">**RecycleMemoryLimit.**</span><span class="sxs-lookup"><span data-stu-id="37042-120">**RecycleMemoryLimit.**</span></span> <span data-ttu-id="37042-121">A quantidade máxima de uso de memória do processo (em kilobytes) antes de reciclar o processo.</span><span class="sxs-lookup"><span data-stu-id="37042-121">The maximum amount of process memory usage (in kilobytes) before recycling the process.</span></span> <span data-ttu-id="37042-122">Se o uso de memória do processo exceder o número especificado por mais de um minuto, o processo será reciclado.</span><span class="sxs-lookup"><span data-stu-id="37042-122">If the process memory usage exceeds the specified number for longer than one minute, the process is recycled.</span></span> <span data-ttu-id="37042-123">O intervalo válido é de 0 a 1.048.576 KB.</span><span class="sxs-lookup"><span data-stu-id="37042-123">The valid range is 0 through 1,048,576 KB.</span></span> <span data-ttu-id="37042-124">A quantidade padrão de uso de memória é 0 KB, o que indica que o processo não fará a reciclagem de atingir um limite de memória.</span><span class="sxs-lookup"><span data-stu-id="37042-124">The default amount of memory usage is 0 KB, which indicates that the process will not recycle from reaching a memory limit.</span></span>
-   <span data-ttu-id="37042-125">**RecycleCallLimit.**</span><span class="sxs-lookup"><span data-stu-id="37042-125">**RecycleCallLimit.**</span></span> <span data-ttu-id="37042-126">O número máximo de chamadas que os objetos de aplicativo podem aceitar antes de reciclar o processo.</span><span class="sxs-lookup"><span data-stu-id="37042-126">The maximum number of calls that application objects can accept before recycling the process.</span></span> <span data-ttu-id="37042-127">O intervalo válido é de 0 a 1.048.576 chamadas.</span><span class="sxs-lookup"><span data-stu-id="37042-127">The valid range is 0 through 1,048,576 calls.</span></span> <span data-ttu-id="37042-128">O número padrão de chamadas é 0, o que indica que o processo não fará a reciclagem de atingir um limite de chamada.</span><span class="sxs-lookup"><span data-stu-id="37042-128">The default number of calls is 0, which indicates that the process will not recycle from reaching a call limit.</span></span>
-   <span data-ttu-id="37042-129">**RecycleActivationLimit.**</span><span class="sxs-lookup"><span data-stu-id="37042-129">**RecycleActivationLimit.**</span></span> <span data-ttu-id="37042-130">O número máximo de ativações de objeto de aplicativo a serem aceitas antes de reciclar o processo.</span><span class="sxs-lookup"><span data-stu-id="37042-130">The maximum number of application object activations to accept before recycling the process.</span></span> <span data-ttu-id="37042-131">O intervalo válido é de 0 a 1.048.576 ativações.</span><span class="sxs-lookup"><span data-stu-id="37042-131">The valid range is 0 through 1,048,576 activations.</span></span> <span data-ttu-id="37042-132">O número padrão de ativações é 0, o que indica que o processo não fará a reciclagem de atingir um limite de ativação.</span><span class="sxs-lookup"><span data-stu-id="37042-132">The default number of activations is 0, which indicates that the process will not recycle from reaching an activation limit.</span></span>

<span data-ttu-id="37042-133">Além disso, a propriedade RecycleExpirationTimeout do objeto [**COMAdminCatalogObject**](comadmincatalogobject.md) é usada para forçar o desligamento de um processo reciclado.</span><span class="sxs-lookup"><span data-stu-id="37042-133">Additionally, the RecycleExpirationTimeout property of the [**COMAdminCatalogObject**](comadmincatalogobject.md) object is used to force the shutdown of a recycled process.</span></span> <span data-ttu-id="37042-134">Indica o número de minutos a aguardar pelo lançamento de todas as referências externas a objetos no processo reciclado antes de forçar o encerramento do processo.</span><span class="sxs-lookup"><span data-stu-id="37042-134">It indicates the number of minutes to wait for the release of all external references to objects in the recycled process before forcibly shutting down the process.</span></span> <span data-ttu-id="37042-135">O intervalo válido é de 1 a 1440 minutos (24 horas) e o tempo limite de expiração padrão é de 15 minutos.</span><span class="sxs-lookup"><span data-stu-id="37042-135">The valid range is 1 through 1440 minutes (24 hours), and the default expiration time-out is 15 minutes.</span></span> <span data-ttu-id="37042-136">Esse valor é usado somente quando já está determinado que um processo será reciclado com base nos outros critérios.</span><span class="sxs-lookup"><span data-stu-id="37042-136">This value is used only when it is already determined that a process will be recycled based on the other criteria.</span></span>

<span data-ttu-id="37042-137">Você pode selecionar mais de um critério para reciclar um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="37042-137">You can select more than one criterion for recycling an application.</span></span> <span data-ttu-id="37042-138">O COM+ recicla o aplicativo depois que o primeiro conjunto de critérios é atendido.</span><span class="sxs-lookup"><span data-stu-id="37042-138">COM+ recycles the application after the first of the set of criteria is satisfied.</span></span> <span data-ttu-id="37042-139">Você pode definir o valor de tempo limite de expiração para determinar por quanto tempo um processo Dllhost antigo pode gastar para concluir as solicitações de serviço restantes antes de ser desligado de forma forçada.</span><span class="sxs-lookup"><span data-stu-id="37042-139">You can set the expiration time-out value to determine how long an old Dllhost process can spend completing remaining service requests before being forcibly shut down.</span></span>

<span data-ttu-id="37042-140">A coleção [**ApplicationInstances**](applicationinstances.md) fornece a propriedade HasRecycled, que fornece uma maneira de determinar se o aplicativo já foi reciclado.</span><span class="sxs-lookup"><span data-stu-id="37042-140">The [**ApplicationInstances**](applicationinstances.md) collection provides the HasRecycled property, which provides a way to determine whether the application has ever been recycled.</span></span>

## <a name="related-topics"></a><span data-ttu-id="37042-141">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="37042-141">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="37042-142">Tarefas de reciclagem de aplicativo COM+</span><span class="sxs-lookup"><span data-stu-id="37042-142">COM+ Application Recycling Tasks</span></span>](com--application-recycling-tasks.md)
</dt> <dt>

[<span data-ttu-id="37042-143">**RecycleSurrogate**</span><span class="sxs-lookup"><span data-stu-id="37042-143">**RecycleSurrogate**</span></span>](/windows/desktop/api/ComSvcs/nf-comsvcs-recyclesurrogate)
</dt> </dl>

 

 



