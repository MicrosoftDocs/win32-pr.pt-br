---
title: Práticas recomendadas da infraestrutura de gráficos do DirectX (DXGI)
description: Este artigo aborda os principais problemas de portabilidade.
ms.assetid: 2df92ffe-1bfc-d682-2770-20cf0c831c9b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f576368674d05af74e3161d4251301ebc066a489
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/20/2020
ms.locfileid: "104366470"
---
# <a name="directx-graphics-infrastructure-dxgi-best-practices"></a><span data-ttu-id="61d3b-103">DXGI (infra-estrutura de gráficos do DirectX): práticas recomendadas</span><span class="sxs-lookup"><span data-stu-id="61d3b-103">DirectX Graphics Infrastructure (DXGI): Best Practices</span></span>

<span data-ttu-id="61d3b-104">A DXGI (DirectX Graphic Infrastructure) da Microsoft é um novo subsistema que foi introduzido com o Windows Vista que encapsula algumas das tarefas de baixo nível que são necessárias pelo Direct3D 10, 10.1, 11 e 11.1.</span><span class="sxs-lookup"><span data-stu-id="61d3b-104">Microsoft DirectX Graphics Infrastructure (DXGI) is a new subsystem that was introduced with Windows Vista that encapsulates some of the low-level tasks that are needed by Direct3D 10, 10.1, 11, and 11.1.</span></span> <span data-ttu-id="61d3b-105">Da perspectiva de um programador do Direct3D 9, DXGI abrange a maior parte do código para enumeração, criação da cadeia de permuta e apresentação que anteriormente foi empacotada nas APIs do Direct3D 9.</span><span class="sxs-lookup"><span data-stu-id="61d3b-105">From the perspective of a Direct3D 9 programmer, DXGI encompasses most of the code for enumeration, swap-chain creation, and presentation that previously was packed into the Direct3D 9 APIs.</span></span> <span data-ttu-id="61d3b-106">Quando você porta um aplicativo para DXGI e o Direct3D 10. x e o Direct3D 11. x, precisa levar em conta algumas considerações para garantir que o processo seja executado sem problemas.</span><span class="sxs-lookup"><span data-stu-id="61d3b-106">When you port an app to DXGI and Direct3D 10.x and Direct3D 11.x, you need to take some considerations into account to ensure that the process runs smoothly.</span></span>

<span data-ttu-id="61d3b-107">Este artigo aborda os principais problemas de portabilidade.</span><span class="sxs-lookup"><span data-stu-id="61d3b-107">This article discusses key porting issues.</span></span>

-   [<span data-ttu-id="61d3b-108">Problemas de tela inteira</span><span class="sxs-lookup"><span data-stu-id="61d3b-108">Full-Screen Issues</span></span>](#full-screen-issues)
-   [<span data-ttu-id="61d3b-109">Vários monitores</span><span class="sxs-lookup"><span data-stu-id="61d3b-109">Multiple Monitors</span></span>](#multiple-monitors)
-   [<span data-ttu-id="61d3b-110">Estilos de janela e DXGI</span><span class="sxs-lookup"><span data-stu-id="61d3b-110">Window Styles and DXGI</span></span>](#window-styles-and-dxgi)
-   [<span data-ttu-id="61d3b-111">Multithread e DXGI</span><span class="sxs-lookup"><span data-stu-id="61d3b-111">Multithreading and DXGI</span></span>](#multithreading-and-dxgi)
-   [<span data-ttu-id="61d3b-112">Gama e DXGI</span><span class="sxs-lookup"><span data-stu-id="61d3b-112">Gamma and DXGI</span></span>](#gamma-and-dxgi)
-   [<span data-ttu-id="61d3b-113">DXGI 1,1</span><span class="sxs-lookup"><span data-stu-id="61d3b-113">DXGI 1.1</span></span>](#dxgi-11)
-   [<span data-ttu-id="61d3b-114">DXGI 1,2</span><span class="sxs-lookup"><span data-stu-id="61d3b-114">DXGI 1.2</span></span>](#dxgi-12)

## <a name="full-screen-issues"></a><span data-ttu-id="61d3b-115">Problemas de Full-Screen</span><span class="sxs-lookup"><span data-stu-id="61d3b-115">Full-Screen Issues</span></span>

<span data-ttu-id="61d3b-116">Em portamento do Direct3D 9 para DXGI e para o Direct3D 10. x ou Direct3D 11. x, os problemas associados à mudança de janelas para o modo de tela inteira geralmente podem causar dores de cabeça para os desenvolvedores.</span><span class="sxs-lookup"><span data-stu-id="61d3b-116">In porting from Direct3D 9 to DXGI and to Direct3D 10.x or Direct3D 11.x, issues associated with moving from windowing to full-screen mode often may cause headaches for developers.</span></span> <span data-ttu-id="61d3b-117">Os principais problemas surgem porque os aplicativos do Direct3D 9, diferentemente dos aplicativos DXGI, exigem uma abordagem mais prática para rastrear estilos de janela e Estados de janela.</span><span class="sxs-lookup"><span data-stu-id="61d3b-117">The main problems arise because Direct3D 9 applications, unlike DXGI applications, require a more hands-on approach to tracking window styles and window states.</span></span> <span data-ttu-id="61d3b-118">Quando o código de alteração de modo é portado para ser executado em DXGI, ele geralmente causa um comportamento inesperado.</span><span class="sxs-lookup"><span data-stu-id="61d3b-118">When the mode-changing code is ported to run on DXGI, it often causes unexpected behavior.</span></span>

<span data-ttu-id="61d3b-119">Muitas vezes, os aplicativos do Direct3D 9 trataram a transição para o modo de tela inteira definindo a resolução do buffer frontal, forçando o dispositivo para o modo exclusivo de tela inteira e, em seguida, definindo as resoluções de buffer de fundo para corresponder.</span><span class="sxs-lookup"><span data-stu-id="61d3b-119">Often, Direct3D 9 applications handled the transition into full-screen mode by setting the resolution of the front buffer, forcing the device into full-screen exclusive mode, and then setting the back buffer resolutions to match.</span></span> <span data-ttu-id="61d3b-120">Um caminho separado foi usado para alterações no tamanho da janela porque eles precisavam ser gerenciados a partir do processo de janela sempre que o aplicativo recebeu uma mensagem de tamanho do WM \_ .</span><span class="sxs-lookup"><span data-stu-id="61d3b-120">A separate path was used for changes to window size because they had to be managed from the window process whenever the application received a WM\_SIZE message.</span></span>

<span data-ttu-id="61d3b-121">DXGI tenta simplificar essa abordagem combinando os dois casos.</span><span class="sxs-lookup"><span data-stu-id="61d3b-121">DXGI attempts to simplify this approach by combining the two cases.</span></span> <span data-ttu-id="61d3b-122">Por exemplo, quando a borda da janela é arrastada no modo de janela, o aplicativo recebe uma mensagem de tamanho do WM \_ .</span><span class="sxs-lookup"><span data-stu-id="61d3b-122">For example, when the window border is dragged in windowed mode, the application receives a WM\_SIZE message.</span></span> <span data-ttu-id="61d3b-123">DXGI intercepta essa mensagem e redimensiona automaticamente o buffer frontal.</span><span class="sxs-lookup"><span data-stu-id="61d3b-123">DXGI intercepts this message and automatically resizes the front buffer.</span></span> <span data-ttu-id="61d3b-124">Tudo o que o aplicativo precisa fazer é chamar [**IDXGISwapChain:: ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) para redimensionar o buffer de fundo para o tamanho que foi passado como parâmetros no tamanho do WM \_ .</span><span class="sxs-lookup"><span data-stu-id="61d3b-124">All that the application needs to do is call [**IDXGISwapChain::ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) to resize the back buffer to the size that was passed as parameters in WM\_SIZE.</span></span> <span data-ttu-id="61d3b-125">Da mesma forma, quando o aplicativo precisa alternar entre o modo de tela inteira e de janela, o aplicativo pode simplesmente chamar [**IDXGISwapChain:: Setfullscreenstate**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate).</span><span class="sxs-lookup"><span data-stu-id="61d3b-125">Similarly, when the application needs to switch between full-screen and windowed mode, the application can simply call [**IDXGISwapChain::SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate).</span></span> <span data-ttu-id="61d3b-126">DXGI redimensiona o buffer frontal para corresponder ao modo de tela inteira selecionado recentemente e envia uma \_ mensagem de tamanho do WM para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="61d3b-126">DXGI resizes the front buffer to match the newly selected full-screen mode, and it sends a WM\_SIZE message to the application.</span></span> <span data-ttu-id="61d3b-127">O aplicativo novamente chama **ResizeBuffers**, assim como faria se a borda da janela fosse arrastada.</span><span class="sxs-lookup"><span data-stu-id="61d3b-127">The application again calls **ResizeBuffers**, just as it would if the window border was dragged.</span></span>

<span data-ttu-id="61d3b-128">A metodologia da explicação anterior segue um caminho muito específico.</span><span class="sxs-lookup"><span data-stu-id="61d3b-128">The methodology of the preceding explanation follows a very particular path.</span></span> <span data-ttu-id="61d3b-129">DXGI definiu a resolução de tela inteira para a resolução de desktop por padrão.</span><span class="sxs-lookup"><span data-stu-id="61d3b-129">DXGI set the full-screen resolution to the desktop resolution by default.</span></span> <span data-ttu-id="61d3b-130">No entanto, muitos aplicativos mudam para uma resolução de tela inteira preferida.</span><span class="sxs-lookup"><span data-stu-id="61d3b-130">Many applications, however, switch to a preferred full-screen resolution.</span></span> <span data-ttu-id="61d3b-131">Nesse caso, DXGI fornece [**IDXGISwapChain:: ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget).</span><span class="sxs-lookup"><span data-stu-id="61d3b-131">In such a case, DXGI provides [**IDXGISwapChain::ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget).</span></span> <span data-ttu-id="61d3b-132">Isso deve ser chamado antes de chamar [**Setfullscreenstate**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate).</span><span class="sxs-lookup"><span data-stu-id="61d3b-132">This should be called before calling [**SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate).</span></span> <span data-ttu-id="61d3b-133">Embora esses métodos possam ser chamados na ordem **oposta (primeiro** , seguido por **ResizeTarget**), fazer isso faz com que uma mensagem de tamanho extra \_ do WM seja enviada ao aplicativo.</span><span class="sxs-lookup"><span data-stu-id="61d3b-133">Although these methods can be called in the opposite order (**SetFullscreenState** first, followed by **ResizeTarget**), doing so causes an extra WM\_SIZE message to be sent to the application.</span></span> <span data-ttu-id="61d3b-134">(Fazer isso também pode causar oscilação, já que DXGI pode ser forçado a executar duas alterações no modo.) Depois de chamar **Setfullscreenstate**, é aconselhável chamar **ResizeTarget** novamente com o membro **Taxa_de_Atualização** do [**\_ modo dxgi \_ desc**](/previous-versions/windows/desktop/legacy/bb173064(v=vs.85)) . Isso resulta em uma instrução de não operação em DXGI, mas pode evitar problemas com a taxa de atualização, que são discutidas a seguir.</span><span class="sxs-lookup"><span data-stu-id="61d3b-134">(Doing so can also cause flickering, since DXGI could be forced to perform two mode changes.) After calling **SetFullscreenState**, it is advisable to call **ResizeTarget** again with the **RefreshRate** member of [**DXGI\_MODE\_DESC**](/previous-versions/windows/desktop/legacy/bb173064(v=vs.85)) zeroed out. This amounts to a no-operation instruction in DXGI, but it can avoid issues with the refresh rate, which are discussed next.</span></span>

<span data-ttu-id="61d3b-135">Quando estiver no modo de tela inteira, o Gerenciador de Janelas da Área de Trabalho (DWM) será desabilitado.</span><span class="sxs-lookup"><span data-stu-id="61d3b-135">When in full-screen mode, the Desktop Window Manager (DWM) is disabled.</span></span> <span data-ttu-id="61d3b-136">DXGI pode executar uma inversão para apresentar o conteúdo do buffer de fundo em vez de fazer um blit, o que faria no modo de janela.</span><span class="sxs-lookup"><span data-stu-id="61d3b-136">DXGI can perform a flip to present the back buffer contents instead of doing a blit, which it would do in windowed mode.</span></span> <span data-ttu-id="61d3b-137">Esse lucro de desempenho pode ser desfeito, no entanto, se determinados requisitos não forem atendidos.</span><span class="sxs-lookup"><span data-stu-id="61d3b-137">This performance gain can be undone, however, if certain requirements are not met.</span></span> <span data-ttu-id="61d3b-138">Para garantir que DXGI faça uma inversão em vez de um blit, o buffer frontal e o buffer de fundo devem ser dimensionados de forma idêntica.</span><span class="sxs-lookup"><span data-stu-id="61d3b-138">To ensure that DXGI does a flip instead of a blit, the front buffer and back buffer must be sized identically.</span></span> <span data-ttu-id="61d3b-139">Se o aplicativo manipula corretamente suas mensagens de tamanho do WM \_ , isso não deve ser um problema.</span><span class="sxs-lookup"><span data-stu-id="61d3b-139">If the application correctly handles its WM\_SIZE messages, this should not be a problem.</span></span> <span data-ttu-id="61d3b-140">Além disso, os formatos devem ser idênticos.</span><span class="sxs-lookup"><span data-stu-id="61d3b-140">Also, the formats must be identical.</span></span>

<span data-ttu-id="61d3b-141">O problema para a maioria dos aplicativos é a taxa de atualização.</span><span class="sxs-lookup"><span data-stu-id="61d3b-141">The problem for most applications is the refresh rate.</span></span> <span data-ttu-id="61d3b-142">A taxa de atualização especificada na chamada para [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) deve ser uma taxa de atualização que é enumerada pelo objeto [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) que a cadeia de permuta está usando.</span><span class="sxs-lookup"><span data-stu-id="61d3b-142">The refresh rate that is specified in the call to [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) must be a refresh rate that is enumerated by the [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) object that the swap chain is using.</span></span> <span data-ttu-id="61d3b-143">DXGI pode calcular esse valor automaticamente se o aplicativo zerar o membro **Taxa_de_Atualização** do [**modo dxgi \_ \_ desc**](/previous-versions/windows/desktop/legacy/bb173064(v=vs.85)) que é passado para **ResizeTarget**.</span><span class="sxs-lookup"><span data-stu-id="61d3b-143">DXGI can automatically calculate this value if the application zeroes out the **RefreshRate** member of [**DXGI\_MODE\_DESC**](/previous-versions/windows/desktop/legacy/bb173064(v=vs.85)) that is passed into **ResizeTarget**.</span></span> <span data-ttu-id="61d3b-144">É importante não supor que certas taxas de atualização sempre terão suporte e simplesmente embutir um valor em código.</span><span class="sxs-lookup"><span data-stu-id="61d3b-144">It is important not to assume that certain refresh rates will always be supported and to simply hard-code a value.</span></span> <span data-ttu-id="61d3b-145">Geralmente, os desenvolvedores escolhem 60 Hz como a taxa de atualização, não sabendo que a taxa de atualização enumerada do monitor é de aproximadamente 60.000/1.001 Hz do monitor.</span><span class="sxs-lookup"><span data-stu-id="61d3b-145">Often, developers choose 60 Hz as the refresh rate, not knowing that the enumerated refresh rate from the monitor is approximately 60,000 / 1,001 Hz from the monitor.</span></span> <span data-ttu-id="61d3b-146">Se a taxa de atualização não corresponder à taxa de atualização esperada de 60, DXGI será forçado a executar um blit no modo de tela inteira em vez de uma inversão.</span><span class="sxs-lookup"><span data-stu-id="61d3b-146">If the refresh rate does not match the expected refresh rate of 60, DXGI is forced to perform a blit in full-screen mode instead of a flip.</span></span>

<span data-ttu-id="61d3b-147">O último problema que os desenvolvedores enfrentam com freqüência é como alterar as resoluções de tela inteira enquanto permanecem no modo de tela inteira.</span><span class="sxs-lookup"><span data-stu-id="61d3b-147">The last issue that developers often face is how to change full-screen resolutions while remaining in full-screen mode.</span></span> <span data-ttu-id="61d3b-148">A chamada de [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) e [**setfullscreenstate**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate) às vezes é bem sucedido, mas a resolução de tela inteira permanece na resolução da área de trabalho.</span><span class="sxs-lookup"><span data-stu-id="61d3b-148">Calling [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) and [**SetFullscreenState**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-setfullscreenstate) sometimes succeeds, but the full-screen resolution remains the desktop resolution.</span></span> <span data-ttu-id="61d3b-149">Além disso, os desenvolvedores podem criar uma cadeia de troca de tela inteira e fornecer uma resolução específica, apenas para descobrir que o DXGI usa como padrão a resolução da área de trabalho, independentemente dos números passados.</span><span class="sxs-lookup"><span data-stu-id="61d3b-149">Also, developers may create a full-screen swap chain and give a specific resolution, only to find that DXGI defaults to the desktop resolution regardless of the numbers passed in.</span></span> <span data-ttu-id="61d3b-150">Salvo indicação em contrário, o DXGI usa como padrão a resolução da área de trabalho para cadeias de troca de tela inteira.</span><span class="sxs-lookup"><span data-stu-id="61d3b-150">Unless otherwise instructed, DXGI defaults to the desktop resolution for full-screen swap chains.</span></span> <span data-ttu-id="61d3b-151">Ao criar uma cadeia de troca de tela inteira, o membro **flags** da [**estrutura \_ \_ \_ desc da cadeia de permuta dxgi**](/windows/desktop/api/dxgi/ns-dxgi-dxgi_swap_chain_desc) deve ser definido como o sinalizador de cadeia de permuta de [**dxgi \_ \_ \_ \_ \_ \_ alternar**](/windows/desktop/api/dxgi/ne-dxgi-dxgi_swap_chain_flag) para o comportamento padrão de dxgi.</span><span class="sxs-lookup"><span data-stu-id="61d3b-151">When creating a full-screen swap chain, the **Flags** member of the [**DXGI\_SWAP\_CHAIN\_DESC**](/windows/desktop/api/dxgi/ns-dxgi-dxgi_swap_chain_desc) structure must be set to [**DXGI\_SWAP\_CHAIN\_FLAG\_ALLOW\_MODE\_SWITCH**](/windows/desktop/api/dxgi/ne-dxgi-dxgi_swap_chain_flag) to override DXGI's default behavior.</span></span> <span data-ttu-id="61d3b-152">Esse sinalizador também pode ser passado para **ResizeTarget** para habilitar ou desabilitar essa funcionalidade dinamicamente.</span><span class="sxs-lookup"><span data-stu-id="61d3b-152">This flag also can be passed to **ResizeTarget** to enable or disable this functionality dynamically.</span></span>

## <a name="multiple-monitors"></a><span data-ttu-id="61d3b-153">Vários monitores</span><span class="sxs-lookup"><span data-stu-id="61d3b-153">Multiple Monitors</span></span>

<span data-ttu-id="61d3b-154">Ao usar DXGI com vários monitores, há duas regras a serem seguidas.</span><span class="sxs-lookup"><span data-stu-id="61d3b-154">When using DXGI with multiple monitors, there are two rules to follow.</span></span>

<span data-ttu-id="61d3b-155">A primeira regra se aplica à criação de duas ou mais cadeias de permuta de tela inteira em vários monitores.</span><span class="sxs-lookup"><span data-stu-id="61d3b-155">The first rule applies to the creation of two or more full-screen swap chains on multiple monitors.</span></span> <span data-ttu-id="61d3b-156">Ao criar essas cadeias de troca, é melhor criar todas as cadeias de permuta como janelas e, em seguida, defini-las como tela inteira.</span><span class="sxs-lookup"><span data-stu-id="61d3b-156">When creating such swap chains, it is best to create all swap chains as windowed, and then to set them to full-screen.</span></span> <span data-ttu-id="61d3b-157">Se as cadeias de permuta forem criadas no modo de tela inteira, a criação de uma segunda cadeia de permuta fará com que uma alteração de modo seja enviada para a primeira cadeia de permuta, o que poderia causar o encerramento do modo de tela inteira.</span><span class="sxs-lookup"><span data-stu-id="61d3b-157">If swap chains are created in full-screen mode, the creation of a second swap chain causes a mode change to be sent to the first swap chain, which could cause termination of full-screen mode.</span></span>

<span data-ttu-id="61d3b-158">A segunda regra se aplica a saídas.</span><span class="sxs-lookup"><span data-stu-id="61d3b-158">The second rule applies to outputs.</span></span> <span data-ttu-id="61d3b-159">Ser olhar de saídas usadas ao criar cadeias de permuta.</span><span class="sxs-lookup"><span data-stu-id="61d3b-159">Be watchful of outputs used when creating swap chains.</span></span> <span data-ttu-id="61d3b-160">Com DXGI, o objeto [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) controla qual monitor a cadeia de permuta usa ao se tornar uma tela inteira.</span><span class="sxs-lookup"><span data-stu-id="61d3b-160">With DXGI, the [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) object controls which monitor the swap chain uses when becoming full-screen.</span></span> <span data-ttu-id="61d3b-161">Ao contrário de DXGI, o Direct3D 9 não tinha nenhum conceito de saídas.</span><span class="sxs-lookup"><span data-stu-id="61d3b-161">Unlike DXGI, Direct3D 9 had no concept of outputs.</span></span>

## <a name="window-styles-and-dxgi"></a><span data-ttu-id="61d3b-162">Estilos de janela e DXGI</span><span class="sxs-lookup"><span data-stu-id="61d3b-162">Window Styles and DXGI</span></span>

<span data-ttu-id="61d3b-163">Os aplicativos do Direct3D 9 tinham muito trabalho a fazer ao alternar entre os modos de tela inteira e de janela.</span><span class="sxs-lookup"><span data-stu-id="61d3b-163">Direct3D 9 applications had a lot of work to do when switching between full-screen and windowed modes.</span></span> <span data-ttu-id="61d3b-164">Grande parte desse trabalho envolvia a alteração de estilos de janela para adicionar e remover bordas, adicionar barras de rolagem e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="61d3b-164">Much of this work involved changing window styles to add and remove borders, to add scrollbars, and so on.</span></span> <span data-ttu-id="61d3b-165">Quando os aplicativos são portados para DXGI e Direct3D 10. x ou Direct3D 11. x, esse código geralmente é deixado em vigor.</span><span class="sxs-lookup"><span data-stu-id="61d3b-165">When applications are ported to DXGI and Direct3D 10.x or Direct3D 11.x, this code often is left in place.</span></span> <span data-ttu-id="61d3b-166">Dependendo das alterações que estão sendo feitas, alternar entre os modos pode causar um comportamento inesperado.</span><span class="sxs-lookup"><span data-stu-id="61d3b-166">Depending on the changes being made, switching between modes can cause unexpected behavior.</span></span> <span data-ttu-id="61d3b-167">Por exemplo, ao alternar para o modo de janela, o aplicativo pode não ter mais um quadro de janela ou uma borda de janela apesar de ter um código que defina especificamente esses estilos.</span><span class="sxs-lookup"><span data-stu-id="61d3b-167">For example, when switching to windowed mode, the application might no longer have a window frame or window border despite having code that specifically sets these styles.</span></span> <span data-ttu-id="61d3b-168">Isso ocorre porque DXGI agora lida com grande parte dessa alteração de estilo por conta própria.</span><span class="sxs-lookup"><span data-stu-id="61d3b-168">This occurs because DXGI now handles much of this style changing on its own.</span></span> <span data-ttu-id="61d3b-169">A configuração manual de estilos de janela pode interferir com DXGI, e isso pode causar um comportamento inesperado.</span><span class="sxs-lookup"><span data-stu-id="61d3b-169">Manual setting of window styles can interfere with DXGI, and this can cause unexpected behavior.</span></span>

<span data-ttu-id="61d3b-170">O comportamento recomendado é fazer o menor trabalho possível e permitir que DXGI manipule a maior parte da interação com as janelas.</span><span class="sxs-lookup"><span data-stu-id="61d3b-170">The recommended behavior is to do as little work as possible, and to let DXGI handle most of the interaction with the windows.</span></span> <span data-ttu-id="61d3b-171">No entanto, se o aplicativo precisar tratar seu próprio comportamento de janela, [**IDXGIFactory:: MakeWindowAssociation**](/windows/desktop/api/dxgi/nf-dxgi-idxgifactory-makewindowassociation) poderá ser usado para informar ao dxgi para desabilitar parte de seu manuseio automático de janela.</span><span class="sxs-lookup"><span data-stu-id="61d3b-171">However, if the application needs to handle its own windowing behavior, [**IDXGIFactory::MakeWindowAssociation**](/windows/desktop/api/dxgi/nf-dxgi-idxgifactory-makewindowassociation) can be used to tell DXGI to disable some of its automatic window handling.</span></span>

## <a name="multithreading-and-dxgi"></a><span data-ttu-id="61d3b-172">Multithread e DXGI</span><span class="sxs-lookup"><span data-stu-id="61d3b-172">Multithreading and DXGI</span></span>

<span data-ttu-id="61d3b-173">Deve-se ter um cuidado especial ao usar a DXGI em um aplicativo multithread para garantir que não ocorram deadlocks.</span><span class="sxs-lookup"><span data-stu-id="61d3b-173">Special care must be taken when using DXGI in a multithreaded application to ensure that deadlocks do not occur.</span></span> <span data-ttu-id="61d3b-174">Devido à interação de fechamento de DXGI com janelas, ele ocasionalmente envia mensagens de janela para a janela do aplicativo associado.</span><span class="sxs-lookup"><span data-stu-id="61d3b-174">Because of DXGI's close interaction with windowing, it occasionally sends window messages to the associated application window.</span></span> <span data-ttu-id="61d3b-175">DXGI precisa que as alterações na janela ocorram antes que ela possa continuar, portanto, usará [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), que é uma chamada síncrona.</span><span class="sxs-lookup"><span data-stu-id="61d3b-175">DXGI needs the windowing changes to occur before it can continue, so it will use [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), which is a synchronous call.</span></span> <span data-ttu-id="61d3b-176">O aplicativo deve processar a mensagem de janela antes de **SendMessage** retornar.</span><span class="sxs-lookup"><span data-stu-id="61d3b-176">The application must process the window message before **SendMessage** returns.</span></span>

<span data-ttu-id="61d3b-177">Em um aplicativo em que as chamadas DXGI e a bomba de mensagens estão no mesmo thread (ou em um aplicativo de thread único), poucas precisam ser feitas.</span><span class="sxs-lookup"><span data-stu-id="61d3b-177">In an application where DXGI calls and the message pump are on the same thread (or a single-threaded application), little needs to be done.</span></span> <span data-ttu-id="61d3b-178">Quando a chamada DXGI está no mesmo thread que a bomba de mensagem, [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) chama o [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85))da janela.</span><span class="sxs-lookup"><span data-stu-id="61d3b-178">When the DXGI call is on the same thread as the message pump, [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) calls the window's [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)).</span></span> <span data-ttu-id="61d3b-179">Isso ignora a bomba de mensagem e permite que a execução continue após a chamada para **SendMessage**.</span><span class="sxs-lookup"><span data-stu-id="61d3b-179">This bypasses the message pump, and allows execution to continue after the call to **SendMessage**.</span></span> <span data-ttu-id="61d3b-180">Lembre-se de que chamadas [**IDXGISwapChain**](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain) , como [**IDXGISwapChain::P reenviada**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-present), também são consideradas chamadas dxgi; DXGI pode adiar o trabalho de [**ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) ou [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) até que **Present** seja chamado.</span><span class="sxs-lookup"><span data-stu-id="61d3b-180">Remember that [**IDXGISwapChain**](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain) calls, such as [**IDXGISwapChain::Present**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-present), are also considered DXGI calls; DXGI may defer work from [**ResizeBuffers**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizebuffers) or [**ResizeTarget**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-resizetarget) until **Present** is called.</span></span>

<span data-ttu-id="61d3b-181">Se a chamada DXGI e a bomba de mensagem estiverem em threads diferentes, deve-se ter cuidado para evitar deadlocks.</span><span class="sxs-lookup"><span data-stu-id="61d3b-181">If the DXGI call and message pump are on different threads, care must be taken to avoid deadlocks.</span></span> <span data-ttu-id="61d3b-182">Quando o bombeamento e o SendMessage da mensagem estiverem em threads diferentes, [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) adicionará uma mensagem à fila de mensagens da janela e aguardará que a janela processe a mensagem.</span><span class="sxs-lookup"><span data-stu-id="61d3b-182">When the message pump and SendMessage are on different threads, [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) adds a message to the window's message queue, and waits for the window to process that message.</span></span> <span data-ttu-id="61d3b-183">Se o procedimento de janela estiver ocupado ou não for chamado pela bomba de mensagem, a mensagem poderá nunca ser processada e DXGI aguardará indefinidamente.</span><span class="sxs-lookup"><span data-stu-id="61d3b-183">If the window procedure is busy or is not called by the message pump, the message may never get processed and DXGI will wait indefinitely.</span></span>

<span data-ttu-id="61d3b-184">Por exemplo, se um aplicativo que tem seu bombeamento de mensagem em um thread e seu processamento em outro, talvez queira alterar os modos.</span><span class="sxs-lookup"><span data-stu-id="61d3b-184">For example, if an application that has its message pump on one thread and its rendering on another, it may want to change modes.</span></span> <span data-ttu-id="61d3b-185">O thread de bombeamento de mensagens informa o thread de renderização para alterar os modos e aguarda até que a alteração do modo seja concluída.</span><span class="sxs-lookup"><span data-stu-id="61d3b-185">The message pump thread tells the rendering thread to change modes, and waits until the mode change is complete.</span></span> <span data-ttu-id="61d3b-186">No entanto, o thread de renderização chama funções DXGI que, por sua vez, chamam [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), que é bloqueado até que a bomba de mensagem processe a mensagem.</span><span class="sxs-lookup"><span data-stu-id="61d3b-186">However, the rendering thread calls DXGI functions, which in turn call [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage), which blocks until the message pump processes the message.</span></span> <span data-ttu-id="61d3b-187">Um deadlock ocorre porque os dois threads agora são bloqueados e estão aguardando uns aos outros.</span><span class="sxs-lookup"><span data-stu-id="61d3b-187">A deadlock occurs because both threads now are blocked, and are waiting on each other.</span></span> <span data-ttu-id="61d3b-188">Para evitar isso, nunca bloqueie a bomba da mensagem.</span><span class="sxs-lookup"><span data-stu-id="61d3b-188">To avoid this, never block the message pump.</span></span> <span data-ttu-id="61d3b-189">Se um bloco for inevitável, toda a interação de DXGI deverá ocorrer no mesmo thread que a bomba de mensagem.</span><span class="sxs-lookup"><span data-stu-id="61d3b-189">If a block is unavoidable, then all DXGI interaction should occur on the same thread as the message pump.</span></span>

## <a name="gamma-and-dxgi"></a><span data-ttu-id="61d3b-190">Gama e DXGI</span><span class="sxs-lookup"><span data-stu-id="61d3b-190">Gamma and DXGI</span></span>

<span data-ttu-id="61d3b-191">Embora o gama possa ser tratado melhor no Direct3D 10. x ou no Direct3D 11. x usando texturas SRGB, a rampa de gama ainda pode ser útil para os desenvolvedores que desejam um valor de gama diferente de 2,2 ou que estejam usando um formato de destino de renderização que não ofereça suporte a SRGB.</span><span class="sxs-lookup"><span data-stu-id="61d3b-191">Although gamma may be best handled in Direct3D 10.x or Direct3D 11.x by using SRGB textures, the gamma ramp still can be useful to developers who want a different gamma value than 2.2 or who are using a render target format that does not support SRGB.</span></span> <span data-ttu-id="61d3b-192">Esteja ciente de dois problemas ao definir a rampa de gama por meio de DXGI.</span><span class="sxs-lookup"><span data-stu-id="61d3b-192">Be aware of two issues when setting the gamma ramp through DXGI.</span></span> <span data-ttu-id="61d3b-193">O primeiro problema é que os valores de Rampes passados para [**IDXGIOutput:: SetGammaControl**](/windows/desktop/api/dxgi/nf-dxgi-idxgioutput-setgammacontrol) são valores float, não valores de **palavra** .</span><span class="sxs-lookup"><span data-stu-id="61d3b-193">The first issue is that the ramp values passed into [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/dxgi/nf-dxgi-idxgioutput-setgammacontrol) are float values, not **WORD** values.</span></span> <span data-ttu-id="61d3b-194">Além disso, certifique-se de que o código portado do Direct3D 9 não tente converter em valores de palavras antes de passá **-** los para **SetGammaControl**.</span><span class="sxs-lookup"><span data-stu-id="61d3b-194">Also, ensure that code ported from Direct3D 9 does not try to convert to **WORD** values before passing these to **SetGammaControl**.</span></span>

<span data-ttu-id="61d3b-195">O segundo problema é que, depois de alterar para o modo de tela inteira, [**SetGammaControl**](/windows/desktop/api/dxgi/nf-dxgi-idxgioutput-setgammacontrol) pode não parecer funcionar, dependendo do objeto [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) que está sendo usado.</span><span class="sxs-lookup"><span data-stu-id="61d3b-195">The second issue is that, after changing to full-screen mode, [**SetGammaControl**](/windows/desktop/api/dxgi/nf-dxgi-idxgioutput-setgammacontrol) may not appear to work, dependent on the [**IDXGIOutput**](/windows/desktop/api/dxgi/nn-dxgi-idxgioutput) object being used.</span></span> <span data-ttu-id="61d3b-196">Ao mudar para o modo de tela inteira, DXGI cria um novo objeto de saída e usa o objeto para todas as operações subsequentes na saída.</span><span class="sxs-lookup"><span data-stu-id="61d3b-196">When changing to full-screen mode, DXGI creates a new output object, and uses the object for all subsequent operations on the output.</span></span> <span data-ttu-id="61d3b-197">Se chamar **SetGammaControl** em uma saída que é enumerada antes de uma opção de modo de tela inteira, a chamada não será direcionada para a saída que dxgi está usando no momento.</span><span class="sxs-lookup"><span data-stu-id="61d3b-197">If calling **SetGammaControl** on an output that is enumerated before a full-screen mode switch, the call is not directed toward the output that DXGI is using currently.</span></span> <span data-ttu-id="61d3b-198">Para evitar isso, chame [**IDXGISwapChain:: GetContainingOutput**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-getcontainingoutput) para obter a saída atual e, em seguida, chame **SetGammaControl** dessa saída para obter o comportamento correto.</span><span class="sxs-lookup"><span data-stu-id="61d3b-198">To avoid this, call [**IDXGISwapChain::GetContainingOutput**](/windows/desktop/api/dxgi/nf-dxgi-idxgiswapchain-getcontainingoutput) to get the current output, and then call **SetGammaControl** off this output to get the correct behavior.</span></span>

<span data-ttu-id="61d3b-199">Para obter informações sobre como usar a correção gama, consulte [usando a correção gama](/windows/desktop/direct3ddxgi/using-gamma-correction).</span><span class="sxs-lookup"><span data-stu-id="61d3b-199">For info about using gamma correction, see [Using gamma correction](/windows/desktop/direct3ddxgi/using-gamma-correction).</span></span>

## <a name="dxgi-11"></a><span data-ttu-id="61d3b-200">DXGI 1,1</span><span class="sxs-lookup"><span data-stu-id="61d3b-200">DXGI 1.1</span></span>

<span data-ttu-id="61d3b-201">O tempo de execução do Direct3D 11 incluído no Windows 7 e instalado no Windows Vista (consulte [KB971644](https://support.microsoft.com/kb/971644)) inclui a versão 1,1 do dxgi.</span><span class="sxs-lookup"><span data-stu-id="61d3b-201">The Direct3D 11 runtime included in Windows 7 and installed onto Windows Vista (see [KB971644](https://support.microsoft.com/kb/971644)) includes version 1.1 of DXGI.</span></span> <span data-ttu-id="61d3b-202">Essa atualização adiciona definições para vários formatos novos (particularmente BGRA, tendência de X2 de 10 bits e compactação de textura BC6H e BC7 do Direct3D 11), bem como uma nova versão da fábrica de DXGI e interfaces de adaptador ([**CreateDXGIFactory1**](/windows/desktop/api/dxgi/nf-dxgi-createdxgifactory1), [**IDXGIFactory1**](/windows/desktop/api/dxgi/nn-dxgi-idxgifactory1), [**IDXGIAdapter1**](/windows/desktop/api/dxgi/nn-dxgi-idxgiadapter1)) para enumerar conexões de área de trabalho remota.</span><span class="sxs-lookup"><span data-stu-id="61d3b-202">This update adds definitions for a number of new formats (particularly BGRA, 10-bit X2 bias, and Direct3D 11's BC6H and BC7 texture compression), as well as a new version of the DXGI factory and adapter interfaces ([**CreateDXGIFactory1**](/windows/desktop/api/dxgi/nf-dxgi-createdxgifactory1), [**IDXGIFactory1**](/windows/desktop/api/dxgi/nn-dxgi-idxgifactory1), [**IDXGIAdapter1**](/windows/desktop/api/dxgi/nn-dxgi-idxgiadapter1)) for enumerating remote desktop connections.</span></span>

<span data-ttu-id="61d3b-203">Quando você usa o Direct3D 11, o tempo de execução usará DXGI 1,1 por padrão ao chamar [**D3D11CreateDevice**](/windows/desktop/api/d3d11/nf-d3d11-d3d11createdevice) ou [**D3D11CreateDeviceAndSwapChain**](/windows/desktop/api/d3d11/nf-d3d11-d3d11createdeviceandswapchain) com um ponteiro [**IDXGIAdapter**](/windows/desktop/api/dxgi/nn-dxgi-idxgiadapter) nulo.</span><span class="sxs-lookup"><span data-stu-id="61d3b-203">When you use Direct3D 11, the runtime will use DXGI 1.1 by default when calling [**D3D11CreateDevice**](/windows/desktop/api/d3d11/nf-d3d11-d3d11createdevice) or [**D3D11CreateDeviceAndSwapChain**](/windows/desktop/api/d3d11/nf-d3d11-d3d11createdeviceandswapchain) with a NULL [**IDXGIAdapter**](/windows/desktop/api/dxgi/nn-dxgi-idxgiadapter) pointer.</span></span> <span data-ttu-id="61d3b-204">Não há suporte para a combinação do uso de DXGI 1,0 e DXGI 1,1 no mesmo processo.</span><span class="sxs-lookup"><span data-stu-id="61d3b-204">Mixing use of DXGI 1.0 and DXGI 1.1 in the same process is not supported.</span></span> <span data-ttu-id="61d3b-205">A combinação de instâncias de objeto DXGI de fábricas diferentes no mesmo processo também não é suportada.</span><span class="sxs-lookup"><span data-stu-id="61d3b-205">Mixing DXGI object instances from different factories in the same process also is not supported.</span></span> <span data-ttu-id="61d3b-206">Portanto, quando você usa o DirectX 11, qualquer uso explícito das interfaces DXGI usa um [**IDXGIFactory1**](/windows/desktop/api/dxgi/nn-dxgi-idxgifactory1) criado pelo ponto de entrada [**CreateDXGIFactory1**](/windows/desktop/api/dxgi/nf-dxgi-createdxgifactory1) em "DXGI.DLL" para garantir que o aplicativo esteja sempre usando dxgi 1,1.</span><span class="sxs-lookup"><span data-stu-id="61d3b-206">Therefore, when you use DirectX 11, any explicit use of the DXGI interfaces uses a [**IDXGIFactory1**](/windows/desktop/api/dxgi/nn-dxgi-idxgifactory1) created by the [**CreateDXGIFactory1**](/windows/desktop/api/dxgi/nf-dxgi-createdxgifactory1) entry-point in “DXGI.DLL” to ensure the application is always using DXGI 1.1.</span></span>

## <a name="dxgi-12"></a><span data-ttu-id="61d3b-207">DXGI 1,2</span><span class="sxs-lookup"><span data-stu-id="61d3b-207">DXGI 1.2</span></span>

<span data-ttu-id="61d3b-208">O tempo de execução do Direct3D 11,1 que está incluído no Windows 8 também inclui a versão 1,2 do DXGI.</span><span class="sxs-lookup"><span data-stu-id="61d3b-208">The Direct3D 11.1 runtime that is included in Windows 8 also includes version 1.2 of DXGI.</span></span>

<span data-ttu-id="61d3b-209">DXGI 1,2 habilita estes recursos:</span><span class="sxs-lookup"><span data-stu-id="61d3b-209">DXGI 1.2 enables these features:</span></span>

-   <span data-ttu-id="61d3b-210">renderização de estéreo</span><span class="sxs-lookup"><span data-stu-id="61d3b-210">stereo rendering</span></span>
-   <span data-ttu-id="61d3b-211">16 formatos de bit por pixel</span><span class="sxs-lookup"><span data-stu-id="61d3b-211">16 bit-per-pixel formats</span></span>

    -   <span data-ttu-id="61d3b-212">O formato DXGI \_ \_ B5G6R5 \_ UNORM e \_ dxgi \_ B5G5R5A1 \_ UNORM agora são totalmente suportados</span><span class="sxs-lookup"><span data-stu-id="61d3b-212">DXGI\_FORMAT\_B5G6R5\_UNORM and DXGI\_FORMAT\_B5G5R5A1\_UNORM are now fully supported</span></span>
    -   <span data-ttu-id="61d3b-213">um novo formato \_ dxgi \_ B5G5R5A1 \_ UNORM foi adicionado</span><span class="sxs-lookup"><span data-stu-id="61d3b-213">a new DXGI\_FORMAT\_B5G5R5A1\_UNORM format was added</span></span>

-   <span data-ttu-id="61d3b-214">formatos de vídeo</span><span class="sxs-lookup"><span data-stu-id="61d3b-214">video formats</span></span>
-   <span data-ttu-id="61d3b-215">novas interfaces DXGI</span><span class="sxs-lookup"><span data-stu-id="61d3b-215">new DXGI interfaces</span></span>

<span data-ttu-id="61d3b-216">Para obter mais informações sobre os recursos do DXGI 1,2, consulte [melhorias do dxgi 1,2](/windows/desktop/direct3ddxgi/dxgi-1-2-improvements).</span><span class="sxs-lookup"><span data-stu-id="61d3b-216">For more info about DXGI 1.2 features, see [DXGI 1.2 Improvements](/windows/desktop/direct3ddxgi/dxgi-1-2-improvements).</span></span>

 

 