---
description: Para implementar totalmente um backup, é necessário participar dos gravadores do sistema.
ms.assetid: ea504f8e-26d9-499e-b3e9-03515b480a75
title: Suporte ao esquema de backup do gravador
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 593df12f552f206d5d0eedbf8d021b69ef955c6d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104164492"
---
# <a name="writer-backup-schema-support"></a><span data-ttu-id="2841a-103">Suporte ao esquema de backup do gravador</span><span class="sxs-lookup"><span data-stu-id="2841a-103">Writer Backup Schema Support</span></span>

<span data-ttu-id="2841a-104">Para implementar totalmente um backup, é necessário participar dos gravadores do sistema.</span><span class="sxs-lookup"><span data-stu-id="2841a-104">To fully implement a backup requires participation of the system's writers.</span></span> <span data-ttu-id="2841a-105">Os diferentes tipos de backups com suporte são chamados de esquemas e são indicados por um bitmask (ou bit ou) de membros da enumeração do [**\_ \_ esquema de backup do VSS**](/windows/desktop/api/Vss/ne-vss-vss_backup_schema) .</span><span class="sxs-lookup"><span data-stu-id="2841a-105">Different types of supported backups are referred to as schemas and are indicated by a bitmask (or bitwise OR) of members of the [**VSS\_BACKUP\_SCHEMA**](/windows/desktop/api/Vss/ne-vss-vss_backup_schema) enumeration.</span></span> <span data-ttu-id="2841a-106">Os esquemas válidos atualmente com suporte incluem o seguinte:</span><span class="sxs-lookup"><span data-stu-id="2841a-106">The currently supported valid schemas include the following:</span></span>

-   <span data-ttu-id="2841a-107">Esquema padrão: completo (VSS \_ BS \_ indefinido) — indica que um gravador dá suporte a um backup no qual será feito backup de todos os arquivos, independentemente da data do último backup.</span><span class="sxs-lookup"><span data-stu-id="2841a-107">Default Schema: Full (VSS\_BS\_UNDEFINED)—indicates that a writer supports a backup where all files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="2841a-108">O histórico de backup de cada arquivo pode ser atualizado pelo solicitante, e os gravadores que dão suporte ao valor de enumeração de carimbo de data e hora do VSS \_ BS \_ serão armazenados em um carimbo de data/hora atualizado com o solicitante.</span><span class="sxs-lookup"><span data-stu-id="2841a-108">The backup history of each file can be updated by the requester, and writers supporting the VSS\_BS\_TIMESTAMPED enumeration value, it will store an updated time stamp with the requester.</span></span> <span data-ttu-id="2841a-109">Esse esquema de backup pode ser usado como a base de um backup incremental ou diferencial.</span><span class="sxs-lookup"><span data-stu-id="2841a-109">This backup scheme can be used as the basis of an incremental or differential backup.</span></span>

    <span data-ttu-id="2841a-110">A restauração de um backup completo requer apenas uma única imagem de backup.</span><span class="sxs-lookup"><span data-stu-id="2841a-110">Restoring a full backup requires only a single backup image.</span></span>

-   <span data-ttu-id="2841a-111">Copiar backup (cópia do VSS \_ BS \_ ) — como o \_ esquema de backup completo do VSS BS \_ , indica que um gravador dá suporte a um backup no qual será feito backup de todos os arquivos, independentemente da data do último backup.</span><span class="sxs-lookup"><span data-stu-id="2841a-111">Copy Backup (VSS\_BS\_COPY)—like the VSS\_BS\_FULL backup schema, indicates that a writer supports a backup where all files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="2841a-112">No entanto, o histórico de backup de cada arquivo não será atualizado pelo solicitante ou gravador, e esse tipo de backup não poderá ser usado como a base de um backup incremental ou diferencial.</span><span class="sxs-lookup"><span data-stu-id="2841a-112">However, the backup history of each file will not be updated by either requester or writer, and this sort of backup cannot be used as the basis of an incremental or differential backup.</span></span>
-   <span data-ttu-id="2841a-113">Arquivo de log ( \_ log de BS \_ do VSS) — somente os arquivos de log de um gravador devem ser copiados em backup.</span><span class="sxs-lookup"><span data-stu-id="2841a-113">Log File (VSS\_BS\_LOG)—only a writer's log files are to be backed up.</span></span> <span data-ttu-id="2841a-114">Isso requer que um gravador tenha adicionado pelo menos um arquivo a pelo menos um componente usando o método [**IVssCreateWriterMetadata:: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) .</span><span class="sxs-lookup"><span data-stu-id="2841a-114">This requires a writer to have added at least one file to at least one component using the [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) method.</span></span> <span data-ttu-id="2841a-115">Esse tipo de backup é específico do VSS.</span><span class="sxs-lookup"><span data-stu-id="2841a-115">This backup type is specific to VSS.</span></span>
-   <span data-ttu-id="2841a-116">Locais de restauração personalizados (o gravador do VSS \_ BS \_ \_ dá suporte ao \_ novo \_ destino) — indica o suporte do gravador para um solicitante mudar, no momento da restauração, em que seus arquivos são restaurados.</span><span class="sxs-lookup"><span data-stu-id="2841a-116">Custom Restore Locations (VSS\_BS\_WRITER\_SUPPORTS\_NEW\_TARGET)—indicates writer support for a requester changing, at restore time, where its files are restored.</span></span> <span data-ttu-id="2841a-117">Isso significa que um gravador foi codificado para verificar tal realocação (usando [**IVssComponent:: GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget)) e tem a capacidade de trabalhar com arquivos realocados.</span><span class="sxs-lookup"><span data-stu-id="2841a-117">This means that a writer has been coded to check for such relocation (using [**IVssComponent::GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget)), and has the capacity for working with relocated files.</span></span>
-   <span data-ttu-id="2841a-118">Restaurar com movimentação (o \_ gravador do VSS BS \_ \_ dá suporte à \_ restauração \_ com \_ movimentação) — indica que o gravador dá suporte à execução de várias instâncias de gravador com a mesma ID de classe e dá suporte a um solicitante que move um componente para uma instância de gravador diferente no momento da restauração.</span><span class="sxs-lookup"><span data-stu-id="2841a-118">Restore with Move (VSS\_BS\_WRITER\_SUPPORTS\_RESTORE\_WITH\_MOVE)—indicates that the writer supports running multiple writer instances with the same class ID, and it supports a requester moving a component to a different writer instance at restore time.</span></span> <span data-ttu-id="2841a-119">A instância do gravador é especificada usando um nome de instância de gravador persistente que foi passado como o parâmetro *wszWriterInstanceName* para o método [**CVssWriter:: Initialize**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-initialize) .</span><span class="sxs-lookup"><span data-stu-id="2841a-119">The writer instance is specified by using a persistent writer instance name that was passed as the *wszWriterInstanceName* parameter to the [**CVssWriter::Initialize**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-initialize) method.</span></span> <span data-ttu-id="2841a-120">Um solicitante pode obter o nome da instância do gravador usando [**IVssExamineWriterMetadataEx:: GetIdentityEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadataex-getidentityex) e mover os componentes durante a restauração usando [**IVssBackupComponentsEx:: SetSelectedForRestoreEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex).</span><span class="sxs-lookup"><span data-stu-id="2841a-120">A requester can obtain the writer instance name using [**IVssExamineWriterMetadataEx::GetIdentityEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadataex-getidentityex) and move components during restore using [**IVssBackupComponentsEx::SetSelectedForRestoreEx**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex).</span></span>

    <span data-ttu-id="2841a-121">**Windows Server 2003 e Windows XP:** Esse valor não tem suporte até o Windows Server 2003 com Service Pack 1 (SP1).</span><span class="sxs-lookup"><span data-stu-id="2841a-121">**Windows Server 2003 and Windows XP:** This value is not supported until Windows Server 2003 with Service Pack 1 (SP1).</span></span>

-   <span data-ttu-id="2841a-122">Incremental (VSS \_ BS \_ incremental) — indica que o gravador usa a API do VSS para ajudar o solicitante, garantindo que apenas os arquivos que foram alterados ou adicionados desde o último backup completo ou incremental sejam copiados para um meio de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="2841a-122">Incremental (VSS\_BS\_INCREMENTAL)—indicates that the writer uses the VSS API to help the requester, ensuring that only files that have been changed or added since the last full or incremental backup are to be copied to a storage medium.</span></span>

    <span data-ttu-id="2841a-123">A restauração de um backup incremental requer a imagem de backup original e todas as imagens de backup incremental feitas desde o backup inicial.</span><span class="sxs-lookup"><span data-stu-id="2841a-123">Restoring an incremental backup requires the original backup image and all incremental backup images made since the initial backup.</span></span>

-   <span data-ttu-id="2841a-124">Diferencial ( \_ diferencial do VSS BS \_ ) — indica que o gravador usa a API do VSS para ajudar o solicitante a garantir que apenas os arquivos que foram alterados ou adicionados desde o último backup completo sejam copiados para um meio de armazenamento; todas as informações de backup intermediários são ignoradas.</span><span class="sxs-lookup"><span data-stu-id="2841a-124">Differential (VSS\_BS\_DIFFERENTIAL)—indicates that the writer uses the VSS API to help the requester ensure that only files that have been changed or added since the last full backup are to be copied to a storage medium; all intermediate backup information is ignored.</span></span>

    <span data-ttu-id="2841a-125">A restauração de um backup diferencial requer a imagem de backup original e a imagem de backup diferencial mais recente feita desde o último backup completo.</span><span class="sxs-lookup"><span data-stu-id="2841a-125">Restoring a differential backup requires the original backup image and the most recent differential backup image made since the last full backup.</span></span>

-   <span data-ttu-id="2841a-126">Incremental/diferencial: suporte a carimbo de data/hora ( \_ \_ o carimbo de data/hora VSS BS) — indica que um gravador dá suporte ao uso do mecanismo de carimbo de data/hora do VSS para incluir arquivos em operações incrementais ou diferenciais.</span><span class="sxs-lookup"><span data-stu-id="2841a-126">Incremental/Differential: Time Stamping Support (VSS\_BS\_TIMESTAMPED)—indicates that a writer supports using the VSS time-stamp mechanism to include files in incremental or differential operations.</span></span> <span data-ttu-id="2841a-127">No backup, o gravador deve armazenar um carimbo de backup [*do conjunto de arquivos*](vssgloss-f.md) com o método [**IVssComponent:: SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp) e, em Restore, recuperá-lo com [**IVssComponent:: GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="2841a-127">At backup, the writer must store a [*file set's*](vssgloss-f.md) backup stamp with the [**IVssComponent::SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp) method, and at restore retrieve it with [**IVssComponent::GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span></span>
-   <span data-ttu-id="2841a-128">Incremental/diferencial: tempo de último suporte à modificação (VSS \_ BS \_ última \_ modificação) — indica que ao implementar backups incrementais ou diferenciais com arquivos com diferenças, um gravador pode fornecer informações de hora da última modificação independentemente.</span><span class="sxs-lookup"><span data-stu-id="2841a-128">Incremental/Differential: Time of Last Modification Support (VSS\_BS\_LAST\_MODIFY)—indicates that when implementing incremental or differential backups with differenced files, a writer can provide last modification time information independently.</span></span> <span data-ttu-id="2841a-129">Essas informações podem ser fornecidas a um solicitante por meio do método [**IVssComponent:: AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) .</span><span class="sxs-lookup"><span data-stu-id="2841a-129">This information can be provided to a requester via the [**IVssComponent::AddDifferencedFilesByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) method.</span></span>
-   <span data-ttu-id="2841a-130">Incremental/diferencial: limitação de suporte \_ ( \_ \_ diferenciação incremental exclusiva do VSS BS \_ ) — indica suporte a gravador de esquemas de backup diferencial ou incrementais, mas somente exclusivamente: por exemplo, você não pode seguir um backup incremental com um backup diferencial.</span><span class="sxs-lookup"><span data-stu-id="2841a-130">Incremental/Differential: Support Limitation (VSS\_BS\_EXCLUSIVE\_INCREMENTAL\_DIFFERENTIAL)—indicates writer support of both differential or increment backup schemas, but only exclusively: for example, you cannot follow an incremental backup with a differential backup.</span></span>
-   <span data-ttu-id="2841a-131">Estado do sistema independente ( \_ \_ estado do \_ sistema independente do VSS BS \_ ) — indica que o gravador dá suporte ao backup de dados que faz parte do estado do sistema, mas que também pode ser feito backup independentemente do estado do sistema.</span><span class="sxs-lookup"><span data-stu-id="2841a-131">Independent System State (VSS\_BS\_INDEPENDENT\_SYSTEM\_STATE)—indicates that the writer supports backing up data that is part of the system state, but that can also be backed up independently of the system state.</span></span>

    <span data-ttu-id="2841a-132">**Windows Server 2003 e Windows XP:** Esse valor não tem suporte até o Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="2841a-132">**Windows Server 2003 and Windows XP:** This value is not supported until Windows Vista.</span></span>

-   <span data-ttu-id="2841a-133">Restauração de Roll-Forward (VSS \_ BS \_ avanço \_ Restore) – indica que o gravador dá suporte a uma configuração de solicitante de um ponto de restauração de roll-forward usando [**IVssBackupComponentsEx2:: SetRollForward**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setrollforward).</span><span class="sxs-lookup"><span data-stu-id="2841a-133">Roll-Forward Restore (VSS\_BS\_ROLLFORWARD\_RESTORE)—indicates that the writer supports a requester setting a roll-forward restore point using [**IVssBackupComponentsEx2::SetRollForward**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setrollforward).</span></span>

    <span data-ttu-id="2841a-134">**Windows Server 2003 e Windows XP:** Esse valor não tem suporte até o Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="2841a-134">**Windows Server 2003 and Windows XP:** This value is not supported until Windows Vista.</span></span>

-   <span data-ttu-id="2841a-135">Restore Rename (VSS \_ BS \_ Restore \_ Rename) – indica que o gravador dá suporte a uma configuração de solicitante como um nome de restauração usando [**IVssBackupComponentsEx2:: setrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setrestorename).</span><span class="sxs-lookup"><span data-stu-id="2841a-135">Restore Rename (VSS\_BS\_RESTORE\_RENAME)—indicates that the writer supports a requester setting a restore name using [**IVssBackupComponentsEx2::SetRestoreName**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setrestorename).</span></span>

    <span data-ttu-id="2841a-136">**Windows Server 2003 e Windows XP:** Esse valor não tem suporte até o Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="2841a-136">**Windows Server 2003 and Windows XP:** This value is not supported until Windows Vista.</span></span>

-   <span data-ttu-id="2841a-137">Restauração autoritativa ( \_ restauração autoritativa do VSS BS \_ \_ ) — indica que o gravador oferece suporte a uma restauração autoritativa de configuração de solicitante usando [**IVssBackupComponentsEx2:: SetAuthoritativeRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setauthoritativerestore).</span><span class="sxs-lookup"><span data-stu-id="2841a-137">Authoritative Restore (VSS\_BS\_AUTHORITATIVE\_RESTORE)—indicates that the writer supports a requester setting authoritative restore using [**IVssBackupComponentsEx2::SetAuthoritativeRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setauthoritativerestore).</span></span>

<span data-ttu-id="2841a-138">Os gravadores definem seus esquemas usando o método [**IVssCreateWriterMetadata:: SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema) , e um solicitante Obtém o esquema de cada gravador chamando [**IVssExamineWriterMetadata:: GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="2841a-138">Writers set their schemas using the [**IVssCreateWriterMetadata::SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema) method, and a requester obtains each writer's schema by calling [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span>

 

 



