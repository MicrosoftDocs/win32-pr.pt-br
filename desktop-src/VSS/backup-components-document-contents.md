---
description: O documento de componentes de backup é mantido por instâncias da interface IVssBackupComponents.
ms.assetid: 8c7ebba8-58c4-4733-ba59-802abf902c5e
title: Conteúdo do documento de componentes de backup
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5e12c88ebffa0037702e1f30dd818d4fd23fe4e2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "103837265"
---
# <a name="backup-components-document-contents"></a><span data-ttu-id="101b2-103">Conteúdo do documento de componentes de backup</span><span class="sxs-lookup"><span data-stu-id="101b2-103">Backup Components Document Contents</span></span>

<span data-ttu-id="101b2-104">O documento de componentes de backup é mantido por instâncias da interface [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) .</span><span class="sxs-lookup"><span data-stu-id="101b2-104">The Backup Components Document is maintained by instances of the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface.</span></span> <span data-ttu-id="101b2-105">Essa interface também contém vários métodos para controlar as operações de backup, manipular cópias de sombra e consultar o estado do sistema.</span><span class="sxs-lookup"><span data-stu-id="101b2-105">This interface also contains numerous methods for controlling backup operations, manipulating shadow copies, and querying the system state.</span></span> <span data-ttu-id="101b2-106">No entanto, nem todas as informações do documento são diretamente acessíveis por meio dessa interface.</span><span class="sxs-lookup"><span data-stu-id="101b2-106">However, not all of the document's information is directly accessible through this interface.</span></span>

<span data-ttu-id="101b2-107">O documento de componentes de backup consiste em vários conjuntos de dados:</span><span class="sxs-lookup"><span data-stu-id="101b2-107">The Backup Components Document consists of several sets of data:</span></span>

-   <span data-ttu-id="101b2-108">Informações sobre quais componentes foram explicitamente incluídos em uma operação de backup ou restauração</span><span class="sxs-lookup"><span data-stu-id="101b2-108">Information about which components were explicitly included in a backup or restore operation</span></span>
-   <span data-ttu-id="101b2-109">Uma representação do componente armazenado e informações do gravador</span><span class="sxs-lookup"><span data-stu-id="101b2-109">A representation of the stored component and writer information</span></span>
-   <span data-ttu-id="101b2-110">Informações de estado sobre a operação de backup/recuperação</span><span class="sxs-lookup"><span data-stu-id="101b2-110">State information about the backup/recover operation</span></span>

<span data-ttu-id="101b2-111">Embora as informações do componente estejam disponíveis para o solicitante e o gravador, somente o gravador tem acesso às informações de estado.</span><span class="sxs-lookup"><span data-stu-id="101b2-111">While the component information is available to both the requester and the writer, only the writer has access to the state information.</span></span>

## <a name="component-inclusion-information"></a><span data-ttu-id="101b2-112">Informações de inclusão de componente</span><span class="sxs-lookup"><span data-stu-id="101b2-112">Component Inclusion Information</span></span>

<span data-ttu-id="101b2-113">O documento componentes de backup contém uma lista desses componentes explicitamente incluídos no backup e na restauração pelo solicitante.</span><span class="sxs-lookup"><span data-stu-id="101b2-113">The Backup Components Document contains a list of those components explicitly included in backup and restore by the requester.</span></span> <span data-ttu-id="101b2-114">A lista contém o seguinte:</span><span class="sxs-lookup"><span data-stu-id="101b2-114">The list contains the following:</span></span>

-   <span data-ttu-id="101b2-115">[*Componentes selecionáveis*](vssgloss-s.md)explicitamente incluídos.</span><span class="sxs-lookup"><span data-stu-id="101b2-115">Explicitly included [*selectable components*](vssgloss-s.md).</span></span>

    <span data-ttu-id="101b2-116">A inclusão desses arquivos em operações de backup é indicada por [**IVssBackupComponents:: addComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) e em operações de restauração por [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span><span class="sxs-lookup"><span data-stu-id="101b2-116">The inclusion of these files in backup operations is indicated by [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) and in restore operations by [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span></span>

-   <span data-ttu-id="101b2-117">Não selecionável para subcomponentes de backup sem selecionável para componente de backup ancestral.</span><span class="sxs-lookup"><span data-stu-id="101b2-117">Nonselectable for backup subcomponents without a selectable for backup component ancestor.</span></span>

    <span data-ttu-id="101b2-118">Todos esses componentes devem ser incluídos se algum componente do gravador for incluído na operação.</span><span class="sxs-lookup"><span data-stu-id="101b2-118">All of these components must be included if any components of the writer are to be included in the operation.</span></span> <span data-ttu-id="101b2-119">A inclusão desses arquivos em operações de backup é indicada por [**IVssBackupComponents:: addComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) e em operações de restauração por [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span><span class="sxs-lookup"><span data-stu-id="101b2-119">The inclusion of these files in backup operations is indicated by [**IVssBackupComponents::AddComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addcomponent) and in restore operations by [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span></span>

-   <span data-ttu-id="101b2-120">Componentes adicionados implicitamente ao backup ([*Subcomponentes*](vssgloss-s.md)) que são [*selecionáveis para restauração*](vssgloss-s.md) e são adicionados explicitamente à restauração.</span><span class="sxs-lookup"><span data-stu-id="101b2-120">Components implicitly added to the backup ([*subcomponents*](vssgloss-s.md)) that are [*selectable for restore*](vssgloss-s.md) and are explicitly added to the restore.</span></span>

    <span data-ttu-id="101b2-121">Esses componentes podem ser selecionáveis ou não selecionáveis, mas têm um ancestral selecionável que foi usado para selecioná-los implicitamente para backup.</span><span class="sxs-lookup"><span data-stu-id="101b2-121">These components may be either selectable or nonselectable, but have a selectable ancestor that was used to implicitly select them for backup.</span></span> <span data-ttu-id="101b2-122">Eles são adicionados ao documento de componentes de backup por [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="101b2-122">They are added to the Backup Components Document by [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span>

<span data-ttu-id="101b2-123">As identidades dos componentes incluídos implicitamente na restauração não são armazenadas no documento componentes de backup.</span><span class="sxs-lookup"><span data-stu-id="101b2-123">The identities of components implicitly included in the restore are not stored in the Backup Components Document.</span></span>

<span data-ttu-id="101b2-124">O VSS tem acesso a informações sobre inclusão de componentes: gravadores sem componentes explicitamente incluídos em uma restauração ou backup não recebem eventos VSS após a geração dos eventos [*PrepareForBackup*](vssgloss-p.md) ou [*prerestore*](vssgloss-p.md) .</span><span class="sxs-lookup"><span data-stu-id="101b2-124">VSS has access to information about component inclusion: writers with no components explicitly included in a restore or backup receive no VSS events following the generation of the [*PrepareForBackup*](vssgloss-p.md) or [*PreRestore*](vssgloss-p.md) events.</span></span>

<span data-ttu-id="101b2-125">Os gravadores não podem consultar essas informações diretamente.</span><span class="sxs-lookup"><span data-stu-id="101b2-125">Writers cannot directly query this information.</span></span> <span data-ttu-id="101b2-126">Essa não é uma limitação significativa porque, por design, os gravadores de VSS individuais não devem exigir informações detalhadas sobre o status de outros gravadores no sistema e, como mencionado acima, aqueles sem componentes incluídos não precisarão participar da operação VSS.</span><span class="sxs-lookup"><span data-stu-id="101b2-126">This is not a significant limitation because by design, individual VSS writers should not require detailed information about the status of other writers on the system and, as noted above, those with no included components will not have to participate in the VSS operation.</span></span>

<span data-ttu-id="101b2-127">Um solicitante pode determinar quais componentes foram explicitamente incluídos em uma operação.</span><span class="sxs-lookup"><span data-stu-id="101b2-127">A requester can determine which components have been explicitly included in an operation.</span></span>

<span data-ttu-id="101b2-128">O método [**IVssBackupComponents:: GetWriterComponentsCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponentscount) retorna o número de gravadores com informações de componente armazenadas no documento de componentes de backup (e não o número de componentes no documento).</span><span class="sxs-lookup"><span data-stu-id="101b2-128">The [**IVssBackupComponents::GetWriterComponentsCount**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponentscount) method returns the number of writers with component information stored in the Backup Components Document (and not the number of components in the document).</span></span>

<span data-ttu-id="101b2-129">O solicitante indexa por meio das informações do gravador armazenado usando [**IVssBackupComponents:: GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents), que retorna instâncias da interface [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) .</span><span class="sxs-lookup"><span data-stu-id="101b2-129">The requester indexes through the stored writer information using [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents), which returns instances of the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface.</span></span> <span data-ttu-id="101b2-130">A interface **IVssWriterComponentsExt** permite que o solicitante obtenha a [*classe do gravador*](vssgloss-w.md) e a [*instância do gravador*](vssgloss-w.md) de escritores participantes, bem como acesse informações sobre aqueles de seus componentes armazenados no documento de componentes de backup.</span><span class="sxs-lookup"><span data-stu-id="101b2-130">The **IVssWriterComponentsExt** interface allows the requester to obtain the [*writer class*](vssgloss-w.md) and [*writer instance*](vssgloss-w.md) of participating writers, as well as to access information about those of its components stored in the Backup Components Document.</span></span>

## <a name="information-on-included-components"></a><span data-ttu-id="101b2-131">Informações sobre os componentes incluídos</span><span class="sxs-lookup"><span data-stu-id="101b2-131">Information on Included Components</span></span>

<span data-ttu-id="101b2-132">A representação do documento dos componentes de backup dos dados do componente (que não inclui informações de especificação de caminho e arquivo), que é acessado por meio de instâncias da interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) .</span><span class="sxs-lookup"><span data-stu-id="101b2-132">The Backup Components Document's representation of the component data (which does not include path and file specification information), which is accessed through instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface.</span></span>

<span data-ttu-id="101b2-133">Os solicitantes e os gravadores obtêm acesso a instâncias da interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) de diferentes maneiras.</span><span class="sxs-lookup"><span data-stu-id="101b2-133">Requesters and writers obtain access to instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface in different ways.</span></span>

<span data-ttu-id="101b2-134">Um solicitante examina os dados do componente em um gravador por gravador usando instâncias da interface [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) retornada por [**IVssBackupComponents:: GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents).</span><span class="sxs-lookup"><span data-stu-id="101b2-134">A requester examines component data on a writer by writer basis by using instances of the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface returned by [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents).</span></span>

<span data-ttu-id="101b2-135">Além das informações de identificação do gravador, a interface [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) fornece uma matriz de instâncias da interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) — uma para cada um dos componentes do gravadores incluídos.</span><span class="sxs-lookup"><span data-stu-id="101b2-135">In addition to the writer identification information, the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface provides an array of instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface—one for each of the selected writers included components.</span></span>

<span data-ttu-id="101b2-136">Conforme observado no [ciclo de vida do documento dos componentes de backup](backup-components-document-life-cycle.md), os gravadores podem obter acesso às mesmas informações por meio da interface [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents) ao manipular o evento PrepareForBackup, PrepareForSnapshot, upsnapshot, BackupComplete, prerestore ou createrestore.</span><span class="sxs-lookup"><span data-stu-id="101b2-136">As noted in [Backup Components Document Life Cycle](backup-components-document-life-cycle.md), the writers can gain access to the same information through the [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents) interface when handling the PrepareForBackup, PrepareForSnapshot, PostSnapshot, BackupComplete, PreRestore, or PostRestore event.</span></span>

<span data-ttu-id="101b2-137">O [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) permite que o gravador e os solicitantes obtenham as seguintes informações:</span><span class="sxs-lookup"><span data-stu-id="101b2-137">[**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) allows both writer and requesters to get the following information:</span></span>

-   <span data-ttu-id="101b2-138">O nome, o tipo e o [*caminho lógico*](vssgloss-l.md) do componente [**(GetComponentName**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponentname), [**getcomponenttype**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponenttype), [**GetLogicalPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getlogicalpath))</span><span class="sxs-lookup"><span data-stu-id="101b2-138">A component's name, type, and [*logical path*](vssgloss-l.md) ([**GetComponentName**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponentname), [**GetComponentType**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getcomponenttype), [**GetLogicalPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getlogicalpath))</span></span>
-   <span data-ttu-id="101b2-139">Como um componente deve ser restaurado conforme indicado pelo [*destino de restauração*](vssgloss-r.md) ([**IVssComponent:: GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget))</span><span class="sxs-lookup"><span data-stu-id="101b2-139">How a component should be restored as indicated by the [*restore target*](vssgloss-r.md) ([**IVssComponent::GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget))</span></span>
-   <span data-ttu-id="101b2-140">Se um local alternativo foi usado na restauração de um arquivo ([**GetAlternateLocationMapping**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmapping), [**GetAlternateLocationMappingCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmappingcount))</span><span class="sxs-lookup"><span data-stu-id="101b2-140">If an alternate location was used in restoring a file ([**GetAlternateLocationMapping**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmapping), [**GetAlternateLocationMappingCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getalternatelocationmappingcount))</span></span>
-   <span data-ttu-id="101b2-141">Novas informações de destino, se houver ([**GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget), [**GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount))</span><span class="sxs-lookup"><span data-stu-id="101b2-141">New target information, if any ([**GetNewTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget), [**GetNewTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtargetcount))</span></span>
-   <span data-ttu-id="101b2-142">Mensagens de erro de pré e pós-restauração ([**GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg), [**GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg))</span><span class="sxs-lookup"><span data-stu-id="101b2-142">Pre-and post-restore error messages ([**GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg), [**GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg))</span></span>
-   <span data-ttu-id="101b2-143">Se uma seleção para o componente [*de backup*](vssgloss-s.md) que define um conjunto de componentes tiver sido selecionada para restauração ([**IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore))</span><span class="sxs-lookup"><span data-stu-id="101b2-143">If a [*selectable for backup*](vssgloss-s.md) component defining a component set has been selected for restore ([**IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore))</span></span>
-   <span data-ttu-id="101b2-144">Se um backup ou restauração foi bem-sucedido ([**GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded), [**GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus))</span><span class="sxs-lookup"><span data-stu-id="101b2-144">Whether a backup or restore succeeded ([**GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded), [**GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus))</span></span>
-   <span data-ttu-id="101b2-145">Qualquer opção de backup ou restauração específica do gravador que possa ter sido definida por [**IVssBackupComponents:: setbackupoptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupoptions) ou [**IVssBackupComponents:: setrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions) ([**getbackupoptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupoptions), [**getrestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions))</span><span class="sxs-lookup"><span data-stu-id="101b2-145">Any writer-specific backup or restore options that may have been set by [**IVssBackupComponents::SetBackupOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupoptions) or [**IVssBackupComponents::SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions) ([**GetBackupOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupoptions), [**GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions))</span></span>
-   <span data-ttu-id="101b2-146">Qualquer backup de metadados específico do gravador ou metadados de restauração ([**GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)), [**GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata))</span><span class="sxs-lookup"><span data-stu-id="101b2-146">Any writer-specific metadata backup or restore metadata ([**GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)), [**GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata))</span></span>
-   <span data-ttu-id="101b2-147">Informações de carimbo de data/hora ([**GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp), [**GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp))</span><span class="sxs-lookup"><span data-stu-id="101b2-147">Time-stamp information ([**GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp), [**GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp))</span></span>
-   <span data-ttu-id="101b2-148">Informações sobre subcomponentes de backup incluídos explicitamente em uma restauração ([**GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent), [**GetRestoreSubcomponentCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponentcount))</span><span class="sxs-lookup"><span data-stu-id="101b2-148">Information about backup subcomponents explicitly included in a restore ([**GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent), [**GetRestoreSubcomponentCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponentcount))</span></span>

<span data-ttu-id="101b2-149">Ao contrário dos solicitantes, os gravadores podem alterar determinadas informações no documento componentes de backup por meio da interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) :</span><span class="sxs-lookup"><span data-stu-id="101b2-149">Unlike requesters, writers can change certain information in the Backup Components Document via the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface:</span></span>

-   <span data-ttu-id="101b2-150">Como um componente deve ser restaurado conforme indicado pelo destino de restauração ([**IVssComponent:: SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget))</span><span class="sxs-lookup"><span data-stu-id="101b2-150">How a component should be restored as indicated by the restore target ([**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget))</span></span>
-   <span data-ttu-id="101b2-151">Metadados de backup e restauração específicos do gravador ([**IVssComponent:: SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata), [**IVssComponent:: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata))</span><span class="sxs-lookup"><span data-stu-id="101b2-151">Writer-specific backup and restore metadata ([**IVssComponent::SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata), [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata))</span></span>
-   <span data-ttu-id="101b2-152">Informações de carimbo de data/hora ([**SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp))</span><span class="sxs-lookup"><span data-stu-id="101b2-152">Time-stamp information ([**SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp))</span></span>
-   <span data-ttu-id="101b2-153">Mensagens de erro de pré e pós-restauração ([**SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg), [**SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg))</span><span class="sxs-lookup"><span data-stu-id="101b2-153">Pre- and post-restore error messages ([**SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg), [**SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg))</span></span>

## <a name="requester-state-information"></a><span data-ttu-id="101b2-154">Informações de estado do solicitante</span><span class="sxs-lookup"><span data-stu-id="101b2-154">Requester State Information</span></span>

<span data-ttu-id="101b2-155">Os solicitantes inserem informações sobre o estado de uma operação de backup ou restauração no documento componentes de backup usando a interface [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) .</span><span class="sxs-lookup"><span data-stu-id="101b2-155">Requesters insert information about the state of a backup or restore operation into the Backup Components Document using the [**IVssBackupComponents**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssbackupcomponents) interface.</span></span> <span data-ttu-id="101b2-156">Aplicativos de gravador são capazes de consultar essas informações por meio da classe [**CVssWriter**](/windows/desktop/api/VsWriter/nl-vswriter-cvsswriter) .</span><span class="sxs-lookup"><span data-stu-id="101b2-156">Writer applications are able to query for this information through the [**CVssWriter**](/windows/desktop/api/VsWriter/nl-vswriter-cvsswriter) class.</span></span>

<span data-ttu-id="101b2-157">As informações de estado armazenadas no documento componentes de backup incluem o seguinte:</span><span class="sxs-lookup"><span data-stu-id="101b2-157">State information stored in the Backup Components Document includes the following:</span></span>

<span data-ttu-id="101b2-158">Informações gerais sobre o backup</span><span class="sxs-lookup"><span data-stu-id="101b2-158">General Information about the Backup</span></span>

-   <span data-ttu-id="101b2-159">O tipo de backup geral (incremental, diferencial ou completo)</span><span class="sxs-lookup"><span data-stu-id="101b2-159">The overall backup type (incremental, differential, or full)</span></span><dl> <dt>

<span data-ttu-id="101b2-160">Definir por solicitantes usando [ **IVssBackupComponents:: setbackupstate**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="101b2-160">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="101b2-161">Recuperados por gravadores usando [ **CVssWriter:: getbackuptype**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getbackuptype)</span><span class="sxs-lookup"><span data-stu-id="101b2-161">Retrieved by writers using [**CVssWriter::GetBackupType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getbackuptype)</span></span>
</dt> </dl>
-   Whether component operations are supported<dl> <dt>

<span data-ttu-id="101b2-162">Definir por solicitantes usando [ **IVssBackupComponents:: setbackupstate**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="101b2-162">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="101b2-163">Recuperados por gravadores usando [ **CVssWriter:: AreComponentsSelected**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-arecomponentsselected)</span><span class="sxs-lookup"><span data-stu-id="101b2-163">Retrieved by writers using [**CVssWriter::AreComponentsSelected**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-arecomponentsselected)</span></span>
</dt> </dl>
-   Whether the bootable system state is backed up<dl> <dt>

<span data-ttu-id="101b2-164">Definir por solicitantes usando [ **IVssBackupComponents:: setbackupstate**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="101b2-164">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="101b2-165">Recuperados por gravadores usando [ **CVssWriter:: IsBootableStateBackedUp**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-isbootablesystemstatebackedup)</span><span class="sxs-lookup"><span data-stu-id="101b2-165">Retrieved by writers using [**CVssWriter::IsBootableStateBackedUp**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-isbootablesystemstatebackedup)</span></span>
</dt> </dl>
-   Whether partial file operations are supported<dl> <dt>

<span data-ttu-id="101b2-166">Definir por solicitantes usando [ **IVssBackupComponents:: setbackupstate**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span><span class="sxs-lookup"><span data-stu-id="101b2-166">Set by requesters using [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate)</span></span>
</dt> <dt>

<span data-ttu-id="101b2-167">Recuperados por gravadores usando [ **CVssWriter:: IsPartialFileSupportEnabled**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispartialfilesupportenabled)</span><span class="sxs-lookup"><span data-stu-id="101b2-167">Retrieved by writers using [**CVssWriter::IsPartialFileSupportEnabled**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispartialfilesupportenabled)</span></span>
</dt> </dl>

<span data-ttu-id="101b2-168">Informações gerais sobre a restauração</span><span class="sxs-lookup"><span data-stu-id="101b2-168">General Information about the Restore</span></span>

-   <span data-ttu-id="101b2-169">O tipo de restauração geral (se a restauração é por cópia ou importação)</span><span class="sxs-lookup"><span data-stu-id="101b2-169">The overall restore type (whether restore is by copy or import)</span></span><dl> <dt>

<span data-ttu-id="101b2-170">Definir por solicitantes usando [ **IVssBackupComponents:: setrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestorestate)</span><span class="sxs-lookup"><span data-stu-id="101b2-170">Set by requesters using [**IVssBackupComponents::SetRestoreState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestorestate)</span></span>
</dt> <dt>

<span data-ttu-id="101b2-171">Recuperados por gravadores usando [ **CVssWriter:: getrestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getrestoretype)</span><span class="sxs-lookup"><span data-stu-id="101b2-171">Retrieved by writers using [**CVssWriter::GetRestoreType**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-getrestoretype)</span></span>
</dt> </dl>

<span data-ttu-id="101b2-172">Informações sobre arquivos de suporte</span><span class="sxs-lookup"><span data-stu-id="101b2-172">Information about Supporting Files</span></span>

-   <span data-ttu-id="101b2-173">O local dos arquivos de intervalos usados por um componente específico em operações de arquivo parcial</span><span class="sxs-lookup"><span data-stu-id="101b2-173">The location of ranges files used by a specific component in partial file operations</span></span><dl> <dt>

<span data-ttu-id="101b2-174">Definir por solicitantes usando [ **IVssBackupComponents:: SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath)</span><span class="sxs-lookup"><span data-stu-id="101b2-174">Set by requesters using [**IVssBackupComponents::SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath)</span></span>
</dt> <dt>

<span data-ttu-id="101b2-175">Recuperados por gravadores (ou solicitantes) usando [ **IVssComponent:: getparcialfile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile)</span><span class="sxs-lookup"><span data-stu-id="101b2-175">Retrieved by writers (or requesters) using [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile)</span></span>
</dt> </dl>

<span data-ttu-id="101b2-176">Status das informações</span><span class="sxs-lookup"><span data-stu-id="101b2-176">Status of Information</span></span>

-   <span data-ttu-id="101b2-177">Indicar se um dos componentes de um determinado gravador foi submetido a backup com êxito</span><span class="sxs-lookup"><span data-stu-id="101b2-177">Indicate whether one of a given writer's components was successfully backed up</span></span><dl> <dt>

<span data-ttu-id="101b2-178">Definir por solicitantes usando [ **IVssBackupComponents:: SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded)</span><span class="sxs-lookup"><span data-stu-id="101b2-178">Set by requesters using [**IVssBackupComponents::SetBackupSucceeded**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupsucceeded)</span></span>
</dt> <dt>

<span data-ttu-id="101b2-179">Recuperados por gravadores e solicitantes usando [ **IVssComponent:: GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded)</span><span class="sxs-lookup"><span data-stu-id="101b2-179">Retrieved by writers and requesters using [**IVssComponent::GetBackupSucceeded**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupsucceeded)</span></span>
</dt> </dl>
-   Indicate whether one of a given writer's components was successfully restored<dl> <dt>

<span data-ttu-id="101b2-180">Definir por solicitantes usando [ **IVssBackupComponents:: SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus)</span><span class="sxs-lookup"><span data-stu-id="101b2-180">Set by requesters using [**IVssBackupComponents::SetFileRestoreStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setfilerestorestatus)</span></span>
</dt> <dt>

<span data-ttu-id="101b2-181">Recuperados por gravadores e solicitante usando [ **IVssComponent:: GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus)</span><span class="sxs-lookup"><span data-stu-id="101b2-181">Retrieved by writers and requester using [**IVssComponent::GetFileRestoreStatus**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getfilerestorestatus)</span></span>
</dt> </dl>

<span data-ttu-id="101b2-182">Informações de Writer-Settable</span><span class="sxs-lookup"><span data-stu-id="101b2-182">Writer-Settable Information</span></span>

-   <span data-ttu-id="101b2-183">Especificação de backup adicional para um dos componentes de um determinado gravador</span><span class="sxs-lookup"><span data-stu-id="101b2-183">Additional backup specification for one of a given writer's components</span></span><dl> <dt>

<span data-ttu-id="101b2-184">Definido por gravadores usando [ **IVssComponent:: SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata)</span><span class="sxs-lookup"><span data-stu-id="101b2-184">Set by writers using [**IVssComponent::SetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupmetadata)</span></span>
</dt> <dt>

<span data-ttu-id="101b2-185">Recuperados por gravadores e solicitantes usando [ **IVssComponent:: GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)</span><span class="sxs-lookup"><span data-stu-id="101b2-185">Retrieved by writers and requesters using [**IVssComponent::GetBackupMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupmetadata)</span></span>
</dt> </dl>
-   Additional restore specification for one of a given writer's components<dl> <dt>

<span data-ttu-id="101b2-186">Definido por gravadores usando [ **IVssComponent:: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata)</span><span class="sxs-lookup"><span data-stu-id="101b2-186">Set by writers using [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata)</span></span>
</dt> <dt>

<span data-ttu-id="101b2-187">Recuperados por gravadores e solicitantes usando [ **IVssComponent:: GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata)</span><span class="sxs-lookup"><span data-stu-id="101b2-187">Retrieved by writers and requesters using [**IVssComponent::GetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoremetadata)</span></span>
</dt> </dl>
-   A backup stamp that indicates, in a writer's own specific format, the time of the current backup of one of its component's backups<dl> <dt>

<span data-ttu-id="101b2-188">Definido por gravadores usando [ **IVssComponent:: SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="101b2-188">Set by writers using [**IVssComponent::SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp)</span></span>
</dt> <dt>

<span data-ttu-id="101b2-189">Recuperados por gravadores e solicitantes usando [ **IVssComponent:: GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="101b2-189">Retrieved by writers and requesters using [**IVssComponent::GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp)</span></span>
<span data-ttu-id="101b2-190"></dt> </dl>
-   A backup stamp that indicates, in a writer's own specific format, the time of the last backup of one of its components' backups using a backup stamp initially set by <a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp">IVssComponent::SetBackupStamp</a></span><span class="sxs-lookup"><span data-stu-id="101b2-190"></dt> </dl>
-   A backup stamp that indicates, in a writer's own specific format, the time of the last backup of one of its components' backups using a backup stamp initially set by <a href="/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp">IVssComponent::SetBackupStamp</a></span></span><dl> <dt>

<span data-ttu-id="101b2-191">Armazenados e definidos por solicitantes para um componente específico usando [ **IVssBackupComponents:: SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="101b2-191">Stored and set by requesters for a specific component using [**IVssBackupComponents::SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp)</span></span>
</dt> <dt>

<span data-ttu-id="101b2-192">Recuperados por gravadores e solicitantes usando [ **IVssComponent:: GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="101b2-192">Retrieved by writers and requesters using [**IVssComponent::GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp)</span></span>
</dt> </dl>
-   Error messages for failure before and after restore operations<dl> <dt>

<span data-ttu-id="101b2-193">Definido por gravadores usando [**IVssComponent:: SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg) ou [**IVssComponent:: SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg)</span><span class="sxs-lookup"><span data-stu-id="101b2-193">Set by writers using [**IVssComponent::SetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setprerestorefailuremsg) or [**IVssComponent::SetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setpostrestorefailuremsg)</span></span>
</dt> <dt>

<span data-ttu-id="101b2-194">Recuperados por gravadores e solicitantes usando [**IVssComponent:: GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg) ou [**IVssComponent:: GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg)</span><span class="sxs-lookup"><span data-stu-id="101b2-194">Retrieved by writers and requesters using [**IVssComponent::GetPreRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getprerestorefailuremsg) or [**IVssComponent::GetPostRestoreFailureMsg**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpostrestorefailuremsg)</span></span>
</dt> </dl>

 

 
