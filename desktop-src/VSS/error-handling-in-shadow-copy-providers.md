---
description: 'O VSS permite que muitas cópias de sombra existam de uma só vez, mas permite que uma criação de conjunto de cópias de sombra esteja em andamento entre a chamada para IVssBackupComponents:: StartSnapshotSet e o retorno da chamada para IVssBackupComponents::D oSnapshotSet.'
ms.assetid: 26657fc2-180f-4ebb-820c-2159e7fe7584
title: Tratamento de erro em provedores de cópia de sombra
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f5f040526f63a0fe57fc5a49ac903e8b60b76646
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2021
ms.locfileid: "105751397"
---
# <a name="error-handling-in-shadow-copy-providers"></a><span data-ttu-id="3c46a-103">Tratamento de erro em provedores de cópia de sombra</span><span class="sxs-lookup"><span data-stu-id="3c46a-103">Error Handling in Shadow Copy Providers</span></span>

<span data-ttu-id="3c46a-104">O VSS permite que muitas cópias de sombra existam de uma só vez, mas permite que uma criação de conjunto de cópias de sombra esteja em andamento entre a chamada para [**IVssBackupComponents:: StartSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset) e o retorno da chamada para [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="3c46a-104">VSS allows many shadow copies to exist at once, but it only allows one shadow copy set creation to be in-progress between the call to [**IVssBackupComponents::StartSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset) and the return from the call to [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span>

## <a name="no-partial-commit"></a><span data-ttu-id="3c46a-105">Nenhuma confirmação parcial</span><span class="sxs-lookup"><span data-stu-id="3c46a-105">No Partial Commit</span></span>

<span data-ttu-id="3c46a-106">Se qualquer provedor falhar em uma cópia de sombra em qualquer volume ou LUN no conjunto de cópias de sombra, a criação do conjunto de cópias de sombra inteiro falhará.</span><span class="sxs-lookup"><span data-stu-id="3c46a-106">If any provider fails a shadow copy on any volume or LUN in the shadow copy set, then the creation of the entire shadow copy set fails.</span></span> <span data-ttu-id="3c46a-107">Isso ocorre por design.</span><span class="sxs-lookup"><span data-stu-id="3c46a-107">This is by design.</span></span> <span data-ttu-id="3c46a-108">Esse design simplifica os problemas comportamentais associados à semântica de falha parcial e mantém um ponto no tempo consistente em todas as cópias de sombra do conjunto.</span><span class="sxs-lookup"><span data-stu-id="3c46a-108">This design simplifies the behavioral issues associated with partial failure semantics and maintains a consistent point-in-time across all shadow copies in the set.</span></span>

## <a name="reporting-fault-conditions"></a><span data-ttu-id="3c46a-109">Condições de falha de relatório</span><span class="sxs-lookup"><span data-stu-id="3c46a-109">Reporting Fault Conditions</span></span>

<span data-ttu-id="3c46a-110">Se ocorrer um erro do provedor ou uma condição de falha, o provedor deverá registrar um erro no log de eventos do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="3c46a-110">If a provider error or fault condition occurs, the provider must log an error to the Application event log.</span></span> <span data-ttu-id="3c46a-111">Isso inclui, mas não se limita a, quaisquer erros específicos de provedor ao criar ou importar um conjunto de cópias de sombra ou falha de alocação de recursos para cópia de sombra de cópia em gravação após a criação.</span><span class="sxs-lookup"><span data-stu-id="3c46a-111">This includes, but is not limited to, any provider-specific errors when creating or importing a Shadow Copy Set, or resource allocation failure for copy-on-write shadow copy after creation.</span></span> <span data-ttu-id="3c46a-112">Esse log não deve ocorrer durante o tempo em que os volumes no conjunto de cópias de sombra estão em um estado congelado.</span><span class="sxs-lookup"><span data-stu-id="3c46a-112">This logging must not take place during the time the volumes in the shadow copy set are in a frozen state.</span></span>

## <a name="valid-provider-return-values"></a><span data-ttu-id="3c46a-113">Valores de retorno de provedor válidos</span><span class="sxs-lookup"><span data-stu-id="3c46a-113">Valid Provider Return Values</span></span>

<span data-ttu-id="3c46a-114">A tabela a seguir lista os códigos de retorno válidos para métodos de provedor e seus significados.</span><span class="sxs-lookup"><span data-stu-id="3c46a-114">The following table lists the valid return codes for provider methods and their meanings.</span></span>



| <span data-ttu-id="3c46a-115">Valor</span><span class="sxs-lookup"><span data-stu-id="3c46a-115">Value</span></span>                                                                                                                                                                              | <span data-ttu-id="3c46a-116">Descrição</span><span class="sxs-lookup"><span data-stu-id="3c46a-116">Description</span></span>                                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="3c46a-117"><span id="S_OK"></span><span id="s_ok"></span>S \_ OK</span><span class="sxs-lookup"><span data-stu-id="3c46a-117"><span id="S_OK"></span><span id="s_ok"></span>S\_OK</span></span><br/>                                                                                                                     | <span data-ttu-id="3c46a-118">O método foi bem-sucedido.</span><span class="sxs-lookup"><span data-stu-id="3c46a-118">The method was successful.</span></span><br/>                                                                                                                                                                                                                  |
| <span data-ttu-id="3c46a-119"><span id="E_OUTOFMEMORY"></span><span id="e_outofmemory"></span>E \_ OUTOFMEMORY</span><span class="sxs-lookup"><span data-stu-id="3c46a-119"><span id="E_OUTOFMEMORY"></span><span id="e_outofmemory"></span>E\_OUTOFMEMORY</span></span><br/>                                                                                          | <span data-ttu-id="3c46a-120">O provedor está sem memória ou outros recursos do sistema.</span><span class="sxs-lookup"><span data-stu-id="3c46a-120">The provider is out of memory or other system resources.</span></span><br/>                                                                                                                                                                                    |
| <span data-ttu-id="3c46a-121"><span id="E_INVALIDARG"></span><span id="e_invalidarg"></span>E \_ INVALIDARG</span><span class="sxs-lookup"><span data-stu-id="3c46a-121"><span id="E_INVALIDARG"></span><span id="e_invalidarg"></span>E\_INVALIDARG</span></span><br/>                                                                                             | <span data-ttu-id="3c46a-122">Um dos valores de parâmetro não é válido.</span><span class="sxs-lookup"><span data-stu-id="3c46a-122">One of the parameter values is not valid.</span></span><br/>                                                                                                                                                                                                   |
| <span data-ttu-id="3c46a-123"><span id="E_ACCESSDENIED"></span><span id="e_accessdenied"></span>E \_ ACCESSDENIED</span><span class="sxs-lookup"><span data-stu-id="3c46a-123"><span id="E_ACCESSDENIED"></span><span id="e_accessdenied"></span>E\_ACCESSDENIED</span></span><br/>                                                                                       | <span data-ttu-id="3c46a-124">Um cliente sem privilégios tentou chamar o provedor.</span><span class="sxs-lookup"><span data-stu-id="3c46a-124">A non-privileged client has tried to call into the provider.</span></span><br/>                                                                                                                                                                                |
| <span data-ttu-id="3c46a-125"><span id="VSS_E_BAD_STATE"></span><span id="vss_e_bad_state"></span>VSS \_ E \_ estado inadequado \_</span><span class="sxs-lookup"><span data-stu-id="3c46a-125"><span id="VSS_E_BAD_STATE"></span><span id="vss_e_bad_state"></span>VSS\_E\_BAD\_STATE</span></span><br/>                                                                                  | <span data-ttu-id="3c46a-126">Nenhum provedor dá suporte à operação solicitada ou a operação não pode ser executada no objeto porque o objeto não está no estado correto.</span><span class="sxs-lookup"><span data-stu-id="3c46a-126">Either no provider supports the requested operation, or the operation cannot be performed on the object because the object is not in the correct state.</span></span><br/>                                                                                     |
| <span data-ttu-id="3c46a-127"><span id="VSS_E_OBJECT_NOT_FOUND"></span><span id="vss_e_object_not_found"></span>\_objeto VSS \_ E \_ não \_ encontrado</span><span class="sxs-lookup"><span data-stu-id="3c46a-127"><span id="VSS_E_OBJECT_NOT_FOUND"></span><span id="vss_e_object_not_found"></span>VSS\_E\_OBJECT\_NOT\_FOUND</span></span><br/>                                                            | <span data-ttu-id="3c46a-128">Um parâmetro refere-se a um objeto que não foi encontrado (como uma ID de cópia de sombra, ID de conjunto de cópias de sombra ou volume.)</span><span class="sxs-lookup"><span data-stu-id="3c46a-128">A parameter refers to an object that was not found (such as a shadow copy ID, shadow copy set ID, or volume.)</span></span><br/>                                                                                                                               |
| <span data-ttu-id="3c46a-129"><span id="VSS_E_INSUFFICIENT_STORAGE"></span><span id="vss_e_insufficient_storage"></span>VSS \_ E \_ armazenamento insuficiente \_</span><span class="sxs-lookup"><span data-stu-id="3c46a-129"><span id="VSS_E_INSUFFICIENT_STORAGE"></span><span id="vss_e_insufficient_storage"></span>VSS\_E\_INSUFFICIENT\_STORAGE</span></span><br/>                                                 | <span data-ttu-id="3c46a-130">O provedor não pode executar a operação porque não há espaço em disco suficiente.</span><span class="sxs-lookup"><span data-stu-id="3c46a-130">The provider cannot perform the operation because there is not enough disk space.</span></span><br/>                                                                                                                                                           |
| <span data-ttu-id="3c46a-131"><span id="VSS_E_VOLUME_NOT_SUPPORTED"></span><span id="vss_e_volume_not_supported"></span>VSS \_ E \_ volume \_ sem \_ suporte</span><span class="sxs-lookup"><span data-stu-id="3c46a-131"><span id="VSS_E_VOLUME_NOT_SUPPORTED"></span><span id="vss_e_volume_not_supported"></span>VSS\_E\_VOLUME\_NOT\_SUPPORTED</span></span><br/>                                                | <span data-ttu-id="3c46a-132">Nenhum provedor neste computador dá suporte à operação solicitada no volume.</span><span class="sxs-lookup"><span data-stu-id="3c46a-132">No provider on this computer supports the requested operation on the volume.</span></span><br/>                                                                                                                                                                |
| <span data-ttu-id="3c46a-133"><span id="VSS_E_VOLUME_NOT_SUPPORTED_BY_PROVIDER"></span><span id="vss_e_volume_not_supported_by_provider"></span>VSS \_ E \_ volume \_ sem \_ suporte \_ do \_ provedor</span><span class="sxs-lookup"><span data-stu-id="3c46a-133"><span id="VSS_E_VOLUME_NOT_SUPPORTED_BY_PROVIDER"></span><span id="vss_e_volume_not_supported_by_provider"></span>VSS\_E\_VOLUME\_NOT\_SUPPORTED\_BY\_PROVIDER</span></span><br/>          | <span data-ttu-id="3c46a-134">O provedor não oferece suporte ao volume.</span><span class="sxs-lookup"><span data-stu-id="3c46a-134">The provider does not support the volume.</span></span><br/>                                                                                                                                                                                                   |
| <span data-ttu-id="3c46a-135"><span id="VSS_E_MAXIMUM_NUMBER_OF_SNAPSHOTS_REACHED"></span><span id="vss_e_maximum_number_of_snapshots_reached"></span>VSS \_ E \_ \_ número máximo \_ de \_ instantâneos \_ atingidos</span><span class="sxs-lookup"><span data-stu-id="3c46a-135"><span id="VSS_E_MAXIMUM_NUMBER_OF_SNAPSHOTS_REACHED"></span><span id="vss_e_maximum_number_of_snapshots_reached"></span>VSS\_E\_MAXIMUM\_NUMBER\_OF\_SNAPSHOTS\_REACHED</span></span><br/> | <span data-ttu-id="3c46a-136">O provedor atingiu o número máximo de cópias de sombra que ele pode dar suporte.</span><span class="sxs-lookup"><span data-stu-id="3c46a-136">The provider has reached the maximum number of shadow copies that it can support.</span></span><br/>                                                                                                                                                           |
| <span data-ttu-id="3c46a-137"><span id="VSS_E_PROVIDER_VETO"></span><span id="vss_e_provider_veto"></span>\_veto do \_ provedor \_ E do VSS</span><span class="sxs-lookup"><span data-stu-id="3c46a-137"><span id="VSS_E_PROVIDER_VETO"></span><span id="vss_e_provider_veto"></span>VSS\_E\_PROVIDER\_VETO</span></span><br/>                                                                      | <span data-ttu-id="3c46a-138">O provedor encontrou um erro de tempo de execução interno que não é mapeado para outro valor de retorno.</span><span class="sxs-lookup"><span data-stu-id="3c46a-138">The provider has encountered an internal run-time error that does not map to another return value.</span></span> <span data-ttu-id="3c46a-139">O provedor também deve gravar um evento no log de eventos do aplicativo, fornecendo ao usuário informações sobre como resolver esse problema.</span><span class="sxs-lookup"><span data-stu-id="3c46a-139">The provider must also write an event into the Application event log providing the user with information on how to resolve this problem.</span></span><br/> |
| <span data-ttu-id="3c46a-140"><span id="VSS_E_CANNOT_REVERT_DISKID"></span><span id="vss_e_cannot_revert_diskid"></span>VSS \_ E \_ não é possível \_ reverter \_ DiskId</span><span class="sxs-lookup"><span data-stu-id="3c46a-140"><span id="VSS_E_CANNOT_REVERT_DISKID"></span><span id="vss_e_cannot_revert_diskid"></span>VSS\_E\_CANNOT\_REVERT\_DISKID</span></span><br/>                                                | <span data-ttu-id="3c46a-141">A assinatura MBR ou a ID GPT para um ou mais discos não pôde ser definida para o valor solicitado.</span><span class="sxs-lookup"><span data-stu-id="3c46a-141">The MBR signature or GPT ID for one or more disks could not be set to the requested value.</span></span> <span data-ttu-id="3c46a-142">Verifique o log de eventos do aplicativo para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="3c46a-142">Check the Application event log for more information.</span></span><br/>                                                                                            |



 

<span data-ttu-id="3c46a-143">O provedor não deve tentar retornar nenhum outro código de erro.</span><span class="sxs-lookup"><span data-stu-id="3c46a-143">The provider should not attempt to return any other error codes.</span></span>

<span data-ttu-id="3c46a-144">Se o provedor retornar um código de erro que não seja esperado (por exemplo, **S \_ false**, **\_ falhar**, **e \_ inesperado** ou **e \_ abortar**), o VSS gravará um evento no log de eventos mencionando o provedor e o método com falha e converterá o erro para o **VSS \_ E o \_ \_ \_ erro do provedor inesperado** antes de retornar ao solicitante.</span><span class="sxs-lookup"><span data-stu-id="3c46a-144">If the provider returns an error code that is not expected (for example **S\_FALSE**, **E\_FAIL**, **E\_UNEXPECTED**, or **E\_ABORT**), VSS writes an event into the event log mentioning the provider and failed method and translates the error to **VSS\_E\_UNEXPECTED\_PROVIDER\_ERROR** before returning to the requester.</span></span> <span data-ttu-id="3c46a-145">Isso não é feito para nenhum retorno de [**IVssProviderCreateSnapshotSet:: AbortSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-abortsnapshots) ou [**IVssProviderNotifications:: OnUnload**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidernotifications-onunload).</span><span class="sxs-lookup"><span data-stu-id="3c46a-145">This is not done for any returns from [**IVssProviderCreateSnapshotSet::AbortSnapshots**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-abortsnapshots) or [**IVssProviderNotifications::OnUnload**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidernotifications-onunload).</span></span>

 

 




