---
description: 'A participação de um gravador em backups incrementais e diferenciais normalmente ocorre durante o tratamento de eventos de identificação (CVssWriter:: onidentification), PrepareForBackup (CVssWriter: OnPrepareBackup) e de upsnapshot (CVssWriter: OnPostSnapshot).'
ms.assetid: 85c4e003-b531-4283-83aa-dd5cc53f35b1
title: Função de gravador em backups incrementais e diferenciais do VSS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f2cda57d907bed4572f0c0f71f9ee829bee18299
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104501723"
---
# <a name="writer-role-in-vss-incremental-and-differential-backups"></a><span data-ttu-id="5d9bc-103">Função de gravador em backups incrementais e diferenciais do VSS</span><span class="sxs-lookup"><span data-stu-id="5d9bc-103">Writer Role in VSS Incremental and Differential Backups</span></span>

<span data-ttu-id="5d9bc-104">A participação de um gravador em backups incrementais e diferenciais normalmente ocorre durante o tratamento de eventos de [*identificação*](vssgloss-i.md) ([**CVssWriter:: onidentification**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify)), [*PrepareForBackup*](vssgloss-p.md) ([**CVssWriter: OnPrepareBackup**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpreparebackup)) e de *upsnapshot* ([**CVssWriter: OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot)).</span><span class="sxs-lookup"><span data-stu-id="5d9bc-104">A writer's participation in incremental and differential backups typically takes place while handling [*Identify*](vssgloss-i.md) ([**CVssWriter::OnIdentify**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onidentify)), [*PrepareForBackup*](vssgloss-p.md) ([**CVssWriter:OnPrepareBackup**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpreparebackup)), and *PostSnapshot* ([**CVssWriter:OnPostSnapshot**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostsnapshot)) events.</span></span> <span data-ttu-id="5d9bc-105">A forma como um gravador participa é moldado se ele dá suporte a carimbos de backup e horários da última modificação e se o solicitante que executa o backup dá suporte a [*operações parciais de arquivo*](vssgloss-p.md).</span><span class="sxs-lookup"><span data-stu-id="5d9bc-105">How a writer participates is shaped by whether it supports backup stamps and last modification times, and whether the requester running the backup supports [*partial file operations*](vssgloss-p.md).</span></span>

## <a name="handling-identify-events-during-incremental-and-differential-backups"></a><span data-ttu-id="5d9bc-106">Tratamento de eventos de identificação durante backups incrementais e diferenciais</span><span class="sxs-lookup"><span data-stu-id="5d9bc-106">Handling Identify Events during Incremental and Differential Backups</span></span>

<span data-ttu-id="5d9bc-107">Ao manipular o evento de identificação, os gravadores estabelecem sua arquitetura básica para a operação de backup incremental e diferencial por meio do esquema de backup ([**\_ \_ esquema de backup do VSS**](/windows/desktop/api/Vss/ne-vss-vss_backup_schema)) e de tipos de backup de especificação de arquivo (tipo de backup de especificação de [**\_ arquivo \_ \_ \_ VSS**](/windows/desktop/api/Vss/ne-vss-vss_file_spec_backup_type)).</span><span class="sxs-lookup"><span data-stu-id="5d9bc-107">While handling the Identify event, writers establish their basic architecture for incremental and differential backup operation through the backup schema ([**VSS\_BACKUP\_SCHEMA**](/windows/desktop/api/Vss/ne-vss-vss_backup_schema)) and file specification backup type ([**VSS\_FILE\_SPEC\_BACKUP\_TYPE**](/windows/desktop/api/Vss/ne-vss-vss_file_spec_backup_type)) masks.</span></span>

<span data-ttu-id="5d9bc-108">Um gravador indica a quais operações ele dá suporte em seu documento de metadados do gravador criando uma máscara de bits de valores de [**\_ \_ esquema de backup do VSS**](/windows/desktop/api/Vss/ne-vss-vss_backup_schema) e passando-a para o método [**IVssCreateWriterMetadata:: SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema) .</span><span class="sxs-lookup"><span data-stu-id="5d9bc-108">A writer indicates which operations it supports in its Writer Metadata Document by creating a bit mask of [**VSS\_BACKUP\_SCHEMA**](/windows/desktop/api/Vss/ne-vss-vss_backup_schema) values and passing it to the [**IVssCreateWriterMetadata::SetBackupSchema**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema) method.</span></span> <span data-ttu-id="5d9bc-109">Com isso, um gravador pode indicar se ele oferece suporte ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="5d9bc-109">With this, a writer can indicate whether it supports the following:</span></span>

-   <span data-ttu-id="5d9bc-110">Backups incrementais (**\_ \_ incremental do VSS BS**)</span><span class="sxs-lookup"><span data-stu-id="5d9bc-110">Incremental backups (**VSS\_BS\_INCREMENTAL**)</span></span>
-   <span data-ttu-id="5d9bc-111">Backups diferenciais (**\_ \_ diferencial do VSS BS**)</span><span class="sxs-lookup"><span data-stu-id="5d9bc-111">Differential backups (**VSS\_BS\_DIFFERENTIAL**)</span></span>
-   <span data-ttu-id="5d9bc-112">Backups incrementais e diferenciais não podem ser misturados (**\_ \_ \_ \_ diferenciais incrementais exclusivos do VSS BS**)</span><span class="sxs-lookup"><span data-stu-id="5d9bc-112">Incremental and differential backups cannot be mixed (**VSS\_BS\_EXCLUSIVE\_INCREMENTAL\_DIFFERENTIAL**)</span></span>
-   <span data-ttu-id="5d9bc-113">Backups incrementais e diferenciais usando carimbos de backup (**\_ carimbo de data/ \_ hora VSS BS**)</span><span class="sxs-lookup"><span data-stu-id="5d9bc-113">Incremental and differential backups using backup stamps (**VSS\_BS\_TIMESTAMPED**)</span></span>
-   <span data-ttu-id="5d9bc-114">Backups incrementais e diferenciais com base nas informações sobre a última modificação de um arquivo (o **VSS \_ BS \_ última \_** modificação)</span><span class="sxs-lookup"><span data-stu-id="5d9bc-114">Incremental and differential backups on the basis of information about a file's last modification (**VSS\_BS\_LAST\_MODIFY**)</span></span>

<span data-ttu-id="5d9bc-115">Os gravadores usam a máscara de tipo de backup de especificação de arquivo para fornecer informações de nível de conjunto de arquivos aos solicitantes sobre como incluir arquivos em um backup incremental ou diferencial.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-115">Writers use the file specification backup type mask to provide file set level information to requesters on how to include files in an incremental or differential backup.</span></span>

<span data-ttu-id="5d9bc-116">Um gravador pode definir uma máscara de tipo de backup de especificação de arquivo de um conjunto de arquivos ao adicionar o conjunto de arquivos a um componente criando uma máscara de bits de valores de [**\_ \_ \_ \_ tipo de backup**](/windows/desktop/api/Vss/ne-vss-vss_file_spec_backup_type) de especificação de arquivo do VSS e passando-o para [**IVssCreateWriterMetadata:: AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata:: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles)ou [**IVssCreateWriterMetadata:: AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup).</span><span class="sxs-lookup"><span data-stu-id="5d9bc-116">A writer can set a file set's file specification backup type mask when it adds the file set to a component by creating a bit mask of [**VSS\_FILE\_SPEC\_BACKUP\_TYPE**](/windows/desktop/api/Vss/ne-vss-vss_file_spec_backup_type) values and passing it to [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles), or [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup).</span></span>

<span data-ttu-id="5d9bc-117">Há três valores de "backup necessário" da enumeração [**de \_ \_ tipo de \_ backup \_ de especificação de arquivo do VSS**](/windows/desktop/api/Vss/ne-vss-vss_file_spec_backup_type) que afetam os backups diferenciais e incrementais:</span><span class="sxs-lookup"><span data-stu-id="5d9bc-117">There are three "backup required" values of the [**VSS\_FILE\_SPEC\_BACKUP\_TYPE**](/windows/desktop/api/Vss/ne-vss-vss_file_spec_backup_type) enumeration that affect differential and incremental backups:</span></span>

-   <span data-ttu-id="5d9bc-118">**BACKUP do VSS \_ FSBT \_ todo \_ \_ necessário**</span><span class="sxs-lookup"><span data-stu-id="5d9bc-118">**VSS\_FSBT\_ALL\_BACKUP\_REQUIRED**</span></span>
-   <span data-ttu-id="5d9bc-119">**\_backup incremental do VSS FSBT \_ \_ \_ necessário**</span><span class="sxs-lookup"><span data-stu-id="5d9bc-119">**VSS\_FSBT\_INCREMENTAL\_BACKUP\_REQUIRED**</span></span>
-   <span data-ttu-id="5d9bc-120">**\_ \_ backup diferencial do VSS FSBT \_ \_ necessário**</span><span class="sxs-lookup"><span data-stu-id="5d9bc-120">**VSS\_FSBT\_DIFFERENTIAL\_BACKUP\_REQUIRED**</span></span>

<span data-ttu-id="5d9bc-121">Há três valores de "cópia de sombra obrigatórias":</span><span class="sxs-lookup"><span data-stu-id="5d9bc-121">There are three "shadow copy required" values:</span></span>

-   <span data-ttu-id="5d9bc-122">**\_FSBT VSS \_ todos os \_ instantâneos \_ necessários**</span><span class="sxs-lookup"><span data-stu-id="5d9bc-122">**VSS\_FSBT\_ALL\_SNAPSHOT\_REQUIRED**</span></span>
-   <span data-ttu-id="5d9bc-123">**\_instantâneo incremental do VSS FSBT \_ \_ \_ necessário**</span><span class="sxs-lookup"><span data-stu-id="5d9bc-123">**VSS\_FSBT\_INCREMENTAL\_SNAPSHOT\_REQUIRED**</span></span>
-   <span data-ttu-id="5d9bc-124">**\_ \_ instantâneo diferencial do VSS FSBT \_ \_ necessário**</span><span class="sxs-lookup"><span data-stu-id="5d9bc-124">**VSS\_FSBT\_DIFFERENTIAL\_SNAPSHOT\_REQUIRED**</span></span>

<span data-ttu-id="5d9bc-125">Conjuntos de arquivos marcados com um tipo de backup de especificação de arquivo de "cópia de sombra necessária" indicam se um solicitante precisa copiar dados de uma cópia de sombra ao executar as operações de backup INCREMENTAL, DIFERENCIAl ou tudo (que inclui operações incrementais e diferenciais).</span><span class="sxs-lookup"><span data-stu-id="5d9bc-125">File sets tagged with a file specification backup type of "shadow copy required" indicate whether a requester needs to copy data from a shadow copy when performing INCREMENTAL, DIFFERENTIAL, or ALL (which includes both incremental and differential operations) backup operations.</span></span>

<span data-ttu-id="5d9bc-126">O sinalizador "backup necessário", aplicado a operações INCREMENTAis, DIFERENCIAis ou de backup, indica que o gravador espera que uma cópia da versão atual do conjunto de arquivos esteja disponível após a restauração de qualquer operação de backup.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-126">The "backup required" flag, applied to INCREMENTAL, DIFFERENTIAL, or ALL backup operations, indicates that the writer expects a copy of the current version of the file set to be available following the restore of any backup operation.</span></span> <span data-ttu-id="5d9bc-127">Normalmente, isso significa que, se um conjunto de arquivos for marcado com "backup necessário", todos os seus membros serão copiados para a mídia de backup durante um backup incremental ou diferencial, independentemente de quando o backup ou a modificação tiver ocorrido pela última vez.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-127">Typically, this means that if a file set is tagged with "backup required," all its members will be copied to backup media during an incremental or differential backup, regardless of when their backup or modification last occurred.</span></span>

<span data-ttu-id="5d9bc-128">Por padrão, os conjuntos de arquivos são adicionados aos componentes com um tipo de backup de especificação de arquivo de **VSS \_ FSBT \_ todos os \_ backups \_ necessários** \| **VSS \_ FSBT \_ todo o \_ instantâneo \_ necessário**.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-128">By default, file sets are added to components with a file specification backup type of **VSS\_FSBT\_ALL\_BACKUP\_REQUIRED** \| **VSS\_FSBT\_ALL\_SNAPSHOT\_REQUIRED**.</span></span> <span data-ttu-id="5d9bc-129">Portanto, a menos que um desenvolvedor de escritor decida não usar o padrão (escolhendo outro tipo de backup de especificação de arquivo, usando operações parciais de arquivo ou usando arquivos diferenciados), os arquivos na maioria dos conjuntos de arquivos serão normalmente copiados em sua totalidade para mídia de backup.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-129">Therefore, unless a writer developer decides not to use the default (by choosing another file specification backup type, using partial file operations, or using differenced files), the files in most file sets will typically be copied in their entirety to backup media.</span></span>

<span data-ttu-id="5d9bc-130">Neste ponto, o documento de metadados do gravador do gravador é totalmente preenchido com a maioria das informações que um solicitante precisará para iniciar um backup diferencial ou incremental.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-130">At this point, the writer's Writer Metadata Document is fully populated with most of information a requester will need to start a differential or incremental backup.</span></span> <span data-ttu-id="5d9bc-131">A especificação de adição do conjunto de arquivos ou das informações de nível de arquivo para dar suporte ao backup será tratada durante o evento [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) .</span><span class="sxs-lookup"><span data-stu-id="5d9bc-131">Addition specification of file set or file level information to support the backup will be handled during the [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) event.</span></span>

## <a name="handling-prepareforbackup-events-during-incremental-and-differential-backups"></a><span data-ttu-id="5d9bc-132">Manipulando eventos PrepareForBackup durante backups incrementais e diferenciais</span><span class="sxs-lookup"><span data-stu-id="5d9bc-132">Handling PrepareForBackup Events during Incremental and Differential Backups</span></span>

<span data-ttu-id="5d9bc-133">Antes que o solicitante continue com a operação de backup real, os gravadores podem modificar a especificação de um backup [*incremental*](vssgloss-i.md) ou [*diferencial*](vssgloss-d.md) alterando o documento de componentes de backup do solicitante por meio da interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) .</span><span class="sxs-lookup"><span data-stu-id="5d9bc-133">Before the requester proceeds with the actual backup operation, writers can modify the specification of an [*incremental*](vssgloss-i.md) or [*differential*](vssgloss-d.md) backup by altering the requester's Backup Components Document through the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface.</span></span>

<span data-ttu-id="5d9bc-134">Como os gravadores usam a interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) , normalmente executam essas preparações ao manipular o evento [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) .</span><span class="sxs-lookup"><span data-stu-id="5d9bc-134">Because the writers use the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface, they typically perform these preparations while handling the [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) event.</span></span>

<span data-ttu-id="5d9bc-135">Em [**CVssWriter: OnPrepareBackup**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpreparebackup), os gravadores podem especificar com mais precisão como alguns arquivos serão avaliados para backup, especificar quais mecanismos devem ser usados para fazer backup deles e possivelmente definir carimbos de backup.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-135">In [**CVssWriter:OnPrepareBackup**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpreparebackup), writers can more precisely specify how some files are to be evaluated for backup, specify what mechanisms should be used in backing them up, and possibly set backup stamps.</span></span>

<dl> <dt>

<span data-ttu-id="5d9bc-136"><span id="Partial_Files"></span><span id="partial_files"></span><span id="PARTIAL_FILES"></span>Arquivos parciais</span><span class="sxs-lookup"><span data-stu-id="5d9bc-136"><span id="Partial_Files"></span><span id="partial_files"></span><span id="PARTIAL_FILES"></span>Partial Files</span></span>
</dt> <dd>

<span data-ttu-id="5d9bc-137">Se um solicitante oferecer suporte a eles, um gravador poderá optar por ter um backup incremental ou diferencial implementado usando operações de arquivo parcial.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-137">If a requester supports them, a writer can choose to have an incremental or differential backup implemented by using partial file operations.</span></span> <span data-ttu-id="5d9bc-138">(Os gravadores podem determinar se um solicitante dá suporte a operações parciais de arquivo chamando [**CVssWriter:: IsPartialFileSupportEnabled**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispartialfilesupportenabled).)</span><span class="sxs-lookup"><span data-stu-id="5d9bc-138">(Writers can determine if a requester supports partial file operations by calling [**CVssWriter::IsPartialFileSupportEnabled**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-ispartialfilesupportenabled).)</span></span>

<span data-ttu-id="5d9bc-139">Os gravadores usam [**IVssComponent:: Addparcialfile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) para indicar as partes dos arquivos selecionados cujo backup será feito durante a operação incremental ou diferencial.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-139">Writers use [**IVssComponent::AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile) to indicate those portions of the selected files to be backed up during the incremental or differential operation.</span></span> <span data-ttu-id="5d9bc-140">Os solicitantes devem respeitar essa especificação e sempre devem fazer backup das seções especificadas dos arquivos.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-140">Requesters must respect this specification, and must always back up the specified sections of the files.</span></span> <span data-ttu-id="5d9bc-141">(Consulte [trabalhando com arquivos parciais](working-with-partial-files.md) para obter mais informações sobre operações de arquivo parcial.)</span><span class="sxs-lookup"><span data-stu-id="5d9bc-141">(See [Working with Partial Files](working-with-partial-files.md) for more information on partial file operations.)</span></span>

<span data-ttu-id="5d9bc-142">Usando [**IVssComponent:: Addparcialfile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile), um gravador pode adicionar um arquivo ao backup que não foi adicionado anteriormente a um de seus conjuntos de componentes (por [**IVssCreateWriterMetadata:: AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata:: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles)ou [**IVssCreateWriterMetadata:: AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup)) como um arquivo parcial.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-142">Using [**IVssComponent::AddPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-addpartialfile), a writer can add a file to the backup that was not previously added to one of its component sets (by [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles), or [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup)) as a partial file.</span></span> <span data-ttu-id="5d9bc-143">Todos os novos arquivos adicionados ao backup dessa maneira devem estar em um volume que já esteja sendo copiado por sombra para esse backup.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-143">Any new files added to the backup in this manner must be on a volume that already is being shadow copied for this backup.</span></span>

<span data-ttu-id="5d9bc-144">Se um arquivo estiver envolvido com operações parciais de arquivo, isso substituirá qualquer tipo de backup de especificação de arquivo, que será ignorado.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-144">If a file is involved with partial file operations, this supersedes any file specification backup type, which is ignored.</span></span>

</dd> <dt>

<span data-ttu-id="5d9bc-145"><span id="Differenced_Files"></span><span id="differenced_files"></span><span id="DIFFERENCED_FILES"></span>Arquivos diferenciados</span><span class="sxs-lookup"><span data-stu-id="5d9bc-145"><span id="Differenced_Files"></span><span id="differenced_files"></span><span id="DIFFERENCED_FILES"></span>Differenced Files</span></span>
</dt> <dd>

<span data-ttu-id="5d9bc-146">Os gravadores que dão suporte a um esquema de backup modificado pela última vez (**\_ \_ esquema de BS VSS**) podem adicionar [*arquivos diferenciados*](vssgloss-d.md) a um backup incremental ou diferencial.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-146">Writers that support a last modified backup schema (**VSS\_BS\_SCHEMA**) can add [*differenced files*](vssgloss-d.md) to an incremental or differential backup.</span></span>

<span data-ttu-id="5d9bc-147">Ao especificar um arquivo diferenciado, um gravador usa [**IVssComponent:: AddDifferencedFileByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) e especifica um caminho, um nome de arquivo e um sinalizador recursivo — no entanto, eles não precisam corresponder a um conjunto de arquivos incluído em qualquer componente.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-147">In specifying a differenced file, a writer uses [**IVssComponent::AddDifferencedFileByLastModifyTime**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) and specifies a path, a file name, and a recursive flag—however, these do not have to match a file set included in any component.</span></span>

<span data-ttu-id="5d9bc-148">Na verdade, um gravador pode adicionar um arquivo não adicionado anteriormente a um de seus conjuntos de componentes (por [**IVssCreateWriterMetadata:: AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata:: AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles)ou [**IVssCreateWriterMetadata:: AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup)) ao backup como um arquivo diferenciado.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-148">In fact, a writer can add a file not previously added to one of its component sets (by [**IVssCreateWriterMetadata::AddDatabaseFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabasefiles), [**IVssCreateWriterMetadata::AddDatabaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles), or [**IVssCreateWriterMetadata::AddFilesToFileGroup**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addfilestofilegroup)) to the backup as a differenced file.</span></span> <span data-ttu-id="5d9bc-149">Todos os novos arquivos adicionados ao backup dessa maneira devem estar em um volume que já esteja sendo copiado por sombra para esse backup.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-149">Any new files added to the backup in this manner must be on a volume that already is being shadow copied for this backup.</span></span>

<span data-ttu-id="5d9bc-150">Normalmente, um gravador também especificará uma hora da última modificação ao adicionar um arquivo diferenciado, com base no mecanismo de histórico próprio do gravador.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-150">Typically, a writer will also specify a time of last modification when adding a differenced file—based on the writer's own history mechanism.</span></span> <span data-ttu-id="5d9bc-151">Essa última hora de modificação, se especificada, deve sempre ser usada por solicitantes para determinar se um arquivo precisa ser incluído em um backup incremental ou diferencial.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-151">This last modification time, if specified, must always be used by requesters in determining if a file needs to be included in an incremental or differential backup.</span></span>

<span data-ttu-id="5d9bc-152">Um gravador pode optar por não especificar uma hora da última modificação ao adicionar um arquivo diferenciado a um conjunto de backup incremental ou diferencial.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-152">A writer may choose not to specify a last modification time when adding a differenced file to an incremental or differential backup set.</span></span> <span data-ttu-id="5d9bc-153">Se esse for o caso, os solicitantes são livres para usar seus próprios mecanismos — por exemplo, logs de backups anteriores ou informações do sistema de arquivos — para determinar se o arquivo diferenciado deve ser incluído em um backup incremental ou diferencial.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-153">If this is the case, requesters are free to use their own mechanisms—for instance, logs of previous backups or file system information—to determine whether the differenced file should be included in an incremental or differential backup.</span></span>

<span data-ttu-id="5d9bc-154">O tipo de backup de especificação de arquivo de qualquer arquivo diferenciado é ignorado.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-154">The file specification backup type of any differenced file is ignored.</span></span>

</dd> <dt>

<span data-ttu-id="5d9bc-155"><span id="Backup_Stamps"></span><span id="backup_stamps"></span><span id="BACKUP_STAMPS"></span>Carimbos de backup</span><span class="sxs-lookup"><span data-stu-id="5d9bc-155"><span id="Backup_Stamps"></span><span id="backup_stamps"></span><span id="BACKUP_STAMPS"></span>Backup Stamps</span></span>
</dt> <dd>

<span data-ttu-id="5d9bc-156">Os gravadores que dão suporte a carimbos de backup (**\_ carimbo de \_ data/hora VSS BS**) têm seu próprio formato privado para armazenar informações sobre quando um backup ocorreu pela última vez.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-156">Writers that support backup stamps (**VSS\_BS\_TIMESTAMP**) have their own private format for storing information about when a backup last occurred.</span></span> <span data-ttu-id="5d9bc-157">Essas informações são geradas pelo gravador durante o backup.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-157">This information is generated by the writer during backup.</span></span>

<span data-ttu-id="5d9bc-158">O carimbo de backup é armazenado no documento componentes de backup como uma cadeia de caracteres pelo método [**IVssComponent:: SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp) .</span><span class="sxs-lookup"><span data-stu-id="5d9bc-158">The backup stamp is stored in the Backup Components Document as a string by the [**IVssComponent::SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp) method.</span></span> <span data-ttu-id="5d9bc-159">O carimbo de backup se aplica a todos os conjuntos de arquivos no componente (ou conjunto de componentes) correspondente à instância do [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent).</span><span class="sxs-lookup"><span data-stu-id="5d9bc-159">The backup stamp applies to all file sets in the component (or component set) corresponding to the instance of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent).</span></span>

<span data-ttu-id="5d9bc-160">Se um solicitante tiver acesso ao carimbo de backup de um backup anterior, ele o terá disponibilizado para o gravador chamando [**IVssBackupComponents:: SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="5d9bc-160">If a requester has access to the backup stamp of a previous backup, it will have made it available to the writer by calling [**IVssBackupComponents::SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp).</span></span>

<span data-ttu-id="5d9bc-161">Em seguida, um gravador pode examinar esse carimbo de data/hora usando [**IVssComponent:: GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="5d9bc-161">A writer then can examine this time stamp using [**IVssComponent::GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span></span>

<span data-ttu-id="5d9bc-162">Observe que o solicitante simplesmente armazena e retorna a cadeia de caracteres que contém o carimbo de backup.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-162">Note that the requester merely stores and returns the string containing the backup stamp.</span></span> <span data-ttu-id="5d9bc-163">Ele não sabe nada sobre o formato da cadeia de caracteres ou como usá-lo; somente o gravador tem essas informações.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-163">It does not know anything about the string's format or how to use it; only the writer has that information.</span></span>

<span data-ttu-id="5d9bc-164">Um gravador pode optar por atualizar o carimbo de backup atual usando [**IVssComponent:: SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp) depois de chamar [**IVssComponent:: GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp), gravando, dessa forma, a data da operação de backup incremental ou diferencial atual.</span><span class="sxs-lookup"><span data-stu-id="5d9bc-164">A writer may choose to update the current backup stamp using [**IVssComponent::SetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp) after it has called [**IVssComponent::GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp), thus recording in its own format the date of the current incremental or differential backup operation.</span></span>

</dd> </dl>

 

 



