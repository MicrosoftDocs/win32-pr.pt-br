---
description: A restauração de um backup incremental ou diferencial no VSS não é significativamente diferente de qualquer outra operação de restauração do VSS.
ms.assetid: 67143f6f-0bb8-4740-9289-8bbfeb7caadf
title: Restaurando backups incrementais e diferenciais
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 639919ea24f12fbc036116bd89b1630321cbae54
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104505744"
---
# <a name="restoring-incremental-and-differential-backups"></a><span data-ttu-id="1b422-103">Restaurando backups incrementais e diferenciais</span><span class="sxs-lookup"><span data-stu-id="1b422-103">Restoring Incremental and Differential Backups</span></span>

<span data-ttu-id="1b422-104">A restauração de um backup incremental ou diferencial no VSS não é significativamente diferente de qualquer outra operação de restauração do VSS.</span><span class="sxs-lookup"><span data-stu-id="1b422-104">Restoring an incremental or differential backup under VSS is not significantly different from any other VSS restore operation.</span></span>

<span data-ttu-id="1b422-105">Um gravador pode modificar destinos de restauração ou direcionamento direcionado a solicitações, e um solicitante deve tratar mapeamentos de local e novos destinos alternativos, assim como acontece com qualquer outra restauração.</span><span class="sxs-lookup"><span data-stu-id="1b422-105">A writer can modify restore targets or request directed targeting, and a requester must handle alternate location mappings and new targets, just as with any other restore.</span></span> <span data-ttu-id="1b422-106">No entanto, há dois problemas significativos a serem considerados no tratamento da restauração de um backup incremental ou diferencial: restaurações adicionais e carimbos de backup.</span><span class="sxs-lookup"><span data-stu-id="1b422-106">There are, however, two significant issues to be aware of in handling the restore of an incremental or differential backup: additional restores and backup stamps.</span></span>

## <a name="additional-restores"></a><span data-ttu-id="1b422-107">Restaurações adicionais</span><span class="sxs-lookup"><span data-stu-id="1b422-107">Additional Restores</span></span>

<span data-ttu-id="1b422-108">A primeira questão é a de restaurações adicionais.</span><span class="sxs-lookup"><span data-stu-id="1b422-108">The first issue is that of additional restores.</span></span> <span data-ttu-id="1b422-109">Um operador de backup pode precisar executar várias operações de restauração usando uma mídia de backup incremental completa e uma subseqüente, como uma origem.</span><span class="sxs-lookup"><span data-stu-id="1b422-109">A backup operator may need to run several restore operations using an initial full and subsequent incremental or differential backup media as a source.</span></span>

<span data-ttu-id="1b422-110">Alguns gravadores, normalmente como parte de seu manuseio de um evento de [*restauração*](vssgloss-p.md) usando [**CVssWriter:: OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore), usam arquivos restaurados para realizar atualizações de dados atualmente no disco.</span><span class="sxs-lookup"><span data-stu-id="1b422-110">Some writers, typically as part of their handling of a [*PostRestore*](vssgloss-p.md) event using [**CVssWriter::OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore), use restored files to perform updates of data currently on disk.</span></span> <span data-ttu-id="1b422-111">Para alguns desses gravadores, ele é ineficiente, ou perigoso, para atualizar repetidamente os dados em disco de arquivos restaurados.</span><span class="sxs-lookup"><span data-stu-id="1b422-111">For some of these writers it is inefficient—or dangerous—to repeatedly update on-disk data from restored files.</span></span>

<span data-ttu-id="1b422-112">Portanto, é importante que os aplicativos de backup indiquem quando um componente ou conjunto de componentes pode exigir restaurações subsequentes chamando [**IVssBackupComponents:: SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores).</span><span class="sxs-lookup"><span data-stu-id="1b422-112">Therefore, it is important that backup applications indicate when a component or component set may require subsequent restores by calling [**IVssBackupComponents::SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores).</span></span>

<span data-ttu-id="1b422-113">Um gravador chamaria [**IVssComponent:: GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) para determinar se o operador de backup planejou mais restaurações do componente ou conjunto de componentes.</span><span class="sxs-lookup"><span data-stu-id="1b422-113">A writer would call [**IVssComponent::GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) to determine whether the backup operator planned more restores of the component or component set.</span></span>

<span data-ttu-id="1b422-114">Se o solicitante não tiver chamado [**IVssBackupComponents:: SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores), [**IVssComponent:: GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) retornará false e o gravador poderá executar qualquer processamento após a restauração necessário.</span><span class="sxs-lookup"><span data-stu-id="1b422-114">If the requester had not called [**IVssBackupComponents::SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores), then [**IVssComponent::GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) returns false, and the writer can perform any post-restore processing it needs to.</span></span>

<span data-ttu-id="1b422-115">Se [**IVssBackupComponents:: SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores) tivesse sido chamado, [**IVssComponent:: GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) retorna **true** e um gravador deve decidir como tratar as operações de pós-restauração — por exemplo, o gravador pode optar por não atualizar seus dados em disco.</span><span class="sxs-lookup"><span data-stu-id="1b422-115">If [**IVssBackupComponents::SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores) had been called, then [**IVssComponent::GetAdditionalRestores**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getadditionalrestores) returns **true**, and a writer should decide how to handle post-restore operations—for instance, the writer may choose not to update its on-disk data.</span></span>

## <a name="backup-stamps"></a><span data-ttu-id="1b422-116">Carimbos de backup</span><span class="sxs-lookup"><span data-stu-id="1b422-116">Backup Stamps</span></span>

<span data-ttu-id="1b422-117">Como parte da operação de backup completo anterior, um gravador pode ter armazenado um carimbo de backup no documento de componentes de backup do solicitante.</span><span class="sxs-lookup"><span data-stu-id="1b422-117">As part of the previous full backup operation, a writer may have stored a backup stamp in the requester's Backup Components Document.</span></span>

<span data-ttu-id="1b422-118">O carimbo de backup é armazenado como uma cadeia de caracteres, e seu formato e informações não são compreensíveis para o solicitante.</span><span class="sxs-lookup"><span data-stu-id="1b422-118">The backup stamp is stored as a string, and its format and information are not intelligible to the requester.</span></span> <span data-ttu-id="1b422-119">Portanto, o solicitante não pode fazer uso direto das informações de carimbo de backup.</span><span class="sxs-lookup"><span data-stu-id="1b422-119">Therefore, the requester cannot make direct use of the backup stamp information.</span></span>

<span data-ttu-id="1b422-120">Em vez disso, sua tarefa é tornar essas informações disponíveis para o gravador, chamando o método [**IVssBackupComponents:: SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) antes da geração de um evento [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) para um backup incremental.</span><span class="sxs-lookup"><span data-stu-id="1b422-120">Instead, its task is to make that information available to the writer, by calling the [**IVssBackupComponents::SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) method prior to the generation of a [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) event for an incremental backup.</span></span>

<span data-ttu-id="1b422-121">O solicitante faz isso em uma base componente por componente.</span><span class="sxs-lookup"><span data-stu-id="1b422-121">The requester does this on a component-by-component basis.</span></span> <span data-ttu-id="1b422-122">Um solicitante examina o componente armazenado ou o conjunto de componentes informações de carimbo de backup usando [**IVssComponent:: GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="1b422-122">A requester examines stored component or component set backup stamp information using [**IVssComponent::GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp).</span></span>

<span data-ttu-id="1b422-123">Se as informações de carimbo de backup forem apropriadas para o tipo de restauração que o solicitante está realizando, ela a disponibilizará como carimbo de data/hora do último backup de um componente com o método [**IVssBackupComponents:: SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) .</span><span class="sxs-lookup"><span data-stu-id="1b422-123">If backup stamp information is appropriate to the type of restore the requester is undertaking, it makes it available as the time stamp of the last backup of a component with the [**IVssBackupComponents::SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) method.</span></span>

<span data-ttu-id="1b422-124">Um gravador recupera as informações de carimbo de backup usando [**IVssComponent:: GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span><span class="sxs-lookup"><span data-stu-id="1b422-124">A writer recovers the backup stamp information using [**IVssComponent::GetPreviousBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).</span></span> <span data-ttu-id="1b422-125">Um gravador dessa classe gerou o carimbo de backup inicial, portanto, o gravador é capaz de decodificar esse carimbo e usar as informações.</span><span class="sxs-lookup"><span data-stu-id="1b422-125">A writer of this class generated the initial backup stamp, so the writer is able to decode this stamp and use the information.</span></span> <span data-ttu-id="1b422-126">Com base nele, ao manipular um evento de [**Prerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) , um gravador pode optar por executar ações como alterar destinos de restauração ou solicitar direcionamento direcionado.</span><span class="sxs-lookup"><span data-stu-id="1b422-126">Based on this, while handling a [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) event, a writer may choose to take actions such as changing restore targets or requesting directed targeting.</span></span>

 

 



