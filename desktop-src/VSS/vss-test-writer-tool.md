---
description: O gravador de teste é um utilitário que você pode usar para testar aplicativos do solicitante do VSS.
ms.assetid: 02434cb9-390c-4cf0-9941-b833ace55685
title: Ferramenta de gravador de teste do VSS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 61ffdbb513697a701866be5ceeb40168e8c28368
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105763409"
---
# <a name="vss-test-writer-tool"></a><span data-ttu-id="b47cd-103">Ferramenta de gravador de teste do VSS</span><span class="sxs-lookup"><span data-stu-id="b47cd-103">VSS Test Writer Tool</span></span>

<span data-ttu-id="b47cd-104">O gravador de teste é um utilitário que você pode usar para testar aplicativos do solicitante do VSS.</span><span class="sxs-lookup"><span data-stu-id="b47cd-104">The Test Writer is a utility that you can use to test VSS requester applications.</span></span> <span data-ttu-id="b47cd-105">Esse gravador pode ser configurado para executar quase todas as ações que um gravador VSS pode executar.</span><span class="sxs-lookup"><span data-stu-id="b47cd-105">This writer can be configured to perform almost all of the actions that a VSS writer can perform.</span></span> <span data-ttu-id="b47cd-106">Além disso, o gravador de teste executa verificações extensivas para garantir que o solicitante tenha tratado corretamente essas ações de gravador.</span><span class="sxs-lookup"><span data-stu-id="b47cd-106">In addition, the Test Writer performs extensive checks to ensure that the requester has dealt with these writer actions correctly.</span></span>

<span data-ttu-id="b47cd-107">Cada instância do gravador é inicializada com um arquivo de configuração XML que descreve exatamente quais componentes serão relatados pelo gravador e como o gravador se comporta.</span><span class="sxs-lookup"><span data-stu-id="b47cd-107">Each instance of the writer is initialized with an XML configuration file that describes exactly what components the writer will report on, and how the writer behaves.</span></span> <span data-ttu-id="b47cd-108">O gravador pode ser configurado para relatar vários tipos de cenários, incluindo cenários mais complicados usando as interfaces incrementais e diferenciais.</span><span class="sxs-lookup"><span data-stu-id="b47cd-108">The writer can be configured to report on various types of scenarios, including more complicated scenarios using the incremental and differential interfaces.</span></span> <span data-ttu-id="b47cd-109">O gravador executará verificações em vários pontos durante o processo para garantir que o solicitante esteja se comportando de maneira adequada.</span><span class="sxs-lookup"><span data-stu-id="b47cd-109">The writer will perform checks at various points during the process to ensure that the requester is behaving in a proper manner.</span></span> <span data-ttu-id="b47cd-110">Depois que a restauração for concluída, o gravador verificará se todos os arquivos necessários foram restaurados sem corrupção.</span><span class="sxs-lookup"><span data-stu-id="b47cd-110">After the restore is completed, the writer will check that all necessary files have been restored without corruption.</span></span> <span data-ttu-id="b47cd-111">O gravador também pode ser configurado para executar outras operações, como eventos específicos com falha.</span><span class="sxs-lookup"><span data-stu-id="b47cd-111">The writer can also be configured to perform other operations such as failing specific events.</span></span>

> [!Note]  
> <span data-ttu-id="b47cd-112">Essa ferramenta está incluída no SDK (Software Development Kit) do Microsoft Windows para Windows Vista e posterior.</span><span class="sxs-lookup"><span data-stu-id="b47cd-112">This tool is included in the Microsoft Windows Software Development Kit (SDK) for Windows Vista and later.</span></span> <span data-ttu-id="b47cd-113">Você pode baixar o SDK do Windows do [https://msdn.microsoft.com/windowsvista](https://msdn.microsoft.com/windows/default.aspx) .</span><span class="sxs-lookup"><span data-stu-id="b47cd-113">You can download the Windows SDK from [https://msdn.microsoft.com/windowsvista](https://msdn.microsoft.com/windows/default.aspx).</span></span>

 

<span data-ttu-id="b47cd-114">Na instalação do SDK do Windows, a ferramenta VssSampleProvider pode ser encontrada em `%Program Files(x86)%\Windows Kits\8.1\bin\x64` (para o Windows de 64 bits) e `%Program Files(x86)%\Windows Kits\8.1\bin\x86` .</span><span class="sxs-lookup"><span data-stu-id="b47cd-114">In the Windows SDK installation, the VssSampleProvider tool can be found in `%Program Files(x86)%\Windows Kits\8.1\bin\x64` (for 64-bit Windows) and `%Program Files(x86)%\Windows Kits\8.1\bin\x86`.</span></span>

## <a name="running-the-test-writer-tool"></a><span data-ttu-id="b47cd-115">Executando a ferramenta de gravador de teste</span><span class="sxs-lookup"><span data-stu-id="b47cd-115">Running the Test Writer Tool</span></span>

<span data-ttu-id="b47cd-116">Para iniciar o gravador de teste, digite o seguinte no prompt de comando:</span><span class="sxs-lookup"><span data-stu-id="b47cd-116">To start the Test Writer, type the following at the command prompt:</span></span>

<span data-ttu-id="b47cd-117"> *Arquivo config-* vswriter.exe</span><span class="sxs-lookup"><span data-stu-id="b47cd-117">**vswriter.exe** *config-file*</span></span>

<span data-ttu-id="b47cd-118">em que *config-file* é o caminho para um arquivo de configuração que especifica o comportamento desse gravador.</span><span class="sxs-lookup"><span data-stu-id="b47cd-118">where *config-file* is the path to a configuration file that specifies the behavior of this writer.</span></span>

<span data-ttu-id="b47cd-119">Para interromper o gravador de teste, pressione CTRL + C.</span><span class="sxs-lookup"><span data-stu-id="b47cd-119">To stop the Test Writer, press CTRL+C.</span></span>

<span data-ttu-id="b47cd-120">Várias instâncias do gravador de teste podem ser executadas ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="b47cd-120">Multiple instances of the Test Writer can be run at the same time.</span></span> <span data-ttu-id="b47cd-121">No entanto, cada instância do gravador relatará a mesma ID de classe de gravador (embora uma ID de instância de gravador diferente), portanto, os caminhos lógicos e os nomes de componentes devem ser exclusivos em todas as instâncias em execução simultaneamente do gravador.</span><span class="sxs-lookup"><span data-stu-id="b47cd-121">However, each instance of the writer will report the same writer class ID (though a different writer instance ID), so logical paths and component names must be unique across all simultaneously running instances of the writer.</span></span>

<span data-ttu-id="b47cd-122">Para garantir que o gravador possa verificar corretamente se o solicitante cumpriu as especificações de arquivo de exclusão, todos os arquivos dos quais foi feito backup devem ser excluídos do volume original antes de tentar restaurá-los.</span><span class="sxs-lookup"><span data-stu-id="b47cd-122">To ensure that the writer can properly check that the requester has honored the exclude file specifications, all files that were backed up should be deleted from the original volume before attempting to restore them.</span></span> <span data-ttu-id="b47cd-123">É recomendável que um modelo de cada cenário de gravador seja armazenado, para que o cenário possa ser facilmente recriado.</span><span class="sxs-lookup"><span data-stu-id="b47cd-123">It is recommended that a template of each writer scenario be stored, so the scenario can be easily recreated.</span></span>

## <a name="using-a-configuration-file"></a><span data-ttu-id="b47cd-124">Usar um Arquivo de Configuração</span><span class="sxs-lookup"><span data-stu-id="b47cd-124">Using a Configuration File</span></span>

<span data-ttu-id="b47cd-125">O arquivo de configuração de exemplo a seguir, vswriter \_config.xml, pode ser encontrado em `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\vsstools` plataformas x86 e `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\x64\vsstools` em plataformas x64.</span><span class="sxs-lookup"><span data-stu-id="b47cd-125">The following sample configuration file, vswriter\_config.xml, can be found in `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\vsstools` on x86 platforms and `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\x64\vsstools` on x64 platforms.</span></span>

``` syntax
<TestWriter usage="USER_DATA">

    <RestoreMethod method="RESTORE_IF_CAN_BE_REPLACED"
                   writerRestore="always"
                   rebootRequired="no" />

    <ExcludeFile path="c:\writerData\notTheseFiles" 
                 filespec="excludeThisFile.txt" 
                 recursive="no"/>

    <Component componentType="filegroup"
               componentName="TestFiles">
        <ComponentFile path="c:\writerData\myFilesHere" 
                       filespec="*"
                       recursive="no" />
    </Component>

</TestWriter>
```

<span data-ttu-id="b47cd-126">O elemento raiz nesse arquivo de configuração é denominado TestWriter.</span><span class="sxs-lookup"><span data-stu-id="b47cd-126">The root element in this configuration file is named TestWriter.</span></span> <span data-ttu-id="b47cd-127">Todos os outros elementos são organizados sob o elemento TestWriter.</span><span class="sxs-lookup"><span data-stu-id="b47cd-127">All other elements are arranged under the TestWriter element.</span></span>

<span data-ttu-id="b47cd-128">Um dos atributos associados a TestWriter é o atributo Usage.</span><span class="sxs-lookup"><span data-stu-id="b47cd-128">One of the attributes associated with TestWriter is the usage attribute.</span></span> <span data-ttu-id="b47cd-129">Esse atributo especifica o tipo de uso relatado por meio de [**IVssExamineWriterMetadata:: getidentity**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getidentity).</span><span class="sxs-lookup"><span data-stu-id="b47cd-129">This attribute specifies the usage type reported through [**IVssExamineWriterMetadata::GetIdentity**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getidentity).</span></span> <span data-ttu-id="b47cd-130">Um dos valores possíveis para esse atributo são \_ os dados do usuário.</span><span class="sxs-lookup"><span data-stu-id="b47cd-130">One of the possible values for this attribute is USER\_DATA.</span></span>

<span data-ttu-id="b47cd-131">O primeiro elemento filho do elemento raiz sempre deve ser um elemento RestoreMethod.</span><span class="sxs-lookup"><span data-stu-id="b47cd-131">The first child element of the root element must always be a RestoreMethod element.</span></span> <span data-ttu-id="b47cd-132">Esse elemento Especifica o seguinte:</span><span class="sxs-lookup"><span data-stu-id="b47cd-132">This element specifies the following:</span></span>

-   <span data-ttu-id="b47cd-133">O método Restore (nesse caso, RESTOre \_ If \_ pode \_ ser \_ substituído)</span><span class="sxs-lookup"><span data-stu-id="b47cd-133">The restore method (in this case, RESTORE\_IF\_CAN\_BE\_REPLACED)</span></span>
-   <span data-ttu-id="b47cd-134">Se o gravador requer eventos de restauração (neste caso, sempre)</span><span class="sxs-lookup"><span data-stu-id="b47cd-134">Whether the writer requires restore events (in this case, always)</span></span>
-   <span data-ttu-id="b47cd-135">Se uma reinicialização é necessária após a restauração do gravador (neste caso, não)</span><span class="sxs-lookup"><span data-stu-id="b47cd-135">Whether a reboot is required after the writer is restored (in this case, no)</span></span>

<span data-ttu-id="b47cd-136">Esse elemento pode, opcionalmente, especificar um mapeamento de local alternativo.</span><span class="sxs-lookup"><span data-stu-id="b47cd-136">This element can optionally specify an alternate-location mapping.</span></span> <span data-ttu-id="b47cd-137">(Nesse caso, nenhum local alternativo é especificado.)</span><span class="sxs-lookup"><span data-stu-id="b47cd-137">(In this case, no alternate location is specified.)</span></span>

<span data-ttu-id="b47cd-138">O segundo elemento filho é um elemento excludefile.</span><span class="sxs-lookup"><span data-stu-id="b47cd-138">The second child element is an ExcludeFile element.</span></span> <span data-ttu-id="b47cd-139">Esse elemento faz com que o gravador exclua um arquivo ou um conjunto de arquivos do backup.</span><span class="sxs-lookup"><span data-stu-id="b47cd-139">This element causes the writer to exclude a file or a set of files from backup.</span></span>

<span data-ttu-id="b47cd-140">O terceiro elemento filho é um elemento de componente.</span><span class="sxs-lookup"><span data-stu-id="b47cd-140">The third child element is a Component element.</span></span> <span data-ttu-id="b47cd-141">Esse elemento faz com que o gravador adicione um componente a seus metadados.</span><span class="sxs-lookup"><span data-stu-id="b47cd-141">This element causes the writer to add a component to its metadata.</span></span> <span data-ttu-id="b47cd-142">Um elemento de componente contém atributos para descrever o componente e os elementos filho para descrever o conteúdo do componente, como o seguinte:</span><span class="sxs-lookup"><span data-stu-id="b47cd-142">A Component element contains attributes to describe the component and child elements to describe the content of the component, such as the following:</span></span>

-   <span data-ttu-id="b47cd-143">ComponentType para indicar se este é um grupo de arquivos ou um banco de dados</span><span class="sxs-lookup"><span data-stu-id="b47cd-143">componentType to indicate whether this is a filegroup or a database</span></span>
-   <span data-ttu-id="b47cd-144">logicalPath para o caminho lógico do componente</span><span class="sxs-lookup"><span data-stu-id="b47cd-144">logicalPath for the component logical path</span></span>
-   <span data-ttu-id="b47cd-145">ComponentName para o nome do componente</span><span class="sxs-lookup"><span data-stu-id="b47cd-145">componentName for the name of the component</span></span>
-   <span data-ttu-id="b47cd-146">selecionável para indicar o status de selecionável para backup</span><span class="sxs-lookup"><span data-stu-id="b47cd-146">selectable to indicate selectable-for-backup status</span></span>

<span data-ttu-id="b47cd-147">O elemento Component também tem um elemento filho chamado Componentfile para adicionar uma especificação de arquivo a esse componente.</span><span class="sxs-lookup"><span data-stu-id="b47cd-147">The Component element also has a child element named ComponentFile to add a file specification to this component.</span></span> <span data-ttu-id="b47cd-148">(Um elemento de componente pode ter um número arbitrário de elementos Componentfile que podem ser especificados para cada componente.) Este elemento Componentfile tem os seguintes atributos:</span><span class="sxs-lookup"><span data-stu-id="b47cd-148">(A Component element can have an arbitrary number of ComponentFile elements that can be specified for each component.) This ComponentFile element has the following attributes:</span></span>

-   <span data-ttu-id="b47cd-149">Path = "c: \\ writerData \\ myFilesHere"</span><span class="sxs-lookup"><span data-stu-id="b47cd-149">path="c:\\writerData\\myFilesHere"</span></span>
-   <span data-ttu-id="b47cd-150">filespec = " \* "</span><span class="sxs-lookup"><span data-stu-id="b47cd-150">filespec="\*"</span></span>
-   <span data-ttu-id="b47cd-151">recursivo = "não"</span><span class="sxs-lookup"><span data-stu-id="b47cd-151">recursive="no"</span></span>

<span data-ttu-id="b47cd-152">Embora o gravador de teste Verifique o comportamento do solicitante, ele não verifica se o arquivo de configuração sempre mantém a semântica documentada para um gravador.</span><span class="sxs-lookup"><span data-stu-id="b47cd-152">Although the Test Writer verifies requester behavior, it does not verify that the configuration file always maintains the documented semantics for a writer.</span></span> <span data-ttu-id="b47cd-153">Há muitas operações que um gravador bem comportado não deve fazer (como relatar o mesmo arquivo em vários componentes), e cabe ao autor do arquivo de configuração XML manter essas semânticas.</span><span class="sxs-lookup"><span data-stu-id="b47cd-153">There are many operations that a well-behaved writer should not do (such as report the same file in multiple components), and it is up to the author of the XML configuration file to maintain these semantics.</span></span>

## <a name="configuring-writer-attributes"></a><span data-ttu-id="b47cd-154">Configurando atributos do gravador</span><span class="sxs-lookup"><span data-stu-id="b47cd-154">Configuring Writer Attributes</span></span>

<span data-ttu-id="b47cd-155">O elemento raiz TestWriter contém atributos que determinam vários comportamentos do gravador.</span><span class="sxs-lookup"><span data-stu-id="b47cd-155">The TestWriter root element contains attributes that determine various behaviors of the writer.</span></span> <span data-ttu-id="b47cd-156">Alguns dos comportamentos que podem ser alterados são os seguintes:</span><span class="sxs-lookup"><span data-stu-id="b47cd-156">Some of the behaviors that can be altered are the following:</span></span>



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><span data-ttu-id="b47cd-157">Atributo</span><span class="sxs-lookup"><span data-stu-id="b47cd-157">Attribute</span></span></th>
<th><span data-ttu-id="b47cd-158">Descrição</span><span class="sxs-lookup"><span data-stu-id="b47cd-158">Description</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="b47cd-159"><span id="verbosity"></span><span id="VERBOSITY"></span>detalhamento</span><span class="sxs-lookup"><span data-stu-id="b47cd-159"><span id="verbosity"></span><span id="VERBOSITY"></span>verbosity</span></span><br/></td>
<td><span data-ttu-id="b47cd-160">O gravador imprime o status no console do à medida que recebe eventos e os processa.</span><span class="sxs-lookup"><span data-stu-id="b47cd-160">The writer prints the status to the console as it receives events and processes them.</span></span> <span data-ttu-id="b47cd-161">O nível de detalhamento exibido é especificado pelo atributo de detalhes.</span><span class="sxs-lookup"><span data-stu-id="b47cd-161">The level of verbosity displayed is specified by the verbosity attribute.</span></span> <span data-ttu-id="b47cd-162">Há três níveis de detalhamento a serem escolhidos:</span><span class="sxs-lookup"><span data-stu-id="b47cd-162">There are three verbosity levels to choose from:</span></span><br/> <dl> <span data-ttu-id="b47cd-163"><dt><span id="low"></span><span id="LOW"></span>pequena</dt> </span><span class="sxs-lookup"><span data-stu-id="b47cd-163"><dt><span id="low"></span><span id="LOW"></span>low</dt> </span></span><dd> <span data-ttu-id="b47cd-164">Somente as falhas no gravador ou comportamento incorreto do solicitante serão impressas.</span><span class="sxs-lookup"><span data-stu-id="b47cd-164">Only failures in the writer or incorrect behavior from the requester will be printed.</span></span><br/> </dd> <span data-ttu-id="b47cd-165"><dt><span id="medium"></span><span id="MEDIUM"></span>médio</dt> </span><span class="sxs-lookup"><span data-stu-id="b47cd-165"><dt><span id="medium"></span><span id="MEDIUM"></span>medium</dt> </span></span><dd> <span data-ttu-id="b47cd-166">Tudo no nível de detalhe baixo é impresso, além das informações de status extras, como quando os eventos são recebidos.</span><span class="sxs-lookup"><span data-stu-id="b47cd-166">Everything at the low verbosity level is printed in addition to extra status information such as when events are received.</span></span> <span data-ttu-id="b47cd-167">Este é o nível padrão.</span><span class="sxs-lookup"><span data-stu-id="b47cd-167">This is the default level.</span></span><br/> </dd> <span data-ttu-id="b47cd-168"><dt><span id="high"></span><span id="HIGH"></span>elevada</dt> </span><span class="sxs-lookup"><span data-stu-id="b47cd-168"><dt><span id="high"></span><span id="HIGH"></span>high</dt> </span></span><dd> <span data-ttu-id="b47cd-169">Informações detalhadas de status sobre a operação do gravador são relatadas.</span><span class="sxs-lookup"><span data-stu-id="b47cd-169">Detailed status information about the operation of the writer is reported.</span></span><br/> </dd> </dl></td>
</tr>
<tr class="even">
<td><span data-ttu-id="b47cd-170"><span id="deleteFiles"></span><span id="deletefiles"></span><span id="DELETEFILES"></span>deleteFiles</span><span class="sxs-lookup"><span data-stu-id="b47cd-170"><span id="deleteFiles"></span><span id="deletefiles"></span><span id="DELETEFILES"></span>deleteFiles</span></span><br/></td>
<td><span data-ttu-id="b47cd-171">Para executar a verificação extra, defina esse atributo como &quot; Sim &quot; para fazer com que o gravador exclua todos os seus arquivos imediatamente após a criação da cópia de sombra de volume.</span><span class="sxs-lookup"><span data-stu-id="b47cd-171">To perform extra verification, set this attribute to &quot;yes&quot; to cause the writer to delete all of its files immediately after the volume shadow copy is created.</span></span> <span data-ttu-id="b47cd-172">O solicitante deve copiar os arquivos da cópia de sombra, pois eles não existem mais no volume original.</span><span class="sxs-lookup"><span data-stu-id="b47cd-172">The requester must then copy the files from the shadow copy, because they no longer exist on the original volume.</span></span> <br/>
<blockquote>
[!Note]<br />
<span data-ttu-id="b47cd-173">No caso de gravadores saliva, os arquivos são excluídos do local original após o saliva, mas antes da cópia de sombra ser criada.</span><span class="sxs-lookup"><span data-stu-id="b47cd-173">In the case of spit writers, the files are deleted from the original location after the spit but before the shadow copy is created.</span></span> <span data-ttu-id="b47cd-174">Depois que a cópia de sombra é criada, os arquivos são excluídos do diretório saliva.</span><span class="sxs-lookup"><span data-stu-id="b47cd-174">After the shadow copy is created, the files are deleted from the spit directory.</span></span>
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="b47cd-175"><span id="deletePartialFiles"></span><span id="deletepartialfiles"></span><span id="DELETEPARTIALFILES"></span>deletePartialFiles</span><span class="sxs-lookup"><span data-stu-id="b47cd-175"><span id="deletePartialFiles"></span><span id="deletepartialfiles"></span><span id="DELETEPARTIALFILES"></span>deletePartialFiles</span></span><br/></td>
<td><span data-ttu-id="b47cd-176">Para excluir arquivos parciais, defina este atributo como &quot; Sim &quot; .</span><span class="sxs-lookup"><span data-stu-id="b47cd-176">To delete partial files, set this attribute to &quot;yes&quot;.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="b47cd-177"><span id="deleteDifferencedFiles"></span><span id="deletedifferencedfiles"></span><span id="DELETEDIFFERENCEDFILES"></span>deleteDifferencedFiles</span><span class="sxs-lookup"><span data-stu-id="b47cd-177"><span id="deleteDifferencedFiles"></span><span id="deletedifferencedfiles"></span><span id="DELETEDIFFERENCEDFILES"></span>deleteDifferencedFiles</span></span><br/></td>
<td><span data-ttu-id="b47cd-178">Para excluir arquivos diferenciados, defina este atributo como &quot; Sim &quot; .</span><span class="sxs-lookup"><span data-stu-id="b47cd-178">To delete differenced files, set this attribute to &quot;yes&quot;.</span></span><br/></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="b47cd-179"><span id="checkIncludes"></span><span id="checkincludes"></span><span id="CHECKINCLUDES"></span>checkIncludes</span><span class="sxs-lookup"><span data-stu-id="b47cd-179"><span id="checkIncludes"></span><span id="checkincludes"></span><span id="CHECKINCLUDES"></span>checkIncludes</span></span><br/></td>
<td><span data-ttu-id="b47cd-180">Defina esse atributo como &quot; Sim &quot; para fazer com que o gravador Verifique se todos os arquivos cujo backup foi feito foi restaurado em um local apropriado e se o arquivo não foi corrompido.</span><span class="sxs-lookup"><span data-stu-id="b47cd-180">Set this attribute to &quot;yes&quot; to cause the writer to check that every file that has been backed up has been restored to an appropriate location, and that the file has not been corrupted.</span></span> <span data-ttu-id="b47cd-181">Arquivos parciais e arquivos diferenciados também são tratados corretamente.</span><span class="sxs-lookup"><span data-stu-id="b47cd-181">Partial files and differenced files are also correctly handled.</span></span><br/></td>
</tr>
<tr class="even">
<td><span data-ttu-id="b47cd-182"><span id="checkExcludes"></span><span id="checkexcludes"></span><span id="CHECKEXCLUDES"></span>checkExcludes</span><span class="sxs-lookup"><span data-stu-id="b47cd-182"><span id="checkExcludes"></span><span id="checkexcludes"></span><span id="CHECKEXCLUDES"></span>checkExcludes</span></span><br/></td>
<td><span data-ttu-id="b47cd-183">Defina esse atributo como &quot; Sim &quot; para fazer com que o gravador Verifique se os arquivos que correspondem a uma especificação de arquivo na lista de exclusões não são restaurados.</span><span class="sxs-lookup"><span data-stu-id="b47cd-183">Set this attribute to &quot;yes&quot; to cause the writer to check that files matching a file specification in the exclude list are not restored.</span></span> <span data-ttu-id="b47cd-184">Para que isso funcione corretamente, os diretórios de restauração devem ser esvaziados antes da restauração.</span><span class="sxs-lookup"><span data-stu-id="b47cd-184">For this to function correctly, the restore directories must be emptied prior to restore.</span></span><br/></td>
</tr>
</tbody>
</table>



 

## <a name="specifying-alternate-location-mappings"></a><span data-ttu-id="b47cd-185">Especificando mapeamentos de local alternativos</span><span class="sxs-lookup"><span data-stu-id="b47cd-185">Specifying Alternate Location Mappings</span></span>

<span data-ttu-id="b47cd-186">Um mapeamento de local alternativo especifica um local para restaurar se o método de restauração for o VSS \_ WRE \_ restaurar \_ para um \_ \_ local alternativo ou se a restauração normal de um componente falhar.</span><span class="sxs-lookup"><span data-stu-id="b47cd-186">An alternate location mapping specifies a location to restore to if the restore method is VSS\_WRE\_RESTORE\_TO\_ALTERNATE\_LOCATION or if normal restore of a component fails.</span></span> <span data-ttu-id="b47cd-187">Um gravador pode relatar seus mapeamentos de local alternativos para o solicitante usando o método [**IVssExamineWriterMetadata:: GetAlternateLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getalternatelocationmapping) .</span><span class="sxs-lookup"><span data-stu-id="b47cd-187">A writer can report its alternate location mappings to the requester by using the [**IVssExamineWriterMetadata::GetAlternateLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getalternatelocationmapping) method.</span></span> <span data-ttu-id="b47cd-188">Você pode adicionar mapeamentos de local alternativos ao arquivo de configuração do gravador de teste adicionando subelementos AlternateLocationMapping ao elemento RestoreMethod.</span><span class="sxs-lookup"><span data-stu-id="b47cd-188">You can add alternate location mappings to the Test Writer configuration file by adding AlternateLocationMapping subelements to the RestoreMethod element.</span></span>

<span data-ttu-id="b47cd-189">O elemento RestoreMethod a seguir contém um subelemento AlternateLocationMapping.</span><span class="sxs-lookup"><span data-stu-id="b47cd-189">The following RestoreMethod element contains a AlternateLocationMapping subelement.</span></span>

``` syntax
<RestoreMethod method="RESTORE_IF_CAN_REPLACE"
              writerRestore="always"
              rebootRequired="no">
    <AlternateLocationMapping path="c:\files"
                              filespec="*.txt"
                              recursive="no"
                              alternatePath="c:\altfiles"/>
</RestoreMethod>
```

<span data-ttu-id="b47cd-190">Este exemplo especifica que o solicitante deve primeiro tentar restaurar todos os arquivos que correspondem a c: \\ files \\ \* . txt para o diretório c: \\ files.</span><span class="sxs-lookup"><span data-stu-id="b47cd-190">This example specifies that the requester should first attempt to restore all of the files matching c:\\files\\\*.txt to the c:\\files directory.</span></span> <span data-ttu-id="b47cd-191">Se um desses arquivos não puder ser substituído, o solicitante deverá restaurar todos os arquivos para o diretório c: \\ altfiles.</span><span class="sxs-lookup"><span data-stu-id="b47cd-191">If one of these files cannot be replaced, the requester should restore all the files to the c:\\altfiles directory instead.</span></span> <span data-ttu-id="b47cd-192">O solicitante deve salvar esse mapeamento de local alternativo usando o método [**IVssBackupComponents:: AddAlternativeLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping) .</span><span class="sxs-lookup"><span data-stu-id="b47cd-192">The requester should save this alternate location mapping by using the [**IVssBackupComponents::AddAlternativeLocationMapping**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addalternativelocationmapping) method.</span></span> <span data-ttu-id="b47cd-193">Se o gravador de teste estiver configurado para verificar se os arquivos foram restaurados, ele também verificará se o solicitante chamou **AddAlternativeLocationMapping**.</span><span class="sxs-lookup"><span data-stu-id="b47cd-193">If the Test Writer is configured to check whether files have been restored, it will also check whether the requester has called **AddAlternativeLocationMapping**.</span></span>

## <a name="specifying-files-to-be-excluded"></a><span data-ttu-id="b47cd-194">Especificando os arquivos a serem excluídos</span><span class="sxs-lookup"><span data-stu-id="b47cd-194">Specifying Files to Be Excluded</span></span>

<span data-ttu-id="b47cd-195">Cada gravador pode especificar uma lista de especificações de arquivo que especificam arquivos para o solicitante excluir do backup.</span><span class="sxs-lookup"><span data-stu-id="b47cd-195">Every writer can specify a list of file specifications that specify files for the requester to exclude from backup.</span></span> <span data-ttu-id="b47cd-196">Você pode adicionar essas especificações de arquivo ao arquivo de configuração do gravador de teste adicionando subelementos de excludefile ao elemento raiz TestWriter.</span><span class="sxs-lookup"><span data-stu-id="b47cd-196">You can add these file specifications to the Test Writer configuration file by adding ExcludeFile subelements to the TestWriter root element.</span></span>

<span data-ttu-id="b47cd-197">Aqui está um exemplo de um subelemento excludefile que exclui todos os arquivos no diretório C: \\ files que correspondem a C: \\ temp \* . \*</span><span class="sxs-lookup"><span data-stu-id="b47cd-197">Here is an example of an ExcludeFile subelement that excludes all files in the C:\\files directory that match C:\\temp\*.\*.</span></span>

``` syntax
    <ExcludeFile path="c:\files" 
                 filespec="temp*.*" 
                 recursive="no"/>
```

## <a name="backing-up-spit-writers"></a><span data-ttu-id="b47cd-198">Fazendo backup de gravadores saliva</span><span class="sxs-lookup"><span data-stu-id="b47cd-198">Backing Up Spit Writers</span></span>

<span data-ttu-id="b47cd-199">Muitos gravadores atuam como "saliva gravadores".</span><span class="sxs-lookup"><span data-stu-id="b47cd-199">Many writers act as "spit writers."</span></span> <span data-ttu-id="b47cd-200">Um gravador saliva cria arquivos intermediários, ou "arquivos saliva", com base em um conjunto original de arquivos e coloca os arquivos saliva em um local alternativo no momento do backup.</span><span class="sxs-lookup"><span data-stu-id="b47cd-200">A spit writer creates intermediate files, or "spit files," based on an original set of files, and puts the spit files in an alternate location at backup time.</span></span> <span data-ttu-id="b47cd-201">O gravador usa o método [**IVssWMFiledesc:: GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) para notificar o solicitante de que ele deve fazer backup desses arquivos a partir do local alternativo.</span><span class="sxs-lookup"><span data-stu-id="b47cd-201">The writer uses the [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation) method to notify the requester that it should back these files up from the alternate location.</span></span> <span data-ttu-id="b47cd-202">No entanto, esses arquivos ainda devem ser restaurados para o local ativo dos arquivos originais.</span><span class="sxs-lookup"><span data-stu-id="b47cd-202">However, these files should still be restored to the active location of the original files.</span></span> <span data-ttu-id="b47cd-203">O gravador de teste pode ser configurado para atuar como um gravador saliva para uma determinada especificação de arquivo.</span><span class="sxs-lookup"><span data-stu-id="b47cd-203">The Test Writer can be configured to act as a spit writer for a particular file specification.</span></span>

<span data-ttu-id="b47cd-204">O elemento Componentfile a seguir contém um atributo alternatePath:</span><span class="sxs-lookup"><span data-stu-id="b47cd-204">The following ComponentFile element contains an alternatePath attribute:</span></span>

``` syntax
    <ComponentFile path="c:\files"
                   filespec="*.txt"
                   recursive="no"
                   alternatePath="c:\files\spit" />
```

<span data-ttu-id="b47cd-205">Este exemplo configura o gravador de teste para copiar todos os arquivos que correspondem a c: \\ files \\ \* . txt para o diretório c: \\ files \\ saliva imediatamente antes da criação da cópia de sombra de volume.</span><span class="sxs-lookup"><span data-stu-id="b47cd-205">This example configures the Test Writer to copy all files matching c:\\files\\\*.txt to the c:\\files\\spit directory immediately before the volume shadow copy is created.</span></span> <span data-ttu-id="b47cd-206">O solicitante deve fazer backup dos arquivos do diretório c: \\ files \\ saliva</span><span class="sxs-lookup"><span data-stu-id="b47cd-206">The requester must back up the files from the c:\\files\\spit directory.</span></span> <span data-ttu-id="b47cd-207">Se o gravador de teste estiver configurado para excluir arquivos, ele excluirá os arquivos originais antes da criação da cópia de sombra, para que eles não apareçam no diretório c: \\ files no volume da cópia de sombra.</span><span class="sxs-lookup"><span data-stu-id="b47cd-207">If the Test Writer is configured to delete files, it deletes the original files before the shadow copy is created, so they do not appear in the c:\\files directory on the shadow copy volume.</span></span> <span data-ttu-id="b47cd-208">Nesse caso, os arquivos em c: \\ files \\ saliva são excluídos após a criação da cópia de sombra, para que seja necessário fazer backup do diretório c: \\ files \\ saliva no volume da cópia de sombra.</span><span class="sxs-lookup"><span data-stu-id="b47cd-208">In this case, the files in c:\\files\\spit are deleted after the shadow copy is created, so they must be backed up from the c:\\files\\spit directory on the shadow copy volume.</span></span>

## <a name="reporting-component-dependencies"></a><span data-ttu-id="b47cd-209">Dependências de componente de relatório</span><span class="sxs-lookup"><span data-stu-id="b47cd-209">Reporting Component Dependencies</span></span>

<span data-ttu-id="b47cd-210">Os gravadores podem especificar uma dependência entre um componente local e um componente existente em outro gravador.</span><span class="sxs-lookup"><span data-stu-id="b47cd-210">Writers can specify a dependency between a local component and a component that exists in another writer.</span></span> <span data-ttu-id="b47cd-211">Essas dependências são relatadas ao solicitante usando [**IVssWMComponent:: getdependency**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdependency).</span><span class="sxs-lookup"><span data-stu-id="b47cd-211">These dependencies are reported to the requester using [**IVssWMComponent::GetDependency**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdependency).</span></span> <span data-ttu-id="b47cd-212">O gravador de teste pode ser configurado para relatar essas dependências adicionando um ou mais subelementos de dependência ao elemento de componente.</span><span class="sxs-lookup"><span data-stu-id="b47cd-212">The Test Writer can be configured to report these dependencies by adding one or more Dependency subelements to the Component element.</span></span>

<span data-ttu-id="b47cd-213">O elemento de componente a seguir contém um subelemento de dependência:</span><span class="sxs-lookup"><span data-stu-id="b47cd-213">The following Component element contains a Dependency subelement:</span></span>

``` syntax
    <Component componentType="filegroup"
               logicalPath=""
               componentName="WriterComponent"
               selectable="yes">
         <Dependency writerId="<GUID of target writer>"
                     logicalPath="ComponentPath"
                     componentName="Writer2Component" />
    </Component>
```

<span data-ttu-id="b47cd-214">A dependência é especificada como atributos do elemento Dependency.</span><span class="sxs-lookup"><span data-stu-id="b47cd-214">The dependency is specified as attributes of the Dependency element.</span></span> <span data-ttu-id="b47cd-215">WriterId é a ID de classe do gravador que contém o destino da dependência, logicalPath é o caminho lógico para o componente nesse gravador e ComponentName é o nome do componente.</span><span class="sxs-lookup"><span data-stu-id="b47cd-215">writerId is the class id of the writer containing the target of the dependency, logicalPath is the logical path to the component in that writer, and componentName is the name of the component.</span></span> <span data-ttu-id="b47cd-216">Nesse caso, se o solicitante estiver fazendo backup de "WriterComponent" no gravador atual, ele também deverá fazer backup do componente "ComponentPath \\ Writer2Component" no gravador de destino.</span><span class="sxs-lookup"><span data-stu-id="b47cd-216">In this case, if the requester is backing up "WriterComponent" in the current writer, it should also back up the component "ComponentPath\\Writer2Component" in the target writer.</span></span>

> [!Note]  
> <span data-ttu-id="b47cd-217">O gravador de teste não executa nenhuma verificação para garantir que as dependências sejam respeitadas.</span><span class="sxs-lookup"><span data-stu-id="b47cd-217">The Test Writer performs no checking to ensure dependencies are honored.</span></span>

 

## <a name="failing-events"></a><span data-ttu-id="b47cd-218">Eventos com falha</span><span class="sxs-lookup"><span data-stu-id="b47cd-218">Failing Events</span></span>

<span data-ttu-id="b47cd-219">O gravador de teste pode ser configurado para falhar em qualquer um dos eventos normais que um gravador recebe.</span><span class="sxs-lookup"><span data-stu-id="b47cd-219">The Test Writer can be configured to fail any of the normal events that a writer receives.</span></span> <span data-ttu-id="b47cd-220">Esses eventos são os seguintes:</span><span class="sxs-lookup"><span data-stu-id="b47cd-220">These events are as follows:</span></span>



| <span data-ttu-id="b47cd-221">Evento</span><span class="sxs-lookup"><span data-stu-id="b47cd-221">Event</span></span>                                                                                                                                    | <span data-ttu-id="b47cd-222">Descrição</span><span class="sxs-lookup"><span data-stu-id="b47cd-222">Description</span></span>                                                                                                                                                                                                                                                         |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="b47cd-223"><span id="Identify"></span><span id="identify"></span><span id="IDENTIFY"></span>Identificar</span><span class="sxs-lookup"><span data-stu-id="b47cd-223"><span id="Identify"></span><span id="identify"></span><span id="IDENTIFY"></span>Identify</span></span><br/>                                     | <span data-ttu-id="b47cd-224">Recebido como uma resposta a uma chamada [**IVssBackupComponents:: GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) .</span><span class="sxs-lookup"><span data-stu-id="b47cd-224">Received as a response to a [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) call.</span></span> <span data-ttu-id="b47cd-225">A falha aqui fará com que o gravador não seja relatado.</span><span class="sxs-lookup"><span data-stu-id="b47cd-225">Failure here will cause the writer to not be reported.</span></span><br/>                                                                 |
| <span data-ttu-id="b47cd-226"><span id="PrepareForBackup"></span><span id="prepareforbackup"></span><span id="PREPAREFORBACKUP"></span>PrepareForBackup</span><span class="sxs-lookup"><span data-stu-id="b47cd-226"><span id="PrepareForBackup"></span><span id="prepareforbackup"></span><span id="PREPAREFORBACKUP"></span>PrepareForBackup</span></span><br/>     | <span data-ttu-id="b47cd-227">Recebido como uma resposta ao solicitante chamando [**IVssBackupComponents::P repareforbackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup).</span><span class="sxs-lookup"><span data-stu-id="b47cd-227">Received as a response to the requester calling [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup).</span></span><br/>                                                                                                                 |
| <span data-ttu-id="b47cd-228"><span id="PrepareForSnapsot"></span><span id="prepareforsnapsot"></span><span id="PREPAREFORSNAPSOT"></span>PrepareForSnapsot</span><span class="sxs-lookup"><span data-stu-id="b47cd-228"><span id="PrepareForSnapsot"></span><span id="prepareforsnapsot"></span><span id="PREPAREFORSNAPSOT"></span>PrepareForSnapsot</span></span><br/> | <span data-ttu-id="b47cd-229">Recebido quando o solicitante chama [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), mas antes da cópia de sombra ser criada.</span><span class="sxs-lookup"><span data-stu-id="b47cd-229">Received when the requester calls [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), but before the shadow copy is created.</span></span><br/>                                                                                              |
| <span data-ttu-id="b47cd-230"><span id="Freeze"></span><span id="freeze"></span><span id="FREEZE"></span>Trave</span><span class="sxs-lookup"><span data-stu-id="b47cd-230"><span id="Freeze"></span><span id="freeze"></span><span id="FREEZE"></span>Freeze</span></span><br/>                                             | <span data-ttu-id="b47cd-231">Recebido imediatamente após [*PrepareForSnapshot*](vssgloss-p.md), mas ainda antes da criação da cópia de sombra.</span><span class="sxs-lookup"><span data-stu-id="b47cd-231">Received immediately after [*PrepareForSnapshot*](vssgloss-p.md), but still before the shadow copy is created.</span></span><br/>                                                                                                      |
| <span data-ttu-id="b47cd-232"><span id="Thaw"></span><span id="thaw"></span><span id="THAW"></span>Congelar</span><span class="sxs-lookup"><span data-stu-id="b47cd-232"><span id="Thaw"></span><span id="thaw"></span><span id="THAW"></span>Thaw</span></span><br/>                                                     | <span data-ttu-id="b47cd-233">Recebido após a conclusão da criação da cópia de sombra.</span><span class="sxs-lookup"><span data-stu-id="b47cd-233">Received after the shadow copy creation is finished.</span></span><br/>                                                                                                                                                                                                     |
| <span data-ttu-id="b47cd-234"><span id="PostSnapshot"></span><span id="postsnapshot"></span><span id="POSTSNAPSHOT"></span>Pós-instantâneo</span><span class="sxs-lookup"><span data-stu-id="b47cd-234"><span id="PostSnapshot"></span><span id="postsnapshot"></span><span id="POSTSNAPSHOT"></span>PostSnapshot</span></span><br/>                     | <span data-ttu-id="b47cd-235">Recebido após o descongelamento ser concluído, mas antes de [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) é concluído.</span><span class="sxs-lookup"><span data-stu-id="b47cd-235">Received after Thaw completes, but before [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) completes.</span></span><br/>                                                                                                                   |
| <span data-ttu-id="b47cd-236"><span id="Abort"></span><span id="abort"></span><span id="ABORT"></span>Anular</span><span class="sxs-lookup"><span data-stu-id="b47cd-236"><span id="Abort"></span><span id="abort"></span><span id="ABORT"></span>Abort</span></span><br/>                                                 | <span data-ttu-id="b47cd-237">Recebido se houver muito tempo decorrido entre [*congelar*](vssgloss-f.md) e [*descongelar*](vssgloss-t.md) ou se o solicitante chamar [**IVssBackupComponents:: AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup).</span><span class="sxs-lookup"><span data-stu-id="b47cd-237">Received if too much time elapses between [*Freeze*](vssgloss-f.md) and [*Thaw*](vssgloss-t.md) or if the requester calls [**IVssBackupComponents::AbortBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-abortbackup).</span></span><br/> |
| <span data-ttu-id="b47cd-238"><span id="BackupComplete"></span><span id="backupcomplete"></span><span id="BACKUPCOMPLETE"></span>BackupComplete</span><span class="sxs-lookup"><span data-stu-id="b47cd-238"><span id="BackupComplete"></span><span id="backupcomplete"></span><span id="BACKUPCOMPLETE"></span>BackupComplete</span></span><br/>             | <span data-ttu-id="b47cd-239">Recebido quando o solicitante é encerrado.</span><span class="sxs-lookup"><span data-stu-id="b47cd-239">Received when the requester exits.</span></span> <span data-ttu-id="b47cd-240">As falhas aqui nunca serão relatadas.</span><span class="sxs-lookup"><span data-stu-id="b47cd-240">Failures here will never be reported.</span></span><br/>                                                                                                                                                                                 |
| <span data-ttu-id="b47cd-241"><span id="PreRestore"></span><span id="prerestore"></span><span id="PRERESTORE"></span>Prerestore</span><span class="sxs-lookup"><span data-stu-id="b47cd-241"><span id="PreRestore"></span><span id="prerestore"></span><span id="PRERESTORE"></span>PreRestore</span></span><br/>                             | <span data-ttu-id="b47cd-242">Recebido quando o solicitante chama [**IVssBackupComponents::P Rerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).</span><span class="sxs-lookup"><span data-stu-id="b47cd-242">Received when the requester calls [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).</span></span><br/>                                                                                                                                           |
| <span data-ttu-id="b47cd-243"><span id="PostRestore"></span><span id="postrestore"></span><span id="POSTRESTORE"></span>Restauração</span><span class="sxs-lookup"><span data-stu-id="b47cd-243"><span id="PostRestore"></span><span id="postrestore"></span><span id="POSTRESTORE"></span>PostRestore</span></span><br/>                         | <span data-ttu-id="b47cd-244">Recebido quando o solicitante chama [**IVssBackupComponents::P ostrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span><span class="sxs-lookup"><span data-stu-id="b47cd-244">Received when the requester calls [**IVssBackupComponents::PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore).</span></span><br/>                                                                                                                                         |



 

<span data-ttu-id="b47cd-245">Essas falhas são configuradas adicionando um ou mais subelementos FailEvent ao elemento raiz TestWriter.</span><span class="sxs-lookup"><span data-stu-id="b47cd-245">These failures are configured by adding one or more FailEvent subelements to the TestWriter root element.</span></span> <span data-ttu-id="b47cd-246">Há duas classes de falhas que podem ser definidas: retryável e sem nova tentativa.</span><span class="sxs-lookup"><span data-stu-id="b47cd-246">There are two classes of failures that can be set: retryable and non-retryable.</span></span> <span data-ttu-id="b47cd-247">Erros com nova tentativa são erros que podem desaparecer se todo o processo de backup for repetido, enquanto erros sem nova tentativa não serão desaparecedos.</span><span class="sxs-lookup"><span data-stu-id="b47cd-247">Retryable errors are errors that may go away if the entire backup process is retried, while non-retryable errors are unlikely to disappear.</span></span> <span data-ttu-id="b47cd-248">O tipo de falha do evento é escolhido com base no atributo com nova tentativa.</span><span class="sxs-lookup"><span data-stu-id="b47cd-248">The failure type for the event is chosen based on the retryable attribute.</span></span>

<span data-ttu-id="b47cd-249">Aqui está um exemplo de uma falha básica sem nova tentativa:</span><span class="sxs-lookup"><span data-stu-id="b47cd-249">Here is an example of a basic non-retryable failure:</span></span>

``` syntax
    <FailEvent writerEvent="Freeze"
               retryable="no" />
```

<span data-ttu-id="b47cd-250">Este exemplo fará com que o gravador falhe durante o evento [*Freeze*](vssgloss-f.md) .</span><span class="sxs-lookup"><span data-stu-id="b47cd-250">This example will cause the writer to fail during the [*Freeze*](vssgloss-f.md) event.</span></span> <span data-ttu-id="b47cd-251">[**IVssBackupComponents:: GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) reportará a falha do gravador para ser VSS \_ E \_ WRITERERROR sem \_ nova tentativa.</span><span class="sxs-lookup"><span data-stu-id="b47cd-251">[**IVssBackupComponents::GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) will report the writer failure to be VSS\_E\_WRITERERROR\_NONRETRYABLE.</span></span>

<span data-ttu-id="b47cd-252">Aqui está um exemplo de um erro básico com nova tentativa:</span><span class="sxs-lookup"><span data-stu-id="b47cd-252">Here is an example of a basic retryable error:</span></span>

``` syntax
    <FailEvent writerEvent="Freeze"
               retryable="yes"
               numFailures="2"/>
```

<span data-ttu-id="b47cd-253">Este exemplo fará com que o gravador falhe nas duas primeiras vezes que receber um evento [*Freeze*](vssgloss-f.md) .</span><span class="sxs-lookup"><span data-stu-id="b47cd-253">This example will cause the writer to fail the first two times it receives a [*Freeze*](vssgloss-f.md) event.</span></span> <span data-ttu-id="b47cd-254">Após as duas primeiras vezes, o gravador sempre terá sucesso.</span><span class="sxs-lookup"><span data-stu-id="b47cd-254">After the first two times, the writer will always succeed.</span></span> <span data-ttu-id="b47cd-255">A falha do gravador relatada por meio de [**GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) será um código de erro com nova tentativa aleatória.</span><span class="sxs-lookup"><span data-stu-id="b47cd-255">The writer failure reported through [**GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus) will be a random retryable error code.</span></span>

## <a name="declaring-supported-backup-types"></a><span data-ttu-id="b47cd-256">Declarando tipos de backup com suporte</span><span class="sxs-lookup"><span data-stu-id="b47cd-256">Declaring Supported Backup Types</span></span>

<span data-ttu-id="b47cd-257">Os gravadores comunicam quais tipos de backup têm suporte por meio da chamada de [**IVssExamineWriterMetadata:: GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema)do solicitante.</span><span class="sxs-lookup"><span data-stu-id="b47cd-257">Writers communicate what backup types are supported through the requester's calling [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span> <span data-ttu-id="b47cd-258">O elemento raiz TestWriter contém atributos para cada tipo de backup para indicar suporte.</span><span class="sxs-lookup"><span data-stu-id="b47cd-258">The TestWriter root element contains attributes for each backup type to indicate support.</span></span> <span data-ttu-id="b47cd-259">Esses atributos são supportsCopy, supportsDifferential, supportsIncremental e supportsLog.</span><span class="sxs-lookup"><span data-stu-id="b47cd-259">These attributes are supportsCopy, supportsDifferential, supportsIncremental, and supportsLog.</span></span> <span data-ttu-id="b47cd-260">Para indicar o suporte para um tipo de backup específico, defina o atributo correspondente como "Sim".</span><span class="sxs-lookup"><span data-stu-id="b47cd-260">To indicate support for a particular backup type, set the corresponding attribute to "yes".</span></span>

<span data-ttu-id="b47cd-261">Se o solicitante definir o tipo de backup para um tipo de backup sem suporte pelo gravador, o gravador notará esse fato durante o [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), mas, caso contrário, funcionará corretamente.</span><span class="sxs-lookup"><span data-stu-id="b47cd-261">If the requester sets the backup type to a backup type that is not supported by the writer, the writer will note this fact during [**PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup), but otherwise work correctly.</span></span>

## <a name="indicating-the-file-backup-type"></a><span data-ttu-id="b47cd-262">Indicando o tipo de backup de arquivo</span><span class="sxs-lookup"><span data-stu-id="b47cd-262">Indicating the File Backup Type</span></span>

<span data-ttu-id="b47cd-263">O método [**IVssWMFiledesc:: GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask) retorna um bitmask para o solicitante que indica como deve ser feito o backup de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="b47cd-263">The [**IVssWMFiledesc::GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask) method returns a bitmask to the requester indicating how a file should be backed up.</span></span> <span data-ttu-id="b47cd-264">Isso indicará se um arquivo é necessário ou não é necessário durante tipos específicos de backup e também se uma cópia de sombra é necessária durante tipos específicos de backup.</span><span class="sxs-lookup"><span data-stu-id="b47cd-264">This will indicate whether a file is required or not required during specific types of backup, and also whether a shadow copy is required during specific types of backup.</span></span> <span data-ttu-id="b47cd-265">Os tipos de backup nesse bitmask são explicados em um comprimento maior na [função de solicitante de documento no backup de repositórios complexos](requestor-role-in-backing-up-complex-stores.md).</span><span class="sxs-lookup"><span data-stu-id="b47cd-265">The backup types in this bitmask are explained at greater length in the document [Requester Role in Backing Up Complex Stores](requestor-role-in-backing-up-complex-stores.md).</span></span>

<span data-ttu-id="b47cd-266">No gravador de teste, os elementos dessa bitmask são especificados pela definição de atributos em cada elemento Componentfile.</span><span class="sxs-lookup"><span data-stu-id="b47cd-266">In the Test Writer, the elements of this bitmask are specified by setting attributes in each ComponentFile element.</span></span> <span data-ttu-id="b47cd-267">Os atributos fullBackupRequired, diffBackupRequired, incBackupRequired e logBackupRequired especificam quando é necessário fazer backup de um arquivo.</span><span class="sxs-lookup"><span data-stu-id="b47cd-267">The fullBackupRequired, diffBackupRequired, incBackupRequired, and logBackupRequired attributes specify when a file needs to be backed up.</span></span> <span data-ttu-id="b47cd-268">Os atributos fullSnapshotRequired, diffSnapshotRequired, incSnapshotRequired e logSnapshotRequired especificam quando é necessário fazer backup de um arquivo de uma cópia de sombra de um volume (e nunca do volume original).</span><span class="sxs-lookup"><span data-stu-id="b47cd-268">The fullSnapshotRequired, diffSnapshotRequired, incSnapshotRequired, and logSnapshotRequired attributes specify when a file must be backed up from a shadow copy of a volume (and never from the original volume).</span></span> <span data-ttu-id="b47cd-269">O padrão para todos esses valores é "Sim", indicando que um arquivo deve sempre ser copiado em backup e deve ser submetido a backup de uma cópia de sombra de um volume.</span><span class="sxs-lookup"><span data-stu-id="b47cd-269">The default for all of these values is "yes", indicating that a file must always be backed up and must be backed up from a shadow copy of a volume.</span></span>

## <a name="adding-partial-files"></a><span data-ttu-id="b47cd-270">Adicionando arquivos parciais</span><span class="sxs-lookup"><span data-stu-id="b47cd-270">Adding Partial Files</span></span>

<span data-ttu-id="b47cd-271">Durante o processamento de [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), um gravador tem a chance de adicionar arquivos parciais a cada componente.</span><span class="sxs-lookup"><span data-stu-id="b47cd-271">During the processing of [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), a writer has a chance to add partial files to each component.</span></span> <span data-ttu-id="b47cd-272">Esses arquivos parciais são relatados usando [**IVssComponent:: Getpartialfile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span><span class="sxs-lookup"><span data-stu-id="b47cd-272">These partial files are reported using [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span></span> <span data-ttu-id="b47cd-273">O gravador de teste pode ser configurado para adicionar arquivos parciais especificando subelementos parciais em um elemento de componente.</span><span class="sxs-lookup"><span data-stu-id="b47cd-273">The Test Writer can be configured to add partial files by specifying PartialFile subelements in a Component element.</span></span>

<span data-ttu-id="b47cd-274">Aqui está um exemplo de um elemento de componente que tem dois subelementos parciais:</span><span class="sxs-lookup"><span data-stu-id="b47cd-274">Here is an example of a Component element that has two PartialFile subelements:</span></span>

``` syntax
    <Component componentType="filegroup"
               logicalPath=""
               componentName="WriterComponent"
               selectable="yes">
        <ComponentFile path="c:\files"
                       filespec="*.txt"
                       recursive="no"/>
        <PartialFile path="c:\files"
                     filespec="partial.txt"
                     ranges="0:5,100:20" />
        <PartialFile path="c:\files2"
                     filespec="partial.txt"
                     ranges="0:5,100:20" />
    </Component>
```

<span data-ttu-id="b47cd-275">Somente arquivos parciais que correspondem parcialmente a um Componentfile existente (como no primeiro arquivo parcial no exemplo) ou novos arquivos parciais que estão no mesmo volume que um Componentfile existente (como no segundo arquivo parcial) devem ser especificados dessa maneira.</span><span class="sxs-lookup"><span data-stu-id="b47cd-275">Only partial files that partially match an existing ComponentFile (as in the first partial file in the example) or new partial files that are on the same volume as an existing ComponentFile (as in the second partial file) should be specified this way.</span></span> <span data-ttu-id="b47cd-276">Para esse componente, o solicitante deve fazer backup completo de todos os arquivos que correspondem a c: \\ files \\ \* . txt, exceto pelo partial.txt.</span><span class="sxs-lookup"><span data-stu-id="b47cd-276">For this component, the requester must fully back up all files matching c:\\files\\\*.txt except for partial.txt.</span></span> <span data-ttu-id="b47cd-277">O solicitante deve então fazer backup dos intervalos especificados (onde um intervalo é um deslocamento seguido por um comprimento) para os arquivos c: \\ files \\partial.txt e c: \\ files2 \\partial.txt.</span><span class="sxs-lookup"><span data-stu-id="b47cd-277">The requester must then back up the specified ranges (where a range is an offset followed by a length) for the files c:\\files\\partial.txt and c:\\files2\\partial.txt.</span></span>

<span data-ttu-id="b47cd-278">Se o gravador estiver configurado para verificar restaurações de arquivo, somente os intervalos de backup do arquivo parcial serão verificados no momento da restauração.</span><span class="sxs-lookup"><span data-stu-id="b47cd-278">If the writer is configured to check file restores, only the backed-up ranges of the partial file will be checked at restore time.</span></span> <span data-ttu-id="b47cd-279">As modificações em outras partes do arquivo vão despercebidas.</span><span class="sxs-lookup"><span data-stu-id="b47cd-279">Modifications to other portions of the file will go unnoticed.</span></span> <span data-ttu-id="b47cd-280">Se o atributo deletePartialFiles do elemento raiz TestWriter for definido, os arquivos parciais serão excluídos do volume original imediatamente após a cópia de sombra ser criada.</span><span class="sxs-lookup"><span data-stu-id="b47cd-280">If the deletePartialFiles attribute of the TestWriter root element is set, the partial files are deleted from the original volume immediately after the shadow copy is created.</span></span>

## <a name="adding-differenced-files"></a><span data-ttu-id="b47cd-281">Adicionando arquivos diferenciados</span><span class="sxs-lookup"><span data-stu-id="b47cd-281">Adding Differenced Files</span></span>

<span data-ttu-id="b47cd-282">Durante o processamento de [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), um gravador pode adicionar arquivos diferenciados a cada componente.</span><span class="sxs-lookup"><span data-stu-id="b47cd-282">During the processing of [**DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), a writer can add differenced files to each component.</span></span> <span data-ttu-id="b47cd-283">Esses arquivos diferenciados são relatados usando [**IVssComponent:: GetDifferencedFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile).</span><span class="sxs-lookup"><span data-stu-id="b47cd-283">These differenced files are reported using [**IVssComponent::GetDifferencedFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile).</span></span> <span data-ttu-id="b47cd-284">O gravador de teste pode ser configurado para adicionar arquivos diferenciados especificando subelementos DifferencedFile em um elemento de componente.</span><span class="sxs-lookup"><span data-stu-id="b47cd-284">The Test Writer can be configured to add differenced files by specifying DifferencedFile subelements in a Component element.</span></span>

<span data-ttu-id="b47cd-285">Aqui está um exemplo de um elemento de componente que tem dois subelementos DifferencedFile:</span><span class="sxs-lookup"><span data-stu-id="b47cd-285">Here is an example of a Component element that has two DifferencedFile subelements:</span></span>

``` syntax
    <Component componentType="filegroup"
               logicalPath=""
               componentName="WriterComponent"
               selectable="yes">
        <ComponentFile path="c:\files"
                       filespec="*.txt"
                       recursive="no"/>
        <DifferencedFile path="c:\files"
                         filespec="*.txt"
                         year="2007"
                         month="1"
                         day="22"
                         hour="12"
                         minute="44"
                         second="17" />
        <DifferencedFile path="c:\files2"
                         filespec="*.txt"
                         year="2007"
                         month="1"
                         day="22"
                         hour="12"
                         minute="44"
                         second="17" />
    </Component>
```

<span data-ttu-id="b47cd-286">Diferentemente dos arquivos parciais, os arquivos diferenciados nunca devem corresponder parcialmente a uma especificação de Componentfile.</span><span class="sxs-lookup"><span data-stu-id="b47cd-286">Unlike partial files, differenced files should never partially match a ComponentFile specification.</span></span> <span data-ttu-id="b47cd-287">A especificação de arquivo em um elemento DifferencedFile deve corresponder exatamente a um Componentfile (como no primeiro arquivo de diferença no exemplo) ou não deve corresponder a ele, mas estar em um volume referenciado em um Componentfile (como no segundo arquivo de diferença).</span><span class="sxs-lookup"><span data-stu-id="b47cd-287">The file specification in a DifferencedFile element should either exactly match a ComponentFile (as in the first differenced file in the example) or it should not match it at all, but be on a volume that is referenced in a ComponentFile (as in the second differenced file).</span></span> <span data-ttu-id="b47cd-288">Os valores de data e hora devem ser relativos ao fuso horário local, mas eles serão convertidos em GMT antes de serem relatados ao solicitante.</span><span class="sxs-lookup"><span data-stu-id="b47cd-288">The date and time values should be relative to the local time zone, but they will be converted to GMT before being reported to the requester.</span></span> <span data-ttu-id="b47cd-289">No exemplo, somente os arquivos que correspondem a c: \\ files \\ \* . txt ou c: \\ files2 \\ \* . txt que foram modificados desde 1/22/2003:12:44:17 serão submetidos a backup.</span><span class="sxs-lookup"><span data-stu-id="b47cd-289">In the example, only files matching c:\\files\\\*.txt or c:\\files2\\\*.txt that have been modified since 1/22/2003:12:44:17 will be backed up.</span></span>

<span data-ttu-id="b47cd-290">Se o gravador de teste estiver configurado para verificar restaurações de arquivo, somente os arquivos modificados serão verificados quanto à restauração.</span><span class="sxs-lookup"><span data-stu-id="b47cd-290">If the Test Writer is configured to check file restores, only the modified files will be checked for restore.</span></span> <span data-ttu-id="b47cd-291">Se o atributo deleteDifferencedFiles do elemento raiz TestWriter for definido, os arquivos diferenciados serão excluídos do volume original imediatamente após a cópia de sombra ser criada.</span><span class="sxs-lookup"><span data-stu-id="b47cd-291">If the deleteDifferencedFiles attribute of the TestWriter root element is set, the differenced files are deleted from the original volume immediately after the shadow copy is created.</span></span>

## <a name="new-targets"></a><span data-ttu-id="b47cd-292">Novos destinos</span><span class="sxs-lookup"><span data-stu-id="b47cd-292">New Targets</span></span>

<span data-ttu-id="b47cd-293">Determinados gravadores permitem que o solicitante informe que um novo local foi escolhido para restaurar determinados arquivos.</span><span class="sxs-lookup"><span data-stu-id="b47cd-293">Certain writers allow the requester to inform them that a new location has been chosen to restore certain files to.</span></span> <span data-ttu-id="b47cd-294">O gravador indica que ele dá suporte a esse modo como parte do bitmask retornado por [**IVssExamineWriterMetadata:: GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="b47cd-294">The writer indicates that it supports this mode as part of the bitmask returned by [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span> <span data-ttu-id="b47cd-295">Por padrão, o gravador de teste sempre dá suporte a novos destinos.</span><span class="sxs-lookup"><span data-stu-id="b47cd-295">By default, the Test Writer always supports new targets.</span></span> <span data-ttu-id="b47cd-296">Esse suporte pode ser desabilitado definindo o atributo supportsNewTarget no elemento raiz TestWriter como "no".</span><span class="sxs-lookup"><span data-stu-id="b47cd-296">This support can be disabled by setting the supportsNewTarget attribute in the TestWriter root element to "no".</span></span>

<span data-ttu-id="b47cd-297">Se um gravador oferecer suporte a novos destinos, o solicitante poderá informar o gravador de novos destinos chamando [**IVssBackupComponents:: AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget).</span><span class="sxs-lookup"><span data-stu-id="b47cd-297">If a writer supports new targets, the requester can inform the writer of new targets by calling [**IVssBackupComponents::AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget).</span></span> <span data-ttu-id="b47cd-298">O gravador verificará o novo local de destino para verificar a restauração em vez do local original.</span><span class="sxs-lookup"><span data-stu-id="b47cd-298">The writer will then check the new target location to verify restore rather than the original location.</span></span>

## <a name="more-information"></a><span data-ttu-id="b47cd-299">Mais informações</span><span class="sxs-lookup"><span data-stu-id="b47cd-299">More Information</span></span>

<span data-ttu-id="b47cd-300">O gravador de teste dá suporte a mais opções de configuração que não são descritas aqui.</span><span class="sxs-lookup"><span data-stu-id="b47cd-300">The Test Writer supports more configuration options that are not described here.</span></span> <span data-ttu-id="b47cd-301">O esquema completo para todos os recursos de configuração do gravador de teste é especificado no swriter.xml in `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\x64\vsstools` (para Windows de 64 bits) e `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\vsstools` (para windows de 32 bits).</span><span class="sxs-lookup"><span data-stu-id="b47cd-301">The full schema for all of the configuration capabilities of the Test Writer is specified in swriter.xml in `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\x64\vsstools` (for 64-bit Windows) and `%ProgramFiles%\Microsoft SDKs\Windows\v7.0\bin\vsstools` (for 32-bit Windows).</span></span> <span data-ttu-id="b47cd-302">Esse arquivo contém um esquema XML que descreve completamente todos os elementos e atributos que compõem um arquivo de configuração.</span><span class="sxs-lookup"><span data-stu-id="b47cd-302">This file contains an XML schema that completely describes all of the elements and attributes that make up a configuration file.</span></span> <span data-ttu-id="b47cd-303">Cada elemento e cada atributo nesse arquivo é comentado com uma descrição que documenta o uso do elemento ou do atributo.</span><span class="sxs-lookup"><span data-stu-id="b47cd-303">Each element and each attribute in this file is commented with a description that documents that element's or attribute's use.</span></span>

 

 




