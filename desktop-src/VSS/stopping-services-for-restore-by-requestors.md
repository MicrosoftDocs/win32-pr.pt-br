---
description: Pode ser necessário que um serviço seja interrompido antes e reiniciado após uma operação de restauração.
ms.assetid: 111d1281-ad83-49bc-868c-1106a0e25a2a
title: Interrompendo serviços para restauração por solicitantes
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 548af25a4b4550d35a8e6fa4d4c0e791897b6e0a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105811382"
---
# <a name="stopping-services-for-restore-by-requesters"></a><span data-ttu-id="06e70-103">Interrompendo serviços para restauração por solicitantes</span><span class="sxs-lookup"><span data-stu-id="06e70-103">Stopping Services for Restore by Requesters</span></span>

<span data-ttu-id="06e70-104">Pode ser necessário que um serviço seja interrompido antes e reiniciado após uma operação de restauração.</span><span class="sxs-lookup"><span data-stu-id="06e70-104">It may be necessary for a service to be stopped prior to and restarted following a restore operation.</span></span>

<span data-ttu-id="06e70-105">Normalmente, parar e iniciar um serviço para dar suporte a uma restauração seria executado por um gravador ao manipular o evento de [*Prerestore*](vssgloss-p.md) (with [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore)) e o evento [*createrestore*](vssgloss-p.md) (with [**CVssWriter:: OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore)).</span><span class="sxs-lookup"><span data-stu-id="06e70-105">Typically, stopping and starting a service to support a restore would be performed by a writer when handling the [*PreRestore*](vssgloss-p.md) event (with [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore)) and the [*PostRestore*](vssgloss-p.md) event (with [**CVssWriter::OnPostRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onpostrestore)).</span></span>

<span data-ttu-id="06e70-106">No entanto, pode haver casos em que é necessário que um solicitante interrompa explicitamente um serviço em execução.</span><span class="sxs-lookup"><span data-stu-id="06e70-106">However, there may be cases when it is necessary for a requester to explicitly stop a running service.</span></span> <span data-ttu-id="06e70-107">Os gravadores indicam se esse é o caso definindo o \_ valor de inicialização do VSS RME \_ Stop \_ Restore \_ ou do VSS \_ RME \_ Restore \_ Stop \_ da enumeração de [**enumeração do VSS \_ \_ RESTOREMETHOD**](/windows/desktop/api/VsWriter/ne-vswriter-vss_restoremethod_enum) como o argumento do método Restore de uma chamada para o método [**IVssCreateWriterMetadata:: SetRestoreMethod**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setrestoremethod) e especificando o nome do serviço a ser parado.</span><span class="sxs-lookup"><span data-stu-id="06e70-107">Writers indicate if this is the case by setting the VSS\_RME\_STOP\_RESTORE\_START or VSS\_RME\_RESTORE\_STOP\_START value of the [**VSS\_RESTOREMETHOD\_ENUM**](/windows/desktop/api/VsWriter/ne-vswriter-vss_restoremethod_enum) enumeration as the restore method argument of a call to the [**IVssCreateWriterMetadata::SetRestoreMethod**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setrestoremethod) method and specifying the name of the service to be stopped.</span></span>

<span data-ttu-id="06e70-108">Um solicitante Obtém informações sobre o método Restore e o nome do serviço a ser interrompido ao trabalhar com metadados do gravador usando o método [**IVssExamineWriterMetadata:: GetRestoreMethod**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getrestoremethod) .</span><span class="sxs-lookup"><span data-stu-id="06e70-108">A requester obtains information about the restore method and the name of the service to be stopped when working with writer metadata by using the [**IVssExamineWriterMetadata::GetRestoreMethod**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getrestoremethod) method.</span></span>

<span data-ttu-id="06e70-109">É importante que o gravador, ao especificar o nome de um serviço a ser interrompido, use o nome público correto desse serviço.</span><span class="sxs-lookup"><span data-stu-id="06e70-109">It is important that the writer, when specifying the name of a service to be stopped, uses the correct publicly known name of that service.</span></span> <span data-ttu-id="06e70-110">Um nome ambíguo ou inexato pode fazer com que os solicitantes interrompam o serviço errado ou não conseguirem determinar qual serviço deve ser interrompido.</span><span class="sxs-lookup"><span data-stu-id="06e70-110">An ambiguous or inaccurate name may result in requesters stopping the wrong service or being unable to determine which service to stop.</span></span>

<span data-ttu-id="06e70-111">Após a conclusão da operação de restauração, os solicitantes devem reiniciar o serviço.</span><span class="sxs-lookup"><span data-stu-id="06e70-111">After the completion of the restore operation, requesters must restart the service.</span></span>

<span data-ttu-id="06e70-112">Você deve ter cuidado ao projetar e implementar gravadores que dão suporte a serviços que os solicitantes devem parar e reiniciar.</span><span class="sxs-lookup"><span data-stu-id="06e70-112">You must be careful in designing and implementing writers that support services that requesters must stop and restart.</span></span> <span data-ttu-id="06e70-113">Especificamente, esses gravadores não devem realmente fazer parte do serviço, ou seja, o próprio gravador não precisa ser interrompido e reiniciado no decorrer da operação de restauração.</span><span class="sxs-lookup"><span data-stu-id="06e70-113">Specifically, such writers should not actually be part of the service—that is, the writer itself should not need to be stopped and then restarted in the course of the restore operation.</span></span>

<span data-ttu-id="06e70-114">Um gravador cujo processo é interrompido terá uma instância de gravador diferente após a reinicialização.</span><span class="sxs-lookup"><span data-stu-id="06e70-114">A writer whose process is stopped will have a different writer instance upon restart.</span></span> <span data-ttu-id="06e70-115">A nova instância do gravador não receberá eventos VSS destinados à instância original do gravador.</span><span class="sxs-lookup"><span data-stu-id="06e70-115">The new instance of the writer will not receive VSS events intended for the original instance of the writer.</span></span> <span data-ttu-id="06e70-116">Especificamente, se o processo de uma instância do gravador for interrompido depois de manipular um evento de pré-restauração, a nova instância não receberá o evento de restauração.</span><span class="sxs-lookup"><span data-stu-id="06e70-116">Specifically, if the process of a writer instance is stopped after handling a PreRestore event, the new instance will not receive the PostRestore event.</span></span> <span data-ttu-id="06e70-117">Além disso, o VSS gerará um erro indicando a perda de um gravador participante na operação de restauração e [**IVssBackupComponents::P ostrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) pode retornar uma falha.</span><span class="sxs-lookup"><span data-stu-id="06e70-117">Further, VSS will generate an error indicating the loss of a participating writer in the restore operation, and [**IVssBackupComponents::PostRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-postrestore) may return a failure.</span></span>

 

 



