---
description: Um conjunto de backup é uma lista de todos os arquivos cujo backup será feito, suas localizações e como fazer backup deles.
ms.assetid: 34a66a9c-c1bc-437d-b034-59dc0c88228c
title: Gerando um conjunto de backup
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 827d9ecb90ac376aa9818b61e8dab65550ff8c50
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105810613"
---
# <a name="generating-a-backup-set"></a><span data-ttu-id="70d1a-103">Gerando um conjunto de backup</span><span class="sxs-lookup"><span data-stu-id="70d1a-103">Generating A Backup Set</span></span>

<span data-ttu-id="70d1a-104">Um conjunto de backup é uma lista de todos os arquivos cujo backup será feito, suas localizações e como fazer backup deles.</span><span class="sxs-lookup"><span data-stu-id="70d1a-104">A backup set is a list of all files to be backed up, their locations, and how to back them up.</span></span>

<span data-ttu-id="70d1a-105">Um solicitante deve fazer uso dos arquivos contidos nos volumes copiados por sombra após o [**IVssBackupComponents::D osnapshotset**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) retorna com êxito para gerar a lista completa de arquivos cujo backup será feito.</span><span class="sxs-lookup"><span data-stu-id="70d1a-105">A requester must make use of the files contained on the shadow-copied volumes after the [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) returns successfully to generate the full list of files to be backed up.</span></span>

<span data-ttu-id="70d1a-106">Além disso, um solicitante deve lidar com a possibilidade de que alguns arquivos tenham [*caminhos alternativos*](vssgloss-a.md) e que alguns arquivos tenham sido excluídos.</span><span class="sxs-lookup"><span data-stu-id="70d1a-106">In addition, a requester must deal with the possibility that some files have [*alternate paths*](vssgloss-a.md) and that some files have been excluded.</span></span>

<span data-ttu-id="70d1a-107">Um algoritmo para selecionar arquivos para fazer backup deve ir em uma [*instância de gravador*](vssgloss-w.md) por instância de gravador, base componente a componente (como será o caso durante a restauração; consulte [gerando um conjunto de restauração](generating-a-restore-set.md)) e pode continuar fazendo o seguinte:</span><span class="sxs-lookup"><span data-stu-id="70d1a-107">An algorithm for selecting files to back up should go on a [*writer instance*](vssgloss-w.md) by writer instance, component-by-component basis (as will be the case during restore; see [Generating a Restore Set](generating-a-restore-set.md)) and might proceed by doing the following:</span></span>

1.  <span data-ttu-id="70d1a-108">Determinando os volumes que contêm os arquivos do gravador e os objetos de dispositivo correspondentes</span><span class="sxs-lookup"><span data-stu-id="70d1a-108">Determining the volumes that contain the writer's files and the corresponding device objects</span></span>
2.  <span data-ttu-id="70d1a-109">Usando as informações de [*conjunto de arquivos*](vssgloss-f.md) (contidas em objetos [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) retornados por [**IVssExamineWriterMetadata::**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getexcludefile)getdelete) para criar uma lista dos arquivos explicitamente excluídos, se necessário, usando **FindFileFirst**, **FindFileFirstEx** e **FindNextFile**.</span><span class="sxs-lookup"><span data-stu-id="70d1a-109">Using the [*file set*](vssgloss-f.md) information (contained in [**IVssWMFiledesc**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswmfiledesc) objects returned by [**IVssExamineWriterMetadata::GetExcludeFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getexcludefile)) to create a list of the explicitly excluded files, if necessary using **FindFileFirst**, **FindFileFirstEx**, and **FindNextFile**.</span></span>
3.  <span data-ttu-id="70d1a-110">Iterando em todos os componentes de um gravador, usando [**IVssExamineWriterMetadata:: GetComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent).</span><span class="sxs-lookup"><span data-stu-id="70d1a-110">Iterating over all of a writer's components, using [**IVssExamineWriterMetadata::GetComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent).</span></span> <span data-ttu-id="70d1a-111">Se um componente selecionável for selecionado, use o [*caminho lógico*](vssgloss-l.md) para obter esses componentes não selecionáveis associados a ele em um conjunto de componentes.</span><span class="sxs-lookup"><span data-stu-id="70d1a-111">If a selectable component is selected, use [*logical path*](vssgloss-l.md) to obtain those nonselectable components associated with it in a component set.</span></span> <span data-ttu-id="70d1a-112">(Consulte [trabalhando com a seleção e os caminhos lógicos](working-with-selectability-and-logical-paths.md).)</span><span class="sxs-lookup"><span data-stu-id="70d1a-112">(See [Working with Selectability and Logical Paths](working-with-selectability-and-logical-paths.md).)</span></span>
4.  <span data-ttu-id="70d1a-113">Obter os [*conjuntos de arquivos*](vssgloss-f.md) contidos em cada componente selecionado usando a interface [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) correspondente a cada componente que ele contém.</span><span class="sxs-lookup"><span data-stu-id="70d1a-113">Obtaining the [*file sets*](vssgloss-f.md) contained in each selected component by using the [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface corresponding to each component it contains.</span></span>
5.  <span data-ttu-id="70d1a-114">Gerando uma lista de arquivos a partir das especificações — se necessário, usando **FindFileFirst**, **FindFileFirstEx** e **FindNextFile**.</span><span class="sxs-lookup"><span data-stu-id="70d1a-114">Generating a list of files from the specifications—if necessary using **FindFileFirst**, **FindFileFirstEx**, and **FindNextFile**.</span></span>
6.  <span data-ttu-id="70d1a-115">Verificando cada arquivo na lista gerada a partir de informações de componente em relação à lista de arquivos excluídos gerados acima.</span><span class="sxs-lookup"><span data-stu-id="70d1a-115">Checking each file in the list generated from component information against the list of excluded files generated above.</span></span> <span data-ttu-id="70d1a-116">Isso deve ser feito usando o caminho padrão para o arquivo (retornado por [**IVssWMFiledesc:: GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath)), não pelo caminho alternativo retornado por [**IVssWMFiledesc:: GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation)).</span><span class="sxs-lookup"><span data-stu-id="70d1a-116">This should be done using the default path for the file (returned by [**IVssWMFiledesc::GetPath**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getpath)), not by the alternate path returned by [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation)).</span></span> <span data-ttu-id="70d1a-117">Se o arquivo corresponder à lista excluída, não será feito backup dele.</span><span class="sxs-lookup"><span data-stu-id="70d1a-117">If the file matches the excluded list, it will not be backed up.</span></span>
7.  <span data-ttu-id="70d1a-118">Escolhendo o local real do qual fazer backup (usando o caminho alternativo se ele foi definido)</span><span class="sxs-lookup"><span data-stu-id="70d1a-118">Choosing the actual location from which to back up (using the alternate path if it was set)</span></span>
8.  <span data-ttu-id="70d1a-119">Neste ponto, uma lista completa de arquivos e seus locais estão disponíveis e um backup pode começar.</span><span class="sxs-lookup"><span data-stu-id="70d1a-119">At this point, a full list of files and their locations is available and a backup can begin.</span></span>

<span data-ttu-id="70d1a-120">Depois que um conjunto de backup inicial tiver sido gerado para todos os gravadores presentes no sistema, o solicitante verificará a seguinte chave do registro:</span><span class="sxs-lookup"><span data-stu-id="70d1a-120">After an initial backup set has been generated for all writers that are present on the system, the requester then checks the following registry key:</span></span>

<span data-ttu-id="70d1a-121">**HKEY \_ local \_ Machine \\ sistema \\ CurrentControlSet \\ Control \\ BackupRestore \\ FilesNotToBackup**</span><span class="sxs-lookup"><span data-stu-id="70d1a-121">**HKEY\_LOCAL\_MACHINE\\System\\CurrentControlSet\\Control\\BackupRestore\\FilesNotToBackup**</span></span>

<span data-ttu-id="70d1a-122">O solicitante usa as subchaves sob esta tecla da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="70d1a-122">The requester uses the subkeys under this key as follows:</span></span>

-   <span data-ttu-id="70d1a-123">Se um gravador estiver presente no sistema e houver uma subchave cujo nome corresponda ao nome do gravador, essa subchave deverá ser ignorada.</span><span class="sxs-lookup"><span data-stu-id="70d1a-123">If a writer is present on the system, and there is a subkey whose name matches the writer's name, that subkey must be ignored.</span></span>
-   <span data-ttu-id="70d1a-124">Se um gravador estava presente no sistema, mas estiver ausente atualmente no conjunto de backup e houver uma subchave correspondente, todos os arquivos especificados nos dados da subchave serão excluídos e deverão ser removidos do conjunto de backup.</span><span class="sxs-lookup"><span data-stu-id="70d1a-124">If a writer was present on the system but is currently absent from the backup set, and there is a matching subkey, any files specified in the subkey data are excluded and must be removed from the backup set.</span></span>
-   <span data-ttu-id="70d1a-125">O aplicativo de backup adiciona arquivos aos dados da subchave criando um \_ valor de vários sz contendo uma lista de especificações de arquivo para os arquivos cujo backup não deve ser feito.</span><span class="sxs-lookup"><span data-stu-id="70d1a-125">The backup application adds files to the subkey data by creating a MULTI\_SZ value containing a list of file specifications for the files that must not be backed up.</span></span> <span data-ttu-id="70d1a-126">Cada cadeia de caracteres no \_ valor de vários sz deve conter uma especificação de arquivo.</span><span class="sxs-lookup"><span data-stu-id="70d1a-126">Each string in the MULTI\_SZ value should contain one file specification.</span></span>
-   <span data-ttu-id="70d1a-127">As especificações de arquivo podem conter o?</span><span class="sxs-lookup"><span data-stu-id="70d1a-127">File specifications can contain the ?</span></span> <span data-ttu-id="70d1a-128">e \* caracteres curinga.</span><span class="sxs-lookup"><span data-stu-id="70d1a-128">and \* wildcard characters.</span></span> <span data-ttu-id="70d1a-129">Uma especificação pode ser tornada recursiva acrescentando/s ao final.</span><span class="sxs-lookup"><span data-stu-id="70d1a-129">A specification can be made recursive by appending /s to the end.</span></span> <span data-ttu-id="70d1a-130">Por exemplo, especificar "% TEMP% \\ \* /s" faz com que todos os arquivos no diretório% temp% e todos os seus subdiretórios não sejam submetidos a backup.</span><span class="sxs-lookup"><span data-stu-id="70d1a-130">For example, specifying "%TEMP%\\\* /s" causes all files in the %TEMP% directory and all of its subdirectories not to be backed up.</span></span>

 

 



