---
description: A seleção de restauração permite que o solicitante determine quando um componente pode ser restaurado individualmente.
ms.assetid: 684dc50f-5d7b-4c95-85dd-77c320d65fff
title: Trabalhando com a seleção para restauração e subcomponentes
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7d988f4c4e029c7dd8623ad22fcaee7662d33e82
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "104501725"
---
# <a name="working-with-selectability-for-restore-and-subcomponents"></a><span data-ttu-id="cf2e8-103">Trabalhando com a seleção para restauração e subcomponentes</span><span class="sxs-lookup"><span data-stu-id="cf2e8-103">Working with Selectability For Restore and Subcomponents</span></span>

<span data-ttu-id="cf2e8-104">A seleção de restauração permite que o solicitante determine quando um componente pode ser restaurado individualmente.</span><span class="sxs-lookup"><span data-stu-id="cf2e8-104">Selectability for restore allows the requester to determine when a component can be individually restored.</span></span> <span data-ttu-id="cf2e8-105">Um componente que foi incluído para backup pode aparecer de uma das duas maneiras:</span><span class="sxs-lookup"><span data-stu-id="cf2e8-105">A component that has been included for backup can appear in one of two ways:</span></span>

-   <span data-ttu-id="cf2e8-106">Um componente pode ter sido [*incluído explicitamente*](vssgloss-e.md) no backup.</span><span class="sxs-lookup"><span data-stu-id="cf2e8-106">A component may have been [*explicitly included*](vssgloss-e.md) in the backup.</span></span> <span data-ttu-id="cf2e8-107">Esses componentes têm uma instância [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) correspondente no documento componentes de backup.</span><span class="sxs-lookup"><span data-stu-id="cf2e8-107">These components have a corresponding [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) instance in the Backup Components Document.</span></span> <span data-ttu-id="cf2e8-108">Esses componentes são incluídos em uma restauração usando [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span><span class="sxs-lookup"><span data-stu-id="cf2e8-108">These components are included in a restore using [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).</span></span>
-   <span data-ttu-id="cf2e8-109">Um componente pode ter sido [*incluído implicitamente*](vssgloss-i.md) no backup.</span><span class="sxs-lookup"><span data-stu-id="cf2e8-109">A component may have been [*implicitly included*](vssgloss-i.md) in the backup.</span></span> <span data-ttu-id="cf2e8-110">Esses componentes não têm uma instância [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) correspondente no documento componentes de backup; no entanto, sempre haverá uma instância de **IVssComponent** para algum componente ancestral no documento.</span><span class="sxs-lookup"><span data-stu-id="cf2e8-110">These components do not have a corresponding [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) instance in the Backup Components Document; however, there will always be an **IVssComponent** instance for some ancestor component in the document.</span></span> <span data-ttu-id="cf2e8-111">Esses componentes são incluídos em uma restauração usando [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="cf2e8-111">These components are included in a restore using [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span>

<span data-ttu-id="cf2e8-112">Qualquer componente que tenha sido explicitamente incluído no backup sempre poderá ser selecionado individualmente para restauração, independentemente de seu valor de seleção para restauração.</span><span class="sxs-lookup"><span data-stu-id="cf2e8-112">Any component that has been explicitly included in the backup can always be individually selected for restore, regardless of its selectability-for-restore value.</span></span> <span data-ttu-id="cf2e8-113">O solicitante chama [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), passando a ID do gravador, o caminho lógico e o nome do componente específico.</span><span class="sxs-lookup"><span data-stu-id="cf2e8-113">The requester calls [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), passing in the writer ID, logical path, and name of the specific component.</span></span> <span data-ttu-id="cf2e8-114">Os componentes que foram incluídos implicitamente no backup serão restaurados quando um ancestral explicitamente incluído for restaurado.</span><span class="sxs-lookup"><span data-stu-id="cf2e8-114">Components that have been implicitly included in the backup will be restored when an explicitly included ancestor is restored.</span></span> <span data-ttu-id="cf2e8-115">Os componentes incluídos implicitamente podem ser selecionados individualmente para restauração somente se forem marcados como selecionáveis para restauração.</span><span class="sxs-lookup"><span data-stu-id="cf2e8-115">Implicitly included components can be individually selected for restore only if they are marked as selectable for restore.</span></span> <span data-ttu-id="cf2e8-116">Primeiro, o solicitante chama **IVssBackupComponents:: SetSelectedForRestore** no componente ancestral mais próximo incluído e, em seguida, chama [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) no componente ancestral para selecionar o componente incluído implicitamente para restauração.</span><span class="sxs-lookup"><span data-stu-id="cf2e8-116">The requester first calls **IVssBackupComponents::SetSelectedForRestore** on the closest explicitly included ancestor component, and then calls [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) on the ancestor component to select the implicitly included component for restore.</span></span> <span data-ttu-id="cf2e8-117">Depois que isso for feito, somente o componente selecionado implicitamente será restaurado; todos os outros componentes no conjunto de componentes não serão restaurados.</span><span class="sxs-lookup"><span data-stu-id="cf2e8-117">After this is done, only the implicitly selected component will be restored; all other components in the component set will not be restored.</span></span>

<span data-ttu-id="cf2e8-118">Ao contrário da seleção de backup, que sempre deve ser definida explicitamente quando um componente é adicionado com [**IVssCreateWriterMetadata:: addComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent), a seleção de Restore tem um valor padrão de false, que pode ser substituído.</span><span class="sxs-lookup"><span data-stu-id="cf2e8-118">Unlike selectability for backup, which must always be explicitly set when a component is added with [**IVssCreateWriterMetadata::AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent), selectability for restore has a default value of false, which can be overridden.</span></span>

<span data-ttu-id="cf2e8-119">Como os componentes de nível superior (componentes com um caminho lógico vazio) só podem ser incluídos explicitamente em um backup, a seleção de restauração não tem significado para esses componentes.</span><span class="sxs-lookup"><span data-stu-id="cf2e8-119">Because top-level components (components with an empty logical path) can only be explicitly included in a backup, selectability for restore has no meaning for these components.</span></span>

 

 



