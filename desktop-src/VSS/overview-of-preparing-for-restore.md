---
description: Ao se preparar para uma restauração, um solicitante usa os documentos de metadados do gravador armazenados em conjunto com seu próprio documento de componentes de backup recuperado para determinar o que será restaurado e como.
ms.assetid: 36cf188f-fce6-467c-a200-cbd9dc8f31a6
title: Visão geral da preparação para restauração
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d8b1bc3e429da5be9872e8345fe6da32a5340005
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105763763"
---
# <a name="overview-of-preparing-for-restore"></a><span data-ttu-id="55ecf-103">Visão geral da preparação para restauração</span><span class="sxs-lookup"><span data-stu-id="55ecf-103">Overview of Preparing for Restore</span></span>

<span data-ttu-id="55ecf-104">Ao se preparar para uma restauração, um solicitante usa os documentos de metadados do gravador armazenados em conjunto com seu próprio documento de componentes de backup recuperado para determinar o que será restaurado e como.</span><span class="sxs-lookup"><span data-stu-id="55ecf-104">In preparing for a restore, a requester uses the stored Writer Metadata Documents in conjunction with its own retrieved Backup Components Document to determine what is to be restored and how.</span></span> <span data-ttu-id="55ecf-105">Para obter mais informações, consulte [visão geral do processamento de uma restauração no VSS](overview-of-processing-a-restore-under-vss.md).</span><span class="sxs-lookup"><span data-stu-id="55ecf-105">For more information, see [Overview of Processing a Restore Under VSS](overview-of-processing-a-restore-under-vss.md).</span></span>

<span data-ttu-id="55ecf-106">Após a seleção dos componentes candidatos à restauração, os gravadores atualmente em execução no sistema acessam o documento de componentes de backup do solicitante.</span><span class="sxs-lookup"><span data-stu-id="55ecf-106">Following the selection of restore candidate components, writers currently running on the system access the requester's Backup Components Document.</span></span> <span data-ttu-id="55ecf-107">Os gravadores usam esse acesso para indicar como causar o mínimo de dificuldade para a execução de serviços devido à restauração.</span><span class="sxs-lookup"><span data-stu-id="55ecf-107">Writers use this access to indicate how to cause minimum difficulty for running services due to the restore.</span></span>

<span data-ttu-id="55ecf-108">Depois que isso for concluído, o solicitante terá informações suficientes para determinar quais arquivos precisarão ser restaurados, bem como onde e como eles devem ser restaurados.</span><span class="sxs-lookup"><span data-stu-id="55ecf-108">After this is completed, the requester has enough information to determine which files will need to be restored, as well as where and how they should be restored.</span></span> <span data-ttu-id="55ecf-109">(Para obter mais informações, consulte [gerando um conjunto de restauração](generating-a-restore-set.md).)</span><span class="sxs-lookup"><span data-stu-id="55ecf-109">(For more information, see [Generating a Restore Set](generating-a-restore-set.md).)</span></span>

<span data-ttu-id="55ecf-110">A tabela a seguir mostra a sequência de ações e eventos que são necessários para se preparar para uma operação de restauração.</span><span class="sxs-lookup"><span data-stu-id="55ecf-110">The following table shows the sequence of actions and events that are required to prepare for a restore operation.</span></span>



| <span data-ttu-id="55ecf-111">Ação do solicitante</span><span class="sxs-lookup"><span data-stu-id="55ecf-111">Requester action</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | <span data-ttu-id="55ecf-112">Evento</span><span class="sxs-lookup"><span data-stu-id="55ecf-112">Event</span></span>                                                         | <span data-ttu-id="55ecf-113">Ação do gravador</span><span class="sxs-lookup"><span data-stu-id="55ecf-113">Writer action</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="55ecf-114">Recuperar informações do documento de componentes de backup sobre os componentes [*incluídos explicitamente*](vssgloss-e.md) na operação de backup (consulte [**IVssBackupComponents:: GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents)) examine documentos de metadados do gravador recuperados para obter detalhes sobre esses componentes incluídos explicitamente no backup e quaisquer subcomponentes de localização [*implicitamente incluídos*](vssgloss-i.md) .</span><span class="sxs-lookup"><span data-stu-id="55ecf-114">Retrieve information from the Backup Components Document about the components [*explicitly included*](vssgloss-e.md) in the backup operation (see [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents)) Examine retrieved Writer Metadata Documents to get details about those components explicitly included in the backup, and any find [*implicitly included*](vssgloss-i.md) subcomponents.</span></span> <span data-ttu-id="55ecf-115">(Consulte [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata), [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent).)</span><span class="sxs-lookup"><span data-stu-id="55ecf-115">(See [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata), [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent).)</span></span><br/> | <span data-ttu-id="55ecf-116">Nenhum</span><span class="sxs-lookup"><span data-stu-id="55ecf-116">None</span></span>                                                          | <span data-ttu-id="55ecf-117">Nenhum</span><span class="sxs-lookup"><span data-stu-id="55ecf-117">None</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="55ecf-118">Selecione componentes e conjuntos de componentes a serem restaurados (consulte [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) e [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).)</span><span class="sxs-lookup"><span data-stu-id="55ecf-118">Select components and component sets to be restored (see [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) and [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).)</span></span>                                                                                                                                                                                                                                                                                                                                                                                          | <span data-ttu-id="55ecf-119">Nenhum</span><span class="sxs-lookup"><span data-stu-id="55ecf-119">None</span></span>                                                          | <span data-ttu-id="55ecf-120">Nenhum</span><span class="sxs-lookup"><span data-stu-id="55ecf-120">None</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <span data-ttu-id="55ecf-121">O solicitante permite que o gravador atualize o documento de componentes de backup e pode, opcionalmente, comunicar quaisquer opções de restauração especiais ao gravador.</span><span class="sxs-lookup"><span data-stu-id="55ecf-121">The requester allows the writer to update the Backup Components Document and may optionally communicate any special restore options to the writer.</span></span> <span data-ttu-id="55ecf-122">(Consulte [**IVssBackupComponents:: setrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions), [**IVssBackupComponents:: AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget)e [**IVssBackupComponents::P rerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).)</span><span class="sxs-lookup"><span data-stu-id="55ecf-122">(See [**IVssBackupComponents::SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions), [**IVssBackupComponents::AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget), and [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore).)</span></span>                                                                                                                                                                                                                                         | [<span data-ttu-id="55ecf-123">*Prerestore*</span><span class="sxs-lookup"><span data-stu-id="55ecf-123">*PreRestore*</span></span>](vssgloss-p.md) | <span data-ttu-id="55ecf-124">O gravador determina a participação na restauração, prepara os arquivos para restauração e, opcionalmente, modifica o documento de componentes de backup, se necessário.</span><span class="sxs-lookup"><span data-stu-id="55ecf-124">The writer determines participation in the restore, prepares files to restore, and optionally modifies Backup Components Document if necessary.</span></span> <span data-ttu-id="55ecf-125">(Consulte [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore), [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent), [**IVssComponent:: IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore), [**IVssComponent:: getrestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions), [**IVssComponent:: SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget), [**IVssComponent:: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata), [**IVssComponent:: AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget).)</span><span class="sxs-lookup"><span data-stu-id="55ecf-125">(See [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore), [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent), [**IVssComponent::IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore), [**IVssComponent::GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions), [**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget), [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata), [**IVssComponent::AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget).)</span></span> |
| <span data-ttu-id="55ecf-126">O solicitante aguarda os gravadores para manipular o evento de [**Prerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) com [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync).</span><span class="sxs-lookup"><span data-stu-id="55ecf-126">The requester waits on writers to handle the [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) event with [**IVssAsync**](/windows/desktop/api/Vss/nn-vss-ivssasync).</span></span> <span data-ttu-id="55ecf-127">Ele também deve verificar o status do gravador.</span><span class="sxs-lookup"><span data-stu-id="55ecf-127">It should also verify writer status.</span></span> <span data-ttu-id="55ecf-128">(Consulte [**IVssBackupComponents:: GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus), [**IVssBackupComponents:: GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus).)</span><span class="sxs-lookup"><span data-stu-id="55ecf-128">(See [**IVssBackupComponents::GatherWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwriterstatus), [**IVssBackupComponents::GetWriterStatus**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwriterstatus).)</span></span>                                                                                                                                                                                                                                                                                  | <span data-ttu-id="55ecf-129">Nenhum</span><span class="sxs-lookup"><span data-stu-id="55ecf-129">None</span></span>                                                          | <span data-ttu-id="55ecf-130">Nenhum</span><span class="sxs-lookup"><span data-stu-id="55ecf-130">None</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |



 

## <a name="requester-actions-during-restore-preparations"></a><span data-ttu-id="55ecf-131">Ações do solicitante durante a preparação da restauração</span><span class="sxs-lookup"><span data-stu-id="55ecf-131">Requester Actions during Restore Preparations</span></span>

<span data-ttu-id="55ecf-132">Para determinar quais componentes são candidatos para restauração, o solicitante deve fazer o seguinte:</span><span class="sxs-lookup"><span data-stu-id="55ecf-132">To determine which components are candidates for restore, the requester must do the following:</span></span>

-   <span data-ttu-id="55ecf-133">Estabeleça o componente e a estrutura do [*conjunto de componentes*](vssgloss-c.md) usada para fazer o backup.</span><span class="sxs-lookup"><span data-stu-id="55ecf-133">Establish the component and the [*component set*](vssgloss-c.md) structure used to make the backup.</span></span>
-   <span data-ttu-id="55ecf-134">Examine a seleção dos componentes [*para restauração*](vssgloss-s.md).</span><span class="sxs-lookup"><span data-stu-id="55ecf-134">Examine the components' [*selectability for restore*](vssgloss-s.md).</span></span>
-   <span data-ttu-id="55ecf-135">Use as diretrizes de seleção ([trabalhando com a seleção de restauração e subcomponentes](working-with-selectability-for-restore-and-subcomponents.md)) para escolher os componentes a serem incluídos.</span><span class="sxs-lookup"><span data-stu-id="55ecf-135">Use selectability guidelines ([Working with Selectability for Restore and Subcomponents](working-with-selectability-for-restore-and-subcomponents.md)) to choose components to include.</span></span>
-   <span data-ttu-id="55ecf-136">Use informações de [*conjunto de arquivos*](vssgloss-f.md) de componente para determinar quais arquivos na mídia de backup devem ser restaurados.</span><span class="sxs-lookup"><span data-stu-id="55ecf-136">Use component [*file set*](vssgloss-f.md) information to determine which files on the backup media must be restored.</span></span>

<span data-ttu-id="55ecf-137">Para fazer isso, o solicitante precisa examinar os componentes [*explicitamente incluídos*](vssgloss-e.md) no documento componentes de backup armazenados.</span><span class="sxs-lookup"><span data-stu-id="55ecf-137">To do this, the requester needs to examine [*explicitly included*](vssgloss-e.md) components in the stored Backup Components Document.</span></span> <span data-ttu-id="55ecf-138">Essas informações de componente estão disponíveis em uma base de gravador por gravador usando [**IVssBackupComponents:: GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents), que retorna instâncias da interface [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) , da qual as informações do gravador e as instâncias da interface [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) podem ser recuperadas.</span><span class="sxs-lookup"><span data-stu-id="55ecf-138">This component information is available on a writer-by-writer basis using [**IVssBackupComponents::GetWriterComponents**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-getwritercomponents), which returns instances of the [**IVssWriterComponentsExt**](/windows/win32/api/vsbackup/nl-vsbackup-ivsswritercomponentsext) interface, from which both writer information and instances of the [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interface can be retrieved.</span></span>

<span data-ttu-id="55ecf-139">Conforme observado em outro lugar ([uso de componentes pelo solicitante](use-of-components-by-the-requestor.md)), o documento componentes de backup e a interface **IVssComponent** não contêm informações suficientes para dar suporte ao backup.</span><span class="sxs-lookup"><span data-stu-id="55ecf-139">As noted elsewhere ([Use of Components by the Requester](use-of-components-by-the-requestor.md)), the Backup Components Document and the **IVssComponent** interface do not contain enough information to support the backup.</span></span> <span data-ttu-id="55ecf-140">Portanto, o solicitante deve examinar o documento de metadados do gravador armazenado correspondente usando [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) (consulte [informações de identificação do gravador](writer-metadata-document-contents.md)).</span><span class="sxs-lookup"><span data-stu-id="55ecf-140">Therefore, the requester must examine the corresponding stored Writer Metadata Document by using [**IVssExamineWriterMetadata**](/windows/desktop/api/VsBackup/nl-vsbackup-ivssexaminewritermetadata) (see [Writer Identification Information](writer-metadata-document-contents.md)).</span></span>

<span data-ttu-id="55ecf-141">O número de componentes gerenciados por cada gravador é retornado por [**IVssExamineWriterMetadata:: GetFileCounts**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getfilecounts).</span><span class="sxs-lookup"><span data-stu-id="55ecf-141">The number of components each writer manages is returned by [**IVssExamineWriterMetadata::GetFileCounts**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getfilecounts).</span></span> <span data-ttu-id="55ecf-142">O solicitante pode usar [**IVssExamineWriterMetadata:: GetComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent) para obter uma interface [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) para cada componente que um gravador gerencia.</span><span class="sxs-lookup"><span data-stu-id="55ecf-142">The requester can then use [**IVssExamineWriterMetadata::GetComponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getcomponent) to get an [**IVssWMComponent**](/windows/desktop/api/VsBackup/nl-vsbackup-ivsswmcomponent) interface for each component a writer manages.</span></span>

<span data-ttu-id="55ecf-143">Ao examinar a seleção dos componentes [*de backup*](vssgloss-s.md) e de [*caminhos lógicos*](vssgloss-l.md) (consulte [trabalhando com a seleção e os caminhos lógicos](working-with-selectability-and-logical-paths.md)), um solicitante é capaz de identificar os componentes que definiram conjuntos de componentes de tempo de backup (componentes explicitamente incluídos) e os membros dos subcomponentes desses conjuntos (componentes incluídos implicitamente).</span><span class="sxs-lookup"><span data-stu-id="55ecf-143">By examining the components' [*selectability for backup*](vssgloss-s.md) and [*logical paths*](vssgloss-l.md) (see [Working with Selectability and Logical Paths](working-with-selectability-and-logical-paths.md)), a requester is able to identify the components that defined backup-time component sets (explicitly included components), and the subcomponents members of those sets (implicitly included components).</span></span>

<span data-ttu-id="55ecf-144">Os solicitantes indicam o documento de componentes de backup se um componente deve ser restaurado explicitamente, usando [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) ou [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="55ecf-144">Requesters indicate through the Backup Components Document if a component is to be explicitly restored, using either [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) or [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span> <span data-ttu-id="55ecf-145">A escolha do método dependerá de como o backup do componente foi originalmente feito e de sua [*seleção de restauração*](vssgloss-s.md).</span><span class="sxs-lookup"><span data-stu-id="55ecf-145">The choice of method will depend on how the component was originally backed up and its [*selectability for restore*](vssgloss-s.md).</span></span> <span data-ttu-id="55ecf-146">Esses componentes incluídos explicitamente para a restauração designam outros componentes que são incluídos implicitamente (consulte [trabalhando com a seleção de restauração e subcomponentes](working-with-selectability-for-restore-and-subcomponents.md) para obter detalhes).</span><span class="sxs-lookup"><span data-stu-id="55ecf-146">These components explicitly included for restore designate other components which are implicitly included (see [Working with Selectability for Restore and Subcomponents](working-with-selectability-for-restore-and-subcomponents.md) for details).</span></span>

<span data-ttu-id="55ecf-147">Um solicitante pode incluir explicitamente nenhum dos componentes do gravador em execução no momento para restauração usando [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) ou [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="55ecf-147">A requester may explicitly include none of a currently executing writer's components for restore using [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) or [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).</span></span> <span data-ttu-id="55ecf-148">Nesse caso, esse gravador não receberá nenhum evento do VSS para o restante da operação de restauração.</span><span class="sxs-lookup"><span data-stu-id="55ecf-148">In this case, that writer will not receive any VSS events for the remainder of the restore operation.</span></span>

<span data-ttu-id="55ecf-149">O uso explícito de [**IVssBackupComponents:: SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) ou [**IVssBackupComponents:: AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) para selecionar um componente de um gravador que não está em execução no momento retorna um \_ erro de objeto VSS E \_ \_ não \_ encontrado.</span><span class="sxs-lookup"><span data-stu-id="55ecf-149">Explicitly using either [**IVssBackupComponents::SetSelectedForRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore) or [**IVssBackupComponents::AddRestoreSubcomponent**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) to select a component of a writer that is not currently running returns a VSS\_E\_OBJECT\_NOT\_FOUND error.</span></span> <span data-ttu-id="55ecf-150">Consulte restaurações [sem a participação do gravador](restores-without-writer-participation.md) para obter informações sobre como restaurar os dados de gravadores ausentes.</span><span class="sxs-lookup"><span data-stu-id="55ecf-150">See [Restores without Writer Participation](restores-without-writer-participation.md) for information on restoring the data of missing writers.</span></span>

<span data-ttu-id="55ecf-151">Para permitir que um gravador tenha informações completas sobre as quais agir, as opções de restauração específicas do gravador e a indicação de uma restauração incremental podem ser enviadas para os gravadores por chamadas do solicitante para [**IVssBackupComponents:: setrestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions) e [**IVssBackupComponents:: SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores), respectivamente.</span><span class="sxs-lookup"><span data-stu-id="55ecf-151">To enable a writer to have complete information upon which to act, writer-specific restore options and indication of an incremental restore can be sent to the writers by requester calls to [**IVssBackupComponents::SetRestoreOptions**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrestoreoptions) and [**IVssBackupComponents::SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores), respectively.</span></span>

<span data-ttu-id="55ecf-152">Neste ponto, um solicitante concluiu sua preparação e gera um evento de **Prerestore** chamando [**IVssBackupComponents::P rerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore), permitindo que os gravadores se preparem para a restauração real.</span><span class="sxs-lookup"><span data-stu-id="55ecf-152">At this point, a requester has finished its preparation, and it generates a **PreRestore** event by calling [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore), allowing writers to prepare for the actual restore.</span></span>

## <a name="writer-actions-during-restore-preparations"></a><span data-ttu-id="55ecf-153">Ações do gravador durante a preparação da restauração</span><span class="sxs-lookup"><span data-stu-id="55ecf-153">Writer Actions during Restore Preparations</span></span>

<span data-ttu-id="55ecf-154">A preparação do gravador para a operação de restauração ocorre ao manipular o evento de [**Prerestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) com o método virtual [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore).</span><span class="sxs-lookup"><span data-stu-id="55ecf-154">Writer preparation for the restore operation occurs when handling the [**PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) event with the virtual method [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore).</span></span> <span data-ttu-id="55ecf-155">A implementação padrão simplesmente retorna sem realizar nenhuma ação.</span><span class="sxs-lookup"><span data-stu-id="55ecf-155">The default implementation simply returns without taking any action.</span></span> <span data-ttu-id="55ecf-156">Os gravadores podem optar por substituir a implementação padrão para exercer mais controle por:</span><span class="sxs-lookup"><span data-stu-id="55ecf-156">Writers may choose to override the default implementation to exercise more control by:</span></span>

-   <span data-ttu-id="55ecf-157">Substituindo [*métodos de restauração*](vssgloss-r.md) por [*destinos de restauração*](vssgloss-r.md)</span><span class="sxs-lookup"><span data-stu-id="55ecf-157">Overriding [*restore methods*](vssgloss-r.md) with [*restore targets*](vssgloss-r.md)</span></span>
-   <span data-ttu-id="55ecf-158">Definindo [ *destinos direcionados*](vssgloss-d.md)</span><span class="sxs-lookup"><span data-stu-id="55ecf-158">Defining [*directed targets*](vssgloss-d.md)</span></span>
-   <span data-ttu-id="55ecf-159">Criando mensagens de erro e dados adicionais</span><span class="sxs-lookup"><span data-stu-id="55ecf-159">Creating error messages and additional data</span></span>
-   <span data-ttu-id="55ecf-160">Fornecendo informações de carimbo de backup</span><span class="sxs-lookup"><span data-stu-id="55ecf-160">Supplying backup stamp information</span></span>

<span data-ttu-id="55ecf-161">O manipulador de eventos [**CVssWriter:: OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore) recebe uma instância do [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents), da qual ele pode obter as interfaces do [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) para aqueles de seus componentes explicitamente incluídos no documento de componentes de backup durante o backup.</span><span class="sxs-lookup"><span data-stu-id="55ecf-161">The event handler [**CVssWriter::OnPreRestore**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-onprerestore) receives an instance of the [**IVssWriterComponents**](/windows/desktop/api/VsWriter/nl-vswriter-ivsswritercomponents), from which it can obtain [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) interfaces for those of its components explicitly included in the Backup Components Document during backup.</span></span>

<span data-ttu-id="55ecf-162">Informações sobre subcomponentes incluídos implicitamente nas operações de backup e explicitamente incluídas em restaurações usando uma instância do **IVssComponent** correspondente ao componente que definiu seu [*conjunto de componentes*](vssgloss-c.md)de backup.</span><span class="sxs-lookup"><span data-stu-id="55ecf-162">Information about subcomponents implicitly included in backup operations and explicitly included in restores by using an instance of the **IVssComponent** corresponding to the component that defined its backup [*component set*](vssgloss-c.md).</span></span>

<span data-ttu-id="55ecf-163">O método [**IVssComponent:: IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore) é usado para determinar se um componente explicitamente incluído para backup deve ser restaurado.</span><span class="sxs-lookup"><span data-stu-id="55ecf-163">The [**IVssComponent::IsSelectedForRestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-isselectedforrestore) method is used to determine whether an explicitly included for backup component is to be restored.</span></span>

<span data-ttu-id="55ecf-164">Para determinar se um subcomponente de backup foi incluído explicitamente na restauração, os gravadores usam [**IVssComponent:: GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent).</span><span class="sxs-lookup"><span data-stu-id="55ecf-164">To determine if a backup subcomponent was explicitly included in the restore, writers use [**IVssComponent::GetRestoreSubcomponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoresubcomponent).</span></span>

<span data-ttu-id="55ecf-165">O gravador deve examinar o [*conjunto de arquivos*](vssgloss-f.md) em cada componente e determinar se ele precisa executar ações para dar suporte à restauração.</span><span class="sxs-lookup"><span data-stu-id="55ecf-165">The writer should examine the [*file set*](vssgloss-f.md) in each component and determine if it needs to take actions to support the restore.</span></span> <span data-ttu-id="55ecf-166">O gravador precisará avaliar se deseja que seus arquivos atuais sejam substituídos ou se exigirá a restauração em novos locais.</span><span class="sxs-lookup"><span data-stu-id="55ecf-166">The writer will need to evaluate if it wants its current files overwritten, or if it will require restoration to new locations.</span></span> <span data-ttu-id="55ecf-167">As ações podem incluir o seguinte:</span><span class="sxs-lookup"><span data-stu-id="55ecf-167">Actions can include the following:</span></span>

-   <span data-ttu-id="55ecf-168">Obter e agir em qualquer opção específica de gravador ou solicitante que governa as operações de restauração (consulte [**IVssComponent:: getrestore**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions))</span><span class="sxs-lookup"><span data-stu-id="55ecf-168">Getting and acting on any writer- or requester-specific options governing restore operations (see [**IVssComponent::GetRestoreOptions**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoreoptions))</span></span>
-   <span data-ttu-id="55ecf-169">Fechar e tornar graváveis arquivos abertos no momento</span><span class="sxs-lookup"><span data-stu-id="55ecf-169">Closing and making writable any currently open files</span></span>
-   <span data-ttu-id="55ecf-170">Atualizando o destino de restauração (por exemplo, para forçar a restauração para um mapeamento de local alternativo).</span><span class="sxs-lookup"><span data-stu-id="55ecf-170">Updating the restore target (for instance, to force restoration to an alternate location mapping).</span></span> <span data-ttu-id="55ecf-171">Consulte [**IVssComponent:: SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget).</span><span class="sxs-lookup"><span data-stu-id="55ecf-171">See [**IVssComponent::SetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoretarget).</span></span>
-   <span data-ttu-id="55ecf-172">Comunicando-se com o solicitante por meio de metadados privados (consulte [**IVssComponent:: SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata))</span><span class="sxs-lookup"><span data-stu-id="55ecf-172">Communicating with the requester via private metadata (see [**IVssComponent::SetRestoreMetadata**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setrestoremetadata))</span></span>
-   <span data-ttu-id="55ecf-173">Indicando que um arquivo deve ser restaurado por remapeamento por meio da definição de [*destinos direcionados*](vssgloss-d.md) (consulte [**IVssComponent:: AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget))</span><span class="sxs-lookup"><span data-stu-id="55ecf-173">Indicating that a file should be restored by remapping through the definition of [*directed targets*](vssgloss-d.md) (see [**IVssComponent::AddDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddirectedtarget))</span></span>

<span data-ttu-id="55ecf-174">A instância de [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) usada será criada pela inclusão explícita do componente no documento de componentes de backup durante o backup ou a do componente que define o conjunto de componentes de backup do qual ele era um membro (consulte [trabalhando com a seleção para restauração e subcomponentes](working-with-selectability-for-restore-and-subcomponents.md)).</span><span class="sxs-lookup"><span data-stu-id="55ecf-174">The instance of [**IVssComponent**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) used will either be that created by the component's explicit inclusion in the Backup Components Document during backup, or that of the component defining the backup component set of which it was a member (see [Working with Selectability For Restore and Subcomponents](working-with-selectability-for-restore-and-subcomponents.md)).</span></span>

 

 
