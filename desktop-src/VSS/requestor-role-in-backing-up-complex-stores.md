---
description: Saiba mais sobre a função de solicitante em backups incrementais e diferenciais, que exigem cooperação estreita entre solicitantes e autores.
ms.assetid: 00391a49-8c81-4518-88a2-741ad5ee4ac3
title: Função do solicitante no back-up de armazenamentos complexos
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a84dfa1b0b1837bacc2488b6bd9e3ffdd51b92c0
ms.sourcegitcommit: d0eb44d0a95f5e5efbfec3d3e9c143f5cba25bc3
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/17/2021
ms.locfileid: "112262178"
---
# <a name="requester-role-in-backing-up-complex-stores"></a><span data-ttu-id="2515f-103">Função do solicitante no back-up de armazenamentos complexos</span><span class="sxs-lookup"><span data-stu-id="2515f-103">Requester Role in Backing Up Complex Stores</span></span>

<span data-ttu-id="2515f-104">Assim como com todas as operações importantes no VSS, [*backups*](vssgloss-d.md) [*incrementais*](vssgloss-i.md) e diferenciais exigem cooperação estreita entre solicitantes e autores.</span><span class="sxs-lookup"><span data-stu-id="2515f-104">As with all important operations under VSS, [*incremental*](vssgloss-i.md) and [*differential*](vssgloss-d.md) backups require close cooperation between requesters and writers.</span></span>

## <a name="backup-type"></a><span data-ttu-id="2515f-105">Tipo de backup</span><span class="sxs-lookup"><span data-stu-id="2515f-105">Backup Type</span></span>

<span data-ttu-id="2515f-106">A infraestrutura fornece suporte especial para cinco tipos de backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-106">The infrastructure provides special support for five types of backup.</span></span> <span data-ttu-id="2515f-107">Elas são descritas da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="2515f-107">They are described as follows:</span></span>

-   <span data-ttu-id="2515f-108">Full (**VSS \_ BT \_ FULL**).</span><span class="sxs-lookup"><span data-stu-id="2515f-108">Full (**VSS\_BT\_FULL**).</span></span> <span data-ttu-id="2515f-109">O backup dos arquivos será feito independentemente da data do último backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-109">Files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="2515f-110">O histórico de backup de cada arquivo será atualizado e esse tipo de backup pode ser usado como base de um backup incremental ou diferencial.</span><span class="sxs-lookup"><span data-stu-id="2515f-110">The backup history of each file will be updated, and this type of backup can be used as the basis of an incremental or differential backup.</span></span> <span data-ttu-id="2515f-111">Se houver arquivos de log, eles poderão ser truncados como resultado desse backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-111">If there are log files, they may be truncated as a result of this backup.</span></span>

    <span data-ttu-id="2515f-112">A restauração de um backup completo requer apenas uma única imagem de backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-112">Restoring a full backup requires only a single backup image.</span></span>

-   <span data-ttu-id="2515f-113">Diferencial (**VSS \_ BT \_ DIFFERENTIAL**).</span><span class="sxs-lookup"><span data-stu-id="2515f-113">Differential (**VSS\_BT\_DIFFERENTIAL**).</span></span> <span data-ttu-id="2515f-114">A API do VSS é usada para garantir que somente os arquivos que foram alterados ou adicionados desde o último backup completo sejam copiados para uma mídia de armazenamento; todas as informações de backup intermediárias são ignoradas.</span><span class="sxs-lookup"><span data-stu-id="2515f-114">The VSS API is used to ensure that only files that have been changed or added since the last full backup are to be copied to a storage medium; all intermediate backup information is ignored.</span></span> <span data-ttu-id="2515f-115">Isso pode incluir arquivos inteiros ou intervalos específicos dentro de arquivos.</span><span class="sxs-lookup"><span data-stu-id="2515f-115">This may include entire files, or specific ranges within files.</span></span> <span data-ttu-id="2515f-116">Um backup diferencial é associado a um backup completo e geralmente não pode ser restaurado até que o backup completo seja restaurado.</span><span class="sxs-lookup"><span data-stu-id="2515f-116">A differential backup is associated with a full backup, and generally cannot be restored until the full backup has been restored.</span></span> <span data-ttu-id="2515f-117">Se houver arquivos de log, eles geralmente não serão truncados como resultado desse backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-117">If there are log files, they will usually not be truncated as a result of this backup.</span></span>

    <span data-ttu-id="2515f-118">A restauração de um backup diferencial requer a imagem de backup original e a imagem de backup diferencial mais recente feita desde o último backup completo.</span><span class="sxs-lookup"><span data-stu-id="2515f-118">Restoring a differential backup requires the original backup image and the most recent differential backup image made since the last full backup.</span></span>

-   <span data-ttu-id="2515f-119">Incremental (**VSS \_ BT \_ INCREMENTAL**).</span><span class="sxs-lookup"><span data-stu-id="2515f-119">Incremental (**VSS\_BT\_INCREMENTAL**).</span></span> <span data-ttu-id="2515f-120">A API do VSS é usada para garantir que somente os arquivos que foram alterados ou adicionados desde o último backup completo ou incremental sejam copiados para uma mídia de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="2515f-120">The VSS API is used to ensure that only files that have been changed or added since the last full or incremental backup are to be copied to a storage medium.</span></span> <span data-ttu-id="2515f-121">Isso pode incluir arquivos inteiros ou intervalos específicos dentro de arquivos.</span><span class="sxs-lookup"><span data-stu-id="2515f-121">This may include entire files, or specific ranges within files.</span></span> <span data-ttu-id="2515f-122">Alguns autores não permitem que backups incrementais sejam mistos com backups diferenciais.</span><span class="sxs-lookup"><span data-stu-id="2515f-122">Some writers do not allow incremental backups to be mixed with differential backups.</span></span> <span data-ttu-id="2515f-123">Se houver arquivos de log, eles poderão ser truncados como resultado desse backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-123">If there are log files, they may be truncated as a result of this backup.</span></span>

    <span data-ttu-id="2515f-124">A restauração de um backup incremental requer a imagem de backup original e todas as imagens de backup incrementais feitas desde o backup inicial.</span><span class="sxs-lookup"><span data-stu-id="2515f-124">Restoring an incremental backup requires the original backup image and all incremental backup images made since the initial backup.</span></span>

-   <span data-ttu-id="2515f-125">Backup de log (**VSS \_ BT \_ LOG**).</span><span class="sxs-lookup"><span data-stu-id="2515f-125">Log Backup (**VSS\_BT\_LOG**).</span></span> <span data-ttu-id="2515f-126">Somente os arquivos de log de um autor (arquivos adicionados a um componente com o método [**IVssCreateWriterMetadata::AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) e recuperados por uma chamada para [**IVssWMComponent::GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)) terão o backup feito.</span><span class="sxs-lookup"><span data-stu-id="2515f-126">Only a writer's log files (files added to a component with the [**IVssCreateWriterMetadata::AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) method, and retrieved by a call to [**IVssWMComponent::GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)) will be backed up.</span></span> <span data-ttu-id="2515f-127">Esse tipo de backup é específico do VSS.</span><span class="sxs-lookup"><span data-stu-id="2515f-127">This backup type is specific to VSS.</span></span> <span data-ttu-id="2515f-128">Os backups de log tendem a ser feitos com muita frequência.</span><span class="sxs-lookup"><span data-stu-id="2515f-128">Log backups tend to be taken quite frequently.</span></span> <span data-ttu-id="2515f-129">Normalmente, o arquivo de log será truncado como resultado desse backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-129">Typically, the log file will be truncated as a result of this backup.</span></span>
-   <span data-ttu-id="2515f-130">Copiar backup (**VSS \_ BT \_ COPY**).</span><span class="sxs-lookup"><span data-stu-id="2515f-130">Copy Backup (**VSS\_BT\_COPY**).</span></span> <span data-ttu-id="2515f-131">Assim como o tipo de backup FULL DO VSS \_ \_ BT, os arquivos terão o backup feito independentemente da data do último backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-131">Like the VSS\_BT\_FULL backup type, files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="2515f-132">No entanto, o histórico de backup de cada arquivo não será atualizado e esse tipo de backup não pode ser usado como base de um backup incremental ou diferencial.</span><span class="sxs-lookup"><span data-stu-id="2515f-132">However, the backup history of each file will not be updated, and this sort of backup cannot be used as the basis of an incremental or differential backup.</span></span> <span data-ttu-id="2515f-133">Os arquivos de log nunca devem ser truncados como resultado de um backup de cópia.</span><span class="sxs-lookup"><span data-stu-id="2515f-133">Log files should never be truncated as a result of a copy backup.</span></span>

<dl> <dt>

<span data-ttu-id="2515f-134"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Suporte parcial a arquivos</span><span class="sxs-lookup"><span data-stu-id="2515f-134"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Partial File Support</span></span>
</dt> <dd>

<span data-ttu-id="2515f-135">Alguns autores suportam a restauração de arquivos por meio da substituição de partes dos arquivos que eles gerenciam.</span><span class="sxs-lookup"><span data-stu-id="2515f-135">Some writers support file restoration through the overwriting of parts of the files they manage.</span></span> <span data-ttu-id="2515f-136">Um solicitante pode ser projetado para tirar proveito disso e, nesse caso, ele indica isso definindo as informações em [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="2515f-136">A requester may be designed to take advantage of this, and if so it indicates this by setting the information in [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span>

</dd> </dl>

<span data-ttu-id="2515f-137">O solicitante especifica que tipo de backup está sendo executado por meio do parâmetro *backupType* de [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="2515f-137">The requester specifies what type of backup is being performed through the *backupType* parameter of [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span> <span data-ttu-id="2515f-138">Diferentes autores darão suporte a diferentes tipos de backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-138">Different writers will support different types of backup.</span></span> <span data-ttu-id="2515f-139">Depois [**que IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) for chamado, o solicitante poderá determinar quais tipos de backup um determinado autor dá suporte chamando [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="2515f-139">After [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) has been called, the requester can determine what types of backup a given writer supports by calling [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span> <span data-ttu-id="2515f-140">O valor retornado é uma máscara de bits que indica suporte para diferentes tipos de backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-140">The returned value is a bit mask indicating support for different backup types.</span></span> <span data-ttu-id="2515f-141">**VSS \_ BS \_ DIFFERENTIAL** indica suporte para backups diferenciais, **\_ VSS BS \_ INCREMENTAL** para backups incrementais, **LOG do VSS \_ BS \_ para** backups de log e **\_ VSS BS \_ COPY** para backups de cópia; todos os autores devem dar suporte a backups completos.</span><span class="sxs-lookup"><span data-stu-id="2515f-141">**VSS\_BS\_DIFFERENTIAL** indicates support for differential backups, **VSS\_BS\_INCREMENTAL** for incremental backups, **VSS\_BS\_LOG** for log backups, and **VSS\_BS\_COPY** for copy backups; all writers must support full backups.</span></span> <span data-ttu-id="2515f-142">Se um writer não dá suporte à combinação de backups incrementais com backups diferenciais, o sinalizador DIFERENCIAL INCREMENTAL EXCLUSIVO DO **\_ VSS BS \_ \_ \_** também será adicionado.</span><span class="sxs-lookup"><span data-stu-id="2515f-142">If a writer does not support mixing incremental backups with differential backups, the **VSS\_BS\_EXCLUSIVE\_INCREMENTAL\_DIFFERENTIAL** flag will be added as well.</span></span> <span data-ttu-id="2515f-143">Se o solicitante estiver executando um backup incremental ou diferencial e um determinado autor não dá suporte a esse tipo de backup, um backup completo deverá ser executado nesse autor.</span><span class="sxs-lookup"><span data-stu-id="2515f-143">If the requester is performing an incremental or differential backup and a given writer does not support that backup type, a full backup should be performed on that writer.</span></span>

## <a name="backup-stamps"></a><span data-ttu-id="2515f-144">Carimbos de backup</span><span class="sxs-lookup"><span data-stu-id="2515f-144">Backup Stamps</span></span>

<span data-ttu-id="2515f-145">Backups incrementais e diferenciais estão sempre vinculados a um backup anterior.</span><span class="sxs-lookup"><span data-stu-id="2515f-145">Incremental and differential backups are always tied to a previous backup.</span></span> <span data-ttu-id="2515f-146">Há duas maneiras de fazer backups.</span><span class="sxs-lookup"><span data-stu-id="2515f-146">There are two ways to tie backups.</span></span> <span data-ttu-id="2515f-147">Para armazenamentos de dados simples, o solicitante pode acompanhar a correlação entre backups.</span><span class="sxs-lookup"><span data-stu-id="2515f-147">For simple data stores, the requester can keep track of the correlation between backups.</span></span> <span data-ttu-id="2515f-148">No entanto, para armazenamentos de dados mais complexos, o autor precisará manter seu próprio timestamp com o backup; esse timestamp pode manter o controle da posição do log, das informações de ponto de verificação e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="2515f-148">However, for more complex data stores, the writer will need to maintain its own timestamp with the backup; this timestamp may keep track of log position, checkpoint information, and so on.</span></span> <span data-ttu-id="2515f-149">O solicitante pode determinar se um determinado autor precisa armazenar seu próprio data/hora verificando o bit **\_ \_ TIMESTAMPED do VSS BS** no valor retornado por [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="2515f-149">The requester can determine whether a given writer needs to store its own timestamp by checking for the **VSS\_BS\_TIMESTAMPED** bit in the value returned by [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span>

<span data-ttu-id="2515f-150">Os autores que armazenam um timestamp em um backup adicionarão o timestamp ao processar [**IVssBackupComponents::P repareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) ou ao processar [**IVssBackupComponents::D oSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="2515f-150">Writers that store a timestamp in a backup will add the timestamp either while processing [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) or while processing [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span> <span data-ttu-id="2515f-151">O solicitante pode obter esse timestamp chamando [**IVssComponent::GetBackupStamp.**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp)</span><span class="sxs-lookup"><span data-stu-id="2515f-151">The requester can obtain this timestamp by calling [**IVssComponent::GetBackupStamp**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getbackupstamp).</span></span> <span data-ttu-id="2515f-152">Ao executar um backup incremental ou diferencial, o solicitante precisa ligar o backup atual a algum backup anterior.</span><span class="sxs-lookup"><span data-stu-id="2515f-152">When performing an incremental or differential backup, the requester needs to tie the current backup to some previous backup.</span></span> <span data-ttu-id="2515f-153">Isso é feito obtendo o timestamp do backup anterior de um componente específico e passando-o para a função [**IVssBackupComponents::SetPreviousBackupStamp;**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) isso precisa ser feito para cada componente que foi feito backup no backup anterior.</span><span class="sxs-lookup"><span data-stu-id="2515f-153">This is done by obtaining the timestamp from the previous backup of a specific component and passing it into the [**IVssBackupComponents::SetPreviousBackupStamp**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setpreviousbackupstamp) function; this needs to be done for each component that was backed up in the previous backup.</span></span>

## <a name="backing-up-files"></a><span data-ttu-id="2515f-154">Fazer o back-up de arquivos</span><span class="sxs-lookup"><span data-stu-id="2515f-154">Backing Up Files</span></span>

### <a name="backing-up-files-reported-by-writer"></a><span data-ttu-id="2515f-155">Fazer o back-up de arquivos relatados pelo writer</span><span class="sxs-lookup"><span data-stu-id="2515f-155">Backing Up Files Reported by Writer</span></span>

<span data-ttu-id="2515f-156">Cada especificação de arquivo que um autor adiciona aos seus metadados durante a fase GatherWriterMetadata contém uma máscara de tipo de backup que especifica quando o arquivo deve ser feito backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-156">Every file specification that a writer adds to its metadata during the GatherWriterMetadata phase contains a backup type mask that specifies when the file should be backed up.</span></span> <span data-ttu-id="2515f-157">O solicitante determina o que é essa máscara chamando [**IVssWMFiledesc::GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask).</span><span class="sxs-lookup"><span data-stu-id="2515f-157">The requester determines what this mask is by calling [**IVssWMFiledesc::GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask).</span></span> <span data-ttu-id="2515f-158">Os valores nessa máscara são usados para determinar para quais tipos de backup a especificação de arquivo precisa ser feito backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-158">The values in this mask are used to determine for which backup types the file specification needs to be backed up.</span></span> <span data-ttu-id="2515f-159">A máscara pode conter um ou mais dos seguintes valores de bit:</span><span class="sxs-lookup"><span data-stu-id="2515f-159">The mask can contain one or more of the following bit values:</span></span>

<dl> <dt>

<span data-ttu-id="2515f-160"><span id="VSS_FSBT_FULL_BACKUP_REQUIRED"></span><span id="vss_fsbt_full_backup_required"></span>**BACKUP COMPLETO DO VSS \_ FSBT \_ \_ \_ NECESSÁRIO**</span><span class="sxs-lookup"><span data-stu-id="2515f-160"><span id="VSS_FSBT_FULL_BACKUP_REQUIRED"></span><span id="vss_fsbt_full_backup_required"></span>**VSS\_FSBT\_FULL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="2515f-161">Necessário para backups completos.</span><span class="sxs-lookup"><span data-stu-id="2515f-161">Required for full backups.</span></span>

</dd> <dt>

<span data-ttu-id="2515f-162"><span id="VSS_FSBT_DIFFERENTIAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_differential_backup_required"></span>**BACKUP \_ DIFERENCIAL DO VSS FSBT \_ \_ \_ NECESSÁRIO**</span><span class="sxs-lookup"><span data-stu-id="2515f-162"><span id="VSS_FSBT_DIFFERENTIAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_differential_backup_required"></span>**VSS\_FSBT\_DIFFERENTIAL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="2515f-163">Necessário para backups diferenciais.</span><span class="sxs-lookup"><span data-stu-id="2515f-163">Required for differential backups.</span></span>

</dd> <dt>

<span data-ttu-id="2515f-164"><span id="VSS_FSBT_INCREMENTAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_incremental_backup_required"></span>**BACKUP INCREMENTAL DO VSS \_ FSBT \_ \_ \_ NECESSÁRIO**</span><span class="sxs-lookup"><span data-stu-id="2515f-164"><span id="VSS_FSBT_INCREMENTAL_BACKUP_REQUIRED"></span><span id="vss_fsbt_incremental_backup_required"></span>**VSS\_FSBT\_INCREMENTAL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="2515f-165">Necessário para backups incrementais.</span><span class="sxs-lookup"><span data-stu-id="2515f-165">Required for incremental backups.</span></span>

</dd> <dt>

<span data-ttu-id="2515f-166"><span id="VSS_FSBT_LOG_BACKUP_REQUIRED"></span><span id="vss_fsbt_log_backup_required"></span>**BACKUP DE LOG DO VSS \_ FSBT \_ \_ \_ NECESSÁRIO**</span><span class="sxs-lookup"><span data-stu-id="2515f-166"><span id="VSS_FSBT_LOG_BACKUP_REQUIRED"></span><span id="vss_fsbt_log_backup_required"></span>**VSS\_FSBT\_LOG\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="2515f-167">Necessário para backups de log.</span><span class="sxs-lookup"><span data-stu-id="2515f-167">Required for log backups.</span></span>

</dd> <dt>

<span data-ttu-id="2515f-168"><span id="VSS_FSBT_ALL_BACKUP_REQUIRED"></span><span id="vss_fsbt_all_backup_required"></span>**VSS \_ FSBT \_ TODO O BACKUP \_ \_ NECESSÁRIO**</span><span class="sxs-lookup"><span data-stu-id="2515f-168"><span id="VSS_FSBT_ALL_BACKUP_REQUIRED"></span><span id="vss_fsbt_all_backup_required"></span>**VSS\_FSBT\_ALL\_BACKUP\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="2515f-169">Necessário para todos os tipos de backup; esse é o padrão.</span><span class="sxs-lookup"><span data-stu-id="2515f-169">Required for all backup types; this is the default.</span></span>

</dd> </dl>

<span data-ttu-id="2515f-170">Essa especificação substitui a especificação de seletividade do componente.</span><span class="sxs-lookup"><span data-stu-id="2515f-170">This specification overrides the component's selectivity specification.</span></span> <span data-ttu-id="2515f-171">Por exemplo, considere um componente cujos arquivos estão marcados com BACKUP DE LOG DO **\_ VSS \_ \_ \_ FSBT** OBRIGATÓRIO, mas não com **\_ VSS FSBT \_ FULL BACKUP \_ \_ REQUIRED.**</span><span class="sxs-lookup"><span data-stu-id="2515f-171">For example, consider a component whose files are all marked with **VSS\_FSBT\_LOG\_BACKUP\_REQUIRED** but not with **VSS\_FSBT\_FULL\_BACKUP\_REQUIRED**.</span></span> <span data-ttu-id="2515f-172">Suponha que esse componente não seja selecionável para backup (*bSelectable* era false quando [**IVssCreateWriterMetadata::AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent) foi chamado).</span><span class="sxs-lookup"><span data-stu-id="2515f-172">Suppose this component is not selectable for backup (*bSelectable* was false when [**IVssCreateWriterMetadata::AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent) was called).</span></span> <span data-ttu-id="2515f-173">No caso de um backup de log, isso significa que todos os arquivos neste componente sempre devem ser armazenados em backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-173">In the case of a log backup, this means that all the files in this component must always be backed up.</span></span> <span data-ttu-id="2515f-174">No entanto, no caso de um backup completo, nenhum dos arquivos precisa ser feito backup, apesar do fato de que a seletividade do componente implica que ele deve ser feito backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-174">However, in the case of a full backup, none of the files need to be backed up, despite the fact that the component's selectivity implies it should be backed up.</span></span>

### <a name="backup-by-last-modify-time"></a><span data-ttu-id="2515f-175">Backup por Hora da Última Modificação</span><span class="sxs-lookup"><span data-stu-id="2515f-175">Backup by Last Modify Time</span></span>

<span data-ttu-id="2515f-176">As informações de especificação de arquivo especificadas na fase [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) não dão ao solicitante informações sobre o que mudou desde o último backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-176">The file specification information specified in the [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) phase does not give the requester information about what has changed since the last backup.</span></span> <span data-ttu-id="2515f-177">Uma maneira de um autor indicar alterações no solicitante é usando o mecanismo de arquivo diferente.</span><span class="sxs-lookup"><span data-stu-id="2515f-177">One way for a writer to indicate changes to the requester is by using the differenced file mechanism.</span></span> <span data-ttu-id="2515f-178">Um autor pode especificar que determinados arquivos em um componente devem ser armazenados em backup somente se eles foram modificados desde um determinado momento; O autor pode especificar esses arquivos em [**IVssBackupComponents::P repareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) ou em [**IVssBackupComponents::D oSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="2515f-178">A writer can specify that certain files in a component should be backed up only if they have been modified since a certain time; the writer may specify these files either in [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) or in [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span> <span data-ttu-id="2515f-179">Um solicitante pode determinar esses arquivos chamando [**IVssComponent::GetDifferencedFilesCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfilescount) e [**IVssComponent::GetDifferencedFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile).</span><span class="sxs-lookup"><span data-stu-id="2515f-179">A requester can determine these files by calling [**IVssComponent::GetDifferencedFilesCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfilescount) and [**IVssComponent::GetDifferencedFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdifferencedfile).</span></span> <span data-ttu-id="2515f-180">Se a especificação de arquivo corresponde a um conjunto em **IVssBackupComponents::GatherWriterMetadata** (que atualmente é válido com base na máscara de tipo de backup), as informações de arquivo diferença substituem as informações anteriores; ou seja, os arquivos correspondentes a essa especificação de arquivo agora terão o backup feito somente se eles foram modificados desde o horário especificado.</span><span class="sxs-lookup"><span data-stu-id="2515f-180">If the file specification matches one set in **IVssBackupComponents::GatherWriterMetadata** (that is currently valid based on the backup type mask) the differenced file information overrides the previous information; that is, the files matching that file specification are now backed up only if they have been modified since the specified time.</span></span> <span data-ttu-id="2515f-181">A hora da última modificação é comunicada usando uma [**estrutura FILETIME.**](/windows/win32/api/minwinbase/ns-minwinbase-filetime)</span><span class="sxs-lookup"><span data-stu-id="2515f-181">The last-modify time is communicated using a [**FILETIME**](/windows/win32/api/minwinbase/ns-minwinbase-filetime) structure.</span></span> <span data-ttu-id="2515f-182">Se o valor dessa estrutura for zero, isso implica que a hora da última modificação deve ser determinada com base no registro do solicitante da hora do último backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-182">If the value of this structure is zero, this implies that the last-modify time should be determined based on the requester's record of the time of last backup.</span></span>

### <a name="partial-file-backup"></a><span data-ttu-id="2515f-183">Backup parcial de arquivo</span><span class="sxs-lookup"><span data-stu-id="2515f-183">Partial File Backup</span></span>

<span data-ttu-id="2515f-184">Outra maneira de um autor indicar alterações no solicitante é usando o mecanismo de arquivo parcial.</span><span class="sxs-lookup"><span data-stu-id="2515f-184">Another way for a writer to indicate changes to the requester is by using the partial file mechanism.</span></span> <span data-ttu-id="2515f-185">Um autor pode especificar intervalos de byte em arquivos de componente que precisam ser armazenados em backup; O autor pode especificar esses intervalos de arquivos [**em IVssBackupComponents::P repareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) ou em [**IVssBackupComponents::D oSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="2515f-185">A writer can specify byte ranges within component files that need to be backed up; the writer can specify these file ranges either in [**IVssBackupComponents::PrepareForBackup**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prepareforbackup) or in [**IVssBackupComponents::DoSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).</span></span> <span data-ttu-id="2515f-186">Um solicitante pode determinar esses arquivos chamando [**IVssComponent::GetPartialFileCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfilecount) e [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span><span class="sxs-lookup"><span data-stu-id="2515f-186">A requester can determine these files by calling [**IVssComponent::GetPartialFileCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfilecount) and [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span></span> <span data-ttu-id="2515f-187">**IVssComponent::GetPartialFile** retornará um caminho e um nome de arquivo apontando para o arquivo e uma cadeia de caracteres de intervalos que indica o que precisa ser feito backup no arquivo.</span><span class="sxs-lookup"><span data-stu-id="2515f-187">**IVssComponent::GetPartialFile** will return a path and a file name pointing to the file, and a ranges string indicating what needs to be backed up in the file.</span></span> <span data-ttu-id="2515f-188">Assim como acontece com arquivos de diferença, se o caminho e o nome do arquivo corresponde a uma especificação de arquivo definida pelo autor em [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), as informações de arquivo parcial substituem a configuração anterior.</span><span class="sxs-lookup"><span data-stu-id="2515f-188">As with differenced files, if the path and file name matches a file specification set by the writer in [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata), the partial-file information overrides the previous setting.</span></span> <span data-ttu-id="2515f-189">A cadeia de caracteres de intervalos pode ter dois formatos: pode especificar os intervalos diretamente ou pode especificar um arquivo que contém informações de intervalos.</span><span class="sxs-lookup"><span data-stu-id="2515f-189">The ranges string can have two formats: it can either specify the ranges directly, or it can specify a file containing ranges information.</span></span> <span data-ttu-id="2515f-190">Se especificar intervalos diretamente, a sintaxe será uma lista separada por vírgulas do formulário offset1:length1, offset2:length2, em que cada deslocamento e comprimento é um inteiro sem sinal de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="2515f-190">If specifying ranges directly, the syntax is a comma-separated list of the form offset1:length1, offset2:length2, where each offset and length is a 64-bit unsigned integer.</span></span> <span data-ttu-id="2515f-191">Se especificar um arquivo de intervalos, a cadeia de caracteres de intervalos deverá ser definida como File= *filename*, em que *filename* é o caminho completo para o arquivo de intervalos.</span><span class="sxs-lookup"><span data-stu-id="2515f-191">If specifying a ranges file, the ranges string should be set to File= *filename*, where *filename* is the full path to the ranges file.</span></span> <span data-ttu-id="2515f-192">O próprio arquivo de intervalos é um arquivo binário formatado como uma lista de inteiros sem sinal de 64 bits.</span><span class="sxs-lookup"><span data-stu-id="2515f-192">The ranges file itself is a binary file that is formatted as a list of 64-bit unsigned integers.</span></span> <span data-ttu-id="2515f-193">O primeiro inteiro indica quantos intervalos são representados no arquivo.</span><span class="sxs-lookup"><span data-stu-id="2515f-193">The first integer indicates how many ranges are represented in the file.</span></span> <span data-ttu-id="2515f-194">Cada par subsequente de inteiros representa o deslocamento e o comprimento de um intervalo.</span><span class="sxs-lookup"><span data-stu-id="2515f-194">Each subsequent pair of integers represents the offset and length of a range.</span></span> <span data-ttu-id="2515f-195">O solicitante deve tomar cuidado para fazer backup e restaurar esse arquivo de intervalos também.</span><span class="sxs-lookup"><span data-stu-id="2515f-195">The requester must take care to back up and restore this ranges file as well.</span></span>

### <a name="file-specification-rules"></a><span data-ttu-id="2515f-196">Regras de especificação de arquivo</span><span class="sxs-lookup"><span data-stu-id="2515f-196">File Specification Rules</span></span>

<span data-ttu-id="2515f-197">As especificações de arquivo adicionadas por meio do arquivo diferente e dos mecanismos de arquivo parcial modificarão as especificações de arquivo definidas em [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) ou adicionarão arquivos completamente novos.</span><span class="sxs-lookup"><span data-stu-id="2515f-197">File specifications added through the differenced-file and the partial-file mechanisms will either modify file specifications set in [**IVssBackupComponents::GatherWriterMetadata**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-gatherwritermetadata) or add completely new files.</span></span> <span data-ttu-id="2515f-198">Se modificar as especificações de arquivos definidas em **IVssBackupComponents::GatherWriterMetadata** usando o mecanismo de arquivo parcial, um solicitante poderá esperar que a especificação do arquivo corresponder exatamente a uma das especificações de arquivo definidas no componente **em IVssBackupComponents::GatherWriterMetadata**.</span><span class="sxs-lookup"><span data-stu-id="2515f-198">If modifying files specifications set in **IVssBackupComponents::GatherWriterMetadata** using the partial-file mechanism, then a requester can expect the file specification to exactly match one of the file specifications set in the component in **IVssBackupComponents::GatherWriterMetadata**.</span></span> <span data-ttu-id="2515f-199">A especificação de arquivo não se sobrepõe parcialmente a outra especificação de arquivo e não corresponderá a nenhuma especificação de arquivo em nenhum outro dos componentes desse autor.</span><span class="sxs-lookup"><span data-stu-id="2515f-199">The file specification will not partially overlap another file specification, and it will not match any file specifications in any other of that writer's components.</span></span> <span data-ttu-id="2515f-200">As especificações de arquivo adicionadas usando o mecanismo de arquivo parcial podem, no entanto, sobrepor parcialmente outra especificação de arquivo.</span><span class="sxs-lookup"><span data-stu-id="2515f-200">File specifications added using the partial-file mechanism can, however, partially overlap another file specification.</span></span> <span data-ttu-id="2515f-201">Quando isso for verdadeiro, a especificação de arquivo diferenciado ou de arquivo parcial substituirá a especificação definida em **IVssBackupComponents:: GatherWriterMetadata**.</span><span class="sxs-lookup"><span data-stu-id="2515f-201">When this is true, the differenced-file or partial-file specification overrides the specification set in **IVssBackupComponents::GatherWriterMetadata**.</span></span> <span data-ttu-id="2515f-202">As especificações de arquivo geral podem ter um valor de local alternativo (retornado por [**IVssWMFiledesc:: GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation)) que indica um local alternativo para obter o arquivo no momento do backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-202">General file specifications can have an alternate-location value (returned by [**IVssWMFiledesc::GetAlternateLocation**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getalternatelocation)) that indicates an alternate place to obtain the file from at backup time.</span></span> <span data-ttu-id="2515f-203">Se as especificações de arquivo definidas por meio dos mecanismos de arquivo diferenciado ou de arquivo parcial corresponderem a uma especificação de arquivos existente que tenha um local alternativo, os dados deverão ser coletados nesse local alternativo.</span><span class="sxs-lookup"><span data-stu-id="2515f-203">If the file specifications set through the differenced-file or partial file mechanisms match an existing files specification that has an alternate location, the data should be picked up from this alternate location.</span></span> <span data-ttu-id="2515f-204">Se as especificações de arquivo definidas por meio dos mecanismos diferenciados-arquivo ou arquivo parcial não corresponderem a nenhuma especificação existente para o componente, então, esses intervalos de arquivos agora devem ser adicionados ao backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-204">If the file specifications set through the differenced-file or partial-file mechanisms do not match any existing specifications for the component, then these file ranges should now be added to the backup.</span></span> <span data-ttu-id="2515f-205">O solicitante pode esperar que somente os arquivos em volumes que já foram incluídos no conjunto de cópias de sombra serão adicionados usando um desses mecanismos.</span><span class="sxs-lookup"><span data-stu-id="2515f-205">The requester can expect that only files on volumes that have already been included in the shadow copy set will be added using one of these mechanisms.</span></span>

### <a name="backup-without-a-shadow-copy"></a><span data-ttu-id="2515f-206">Backup sem uma cópia de sombra</span><span class="sxs-lookup"><span data-stu-id="2515f-206">Backup without a Shadow Copy</span></span>

<span data-ttu-id="2515f-207">É possível que certos tipos de arquivos não precisem ser submetidos a backup de um volume de cópia de sombra.</span><span class="sxs-lookup"><span data-stu-id="2515f-207">Certain types of files may not need to be backed up off of a shadow copy volume.</span></span> <span data-ttu-id="2515f-208">Por exemplo, isso geralmente será verdadeiro para arquivos de log de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="2515f-208">For example, this will often be true of database log files.</span></span> <span data-ttu-id="2515f-209">Como os arquivos de log crescem de forma monotônico, e um gravador pode especificar exatamente quais partes do arquivo fazer backup usando arquivos parciais, muitas vezes será possível fazer backup do volume original.</span><span class="sxs-lookup"><span data-stu-id="2515f-209">Since log files grow monotonically, and a writer can specify exactly what portions of the file to back up using partial files, it will often be possible to backup the log off the original volume.</span></span> <span data-ttu-id="2515f-210">Como uma otimização, um gravador pode marcar quais arquivos exigem cópias de sombra para tipos de backup diferentes usando a máscara de tipo de backup.</span><span class="sxs-lookup"><span data-stu-id="2515f-210">As an optimization, a writer can mark which files require shadow copies for different backup types using the backup-type mask.</span></span> <span data-ttu-id="2515f-211">O valor retornado de [**IVssWMFiledesc:: GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask) pode conter um ou mais dos seguintes valores de bits:</span><span class="sxs-lookup"><span data-stu-id="2515f-211">The value returned from [**IVssWMFiledesc::GetBackupTypeMask**](/windows/desktop/api/VsWriter/nf-vswriter-ivsswmfiledesc-getbackuptypemask) can contain one or more of the following bit values:</span></span>

<dl> <dt>

<span data-ttu-id="2515f-212"><span id="VSS_FSBT_FULL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_full_snapshot_required"></span>**\_instantâneo completo do VSS FSBT \_ \_ \_ necessário**</span><span class="sxs-lookup"><span data-stu-id="2515f-212"><span id="VSS_FSBT_FULL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_full_snapshot_required"></span>**VSS\_FSBT\_FULL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="2515f-213">Cópia de sombra necessária para backups completos.</span><span class="sxs-lookup"><span data-stu-id="2515f-213">Shadow copy required for full backups.</span></span>

</dd> <dt>

<span data-ttu-id="2515f-214"><span id="VSS_FSBT_DIFFERENTIAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_differential_snapshot_required"></span>**\_ \_ instantâneo diferencial do VSS FSBT \_ \_ necessário**</span><span class="sxs-lookup"><span data-stu-id="2515f-214"><span id="VSS_FSBT_DIFFERENTIAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_differential_snapshot_required"></span>**VSS\_FSBT\_DIFFERENTIAL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="2515f-215">Cópia de sombra necessária para backups diferenciais.</span><span class="sxs-lookup"><span data-stu-id="2515f-215">Shadow copy required for differential backups.</span></span>

</dd> <dt>

<span data-ttu-id="2515f-216"><span id="VSS_FSBT_INCREMENTAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_incremental_snapshot_required"></span>**\_instantâneo incremental do VSS FSBT \_ \_ \_ necessário**</span><span class="sxs-lookup"><span data-stu-id="2515f-216"><span id="VSS_FSBT_INCREMENTAL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_incremental_snapshot_required"></span>**VSS\_FSBT\_INCREMENTAL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="2515f-217">Cópia de sombra necessária para backups incrementais.</span><span class="sxs-lookup"><span data-stu-id="2515f-217">Shadow copy required for incremental backups.</span></span>

</dd> <dt>

<span data-ttu-id="2515f-218"><span id="VSS_FSBT_LOG_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_log_snapshot_required"></span>**instantâneo de log de FSBT do VSS \_ \_ \_ \_ necessário**</span><span class="sxs-lookup"><span data-stu-id="2515f-218"><span id="VSS_FSBT_LOG_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_log_snapshot_required"></span>**VSS\_FSBT\_LOG\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="2515f-219">Cópia de sombra necessária para backups de log.</span><span class="sxs-lookup"><span data-stu-id="2515f-219">Shadow copy required for log backups.</span></span>

</dd> <dt>

<span data-ttu-id="2515f-220"><span id="VSS_FSBT_ALL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_all_snapshot_required"></span>**\_FSBT VSS \_ todos os \_ instantâneos \_ necessários**</span><span class="sxs-lookup"><span data-stu-id="2515f-220"><span id="VSS_FSBT_ALL_SNAPSHOT_REQUIRED"></span><span id="vss_fsbt_all_snapshot_required"></span>**VSS\_FSBT\_ALL\_SNAPSHOT\_REQUIRED**</span></span>
</dt> <dd>

<span data-ttu-id="2515f-221">Cópia de sombra necessária para todos os tipos de backup; Esse é o padrão.</span><span class="sxs-lookup"><span data-stu-id="2515f-221">Shadow copy required for all backup types; this is the default.</span></span>

</dd> </dl>

<span data-ttu-id="2515f-222">Se um volume específico contiver apenas componentes que não exigem uma cópia de sombra para esse backup, o solicitante poderá ignorar a etapa de criação de uma cópia de sombra para esse volume.</span><span class="sxs-lookup"><span data-stu-id="2515f-222">If a specific volume contains only components that do not require a shadow copy for this backup, the requester can skip the step of creating a shadow copy for this volume.</span></span> <span data-ttu-id="2515f-223">Todos os dados nesse volume podem ser copiados para a mídia de backup diretamente do volume original.</span><span class="sxs-lookup"><span data-stu-id="2515f-223">All the data on this volume can be copied to the backup media directly from the original volume.</span></span>

## <a name="restoring-files"></a><span data-ttu-id="2515f-224">Restaurando arquivos</span><span class="sxs-lookup"><span data-stu-id="2515f-224">Restoring Files</span></span>

### <a name="sequential-restores"></a><span data-ttu-id="2515f-225">Restaurações sequenciais</span><span class="sxs-lookup"><span data-stu-id="2515f-225">Sequential Restores</span></span>

<span data-ttu-id="2515f-226">Depois que o solicitante é executado executando uma operação de restauração, ele envia o evento de restauração para todos os gravadores.</span><span class="sxs-lookup"><span data-stu-id="2515f-226">After the requester is done performing a restore operation, it sends the PostRestore event to all writers.</span></span> <span data-ttu-id="2515f-227">Em geral, os gravadores lidam com esse evento realizando recuperação ou outras operações de pós-restauração.</span><span class="sxs-lookup"><span data-stu-id="2515f-227">Generally, writers handle this event by performing recovery or other post-restore operations.</span></span> <span data-ttu-id="2515f-228">No entanto, a restauração de backups incrementais geralmente ocorre como uma sequência de operações de restauração, uma por backup incremental.</span><span class="sxs-lookup"><span data-stu-id="2515f-228">Restoration of incremental backups, however, usually happen as a sequence of restore operations, one per incremental backup.</span></span> <span data-ttu-id="2515f-229">O solicitante precisa informar ao gravador que tal restauração está em andamento para evitar que a recuperação ou outras operações indesejadas ocorram até que a restauração seja concluída.</span><span class="sxs-lookup"><span data-stu-id="2515f-229">The requester needs to inform the writer that such a restoration is in progress in order to prevent recovery or other undesirable operations from happening until the restore is completely done.</span></span> <span data-ttu-id="2515f-230">Isso é feito chamando [**IVssBackupComponents:: SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores).</span><span class="sxs-lookup"><span data-stu-id="2515f-230">This is done by calling [**IVssBackupComponents::SetAdditionalRestores**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setadditionalrestores).</span></span> <span data-ttu-id="2515f-231">Esse método é chamado por componente e indica para o gravador que mais restaurações são recebidas para esse componente.</span><span class="sxs-lookup"><span data-stu-id="2515f-231">This method is called per component, and indicates to the writer that more restores are coming for that component.</span></span> <span data-ttu-id="2515f-232">Para a restauração final na sequência, o sinalizador de restaurações adicionais deve ser definido como false (seu valor padrão), que indica que esta é a última restauração na sequência para esse componente.</span><span class="sxs-lookup"><span data-stu-id="2515f-232">For the final restore in the sequence, the additional-restores flag should be set to false (its default value), which indicates that this is the last restore in the sequence for that component.</span></span>

### <a name="new-targets"></a><span data-ttu-id="2515f-233">Novos destinos</span><span class="sxs-lookup"><span data-stu-id="2515f-233">New Targets</span></span>

<span data-ttu-id="2515f-234">Se houver suporte do gravador, o solicitante poderá restaurar arquivos de dados para um local diferente do local de tempo de backup original.</span><span class="sxs-lookup"><span data-stu-id="2515f-234">If supported by the writer, the requester can restore data files to a location other than the original backup-time location.</span></span> <span data-ttu-id="2515f-235">O solicitante pode verificar esse suporte chamando [**IVssExamineWriterMetadata:: GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span><span class="sxs-lookup"><span data-stu-id="2515f-235">The requester can check for this support by calling [**IVssExamineWriterMetadata::GetBackupSchema**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).</span></span> <span data-ttu-id="2515f-236">O **gravador do VSS \_ BS \_ \_ dá suporte ao \_ novo \_** bit de destino será definido se o gravador oferecer suporte a esse comportamento.</span><span class="sxs-lookup"><span data-stu-id="2515f-236">The **VSS\_BS\_WRITER\_SUPPORTS\_NEW\_TARGET** bit will be set if the writer supports this behavior.</span></span> <span data-ttu-id="2515f-237">O solicitante informa o gravador do novo local chamando [**IVssBackupComponents:: AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget) para cada especificação de arquivo realocado.</span><span class="sxs-lookup"><span data-stu-id="2515f-237">The requester informs the writer of the new location by calling [**IVssBackupComponents::AddNewTarget**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addnewtarget) for each relocated file specification.</span></span> <span data-ttu-id="2515f-238">O solicitante também pode optar por restaurar um arquivo de intervalos específico para um local diferente.</span><span class="sxs-lookup"><span data-stu-id="2515f-238">The requester can also decide to restore a specific ranges file to a different location.</span></span> <span data-ttu-id="2515f-239">O solicitante informa o gravador dessa alteração chamando [**IVssBackupComponents:: SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath).</span><span class="sxs-lookup"><span data-stu-id="2515f-239">The requester informs the writer of this change by calling [**IVssBackupComponents::SetRangesFilePath**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setrangesfilepath).</span></span>

### <a name="directed-targets"></a><span data-ttu-id="2515f-240">Destinos direcionados</span><span class="sxs-lookup"><span data-stu-id="2515f-240">Directed Targets</span></span>

<span data-ttu-id="2515f-241">Para cenários de restauração complicadas, um gravador pode querer mapear intervalos de um arquivo de backup em diferentes intervalos do mesmo arquivo ou de outro.</span><span class="sxs-lookup"><span data-stu-id="2515f-241">For complicated restore scenarios, a writer may want to map ranges of a backed-up file onto different ranges of the same or a different file.</span></span> <span data-ttu-id="2515f-242">Isso pode ser feito usando o mecanismo direcionado de destino.</span><span class="sxs-lookup"><span data-stu-id="2515f-242">This can be done by using the directed target mechanism.</span></span> <span data-ttu-id="2515f-243">O solicitante pode determinar após a fase de [**Rerestauração IVssBackupComponents::P**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) que esse mecanismo está sendo usado para um componente chamando [**IVssComponent:: GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget) e verificando um retorno do **VSS \_ RT \_ direcionado**.</span><span class="sxs-lookup"><span data-stu-id="2515f-243">The requester can determine after the [**IVssBackupComponents::PreRestore**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) phase that this mechanism is being used for a component by calling [**IVssComponent::GetRestoreTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getrestoretarget) and checking for a return of **VSS\_RT\_DIRECTED**.</span></span> <span data-ttu-id="2515f-244">O solicitante pode obter todas essas restaurações redirecionadas chamando [**IVssComponent:: GetDirectedTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtargetcount) e [**IVssComponent:: GetDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtarget).</span><span class="sxs-lookup"><span data-stu-id="2515f-244">The requester can than obtain all of these redirected restores by calling [**IVssComponent::GetDirectedTargetCount**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtargetcount) and [**IVssComponent::GetDirectedTarget**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getdirectedtarget).</span></span> <span data-ttu-id="2515f-245">**IVssComponent:: GetDirectedTarget** retornará um caminho completo para um arquivo de origem no backup e um caminho completo para um arquivo de destino que será restaurado para o.</span><span class="sxs-lookup"><span data-stu-id="2515f-245">**IVssComponent::GetDirectedTarget** will return a full path to a source file on the backup and a full path to a destination file that will be restored to.</span></span> <span data-ttu-id="2515f-246">Ele também retorna uma lista de intervalos para cada um desses arquivos.</span><span class="sxs-lookup"><span data-stu-id="2515f-246">It also returns a ranges list for each of these files.</span></span> <span data-ttu-id="2515f-247">O solicitante é então responsável por restaurar os intervalos especificados no arquivo de origem para os intervalos mapeados no arquivo de destino.</span><span class="sxs-lookup"><span data-stu-id="2515f-247">The requester is then responsible for restoring the specified ranges in the source file to the mapped ranges in the destination file.</span></span> <span data-ttu-id="2515f-248">O formato da cadeia de caracteres de intervalos é o mesmo que em [**IVssComponent:: Getparcialfile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span><span class="sxs-lookup"><span data-stu-id="2515f-248">The format of the ranges string is the same as in [**IVssComponent::GetPartialFile**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpartialfile).</span></span>

-   [<span data-ttu-id="2515f-249">Função de gravador em backups incrementais e diferenciais do VSS</span><span class="sxs-lookup"><span data-stu-id="2515f-249">Writer Role in VSS Incremental and Differential Backups</span></span>](writer-role-in-vss-incremental-and-differential-backups.md)
-   [<span data-ttu-id="2515f-250">Função de solicitante no VSS backups incrementais e diferenciais</span><span class="sxs-lookup"><span data-stu-id="2515f-250">Requester Role in VSS Incremental and Differential Backups</span></span>](requestor-role-in-vss-incremental-and-differential-backups.md)

 

 
