---
description: O processamento de um dos conjuntos de arquivos de um componente pode exigir que um solicitante Percorra uma árvore de diretório recursivamente, o que pode exigir que o solicitante manipule pastas montadas e pontos de nova análise (como links) que apontam para dados que não estão no volume atual.
ms.assetid: d0e08598-a8a2-489b-9cb2-e989bed1ce53
title: Trabalhando com pastas montadas e pontos de nova análise
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 397a7aa88f39361f788f9aac882b4f9d337fd6f8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "105781484"
---
# <a name="working-with-mounted-folders-and-reparse-points"></a><span data-ttu-id="b35ed-103">Trabalhando com pastas montadas e pontos de nova análise</span><span class="sxs-lookup"><span data-stu-id="b35ed-103">Working with Mounted Folders and Reparse Points</span></span>

<span data-ttu-id="b35ed-104">O processamento de um dos conjuntos de arquivos de um componente pode exigir que um solicitante Percorra uma árvore de diretório recursivamente, o que pode exigir que o solicitante manipule pastas montadas e pontos de nova análise (como links) que apontam para dados que não estão no volume atual.</span><span class="sxs-lookup"><span data-stu-id="b35ed-104">Processing one of a component's file sets may require a requester to traverse a directory tree recursively, which can require the requester to handle mounted folders and reparse points (such as links) that point to data that is not on the current volume.</span></span>

<span data-ttu-id="b35ed-105">Os solicitantes devem seguir as pastas montadas e os pontos de nova análise ao atravessar uma árvore de diretórios, e o VSS tem diretrizes bem definidas para tratá-las para operações de backup e restauração.</span><span class="sxs-lookup"><span data-stu-id="b35ed-105">Requesters are expected to follow mounted folders and reparse points when traversing a directory tree, and VSS has well-defined guidelines for handling them for backup and restore operations.</span></span>

<span data-ttu-id="b35ed-106">Para ilustrar essas diretrizes, considere o seguinte exemplo:</span><span class="sxs-lookup"><span data-stu-id="b35ed-106">To illustrate these guidelines, consider the following example:</span></span>

-   <span data-ttu-id="b35ed-107">O volume \\ \\ ? \\ O volume {GUID \_ 1} tem a letra da unidade C: \\ .</span><span class="sxs-lookup"><span data-stu-id="b35ed-107">The volume \\\\?\\Volume{GUID\_1} has the drive letter C:\\.</span></span>
-   <span data-ttu-id="b35ed-108">Um conjunto de arquivos tem um caminho de C: \\ WriterData.</span><span class="sxs-lookup"><span data-stu-id="b35ed-108">A file set has a path of C:\\WriterData.</span></span>
-   <span data-ttu-id="b35ed-109">Um arquivo Specification \* . dat é usado pelo conjunto de arquivos.</span><span class="sxs-lookup"><span data-stu-id="b35ed-109">A file specification \*.dat is used by the file set.</span></span>
-   <span data-ttu-id="b35ed-110">A recursão do conjunto de arquivos é definida como **true**.</span><span class="sxs-lookup"><span data-stu-id="b35ed-110">The file set's recursion is set to **TRUE**.</span></span>
-   <span data-ttu-id="b35ed-111">O diretório C: \\ WriterData está localizado no volume \\ \\ ? \\ Volume {GUID \_ 1}.</span><span class="sxs-lookup"><span data-stu-id="b35ed-111">The directory C:\\WriterData is located on the volume \\\\?\\Volume{GUID\_1}.</span></span>
-   <span data-ttu-id="b35ed-112">O diretório C: \\ WriterData \\ arquivo morto é uma pasta montada.</span><span class="sxs-lookup"><span data-stu-id="b35ed-112">The directory C:\\WriterData\\Archive is a mounted folder.</span></span>
-   <span data-ttu-id="b35ed-113">O volume \\ \\ ? \\ O volume {GUID \_ 2} está associado ao arquivo C: WriterData da pasta montada \\ \\ .</span><span class="sxs-lookup"><span data-stu-id="b35ed-113">The volume \\\\?\\Volume{GUID\_2} is associated with the mounted folder C:\\WriterData\\Archive.</span></span>

## <a name="handling-mounted-folders-and-reparse-points-during-backup"></a><span data-ttu-id="b35ed-114">Manipulando pastas montadas e pontos de nova análise durante o backup</span><span class="sxs-lookup"><span data-stu-id="b35ed-114">Handling Mounted Folders and Reparse Points during Backup</span></span>

<span data-ttu-id="b35ed-115">As regras básicas para lidar com pastas montadas e pontos de nova análise no VSS ao executar um backup recursivo podem ser resumidas da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="b35ed-115">The basic rules for handling mounted folders and reparse points under VSS when performing a recursive backup can be summarized as follows:</span></span>

-   <span data-ttu-id="b35ed-116">Os caminhos são seguidos entre pastas montadas e pontos de nova análise.</span><span class="sxs-lookup"><span data-stu-id="b35ed-116">Paths are followed across mounted folders and reparse points.</span></span>
-   <span data-ttu-id="b35ed-117">Se um ponto de reanálise ou pasta montada apontar para um volume, esse volume deverá ser copiado em sombra.</span><span class="sxs-lookup"><span data-stu-id="b35ed-117">If a mounted folder or reparse point points to a volume, that volume should be shadow copied.</span></span>
-   <span data-ttu-id="b35ed-118">Se um volume contiver pastas montadas ou pontos de nova análise, eles serão exibidos na cópia de sombra do volume.</span><span class="sxs-lookup"><span data-stu-id="b35ed-118">If a volume contains mounted folders or reparse points, these will appear in the shadow copy of the volume.</span></span>
-   <span data-ttu-id="b35ed-119">Os dados que estão sob a pasta montada ou o ponto de nova análise são capturados na cópia de sombra do volume para o qual a pasta montada ou o ponto de nova análise aponta.</span><span class="sxs-lookup"><span data-stu-id="b35ed-119">Data that is under the mounted folder or reparse point is captured in the shadow copy of the volume that the mounted folder or reparse point points to.</span></span>

<span data-ttu-id="b35ed-120">Para ilustrar o uso do exemplo acima, como o sinalizador recursivo está definido, o solicitante deve examinar todos os dados em C: \\ WriterData \\ arquivo morto e abaixo.</span><span class="sxs-lookup"><span data-stu-id="b35ed-120">To illustrate using the example above, because the recursive flag is set, the requester must examine all data under C:\\WriterData\\Archive and below.</span></span>

<span data-ttu-id="b35ed-121">O solicitante deve adicionar o volume com a letra da unidade C: \\ ( \\ \\ ? \\ Volume {GUID \_ 1}) e o volume associado à pasta montada C: \\ WriterData \\ ( \\ \\ ? \\ Volume {GUID \_ 2}) para o conjunto de cópias de sombra usando [**IVssBackupComponents:: AddToSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addtosnapshotset).</span><span class="sxs-lookup"><span data-stu-id="b35ed-121">The requester must add both the volume with drive letter C:\\ (\\\\?\\Volume{GUID\_1}) and the volume associated with the mounted folder C:\\WriterData\\Archive (\\\\?\\Volume{GUID\_2}) to the shadow copy set using [**IVssBackupComponents::AddToSnapshotSet**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addtosnapshotset).</span></span>

<span data-ttu-id="b35ed-122">A pasta montada C: \\ WriterData \\ arquivo morto aparece na cópia de sombra do volume \\ \\ ? \\ Volume {GUID \_ 1}, que tem um objeto de dispositivo chamado deviceObject1.</span><span class="sxs-lookup"><span data-stu-id="b35ed-122">The mounted folder C:\\WriterData\\Archive appears in the shadow copy of volume \\\\?\\Volume{GUID\_1}, which has a device object named deviceObject1.</span></span>

<span data-ttu-id="b35ed-123">No entanto, o VSS não copiará nenhum dado nessa pasta montada (dados em \\ \\ ? \\ Volume {GUID \_ 2}) para a cópia de sombra referenciada por deviceObject1.</span><span class="sxs-lookup"><span data-stu-id="b35ed-123">However, VSS will not copy any data under that mounted folder (data on \\\\?\\Volume{GUID\_2}) to the shadow copy referenced by deviceObject1.</span></span> <span data-ttu-id="b35ed-124">Em vez disso, esses dados são capturados na cópia de sombra de \\ \\ ? \\ Volume {GUID \_ 2}, que tem um objeto de dispositivo chamado deviceObject2.</span><span class="sxs-lookup"><span data-stu-id="b35ed-124">Instead, that data is captured in the shadow copy of \\\\?\\Volume{GUID\_2}, which has a device object named deviceObject2.</span></span>

<span data-ttu-id="b35ed-125">Portanto, um solicitante que está fazendo backup dos arquivos de sombra copiados em C: \\ WriterData usará um caminho de deviceObject1 \\ WriterData para pesquisar arquivos que correspondem a C: \\ WriterData \\ \* . dat.</span><span class="sxs-lookup"><span data-stu-id="b35ed-125">Therefore, a requester that is backing up shadow copied files under C:\\WriterData will use a path of deviceObject1\\WriterData to search for files matching C:\\WriterData\\\*.dat.</span></span>

<span data-ttu-id="b35ed-126">Para fazer backup de arquivos de sombra copiados no arquivo C: \\ WriterData \\ , o solicitante usará um caminho de deviceObject2 (porque o diretório raiz de \\ \\ ? \\ O volume {GUID \_ 2} foi associado à pasta montada c: \\ Writer \\ Archive) para pesquisar arquivos que correspondem a c: \\ WriterData \\ Archive \\ \* . dat.</span><span class="sxs-lookup"><span data-stu-id="b35ed-126">To back up shadow copied files under C:\\WriterData\\Archive, the requester will use a path of deviceObject2 (because the root directory of \\\\?\\Volume{GUID\_2} was associated with the mounted folder C:\\Writer\\Archive) to search for files matching C:\\WriterData\\Archive\\\*.dat.</span></span>

<span data-ttu-id="b35ed-127">Observe que um ponto de nova análise é tratado da mesma maneira que uma pasta montada.</span><span class="sxs-lookup"><span data-stu-id="b35ed-127">Note that a reparse point is handled in the same way as a mounted folder.</span></span> <span data-ttu-id="b35ed-128">O ponto de nova análise aparece na cópia de sombra do primeiro volume.</span><span class="sxs-lookup"><span data-stu-id="b35ed-128">The reparse point appears in the shadow copy of the first volume.</span></span> <span data-ttu-id="b35ed-129">Os dados sob o ponto de nova análise aparecem na cópia de sombra do segundo volume.</span><span class="sxs-lookup"><span data-stu-id="b35ed-129">The data under the reparse point appears in the shadow copy of the second volume.</span></span>

<span data-ttu-id="b35ed-130">Durante o backup, os solicitantes devem armazenar informações sobre pastas montadas e os volumes associados a eles, bem como pontos de nova análise e seus destinos para garantir que todos os dados sejam armazenados em backup e restaurados corretamente.</span><span class="sxs-lookup"><span data-stu-id="b35ed-130">During backup, requesters should store information about mounted folders and the volumes associated with them as well as reparse points and their targets to ensure that all data is backed up and restored correctly.</span></span>

## <a name="handling-mount-and-reparse-points-during-restore"></a><span data-ttu-id="b35ed-131">Manipulando pontos de montagem e de nova análise durante a restauração</span><span class="sxs-lookup"><span data-stu-id="b35ed-131">Handling Mount and Reparse Points during Restore</span></span>

<span data-ttu-id="b35ed-132">Ao restaurar arquivos, o solicitante deve seguir as diretrizes um pouco diferentes daqueles que foram usados durante o backup (ignorando problemas, como o [*mapeamento de local alternativo*](vssgloss-a.md) e o [*novo local de destino*](vssgloss-n.md)):</span><span class="sxs-lookup"><span data-stu-id="b35ed-132">When restoring files, the requester must follow guidelines somewhat different from those that were used during backup (ignoring issues such as [*alternate location mapping*](vssgloss-a.md) and [*new target location*](vssgloss-n.md)):</span></span>

-   <span data-ttu-id="b35ed-133">Como antes, se a recursão for necessária, os caminhos serão seguidos entre as pastas montadas e os pontos de nova análise.</span><span class="sxs-lookup"><span data-stu-id="b35ed-133">As before, if recursion is required, paths are followed across mounted folders and reparse points.</span></span>
-   <span data-ttu-id="b35ed-134">As pastas montadas devem ser restauradas.</span><span class="sxs-lookup"><span data-stu-id="b35ed-134">Mounted folders are to be restored.</span></span>
-   <span data-ttu-id="b35ed-135">Os locais de restauração de pastas montadas e pontos de nova análise são aqueles determinados pelos seus caminhos originais.</span><span class="sxs-lookup"><span data-stu-id="b35ed-135">The restoration locations of mounted folders and reparse points are those determined by their original paths.</span></span>

<span data-ttu-id="b35ed-136">Se os nomes de volume persistirem entre backup e restauração, ou seja, você não recriar os volumes, as pastas montadas restauradas e os pontos de nova análise devem apontar para os volumes corretos.</span><span class="sxs-lookup"><span data-stu-id="b35ed-136">If the volume names persist between backup and restore—that is, you do not re-create the volumes—restored mounted folders and reparse points should point to the correct volumes.</span></span>

<span data-ttu-id="b35ed-137">Portanto, no exemplo discutido acima, se a pasta montada C: \\ WriterData \\ arquivo morto foi restaurada para ( \\ \\ ? \\ Volume {GUID \_ 1}) e o volume associado anteriormente a ele foi restaurado para ( \\ \\ ? \\ Volume {GUID \_ 2}), os arquivos restaurados e a estrutura de arquivos seriam corretos e consistentes.</span><span class="sxs-lookup"><span data-stu-id="b35ed-137">Therefore, in the example discussed above, if the mounted folder C:\\WriterData\\Archive was restored to (\\\\?\\Volume{GUID\_1}) and the volume previously associated with it was restored to (\\\\?\\Volume{GUID\_2}), the restored files and file structure would be correct and consistent.</span></span>

<span data-ttu-id="b35ed-138">Pode acontecer que os dados sejam restaurados para um sistema no qual os nomes de volume foram alterados.</span><span class="sxs-lookup"><span data-stu-id="b35ed-138">It may happen that data is restored to a system where volume names changed.</span></span> <span data-ttu-id="b35ed-139">Isso pode ser devido a falhas de disco, em que talvez seja necessário executar uma recuperação manual do sistema e recriar volumes.</span><span class="sxs-lookup"><span data-stu-id="b35ed-139">This could be due to disk crashes, where you might need to perform a manual system recovery and re-create volumes.</span></span> <span data-ttu-id="b35ed-140">Nesse tipo de situação, as pastas montadas e os pontos de nova análise não serão mais válidos após a restauração.</span><span class="sxs-lookup"><span data-stu-id="b35ed-140">In this type of situation, mounted folders and reparse points will no longer be valid after restore.</span></span> <span data-ttu-id="b35ed-141">Para recriar os arquivos e a estrutura de arquivos no volume restaurado, será necessário excluir as pastas montadas e os pontos de nova análise restaurados e recriá-los no disco.</span><span class="sxs-lookup"><span data-stu-id="b35ed-141">To re-create the files and file structure on the restored volume will require deleting the restored mounted folders and reparse points and re-creating them on disk.</span></span> <span data-ttu-id="b35ed-142">Cabe ao aplicativo de backup decidir se isso é apropriado.</span><span class="sxs-lookup"><span data-stu-id="b35ed-142">It is up to the backup application to decide whether this is appropriate.</span></span>

<span data-ttu-id="b35ed-143">Observe que é possível que o destino de restauração de uma pasta montada já esteja ocupado.</span><span class="sxs-lookup"><span data-stu-id="b35ed-143">Note that it is possible that the restore destination for a mounted folder is already occupied.</span></span> <span data-ttu-id="b35ed-144">Por exemplo, C: \\ WriterData \\ arquivo morto pode já conter alguns arquivos.</span><span class="sxs-lookup"><span data-stu-id="b35ed-144">For example, C:\\WriterData\\Archive might already contain some files.</span></span> <span data-ttu-id="b35ed-145">Cabe ao aplicativo de backup decidir como lidar com essa situação.</span><span class="sxs-lookup"><span data-stu-id="b35ed-145">It is up to the backup application to decide how to handle this situation.</span></span>

 

 



