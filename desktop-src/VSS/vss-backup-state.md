---
description: 'Durante uma operação de backup, o solicitante usa IVssBackupComponents:: setbackupstate para definir o tipo de operação em andamento.'
ms.assetid: 43dcdac7-ed8e-4150-83eb-585e0e92f13c
title: Estado de backup do VSS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e9aa9250139aee9f48f9880fd4a657fa7c6c4991
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "103647166"
---
# <a name="vss-backup-state"></a><span data-ttu-id="e6e6e-103">Estado de backup do VSS</span><span class="sxs-lookup"><span data-stu-id="e6e6e-103">VSS Backup State</span></span>

<span data-ttu-id="e6e6e-104">Durante uma operação de backup, o solicitante usa [**IVssBackupComponents:: Setbackupstate**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate) para definir o tipo de operação em andamento.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-104">During a backup operation, the requester uses [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate) to define the type of operation in progress.</span></span>

<span data-ttu-id="e6e6e-105">Essas informações não são incluídas em um formulário facilmente recuperável no documento de componentes de backup, por isso os desenvolvedores de solicitantes devem armazenar essas informações independentemente em qualquer mídia de backup.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-105">This information is not included in an easily retrievable form in the Backup Components Document, so requester developers should store this information independently on any backup media.</span></span>

<span data-ttu-id="e6e6e-106">O estado de backup contém o seguinte:</span><span class="sxs-lookup"><span data-stu-id="e6e6e-106">The backup state contains the following:</span></span>

<dl> <dt>

<span data-ttu-id="e6e6e-107"><span id="Backup_Type"></span><span id="backup_type"></span><span id="BACKUP_TYPE"></span>Tipo de backup</span><span class="sxs-lookup"><span data-stu-id="e6e6e-107"><span id="Backup_Type"></span><span id="backup_type"></span><span id="BACKUP_TYPE"></span>Backup Type</span></span>
</dt> <dd>

<span data-ttu-id="e6e6e-108">O tipo de backup especifica critérios para identificar os arquivos cujo backup será feito.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-108">The backup type specifies criteria for identifying files to be backed up.</span></span> <span data-ttu-id="e6e6e-109">A avaliação desses critérios deve ser feita usando a API do VSS.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-109">The evaluation of these criteria must be made using the VSS API.</span></span>

<span data-ttu-id="e6e6e-110">Ao decidir sobre o tipo de backup a ser buscado e com quais gravadores trabalhar, os solicitantes devem examinar os tipos (ou esquemas — consulte [suporte ao esquema de backup do gravador](writer-backup-schema-support.md)) de operações de backup com suporte de cada um dos gravadores do sistema.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-110">When deciding on the type of backup to pursue and which writers to work with, requesters should examine the kinds (or schemas—see [Writer Backup Schema Support](writer-backup-schema-support.md)) of backup operations that each of the system's writers supports.</span></span> <span data-ttu-id="e6e6e-111">Os backups em VSS podem ser os seguintes tipos:</span><span class="sxs-lookup"><span data-stu-id="e6e6e-111">Backups under VSS can be the following types:</span></span>

-   <span data-ttu-id="e6e6e-112">Completo (VSS \_ BT \_ completa) — será feito backup dos arquivos, independentemente da data do último backup.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-112">Full (VSS\_BT\_FULL)—files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="e6e6e-113">O histórico de backup de cada arquivo será atualizado e esse tipo de backup poderá ser usado como a base de um backup incremental ou diferencial.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-113">The backup history of each file will be updated, and this type of backup can be used as the basis of an incremental or differential backup.</span></span> <span data-ttu-id="e6e6e-114">A restauração de um backup completo requer apenas uma única imagem de backup.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-114">Restoring a full backup requires only a single backup image.</span></span>
-   <span data-ttu-id="e6e6e-115">Copiar backup (cópia do VSS \_ BT \_ ) — como o \_ tipo de backup completo de BT do VSS \_ , será feito backup dos arquivos, independentemente da data do último backup.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-115">Copy Backup (VSS\_BT\_COPY)—like the VSS\_BT\_FULL backup type, files will be backed up regardless of their last backup date.</span></span> <span data-ttu-id="e6e6e-116">No entanto, o histórico de backup de cada arquivo não será atualizado e esse tipo de backup não poderá ser usado como a base de um backup incremental ou diferencial.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-116">However, the backup history of each file will not be updated, and this sort of backup cannot be used as the basis of an incremental or differential backup.</span></span>
-   <span data-ttu-id="e6e6e-117">Incremental (VSS \_ BT \_ incremental) – a API do VSS é usada para garantir que apenas os arquivos que foram alterados ou adicionados desde o último backup completo ou incremental sejam copiados para um meio de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-117">Incremental (VSS\_BT\_INCREMENTAL)—the VSS API is used to ensure that only files that have been changed or added since the last full or incremental backup are to be copied to a storage medium.</span></span> <span data-ttu-id="e6e6e-118">A restauração de um backup incremental requer a imagem de backup original e todas as imagens de backup incremental feitas desde o backup inicial.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-118">Restoring an incremental backup requires the original backup image and all incremental backup images made since the initial backup.</span></span>
-   <span data-ttu-id="e6e6e-119">Diferencial ( \_ diferencial do VSS BT \_ ) – a API do VSS é usada para garantir que apenas os arquivos que foram alterados ou adicionados desde o último backup completo sejam copiados para uma mídia de armazenamento; todas as informações de backup intermediários são ignoradas.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-119">Differential (VSS\_BT\_DIFFERENTIAL)—the VSS API is used to ensure that only files that have been changed or added since the last full backup are to be copied to a storage media; all intermediate backup information is ignored.</span></span> <span data-ttu-id="e6e6e-120">A restauração de um backup diferencial requer a imagem de backup original e a imagem de backup diferencial mais recente feita desde o último backup completo.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-120">Restoring a differential backup requires the original backup image and the most recent differential backup image made since the last full backup.</span></span>
-   <span data-ttu-id="e6e6e-121">Arquivo de log ( \_ log de BT VSS \_ ) — somente os arquivos de log de um gravador (arquivos adicionados a um componente com o método [**IVssCreateWriterMetadata:: AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) e recuperados por uma chamada para [**IVssWMComponent:: GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)) serão submetidos a backup.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-121">Log File (VSS\_BT\_LOG)—only a writer's log files (files added to a component with the [**IVssCreateWriterMetadata::AddDataBaseLogFiles**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) method, and retrieved by a call to [**IVssWMComponent::GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)) will be backed up.</span></span> <span data-ttu-id="e6e6e-122">Esse tipo de backup é específico do VSS.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-122">This backup type is specific to VSS.</span></span>

<span data-ttu-id="e6e6e-123">É possível que os solicitantes implementem esses backups usando informações e métodos fora do VSS.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-123">It is possible for requesters to implement these backups using information and methods outside of VSS.</span></span> <span data-ttu-id="e6e6e-124">Somente quando um solicitante implementa um backup usando a API do VSS, deve-se dizer que ele tem um dos tipos de backup listados.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-124">Only when a requester implements a backup using the VSS API should it be said to have one of the listed backup types.</span></span> <span data-ttu-id="e6e6e-125">Por exemplo, um solicitante participará de um \_ \_ tipo de log de BT VSS do backup somente se ele usou as informações retornadas por [**IVssWMComponent:: GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile) para identificar os arquivos de log.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-125">For instance, a requester participates in a VSS\_BT\_LOG type of backup only if it used the information returned by [**IVssWMComponent::GetDatabaseLogFile**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile) to identify log files.</span></span> <span data-ttu-id="e6e6e-126">Da mesma forma, \_ os \_ tipos diferenciais VSS BT incremental e VSS \_ BT \_ se aplicam somente a operações incrementais ou diferenciais, conforme descrito em [backups incrementais e diferenciais](incremental-and-differential-backups.md).</span><span class="sxs-lookup"><span data-stu-id="e6e6e-126">Similarly, the VSS\_BT\_INCREMENTAL and VSS\_BT\_DIFFERENTIAL types apply only to incremental or differential operations, as described in [Incremental and Differential Backups](incremental-and-differential-backups.md).</span></span>

</dd> <dt>

<span data-ttu-id="e6e6e-127"><span id="Specification_about_Selectability"></span><span id="specification_about_selectability"></span><span id="SPECIFICATION_ABOUT_SELECTABILITY"></span>Especificação sobre a seleção</span><span class="sxs-lookup"><span data-stu-id="e6e6e-127"><span id="Specification_about_Selectability"></span><span id="specification_about_selectability"></span><span id="SPECIFICATION_ABOUT_SELECTABILITY"></span>Specification about Selectability</span></span>
</dt> <dd>

<span data-ttu-id="e6e6e-128">Um backup do VSS pode optar por respeitar noções do VSS de seleção de componentes – isso é chamado de execução no [*modo de componente*](vssgloss-c.md)— ou de ignorá-los.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-128">A VSS backup may choose to respect VSS notions of component selectability—this is referred to as running in [*component mode*](vssgloss-c.md)—or to ignore them.</span></span>

<span data-ttu-id="e6e6e-129">Um exemplo de não execução no modo de componente seria executar um backup de imagem do sistema, em que o aplicativo de backup precisaria de uma cooperação de gravador para garantir a estabilidade dos dados, mas onde a seleção de componentes seria irrelevante.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-129">An example of not running in component mode would be performing a system image backup, where the backup application would need writer cooperation to ensure data stability but where selection of components would be irrelevant.</span></span>

</dd> <dt>

<span data-ttu-id="e6e6e-130"><span id="Saving_Bootable_State"></span><span id="saving_bootable_state"></span><span id="SAVING_BOOTABLE_STATE"></span>Salvando estado inicializável</span><span class="sxs-lookup"><span data-stu-id="e6e6e-130"><span id="Saving_Bootable_State"></span><span id="saving_bootable_state"></span><span id="SAVING_BOOTABLE_STATE"></span>Saving Bootable State</span></span>
</dt> <dd>

<span data-ttu-id="e6e6e-131">O VSS dá suporte à gravação do estado do sistema em execução em uma configuração totalmente inicializável.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-131">VSS supports saving the running system state in a fully bootable configuration.</span></span> <span data-ttu-id="e6e6e-132">No entanto, isso nem sempre é necessário, e a preparação do gravador para salvar um estado inicializável pode, às vezes, prejudicar o desempenho em tempo real de um sistema em execução.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-132">However, this is not always necessary, and writer preparation to save a bootable state can sometimes degrade real-time performance of a running system.</span></span>

<span data-ttu-id="e6e6e-133">Portanto, os solicitantes indicam se um backup incluirá um estado de sistema inicializável como um argumento para [**IVssBackupComponents:: Setbackupstate**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="e6e6e-133">Therefore, requesters indicate whether a backup will include a bootable system state as an argument to [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span> <span data-ttu-id="e6e6e-134">Os gravadores determinam se precisam dar suporte ao salvamento do estado do sistema inicializável chamando [**CVssWriter:: IsBootableStateBackedUp**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-isbootablesystemstatebackedup).</span><span class="sxs-lookup"><span data-stu-id="e6e6e-134">Writers determine whether they have to support saving the bootable system state by calling [**CVssWriter::IsBootableStateBackedUp**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-isbootablesystemstatebackedup).</span></span>

<span data-ttu-id="e6e6e-135">Mesmo se o estado do sistema inicializável não estiver selecionado, as cópias de sombra dos arquivos do sistema serão feitas e o backup dos arquivos poderá ser feito.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-135">Even if bootable system state is not selected, shadow copies of the system files will be made and the files may be backed up.</span></span>

<span data-ttu-id="e6e6e-136">No entanto, deve-se ter muito cuidado ao restaurar arquivos do sistema se o backup não tiver salvo o estado do sistema inicializável (consulte [fazendo backup e restaurando o estado do sistema no Windows server 2003 R2 e no Windows server 2003 SP1](backing-up-and-restoring-system-state-under-vss.md)).</span><span class="sxs-lookup"><span data-stu-id="e6e6e-136">However, great care should be exercised in restoring system files if the backup did not save the bootable system state (see [Backing Up and Restoring System State in Windows Server 2003 R2 and Windows Server 2003 SP1](backing-up-and-restoring-system-state-under-vss.md)).</span></span>

<span data-ttu-id="e6e6e-137">Não é possível recuperar essas informações de um documento de componentes de backup recuperado, portanto, os autores do solicitante devem armazenar se o backup do sistema foi feito com um estado de sistema inicializável ou não.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-137">It is not possible to recover this information from a retrieved Backup Components Document, so requester authors should store whether the system was backed up with a bootable system state or not.</span></span>

</dd> <dt>

<span data-ttu-id="e6e6e-138"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Suporte a arquivos parciais</span><span class="sxs-lookup"><span data-stu-id="e6e6e-138"><span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Partial File Support</span></span>
</dt> <dd>

<span data-ttu-id="e6e6e-139">Alguns gravadores dão suporte à restauração de arquivos por meio da substituição de partes dos arquivos que eles gerenciam.</span><span class="sxs-lookup"><span data-stu-id="e6e6e-139">Some writers support file restoration through the overwriting of parts of the files they manage.</span></span> <span data-ttu-id="e6e6e-140">Um solicitante pode ser projetado para tirar proveito disso e, se for, ele indicará isso definindo as informações em [**IVssBackupComponents:: Setbackupstate**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span><span class="sxs-lookup"><span data-stu-id="e6e6e-140">A requester may be designed to take advantage of this, and if so it indicates this by setting the information in [**IVssBackupComponents::SetBackupState**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).</span></span>

</dd> </dl>

 

 



