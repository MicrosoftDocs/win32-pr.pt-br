---
description: A correção gama, ou gama, para curto, é o nome de uma operação não linear que os sistemas usam para codificar e decodificar valores de pixel em imagens.
ms.assetid: 97ACDAE3-514E-4AAF-A27D-E5FFC162DB2A
title: Usando a correção gama
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c940db1a94fb41e9babecbeb3075aa9e01b3732
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/06/2021
ms.locfileid: "104566479"
---
# <a name="using-gamma-correction"></a><span data-ttu-id="b1a59-103">Usando a correção gama</span><span class="sxs-lookup"><span data-stu-id="b1a59-103">Using gamma correction</span></span>

<span data-ttu-id="b1a59-104">A correção gama, ou gama, para curto, é o nome de uma operação não linear que os sistemas usam para codificar e decodificar valores de pixel em imagens.</span><span class="sxs-lookup"><span data-stu-id="b1a59-104">Gamma correction, or gamma for short, is the name of a nonlinear operation that systems use to code and decode pixel values in images.</span></span>

-   [<span data-ttu-id="b1a59-105">O que é o gama e para que se trata?</span><span class="sxs-lookup"><span data-stu-id="b1a59-105">What is gamma and what is it for?</span></span>](#what-is-gamma-and-what-is-it-for)
-   [<span data-ttu-id="b1a59-106">Plano de fundo de gama no Windows</span><span class="sxs-lookup"><span data-stu-id="b1a59-106">Background of gamma on Windows</span></span>](#background-of-gamma-on-windows)
-   [<span data-ttu-id="b1a59-107">Evolução do hardware de vídeo</span><span class="sxs-lookup"><span data-stu-id="b1a59-107">Evolution of display hardware</span></span>](#evolution-of-display-hardware)
-   [<span data-ttu-id="b1a59-108">Recursos de controle de gama em DXGI</span><span class="sxs-lookup"><span data-stu-id="b1a59-108">Gamma control capabilities in DXGI</span></span>](#gamma-control-capabilities-in-dxgi)
-   [<span data-ttu-id="b1a59-109">Definindo o controle gama com DXGI</span><span class="sxs-lookup"><span data-stu-id="b1a59-109">Setting gamma control with DXGI</span></span>](#setting-gamma-control-with-dxgi)
-   [<span data-ttu-id="b1a59-110">Práticas de controle de gama</span><span class="sxs-lookup"><span data-stu-id="b1a59-110">Gamma control practicalities</span></span>](#gamma-control-practicalities)
-   [<span data-ttu-id="b1a59-111">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="b1a59-111">Related topics</span></span>](#related-topics)

## <a name="what-is-gamma-and-what-is-it-for"></a><span data-ttu-id="b1a59-112">O que é o gama e para que se trata?</span><span class="sxs-lookup"><span data-stu-id="b1a59-112">What is gamma and what is it for?</span></span>

<span data-ttu-id="b1a59-113">No final do pipeline de gráficos, apenas onde a imagem deixa o computador para fazer sua jornada ao longo do cabo do monitor, há uma pequena parte do hardware que pode transformar valores de pixel em tempo real.</span><span class="sxs-lookup"><span data-stu-id="b1a59-113">At the end of the graphics pipeline, just where the image leaves the computer to make its journey along the monitor cable, there is a small piece of hardware that can transform pixel values on the fly.</span></span> <span data-ttu-id="b1a59-114">Esse hardware geralmente usa uma tabela de pesquisa para transformar os pixels.</span><span class="sxs-lookup"><span data-stu-id="b1a59-114">This hardware typically uses a lookup table to transform the pixels.</span></span> <span data-ttu-id="b1a59-115">Esse hardware usa os valores vermelho, verde e azul provenientes da superfície a ser exibida para pesquisar valores corrigidos em gama na tabela e, em seguida, envia os valores corrigidos para o monitor em vez dos valores reais da superfície.</span><span class="sxs-lookup"><span data-stu-id="b1a59-115">This hardware uses the red, green and blue values that come from the surface to be displayed to look up gamma-corrected values in the table and then sends the corrected values to the monitor instead of the actual surface values.</span></span> <span data-ttu-id="b1a59-116">Portanto, essa tabela de pesquisa é uma oportunidade de substituir qualquer cor por qualquer outra cor.</span><span class="sxs-lookup"><span data-stu-id="b1a59-116">So, this lookup table is an opportunity to replace any color with any other color.</span></span> <span data-ttu-id="b1a59-117">Embora a tabela tenha esse nível de potência, o uso típico é ajustar as imagens sutilmente para compensar as diferenças na resposta do monitor.</span><span class="sxs-lookup"><span data-stu-id="b1a59-117">While the table has that level of power, the typical usage is to tweak images subtly to compensate for differences in the monitor’s response.</span></span> <span data-ttu-id="b1a59-118">A resposta do monitor é a função que relaciona o valor numérico dos componentes vermelho, verde e azul de um pixel com o brilho exibido desse pixel.</span><span class="sxs-lookup"><span data-stu-id="b1a59-118">The monitor’s response is the function that relates the numerical value of the red, green and blue components of a pixel with that pixel’s displayed brightness.</span></span>

<span data-ttu-id="b1a59-119">É para isso que essa tabela se destina, mas os desenvolvedores de jogos encontraram usos criativos para ele, como piscar toda a tela em vermelho para o efeito psicológica.</span><span class="sxs-lookup"><span data-stu-id="b1a59-119">That’s what this table was intended for, but game developers found creative uses for it, such as flashing the whole screen red for psychological effect.</span></span> <span data-ttu-id="b1a59-120">Em aplicativos de jogos modernos, como parte do pós-processamento de cada quadro, normalmente fornecemos outras maneiras de fazer essas coisas.</span><span class="sxs-lookup"><span data-stu-id="b1a59-120">In modern game apps, as part of the post-processing of each frame, we typically provide other ways to do such things.</span></span> <span data-ttu-id="b1a59-121">Na verdade, é recomendável deixar a tabela gama sozinha porque ela pode estar em uso para calibrar a resposta do monitor, e as alterações no atacado para a rampa de gama destruirão essa calibragem cuidadosa.</span><span class="sxs-lookup"><span data-stu-id="b1a59-121">In fact, we recommend that you leave the gamma table alone because it might be in use to calibrate the monitor’s response, and wholesale changes to the gamma ramp will destroy this careful calibration.</span></span>

<span data-ttu-id="b1a59-122">A ciência de determinar a correção de gama é complexa e não é apresentada aqui, além de não se acender de onde veio o nome "gama".</span><span class="sxs-lookup"><span data-stu-id="b1a59-122">The science of determining gamma correction is complex, and is not presented here, other than to illuminate where the name “gamma” came from.</span></span> <span data-ttu-id="b1a59-123">Uma resposta do monitor CRT (ou seja, uma velha) é uma função complexa, mas a física desses monitores significa que eles exibem uma resposta que pode ser representada de forma bruta por essa função de energia:</span><span class="sxs-lookup"><span data-stu-id="b1a59-123">A CRT (that is, an old-fashioned glass) monitor’s response is a complex function, but the physics of these monitors mean that they exhibit a response that can be crudely represented by this power function:</span></span>

<span data-ttu-id="b1a59-124">brilho (entrada) =<sup>gama</sup> de entrada</span><span class="sxs-lookup"><span data-stu-id="b1a59-124">brightness( input ) = input<sup>gamma</sup></span></span>

<span data-ttu-id="b1a59-125">O valor de gama normalmente é próximo ao valor de 2,0.</span><span class="sxs-lookup"><span data-stu-id="b1a59-125">The gamma value is typically close to a value of 2.0.</span></span> <span data-ttu-id="b1a59-126">Os monitores LCD e todas as outras tecnologias mais recentes são especificamente desenvolvidos para exibir uma resposta semelhante para que todos os nossos softwares e imagens não precisem ser recalibrados para essas novas tecnologias.</span><span class="sxs-lookup"><span data-stu-id="b1a59-126">LCD monitors and all other newer technologies are specifically engineered to exhibit a similar response so all our software and images don’t have to be recalibrated for those new technologies.</span></span> <span data-ttu-id="b1a59-127">O padrão sRGB declara que esse valor de gama é exatamente 2,2, e esse valor se tornou um padrão amplamente implementado.</span><span class="sxs-lookup"><span data-stu-id="b1a59-127">The sRGB standard declares that this gamma value is exactly 2.2, and this value has become a widely implemented standard.</span></span>

<span data-ttu-id="b1a59-128">O olho humano também tem uma função de resposta que aproximadamente inverte a função de energia CRT.</span><span class="sxs-lookup"><span data-stu-id="b1a59-128">The human eye also has a response function which approximately inverts the CRT power function.</span></span> <span data-ttu-id="b1a59-129">Isso significa que o brilho percebido de um pixel aumenta aproximadamente de forma linear com os valores RGB nesse pixel.</span><span class="sxs-lookup"><span data-stu-id="b1a59-129">This means that the perceived brightness of a pixel goes up very roughly linearly with the RGB values in that pixel.</span></span>

<span data-ttu-id="b1a59-130">Como um valor de gama de 2,2 se tornou um padrão de fato, não precisamos nos preocupar muito com a curva gama codificada nesta tabela e pode deixá-la como um mapeamento linear de um para um.</span><span class="sxs-lookup"><span data-stu-id="b1a59-130">Because a gamma value of 2.2 has become a de-facto standard, we typically don’t need to worry too much about the gamma curve encoded in this table, and can leave it as a linear, one-to-one mapping.</span></span> <span data-ttu-id="b1a59-131">É claro que a correspondência de cores adequada não exige Exquisite com essa função, mas essa discussão está além do escopo deste tópico.</span><span class="sxs-lookup"><span data-stu-id="b1a59-131">Proper color matching does of course require exquisite care with this function, but that discussion is beyond the scope of this topic.</span></span> <span data-ttu-id="b1a59-132">O Windows inclui uma ferramenta que permite aos usuários calibrar seus monitores para o gama 2,2, e essa ferramenta usa o hardware da tabela de pesquisa para derivar um ajuste sutil cuidadosamente escolhido para seus computadores.</span><span class="sxs-lookup"><span data-stu-id="b1a59-132">Windows includes a tool that lets users calibrate their displays to gamma 2.2, and this tool uses the lookup table hardware to derive a carefully-chosen subtle tweak for their computers.</span></span> <span data-ttu-id="b1a59-133">Os usuários podem executar essa ferramenta pesquisando "calibrar cor".</span><span class="sxs-lookup"><span data-stu-id="b1a59-133">Users can run this tool by searching for "calibrate color".</span></span> <span data-ttu-id="b1a59-134">Também há perfis de cores bem definidos para monitores específicos que automatizam esse processo.</span><span class="sxs-lookup"><span data-stu-id="b1a59-134">There are also well-defined color profiles for particular monitors that automate this process.</span></span> <span data-ttu-id="b1a59-135">A ferramenta "calibrar cor" pode detectar esses monitores mais recentes e informar aos usuários que a calibragem já está em vigor.</span><span class="sxs-lookup"><span data-stu-id="b1a59-135">The "calibrate color" tool can detect these newer monitors, and inform users that calibration is already in place.</span></span>

<span data-ttu-id="b1a59-136">Essa noção de codificar uma lei de energia em valores de cor também é útil em outro lugar no pipeline de gráficos, especialmente em texturas.</span><span class="sxs-lookup"><span data-stu-id="b1a59-136">This notion of encoding a power law into color values is useful elsewhere in the graphics pipeline too, especially in textures.</span></span> <span data-ttu-id="b1a59-137">Para texturas, você quer mais precisão em cores mais escuras devido à resposta de olho humano logarítmica sobre a qual acabamos de falar.</span><span class="sxs-lookup"><span data-stu-id="b1a59-137">For textures, you want more precision on darker colors because of the logarithmic human eye response we just talked about.</span></span> <span data-ttu-id="b1a59-138">Um tratamento cuidadoso de gama nesta parte do pipeline é importante.</span><span class="sxs-lookup"><span data-stu-id="b1a59-138">Careful handling of gamma in this part of the pipeline is important.</span></span> <span data-ttu-id="b1a59-139">Para obter mais informações, consulte [convertendo dados para o espaço de cores](converting-data-color-space.md).</span><span class="sxs-lookup"><span data-stu-id="b1a59-139">For more info, see [Converting data for the color space](converting-data-color-space.md).</span></span>

<span data-ttu-id="b1a59-140">O restante deste tópico se concentra apenas na correção gama nesta última parte do pipeline, entre os dados do buffer do quadro e o monitor.</span><span class="sxs-lookup"><span data-stu-id="b1a59-140">The remainder of this topic focuses only on gamma correction in this last part of the pipeline, between the frame buffer data and the monitor.</span></span> <span data-ttu-id="b1a59-141">Se você quiser escrever um assistente de calibragem ou criar efeitos especiais em um aplicativo de tela inteira em que uma etapa de pós-processamento não é prática, aqui estão as informações necessárias.</span><span class="sxs-lookup"><span data-stu-id="b1a59-141">If you want to write a calibration wizard or to create special effects in a full-screen app where a post-processing step is not practical, here is the info you need.</span></span>

## <a name="background-of-gamma-on-windows"></a><span data-ttu-id="b1a59-142">Plano de fundo de gama no Windows</span><span class="sxs-lookup"><span data-stu-id="b1a59-142">Background of gamma on Windows</span></span>

<span data-ttu-id="b1a59-143">Os computadores com Windows normalmente têm uma tabela gama que é uma tabela de pesquisa que usa um terceto de bytes e gera um terceto de bytes.</span><span class="sxs-lookup"><span data-stu-id="b1a59-143">Windows computers typically have a gamma table that is a lookup table that takes a triplet of bytes and outputs a triplet of bytes.</span></span> <span data-ttu-id="b1a59-144">Esses tercetos são 768 (256 x 3) bytes de RAM.</span><span class="sxs-lookup"><span data-stu-id="b1a59-144">These triplets are 768 (256 x 3) bytes of RAM.</span></span> <span data-ttu-id="b1a59-145">Isso é bom quando o formato de exibição contém um terceto de valores de bytes RGB, mas não é expressivo o suficiente para descrever as transformações que você pode querer quando o formato de exibição tem um intervalo maior que \[ 0, 1 \] , como valores de ponto flutuante.</span><span class="sxs-lookup"><span data-stu-id="b1a59-145">This is fine when your display format contains a triplet of RGB BYTE values but isn't expressive enough to describe the transformations that you might want when the display format has a greater range than \[0,1\], such as floating point values.</span></span> <span data-ttu-id="b1a59-146">As APIs no Windows que controlam o gama seguiram uma evolução à medida que os formatos de exibição se tornaram mais complexos.</span><span class="sxs-lookup"><span data-stu-id="b1a59-146">The APIs in Windows that control gamma have followed an evolution as display formats have become more complex.</span></span>

<span data-ttu-id="b1a59-147">As primeiras APIs do Windows para oferecer controle de gama são [**SetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-setdevicegammaramp) e [**GetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-getdevicegammaramp)da GDI (Windows Graphics Device Interface).</span><span class="sxs-lookup"><span data-stu-id="b1a59-147">The first Windows APIs to offer gamma control are Windows Graphics Device Interface (GDI)’s [**SetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-setdevicegammaramp) and [**GetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-getdevicegammaramp).</span></span> <span data-ttu-id="b1a59-148">Essas APIs funcionam com matrizes de entrada de 3 256 de palavras, com cada palavra codificando zero para uma, representada pelos valores de palavra 0 e 65535.</span><span class="sxs-lookup"><span data-stu-id="b1a59-148">These APIs work with three 256-entry arrays of WORDs, with each WORD encoding zero up to one, represented by WORD values 0 and 65535.</span></span> <span data-ttu-id="b1a59-149">A precisão extra de uma palavra normalmente não está disponível em tabelas de pesquisa de hardware reais, mas essas APIs foram destinadas a serem flexíveis.</span><span class="sxs-lookup"><span data-stu-id="b1a59-149">The extra precision of a WORD typically isn’t available in actual hardware lookup tables, but these APIs were intended to be flexible.</span></span> <span data-ttu-id="b1a59-150">Essas APIs, em contraste com as outras descritas posteriormente nesta seção, permitem apenas um pequeno desvio de uma função de identidade.</span><span class="sxs-lookup"><span data-stu-id="b1a59-150">These APIs, in contrast to the others described later in this section, allow only a small deviation from an identity function.</span></span> <span data-ttu-id="b1a59-151">Na verdade, qualquer entrada na rampa deve estar dentro de 32768 do valor de identidade.</span><span class="sxs-lookup"><span data-stu-id="b1a59-151">In fact, any entry in the ramp must be within 32768 of the identity value.</span></span> <span data-ttu-id="b1a59-152">Essa restrição significa que nenhum aplicativo pode ativar a exibição completamente preta ou para outra cor ilegível.</span><span class="sxs-lookup"><span data-stu-id="b1a59-152">This restriction means that no app can turn the display completely black or to some other unreadable color.</span></span>

<span data-ttu-id="b1a59-153">A próxima API é o [**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp)do Microsoft Direct3D 9, que segue o mesmo padrão e formato de dados que [**SetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-setdevicegammaramp).</span><span class="sxs-lookup"><span data-stu-id="b1a59-153">The next API is Microsoft Direct3D 9’s [**SetGammaRamp**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp), which follows the same pattern and data format as [**SetDeviceGammaRamp**](/windows/win32/api/wingdi/nf-wingdi-setdevicegammaramp).</span></span> <span data-ttu-id="b1a59-154">O valor padrão da rampa de gama de Direct3D 9 não é particularmente útil; é um rampa de palavras inicializado para 0-255, não 0-65535, mesmo que a API seja definida em termos de 0-65535.</span><span class="sxs-lookup"><span data-stu-id="b1a59-154">The default value of the Direct3D 9 gamma ramp is not particularly useful; it is a ramp of WORDs initialized to 0-255, not 0-65535, even though the API is defined in terms of 0-65535.</span></span>

<span data-ttu-id="b1a59-155">A API mais recente é [**IDXGIOutput:: SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol).</span><span class="sxs-lookup"><span data-stu-id="b1a59-155">The latest API is [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol).</span></span> <span data-ttu-id="b1a59-156">Essa API tem um esquema mais flexível para expressar o controle de gama, como se ajusta ao conjunto de formatos de exibição de DXGI, incluindo dez bits de inteiros por canal, formatos float de 16 bits e o \_ formato de intervalo estendido de polarização de XR.</span><span class="sxs-lookup"><span data-stu-id="b1a59-156">This API has a more flexible scheme to express gamma control, as befits DXGI’s increased set of display formats, including ten integer bits-per-channel, 16-bit float formats and the XR\_BIAS extended range format.</span></span>

<span data-ttu-id="b1a59-157">Todas essas APIs operam no mesmo hardware e alteram os mesmos valores.</span><span class="sxs-lookup"><span data-stu-id="b1a59-157">All of these APIs operate on the same hardware, and change the same values.</span></span> <span data-ttu-id="b1a59-158">As APIs do Direct3D 9 e DXGI são "somente gravação".</span><span class="sxs-lookup"><span data-stu-id="b1a59-158">The Direct3D 9 and DXGI APIs are “write only”.</span></span> <span data-ttu-id="b1a59-159">Você não pode ler o valor do hardware, modificá-lo e, em seguida, defini-lo.</span><span class="sxs-lookup"><span data-stu-id="b1a59-159">You can't read the value of the hardware, modify it, and then set it.</span></span> <span data-ttu-id="b1a59-160">Você só pode definir a rampa.</span><span class="sxs-lookup"><span data-stu-id="b1a59-160">You can only set the ramp.</span></span> <span data-ttu-id="b1a59-161">Além disso, você só pode definir o gama quando o aplicativo está em tela inteira.</span><span class="sxs-lookup"><span data-stu-id="b1a59-161">Furthermore, you can only set gamma when the app is full screen.</span></span> <span data-ttu-id="b1a59-162">Essa restrição é outra maneira de garantir que a área de trabalho sempre seja legível.</span><span class="sxs-lookup"><span data-stu-id="b1a59-162">This restriction is another way to guarantee that the desktop is always readable.</span></span> <span data-ttu-id="b1a59-163">Ou seja, o aplicativo pode incomodar sua própria exibição, mas o Windows irá restaurar a rampa de gama anterior quando o aplicativo perde a tela inteira (por exemplo, por meio de Alt-Tab ou Ctrl-Alt-Del).</span><span class="sxs-lookup"><span data-stu-id="b1a59-163">That is, the app can disturb its own display, but Windows will restore the previous gamma ramp when the app loses full screen (for example, via alt-tab or ctrl-alt-del).</span></span>

## <a name="evolution-of-display-hardware"></a><span data-ttu-id="b1a59-164">Evolução do hardware de vídeo</span><span class="sxs-lookup"><span data-stu-id="b1a59-164">Evolution of display hardware</span></span>

<span data-ttu-id="b1a59-165">Alguns monitores mais recentes podem exibir uma ampla gama de intensidades.</span><span class="sxs-lookup"><span data-stu-id="b1a59-165">Some newer monitors can display a wide range of intensities.</span></span> <span data-ttu-id="b1a59-166">Mas, quando o formato de exibição pode representar apenas valores entre zero e um, a exibição deve mapear zero para seu valor mais escuro e um para seu valor mais brilhante.</span><span class="sxs-lookup"><span data-stu-id="b1a59-166">But, when the display format can represent only values between zero and one, the display must map zero to its darkest value and one to its brightest value.</span></span> <span data-ttu-id="b1a59-167">Esse valor mais brilhante pode ser muito claro para a exibição confortável de páginas da Web com texto preto em um plano de fundo branco, mas é maravilhoso para efeitos especiais mais brilhantes, como a exibição do Glittering de luz solar de um lago ou relâmpago de bifurcação do céu.</span><span class="sxs-lookup"><span data-stu-id="b1a59-167">This brightest value might be far too bright for comfortable viewing of Web pages with black text on a white background but is wonderful for over-bright special effects, such as viewing sunlight glittering off of a lake or lightning forking the sky.</span></span> <span data-ttu-id="b1a59-168">Portanto, precisamos de uma maneira de expressar esses intervalos mais amplos.</span><span class="sxs-lookup"><span data-stu-id="b1a59-168">So, we need a way to express these wider ranges.</span></span> <span data-ttu-id="b1a59-169">DXGI 1,1 e posterior contém valores de formato de exibição que permitem que 1,0 representem um valor branco confortável e reservam valores de formato de exibição mais largos para efeitos especiais mais brilhantes.</span><span class="sxs-lookup"><span data-stu-id="b1a59-169">DXGI 1.1 and later contains display format values that let 1.0 represent a comfortable white value and reserves wider display format values for over-bright special effects.</span></span> <span data-ttu-id="b1a59-170">DXGI 1,1 dá suporte a dois formatos de exibição que podem expressar esses valores mais largos: \_ formato dxgi \_ R10G10B10 \_ XR \_ Bias \_ a2 \_ UNORM e ponto flutuante de 16 bits.</span><span class="sxs-lookup"><span data-stu-id="b1a59-170">DXGI 1.1 supports two display formats that can express these wider values: DXGI\_FORMAT\_R10G10B10\_XR\_BIAS\_A2\_UNORM and 16-bit floating point.</span></span> <span data-ttu-id="b1a59-171">Para obter uma discussão completa sobre esses formatos, consulte [detalhes do formato estendido](/windows-hardware/drivers/display/details-of-the-extended-format).</span><span class="sxs-lookup"><span data-stu-id="b1a59-171">For a full discussion of these formats, see [Details of the Extended Format](/windows-hardware/drivers/display/details-of-the-extended-format).</span></span> <span data-ttu-id="b1a59-172">Em seguida, examinamos por que a API gama [**IDXGIOutput:: SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) do dxgi precisa de valores de pixel maiores que 1,0.</span><span class="sxs-lookup"><span data-stu-id="b1a59-172">Next, we look at why DXGI’s [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) gamma API needs pixel values greater than 1.0.</span></span>

## <a name="gamma-control-capabilities-in-dxgi"></a><span data-ttu-id="b1a59-173">Recursos de controle de gama em DXGI</span><span class="sxs-lookup"><span data-stu-id="b1a59-173">Gamma control capabilities in DXGI</span></span>

<span data-ttu-id="b1a59-174">DXGI permite que o driver de vídeo Expresse seus controles gama como uma função linear de etapa.</span><span class="sxs-lookup"><span data-stu-id="b1a59-174">DXGI lets the display driver express its gamma controls as a step-wise linear function.</span></span> <span data-ttu-id="b1a59-175">Essa função linear por etapa é definida pelos pontos de controle dessa função, o intervalo de valores para os quais a função pode ser convertida e uma operação adicional de escala e deslocamento opcional que pode ser aplicada após a conversão.</span><span class="sxs-lookup"><span data-stu-id="b1a59-175">This step-wise linear function is defined by the control points of this function, the range of values the function can convert to, and an additional optional scale-and-offset operation that can be applied after conversion.</span></span> <span data-ttu-id="b1a59-176">Um aplicativo pode chamar o método [**IDXGIOutput:: GetGammaControlCapabilities**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-getgammacontrolcapabilities) para recuperar todos esses recursos de controle na estrutura [**de \_ \_ \_ recursos de controle do dxgi gama**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) .</span><span class="sxs-lookup"><span data-stu-id="b1a59-176">An app can call the [**IDXGIOutput::GetGammaControlCapabilities**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-getgammacontrolcapabilities) method to retrieve all of these control capabilities in the [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) structure.</span></span>

<span data-ttu-id="b1a59-177">Esse grafo mostra uma função linear com apenas quatro pontos de controle.</span><span class="sxs-lookup"><span data-stu-id="b1a59-177">This graph shows a linear function with just four control points.</span></span>

![função linear de correção gama](images/gamma-linear-function.png)

<span data-ttu-id="b1a59-179">DXGI define os pontos de controle por sua localização ao longo do eixo de cores da superfície.</span><span class="sxs-lookup"><span data-stu-id="b1a59-179">DXGI defines control points by their location along the surface color axis.</span></span> <span data-ttu-id="b1a59-180">No grafo anterior, os locais dos pontos de controle são 0, 0,5, 0,75 e 1,0.</span><span class="sxs-lookup"><span data-stu-id="b1a59-180">In the preceding graph, the locations of the control points are 0, 0.5, 0.75 and 1.0.</span></span> <span data-ttu-id="b1a59-181">Esses pontos de controle indicam que o hardware pode converter valores no intervalo de 0 a 1,0.</span><span class="sxs-lookup"><span data-stu-id="b1a59-181">These control points indicate that the hardware can convert values in the range 0 through 1.0.</span></span> <span data-ttu-id="b1a59-182">DXGI lista esses pontos de controle no  membro da matriz ControlPointPositions [**de \_ \_ \_ recursos de controle do dxgi gama**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) e sempre os declara em ordem crescente.</span><span class="sxs-lookup"><span data-stu-id="b1a59-182">DXGI lists these control points in the **ControlPointPositions** array member of [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) and always declares them in increasing order.</span></span> <span data-ttu-id="b1a59-183">DXGI preenche apenas os primeiros elementos da matriz **ControlPointPositions** e indica o número de elementos com o membro **NumGammaControlPoints** dos **recursos de \_ \_ controle \_ do dxgi gama**.</span><span class="sxs-lookup"><span data-stu-id="b1a59-183">DXGI fills only the first elements of the **ControlPointPositions** array and indicates the number of elements with the **NumGammaControlPoints** member of **DXGI\_GAMMA\_CONTROL\_CAPABILITIES**.</span></span> <span data-ttu-id="b1a59-184">Se **NumGammaControlPoints** for menor que 1025, DXGI deixará o restante dos elementos **ControlPointPositions** indefinidos.</span><span class="sxs-lookup"><span data-stu-id="b1a59-184">If **NumGammaControlPoints** is less than 1025, DXGI leaves the rest of the **ControlPointPositions** elements undefined.</span></span>

<span data-ttu-id="b1a59-185">O hardware representado por esse grafo pode converter valores em um intervalo de 0 a 1,25.</span><span class="sxs-lookup"><span data-stu-id="b1a59-185">The hardware represented by this graph can convert values to a range of 0 through 1.25.</span></span> <span data-ttu-id="b1a59-186">Portanto, DXGI define os membros **MinConvertedValue** e **MaxConvertedValue** como 0,0 f e 1,25 f, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="b1a59-186">So, DXGI sets the **MinConvertedValue** and **MaxConvertedValue** members to 0.0f and 1.25f respectively.</span></span>

<span data-ttu-id="b1a59-187">DXGI define o membro **ScaleAndOffsetSupported** dos [**\_ \_ \_ recursos de controle do dxgi gama**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) para indicar se o hardware dá suporte ao recurso de escala e deslocamento.</span><span class="sxs-lookup"><span data-stu-id="b1a59-187">DXGI sets the **ScaleAndOffsetSupported** member of [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) to indicate whether the hardware supports the scale-and-offset capability.</span></span> <span data-ttu-id="b1a59-188">Se o hardware oferecer suporte a escala e deslocamento, ele mantém uma tabela simples de pesquisa um-para-um, mas, em seguida, ajusta a saída da tabela para alongar a saída para um intervalo maior que \[ 0, 1 \] .</span><span class="sxs-lookup"><span data-stu-id="b1a59-188">If hardware supports scale-and-offset, it keeps a simple one-to-one lookup table but then adjusts the output of the table to stretch the output to a range greater than \[0,1\].</span></span> <span data-ttu-id="b1a59-189">O hardware primeiro dimensiona os valores que vêm da tabela de pesquisa e os desloca.</span><span class="sxs-lookup"><span data-stu-id="b1a59-189">The hardware first scales the values that come out of the lookup table and then offsets them.</span></span>

> [!Note]  
> <span data-ttu-id="b1a59-190">Monitores diferentes conectados ao mesmo computador podem ter diferentes recursos de controle gama.</span><span class="sxs-lookup"><span data-stu-id="b1a59-190">Different monitors connected to the same computer might have different gamma control capabilities.</span></span> <span data-ttu-id="b1a59-191">Além disso, os recursos de controle do gama podem, na verdade, mudar dependendo do modo de exibição da saída.</span><span class="sxs-lookup"><span data-stu-id="b1a59-191">Moreover, the gamma control capabilities can in fact change depending on the display mode of the output.</span></span> <span data-ttu-id="b1a59-192">Consequentemente, recomendamos que você sempre chame [**IDXGIOutput:: GetGammaControlCapabilities**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-getgammacontrolcapabilities) para consultar os recursos de controle de gama depois que seu aplicativo entrar no modo de tela inteira.</span><span class="sxs-lookup"><span data-stu-id="b1a59-192">Consequently, we recommend that you always call [**IDXGIOutput::GetGammaControlCapabilities**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-getgammacontrolcapabilities) to query gamma control capabilities after your app enters full-screen mode.</span></span>

 

<span data-ttu-id="b1a59-193">Você pode usar esses valores de capacidade de controle de gama para derivar valores de controle que podem ser definidos usando a API [**IDXGIOutput:: SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) .</span><span class="sxs-lookup"><span data-stu-id="b1a59-193">You can use these gamma control capability values to derive control values that you can then set by using the [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) API.</span></span>

## <a name="setting-gamma-control-with-dxgi"></a><span data-ttu-id="b1a59-194">Definindo o controle gama com DXGI</span><span class="sxs-lookup"><span data-stu-id="b1a59-194">Setting gamma control with DXGI</span></span>

<span data-ttu-id="b1a59-195">Para definir controles gama, você passa um ponteiro para uma estrutura de [**\_ \_ controle do dxgi gama**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) quando chama a API [**IDXGIOutput:: SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) .</span><span class="sxs-lookup"><span data-stu-id="b1a59-195">To set gamma controls, you pass a pointer to a [**DXGI\_GAMMA\_CONTROL**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) structure when you call the [**IDXGIOutput::SetGammaControl**](/windows/desktop/api/DXGI/nf-dxgi-idxgioutput-setgammacontrol) API.</span></span>

<span data-ttu-id="b1a59-196">Você define os membros de **escala** e **deslocamento** do [**controle de \_ gama \_ de dxgi**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) para especificar os valores de escala e deslocamento que você deseja que o hardware aplique aos valores obtidos da tabela de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="b1a59-196">You set the **Scale** and **Offset** members of [**DXGI\_GAMMA\_CONTROL**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) to specify the scale and offset values that you want the hardware to apply to the values that you get from the lookup table.</span></span> <span data-ttu-id="b1a59-197">Você pode definir com segurança a **escala** como 1 e o **deslocamento** para zero (ou seja, uma escala por um não tem nenhum efeito e um deslocamento de zero não tem nenhum efeito) se você não quiser usar o recurso de escala e deslocamento ou se o hardware não tiver esse recurso.</span><span class="sxs-lookup"><span data-stu-id="b1a59-197">You can safely set **Scale** to 1 and **Offset** to zero (that is, a scale by one has no effect and an offset of zero has no effect) if you don't want to use the scale-and-offset capability or if the hardware doesn't have that capability.</span></span>

<span data-ttu-id="b1a59-198">Você define o  membro da matriz GammaCurve [**do \_ \_ controle de gama de dxgi**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) para uma lista de estruturas de [**\_ RGB de dxgi**](/previous-versions/windows/desktop/legacy/bb173071(v=vs.85)) para os pontos na curva gama.</span><span class="sxs-lookup"><span data-stu-id="b1a59-198">You set the **GammaCurve** array member of [**DXGI\_GAMMA\_CONTROL**](/previous-versions/windows/desktop/legacy/bb173061(v=vs.85)) to a list of [**DXGI\_RGB**](/previous-versions/windows/desktop/legacy/bb173071(v=vs.85)) structures for the points on the gamma curve.</span></span> <span data-ttu-id="b1a59-199">Cada elemento do **dxgi \_ RGB** especifica os valores float que representam os componentes vermelho, verde e azul para esse ponto.</span><span class="sxs-lookup"><span data-stu-id="b1a59-199">Each **DXGI\_RGB** element specifies the float values that represent the red, green, and blue components for that point.</span></span> <span data-ttu-id="b1a59-200">A curva gama não usa valores Alfa.</span><span class="sxs-lookup"><span data-stu-id="b1a59-200">The gamma curve doesn't use alpha values.</span></span> <span data-ttu-id="b1a59-201">Você usa o número obtido do **NumGammaControlPoints** de recursos de [**\_ \_ controle \_ do dxgi gama**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) para preencher esse número de elementos na matriz **GammaCurve** .</span><span class="sxs-lookup"><span data-stu-id="b1a59-201">You use the number that you obtained from **NumGammaControlPoints** of [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)) to fill that number of elements in the **GammaCurve** array.</span></span> <span data-ttu-id="b1a59-202">Cada elemento que você coloca na matriz **GammaCurve** é a altura de cada ponto de controle.</span><span class="sxs-lookup"><span data-stu-id="b1a59-202">Each element that you place in the **GammaCurve** array is the height for each control point.</span></span>

<span data-ttu-id="b1a59-203">Observe no grafo anterior que agora você tem controle sobre o posicionamento vertical de cada ponto de controle e tem um controle separado para vermelho, verde e azul.</span><span class="sxs-lookup"><span data-stu-id="b1a59-203">Notice in the preceding graph that you now have control over the vertical placement of each control point, and you have separate control for red, green and blue.</span></span> <span data-ttu-id="b1a59-204">Por exemplo, você pode definir todos os valores verdes e azuis como zero e definir os valores vermelhos como uma escada crescente de zero para um.</span><span class="sxs-lookup"><span data-stu-id="b1a59-204">For example, you can set all of the green and blue values to zero and set the red values to an ascending staircase from zero to one.</span></span> <span data-ttu-id="b1a59-205">Nesse cenário, a imagem exibida mostra apenas suas partes vermelhas, com azul e verde aparecendo como preto.</span><span class="sxs-lookup"><span data-stu-id="b1a59-205">In this scenario, the displayed image shows only its red parts, with the blue and green appearing as black.</span></span> <span data-ttu-id="b1a59-206">Você também pode definir uma escada decrescente para todas as cores, o que resulta em uma exibição invertida.</span><span class="sxs-lookup"><span data-stu-id="b1a59-206">You can also set a descending staircase for all colors, which results in an inverted display.</span></span> <span data-ttu-id="b1a59-207">Qualquer valor que você coloca na matriz **GammaCurve** deve estar inclusivamente dentro dos valores obtidos dos membros **MinConvertedValue** e **MaxConvertedValue** dos recursos de [**\_ \_ controle \_ do dxgi gama**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="b1a59-207">Any value you place in the **GammaCurve** array must be inclusively within the values you obtained from the **MinConvertedValue** and **MaxConvertedValue** members of [**DXGI\_GAMMA\_CONTROL\_CAPABILITIES**](/previous-versions/windows/desktop/legacy/bb173062(v=vs.85)).</span></span>

## <a name="gamma-control-practicalities"></a><span data-ttu-id="b1a59-208">Práticas de controle de gama</span><span class="sxs-lookup"><span data-stu-id="b1a59-208">Gamma control practicalities</span></span>

<span data-ttu-id="b1a59-209">Os controles de gama de DXGI aplicam-se somente enquanto o aplicativo estiver em tela inteira.</span><span class="sxs-lookup"><span data-stu-id="b1a59-209">DXGI’s gamma controls apply only as long as the app is full screen.</span></span> <span data-ttu-id="b1a59-210">O Windows restaura o estado anterior da exibição quando o aplicativo é encerrado ou retorna ao modo de janela.</span><span class="sxs-lookup"><span data-stu-id="b1a59-210">Windows restores the previous state of the display when the app exits or returns to windowed mode.</span></span> <span data-ttu-id="b1a59-211">Mas o Windows não restaura o estado de gama do aplicativo se o aplicativo inserir novamente o modo de tela inteira.</span><span class="sxs-lookup"><span data-stu-id="b1a59-211">But Windows doesn’t restore your app’s gamma state if the app re-enters full-screen mode.</span></span> <span data-ttu-id="b1a59-212">Seu aplicativo deve restaurar explicitamente seu estado de gama quando ele reinserir o modo de tela inteira.</span><span class="sxs-lookup"><span data-stu-id="b1a59-212">Your app must explicitly restore its gamma state when it re-enters full-screen mode.</span></span>

<span data-ttu-id="b1a59-213">Nem todos os adaptadores dão suporte ao controle gama.</span><span class="sxs-lookup"><span data-stu-id="b1a59-213">Not all adapters support gamma control.</span></span> <span data-ttu-id="b1a59-214">Se um adaptador não oferecer suporte ao controle gama, ele ignorará as chamadas para definir uma rampa de gama.</span><span class="sxs-lookup"><span data-stu-id="b1a59-214">If an adapter doesn't support gamma control, it ignores calls to set a gamma ramp.</span></span>

<span data-ttu-id="b1a59-215">Os aplicativos executados na área de trabalho remota não podem controlar o gama.</span><span class="sxs-lookup"><span data-stu-id="b1a59-215">Apps that run under remote desktop can't control gamma at all.</span></span>

<span data-ttu-id="b1a59-216">O cursor do mouse, se for implementado em hardware (como a maioria deles), normalmente não responderá à configuração gama.</span><span class="sxs-lookup"><span data-stu-id="b1a59-216">The mouse cursor, if it is implemented in hardware (as most are), typically doesn't respond to the gamma setting.</span></span>

## <a name="related-topics"></a><span data-ttu-id="b1a59-217">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="b1a59-217">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="b1a59-218">Guia de programação para DXGI</span><span class="sxs-lookup"><span data-stu-id="b1a59-218">Programming Guide for DXGI</span></span>](dx-graphics-dxgi-overviews.md)
</dt> </dl>

 

 
