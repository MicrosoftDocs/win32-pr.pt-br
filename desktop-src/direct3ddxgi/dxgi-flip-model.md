---
description: O Windows 8 adiciona suporte para o modelo de apresentação de flip e suas estatísticas atuais associadas no DXGI 1,2.
ms.assetid: E132DAF5-80B7-4C52-A760-3779CC140CE7
title: Modelo de flip DXGI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49ee82febd13a3b57a06d93fd01eb8d230d6b78a
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/06/2021
ms.locfileid: "103825824"
---
# <a name="dxgi-flip-model"></a><span data-ttu-id="9cb3f-103">Modelo de flip DXGI</span><span class="sxs-lookup"><span data-stu-id="9cb3f-103">DXGI flip model</span></span>

<span data-ttu-id="9cb3f-104">O Windows 8 adiciona suporte para o modelo de apresentação de flip e suas estatísticas atuais associadas no DXGI 1,2.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-104">Windows 8 adds support for flip presentation model and its associated present statistics in DXGI 1.2.</span></span> <span data-ttu-id="9cb3f-105">O modelo de apresentação de inversão DXGI do Windows 8 é semelhante à [apresentação do modo de inversão do Direct3D 9EX](../direct3darticles/direct3d-9ex-improvements.md)do Windows 7.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-105">Windows 8’s DXGI flip presentation model is similar to Windows 7’s [Direct3D 9EX Flip Mode Presentation](../direct3darticles/direct3d-9ex-improvements.md).</span></span> <span data-ttu-id="9cb3f-106">Aplicativos de apresentação baseados em taxas de vídeo ou quadros, como jogos, podem se beneficiar mais usando o modelo de apresentação de flip.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-106">Video or frame rate-based presentation apps such as games can benefit most by using flip presentation model.</span></span> <span data-ttu-id="9cb3f-107">Os aplicativos que usam o modelo de apresentação de flip DXGI reduzem a carga de recursos do sistema e aumentam o desempenho.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-107">Apps that use DXGI flip presentation model reduce the system resource load and increase performance.</span></span> <span data-ttu-id="9cb3f-108">Os aplicativos também podem usar os aprimoramentos de estatísticas atuais com o modelo de apresentação de inversão para controlar melhor a taxa de apresentação, fornecendo comentários em tempo real e mecanismos de correção.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-108">Apps can also use present statistics enhancements with flip presentation model to better control the rate of presentation by providing real-time feedback and correction mechanisms.</span></span>

-   [<span data-ttu-id="9cb3f-109">Comparando o modelo de inversão DXGI e o modelo BitBlt</span><span class="sxs-lookup"><span data-stu-id="9cb3f-109">Comparing the DXGI flip model and the BitBlt model</span></span>](#comparing-the-dxgi-flip-model-and-the-bitblt-model)
-   [<span data-ttu-id="9cb3f-110">Como usar o modelo de flip DXGI</span><span class="sxs-lookup"><span data-stu-id="9cb3f-110">How to use DXGI flip model</span></span>](#how-to-use-dxgi-flip-model)
-   [<span data-ttu-id="9cb3f-111">Sincronização de quadros de aplicativos de modelo de flip-DXGI</span><span class="sxs-lookup"><span data-stu-id="9cb3f-111">Frame synchronization of DXGI flip model apps</span></span>](#frame-synchronization-of-dxgi-flip-model-apps)
-   [<span data-ttu-id="9cb3f-112">Evitando, detectando e recuperando de falhas</span><span class="sxs-lookup"><span data-stu-id="9cb3f-112">Avoiding, detecting, and recovering from glitches</span></span>](#avoiding-detecting-and-recovering-from-glitches)
-   [<span data-ttu-id="9cb3f-113">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="9cb3f-113">Related topics</span></span>](#related-topics)

## <a name="comparing-the-dxgi-flip-model-and-the-bitblt-model"></a><span data-ttu-id="9cb3f-114">Comparando o modelo de inversão DXGI e o modelo BitBlt</span><span class="sxs-lookup"><span data-stu-id="9cb3f-114">Comparing the DXGI flip model and the BitBlt model</span></span>

<span data-ttu-id="9cb3f-115">O tempo de execução usa a BitBlt (transferência de bloco de bits) e os modelos de apresentação de flip para apresentar conteúdo gráfico em monitores de exibição.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-115">The runtime uses the bit-block transfer (bitblt) and flip presentation models to present graphics content on display monitors.</span></span> <span data-ttu-id="9cb3f-116">A maior diferença entre os modelos de apresentação BitBlt e flip é como o conteúdo de back-buffer chega ao DWM do Windows 8 para composição.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-116">The biggest difference between bitblt and flip presentation models is how back-buffer contents get to the Windows 8 DWM for composition.</span></span> <span data-ttu-id="9cb3f-117">No modelo BitBlt, o conteúdo do buffer de fundo é copiado para a superfície de redirecionamento em cada chamada para [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1).</span><span class="sxs-lookup"><span data-stu-id="9cb3f-117">In the bitblt model, contents of the back buffer are copied into the redirection surface on each call to [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1).</span></span> <span data-ttu-id="9cb3f-118">No modelo inverter, todos os buffers de fundo são compartilhados com o Gerenciador de Janelas da Área de Trabalho (DWM).</span><span class="sxs-lookup"><span data-stu-id="9cb3f-118">In the flip model, all back buffers are shared with the Desktop Window Manager (DWM).</span></span> <span data-ttu-id="9cb3f-119">Portanto, o DWM pode compor diretamente dos buffers de fundo sem nenhuma operação de cópia adicional.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-119">Therefore, the DWM can compose straight from those back buffers without any additional copy operations.</span></span> <span data-ttu-id="9cb3f-120">Em geral, o modelo de inversão é mais eficiente.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-120">In general, the flip model is more efficient.</span></span> <span data-ttu-id="9cb3f-121">O modelo de inversão também fornece mais recursos, como as estatísticas presentes aprimoradas.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-121">The flip model also provides more features, such as enhanced present statistics.</span></span>

<span data-ttu-id="9cb3f-122">Se você tiver componentes herdados que usam o Windows Graphics Device Interface (GDI) para gravar em um [**HWND**](../winprog/windows-data-types.md) diretamente, use o modelo BitBlt.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-122">If you have legacy components that use Windows Graphics Device Interface (GDI) to write to an [**HWND**](../winprog/windows-data-types.md) directly, use the bitblt model.</span></span>

<span data-ttu-id="9cb3f-123">As melhorias de desempenho do modelo de inversão DXGI são significativas quando o aplicativo está no modo de janela.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-123">Performance improvements of DXGI flip model are significant when the app is in windowed mode.</span></span> <span data-ttu-id="9cb3f-124">A sequência nesta tabela e a ilustração comparam os usos de largura de banda da memória e as leituras do sistema e as gravações de aplicativos em janelas que escolhem o modelo de flip versus o modelo BitBlt.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-124">The sequence in this table and the illustration compare memory bandwidth usages and system reads and writes of windowed apps that choose flip model versus the bitblt model.</span></span>



| <span data-ttu-id="9cb3f-125">Etapa</span><span class="sxs-lookup"><span data-stu-id="9cb3f-125">Step</span></span> | <span data-ttu-id="9cb3f-126">Modelo BitBlt presente para DWM</span><span class="sxs-lookup"><span data-stu-id="9cb3f-126">BitBlt model present to DWM</span></span>                                                                               | <span data-ttu-id="9cb3f-127">Modelo de flip DXGI presente para DWM</span><span class="sxs-lookup"><span data-stu-id="9cb3f-127">DXGI flip model present to DWM</span></span>                                   |
|------|-----------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|
| <span data-ttu-id="9cb3f-128">1.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-128">1.</span></span>   | <span data-ttu-id="9cb3f-129">O aplicativo atualiza seu quadro (gravação)</span><span class="sxs-lookup"><span data-stu-id="9cb3f-129">The app updates its frame (Write)</span></span><br/>                                                              | <span data-ttu-id="9cb3f-130">O aplicativo atualiza seu quadro (gravação)</span><span class="sxs-lookup"><span data-stu-id="9cb3f-130">The app updates its frame (Write)</span></span><br/>                     |
| <span data-ttu-id="9cb3f-131">2.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-131">2.</span></span>   | <span data-ttu-id="9cb3f-132">O Direct3D Runtime copia o conteúdo da superfície para uma superfície de redirecionamento de DWM (leitura, gravação)</span><span class="sxs-lookup"><span data-stu-id="9cb3f-132">Direct3D runtime copies surface contents to a DWM redirection surface (Read, Write)</span></span><br/>            | <span data-ttu-id="9cb3f-133">O tempo de execução do Direct3D passa a superfície do aplicativo para o DWM</span><span class="sxs-lookup"><span data-stu-id="9cb3f-133">Direct3D runtime passes the app surface to DWM</span></span><br/>        |
| <span data-ttu-id="9cb3f-134">3.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-134">3.</span></span>   | <span data-ttu-id="9cb3f-135">Após a conclusão da cópia de superfície compartilhada, o DWM renderiza a superfície do aplicativo na tela (leitura, gravação)</span><span class="sxs-lookup"><span data-stu-id="9cb3f-135">After the shared surface copy completes, DWM renders the app surface onto screen (Read, Write)</span></span><br/> | <span data-ttu-id="9cb3f-136">O DWM renderiza a superfície do aplicativo na tela (leitura, gravação)</span><span class="sxs-lookup"><span data-stu-id="9cb3f-136">DWM renders the app surface onto screen (Read, Write)</span></span><br/> |



 

![ilustração de uma comparação do modelo BLT e do flip Model](images/blt-flip-mode-present.png)

<span data-ttu-id="9cb3f-138">O flip Model reduz o uso de memória do sistema, reduzindo o número de leituras e gravações pelo tempo de execução do Direct3D para a composição de quadro em janela pelo DWM.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-138">Flip model reduces system memory usage by reducing the number of reads and writes by the Direct3D runtime for the windowed frame composition by DWM.</span></span>

## <a name="how-to-use-dxgi-flip-model"></a><span data-ttu-id="9cb3f-139">Como usar o modelo de flip DXGI</span><span class="sxs-lookup"><span data-stu-id="9cb3f-139">How to use DXGI flip model</span></span>

<span data-ttu-id="9cb3f-140">Os aplicativos do Direct3D 11,1 destinados ao Windows 8 usam o flip Model criando a cadeia de permuta com o [**efeito de permuta de dxgi \_ \_ \_ inverter \_**](/windows/desktop/api/DXGI/ne-dxgi-dxgi_swap_effect) valor de enumeração sequencial definido no membro **SwapEffect** da estrutura [**\_ DESC1 da \_ cadeia \_ de permuta dxgi**](/windows/desktop/api/DXGI1_2/ns-dxgi1_2-dxgi_swap_chain_desc1) .</span><span class="sxs-lookup"><span data-stu-id="9cb3f-140">Direct3D 11.1 apps that target Windows 8 use flip model by creating the swap chain with the [**DXGI\_SWAP\_EFFECT\_FLIP\_SEQUENTIAL**](/windows/desktop/api/DXGI/ne-dxgi-dxgi_swap_effect) enumeration value set in the **SwapEffect** member of the [**DXGI\_SWAP\_CHAIN\_DESC1**](/windows/desktop/api/DXGI1_2/ns-dxgi1_2-dxgi_swap_chain_desc1) structure.</span></span> <span data-ttu-id="9cb3f-141">Quando você define **SwapEffect** para o **efeito de permuta de dxgi \_ \_ \_ inverter \_ sequencial**, também define esses membros da **cadeia de permuta dxgi \_ \_ \_ DESC1** com os valores indicados:</span><span class="sxs-lookup"><span data-stu-id="9cb3f-141">When you set **SwapEffect** to **DXGI\_SWAP\_EFFECT\_FLIP\_SEQUENTIAL**, also set these members of **DXGI\_SWAP\_CHAIN\_DESC1** to the indicated values:</span></span>

-   <span data-ttu-id="9cb3f-142">**BufferCount** a um valor entre 2 e 16 para evitar uma penalidade de desempenho como resultado da espera do DWM para liberar o buffer de apresentação anterior.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-142">**BufferCount** to a value between 2 and 16 to prevent a performance penalty as a result of waiting on DWM to release the previous presentation buffer.</span></span>
-   <span data-ttu-id="9cb3f-143">**Formato** para o \_ formato dxgi \_ R16G16B16A16 \_ float, \_ formato dxgi \_ B8G8R8A8 \_ UNORM ou formato dxgi \_ \_ R8G8B8A8 \_ UNORM</span><span class="sxs-lookup"><span data-stu-id="9cb3f-143">**Format** to DXGI\_FORMAT\_R16G16B16A16\_FLOAT, DXGI\_FORMAT\_B8G8R8A8\_UNORM, or DXGI\_FORMAT\_R8G8B8A8\_UNORM</span></span>
-   <span data-ttu-id="9cb3f-144">**Contagem** de membros da [**estrutura \_ \_ desc de exemplo de dxgi**](/windows/desktop/api/dxgicommon/ns-dxgicommon-dxgi_sample_desc) que o membro **SampleDesc** especifica para um e o membro de **qualidade** do **\_ exemplo \_ desc de dxgi** a zero porque não há suporte para a MSAA (várias amostras de anti-aliasing)</span><span class="sxs-lookup"><span data-stu-id="9cb3f-144">**Count** member of the [**DXGI\_SAMPLE\_DESC**](/windows/desktop/api/dxgicommon/ns-dxgicommon-dxgi_sample_desc) structure that the **SampleDesc** member specifies to one and the **Quality** member of **DXGI\_SAMPLE\_DESC** to zero because multiple sample antialiasing (MSAA) is not supported</span></span>

<span data-ttu-id="9cb3f-145">Se você usar [**o \_ efeito de permuta dxgi \_ \_ inverter \_ sequencialmente**](/windows/desktop/api/DXGI/ne-dxgi-dxgi_swap_effect) no sistema operacional Windows 7 ou anterior, a criação do dispositivo falhará.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-145">If you use [**DXGI\_SWAP\_EFFECT\_FLIP\_SEQUENTIAL**](/windows/desktop/api/DXGI/ne-dxgi-dxgi_swap_effect) on Windows 7 or earlier operating system, device creation fails.</span></span> <span data-ttu-id="9cb3f-146">Ao usar o flip Model, você pode usar as estatísticas de apresentação em tela inteira no modo de janela.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-146">When you use flip model, you can use full-screen present statistics in windowed mode.</span></span> <span data-ttu-id="9cb3f-147">O comportamento de tela inteira não é afetado.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-147">Full-screen behavior is not affected.</span></span> <span data-ttu-id="9cb3f-148">Se você passar **NULL** para o parâmetro *pFullscreenDesc* de [**IDXGIFactory2:: CreateSwapChainForHwnd**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgifactory2-createswapchainforhwnd) para uma cadeia de permuta em janela e definir **SwapEffect** como efeito de permuta de **dxgi, \_ \_ \_ inverter \_ sequencialmente**, o tempo de execução criará um buffer de fundo extra e girará qualquer identificador que pertença ao buffer que se torna o buffer frontal no momento da apresentação.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-148">If you pass **NULL** to the *pFullscreenDesc* parameter of [**IDXGIFactory2::CreateSwapChainForHwnd**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgifactory2-createswapchainforhwnd) for a windowed swap chain and set **SwapEffect** to **DXGI\_SWAP\_EFFECT\_FLIP\_SEQUENTIAL**, the runtime creates one extra back buffer and rotates whichever handle belongs to the buffer that becomes the front buffer at presentation time.</span></span>

<span data-ttu-id="9cb3f-149">Ao usar o flip Model, considere estas dicas:</span><span class="sxs-lookup"><span data-stu-id="9cb3f-149">When you use flip model, consider these tips:</span></span>

-   <span data-ttu-id="9cb3f-150">Use uma cadeia de permuta de modelo de flip por [**HWND**](../winprog/windows-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="9cb3f-150">Use one flip model swap chain per [**HWND**](../winprog/windows-data-types.md).</span></span> <span data-ttu-id="9cb3f-151">Não direcione vários cadeias de permuta de modelo de flip para o mesmo **HWND**.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-151">Do not target multiple flip model swap chains to the same **HWND**.</span></span>
-   <span data-ttu-id="9cb3f-152">Não use a cadeia de permuta de modelo de flip com a função [**ScrollWindow**](/windows/win32/api/winuser/nf-winuser-scrollwindow) ou [**ScrollWindowEx**](/windows/win32/api/winuser/nf-winuser-scrollwindowex) da GDI.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-152">Do not use flip model swap chain with GDI's [**ScrollWindow**](/windows/win32/api/winuser/nf-winuser-scrollwindow) or [**ScrollWindowEx**](/windows/win32/api/winuser/nf-winuser-scrollwindowex) function.</span></span> <span data-ttu-id="9cb3f-153">Alguns aplicativos do Direct3D usam as funções **ScrollWindow** e **ScrollWindowEx** da GDI para atualizar o conteúdo da janela após a ocorrência de um evento de rolagem do usuário.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-153">Some Direct3D apps use GDI's **ScrollWindow** and **ScrollWindowEx** functions to update window contents after a user scroll event occurs.</span></span> <span data-ttu-id="9cb3f-154">**ScrollWindow** e **ScrollWindowEx** executam bitblts de conteúdo da janela na tela enquanto o usuário rola uma janela.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-154">**ScrollWindow** and **ScrollWindowEx** perform bitblts of window contents on screen as the user scrolls a window.</span></span> <span data-ttu-id="9cb3f-155">Essas funções também exigem atualizações de modelo BitBlt para conteúdo GDI e Direct3D.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-155">These functions also require bitblt model updates for GDI and Direct3D content.</span></span> <span data-ttu-id="9cb3f-156">Os aplicativos que usam qualquer função não exibirão, necessariamente, a rolagem do conteúdo da janela visível na tela quando o aplicativo estiver no modo de janela.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-156">Apps that use either function will not necessarily display visible window contents scrolling on screen when the app is in windowed mode.</span></span> <span data-ttu-id="9cb3f-157">Recomendamos que você não use as funções **ScrollWindow** e **ScrollWindowEx** da GDI e, em vez disso, Redesenhe o conteúdo GDI e Direct3D na tela em resposta à rolagem.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-157">We recommend that you not use GDI's **ScrollWindow** and **ScrollWindowEx** functions, and instead redraw GDI and Direct3D contents on screen in response to scrolling.</span></span>
-   <span data-ttu-id="9cb3f-158">Use o flip Model em um [**HWND**](../winprog/windows-data-types.md) que não é também direcionado por outras APIs, incluindo o modelo de apresentação dxgi BitBlt, outras versões do Direct3D ou GDI.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-158">Use flip model in an [**HWND**](../winprog/windows-data-types.md) that is not also targeted by other APIs, including DXGI bitblt presentation model, other versions of Direct3D, or GDI.</span></span> <span data-ttu-id="9cb3f-159">Como o modelo BitBlt mantém uma cópia adicional da superfície, você pode adicionar o GDI e outros conteúdos do Direct3D ao mesmo **HWND** por meio de atualizações por etapas do Direct3D e GDI.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-159">Because bitblt model maintains an additional copy of the surface, you can add GDI and other Direct3D contents to the same **HWND** through piecemeal updates from Direct3D and GDI.</span></span> <span data-ttu-id="9cb3f-160">Quando você usa o modelo inverter, somente o conteúdo do Direct3D no flip Model troca cadeias que o tempo de execução passa para o DWM é visível.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-160">When you use the flip model, only Direct3D content in flip model swap chains that the runtime passes to DWM are visible.</span></span> <span data-ttu-id="9cb3f-161">O tempo de execução ignora todas as outras atualizações de conteúdo do modelo BitBlt Direct3D ou GDI.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-161">The runtime ignores all other bitblt model Direct3D or GDI content updates.</span></span>

## <a name="frame-synchronization-of-dxgi-flip-model-apps"></a><span data-ttu-id="9cb3f-162">Sincronização de quadros de aplicativos de modelo de flip-DXGI</span><span class="sxs-lookup"><span data-stu-id="9cb3f-162">Frame synchronization of DXGI flip model apps</span></span>

<span data-ttu-id="9cb3f-163">As estatísticas atuais são informações de tempo de quadro que os aplicativos de mídia usam para sincronizar fluxos de áudio e vídeo e recuperar-se de falhas de reprodução de vídeo.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-163">Present statistics are frame-timing information that media apps use to synchronize video and audio streams and recover from video playback glitches.</span></span> <span data-ttu-id="9cb3f-164">Os aplicativos podem usar as informações de tempo de quadro em atuais estatísticas para ajustar a taxa de apresentação de seus quadros de vídeo para uma apresentação mais suave.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-164">Apps can use the frame-timing information in present statistics to adjust the presentation rate of their video frames for smoother presentation.</span></span> <span data-ttu-id="9cb3f-165">Para obter informações sobre estatísticas presentes, chame o método [**IDXGISwapChain:: GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics) para obter a estrutura de [**\_ \_ estatísticas do quadro dxgi**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) .</span><span class="sxs-lookup"><span data-stu-id="9cb3f-165">To obtain present statistics information, call the [**IDXGISwapChain::GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics) method to obtain the [**DXGI\_FRAME\_STATISTICS**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) structure.</span></span> <span data-ttu-id="9cb3f-166">**Dxgi \_ As \_ Estatísticas de quadro** contêm estatísticas sobre chamadas [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) .</span><span class="sxs-lookup"><span data-stu-id="9cb3f-166">**DXGI\_FRAME\_STATISTICS** contains statistics about [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) calls.</span></span> <span data-ttu-id="9cb3f-167">Uma cadeia de permuta do flip Model fornece informações de estatísticas presentes nos modos de tela inteira e em janelas.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-167">A flip model swap chain provides present statistics information in both windowed and full-screen modes.</span></span> <span data-ttu-id="9cb3f-168">Para cadeias de troca de modelo BitBlt no modo de janela, todos os valores de **\_ \_ Estatísticas de quadro dxgi** são zeros.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-168">For bitblt model swap chains in windowed mode, all **DXGI\_FRAME\_STATISTICS** values are zeroes.</span></span>

<span data-ttu-id="9cb3f-169">Para estatísticas presentes do modelo de flip, [**IDXGISwapChain:: GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics) retorna **\_ Estatísticas de quadro de erro \_ \_ \_ dxgi** nessas situações:</span><span class="sxs-lookup"><span data-stu-id="9cb3f-169">For flip model present statistics, [**IDXGISwapChain::GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics) returns **DXGI\_ERROR\_FRAME\_STATISTICS\_DISJOINT** in these situations:</span></span>

-   <span data-ttu-id="9cb3f-170">Primeira chamada para [**GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics), que indica o início de uma sequência</span><span class="sxs-lookup"><span data-stu-id="9cb3f-170">First call to [**GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics), which indicates the beginning of a sequence</span></span>
-   <span data-ttu-id="9cb3f-171">Alteração de modo: qualquer modo de janela para ou de tela inteira ou tela inteira para transições de tela inteira</span><span class="sxs-lookup"><span data-stu-id="9cb3f-171">Mode change: either windowed mode to or from full screen or full screen to full screen transitions</span></span>

<span data-ttu-id="9cb3f-172">Os valores nos membros **PresentRefreshCount**, **SyncRefreshCount** e **SyncQPCTime** das [**\_ \_ Estatísticas de quadro dxgi**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) têm as seguintes características:</span><span class="sxs-lookup"><span data-stu-id="9cb3f-172">The values in **PresentRefreshCount**, **SyncRefreshCount**, and **SyncQPCTime** members of [**DXGI\_FRAME\_STATISTICS**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) have the following characteristics:</span></span>

-   <span data-ttu-id="9cb3f-173">**PresentRefreshCount** é igual a **SyncRefreshCount** quando o aplicativo apresenta em cada vsync.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-173">**PresentRefreshCount** is equal to **SyncRefreshCount** when the app presents on every vsync.</span></span>
-   <span data-ttu-id="9cb3f-174">**SyncRefreshCount** é obtido no intervalo de vsync quando o presente foi enviado, **SyncQPCTime** é aproximadamente o tempo associado ao intervalo de vsync.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-174">**SyncRefreshCount** is obtained on the vsync interval when the present was submitted, **SyncQPCTime** is approximately the time associated with the vsync interval.</span></span>

<span data-ttu-id="9cb3f-175">O método [**IDXGISwapChain:: GetLastPresentCount**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getlastpresentcount) retorna a última contagem presente, ou seja, a ID atual da última IDXGISwapChain1 bem-sucedida [**::P**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) chamada de resent1 feita por um dispositivo de vídeo associado à cadeia de permuta.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-175">The [**IDXGISwapChain::GetLastPresentCount**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getlastpresentcount) method returns the last present count, that is, the present ID of the last successful [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) call made by a display device that is associated with the swap chain.</span></span> <span data-ttu-id="9cb3f-176">Essa ID atual é o valor do membro **PresentCount** da estrutura de [**\_ \_ estatísticas do quadro dxgi**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) .</span><span class="sxs-lookup"><span data-stu-id="9cb3f-176">This present ID is the value of the **PresentCount** member of the [**DXGI\_FRAME\_STATISTICS**](/windows/desktop/api/DXGI/ns-dxgi-dxgi_frame_statistics) structure.</span></span> <span data-ttu-id="9cb3f-177">Para cadeias de troca de modelo BitBlt, no modo de janela, todos os valores de **\_ \_ Estatísticas de quadro dxgi** são zeros.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-177">For bitblt model swap chains, while in windowed mode, all **DXGI\_FRAME\_STATISTICS** values are zeroes.</span></span>

## <a name="avoiding-detecting-and-recovering-from-glitches"></a><span data-ttu-id="9cb3f-178">Evitando, detectando e recuperando de falhas</span><span class="sxs-lookup"><span data-stu-id="9cb3f-178">Avoiding, detecting, and recovering from glitches</span></span>

<span data-ttu-id="9cb3f-179">Execute estas etapas para evitar, detectar e recuperar-se de falhas na apresentação de quadros:</span><span class="sxs-lookup"><span data-stu-id="9cb3f-179">Perform these steps to avoid, detect, and recover from glitches in frame presentation:</span></span>

1.  <span data-ttu-id="9cb3f-180">IDXGISwapChain1 da fila: chamadas de [**resent1 de:P**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) (ou seja, chamada **IDXGISwapChain1::P resent1** várias vezes, o que faz com que elas sejam coletadas em uma fila).</span><span class="sxs-lookup"><span data-stu-id="9cb3f-180">Queue [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) calls (that is, call **IDXGISwapChain1::Present1** multiple times, which causes them to collect in a queue).</span></span>
2.  <span data-ttu-id="9cb3f-181">Crie uma estrutura de fila atual para armazenar todos os IDXGISwapChain1 enviados com êxito [**::P**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)a ID atual do resent1 (retornada por [**IDXGISwapChain:: GetLastPresentCount**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getlastpresentcount)) e valores de **PresentRefreshCount** associados, calculados/esperados.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-181">Create a present-queue structure to store all successfully submitted [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)'s present ID (returned by [**IDXGISwapChain::GetLastPresentCount**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getlastpresentcount)) and associated, calculated/expected **PresentRefreshCount** values.</span></span>
3.  <span data-ttu-id="9cb3f-182">Para detectar uma falha:</span><span class="sxs-lookup"><span data-stu-id="9cb3f-182">To detect a glitch:</span></span>

    -   <span data-ttu-id="9cb3f-183">Chame [**IDXGISwapChain:: GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics).</span><span class="sxs-lookup"><span data-stu-id="9cb3f-183">Call [**IDXGISwapChain::GetFrameStatistics**](/windows/desktop/api/DXGI/nf-dxgi-idxgiswapchain-getframestatistics).</span></span>
    -   <span data-ttu-id="9cb3f-184">Para esse quadro, obtenha a ID atual (**PresentCount**) e a contagem de vsync em que o sistema operacional apresentou a última imagem ao monitor (**PresentRefreshCount**).</span><span class="sxs-lookup"><span data-stu-id="9cb3f-184">For this frame, get the present ID (**PresentCount**) and vsync count where the operating system presented the last image to the monitor (**PresentRefreshCount**).</span></span>
    -   <span data-ttu-id="9cb3f-185">Recupere o **PresentRefreshCount** esperado que está associado à ID atual e que você armazenou anteriormente na estrutura de fila atual.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-185">Retrieve the expected **PresentRefreshCount** that is associated with the present ID and that you previously stored in the present-queue structure.</span></span>
    -   <span data-ttu-id="9cb3f-186">Se o **PresentRefreshCount** real for posterior ao esperado **PresentRefreshCount**, ocorrerá uma falha.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-186">If the actual **PresentRefreshCount** is later than the expected **PresentRefreshCount**, a glitch has occurred.</span></span>

4.  <span data-ttu-id="9cb3f-187">Para se recuperar do problema:</span><span class="sxs-lookup"><span data-stu-id="9cb3f-187">To recover from the glitch:</span></span>

    -   <span data-ttu-id="9cb3f-188">Calcule o número de quadros a serem ignorados para a recuperação da falha.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-188">Calculate the number of frames to skip to recover from the glitch.</span></span> <span data-ttu-id="9cb3f-189">Por exemplo, se a etapa 3 revelar que a contagem vsync esperada (**PresentRefreshCount**) para uma ID presente (**PresentCount**) é 5 e a contagem vsync real para a ID atual for 8, o número de quadros a serem ignorados para recuperação da falha será de 3 quadros.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-189">For example, if step 3 reveals that the expected vsync count (**PresentRefreshCount**) for a present ID (**PresentCount**) is 5 and the actual vsync count for the present ID is 8, the number of frames to skip to recover from the glitch is 3 frames.</span></span>
    -   <span data-ttu-id="9cb3f-190">Passe 0 para o parâmetro *SyncInterval* neste número de chamadas para [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) para descartar e ignorar esse número de quadros.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-190">Pass 0 to the *SyncInterval* parameter in this number of calls to [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) to discard and skip this number of frames.</span></span>

        > [!Note]  
        > <span data-ttu-id="9cb3f-191">Se o problema consistir em um grande número de quadros, chame [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) com o parâmetro *flags* definido como [**dxgi \_ presente \_ Restart**](dxgi-present.md) para descartar e ignorar todos os presentes enfileirados pendentes.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-191">If the glitch consists of a large number of frames, call [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) with the *Flags* parameter set to [**DXGI\_PRESENT\_RESTART**](dxgi-present.md) to discard and skip all outstanding queued presents.</span></span>

         

<span data-ttu-id="9cb3f-192">Aqui está um cenário de exemplo de recuperação de falhas na apresentação de quadros:</span><span class="sxs-lookup"><span data-stu-id="9cb3f-192">Here is an example scenario of recovering from glitches in frame presentation:</span></span>

![ilustração de um cenário de exemplo de recuperação de falhas na apresentação de quadros](images/frame-sync-glitch-recover.png)

<span data-ttu-id="9cb3f-194">No cenário de exemplo, você espera que o quadro A passe na tela em uma contagem de vsync de 1.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-194">In the example scenario, you expect frame A to go on screen on a vsync count of 1.</span></span> <span data-ttu-id="9cb3f-195">Mas, na verdade, você detecta a contagem de vsync que o quadro A aparece na tela como 4.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-195">But you actually detect the vsync count that frame A appears on screen as 4.</span></span> <span data-ttu-id="9cb3f-196">Portanto, você determina que ocorreu uma falha.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-196">Therefore, you determine that a glitch occurred.</span></span> <span data-ttu-id="9cb3f-197">Em seguida, você pode descartar 3 quadros, ou seja, você pode passar 0 para o parâmetro *SyncInterval* em 3 chamadas para [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1).</span><span class="sxs-lookup"><span data-stu-id="9cb3f-197">You can then discard 3 frames, that is, you can pass 0 to the *SyncInterval* parameter in 3 calls to [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1).</span></span> <span data-ttu-id="9cb3f-198">No cenário de exemplo anterior, para se recuperar da falha, você precisa de um total de 8 **IDXGISwapChain1:** chamadas de resent1 de:P.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-198">In the preceding example scenario, to recover from the glitch, you need a total of 8 **IDXGISwapChain1::Present1** calls.</span></span> <span data-ttu-id="9cb3f-199">Em seguida, o nono quadro é visível de acordo com a contagem de vsync esperada.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-199">The 9th frame is then visible as per the vsync count that you expect.</span></span>

<span data-ttu-id="9cb3f-200">Aqui está uma linha de tempo de eventos de apresentação.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-200">Here's a time line of presentation events.</span></span> <span data-ttu-id="9cb3f-201">Cada linha vertical representa um vsync.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-201">Each vertical line represents a vsync.</span></span> <span data-ttu-id="9cb3f-202">A direção horizontal é time, que aumenta à direita.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-202">The horizontal direction is time, which increases to the right.</span></span> <span data-ttu-id="9cb3f-203">Você pode usar a figura para imaginar como os problemas podem ocorrer.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-203">You can use the figure to imagine how glitches can occur.</span></span>

![ilustração de uma linha de tempo de eventos de apresentação](images/present-timeline.png)

<span data-ttu-id="9cb3f-205">A figura ilustra esta sequência:</span><span class="sxs-lookup"><span data-stu-id="9cb3f-205">The figure illustrates this sequence:</span></span>

1.  <span data-ttu-id="9cb3f-206">O aplicativo é ativado em vsync, renderiza azul, chama [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)e, em seguida, volta para o estado de suspensão.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-206">The app wakes up on vsync, renders blue, calls [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1), and then goes back to sleep.</span></span>
2.  <span data-ttu-id="9cb3f-207">A GPU (unidade de processamento gráfico) é ativada de ocioso, executa o processamento em azul e, em seguida, volta para o estado de suspensão.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-207">The graphics processing unit (GPU) wakes up from idle, performs the render to blue, and then goes back to sleep.</span></span>
3.  <span data-ttu-id="9cb3f-208">O DWM é ativado no próximo vsync, compõe o azul em seu buffer de fundo, chama [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)e, em seguida, volta para o estado de suspensão.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-208">The DWM wakes up at the next vsync, composes blue into its back buffer, calls [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1), and then goes back to sleep.</span></span>
4.  <span data-ttu-id="9cb3f-209">O aplicativo é ativado, renderiza verde, chama [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1)e, em seguida, volta para o estado de suspensão.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-209">The app wakes up, renders green, calls [**IDXGISwapChain1::Present1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1), and then goes back to sleep.</span></span>
    > [!Note]  
    > <span data-ttu-id="9cb3f-210">O aplicativo é executado simultaneamente enquanto a GPU executa a composição de azul.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-210">The app concurrently executes while the GPU performs the compose of blue.</span></span>

     

5.  <span data-ttu-id="9cb3f-211">Em seguida, a GPU renderiza verde para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-211">Next, the GPU renders green for the app.</span></span>
6.  <span data-ttu-id="9cb3f-212">Por fim, o conversor de digital para analógico (DAC) mostra os resultados da composição do DWM no monitor no próximo vsync.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-212">Finally, the digital to analog converter (DAC) shows results of the DWM composition on the monitor on the next vsync.</span></span>

<span data-ttu-id="9cb3f-213">Na linha de tempo, você pode imaginar a latência de atuais estatísticas e como os problemas podem ocorrer.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-213">From the time line, you can imagine the latency of present statistics and how glitches can occur.</span></span> <span data-ttu-id="9cb3f-214">Por exemplo, para mostrar uma falha do DWM para a cor verde que aparece na tela, imagine alargar a caixa verde/vermelha para que o lado direito da caixa verde/vermelha corresponda ao lado direito da caixa roxo/vermelho.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-214">For example, to show a DWM glitch for the green color appearing on screen, imagine widening the green/red box so that the right side of the green/red box matches up to the right side of the purple/red box.</span></span> <span data-ttu-id="9cb3f-215">Nesse cenário, o DAC mostra dois quadros de azul e, em seguida, o quadro verde.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-215">In this scenario, the DAC shows two frames of blue and then the green frame.</span></span> <span data-ttu-id="9cb3f-216">Você pode ver que esse problema ocorreu na leitura de estatísticas presentes.</span><span class="sxs-lookup"><span data-stu-id="9cb3f-216">You can see that this glitch occurred from reading present statistics.</span></span>

## <a name="related-topics"></a><span data-ttu-id="9cb3f-217">Tópicos relacionados</span><span class="sxs-lookup"><span data-stu-id="9cb3f-217">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="9cb3f-218">Aprimorando a apresentação com o modelo de flip, retângulos sujos e áreas roladas</span><span class="sxs-lookup"><span data-stu-id="9cb3f-218">Enhancing presentation with the flip model, dirty rectangles, and scrolled areas</span></span>](dxgi-1-2-presentation-improvements.md)
</dt> </dl>

 

 
